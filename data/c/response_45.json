[{"tags": ["c", "linux", "copy"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447890707, "post_id": 33792754, "comment_id": 55352343, "body": "I would check both file descriptors against <code>-1</code>..."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1447890815, "post_id": 33792754, "comment_id": 55352380, "body": "1. Read the documentation for <code>open</code>, &quot;r&quot; and &quot;w&quot; are not valid. 2. you need to write the number of bytes that were read, which is <code>pos</code>. 3. if <code>read</code> fails it may return a negative number which will cause an infinite loop in your code."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1447890860, "post_id": 33792754, "comment_id": 55352398, "body": "Why <code>&amp;buf</code>? Maybe <code>&amp;buf[0]</code>, but <code>&amp;buf</code>?? Also, why write 1,024 bytes even if you read fewer than that?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1447890935, "post_id": 33792754, "comment_id": 55352421, "body": "Does this even compile? Looks like <code>open</code> should be <code>fopen</code>. And <code>FILE</code> should be <code>FILE *</code>."}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447890961, "post_id": 33792754, "comment_id": 55352429, "body": "I&#39;m still a bit confused. I had O_CREAT instead of &#39;w&#39; and it said that O_CREAT was undefined."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1447891251, "post_id": 33792754, "comment_id": 55352526, "body": "Please, just go read the <a href=\"http://linux.die.net/man/2/open\" rel=\"nofollow noreferrer\">man page</a>. If you want to use <code>open</code> (as opposed to <code>fopen</code>) then you need the <code>#include</code>s shown in that man page."}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447891465, "post_id": 33792754, "comment_id": 55352611, "body": "Ok I guess I may have posted this question prematurely. I&#39;m going to spend another hour or so trying and come back here."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447891214, "post_id": 33792776, "comment_id": 55352514, "body": "Could you possibly fix the errors and post a solution? I have never used linux nor C until today so this is all very confusing. I&#39;m trying to run a few tests to see how different buffer sizes affect each OS."}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447891606, "post_id": 33792776, "comment_id": 55352672, "body": "Why do you use char * <i>argv rather than char</i> argv[]?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447891650, "post_id": 33792776, "comment_id": 55352695, "body": "Why do you use <code>char *argv[]</code>?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447891856, "post_id": 33792776, "comment_id": 55352779, "body": "You see, in the end <code>char *argv[]</code> is converted to <code>char **</code> inside <code>main()</code>, but I like it <code>char **argv</code> just because <code>char *argv[]</code> looks like java, it&#39;s silly but it&#39;s how I like it."}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447892146, "post_id": 33792776, "comment_id": 55352869, "body": "I tried your code and it doesn&#39;t seem to actually copy the file"}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447892192, "post_id": 33792776, "comment_id": 55352884, "body": "i named it mycopy2.c and compiled in gcc and then ran with ./mycopy2 file.txt newfile.txt"}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447892203, "post_id": 33792776, "comment_id": 55352891, "body": "But after doing an LS newfile.txt does not show up in the directory"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447892314, "post_id": 33792776, "comment_id": 55352926, "body": "The first code I posted I forgot the <code>O_CREAT</code> flag. Also, the correct way would be to check whether the source and destination are the same, perhaps check if the destination exists and also, read the permissions and set the same ones to the destination file."}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447892895, "post_id": 33792776, "comment_id": 55353120, "body": "You have helped me tremendously! Thank you!"}, {"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447894583, "post_id": 33792776, "comment_id": 55353647, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95500/discussion-between-mkey-and-iharob\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 4, "last_activity_date": 1447892855, "last_edit_date": 1447892855, "creation_date": 1447890749, "answer_id": 33792776, "question_id": 33792754, "link": "https://stackoverflow.com/questions/33792754/in-c-on-linux-how-would-you-implement-cp/33792776#33792776", "title": "In C on linux how would you implement cp", "body": "<p>This code has an important problem, the fact that you always write <code>1024</code> bytes regardless of how many you read.</p>\n\n<p>Also:</p>\n\n<ol>\n<li>You don't check the number of command line arguments.</li>\n<li>You don't check if the source file exists (if it opens).</li>\n<li>You don't check that the destination file opens (permission issues).</li>\n<li>You pass the address of the array which has a different type than the pointer to the first element to the array.</li>\n<li><p><strong>The type of <code>fp1</code></strong> is wrong, as well as that of <code>fp2</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;fcntl.h&gt;\n\nint main(int argc, char **argv)\n{\n    char buffer[1024];\n    int files[2];\n    ssize_t count;\n\n    /* Check for insufficient parameters */\n    if (argc &lt; 3)\n        return -1;\n    files[0] = open(argv[1], O_RDONLY);\n    if (files[0] == -1) /* Check if file opened */\n        return -1;\n    files[1] = open(argv[2], O_WRONLY | O_CREAT | S_IRUSR | S_IWUSR);\n    if (files[1] == -1) /* Check if file opened (permissions problems ...) */\n    {\n        close(files[0]);\n        return -1;\n    }\n\n    while ((count = read(files[0], buffer, sizeof(buffer))) != 0)\n        write(files[1], buffer, count);\n\n    return 0;\n}\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 3848072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SUOv5.jpg?s=128&g=1", "display_name": "jarr", "link": "https://stackoverflow.com/users/3848072/jarr"}, "is_accepted": false, "score": 1, "last_activity_date": 1447892305, "creation_date": 1447892305, "answer_id": 33793078, "question_id": 33792754, "link": "https://stackoverflow.com/questions/33792754/in-c-on-linux-how-would-you-implement-cp/33793078#33793078", "title": "In C on linux how would you implement cp", "body": "<p>Go to section 8.3 of the K&amp;R \"The C Programming Language\". There you will see an example of what you want to accomplish. Try using different buffer sizes and you will end up seeing a point where the performance tops.</p>\n"}, {"tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 1, "last_activity_date": 1447894823, "last_edit_date": 1447894823, "creation_date": 1447894419, "answer_id": 33793397, "question_id": 33792754, "link": "https://stackoverflow.com/questions/33792754/in-c-on-linux-how-would-you-implement-cp/33793397#33793397", "title": "In C on linux how would you implement cp", "body": "<pre><code>#include &lt;stdio.h&gt;\nint cpy(char *, char *);\nint main(int argc, char *argv[])\n{\n    char *fn1 = argv[1];\n    char *fn2 = argv[2];\n\n    if (cpy(fn2, fn1) == -1) {\n        perror(\"cpy\");\n        return 1;\n    }\n    reurn 0;\n}\nint cpy(char *fnDest, char *fnSrc)\n{\n    FILE *fpDest, *fpSrc;\n    int c;\n\n    if ((fpDest = fopen(fnDest, \"w\")) &amp;&amp; (fpSrc = fopen(fnSrc, \"r\"))) {\n        while ((c = getc(fpSrc)) != EOF)\n            putc(fpDest);\n        fclose(fpDest);\n        fclose(fpSrc);\n\n        return 0;\n    }\n    return -1;\n}\n</code></pre>\n\n<p>First, we get the two file names from the command line (<code>argv[1]</code> and <code>argv[2]</code>). The reason we don't start from <code>*argv</code>, is that it contains the program name.</p>\n\n<p>We then call our <code>cpy</code> function, which copies the contents of the second named file to the contents of the first named file.</p>\n\n<p>Within <code>cpy</code>, we declare two file pointers: fpDest, the destination file pointer, and fpSrc, the source file pointer. We also declare <code>c</code>, the character that will be read. It is of type <code>int</code>, because <code>EOF</code> does not fit in a <code>char</code>.</p>\n\n<p>If we could open the files succesfully(if <code>fopen</code> does not return <code>NULL</code>), we get characters from <code>fpSrc</code> and copy them onto <code>fpDest</code>, as long as the character we have read is not <code>EOF</code>. Once we have seen <code>EOF</code>, we close our file pointers, and return 0, the success indicator. If we could not open the files,  <code>-1</code> is returned. The caller can check the return value for -1, and if it is, print an error message.</p>\n"}], "owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12080, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1447897002, "creation_date": 1447890637, "last_edit_date": 1447897002, "question_id": 33792754, "link": "https://stackoverflow.com/questions/33792754/in-c-on-linux-how-would-you-implement-cp", "title": "In C on linux how would you implement cp", "body": "<p>I've found on google code that was over 50 lines long and that's completely unnecessary for what I'm trying to do. </p>\n\n<p>I want to make a very simple <code>cp</code> implementation in C. </p>\n\n<p>Just so I can play with the buffer sizes and see how it affects performance.</p>\n\n<p>I want to use only Linux API calls like <code>read()</code> and <code>write()</code> but I'm having no luck. </p>\n\n<p>I want a buffer that is defined as a certain size so data from file1 can be read into buffer and then written to file2 and that continues until file1 has reached EOF.</p>\n\n<p>Here is what I tried but it doesn't do anything</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n\n#define BUFSIZE 1024\n\nint main(int argc, char* argv[]){\n\n    FILE fp1, fp2;\n    char buf[1024];\n    int pos;\n\n\n    fp1 = open(argv[1], \"r\");\n    fp2 = open(argv[2], \"w\");\n\n    while((pos=read(fp1, &amp;buf, 1024)) != 0)\n    {\n        write(fp2, &amp;buf, 1024);\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>The way it would work is <code>./mycopy file1.txt file2.txt</code></p>\n"}, {"tags": ["c", "random", "numbers"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447889452, "post_id": 33792524, "comment_id": 55351894, "body": "You have the answer, you say not in any order ... it&#39;s just about reordering."}, {"owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "edited": false, "score": 1, "creation_date": 1447889574, "post_id": 33792524, "comment_id": 55351947, "body": "If you don&#39;t want duplicates then you don&#39;t want a <i>random number</i>, you want a well defined <i>set</i> of numbers in <i>random order</i>."}, {"owner": {"reputation": 170, "user_id": 4855124, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/863e012c9931192c38b76c58fad3fb33?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4855124/george"}, "edited": false, "score": 0, "creation_date": 1447889579, "post_id": 33792524, "comment_id": 55351950, "body": "When I ran the program, I had the number 0844 two times. And I don&#39;t think it&#39;s only this number that appears twice.   Let&#39;s say that I have produced numbers in this way: 0000, 0001, ..., 9999, not randomly. How can I reorder them in order to seem random? (question to your comment.)"}, {"owner": {"reputation": 170, "user_id": 4855124, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/863e012c9931192c38b76c58fad3fb33?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4855124/george"}, "reply_to_user": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "edited": false, "score": 0, "creation_date": 1447889668, "post_id": 33792524, "comment_id": 55351972, "body": "@J... How is this possible?"}, {"owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "edited": false, "score": 0, "creation_date": 1447890868, "post_id": 33792524, "comment_id": 55352400, "body": "@George See below ;)"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1447889996, "post_id": 33792563, "comment_id": 55352104, "body": "This is an excelente answer. I had mine ready so I posted it anyway."}], "tags": [], "owner": {"reputation": 160, "user_id": 4184445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e594e56abc92b645c3487dcf576207e4?s=128&d=identicon&r=PG", "display_name": "Bug Hunter 219", "link": "https://stackoverflow.com/users/4184445/bug-hunter-219"}, "is_accepted": false, "score": 6, "last_activity_date": 1461433567, "last_edit_date": 1495540775, "creation_date": 1447889582, "answer_id": 33792563, "question_id": 33792524, "link": "https://stackoverflow.com/questions/33792524/generating-unequal-random-numbers-in-c/33792563#33792563", "title": "Generating unequal random numbers in C", "body": "<p>Take an array of 10000 length and store the elements from 0 to 9999 in those.\nThen shuffle the array <a href=\"https://stackoverflow.com/questions/6127503/shuffle-array-in-c\">Shuffle array in C</a>.</p>\n\n<p>Then print the answer with leading zeros when needed <a href=\"https://stackoverflow.com/questions/153890/printing-leading-0s-in-c\">Printing leading 0&#39;s in C?</a></p>\n"}, {"comments": [{"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 1, "creation_date": 1447893743, "post_id": 33792587, "comment_id": 55353408, "body": "except I believe this introduces bias: see Fisher-Yates shuffle."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1447890022, "last_edit_date": 1447890022, "creation_date": 1447889720, "answer_id": 33792587, "question_id": 33792524, "link": "https://stackoverflow.com/questions/33792524/generating-unequal-random-numbers-in-c/33792587#33792587", "title": "Generating unequal random numbers in C", "body": "<p>What you should do is generate an array with the numbers from <code>0</code> to <code>9999</code> and then mix it up, like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SIZE 10000\n\nint main()\n{\n    int numbers[SIZE];\n\n    srand(time(NULL));\n    /* Fill the array */\n    for (int i = 0 ; i &lt; SIZE ; ++i)\n        numbers[i] = i;\n    /* Mix it */\n    for (int i = 0, j = rand() % SIZE ; i &lt; SIZE ; ++i, j = rand() % SIZE)\n    {\n        int swap;\n        swap = numbers[i];\n        numbers[i] = numbers[j];\n        numbers[j] = swap;\n    }\n    /* Display it */\n    for (int i = 0 ; i &lt; SIZE ; ++i)\n        fprintf(stdout, \"%04d\\n\", numbers[i]);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 4855124, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/863e012c9931192c38b76c58fad3fb33?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4855124/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1461433567, "creation_date": 1447889339, "last_edit_date": 1447889460, "question_id": 33792524, "link": "https://stackoverflow.com/questions/33792524/generating-unequal-random-numbers-in-c", "title": "Generating unequal random numbers in C", "body": "<p>I have written a program that generates 4 random digits, that should appear on the screen like this: from 0000 to 9999 (not in ascending order necessarily, of course!). </p>\n\n<p>The problem is that I have encountered numbers that are equal with each other. How can I fix it? I just want to produce 10.000 numbers, in the range 0000 to 9999, but not in any order: just \"random\".</p>\n\n<p>Here is what I have written so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;assert.h&gt;\n#define SIZE 10000\n\nint main(){\n\n    srand(time(NULL));\n\n    int a[SIZE], b[SIZE], c[SIZE], d[SIZE], i;\n    FILE *fd = fopen(\"combinations_rand.txt\", \"w\");\n    assert(fd);\n\n    for(i=0; i&lt;SIZE; i++){      \n        a[i] = rand()%10; //array of first digits\n        b[i] = rand()%10; //array of second digits, etc...\n        c[i] = rand()%10;\n        d[i] = rand()%10;\n        fprintf(fd, \"%d%d%d%d\\n\", a[i], b[i], c[i], d[i]);\n     }\n     fclose(fd);\n}\n</code></pre>\n"}, {"tags": ["c", "math"], "comments": [{"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447889145, "post_id": 33792452, "comment_id": 55351785, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33787851/edit-script-for-user-input-rather-than-internal-input\">Edit script for user input rather than internal input</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447889163, "post_id": 33792452, "comment_id": 55351793, "body": "You need to move <code>int fac = gcd(add, add1);  add &#47;=fac;   add1&#47;=fac;</code> down to be below <code>add1=(b*d)</code> .  In C, statements like that don&#39;t define relations between variables; they are calculations that are executed immediately, and as such, you are just performing meaningless calculations with uninitialized variables that have no impact on the rest of the program."}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447889415, "post_id": 33792452, "comment_id": 55351880, "body": "That worked for the sum, what about the remaining? Do I essentially just repeat the same process just changing the variable? As an example for subtraction: &#39;int fac = gcd(sub, sub1); sub /=fac; sub1/=fac;&#39; @M.M"}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447889581, "post_id": 33792452, "comment_id": 55351952, "body": "That did not work, nor did inserting the sub, sub1 function into the same gcd(). I get the error of too many functions within the &#39;gcd()&#39; @M.M"}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "edited": false, "score": 0, "creation_date": 1447890142, "post_id": 33792452, "comment_id": 55352158, "body": "input is a numerator and denominator and the output should be a solution of arithmetic functions reduced to the lcd. So far the add and sub work but multiplication and division do not."}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447890605, "post_id": 33792452, "comment_id": 55352304, "body": "there is ambiguity in your method usage.. greatest common denominator is  not inclusive to fractions, just arithmetic.. you&#39;re second parameter is assumed to be a denominator. why? if <code>a</code> is <code>0</code>, the gcd should return <code>b</code>..  unless <code>b</code> is <code>0</code>.. then it&#39;s an exception. if <code>a</code> is suppose to be a numerator here, you&#39;re forced with trying to find a gcd of 0.."}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447890720, "post_id": 33792452, "comment_id": 55352345, "body": "it&#39;s an exception because the answer is infinite.."}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447890736, "post_id": 33792452, "comment_id": 55352351, "body": "@BrettCaswell I see what you mean. However, the script works fine and I was told if it works, done touch it."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447891451, "post_id": 33792452, "comment_id": 55352605, "body": "@AraMod it should work equally well for all cases, you probably made a typo"}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447891520, "post_id": 33792452, "comment_id": 55352627, "body": "It does, works perfectly fine the way it&#39;s displayed. If you had a chance can you show me how to get this in a loop form so the user can perform the task more than once. @M.M"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447891756, "post_id": 33792452, "comment_id": 55352735, "body": "@AraMod you could write a function, with same signature as the one in @stackptr &#39;s answer, except inside the body, have <code>int x = gcd(*num, *den); *num &#47;= x; *den &#47;= x;</code>"}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447891856, "post_id": 33792452, "comment_id": 55352778, "body": "Would that keep my script continuous? @M.M"}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447897131, "post_id": 33792452, "comment_id": 55354364, "body": "bah.. I messed up my arithmetic.. GCD of 3/4 is not <code>GCD(3, 4)</code> it&#39;s <code>GCD(3&#47;4)</code>, or <code>GCD(3&#47;4, 0&#47;4)</code>, which is <code>GCD(3, 0) &#47; LCM(4, 4) = 3&#47;4</code> .. GCD is step in the process of solving (arithmetic).. GCD (3, 0) is <code>3</code>"}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447899545, "post_id": 33792452, "comment_id": 55355013, "body": "Hey Brett thanks for your reply. I was wondering, how can I get my script to loop after one set of equations is processed? @BrettCaswell"}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447900376, "post_id": 33792452, "comment_id": 55355272, "body": "move your logic to another method, in your main start a while (true|false) loop that checks whether a variable (that you declared and initialized/assigned <code>true</code> before your loop), call your method.. perform another input check after your method call.. determine if that variable/response justifies setting the while check variable to false."}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447900454, "post_id": 33792452, "comment_id": 55355290, "body": "I&#39;m lost, isn&#39;t it always true? Would I have to check for anything other than an end of the original statement? @BrettCaswell"}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447900897, "post_id": 33792452, "comment_id": 55355389, "body": "<code>while (whileCheck)  {    RunMyMethods();     whileCheck = input(&quot;Run again? (1 - yes, 0 - no)&quot;); }</code>"}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447900967, "post_id": 33792452, "comment_id": 55355399, "body": "And that goes directly below main or is it something that needs to be established outside of the main() @BrettCaswell"}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1447901033, "post_id": 33792452, "comment_id": 55355419, "body": "@AraMod within <code>main</code> closure. program ends at the end of <code>main</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1167, "user_id": 5339807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5db3c9fa9b80760fc44ae03008f7a1?s=128&d=identicon&r=PG&f=1", "display_name": "mascoj", "link": "https://stackoverflow.com/users/5339807/mascoj"}, "is_accepted": false, "score": 2, "last_activity_date": 1447889943, "creation_date": 1447889943, "answer_id": 33792634, "question_id": 33792452, "link": "https://stackoverflow.com/questions/33792452/how-can-i-get-my-fraction-results-reduced-in-this-c-code/33792634#33792634", "title": "How can I get my fraction results reduced in this C Code?", "body": "<p>You need to recalculate your gcd for each specific case and then divide:</p>\n\n<pre><code>    add=(a*d+b*c);\n    add1=(b*d);\n    int fac = gcd(add, add1);\n    add /=fac;\n    add1/=fac;\n    printf(\"\\The sum of your fractions is: %d/%d\",add,add1);\n    sub=(a*d-b*c);\n    sub1=(b*d);\n    fac = gcd(sub,sub1);\n    sub /= fac;\n    sub1 /= fac;\n</code></pre>\n\n<p>etc.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "edited": false, "score": 0, "creation_date": 1447890569, "post_id": 33792707, "comment_id": 55352294, "body": "I was able to get this portion figured out, thanks for your help. My follow up question now that my script works, how do I get it to loop so that after one set of results are displayed, the user can start over until they type &quot;quit&quot; as the first numerator? @stackptr"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447891427, "post_id": 33792707, "comment_id": 55352599, "body": "The gcd function already exists; no need to reinvent the wheel"}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 0, "last_activity_date": 1447890370, "creation_date": 1447890370, "answer_id": 33792707, "question_id": 33792452, "link": "https://stackoverflow.com/questions/33792452/how-can-i-get-my-fraction-results-reduced-in-this-c-code/33792707#33792707", "title": "How can I get my fraction results reduced in this C Code?", "body": "<p>To simplify a fraction:</p>\n\n<pre><code>void simp(int *num, int *den)\n{\n    int i;\n\n    int lim = (*num &lt; *den) ? *num : *den;\n    for (i = 2; i &lt; lim; ++i)\n        if (*num % i == 0 &amp;&amp; *den % i == 0) {\n            *num /= i;\n            *den /= i;\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447890461, "creation_date": 1447888961, "last_edit_date": 1447890461, "question_id": 33792452, "link": "https://stackoverflow.com/questions/33792452/how-can-i-get-my-fraction-results-reduced-in-this-c-code", "title": "How can I get my fraction results reduced in this C Code?", "body": "<p>Update 1: \nWith everyone's help i was able to get:\n-A point I would like to make, each int requires for a new role of definition. Have a look below to understand the mistake in answers and the solution in which I was going for.</p>\n\n<p>If possibly can someone help me make this script continuous? By that I mean, after one expression is done and all the solutions are displayed, the user should be able to continue and keep using the script until they want to quit. Basically, how can I loop this whole thing so it does not end after one user input?</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include&lt;math.h&gt;\n #include&lt;string.h&gt;\n\n int gcd(int a, int b) {\n    while(0!=b) { int r = a % b; a=b; b=r; }\n    return a;\n}\n int input(char* prompt) {\n    int res;\n    printf(\"%s: \", prompt);\n    scanf(\"%d\", &amp;res);\n    return res;\n}\n main()\n {\n    int add,sub,mul,dd;\n    int add1,sub1,mul1,dd1;\n    int a,b,c,d;\n    a=input(\"Please enter the numerator for your first equation\");\n    b=input(\"Please enter the denominator for your first equation\");\n    c=input(\"Please enter the numerator for your second equation\");\n    d=input(\"Please enter the denominator for your second equation\");\n    add=(a*d+b*c);\n    add1=(b*d);\n    int fac = gcd(add, add1);\n        add /=fac;\n        add1 /=fac;\n    printf(\"\\The sum of your fractions is: %d/%d\",add,add1);\n    sub=(a*d-b*c);\n    sub1=(b*d);\n    int red = gcd(sub, sub1);\n        sub /=red;\n        sub1 /=red;\n    printf(\"\\nThe difference of your fractions is: %d/%d\",sub,sub1);\n    mul=(a*c);\n    mul1=(b*d);\n    int red1 = gcd(mul, mul1);\n        mul /=red1;\n        mul1 /=red1;\n    printf(\"\\nThe product of your fractions is: %d/%d\",mul,mul1);\n    dd=(a*d);\n    dd1=(b*c);\n    int red2 = gcd(dd, dd1);\n        dd /=red2;\n        dd1 /=red2;\n    printf(\"\\nThe quotient of your fractions is: %d/%d\",dd,dd1);\n }\n</code></pre>\n"}, {"tags": ["c", "struct", "stat"], "comments": [{"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1447888933, "post_id": 33792423, "comment_id": 55351720, "body": "<code>buf</code> is a pointer to <code>struct stat</code> so you need <code>buf-&gt;st_mode</code>. Alternatively: declare <code>buf</code> as such: <code>struct stat buf;</code> and pass its address to <code>stat</code>: <code>stat(fn, &amp;buf);</code>."}, {"owner": {"reputation": 1, "user_id": 5467970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444e76549e334b7902fab226f9aa6d3f?s=128&d=identicon&r=PG&f=1", "display_name": "WIN10DBubuntu", "link": "https://stackoverflow.com/users/5467970/win10dbubuntu"}, "reply_to_user": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1447889338, "post_id": 33792423, "comment_id": 55351849, "body": "Wow thank you! Why is it like this? Say if I have a node struct with something like a <code>char data</code>. At first sight, I&#39;d tell that <code>node-&gt;data</code> and <code>node.data</code> are the same. What&#39;s the difference in <code>struct stat</code>?"}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1447889607, "post_id": 33792423, "comment_id": 55351956, "body": "The dot <code>.</code> is used when you are dealing with a <code>struct</code> (or <code>union</code>) directly e.g when you have <code>struct something node;</code>. The in arrow <code>node-&gt;data</code> is short for <code>(*node).data</code> so <code>node</code> needs to be a <i>pointer</i> to a <code>struct</code> (or <code>union</code>) e.g. when you have <code>struct something * node;</code>."}, {"owner": {"reputation": 1, "user_id": 5467970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444e76549e334b7902fab226f9aa6d3f?s=128&d=identicon&r=PG&f=1", "display_name": "WIN10DBubuntu", "link": "https://stackoverflow.com/users/5467970/win10dbubuntu"}, "reply_to_user": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1447940662, "post_id": 33792423, "comment_id": 55376484, "body": "I see! Thank you for the clarification!"}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 1, "last_activity_date": 1447889802, "creation_date": 1447889802, "answer_id": 33792609, "question_id": 33792423, "link": "https://stackoverflow.com/questions/33792423/cstatfileinfo-why-is-st-mode-defined-as-something-not-in-structure-when-i/33792609#33792609", "title": "[C][Stat][Fileinfo] Why is st_mode defined as something not in structure, when I use the stat() call to return a structure?", "body": "<p><code>buf</code> is not a <code>struct stat</code>. <code>buf</code> is a pointer to a <code>struct stat</code>, and pointers don't have <code>st_mode</code> fields. To get the <code>st_mode</code> field of the <code>struct stat</code> <em>that <code>buf</code> points to</em>, use <code>(*buf).st_mode</code>, or <code>buf-&gt;st_mode</code> for short.</p>\n"}], "owner": {"reputation": 1, "user_id": 5467970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444e76549e334b7902fab226f9aa6d3f?s=128&d=identicon&r=PG&f=1", "display_name": "WIN10DBubuntu", "link": "https://stackoverflow.com/users/5467970/win10dbubuntu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447889802, "creation_date": 1447888807, "question_id": 33792423, "link": "https://stackoverflow.com/questions/33792423/cstatfileinfo-why-is-st-mode-defined-as-something-not-in-structure-when-i", "title": "[C][Stat][Fileinfo] Why is st_mode defined as something not in structure, when I use the stat() call to return a structure?", "body": "<p>I'm trying to use the <code>st_mode</code> from a returned <code>stat</code> struct, that I get from the <code>stat()</code> call following way; </p>\n\n<pre><code>        char *fn = \"test.c\"\n\n        struct stat *buf = malloc(sizeof(stat));\n\n        stat(fn,buf);\n\n        if(S_ISREG(buf.st_mode))\n        {\n          printf(\"this file is a regular file...\"); //if regular\n        }\n</code></pre>\n\n<p>When I try to compile this code, I get the following error: </p>\n\n<pre><code>server1.c: In function \u2018main\u2019:\nserver1.c:223:32: error: request for member \u2018st_mode\u2019 in something not \na structure or union\n         if(S_ISREG(fileData.st_mode))\n                            ^\n</code></pre>\n\n<p>Why do I get this compile error? I can't seem to find much info myself..</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447887655, "post_id": 33792106, "comment_id": 55351220, "body": "No no ... first you have to fix it! <code>gets()</code> is deprecated and actually was removed from the c standard. Use <code>fgets(str, sizeof(str), stdin)</code> instead."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447887802, "post_id": 33792106, "comment_id": 55351292, "body": "No, <code>fgets(str, sizeof(str), stdin)</code>. Also, <code>scanf()</code> returns a value, check it. Don&#39;t you have any ideas? Involving arrays perhaps?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1447887827, "post_id": 33792106, "comment_id": 55351304, "body": "Mixing chalk with cheese here: <code>for (str ; str &lt;= count ; str++)</code> because <code>str</code> isn&#39;t something you can alter, or compare with <code>int</code>."}, {"owner": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447887946, "post_id": 33792106, "comment_id": 55351350, "body": "Im really bad at arrays too its really confusing for me."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447887949, "post_id": 33792106, "comment_id": 55351352, "body": "Er.. um.. search for examples about reversing strings? Plenty of SO questions about that."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447887985, "post_id": 33792106, "comment_id": 55351364, "body": "And also, I don&#39;t understand ... You want to count the ocurrences of each character?"}, {"owner": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447887987, "post_id": 33792106, "comment_id": 55351365, "body": "I got number 1 already."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447888078, "post_id": 33792106, "comment_id": 55351390, "body": "<code>mmmmrrnzzz 4 mmrz</code> What does means <code>4</code>? if is because of the presence of 4M like <code>mmmm</code>, then what is <code>rz</code> in this story. Please edit your question"}, {"owner": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447888187, "post_id": 33792106, "comment_id": 55351431, "body": "I really dont know what you&#39;re talkin about Sir its just I am new to this language and I dont get how should I answer the program question."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 8677, "user_id": 2378910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c5516f058929cbdca03b0319e61bf8?s=128&d=identicon&r=PG", "display_name": "Kenney", "link": "https://stackoverflow.com/users/2378910/kenney"}, "edited": false, "score": 0, "creation_date": 1447888220, "post_id": 33792106, "comment_id": 55351448, "body": "@Kenney NO, i don&#39;t think he need the length of that string, he need to count letters which are repeating it self, or something like that."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447888261, "post_id": 33792106, "comment_id": 55351467, "body": "@PatrickVillanueva If you do not know what you exactly wont to do, how we can help you then ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1447888285, "post_id": 33792106, "comment_id": 55351481, "body": "@PatrickVillanueva You need to explain what the program is supposed to do. We can&#39;t tell just from the name &quot;character count&quot;. And we don&#39;t care about the other problems, take them out of the question."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447888384, "post_id": 33792106, "comment_id": 55351518, "body": "@PatrickVillanueva i think i understand your program logic. \u1e3eississipi` there are 2 <code>ss</code> + another 2 <code>ss</code> and + another 2 <code>pp</code> and you print <code>ssp</code> because are repeating itself."}, {"owner": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447888455, "post_id": 33792106, "comment_id": 55351550, "body": "Ohh sorry about that... I will try to understand it better than I did before."}, {"owner": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447888807, "post_id": 33792106, "comment_id": 55351683, "body": "I get it now the count you input is like finding for letters that repeats itself or double."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447889632, "post_id": 33792508, "comment_id": 55351962, "body": "I kind of get it but can I ask? What is the purpose of i-1 and found +1? I wanted to know what is its function so I can use it for the future activities like this."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447889941, "post_id": 33792508, "comment_id": 55352085, "body": "Because you need to check the last position with the actual one. If you do <code>if(str[i] == str[i])</code> you will get <code>isisipi</code> and this is not what you need."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "edited": false, "score": 0, "creation_date": 1447890037, "post_id": 33792508, "comment_id": 55352119, "body": "Same thing for <code>found = i-1;</code> remove that line and you will get <code>sssspp</code>"}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": true, "score": 0, "last_activity_date": 1447889245, "creation_date": 1447889245, "answer_id": 33792508, "question_id": 33792106, "link": "https://stackoverflow.com/questions/33792106/character-count-i-do-not-know-what-to-do-next/33792508#33792508", "title": "Character Count (I do not know what to do next)", "body": "<p>Based on your Question/comments, probably this should be what you need:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void){\n    char str[100] = \"Mississippi\";\n    int i, found = 0;\n\n    for(i = 1; str[i] != '\\0';i++){\n        if(str[i-1] == str[i]){\n            found = i-1;\n            found++;\n            while(1){\n                if(str[found] == str[found+1]){\n                    found++;\n                }else{\n                    break;\n                }\n            }\n\n            printf(\"%c\", str[i]);\n            i = found;\n        }\n    }\n\n    if(found == 0){\n        printf(\"No repeated character was Found\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>ssp</p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 5574631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934b24e911371da69d5a2da83f0ac542?s=128&d=identicon&r=PG&f=1", "display_name": "isuckateverything", "link": "https://stackoverflow.com/users/5574631/isuckateverything"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 33792508, "answer_count": 1, "score": -1, "last_activity_date": 1447889245, "creation_date": 1447887475, "last_edit_date": 1447888163, "question_id": 33792106, "link": "https://stackoverflow.com/questions/33792106/character-count-i-do-not-know-what-to-do-next", "title": "Character Count (I do not know what to do next)", "body": "<p>Okay so I got this activity to do and its called string concerto. I got the number 1 (reversing a string and turn vowels into an asterisk) but I cant answer number 2 its called character count.</p>\n\n<p>Its like this:</p>\n\n<pre><code>Sample Run:\nEnter string:   Mississippi\n3\nssp\n\nEnter string:   Committee\n3\nmte\n\nEnter string:   mmmmrrnzzz\n4\nmmrz\n</code></pre>\n\n<p>I do not know what to do next with my program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char str[100];\n    int count;\n    printf(\"Input a word: \");\n    gets(str);\n    printf(\"Count: \");\n    scanf(\"%d\", &amp;count);\n    for (str ; str &lt;= count ; str++)\n    {\n        blank space(dunno what to do)\n    }\n    printf(\"%s\",str[count]);\n    getch();\n}\n</code></pre>\n\n<p>What should I do? Should I use a string command?(I really don't know those things because the prof didn't haven't discussed it really good and she discussed arrays more.) </p>\n\n<p>Im on 1st yr college so we use c language and a new member here in stackoverflow so if I have any violations in this question please tell me about it so I can improve in asking here too and not being a nuisance in this website.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "edited": false, "score": 0, "creation_date": 1447887407, "post_id": 33792072, "comment_id": 55351117, "body": "This not a valid C++ code."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1447887416, "post_id": 33792072, "comment_id": 55351120, "body": "This is not part of C++."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1447887460, "post_id": 33792072, "comment_id": 55351142, "body": "@BaummitAugen IMHO this is arguable since the OP uses input/output streams which they&#39;re not C either."}, {"owner": {"reputation": 4567, "user_id": 1320751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eee0011ba2ca995b31e464fc2e2ad885?s=128&d=identicon&r=PG", "display_name": "Anon Mail", "link": "https://stackoverflow.com/users/1320751/anon-mail"}, "edited": false, "score": 0, "creation_date": 1447887513, "post_id": 33792072, "comment_id": 55351165, "body": "What they are saying is variable length arrays are in standard C but an extension to standard C++."}, {"owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 1, "creation_date": 1447887531, "post_id": 33792072, "comment_id": 55351176, "body": "Duplicate: <a href=\"http://stackoverflow.com/a/737245/864696\">stackoverflow.com/a/737245/864696</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447887622, "post_id": 33792072, "comment_id": 55351207, "body": "<i>&quot;How does the compiler know what size to allocate to array A at compile time?&quot;</i> It doesn&#39;t, it generates code to allocate memory at run time."}, {"owner": {"reputation": 558, "user_id": 5403968, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b32bb8cb5029a32c6ee6fc71fe52453e?s=128&d=identicon&r=PG&f=1", "display_name": "Sashank", "link": "https://stackoverflow.com/users/5403968/sashank"}, "reply_to_user": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 0, "creation_date": 1447887709, "post_id": 33792072, "comment_id": 55351245, "body": "@RossPresser I know it is valid in C99. I want to know how the compiler implements it. I did not find it there."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447887732, "post_id": 33792072, "comment_id": 55351259, "body": "@Sashank the top answer there describes how the compiler implements it"}, {"owner": {"reputation": 558, "user_id": 5403968, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b32bb8cb5029a32c6ee6fc71fe52453e?s=128&d=identicon&r=PG&f=1", "display_name": "Sashank", "link": "https://stackoverflow.com/users/5403968/sashank"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447887838, "post_id": 33792072, "comment_id": 55351308, "body": "@WeatherVane At run time all the stack variables needs to have an address ri8! If compiler generates code to allocate memory at run time, what about other variables in the same scope and are declared after this?"}, {"owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 0, "creation_date": 1447887843, "post_id": 33792072, "comment_id": 55351310, "body": "From the answer I linked: &gt;&gt;gcc allocates the array on the stack, just like it does with int array[100] by just adjusting the stack pointer. &lt;&lt;  This means that the code emitted by gcc will compute the size needed to hold the array, and adjust the stack pointer by that amount."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447887930, "post_id": 33792072, "comment_id": 55351342, "body": "why don&#39;t you write some code and look at the assembly output to see for yourself? use <code>gcc -S</code> for example."}, {"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1447888120, "post_id": 33792072, "comment_id": 55351407, "body": "It doesn&#39;t.  It just generates code to subtract (add) a non-constant from the stack pointer; nothing exciting.  <code>clang -S</code> or <code>gcc -S</code> are a good way to see how it works."}], "owner": {"reputation": 558, "user_id": 5403968, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b32bb8cb5029a32c6ee6fc71fe52453e?s=128&d=identicon&r=PG&f=1", "display_name": "Sashank", "link": "https://stackoverflow.com/users/5403968/sashank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1447887697, "answer_count": 0, "score": 2, "last_activity_date": 1447887406, "creation_date": 1447887341, "last_edit_date": 1447887406, "question_id": 33792072, "link": "https://stackoverflow.com/questions/33792072/how-are-variable-length-arrays-allocated-in-c", "closed_reason": "Duplicate", "title": "How are variable length arrays allocated in C?", "body": "<p>My understanding is that, to allocate memory to a variable on stack, compiler needs to know its size during the compile time. In case of variable length arrays, as compiler can't figure out the size, I thought the memory is allocated in heap during run time. I printed the address to confirm this - </p>\n\n<pre><code>int main(){\n    int n;\n    cin&gt;&gt;n;\n    int A[n];\n    cout&lt;&lt; &amp;n &lt;&lt; \" \"&lt;&lt; A &lt;&lt;endl;\n}\n</code></pre>\n\n<p>The output is </p>\n\n<pre><code>0x7ffc663c9b2c 0x7ffc663c9ae0\n</code></pre>\n\n<p>They are close to each other => A is on stack. How does the compiler know what size to allocate to array A at compile time?</p>\n"}, {"tags": ["python", "c", "spi", "ioerror"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 5527382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f9e9e844ae401903171e1dc334c6a6?s=128&d=identicon&r=PG", "display_name": "Alex Hiam", "link": "https://stackoverflow.com/users/5527382/alex-hiam"}, "edited": false, "score": 0, "creation_date": 1448890834, "post_id": 33999484, "comment_id": 55755492, "body": "You can also find out the current max transfer size with <code>cat &#47;sys&#47;module&#47;spidev&#47;parameters&#47;bufsiz</code>"}, {"owner": {"reputation": 11, "user_id": 5578783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f45548190001285c2100457f1294a9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael L", "link": "https://stackoverflow.com/users/5578783/michael-l"}, "edited": false, "score": 0, "creation_date": 1449016311, "post_id": 33999484, "comment_id": 55821020, "body": "Hi Alex,  Thank you so much for this useful info!! however I do not have a file called /etc/modprobe.d/local.conf  =(  My modprobe.d folder contains: fbdev-blacklist.conf alsa-base-blacklist.conf alsa-base.conf 8192cu.conf 8188eu.conf  cat /sys/module/spidev/parameters/bufsiz does indeed return 4092...  What could you suggest I do to add that option?  I tried creating a local.conf file with the option you suggested but that did nothing.  Thanks Again"}, {"owner": {"reputation": 11, "user_id": 5578783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f45548190001285c2100457f1294a9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael L", "link": "https://stackoverflow.com/users/5578783/michael-l"}, "edited": false, "score": 0, "creation_date": 1449090516, "post_id": 33999484, "comment_id": 55860306, "body": "I found a solution that seems to work for me right now since I can&#39;t figure out how to add the &#39;options&#39; method described by Alex Haim.  Instead I wrote a bash script that edits the /sys/module/spidev/parameters/bufsiz file  <code>#!&#47;bin&#47;bash # Spi Bufsiz Script  cd &#47;sys&#47;module&#47;spidev&#47;parameters chmod 666 bufsiz echo 65534 &gt; bufsiz</code>"}], "tags": [], "owner": {"reputation": 241, "user_id": 5527382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f9e9e844ae401903171e1dc334c6a6?s=128&d=identicon&r=PG", "display_name": "Alex Hiam", "link": "https://stackoverflow.com/users/5527382/alex-hiam"}, "is_accepted": false, "score": 0, "last_activity_date": 1448896229, "last_edit_date": 1495542245, "creation_date": 1448889149, "answer_id": 33999484, "question_id": 33791995, "link": "https://stackoverflow.com/questions/33791995/python-ioerror-errno-90-message-too-long-passing-long-list-to-spi-function/33999484#33999484", "title": "Python IOError: [Errno 90] Message too long, Passing long list to SPI function", "body": "<p>Look in the notes in the Linux spidev docs - <a href=\"https://www.kernel.org/doc/Documentation/spi/spidev\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/Documentation/spi/spidev</a>:</p>\n\n<blockquote>\n<pre><code>- There's a limit on the number of bytes each I/O request can transfer\n  to the SPI device.  It defaults to one page, but that can be changed\n  using a module parameter.\n</code></pre>\n</blockquote>\n\n<p>(You can find out your page size with <code>$ getconf PAGESIZE</code> - I believe it's pretty much always 4096 bytes.)</p>\n\n<p>I haven't tested it, but I think Maxim's answer here should work for you: <a href=\"https://stackoverflow.com/a/16440226/5527382\">https://stackoverflow.com/a/16440226/5527382</a>, which is:</p>\n\n<blockquote>\n  <p>The solution is to add following lines to /etc/modprobe.d/local.conf:</p>\n  \n  <p><code>options spidev bufsiz=&lt;NEEDED BUFFER SIZE&gt;</code></p>\n</blockquote>\n\n<p>The spidev driver defaults to 4096 bytes, then overrides it with the value of that argument if it's provided - <a href=\"https://github.com/beagleboard/linux/blob/4.1/drivers/spi/spidev.c#L92-L94\" rel=\"nofollow noreferrer\">https://github.com/beagleboard/linux/blob/4.1/drivers/spi/spidev.c#L92-L94</a>:</p>\n\n<pre><code>static unsigned bufsiz = 4096;\nmodule_param(bufsiz, uint, S_IRUGO);\nMODULE_PARM_DESC(bufsiz, \"data bytes in biggest supported SPI message\");\n</code></pre>\n\n<p>Putting that line into <code>/etc/modprobe.d/local.conf</code> should pass that argument to the spidev module when it's loaded - you'll want to reboot after making the change to make sure you've reloaded it.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5578783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f45548190001285c2100457f1294a9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael L", "link": "https://stackoverflow.com/users/5578783/michael-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1449091836, "creation_date": 1449091836, "answer_id": 34053393, "question_id": 33791995, "link": "https://stackoverflow.com/questions/33791995/python-ioerror-errno-90-message-too-long-passing-long-list-to-spi-function/34053393#34053393", "title": "Python IOError: [Errno 90] Message too long, Passing long list to SPI function", "body": "<p>I found a solution that seems to work for me right now since I can't figure out how to add the 'options' method described by Alex Haim.  Instead I wrote a bash script that edits the /sys/module/spidev/parameters/bufsiz file</p>\n\n<pre><code>#!/bin/bash\n# Spi Bufsiz Script\n\ncd /sys/module/spidev/parameters\nchmod 666 bufsiz\necho 65534 &gt; bufsiz\n</code></pre>\n\n<p>This solution was found <a href=\"https://e2e.ti.com/support/arm/sitara_arm/f/791/t/343692\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 5578783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f45548190001285c2100457f1294a9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael L", "link": "https://stackoverflow.com/users/5578783/michael-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7080, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1611144350, "creation_date": 1447887064, "question_id": 33791995, "link": "https://stackoverflow.com/questions/33791995/python-ioerror-errno-90-message-too-long-passing-long-list-to-spi-function", "title": "Python IOError: [Errno 90] Message too long, Passing long list to SPI function", "body": "<p>I'm programming my <a href=\"https://www.olimex.com/Products/OLinuXino/A13/A13-OLinuXino-MICRO/open-source-hardware\" rel=\"nofollow\"> A13-OLinuXino-MICRO</a> using the provided <a href=\"https://pypi.python.org/pypi/pyA13\" rel=\"nofollow\">pyA13 0.2.2</a> SPI driver to send data to an LCD.  Ideally I would like to send a list containing 320*240*2 (320*240 pixel 16 bits per color) bytes to be written in one continuous write command to be speed efficient.  The drivers in spi.c and spi_lib.c had an 8bit tx_len which limited me to 256 bytes so I modified them to 32bit which worked but now I receive an error when I try to pass a list that is more than 4096 values long in my spi.write(data[:]) function.  Below is the code I'm using to fill the screen with a solid color that is 16 bits:</p>\n\n<pre><code>def FillScreen(c):\n    LCD_SetPos(0, 0, 239, 319)\n    ch = c&gt;&gt;8 &amp; 0x00FF\n    cl = c &amp; 0x00FF\n    d =[]\n    for x in range (0,76800):\n        d += [ch, cl]\n   spi.write(d[:])\n</code></pre>\n\n<p>This is the error I get when I run the function:</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"lcd.py\", line 205, in &lt;module&gt;\n    FillScreen(0x00FF)\n  File \"lcd.py\", line 200, in FillScreen\n    spi.write(d[:])\nIOError: [Errno 90] Message too long\n</code></pre>\n\n<p>The piece of code that is giving me this error is contained in spi.c</p>\n\n<pre><code>/* Send data */\n    if(spi_write(fd, tx_buffer, tx_len) &lt; 0){\n        return PyErr_SetFromErrno(PyExc_IOError);\n    }\n</code></pre>\n\n<p>Is there any way that I can pass a longer message to the spi.write function?  I'm very new to python but quite comfortable with C, go easy on my code please... Also, I have tried looping smaller messages to fill the screen but that takes too long.  Any help would be appreciated.</p>\n\n<p>Thanks,\nMichael</p>\n"}, {"tags": ["c", "parsing", "io"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1447886772, "post_id": 33791865, "comment_id": 55350883, "body": "<code>fflush(stdout);</code> after the first <code>printf()</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1447886786, "post_id": 33791865, "comment_id": 55350891, "body": "<code>int c;</code> --&gt; <code>char c</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447886786, "post_id": 33791865, "comment_id": 55350892, "body": "<code>c</code> is an <code>int</code> which is probably 4 bytes, but you are reading only 1 byte. This leaves <code>c</code> consisting of 3 uninitialized bytes.  To fix this just make <code>c</code> be a <code>char</code> in the first place."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447886840, "post_id": 33791865, "comment_id": 55350917, "body": "You <i>could</i> replace <code>(unsigned char)c</code> with <code>*(char *)&amp;c</code> although that is silly compared to the more obvious solution of using a char in the first place"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447886855, "post_id": 33791865, "comment_id": 55350922, "body": "@M.M  Same idea about <code>char c</code> within &lt; 1 second of each other!"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447886941, "post_id": 33791865, "comment_id": 55350948, "body": "@M.M: True, but most systems today are little-endian, so changing <code>int</code> to <code>char</code> wouldn&#39;t actually make a difference."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1447887265, "post_id": 33791865, "comment_id": 55351054, "body": "I think there are more embedded ARM devices (e.g. smartphones) around than there are x86-like PCs. In any case that&#39;s no justification for having broken code"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447887308, "post_id": 33791865, "comment_id": 55351070, "body": "re. <code>.&#47;myprogram.o</code>, typically the <code>.o</code> file extension would be used for object files, not executables"}, {"owner": {"reputation": 606, "user_id": 3106912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/acOpL.jpg?s=128&g=1", "display_name": "FrankM", "link": "https://stackoverflow.com/users/3106912/frankm"}, "edited": false, "score": 1, "creation_date": 1447887322, "post_id": 33791865, "comment_id": 55351076, "body": "I counted as many YES as there are y in the input. Seems like it&#39;s doing what it should. Not sure what the code before this is but most of the input is ending up in the read command that will loop until it hits the EOF."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447887385, "post_id": 33791865, "comment_id": 55351107, "body": "anyway - the call to <code>read</code> will read any bytes which have been input yet but not previously read. You described that this was your exact situation.  If you don&#39;t want this behaviour you will have to insert code that reads and discards any previously-entered characters, before entering this loop"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447887436, "post_id": 33791865, "comment_id": 55351130, "body": "@M.M: I&#39;m with you, the code <i>should</i> be fixed. <i>But</i>! This question is about <i>specific</i> behavior of a <i>specific</i> program. The textual input suggests a keyboard as I/O, which makes x86 more likely than ARM. Also, <code>read()</code> takes a <code>void*</code>, so passing an <code>int*</code> is fine."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 606, "user_id": 3106912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/acOpL.jpg?s=128&g=1", "display_name": "FrankM", "link": "https://stackoverflow.com/users/3106912/frankm"}, "edited": false, "score": 0, "creation_date": 1447887455, "post_id": 33791865, "comment_id": 55351140, "body": "@FrankM Good eye.  8 <code>&#39;y&#39;</code> and 8 <code>&quot;Yes&quot;</code>.  does exactly as OP&#39;s code directs."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1447887499, "post_id": 33791865, "comment_id": 55351159, "body": "@EOF the call to <code>read</code> is correct , the problem is <code>(unsigned char)c</code> afterwards (which, as you point out, might appear to work correctly due to implementation details)"}, {"owner": {"reputation": 606, "user_id": 3106912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/acOpL.jpg?s=128&g=1", "display_name": "FrankM", "link": "https://stackoverflow.com/users/3106912/frankm"}, "edited": false, "score": 0, "creation_date": 1447887526, "post_id": 33791865, "comment_id": 55351172, "body": "If you just want to consider first character you get you must not read in a loop."}, {"owner": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "edited": false, "score": 0, "creation_date": 1447887653, "post_id": 33791865, "comment_id": 55351218, "body": "Ok, I added a fflush(stdin) and changed the int to char, but it doesn&#39;t make a difference. I also isolated the code in its own program without any other code. Its freaking me out."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1447887813, "post_id": 33791865, "comment_id": 55351298, "body": "@Test, nobody suggested <code>fflush(stdin)</code>.  <code>fflush(stdout)</code> was suggested.  (Attention to detail)  See <a href=\"http://stackoverflow.com/questions/33791865/c-printf-read-collission#comment55350883_33791865\">comment</a>"}, {"owner": {"reputation": 606, "user_id": 3106912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/acOpL.jpg?s=128&g=1", "display_name": "FrankM", "link": "https://stackoverflow.com/users/3106912/frankm"}, "edited": false, "score": 0, "creation_date": 1447887851, "post_id": 33791865, "comment_id": 55351312, "body": "flush(stdin) does not have a well defined behaviour. flush(stdout) should make the printf be flushed to the screen. If this is all the code that is running that should make the printed text show up before you start typing"}, {"owner": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "edited": false, "score": 0, "creation_date": 1447887963, "post_id": 33791865, "comment_id": 55351354, "body": "Oh, I&#39;m sorry fflush(stdout) fixed the problem with the warning message not being printed before reading, but the &quot;YES&quot;s are still printed AFTER everything is read."}, {"owner": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "edited": false, "score": 0, "creation_date": 1447888037, "post_id": 33791865, "comment_id": 55351377, "body": "Update 2.0: If I change the &#39;printf(&quot;YES&quot;);&#39; to &#39;return 0&#39; (in main). Than the program returns after the first newline, not the first end-of-file."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "edited": false, "score": 0, "creation_date": 1447888186, "post_id": 33792261, "comment_id": 55351430, "body": "That fixed the problem with the warning not being printed before reading, but &quot;Yes&quot; is still not printed after a &#39;y&#39;+newline."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "edited": false, "score": 0, "creation_date": 1447888262, "post_id": 33792261, "comment_id": 55351469, "body": "@Test, Did you add <i>both</i> <code>fflush(stdout)</code>? (Attention to detail)"}, {"owner": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "edited": false, "score": 0, "creation_date": 1447888521, "post_id": 33792261, "comment_id": 55351573, "body": "Now it works actually you didn&#39;t edited your answer yet, when I wrote the comment and tried it in the meantime. Thank you!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "edited": false, "score": 0, "creation_date": 1447888957, "post_id": 33792261, "comment_id": 55351727, "body": "@Test The <i>initial</i> edit said &quot;To force output to occur before the next line of code add &#39;\\n&#39; to the output or use fflush(stdout).&quot;  That applied to <code>printf(&quot;WARNING: ....</code>, as you tried  and to <code>printf(&quot;YES&quot;);</code> which is the same problem just solved.  <a href=\"https://www.youtube.com/watch?v=eGblsNXkJog\" rel=\"nofollow noreferrer\">patience grasshopper</a>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1447888215, "last_edit_date": 1447888215, "creation_date": 1447888091, "answer_id": 33792261, "question_id": 33791865, "link": "https://stackoverflow.com/questions/33791865/c-printf-read-collission/33792261#33792261", "title": "C printf/read Collission", "body": "<p><code>stdout</code> is often <em>line</em> buffered.  To force output to occur before the next line of code add <code>'\\n'</code> to the output or use <code>fflush(stdout)</code>.</p>\n\n<p>Also change <code>int c</code> to <code>char c</code> to properly read data into <code>c</code>.</p>\n\n<pre><code>printf(\"WARNING: THE USER INPUT WILL OVERWRITE THE FILE \\\"%s\\\". ARE YOU SURE? [Y/N] \", \n    output_file_name);\nfflush(stdout); // *****\n// int c;\nchar c;\n\nwhile(read(0, &amp;c, 1) == 1) {\n    if (((unsigned char) c) == 'y') {\n      printf(\"YES\");\n      fflush(stdout); // *****\n    ]\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5578765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f9de8efb8956813f0a210819acf91?s=128&d=identicon&r=PG&f=1", "display_name": "Test", "link": "https://stackoverflow.com/users/5578765/test"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 33792261, "answer_count": 1, "score": 0, "last_activity_date": 1447888215, "creation_date": 1447886517, "last_edit_date": 1592644375, "question_id": 33791865, "link": "https://stackoverflow.com/questions/33791865/c-printf-read-collission", "title": "C printf/read Collission", "body": "<p>I'm currently trying to get this piece of code working:</p>\n<pre><code>//TODO THIS IS NOT WORKING\nprintf(&quot;WARNING: THE USER INPUT WILL OVERWRITE THE FILE \\&quot;%s\\&quot;. ARE YOU SURE? [Y/N] &quot;, output_file_name);\nint c;\n\nwhile(read(0, &amp;c, 1) == 1) {\n    if (((unsigned char) c) == 'y')\n        printf(&quot;YES&quot;);\n}\n</code></pre>\n<p><strong>What I'm expecting the code to do:</strong>\nI was expecting to get the text</p>\n<p><em><strong>WARNING: THE USER INPUT WILL OVERWRITE THE FILE &quot;FILENAME&quot;. ARE YOU SURE? [Y/N]</strong></em></p>\n<p>printed in the command line. And to be able to write something, after pressing <em>enter</em> I expect to see the text <em><strong>YES</strong></em> printed as many times as given 'y's in the previous input. Instead this is what I get:</p>\n<pre><code>./myprogram.o\nI type things.\nIncluding yyyy\nydkfasjf\nyay\nNow I'm tired and will press ctrl+d to write EOF to stdin...\nWARNING: THE USER INPUT WILL OVERWRITE THE FILE &quot;FILENAME&quot;. ARE YOU SURE? [Y/N]YESYESYESYESYESYESYESYES\nMatthias@BASH ~/folder/\n</code></pre>\n<p>What is happening here? I think that somehow the printf and read functions collide... Can someone please enlighten me?</p>\n"}, {"tags": ["c", "parameters", "out"], "comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 4, "creation_date": 1447885715, "post_id": 33791657, "comment_id": 55350444, "body": "<code>&amp;*x = x</code>; it&#39;s redundant. Please create an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 93, "user_id": 1559427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5969e9cdba1ee1d305f172be5fb3c5?s=128&d=identicon&r=PG", "display_name": "fyeth fyeth", "link": "https://stackoverflow.com/users/1559427/fyeth-fyeth"}, "reply_to_user": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1447886493, "post_id": 33791657, "comment_id": 55350773, "body": "what&#39;s the reason for the negative votes?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1447892405, "post_id": 33791657, "comment_id": 55352959, "body": "How do you define <code>sort</code>?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1447892652, "post_id": 33791657, "comment_id": 55353034, "body": "<code>&amp;*E</code> is equivalent to <code>E</code> (N1256 6.5.3.2 Address and indirection operators footnote 87), so you can use <code>head</code> and <code>tail</code> instead of <code>&amp;*head</code> and <code>&amp;*tail</code>."}], "answers": [{"comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1447892738, "post_id": 33793009, "comment_id": 55353066, "body": "<code>&amp;*E</code> is equivalent to <code>E</code> (N1256 6.5.3.2 Address and indirection operators footnote 87), so you cab use <code>head</code> and <code>tail</code> instead of <code>&amp;*head</code> and <code>&amp;*tail</code>."}], "tags": [], "owner": {"reputation": 93, "user_id": 1559427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5969e9cdba1ee1d305f172be5fb3c5?s=128&d=identicon&r=PG", "display_name": "fyeth fyeth", "link": "https://stackoverflow.com/users/1559427/fyeth-fyeth"}, "is_accepted": false, "score": 0, "last_activity_date": 1447891908, "creation_date": 1447891908, "answer_id": 33793009, "question_id": 33791657, "link": "https://stackoverflow.com/questions/33791657/passing-out-parameters-in-different-level-of-functions/33793009#33793009", "title": "passing out parameters in different level of functions", "body": "<p>Re-passing the out parameters to another function is adding \"&amp;\" again and again.\nexiting display will make head and tail variable reflect the changes made on the other functions. Not sure if its the best way but it is working.</p>\n\n<p>Ex.</p>\n\n<pre><code>display(&amp;head, &amp;tail);\n\nvoid display(myrec **head, myrec **tail) {\nsort(&amp;*head, &amp;*tail)\n}\n\nvoid sort(myrec **head, myrec **tail) {\nswap(&amp;*head, &amp;*tail)\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 1559427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5969e9cdba1ee1d305f172be5fb3c5?s=128&d=identicon&r=PG", "display_name": "fyeth fyeth", "link": "https://stackoverflow.com/users/1559427/fyeth-fyeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1447891908, "creation_date": 1447885615, "last_edit_date": 1447886653, "question_id": 33791657, "link": "https://stackoverflow.com/questions/33791657/passing-out-parameters-in-different-level-of-functions", "title": "passing out parameters in different level of functions", "body": "<p>I have <strong>linklist</strong> c-program which is working correctly, but a late requirement was that no global variables must be use. So I had to redesigned everything to avoid passing out parameters, but there are parts which is hard to redesign and some of the functions are calling functions and another functions, one example is on the display.</p>\n\n<pre><code>int main() {\n        display(&amp;head, &amp;tail);\n}\n\nvoid display(myrec **head, myrec **tail) {\n        sort(&amp;*head, &amp;*tail)\n        then sort again call function swap\n}\n</code></pre>\n\n<p>My question is how to correctly pass out parameters multiple times. Program is not working correct using sort(&amp;*head, &amp;*tail), there is no syntax error but there are now missing entries on the data. I tried to code everything on the display function just to check and it does, so I am guessing that I am doing something wrong in passing the variables. thanks.</p>\n\n<p>Its not recursion, the head and tail are variables that holds the state of the linklist, so in swap it is change, I also need to reflect the changes to the root caller and other part of the program need the new state of the head and tail.</p>\n"}, {"tags": ["c++", "c", "visual-studio", "visual-studio-2010", "compilation"], "comments": [{"owner": {"reputation": 3477, "user_id": 5373104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7370abc4cc61836c6302fc38b73a75fb?s=128&d=identicon&r=PG", "display_name": "Jared Dykstra", "link": "https://stackoverflow.com/users/5373104/jared-dykstra"}, "edited": false, "score": 0, "creation_date": 1447885845, "post_id": 33791546, "comment_id": 55350498, "body": "Looks like C99&#39;s Variable length array support was never supported by Visual Studio; not even in VS 2010 - <a href=\"https://msdn.microsoft.com/library/zb1574zs(v=vs.100).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/library/zb1574zs(v=vs.100).aspx</a>  So you have to edit the code, or use a different compiler"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1447885847, "post_id": 33791546, "comment_id": 55350499, "body": "Sample: Line 145 <code>int maxima[numMax];</code> numMax is not a constant, making this not standard compliant C++. Visual Studio adheres to this part of the standard, so you are SOL, dude. Much re-writing of code will be required to make this work under Visual Studio (and a lot of other C++ compilers)"}, {"owner": {"reputation": 3477, "user_id": 5373104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7370abc4cc61836c6302fc38b73a75fb?s=128&d=identicon&r=PG", "display_name": "Jared Dykstra", "link": "https://stackoverflow.com/users/5373104/jared-dykstra"}, "edited": false, "score": 0, "creation_date": 1447886249, "post_id": 33791546, "comment_id": 55350661, "body": "Have you tried using CMake and selecting mingw as the compiler, since you went through the trouble of installing it?"}, {"owner": {"reputation": 3415, "user_id": 1198474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/pUCYm.jpg?s=128&g=1", "display_name": "salocinx", "link": "https://stackoverflow.com/users/1198474/salocinx"}, "edited": false, "score": 0, "creation_date": 1447886344, "post_id": 33791546, "comment_id": 55350708, "body": "Thanks for the fast replies. I am basically not bound to Visual Studio. So let me try with the mingw compiler... I will be back right after the attempt."}, {"owner": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1447886413, "post_id": 33791546, "comment_id": 55350735, "body": "You might consider using Visual Studio&#39;s C++ compiler, it&#39;s (mostly) backward compatible with C.  All you have to do is rename the files from .c to .cpp"}], "owner": {"reputation": 3415, "user_id": 1198474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/pUCYm.jpg?s=128&g=1", "display_name": "salocinx", "link": "https://stackoverflow.com/users/1198474/salocinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447886978, "creation_date": 1447885135, "last_edit_date": 1447886978, "question_id": 33791546, "link": "https://stackoverflow.com/questions/33791546/how-to-compile-a-c-program-with-visual-studio-on-windows", "title": "How to compile a C program with Visual Studio on Windows?", "body": "<p>I am trying to compile a library for 2D localization called <strong>libdots</strong> <a href=\"http://chili.epfl.ch/libdots\" rel=\"nofollow noreferrer\">which can be found on this website</a> with Visual Studio 2015 on Windows for x86 or x64.</p>\n\n<p>The following is stated in the readme file of the lib:</p>\n\n<blockquote>\n  <p>It is written in pure c and has no external library dependencies other\n  than 'libc'.</p>\n</blockquote>\n\n<p>What I have done so far:</p>\n\n<ul>\n<li>Installed <a href=\"http://opencv.org/downloads.html\" rel=\"nofollow noreferrer\">OpenCV 3.0.0</a> to C:/opencv</li>\n<li>Installed <a href=\"https://cmake.org/runningcmake/\" rel=\"nofollow noreferrer\">CMake for Windows</a></li>\n<li>Installed <a href=\"http://www.mingw.org/\" rel=\"nofollow noreferrer\">MinGW</a></li>\n</ul>\n\n<p>Set the following <code>System Environment Variable</code>:</p>\n\n<pre><code>OPENCV_DIR    C:\\opencv\\build\\x86\\vc12\n</code></pre>\n\n<p>Added the following to the <code>Path</code> variable in Windows settings:</p>\n\n<pre><code>%OPENCV_DIR%;\nC:\\opencv\\build\\x86\\vc12\\lib;\nC:\\opencv\\build\\include;\nC:\\opencv\\build\\include\\opencv;\nC:\\opencv\\build\\include\\opencv2\n</code></pre>\n\n<p>Then I configured and generated the Makefile with cmake-gui and selected <code>Visual Studio 14 2015</code> generator with \"Use default native compilers\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/VQBgI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VQBgI.png\" alt=\"enter image description here\"></a></p>\n\n<p>This produced a Visual Studio Solution file (*.sln). Opening this file shows me the complete C project in the IDE. But when trying to build the project, I get the following errors:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WfOay.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WfOay.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does somebody have a hint how to proceed and/or solve these issues?</p>\n"}, {"tags": ["c", "linux", "file"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1447884520, "post_id": 33791339, "comment_id": 55349883, "body": "Think logically about it. You can use <code>fwrite</code> to write a buffer of a size of your choosing instead of just one character. <b>See the documentation.</b> So you could declare a buffer of, say, <code>1,024</code> bytes (1K) and fill it with what data you wish. Then tell <code>fwrite</code> you want to write it <code>1,024</code> times. That&#39;s 1MB."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1447884560, "post_id": 33791339, "comment_id": 55349901, "body": "Add a check to make sure that <code>fopen</code> was successful. <code>if ( fp != NULL ) { ... }</code>."}], "answers": [{"tags": [], "owner": {"reputation": 91305, "user_id": 19410, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/175f1d55c73ce5cb1d071dc4d0f1a333?s=128&d=identicon&r=PG", "display_name": "Alex Reynolds", "link": "https://stackoverflow.com/users/19410/alex-reynolds"}, "is_accepted": false, "score": 5, "last_activity_date": 1447890045, "last_edit_date": 1447890045, "creation_date": 1447884621, "answer_id": 33791422, "question_id": 33791339, "link": "https://stackoverflow.com/questions/33791339/on-linux-in-c-how-to-generate-file-of-size-x/33791422#33791422", "title": "On linux in C how to generate file of size X?", "body": "<p>If you compile with warnings, you get a hint as to the exact problem:</p>\n\n<pre><code>test.c:3:5: warning: second argument of \u2018main\u2019 should be \u2018char **\u2019 [-Wmain]\n int main (int argc, char *argv) {\n     ^\n</code></pre>\n\n<p>All your troubles start downstream of this error. Fix this argument, and your code will work.</p>\n\n<p>In the future, get into the habit of compiling with warnings turned on:</p>\n\n<pre><code>$ gcc -Wall foo.c\n...\n</code></pre>\n\n<p>This will help catch typos and other oddities that will cause problems.</p>\n"}, {"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1447886367, "post_id": 33791762, "comment_id": 55350719, "body": "If you only ever need to create a regular file than a single <code>write</code> instead of <code>writen</code> should do it or else it&#39;s an error. <code>writen</code> is only needed to ensure correct behavior for special output files like sockets and pipes."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1447886083, "creation_date": 1447886083, "answer_id": 33791762, "question_id": 33791339, "link": "https://stackoverflow.com/questions/33791339/on-linux-in-c-how-to-generate-file-of-size-x/33791762#33791762", "title": "On linux in C how to generate file of size X?", "body": "<p>Since you tagged it Linux, this is how you can do it with the system-level functions (this should be a correct, most efficient way to do it):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sysexits.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n\nssize_t             /* Write \"n\" bytes to a descriptor  */\nwriten(int fd, const void *ptr, size_t n);\n\nint \nmain (int argc, char** argv) {\n  char buf[1000];\n  memset(buf, 'A', sizeof(buf));\n  int fd;\n  if((fd = open(argv[1], O_WRONLY|O_CREAT, 0666))&lt;0){\n    perror(argv[1]);\n    exit(EX_NOPERM);\n  }\n  ssize_t left = writen(fd, buf, sizeof(buf));\n  if(left) \n    perror(\"write error\\n\"); \n  return !!left;\n}\n\nssize_t             /* Write \"n\" bytes to a descriptor  */\nwriten(int fd, const void *ptr, size_t n) {\n  size_t        nleft;\n  ssize_t       nwritten;\n\n  nleft = n;\n  while (nleft &gt; 0) {\n    if ((nwritten = write(fd, ptr, nleft)) &lt; 0) {\n      if (nleft == n)\n        return(-1); /* error, return -1 */\n      else\n        break;      /* error, return amount written so far */\n    } else if (nwritten == 0) {\n      break;\n    }\n    nleft -= nwritten;\n    ptr   += nwritten;\n  }\n  return(n - nleft);      /* return &gt;= 0 */\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "edited": false, "score": 0, "creation_date": 1447889654, "post_id": 33792000, "comment_id": 55351969, "body": "This helped a lot.  I was wondering would you be able to show me how to implement my own cp command in c code? I want to create a buffer variable, read in X bytes from file1, and write X bytes to file2. And keep doing this until EOF of file1 is reached.  I am doing this to test how different buffer sizes effect performance but my C skills are terrible."}], "tags": [], "owner": {"reputation": 46, "user_id": 3992973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a304d20d741e8120ffc1a50452b866e3?s=128&d=identicon&r=PG&f=1", "display_name": "ApprenticeTheSecond", "link": "https://stackoverflow.com/users/3992973/apprenticethesecond"}, "is_accepted": false, "score": 0, "last_activity_date": 1447887074, "creation_date": 1447887074, "answer_id": 33792000, "question_id": 33791339, "link": "https://stackoverflow.com/questions/33791339/on-linux-in-c-how-to-generate-file-of-size-x/33792000#33792000", "title": "On linux in C how to generate file of size X?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SIZE_OF_FILE  1024\n\nint main(int argc, char *argv[])\n{\n     FILE *fdest;\n     char ch = '\\n';\n\n     if(argc != 2)\n          exit(EXIT_FAILURE);\n\n     fdest = fopen(argv[1], \"wb\");\n     if (fdest == NULL)\n          exit(EXIT_FAILURE);\n\n     fseek(fdest, SIZE_OF_FILE - 1, SEEK_CUR);\n     fwrite(&amp;ch, sizeof(char), 1, fdest);\n\n     fclose(fdest);\n\n\n     return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>In essence creating a 1kb file</p>\n</blockquote>\n\n<p>if the only purpose is creating a file with sizeof x, it is more simple i belive. </p>\n"}], "owner": {"reputation": 145, "user_id": 5562327, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/36f4a2cdb2a0ea2cb04673f18009f8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mkey", "link": "https://stackoverflow.com/users/5562327/mkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1447890045, "creation_date": 1447884292, "last_edit_date": 1447886269, "question_id": 33791339, "link": "https://stackoverflow.com/questions/33791339/on-linux-in-c-how-to-generate-file-of-size-x", "title": "On linux in C how to generate file of size X?", "body": "<p>So I want to make a file named genData.c that when executed for example: ./genData filename.txt       will write 1 character to that file 1000 times.</p>\n\n<p>In essence creating a 1kb file. \nI would like to be able to modify the for loop, say 100000 times, to generate a 1MB file and so on. </p>\n\n<p>Here is what I have tried and it compiles but when executed causes a segmentation fault. </p>\n\n<p>Any suggestions? Sorry C is a language I've never dabbled in.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (int argc, char *argv) {\n    char ch = 'A';\n    FILE *fp;\n    fp = fopen(argv[1], \"wb\");\n    int i;\n\n    for (i = 0; i &lt; 1000; i++) {\n        fwrite(&amp;ch, sizeof(char), 1, fp);\n    }\n\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1447884484, "post_id": 33791325, "comment_id": 55349868, "body": "Why are you passing the addresses of <code>x</code> and <code>y</code>? You only need to pass an address if you need to modify the parameter, so only <code>z</code> needs to be an address."}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3857250, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c603a09e908db2b2ddb53c59343fccc7?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan Scott", "link": "https://stackoverflow.com/users/3857250/johnathan-scott"}, "edited": false, "score": 0, "creation_date": 1447884416, "post_id": 33791355, "comment_id": 55349825, "body": "WOW well that was way easier than I expected! Thank you!"}], "tags": [], "owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "is_accepted": true, "score": 2, "last_activity_date": 1447884348, "creation_date": 1447884348, "answer_id": 33791355, "question_id": 33791325, "link": "https://stackoverflow.com/questions/33791325/using-pointers-in-c-programming/33791355#33791355", "title": "Using pointers in C programming?", "body": "<p>when you pass things by pointer, if you want to get to the values, you need to do </p>\n\n<pre><code>(*x &gt; *y)\n</code></pre>\n\n<p>Which gets the value pointed at by the pointer. (x and y are pointers, so they are going to contain memory addresses of the where the values are stored)</p>\n"}, {"tags": [], "owner": {"reputation": 1192, "user_id": 5203926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIMga.png?s=128&g=1", "display_name": "kcraigie", "link": "https://stackoverflow.com/users/5203926/kcraigie"}, "is_accepted": false, "score": 2, "last_activity_date": 1447884410, "creation_date": 1447884410, "answer_id": 33791368, "question_id": 33791325, "link": "https://stackoverflow.com/questions/33791325/using-pointers-in-c-programming/33791368#33791368", "title": "Using pointers in C programming?", "body": "<p>Needs to be:</p>\n\n<pre><code>if (*x &gt; *y) {\n    *z = *x;\n}\nelse if (*y &gt; *x){\n    *z = *y;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11059, "user_id": 1828684, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7edf260264d7b29154a3eef9ed0cf9f2?s=128&d=identicon&r=PG", "display_name": "mohkhan", "link": "https://stackoverflow.com/users/1828684/mohkhan"}, "is_accepted": false, "score": 2, "last_activity_date": 1447884442, "creation_date": 1447884442, "answer_id": 33791374, "question_id": 33791325, "link": "https://stackoverflow.com/questions/33791325/using-pointers-in-c-programming/33791374#33791374", "title": "Using pointers in C programming?", "body": "<p>You are comparing pointer addresses. You should de-reference the pointers for comparisons and assignments.</p>\n\n<pre><code>void max(int* x, int* y, int* z)\n{\n\n    if (*x &gt; *y) {\n        *z = *x;\n    }\n    else if (*y &gt; *x){\n        *z = *y;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 3, "last_activity_date": 1447885500, "creation_date": 1447885500, "answer_id": 33791631, "question_id": 33791325, "link": "https://stackoverflow.com/questions/33791325/using-pointers-in-c-programming/33791631#33791631", "title": "Using pointers in C programming?", "body": "<p>As you probably already know, a pointer is a variable which contains the address in memory of another variable. </p>\n\n<p>To access that memory we use The Unary operator <code>&amp;</code> which gives us the <code>address of a variable</code>.</p>\n\n<p>But accessing that memory is not all what a Pointer can do, we can with that pointer modify the value of that variable where the pointer points to.\nFor that we need to supply <code>*</code> to that pointer like this <code>*ptr</code>.</p>\n\n<p>Let's take a look at the following program:</p>\n\n<pre><code>#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n\nint main(void){\n\n    int a = 5;\n    int b = 10;\n\n    printf(\"A = %d\\nB = %d\\n\\n\\n\",a,b);\n\n    int *pa = &amp;a;\n    int *pb = &amp;b;\n\n    *pa = 50;\n    *pb = 100;\n\n    printf(\"A = %d\\nB = %d\\n*PA = %d\\n*PB = %d\\n\",a,b,*pa,*pb);\n\n    return 0;\n}\n</code></pre>\n\n<p>The output will be:</p>\n\n<blockquote>\n<pre><code>A = 5\nB = 10\n</code></pre>\n</blockquote>\n\n<pre><code>A = 50\nB = 100\n*PA = 50\n*PB = 100\n</code></pre>\n\n<p>As you can see <code>A</code> and <code>B</code> got new values. I hope you understand that.</p>\n"}], "owner": {"reputation": 273, "user_id": 3857250, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c603a09e908db2b2ddb53c59343fccc7?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan Scott", "link": "https://stackoverflow.com/users/3857250/johnathan-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 33791355, "answer_count": 4, "score": 0, "last_activity_date": 1447885500, "creation_date": 1447884233, "question_id": 33791325, "link": "https://stackoverflow.com/questions/33791325/using-pointers-in-c-programming", "title": "Using pointers in C programming?", "body": "<p>Right now I'm working on a program in C that takes 3 parameters; the address of a \"first\" integer, address of the \"second\" integer and the address in which to store the maximum of the two integers. So far I have the following basic code: </p>\n\n<pre><code>void max(int* x, int* y, int* z)\n{\n\n    if (x &gt; y) {\n        z = x;\n    }\n    else if (y &gt; x){\n        z = y;\n    }\n}\n\nint main()\n{\n    int x = 6;\n    int y = 4;\n    int z;\n    max(&amp;x, &amp;y, &amp;z);\n    printf(\"max of %d and %d = %d\\n\", x, y, z);\n\n    x = 12;\n    y = 17;\n    max(&amp;x, &amp;y, &amp;x);\n    printf(\"x = %d, y = %d\\n\", x, y);\n}\n</code></pre>\n\n<p>When executed it outputs the following:</p>\n\n<pre><code>max of 6 and 4 = 32767\nx = 12, y = 17\n</code></pre>\n\n<p>HOWEVER! I want it to output this instead:</p>\n\n<pre><code>max of 6 and 4 = 6\nx = 17, y = 17\n</code></pre>\n\n<p>I'm not sure where I'm going wrong in my <code>max</code> function. Z should not be so huge and in the second print statement <code>x</code> should equal <code>y</code>. Any help is greatly appreciated, thanks!</p>\n"}, {"tags": ["c", "memory-management", "segmentation-fault", "mmap"], "comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 2, "creation_date": 1447884290, "post_id": 33791310, "comment_id": 55349748, "body": "Your code is not valid C. Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1447884606, "post_id": 33791310, "comment_id": 55349929, "body": "<code>0xffffffff</code> is probably <code>MAP_FAILED</code>, which means it got an error. <code>errno</code> will contain the reason."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1447884740, "post_id": 33791310, "comment_id": 55349989, "body": "What is <code>-1 0</code> at the end of the <code>MMAP</code> call? There should be a comma between the parameters."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1447884797, "post_id": 33791310, "comment_id": 55350018, "body": "It doesn&#39;t make sense to have both <code>MAP_ANONYMOUS</code> and <code>MAP_FILE</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1447884843, "post_id": 33791310, "comment_id": 55350039, "body": "What is the <code>MMAP</code> function? The standard function is <code>mmap</code>, lowercase."}, {"owner": {"reputation": 1911, "user_id": 5018771, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6dec254b17d75df0cfa8c42806cfca3f?s=128&d=identicon&r=PG&f=1", "display_name": "AdrienW", "link": "https://stackoverflow.com/users/5018771/adrienw"}, "edited": false, "score": 0, "creation_date": 1447884908, "post_id": 33791310, "comment_id": 55350070, "body": "Copy-paste errors ? Please edit !"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1447885488, "post_id": 33791310, "comment_id": 55350349, "body": "Camel case is bad enough, but all-caps variable names?  Gah!  Have a scrap of decency, man!"}, {"owner": {"reputation": 4826, "user_id": 5578655, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/MSqGy.png?s=128&g=1", "display_name": "Alexi Coard", "link": "https://stackoverflow.com/users/5578655/alexi-coard"}, "edited": false, "score": 0, "creation_date": 1447885581, "post_id": 33791310, "comment_id": 55350387, "body": "it is CAPS variable because it is global variables, i just don&#39;t put my whole code ;)"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1447885894, "post_id": 33791310, "comment_id": 55350522, "body": "Your question is quite unclear. Please post an MCVE as requested. For example, &quot;when I call Mem_Init it returns me an adress like 0xbcfd210 which is something ok, but when I call it while in the Mem_Alloc method mmap returns me 0xffffffff&quot;. That doesn&#39;t really make sense. The only place that calls <code>mmap</code> shown is <code>Mem_Init</code>. So what do you mean exactly by some calls fail and some calls don&#39;t? Show those exact calls in your code."}, {"owner": {"reputation": 4826, "user_id": 5578655, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/MSqGy.png?s=128&g=1", "display_name": "Alexi Coard", "link": "https://stackoverflow.com/users/5578655/alexi-coard"}, "edited": false, "score": 0, "creation_date": 1447886769, "post_id": 33791310, "comment_id": 55350882, "body": "I edited my question, i added the errno returned by the mmap and a make some cleanup in the text"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1447886877, "post_id": 33791310, "comment_id": 55350931, "body": "You told <code>mmap</code> to use a file <code>MAP_FILE</code> but then didn&#39;t give it a valid open file descriptor. So it&#39;s the <code>-1</code> for the file descriptor that it&#39;s complaining about."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1447886936, "post_id": 33791310, "comment_id": 55350947, "body": "&quot;Why do mmap returns a valid adress when i call it using the Mem_Init method and why do it returns me invalidArgument when i call Mem_Init in the Mem_Alloc method?&quot; -- presumably because in the latter case you pass <code>mmap()</code> an invalid argument.  That suggests that you pass a <i>different</i> argument when you call <code>Mem_Init()</code> directly than when you call <code>Mem_Alloc</code>.  Alternatively, perhaps the parts you left out contain the actual problem code."}, {"owner": {"reputation": 4826, "user_id": 5578655, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/MSqGy.png?s=128&g=1", "display_name": "Alexi Coard", "link": "https://stackoverflow.com/users/5578655/alexi-coard"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1447887080, "post_id": 33791310, "comment_id": 55350990, "body": "@JohnBollinger even if I remove the MAP_FILE it still don&#39;t work"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1447887083, "post_id": 33791310, "comment_id": 55350992, "body": "@user3386109, the arguments are certainly suspicious, but note that he also passes <code>MAP_ANONYMOUS</code>, which conflicts with <code>MAP_FILE</code> and which in some implementations <i>requires</i> <code>-1</code> to be passed as the file descriptor."}, {"owner": {"reputation": 4826, "user_id": 5578655, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/MSqGy.png?s=128&g=1", "display_name": "Alexi Coard", "link": "https://stackoverflow.com/users/5578655/alexi-coard"}, "edited": false, "score": 0, "creation_date": 1447887269, "post_id": 33791310, "comment_id": 55351057, "body": "Yes, i also tried by removing the MAP_FILE arguments but i still have the same problem, maybe it is a problem due to the fact I am using a Virtual Machine."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1447887774, "post_id": 33791310, "comment_id": 55351275, "body": "@JohnBollinger I was just trying to see if I could get OP to acknowledge and act upon Barmar&#39;s third comment. Mission accomplished. Now the objective is to get OP to acknowledge and act upon ColonelThirtyTwo&#39;s first comment. I expect that the question will be closed before that happens."}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1447892382, "post_id": 33792485, "comment_id": 55352950, "body": "Global variables are automatically initialised to 0 already. That can&#39;t be the problem."}, {"owner": {"reputation": 1911, "user_id": 5018771, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6dec254b17d75df0cfa8c42806cfca3f?s=128&d=identicon&r=PG&f=1", "display_name": "AdrienW", "link": "https://stackoverflow.com/users/5018771/adrienw"}, "edited": false, "score": 0, "creation_date": 1447938608, "post_id": 33792485, "comment_id": 55375014, "body": "Maybe it comes from the fact that OP is using a Virtual Machine ? (see previous comments) Besides, I think OP does not want to use <i>mmap</i> more than once, so only Mem_Alloc should be called in the main. That&#39;s what the problem was about at start, calling <i>mmap</i> from Mem_Alloc or directly from Mem_Init"}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1447947827, "post_id": 33792485, "comment_id": 55381845, "body": "I meant to call Mem_Alloc in main. After the change, the code still works. The code was compiled and run on a Virtual Machine."}], "tags": [], "owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "is_accepted": false, "score": 1, "last_activity_date": 1447946312, "last_edit_date": 1447946312, "creation_date": 1447889136, "answer_id": 33792485, "question_id": 33791310, "link": "https://stackoverflow.com/questions/33791310/c-mmap-initialize-at-0xffffffff/33792485#33792485", "title": "C : mmap initialize at 0xffffffff", "body": "<p>With some minor changes, your code appears to work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/mman.h&gt;\n\nvoid * START_ADDRESS;\nint MEMORY_INITIALIZED = 0;\n\nvoid* Mem_Init(int sizeOfRegion){\n    START_ADDRESS = mmap(NULL, sizeOfRegion, PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_FILE |MAP_PRIVATE, -1,0);\n\n    if ((void *) -1 == START_ADDRESS) {\n        printf(\"Could not map memory: %s\\n\", strerror(errno));\n    }\n\n    printf(\"%p\\n\", START_ADDRESS);\n\n    void* startingHeader = START_ADDRESS;\n\n    //rest of the fontion\n    return startingHeader;\n}\n\nvoid* Mem_Alloc(int size){\n    if(MEMORY_INITIALIZED==0){\n    START_ADDRESS= Mem_Init(size); \n    }\n\n    //rest of the funtion\n    return START_ADDRESS;\n}\n\nint main(void) {\n    Mem_Alloc(1024);\n    return 0;\n}\n</code></pre>\n\n<p>Compiled using</p>\n\n<pre><code>gcc -Wall -Werror -o code code.c\n</code></pre>\n\n<p>I thought the most important change is that MEMORY_INITIALIZED is set to 0, but the language lawyers assure me that this is already done by compilers that follow the C89 standard.</p>\n"}, {"comments": [{"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 1, "creation_date": 1449204757, "post_id": 33815235, "comment_id": 55915172, "body": "I don&#39;t think that is right. From the man page: <code>If addr is NULL, then the kernel chooses the address at which to create the mapping; this is the most portable method of creating a new mapping.</code>"}, {"owner": {"reputation": 4826, "user_id": 5578655, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/MSqGy.png?s=128&g=1", "display_name": "Alexi Coard", "link": "https://stackoverflow.com/users/5578655/alexi-coard"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1449501247, "post_id": 33815235, "comment_id": 56021403, "body": "Yes, i have checked and I agree with your point of view. But as we ask for a region which have a NULL size, i think the kernel init a map of size 0 at a valid place and in order to have the least conflicts possible it initialize it at the end of the memory. This is my point of view, but maybe it works diffrently...."}], "tags": [], "owner": {"reputation": 4826, "user_id": 5578655, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/MSqGy.png?s=128&g=1", "display_name": "Alexi Coard", "link": "https://stackoverflow.com/users/5578655/alexi-coard"}, "is_accepted": true, "score": 0, "last_activity_date": 1447970841, "creation_date": 1447970841, "answer_id": 33815235, "question_id": 33791310, "link": "https://stackoverflow.com/questions/33791310/c-mmap-initialize-at-0xffffffff/33815235#33815235", "title": "C : mmap initialize at 0xffffffff", "body": "<p>I finally found the error.</p>\n\n<p>In the test program the teacher gave us, he tried to allocate a 0 size header, and mmap fails when you try to alocate a null pointer.</p>\n\n<p>A simple correction was</p>\n\n<pre><code>void* Mem_Init(int sizeOfRegion){\n    if(sizeOfRegion==0) sizeOfRegion = 1024; //1024 is an exemple\n    START_ADDRESS = mmap(NULL, sizeOfRegion, PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_FILE |MAP_PRIVATE, -1,0);\n\n    if ((void *) -1 == START_ADDRESS) {\n        printf(\"Could not map memory: %s\\n\", strerror(errno));\n    }\n</code></pre>\n\n<p>Thanks for the support guys </p>\n"}], "owner": {"reputation": 4826, "user_id": 5578655, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/MSqGy.png?s=128&g=1", "display_name": "Alexi Coard", "link": "https://stackoverflow.com/users/5578655/alexi-coard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2578, "favorite_count": 1, "accepted_answer_id": 33815235, "answer_count": 2, "score": -1, "last_activity_date": 1447970841, "creation_date": 1447884192, "last_edit_date": 1447886697, "question_id": 33791310, "link": "https://stackoverflow.com/questions/33791310/c-mmap-initialize-at-0xffffffff", "title": "C : mmap initialize at 0xffffffff", "body": "<p>I am currently doing a memory allocator for a C project and I am facing something that I don't understand</p>\n\n<p>I'm calling mmap to reserve the heap for my program where i will put some headers.</p>\n\n<p>I have</p>\n\n<pre><code>void * START_ADDRESS;\nint MEMORY_INITIALIZED;\n\nvoid* Mem_Init(int sizeOfRegion){\n    START_ADDRESS = mmap(NULL, sizeOfRegion, PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_FILE |MAP_PRIVATE, -1,0);\n\n    header_t* startingHeader = START_ADDRESS;\n\n    //rest of the fontion\n}\n\nvoid* Mem_Alloc(int size){\n    if(MEMORY_INITIALIZED==0){\n    START_ADDRESS= Mem_Init(size); \n\n    //rest of the funtion\n}\n</code></pre>\n\n<p>When i use the errno on this code it returns me the invalid Argument error.</p>\n\n<p>Why do mmap returns a valid adress when i call it using the Mem_Init method and why do it returns me invalidArgument when i call Mem_Init in the Mem_Alloc method ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "arrays", "function", "pointers", "memory"], "answers": [{"tags": [], "owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "is_accepted": false, "score": -1, "last_activity_date": 1447885351, "creation_date": 1447885351, "answer_id": 33791589, "question_id": 33791297, "link": "https://stackoverflow.com/questions/33791297/how-to-access-values-from-pointers-to-pointers-in-c/33791589#33791589", "title": "How to access values from pointers to pointers in C?", "body": "<p>Here's a little program that might help you, it might be worth playing about with pointers for a bit and inspecting them, output addresses etc.</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint\nmain(void)\n    {\n        char    *p1 = \"String of text.\";\n        char    **p2;\n\n        /**\n         * We can print the avtual address of *p1 and **p2...\n         */\n        fprintf(stdout, \"p1 = %p\\n\", p1);\n        fprintf(stdout, \"p2 = %p\\n\", p2);\n\n        /**\n         * Now if we point p2 at p1 we can then check what address\n         * *p2 points at...\n         */\n        p2 = &amp;p1;\n        fprintf(stdout, \"*p2 = %p\\n\", *p2);\n\n        /**\n         * So if you think about it, *p2 should be the same at p1\n         * if we print it as a string:\n         */\n        fprintf(stdout, \"p1 is %s\\n*p2 is %s\\n\", p1, *p2);\n\n        exit(EXIT_FAILURE);\n    }\n</code></pre>\n\n<p>Hope this helps.</p>\n\n<p>As for referencing the struct from another function, if you're passing a pointer to that structure you use a single -> to refer to any member of the struct...but you are allocating another struct within your struct - using a pointer.</p>\n\n<p>Say I have</p>\n\n<pre><code>struct one {\n    char *string;\n}\n\nstruct two {\n    struct *one a;\n    struct one b;\n    char *whatever;\n}\n</code></pre>\n\n<p>If have a pointer to a struct two:</p>\n\n<p>struct two *t;</p>\n\n<p>And it had its member a allocated a struct one...then I'd reference the members of a using -></p>\n\n<pre><code>t -&gt; a -&gt; string;\n</code></pre>\n\n<p>But b isn't a pointer so you would do:</p>\n\n<pre><code>t -&gt; b.string;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1447890483, "creation_date": 1447890483, "answer_id": 33792731, "question_id": 33791297, "link": "https://stackoverflow.com/questions/33791297/how-to-access-values-from-pointers-to-pointers-in-c/33792731#33792731", "title": "How to access values from pointers to pointers in C?", "body": "<p>There are several ways to look at a pointer to a pointer.  One way is as you described with </p>\n\n<pre><code>int   x =  5;\nint  *p = &amp;x;\nint **q = &amp;p; \n</code></pre>\n\n<p>After all that, the following are all true:</p>\n\n<pre><code>**q == *p ==  x == 5\n *q ==  p == &amp;x\n  q == &amp;p\n</code></pre>\n\n<p>However, another way to look at a pointer to a pointer is as an <em>array</em> of pointers.  For example, assume the declaration:</p>\n\n<pre><code>int *arr[10];\n</code></pre>\n\n<p>Except when it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operands, the expression <code>arr</code> will be converted (\"decay\") from type \"10-element array of <code>int *</code>\" to \"pointer to <code>int *</code>\", or <code>int **</code>.  </p>\n\n<p>If you want to dynamically allocate an <code>N</code>-element array of pointers to <code>struct node</code>, you would write</p>\n\n<pre><code>struct node **arr = malloc( sizeof *arr * N );\n</code></pre>\n\n<p>You would use the <code>[]</code> subscript operator to access elements in <code>arr</code> as you would a normal array.  Since <code>arr</code> has type <code>struct node **</code>, each <code>arr[i]</code> has type <code>struct node *</code>, so you would access members of the structure like so:</p>\n\n<pre><code>arr[i]-&gt;data = \"foo\"; // use -&gt; when the LHS is a pointer to a struct or union\narr[i]-&gt;next = NULL;\n</code></pre>\n\n<p><code>struct hashtable</code> allows you to create multiple hashtable instances, each one of which has a <code>size</code> member and an array of <code>struct node *</code> which you allocate at runtime, like so:</p>\n\n<pre><code>struct hashtable h1;\n\nh1.size = 512;\nh1.table = calloc( h1.size, sizeof h1.table ); // calloc initializes all elements of\n                                               // h1.table to NULL\nif ( !h1.table )\n{\n  // calloc call failed, handle as appropriate\n}\n</code></pre>\n\n<p>You'd insert a new element into the table like so:</p>\n\n<pre><code>/**\n * Assumes we know that the string data points to is not already in\n * the table.  hashfunc is a pointer to the hashing function.\n */\nvoid insert( struct hashtable *h, const char *data, size_t (*hashfunc)(const char *))\n{\n  /**\n   * Create a new table entry.  Remember that table is an array of\n   * *pointers* to struct node, and that each array element is initially\n   * NULL.  We still need to allocate something for that table entry\n   * to point *to*.\n   */\n  struct node *newNode = malloc( sizeof *newNode );\n  if ( !newNode )\n  {\n    /**\n     * Memory allocation for new node failed, handle as appropriate\n     */\n  }\n\n  newNode-&gt;data = malloc( strlen( data ) + 1 );\n  strcpy( newNode-&gt;data, data );\n\n  /**\n   * Get the table index by computing the hash and modding against the\n   * table size.\n   */\n  size_t idx = hashfunc( data ) % h-&gt;size;\n\n  /**\n   * Insert newNode at the head of the list starting at\n   * h-&gt;table[idx].  In reality you'd probably want to insert \n   * strings in order, but for a toy example this is good enough.\n   */\n  newNode-&gt;next = h-&gt;table[idx]; // newNode-&gt;next points to the previous head of list\n  h-&gt;table[idx] = newNode;       // newNode becomes new head of list.\n}\n</code></pre>\n\n<p>When you're done, your hashtable looks something like this:</p>\n\n<pre><code>    +---+\nh1: |   | size\n    +---+             +---+     +---+---+     +---+---+\n    |   | table ----&gt; |   | --&gt; |   |   | --&gt; |   |   |\n    +---+             +---+     +---+---+     +---+---+\n                      |   | \n                      +---+     +---+---+\n                      |   | --&gt; |   |   |\n                      +---+     +---+---+     +---+---+     +---+---+\n                      |   | --&gt; |   |   | --&gt; |   |   | --&gt; |   |   |\n                      +---+     +---+---+     +---+---+     +---+---+\n                       ...\n</code></pre>\n\n<p><code>table</code> points to an array of <code>struct node *</code>, each of which may point to an instance of <code>struct node</code>, each of which may point to <em>another</em> instance of <code>struct node</code>.  In the picture above, two strings have hashed to <code>table[0]</code>,\none to <code>table[2]</code>, and three to <code>table[3]</code>.  </p>\n"}], "owner": {"reputation": 7, "user_id": 5578544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/408aead76d5b36b63a75fd5060748660?s=128&d=identicon&r=PG&f=1", "display_name": "EmpirialPrince", "link": "https://stackoverflow.com/users/5578544/empirialprince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1447890483, "creation_date": 1447884138, "question_id": 33791297, "link": "https://stackoverflow.com/questions/33791297/how-to-access-values-from-pointers-to-pointers-in-c", "title": "How to access values from pointers to pointers in C?", "body": "<p>I am writing a program that is attempting to implement a hash table in C. It has to use a pointer to a pointer as an attribute in a struct data type. Here is the code of the relevant structs. </p>\n\n<pre><code>      struct node {\n      char * data;\n      struct node * next;\n    };\n\n    struct hashtable {\n      int size;\n      struct node ** table;\n    };\n</code></pre>\n\n<p>Part one of question:</p>\n\n<p>I have been doing a lot of research to figure out just how pointers to pointers work but I still can't seem to get my head around it. Every example I've found assigns two different pointer names to the first and second pointer. eg</p>\n\n<pre><code>  x = 5;\n  *p = &amp;x;\n  **q = &amp;p; \n</code></pre>\n\n<p>What about the case above \"struct node ** table;\" \nIs ** table the same as **q in this case? \nWhat would the values of q , *q and  **q be in this case? is q = 5 and then *q and **q work back through the addresses or is **q = 5 and *q and q store the addresses?</p>\n\n<p>Part two of question:</p>\n\n<p>How do I access a pointer to a pointer within another function? Here is the code I have right now. </p>\n\n<pre><code>struct hashtable * hashtable_new(int size){\n\n    struct hashtable *newTable;\n\n    if ( size &lt; 1 )\n    {\n        return NULL;\n    printf(\"Its returning Null.\");\n    }\n    else\n    {\n        newTable = malloc(sizeof(struct hashtable));\n        newTable -&gt; size = size;\n        newTable -&gt; table = malloc(sizeof(struct node) * size);\n        int i;\n        for (i = 0; i &lt; size; i++ )\n        {\n\n            newTable -&gt; table[i] = NULL;\n        }\n    fprintf(stderr, \"Table has been created.\");\n        return newTable;\n    }\n\n};\n</code></pre>\n\n<p>I'm not sure I understand how to access either the pointer or the pointer to a pointer through the -> symbol. Is it \"newtable -> table\" or \"newtable -> -> table\"  ?</p>\n\n<p>The aim of the table is essentially to be a 2d table, where the list is primarily 1D and can spread to 2D to deal with collisions in the hashing. </p>\n\n<p>End note:</p>\n\n<p>Hopefully I've provided enough information to make contextual sense asking this question. Its my first time asking a question on stackoverflow so feel free to ask me extra question, provide CC or flag any mistakes I've made asking this question. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "eclipse", "pointers", "struct", "typedef"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1447883411, "post_id": 33790877, "comment_id": 55349279, "body": "&quot;b is an array of type Y of size size&quot; -- no <code>b</code> is a <i>pointer</i> to a <code>Y</code>, which apparently is supposed to be the first <code>Y</code> in an array of length <code>size</code>.  Pointers are not the same thing as arrays."}, {"owner": {"reputation": 239, "user_id": 3697301, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/000e9a2b5b7fdf131f361d0cb8612df9?s=128&d=identicon&r=PG&f=1", "display_name": "Stabilo", "link": "https://stackoverflow.com/users/3697301/stabilo"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1447883740, "post_id": 33790877, "comment_id": 55349455, "body": "@JohnBollinger thanks. so I can&#39;t fix <code>func</code>? maybe with <code>size</code> some way?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1447884230, "post_id": 33790877, "comment_id": 55349715, "body": "See my just-posted answer."}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 3697301, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/000e9a2b5b7fdf131f361d0cb8612df9?s=128&d=identicon&r=PG&f=1", "display_name": "Stabilo", "link": "https://stackoverflow.com/users/3697301/stabilo"}, "edited": false, "score": 0, "creation_date": 1447883061, "post_id": 33790937, "comment_id": 55349083, "body": "Now <code>invalid operands to binary - (have \u2018Y\u2019 and \u2018struct y_t **\u2019)</code>"}], "tags": [], "owner": {"reputation": 4184, "user_id": 3987536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/327abb72f81fec541e936876b90d25d2?s=128&d=identicon&r=PG", "display_name": "Lawrence Aiello", "link": "https://stackoverflow.com/users/3987536/lawrence-aiello"}, "is_accepted": false, "score": 0, "last_activity_date": 1447882788, "creation_date": 1447882788, "answer_id": 33790937, "question_id": 33790877, "link": "https://stackoverflow.com/questions/33790877/c-error-arithmetic-on-pointer-to-an-incomplete-type/33790937#33790937", "title": "C Error: `arithmetic on pointer to an incomplete type`", "body": "<p>The reason you are getting that error is because you are trying to index a variable that is not an array. When you de-reference an array, as you've done here:</p>\n\n<pre><code>Y *b\n</code></pre>\n\n<p>You are already accessing the 0th index of the array in your struct definition. So just change your line to this:</p>\n\n<pre><code>int diff = x-&gt;a - x-&gt;b;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1447884114, "creation_date": 1447884114, "answer_id": 33791287, "question_id": 33790877, "link": "https://stackoverflow.com/questions/33790877/c-error-arithmetic-on-pointer-to-an-incomplete-type/33791287#33791287", "title": "C Error: `arithmetic on pointer to an incomplete type`", "body": "<p>The message ...</p>\n\n<blockquote>\n  <p>arithmetic on pointer to an incomplete type</p>\n</blockquote>\n\n<p>... likely arises because the declaration of <code>struct y_t</code> is not visible at that point in the compilation unit.  The typedef of <code>Y</code> serves double-duty as a forward declaration of such a structure, but without a full declaration, <code>struct y_t</code> is an incomplete type.</p>\n\n<p>Both <code>x-&gt;a</code> and <code>x-&gt;b[0]</code> are <code>Y</code>s, a.k.a. <code>struct y_t *</code>.  The difference between them is defined in terms of the size of the pointed-to structure, but its size is unknown because it is an incomplete type.  You need to provide the declaration of <code>struct y_t</code> for what you're doing to work.</p>\n"}], "owner": {"reputation": 239, "user_id": 3697301, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/000e9a2b5b7fdf131f361d0cb8612df9?s=128&d=identicon&r=PG&f=1", "display_name": "Stabilo", "link": "https://stackoverflow.com/users/3697301/stabilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2642, "favorite_count": 0, "accepted_answer_id": 33791287, "answer_count": 2, "score": -1, "last_activity_date": 1447969379, "creation_date": 1447882571, "last_edit_date": 1447969279, "question_id": 33790877, "link": "https://stackoverflow.com/questions/33790877/c-error-arithmetic-on-pointer-to-an-incomplete-type", "title": "C Error: `arithmetic on pointer to an incomplete type`", "body": "<p>If I have the definitions:</p>\n\n<pre><code>typedef struct y_t *Y;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>typedef struct x_t *X;    \nstruct x_t {\n    Y *b;\n    Y a;\n    int size;\n};\n</code></pre>\n\n<p>(<code>b</code> is an array of type <code>Y</code> of size <code>size</code>)</p>\n\n<p>and I have</p>\n\n<pre><code>int func(X x) {    \n    int diff = x-&gt;a - x-&gt;b[0];   // error here\n    return diff;\n}\n</code></pre>\n\n<p>Let's assume <code>a</code> is an element in the <code>b</code> array, and <code>func</code> needs to return <code>a</code>'s index in <code>b</code> array.</p>\n\n<p>But I'm getting an error <code>arithmetic on pointer to an incomplete type</code> (I'm using eclipse). </p>\n\n<p>I'm assuming it has trouble because it doesn't know the dimension of the array... So how can I fix <code>func</code>?</p>\n"}, {"tags": ["c++", "c", "arrays"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1447882303, "post_id": 33790761, "comment_id": 55348654, "body": "The declaration &quot; int matrix[matrixDimension][matrixDimension]&quot; is not valid C++ (it&#39;s a C99 VLA). The indexing used is 1-based. C++ raw array indexing is 0-based. That said you should have debugged your code  yourself. True,, some people can just look at code and spot what&#39;s wrong with it, but  you&#39;ll never get anywhere if you offload all small problems to others."}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1447882568, "post_id": 33790761, "comment_id": 55348799, "body": "<code>&amp;matrix[matrixDimension][matrixDimension]</code> delivers an address just behind the matrix."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "reply_to_user": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1447882665, "post_id": 33790761, "comment_id": 55348855, "body": "@MartinZabel Is that&#39;s what&#39;s known as the red pill?"}, {"owner": {"reputation": 514, "user_id": 918454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPi0H.jpg?s=128&g=1", "display_name": "Elena Viter", "link": "https://stackoverflow.com/users/918454/elena-viter"}, "edited": false, "score": 0, "creation_date": 1447882891, "post_id": 33790761, "comment_id": 55348994, "body": "Take a look <a href=\"http://stackoverflow.com/questions/8767166/passing-a-2d-array-to-a-c-function\">here</a> to get idea how to pass the multidimensional array into the function"}], "answers": [{"comments": [{"owner": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "edited": false, "score": 0, "creation_date": 1447883419, "post_id": 33790999, "comment_id": 55349284, "body": "Thanks for the answer I think I see what you are saying and what I am doing wrong. I am trying to pass the array to the function ComputeMatrixMainDiagonal() so that it can compute the first main diagonal. Can you elaborate on  &quot;though why you would want to do so escapes me&quot;. If i needed to manipulate the array I would need to pass it by reference but since I am just getting the values out of the array to be computed pass-by-value should be fine right? Also how could this be changed to be a pass-by-reference.Thanks !"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "edited": false, "score": 0, "creation_date": 1447884474, "post_id": 33790999, "comment_id": 55349864, "body": "Passing an <i>array</i> by value implies passing all its elements, which in fact you cannot do at all.  You can, however, pass a pointer (by value), which is fine."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "edited": false, "score": 0, "creation_date": 1447884718, "post_id": 33790999, "comment_id": 55349976, "body": "@DougRay, note, too, that it is perversely appropriate that you have tagged the question with both [c] and [c++].  This is almost always the wrong thing to do, but your code uses features of each language that are not present in the other."}, {"owner": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "edited": false, "score": 0, "creation_date": 1447886083, "post_id": 33790999, "comment_id": 55350609, "body": "Thanks @JohnBollinger,  so I am calling my function like this     matrixMainDiagonal = ComputeMatrixMainDiagonal(matrixDimension,&amp;matrix[0][0]); Then receiving it in the function like this int ComputeMatrixMainDiagonal(int matrixDimensions, int* matrix). Which to me means pass the address of the 2d array and the function then should have a pointer to that array with the field matrix. Which then could be accessed via diagonalValue =+ matrix[i][rowIndent];. Is that logic correct ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "edited": false, "score": 0, "creation_date": 1447886635, "post_id": 33790999, "comment_id": 55350834, "body": "The argument passing you describe sounds fine, but you cannot use a double subscript to dereference an <code>int *</code>.  The element you can access in <code>main()</code> as <code>matrix[row][col]</code> would need to be accessed in the function as <code>matrix[row * matrixDimensions + col]</code>."}, {"owner": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "edited": false, "score": 0, "creation_date": 1447891284, "post_id": 33790999, "comment_id": 55352539, "body": "Sorry for all the sub questions I am now getting my matrix values but I am noticing something strange for my for loop i get the correct values  for  diagonalValue but when I return it only returns the last value.  This is the line I am using in my for loop   diagonalValue =+  matrix[i * matrixDimensions + rowIndent];  but when I use cout &lt;&lt; diagonalValue  to see the value it  returns 11 5 -12 -12  when it should be 11+5-12=4. Thanks for all the help and sticking with the question :) !!!"}, {"owner": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "edited": false, "score": 0, "creation_date": 1447895921, "post_id": 33790999, "comment_id": 55354053, "body": "Never mind simple mistake i flipped the += sign to a =+ sign thanks for everything ! :)"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1447883043, "creation_date": 1447883043, "answer_id": 33790999, "question_id": 33790761, "link": "https://stackoverflow.com/questions/33790761/c-passing-array-by-value-causing-segment-fault/33790999#33790999", "title": "C++ passing array by value causing segment fault", "body": "<p>Your segmentation fault likely occurs because <code>&amp;matrix[matrixDimension][matrixDimension]</code> does not mean what you think it means.  Your question title suggests that you think this is a way to pass the array by value (though why you would want to do so escapes me), but pass-by-value vs. pass-by-reference is a matter of how the function is <em>declared</em>, not of how it is called.</p>\n\n<p>The expression <code>&amp;matrix[matrixDimension][matrixDimension]</code> would be the address of the <code>matrixDimension</code>th element of the <code>matrixDimension</code>th row of the matrix.  This is outside the bounds of the matrix, as the maximum index for an array is one less than the array dimension.  Even if you wrote <code>&amp;matrix[matrixDimension - 1][matrixDimension - 1]</code>, however, it would not be what you want.  You want the address of the <em>first</em> element of the array, which is <code>&amp;matrix[0][0]</code> or simply <code>matrix</code>, though these are inequivalent on account of having different type (corresponding to different senses of what the elements of <code>matrix</code> are).</p>\n"}], "owner": {"reputation": 954, "user_id": 4935793, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-D15klxQvVQM/AAAAAAAAAAI/AAAAAAAAADE/6q3j1nE_Ueo/photo.jpg?sz=128", "display_name": "Doug Ray", "link": "https://stackoverflow.com/users/4935793/doug-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 33790999, "answer_count": 1, "score": 0, "last_activity_date": 1447883418, "creation_date": 1447882160, "question_id": 33790761, "link": "https://stackoverflow.com/questions/33790761/c-passing-array-by-value-causing-segment-fault", "title": "C++ passing array by value causing segment fault", "body": "<p>Hey everyone I am relearning C++ by doing some hacker rank challenges and am getting a segment fault error. The program should take in the dimensions for the matrix and compute both diagonals, then add them together. I am pretty sure the error is in how the 2d array is passed to the computeMainDiagonal and computeSecondaryDiagonal functions. Thanks for the help !</p>\n\n<pre><code>int ComputeMatrixMainDiagonal(int matrixDimensions, int* matrix){\n    int rowIndent = 0;\n    int diagonalValue; \n\n    for(int i = 0;i &lt; matrixDimensions;i++){\n        diagonalValue =+ (&amp;matrix)[i][rowIndent];\n        rowIndent++;\n    }\n    return diagonalValue;\n}\n\nint ComputeMatrixSecondaryDiagonal(int matrixDimensions, int* matrix){\n    int rowIndent = matrixDimensions;\n    int diagonalValue;\n\n    for(int i = matrixDimensions;i &gt; 0;i--){\n        diagonalValue =+ (&amp;matrix)[i][rowIndent];\n        rowIndent--;\n    }\n    return diagonalValue;\n}\n\n\nint main() {\n    int matrixDimension;\n    int differenceAcrossSumsOfDiagonal;\n    int matrixMainDiagonal;\n    int matrixSecondaryDiagonal;\n\n    int * matrixPointer;\n\n    cin &gt;&gt; matrixDimension; //get matrix dimensions\n    int matrix[matrixDimension][matrixDimension]; //declare new matrix\n    for(int index = 0; index &lt; matrixDimension;index++ ){ //populate matrix\n        for(int i = 0; i &lt; matrixDimension;i++){\n            cin &gt;&gt; matrix[index][i];\n        }\n    }\n    matrixMainDiagonal = ComputeMatrixMainDiagonal(matrixDimension,&amp;matrix[matrixDimension][matrixDimension]);      \n    matrixSecondaryDiagonal = ComputeMatrixSecondaryDiagonal(matrixDimension,&amp;matrix[matrixDimension][matrixDimension]);\n\n    differenceAcrossSumsOfDiagonal = (matrixMainDiagonal + matrixSecondaryDiagonal);\n\n    cout &lt;&lt; differenceAcrossSumsOfDiagonal;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1447882694, "post_id": 33790756, "comment_id": 55348867, "body": "As you know, <code>ABC_ is undeclared</code> means your preprocessor expanded the &quot;P&quot; in  &quot;TKN_PST(P)&quot; to &quot;&quot;.   Since &quot;Q&quot; and &quot;R&quot; seem to work ... I agree with  your guess that &quot;P&quot; is itself a macro, defined &quot;somewhere else&quot;.  SUGGESTION: Compile with <code>-E</code> (or equivalent for your compiler) to debug the macro expansion."}, {"owner": {"reputation": 53, "user_id": 2755448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6918f6b1646923e2ff6215dbfde9501?s=128&d=identicon&r=PG&f=1", "display_name": "SuperZero", "link": "https://stackoverflow.com/users/2755448/superzero"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1447883893, "post_id": 33790756, "comment_id": 55349531, "body": "Thanks for your comment. I did find a definition elsewhere that is included in the file where these macros are defined. That definition is just a #define with no replacement text."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 2755448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6918f6b1646923e2ff6215dbfde9501?s=128&d=identicon&r=PG&f=1", "display_name": "SuperZero", "link": "https://stackoverflow.com/users/2755448/superzero"}, "is_accepted": true, "score": 1, "last_activity_date": 1447884102, "creation_date": 1447884102, "answer_id": 33791280, "question_id": 33790756, "link": "https://stackoverflow.com/questions/33790756/token-undeclared-error-in-a-macro-that-does-token-pasting/33791280#33791280", "title": "Token undeclared error in a macro that does token pasting", "body": "<p>Thanks to paulsm4 for pointing me in the right direction with his comment above.</p>\n\n<p>I was able to find a definition (#define) for \"P\" in an included file, which has no replacement text.\nI hadn't considered this possibility.</p>\n"}], "owner": {"reputation": 53, "user_id": 2755448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6918f6b1646923e2ff6215dbfde9501?s=128&d=identicon&r=PG&f=1", "display_name": "SuperZero", "link": "https://stackoverflow.com/users/2755448/superzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 33791280, "answer_count": 1, "score": 1, "last_activity_date": 1447884102, "creation_date": 1447882148, "question_id": 33790756, "link": "https://stackoverflow.com/questions/33790756/token-undeclared-error-in-a-macro-that-does-token-pasting", "title": "Token undeclared error in a macro that does token pasting", "body": "<p>I'm not posting the exact code here, but I have tried to represent the problem fully. I have the following macro - </p>\n\n<pre><code>#define TKN_PST(P) (ABC_##P)\n</code></pre>\n\n<p>This macro is called in the definition of another macro, which itself is called from another macro as below - </p>\n\n<pre><code>#define CREATE_TOKEN(P) FURTHER_PROC(P)\n#define FURTHER_PROC(X) foo(a, b, TKN_PST(X), ...)\n</code></pre>\n\n<p>foo() is a function that accepts a variable number of arguments.</p>\n\n<p>I'm getting an error when I call <code>CREATE_TOKEN(P)</code>. The compiler tells me that <code>ABC_</code> is undeclared.</p>\n\n<p>This problem only occurs when I call <code>CREATE_TOKEN(P)</code>, and doesn't occur for <code>CREATE_TOKEN(Q)</code>, <code>CREATE_TOKEN(R)</code>, etc. I suspect that this issue might be the result of P having a definition somewhere in the large code-base.</p>\n\n<p>I tried introducing an extra level of indirection as below - </p>\n\n<pre><code>#define FURTHER_PROC(X) FURTHER_PROC2(X)\n#define FURTHER_PROC2(X) foo(a, b, TKN_PST(X), ...)\n</code></pre>\n\n<p>Then <code>CREATE_TOKEN(Q)</code>, <code>CREATE_TOKEN(R)</code>, etc started failing with the error \"')' expected before ...\".</p>\n\n<p>What might be the reason for this issue?</p>\n"}, {"tags": ["c", "ffmpeg", "libavcodec", "libavformat"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1447894974, "post_id": 33790619, "comment_id": 55353753, "body": "Unfortunately, BMP expects the row 0 to be the bottom row."}, {"owner": {"reputation": 2007, "user_id": 1540501, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JcHkg.jpg?s=128&g=1", "display_name": "ivan.ukr", "link": "https://stackoverflow.com/users/1540501/ivan-ukr"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1447958129, "post_id": 33790619, "comment_id": 55388846, "body": "Thanks, I didn&#39;t knew that. So just need to reorder rows."}], "answers": [{"tags": [], "owner": {"reputation": 2007, "user_id": 1540501, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JcHkg.jpg?s=128&g=1", "display_name": "ivan.ukr", "link": "https://stackoverflow.com/users/1540501/ivan-ukr"}, "is_accepted": false, "score": 2, "last_activity_date": 1448138918, "creation_date": 1448138918, "answer_id": 33848405, "question_id": 33790619, "link": "https://stackoverflow.com/questions/33790619/extracting-video-frame-image-with-libavformat-and-libswscale-gives-flipped-image/33848405#33848405", "title": "Extracting video frame image with libavformat and libswscale gives flipped image", "body": "<p>So here is the working code:</p>\n\n<pre><code>// Extract pixels\n{\n    int y = 0;\n    size_t frame_line_size = state.picture.linesize[0];\n    uint8_t* bmp_data = &amp;bmp-&gt;data[0] + (image_line_size_with_padding * (height - 1));\n    uint8_t* picture_data = state.picture.data[0];\n    while(y &lt; height)\n    {\n        memcpy(bmp_data, picture_data, image_line_size);\n        bmp_data -= image_line_size_with_padding;\n        picture_data += frame_line_size;\n        ++y;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2007, "user_id": 1540501, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JcHkg.jpg?s=128&g=1", "display_name": "ivan.ukr", "link": "https://stackoverflow.com/users/1540501/ivan-ukr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1448138918, "creation_date": 1447881612, "last_edit_date": 1447882584, "question_id": 33790619, "link": "https://stackoverflow.com/questions/33790619/extracting-video-frame-image-with-libavformat-and-libswscale-gives-flipped-image", "title": "Extracting video frame image with libavformat and libswscale gives flipped image", "body": "<p>I am using following code to extract image frames outputted by <code>avcodec_decode_video2()</code> into BMP file:</p>\n\n<pre><code>// Convert the image from its native format to RGB\nint height = sws_scale(state.sws_ctx, \n             (uint8_t const * const *)state.frame-&gt;data,\n             state.frame-&gt;linesize, \n             0, \n             state.video_codec_ctx-&gt;height,\n             state.picture.data, \n             state.picture.linesize);\n\n// ..... here BMP header initialization goes ...\n\n// Extract pixels\n{\n    int y = 0;\n    size_t frame_line_size = state.picture.linesize[0];\n    uint8_t* bmp_data = &amp;bmp-&gt;data[0];\n    uint8_t* picture_data = state.picture.data[0];\n    while(y &lt; height)\n    {\n        memcpy(bmp_data, picture_data, image_line_size);\n        bmp_data += image_line_size_with_padding;\n        picture_data += frame_line_size;\n        ++y;\n    }\n}\n</code></pre>\n\n<p>But it results flipped image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DVyyJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DVyyJ.png\" alt=\"Resulting BMP image\"></a></p>\n\n<p>Can anyone please help me to understand, what I am doing wrong here?</p>\n\n<p>Video stream information:</p>\n\n<pre><code>Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'testdata/video3.mp4':\n  Metadata:\n    major_brand     : isom\n    minor_version   : 512\n    compatible_brands: isomiso2avc1mp41\n    creation_time   : 1970-01-01 00:00:00\n    title           : video3.mp4\n    encoder         : Lavf52.78.3\n  Duration: 00:00:07.93, start: 0.000000, bitrate: 1467 kb/s\n    Stream #0.0(und): Video: h264 (High), yuv420p, 640x320 [PAR 1:1 DAR 2:1], 1331 kb/s, 29.73 fps, 29.73 tbr, 29734 tbn, 59.47 tbc\n    Metadata:\n      creation_time   : 1970-01-01 00:00:00\n    Stream #0.1(und): Audio: aac, 48000 Hz, stereo, fltp, 127 kb/s\n    Metadata:\n      creation_time   : 1970-01-01 00:00:00\nVideo file 'testdata/video3.mp4' has 236 frames.\n</code></pre>\n\n<p>I have alternate code that uses libopencv, and it gives correct image from the same video file, but I need to reach the correct effect using directly ffmpeg libs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UKXNF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UKXNF.png\" alt=\"Correct image established from the same video file via libopencv\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20333, "user_id": 774078, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/seSXR.png?s=128&g=1", "display_name": "Sterling Archer", "link": "https://stackoverflow.com/users/774078/sterling-archer"}, "edited": false, "score": 4, "creation_date": 1447882136, "post_id": 33790508, "comment_id": 55348555, "body": "Please don&#39;t wipe out your question like that."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1447881379, "creation_date": 1447881379, "answer_id": 33790551, "question_id": 33790508, "link": "https://stackoverflow.com/questions/33790508/one-of-this-three-codes-is-not-working/33790551#33790551", "title": "One of this three codes is not working", "body": "<p>array types and pointer types are not same even though they work similarly in many situations. You cannot change where an array points to. You cannot increment it or decrement it like you can with a pointer.</p>\n\n<p>Use:</p>\n\n<pre><code>for (j = 0; j &lt; MAXIMUM; j++) {\n     P[j] = 0.0;\n}\n</code></pre>\n\n<p>If you want use a pointer, you can create a pointer that points to the array and then increment it.</p>\n\n<pre><code>float* ptr = P;\nfor (j = 0; j &lt; MAXIMUM; j++) {\n     *ptr = 0.0;\n     ptr++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2059, "user_id": 2759368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03e2c110cced20e5bde6dc62146fcce?s=128&d=identicon&r=PG&f=1", "display_name": "nnn", "link": "https://stackoverflow.com/users/2759368/nnn"}, "is_accepted": false, "score": 0, "last_activity_date": 1447881516, "creation_date": 1447881516, "answer_id": 33790590, "question_id": 33790508, "link": "https://stackoverflow.com/questions/33790508/one-of-this-three-codes-is-not-working/33790590#33790590", "title": "One of this three codes is not working", "body": "<p>If you want to use a pointer (as you have now) in the <code>for</code> loop, you should declare something like:</p>\n\n<pre><code>float P_array[MAXIMUM];\nfloat *P = P_array;\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5580103"}, "is_accepted": false, "score": 0, "last_activity_date": 1447921291, "creation_date": 1447921291, "answer_id": 33798541, "question_id": 33790508, "link": "https://stackoverflow.com/questions/33790508/one-of-this-three-codes-is-not-working/33798541#33798541", "title": "One of this three codes is not working", "body": "<p>First just to highlight...</p>\n\n<p>Do not use...</p>\n\n<pre><code>main()\n</code></pre>\n\n<p>Use</p>\n\n<pre><code>int main(void)\n</code></pre>\n\n<p>Second... You created an array, not a pointer which was *P</p>\n\n<p>Do this instead</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXIMUM 100\n\nint main(void)\n{   int j;\n    float P[MAXIMUM]; // Create array\n\n    for (j = 0; j &lt; MAXIMUM; j++) //First loop, j = 0. Second loop, j = 1\n    {\n         P[j] = 0.0;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>And if you want to print results</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXIMUM 100\n\nint main(void)\n{   int j;\n    float P[MAXIMUM]; // Create array\n\n    for (j = 0; j &lt; MAXIMUM; j++) //First loop, j = 0. Second loop, j = 1\n    {\n         P[j] = 0.0;\n         printf(\"%d: %d\", j, P[j]);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5578541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bd9f4d9a3f628dca6bd29141182225?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Jay", "link": "https://stackoverflow.com/users/5578541/kevin-jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1447921291, "creation_date": 1447881261, "last_edit_date": 1447882119, "question_id": 33790508, "link": "https://stackoverflow.com/questions/33790508/one-of-this-three-codes-is-not-working", "title": "One of this three codes is not working", "body": "<p>I'm trying to find out what is wrong in this program (C code). But I don't get anything clear. I'd appreciate some help. I get this error <code>main.c:10:11: error: lvalue required as increment operand</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXIMUM 100\n\nmain()\n{   int j;\n    float P[MAXIMUM];\n\n    for (j = 0; j &lt; MAXIMUM; j++) {\n         *P = 0.0;\n         P++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio", "linker", "cmocka"], "comments": [{"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1469627464, "post_id": 33790425, "comment_id": 64615988, "body": "+1 This is what I would like to know too, it appears that in VS (i.e. MSVC compiler) you can only use #defines to manually override the actual implementation."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 14313383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2c15b90ab8a2b7472b7082ae4d9e37?s=128&d=identicon&r=PG&f=1", "display_name": "jl.lu", "link": "https://stackoverflow.com/users/14313383/jl-lu"}, "is_accepted": true, "score": 1, "last_activity_date": 1614306057, "creation_date": 1614306057, "answer_id": 66379212, "question_id": 33790425, "link": "https://stackoverflow.com/questions/33790425/visual-studio-c-linker-wrap-option/66379212#66379212", "title": "visual studio c linker wrap option?", "body": "<p>The <code>--wrap</code> in <code>ld</code> can be emulated by the <code>/ALTERNATENAME</code> option in MSVC Linker.</p>\n<p>We start from two compilation units, say <code>foo.o</code> compiled from <code>foo.c</code>, whose external functions are declared in <code>foo.h</code>, and <code>main.o</code> from <code>main.c</code>.\n(If <code>foo</code> has been compiled as a library, things won't change much.)</p>\n<pre><code>// foo.h\nint foo();\n\n// foo.c\nint foo() {\n    return 0;\n}\n\n// main.c\n#include &lt;stdio.h&gt;\n#include &quot;foo.h&quot;\nint main() {\n    int x = foo();\n    printf(&quot;%s\\n&quot;, x ? &quot;wrapped&quot; : &quot;original&quot;);\n}\n</code></pre>\n<p>The return value of <code>int foo()</code> is 0, so the snippet of code above will output &quot;original&quot;.</p>\n<p>Now we override the actual implementation by an alias: The <code>#include &quot;foo.h&quot;</code> in <code>main.c</code> is replaced by</p>\n<pre><code>#define foo real_foo\n#include &quot;foo.h&quot;\n#undef foo\n#pragma comment(linker, &quot;/alternatename:real_foo=foo&quot;)\n</code></pre>\n<p>Let me explain what happens here:</p>\n<ol>\n<li>by <code>#define foo real_foo</code>, the function declaration in <code>foo.h</code> is modified as <code>int real_foo()</code>.</li>\n<li>However, the symbol in <code>foo.o</code> is still named after <code>int foo()</code>, instead of the alias <code>int real_foo()</code>. That's why we need the <code>/alternatename</code> linker switch.</li>\n<li><code>&quot;/alternatename:real_foo=foo&quot;</code> tells the linker that, if you cannot find the symbol called <code>real_foo</code>, try <code>foo</code> again before throwing an error.</li>\n<li>Apparently there is no definition of <code>int real_foo()</code>. MSVC Linker will search for <code>int foo()</code> and link it instead at each occurrence of <code>int real_foo()</code>.</li>\n</ol>\n<p>As the previous implementation has been aliased, now we redirect <code>int foo()</code> to our new implementation by a macro:</p>\n<pre><code>int wrap_foo() {\n    return real_foo() + 1;\n}\n#define foo wrap_foo\n</code></pre>\n<p>And we are done here. At last the <code>main.cpp</code> looks like:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\n#define foo real_foo\n#include &quot;foo.h&quot;\n#undef foo\n#pragma comment(linker, &quot;/alternatename:real_foo=foo&quot;)\n\nint wrap_foo() {\n    return real_foo() + 1;\n}\n#define foo wrap_foo\n\nint main() {\n    int x = foo();\n    printf(&quot;%s\\n&quot;, x ? &quot;wrapped&quot; : &quot;original&quot;);\n}\n</code></pre>\n<p>Built in MSVC, it will output &quot;wrapped&quot;.</p>\n"}], "owner": {"reputation": 1461, "user_id": 2432942, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c87157a04595650eeee0903527be7168?s=128&d=identicon&r=PG", "display_name": "pogorman", "link": "https://stackoverflow.com/users/2432942/pogorman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 1, "accepted_answer_id": 66379212, "answer_count": 1, "score": 4, "last_activity_date": 1614306057, "creation_date": 1447880971, "last_edit_date": 1592644375, "question_id": 33790425, "link": "https://stackoverflow.com/questions/33790425/visual-studio-c-linker-wrap-option", "title": "visual studio c linker wrap option?", "body": "<p>From this article <a href=\"https://lwn.net/Articles/558106/\" rel=\"nofollow noreferrer\">Unit testing with mock objects in C</a>:</p>\n<blockquote>\n<p>This is done by using the <code>--wrap</code> linker option which takes the name of the wrapped function as an argument. If the test was compiled using gcc, the invocation might look like:</p>\n<p><code>$ gcc -g -Wl,--wrap=chef_cook waiter_test.c chef.c</code></p>\n</blockquote>\n<p>How can I do this when compiling a C project in visual studio?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "edited": false, "score": 0, "creation_date": 1447881063, "post_id": 33790401, "comment_id": 55347928, "body": "Please format your code."}, {"owner": {"reputation": 1230, "user_id": 4488318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb0e9296a94c70973340799a7a951d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Evans", "link": "https://stackoverflow.com/users/4488318/joseph-evans"}, "edited": false, "score": 0, "creation_date": 1447881289, "post_id": 33790401, "comment_id": 55348070, "body": "Try printing out the characters so you can debug the code and actually see what is happening."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1447881359, "post_id": 33790401, "comment_id": 55348100, "body": "1) initialize <code>j</code> E.g <code>int i,j=0;</code> 2) <code>if(str[i] ==&quot; &quot;) {</code> --&gt; <code>if(str[i] ==&#39; &#39;) {</code> 3) <code>char  str[10]=&quot;I love you&quot;</code> --&gt; <code>char  str[11]=&quot;I love you&quot;</code> or <code>char  str[]=&quot;I love you&quot;</code>"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1447887759, "post_id": 33790401, "comment_id": 55351273, "body": "What is the question?"}], "answers": [{"tags": [], "owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "is_accepted": false, "score": 0, "last_activity_date": 1447882477, "last_edit_date": 1447882477, "creation_date": 1447882041, "answer_id": 33790725, "question_id": 33790401, "link": "https://stackoverflow.com/questions/33790401/writing-a-c-program-to-delete-space-between-strings/33790725#33790725", "title": "Writing a C Program to Delete Space Between Strings", "body": "<p>You're using double quotes to reference a single character - comparing it to a single char[] element in your string, you should use single quotes:</p>\n\n<pre><code>if (str[i] == ' ')\n</code></pre>\n\n<p>Also, not 100% here so maybe  someone can confirm - the inactive/empty if condition may throw up at least a warning, try changing it to:</p>\n\n<pre><code>if (str[i] != ' ') {\n    temp[j]=str[i];\n    j++;\n}\n</code></pre>\n\n<p>Hope that helps.</p>\n\n<p>ETA - I just want to add so that you don't end up back here again :p</p>\n\n<p>You're packing a string byte by byte, when we assign strings to buffers in c using double quotes like:</p>\n\n<pre><code>char str[10] = \"I love you\";\n</code></pre>\n\n<p>We create a string that is terminated with a NUL byte or \\0:</p>\n\n<pre><code>temp[0] = '\\0';\n</code></pre>\n\n<p>For example - using single-quotes to refer to a single character - when you pack your string:</p>\n\n<pre><code>temp[j]=str[i];\n</code></pre>\n\n<p>You should add the \\0 byte at the end so functions like strcpy() and printf() know when the string ends</p>\n\n<p>So when you copy temp to str, strcpy won't know where your string ends, you need to add that \\0 byte. This also means that you are overwriting str...because str has 10 elements, \"I love you\" including spaces is 10 bytes...but it's really 11, because when youa ssign the string the \\0 is automatically added at the end for you...you are packing your temp string by hand so you need to add the \\0 yourself:</p>\n\n<pre><code>if (str[i] != ' ') {\n    temp[j]=str[i];\n    temp[++j] = '\\0';\n}\n</code></pre>\n\n<p>I'd change the entire loop to:</p>\n\n<pre><code>for(i=0; str[i] != '\\0'; i++) {\n    if(str[i] != ' ') {\n        temp[j++] = str[i];\n        temp[j] = '\\0';\n    }\n}\n</code></pre>\n\n<p>Oughtta do it, hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "is_accepted": false, "score": 0, "last_activity_date": 1447882181, "creation_date": 1447882181, "answer_id": 33790765, "question_id": 33790401, "link": "https://stackoverflow.com/questions/33790401/writing-a-c-program-to-delete-space-between-strings/33790765#33790765", "title": "Writing a C Program to Delete Space Between Strings", "body": "<p>Welp this worked for me i just searched up a bit.</p>\n\n<pre><code>#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include\"stdafx.h\"\nint main(void) \n{\n    char  str[11] = \"I love you\", str2;\n\n\n    char *src, *dst;\n    for (src = dst = str; *src != '\\0'; src++) {\n        *dst = *src;\n        if (*dst != ' ') dst++;\n    }\n    *dst = '\\0';\n    printf(\"%s\", str);\n\n    return 0;\n}\n</code></pre>\n\n<p>(It returns Iloveyou)</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1447883292, "last_edit_date": 1447883292, "creation_date": 1447882614, "answer_id": 33790893, "question_id": 33790401, "link": "https://stackoverflow.com/questions/33790401/writing-a-c-program-to-delete-space-between-strings/33790893#33790893", "title": "Writing a C Program to Delete Space Between Strings", "body": "<p>There are several problems with your program.</p>\n\n<p>Though this initialization of a character array is valid in C</p>\n\n<pre><code>char  str[10]=\"I love you\",temp[20];\n         ^^^^ \n</code></pre>\n\n<p>nevertheless the array <code>str</code> will not contain the terminating zero of the string literal <code>\"I love you\"</code> because the string literal contains 11 characters including the terminating zero. This makes some difficulties in processing of the array.</p>\n\n<p>It is better to declare the array either like</p>\n\n<pre><code>char  str[11]=\"I love you\",temp[20];\n         ^^^^ \n</code></pre>\n\n<p>or like</p>\n\n<pre><code>char  str[]=\"I love you\",temp[20];\n         ^^^^ \n</code></pre>\n\n<p>In this case the array will contain the terminating zero.</p>\n\n<p>In this statement</p>\n\n<pre><code>if(str[i] ==\" \") {\n            ^^^^\n</code></pre>\n\n<p>there is compared a character with a pointer because the string literal <code>\" \"</code> is implicitly converted to pointer to its first character.</p>\n\n<p>I think you mean a character constant instead of the string literal</p>\n\n<pre><code>if(str[i] == ' ') {\n             ^^^^\n</code></pre>\n\n<p>Take into account that variable <code>j</code> was not initialized. So the program has undefined behavior. At least you should write</p>\n\n<pre><code>int i,j = 0;\n      ^^^^^\n</code></pre>\n\n<p>And the program can be written without using an auxiliary array.</p>\n\n<p>It could look for example the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( void )\n{\n    char  str[] = \"I love you\";\n\n    size_t i = 0;\n\n    while ( str[i] &amp;&amp; str[i] != ' ' ) i++;\n\n    size_t j = i;\n\n    while ( str[i] )\n    {\n        if ( str[++i] != ' ' ) str[j++] = str[i];\n    }\n\n    puts( str );\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Iloveyou\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5578530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wxsI6ZElp2E/AAAAAAAAAAI/AAAAAAAAAC0/4p0edmtXqZI/photo.jpg?sz=128", "display_name": "Abhisek Rajput", "link": "https://stackoverflow.com/users/5578530/abhisek-rajput"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1448070347, "creation_date": 1447880892, "last_edit_date": 1448070347, "question_id": 33790401, "link": "https://stackoverflow.com/questions/33790401/writing-a-c-program-to-delete-space-between-strings", "title": "Writing a C Program to Delete Space Between Strings", "body": "<p>I want to create a program that removes space between characters in a string. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include&lt;string.h&gt; \n#include&lt;stdlib.h&gt; \n#include&lt;stdio.h&gt; \nint main(){ \n    char  str[10]=\"I love you\",temp[20];\n    int i,j;  \n    for(i=0;str[i];i++){     \n        if(str[i] ==\" \"){              \n        }    \n        else{         \n            temp[j]=str[i];       \n            j++;\n        }\n    } \n    temp[j]='\\0'; \n    strcpy(str,temp); \n    printf(\"%s\",str);  \n}\n</code></pre>\n"}, {"tags": ["c++", "c", "assembly"], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1447881093, "post_id": 33790445, "comment_id": 55347956, "body": "Good catch.  It should be <code>bl</code> instead of <code>ebx</code>."}, {"owner": {"reputation": 115, "user_id": 5518551, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd8c4fe528b5da5d18c8f4e3faef672?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Nguyen", "link": "https://stackoverflow.com/users/5518551/andrew-nguyen"}, "edited": false, "score": 0, "creation_date": 1447881668, "post_id": 33790445, "comment_id": 55348277, "body": "Whammm-o!!! Thank you so much. Since I am still new, it is a bit difficult remember the size of each register. To be clear, bl is 8 bit, bx is 16 bit, and ebx is 32 bit? Is every char[] index 8 bit worth of data? Thank you again!"}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 1, "creation_date": 1447882233, "post_id": 33790445, "comment_id": 55348600, "body": "Yes, the registers have these width. The size of one char is 8-bit."}, {"owner": {"reputation": 115, "user_id": 5518551, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd8c4fe528b5da5d18c8f4e3faef672?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Nguyen", "link": "https://stackoverflow.com/users/5518551/andrew-nguyen"}, "edited": false, "score": 0, "creation_date": 1447882286, "post_id": 33790445, "comment_id": 55348641, "body": "@MartinZabel Understood. Thanks again for the clarifications. Cheers!"}], "tags": [], "owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "is_accepted": true, "score": 6, "last_activity_date": 1451570685, "last_edit_date": 1451570685, "creation_date": 1447881034, "answer_id": 33790445, "question_id": 33790106, "link": "https://stackoverflow.com/questions/33790106/x86-intel-assembly-and-c-stack-around-array-corrupted/33790445#33790445", "title": "x86 Intel Assembly and C++ - Stack around array corrupted", "body": "<p>I have no assembler to compile your code, but you write 32-bit values into a <code>char[]</code> at this line:</p>\n\n<pre><code>mov [eax],ebx           ;Copy the 0's or 1's into the array location\n</code></pre>\n\n<p>So, the last write will update the memory locations <code>arr[SIZE-1]</code> to <code>arr[SIZE+2]</code>.</p>\n"}], "owner": {"reputation": 115, "user_id": 5518551, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd8c4fe528b5da5d18c8f4e3faef672?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Nguyen", "link": "https://stackoverflow.com/users/5518551/andrew-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 33790445, "answer_count": 1, "score": 3, "last_activity_date": 1451570685, "creation_date": 1447879909, "last_edit_date": 1447954109, "question_id": 33790106, "link": "https://stackoverflow.com/questions/33790106/x86-intel-assembly-and-c-stack-around-array-corrupted", "title": "x86 Intel Assembly and C++ - Stack around array corrupted", "body": "<p><strong>Error:</strong></p>\n\n<pre><code>Run-Time Check Failure #2 - Stack around the variable 'arr' was corrupted.\n</code></pre>\n\n<p>This seems to be a common error on this forum; however, I was unable to find one that had assembly code mixed into it. Basically, my program is to convert decimal to binary (16-bit representation). After completing the coding, everything seems to compute correctly and convert the decimal to binary without an issue; however, after the <strong>\"Press any key to continue . . .\"</strong>, the error above pops up.</p>\n\n<p>I do not believe the C++ code is causing the issue as it is very basic, and is there only to invoke the assembly function.</p>\n\n<p>Again, the computation is correct as the program will produce the correct conversion (i.e: Decimal = 10, Binary Conversion: 0000000000001010), but just giving me the error at the end of the program.</p>\n\n<p><strong>C++ Code:</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nextern\"C\" void decToBin(char[], int, int);\n\nint main()\n{\n//Initialize array and variables\nconst int SIZE = 16;\nchar arr[SIZE] = { NULL };\nint dec = 0;\n\n//Ask user for integer that they want to convert\ncout &lt;&lt; \"Please enter integer you want to convert to binary: \";\ncin &gt;&gt; dec;\n\n//Assembly function to convert integer\ndecToBin(arr, dec, SIZE);\n\ncout &lt;&lt; \"The 16-bit binary representation of \" &lt;&lt; dec &lt;&lt; \" is: \";\n\n//Display the 16-bit binary conversion\nfor (int i = 0; i &lt; SIZE; i++)\n    cout &lt;&lt; arr[i];\n\ncout &lt;&lt; endl;\n\nsystem(\"PAUSE\");\nreturn 0;\n}\n</code></pre>\n\n<p><strong>Assembly Code:</strong></p>\n\n<pre><code>.686\n.model flat\n\n.code\n\n_decToBin PROC              ;Start of project\n\nstart:\npush ebp\nmov ebp,esp             ;Stack pointer to ebp\n\nmov eax,[ebp+8]         ;Address of first array element\nmov cx,[ebp+12]         ;Integer number being passed - Copying onto 16 bit register\nmov edx,[ebp+16]        ;Size of array\n\nloopme:                     ;Loop to fill in array\nmov ebx,0               ;Initializes ebx to store carry flag after shift\ncmp edx,0               ;Compare edx with 0 to see if we should continue\nje alldone              \n\nshl cx,1                ;Shift the value to the left\nadc ebx,0               ;Check carry flag and add 1 if CF(CY) is set to 1 and stay at 0 if CF(CY) is 0\nadd ebx,48              ;Since array is CHAR, adding 48 will give correct 0 or 1 instead of null\n\nmov [eax],ebx           ;Copy the 0's or 1's into the array location\n\ndec edx                 ;Decrement the counter\ninc eax                 ;Move the array up an index\n\njmp loopme\n\nalldone:    \npop ebp\nret\n\n_decToBin ENDP\n\nEND\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory", "dereference"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 4, "creation_date": 1447879809, "post_id": 33790036, "comment_id": 55347194, "body": "How do you print the value? What is the size of <code>long</code> on your system? 32-bit or 64-bit?"}, {"owner": {"reputation": 371, "user_id": 5578439, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b1ab467240dca27dcab43835dc5c104b?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/5578439/neo"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1447879946, "post_id": 33790036, "comment_id": 55347267, "body": "@cad I mentioned in my question. It is a x86_64 system and I am debugging my code in gdb. It is a very small but independent fraction of the code. Thanks for helping"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1447880015, "post_id": 33790036, "comment_id": 55347316, "body": "Ouh, yeah, overlooked that, sorry."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1447880088, "post_id": 33790036, "comment_id": 55347368, "body": "Anyway, only <code>intptr_t</code> and <code>uintptr_t</code> are guaranteed to be able to hold pointer integer values; currently, your program is implementation-defined"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1447880288, "post_id": 33790036, "comment_id": 55347469, "body": "Since this is a nice small independent piece of code, you should be able to provide us with a nice small independent MCVE (<a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable Example?</a>) that shows the problem you are seeing \u2014 code and sample output.  It is not clear what you are up to yet, and therefore it is not clear what&#39;s going wrong.  What is <code>sizeof(void *)</code> and <code>sizeof(unsigned long)</code> on this machine/compiler?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447880553, "post_id": 33790036, "comment_id": 55347619, "body": "This code may violate the strict aliasing rule, depending on how the space pointed to by <code>a</code> was allocated."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1447880656, "post_id": 33790250, "comment_id": 55347684, "body": "minor nitpick: <code>(uint64_t)b</code> would cause undefined behaviour if the pointer could not be represented in a <code>uint64_t</code>  ; using <code>(uintptr_t)</code> for the right-hand side avoids UB"}, {"owner": {"reputation": 371, "user_id": 5578439, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b1ab467240dca27dcab43835dc5c104b?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/5578439/neo"}, "edited": false, "score": 0, "creation_date": 1447880904, "post_id": 33790250, "comment_id": 55347836, "body": "Thanks for helping. When I debug on gdb, address of b = <code>0x400002728</code> but the value at a = <code>0x400000010:    0x00002728</code>. I still don&#39;t get it, why would it only copy last 4 and not full address? Sorry, if this seems naive. I am a beginner"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447880927, "post_id": 33790250, "comment_id": 55347851, "body": "@M.M, yes, but the answer is already expressly provisional on the converted value fitting in 8 bytes.  If it does not, then UB is moot because the whole exercise is pointless."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1447881088, "post_id": 33790250, "comment_id": 55347950, "body": "@ShekharSharma, you are asking <code>gdb</code> the wrong question, as judged by the fact that it is printing a four-byte value for you.  (8 hexadecimal digits = 4 bytes)"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1447880357, "creation_date": 1447880357, "answer_id": 33790250, "question_id": 33790036, "link": "https://stackoverflow.com/questions/33790036/write-address-to-a-pointer/33790250#33790250", "title": "Write address to a pointer", "body": "<p>Why would you involve a separate, unrelated type of uncertain size?  If you want to store the pointer value in exactly 8 bytes (and supposing that the value <em>fits</em> in 8 bytes), you would spell that like so:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\nstatic void write_add(void *a, char *b) {\n    *(uint64_t *) a = (uint64_t) b; \n}\n</code></pre>\n\n<p>You could also use <code>memcpy()</code>, but that seems a bit heavy-handed.</p>\n\n<p>Do note, however, that C guarantees nothing about the size of the representation of pointer values.  Although it is likely that 64 bits is enough on your system, you cannot safely assume that it is enough on every system.</p>\n"}, {"tags": [], "owner": {"reputation": 1113, "user_id": 4092381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-iUd348W6B_A/AAAAAAAAAAI/AAAAAAAAAjs/0d8MLWyOoFo/photo.jpg?sz=128", "display_name": "Jordan Melo", "link": "https://stackoverflow.com/users/4092381/jordan-melo"}, "is_accepted": false, "score": 0, "last_activity_date": 1447880435, "creation_date": 1447880435, "answer_id": 33790276, "question_id": 33790036, "link": "https://stackoverflow.com/questions/33790036/write-address-to-a-pointer/33790276#33790276", "title": "Write address to a pointer", "body": "<p><code>unsigned long</code> is not necessarily 64 bits on your platform. You can't make that assumption simply because you're on a x86_64 platform. I'm willing to bet it's actually 32 bits.</p>\n\n<p>You should use <code>uintptr_t</code> instead as suggested by cad. This type is always defined to be a type that is big enough to contain a pointer on your platform.</p>\n"}], "owner": {"reputation": 371, "user_id": 5578439, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b1ab467240dca27dcab43835dc5c104b?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/5578439/neo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 33790250, "answer_count": 2, "score": 0, "last_activity_date": 1447880435, "creation_date": 1447879621, "question_id": 33790036, "link": "https://stackoverflow.com/questions/33790036/write-address-to-a-pointer", "title": "Write address to a pointer", "body": "<p>I have a pointer <code>char *a</code> pointing to a block of memory. I have another pointer <code>char *b</code> that points to a memory block. Let's say b points to address <code>0x10001111</code>. I want to write this address to next 8 bytes to the memory block pointed by a. In short, when I deference a, I should get the next 8 bytes of memory and value =  <code>0x10001111</code>. How do I do that? This is a x86_64 machine. <br/><br/>\nMy current code:</p>\n\n<pre><code>static void write_add(void *a, char *b)\n{                                                                                                                                                                                                                                      *(unsigned long *)a= (unsigned long)b;\n *(unsigned long *)a= (unsigned long)b; \n return;\n}\n</code></pre>\n\n<p>I see only 0x00001111 on dereferencing a. Why am I not able to see the complete address?</p>\n"}, {"tags": ["c++", "c", "ffi", "nim-lang"], "answers": [{"tags": [], "owner": {"reputation": 1713, "user_id": 1089957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/KCJWw.jpg?s=128&g=1", "display_name": "JesseTG", "link": "https://stackoverflow.com/users/1089957/jessetg"}, "is_accepted": false, "score": 0, "last_activity_date": 1447888146, "creation_date": 1447888146, "answer_id": 33792272, "question_id": 33789764, "link": "https://stackoverflow.com/questions/33789764/nim-ffi-using-existing-type-to-wrap-a-c-type/33792272#33792272", "title": "Nim FFI: Using existing type to wrap a C++ type", "body": "<p>Actually, it doesn't look like I can do this, at least not between <code>basic2d.Vector2d</code> and <code>b2Vec2</code>.  The former is made of two 64-bit floats, and the latter is made of two 32-bit floats.</p>\n"}], "owner": {"reputation": 1713, "user_id": 1089957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/KCJWw.jpg?s=128&g=1", "display_name": "JesseTG", "link": "https://stackoverflow.com/users/1089957/jessetg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565543684, "creation_date": 1447878552, "last_edit_date": 1565543684, "question_id": 33789764, "link": "https://stackoverflow.com/questions/33789764/nim-ffi-using-existing-type-to-wrap-a-c-type", "title": "Nim FFI: Using existing type to wrap a C++ type", "body": "<p>I'm putting together a Nim wrapper for <a href=\"http://box2d.org/\" rel=\"nofollow\">Box2D</a> using <a href=\"https://github.com/nim-lang/c2nim\" rel=\"nofollow\"><code>c2nim</code></a>.</p>\n\n<p>Box2D has its own mathematical vector class, <a href=\"https://github.com/erincatto/Box2D/blob/master/Box2D/Box2D/Common/b2Math.h#L53\" rel=\"nofollow\"><code>b2Vec2</code></a>.  If I were using Box2D in raw C++, I'd just use that class.  Simple.</p>\n\n<p>But Nim already has such functionality in the <a href=\"http://nim-lang.org/docs/basic2d.html\" rel=\"nofollow\"><code>basic2d</code></a> module's <a href=\"http://nim-lang.org/docs/basic2d.html#Vector2d\" rel=\"nofollow\"><code>Vector2d</code></a> type.</p>\n\n<p>I want my wrapper's interface to use the built-in <code>Vector2d</code> type so that users of this wrapper don't have to mentally juggle two different vector types.  This entails somehow using <code>Vector2d</code> as a Nim interface to <code>b2Vec2</code>.  <strong>How can I do this?</strong></p>\n\n<p><strong>Things of note:</strong></p>\n\n<ul>\n<li><s>Both <code>b2Vec2</code> and <code>Vector2d</code> are made of just two 32-bit <code>float</code>s.</s>  <strong>I'm wrong.  Nim <code>float</code>s are 64-bit.</strong></li>\n<li><code>Vector2d</code> is part of the Nim standard library, so I can't modify its definition.</li>\n<li>I'll create a wrapper for <code>b2Vec2</code> if I have to, but I'd like to avoid doing so, and I definitely don't want users to see it.</li>\n</ul>\n"}, {"tags": ["c", "valgrind"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447877712, "post_id": 33789306, "comment_id": 55346025, "body": "include the exact and complete output of valgrind. Also it would be a huge help if you could create a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>. There are heaps of unknowns in what you have posted so far -- you could be messing up memory allocation for just about anything."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1447877842, "post_id": 33789306, "comment_id": 55346101, "body": "complaining about <code>*index = (warehouse.elemcount - 1);</code> suggests the problem is with <code>*index</code>, not with <code>sprite[i]</code> as you seem to be focusing on. . Make sure that <code>index</code> is pointing to allocated memory."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447878452, "post_id": 33789306, "comment_id": 55346467, "body": "M.M, index is sprite[0], as I claimed earlier. The full valgrind&#39;s output is as follows: Invalid write of size 4 in SmlWhsAdd in local/smlwarehouse.c:353 Stack of calls, where &amp;sprite[0] is going inside of WhsAdd, Then &quot;Address 0x6f31538 is 188,272 bytes inside a block of size 189,280 free&#39;d Stack of the same calls as earlier, realloc at the first place, pointing to realloc line in the WhsAdd.  You&#39;ve said about heaps of unknown- I&#39;ve tried to make MCVE, but failed - can&#39;t repeat it in just messing with similar situations and structs/unions.  What can I do else?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1447878663, "post_id": 33789306, "comment_id": 55346575, "body": "I find the proposition that Valgrind misunderstands your code to be highly doubtful, because to do so Valgrind would have to try to understand your code in the first place.  It does not.  It simply observes what your code <i>does</i> with memory at run time.  If it says you perform an invalid read, then it&#39;s virtually certain that you do perform an invalid read."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447878695, "post_id": 33789306, "comment_id": 55346595, "body": "I also tried to print the pointer&#39;s value: <code>SmlWidgetSpritesCreate &amp;(warehouse.sprite[i])166531448</code> <code>SmlImageCreate index 166531448</code> <code>SmlWhsAdd index 166531448</code> So, the pointer doesn&#39;t broke during the run."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447878857, "post_id": 33789306, "comment_id": 55346696, "body": "John,  I&#39;ve located the block, that is suspicious from the valgrind&#39;s point of view, but can&#39;t get any further. He&#39;s telling me that I didn&#39;t rightfully allocated the value of index, but it&#39;s taken from static array."}, {"owner": {"reputation": 5077, "user_id": 2327831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/acb1ec5c15fa33042fa79847c55da18d?s=128&d=identicon&r=PG", "display_name": "this", "link": "https://stackoverflow.com/users/2327831/this"}, "edited": false, "score": 1, "creation_date": 1447878932, "post_id": 33789306, "comment_id": 55346726, "body": "@AlexTiger Can you create a minimal example that reproduces the error?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1447879128, "post_id": 33789306, "comment_id": 55346820, "body": "A minimal <i>complete</i> example, please.  Who knows what all these types are, what code these macros provide, and how, specifically, you end up where you do?  The necessary information is not there."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447879816, "post_id": 33789306, "comment_id": 55347198, "body": "I tried to reproduce it in minimal code. I failed at it. I will try another time, but don&#39;t expect a success."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447880362, "post_id": 33789306, "comment_id": 55347519, "body": "YAY! MCVE: <a href=\"http://pastebin.com/r5T5ZBPC\" rel=\"nofollow noreferrer\">pastebin.com/r5T5ZBPC</a> At last I&#39;m able to shorten everything to 100 lines to demonstrate."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1447885190, "post_id": 33789306, "comment_id": 55350206, "body": "FYI: You may want to use the sanitizers (asan, etc.) available now, which use GCC or Clang to instrument binaries.  They offer mostly the same diagnostics as Valgrind, but the performance and diagnostics are much improved."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447881859, "post_id": 33790540, "comment_id": 55348393, "body": "M.M, valgrind is bitching about *index = stuff, not warehouse.elem[...] = stuff."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447882400, "post_id": 33790540, "comment_id": 55348724, "body": "Braces doesn&#39;t work in my gcc, nullified instead: <a href=\"http://pastebin.com/GqenXUi2\" rel=\"nofollow noreferrer\">pastebin.com/GqenXUi2</a> Still complainings."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447882458, "post_id": 33790540, "comment_id": 55348756, "body": "just a reminder, gen&amp;wdg are in union, init of one thing will rewrite another."}, {"owner": {"reputation": 5077, "user_id": 2327831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/acb1ec5c15fa33042fa79847c55da18d?s=128&d=identicon&r=PG", "display_name": "this", "link": "https://stackoverflow.com/users/2327831/this"}, "edited": false, "score": 0, "creation_date": 1447884394, "post_id": 33790540, "comment_id": 55349812, "body": "Like pulling a rug under your own feet. I can&#39;t believe I didn&#39;t see this. Honestly OP&#39;s entire design smells badly."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447884408, "post_id": 33790540, "comment_id": 55349820, "body": "removing old comments relating to uninitilalized variables now"}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447885142, "post_id": 33790540, "comment_id": 55350190, "body": "@M.M, about your upd: There is only one realloc - the increasing of the warehouse&#39;s elem. SmlIndex is no pointer, it&#39;s just a number - 0, 1, 2, which is <i>index</i>."}, {"owner": {"reputation": 5077, "user_id": 2327831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/acb1ec5c15fa33042fa79847c55da18d?s=128&d=identicon&r=PG", "display_name": "this", "link": "https://stackoverflow.com/users/2327831/this"}, "reply_to_user": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447885226, "post_id": 33790540, "comment_id": 55350226, "body": "@AlexTiger No it is a pointer, that points to memory that gets freed. You dereference it and cause the uninitialized read. Can I ask you, what is the reason behind all those nested structs and unions, why just why...?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447885540, "post_id": 33790540, "comment_id": 55350371, "body": "@AlexTiger <code>SmlIndex * index</code> means that <code>index</code> is a pointer. It holds the address of a memory location.  By giving <code>&amp;(warehouse.elem[window].data.wdg.sprite[0])</code> as argument, it means that <code>index</code> is pointing at a piece of memory which is inside the <code>warehouse.elem</code> . You free that memory location and then write <code>*index = </code>, which writes into freed space."}, {"owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "edited": false, "score": 0, "creation_date": 1447885742, "post_id": 33790540, "comment_id": 55350451, "body": "@M.M, understood now. Thank you. Works without complainings with temp var. Thank you again."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1447884906, "last_edit_date": 1447884906, "creation_date": 1447881354, "answer_id": 33790540, "question_id": 33789306, "link": "https://stackoverflow.com/questions/33789306/valgrinds-behaviour-for-structs-unions/33790540#33790540", "title": "Valgrind&#39;s behaviour for structs + unions", "body": "<p><em>(Edit history note: the MCVE originally used uninitialized variables, however after initializing all of those, the problem persists)</em></p>\n\n<p>In the MCVE, the issue comes from:</p>\n\n<pre><code>SmlWhsAdd(sprite, &amp;(warehouse.elem[window].data.wdg.sprite[0]));\n</code></pre>\n\n<p>The second argument is a pointer into the space allocated by an earlier call to <code>realloc</code>.</p>\n\n<p>However, inside the <code>SmlWhsAdd</code> function, <code>realloc</code> is called on this space, which allocates a new block and frees the old. This leaves the second argument pointing into freed space.</p>\n\n<hr>\n\n<p>To fix this, my suggestion would be to review all uses of <code>SmlWhsAdd</code> and avoid passing a pointer which is under <code>warehouse.elem</code>.  </p>\n\n<p>One option might be to use a temporary variable and then assign the index after the call; another option might be to pass some other information which allows the <code>SmlWhsAdd</code> function to compute the location to write the index, after it performs <code>realloc</code>; or if the index is always at the end you don't even need to have that parameter at all because the caller can do <code>warehouse.elemcount-1</code> after.</p>\n"}], "owner": {"reputation": 351, "user_id": 2932207, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8efe80ed5f74272fadabb3f2d2deee74?s=128&d=identicon&r=PG", "display_name": "Alex  Tiger", "link": "https://stackoverflow.com/users/2932207/alex-tiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 33790540, "answer_count": 1, "score": 1, "last_activity_date": 1447884906, "creation_date": 1447877012, "last_edit_date": 1447880472, "question_id": 33789306, "link": "https://stackoverflow.com/questions/33789306/valgrinds-behaviour-for-structs-unions", "title": "Valgrind&#39;s behaviour for structs + unions", "body": "<p>I have a big C-project and thanks to valgrind I cleaned up some mess I was doing with a memory management. I cleaned up everything except for one thing, and after a week of analysis I'm starting to think that that's valgrind's misunderstanding of my code, rather than my mistake. The program is running for good, but that means nothing (I've seen the case when the program runs for good for weeks and then stucks because of 31th flipped bit in an int).</p>\n\n<p>My code uses the next idea: there's the a storage (in terms of my project a \"warehouse\"), which holds all the kinds of structures I desired to build. I use the trick from the Xlib to keep this as small as possible in memory:</p>\n\n<pre><code> typedef struct\n {\n     // data\n } TypeA\n\n typedef struct\n {\n     // data\n } TypeB\n\n typedef struct\n {\n     // data\n } TypeC\n\n typedef union\n {\n    TypeA typea;\n    TypeB typeb;\n    TypeC typec;\n } UniType;\n\n typedef struct\n {\n     int type;\n     UniType data;\n } Element;\n</code></pre>\n\n<p>Then I create an element:</p>\n\n<pre><code>SmlErrors SmlWhsAdd(SmlElement element, SmlIndex * index)\n{\n    SML_CHECKPTR(index);\n\n    SmlElement * ptrold = warehouse.elem;\n\n    warehouse.elem      = realloc(warehouse.elem,\n                                  (++warehouse.elemcount) * sizeof(SmlElement));\n    if (!(warehouse.elem))\n    {\n        warehouse.elem = ptrold;\n        *index         = 0;\n        warehouse.elemcount--;\n        return SML_ERR_BADALLOC;\n    }\n\n    warehouse.elem[warehouse.elemcount - 1] = element;\n\n    *index = (warehouse.elemcount - 1);\n\n    return SML_ERR_SUCCESS;\n}\n</code></pre>\n\n<p><em>For those, who thinks that ptr = realloc(ptr... is bad - look closer, I save the old one and restore it after. I'm planning to replace all alloc tools with myalloc to crash the program there instead of continuing work</em></p>\n\n<p>This code is clear, valgrind is silent. Except for one case. One of my \"TypeX\" structures (if to be exact, child-of-child-of-TypeX) contains an array:</p>\n\n<pre><code>SmlIndex     sprite[SML_THEMEBLOCK_SIZE];\n</code></pre>\n\n<p>Every sprite is also an index from warehouse, so it's mobiles in mobile, as that array is a part of one of the element of that warehouse (in the house that Jack built).</p>\n\n<p>I use the aforementioned function to write the value inside of one of the sprites:</p>\n\n<pre><code>SML_CHECKLOC(SmlImageCreate(&amp;(widget-&gt;sprite[i]),\n                            widget-&gt;geometry.size));\n// Which calls `WhsAdd` with `&amp;(widget-&gt;sprite[i]` as `index`-parameter.\n</code></pre>\n\n<p>And every time I call it this way the valgrind is whining about <code>Invalid write of size 4</code>. Every time I'm trying to use the value from <code>sprite[x]</code> after that - <code>Invalid read of size 4</code>. If to be exact, it's whining about the following line:</p>\n\n<pre><code>*index = (warehouse.elemcount - 1);\n</code></pre>\n\n<p>My system is 32bit, SmlIndex is uint32_t</p>\n\n<p>Please, give me a clue about where to dig. After a week of research I'm out of ideas. That's why I'm started to think that that might be valgrind's bug - I also 've heard that it's working strange with unions and structs in it.</p>\n\n<p>One more thing.</p>\n\n<pre><code>widget-&gt;sprite[i] = 0; // No complainings.\nSmlImageCreate(&amp;(widget-&gt;sprite[i], ...) // Complainings.\n</code></pre>\n\n<p>Can someone give me a hand, please? I'm drowning in that swamp. Any suggestions about where to look. Anything.</p>\n\n<p><em>UPD</em>:\nMCVE: <a href=\"http://pastebin.com/r5T5ZBPC\" rel=\"nofollow\">http://pastebin.com/r5T5ZBPC</a></p>\n\n<p>Regards,\nAlex.</p>\n"}, {"tags": ["c", "gcc", "lua"], "comments": [{"owner": {"reputation": 75, "user_id": 4159461, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a9fc33a08f075f175f32c2e299b43a71?s=128&d=identicon&r=PG&f=1", "display_name": "DevBush", "link": "https://stackoverflow.com/users/4159461/devbush"}, "edited": false, "score": 0, "creation_date": 1447876939, "post_id": 33789276, "comment_id": 55345551, "body": "This is a working program."}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 2, "creation_date": 1447884942, "post_id": 33789276, "comment_id": 55350093, "body": "What errors do you get? Why don&#39;t you statically link Lua instead of grafting the source code to your project?"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 4159461, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a9fc33a08f075f175f32c2e299b43a71?s=128&d=identicon&r=PG&f=1", "display_name": "DevBush", "link": "https://stackoverflow.com/users/4159461/devbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1447970312, "last_edit_date": 1495539870, "creation_date": 1447970312, "answer_id": 33815116, "question_id": 33789276, "link": "https://stackoverflow.com/questions/33789276/compiling-c-code-with-lua-source/33815116#33815116", "title": "Compiling C code with lua source", "body": "<p>The answer was found in:\n<a href=\"https://stackoverflow.com/questions/20848275/compiling-lua-create-so-files\">Compiling Lua - create .so files?</a>\nto make liblua5.1.so use <b>make so</b></p>\n\n<p>The make file used:</p>\n\n<pre><code># makefile for building Lua\n# see ../INSTALL for installation instructions\n# see ../Makefile and luaconf.h for further customization\n\n# == CHANGE THE SETTINGS BELOW TO SUIT YOUR ENVIRONMENT =======================\n\n# Your platform. See PLATS for possible values.\nPLAT= none\n\nCC= gcc\nCFLAGS= -O2 -Wall $(MYCFLAGS)\nAR= ar rcu\nRANLIB= ranlib\nRM= rm -f\nLIBS= -lm $(MYLIBS)\n\nMYCFLAGS=-fPIC\nMYLDFLAGS=\nMYLIBS=\n\n# == END OF USER SETTINGS. NO NEED TO CHANGE ANYTHING BELOW THIS LINE =========\n\nPLATS= aix ansi bsd freebsd generic linux macosx mingw posix solaris\n\nLUA_A=  liblua.a\nLUA_SO= liblua5.1.so\nCORE_O= lapi.o lcode.o ldebug.o ldo.o ldump.o lfunc.o lgc.o llex.o lmem.o \\\n    lobject.o lopcodes.o lparser.o lstate.o lstring.o ltable.o ltm.o  \\\n    lundump.o lvm.o lzio.o\nLIB_O=  lauxlib.o lbaselib.o ldblib.o liolib.o lmathlib.o loslib.o ltablib.o \\\n    lstrlib.o loadlib.o linit.o\n\nLUA_T=  lua\nLUA_O=  lua.o\n\nLUAC_T= luac\nLUAC_O= luac.o print.o\n\nALL_O= $(CORE_O) $(LIB_O) $(LUA_O) $(LUAC_O)\n#ALL_T= $(LUA_A) $(LUA_T) $(LUAC_T)\nALL_T= $(LUA_A) $(LUA_T) $(LUAC_T) $(LUA_SO) \nALL_A= $(LUA_A)\n\ndefault: $(PLAT)\n\nall:    $(ALL_T)\n\no:  $(ALL_O)\n\na:  $(ALL_A)\n\nso: $(LUA_SO)\n\n$(LUA_SO): $(CORE_O) $(LIB_O)\n    $(CC) -shared -ldl -Wl,-soname,$(LUA_SO) -o $@ $? -lm $(MYLDFLAGS)\n    #ln -sf $(LUA_SO).$(R) $(LUA_SO).$(V)\n    #ln -sf $(LUA_SO).$(R) $(LUA_SO)\n\n$(LUA_A): $(CORE_O) $(LIB_O)\n    $(AR) $@ $(CORE_O) $(LIB_O) # DLL needs all object files\n    $(RANLIB) $@\n\n$(LUA_T): $(LUA_O) $(LUA_A)\n    $(CC) -o $@ $(MYLDFLAGS) $(LUA_O) $(LUA_A) $(LIBS)\n\n$(LUAC_T): $(LUAC_O) $(LUA_A)\n    $(CC) -o $@ $(MYLDFLAGS) $(LUAC_O) $(LUA_A) $(LIBS)\n\nclean:\n    $(RM) $(ALL_T) $(ALL_O)\n\ndepend:\n    @$(CC) $(CFLAGS) -MM l*.c print.c\n\necho:\n    @echo \"PLAT = $(PLAT)\"\n    @echo \"CC = $(CC)\"\n    @echo \"CFLAGS = $(CFLAGS)\"\n    @echo \"AR = $(AR)\"\n    @echo \"RANLIB = $(RANLIB)\"\n    @echo \"RM = $(RM)\"\n    @echo \"MYCFLAGS = $(MYCFLAGS)\"\n    @echo \"MYLDFLAGS = $(MYLDFLAGS)\"\n    @echo \"MYLIBS = $(MYLIBS)\"\n\n# convenience targets for popular platforms\n\nnone:\n    @echo \"Please choose a platform:\"\n    @echo \"   $(PLATS)\"\n\naix:\n    $(MAKE) all CC=\"xlc\" CFLAGS=\"-O2 -DLUA_USE_POSIX -DLUA_USE_DLOPEN\" MYLIBS=\"-ldl\" MYLDFLAGS=\"-brtl -bexpall\"\n\nansi:\n    $(MAKE) all MYCFLAGS=-DLUA_ANSI\n\nbsd:\n    $(MAKE) all MYCFLAGS=\"-DLUA_USE_POSIX -DLUA_USE_DLOPEN\" MYLIBS=\"-Wl,-E\"\n\nfreebsd:\n    $(MAKE) all MYCFLAGS=\"-DLUA_USE_LINUX\" MYLIBS=\"-Wl,-E -lreadline\"\n\ngeneric:\n    $(MAKE) all MYCFLAGS=\n\nlinux:\n    $(MAKE) all MYCFLAGS=-DLUA_USE_LINUX MYLIBS=\"-Wl,-E -ldl -lreadline -lhistory -lncurses\"\n\nmacosx:\n    $(MAKE) all MYCFLAGS=-DLUA_USE_LINUX MYLIBS=\"-lreadline\"\n# use this on Mac OS X 10.3-\n#   $(MAKE) all MYCFLAGS=-DLUA_USE_MACOSX\n\nmingw:\n    $(MAKE) \"LUA_A=lua51.dll\" \"LUA_T=lua.exe\" \\\n    \"AR=$(CC) -shared -o\" \"RANLIB=strip --strip-unneeded\" \\\n    \"MYCFLAGS=-DLUA_BUILD_AS_DLL\" \"MYLIBS=\" \"MYLDFLAGS=-s\" lua.exe\n    $(MAKE) \"LUAC_T=luac.exe\" luac.exe\n\nposix:\n    $(MAKE) all MYCFLAGS=-DLUA_USE_POSIX\n\nsolaris:\n    $(MAKE) all MYCFLAGS=\"-DLUA_USE_POSIX -DLUA_USE_DLOPEN\" MYLIBS=\"-ldl\"\n\n# list targets that do not create files (but not all makes understand .PHONY)\n.PHONY: all $(PLATS) default o a clean depend echo none\n\n# DO NOT DELETE\n\nlapi.o: lapi.c lua.h luaconf.h lapi.h lobject.h llimits.h ldebug.h \\\n  lstate.h ltm.h lzio.h lmem.h ldo.h lfunc.h lgc.h lstring.h ltable.h \\\n  lundump.h lvm.h\nlauxlib.o: lauxlib.c lua.h luaconf.h lauxlib.h\nlbaselib.o: lbaselib.c lua.h luaconf.h lauxlib.h lualib.h\nlcode.o: lcode.c lua.h luaconf.h lcode.h llex.h lobject.h llimits.h \\\n  lzio.h lmem.h lopcodes.h lparser.h ldebug.h lstate.h ltm.h ldo.h lgc.h \\\n  ltable.h\nldblib.o: ldblib.c lua.h luaconf.h lauxlib.h lualib.h\nldebug.o: ldebug.c lua.h luaconf.h lapi.h lobject.h llimits.h lcode.h \\\n  llex.h lzio.h lmem.h lopcodes.h lparser.h ldebug.h lstate.h ltm.h ldo.h \\\n  lfunc.h lstring.h lgc.h ltable.h lvm.h\nldo.o: ldo.c lua.h luaconf.h ldebug.h lstate.h lobject.h llimits.h ltm.h \\\n  lzio.h lmem.h ldo.h lfunc.h lgc.h lopcodes.h lparser.h lstring.h \\\n  ltable.h lundump.h lvm.h\nldump.o: ldump.c lua.h luaconf.h lobject.h llimits.h lstate.h ltm.h \\\n  lzio.h lmem.h lundump.h\nlfunc.o: lfunc.c lua.h luaconf.h lfunc.h lobject.h llimits.h lgc.h lmem.h \\\n  lstate.h ltm.h lzio.h\nlgc.o: lgc.c lua.h luaconf.h ldebug.h lstate.h lobject.h llimits.h ltm.h \\\n  lzio.h lmem.h ldo.h lfunc.h lgc.h lstring.h ltable.h\nlinit.o: linit.c lua.h luaconf.h lualib.h lauxlib.h\nliolib.o: liolib.c lua.h luaconf.h lauxlib.h lualib.h\nllex.o: llex.c lua.h luaconf.h ldo.h lobject.h llimits.h lstate.h ltm.h \\\n  lzio.h lmem.h llex.h lparser.h lstring.h lgc.h ltable.h\nlmathlib.o: lmathlib.c lua.h luaconf.h lauxlib.h lualib.h\nlmem.o: lmem.c lua.h luaconf.h ldebug.h lstate.h lobject.h llimits.h \\\n  ltm.h lzio.h lmem.h ldo.h\nloadlib.o: loadlib.c lua.h luaconf.h lauxlib.h lualib.h\nlobject.o: lobject.c lua.h luaconf.h ldo.h lobject.h llimits.h lstate.h \\\n  ltm.h lzio.h lmem.h lstring.h lgc.h lvm.h\nlopcodes.o: lopcodes.c lopcodes.h llimits.h lua.h luaconf.h\nloslib.o: loslib.c lua.h luaconf.h lauxlib.h lualib.h\nlparser.o: lparser.c lua.h luaconf.h lcode.h llex.h lobject.h llimits.h \\\n  lzio.h lmem.h lopcodes.h lparser.h ldebug.h lstate.h ltm.h ldo.h \\\n  lfunc.h lstring.h lgc.h ltable.h\nlstate.o: lstate.c lua.h luaconf.h ldebug.h lstate.h lobject.h llimits.h \\\n  ltm.h lzio.h lmem.h ldo.h lfunc.h lgc.h llex.h lstring.h ltable.h\nlstring.o: lstring.c lua.h luaconf.h lmem.h llimits.h lobject.h lstate.h \\\n  ltm.h lzio.h lstring.h lgc.h\nlstrlib.o: lstrlib.c lua.h luaconf.h lauxlib.h lualib.h\nltable.o: ltable.c lua.h luaconf.h ldebug.h lstate.h lobject.h llimits.h \\\n  ltm.h lzio.h lmem.h ldo.h lgc.h ltable.h\nltablib.o: ltablib.c lua.h luaconf.h lauxlib.h lualib.h\nltm.o: ltm.c lua.h luaconf.h lobject.h llimits.h lstate.h ltm.h lzio.h \\\n  lmem.h lstring.h lgc.h ltable.h\nlua.o: lua.c lua.h luaconf.h lauxlib.h lualib.h\nluac.o: luac.c lua.h luaconf.h lauxlib.h ldo.h lobject.h llimits.h \\\n  lstate.h ltm.h lzio.h lmem.h lfunc.h lopcodes.h lstring.h lgc.h \\\n  lundump.h\nlundump.o: lundump.c lua.h luaconf.h ldebug.h lstate.h lobject.h \\\n  llimits.h ltm.h lzio.h lmem.h ldo.h lfunc.h lstring.h lgc.h lundump.h\nlvm.o: lvm.c lua.h luaconf.h ldebug.h lstate.h lobject.h llimits.h ltm.h \\\n  lzio.h lmem.h ldo.h lfunc.h lgc.h lopcodes.h lstring.h ltable.h lvm.h\nlzio.o: lzio.c lua.h luaconf.h llimits.h lmem.h lstate.h lobject.h ltm.h \\\n  lzio.h\nprint.o: print.c ldebug.h lstate.h lua.h luaconf.h lobject.h llimits.h \\\n  ltm.h lzio.h lmem.h lopcodes.h lundump.h\n\n# (end of Makefile)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4159461, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a9fc33a08f075f175f32c2e299b43a71?s=128&d=identicon&r=PG&f=1", "display_name": "DevBush", "link": "https://stackoverflow.com/users/4159461/devbush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1095, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447970393, "creation_date": 1447876903, "last_edit_date": 1447970393, "question_id": 33789276, "link": "https://stackoverflow.com/questions/33789276/compiling-c-code-with-lua-source", "title": "Compiling C code with lua source", "body": "<pre><code>    int init_lua (char *filename,lua_State *L){\n//int inter;\n//lua_State *L = luaL_newstate();\n\nluaL_openlibs(L);\n\nif(luaL_loadfile(L, filename) ){\n    error(L, \"cannot run configuration file: %s\",lua_tostring(L, -1)); \n    return 1;\n    }\nif (lua_pcall(L, 0, 0, 0)){\n    error(L, \"lua_pcall() failed\");\n    return 2;\n    }\n\nreturn 0;\n}\nuint8_t get_interface(unsigned int inteiro,lua_State *L){\nint inter;\n\nlua_getglobal(L,\"ret_ind\"); //fun\u00e7\u00e3o a ser chamada\nlua_pushnumber(L,inteiro); //argumento\n\n// do the call (1 arguments, 1 result)     \nif (lua_pcall(L, 1, 1, 0))\n    error(L, \"error running function 'f': %s\",lua_tostring(L, -1));\n\nif (!lua_isnumber(L, -1))\n    error(L, \"function 'f' must return a number\");\n\ninter = lua_tonumber(L, -1);\nlua_pop(L, 1);  // pop returned value /\n\nreturn (uint8_t)inter;\n}\n\n\nint main(void)\n{\n\nlua_State *L = luaL_newstate();\nprintf(\"apos o load3\\n\");\nif (init_lua(\"pp.lua\",L))\n    printf(\"erro ao tentar inicializar arquivo lua\\n\");\nuint8_t resul;\nresul = get_interface(190,L);\nprintf(\"Index of array: %d\\n\",(int)resul);\n\nresul = get_interface(10000,L);\nprintf(\"Index of array: %d\\n\",(int)resul);\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>The code above as  pp.c</p>\n\n<pre><code>interfaces = {190,3141592,10000}\n\nfunction ret_ind (ip)\n    for i, inter in ipairs(interfaces) do\n            if  inter == ip then\n            return i\n        end\n    end\n\n    return 0;\nend\n</code></pre>\n\n<p>The code above as pp.lua</p>\n\n<p>and the command to compile\ngcc -o pp pp.c -I/usr/include/lua5.1/ -llua5.1</p>\n\n<p>I'm trying to include the source of lua so I don't need have the lua installed on the machine. with the below  I can't compile once I remove the the liblua5.1-0-dev from the system.</p>\n\n<p>gcc -std=c99 -O2 -I./lua5.1/src/  pp.c -o pp.o -llua5.1</p>\n\n<p>with the library on the system I can use local source but global lua5.1 from -llua5.1.</p>\n\n<p>EDIT</p>\n\n<p>After transform the lua source code into shered object (.so) I got a executing program with:\n<i>OBS: I will put the makefile I used as a comment of this post</i></p>\n\n<p>gcc -o pp pp.c -I./lua5.1/src/ -L./lua5.1/src/ -llua5.1\nto execute the program I use \n(must execute the 2 follows command so the ld can find the .so file)</p>\n\n<p>LD_LIBRARY_PATH=./lua5.1/src/\nexport LD_LIBRARY_PATH\nand ran ./pp</p>\n"}, {"tags": ["c", "assembly", "x86-64", "128-bit"], "comments": [{"owner": {"reputation": 384, "user_id": 5239908, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/64891690463fa4000d0fc4f0364c811c?s=128&d=identicon&r=PG", "display_name": "Andriy Lysak", "link": "https://stackoverflow.com/users/5239908/andriy-lysak"}, "edited": false, "score": 0, "creation_date": 1447876936, "post_id": 33789230, "comment_id": 55345549, "body": "just a guess: shifting makes it 128 bits, since you get 64 bits at the beginning. 1 and -1 are im guessing the pos/neg of the number"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1447876961, "post_id": 33789230, "comment_id": 55345565, "body": "Both of the operands to the multiplication must be of the same type. To that end, <code>x</code> is promoted to type <code>__int128</code>, because <code>y</code> is of this type after the cast, and the integer promotion rank of <code>__int128</code> is higher than that of <code>int64_t</code>. One of the conversions is done by <code>cqto</code>, but that only works on <code>rax</code>, so the other is converted by <code>sarq</code>."}, {"owner": {"reputation": 1596, "user_id": 1446139, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7afb11066c85e5c5d28301f285a78be?s=128&d=identicon&r=PG&f=1", "display_name": "denis631", "link": "https://stackoverflow.com/users/1446139/denis631"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1447877101, "post_id": 33789230, "comment_id": 55345665, "body": "@EOF but why do we multiply the low order bits of y with 1 or -1 ? imulq %rax, %rcx   -  this instruction, after the right shift, does exactly that. Since the low order bits, don&#39;t contain any sign information, why do we do that ?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1447877367, "post_id": 33789230, "comment_id": 55345818, "body": "You don&#39;t multiply with <code>1</code> or <code>-1</code>, you multiply with <code>0</code> or <code>-1</code>. The arithmetic right shift does exactly what the <code>cqto</code> does: sign-extend to a whole register (<code>%rcx</code> for the <code>sarq</code>, <code>%rdx</code> for <code>cqto</code>)."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1447878113, "post_id": 33789230, "comment_id": 55346276, "body": "Since <code>imul</code> already provides a 64x64-&gt;128 bit multiply, I don&#39;t see the point of this. You can still explain how it works, of course :) Probably the usual case of disabled optimization, otherwise the compiler is clever enough to use a single <code>imul</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1447878340, "post_id": 33789230, "comment_id": 55346409, "body": "@Jester: But you can&#39;t write <code>imul</code> in C. If you multiply two 64-bit integers, you just get a 64-bit result. You <i>could</i> drop down to inline-assembly though, and do the multiplication in a single instruction."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1447878800, "post_id": 33789230, "comment_id": 55346659, "body": "@EOF no need, as I said, at least <a href=\"http://goo.gl/fmFtgG\" rel=\"nofollow noreferrer\">gcc and clang is clever enough</a> to turn that exact C code into a single <code>imul</code>. icc, for some reason, isn&#39;t."}, {"owner": {"reputation": 1596, "user_id": 1446139, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7afb11066c85e5c5d28301f285a78be?s=128&d=identicon&r=PG&f=1", "display_name": "denis631", "link": "https://stackoverflow.com/users/1446139/denis631"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1448101077, "post_id": 33789230, "comment_id": 55448882, "body": "@EOF please edit my answer, so I&#39;ll know if I am right or wrong. Thanks in advance"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1448371753, "post_id": 33789230, "comment_id": 55552613, "body": "It sounds to me like you want to ask a more general question. Such as if your processor only can do 32*32 to 64 or 64*64 to 64 how to do 128-bit multiplication? That&#39;s a much more interesting question. You don&#39;t want to do <code>xh * yl + yh * xl</code>. You can do that but then you have to figure out overflow. There is a way to do the multiplication without worrying about overflow."}, {"owner": {"reputation": 1596, "user_id": 1446139, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7afb11066c85e5c5d28301f285a78be?s=128&d=identicon&r=PG&f=1", "display_name": "denis631", "link": "https://stackoverflow.com/users/1446139/denis631"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1448372040, "post_id": 33789230, "comment_id": 55552801, "body": "@Zboson yeah. I want a deeper understanding of what is happening under the hood. I know that this formula works, but why ?"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1448372140, "post_id": 33789230, "comment_id": 55552855, "body": "@denis631, well then you have to ask a new question. Your current question is typed to x86-64 which already has an instruction to do 64*64 to 128."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1448440011, "post_id": 33789230, "comment_id": 55585170, "body": "@denis631, you were right not to make another question. I did not understand your question. You could have written it better. It only made sense after reading your answer. I can answer your question now.  Give me a sec."}], "answers": [{"comments": [{"owner": {"reputation": 1596, "user_id": 1446139, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7afb11066c85e5c5d28301f285a78be?s=128&d=identicon&r=PG&f=1", "display_name": "denis631", "link": "https://stackoverflow.com/users/1446139/denis631"}, "edited": false, "score": 1, "creation_date": 1447921616, "post_id": 33793316, "comment_id": 55363200, "body": "thanks for the answer. As I said, it&#39;s the homework written in the book, so I don&#39;t know which compiler was used and with which optimization level flags."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "edited": false, "score": 0, "creation_date": 1447924805, "post_id": 33793316, "comment_id": 55365187, "body": "@TomZych: thanks for the tidy up.  Minor improvement, but definitely an improvement. :)"}, {"owner": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "edited": false, "score": 0, "creation_date": 1447924899, "post_id": 33793316, "comment_id": 55365242, "body": "<i>De rien</i> - almost have my Copy Editor badge :)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 4, "last_activity_date": 1447923950, "last_edit_date": 1447923950, "creation_date": 1447893837, "answer_id": 33793316, "question_id": 33789230, "link": "https://stackoverflow.com/questions/33789230/how-does-this-128-bit-integer-multiplication-work-in-assembly-x86-64/33793316#33793316", "title": "How does this 128 bit integer multiplication work in assembly (x86-64)?", "body": "<p>As always, <strong>compiler options matter</strong>.  That source code with <code>gcc -Og</code> (optimize for debugging) <a href=\"http://goo.gl/GY2PUY\" rel=\"nofollow\">produces very similar asm to your listing</a> (the cast sign-extends both operands to 128bit before doing a full 128x128->128 multiply).  This is exactly what the C standard says should happen (integer promotion).  If you're going to talk about compiler output, you should always say which version of which compiler with what options.  Or just post a link to it on <a href=\"https://gcc.godbolt.org/\" rel=\"nofollow\">godbolt</a>, like the one above.</p>\n\n<p>(Edit: oops, source and asm were from a book that didn't give that info.)</p>\n\n<p>With <code>gcc -O3</code>, gcc takes advantage of the fact that both operands are still really only 64bit, <a href=\"http://goo.gl/c6jxJr\" rel=\"nofollow\">so a single <code>imul</code> is enough</a>.</p>\n\n<hr>\n\n<p>The <code>sar $63, %rcx</code> is part of sign-extending <code>rsi</code> into <code>rcx:rsi</code>, just like <code>cqto</code> sign-extends <code>rax</code> into <code>rdx:rax</code>.</p>\n\n<hr>\n\n<p>Most of this answer was already given by other people in comments, but I don't think anyone else noticed that <code>gcc -Og</code> / <code>-O1</code> gives almost exactly that asm output.</p>\n"}, {"tags": [], "owner": {"reputation": 1596, "user_id": 1446139, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7afb11066c85e5c5d28301f285a78be?s=128&d=identicon&r=PG&f=1", "display_name": "denis631", "link": "https://stackoverflow.com/users/1446139/denis631"}, "is_accepted": false, "score": 2, "last_activity_date": 1448774946, "last_edit_date": 1448774946, "creation_date": 1448100673, "answer_id": 33842088, "question_id": 33789230, "link": "https://stackoverflow.com/questions/33789230/how-does-this-128-bit-integer-multiplication-work-in-assembly-x86-64/33842088#33842088", "title": "How does this 128 bit integer multiplication work in assembly (x86-64)?", "body": "<p>In order to understand why do we do this operations, try to interpret int128_t as: 2^64 * xh + xl</p>\n\n<p>so if we want to multiply two int128_t integers, we will do the following:</p>\n\n<p>x = 2^64 * xh + xl</p>\n\n<p>y = 2^64 * yh + yl</p>\n\n<p>so x * y = (2^128 * xh * yh) + (2^64 * xh * yl) + (2^64 * yh * xl) + (yl * xl)</p>\n\n<p>And this is exactly, what the assembly code does:</p>\n\n<p>yh = %rdx yl = %rax</p>\n\n<p>xh = %rcx xl = %rsi</p>\n\n<p>2^64 * xh * yl: is <code>imulq %rax, %rcx</code> 2^64 indicates, that we need to add this to the high order bits</p>\n\n<p>2^64 * yh * xl: is <code>imulq %rsi, %rdx</code> 2^64 indicates, that we need to add this to the high order bits</p>\n\n<p>2^128 * xh * yh: This operation is not needed, since <code>2^128 * xh * yh</code> won't fit in 128 bit integer. It represents only sign bit information and may be ignored.</p>\n\n<p>xl * yl: is <code>mulq  %rsi</code></p>\n\n<p>I hope this clears things up!</p>\n"}, {"tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": true, "score": 2, "last_activity_date": 1448445644, "last_edit_date": 1495540241, "creation_date": 1448444455, "answer_id": 33913055, "question_id": 33789230, "link": "https://stackoverflow.com/questions/33789230/how-does-this-128-bit-integer-multiplication-work-in-assembly-x86-64/33913055#33913055", "title": "How does this 128 bit integer multiplication work in assembly (x86-64)?", "body": "<p>What GCC is doing is using the property that signed multiplication can be done using <a href=\"https://stackoverflow.com/a/22847373/2542702\">the following formula</a>.</p>\n\n<pre><code>(hi,lo) = unsigned(x*y)\nhi -= ((x&lt;0) ? y : 0)  + ((y&lt;0) ? x : 0)\n</code></pre>\n\n<p>Despite the fact that there is no need to do this since in this case the x86-64 instruction set has a signed 64-bit*64-bit to 128-bit instruction (<code>imul</code> with one operand) this formula is useful in other cases. For example for implementing <a href=\"https://stackoverflow.com/a/28827013/2542702\">signed 128-bit multiplication with SSE2/AVX2/AVX512</a> or for implementing <a href=\"https://stackoverflow.com/questions/29029572/multi-word-addition-using-the-carry-flag\">256-bit multiplication when the instruction set only does 128-bit multiplication</a> (such as with x86-64).</p>\n\n<p>GCC implemented this formula a bit differently though.  If we take the sign bit and extend it to the whole word, call this function <code>sign_ext</code>, then the function returns <code>-1</code> or <code>0</code>.  Then what GCC did is:</p>\n\n<pre><code>hi += sign_ext(x)*y + sign_ext(y)*x\n</code></pre>\n\n<p>for example <code>sign_ext(x)*y</code> in pseudo-instructions for 64-bit words is </p>\n\n<pre><code>sarq  $63, x    ; sign_ext(x)\nimulq   y, x    ; sign_ext(x)*y\n</code></pre>\n\n<p>So now you ask (or meant to ask): </p>\n\n<blockquote>\n  <p>Why is this formula true?</p>\n</blockquote>\n\n<p>That's a good qeustion. I asked this same question as well and <a href=\"https://stackoverflow.com/questions/22845801/32-bit-signed-multiplication-without-using-64-bit-data-type/22847373#22847373\">njuffa wrote</a> </p>\n\n<blockquote>\n  <p>@Zboson: It follows directly from two's complement complement representation. E.g. 32-bit integers <code>-n</code> and <code>-m</code> are represented as unsigned numbers <code>x=2**32-n, y=2**32-m</code>. If you multiply those you have <code>x*y = 2**64 - 2**32*n - 2**32*m + n*m</code>. The middle terms indicate the necessary corrections to the upper half of the product. Working through a simple example using -1*-1 should prove very instructive.</p>\n</blockquote>\n"}], "owner": {"reputation": 1596, "user_id": 1446139, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7afb11066c85e5c5d28301f285a78be?s=128&d=identicon&r=PG&f=1", "display_name": "denis631", "link": "https://stackoverflow.com/users/1446139/denis631"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2786, "favorite_count": 5, "accepted_answer_id": 33913055, "answer_count": 3, "score": 8, "last_activity_date": 1448774946, "creation_date": 1447876750, "last_edit_date": 1448444724, "question_id": 33789230, "link": "https://stackoverflow.com/questions/33789230/how-does-this-128-bit-integer-multiplication-work-in-assembly-x86-64", "title": "How does this 128 bit integer multiplication work in assembly (x86-64)?", "body": "<p>I'm reading <a href=\"http://csapp.cs.cmu.edu/\" rel=\"nofollow\"><em>Computer Systems: A Programmer's Perspective</em></a> and the homework was to describe how this algorithm works.</p>\n\n<p>C function:</p>\n\n<pre><code>void store_prod(__int128 *dest, int64_t x, int64_t y) {\n    *dest = x * (__int128)y;\n}\n</code></pre>\n\n<p>Assembly:</p>\n\n<pre><code>movq %rdx, %rax\ncqto\nmovq  %rsi, %rcx\nsarq  $63,  %rcx\nimulq %rax, %rcx\nimulq %rsi, %rdx\naddq  %rdx, %rcx\nmulq  %rsi\naddq  %rcx, %rdx\nmovq  %rax, (%rdi)\nmovq  %rdx, 8(%rdi)\nret\n</code></pre>\n\n<p>I don't know why it performs: <code>xh * yl + yh * xl = value which we add after unsigned multiplication</code></p>\n"}, {"tags": ["c", "stack", "aslr"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1447879705, "post_id": 33789155, "comment_id": 55347146, "body": "Regarding 1: maybe this is just being unprecise but return addresses and arguments also take up some stack space."}, {"owner": {"reputation": 861, "user_id": 3347983, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8243b37287e4b3ba0643c419e847acc2?s=128&d=identicon&r=PG&f=1", "display_name": "\u4eca\u5929\u6625\u5929", "link": "https://stackoverflow.com/users/3347983/%e4%bb%8a%e5%a4%a9%e6%98%a5%e5%a4%a9"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1447880492, "post_id": 33789155, "comment_id": 55347594, "body": "Yes, I already considered this."}], "owner": {"reputation": 861, "user_id": 3347983, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8243b37287e4b3ba0643c419e847acc2?s=128&d=identicon&r=PG&f=1", "display_name": "\u4eca\u5929\u6625\u5929", "link": "https://stackoverflow.com/users/3347983/%e4%bb%8a%e5%a4%a9%e6%98%a5%e5%a4%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1447879634, "creation_date": 1447876465, "last_edit_date": 1447879634, "question_id": 33789155, "link": "https://stackoverflow.com/questions/33789155/32-bit-aslr-ranges", "title": "32 Bit ASLR - Ranges?", "body": "<p>I know that the maximum size of a program stack which can be used on my machine is 8192 kbytes (according to <code>ulimit -a | grep \"stack size\"</code>).</p>\n\n<p>I also know that Linux uses ASLR. I use a 64-bit system with the gcc compilerflag <code>-m32</code>.</p>\n\n<ol>\n<li><p>Is it therefore true that the total amount of local variables can only take up a maximum of 8192 kbytes? Is it possible that it touches the heap before this maximum is taken up? Or will the heap take care of not growing too much?</p></li>\n<li><p>What is the possible range of addresses of local variables according to ASLR? Can I create a local variable at address 0xf740d25a, 0x7ffXXXXX, 0xaXXXXXX or 0x1XXX where X is any hexadecimal digit?</p></li>\n</ol>\n"}, {"tags": ["c", "struct", "memory-leaks", "singly-linked-list"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447876199, "post_id": 33788997, "comment_id": 55345063, "body": "When you finally print the list <code>while(1)</code> should be <code>while(head)</code>. You already checked if it is <code>NULL</code>."}, {"owner": {"reputation": 61, "user_id": 5490006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cf430beba36dbf13ce7766127d5a972?s=128&d=identicon&r=PG&f=1", "display_name": "geforce", "link": "https://stackoverflow.com/users/5490006/geforce"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447876372, "post_id": 33788997, "comment_id": 55345175, "body": "That&#39;s true but I don&#39;t think that is causing the failed test cause memory leak. Its just an nontraditional way I made the loop"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1447876379, "post_id": 33788997, "comment_id": 55345183, "body": "You <code>free(curr)</code> but the possibility exists it never gets <code>malloc()</code>&#39;d. There is also the case in the passed tests where you <code>malloc</code> multiple times but only free once. Every <code>malloc</code> should have corresponding <code>free</code>."}, {"owner": {"reputation": 7592, "user_id": 2371054, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gWrKl.jpg?s=128&g=1", "display_name": "mshildt", "link": "https://stackoverflow.com/users/2371054/mshildt"}, "edited": false, "score": 0, "creation_date": 1447876640, "post_id": 33788997, "comment_id": 55345347, "body": "scanf returns the number of items successfully matched. You should be checking this value before testing the value of <code>n</code>."}, {"owner": {"reputation": 61, "user_id": 5490006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cf430beba36dbf13ce7766127d5a972?s=128&d=identicon&r=PG&f=1", "display_name": "geforce", "link": "https://stackoverflow.com/users/5490006/geforce"}, "edited": false, "score": 0, "creation_date": 1447877488, "post_id": 33788997, "comment_id": 55345890, "body": "Where would I possibly free the curr variable during the loop?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5490006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cf430beba36dbf13ce7766127d5a972?s=128&d=identicon&r=PG&f=1", "display_name": "geforce", "link": "https://stackoverflow.com/users/5490006/geforce"}, "edited": false, "score": 0, "creation_date": 1447876877, "post_id": 33789198, "comment_id": 55345506, "body": "Thanks it worked. Just checked valgrind and no more errors!"}], "tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": true, "score": 1, "last_activity_date": 1447876626, "creation_date": 1447876626, "answer_id": 33789198, "question_id": 33788997, "link": "https://stackoverflow.com/questions/33788997/tracking-possible-memory-leak-in-c-program-using-linked-list-struct/33789198#33789198", "title": "Tracking Possible Memory Leak in C program using Linked List Struct", "body": "<p>you need to free the <code>head</code> node in the last while loop:</p>\n\n<pre><code>while(1)\n{\n  if(head == NULL) {\n    printf(\"NULL\\n\");\n    break;\n  }\n  printf(\"%d--&gt;\", head-&gt;node);\n  void *tmp = head;\n  head = head-&gt;next;\n  free(tmp);\n}\n</code></pre>\n\n<p>and remove the <code>free(curr);</code>.</p>\n\n<p>You should also check <code>scanf</code> for success or set <code>n</code> to some negative value before.</p>\n"}], "owner": {"reputation": 61, "user_id": 5490006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cf430beba36dbf13ce7766127d5a972?s=128&d=identicon&r=PG&f=1", "display_name": "geforce", "link": "https://stackoverflow.com/users/5490006/geforce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 33789198, "answer_count": 1, "score": 0, "last_activity_date": 1447876626, "creation_date": 1447875965, "question_id": 33788997, "link": "https://stackoverflow.com/questions/33788997/tracking-possible-memory-leak-in-c-program-using-linked-list-struct", "title": "Tracking Possible Memory Leak in C program using Linked List Struct", "body": "<p>This program is supposed to read inputs until 0 or a negative number is read. Then put it into a linked list in ascending order using the structure below.</p>\n\n<p>When I was emailed the test cases 0-3 I passed them all. Those inputs consist of numbers that are random such as  1 2 3 4 5 -1 or 3493494 2922 -1.</p>\n\n<p>The last input file which is \"#### failed test\" consists of a blank page which is the input txt. So my program automatically says \"The linked list is empty\". However there is a memory check error.</p>\n\n<p><strong><em>Is this error because of the block? Should \"free(curr);\" be after the printf?</em></strong> </p>\n\n<pre><code>  if(head == NULL)\n  {\n     printf(\"The list is empty\\n\");\n     return(-1);\n  }\n</code></pre>\n\n<p><strong><em>I am asking this because when the program runs normally and executes it reaches the last line which free's the memory for the curr variable. But when the list is empty it instantly goes to the \"head == NULL\" statement and exits without freeing the variable.</em></strong></p>\n\n<p>My Professor emailed me the test cases where the input is different for each:</p>\n\n<pre><code> #### Passed test 0.\n #### Passed test 1.\n #### Passed test 2.\n #### Passed test 3.\n #### Failed test MemoryCheck. Output of memory checker follows.\n ==23571== 128 (32 direct, 96 indirect) bytes in 2 blocks are definitely        \n lost in loss record 2 of 2\n ==23571== at 0x4A07218: malloc (vg_replace_malloc.c:296)\n ==23571== by 0x40071A: main (in /eecs/dept/course/2015-    \n 16/F/2031/submit/lab7/cse13020/q2) \n ==23571== \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\n\nstruct node\n{\n   int node;\n   struct node* next;\n};\n\n\nvoid insert(struct node** head, struct node* node)\n{\n    struct node* curr;\n\n    if (*head == NULL || (*head)-&gt;node &gt;= node-&gt;node)\n    {\n       node-&gt;next = *head;\n       *head = node;\n    }\n    else\n    {\n       curr = *head;\n\n        while (curr-&gt;next!= NULL &amp;&amp; curr-&gt;next-&gt;node &lt; node-&gt;node)\n           curr = curr-&gt;next;\n\n        node-&gt;next = curr-&gt;next;\n        curr-&gt;next = node;\n    }\n}\n\n\nint main()\n{\n\n   struct node *head = NULL;\n   struct node *curr;\n\n   int n;\n\n   while(1)\n   {\n\n      scanf(\"%d\", &amp;n);\n\n      if(n &lt;= 0) \n        break;\n\n      curr = (struct node*) malloc(sizeof(struct node));\n      curr-&gt;node  = n;\n      curr-&gt;next =  NULL;\n\n      insert(&amp;head, curr); \n   }\n\n  if(head == NULL)\n  {\n     printf(\"The list is empty\\n\");\n     return(-1);\n  }\n\n  printf(\"The linked list is:\\n\");\n\n  while(1)\n  {\n     if(head == NULL) {\n       printf(\"NULL\\n\");\n       break;\n     }\n     printf(\"%d--&gt;\", head-&gt;node);\n     head = head-&gt;next;\n  }\n\n\n  free(curr);  \n}\n</code></pre>\n"}, {"tags": ["c", "pid", "derivative"], "comments": [{"owner": {"reputation": 7961, "user_id": 329801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a738a21eabcad64d71d7aeea53d84891?s=128&d=identicon&r=PG", "display_name": "thelaws", "link": "https://stackoverflow.com/users/329801/thelaws"}, "edited": false, "score": 0, "creation_date": 1447875020, "post_id": 33788643, "comment_id": 55344344, "body": "Shouldn&#39;t percent change be <code>(current-old)&#47;old</code>? Why do you have <code>max</code> in the denominator?"}, {"owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "reply_to_user": {"reputation": 7961, "user_id": 329801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a738a21eabcad64d71d7aeea53d84891?s=128&d=identicon&r=PG", "display_name": "thelaws", "link": "https://stackoverflow.com/users/329801/thelaws"}, "edited": false, "score": 0, "creation_date": 1447875240, "post_id": 33788643, "comment_id": 55344473, "body": "well i put max because max possible change in feedback is the mx feedback it self...."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1447875501, "post_id": 33788643, "comment_id": 55344634, "body": "I would suspect integer division.  How big is <code>N</code> compared to <code>s*Td</code>?  If it is bigger, your lower term is rounded to 1.  and if <code>N</code> is smaller than <code>Td</code>, the whole formula is truncated to 0."}, {"owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "edited": false, "score": 0, "creation_date": 1447875631, "post_id": 33788643, "comment_id": 55344718, "body": "N is usually 5 but in the system there is a limit it wont go beyond 10"}, {"owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "edited": false, "score": 0, "creation_date": 1447875790, "post_id": 33788643, "comment_id": 55344800, "body": "my doubt is in the realization of the equation. I am not good in maths :D"}, {"owner": {"reputation": 7961, "user_id": 329801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a738a21eabcad64d71d7aeea53d84891?s=128&d=identicon&r=PG", "display_name": "thelaws", "link": "https://stackoverflow.com/users/329801/thelaws"}, "edited": false, "score": 0, "creation_date": 1447875960, "post_id": 33788643, "comment_id": 55344913, "body": "What are the types of your variables? Is <code>N</code> an <code>int</code>?"}, {"owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "edited": false, "score": 0, "creation_date": 1447876225, "post_id": 33788643, "comment_id": 55345090, "body": "my final D Term is S32, N is U8, Feedback is S32, diff time is U32 as well"}, {"owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1447876969, "post_id": 33788643, "comment_id": 55345572, "body": "@AShelly.. I suspected the same...i took sample at different change in feedback and recalculated everything...at no point it;s being rounded 0. I took care of the 2 point decimal precision but proper multiplication and division...but i havent added here so that people dont get confused by seeing all that stuff"}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1447879697, "post_id": 33788643, "comment_id": 55347140, "body": "I&#39;m confused by not seeing &quot;that stuff&quot;. You say the types are integral, but then you say you have 2 decimal point precision.   GIve at  least one concrete example of inputs, expected outputs , and actual output."}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 1, "creation_date": 1447880222, "post_id": 33788643, "comment_id": 55347436, "body": "@AShelly I suspect the integer values are scaled x100 to get the 2 decimal points of precision ? Scaling like that is often used for integer calculation, e.g. in control loops."}, {"owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "reply_to_user": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1447883204, "post_id": 33788643, "comment_id": 55349168, "body": "You are right @Morten Jensen"}], "answers": [{"comments": [{"owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "edited": false, "score": 0, "creation_date": 1447876486, "post_id": 33788998, "comment_id": 55345242, "body": "Mostly D will remain the off only..but if user activates it system should be capable enough to deal with it"}], "tags": [], "owner": {"reputation": 109, "user_id": 5578258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239afaeb9f6578458f573e0af76fc640?s=128&d=identicon&r=PG", "display_name": "Santiago", "link": "https://stackoverflow.com/users/5578258/santiago"}, "is_accepted": false, "score": 0, "last_activity_date": 1447875967, "creation_date": 1447875967, "answer_id": 33788998, "question_id": 33788643, "link": "https://stackoverflow.com/questions/33788643/d-portion-of-pid-calculation/33788998#33788998", "title": "D portion of PID calculation", "body": "<p>Whenever the sample time is high enough and the sensibility of the measure is high the D will only add noise, because any small change will be inmediately attacked by the D control, creating an awful ripple at the end.\nIn most systems you don't need a D if you can live with a slower control. If you still want to use a D then be sure that it's far smaller than P and I.</p>\n\n<p>And maybe you can change your last symbol.</p>\n"}], "owner": {"reputation": 1071, "user_id": 2614145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7cfda8d12298be3cc3ab86f26583cd6d?s=128&d=identicon&r=PG", "display_name": "SPandya", "link": "https://stackoverflow.com/users/2614145/spandya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447875967, "creation_date": 1447874777, "question_id": 33788643, "link": "https://stackoverflow.com/questions/33788643/d-portion-of-pid-calculation", "title": "D portion of PID calculation", "body": "<p>I am implementing PID control for motor speed control. In the specification I have been told to implement filtering technique using the following equation for D part. I am done with Implementing the PI control and it works perfectly fine for me. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ygD7h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ygD7h.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now what I understood so far is that s represents <code>\"dx/dt\"</code> generally which corresponds to the rate of change of error but here i can relate it with rate of change of feedback. <code>Td/N</code> is for limiting the all over gain output(hope i got this right). Now to represent this in terms of C code I tried with the following way.</p>\n\n<pre><code>s = (CurrentFeedback()-Old_Feedback)*100/(MaxFeedback()); //to calculate the % change in feedback\n    s = s*1000/sampleTime;      //1000 is multiplied because sampleTime is in milliseconds\n    D = (Td*s)/(1+(s*Td/N));\n    D = D*KP;   //Kp is multiplied as per the standard pid equation.\n\n    Old_Feedback = CurrentFeedback();\n    PID = P+I-D;\n</code></pre>\n\n<p>Well the results by adding D is not what I have predicted. I just want to know that ..did I implement the D portion equation correctly? Am I making in mistake in the understanding the basic maths of differentiation?</p>\n\n<p>NOTE: I am not in liberty to change the recalculate the kp,ti,td as it comes directly from the VFD. Thanks a lot in advance. Sorry for the bad english.</p>\n"}, {"tags": ["c", "function", "external", "modelica", "dymola"], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 4210009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99f1673048d25c96dffe5ddcfa6c3cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Shaga", "link": "https://stackoverflow.com/users/4210009/shaga"}, "edited": false, "score": 1, "creation_date": 1447937305, "post_id": 33796713, "comment_id": 55374101, "body": "Thank you for your answer. I am not actually familiar with LoadLibrary from the win32 API. Could you maybe add a link so that I can find some information? Thanks!"}, {"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 2, "creation_date": 1447942833, "post_id": 33796713, "comment_id": 55378120, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684179(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN: LoadLibraryEx</a>"}, {"owner": {"reputation": 170, "user_id": 4210009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99f1673048d25c96dffe5ddcfa6c3cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Shaga", "link": "https://stackoverflow.com/users/4210009/shaga"}, "edited": false, "score": 0, "creation_date": 1452625269, "post_id": 33796713, "comment_id": 57249338, "body": "I just used LoadLibrary to load the dll simply by using <code>HMODULE hModule = LoadLibrary(L&quot;C:\\mylib.dll&quot;)</code>. Although the library is found in VM, dymola is unable to find it and hModule is returned as null. What could be the reason?"}, {"owner": {"reputation": 170, "user_id": 4210009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99f1673048d25c96dffe5ddcfa6c3cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Shaga", "link": "https://stackoverflow.com/users/4210009/shaga"}, "edited": false, "score": 0, "creation_date": 1452625866, "post_id": 33796713, "comment_id": 57249703, "body": "@sjoelund.se sorry for the multiple comments, I was not able to edit my previous comment."}, {"owner": {"reputation": 2937, "user_id": 934829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bcf5c6230b50780f3973962c27ccb48?s=128&d=identicon&r=PG", "display_name": "sjoelund.se", "link": "https://stackoverflow.com/users/934829/sjoelund-se"}, "edited": false, "score": 0, "creation_date": 1452663586, "post_id": 33796713, "comment_id": 57263717, "body": "Try using C:/ or C:\\\\ instead of C:\\. It&#39;s strings, so you need to escape the character. I get <code>warning: unknown escape sequence &#39;\\m&#39;</code> and my C-compiler ignores the \\."}, {"owner": {"reputation": 170, "user_id": 4210009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99f1673048d25c96dffe5ddcfa6c3cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Shaga", "link": "https://stackoverflow.com/users/4210009/shaga"}, "edited": false, "score": 0, "creation_date": 1452780640, "post_id": 33796713, "comment_id": 57326590, "body": "@sjoelund.se Dymola still doesn&#39;t find the path when I use C:\\  or  C:\\\\. My problem is, I don&#39;t know how to specify a path that dymola can find it. I ran my code in VS2012 (the compiler that my Dymola instance is also using) and everything works fine, but I don&#39;t understand why the path is not found when I use the same compiler in Dymola."}, {"owner": {"reputation": 170, "user_id": 4210009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99f1673048d25c96dffe5ddcfa6c3cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Shaga", "link": "https://stackoverflow.com/users/4210009/shaga"}, "edited": false, "score": 0, "creation_date": 1452782742, "post_id": 33796713, "comment_id": 57328144, "body": "ok, it finally worked! :) I had to include the static library as well in the <code>Library</code> section of the external function call."}], "tags": [], "owner": {"reputation": 2937, "user_id": 934829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bcf5c6230b50780f3973962c27ccb48?s=128&d=identicon&r=PG", "display_name": "sjoelund.se", "link": "https://stackoverflow.com/users/934829/sjoelund-se"}, "is_accepted": true, "score": 3, "last_activity_date": 1447914500, "creation_date": 1447914500, "answer_id": 33796713, "question_id": 33788322, "link": "https://stackoverflow.com/questions/33788322/modelica-external-c-function-call-using-a-dll/33796713#33796713", "title": "Modelica External C function call using a DLL", "body": "<p>If you really need the symbols to be named the same thing, use LoadLibrary and so on from the win32 API. Else, you should probably give the functions unique names for cross-tool and cross-platform compatibility.</p>\n"}, {"comments": [{"owner": {"reputation": 170, "user_id": 4210009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99f1673048d25c96dffe5ddcfa6c3cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Shaga", "link": "https://stackoverflow.com/users/4210009/shaga"}, "edited": false, "score": 0, "creation_date": 1451927149, "post_id": 33922636, "comment_id": 56937592, "body": "I have both DLL and Lib files."}], "tags": [], "owner": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "is_accepted": false, "score": 1, "last_activity_date": 1448471805, "creation_date": 1448471805, "answer_id": 33922636, "question_id": 33788322, "link": "https://stackoverflow.com/questions/33788322/modelica-external-c-function-call-using-a-dll/33922636#33922636", "title": "Modelica External C function call using a DLL", "body": "<p>Does the library have both a DLL and a LIB file or just a DLL?</p>\n\n<p>If there is a LIB-file Dymola will link with that - and it could cause the problem above, but without a LIB-file Dymola 2016 should go directly to the DLL.</p>\n\n<p>But using different names is normally simpler.</p>\n"}], "owner": {"reputation": 170, "user_id": 4210009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99f1673048d25c96dffe5ddcfa6c3cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Shaga", "link": "https://stackoverflow.com/users/4210009/shaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 33796713, "answer_count": 2, "score": 1, "last_activity_date": 1448471805, "creation_date": 1447873702, "question_id": 33788322, "link": "https://stackoverflow.com/questions/33788322/modelica-external-c-function-call-using-a-dll", "title": "Modelica External C function call using a DLL", "body": "<p>I was working with two external functions in Dymola via two DLLs. I encountered a problem which made me think about how the compiler actually finds the external function. So the functions within the two different DLLs have the same name and the same set of input and output variables but were doing different tasks.</p>\n\n<pre><code>void Execute(int in_1, bool flag_in, bool* flag_out, int* out_1);\n</code></pre>\n\n<p>I defined them as the following in the external function interface in Modelica: </p>\n\n<pre><code>function testFunc1 \n\n  input Integer in_1;\n  input Boolean flag_in;\n  output Boolean flag_out;\n  output Integer[5] out_1;\n\n  external C Execute(int in_1, bool flag_in, bool* flag_out, int* out_1)   \n  annotation(Library = \"DLL1\");\nend testFunc1;\n</code></pre>\n\n<p>and the second function was called within another modelica function called testFunc2 just like above. \nWhat I observed was, since the external functions have the same names and the same set of input and output variables, in spite of the defined Library name, the compiler would mistakenly pick the wrong function from the other DLL and execute it. </p>\n\n<p>I was wondering if there is a way to force the compiler to only look into a particular DLL when looking for an external function? or the external functions are not supposed to have identical names at all? Or is there a better way to introduce the DLL to Modelica?  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 5, "creation_date": 1447873724, "post_id": 33788315, "comment_id": 55343533, "body": "Seed once per program, only. Move <code>srand</code> into <code>main</code> as one of the first lines (not inside a loop!). I can see from your commented-out line that you intended this at some point."}, {"owner": {"reputation": 367, "user_id": 2999915, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebe6d9e2fd56b3218d4deff684fe6fab?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2999915/mike"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1447873772, "post_id": 33788315, "comment_id": 55343563, "body": "Hmmm I apologize for this silly question. You are right. I should&#39;ve been more careful"}, {"owner": {"reputation": 24609, "user_id": 1974224, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/rQQMq.png?s=128&g=1", "display_name": "Cristik", "link": "https://stackoverflow.com/users/1974224/cristik"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1447873889, "post_id": 33788315, "comment_id": 55343620, "body": "@MicroVirus you should add an answer with that, it will likely help others that try to use <code>rand()</code>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1447873908, "post_id": 33788315, "comment_id": 55343640, "body": "The most important reason though is that in debug mode the (VC2008) compiler wants the randomizer to be deterministic and thus always seeds it with he same value, even when calling <code>time()</code> (otherwise here would have been different outcomes, even when calling <code>srand</code> multiple times)."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "reply_to_user": {"reputation": 24609, "user_id": 1974224, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/rQQMq.png?s=128&g=1", "display_name": "Cristik", "link": "https://stackoverflow.com/users/1974224/cristik"}, "edited": false, "score": 0, "creation_date": 1447873976, "post_id": 33788315, "comment_id": 55343684, "body": "@Cristik Sure, done."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1447874043, "post_id": 33788315, "comment_id": 55343726, "body": "@PaulOgilvie That&#39;s not true. It&#39;s just that the loop only runs 5 times and the <code>time()</code> function doesn&#39;t have the resolution to change within such a minuscule amount of time."}, {"owner": {"reputation": 3807, "user_id": 3679857, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/J8vHF.jpg?s=128&g=1", "display_name": "narendra-choudhary", "link": "https://stackoverflow.com/users/3679857/narendra-choudhary"}, "edited": false, "score": 0, "creation_date": 1447874065, "post_id": 33788315, "comment_id": 55343739, "body": "Here&#39;s a more detailed answer: <a href=\"https://stackoverflow.com/questions/5574914/srandtimenull-doesnt-change-seed-value-quick-enough\">srand() \u2014 why call it only once?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "is_accepted": false, "score": 1, "last_activity_date": 1447873965, "creation_date": 1447873965, "answer_id": 33788400, "question_id": 33788315, "link": "https://stackoverflow.com/questions/33788315/rand-does-not-update-values-between-function-invocations/33788400#33788400", "title": "rand() does not update values between function invocations", "body": "<p>Seed once per program, only. Move <code>srand</code> into <code>main</code> as one of the first lines (not inside a loop!). I can see from your commented-out line that you intended this at some point.</p>\n"}], "owner": {"reputation": 367, "user_id": 2999915, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebe6d9e2fd56b3218d4deff684fe6fab?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2999915/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "closed_date": 1447873976, "answer_count": 1, "score": -1, "last_activity_date": 1447873965, "creation_date": 1447873655, "question_id": 33788315, "link": "https://stackoverflow.com/questions/33788315/rand-does-not-update-values-between-function-invocations", "closed_reason": "Duplicate", "title": "rand() does not update values between function invocations", "body": "<p>I noticed that if I used <code>rand()</code> to generate random values inside a loop, it will change the value at each iteration. However, this is not the case between for function invocations even by seeding via <code>srand()</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt; \n#include &lt;time.h&gt;\n#include &lt;string.h&gt; \n\nvoid test(){   \n    float r;\n\n    srand(time(NULL));\n    r =  (double)rand()/(double)RAND_MAX;\n    printf(\" %6.3f \\n\",r);\n}  \nint main(){\n\n     float r;\n    //srand(time(NULL));\n    for(int i=0;i&lt;5;i++){\n        test();\n        //r =  (double)rand()/(double)RAND_MAX;\n        //printf(\" %6.3f \\n\",r);\n    }\n\n}\n</code></pre>\n\n<p>How can I force rand() to refresh its values in each function call?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1447873462, "post_id": 33788210, "comment_id": 55343386, "body": "You&#39;re passing an int when you&#39;ve told <code>printf</code> to expect a double."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 1, "creation_date": 1447873542, "post_id": 33788210, "comment_id": 55343434, "body": "Reminded me a lot of <a href=\"http://stackoverflow.com/questions/33692356/moving-printf-to-different-lines-gives-different-outputs-c\">Moving printf to different lines gives different outputs? (C)</a>. Are you the same person?"}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1447873931, "post_id": 33788210, "comment_id": 55343655, "body": "@MOehm Yeah it wasn&#39;t a duplicate call per se, it&#39;s just that the codes match up, right down to the <code>5&#47;2</code> and <code>int a = 65</code>, I am just wondering why."}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 1, "creation_date": 1447874383, "post_id": 33788210, "comment_id": 55343936, "body": "@MicroVirus: <a href=\"http://stackoverflow.com/questions/33766748/why-is-the-output-different-using-printf\">Here&#39;s another &quot;duplicate&quot; from yesterday.</a> Lots of people using SO for their schoolwork, as usual."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5578066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910d9b370193241a309aa061d8dd5c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Bazak", "link": "https://stackoverflow.com/users/5578066/tom-bazak"}, "edited": false, "score": 0, "creation_date": 1447873918, "post_id": 33788245, "comment_id": 55343649, "body": "But when i put it in the middle of the print goup its fine , why?"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1447874600, "last_edit_date": 1447874600, "creation_date": 1447873413, "answer_id": 33788245, "question_id": 33788210, "link": "https://stackoverflow.com/questions/33788210/why-the-output-is-0-000000-c/33788245#33788245", "title": "Why the output is 0.000000? (C)", "body": "<p>In your first line, when you divide integer 5 by integer 2, the computer does integer division, which discards the remainder, giving 2 (not 2.5).  The result is an integer, but you try to print it using <code>%f</code>, which is why you saw 0 and not 2.</p>\n\n<hr>\n\n<p>In answer to your second question: when you pass a plain <code>int</code> to printf but tell it to print it using <code>%f</code>, printf basically takes random garbage from the stack to flesh out the rest of the floating-point number it's trying to print.  Whatever random garbage it finds on the stack depends (among other things) on what other functions you've been calling recently.  When you moved your printf call to the middle, it was pure luck that the random garbage happened to line up and give a semi-meaningful result.</p>\n"}], "owner": {"reputation": 11, "user_id": 5578066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910d9b370193241a309aa061d8dd5c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Bazak", "link": "https://stackoverflow.com/users/5578066/tom-bazak"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 0, "closed_date": 1447873384, "answer_count": 1, "score": -3, "last_activity_date": 1447874600, "creation_date": 1447873290, "question_id": 33788210, "link": "https://stackoverflow.com/questions/33788210/why-the-output-is-0-000000-c", "closed_reason": "Duplicate", "title": "Why the output is 0.000000? (C)", "body": "<p>Can someone please help me and tell me why the output here is 0.000000 when it supposed to be 2.500000?\nIts only like that when i put it the first line of print commands, if its in the middle of the print group its going well and goes out 2.500000.. \nSo why its 0?\n<a href=\"http://prntscr.com/948vzc\" rel=\"nofollow\">for screenshot click here</a></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint main()\n{\n    int a = 65;\n    char c = (char)a;\n    int m = 3.0/2;\n\n    printf(\"%f\\n\", 5 / 2);\n    printf(\"%c\\n\", c);              // output: A\n    printf(\"%f\\n\", (float)a);       // output: 65.000\n    printf(\"%f\\n\", 5.0 / 2);        // output: 2.5000\n    printf(\"%f\\n\", 5 / 2.0);        // output: 2.5000\n    printf(\"%f\\n\", (float)5 / 2);   // output: 2.5000\n    printf(\"%f\\n\", 5 / (float)2);   // output: 2.5000\n    printf(\"%f\\n\", (float)(5 / 2)); // output: 2.0000\n    printf(\"%f\\n\", 5.0 / 2);        // output: 2.5000\n    printf(\"%d\\n\", m);              // output: 1\n\n\n\n    system(\"PAUSE\");\n    return(0);\n}\n</code></pre>\n\n<p>Thanks ,\nTom.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 3, "creation_date": 1447873506, "post_id": 33788195, "comment_id": 55343410, "body": "Is there a reason why you don&#39;t want to use <code>printf</code>?"}, {"owner": {"reputation": 715, "user_id": 2584045, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d60e9557414b2121c5c7eeaca12a2c95?s=128&d=identicon&r=PG", "display_name": "Spyros_av", "link": "https://stackoverflow.com/users/2584045/spyros-av"}, "reply_to_user": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 0, "creation_date": 1447873807, "post_id": 33788195, "comment_id": 55343584, "body": "Just looking if there is a way. @pzaenger"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1447873943, "post_id": 33788195, "comment_id": 55343664, "body": "Why is <code>printf(&quot;type something&quot;)</code> okay but not <code>printf(&quot;#&quot;)</code>?"}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 1, "creation_date": 1447874067, "post_id": 33788195, "comment_id": 55343742, "body": "He&#39;s asking for an alternative to that...why don&#39;t people just answer someone&#39;s question or move along? Every question I read on here...rude, ignorant comments but nothing constructive is offered... OP try putchar()"}, {"owner": {"reputation": 1619, "user_id": 3342206, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92d5672ff3c806eb71d84d7298d5be43?s=128&d=identicon&r=PG&f=1", "display_name": "8bittree", "link": "https://stackoverflow.com/users/3342206/8bittree"}, "edited": false, "score": 0, "creation_date": 1447874469, "post_id": 33788195, "comment_id": 55343986, "body": "Have you looked at the <a href=\"http://stackoverflow.com/tags/c/info\">c tag info page</a>? (Try searching for &quot;Hello World&quot;)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1447874729, "post_id": 33788195, "comment_id": 55344157, "body": "So the question is reduced to &quot;how to print a character without <code>printf</code>&quot;."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447875972, "post_id": 33788195, "comment_id": 55344921, "body": "I would have thought that <code>printf(&quot;type something&quot;)</code> is better than <code>printf(&quot;#&quot;)</code> anyway. You, or someone else, runs your program in 6 months time and it prints <code>#</code>. What the heck does that mean?"}, {"owner": {"reputation": 715, "user_id": 2584045, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d60e9557414b2121c5c7eeaca12a2c95?s=128&d=identicon&r=PG", "display_name": "Spyros_av", "link": "https://stackoverflow.com/users/2584045/spyros-av"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447876578, "post_id": 33788195, "comment_id": 55345309, "body": "I want both <code>printf(&quot;type something&quot;)</code> and the <code>#</code> symbol. Like terminal gives <code>$</code> @WeatherVane"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1447876644, "post_id": 33788195, "comment_id": 55345351, "body": "<code>printf(&quot;type something\\n#&quot;)</code>"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 1, "creation_date": 1447876943, "post_id": 33788195, "comment_id": 55345553, "body": "I think the OP is looking for a function that asks for an input while displaying a prompt. Analogous to <code>read -p &quot;#&#39; input</code> in bash."}, {"owner": {"reputation": 715, "user_id": 2584045, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d60e9557414b2121c5c7eeaca12a2c95?s=128&d=identicon&r=PG", "display_name": "Spyros_av", "link": "https://stackoverflow.com/users/2584045/spyros-av"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447876955, "post_id": 33788195, "comment_id": 55345560, "body": "And without using <code>printf</code>... @WeatherVane I think my question is quite clear..."}, {"owner": {"reputation": 715, "user_id": 2584045, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d60e9557414b2121c5c7eeaca12a2c95?s=128&d=identicon&r=PG", "display_name": "Spyros_av", "link": "https://stackoverflow.com/users/2584045/spyros-av"}, "reply_to_user": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1447877045, "post_id": 33788195, "comment_id": 55345626, "body": "Exactly! This is what i am looking for. @alvits"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1447877154, "post_id": 33788195, "comment_id": 55345694, "body": "Why not make your own function to do it? What is the objection to <code>printf</code>? Why is <code>putchar</code> OK but not <code>printf</code>?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447884530, "post_id": 33788195, "comment_id": 55349888, "body": "@WeatherVane The whole story sounds like a joke, the same thing for the given Answer of using <code>putchar</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447884456, "post_id": 33788706, "comment_id": 55349852, "body": "Is there any reason why he should use <code>putchar</code> instead of <code>printf ?</code> I&#39;m just asking. Anyway this should be a comment and not an Answer, because there is no explanation why."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447887171, "post_id": 33788706, "comment_id": 55351015, "body": "I thought he wanted <code>#</code>."}], "tags": [], "owner": {"reputation": 176, "user_id": 3861910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097778f1108707406fba0ea0a0f05acd?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime", "link": "https://stackoverflow.com/users/3861910/maxime"}, "is_accepted": true, "score": 2, "last_activity_date": 1447889698, "last_edit_date": 1447889698, "creation_date": 1447874963, "answer_id": 33788706, "question_id": 33788195, "link": "https://stackoverflow.com/questions/33788195/how-to-create-a-prompt/33788706#33788706", "title": "How to create a prompt", "body": "<p>Try using the following</p>\n\n<pre><code>putchar('#');\n</code></pre>\n"}], "owner": {"reputation": 715, "user_id": 2584045, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d60e9557414b2121c5c7eeaca12a2c95?s=128&d=identicon&r=PG", "display_name": "Spyros_av", "link": "https://stackoverflow.com/users/2584045/spyros-av"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 33788706, "answer_count": 1, "score": -3, "last_activity_date": 1447889698, "creation_date": 1447873243, "question_id": 33788195, "link": "https://stackoverflow.com/questions/33788195/how-to-create-a-prompt", "title": "How to create a prompt", "body": "<p>Is there any way to create a prompt like <code>\"#\"</code> at the terminal before the user's typing,after \"type something\"? Without using <code>printf(\"#\");</code> </p>\n\n<pre><code> char str[500]; \n printf(\"type something\"); \n scanf(\"%s\",&amp;str);\n</code></pre>\n"}, {"tags": ["c", "algorithm", "data-structures", "tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 4003, "user_id": 4331480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oWiMU.jpg?s=128&g=1", "display_name": "therainmaker", "link": "https://stackoverflow.com/users/4331480/therainmaker"}, "edited": false, "score": 0, "creation_date": 1447872352, "post_id": 33787895, "comment_id": 55342648, "body": "Use a linked list as the container for a queue. And please read a good elementary book, as it will be covered in detail there."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1447873449, "post_id": 33787895, "comment_id": 55343381, "body": "BSTs and Queues are both abstract data types. you don&#39;t use a Queue to create a BST."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4181000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a19d9d53ca86169bbf324cb87eb7a566?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Yates", "link": "https://stackoverflow.com/users/4181000/chris-yates"}, "edited": false, "score": 0, "creation_date": 1447876027, "post_id": 33788564, "comment_id": 55344958, "body": "Thanks that clarified things for me."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1447874556, "creation_date": 1447874556, "answer_id": 33788564, "question_id": 33787895, "link": "https://stackoverflow.com/questions/33787895/level-order-queue-implemmentation-in-c/33788564#33788564", "title": "level order queue implemmentation in C", "body": "<blockquote>\n  <p>visit[ing] the nodes in a binary search tree level by level</p>\n</blockquote>\n\n<p>has a name: it is called a \"breadth-first\" traversal of the tree.  Starting with an empty queue, you enqueue the root node and then repeatedly dequeue the first node in the queue, process it somehow, and enqueue all that node's children, until there are no more nodes enqueued.  When exactly you should enqueue a node's children relative to other processing of that node may depend on exactly what processing you intend to perform, especially if it involves structurally modifying the tree.</p>\n\n<p>As long as the per-node processing can affect only the subtree rooted at the then-current node, this is all fine.  If you need to be able to affect other parts of the overall tree, however, then a breadth-first traversal probably is not appropriate for your task.</p>\n\n<p>You said</p>\n\n<blockquote>\n  <p>[I] don't know how to enqueue them properly. Starting with the root [I] can create a Queue but after that if [I] add the children of the root to the queue [I] will lose the children of those new nodes since [I] am modifying the connections in the Queue every time a add a new node.</p>\n</blockquote>\n\n<p>The key concept here is that membership and position in the queue are separate and independent from membership and position in the tree.  You could manage that by adding additional links to the node structures themselves, or by creating a new structure for the queue elements that contains a pointer to the enqueued BST node.  The latter decouples the tree from the queue, which many, including me, would consider preferable for most purposes.</p>\n"}], "owner": {"reputation": 81, "user_id": 4181000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a19d9d53ca86169bbf324cb87eb7a566?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Yates", "link": "https://stackoverflow.com/users/4181000/chris-yates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 33788564, "answer_count": 1, "score": 0, "last_activity_date": 1447874556, "creation_date": 1447872242, "question_id": 33787895, "link": "https://stackoverflow.com/questions/33787895/level-order-queue-implemmentation-in-c", "title": "level order queue implemmentation in C", "body": "<p>I understand the logic of using a queue to visit the nodes in a binary search tree level by level. \nHowever i tried to implemment in C but i'am stuck because i don't know how to  enqueue them properly. Starting with the root i can create a Queue but after that if i add the children of the root to the queue i will lose the children of those new nodes since iam modifying  the connections in the Queue every time a add a new node.</p>\n\n<p>I could create a new data type that has one more link to use in the linked list Queue, that should work. What is the best approach here?</p>\n"}, {"tags": ["c", "pointers", "math", "function-pointers"], "comments": [{"owner": {"reputation": 2405, "user_id": 2216129, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/U0xqx.jpg?s=128&g=1", "display_name": "Topological Sort", "link": "https://stackoverflow.com/users/2216129/topological-sort"}, "edited": false, "score": 0, "creation_date": 1447878580, "post_id": 33787851, "comment_id": 55346540, "body": "You can&#39;t declare functions inside other functions. I see you&#39;re going with a recursive solution.  if you don&#39;t know what &quot;recursive solution&quot; means -- or are uncomfortable writing your own -- it seems to me you are trying to do something that is significantly beyond your understanding of C.  You must walk before you run!  Copying in answers you don&#39;t understand how to write won&#39;t do you a lot of good.  Do you have a decent C textbook?  Go thru it until you get through loops -- or recursion -- and see what you&#39;ll write then.  Good luck."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447879553, "post_id": 33787851, "comment_id": 55347058, "body": "See my updated answer. While the compiler may inline methods, they are all separate entities that should only depend on the stated input. They need not and should not be written where they are called."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447880556, "post_id": 33787851, "comment_id": 55347621, "body": "It should work, what does the compiler say? Compiler option <code>-Wall</code> should complain about the form of the <code>main</code> definition. Are there other warnings/errors? You should also reduce the other operation results."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447881542, "post_id": 33787851, "comment_id": 55348208, "body": "Remove the second declaration of <code>input</code> and work through all the compiler warnings and errors, they are (gcc) or should be sufficiently explicit."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447882932, "post_id": 33787851, "comment_id": 55349015, "body": "No, the identifier <code>fac</code> is undeclared, there is no function mentioned in the error message. You need to declare it as <code>int</code>, as you declared <code>a,b,\u2026,add,add1,\u2026</code>."}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447883003, "post_id": 33787851, "comment_id": 55349050, "body": "The newly updated and edited post works perfectly! However, It did not reduce the fractions, am I still missing something? @LutzL"}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447885134, "post_id": 33787851, "comment_id": 55350182, "body": "The program only does what you instruct it to do. So if there are no instruction for the reduction of the subtraction result, there will be no reduction. Etc. -- And: The computer does not have any metaphysical capabilities. It can not divine what value a variable will have before that value is computed. In C, variables are just dumb variables, not properties with bindings that automatically update after value changes."}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "edited": false, "score": 0, "creation_date": 1447885358, "post_id": 33787851, "comment_id": 55350289, "body": "How can j get the reduction process? With that I&#39;ll be done entirely.@LutzL"}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447889185, "post_id": 33787851, "comment_id": 55351800, "body": "You just need to read carefully, the answers are already there."}, {"owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "reply_to_user": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447889669, "post_id": 33787851, "comment_id": 55351973, "body": "I got it for the addition, but the remaining just don&#39;t work. @lutzl"}], "answers": [{"comments": [{"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1447874195, "post_id": 33788219, "comment_id": 55343830, "body": "You need also to account for multiple factors. Thus you will need to divide a found factor until it is no longer to be found in both numbers."}, {"owner": {"reputation": 2405, "user_id": 2216129, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/U0xqx.jpg?s=128&g=1", "display_name": "Topological Sort", "link": "https://stackoverflow.com/users/2216129/topological-sort"}, "edited": false, "score": 0, "creation_date": 1447874481, "post_id": 33788219, "comment_id": 55343997, "body": "The algorithm above is in pseudocode.  You&#39;ll need to convert it to valid C, of course.  Presumably you know how to write for-loops and while-loops; if not, best review that before going further."}, {"owner": {"reputation": 2405, "user_id": 2216129, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/U0xqx.jpg?s=128&g=1", "display_name": "Topological Sort", "link": "https://stackoverflow.com/users/2216129/topological-sort"}, "edited": false, "score": 0, "creation_date": 1447874627, "post_id": 33788219, "comment_id": 55344085, "body": "Good catch, Lutzl.  AraMod, I altered the code slightly to replace &quot;if this factor...&quot; with &quot;while this factor...&quot;  This means, for example, if you&#39;ve got 20/20, it will factor out <i>all</i> the 2&#39;s, not just one."}], "tags": [], "owner": {"reputation": 2405, "user_id": 2216129, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/U0xqx.jpg?s=128&g=1", "display_name": "Topological Sort", "link": "https://stackoverflow.com/users/2216129/topological-sort"}, "is_accepted": false, "score": 0, "last_activity_date": 1447874517, "last_edit_date": 1447874517, "creation_date": 1447873327, "answer_id": 33788219, "question_id": 33787851, "link": "https://stackoverflow.com/questions/33787851/edit-script-for-user-input-rather-than-internal-input/33788219#33788219", "title": "Edit script for user input rather than internal input", "body": "<pre><code>for each possible factor from 2 to min (numerator, denominator)\n    while this factor evenly divides both numerator and denominator\n        numerator   /= factor;\n        denominator /= factor;\n</code></pre>\n\n<p>This will do it.  Actually, you could go up to <code>min (sqrt (numerator), sqrt (denominator))</code>, and that would work too.</p>\n\n<p>Since you need it several times, best put it into a function and call it on each of your results.</p>\n"}, {"comments": [{"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "reply_to_user": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "edited": false, "score": 0, "creation_date": 1447874508, "post_id": 33788437, "comment_id": 55344012, "body": "The gcd is the greatest common factor. To reduce the sum, do <code>fac = gcd(add, add1); add &#47;=fac; add1&#47;=fac;</code> to get the reduced numbers."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "reply_to_user": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "edited": false, "score": 0, "creation_date": 1447874925, "post_id": 33788437, "comment_id": 55344285, "body": "No, <code>gcd</code> is a function that is to be defined outside of main. Then you apply the reduction after you have computed the unreduced quantities. <code>int gcd(int a, int b) { return (0==b) ? a : gcd(b, a % b); } int main() { int add, add1; int a=-2, b=4, c=4, d=5;  add=(ad+bc); add1=(b*d); fac = gcd(add, add1); add &#47;=fac; add1&#47;=fac; printf(...</code>"}], "tags": [], "owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1447879430, "last_edit_date": 1447879430, "creation_date": 1447874089, "answer_id": 33788437, "question_id": 33787851, "link": "https://stackoverflow.com/questions/33787851/edit-script-for-user-input-rather-than-internal-input/33788437#33788437", "title": "Edit script for user input rather than internal input", "body": "<p>Look up the Euclidean algorithm. This is faster to compute the gcd of two numbers than trying out all possible prime factors.</p>\n\n<pre><code>int gcd(int a, int b) {\n    return  (0==b) ? a : gcd(b, a % b);\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int gcd(int a, int b) {\n    while(0!=b) { int r = a % b; a=b; b=r; }\n    return a;\n}\n</code></pre>\n\n<p>Then apply, for instance for the sum, as </p>\n\n<pre><code>fac = gcd(add, add1); \nadd /=fac; \nadd1/=fac;\n</code></pre>\n\n<p>to get the reduced numbers.</p>\n\n<hr>\n\n<p>To your other question, use the <code>atoi</code> function to transform argument string into numbers or use the <code>scanf</code> function to prompt for input. Be aware that no input verification is done by the C functions.</p>\n\n<pre><code>#include ...\n\nint gcd(int a, int b) { ... }\n\nint input(char* prompt) {\n    int res;\n    printf(\"%s: \", prompt);\n    scanf(\"%d\", &amp;res);\n    return res;\n}\n\nint main() {\n...\nint a,b,c,d;\na = input(\"Number for a\");\nb = input(\"Number for b\");\n...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5467693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/45d808d65b0dcf441dfd468b9339f01b?s=128&d=identicon&r=PG&f=1", "display_name": "AraMod", "link": "https://stackoverflow.com/users/5467693/aramod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447882691, "creation_date": 1447872131, "last_edit_date": 1447882691, "question_id": 33787851, "link": "https://stackoverflow.com/questions/33787851/edit-script-for-user-input-rather-than-internal-input", "title": "Edit script for user input rather than internal input", "body": "<p>I have a simple script and it works fine. My question is, how can I get my results to display in a reduced simplified fraction? Also, at this point I am defining the values myself, is there a way to have the script ask the user to input the numerator and denominator for the different fractions used?</p>\n\n<p>The posted script worked wonders for me in regards towards asking and performing the operations, so I am very thankful for that. It did not reduce the fractions, am I still missing something?</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include&lt;math.h&gt;\n #include&lt;string.h&gt;\n\n int gcd(int a, int b) {\n    while(0!=b) { int r = a % b; a=b; b=r; }\n    return a;\n}\n int input(char* prompt) {\n    int res;\n    printf(\"%s: \", prompt);\n    scanf(\"%d\", &amp;res);\n    return res;\n}\n main()\n {\n    int add,sub,mul,dd;\n    int add1,sub1,mul1,dd1;\n    int a,b,c,d;\n    int fac = gcd(add, add1);\n    a=input(\"Please enter the numerator for your first equation:\");\n    b=input(\"Please enter the denominator for your first equation:\");\n    c=input(\"Please enter the numerator for your second equation:\");\n    d=input(\"Please enter the denominator for your second equation:\");\n    add=(a*d+b*c);\n    add1=(b*d);\n    add /=fac;\n    add1/=fac;\n    printf(\"\\The sum of your fractions is: %d/%d\",add,add1);\n    sub=(a*d-b*c);\n    sub1=(b*d);\n    printf(\"\\nThe difference of your fractions is: %d/%d\",sub,sub1);\n    mul=(a*c);\n    mul1=(b*d);\n    printf(\"\\nThe product of your fractions is: %d/%d\",mul,mul1);\n    dd=(a*d);\n    dd1=(b*c);\n    printf(\"\\nThe quotient of your fractions is: %d/%d\",dd,dd1);\n }\n</code></pre>\n"}, {"tags": ["c", "pointers", "function-pointers"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447871965, "post_id": 33787703, "comment_id": 55342423, "body": "Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. What is <code>data</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447872116, "post_id": 33787703, "comment_id": 55342514, "body": "In the first part, you could choose a <code>struct {  int (*funIntPtr)(int,int); float (*funFloatPtr)(float,float); }</code>, and leave the type checking to the second part."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447872124, "post_id": 33787703, "comment_id": 55342521, "body": "You have copy/paste issues in <code>case DIVIDE</code> (it&#39;s the same as <code>case MULTIPLY</code>) and also you should trap divide by 0."}, {"owner": {"reputation": 926, "user_id": 1900748, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/x1moH.jpg?s=128&g=1", "display_name": "LMG", "link": "https://stackoverflow.com/users/1900748/lmg"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447872593, "post_id": 33787703, "comment_id": 55342821, "body": "@WeatherVane typecheking happens before this function call and I assume I can not divide by zero, there are also int division problems around but that&#39;s quite ok for the example. Question is now updated as requested with more information.."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447872746, "post_id": 33787703, "comment_id": 55342933, "body": "@LMG I see you have edited <code>case DIVIDE</code> but basic errors like that make me lose confidence in the question."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1447872600, "post_id": 33787919, "comment_id": 55342825, "body": "Note: before calling the function you must check that both operands your parser read are of the correct type, or you must cast/convert them to that type; for example, e2 has an int value and e1 has a float value requires the call <code>funFloatPtr(e1.b.f, e2.b.i);</code>"}, {"owner": {"reputation": 926, "user_id": 1900748, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/x1moH.jpg?s=128&g=1", "display_name": "LMG", "link": "https://stackoverflow.com/users/1900748/lmg"}, "edited": false, "score": 0, "creation_date": 1447872690, "post_id": 33787919, "comment_id": 55342896, "body": "type checking happens before this function call, so since there is not coercion provided yet, they are assumed to be of the same type.."}, {"owner": {"reputation": 926, "user_id": 1900748, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/x1moH.jpg?s=128&g=1", "display_name": "LMG", "link": "https://stackoverflow.com/users/1900748/lmg"}, "edited": false, "score": 0, "creation_date": 1447873028, "post_id": 33787919, "comment_id": 55343130, "body": "so you are saying &quot;Of course you could do heavy casting, just to save a function pointer, but that would obfuscate the code so I advice against that.&quot;, that is better having a readable code rather than a compact one?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 926, "user_id": 1900748, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/x1moH.jpg?s=128&g=1", "display_name": "LMG", "link": "https://stackoverflow.com/users/1900748/lmg"}, "edited": false, "score": 0, "creation_date": 1447873582, "post_id": 33787919, "comment_id": 55343458, "body": "Yes, always. Readable code is maintainable; compact code not always. Readable compact code is of course best."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1447872297, "creation_date": 1447872297, "answer_id": 33787919, "question_id": 33787703, "link": "https://stackoverflow.com/questions/33787703/generalize-function-pointers/33787919#33787919", "title": "generalize function pointers", "body": "<p>In your example I don't see the float function used:</p>\n\n<pre><code>  case basic_float_value:\n    {\n      res.b.i = funIntPtr(e1.b.i, e2.b.i);\n    }\n</code></pre>\n\n<p>I would expect something like:</p>\n\n<pre><code>  case basic_float_value:\n    {\n      res.b.f = funFloatPtr(e1.b.f, e2.b.f);\n    }\n</code></pre>\n\n<p>And this is exactly why you can't use a single function pointer: there is a huge difference in how float (double) and integer parameters are passed to the function and how the result is returned. Of course you could do heavy casting, just to save a function pointer, but that would obfuscate the code so I advice against that.</p>\n"}, {"tags": [], "owner": {"reputation": 532, "user_id": 1644482, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ea25c27c274633522adb95bfd17388d4?s=128&d=identicon&r=PG", "display_name": "Sergey Kanaev", "link": "https://stackoverflow.com/users/1644482/sergey-kanaev"}, "is_accepted": false, "score": 0, "last_activity_date": 1447872419, "creation_date": 1447872419, "answer_id": 33787956, "question_id": 33787703, "link": "https://stackoverflow.com/questions/33787703/generalize-function-pointers/33787956#33787956", "title": "generalize function pointers", "body": "<p>You may use folowing structure:</p>\n\n<pre><code>/* Operations enum */\nenum operation {\n    ADD, SUB, DIV, MUL, OP_COUNT\n};\n\n/* Operation arity */\nstatic const int arity[OP_COUNT] = {\n    [ADD] = 2, [SUB] = 2, [DIV] = 2, [MUL] = 2\n};\n\n/* Operation function pointer */\ntypedef double (*Operator)(double* arguments);\n\n/* Map operation to operator */\nOperator operators[OP_COUNT] = {\n    [ADD] = add, [SUB] = sub, [DIV] = div, [MUL] = mul\n};\n\ndouble add(double *arguments) { return arguments[0] + arguments[1]; }\n/* and so on for other operators */\n</code></pre>\n\n<p>Also, you may want to combine <code>arity</code> and <code>operators</code> maps.</p>\n\n<p>One more thing is that declaring a static array for arguments may require knowing the maximum amongst <code>arity</code> values. This structure will let you implement any-arity  operators without having much code rewrite.</p>\n\n<p>Also, instead of <code>double</code> you can use any generalized value structure you want.</p>\n"}], "owner": {"reputation": 926, "user_id": 1900748, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/x1moH.jpg?s=128&g=1", "display_name": "LMG", "link": "https://stackoverflow.com/users/1900748/lmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447872518, "creation_date": 1447871620, "last_edit_date": 1447872518, "question_id": 33787703, "link": "https://stackoverflow.com/questions/33787703/generalize-function-pointers", "title": "generalize function pointers", "body": "<p>Yesterday night I've written the following piece of code to perform some arithmetical operation (sum, multiplication, subtraction, division).</p>\n\n<pre><code> data operation(int oper, data e1, data e2){\n   data res;\n   basic b;\n   //pointer to a funcion that takes two int input and return an int\n   int (*funIntPtr)(int,int);\n   float (*funFloatPtr)(float,float);\n\n   funIntPtr = NULL;\n   funFloatPtr= NULL;\n   //I look for the function to be called\n     switch (oper) {\n       case MINUS:\n         //*functionPtr = &amp;subInt;\n         switch (e1.b.type) {\n           case basic_int_value:funIntPtr = subInt;break;\n           case basic_float_value:funFloatPtr = subFloat;break;\n           case basic_boolean_value:\n             yyerror(\"boolean arithmetic operation are NOT_ALLOWED\");\n             exit(NOT_ALLOWED);\n             break;\n         }\n         break;\n       case PLUS :\n         switch (e1.b.type) {\n           case basic_int_value:funIntPtr = addInt;break;\n           case basic_float_value:funFloatPtr = addFloat;break;\n           case basic_boolean_value:\n             yyerror(\"boolean arithmetic operation are NOT_ALLOWED\");\n             exit(NOT_ALLOWED);\n             break;\n         }\n         break;\n       case MULTIPLY:\n         switch (e1.b.type) {\n           case basic_int_value:funIntPtr = mulInt;break;\n           case basic_float_value:funFloatPtr = mulFloat;break;\n           case basic_boolean_value:\n             yyerror(\"boolean arithmetic operation are NOT_ALLOWED\");\n             exit(NOT_ALLOWED);\n             break;\n         }\n         break;\n       case DIVIDE :\n         switch (e1.b.type) {\n           case basic_int_value:funIntPtr = divInt;break;\n           case basic_float_value:funFloatPtr = divFloat;break;\n           case basic_boolean_value:\n             yyerror(\"boolean arithmetic operation are NOT_ALLOWED\");\n             exit(NOT_ALLOWED);\n             break;\n         }\n         break;\n       default:\n         yyerror(\"what now?\");\n         exit(BUGGY_THE_CLOWN);\n         break;\n      }\n    //look for values to be used\n    if( funIntPtr == NULL &amp;&amp; funFloatPtr == NULL){\n      yyerror(\"no function found for the specified operation..\");\n      exit(BUGGY_THE_CLOWN);\n    }\n    res.type = basic_dataType;\n    res.b.type = e1.b.type;//inherithed\n    switch (e1.b.type) {\n      case basic_int_value:\n        {\n          res.b.i = funIntPtr(e1.b.i, e2.b.i);\n        }\n        break;\n      case basic_float_value:\n        {\n          res.b.f = funFloatPtr(e1.b.f, e2.b.f);\n        }\n        break;\n      case basic_boolean_value:\n      default:\n        yyerror(\"no data found for the specified operation..\");\n        exit(BUGGY_THE_CLOWN);\n    }\n   return res;\n }\n</code></pre>\n\n<p>In the first part I find the function to be used and in the second part I collect the input data to be used. It works fine and it serves the purpose.</p>\n\n<pre><code>typedef struct data{\n    dataType type;\n    union{\n      complex c;\n      basic b;\n    };\n}data;\n</code></pre>\n\n<p>data is a struct which contains either basic types values or complex values. Complex values are array types and structures. About which, for the moment, I don't care.</p>\n\n<pre><code>typedef struct basic{\n  basicType type;\n  union{\n     int i;\n     float f;\n     bool b;\n  };\n}basic;\n</code></pre>\n\n<p>Basic values atm contains just integers, floats and booleans.</p>\n\n<p>But I was wondering if I can make it more compact and efficient.\nFor example I have declared two function pointer but I use only one of them. Is there any way to generalize the function pointer?</p>\n\n<p>I know I have to declare the input types and return type, but in this case it would be great to defer such function specialization in order to have only one pointer.\nIs it possible or should I change the way I'm tackling the problem?</p>\n\n<p>Any constructive suggestion is well accepted :)</p>\n"}, {"tags": ["c", "loops", "gcc", "syntax"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447871796, "post_id": 33787546, "comment_id": 55342303, "body": "It&#39;s a peculiar way to write a <code>for</code> loop. The second expression usually tests the loop iterator at the start of each loop, the third usually modifies it at the end of each loop. Writing trick loops and then asking &quot;how does this work&quot; is not good."}, {"owner": {"reputation": 73, "user_id": 3907906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef722a6232ba1573a77781c8fa12431?s=128&d=identicon&r=PG&f=1", "display_name": "lubosmj", "link": "https://stackoverflow.com/users/3907906/lubosmj"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1447871921, "post_id": 33787546, "comment_id": 55342389, "body": "This code is for study purposes and it is not written by me. Thank you for explanation."}, {"owner": {"reputation": 1, "user_id": 11357671, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b12cc40c2b74c57fd45794f807f15a12?s=128&d=identicon&r=PG", "display_name": "hobbyist", "link": "https://stackoverflow.com/users/11357671/hobbyist"}, "edited": false, "score": 0, "creation_date": 1555208330, "post_id": 33787546, "comment_id": 98029117, "body": "&#39;i&#39; is called before the loop and will run fine through g++. This is an indicator for index manipulations. I&#39;ve seen three go by and am not sure how to tool code like that. Interesting point."}], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 5, "last_activity_date": 1447871224, "creation_date": 1447871224, "answer_id": 33787570, "question_id": 33787546, "link": "https://stackoverflow.com/questions/33787546/what-does-i-i1-mean-in-c-programming-language/33787570#33787570", "title": "What does i = i&amp;1 mean in C programming language?", "body": "<p><code>&amp;</code> is <code>bitwise AND</code> operator</p>\n\n<pre><code>i = i&amp;1 // this AND's bits of i to bits of value 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 3907906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef722a6232ba1573a77781c8fa12431?s=128&d=identicon&r=PG&f=1", "display_name": "lubosmj", "link": "https://stackoverflow.com/users/3907906/lubosmj"}, "edited": false, "score": 0, "creation_date": 1447871794, "post_id": 33787608, "comment_id": 55342301, "body": "I have fixed that. And thank you for your fast response."}, {"owner": {"reputation": 73, "user_id": 3907906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef722a6232ba1573a77781c8fa12431?s=128&d=identicon&r=PG&f=1", "display_name": "lubosmj", "link": "https://stackoverflow.com/users/3907906/lubosmj"}, "edited": false, "score": 0, "creation_date": 1447872421, "post_id": 33787608, "comment_id": 55342695, "body": "We have got this piece of code on exam. It is kind of catch question where you have to determine number of iterations and value of i variable."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1447878016, "post_id": 33787608, "comment_id": 55346202, "body": "<code>i &amp; 1</code> is not  equivalent to <code>i % 2</code>.  Try it with <code>i = -1</code>."}, {"owner": {"reputation": 4003, "user_id": 4331480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oWiMU.jpg?s=128&g=1", "display_name": "therainmaker", "link": "https://stackoverflow.com/users/4331480/therainmaker"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1447909360, "post_id": 33787608, "comment_id": 55357805, "body": "@chux : Thank you, fixed it."}], "tags": [], "owner": {"reputation": 4003, "user_id": 4331480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oWiMU.jpg?s=128&g=1", "display_name": "therainmaker", "link": "https://stackoverflow.com/users/4331480/therainmaker"}, "is_accepted": false, "score": 4, "last_activity_date": 1447909345, "last_edit_date": 1447909345, "creation_date": 1447871350, "answer_id": 33787608, "question_id": 33787546, "link": "https://stackoverflow.com/questions/33787546/what-does-i-i1-mean-in-c-programming-language/33787608#33787608", "title": "What does i = i&amp;1 mean in C programming language?", "body": "<p><code>i = i&amp;1</code> will extract the least significant bit of <code>i</code> as <code>&amp;</code> is the <code>bitwise AND</code> operator.</p>\n\n<p>However, the program you've written is Undefined Behavior (error with g++). This is because you define <code>i</code> in the <code>for</code> loop, and once the loop ends, <code>i</code> goes out of scope. So printing it afterwards in the next line gives an error.</p>\n\n<p>Coming to your code, I would seriously love to know where you saw it, cause it seems horrible to me. The conditions of the <code>for</code> loop seem convoluted, and I can't explain how the loop will run (which is probably not a good thing).</p>\n"}, {"tags": [], "owner": {"reputation": 106, "user_id": 5520114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FrYXN.jpg?s=128&g=1", "display_name": "mcr76", "link": "https://stackoverflow.com/users/5520114/mcr76"}, "is_accepted": true, "score": 7, "last_activity_date": 1447872158, "creation_date": 1447872158, "answer_id": 33787859, "question_id": 33787546, "link": "https://stackoverflow.com/questions/33787546/what-does-i-i1-mean-in-c-programming-language/33787859#33787859", "title": "What does i = i&amp;1 mean in C programming language?", "body": "<p>At the begin of the for-Loop:</p>\n\n<ul>\n<li>i is set to 5</li>\n</ul>\n\n<p>Next step is: Check i--, which means:</p>\n\n<ul>\n<li>First: i = 5 > 0 => true</li>\n<li>Second: set i to i - 1 => i = 4</li>\n</ul>\n\n<p>Next step: do the inner block. </p>\n\n<p>Next step: i = i &amp; 1, which results in:</p>\n\n<ul>\n<li>4&amp;1 => 0100 &amp; 0001 => i = 0</li>\n</ul>\n\n<p>Next step: Check i--</p>\n\n<ul>\n<li>First: i = 0 => false </li>\n<li>Second: set i to i - 1 => i = -1</li>\n</ul>\n"}], "owner": {"reputation": 73, "user_id": 3907906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef722a6232ba1573a77781c8fa12431?s=128&d=identicon&r=PG&f=1", "display_name": "lubosmj", "link": "https://stackoverflow.com/users/3907906/lubosmj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7880, "favorite_count": 1, "accepted_answer_id": 33787859, "answer_count": 3, "score": -2, "last_activity_date": 1555211105, "creation_date": 1447871153, "last_edit_date": 1592644375, "question_id": 33787546, "link": "https://stackoverflow.com/questions/33787546/what-does-i-i1-mean-in-c-programming-language", "title": "What does i = i&amp;1 mean in C programming language?", "body": "<p>I got this sample code and I really do not understand how does it work. It is compiled by GCC and there are no errors at all.</p>\n<p>Also, can you please tell me what this piece of code &quot;<em><strong>i = i&amp;1</strong></em>&quot; does? Thank you!</p>\n<pre><code>int main(void){\n  int i;\n  for (i = 5; i--; i = i&amp;1) {\n    puts(&quot;iteration&quot;); \n  }\n  printf(&quot;%d\\n&quot;,i);\n  return 0;\n}\n</code></pre>\n<p>Output of this program is:</p>\n<blockquote>\n<p>iteration</p>\n<p>-1</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 10, "creation_date": 1447870873, "post_id": 33787421, "comment_id": 55341778, "body": "C is designed by programmers for programmers. If you tell the compiler that you want to shoot yourself in the foot, it won&#39;t stop you."}, {"owner": {"reputation": 21862, "user_id": 12971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1693336f1e00e61f15d541a3fd610eb8?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/12971/greg"}, "edited": false, "score": 4, "creation_date": 1447871004, "post_id": 33787421, "comment_id": 55341850, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/382993/why-do-compilers-not-warn-about-out-of-bounds-static-array-indices\">Why do compilers not warn about out-of-bounds static array indices?</a>"}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1447871027, "post_id": 33787421, "comment_id": 55341862, "body": "Compilers just check the syntactic correctness of the program.  They don&#39;t actually execute your logic to see if the program can possibly fail at runtime."}, {"owner": {"reputation": 1285, "user_id": 5003848, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12b681a7a5cab103fa1ea1165685555b?s=128&d=identicon&r=PG&f=1", "display_name": "tonysdg", "link": "https://stackoverflow.com/users/5003848/tonysdg"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 6, "creation_date": 1447871111, "post_id": 33787421, "comment_id": 55341910, "body": "To add to what @ThomasPadron-McCarthy noted, C is like that friend whom you can always rely upon to be up for a night on the town.  Dependable in all the ways that count, but never one to stop you from doing something that you might regret later."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1447871288, "post_id": 33787421, "comment_id": 55342001, "body": "This question should not close, because the comments here are the best way to make someone understand why <code>C</code> allows <i>Undefined Behavior</i>. :)"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 2876238, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3e2ebe248af8672555cc9147240d104a?s=128&d=identicon&r=PG&f=1", "display_name": "rolory", "link": "https://stackoverflow.com/users/2876238/rolory"}, "edited": false, "score": 0, "creation_date": 1447870979, "post_id": 33787449, "comment_id": 55341827, "body": "But if it is cannot be defined, why when I print <code>a[6]</code> it prints it perfectly?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 331, "user_id": 2876238, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3e2ebe248af8672555cc9147240d104a?s=128&d=identicon&r=PG&f=1", "display_name": "rolory", "link": "https://stackoverflow.com/users/2876238/rolory"}, "edited": false, "score": 2, "creation_date": 1447871104, "post_id": 33787449, "comment_id": 55341906, "body": "@rolory: &quot;undefined behavior&quot; simply means that the compiler isn&#39;t required to handle the situation in a particular way; your code didn&#39;t clobber anything important, so it <i>appeared</i> to run without any errors."}, {"owner": {"reputation": 1285, "user_id": 5003848, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12b681a7a5cab103fa1ea1165685555b?s=128&d=identicon&r=PG&f=1", "display_name": "tonysdg", "link": "https://stackoverflow.com/users/5003848/tonysdg"}, "reply_to_user": {"reputation": 331, "user_id": 2876238, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3e2ebe248af8672555cc9147240d104a?s=128&d=identicon&r=PG&f=1", "display_name": "rolory", "link": "https://stackoverflow.com/users/2876238/rolory"}, "edited": false, "score": 0, "creation_date": 1447871621, "post_id": 33787449, "comment_id": 55342200, "body": "@rolory: Put another way, if <code>a[5]</code> is memory location <code>0x600</code>, then <code>a[6]</code> is memory location <code>0x604</code>.  It&#39;s invalid from the programmer&#39;s point of view, but given that the compiler makes no guarantees, the computer sees it as a perfectly valid location in memory.  Coincidentally, this partly explains how a buffer overflow attack works - what&#39;s to stop me from reading/modifying <code>a[6]</code>?"}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 1, "last_activity_date": 1447871026, "last_edit_date": 1447871026, "creation_date": 1447870872, "answer_id": 33787449, "question_id": 33787421, "link": "https://stackoverflow.com/questions/33787421/why-doesnt-the-compiler-warns-me-about-an-obvious-error/33787449#33787449", "title": "Why doesn&#39;t the compiler warns me about an obvious error?", "body": "<p>What you are doing here is called <em>Undefined Behavior</em>. It will not show an error when you go beyond the index of an array.</p>\n\n<p>This means that the behavior that your code will show, cannot be defined.</p>\n\n<hr>\n\n<p>On a side note, I would like to add something I read somewhere. <strong>Please note that this is just something I read, it may be wrong, but it does make sense.</strong> In <code>C</code>, some behaviors are not made into errors, because <code>C</code> believes in that the programmers are smart enough not to make mistakes like this. </p>\n"}, {"tags": [], "owner": {"reputation": 17586, "user_id": 3482140, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/lSFth.jpg?s=128&g=1", "display_name": "Am_I_Helpful", "link": "https://stackoverflow.com/users/3482140/am-i-helpful"}, "is_accepted": false, "score": 5, "last_activity_date": 1447870949, "creation_date": 1447870949, "answer_id": 33787476, "question_id": 33787421, "link": "https://stackoverflow.com/questions/33787421/why-doesnt-the-compiler-warns-me-about-an-obvious-error/33787476#33787476", "title": "Why doesn&#39;t the compiler warns me about an obvious error?", "body": "<p>C doesn't have any standard on constraint on array index out of bound checking.</p>\n\n<p>That means programs are free to violate the index rule. It is upto the programmers to check the array index constraint.</p>\n\n<p>And, that will result in an undefined behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "is_accepted": false, "score": 1, "last_activity_date": 1447871136, "creation_date": 1447871136, "answer_id": 33787540, "question_id": 33787421, "link": "https://stackoverflow.com/questions/33787421/why-doesnt-the-compiler-warns-me-about-an-obvious-error/33787540#33787540", "title": "Why doesn&#39;t the compiler warns me about an obvious error?", "body": "<p>C does not perform array bounds checking.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1129665"}, "is_accepted": false, "score": 2, "last_activity_date": 1447872059, "last_edit_date": 1447872059, "creation_date": 1447871290, "answer_id": 33787590, "question_id": 33787421, "link": "https://stackoverflow.com/questions/33787421/why-doesnt-the-compiler-warns-me-about-an-obvious-error/33787590#33787590", "title": "Why doesn&#39;t the compiler warns me about an obvious error?", "body": "<p>This error has nothing to do with the compiler. Whether it's C or Java, as long as it does not violate the language syntax and semantic, the code will compile.</p>\n\n<p>What you have is a logical error which could be detected by the language run-time environment, e.g. JVM, which what C lacks.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1447871772, "last_edit_date": 1447871772, "creation_date": 1447871409, "answer_id": 33787627, "question_id": 33787421, "link": "https://stackoverflow.com/questions/33787421/why-doesnt-the-compiler-warns-me-about-an-obvious-error/33787627#33787627", "title": "Why doesn&#39;t the compiler warns me about an obvious error?", "body": "<p>C does not do any bounds checking on array accesses (that is, the compiler will not inject any code that will throw an exception if you try to access an element outside of the array bounds).  The language standard does not define what should happen if you access items outside of the array bounds; you basically void the warranty on your code when you do that.  </p>\n\n<p>The result can include anything from running to completion with no apparent errors, to throwing a segfault, to triggering a malware routine, etc.  Again, the language definition does not mandate any particular behavior for such an error.  </p>\n\n<p>Remember that C is a product of the early '70s; bounds checks slow you down, and the C philosophy is that the programmer is in the best position to know whether a bounds check is really necessary or not.  The compiler assumes you know how big your array is, and that you know not to try to read or write past the end of it.  </p>\n"}], "owner": {"reputation": 331, "user_id": 2876238, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3e2ebe248af8672555cc9147240d104a?s=128&d=identicon&r=PG&f=1", "display_name": "rolory", "link": "https://stackoverflow.com/users/2876238/rolory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 5, "score": -1, "last_activity_date": 1447872059, "creation_date": 1447870782, "question_id": 33787421, "link": "https://stackoverflow.com/questions/33787421/why-doesnt-the-compiler-warns-me-about-an-obvious-error", "title": "Why doesn&#39;t the compiler warns me about an obvious error?", "body": "<p>So, I just studied the <strong>Arrays</strong> material and got a problem... <br>\nI got this following code:</p>\n\n<pre><code>int a[5]; \nint i;\nfor(i=0; i&lt;=10; i++) {\n    scanf(\"%d\", &amp;a[i]);\n}\n</code></pre>\n\n<p>I declared on an array that its length is 5.\n<img src=\"https://i.imgur.com/KH702Km.png\"> <br>\nThen, I ran a <code>for</code> loop from 0 to 10 that inserts numbers into <code>a[i]</code>.<br>\nI used this table (which I created) to understand what happened during the execute time: <br>\n<img src=\"https://i.imgur.com/mNgWZ0R.png\"> <br>\nYou see the red arrow? That's where the loop she be stopped, because they <code>a[]</code> cannot get more than 5 values into it. Which mean, that <code>a[6]</code> doesn't exist. <br> Even though, it keeps asking for numbers, and keeps saving them into the array. <br><br>\nOne more thing, I'm currently using <b>Dev C++</b> compiler.<br><br>\nDoes anyone has an idea why is it happening? <br>\nThanks!</p>\n"}, {"tags": ["c", "stack"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1447870450, "post_id": 33787296, "comment_id": 55341528, "body": "what do you mean by &#39;work with typedef&#39;? Are you unsure about it&#39;s usage? Do you have errors when you try to use typedefed type? Something else?"}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 1, "creation_date": 1447870456, "post_id": 33787296, "comment_id": 55341532, "body": "<code>top-&gt;info = *elem;</code> <code>info</code> is an <code>int</code>, but <code>*elem</code> is an <code>item</code>."}, {"owner": {"reputation": 1623, "user_id": 2938633, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b7a9a16a5d22c2009f131694196a212f?s=128&d=identicon&r=PG&f=1", "display_name": "Blnpwr", "link": "https://stackoverflow.com/users/2938633/blnpwr"}, "edited": false, "score": 0, "creation_date": 1447870549, "post_id": 33787296, "comment_id": 55341586, "body": "I mean, I have never worked with it. I roughly understand what it means, but it is a bit difficult to me when I have to use it implementing a method ( in this case my push method)"}, {"owner": {"reputation": 1623, "user_id": 2938633, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b7a9a16a5d22c2009f131694196a212f?s=128&d=identicon&r=PG&f=1", "display_name": "Blnpwr", "link": "https://stackoverflow.com/users/2938633/blnpwr"}, "edited": false, "score": 0, "creation_date": 1447870589, "post_id": 33787296, "comment_id": 55341608, "body": "Do I have to declare info as an *elem, would it fix my problem?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1447870800, "post_id": 33787296, "comment_id": 55341732, "body": "If you are unsure, don&#39;t combine things like you do. First define the struct, then create a typedef for it and define variables of that type, as separate statemens. I mean, something like this: <code>struct X {...}; typedef struct X X; X *temp;</code>. The easy rule about <code>typedef</code> is, that it is like defining a variable, except it defines a type: <code>int A;</code> defines variable <code>A</code> (of type <code>int</code>), so <code>typedef int A;</code> defines type <code>A</code> (to be same as <code>int</code>);"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1447871041, "post_id": 33787296, "comment_id": 55341874, "body": "Another note, some consider it a bad practice to <code>typedef</code> structs like that. Read this and links there for more on that: <a href=\"http://stackoverflow.com/questions/10243149/why-is-typedef-struct-foo-foo-considered-harmful\" title=\"why is typedef struct foo foo considered harmful\">stackoverflow.com/questions/10243149/&hellip;</a>"}, {"owner": {"reputation": 1623, "user_id": 2938633, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b7a9a16a5d22c2009f131694196a212f?s=128&d=identicon&r=PG&f=1", "display_name": "Blnpwr", "link": "https://stackoverflow.com/users/2938633/blnpwr"}, "edited": false, "score": 0, "creation_date": 1447871176, "post_id": 33787296, "comment_id": 55341945, "body": "Nah, I don&#39;t know how to solve this. Sorry, maybe it is because of too much programming, but I am desperated here because of this"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1447871204, "post_id": 33787296, "comment_id": 55341956, "body": "Why is <code>struct item</code> empty, anyway?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1447872076, "post_id": 33787296, "comment_id": 55342490, "body": "@hyde: A variable definition allocates storage and declares it. A <code>typedef</code> just defines an alias. They are definitively not alike."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447872192, "post_id": 33787296, "comment_id": 55342551, "body": "@Olaf I meant syntactically: You can just add <code>typedef</code> in front of a variable definition, and it becomes a type definition (or is there some case where this isn&#39;t so?)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1447872388, "post_id": 33787296, "comment_id": 55342672, "body": "@hyde: Yes, there is. Try adding an initialiser to the variable definition (note that without it it is just a <i>declaration</i> or tentative definition."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447873789, "post_id": 33787296, "comment_id": 55343572, "body": "@Olaf Ok, right, let&#39;s clarify, variable definition without explicit initializer can be turned into type definition by prepending <code>typedef</code>, and vice versa. The point of that &quot;rule&quot; is, it makes it easy to remember which way the existing type and the new type name go after <code>typedef</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1623, "user_id": 2938633, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b7a9a16a5d22c2009f131694196a212f?s=128&d=identicon&r=PG&f=1", "display_name": "Blnpwr", "link": "https://stackoverflow.com/users/2938633/blnpwr"}, "edited": false, "score": 0, "creation_date": 1447871483, "post_id": 33787592, "comment_id": 55342114, "body": "Hello, thanks for your answer. But what you assume &quot; elem is already created&quot; is my problem. I do not know how to create this."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 1623, "user_id": 2938633, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b7a9a16a5d22c2009f131694196a212f?s=128&d=identicon&r=PG&f=1", "display_name": "Blnpwr", "link": "https://stackoverflow.com/users/2938633/blnpwr"}, "edited": false, "score": 0, "creation_date": 1447871529, "post_id": 33787592, "comment_id": 55342144, "body": "It gets created in the <code>new_item</code> function."}, {"owner": {"reputation": 17608, "user_id": 3650362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fqdi1.jpg?s=128&g=1", "display_name": "trentcl", "link": "https://stackoverflow.com/users/3650362/trentcl"}, "edited": false, "score": 0, "creation_date": 1447871825, "post_id": 33787592, "comment_id": 55342318, "body": "I think you mean <code>typedef struct node item;</code> near the top."}], "tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": true, "score": 1, "last_activity_date": 1447871860, "last_edit_date": 1447871860, "creation_date": 1447871305, "answer_id": 33787592, "question_id": 33787296, "link": "https://stackoverflow.com/questions/33787296/using-typedef-and-pointer-in-c-for-implementing-a-stack/33787592#33787592", "title": "Using typedef and pointer in C for implementing a Stack", "body": "<p>First, the typedef:</p>\n\n<pre><code>struct node  \n{\n    int info;\n    struct node *ptr;\n};\ntypedef struct node item;\n</code></pre>\n\n<p>And create a pointer:</p>\n\n<pre><code>item *top = NULL;\n</code></pre>\n\n<p><code>push</code> should simply insert the element at the top of the stack.</p>\n\n<pre><code>void push(item *elem)\n{\n    // I assume elem is already created.\n    if (top == NULL)\n    {\n        top = elem;\n    }\n    else\n    {\n        top-&gt;ptr = elem;\n        top = elem;\n    }\n    count++;\n}\n</code></pre>\n\n<p><code>new_item</code> should allocate memory and initialize</p>\n\n<pre><code>item* new_item(int value)\n{\n    item *temp = malloc(sizeof(item));\n    item-&gt;info = value;\n    item-&gt;ptr = NULL;\n}\n</code></pre>\n\n<p>Somewhere else, create and add....</p>\n\n<pre><code>item *someNewItem = new_item(100);\npush(someNewItem);\n// Later on, someNewItem needs to be free()'d\n</code></pre>\n"}], "owner": {"reputation": 1623, "user_id": 2938633, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b7a9a16a5d22c2009f131694196a212f?s=128&d=identicon&r=PG&f=1", "display_name": "Blnpwr", "link": "https://stackoverflow.com/users/2938633/blnpwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 33787592, "answer_count": 1, "score": -1, "last_activity_date": 1447871860, "creation_date": 1447870337, "question_id": 33787296, "link": "https://stackoverflow.com/questions/33787296/using-typedef-and-pointer-in-c-for-implementing-a-stack", "title": "Using typedef and pointer in C for implementing a Stack", "body": "<p>I am facing problems compiling this code, because I do not know how to work with typedef (but we have to). My method push has item *elem as input but top -> info = *elem does not work. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n\nstruct node  \n{\nint info;\n\nstruct node *ptr;\n}*top,*top1,*temp;\n\n\ntypedef struct item {\n\n} item;\n\n// my methods\nvoid push(item *elem);\nvoid *pop();\nvoid empty();\nvoid create();\n\nint count = 0;\n\nvoid create()\n{\n   top = NULL;\n }\n\n\n // pushing the elements in the stack\n void push(item *elem)\n {\n    if (top == NULL)\n    {\n        top =(struct node *)malloc(1*sizeof(struct node));\n        top-&gt;ptr = NULL;\n        top-&gt;info = *elem;\n    }\n   else\n    {\n        temp =(struct node *)malloc(1*sizeof(struct node));\n        temp-&gt;ptr = top;\n        temp-&gt;info = *elem;  // here is the error \"not compatible\"\n        top = temp;\n    }\n    count++;\n }\n    // I also got this, this is for creating a new elem, but I do not  \n     // know how to implement this method\n  item* new_item(int value) {\n\n }\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "strtok"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 1, "creation_date": 1447870089, "post_id": 33787176, "comment_id": 55341318, "body": "Have you tried compiling with debug symbols and executing under GDB or something similar?  This will tell you precisely where the problem is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1447870233, "post_id": 33787176, "comment_id": 55341400, "body": "yes I did, each time I fix something something else pops up, so something is wrong with the way I built the code or I&#39;m using strtok in a wrong way."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "edited": false, "score": 0, "creation_date": 1447870432, "post_id": 33787176, "comment_id": 55341511, "body": "yes but I&#39;m using realloc when needed"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447870668, "post_id": 33787176, "comment_id": 55341654, "body": "<code>cmd = -1</code> should be set <i>inside</i> the <code>while(fgets(...))</code> loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "edited": false, "score": 0, "creation_date": 1447870741, "post_id": 33787176, "comment_id": 55341695, "body": "it is inside the loop at the end"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447870804, "post_id": 33787176, "comment_id": 55341734, "body": "Don&#39;t do that. Set the variables first, same with <code>i</code> and <code>j</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "edited": false, "score": 0, "creation_date": 1447870875, "post_id": 33787176, "comment_id": 55341779, "body": "all of them are defined at the top of the main function, then they are reset and the end of the while loop"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447870930, "post_id": 33787176, "comment_id": 55341804, "body": "It&#39;s poor practice, makes the code hard to follow, makes you set them twice, and requires the code to be read bottom-up."}, {"owner": {"reputation": 428, "user_id": 1626064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCyTI.jpg?s=128&g=1", "display_name": "zeyorama", "link": "https://stackoverflow.com/users/1626064/zeyorama"}, "edited": false, "score": 2, "creation_date": 1447870997, "post_id": 33787176, "comment_id": 55341842, "body": "I could be wrong, but doesn&#39;t execv  need the last element in the parameter list to be NULL, so that it can determine the end of the array?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447871316, "post_id": 33787176, "comment_id": 55342015, "body": "@WeatherVane ok will do so user3121023 so the for loop it self isn&#39;t needed, I tried without it leads codes not working. zeyorama if that&#39;s true then that will explain why some lines just don&#39;t work so I have to set the last member of params to null. I will test it out"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "edited": false, "score": 0, "creation_date": 1447871421, "post_id": 33787541, "comment_id": 55342079, "body": "yes I will test it out right now, and give feedback"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "edited": false, "score": 1, "creation_date": 1447872143, "post_id": 33787541, "comment_id": 55342536, "body": "it appears to be working thank you, I applied your fix and what @zeyorama mentioned"}], "tags": [], "owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "is_accepted": true, "score": 2, "last_activity_date": 1447871546, "last_edit_date": 1447871546, "creation_date": 1447871143, "answer_id": 33787541, "question_id": 33787176, "link": "https://stackoverflow.com/questions/33787176/c-language-freeing-memory-after-using-strtok-to-build-char/33787541#33787541", "title": "C Language- freeing memory after using strtok to build char**", "body": "<p>You should add</p>\n\n<pre><code>params[0] = NULL;\n</code></pre>\n\n<p>right after the initial malloc (or use calloc) otherwise you'll be using an unitialized pointer if the line is empty. Then at the end</p>\n\n<pre><code>free(params);\n</code></pre>\n\n<p>you don't need to free any of params[i] since those are pointers into the local line[] buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 17723, "user_id": 733077, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/db1bf62fae51d5bafb8f1db7fb677176?s=128&d=identicon&r=PG", "display_name": "luser droog", "link": "https://stackoverflow.com/users/733077/luser-droog"}, "is_accepted": false, "score": 4, "last_activity_date": 1447871157, "creation_date": 1447871157, "answer_id": 33787552, "question_id": 33787176, "link": "https://stackoverflow.com/questions/33787176/c-language-freeing-memory-after-using-strtok-to-build-char/33787552#33787552", "title": "C Language- freeing memory after using strtok to build char**", "body": "<p><code>strtok</code> parses a string <em>in-place</em> so you should not free the individual results. They are portions of the original string. You can use the POSIX function <code>strdup</code> to make copies that can be free'd, and will persist beyond the life of the original buffer contents.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2411267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 33787541, "answer_count": 2, "score": 2, "last_activity_date": 1447871546, "creation_date": 1447869979, "last_edit_date": 1447870676, "question_id": 33787176, "link": "https://stackoverflow.com/questions/33787176/c-language-freeing-memory-after-using-strtok-to-build-char", "title": "C Language- freeing memory after using strtok to build char**", "body": "<p>and sorry for the title I couldn't think of a better way to phrase it.</p>\n\n<p>so I have a C assignment working with <code>fork</code> and <code>exec</code>.</p>\n\n<p>I have three programs called <code>ps</code>, <code>echo</code> and <code>history</code> all of them take different arguments. The final program is called <code>shell</code> and it takes in commands from <code>stdin</code> and calls for <code>exec</code> upon taking a proper command.</p>\n\n<p>example:</p>\n\n<pre><code>ps -a \n\necho Hello World\n\nhistory 1.txt\n</code></pre>\n\n<p>once it reads a line and find it's a valid command it makes a child process and calls for <code>exec</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nconst int MAX_LINE = 100;\n\nconst char *HISTORY = \"./history\";\nconst char *PS = \"./ps\";\nconst char *ECHO = \"./echo\";\n\nvoid call_cmd(int cmd, char *const argv[]);\n\n/* main function */\nint main(int argc, char** argv)\n{\n    FILE * out;\n    char line[MAX_LINE], line_print[MAX_LINE], seps[] = \" \\n\", rm[80];\n    char *first, *tmp, ** params;\n    pid_t pid;\n    int cmd = -1, i = 0,j= 0;\n\n    if (argc != 2)\n    {\n        printf(\"Invalid arguments\");\n        return EXIT_FAILURE;\n    }\n    out = fopen(argv[1],\"w\");\n    if (out == NULL)\n    {\n        perror(\"Couldn't open file to write\");\n        return EXIT_FAILURE;\n    }\n    while(fgets(line,sizeof(line),stdin) != NULL)\n    {\n        strcpy(line_print,line);\n        params = (char**) malloc(sizeof(char*));\n        tmp = strtok(line,seps);\n        while (tmp != NULL)\n        {\n            if(i != 0)\n            params = (char**) realloc(params,sizeof(char*) * (i + 1));\n            params[i] = tmp;\n            j++;\n            tmp = strtok(NULL,seps);\n            i++;\n        }\n        first = params[0];\n        if (strcmp(\"exit\",first) == 0)\n        {\n            sprintf(rm,\"rm %s\",argv[1]);\n            system(rm);\n                        exit(0);\n        }\n        if(strcmp(\"echo\",first) == 0)\n            cmd = 0;\n        if(strcmp(\"history\",first) == 0)\n            cmd = 1;\n        if(strcmp(\"ps\",first) == 0)\n            cmd = 2;\n        if(cmd == -1){\n            perror(\"\\nInvalid Command\\n\");\n        }\n        if(cmd &gt;= 0)\n        {\n            fprintf(out,\"%s\",line_print);\n            pid = fork();\n            if (pid == -1)\n            {\n                perror(\"Error Creating Child\");\n                return EXIT_FAILURE;\n            }\n            if(pid == 0)\n            {\n                call_cmd(cmd,params);\n                exit(0);\n            }\n        }   \n        for (i = 0; i &lt; j ; i++)\n             free(params[i]);\n        free(params);   \n        i = j = 0;\n        cmd = -1;\n    }\n    fclose(out);\n    return EXIT_SUCCESS;\n}\n\nvoid call_cmd(int cmd, char *const argv[])\n{\n    switch(cmd)\n    {\n        case 0:\n            execv(ECHO, argv);\n            break;\n        case 1:\n\n            execv(HISTORY, argv);\n            break;\n        default:\n            execv(PS, argv);\n            break;\n    }\n}\n</code></pre>\n\n<p>that is my code so far, it behaves in a weird way causing segmentation faults,\nI'm pretty sure it's because of the way I split the parameters and free them.</p>\n\n<p>example output:</p>\n\n<pre><code>*** Error in `./shell': double free or corruption (out): 0x00007ffe58f1a630 ***\nParent Id: 1928\nAborted (core dumped)\n</code></pre>\n\n<p>so I keep editing the for loop</p>\n\n<pre><code>for (i = 0; i &lt; j ; i++)\n         free(params[i]);\n</code></pre>\n\n<p>all that does is just jump from double free to segmentation faults or I write a command like ps or history and it does nothing, so I must be doing something but I'm truly lost been trying to fix it for two days with, so if you see what I did wrong please point it out.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1447869487, "post_id": 33786932, "comment_id": 55340977, "body": "Whats the problem ? Besides you not <code>free</code>ing the allocated memory ."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447869592, "post_id": 33786932, "comment_id": 55341039, "body": "<code>v3=(int*)malloc(n*m*sizeof(int));</code> should be <code>v3=malloc((n+m)*sizeof(int));</code> you multiplied where you should add."}, {"owner": {"reputation": 11, "user_id": 5574269, "user_type": "registered", "profile_image": "https://graph.facebook.com/981452025249552/picture?type=large", "display_name": "Radu Costel", "link": "https://stackoverflow.com/users/5574269/radu-costel"}, "edited": false, "score": 0, "creation_date": 1447869668, "post_id": 33786932, "comment_id": 55341080, "body": "I dont know how to add the next elements, i know how to add the first two from both arrays,but i want them to continue ,like the example i showed up.   v1 { 1 2 3 4 }  v2 { 5 6 7 8 }  v3 { 1 2 5 6 3 4 7 8 }  i can only make 1 2 5 6 but not the rest."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447869803, "post_id": 33786932, "comment_id": 55341159, "body": "You could have another indexing variable, say <code>int j=0;</code> and then your loops can do <code>v3[j++]=v1[i];</code> and so on."}, {"owner": {"reputation": 11, "user_id": 5574269, "user_type": "registered", "profile_image": "https://graph.facebook.com/981452025249552/picture?type=large", "display_name": "Radu Costel", "link": "https://stackoverflow.com/users/5574269/radu-costel"}, "edited": false, "score": 0, "creation_date": 1447871189, "post_id": 33786932, "comment_id": 55341952, "body": "Hmm, i will try this too. Thank you Weather Vane."}, {"owner": {"reputation": 11, "user_id": 5574269, "user_type": "registered", "profile_image": "https://graph.facebook.com/981452025249552/picture?type=large", "display_name": "Radu Costel", "link": "https://stackoverflow.com/users/5574269/radu-costel"}, "edited": false, "score": 0, "creation_date": 1447871462, "post_id": 33786932, "comment_id": 55342101, "body": "RM Faheem im not sure how to do that..."}, {"owner": {"reputation": 68, "user_id": 1703071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980f568cbfae51e7cfd682e54a54166e?s=128&d=identicon&r=PG", "display_name": "RM Faheem", "link": "https://stackoverflow.com/users/1703071/rm-faheem"}, "edited": false, "score": 0, "creation_date": 1447872035, "post_id": 33786932, "comment_id": 55342470, "body": "oh sorry i mistakenly pressed enter key for the next line instead of shift+enter"}, {"owner": {"reputation": 68, "user_id": 1703071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980f568cbfae51e7cfd682e54a54166e?s=128&d=identicon&r=PG", "display_name": "RM Faheem", "link": "https://stackoverflow.com/users/1703071/rm-faheem"}, "edited": false, "score": 0, "creation_date": 1447872049, "post_id": 33786932, "comment_id": 55342479, "body": "i explain the psuedo code, u can easily implement as  use nested for loops: in for loop i with increment of 4,  and other sub loop j with increment of 2 assign v3(i) as jth element of v1 and v3(i+1) j+1 element of v1 assign v3(i+2) as jth elem of v2 and v3(i+4) as j+1 element of v2  I hope this will help.."}, {"owner": {"reputation": 11, "user_id": 5574269, "user_type": "registered", "profile_image": "https://graph.facebook.com/981452025249552/picture?type=large", "display_name": "Radu Costel", "link": "https://stackoverflow.com/users/5574269/radu-costel"}, "edited": false, "score": 0, "creation_date": 1447880000, "post_id": 33786932, "comment_id": 55347300, "body": "Thank you RM. I will try to code what you&#39;ve said, even though i&#39;m having real problems with understanding algorithms."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5574269, "user_type": "registered", "profile_image": "https://graph.facebook.com/981452025249552/picture?type=large", "display_name": "Radu Costel", "link": "https://stackoverflow.com/users/5574269/radu-costel"}, "edited": false, "score": 0, "creation_date": 1447870983, "post_id": 33787322, "comment_id": 55341831, "body": "Only works for even number of elements,its great though,i couldn&#39;t think of this. But im having a hard time to understand what you did. Thank you gaemaf !"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447878295, "post_id": 33787322, "comment_id": 55346385, "body": "You should explain what changes you made and why"}, {"owner": {"reputation": 39660, "user_id": 3880585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8pfp3.png?s=128&g=1", "display_name": "gaetanoM", "link": "https://stackoverflow.com/users/3880585/gaetanom"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1447881168, "post_id": 33787322, "comment_id": 55348005, "body": "@M.M I hope now it&#39;s all ok! If not, let me know. Thanks so much"}], "tags": [], "owner": {"reputation": 39660, "user_id": 3880585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8pfp3.png?s=128&g=1", "display_name": "gaetanoM", "link": "https://stackoverflow.com/users/3880585/gaetanom"}, "is_accepted": true, "score": 1, "last_activity_date": 1447880974, "last_edit_date": 1447880974, "creation_date": 1447870422, "answer_id": 33787322, "question_id": 33786932, "link": "https://stackoverflow.com/questions/33786932/adding-first-2-elements-from-one-array-and-first-2-elements-from-another-array-i/33787322#33787322", "title": "Adding first 2 elements from one array and first 2 elements from another array in C", "body": "<p>I tried to make as few changes as possible. I hope this could help you.</p>\n\n<p>The first mistake is the allocation of the resulting array of integer. It must be:</p>\n\n<pre><code>v3 = (int*)malloc((n + m)*sizeof(int));\n</code></pre>\n\n<p>The second problem is how to merge the two input arrays in order to obtain your final result.\nThis means you must for the first check if the input arrays are even or odd:</p>\n\n<pre><code>j = ((m % 2) != 0) ? 1 : 0;\n</code></pre>\n\n<p>Then cycling on each input array with a step of two you can merge one after another the two input arrays in a way very similiar to your approach:</p>\n\n<pre><code>for (k = 0; k &lt; m; k += 2) {\n    for (i = k; i &lt; (k + 2) &amp;&amp; i &lt; m; i++) {\n        v3[k + i] = v1[i];\n    }\n    if (i &gt;= m &amp;&amp; j == 1) {\n        v3[m + m - 1] = v2[m - 1];\n    } else {\n        for (i = k; i &lt; (k + 2) &amp;&amp; i &lt; m; i++) {\n            v3[k + i + 2] = v2[i];\n        }\n    }\n}\n</code></pre>\n\n<p>In the following the full code:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\n\nvoid main()\n{\n    int *v1, *v2, *v3, n, m, i, j, k;\n    scanf(\"%d\", &amp;n);\n    m = n;\n    v1 = (int*)malloc(n*sizeof(int));\n    v2 = (int*)malloc(m*sizeof(int));\n    v3 = (int*)malloc((n + m)*sizeof(int));\n\n    for (i = 0; i&lt;n; i++)\n        scanf(\"%d\", &amp;v1[i]);\n    for (j = 0; j&lt;m; j++)\n        scanf(\"%d\", &amp;v2[j]);\n\n    j = ((m % 2) != 0) ? 1 : 0;\n    for (k = 0; k &lt; m; k += 2) {\n        for (i = k; i &lt; (k + 2) &amp;&amp; i &lt; m; i++) {\n            v3[k + i] = v1[i];\n        }\n        if (i &gt;= m &amp;&amp; j == 1) {\n            v3[m + m - 1] = v2[m - 1];\n        } else {\n            for (i = k; i &lt; (k + 2) &amp;&amp; i &lt; m; i++) {\n                v3[k + i + 2] = v2[i];\n            }\n        }\n    }\n    printf(\"sir concatenat =\\n\");\n    for (i = 0; i &lt; (2 * m); i++)\n        printf(\"v3[%d]= %d\\n\", i, v3[i]);\n}\n</code></pre>\n\n\n"}], "owner": {"reputation": 11, "user_id": 5574269, "user_type": "registered", "profile_image": "https://graph.facebook.com/981452025249552/picture?type=large", "display_name": "Radu Costel", "link": "https://stackoverflow.com/users/5574269/radu-costel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 33787322, "answer_count": 1, "score": 0, "last_activity_date": 1447880974, "creation_date": 1447869061, "last_edit_date": 1447870098, "question_id": 33786932, "link": "https://stackoverflow.com/questions/33786932/adding-first-2-elements-from-one-array-and-first-2-elements-from-another-array-i", "title": "Adding first 2 elements from one array and first 2 elements from another array in C", "body": "<p>I'm trying to create a third array of numbers by adding the 2 first elements from first array and 2 first elements from the second array and so on.\nExample: <code>v1 { 1 2 3 4 } v2 { 5 6 7 8 }</code> \nand v3 should be <code>{ 1 2 5 6 3 4 7 8 }</code></p>\n\n<p>All I've done so far: </p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>int *v1,*v2,*v3,n,m,i,j;\nscanf(\"%d\",&amp;n);\nm=n;\nv1=(int*)malloc(n*sizeof(int));\nv2=(int*)malloc(m*sizeof(int));\nv3=(int*)malloc(n*m*sizeof(int));\n\nfor(i=0;i&lt;n;i++)\n    scanf(\"%d\",&amp;v1[i]);\nfor(j=0;j&lt;m;j++)\n    scanf(\"%d\",&amp;v2[j]);\n\nfor(i=0;i&lt;2;i++)\n    v3[i]=v1[i];\nfor(i=0;i&lt;2;i++)\n    v3[2+i]=v2[i];\nprintf(\"sir concatenat =\\n\");\nfor(i=0;i&lt;4;i++)\n    printf(\"v3[%d]= %d\\n\",i,v3[i]);\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1447869268, "post_id": 33786919, "comment_id": 55340848, "body": "In <code>for (i=0; wordsToCount[i] != &#39;\\0&#39;; i++)</code> the array <code>wordsToCount[]</code> is uninitialised, hence you have <i>undefined behaviour</i>."}, {"owner": {"reputation": 1285, "user_id": 5003848, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12b681a7a5cab103fa1ea1165685555b?s=128&d=identicon&r=PG&f=1", "display_name": "tonysdg", "link": "https://stackoverflow.com/users/5003848/tonysdg"}, "edited": false, "score": 0, "creation_date": 1447869508, "post_id": 33786919, "comment_id": 55340989, "body": "You should look at using the <a href=\"http://man7.org/linux/man-pages/man3/strtok.3.html\" rel=\"nofollow noreferrer\"><code>strtok</code></a> function to break up the words in your sentence."}], "owner": {"reputation": 37, "user_id": 5499177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee5cbb3de4dfd50b30da8f0dfb0f489?s=128&d=identicon&r=PG&f=1", "display_name": "user5499177", "link": "https://stackoverflow.com/users/5499177/user5499177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447869314, "creation_date": 1447869028, "last_edit_date": 1447869314, "question_id": 33786919, "link": "https://stackoverflow.com/questions/33786919/count-words-in-a-sentence-in-c", "title": "Count words in a sentence in C?", "body": "<p>I am creating a program which counts the number of words in a given sentence, but when I run the program it gives 0 for every sentence.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nchar wordCount(char sentence[]);\nint main(void) {\n\n        char wordsToCount[100];\n        int numberOfWords;\n        int i;\n\n        printf(\"Word count \\n\");\n        printf(\"========== \\n\");\n\n        for (i=0; wordsToCount[i] != '\\0'; i++) {\n\n                printf(\"Text to be analyzed: \");\n                scanf(\" %s\", &amp;wordsToCount[i]);\n        }\n\n        /*numberOfWords = */wordCount(wordsToCount);\n\n}\n\nchar wordCount(char sentence[]) {\n\n        int wordsCount;\n        int i;\n        int count = 0;\n\n        for (i=0; sentence[i] != '\\0'; i++) {\n\n                if (sentence[i] == ' ') {\n\n                        count++;\n                }\n        }\n\n        printf(\"Word Count : %d \\n\", count);\n}\n</code></pre>\n\n<p>Let's say if I enter:\nHello World. I should get 2, but the program keep asking me to input data again, but if I enter something like:\nC is not that hard! \nI get 0.</p>\n\n<pre><code>Word count\n==========\nText to be analyzed: C is not that hard\nWord Count : 0\n\nWord count\n==========\nText to be analyzed: Hello World\nText to be analyzed: Text to be analyzed: Hello World\nText to be analyzed: Text to be analyzed:\n</code></pre>\n"}, {"tags": ["c", "struct", "linked-list"], "comments": [{"owner": {"reputation": 261, "user_id": 4173899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/afc74a74b89e30c83704d3224e97622d?s=128&d=identicon&r=PG&f=1", "display_name": "scerrecrow", "link": "https://stackoverflow.com/users/4173899/scerrecrow"}, "edited": false, "score": 0, "creation_date": 1447868934, "post_id": 33786855, "comment_id": 55340661, "body": "You are entering in the value for &quot;a&quot; before start has any memory allocated to it, other than the pointer size"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1447869013, "post_id": 33786855, "comment_id": 55340704, "body": "<code>end = (List*)malloc(sizeof(List));</code> should be <code>start = malloc(sizeof(List));</code>"}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1447869945, "post_id": 33786855, "comment_id": 55341236, "body": "haccks is right. find out why casting malloc is not such a good idea: <a href=\"http://stackoverflow.com/questions/1565496/specifically-whats-dangerous-about-casting-the-result-of-malloc\" title=\"specifically whats dangerous about casting the result of malloc\">stackoverflow.com/questions/1565496/&hellip;</a>"}, {"owner": {"reputation": 375, "user_id": 4551823, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/851af7dce4f502a930cb9608b3cd02ef?s=128&d=identicon&r=PG&f=1", "display_name": "Finlandia_C", "link": "https://stackoverflow.com/users/4551823/finlandia-c"}, "edited": false, "score": 0, "creation_date": 1447870513, "post_id": 33786855, "comment_id": 55341569, "body": "I added the line &#39;i realise i shouldn&#39;t cast malloc&#39; because everytime the questions descend into arguments about malloc lol."}], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 3, "last_activity_date": 1447869327, "last_edit_date": 1447869327, "creation_date": 1447869026, "answer_id": 33786918, "question_id": 33786855, "link": "https://stackoverflow.com/questions/33786855/linked-list-printing-in-reverse-or-filling-in-reverse/33786918#33786918", "title": "Linked list printing in reverse (or filling in reverse?)", "body": "<p>You have a memory leak here</p>\n\n<pre><code>end = (List*)malloc(sizeof(List));\nend = NULL;\n</code></pre>\n\n<hr>\n\n<p>Your first <code>start</code> is getting lost.</p>\n\n<hr>\n\n<p>You need to allocate <code>start</code> to <code>end</code> before you allocate memory for <code>start</code> in loop.</p>\n\n<pre><code>start = (List*)malloc(sizeof(List));\nend = NULL;\n\nwhile(scanf(\"%d\", &amp;(start -&gt; a )) == 1)\n{\n   end = start;\n   start = (List*)malloc(sizeof(List));\n   start -&gt; next = end;\n}\n</code></pre>\n\n<hr>\n\n<p>I would like to add that, this is essentially <em>filling the link list in reverse</em>. Because the code fills the link list in reverse order from the beginning</p>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 4551823, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/851af7dce4f502a930cb9608b3cd02ef?s=128&d=identicon&r=PG&f=1", "display_name": "Finlandia_C", "link": "https://stackoverflow.com/users/4551823/finlandia-c"}, "edited": false, "score": 0, "creation_date": 1447880922, "post_id": 33787049, "comment_id": 55347846, "body": "and the *node? Very confused here"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 375, "user_id": 4551823, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/851af7dce4f502a930cb9608b3cd02ef?s=128&d=identicon&r=PG&f=1", "display_name": "Finlandia_C", "link": "https://stackoverflow.com/users/4551823/finlandia-c"}, "edited": false, "score": 0, "creation_date": 1447881161, "post_id": 33787049, "comment_id": 55348001, "body": "@Finlandia_C Don&#39;t free the double pointer. Go to the demo link, and see the last <code>while</code> loop to see how the list gets deleted."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1447869861, "last_edit_date": 1447869861, "creation_date": 1447869543, "answer_id": 33787049, "question_id": 33786855, "link": "https://stackoverflow.com/questions/33786855/linked-list-printing-in-reverse-or-filling-in-reverse/33787049#33787049", "title": "Linked list printing in reverse (or filling in reverse?)", "body": "<p>You are indeed entering the data into the list in a way that the most recent entry ends up at the head of the list.</p>\n\n<p>One way to fix this problem is to make <code>end</code> point to the last <em>pointer</em> to <code>next</code>, and set it to point to <code>start</code> at the beginning. Note that <code>end</code> is now a \"double-pointer\":</p>\n\n<pre><code>List *start = NULL, **end = &amp;start;\nint a; // read data into a local, not into the node\nwhile(scanf(\"%d\", &amp;a) == 1) {\n    // Make a new node\n    List *node = malloc(sizeof(List));\n    // set the data to what we just read\n    node-&gt;a = a;\n    // This is the last node, so next is NULL\n    node-&gt;next = NULL;\n    // end points to previous node's next, so add new node to it\n    *end = node;\n    // Finally, re-point end to new node's next\n    end = &amp;node-&gt;next;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/SFBY9w\" rel=\"nofollow\">Demo.</a></p>\n"}], "owner": {"reputation": 375, "user_id": 4551823, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/851af7dce4f502a930cb9608b3cd02ef?s=128&d=identicon&r=PG&f=1", "display_name": "Finlandia_C", "link": "https://stackoverflow.com/users/4551823/finlandia-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 33787049, "answer_count": 2, "score": 1, "last_activity_date": 1447869861, "creation_date": 1447868829, "last_edit_date": 1447868937, "question_id": 33786855, "link": "https://stackoverflow.com/questions/33786855/linked-list-printing-in-reverse-or-filling-in-reverse", "title": "Linked list printing in reverse (or filling in reverse?)", "body": "<p>If I enter the input for this code as <code>1 2 3 4 5</code> then Ctrl-D to end the program, it will print </p>\n\n<p><code>0 --&gt; 5 --&gt; 4 --&gt; 3 --&gt; 2 --&gt;</code> , which is strange. I tried following a tutorial for building a linked list but I think i've done it slightly wrong. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct list \n{\n   int a;\n   struct list *next;\n};\ntypedef struct list List;\n\nint main (void)\n{\n   List *start, *end;\n\n   end = (List*)malloc(sizeof(List));\n   end = NULL;\n\n   while(scanf(\"%d\", &amp;(start -&gt; a )) == 1)\n   {\n      start = (List*)malloc(sizeof(List));\n      start -&gt; next = end;\n      end = start; \n   }\n\n   end = start;\n\n   while(start)                                      \n   {\n      printf(\"%d --&gt; \", start -&gt; a);\n      start = start -&gt; next;\n   }\n\n   return 0;\n}\n</code></pre>\n\n<ul>\n<li>I realise I shouldn't cast the return of malloc and should be checking the return of scanf! This is merely test code to learn how to build linked lists.</li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2094, "user_id": 5508728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3gtR.jpg?s=128&g=1", "display_name": "jeff carey", "link": "https://stackoverflow.com/users/5508728/jeff-carey"}, "edited": false, "score": 0, "creation_date": 1447868261, "post_id": 33786645, "comment_id": 55340266, "body": "What is the crash?  What line causes it?  (Even if you don&#39;t understand it)"}, {"owner": {"reputation": 5077, "user_id": 2327831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/acb1ec5c15fa33042fa79847c55da18d?s=128&d=identicon&r=PG", "display_name": "this", "link": "https://stackoverflow.com/users/2327831/this"}, "edited": false, "score": 0, "creation_date": 1447868405, "post_id": 33786645, "comment_id": 55340361, "body": "Enable warnings and try to re-compile."}, {"owner": {"reputation": 2916, "user_id": 2108812, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/yiPgB.jpg?s=128&g=1", "display_name": "dietbacon", "link": "https://stackoverflow.com/users/2108812/dietbacon"}, "edited": false, "score": 0, "creation_date": 1447868456, "post_id": 33786645, "comment_id": 55340386, "body": "If you wanna post the problem the least you could do is retype it here instead of posting a link to a picture of your teacher&#39;s powerpoint"}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1447868694, "post_id": 33786645, "comment_id": 55340528, "body": "You, probably, did not understand what a pointer is. strcat, for instance, takes two pointers."}, {"owner": {"reputation": 1, "user_id": 5084282, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204533904643383/picture?type=large", "display_name": "Jake", "link": "https://stackoverflow.com/users/5084282/jake"}, "reply_to_user": {"reputation": 2094, "user_id": 5508728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3gtR.jpg?s=128&g=1", "display_name": "jeff carey", "link": "https://stackoverflow.com/users/5508728/jeff-carey"}, "edited": false, "score": 0, "creation_date": 1447869651, "post_id": 33786645, "comment_id": 55341075, "body": "@jeffcarey a lot of the errors are saying that I&#39;m making an integer from pointer without cast. The program runs and compiles but crashes after inputs."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1447868633, "post_id": 33786750, "comment_id": 55340495, "body": "And <code>link = (char *) malloc(24)</code> is <a href=\"http://stackoverflow.com/a/605858/824425\">technically correct, but poor style</a>."}, {"owner": {"reputation": 12250, "user_id": 70930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8e7e117b5fb845cfe93ae42f43b244a?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/70930/paul"}, "edited": false, "score": 0, "creation_date": 1447869051, "post_id": 33786750, "comment_id": 55340732, "body": "@Rhymoid, yep, you are right, but it won&#39;t compile by C++ compiler without a cast, that was a &quot;muscle memory&quot; typing that cast. Not sure whether I need to edit the answer."}, {"owner": {"reputation": 1, "user_id": 5084282, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204533904643383/picture?type=large", "display_name": "Jake", "link": "https://stackoverflow.com/users/5084282/jake"}, "edited": false, "score": 0, "creation_date": 1447869465, "post_id": 33786750, "comment_id": 55340964, "body": "Hi! I do have a bit of knowledge when working with pointers but dynamic allocation is a really new topic for me. In fact a bit of the mistakes present in that code is because of the frustration and trial and error.  One of the things I&#39;m really having a hard time with is          *fblink = createFBlink(firstname, lastname); I have no idea how that works and no previous answer had anything like that."}, {"owner": {"reputation": 12250, "user_id": 70930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8e7e117b5fb845cfe93ae42f43b244a?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/70930/paul"}, "reply_to_user": {"reputation": 1, "user_id": 5084282, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204533904643383/picture?type=large", "display_name": "Jake", "link": "https://stackoverflow.com/users/5084282/jake"}, "edited": false, "score": 0, "creation_date": 1447874170, "post_id": 33786750, "comment_id": 55343811, "body": "@Jake <code>createFBLink</code> returns <code>char*</code>. <code>fblink</code> is an array of <code>char</code>s that can be treated as a pointer to the first element of an array. <code>*fblink</code> is a first element of the array <code>fblink</code>. So when you do that assignment you assign <code>char*</code> to a <code>char</code>, which is incorrect. You either need to <code>strcpy(fblink, createFBLink(...))</code> to copy buffer returned by <code>createFBLink()</code> to <code>fblink</code> array or change definition of <code>fblink</code> to <code>char* fblink</code> and just assign a pointer <code>fblink = createFBLink(...)</code>. Also, you need to remember to free the pointer returned by <code>createFBLink()</code>."}, {"owner": {"reputation": 12250, "user_id": 70930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8e7e117b5fb845cfe93ae42f43b244a?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/70930/paul"}, "reply_to_user": {"reputation": 1, "user_id": 5084282, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204533904643383/picture?type=large", "display_name": "Jake", "link": "https://stackoverflow.com/users/5084282/jake"}, "edited": false, "score": 0, "creation_date": 1447874556, "post_id": 33786750, "comment_id": 55344050, "body": "@Jake Another better way to handle it is to change definition of <code>createFBLink</code> to accept output parameter: <code>void createFBlink(char *firstname , char *lastname, char* fblink)</code> and fill <code>fblink</code> inside of the function instead of allocating memory and returning a pointer to it. Then, in <code>main()</code> you call <code>createFBLink(firstname, lastname, fblink);</code>. Remember also, that 24 chars of <code>fblink</code> may not be enough to hold 24 chars of <code>firstname</code>, dot, 24 chars of <code>lastname</code> and 13 chars of &quot;@facebook.com&quot;."}, {"owner": {"reputation": 12250, "user_id": 70930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8e7e117b5fb845cfe93ae42f43b244a?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/70930/paul"}, "reply_to_user": {"reputation": 1, "user_id": 5084282, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204533904643383/picture?type=large", "display_name": "Jake", "link": "https://stackoverflow.com/users/5084282/jake"}, "edited": false, "score": 0, "creation_date": 1447875146, "post_id": 33786750, "comment_id": 55344420, "body": "@Jake, Ok, I re-read the problem text, <code>createFBLink</code> should create a pointer to the link or <code>NULL</code>. Still you can accept output buffer as a parameter and either return pointer to it or <code>NULL</code> depending on the input parameters."}], "tags": [], "owner": {"reputation": 12250, "user_id": 70930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8e7e117b5fb845cfe93ae42f43b244a?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/70930/paul"}, "is_accepted": false, "score": 1, "last_activity_date": 1447869184, "last_edit_date": 1447869184, "creation_date": 1447868439, "answer_id": 33786750, "question_id": 33786645, "link": "https://stackoverflow.com/questions/33786645/how-do-i-return-a-string-from-a-function-in-c/33786750#33786750", "title": "How do I return a string from a function in C?", "body": "<pre><code>*link = (char *) malloc(24);\n</code></pre>\n\n<p>This is incorrect, it should be</p>\n\n<pre><code>link = (char *) malloc(24);\n</code></pre>\n\n<p><code>*link</code> (the same as <code>link[0]</code>) is the first character of the string pointed by <code>link</code>, that assignment is just overwriting the character, not changing the pointer.</p>\n\n<p>The following is also incorrect:</p>\n\n<pre><code>*fblink = createFBlink(firstname, lastname);\n</code></pre>\n\n<p>This:    </p>\n\n<pre><code>strcat(*lastname, ...);\n</code></pre>\n\n<p>is incorrect in the same way. You are getting the first character of the string pointed by <code>lastname</code>, converting it to a pointer and passing this (obviously invalid) pointer to <code>strcat</code>. This is the most likely reason of the crash.\nAlso, 24 characters may not be enough to hold the concatenated string.</p>\n\n<p>Try to read a book about working with pointers in C, trying to understand them via trial-and-error is probably not the most effective way.</p>\n"}, {"tags": [], "owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1447870848, "last_edit_date": 1447870848, "creation_date": 1447870421, "answer_id": 33787321, "question_id": 33786645, "link": "https://stackoverflow.com/questions/33786645/how-do-i-return-a-string-from-a-function-in-c/33787321#33787321", "title": "How do I return a string from a function in C?", "body": "<p>When working with strings, you need to understand the types you are using.</p>\n\n<p>This is a fixed area in memory, of fixed size.</p>\n\n<pre><code>char buffer [24];\n</code></pre>\n\n<p>This is a dynamically allocated buffer that must be freed</p>\n\n<pre><code>char* szBuffer = malloc(24);\nfree(szBuffer)\n</code></pre>\n\n<p>Instead of doing that correctly, your createFBlink does malloc twice, and free zero times.</p>\n\n<p>If you return a malloc'ed buffer from a function, you still must free it.</p>\n\n<pre><code>char * result = createFBlink(stuff);\nfree(result);\n</code></pre>\n\n<p>Since the types are different, you would need to use another function to move the string data from one to the other.</p>\n\n<pre><code>char * result = createFBlink(stuff);\nstrcpy(fblink, result, sizeof(fblink));\nfree(result);\n</code></pre>\n\n<p>And then you have additional risk from writing outside the allocated space. Let's try a made-up name with some common names.</p>\n\n<pre><code>firstname \"Richard\"\nlastname  \"Hernandez\"\nreturned string \"Hernandez.Richard@facebook.com\" \n</code></pre>\n\n<p>Oh look, 31 characters in a 24 character string. We just overwrite something, somewhere on your computer. Literally anything could happen, now.</p>\n\n<p>So you have all kinds of risk. You have to match malloc with free. You have to keep track of the size. All of this is considered to be VERY BAD c++ style. The std::string class is highly recommended for this. You want your string class to take care of all the resource management, so you can't mess it up while you are using it.</p>\n\n<pre><code>std::string CreateFacebookLink (const std::string &amp;firstname, const std::string &amp;lastname){\n    return firstname + \".\" + lastname + \"@facebook.com\";\n}\n\nstd::string strFacebookLink (CreateFacebookLink(\"Richard\", \"Hernandez\"));\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5084282, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204533904643383/picture?type=large", "display_name": "Jake", "link": "https://stackoverflow.com/users/5084282/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1447871481, "creation_date": 1447868073, "last_edit_date": 1447871481, "question_id": 33786645, "link": "https://stackoverflow.com/questions/33786645/how-do-i-return-a-string-from-a-function-in-c", "title": "How do I return a string from a function in C?", "body": "<p>I'm working on the following homework problem: </p>\n\n<blockquote>\n  <p>Given the first name and last name as parameters, write the code of\n  the function <code>createFBlink()</code>.  The functions returns a facebook link\n  which serves as an alternate email of the facebook user.  The variable\n  holding the facebook link should contain the minimum number of bytes\n  required to store the string representing the facebook link.  If there\n  is no first name or last name, the function returns <code>NULL</code>.</p>\n  \n  <p>For example, if <code>firstname = tzuyu</code> and <code>lastname = chou</code>, the\n  facebook link is <code>chou.tzuyu@facebook.com</code>.</p>\n</blockquote>\n\n<p>(See the original problem statement <a href=\"https://z-n.ak.fbcdn.net/sphotos-f.ak/hphotos-ak-xpf1/v/t34.0-12/12270551_10205261677157241_346066442_n.jpg?oh=227eb6e1bec61edc89519491e8154fd9&amp;oe=564EA50B&amp;__gda__=1448051583_774e2f9c9eef0a0276624cca5103cdd5\" rel=\"nofollow\">here</a>.)</p>\n\n<p>I've been trying to return a string from <code>createFBlink</code> into <code>main</code>. I've tried multiple methods such as turning char into static but I keep getting errors that I don't understand because I don't have a lot of experience with C.</p>\n\n<p>I've had the best luck with using <code>malloc</code>, but I've come across a problem wherein if ever there are parameters to the function I'm sending from main, I end up with a crash after the input.  Here's my code so far:</p>\n\n<pre><code>    #include &lt;string.h&gt;\n#include &lt;conio.h.&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *createFBlink(char *firstname , char *lastname) ;\n\nint main(void)\n{\n    char firstname[24] , lastname[24], fblink[24] ;\n\n    printf(\"Enter first name: \");\n    scanf(\"%s\", firstname);\n    firstname[strlen(firstname)] = '\\0';\n    printf(\"\\n Enter last name: \");\n    scanf(\"%s\", lastname);\n    lastname[strlen(lastname)] = '\\0';\n\n\n    *fblink = createFBlink(firstname, lastname);\n    if(*firstname == '\\0'){\n        printf(\"no facebook link generated\");\n    }else{\n        printf(\"%s\", *fblink);\n    }\n    getch();\n    return 0;\n}\n\nchar * createFBlink(char *firstname , char *lastname)\n{\n    int check1 = strlen(firstname) , check2 = strlen(lastname), num = check1+check2;\n    char link = (char*) malloc(sizeof(char) * num);\n    if(check1 == 0 || check2 == 0){\n        *firstname = '\\0' ;\n    }else{\n\n        strcat(*lastname, \".\");\n        strcat(*lastname, firstname);\n        strcat(*lastname, \"@facebook.com\");\n        strcpy(link , *lastname);\n        return link;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "makefile", "cmake"], "comments": [{"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 1, "creation_date": 1447873471, "post_id": 33786426, "comment_id": 55343391, "body": "The main point of the <code>autotools</code> package is to facilitate portability across compilers and build environments, something which I think I we may safely assume to be non-issue in your application. I would certainly look into more capable build tools however, such as <code>scons</code> or <code>cmake</code>. The ability to comfortably and reliably craft Rube Goldberg-esque build scripts should not be underestimated, just consider some of the insane C preprocessor or C++ template abuses being committed for the lack of flexible meta-programming facilities."}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1447877008, "post_id": 33786426, "comment_id": 55345597, "body": "@doynax, I am not sure to understand the meaning of your last point."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1447880356, "post_id": 33786426, "comment_id": 55347515, "body": "Sorry but you&#39;ve hit on something of a pet-peeve of mine, albeit tangentially. All I&#39;m trying to say is that the meta-programming facilities available in C/C++ are rather limited and unfortunately many build systems make integrating external code generators and other meta-programming techniques sufficiently painful that it has become common to practice stretch macro and template hacks to ridiculous and unmaintainable lengths. Classic <code>make</code> mostly works yet it is surprisingly easy to miss dependencies and find yourself forcing a rebuild as an incantation at the first sign of trouble."}], "answers": [{"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 1, "last_activity_date": 1447872481, "creation_date": 1447872481, "answer_id": 33787971, "question_id": 33786426, "link": "https://stackoverflow.com/questions/33786426/are-cmake-autotools-useful-for-non-standard-compilers/33787971#33787971", "title": "Are Cmake/Autotools useful for non standard compilers?", "body": "<p>CMake works perfectly with generated sources. Just add appropriate custom command:</p>\n\n<pre><code>add_custom_command(OUTPUT a.c\n    COMMAND jinja &lt;args&gt;\n    DEPENDS a.yaml)\n\nadd_executable(a a.c)\n</code></pre>\n"}], "owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 33787971, "answer_count": 1, "score": 0, "last_activity_date": 1447872481, "creation_date": 1447867417, "question_id": 33786426, "link": "https://stackoverflow.com/questions/33786426/are-cmake-autotools-useful-for-non-standard-compilers", "title": "Are Cmake/Autotools useful for non standard compilers?", "body": "<p>I am working on a complex project written in C/Asm for an embedded target running on an Analog Devices DSP. The toolchain is close to gcc, but they are plenty of differences. Moreover, I am using a lot of autogeneration scripts using Jinja2 to generate header files from data extracted from a database. I also have plenty of compiler flags. </p>\n\n<p>I currently wrote a Makefile from scratch. It is about 400 lines long and works pretty well. I automatically discover the sources across the directories and hold all the dependencies <em>i.e.</em></p>\n\n<pre><code>a.tmpl ---&gt;jinja--&gt;a.c---&gt;a.o\n             ^\na.yaml ------'\n</code></pre>\n\n<p>I would like to know if tools such as Cmake or Automake can be useful in my case. In other words, can I use these tools to simply the readability of Makefile?</p>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1447867443, "post_id": 33786419, "comment_id": 55339747, "body": "Where did you learn that &quot;myfunc() creates an address in the stack&quot;?"}, {"owner": {"reputation": 261, "user_id": 4173899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/afc74a74b89e30c83704d3224e97622d?s=128&d=identicon&r=PG&f=1", "display_name": "scerrecrow", "link": "https://stackoverflow.com/users/4173899/scerrecrow"}, "edited": false, "score": 1, "creation_date": 1447867590, "post_id": 33786419, "comment_id": 55339840, "body": "Since temp is a string literal, it is pointing to the ROM segment, which is usually in the Data section of memory, not on the stack."}], "answers": [{"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1447867653, "post_id": 33786474, "comment_id": 55339889, "body": "Are you sure a pointer to string literal can be returned from a function? <code>temp</code> is automatic local variable."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1447867692, "post_id": 33786474, "comment_id": 55339917, "body": "@haccks Yes, the location of string literals are static through the runtime of the program. Their address won&#39;t change. Returning a pointer to <code>temp</code> (e.g. <code>&amp;temp</code>) will however lead to UB since that variable will &quot;disappear&quot; when the function returns."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1447867744, "post_id": 33786474, "comment_id": 55339952, "body": "I think I am missing something here. It would be nice if you can quote some reference from standard."}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1447867912, "post_id": 33786474, "comment_id": 55340063, "body": "@hacks: Where are you getting stuck on this? We all agree that the variable <code>temp</code> is created on the stack and is no longer available when the function returns, but what is your understanding of where the string literal is stored?"}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1447867986, "post_id": 33786474, "comment_id": 55340102, "body": "@haccks This is no different to returning a pointer to a global variable from the function, or indeed a local<code>int</code> for example; you can always return an object created on the function&#39;s stack frame (even structs, but except arrays of course); you can&#39;t return <i>pointers</i> to such objects."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1447868053, "post_id": 33786474, "comment_id": 55340137, "body": "@JoachimPileborg; Of course it is stored in read only section of memory."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1447868255, "post_id": 33786474, "comment_id": 55340260, "body": "@szczurcio; Here <code>&quot;string&quot;</code> is an object and <code>temp</code> is pointer to it; that means <code>temp</code> can&#39;t be return :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 3, "creation_date": 1447868328, "post_id": 33786474, "comment_id": 55340308, "body": "@haccks Remember that in C values are passed and returned <i>by value</i>, which means the value is copied. Returning a pointer means that the <i>pointer</i> is passed/returned by value, i.e. the pointer is copied."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1447868421, "post_id": 33786474, "comment_id": 55340368, "body": "@JonathanWood; Of course it is stored in read only section of memory."}, {"owner": {"reputation": 768, "user_id": 5543739, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/be7e742aa8ac8a25356e2af2bd276474?s=128&d=identicon&r=PG", "display_name": "susdu", "link": "https://stackoverflow.com/users/5543739/susdu"}, "edited": false, "score": 0, "creation_date": 1447868478, "post_id": 33786474, "comment_id": 55340400, "body": "Thanks, makes sense now. what other types of variables are stored in the Data/ROM?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1447868519, "post_id": 33786474, "comment_id": 55340429, "body": "It is perhaps significant here that pointers are not arrays.  It matters in this case because the the OP&#39;s code would <i>not</i> be correct if <code>temp</code> were instead declared <code>char temp[] = &quot;string&quot;;</code>."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1447868697, "post_id": 33786474, "comment_id": 55340530, "body": "@JoachimPileborg; I forgot about that static storage duration. Make sense now. Thanks :)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 6, "last_activity_date": 1447868270, "last_edit_date": 1447868270, "creation_date": 1447867586, "answer_id": 33786474, "question_id": 33786419, "link": "https://stackoverflow.com/questions/33786419/c-function-returning-pointer/33786474#33786474", "title": "C: function returning pointer", "body": "<p>The location of the <code>temp</code> variable is on the stack, but the location of the string literal (to which <code>temp</code> points) is not stored on the stack. All string literals have a lifetime of the full runtime of the program, and so pointers to a string literal can be passed around freely.</p>\n\n<p>But you should really get in the habit of using <code>const char *</code> when pointing to string literals, as string literals can't be modified.</p>\n\n<hr>\n\n<p>From ISO/IEC 9899:2011, \u00a76.4.5/6:</p>\n\n<blockquote>\n  <p>The multibyte character sequence is then used to initialize an array of <strong>static storage duration</strong></p>\n</blockquote>\n\n<p>(Emphasis mine)</p>\n\n<p>When the specification says \"static storage duration\" it means that the lifetime is the same as the execution of the program.</p>\n"}], "owner": {"reputation": 768, "user_id": 5543739, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/be7e742aa8ac8a25356e2af2bd276474?s=128&d=identicon&r=PG", "display_name": "susdu", "link": "https://stackoverflow.com/users/5543739/susdu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 33786474, "answer_count": 1, "score": 1, "last_activity_date": 1447868270, "creation_date": 1447867405, "question_id": 33786419, "link": "https://stackoverflow.com/questions/33786419/c-function-returning-pointer", "title": "C: function returning pointer", "body": "<p>I have a difficulty in a  conceptual problem</p>\n\n<p>consider this code:</p>\n\n<pre><code>char *myfunc()\n{\nchar *temp = \"string\";\nreturn temp;\n}\n\nint main()\n{\nchar* ptr = myfunc();\n} \n</code></pre>\n\n<p>I can't understand why ptr points to \"string\" after the function call. \nmyfunc() creates an address in the stack which has the value \"string\" and another address which has the address of \"string\".\nWhen the function ends, the memory it had in the stack is freed so it should return a pointer pointing to an address that does not contain \"string\" anymore.</p>\n"}, {"tags": ["c", "x86", "paging", "kvm", "page-tables"], "comments": [{"owner": {"reputation": 25984, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1447872508, "post_id": 33786051, "comment_id": 55342754, "body": "If I understand your question correctly, I think what you want is <code>kvm_read_guest(vcpu-&gt;kvm, (cr3 &amp; VALID_CR3_BITS_MASK)  + i * 8, &amp;pdpte, 8)</code> where <code>VALID_CR3_BITS_MASK==0xfffffff0</code>(not tested)."}, {"owner": {"reputation": 364, "user_id": 1818123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a49672f2dac0e33d9697dcff95311981?s=128&d=identicon&r=PG", "display_name": "Yacine Hebbal", "link": "https://stackoverflow.com/users/1818123/yacine-hebbal"}, "reply_to_user": {"reputation": 25984, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1447879671, "post_id": 33786051, "comment_id": 55347124, "body": "I see, So, I should zero the flags of the entries and not remove them from the physical address ?"}, {"owner": {"reputation": 25984, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1447880230, "post_id": 33786051, "comment_id": 55347439, "body": "Yes AFAIR if you mask (I think the mask I provided above might be wrong so double check it) out the ignored/ressrved bits of CR3 and add 8 (size of each PDPT entry) * i (index into PDPT) you should get the physical address of the PDPTE(ntry)."}, {"owner": {"reputation": 364, "user_id": 1818123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a49672f2dac0e33d9697dcff95311981?s=128&d=identicon&r=PG", "display_name": "Yacine Hebbal", "link": "https://stackoverflow.com/users/1818123/yacine-hebbal"}, "reply_to_user": {"reputation": 25984, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1447880771, "post_id": 33786051, "comment_id": 55347756, "body": "Thanks, and for PDEs and PTEs should I just mask the (12 bits) flags (zero them) ? or shift them and preserve only the base addresses ? It&#39;s not yet very clear to me."}, {"owner": {"reputation": 25984, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 1, "creation_date": 1447953842, "post_id": 33786051, "comment_id": 55386293, "body": "Just mask the ignored/reserved bits. The physical addresses contained in the tables are page aligned."}, {"owner": {"reputation": 364, "user_id": 1818123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a49672f2dac0e33d9697dcff95311981?s=128&d=identicon&r=PG", "display_name": "Yacine Hebbal", "link": "https://stackoverflow.com/users/1818123/yacine-hebbal"}, "reply_to_user": {"reputation": 25984, "user_id": 786653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b710188acb0d8cd30d6cb44061cc15?s=128&d=identicon&r=PG", "display_name": "user786653", "link": "https://stackoverflow.com/users/786653/user786653"}, "edited": false, "score": 0, "creation_date": 1447959748, "post_id": 33786051, "comment_id": 55389873, "body": "Yes, everything works fine now and I can see what I want from the hypervisor :)"}], "owner": {"reputation": 364, "user_id": 1818123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a49672f2dac0e33d9697dcff95311981?s=128&d=identicon&r=PG", "display_name": "Yacine Hebbal", "link": "https://stackoverflow.com/users/1818123/yacine-hebbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447866219, "creation_date": 1447866219, "question_id": 33786051, "link": "https://stackoverflow.com/questions/33786051/linear-address-translation-when-using-pae-paging", "title": "Linear address translation when using pae paging", "body": "<p>I'm trying to walk through (and print) process paging structures from the hypervisor level. The guest I'm running is 32bits OS (ubuntu 12.04) that uses PAE (physical address extensions) paging.</p>\n\n<p>The following picture from intel manual shows the details of the different structures when using PAE paging</p>\n\n<p><a href=\"https://i.stack.imgur.com/7IEdf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7IEdf.png\" alt=\"PAE = 1\"></a></p>\n\n<p>I'm confused about how to use these information:</p>\n\n<p>To access the different PDPTEs: should I use <code>CR3 + i</code> (including the ignored bits) or shift right CR3 by 4 then add an offset <code>(CR3 &gt;&gt; 4) + i</code> ? </p>\n\n<p>Similarly for address of page directory from PDPTEs, I understand that I should exclude the flags from the entry and its 40 bits (12:51). However, I get only 0ed PDEs (I used <code>CR3 + i</code>) for all PDPTEs ...\nI used <code>kvm_read_guest(vcpu-&gt;kvm, cr3 + i, &amp;pdpte, 8)</code> to read PDPTEs and <code>kvm_read_guest(vcpu-&gt;kvm, (pdpte &gt;&gt; 12) + i, &amp;pde, 8)</code> to read PDEs from PDPTEs</p>\n\n<p>If anyone has any explanation for this I would be very thankful :)</p>\n"}, {"tags": ["c", "sizeof"], "comments": [{"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 1, "creation_date": 1447866412, "post_id": 33786002, "comment_id": 55339077, "body": "Partly good reasoning (well, the actual behaviour limits somewhat those possibilities). Now why don&#39;t you check a manual? :) <a href=\"http://en.cppreference.com/w/c/language/sizeof\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/sizeof</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447867094, "post_id": 33786002, "comment_id": 55339524, "body": "@Karoly-Horvath, thanks for the pointer. Makes sense now: since C99 there are runtime requirements placed on <code>sizeof</code>."}], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1447866410, "answer_count": 0, "score": 1, "last_activity_date": 1447866080, "creation_date": 1447866080, "question_id": 33786002, "link": "https://stackoverflow.com/questions/33786002/what-is-sizeof-variable-length-array", "closed_reason": "Duplicate", "title": "What is sizeof() variable length array?", "body": "<p>In a recent post I saw:</p>\n\n<pre><code>scanf(\"%d\" , &amp;TASK_NO);\nstruct task_info tasks[TASK_NO];\nprintf(\"total: %d\\n\", sizeof(tasks)/sizeof(tasks[0]));\n</code></pre>\n\n<p>with a comment: \"<code>sizeof()</code> is evaluated at compile time, not runtime, so will not give the correct number for total.\"</p>\n\n<p>In all the history of the C language, <code>sizeof</code> is evaluated at compile time and can be given a declared array (a declared array is something like <code>int a[10];</code> and <code>sizeof(a)</code> gives 10 times the size of an int). With C99 it is possible to provide the size of an array that is an automatic variable in run time. Does this mean that <code>sizeof</code> for the declared automatic array <code>tasks[TASK_NO]</code> must be evaluated at run time? I.e., has <code>sizeof</code> become something that is sometimes evaluated at run time? If not, is it defined as an error to ask <code>sizeof</code> for a VLA (so the compiler would give a warning/error message as what you are asking is <em>known</em> to not be decidable at compile time)?</p>\n"}, {"tags": ["c", "matlab", "udp", "simulink", "mindstorms"], "comments": [{"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "edited": false, "score": 0, "creation_date": 1447870130, "post_id": 33785571, "comment_id": 55341340, "body": "Are you using the standard firmware from the LEGO Group on the EV3 or are you using a 3rd party OS? Also, both of your code samples look like they are receiving data, what is transmitting? Are you compiling and installing the c code on the EV3?"}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "reply_to_user": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "edited": false, "score": 0, "creation_date": 1447871515, "post_id": 33785571, "comment_id": 55342135, "body": "Hallo David, I am using the standard firmware from LEGO Group. And Yup I am writing the code to receive data. Basically I would want to receive all kind of data using that code, especially the measured data from other hardware. For now, I am sending a infinite sine signal from my raspberry pi and wishing that EV3 can receive the signal. The c-code is being compiled together with the simulink model onto EV3 and being executed there by the matlab function block."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "reply_to_user": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "edited": false, "score": 0, "creation_date": 1447872227, "post_id": 33785571, "comment_id": 55342571, "body": "I have just uploaded the warning I received during the compilation in the question above. Hope you can help me, thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447893550, "post_id": 33789465, "comment_id": 55353344, "body": "Thanks David! I corrected all the errors and warning in the c-code. The corrected codes are updated in the question. However, the model is still running with always T=0.0000 and stucks there. I am wondering if those headers I included are existing in EV3. Is there any way to check it?"}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447897925, "post_id": 33789465, "comment_id": 55354565, "body": "You are never allocating any memory for <code>buf</code>. I image that the program is getting a segfualt when you try to use <code>buf</code>. In your original post, you were using <code>buf[BUFLEN];</code>, which allocates memory on the stack and is most likely what you want to do here."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447943640, "post_id": 33789465, "comment_id": 55378777, "body": "Thanks David. I had corrected it and tried to run the c-code little by little. And when I comment the <code>recvfrom()</code> function like what I just updated in my question, the model is running smoothly, but of course no data received, and the data is returned -1 all the time. So firstly, I thought it should return 0 as value if no data received, since I declared <code>double data = 0;</code>? Also I can&#39;t figure out why the <code>recvfrom</code> function is not working."}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447953233, "post_id": 33789465, "comment_id": 55385860, "body": "I don&#39;t have access to simulink, so I don&#39;t know how data is actually returned there and why it would be -1. The <code>recvfrom()</code> function blocks until it receives data. Are you actually sending it data? Also, you currently have <code>return data</code> before <code>close(s)</code> so the socket is not being properly closed."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447957216, "post_id": 33789465, "comment_id": 55388344, "body": "I see. I didn&#39;t send any data to it yet. But what I want to do is that, if no data being received in a timeout period, the data will return 0. Is there any way to achieve that? Also, when the are errors in creating or binding the socket, the data will also return 0. (But I am not quite sure if the way I wrote is correct. Basically I want to exit the function and return the output data as 0). The function is being called in infinite loops until i stop the model. It will be great if I get the data as 0 instead of waiting to receive the data, so that other components in the model can run as well."}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447958939, "post_id": 33789465, "comment_id": 55389358, "body": "If you are running this in a loop, I would make a separate function to bind the socket (you will need to make the socket a global variable). Then just do the receive in the loop and have another separate function to close the socket when you are done. You can use <code>fcntl</code> to make <code>recvfrom</code> non-blocking. See the <code>recvfrom</code> man page."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447968977, "post_id": 33789465, "comment_id": 55395207, "body": "Thank you very much, David! I am almost there! However is there any way where I can send/receive double type directly instead of convert double to char* to send it and then convert from char* to double again after receiving it?"}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1447988023, "post_id": 33789465, "comment_id": 55402187, "body": "Yes and no. The data type will still be <code>char *</code>, but instead of converting it to a string, you can send it as binary data. A <code>double</code> is a 64-bit floating point number. So, for example, in the send function you might have <code>buf[sizeof(double)];</code> And then later, instead of the <code>sprintf</code>, you would have <code>*(uint64_t *)buf = htobe64((uint64_t)data);</code> and <code>size_t n = sizeof(double);</code>. The receive function would be similar. <code>data = (double)be64toh(*(uint64_t *)buf);</code>"}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448022248, "post_id": 33789465, "comment_id": 55418345, "body": "Sorry, I didn&#39;t state the question clearly. What I would want to send and receive should be a vector or matrix of double values, instead of just one value each time. Is there any trick to deal with it?"}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448041292, "post_id": 33789465, "comment_id": 55430783, "body": "Sure, you can use an array of floats the same way. So the code in my previous comment would change to <code>buf[sizeof(double) * N_DATA];</code>, <code>((uint64_t *)buf)[i] = htobe64((uint64_t)data[i]);</code>, <code>size_t n = sizeof(double) * N_DATA;</code>, <code>data[i] = (double)be64toh(((uint64_t *)buf)[i]);</code> where <code>N_DATA</code> is defined as the number of values you are sending and <code>i</code> is in a <code>for (i = 0; i &lt; N_DATA; i++)</code> loop."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448047068, "post_id": 33789465, "comment_id": 55434017, "body": "Is it char <code>buf[sizeof(double) * N_DATA];</code>? <code>sendto(s, buf, n , 0 , (struct sockaddr *) &amp;si_other, slen)</code> returns error when I try to send the data. The modified code is again updated in the question."}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448060411, "post_id": 33789465, "comment_id": 55440343, "body": "I was thinking <code>N_DATA</code> would be a constant, but actually, it would be better to pass it as a parameter along with <code>data</code>, in which case I would make it lower case."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448063579, "post_id": 33789465, "comment_id": 55441316, "body": "Thanks David. The sending part is doing fine after I change <code>N_DATA</code> into <code>n-data</code>. However the <code>recvfrom()</code> is returning error when I send the array to it. The receiver won&#39;t be able to know the size of the receiving array, so I put a constant on it as its max size. Why is it returning error?"}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448071094, "post_id": 33789465, "comment_id": 55443001, "body": "I found out where the error is. It is not due to <code>recvfrom()</code> but <code>int n_data = sizeof(buf)&#47;sizeof(buf[0]);</code> where the n_data will be used in the loop as <code>for (j = 0; i &lt; N_DATA; j++)</code> , and as a result, <code>data[j] = (double)be64toh(((uint64_t *)buf)[j]);</code> is out of the index. But how can I find out the number of data being received?"}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448071795, "post_id": 33789465, "comment_id": 55443141, "body": "You can either use a constant and send the same amount of data each time (some values will just be 0 if there is not an actual value). Or you can send the size as the first byte of data, then read one byte to get the size and then read the rest of the data."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448079999, "post_id": 33789465, "comment_id": 55444505, "body": "Ok thanks. I get the idea now. There is one very strange thing about the sender. It was sending the correct data to correct address previously when the argument was double data (of course only scalar data could be sent). However after I change it into double * data(with n_data and loop) and try to send a scalar data, it returns error at inet_aton(), which it fails to change the ip_add to the address structure. And if I send a vector data, no error is returned, but it is the wrong address. How could this happen? Changing the type of the data argument should have nothing to do with IP-address."}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448128339, "post_id": 33789465, "comment_id": 55457800, "body": "You could be accidentally writing past the end of an array and writing over the ip address data structures."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448158120, "post_id": 33789465, "comment_id": 55466216, "body": "Yup you are right. The matlab vector structure and the array structure in c are different. Now it is solved. However, how can I pass a scalar parameter to the c-function, which expects an array argument? I tried to pass a scalar data to the c-function that expects <code>double * data</code>, and the data is not sent to the assigned IP-address(although no error is returned). Of course I can create 2 similar c-functions, one for scalar and one for vector, but it is wasting and doesn&#39;t look neat."}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448225654, "post_id": 33789465, "comment_id": 55484523, "body": "You can just use an array with length of one for the scalar value or you can pass by reference (<code>&amp;data</code>), which is essentially the same thing."}, {"owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448247795, "post_id": 33789465, "comment_id": 55490561, "body": "Thanks David. I created the blocks successfully with your help. However I realised that the transfer rate is decreasing by time. The longer I run the model, the slower it can transfer the data, Is it normal? Is there any suggestion to improve this?"}, {"owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "reply_to_user": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "edited": false, "score": 0, "creation_date": 1448253521, "post_id": 33789465, "comment_id": 55491759, "body": "Sorry, not sure what might be causing the slow down."}], "tags": [], "owner": {"reputation": 756, "user_id": 1976323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058022a25fc0d063e6e02548e2c7fd29?s=128&d=identicon&r=PG", "display_name": "David Lechner", "link": "https://stackoverflow.com/users/1976323/david-lechner"}, "is_accepted": true, "score": 0, "last_activity_date": 1447877588, "creation_date": 1447877588, "answer_id": 33789465, "question_id": 33785571, "link": "https://stackoverflow.com/questions/33785571/how-to-send-and-receive-udp-pakets-on-lego-mindstorms-ev3-using-simulink-externa/33789465#33789465", "title": "How to send and receive UDP Pakets on Lego Mindstorms EV3 using Simulink External Mode?", "body": "<blockquote>\n  <p>./udp_send_receive.c:14: warning: incompatible implicit declaration of built-in function 'exit'</p>\n</blockquote>\n\n<p>You are missing </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n</code></pre>\n\n<blockquote>\n  <p>./udp_send_receive.c:31: warning: incompatible implicit declaration of built-in function 'memset'</p>\n  \n  <p>./udp_send_receive.c:66: warning: incompatible implicit declaration of built-in function 'memset'</p>\n  \n  <p>./udp_send_receive.c:76: warning: incompatible implicit declaration of built-in function 'strlen'</p>\n</blockquote>\n\n<p>You are missing </p>\n\n<pre><code>#include &lt;string.h&gt;\n</code></pre>\n\n<blockquote>\n  <p>./udp_send_receive.c:44: warning: passing argument 5 of 'recvfrom' from incompatible pointer type</p>\n</blockquote>\n\n<p>Not exactly sure how to fix this one. Defining <code>__USE_GNU</code> may help. See <code>sys/socket.h</code>.</p>\n\n<blockquote>\n  <p>./udp_send_receive.c:70: warning: passing argument 1 of 'inet_aton' makes pointer from integer without a cast</p>\n  \n  <p>./udp_send_receive.c:76: warning: passing argument 1 of 'strlen' makes pointer from integer without a cast</p>\n</blockquote>\n\n<p>Need to add <code>*</code> to parameter declarations. <code>char</code> is a single character. <code>char *</code> is a string.</p>\n\n<pre><code>void udp_send(char *data, char *SERVER, int PORT)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5577552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15876438bcd3e1318ae4c7b725b4aec6?s=128&d=identicon&r=PG&f=1", "display_name": "limck", "link": "https://stackoverflow.com/users/5577552/limck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 33789465, "answer_count": 1, "score": 0, "last_activity_date": 1448287146, "creation_date": 1447864797, "last_edit_date": 1448287146, "question_id": 33785571, "link": "https://stackoverflow.com/questions/33785571/how-to-send-and-receive-udp-pakets-on-lego-mindstorms-ev3-using-simulink-externa", "title": "How to send and receive UDP Pakets on Lego Mindstorms EV3 using Simulink External Mode?", "body": "<p>I am trying to create a simulink block using c-code for my EV3 to send the measured value from its sensors and/or receive datas from other hardware (raspberry pi) via UDP Pakets. However I can't find any concrete example in internet. I tried to write my own code following the example from <a href=\"https://www.abc.se/~m6695/udp.html\" rel=\"nofollow\">https://www.abc.se/~m6695/udp.html</a>. I expected it to work, since EV3 is a linux system. However, it is not working.</p>\n\n<p>The c-code library of the udp_receiver (<strong>updated</strong>):</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// BUFLEN = max size\n#define BUFLEN 512\n#define NPACK 1\n\n\ndouble * linux_udp_empfaenger(int32_t PORT)\n{\n  struct sockaddr_in si_me, si_other;\n\n  int s, i, j, slen = sizeof(si_other) , recv_len;\n  char buf[BUFLEN];\n  //char buf_h[BUFLEN];\n  unsigned short recv_port = (unsigned short) PORT;\n  double * data;\n\n  //create a UDP socket\n  if ((s=socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1)\n  {\n    return 0;\n    exit(1);\n  } else{\n\n    // zero out the structure\n    memset((char *) &amp;si_me, 0, sizeof(si_me));\n\n   si_me.sin_family = AF_INET;\n   si_me.sin_port = htons(recv_port);\n   si_me.sin_addr.s_addr = htonl(INADDR_ANY);\n\n   //bind socket to port\n   if( bind(s , (struct sockaddr*)&amp;si_me, sizeof(si_me) ) == -1)\n   {\n     close(s);\n     return 0;\n     exit(1);\n   } else{\n\n    //clear the buffer by filling null, it might have previously received data\n    //memset(buf,'\\0', BUFLEN);\n\n    for (i=0; i&lt;NPACK; i++) {\n     if (recvfrom(s, buf, BUFLEN, 0, (struct sockaddr *) &amp;si_other, &amp;slen)==-1)\n      {\n        close(s);\n        return 0;\n       } else {\n        //Convert buf into usable host format\n        //buf_h = ntohs(buf);\n\n        // Convert data from string to double\n        //data = atof(buf);\n\n        int N_DATA = sizeof(buf)/sizeof(buf[0]);\n\n        for (j = 0; j &lt; N_DATA; j++){\n        data[j] = (double)be64toh(((uint64_t *)buf)[j]);\n        }\n\n        close(s);\n        return data;\n      } \n\n    }\n\n  }\n\n }\n\n}\n</code></pre>\n\n<p>When I run the block externally, the model is shown running, but T=0.000 all the time. I can't even stop the model now.</p>\n\n<p>Hope to get help from you.\nThanks guys!</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 1, "creation_date": 1447864690, "post_id": 33785473, "comment_id": 55337823, "body": "This is called a VLA (variable length array), and is supported since C99 (although not required in C11)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447864888, "post_id": 33785473, "comment_id": 55337975, "body": "The <code>sizeof()</code> keyword is evaluated at compile time, not runtime, so will not give the correct number for <code>total</code>"}, {"owner": {"reputation": 235, "user_id": 5094261, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/37ssA.jpg?s=128&g=1", "display_name": "shiladitya basu", "link": "https://stackoverflow.com/users/5094261/shiladitya-basu"}, "edited": false, "score": 0, "creation_date": 1447865536, "post_id": 33785473, "comment_id": 55338444, "body": "What is the reason for down vote? Is the question quality so poor or the answer is so well known ?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1447866286, "post_id": 33785473, "comment_id": 55338982, "body": "Not my down-vote but I expect it&#39;s because of any/all of the following: (a) no prior research effort shown, (b) answer is readily available via a simple Google search, (c) numerous duplicates on StackOverflow already."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1447867765, "post_id": 33785473, "comment_id": 55339964, "body": "@ user3629249, since C99 there are runtime requiremens for sizeof."}], "answers": [{"comments": [{"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1447864711, "post_id": 33785500, "comment_id": 55337844, "body": "Well, it can if you implement it yourself using dynamic memory allocation."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1447864738, "post_id": 33785500, "comment_id": 55337862, "body": "Yes, that can be done in C, but not as a syntactic feature. It can be done by declaring a pointer, allocating space to that pointer and treating the pointer as an array. You change the array size with <code>realloc</code>."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 2, "creation_date": 1447864814, "post_id": 33785500, "comment_id": 55337922, "body": "@szczurcio True. I think Stroustrup started that around 1979. It kinda got out of hand though."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447865611, "post_id": 33785500, "comment_id": 55338501, "body": "There is no reason to say that is not possible, just because we don&#39;t know if there is a way or not. We do have pointers and malloc. Should be enough."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447865713, "post_id": 33785500, "comment_id": 55338568, "body": "@Michi, I changed the answer a little. Do take a look."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447865842, "post_id": 33785500, "comment_id": 55338670, "body": "@Haris I saw that now :). But like I said, we have <a href=\"http://stackoverflow.com/questions/33655093/array-with-undefined-length-in-c/33656480#33656480\">pointers and malloc</a>"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447865983, "post_id": 33785500, "comment_id": 55338771, "body": "@Michi, Ya.. I added your suggestion also. :)"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447866155, "post_id": 33785500, "comment_id": 55338887, "body": "@Haris ....and you got my vote for that :d."}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 4, "last_activity_date": 1447865959, "last_edit_date": 1447865959, "creation_date": 1447864621, "answer_id": 33785500, "question_id": 33785473, "link": "https://stackoverflow.com/questions/33785473/c-supporting-dynamic-arrays/33785500#33785500", "title": "C supporting dynamic arrays", "body": "<p><code>struct task_info tasks[TASK_NO];</code> is not a dynamic array. It is a variable length array whose length will be decided on run time.</p>\n\n<hr>\n\n<p>Dynamic arrays would be arrays whose size can be changed as and when required. Think of an array which you initialized to contain <code>10</code> elements and later would want to change it to contain <code>20</code> elements. That is not present in <code>C</code>.</p>\n\n<hr>\n\n<p>You can however implement dynamic arrays yourself using pointers, dynamic memory allocation and <code>realloc()</code>. But that won't be something that is a feature provided by the language.</p>\n"}], "owner": {"reputation": 235, "user_id": 5094261, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/37ssA.jpg?s=128&g=1", "display_name": "shiladitya basu", "link": "https://stackoverflow.com/users/5094261/shiladitya-basu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1447864902, "answer_count": 1, "score": -1, "last_activity_date": 1447865959, "creation_date": 1447864559, "question_id": 33785473, "link": "https://stackoverflow.com/questions/33785473/c-supporting-dynamic-arrays", "closed_reason": "Duplicate", "title": "C supporting dynamic arrays", "body": "<p>As far as I know C doesn't support dynamic arrays. Here I implemented a dynamic array <strong>tasks</strong> with a variable length <strong>TASK_NO</strong> which I am fetching through scanf. The code is compiled without error and it is running properly. What can be the reason? Please clarify. </p>\n\n<pre><code>scanf(\"%d\" , &amp;TASK_NO);\nint counter=TASK_NO;\nstruct task_info tasks[TASK_NO];\nprintf(\"total: %d\\n\", sizeof(tasks)/sizeof(tasks[0]));\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 6, "creation_date": 1447863703, "post_id": 33785046, "comment_id": 55337128, "body": "Can somebody also explain the +1 on this question?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1447863726, "post_id": 33785046, "comment_id": 55337144, "body": "Why should it mean anything different than in a condition?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447863866, "post_id": 33785046, "comment_id": 55337228, "body": "Another way to write this would be <code>w = ((i != 0) || (j != 0) || (k != 0));</code> where I only put the brackets for clarity. Each part such as <code>(i != 0)</code> will evaluate to <code>0</code> or <code>1</code>. Remember, in a C boolean test it is implied that <code>0</code> is <code>false</code> and all other values are <code>true</code>."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1447864466, "post_id": 33785046, "comment_id": 55337683, "body": "There are many other dups of this one on SO. You may want to read <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow noreferrer\">short-circuit evaluation</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447865402, "post_id": 33785101, "comment_id": 55338342, "body": "I did not downvote, but your answer has kind of a flaw: For <code>(i||j)</code>, <code>j</code> will not be evaluated if <code>i</code> yields <i>true</i> already. You are basically right that this <code>||</code>-expression <b>will</b> be evaluated as such, but just not necessary both operands."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447866043, "post_id": 33785101, "comment_id": 55338809, "body": "@Olaf Sir, I understand your point, but I never mentioned that <code>j</code> will get evaluated in the evaluation of <code>(i || j)</code>. The logical OR will get evaluated, no? Can you suggest any better wordings? FWIW, to avoid any confusion, I have already added the related quotes from the standard."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447868738, "post_id": 33785101, "comment_id": 55340547, "body": "To me it was ok, because I know the details. With the addition it is fine now. I too have sometimes DVs without comment. Maybe there should be an requirement to leave a comment. How else should one improve one&#39;s answer?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1447865808, "last_edit_date": 1447865808, "creation_date": 1447863517, "answer_id": 33785101, "question_id": 33785046, "link": "https://stackoverflow.com/questions/33785046/how-do-we-interpret-the-and-in-an-assignment-statement/33785101#33785101", "title": "how do we interpret the `||` and `&amp;&amp;` in an assignment statement?", "body": "<p>In your code,</p>\n\n<pre><code> w=i||j||k;\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>w= ((i||j) || k);\n</code></pre>\n\n<p>That means, first the <code>(i||j)</code> will be evaluated, and based on the result (if 0), the later part will be evaluated.</p>\n\n<p>So, in your case, <code>i</code> being <code>4</code>, <code>(i||j)</code> evaluates to <code>1</code> and based on the logical OR operator semantics, the later part is not evaluated and the whole expression yields <code>1</code> which is finally assigned to <code>w</code>.</p>\n\n<p>Related quotes, from <code>C11</code> standard, chapter \u00a76.5.14, Logical OR operator</p>\n\n<blockquote>\n  <p>The <code>||</code> operator shall yield 1 if either of its operands compare unequal to 0; otherwise, it\n  yields 0. The result has type <code>int</code>.</p>\n</blockquote>\n\n<p>then, regarding the evaluation of arguments,</p>\n\n<blockquote>\n  <p>[...] If the first operand compares unequal to 0, the second operand is\n  not evaluated.</p>\n</blockquote>\n\n<p>and regarding the <em>grouping</em>, </p>\n\n<blockquote>\n  <p>[...] the <code>||</code> operator guarantees left-to-right evaluation;</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447864185, "post_id": 33785150, "comment_id": 55337466, "body": "This answer maybe is misleading, as in case of <code>1 || k</code>, <code>k</code> is not evaluated. Please see my (downvoted) answer for a clarification. :)"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447864231, "post_id": 33785150, "comment_id": 55337501, "body": "@SouravGosh I do address that in the bottom of the question, if that&#39;s what you mean."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447864330, "post_id": 33785150, "comment_id": 55337576, "body": "@SouravGosh I see, will try to rectify."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447864372, "post_id": 33785150, "comment_id": 55337615, "body": "Don&#39;t get me wrong. I;m just trying to improve your answer. For some <i>unknown</i> reason, mine got downvoted, so probably I&#39;ll remove mine. :)"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447864681, "post_id": 33785150, "comment_id": 55337815, "body": "@SouravGosh Don&#39;t worry, I wrote something wrong, (funnily enough got upvotes), you corrected me -&gt; fine."}], "tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": false, "score": 3, "last_activity_date": 1447864525, "last_edit_date": 1495541745, "creation_date": 1447863665, "answer_id": 33785150, "question_id": 33785046, "link": "https://stackoverflow.com/questions/33785046/how-do-we-interpret-the-and-in-an-assignment-statement/33785150#33785150", "title": "how do we interpret the `||` and `&amp;&amp;` in an assignment statement?", "body": "<p><code>i  || j || k</code> is evaluated from left to right. It does that:</p>\n\n<p><code>i == 4</code>, which is true, so ORing it with any other value will yield true. That's it<sup>1</sup>.</p>\n\n<p>The rest of the statement is not evaluated because <code>||</code> and <code>&amp;&amp;</code> are <a href=\"https://stackoverflow.com/questions/628526/is-short-circuiting-boolean-operators-mandated-in-c-c-and-evaluation-order\"><em>short-circuit</em> operators</a>, that is, if in your statement <code>i != 0</code>, neither <code>j</code> nor <code>k</code> will be evaluated because the result is guaranteed to be <code>1</code>. <code>&amp;&amp;</code> works similarly.<br>\nThat's important to remember if you have something like <code>f() || k()</code>, where <code>k</code> has some side effect like an output to screen or a variable assignment; it might not be executed at all.</p>\n\n<p>The <strong>bitwise</strong> OR operator <code>|</code> really ORs the bitwise representations of the values instead; it evaluates <strong>all its operands</strong>.</p>\n\n<hr>\n\n<p><sub><sup>1</sup> Thanks to @SouravGosh on that!</sub></p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 0, "last_activity_date": 1447863953, "last_edit_date": 1447863953, "creation_date": 1447863866, "answer_id": 33785224, "question_id": 33785046, "link": "https://stackoverflow.com/questions/33785046/how-do-we-interpret-the-and-in-an-assignment-statement/33785224#33785224", "title": "how do we interpret the `||` and `&amp;&amp;` in an assignment statement?", "body": "<p>The result of boolean operators yields an <code>int</code> value of <code>0</code> or <code>1</code>.</p>\n\n<p>See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.13\" rel=\"nofollow\">6.5.13</a> and <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.14\" rel=\"nofollow\">6.5.14</a>, paragraph 3.</p>\n\n<p><em>The [...] operator shall yield 1 [or] 0. The result has type int.</em></p>\n"}], "owner": {"reputation": 7, "user_id": 5571153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1622779931306527/picture?type=large", "display_name": "Engr Abbas Ahmad", "link": "https://stackoverflow.com/users/5571153/engr-abbas-ahmad"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1447864410, "answer_count": 3, "score": -5, "last_activity_date": 1447865808, "creation_date": 1447863368, "question_id": 33785046, "link": "https://stackoverflow.com/questions/33785046/how-do-we-interpret-the-and-in-an-assignment-statement", "closed_reason": "Duplicate", "title": "how do we interpret the `||` and `&amp;&amp;` in an assignment statement?", "body": "<p>I have been coding from a long time though I'm still a student programmer/ I'm usually good at programming but when questions like the one below are asked I get stuck. What will be the output and why of the following program?</p>\n\n<pre><code>int main() \n    {\n        int i=4,j=-1,k=0,w,x,y,z;\n        w=i||j||k;\n        print(\"%d\",w);\n        return 0;\n    }\n</code></pre>\n\n<p>output:\n1\nwhy this result? what does the statement <code>w=||j||k;</code> means?</p>\n"}, {"tags": ["c", "linux", "windows", "bmp"], "comments": [{"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1447865146, "post_id": 33785003, "comment_id": 55338140, "body": "Your question is unclear - WHAT does not work? Does your software make the BMP files correctly - if it does, why are you showing it to us? If it doesn&#39;t make the BMP files correctly, how can it work on Windows?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447865341, "post_id": 33785003, "comment_id": 55338294, "body": "The posted code has lots of &#39;magic&#39; numbers. &#39;magic&#39; numbers make the code difficult understand, difficult to debug and/or maintain.  Suggest using #defines or an enum to give the numbers meaningful names."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447865718, "post_id": 33785003, "comment_id": 55338575, "body": "the letter &#39;o&#39; is difficult, in many fonts, to distinguish from the number &#39;0&#39; (an early outer space mission failed for this very reason).   The variable names seem (from the posted code) to be meaningless.  For understandability, Suggest using meaningful names for variables"}, {"owner": {"reputation": 25, "user_id": 2885761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523595562/picture?type=large", "display_name": "Laurent Fournier", "link": "https://stackoverflow.com/users/2885761/laurent-fournier"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1447865916, "post_id": 33785003, "comment_id": 55338715, "body": "@MarkSetchell the BMP files are indeed created but while on windows, the character &quot;move&quot; (from mario[0] to mario[4] and for the bird 0 to 2) it dont when compiled under linux..both stay in position 0"}, {"owner": {"reputation": 25, "user_id": 2885761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523595562/picture?type=large", "display_name": "Laurent Fournier", "link": "https://stackoverflow.com/users/2885761/laurent-fournier"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447866088, "post_id": 33785003, "comment_id": 55338841, "body": "@user3629249 sorry, it probably have more meaning in my native language..? (french) perhaps i can explain some parts to you ? and about the &#39;magic&#39; numbers...i don&#39;t understand what you mean by that"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447866309, "post_id": 33785003, "comment_id": 55339002, "body": "When indenting code, do not use tabs,  because each word processor/editor has the tab stops/tab width set differently.."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447866553, "post_id": 33785003, "comment_id": 55339178, "body": "here is some examples of the the &#39;magic&#39; numbers:  295, 3, 4, 50, 100, 32, 33, 125, 126, 250, 450, 200,400, 69, 93, 40, 15, 50, ...."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1447866789, "post_id": 33785003, "comment_id": 55339342, "body": "So, under Windows you get 290 <i>different</i> BMP files that ImageMagick can animate and your bird and clouds move, but on Linux you get 290 identical BMP files in which nothing moves. Correct?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447867139, "post_id": 33785003, "comment_id": 55339556, "body": "when writing header files, in general, it is best to have one header file per source file, rather than mixing the globally visible prototypes, etc all into a single header files.   This strongly relates to such concepts as localization/hiding of data, reduction of complexity, reduction of interconnections (logical, data, etc) between different parts of the program. modularity (one function only handles one thing, one file only contains related functions,)"}, {"owner": {"reputation": 25, "user_id": 2885761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523595562/picture?type=large", "display_name": "Laurent Fournier", "link": "https://stackoverflow.com/users/2885761/laurent-fournier"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1447867806, "post_id": 33785003, "comment_id": 55339992, "body": "@MarkSetchell yes, under windows i have all files with mario and oiseau moving from [0] to [4] with     if(i%3 == 0) j = j++;     if(j == 3) j = 0; while under linux, on all the 290 files both objects are only mario[0] and oiseau[0]"}, {"owner": {"reputation": 25, "user_id": 2885761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523595562/picture?type=large", "display_name": "Laurent Fournier", "link": "https://stackoverflow.com/users/2885761/laurent-fournier"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447867999, "post_id": 33785003, "comment_id": 55340109, "body": "@user3629249 thanks for the advices, i take notes...really. but right not this isn&#39;t my concern :) my teacherdid wanted to have a single header file so let it be that way even if i don&#39;t like that neither"}], "owner": {"reputation": 25, "user_id": 2885761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523595562/picture?type=large", "display_name": "Laurent Fournier", "link": "https://stackoverflow.com/users/2885761/laurent-fournier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447863241, "creation_date": 1447863241, "question_id": 33785003, "link": "https://stackoverflow.com/questions/33785003/animation-of-a-bitmap-file-working-on-windows-but-dont-on-linux", "title": "Animation of a bitmap file working on windows but don&#39;t on linux", "body": "<p>First, sorry about this title i didn't know how to write this in a smart way..</p>\n\n<p>Actually, i work on a small project for school to learn basis of bitmap manipulation.\nSo far everything is working smoothly, but when i come back at home on some linux distro (already made sources compatibles with both OS)..ALMOST everything's still working fine.</p>\n\n<p>The problem is that i have an image array to animate a character and this little one is only animated under windows, while on the other OS it stays on array[0] during all animation (the script create 290+ bmp files and after that i run with imagemagick <b>convert -delay 2 *.bmp -loop 0 test.gif</b>)</p>\n\n<p>Any ideas ? </p>\n\n<p>Here my complete program :\n<a href=\"https://github.com/OkTekk/SchoolProject1\" rel=\"nofollow\">https://github.com/OkTekk/SchoolProject1</a> </p>\n\n<p>Here the small part of code (it start at line 279 of main.c) :</p>\n\n<pre><code>   for(i = 1; i &lt;= 295; i++) {\n        Copier_Pixel(img, background);\n\n        if(i%3 == 0) j = j++;\n        if(j == 3) j = 0;\n\n        if(i%4 == 0) k = k++;\n        if(k == 4) k = 0;\n\n        Ajouter_Calque(img, nuage_ar, 150, i-100);\n\n/****************** Animation Bird ****************/\n        if(i &lt;= 32)\n            Ajouter_Calque(img, oiseau[j], 250-i/2, 450-2*i);\n\n        if(i &gt;= 33 &amp;&amp; i &lt;= 125)\n            Ajouter_Calque(img, oiseau[j], 250-i, 450-2*i);\n\n        if(i &gt;= 126) {\n            Ajouter_Calque(img, oiseau[j], 125+m, 450-2*i);\n            m++;\n        }\n/**************************************************/\n\n        Ajouter_Calque(img, nuage_av, 200, 400-3*i);\n\n/***************** Animation Mario ****************/\n        if(i &lt;= 32)\n            Ajouter_Calque(img, mario[k], 93, 2*i);\n\n        if(i &gt;= 33 &amp;&amp; i &lt;= 69) {\n            x = 1;\n            px1 = 1100 + x;\n            py1 = f(500, x, 50, 15);\n\n            Ajouter_Calque(img, mario[k], 95-o, 2*i);       // To-do : f() ou fNeg() de px1/py1\n\n            o++;\n            x++;\n        }\n\n        if(i &gt;= 70 &amp;&amp; i &lt;= 125)\n            Ajouter_Calque(img, mario[k], 59, 2*i);\n\n        if(i &gt;= 126 &amp;&amp; i &lt;= 200) {\n            Ajouter_Calque(img, mario[k], 59+p/2, 2*i);\n            p++;\n        }\n/**************************************************/\n</code></pre>\n"}, {"tags": ["c", "debugging", "ubuntu"], "answers": [{"comments": [{"owner": {"reputation": 3927, "user_id": 1251851, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hsmcR.jpg?s=128&g=1", "display_name": "Kartik Anand", "link": "https://stackoverflow.com/users/1251851/kartik-anand"}, "edited": false, "score": 0, "creation_date": 1447868385, "post_id": 33786723, "comment_id": 55340342, "body": "But won&#39;t <code>gdb</code> be using the debug library. I&#39;ve also tried setting LD_LIBRARY_PATH to debug lib path, even that doesn&#39;t help"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 3927, "user_id": 1251851, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hsmcR.jpg?s=128&g=1", "display_name": "Kartik Anand", "link": "https://stackoverflow.com/users/1251851/kartik-anand"}, "edited": false, "score": 0, "creation_date": 1447868845, "post_id": 33786723, "comment_id": 55340612, "body": "&#39;gdb&#39; uses what ever you tell it to use.  Normally you tell it the path/name of an executable.   the source files must be visible to &#39;gdb&#39; for it to display the related code while stepping through the execution of the code.   Note: the library (especially for system libraries) will have all the debug info removed (probably via something similar to the &#39;strip&#39; command),   Between the optimization and the debug info stripping, there is very little chance of easily debugging a system library."}, {"owner": {"reputation": 3927, "user_id": 1251851, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hsmcR.jpg?s=128&g=1", "display_name": "Kartik Anand", "link": "https://stackoverflow.com/users/1251851/kartik-anand"}, "edited": false, "score": 0, "creation_date": 1447868915, "post_id": 33786723, "comment_id": 55340648, "body": "I agree. But the libraries in <code>&#47;usr&#47;lib&#47;debug</code> do have their debug infos intact"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1447868337, "creation_date": 1447868337, "answer_id": 33786723, "question_id": 33784699, "link": "https://stackoverflow.com/questions/33784699/unable-to-debug-libc-source-on-ubuntu-14-04/33786723#33786723", "title": "Unable to debug libc source on Ubuntu 14.04", "body": "<p>Assuming the source code version and the library version are the same.... </p>\n\n<p>The root cause of the 'jumping' is due to the compiler optimization often changes the order of the executable code from the order in the source file.</p>\n\n<p>This happens when the code is compiled with any of the optimization parameters.</p>\n"}], "owner": {"reputation": 3927, "user_id": 1251851, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hsmcR.jpg?s=128&g=1", "display_name": "Kartik Anand", "link": "https://stackoverflow.com/users/1251851/kartik-anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447868337, "creation_date": 1447862385, "question_id": 33784699, "link": "https://stackoverflow.com/questions/33784699/unable-to-debug-libc-source-on-ubuntu-14-04", "title": "Unable to debug libc source on Ubuntu 14.04", "body": "<p>I'm trying to debug <code>libc</code> on Ubuntu 14.04 but unable to do so using <code>gdb</code> as the library and the source are not matching correctly.</p>\n\n<p><code>gdb</code> is unable to place the break point correctly. As in, I'm able to step into a function and see the source code but the break point marker would be at some random place inside the function instead of being at the beginning. </p>\n\n<p>When I proceed statement by statement using <code>next</code> on <code>gdb</code>, the marker would keep jumping up and down (Reason being the source file and debug library are not matching correctly.</p>\n\n<p>My <code>glibc</code> version according to <code>ldd</code> is</p>\n\n<pre><code>ldd --version\nldd (Ubuntu EGLIBC 2.19-0ubuntu6.6) 2.19\nCopyright (C) 2014 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\nWritten by Roland McGrath and Ulrich Drepper.\n</code></pre>\n\n<p>I've downloaded <code>libc</code> sources using the command:</p>\n\n<p><code>sudo apt-get source libc6</code></p>\n\n<p>The above would create the following files:</p>\n\n<pre><code>eglibc-2.19  \neglibc_2.19-0ubuntu6.6.debian.tar.xz  \neglibc_2.19-0ubuntu6.6.dsc  \neglibc_2.19.orig.tar.xz\n</code></pre>\n\n<p>In <code>gdb</code> I'm doing </p>\n\n<p><code>dir &lt;path-to-libc-source&gt;/nptl</code> (nptl because I'm stepping into <code>pthread_create</code>)</p>\n\n<p>I've tried using both <code>eglibc-2.19</code> source as well as <code>eglibc_2.19.orig.tar.xz</code>.</p>\n\n<p>I've also tried setting LD_LIBRARY_PATH: <code>export LD_LIBRARY_PATH=/usr/lib/debug</code></p>\n\n<p>But the above also doesn't help.</p>\n\n<p>Can somebody who has successfully been able to debug <code>libc</code> code share his/her techniques as to how to do it correctly?</p>\n"}, {"tags": ["c++", "c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1447861930, "post_id": 33784529, "comment_id": 55335802, "body": "<code>float **</code> is not an array, but a pointer to pointer."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1447861951, "post_id": 33784529, "comment_id": 55335824, "body": "<code>float[2][2] = {{0,100},{0,200}} </code>  --&gt; <code>float ranges[2][2] = {{0.0,100.0},{0.0,200.0}}; </code>"}, {"owner": {"reputation": 414, "user_id": 5524637, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bd799d5baded791177ba35f8c4d1b085?s=128&d=identicon&r=PG&f=1", "display_name": "Eumel", "link": "https://stackoverflow.com/users/5524637/eumel"}, "edited": false, "score": 0, "creation_date": 1447862064, "post_id": 33784529, "comment_id": 55335913, "body": "the title is befor the and. I need to get the values int here and dont lnow how basically"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 0, "last_activity_date": 1447862271, "creation_date": 1447862271, "answer_id": 33784651, "question_id": 33784529, "link": "https://stackoverflow.com/questions/33784529/initializing-a-array-and-what-actually-need-to-be-in-the-title-so-it-goes-thro/33784651#33784651", "title": "initializing a **Array and what actually need to be in the title so it goes through", "body": "<pre><code>float** ranges = new float*[2];\nranges[0] = {0,100};\nranges[1] = {0,200};\n</code></pre>\n\n<p>doesn't work since:</p>\n\n<ol>\n<li>The RHS is an initilaization list that cannot be assigned to a pointer.</li>\n<li><code>range[0]</code> and <code>range[1]</code> are pointers for which memory needs to be allocated first. And then, you can assign values to individual elements.</li>\n</ol>\n\n<p>You can use:</p>\n\n<pre><code>ranges[0] = new float[2]{0,100};\nranges[1] = new float[2]{0,200};\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ranges[0] = new float[2];\nranges[0][0] = 0;\nranges[0][1] = 100;\nranges[1] = new float[2];\nranges[1][0] = 0;\nranges[1][1] = 200;\n</code></pre>\n\n<p>Of course, make sure to add code to <code>delete</code> them.</p>\n"}], "owner": {"reputation": 414, "user_id": 5524637, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bd799d5baded791177ba35f8c4d1b085?s=128&d=identicon&r=PG&f=1", "display_name": "Eumel", "link": "https://stackoverflow.com/users/5524637/eumel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 33784651, "answer_count": 1, "score": -4, "last_activity_date": 1447862271, "creation_date": 1447861866, "last_edit_date": 1447861977, "question_id": 33784529, "link": "https://stackoverflow.com/questions/33784529/initializing-a-array-and-what-actually-need-to-be-in-the-title-so-it-goes-thro", "title": "initializing a **Array and what actually need to be in the title so it goes through", "body": "<p>A function I want to use requires an input of a <code>float **</code> array.</p>\n\n<p>How can i initialize this to be a 2x2 array?</p>\n\n<p>Just using <code>float[2][2] = {{0,100},{0,200}}</code> obviously doesn\u00b4t work.</p>\n\n<p>I also tried </p>\n\n<pre><code>float** ranges = new float*[2];\nranges[0] = {0,100};\nranges[1] = {0,200};\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "increment"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1447861791, "post_id": 33784400, "comment_id": 55335691, "body": "<code>*(data+1)</code> == <code>data[1]</code>. <code>(data+1)[1]</code> == <code>data[2]</code>. You can use any pointer as array (there is no guarantee this is a valid memory address, however)."}, {"owner": {"reputation": 122, "user_id": 3714840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/abe8a4e6a89e50b90711d8663805cb40?s=128&d=identicon&r=PG&f=1", "display_name": "Fred B", "link": "https://stackoverflow.com/users/3714840/fred-b"}, "edited": false, "score": 0, "creation_date": 1447861827, "post_id": 33784400, "comment_id": 55335722, "body": "Data is a pointer. By doing `data + 1&#39;, you move your pointer to the next element in memory."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447862056, "post_id": 33784400, "comment_id": 55335903, "body": "<code>data</code> is not an array, but a pointer. Possibly to the first element of a <code>data_t</code> array. In C you cannot pass an array as argument, only pointers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1447862224, "post_id": 33784400, "comment_id": 55336037, "body": "I&#39;d start by rewriting the macro to a function: <code>inline void (data_t* data) { d[0]=1; d[1]=2 }</code> or just drop it entirely. The presence of that icky macro plus the pointless declaration <code>data_t* const</code> suggests that the person who wrote the code were fond of &quot;lets make the code as complex as possible by using various obscure tricks&quot; but in reality doesn&#39;t quite know what they are doing."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1447862433, "post_id": 33784400, "comment_id": 55336204, "body": "the macro is in fact invalid (need to use <code>\\ </code> for multi-line macro), and its use as shown will cause an error (<code>data + 1[0]</code> is not valid C)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1447862563, "post_id": 33784400, "comment_id": 55336303, "body": "@SanderDeDycker Nicely spotted. Turns out the whole code is nonsense then. So maybe this was an artificial example and not the actual code?"}, {"owner": {"reputation": 123, "user_id": 4819627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55c12a34ca00ed833f119d73423b24d9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4819627/michael"}, "edited": false, "score": 0, "creation_date": 1447863885, "post_id": 33784400, "comment_id": 55337242, "body": "I think the last comment from user3714840 clarifies it for me. Thanks :-)"}, {"owner": {"reputation": 123, "user_id": 4819627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55c12a34ca00ed833f119d73423b24d9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4819627/michael"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1447864238, "post_id": 33784400, "comment_id": 55337507, "body": "@Lundin thanks for your comments. I just wanted to understand the meaning of this semantics, so I know what to do, when rewriting it in C#."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 4819627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55c12a34ca00ed833f119d73423b24d9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4819627/michael"}, "edited": false, "score": 0, "creation_date": 1447863741, "post_id": 33784513, "comment_id": 55337155, "body": "Thanks for this input. But just because it&#39;s C, i want to state it more precisely. Is *(data + 1) = data + 1?"}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1447864904, "post_id": 33784513, "comment_id": 55337995, "body": "It&#39;s always interesting to see an accepted answer with 0 upvotes... how can an answer solve the OP&#39;s problem but at the same time not be useful?"}, {"owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "reply_to_user": {"reputation": 123, "user_id": 4819627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55c12a34ca00ed833f119d73423b24d9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4819627/michael"}, "edited": false, "score": 0, "creation_date": 1447867135, "post_id": 33784513, "comment_id": 55339552, "body": "@Michael I updated the answer.  Basically <code>*(data+1)</code> does not equal <code>data + 1</code>"}], "tags": [], "owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "is_accepted": true, "score": 2, "last_activity_date": 1447867092, "last_edit_date": 1592644375, "creation_date": 1447861821, "answer_id": 33784513, "question_id": 33784400, "link": "https://stackoverflow.com/questions/33784400/c-array-pointer-usage-clarification/33784513#33784513", "title": "C array pointer usage clarification", "body": "<p>In C pointers and arrays are usually interchangeable.</p>\n<p><code>data_t*</code> is equivalent to <code>data_t[]</code> in most cases, and the use of the array notation is used to simplify the dereferencing of the pointers for assignment.</p>\n<pre><code>data[0] = 1;\ndata[1] = 2; \n</code></pre>\n<p>can be replaced with</p>\n<pre><code>*(data) = 1;\n*(data+1) = 2;\n</code></pre>\n<p>It really is just semantics, although the use of the macro is ugly.  Either way you can access out of range memory locations and cause trouble when accessing memory which is unassigned.</p>\n<h2>Update:</h2>\n<pre><code>*(data+1) != data + 1\n</code></pre>\n<p><code>data + 1</code> - Memory location at the pointer data + 1 * (size of data type of the pointer).  In other words, it is one unit over from the position of data.</p>\n<p><code>*(data + 1)</code> - Value at memory location of said data type.</p>\n"}, {"tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 2, "last_activity_date": 1447861835, "creation_date": 1447861835, "answer_id": 33784518, "question_id": 33784400, "link": "https://stackoverflow.com/questions/33784400/c-array-pointer-usage-clarification/33784518#33784518", "title": "C array pointer usage clarification", "body": "<p>In this context:</p>\n\n<pre><code>data + 1\n</code></pre>\n\n<p>Means:</p>\n\n<pre><code>data + sizeof(data_t);\n</code></pre>\n\n<p>Because <code>data</code> is a pointer of type <code>data_t</code> pointer arithmetic is applied so that <code>+ 1</code> results in <code>sizeof(data_t)</code> bytes further than <code>data</code>.</p>\n\n<p>So your first assumption is correct.</p>\n"}], "owner": {"reputation": 123, "user_id": 4819627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55c12a34ca00ed833f119d73423b24d9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4819627/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 33784513, "answer_count": 2, "score": 0, "last_activity_date": 1447867092, "creation_date": 1447861522, "question_id": 33784400, "link": "https://stackoverflow.com/questions/33784400/c-array-pointer-usage-clarification", "title": "C array pointer usage clarification", "body": "<p>I have a seemingly simple question regarding array pointer in C. I am trying to understand a portion of code written in C, so i can port it to C#. The data types and functions are defined as follows:</p>\n\n<pre><code>/* header file */\n/* definition of data_t type */\ntypedef unsigned short uint16_t;\ntypedef uint16_t data_t;\n\n/*  the function the type data_t is used */\n#define FOO(d) do {\n d[0] = 1;\n d[1] = 2;\n} while (0)\n\n/* source file */\n/* the function where FOO is used */\nstatic int BAR(data_t* const data)\n{\n   FOO(data + 1);\n}\n</code></pre>\n\n<p>When calling FOO(..) within BAR(..), what does \"data + 1\" mean? As i understand, data is an array from type data_t. \nI wasn't able to find an exact example on stackoverflow or else, therefore i am confused about the meaning of it. \nI have three options in my mind how an appropriate assignment in C# could look like:</p>\n\n<ol>\n<li>data + 1 -> data[1]</li>\n<li>data + 1 -> data[0] + 1</li>\n<li>data + 1 -> new data_t[] (new instance of data_t array at address + 1)</li>\n</ol>\n\n<p>The first option makes sense to me. But when taking a look into the function FOO(..), it makes no sense, because FOO is using \"data\" like an array.</p>\n\n<p>Can anyone give me a hint?</p>\n\n<p>Thanks,</p>\n\n<p>Michael</p>\n"}, {"tags": ["c++", "c", "recursion", "iteration"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1447861202, "post_id": 33784210, "comment_id": 55335201, "body": "The core of the function is another function called <code>result</code>, which is not defined here."}, {"owner": {"reputation": 1340, "user_id": 660390, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/214ff44e8eddad770c44bc8de91fe92b?s=128&d=identicon&r=PG", "display_name": "Neva", "link": "https://stackoverflow.com/users/660390/neva"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1447861245, "post_id": 33784210, "comment_id": 55335234, "body": "That&#39;s not the issue, result() just returns a random float."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1447861302, "post_id": 33784210, "comment_id": 55335287, "body": "So your function is returning a random float. No iteration needed."}, {"owner": {"reputation": 1340, "user_id": 660390, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/214ff44e8eddad770c44bc8de91fe92b?s=128&d=identicon&r=PG", "display_name": "Neva", "link": "https://stackoverflow.com/users/660390/neva"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1447861388, "post_id": 33784210, "comment_id": 55335348, "body": "The point of this is to make a recursive function become iterative, no matter what result() does."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1447861409, "post_id": 33784210, "comment_id": 55335376, "body": "@EugeneSh. You don&#39;t need the definition of <code>return()</code> to determine what <code>myRecursiveFunction</code> could be implemented as an iterative function."}, {"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1447861474, "post_id": 33784210, "comment_id": 55335433, "body": "What result does is the key to making the function non recursive. The easiest form of recursion to eliminate is tail recursion and if this is possible depends entirely on what the code after the recursion does, so what result does underpins the whole question."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1447861480, "post_id": 33784210, "comment_id": 55335442, "body": "@Neva You could trace your function calls, displaying x, y, depth and divisor at the begining of your function. That would help."}, {"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1447861548, "post_id": 33784210, "comment_id": 55335485, "body": "As it is now this question does not meet &quot;must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1447861549, "post_id": 33784210, "comment_id": 55335486, "body": "What are the types of <code>x</code>, <code>y</code>, <code>depth</code>, <code>divisor</code>?  Is <code>depth</code> an integer type?  Is <code>divisor</code> a floating point type?  Are <code>x</code> and <code>y</code> also <code>float</code>?"}, {"owner": {"reputation": 1340, "user_id": 660390, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/214ff44e8eddad770c44bc8de91fe92b?s=128&d=identicon&r=PG", "display_name": "Neva", "link": "https://stackoverflow.com/users/660390/neva"}, "edited": false, "score": 0, "creation_date": 1447861603, "post_id": 33784210, "comment_id": 55335532, "body": "x, y and divisor are floats, depth is an integer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1447861815, "post_id": 33784210, "comment_id": 55335712, "body": "This is no valid signature. Provide a proper prototype with argument-types. This might be important."}], "answers": [{"comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1447861985, "post_id": 33784456, "comment_id": 55335848, "body": "<code>**</code> is not an operator in either C or C++."}, {"owner": {"reputation": 11225, "user_id": 241013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0825ba5ec12464a2b8176642830e6a7?s=128&d=identicon&r=PG", "display_name": "Sorin", "link": "https://stackoverflow.com/users/241013/sorin"}, "edited": false, "score": 1, "creation_date": 1447862818, "post_id": 33784456, "comment_id": 55336516, "body": "Sorry, it think faster in python, but should be trivial to convert to C++."}, {"owner": {"reputation": 1340, "user_id": 660390, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/214ff44e8eddad770c44bc8de91fe92b?s=128&d=identicon&r=PG", "display_name": "Neva", "link": "https://stackoverflow.com/users/660390/neva"}, "edited": false, "score": 0, "creation_date": 1447862861, "post_id": 33784456, "comment_id": 55336543, "body": "That&#39;s exactly it. Thank you."}], "tags": [], "owner": {"reputation": 11225, "user_id": 241013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0825ba5ec12464a2b8176642830e6a7?s=128&d=identicon&r=PG", "display_name": "Sorin", "link": "https://stackoverflow.com/users/241013/sorin"}, "is_accepted": true, "score": 4, "last_activity_date": 1447861643, "creation_date": 1447861643, "answer_id": 33784456, "question_id": 33784210, "link": "https://stackoverflow.com/questions/33784210/transform-a-recursive-function-and-make-it-iterative/33784456#33784456", "title": "Transform a recursive function and make it iterative", "body": "<pre><code>divisor *= (1/2.0) ** depth\nr = result(x/divisor, y/divisor)\nfor i in range(depth -1):\n  divisor *= 2\n  r = result(r + x/divisor, r+y/divisor)\n\nreturn r\n</code></pre>\n\n<p>Be careful, you might be losing precision if you do it this way.</p>\n\n<p>Hope I didn't forget some -1/+1 somewhere.</p>\n"}], "owner": {"reputation": 1340, "user_id": 660390, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/214ff44e8eddad770c44bc8de91fe92b?s=128&d=identicon&r=PG", "display_name": "Neva", "link": "https://stackoverflow.com/users/660390/neva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 33784456, "answer_count": 1, "score": 0, "last_activity_date": 1447862249, "creation_date": 1447860974, "last_edit_date": 1447861342, "question_id": 33784210, "link": "https://stackoverflow.com/questions/33784210/transform-a-recursive-function-and-make-it-iterative", "title": "Transform a recursive function and make it iterative", "body": "<p>Basically I have a recursive function, that I don't want to be recursive anymore.\nBut I can't figure out the logic of the existing code itself.</p>\n\n<p>Here it is </p>\n\n<pre><code>float myRecursiveFunction(x, y, depth, divisor) {\n    if(depth == 0)\n        return result(x/divisor, y/divisor);\n\n    float displace = myRecursiveFunction(x, y, depth-1, divisor/2);\n\n    return result(displace+(x/divisor), displace+(y/divisor));\n\n}\n</code></pre>\n\n<p>and here is how it is called :</p>\n\n<p>float myresult = myRecursiveFunction(x, y, 5, 2);</p>\n\n<p>it will ALWAYS be called with 5 and 2.</p>\n\n<p>Any of you have an idea on how to proceed ? or if it's short enough, a code with no recursion ?</p>\n\n<p>float result(float, float) isn't important here, it is just a function that returns a random float. The point here is to remove the recursion</p>\n"}, {"tags": ["c", "sockets", "file-handling"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1447860891, "post_id": 33784149, "comment_id": 55334961, "body": "<b>TL;DR</b> check null-termination."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1447860991, "post_id": 33784149, "comment_id": 55335032, "body": "You don&#39;t check how many bytes were read, so you don&#39;t know how many bytes to write.  You cannot afford to ignore the return value from <code>read</code> or its variants."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1447861386, "post_id": 33784149, "comment_id": 55335347, "body": "You always write <code>CLIENTBUFSIZE</code> bytes to the file, no matter how many were <code>read</code>. And you don&#39;t ensure <code>recvBuff</code> is zero terminated."}, {"owner": {"reputation": 727, "user_id": 3340994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/098c53051f026ff423dd9faedf8392a0?s=128&d=identicon&r=PG&f=1", "display_name": "nishantbhardwaj2002", "link": "https://stackoverflow.com/users/3340994/nishantbhardwaj2002"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1447861887, "post_id": 33784149, "comment_id": 55335769, "body": "@JohnnyMopp you are right. I was always reading CLIENTBUFSIZE. This solved the problem. I was thinking that my editor will not consider to show &#39;\\0&#39;. You should add that as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 1, "last_activity_date": 1447862378, "creation_date": 1447862378, "answer_id": 33784697, "question_id": 33784149, "link": "https://stackoverflow.com/questions/33784149/why-is-this-c-program-using-sockets-and-file-handling-adding-unwanted-characte/33784697#33784697", "title": "Why is this C program (using sockets and file handling) adding unwanted characters at the end of file?", "body": "<p>The <code>read()</code> system call returns the number of bytes read (or -1 for error). You are throwing the result away and writing the entire buffer of <code>CLIENTBUFSIZE</code> bytes to your file even if you were sent fewer than 16 bytes.</p>\n"}], "owner": {"reputation": 727, "user_id": 3340994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/098c53051f026ff423dd9faedf8392a0?s=128&d=identicon&r=PG&f=1", "display_name": "nishantbhardwaj2002", "link": "https://stackoverflow.com/users/3340994/nishantbhardwaj2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 33784697, "answer_count": 1, "score": 0, "last_activity_date": 1447862378, "creation_date": 1447860852, "question_id": 33784149, "link": "https://stackoverflow.com/questions/33784149/why-is-this-c-program-using-sockets-and-file-handling-adding-unwanted-characte", "title": "Why is this C program (using sockets and file handling) adding unwanted characters at the end of file?", "body": "<p>Program: In this project, i have to read a file in a client program, and send it to the server program</p>\n\n<p>Problem: In the resulting file, i am getting all the characters in the client program, along with some unwanted characters in the end.</p>\n\n<p>What i think is the reason: If i put 15 characters in the file to be sent, i get correct output (note that my buffer size, i.e., number of characters i send at one time, is 16). If i use 14 or less characters, i get 1 '\\00' at the end. If i use even less characters, then i get a '\\00' corresponding to each of the missing ones. Maybe my '\\0' (that is what i set empty space, or the extra characters in my buffer as) are getting represented in output file as '\\00'.</p>\n\n<p>Here's the client program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;fcntl.h&gt;\n\n#define BUFSIZE 16\n\n#define USAGE                                                                 \\\n\"usage:\\n\"                                                                    \\\n\"  transferclient [options]\\n\"                                                \\\n\"options:\\n\"                                                                  \\\n\"  -s                  Server (Default: localhost)\\n\"                         \\\n\"  -p                  Port (Default: 8888)\\n\"                                \\\n\"  -o                  Output file (Default foo.txt)\\n\"                       \\\n\"  -h                  Show this help message\\n\"\n\n/* Main ========================================================= */\nint main(int argc, char **argv) {\n    int option_char = 0;\n    char *hostname = \"127.0.0.1\";\n    unsigned short portno = 8888;\n    char *filename = \"foo.txt\";\n\n    // Parse and set command line arguments\n    while ((option_char = getopt(argc, argv, \"s:p:o:h\")) != -1) {\n        switch (option_char) {\n            case 's': // server\n            hostname = optarg;\n                break;\n            case 'p': // listen-port\n                portno = atoi(optarg);\n                break;\n            case 'o': // filename\n                filename = optarg;\n                break;\n            case 'h': // help\n                fprintf(stdout, \"%s\", USAGE);\n                exit(0);\n                break;\n            default:\n                fprintf(stderr, \"%s\", USAGE);\n                exit(1);\n    }\n    }\n\n    /* Socket Code Here */\n    int sockfd = 0, n = 0;\n    char recvBuff[BUFSIZE], sendBuff[BUFSIZE];\n    struct sockaddr_in serv_addr;\n\n    if((sockfd = socket(AF_INET, SOCK_STREAM, 0))&lt; 0) {\n        printf(\"Error: Could not create socket \\n\");\n        return 1;\n    }\n\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_port = htons(portno);\n    serv_addr.sin_addr.s_addr = inet_addr(hostname);\n\n    if(connect(sockfd, (struct sockaddr *)&amp;serv_addr, sizeof(serv_addr))&lt;0) {\n        printf(\"Error: Connect Failed\\n\");\n        return 1;\n    }\n\n    FILE *fp = fopen(filename, \"rb\");\n    if(fp == NULL) {\n        printf(\"Error: file not found.\\n\");\n        return 0;\n    }\n\n    fseek(fp, 0, SEEK_END);\n    int size = ftell(fp);\n    fseek(fp, 0, SEEK_SET);\n\n    memset(sendBuff, '\\0', BUFSIZE);\n    sprintf(sendBuff, \"%d\", size);\n    write(sockfd, sendBuff, strlen(sendBuff));\n    printf(\"size: %d\\n\", size);\n\n    memset(sendBuff, '\\0', BUFSIZE);\n    int temp = fread(sendBuff, 1, BUFSIZE, fp);\n\n    while(temp &gt; 0) {\n        write(sockfd, sendBuff, BUFSIZE);\n        memset(sendBuff, '\\0', BUFSIZE);\n        temp = fread(sendBuff, 1, BUFSIZE, fp);\n    }\n\n    fclose(fp); \n    printf(\"done sending data to server.\\n\");\n\n    memset(recvBuff, '\\0', BUFSIZE);\n    while((n = read(sockfd, recvBuff, BUFSIZE)) &gt; 0) {\n        recvBuff[n] = '\\0';\n        if(fputs(recvBuff, stdout) == EOF) {\n            printf(\"Error: Fputs error\\n\");\n        }\n        printf(\"\\n\");\n    }\n\n    if( n &lt; 0) {\n        printf(\"Read Error\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here's the server program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;fcntl.h&gt;\n\n#if 0\n/*\n * Structs exported from netinet/in.h (for easy reference)\n */\n\n/* Internet address */\n\nstruct in_addr {\n  unsigned int s_addr;\n};\n\n/* Internet style socket address */\nstruct sockaddr_in  {\n  unsigned short int sin_family; /* Address family */\n  unsigned short int sin_port;   /* Port number */\n  struct in_addr sin_addr;   /* IP address */\n  unsigned char sin_zero[...];   /* Pad to size of 'struct sockaddr' */\n};\n\n/*\n * Struct exported from netdb.h\n */\n\n/* Domain name service (DNS) host entry */\nstruct hostent {\n  char    *h_name;        /* official name of host */\n  char    **h_aliases;    /* alias list */\n  int     h_addrtype;     /* host address type */\n  int     h_length;       /* length of address */\n  char    **h_addr_list;  /* list of addresses */\n}\n#endif\n\n#define BUFSIZE 4096\n#define CLIENTBUFSIZE 16\n\n#define USAGE                                                                 \\\n\"usage:\\n\"                                                                    \\\n\"  transferserver [options]\\n\"                                                \\\n\"options:\\n\"                                                                  \\\n\"  -p                  Port (Default: 8888)\\n\"                                \\\n\"  -f                  Filename (Default: bar.txt)\\n\"                         \\\n\"  -h                  Show this help message\\n\"\n\nint num_of_digits(int num) {\n    if(num &lt;= 0) printf(\"Error: size &lt;= 0.\\n\");\n    if(num &lt;= 0) exit(1);\n\n    int n = 0;\n    while(num &gt; 0) {\n        n++;\n        num /= 10;\n    }\n\n    return n;\n}\n\nint main(int argc, char **argv) {\n    int option_char;\n    int portno = 8888; /* port to listen on */\n    char *filename = \"bar.txt\"; /* file to transfer */\n\n    // Parse and set command line arguments\n    while ((option_char = getopt(argc, argv, \"p:f:h\")) != -1){\n        switch (option_char) {\n            case 'p': // listen-port\n                portno = atoi(optarg);\n                break;\n            case 'f': // listen-port\n                filename = optarg;\n                break;\n            case 'h': // help\n                fprintf(stdout, \"%s\", USAGE);\n                exit(0);\n                break;\n            default:\n                fprintf(stderr, \"%s\", USAGE);\n                exit(1);\n        }\n     }\n\n    /* Socket Code Here */\n    int listenfd = 0, connfd = 0;\n\n    struct sockaddr_in serv_addr;\n\n    char sendBuff[BUFSIZE], recvBuff[BUFSIZE];  \n\n    listenfd = socket(AF_INET, SOCK_STREAM, 0);\n    printf(\"socket retrieve success\\n\");\n\n    memset(&amp;serv_addr, '0', sizeof(serv_addr));\n\n    serv_addr.sin_family = AF_INET;    \n    serv_addr.sin_addr.s_addr = htonl(INADDR_ANY); \n    serv_addr.sin_port = htons(portno);    \n\n    bind(listenfd, (struct sockaddr*)&amp;serv_addr,sizeof(serv_addr));\n\n    if(listen(listenfd, 5) == -1) {\n        printf(\"Failed to listen\\n\");\n        return -1;\n    }\n\n    int size, temp;\n\n    while(1) {\n        connfd = accept(listenfd, (struct sockaddr*)NULL, NULL); // accept awaiting request\n\n        memset(recvBuff, '\\0', BUFSIZE);\n        read(connfd, recvBuff, BUFSIZE);\n\n        sscanf(recvBuff, \"%d\", &amp;size);\n        temp = strlen(recvBuff) - num_of_digits(size);\n        size -= temp;\n\n        printf(\"size: %d\\n\", size);\n        printf(\"Data from client:\\n%s\", (recvBuff + num_of_digits(size)));\n\n        FILE * fp = fopen(filename, \"wb\");\n        int temp;\n        while(size &gt; 0) {\n            read(connfd, recvBuff, CLIENTBUFSIZE);\n            printf(\"%s\", recvBuff);\n            temp = fwrite(recvBuff, 1, CLIENTBUFSIZE, fp);\n            size -= temp;\n            printf(\"temp: %d\\n\", temp);\n            printf(\"Remaining data: %d\\n\", size);\n        }\n        fclose(fp);\n        printf(\"size: %d\\n\", size);\n        printf(\"\\n\\nFinished reading from client.\\n\");\n\n        strcpy(sendBuff, \"Message from server: your message has been recieved.\");\n        write(connfd, sendBuff, strlen(sendBuff));\n\n\n        close(connfd);    \n        sleep(1);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here's the input file content:</p>\n\n<blockquote>\n  <p>12345678901234</p>\n</blockquote>\n\n<p>Here's the output file content:</p>\n\n<blockquote>\n  <p>12345678901234</p>\n  \n  <p>\\00</p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "while-loop", "console", "tic-tac-toe"], "answers": [{"tags": [], "owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "is_accepted": true, "score": 3, "last_activity_date": 1447862414, "last_edit_date": 1447862414, "creation_date": 1447861757, "answer_id": 33784494, "question_id": 33783995, "link": "https://stackoverflow.com/questions/33783995/struggling-with-tictactoe-in-c/33784494#33784494", "title": "Struggling with TicTacToe in C", "body": "<p>There are multiple issues</p>\n\n<ol>\n<li><p><code>isWinner</code> returns characters '0', '1', '2' and '3'. Replace them with numbers 0, 1, 2, 3, because your are comparing with numbers in <code>main</code>.</p></li>\n<li><p>In <code>main</code> instead of checking <code>if (winner &gt;= 1) {</code>, which is true even if 3 is returned by <code>isWinner</code>, check for <code>if (winner == 1 || winner == 2) {</code>.</p></li>\n<li><p>Suggest to use parentheses in <code>isWinner</code> around each condition separated by <code>||</code>.</p></li>\n</ol>\n\n<p>Parentheses as shown below for the first condition</p>\n\n<pre><code>if (((field[0] == 'O') &amp;&amp; (field[1] == 'O') &amp;&amp; (field[2] == 'O')) ||\n    ((field[3] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[5] == 'O')) ||\n    ((field[6] == 'O') &amp;&amp; (field[7] == 'O') &amp;&amp; (field[8] == 'O')) ||\n    ((field[0] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[8] == 'O')) ||\n    ((field[2] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[6] == 'O')) ||\n    ((field[0] == 'O') &amp;&amp; (field[3] == 'O') &amp;&amp; (field[6] == 'O')) ||\n    ((field[1] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[7] == 'O')) ||\n    ((field[2] == 'O') &amp;&amp; (field[5] == 'O') &amp;&amp; (field[8] == 'O')))\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4614953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/790419611032452/picture?type=large", "display_name": "Samy Dressel", "link": "https://stackoverflow.com/users/4614953/samy-dressel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33784494, "answer_count": 1, "score": 1, "last_activity_date": 1514944184, "creation_date": 1447860439, "last_edit_date": 1514944184, "question_id": 33783995, "link": "https://stackoverflow.com/questions/33783995/struggling-with-tictactoe-in-c", "title": "Struggling with TicTacToe in C", "body": "<p>I tried to program a simple TicTacToe in C. The program itselfs compiles and show no errors.\nSo the program draws the field, reads the names and let a player put his symbol in a specific field. All this happens in a while loop, the should be run until its a draw or someone wins.\nBut the program just run the loop one time so there is only one turn then the program stops.</p>\n\n<p>So here is my code:</p>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"game.h\"\n\n\n#define NAMELENGTH 20\n\n int main(void) {\nchar names[2][NAMELENGTH];\n// field positions\nchar field[9];\nint winner = -1;\ngetnames(names);\nprintf(\"\\n\\n\");\ninitField(field);\n// set field positions to 'empty'\nchar actualPlayer = (char)(get_random_number()*10.0) % 2;\n\nwhile (1) {\n    drawField(field);\n    turn(actualPlayer, names, field);\n    winner = isWinner(actualPlayer, field);\n    drawField(field);\n    if (winner &gt;= 1) {\n        printwinner(winner, names);\n        return 0;\n    }\n    else if (winner == 0) {\n        printDrawGame(names);\n        return 0;\n    }\n    actualPlayer = (actualPlayer + 1) % 2;\n\n}\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>game.h Headerfile:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#define NAMELENGTH 20\n#pragma warning(disable:4996)\n\nextern void drawField(char *field);\nextern void getnames(char nameField[][NAMELENGTH]);\nextern void initField(char *field);\nextern void turn(char actualPlayer, char names[][NAMELENGTH], char *field);\nextern char isWinner(char actualPlayer, char *field);\nextern void printwinner(char winnerNumber, char names[][NAMELENGTH]);\nextern void printDrawGame(char names[][NAMELENGTH]);\nextern double get_random_number();\n</code></pre>\n\n<p>and then my game.c where I defined my functions:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include \"game.h\"\n#define NAMELENGTH 20\n#pragma warning(disable:4996)\n\nvoid drawField(char *field) {\n\nprintf(\"________________________\\n\");\nprintf(\"|       |       |      |\\n\");\nprintf(\"|   %c   |   %c   |   %c  |\\n\", field[0], field[1], field[2]);\nprintf(\"|_______|_______|______|\\n\");\nprintf(\"|       |       |      |\\n\");\nprintf(\"|   %c   |   %c   |   %c  |\\n\", field[3], field[4], field[5]);\nprintf(\"|_______|_______|______|\\n\");\nprintf(\"|       |       |      |\\n\");\nprintf(\"|   %c   |   %c   |   %c  |\\n\", field[6], field[7], field[8]);\nprintf(\"|_______|_______|______|\\n\");\n\n}\n\nvoid getnames(char nameField[][NAMELENGTH]) {\n\nprintf(\"Name of the first player: \");\nscanf(\"%s\", nameField[0]);\nprintf(\"Name of the second player: \");\nscanf(\"%s\", nameField[1]);\n\n}\n\nvoid initField(char *field) {\n\nfor (int i = 0; i &lt;= 8; i++)\n{\n    field[i] = i + '1';\n}\n\n}\n\nvoid turn(char actualPlayer, char names[][NAMELENGTH], char *field) {\n\nchar symbol = ' ';\nint p1fieldnumber;\nint p2fieldnumber;\n\n\nif (actualPlayer == 0)\n{\n    do {\n\n        printf(\"\\nIts Player %s's turn.\", names[0]);\n        char symbol = 'X';\n        printf(\"\\nNumber of the field which you want to put your symbol in: \");\n        scanf(\"%d\", &amp;p1fieldnumber);\n        if (field[p1fieldnumber] == 'X' || field[p1fieldnumber] == 'O')\n        {\n            printf(\"\\nField is already occupied!\");\n            p1fieldnumber = 10;\n        }\n    } while (p1fieldnumber &lt; 1 || p1fieldnumber &gt; 9);\n\n    field[p1fieldnumber-1] = 'X';\n\n}\nelse {\n\n    do {\n        printf(\"\\nIts Player %s's turn.\", names[1]);\n        char symbol = 'O';\n        printf(\"\\nNumber of the field which you want to put your symbol in: \");\n        scanf(\"%d\", &amp;p2fieldnumber);\n        if (field[p2fieldnumber] == 'X' || field[p2fieldnumber] == 'O')\n        {\n            printf(\"\\nField is already occupied!\");\n            p2fieldnumber = 10;\n        }\n    } while (p2fieldnumber &lt; 1 || p2fieldnumber &gt; 9);\n\n    field[p2fieldnumber-1] = 'O';\n\n}\n\n}\n\nchar isWinner(char actualPlayer, char *field) {\n\nchar pwinner = '3';\n\nif (((field[0] == 'O') &amp;&amp; (field[1] == 'O') &amp;&amp; (field[2] == 'O')) || \n    (field[3] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[5] == 'O') || \n    (field[6] == 'O') &amp;&amp; (field[7] == 'O') &amp;&amp; (field[8] == 'O') || \n    (field[0] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[8] == 'O') || \n    (field[2] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[6] == 'O') || \n    (field[0] == 'O') &amp;&amp; (field[3] == 'O') &amp;&amp; (field[6] == 'O') ||\n    (field[1] == 'O') &amp;&amp; (field[4] == 'O') &amp;&amp; (field[7] == 'O') || \n    (field[2] == 'O') &amp;&amp; (field[5] == 'O') &amp;&amp; (field[8] == 'O'))\n\n{\n    pwinner = '2';\n}\n\nelse if (((field[0] == 'X') &amp;&amp; (field[1] == 'X') &amp;&amp; (field[2] == 'X')) || \n    (field[3] == 'X') &amp;&amp; (field[4] == 'X') &amp;&amp; (field[5] == 'X') || \n    (field[6] == 'X') &amp;&amp; (field[7] == 'X') &amp;&amp; (field[8] == 'X') || \n    (field[0] == 'X') &amp;&amp; (field[4] == 'X') &amp;&amp; (field[8] == 'X') || \n    (field[2] == 'X') &amp;&amp; (field[4] == 'X') &amp;&amp; (field[6] == 'X') || \n    (field[0] == 'X') &amp;&amp; (field[3] == 'X') &amp;&amp; (field[6] == 'X') || \n    (field[1] == 'X') &amp;&amp; (field[4] == 'X') &amp;&amp; (field[7] == 'X') || \n    (field[2] == 'X') &amp;&amp; (field[5] == 'X') &amp;&amp; (field[8] == 'X'))\n\n{\n    pwinner = '1';\n}\n\nelse if (((field[0] == 'X') || (field[0] == 'O')) &amp;&amp; ((field[1] == 'X') || (field[1] == 'O')) &amp;&amp; ((field[2] == 'X') || (field[2] == 'O')) ||\n    ((field[3] == 'X') || (field[3] == 'O')) &amp;&amp; ((field[4] == 'X') || (field[4] == 'O')) &amp;&amp; ((field[5] == 'X') || (field[5] == 'O')) ||\n    ((field[6] == 'X') || (field[6] == 'O')) &amp;&amp; ((field[7] == 'X') || (field[7] == 'O')) &amp;&amp; ((field[8] == 'X') || (field[8] == 'O')) ||\n    ((field[0] == 'X') || (field[0] == 'O')) &amp;&amp; ((field[4] == 'X') || (field[4] == 'O')) &amp;&amp; ((field[8] == 'X') || (field[8] == 'O')) ||\n    ((field[2] == 'X') || (field[2] == 'O')) &amp;&amp; ((field[4] == 'X') || (field[4] == 'O')) &amp;&amp; ((field[6] == 'X') || (field[6] == 'O')) ||\n    ((field[0] == 'X') || (field[0] == 'O')) &amp;&amp; ((field[3] == 'X') || (field[3] == 'O')) &amp;&amp; ((field[6] == 'X') || (field[6] == 'O')) ||\n    ((field[1] == 'X') || (field[1] == 'O')) &amp;&amp; ((field[4] == 'X') || (field[4] == 'O')) &amp;&amp; ((field[7] == 'X') || (field[7] == 'O')) ||\n    ((field[2] == 'X') || (field[2] == 'O')) &amp;&amp; ((field[5] == 'X') || (field[5] == 'O')) &amp;&amp; ((field[8] == 'X') || (field[8] == 'O')))\n{\n    pwinner = '0';\n}\n\nreturn pwinner;\n}\n\nvoid printwinner(char winnerNumber, char names[][NAMELENGTH]) {\n\nif (winnerNumber == '1') {\n    printf(\"Player %s won!\", names[0]);\n}\nelse if (winnerNumber == '2') {\n    printf(\"Player %s won!\", names[1]);\n}\n\n}\n\nvoid printDrawGame(char names[][NAMELENGTH]) {\nprintf(\"Draw!\");\n}\n\nstatic int _initialized;\n\ndouble get_random_number() {\nif (!_initialized) {\n    srand(time(NULL));\n    _initialized = 1;\n}\nreturn (double)rand() / ((double)(RAND_MAX)+1);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447858991, "post_id": 33783415, "comment_id": 55333485, "body": "online compiler? try adding a <code>\\n</code> at the end of the printf statement."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447859024, "post_id": 33783415, "comment_id": 55333509, "body": "or, <code>fflush(stdout)</code> after the current printf."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1447859064, "post_id": 33783415, "comment_id": 55333537, "body": "@SouravGhosh, i think before the program exits, the buffer will flush."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1447859114, "post_id": 33783415, "comment_id": 55333568, "body": "@Haris please note the first two words in my very first comment. :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1447859138, "post_id": 33783415, "comment_id": 55333596, "body": "How do you run your program? What compiler are you using`Which version of the compiler? On which operating system?"}, {"owner": {"reputation": 23, "user_id": 5457664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92d56153a22d83427628c781f0301265?s=128&d=identicon&r=PG&f=1", "display_name": "Deva", "link": "https://stackoverflow.com/users/5457664/deva"}, "edited": false, "score": 0, "creation_date": 1447859503, "post_id": 33783415, "comment_id": 55333881, "body": "I have just downloaded a compiler using this location : <a href=\"http://sourceforge.net/projects/turbocforwindows-9/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/turbocforwindows-9</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1447859589, "post_id": 33783415, "comment_id": 55333948, "body": "Turbo C? It&#39;s 80&#39;s. Forget of it&#39;s existence. It&#39;s likely it shows the input, but the console is closing right away."}, {"owner": {"reputation": 23, "user_id": 5457664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92d56153a22d83427628c781f0301265?s=128&d=identicon&r=PG&f=1", "display_name": "Deva", "link": "https://stackoverflow.com/users/5457664/deva"}, "edited": false, "score": 0, "creation_date": 1447859657, "post_id": 33783415, "comment_id": 55334004, "body": "So Which one I should use ? can you help"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1447859700, "post_id": 33783415, "comment_id": 55334036, "body": "GCC or MSVC. Probably the latter will be better for you."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1447859957, "post_id": 33783415, "comment_id": 55334242, "body": "<a href=\"https://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments#C.2FC.2B.2B\" rel=\"nofollow noreferrer\">Here&#39;s a list</a> of different C and C++ <a href=\"https://en.wikipedia.org/wiki/Integrated_development_environment\" rel=\"nofollow noreferrer\">Integrated Development Environments</a>. Some of them are free and comes with an up-to-date compilers."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1447859848, "creation_date": 1447859848, "answer_id": 33783767, "question_id": 33783415, "link": "https://stackoverflow.com/questions/33783415/c-program-getting-compiled-but-not-showing-output/33783767#33783767", "title": "C program getting compiled but not showing output", "body": "<p>My <em>guess</em> is that the console window which contains the output flashes by so quickly that you don't have time to see it. You need to put in something to halt the program so you can see the output. One way of doing it is to ask the user to press the <kbd>Enter</kbd> key.</p>\n\n<p>Something like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"Hello World\\n\");\n    printf(\"Press the Enter key to continue\\n\");\n    (void) getc(stdin);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5457664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92d56153a22d83427628c781f0301265?s=128&d=identicon&r=PG&f=1", "display_name": "Deva", "link": "https://stackoverflow.com/users/5457664/deva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1019, "favorite_count": 0, "accepted_answer_id": 33783767, "answer_count": 1, "score": 0, "last_activity_date": 1447861891, "creation_date": 1447858927, "last_edit_date": 1447861891, "question_id": 33783415, "link": "https://stackoverflow.com/questions/33783415/c-program-getting-compiled-but-not-showing-output", "title": "C program getting compiled but not showing output", "body": "<p>I am not sure why my program is not showing \"Hello World\". I am trying by executing only <code>printf()</code>. Is there anything I am missing here?</p>\n\n<p>Below is my complete program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    printf(\"Hello World\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447858948, "post_id": 33783368, "comment_id": 55333450, "body": "show the definition of <code>cache</code>.."}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "edited": false, "score": 3, "creation_date": 1447859076, "post_id": 33783368, "comment_id": 55333548, "body": "Show the definition of <code>struct List_t</code> which is not there in your posting. If it is not there in your source file as well, the error seems logical, as <code>struct List_t</code> is incomplete type, and its size is not known and so its pointer (of type <code>List</code>) cannot be incremented."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1447859330, "post_id": 33783368, "comment_id": 55333758, "body": "Do not <code>typedef</code> pointers. That hides the semantics and results in erros as the one you show. Instead, use them only explicitly. (And the name <code>List</code> for a pointer is missleading anyway)."}], "answers": [{"comments": [{"owner": {"reputation": 1380, "user_id": 5306478, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d69c5f3d65ef36b14f4a4f2b06c690d8?s=128&d=identicon&r=PG&f=1", "display_name": "shayelk", "link": "https://stackoverflow.com/users/5306478/shayelk"}, "edited": false, "score": 0, "creation_date": 1447859534, "post_id": 33783547, "comment_id": 55333907, "body": "thanks! I used a pointe to List (List*) to get the result I wanted"}], "tags": [], "owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "is_accepted": true, "score": 1, "last_activity_date": 1447859259, "creation_date": 1447859259, "answer_id": 33783547, "question_id": 33783368, "link": "https://stackoverflow.com/questions/33783368/why-do-i-get-increment-of-pointer-to-unknown-structure/33783547#33783547", "title": "Why do I get &quot;increment of pointer to unknown structure&quot;?", "body": "<p>The pointer is not incremented by <code>sizeof(List)</code> but by <code>sizeof(struct List_t)</code>. The definition of <code>struct List_t</code> is not there in your source, and is thus an incomplete type. This is the reason for the error.</p>\n"}], "owner": {"reputation": 1380, "user_id": 5306478, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d69c5f3d65ef36b14f4a4f2b06c690d8?s=128&d=identicon&r=PG&f=1", "display_name": "shayelk", "link": "https://stackoverflow.com/users/5306478/shayelk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 33783547, "answer_count": 1, "score": 0, "last_activity_date": 1448013646, "creation_date": 1447858813, "last_edit_date": 1448013646, "question_id": 33783368, "link": "https://stackoverflow.com/questions/33783368/why-do-i-get-increment-of-pointer-to-unknown-structure", "title": "Why do I get &quot;increment of pointer to unknown structure&quot;?", "body": "<p>I'm trying to bulid a structure named \"cache\", which holds a container (an array of type List which is already implemented) and an iterator.\nwhen I'm trying to make the iterator point at the next List in the container I get \"increment of pointer to unknown structure\" and \"arithmetic on pointer to an incomplete type\". I would love an explanation as to what I'm doing wrong:</p>\n\n<p>List is typedefed as follows:</p>\n\n<pre><code>typedef struct List_t *List;\n</code></pre>\n\n<p>so List is a pointer to a List_t structure.</p>\n\n<p>Cache is defined as follows:</p>\n\n<pre><code>typedef struct cache_t* Cache;\n\nstruct cache_t {\n    List* container;\n    int cache_size;\n    List iterator;\n};\n</code></pre>\n\n<p>so iterator is a List which is a pointer to a List_t in an array (container).\nWhat I'm trying to do is:</p>\n\n<pre><code>cache-&gt;iterator ++; //cache is an object of type Cache\n</code></pre>\n\n<p>which, as far as I know, should move iterator by sizeof(List) to the next List in the array. so why am I getting errors?</p>\n\n<p>thanks!</p>\n"}, {"tags": ["c", "regex", "count", "scanf", "words"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 3, "creation_date": 1447858467, "post_id": 33783219, "comment_id": 55333102, "body": "<code>fscanf</code> does not support regex."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 3, "creation_date": 1447858548, "post_id": 33783219, "comment_id": 55333165, "body": "Well, it supports the character range format <code>%[</code>, which looks a bit like a regex character range. Still, it&#39;s no regex, of course."}, {"owner": {"reputation": 3, "user_id": 5577135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215afde1afc3d59d7c3ae809b6084d0?s=128&d=identicon&r=PG&f=1", "display_name": "Khorne", "link": "https://stackoverflow.com/users/5577135/khorne"}, "edited": false, "score": 0, "creation_date": 1447858760, "post_id": 33783219, "comment_id": 55333314, "body": "Care to elaborate why it is working (somewhat) correctly then ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1447858778, "post_id": 33783219, "comment_id": 55333326, "body": "After the definition <code>char word[10];</code> you cannot use <code>10</code> in the <code>scanf()</code> format conversion: you must take into account the <code>&#39;\\0&#39;</code> terminator: <code>fscanf(fp, &quot; %9[^A-Za-z]%*c&quot;, ...)</code>"}, {"owner": {"reputation": 3, "user_id": 5577135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215afde1afc3d59d7c3ae809b6084d0?s=128&d=identicon&r=PG&f=1", "display_name": "Khorne", "link": "https://stackoverflow.com/users/5577135/khorne"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1447859056, "post_id": 33783219, "comment_id": 55333528, "body": "@pmg I am aware of that, I was just surprised it still worked with the 10 in place, I put that in place because when scanning the array through the loop it seemed that the first letter of each word was being &quot;eaten&quot;, I thought it would fix that issue which it did not."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1447859416, "post_id": 33783219, "comment_id": 55333820, "body": "Of course the first letter gets eaten; you told the program to do so by reading an extra char with <code>%*c</code>. If you only want to count the number of words, the <code>fscanf</code> approach seems too complicated."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1447859481, "post_id": 33783219, "comment_id": 55333865, "body": "If you are not going to do anyting with <code>r</code> except compare it to 0 or 1 right away, you could just as easily do without it and save some parens in the if/while constructs."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1447859601, "post_id": 33783219, "comment_id": 55333957, "body": "Rather than attempt to repair this approach, suggest reading the line with <code>fgets()</code> and then parsing with <code>sscanf()</code>"}, {"owner": {"reputation": 3, "user_id": 5577135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215afde1afc3d59d7c3ae809b6084d0?s=128&d=identicon&r=PG&f=1", "display_name": "Khorne", "link": "https://stackoverflow.com/users/5577135/khorne"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1447860425, "post_id": 33783219, "comment_id": 55334616, "body": "@chux I will try this approach and post back results, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5577135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215afde1afc3d59d7c3ae809b6084d0?s=128&d=identicon&r=PG&f=1", "display_name": "Khorne", "link": "https://stackoverflow.com/users/5577135/khorne"}, "edited": false, "score": 0, "creation_date": 1447863384, "post_id": 33784678, "comment_id": 55336914, "body": "This clarifies a lot of the concepts I have wrongly assumed in my head, thank you very much for this."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1447865581, "post_id": 33784678, "comment_id": 55338477, "body": "Elegant use of <code>[^...]</code> and <code>[...]</code>.  Minor:  <code>&#39;</code> in <code>&quot;A-Za-z0-9&#39;&quot;</code>?? .  <code>WORD</code> inconsistent with <code>isword(int c)</code> .  <code>WORD</code> not used in 2nd snippet."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1447872867, "post_id": 33784678, "comment_id": 55343010, "body": "@chux: I&#39;ve included the apostrophe so that the English contractions (<i>you&#39;re</i>, <i>it&#39;s</i>) and possessives will be one word. The <code>WORD</code> in the second snipped is a leftover from its incarnation as first snippet; I&#39;ll remove it. Thanks."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 2, "last_activity_date": 1447872902, "last_edit_date": 1447872902, "creation_date": 1447862325, "answer_id": 33784678, "question_id": 33783219, "link": "https://stackoverflow.com/questions/33783219/c-counting-word-program-works-if-there-is-no-space-between-symbols-why/33784678#33784678", "title": "C counting word program works if there is no space between symbols, why?", "body": "<p>Your first scanning command is</p>\n\n<pre><code>fscanf(fp, \"\\n%10[^A-Za-z]%*c\", word)\n</code></pre>\n\n<p>This will skip any white-space (<code>\"\\n\"</code>), then read into a buffer of up to 10 chars that are not letters (<code>\"%10[^A-Za-z]\"</code>) and finally read the character after that (<code>\"*c\"</code>). </p>\n\n<p>You don't enter the <code>while</code> loop when the file begins with a letter, because <code>fscanf</code> will return 0, as it cound't scan a non-empty string of non-letters. If you even skip white space before that, the while loop is only entered when the first non-space character is not a letter, which is not very likely.</p>\n\n<p>Because you read an extra character at the end of the <code>fscanf</code>, your words will miss their first letter. </p>\n\n<p>By constraining the word to 10 letters, you read longer words in chunks, which should throw your word count off by counting longer words a stwo or three words. The char buffer <code>word</code> should also have at least 11 chars.</p>\n\n<p>The proper way to print a string is to <code>printf(\"%s\", word)</code>or to <code>puts(word)</code> it. Your loop is basically okay, but prints all ten letters even if the word might have fewer letters.</p>\n\n<p>I don't think that using <code>fscanf</code> is a good way to count words, but if you want to use it, you could do something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define WORD \"A-Za-z0-9'\"\n\nint main(void)\n{\n    FILE *fp = stdin;\n    int n = 0;\n\n    while (fscanf(fp, \"%*[^\" WORD \"]\") != EOF\n        &amp;&amp; fscanf(fp, \"%*[\" WORD \"]\") != EOF) {\n        n++;\n    }\n\n    printf(\"%d words\\n\", n);\n\n    return 0;\n}\n</code></pre>\n\n<p>Here, we <code>fscanf</code> for non-words and words alternately and end the lopp when one of the <code>fscanf</code>s signals the end of the file. Note that we don't care about the actual contents, as we skip them by not converting anything with the <code>*</code> asterisk. That means that the only outcome of the <code>fscanf</code> can be 0 and <code>EOF</code>.</p>\n\n<p>The usual approach to count words is to read chars and detect when the \"context\" switches from non-words to words:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint isword(int c)\n{\n    if ('A' &lt;= c &amp;&amp; c &lt;= 'Z') return 1;\n    if ('a' &lt;= c &amp;&amp; c &lt;= 'z') return 1;\n    if ('0' &lt;= c &amp;&amp; c &lt;= '9') return 1;\n    if (c == '-') return 1;\n    if (c == '\\'') return 1;\n    return 0;\n}\n\nint main(void)\n{\n    FILE *fp = stdin;       // or use a real file, of course\n    int word = 0;           // 0: space cntext, 1: word context\n    int n = 0;\n\n    for (;;) {\n        int c = fgetc(fp);\n\n        if (c == EOF) break;\n\n        if (isword(c)) {\n            if (word == 0) n++;\n            word = 1;\n        } else {\n            word = 0;\n        }\n    }\n\n    printf(\"%d words\\n\", n);\n\n    return 0;\n}\n</code></pre>\n\n<p>What counts as a word is defined here by the function <code>isword</code>. Note how there is no need to keep two <code>fscanf</code> formats in sync. A letter is part of a word or it is not., That's unambiguous with the <code>else</code> clause.</p>\n"}], "owner": {"reputation": 3, "user_id": 5577135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215afde1afc3d59d7c3ae809b6084d0?s=128&d=identicon&r=PG&f=1", "display_name": "Khorne", "link": "https://stackoverflow.com/users/5577135/khorne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 33784678, "answer_count": 1, "score": 0, "last_activity_date": 1448032501, "creation_date": 1447858402, "last_edit_date": 1448032501, "question_id": 33783219, "link": "https://stackoverflow.com/questions/33783219/c-counting-word-program-works-if-there-is-no-space-between-symbols-why", "title": "C counting word program works if there is no space between symbols, why?", "body": "<p>This is the code I'm using and it works perfectly unless:</p>\n\n<ol>\n<li>The text file starts with integers.</li>\n<li>If there is no space between symbols e.g [hi!] works perfectly  but [hi !] prints \ufffd</li>\n<li>If i put multiple symbols together e.g [?????????] the number of words will be incorrect.</li>\n</ol>\n\n<p>Just to clarify it is fine if there are integers within the code but not if they are at the start.</p>\n\n<p>Why is that the case? I am really curious how to solve that issue.</p>\n\n<p>EDIT:\nIt was pointed out to me that fscanf does not support regex, why does it filter out the letters correctly then?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* counts words in the file */\nint main(void) \n{\n    FILE *fp;\n    int r,n,i; /* a variable for result of a function, returning int */\n     /* the words counter */\n    const char *filename = \"test2.txt\"; /* a file name opening for read */\n    char word[10]; /* an array for the check if a non-empty word was read */\n\n    if ((fp = fopen(filename, \"r\")) == NULL) {\n        fprintf(stderr, \"error: file\" \"\\n\");\n        return 1;\n    }  \n    /* if can't open the file for read\n       then print an error message and return false to the environment */\n    int arraylen = sizeof(word)/sizeof(word[0]); /*write the length of array word to arraylen*/ \n    n = 0; /* turn the counter of words to zero */\n    word[0] = '\\0'; /* turn the word array to an empty state */\n   while ((r = fscanf(fp, \"\\n%10[^A-Za-z]%*c\", word)) == 1) {\n        printf(\"firstoutput\\n\");\n        for(i=0;i&lt;arraylen;i++)\n\n                printf(\"%c\",word[i]);\n\n\n    if((r = fscanf(fp, \"\\n%[A-Za-z]%*c\", word)) == 0) { /*in case next character is not a \n        letter do nothing, this is in place to prevent the program from getting stuck*/\n\n         printf(\"secondoutput\\n\");\n        for(i=0;i&lt;arraylen;i++)\n            if(word[i] != (' '))\n                printf(\"%c\",word[i]);\n        }\n\n        if (word[0] != '\\0')\n            n++;\n        /* if the word array got something,\n           then it was a word, count it */ \n\n        word[0] = '\\0'; /* turn the word back into an empty state */\n    }  \n    /* skipping words delimeted by ' ' or '\\n' or ','\n       while file fp can be read, continue skipping\n       and count every skip */\n\n\n    if (ferror(fp) != 0) { /* check the file for read error if EOF occured */\n        fprintf(stderr, \"error: read file\" \"\\n\");\n        fclose(fp);\n        return 1;\n    }\n    /* if there was an error while reading the file\n       then print error, close the file (because it was opened though)\n       and return false to the environment */\n\n    if (n == 1) /* control \"to be\" and endings for word or words */\n        printf(\"\\nthere is %d word\" \"\\n\", n);\n    else\n        printf(\"\\nthere are %d words\" \"\\n\", n);\n\n    fclose(fp); /* close the file */\n\n    return 0; /* return success to the environment */\n}\n</code></pre>\n\n<p>EDIT2 : Im posting a full solution which works 101%, I combined all the various tips and stuff I found and created this, I believe this solution is extremely compact and efficient, if I am in the wrong do correct me !</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define WORD \"A-Za-z\"\n\n\nint countWords(FILE *f,int* now){\n   char ch[100][100];\n   int x;\n   *now=0;\n   int count = 0;\n       while (fscanf(f, \"%[^\" WORD \"]\",ch[count]) != EOF\n        &amp;&amp; fscanf(f, \"%10[\" WORD \"]\",ch[count]) != EOF) {\n\n        if(count&gt;0) {\n\n        for(x=0;x&lt;count;x++) {\n\n          if((strcasecmp(ch[count],ch[x]))==0) { /* Compare if the two words match, \n          case insensitive*/\n            if(fscanf(f, \"%[^\" WORD \"]\",ch[count]) != EOF\n            &amp;&amp; fscanf(f, \"%10[\" WORD \"]\",ch[count]) != EOF) /* Since the words match,\n            now we have to overwrite the double word by scanning the next set of characters.*/\n              printf(\"String is equal\\n\");\n\n              (*now)++;\n          }\n        }\n      }\n        puts(ch[count]);\n        count++;\n        (*now)++;\n    }\n    puts(ch[13]);\n    printf(\"%d\\n\",*now );\n\n   return count;\n}\n\nint main(void){\n\n   int uniquewordCount=0,wordCount=0;\n   FILE *rFile = fopen(\"test2.txt\", \"r\");\n   uniquewordCount += countWords(rFile,&amp;wordCount);\n   printf(\"%d\\n\",(a+b));\n   printf(\"Amount of unique words: %d\\n\", uniquewordCount);\n   printf(\"Amount of words: %d\\n\", wordCount);\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "crash", "valgrind", "main"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 3, "creation_date": 1447858299, "post_id": 33783121, "comment_id": 55332991, "body": "Are the <code>lines</code> and <code>path</code> arrays too big for your stack? If so, you can try to reduce  <code>MAXLINES</code> and <code>BUFSIZE</code>. Alternatively, allocate the arrays on the heap with <code>malloc</code>."}, {"owner": {"reputation": 52, "user_id": 5511530, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0be493cbe52181c3aa2c39208250b19?s=128&d=identicon&r=PG&f=1", "display_name": "Loic Reyreaud", "link": "https://stackoverflow.com/users/5511530/loic-reyreaud"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1447858889, "post_id": 33783121, "comment_id": 55333411, "body": "It was not me who coded this i tried a few things, I changed MAXLINES value but nothing happened (defines at 5000 upper in the code) and then changed BUFSIZE with 10 and it worked, I&#39;ll see with my friend and try to find a workaround, thanks for your help! :)"}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 1, "creation_date": 1447865064, "post_id": 33783121, "comment_id": 55338091, "body": "Quick workaround: Make <code>path</code> (and potentially also <code>lines</code>) a global (or static) variable. Basically, just move it a bit up, outside of main. That way it won&#39;t get allocated on the stack."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447871893, "post_id": 33783121, "comment_id": 55342368, "body": "this pair of lines: <code>char *temp2 = (char *) malloc(1 + strlen(folder)+ strlen(temp));         strcat(temp2,folder);</code> has a couple of problems.  1) in C, casting the returned value from malloc() just leads to debug and maintenance problems.  2) always check (!=NULL) the returned value from malloc() to assure the operation was successful.  3) the memory pointed at by <code>temp2</code> contains trash,  so it is anyones guess where a NUL byte would be located. it could be beyond the bounds of the allocated memory. use: `strcpy( temp2, folder );"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447872556, "post_id": 33783121, "comment_id": 55342785, "body": "the code will leak memory like a sieve because of the many calls to <code>malloc()</code> without corresponding calls to <code>free()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447872832, "post_id": 33783121, "comment_id": 55342982, "body": "Since the array <code>lines[][]</code> is not needed except as an input to the creation of the string pointed to by <code>path[]</code>, there only needs to be a single instance of <code>lines[BUFSIZE]</code>   then prepend the <code>folder[]</code> contents, and setting of <code>path[i]</code> all in the same loop."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447873048, "post_id": 33783121, "comment_id": 55343148, "body": "It reads like your using a windows OS. The last time I looked, the stack was limited to only one meg on windows. So the declaration for lines[][] and path[] are overrunning the available stack space. Suggest using malloc() to allocate the needed memory areas."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447873327, "post_id": 33783121, "comment_id": 55343306, "body": "this pair of lines: while (i &lt; MAXLINES &amp;&amp; fgets(lines[i], sizeof(lines[0]), fp)) { lines[i][strlen(lines[i])-1] = &#39;\\0&#39;; has a couple of &#39;less than great&#39; details. 1) the fgets() function will include the &lt;newline&gt; sequence. (Which is 2 bytes on windows, not one byte.) Suggest use something like char *newline = NULL; if( NULL != (newline = strstr( lines[i], &quot;\\n&quot;)) ) { *newline = &#39;\\0&#39;; } 2) the expression: sizeof(lines[0])` is a bit &#39;iffy&#39; especially as there is a BUFSIZE defined. Suggest replace sizeof(lines[0]) with BUFSIZE"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447874043, "post_id": 33783121, "comment_id": 55343725, "body": "When compiling, always enable all the warnings. then fix those warnings. (for gcc, at a minimum, use: -Wall -Wextra -pedantic ) When asking a question about a runtime problem, post code that cleanly compiles, is short, and still exhibits the problem. The posted code is missing the needed #include, are we expected to guess what those statements are? the values: MAXLINES and BUFSIZE are not defined.  in general, the checking for required command line parameters should be the first thing the code does, before opening/reading file, etc  Before exiting close files, free memory."}, {"owner": {"reputation": 52, "user_id": 5511530, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0be493cbe52181c3aa2c39208250b19?s=128&d=identicon&r=PG&f=1", "display_name": "Loic Reyreaud", "link": "https://stackoverflow.com/users/5511530/loic-reyreaud"}, "edited": false, "score": 0, "creation_date": 1447977477, "post_id": 33783121, "comment_id": 55398989, "body": "Everything you guys said was dully noted, indeed this is a WIP and there are a lot of mistakes in it, and I won&#39;t make the same mistake twice (relative ton #include statement). Thanks everyone for your answers :) ."}], "owner": {"reputation": 52, "user_id": 5511530, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0be493cbe52181c3aa2c39208250b19?s=128&d=identicon&r=PG&f=1", "display_name": "Loic Reyreaud", "link": "https://stackoverflow.com/users/5511530/loic-reyreaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447858145, "creation_date": 1447858145, "question_id": 33783121, "link": "https://stackoverflow.com/questions/33783121/crash-on-first-main-line-c", "title": "Crash on first main line C", "body": "<p>I'm having a really weird error on a project I'm working code.\nHere's the error (with valgrind)</p>\n\n<pre><code>==1930== Memcheck, a memory error detector\n==1930== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==1930== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==1930== Command: ./main\n==1930== \n==1930== Warning: client switching stacks?  SP change: 0xfff000280 --&gt; 0xffc8e6590\n==1930==          to suppress, use: --max-stackframe=41000176 or greater\n==1930== Invalid write of size 8\n==1930==    at 0x401288: main (main.c:70)\n==1930==  Address 0xffc8e6588 is on thread 1's stack\n==1930==  in frame #0, created by main (main.c:69)\n==1930== \n==1930== \n==1930== Process terminating with default action of signal 11 (SIGSEGV)\n==1930==  Access not within mapped region at address 0xFFC8E6588\n==1930==    at 0x401288: main (main.c:70)\n==1930==  If you believe this happened as a result of a stack\n==1930==  overflow in your program's main thread (unlikely but\n==1930==  possible), you can try to increase the size of the\n==1930==  main thread stack using the --main-stacksize= flag.\n==1930==  The main thread stack size used in this run was 8388608.\n==1930== \n==1930== Process terminating with default action of signal 11 (SIGSEGV)\n==1930==  Access not within mapped region at address 0xFFC8E6581\n==1930==    at 0x4A236C0: _vgnU_freeres (vg_preloaded.c:58)\n==1930==  If you believe this happened as a result of a stack\n==1930==  overflow in your program's main thread (unlikely but\n==1930==  possible), you can try to increase the size of the\n==1930==  main thread stack using the --main-stacksize= flag.\n==1930==  The main thread stack size used in this run was 8388608.\n==1930== \n==1930== HEAP SUMMARY:\n==1930==     in use at exit: 37 bytes in 1 blocks\n==1930==   total heap usage: 1 allocs, 0 frees, 37 bytes allocated\n==1930== \n==1930== LEAK SUMMARY:\n==1930==    definitely lost: 0 bytes in 0 blocks\n==1930==    indirectly lost: 0 bytes in 0 blocks\n==1930==      possibly lost: 0 bytes in 0 blocks\n==1930==    still reachable: 37 bytes in 1 blocks\n==1930==         suppressed: 0 bytes in 0 blocks\n==1930== Reachable blocks (those to which a pointer was found) are not    shown.\n==1930== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==1930== \n==1930== For counts of detected and suppressed errors, rerun with: -v\n==1930== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\nErreur de segmentation (segfault basically)\n</code></pre>\n\n<p>I'll add that on my co-worker computer (MACOSX actually) it works perfectly fine.</p>\n\n<p>Here's our (awfull) main, the line 70 is the first line of the main in our .c file: (still WIP excuse me for all the shit that's going on here ^^)</p>\n\n<pre><code>int main(int argc, char* argv[]) {\n    printf(\"derp\\n\");\n    int i = 0;\n    char lines[MAXLINES][BUFSIZ];\n    char* path[MAXLINES];\n\n    printf(\"derp\\n\");\n    FILE *fp = fopen(\"./Images/125/DBtexte.txt\", \"r\");\n\n    if (fp == 0) {\n        fprintf(stderr, \"failed to open DBtexte\\n\");\n        exit(1);\n    }\n\n    printf(\"derp\\n\");\n    while (i &lt; MAXLINES &amp;&amp; fgets(lines[i], sizeof(lines[0]), fp)) {\n        lines[i][strlen(lines[i])-1] = '\\0';\n        i = i + 1;\n    }\n\n    i = 0;\n    printf(\"derp\\n\");\n    while(strcmp(lines[i],\"\\0\"))\n        i++;\n    char *folder = \"./Images/125/\";\n    for (size_t j = 0; j&lt;(size_t)i; j++) {\n        char *temp = lines[j];\n        char *temp2 = (char *) malloc(1 + strlen(folder)+ strlen(temp));\n        strcat(temp2,folder);\n        strcat(temp2,temp);\n        path[j] = temp2;\n        //printf(\"%s\\n\",path[j]);\n    }\n    fclose(fp);\n    int *visage = faces(i-1,i);\n    printf(\"\\nTHE FACE IS A LIE\\n\");\n    /*if (argc &lt; 2)\n            errx(2, \"Usage:\\n%s &lt;path&gt;\", argv[0]);\n    SDL_Surface* image = load_image(argv[1]);\n    display_image(image);\n    ToGray(image);\n    display_image(image);\n    Binarize(image);\n    display_image(image); */\n    printf(\"ONSTART\\n\");\n    strongClassifier* yolo;\n\n    yolo = adaboost(path, visage, 124, 1, 20);\n\n\n    //int len;\n    //haarRecord* haarOutput;\n    //haarOutput = processImage(image, &amp;len);\n    //display_haar(haarOutput, len);\n    //SDL_SaveBMP(image, \"./ToGray.bmp\");\n    return 0;\n}\n</code></pre>\n\n<p>Really looking forward for your help :)</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1447857832, "post_id": 33782940, "comment_id": 55332605, "body": "Try learning one language at a time. Get a book about one and start from there."}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1447857839, "post_id": 33782940, "comment_id": 55332612, "body": "Welcome to SO.  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>.  Show what code you have, any what the issue is in the code."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1447857913, "post_id": 33782940, "comment_id": 55332683, "body": "What range can X take? Is it a compile-time constant or a run-time variable? sqrt(2) is about 1.4142135623730950488016887242096980785696718753769480731766&zwnj;&#8203;7973799 ... just truncate it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1447858051, "post_id": 33782940, "comment_id": 55332807, "body": "While a solution for C can work in C++, the opposite isn&#39;t necessarily true. Please be specific, which language do you want to learn?"}, {"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 0, "creation_date": 1447858341, "post_id": 33782940, "comment_id": 55333020, "body": "Please post your code."}, {"owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447859010, "post_id": 33782940, "comment_id": 55333499, "body": "i&#39;m moving more on c language, forgot to mention it. The thing is that I understant what those things .3f or smth like that do, but after~16 numbers after the dot, it throws zeros. My task is to do a program that can show more than that. Do I need some kind of math algorythms to change it into program ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1447859435, "post_id": 33782940, "comment_id": 55333832, "body": "For the format strings, <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">this <code>printf</code> (and family) reference</a> might come in handy. As for the zeroes, while <code>double</code> has higher precision than <code>float</code>, it&#39;s not as much as <code>long double</code>, and even <code>long double</code> have a finite and fixed precision. You might want to check into a multiple-precision library such as <a href=\"https://gmplib.org/\" rel=\"nofollow noreferrer\">libgmp</a>."}], "answers": [{"tags": [], "owner": {"reputation": 340, "user_id": 5442199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4227301e488e0e33cf09c902fe99ab30?s=128&d=identicon&r=PG&f=1", "display_name": "uvr", "link": "https://stackoverflow.com/users/5442199/uvr"}, "is_accepted": false, "score": 0, "last_activity_date": 1447858026, "creation_date": 1447858026, "answer_id": 33783073, "question_id": 33782940, "link": "https://stackoverflow.com/questions/33782940/square-root-of-2-need-x-digits-after-the-dot/33783073#33783073", "title": "Square root of 2, need x digits after the dot", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    double number = 20.0;\n    double sq = sqrt(number);\n    printf(\"%.3lf\\n\", sq);\n    return 0;\n}\n</code></pre>\n\n<p>This code works for me. \nThe .3 in the print statement says it is 3 digits</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447858798, "post_id": 33783110, "comment_id": 55333338, "body": "i&#39;m moving more on c language, forgot to mention it. The thing is that I understant what those things .3f or smth like that do, but after~16 numbers after the dot, it throws zeros. My task is to do a program that can show more than that. Do I need some kind of math algorythms to change it into program ?"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447858849, "post_id": 33783110, "comment_id": 55333378, "body": "@Andrelis ~16 places is then where the double precision ends. A data type double can only save so many numbers after the dot. There is a limit to how precise it can get. Its also worth noting that there are some results who cannot be accurately displayed in double, <code>sqrt(2)</code> is a good example. Those are rounded to the nearest representable number in the data type."}, {"owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447858991, "post_id": 33783110, "comment_id": 55333486, "body": "So is it possible somehow take this number into array with all of its digits?"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447859035, "post_id": 33783110, "comment_id": 55333513, "body": "Not by using the c library function <code>sqrt()</code> because that uses a return type double, and, as such, is bound to the precision limits of double. Now if you implement your own algorhitm function that saves the results in an array instead, that could work, but is out of scope for the question here. Its additionally worth noting that <code>sqrt(2)</code> is an irrational number, and thus cannot ever be represented just using decimal numbers. It has an infinite amount of numbers after the dot."}, {"owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447859296, "post_id": 33783110, "comment_id": 55333722, "body": "and if i need to bring around 200 numbers after the dot, array won&#39;t help me?"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447859388, "post_id": 33783110, "comment_id": 55333801, "body": "@Andrelis it will, but you will have to implement sqrt() yourself, with your specific constraints in mind. There are some algorhitms out there for approximating N numbers after the dot for irrational square root results, but you will have to implement that yourself. You can theorethically write your own function that stores the result in an array with 100 elements, or 200 elements, or even 500 elements."}, {"owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447860030, "post_id": 33783110, "comment_id": 55334294, "body": "Ahhh this sound harder with every word you say. Too much to learn so far."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447860108, "post_id": 33783110, "comment_id": 55334359, "body": "@Andrelis sometimes it gets overwhelming, but there is alot of documentation out there and tutorials on almost everything. Google is your best friend in learning programming soon and properly. :)"}, {"owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447860210, "post_id": 33783110, "comment_id": 55334436, "body": "the worst thing that I have  days to make this program.. Thats the wors thing"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447860400, "post_id": 33783110, "comment_id": 55334601, "body": "@Andrelis If you look for specific constants, for instance directly for sqrt(2), you can use a Taylor Series Expansion Algo to approximate (We&#39;re moving in upper level calculus here). An example of how its done is here: <a href=\"http://numbers.computation.free.fr/Constants/Programs/programs.html\" rel=\"nofollow noreferrer\">numbers.computation.free.fr/Constants/Programs/programs.html</a>  In any event, I recommend you find a way using ordinary advanced calculus and related maths to solve your problem, and then translate that way into code, rather then starting from the other side. Math and programming are closely related."}, {"owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "edited": false, "score": 0, "creation_date": 1447860703, "post_id": 33783110, "comment_id": 55334817, "body": "ohhh gosh, hard to understant this things in this program... I have a clue how mathimaticaly count this square, but the problem is how to turn it into code... ahhh, Somehow, somehow..."}], "tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 1, "last_activity_date": 1447858111, "creation_date": 1447858111, "answer_id": 33783110, "question_id": 33782940, "link": "https://stackoverflow.com/questions/33782940/square-root-of-2-need-x-digits-after-the-dot/33783110#33783110", "title": "Square root of 2, need x digits after the dot", "body": "<p>Anything stopping you from simply printing X numbers after the dot?</p>\n\n<p>Like so:\n(for plain c)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint main (void)\n{\ndouble myRoot = sqrt(2.00);\nprintf(\"%.3f\\n\", myRoot);\nreturn 0;\n}\n</code></pre>\n\n<p>a double is a number with accuracy beyond whole numbers. the <code>sqrt()</code> function returns a double and takes input of type double. Its a c standart function whose definition is included in the header file <code>math.h</code>. the <code>%3.f</code> in the <code>printf()</code> call says it should print the number with 3 places behind the dot.</p>\n\n<p>Its worth noting that c and c++ are entirely different languages, so you need to choose which one you want to tackle.</p>\n"}, {"tags": [], "owner": {"reputation": 1804, "user_id": 4313775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kpFpj.jpg?s=128&g=1", "display_name": "David van rijn", "link": "https://stackoverflow.com/users/4313775/david-van-rijn"}, "is_accepted": false, "score": 0, "last_activity_date": 1447858196, "creation_date": 1447858196, "answer_id": 33783143, "question_id": 33782940, "link": "https://stackoverflow.com/questions/33782940/square-root-of-2-need-x-digits-after-the-dot/33783143#33783143", "title": "Square root of 2, need x digits after the dot", "body": "<p>if you want to round off your actual number, you can do <code>floor(val*pow(10, X))/pow(10,X)</code> but it is probably neater to only print it in a given precision:\n<a href=\"http://www.cplusplus.com/reference/ios/ios_base/precision/\" rel=\"nofollow\">c++</a> or <a href=\"http://www.cplusplus.com/reference/cstdio/printf/?kw=printf\" rel=\"nofollow\">c</a></p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1447858363, "creation_date": 1447858363, "answer_id": 33783204, "question_id": 33782940, "link": "https://stackoverflow.com/questions/33782940/square-root-of-2-need-x-digits-after-the-dot/33783204#33783204", "title": "Square root of 2, need x digits after the dot", "body": "<p>If you're looking to print a particular number of digits after the decimal, you could do this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main ( )\n{\n    double d = sqrt(2);\n    int digits = 7;\n    printf(\"d=%.*f\\n\", digits, d);\n    return 0;\n}\n</code></pre>\n\n<p>The <code>*</code> in place of the precision specifier (the digit after the <code>.</code>) specifies that the value of the precision appears next in the argument list.  This allows you to print to whatever precision you specify.</p>\n"}], "owner": {"reputation": 15, "user_id": 5577093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001832463206961/picture?type=large", "display_name": "Andrelis", "link": "https://stackoverflow.com/users/5577093/andrelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1448252522, "creation_date": 1447857684, "last_edit_date": 1447859830, "question_id": 33782940, "link": "https://stackoverflow.com/questions/33782940/square-root-of-2-need-x-digits-after-the-dot", "title": "Square root of 2, need x digits after the dot", "body": "<p>Tried everything an I can't get an idea how to do it. I'm new at programming, trying to manage c and c++ languages, but sometimes I stuck at zero. Can anyone help me with this? I need to get X digits after squared of 2. Sounds easy but it isn't for me. Thanks for ya attention.\nAnd this is an idea</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    double a = 2;\n    double b = 1;//somehow i read about dividing, and square of 2 is between 1 and 2;\n    double c = (a-b*b)/(2*b);\n    double d = b+c;\n    double c1= (a-d*d)/(2*d);\n    double d1 = c1+d;\nprintf(\"%.16f\\n%.16f\\n\",d1, d);\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "pointers", "integer"], "comments": [{"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 2, "creation_date": 1447857651, "post_id": 33782861, "comment_id": 55332446, "body": "You are doing things in a very strange way. If you wanna compare <code>int</code>s. Take and <code>int</code>, read it and compare, Why is the <code>array</code> needed?"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1447858343, "post_id": 33782861, "comment_id": 55333022, "body": "Posted a simple way to do what you are trying."}, {"owner": {"reputation": 1, "user_id": 5577097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20209d831118f6908d72a5b8529dbbf8?s=128&d=identicon&r=PG&f=1", "display_name": "hdlsswrrr", "link": "https://stackoverflow.com/users/5577097/hdlsswrrr"}, "reply_to_user": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1447858625, "post_id": 33782861, "comment_id": 55333216, "body": "@Haris We need to hide the pin code with # or something like entering a password."}], "answers": [{"comments": [{"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 1, "creation_date": 1447857603, "post_id": 33782892, "comment_id": 55332405, "body": "This seems more like a comment to me."}, {"owner": {"reputation": 1, "user_id": 5577097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20209d831118f6908d72a5b8529dbbf8?s=128&d=identicon&r=PG&f=1", "display_name": "hdlsswrrr", "link": "https://stackoverflow.com/users/5577097/hdlsswrrr"}, "edited": false, "score": 0, "creation_date": 1447857805, "post_id": 33782892, "comment_id": 55332573, "body": "What can I do to fix that?"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1447857818, "last_edit_date": 1447857818, "creation_date": 1447857577, "answer_id": 33782892, "question_id": 33782861, "link": "https://stackoverflow.com/questions/33782861/error-iso-c-forbids-comparison-between-pointer-and-integer-fpermissive/33782892#33782892", "title": "Error] ISO C++ forbids comparison between pointer and integer [-fpermissive]", "body": "<p>You are reading characters and comparing them as ints. That won't work....</p>\n\n<p>The following first places the charactes into an array of characters, then converts that aray to an int and compares the int:</p>\n\n<pre><code>char passch[6];\nint pass, x;\nmain()\n{\n    cout&lt;&lt;\"\\nEnter pin code: \";\n    for(x=0;x&lt;=4;x++)\n    {\n        passch[x]=getch();\n        putch('#');\n    } \n    passch[5]= '\\0';\n    pass= atoi(passch);\n    if(pass==86222)\n        cout&lt;&lt;\"\\nW E L C O M E!\";\n    else\n        cout&lt;&lt;\"\\nIncorrect Pin Code\";\n    getch();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 876, "user_id": 1904913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f077c00629c09e11bb8eb28a9534fba6?s=128&d=identicon&r=PG", "display_name": "honi", "link": "https://stackoverflow.com/users/1904913/honi"}, "is_accepted": false, "score": 0, "last_activity_date": 1447858305, "last_edit_date": 1447858305, "creation_date": 1447857717, "answer_id": 33782952, "question_id": 33782861, "link": "https://stackoverflow.com/questions/33782861/error-iso-c-forbids-comparison-between-pointer-and-integer-fpermissive/33782952#33782952", "title": "Error] ISO C++ forbids comparison between pointer and integer [-fpermissive]", "body": "<p>pass is an array (which is implemented in c++ as a pointer) and 86222 is an integer.  you cannot compare those.  </p>\n\n<p>As @haris said in their comment, you really just want to store the input as an integer.  you do this with <code>std::cin &gt;&gt; pass</code>.  then you can compare <code>pass</code> with your stored value.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5577097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20209d831118f6908d72a5b8529dbbf8?s=128&d=identicon&r=PG&f=1", "display_name": "hdlsswrrr", "link": "https://stackoverflow.com/users/5577097/hdlsswrrr"}, "edited": false, "score": 0, "creation_date": 1447858537, "post_id": 33783183, "comment_id": 55333156, "body": "We need to hide the pin code with # or something like entering a password. @Haris"}, {"owner": {"reputation": 1, "user_id": 5577097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20209d831118f6908d72a5b8529dbbf8?s=128&d=identicon&r=PG&f=1", "display_name": "hdlsswrrr", "link": "https://stackoverflow.com/users/5577097/hdlsswrrr"}, "edited": false, "score": 0, "creation_date": 1447859676, "post_id": 33783183, "comment_id": 55334016, "body": "It says [Error] cannot convert &#39;int*&#39; to &#39;const char*&#39; for argument &#39;1&#39; to &#39;int strcmp(const char*, const char*)&#39;"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 1, "user_id": 5577097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20209d831118f6908d72a5b8529dbbf8?s=128&d=identicon&r=PG&f=1", "display_name": "hdlsswrrr", "link": "https://stackoverflow.com/users/5577097/hdlsswrrr"}, "edited": false, "score": 0, "creation_date": 1447862166, "post_id": 33783183, "comment_id": 55335988, "body": "@hdlsswrrr, Sorry, mistake.. it should be <code>char pass[5]</code>"}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 1, "last_activity_date": 1447862145, "last_edit_date": 1447862145, "creation_date": 1447858310, "answer_id": 33783183, "question_id": 33782861, "link": "https://stackoverflow.com/questions/33782861/error-iso-c-forbids-comparison-between-pointer-and-integer-fpermissive/33783183#33783183", "title": "Error] ISO C++ forbids comparison between pointer and integer [-fpermissive]", "body": "<p>You are doing things in a very strange way. If you wanna compare <code>int</code>s. Take and <code>int</code>, read it and compare, Why is the <code>array</code> needed?</p>\n\n<p>The best and simple way to do this is to use only <code>int</code>s.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\nusing namespace std;\nmain()\n{\n    int pass;\n    cout&lt;&lt;\"\\nEnter pin code: \";\n    cin&gt;&gt;pass;\n\n    if(pass==86222)\n        cout&lt;&lt;\"\\nW E L C O M E!\";\n    else\n        cout&lt;&lt;\"\\nIncorrect Pin Code\";\n    getch();\n}\n</code></pre>\n\n<hr>\n\n<p>If you want to do it the way you want, then use <code>strcmp()</code></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\nusing namespace std;\nchar pass[5];\nint x;\nmain()\n{\n    cout&lt;&lt;\"\\nEnter pin code: \";\n    for(x=0;x&lt;=4;x++)\n    {\n        pass[x]=getch();\n        putch('#');\n    }   \n    if(!strcmp(pass, \"86222\"))\n        cout&lt;&lt;\"\\nW E L C O M E!\";\n    else\n        cout&lt;&lt;\"\\nIncorrect Pin Code\";\n    getch();\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5577097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20209d831118f6908d72a5b8529dbbf8?s=128&d=identicon&r=PG&f=1", "display_name": "hdlsswrrr", "link": "https://stackoverflow.com/users/5577097/hdlsswrrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1447862145, "creation_date": 1447857492, "last_edit_date": 1447857585, "question_id": 33782861, "link": "https://stackoverflow.com/questions/33782861/error-iso-c-forbids-comparison-between-pointer-and-integer-fpermissive", "title": "Error] ISO C++ forbids comparison between pointer and integer [-fpermissive]", "body": "<p>I'm a beginner in c++ programming and I have this activity in school. I keep getting [Error] ISO C++ forbids comparison between pointer and integer [-fpermissive] in line 15. How do you solve this? Thanks!</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\nusing namespace std;\nint pass[5];\nint x;\nmain()\n{\n    cout&lt;&lt;\"\\nEnter pin code: \";\n    for(x=0;x&lt;=4;x++)\n    {\n        pass[x]=getch();\n        putch('#');\n    }   \n    if(pass==86222)\n        cout&lt;&lt;\"\\nW E L C O M E!\";\n    else\n        cout&lt;&lt;\"\\nIncorrect Pin Code\";\n    getch();\n}\n</code></pre>\n"}, {"tags": ["c", "xml", "tree", "libxml2"], "comments": [{"owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1447858672, "post_id": 33782703, "comment_id": 55333251, "body": "why not just use <code>childNode = childNode-&gt;next;</code>?"}, {"owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1447858808, "post_id": 33782703, "comment_id": 55333349, "body": "have you checked the <code>else</code>-part to <code>if (type)</code>? maybe you run a path you did not expect."}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "reply_to_user": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1447859231, "post_id": 33782703, "comment_id": 55333659, "body": "@PeterMiehle I started out using <code>childNode-&gt;next</code> and that showed the same results. The <code>else</code> condition is actually never hit, its there &quot;just in case&quot;"}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "reply_to_user": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1447859554, "post_id": 33782703, "comment_id": 55333922, "body": "@PeterMiehle It basically acts like my child tree under <code>Device</code> looks like this: <code>ID-&gt;VAL1-&gt;VAL2-&gt;VAL3-&gt;VAL4-&gt;VAL5-&gt;VAL6-&gt;VAL3-&gt;VAL4-&gt;VAL5-&gt;VA&zwnj;&#8203;L6-&gt;NULL</code>"}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "reply_to_user": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1447860040, "post_id": 33782703, "comment_id": 55334308, "body": "Perhaps I just need to rethink this and use XPath to check for a tag within the <code>Device</code> element rather than loop through"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1447874471, "post_id": 33782703, "comment_id": 55343988, "body": "This should work. I would either use <code>childNode = childNode-&gt;next</code> <i>or</i> keep <code>xmlNextElementSibling()</code> but use <code>xmlFirstElementChild()</code> to get the first child (in which case you can dispense with checking the node type). Can you post a simple self-contained example (compilable) which illustrates the problem?"}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "edited": false, "score": 0, "creation_date": 1447878202, "post_id": 33782703, "comment_id": 55346332, "body": "I found the issue. I screwed up my XML files and was trying to parse a test file that I added extra entries into. Yikes. Apologies."}], "owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447859834, "creation_date": 1447857073, "last_edit_date": 1447859834, "question_id": 33782703, "link": "https://stackoverflow.com/questions/33782703/strange-tree-traversing-behavior-in-libxml2-using-c", "title": "Strange tree traversing behavior in LibXml2 using C", "body": "<p>I have an XML file with devices in it structured as such:</p>\n\n<pre><code>&lt;Device&gt;\n   &lt;ID&gt;&lt;/ID&gt;\n   &lt;VAL1&gt;&lt;/VAL1&gt;\n   &lt;VAL2&gt;&lt;/VAL2&gt;\n   &lt;VAL3&gt;&lt;/VAL3&gt;\n   &lt;VAL4&gt;&lt;/VAL4&gt;\n   &lt;VAL5&gt;&lt;/VAL5&gt;\n   &lt;VAL6&gt;&lt;/VAL6&gt;\n&lt;/Device&gt;\n</code></pre>\n\n<p>My function is meant to find the first <code>&lt;Device&gt;</code> element, and loop through the children elements of the Device and assure that no unexpected tags exist. </p>\n\n<blockquote>\n  <p>NOTE: This function opens the XML file using the XML_PARSE_NOBLANKS\n  option, and curNode is only examined if it is an XML_ELEMENT_NODE</p>\n</blockquote>\n\n<pre><code>// If current node is opening Device tag for a device\nif (xmlStrcmp(curNode-&gt;name, (const xmlChar*)\"Device\") == 0)\n{\n   // Loop through child nodes and assure that they match\n   // a valid tag and have no other children tag elements\n   childNode = curNode-&gt;children;\n\n   while (childNode != NULL)\n   {\n      if (childNode-&gt;type == XML_ELEMENT_NODE)\n      {\n         for (nIdx = 0; nIdx &lt; 7; nIdx++)\n         {\n            if (xmlStrcmp(childNode-&gt;name, \n                         (const xmlChar*)acXmlChildTags[nIdx]) == 0)\n            {\n               bChildFound = TRUE;\n               break;\n            }\n         }\n         if (bChildFound != TRUE)\n         {\n            nReturnValue = FAILURE;\n            break;\n         }\n      }\n      childNode = xmlNextElementSibling(childNode);\n   }\n}\n</code></pre>\n\n<p><code>acXmlChildTags</code> is an array of <code>char*</code> equal to the tag strings (\"ID\", \"VAL1\" etc)</p>\n\n<p>Aside from any issues in the overall logic here, because parts of the function are excluded, what I'm noticing is my function correctly reaches the \"VAL6\" element inside of the \"Device\", but when I go to the next element it jumps back up \"VAL3\", then continues back down to \"VAL6\" and then finally reaches the NULL next element to break out of the loop.</p>\n\n<p>Can anyone explain to me why going to the next element sibling of the last child element of \"Device\" is pushing me back into the 3rd child element? </p>\n\n<p>I apologize in advance for the convoluted question.</p>\n"}, {"tags": ["c", "arrays"], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": true, "score": 3, "last_activity_date": 1447857201, "creation_date": 1447857201, "answer_id": 33782743, "question_id": 33782702, "link": "https://stackoverflow.com/questions/33782702/sort-array-through-scanf/33782743#33782743", "title": "Sort Array through scanf", "body": "<p>Problem is in your swapping.</p>\n\n<pre><code>if(tal[j] &lt; tal[i]){\n        temp = tal[j];      //put tal[j] in temp\n        tal[i] = tal[j];    // put tal[j] in tal[i], (tal[i] value lost)\n        tal[j] = temp;      // put temp in tal[j], \n    }\n</code></pre>\n\n<p>It should be,</p>\n\n<pre><code>if(tal[j] &lt; tal[i]){\n        temp = tal[j];\n        tal[j] = tal[i];\n        tal[i] = temp;\n    }\n</code></pre>\n"}], "owner": {"reputation": 3686, "user_id": 2902996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/zogMf.png?s=128&g=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/2902996/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 33782743, "answer_count": 1, "score": 1, "last_activity_date": 1447857638, "creation_date": 1447857072, "last_edit_date": 1447857638, "question_id": 33782702, "link": "https://stackoverflow.com/questions/33782702/sort-array-through-scanf", "title": "Sort Array through scanf", "body": "<p>so I've managed to sort my array-values through hard-coding them in.\nbut every now and then i want to manually add new values through scanf.\nFor some reason it doesn't work.\nhere's the code:</p>\n\n<pre><code>int main(void) {\n   int tal[5];\n   int temp, i, j;\n   for(i=0;i&lt;5;i++) {\n      scanf(\"%d\",&amp;tal[i]);\n    }\n   for(i=0;i&lt;5;i++){\n      for(j=0;j&lt;5;j++){\n         if(tal[j] &lt; tal[i]){\n            temp = tal[j];\n            tal[i] = tal[j];\n            tal[j] = temp;\n         }\n      }   \n   }\n   for(i=0;i&lt;5;i++) {\n      printf(\"%d\\n\",tal[i]);\n   }\n   return 0;\n}\n</code></pre>\n\n<p>eg. Input: <code>3 6 5 7 8</code>\nOutput: <code>3 3 3 3 3</code></p>\n\n<p>Where is my issue?</p>\n"}, {"tags": ["c", "language-lawyer", "c99"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447857951, "post_id": 33782633, "comment_id": 55332719, "body": "In general, you should not expect a compiler to accept <code>if (always_false) { invalid_code; }</code>, since the compiler may not be able to convince itself that <code>always_false</code> is always false. And even if it can, its type checking stage should not depend on this type of analysis."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1447857978, "post_id": 33782633, "comment_id": 55332739, "body": "For an <code>int f()</code> function, the <code>if (0) return (struct s){.d = 3.14};</code> and the final  <code>}</code> with no return value are really 2 separate issues and would have been better as 2 posts.  Thoughtful question anyways."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447951817, "post_id": 33782633, "comment_id": 55384868, "body": "on ubuntu linux 14.04, using gcc, with parameters: <code>-Wall -Wextra -pedantic -std=c99</code>   the compiler outputs two messages: 1) ...4:`0: error incompatibble types when returns type &#39;struct s&#39; but &#39;int&#39; was expected.  2) ...6:1: warning: control reaches end of non-void function [-Wreturn-type]  So there are two major problems with the posted code.  Any modern compiler (and especially if you used a c99 compatible compiler) would have told you the same.   When the compiler says the code is wrong, you can believe it.  &#39;turbo c&#39; is an ancient compiler, good for its&#39; day but not now"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447952440, "post_id": 33782633, "comment_id": 55385324, "body": "The analysis of the c99 standard, as it pertains to the posted code is flawed.  Lets&#39; remember that the posted code is returning a struct, not an double.  in general, cannot assign a struct to a int.  If the code were actually assigning a double to an int, then that part of the posted code would have been valid."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": true, "score": 10, "last_activity_date": 1447857260, "creation_date": 1447857260, "answer_id": 33782767, "question_id": 33782633, "link": "https://stackoverflow.com/questions/33782633/defining-a-function-returning-incompatible-type-but-unreachable/33782767#33782767", "title": "Defining a function returning incompatible type, but unreachable", "body": "<p>\"If the expression has a type different from the return type of the function in which it appears, the value is converted as if by assignment to an object having the return type of the function.\" is a standalone sentence. It is not conditional on \"If a return statement with an expression is executed\" so applies even to your code. And I'm pretty sure you already know that conversion as if by assignment means that incompatible types allow for a compile-time error.</p>\n"}], "owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1011, "favorite_count": 0, "accepted_answer_id": 33782767, "answer_count": 1, "score": 2, "last_activity_date": 1447857260, "creation_date": 1447856895, "last_edit_date": 1592644375, "question_id": 33782633, "link": "https://stackoverflow.com/questions/33782633/defining-a-function-returning-incompatible-type-but-unreachable", "title": "Defining a function returning incompatible type, but unreachable", "body": "<p>After reading through the C99 standard, I could not find any sections which would forbid defining function <code>f</code> below:</p>\n<pre><code>struct s { double d; };\n\nint f() {\n  if (0) return (struct s){.d = 3.14};\n  // There is intentionally no return statement of type int, which is valid\n}\n\nint main() {\n  f();\n  return 0;\n}\n</code></pre>\n<p>In particular, this program's behavior should be defined, since the return value is (a) never reached in the first place and (b) never used, even if it were reached.</p>\n<p>Still, most of my compilers (GCC, Clang and CompCert) prevent this program from being compiled, with error <code>returning 'struct s' from a function with incompatible result type 'int'</code>. I did manage to compile it with <code>tcc</code>, but I don't know if it's mostly due to luck (i.e. lack of verifications).</p>\n<p>Could someone please confirm if this program is syntactically C99 valid, and also that its behavior is completely well-defined, or otherwise indicate where the standard forbids it?</p>\n<p>I actually prefer that my compilers reject it, but for instance some macro definitions could produce code similar to this one, so it could be actually useful to accept such programs if they are valid.</p>\n<p><strong>Background</strong></p>\n<p>Below are the possibly relevant excerpts of the C99 standard that I could find, along with my reasoning on why they should not forbid my program from being syntactically valid and semantically well-defined:</p>\n<blockquote>\n<p><strong>\u00a76.8.6.4</strong> The return statement</p>\n<p><strong>\u00a76.8.6.4.1</strong> A return statement with an expression shall not appear in a function whose return type is void. A return statement without an expression shall only appear in a function whose return type is void.</p>\n</blockquote>\n<p>In my code, we have a non-<code>void</code> function with a non-<code>void</code> return, so everything seems fine.</p>\n<blockquote>\n<p><strong>\u00a76.8.6.4.3</strong> If a return statement with an expression is executed, the value of the expression is returned to the caller as the value of the function call expression. If the expression has a type different from the return type of the function in which it appears, the value is converted as if by assignment to an object having the return type of the function.</p>\n</blockquote>\n<p>Because the return statement is never executed, the above does not apply.</p>\n<blockquote>\n<p><strong>\u00a76.9.1</strong> Function definitions</p>\n<p><strong>\u00a76.9.1.12</strong> If the } that terminates a function is reached, and the value of the function call is used by the caller, the behavior is undefined.</p>\n</blockquote>\n<p>The result of the function call is not used by the caller, so the behavior should be defined.</p>\n"}, {"tags": ["c++", "c", "arrays", "pointers", "g++"], "comments": [{"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "edited": false, "score": 0, "creation_date": 1447857252, "post_id": 33782518, "comment_id": 55332118, "body": "What later dereference?"}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "reply_to_user": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "edited": false, "score": 0, "creation_date": 1447857349, "post_id": 33782518, "comment_id": 55332204, "body": "@ecatmur Updated the question with an example"}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1447857826, "post_id": 33782518, "comment_id": 55332594, "body": "@user2079303 I think that question in your link is taking about incomplete array type but not about conversion from complete to incomplete type, especially the difference between <code>c</code> and <code>c++</code> in this regard."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1447858048, "post_id": 33782518, "comment_id": 55332806, "body": "@Yeah, it seems to not be very relevant after all."}], "answers": [{"comments": [{"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1447902670, "post_id": 33785920, "comment_id": 55355781, "body": "Why is it unsafe, as opposed to merely not allowed? (Also, I offer parameters of incomplete array type as counter-example.)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1447925474, "post_id": 33785920, "comment_id": 55365640, "body": "@AlanStokes: It is unsafe, and that&#39;s why it&#39;s not allowed. And could you show me an example of one of these &quot;parameters of incomplete array type&quot;?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1447949745, "post_id": 33785920, "comment_id": 55383339, "body": "@AlanStokes: That is not an incomplete array type. It is silently translated to <code>int* p</code> at the parse stage, an oddity inherited from C. Look up &quot;array name decay&quot;."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1447865812, "creation_date": 1447865812, "answer_id": 33785920, "question_id": 33782518, "link": "https://stackoverflow.com/questions/33782518/difference-in-incomplete-array-pointer-conversion-rules-between-c-and-c/33785920#33785920", "title": "Difference in incomplete array pointer conversion rules between C and C++", "body": "<p>Yes, this assignment does is really type-unsafe.</p>\n\n<p>In C++, array types include the dimension. Always.</p>\n\n<p>(Mostly.)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": true, "score": 1, "last_activity_date": 1454776080, "last_edit_date": 1454776080, "creation_date": 1454775540, "answer_id": 35243273, "question_id": 33782518, "link": "https://stackoverflow.com/questions/33782518/difference-in-incomplete-array-pointer-conversion-rules-between-c-and-c/35243273#35243273", "title": "Difference in incomplete array pointer conversion rules between C and C++", "body": "<p>The conversion by itself is safe, but keep in mind that the same rule in C that allows this conversion also allows it in the opposite direction.</p>\n\n<pre><code>int main() {\n  int array[4] = {0};\n  int (*ptr4)[4] = &amp;array;\n  int (*ptrN)[]  = ptr4;\n  int (*ptr5)[5] = ptrN; /* oh dear */\n}\n</code></pre>\n\n<p>This is clearly bad. C++ has removed this rule, the rule that says <code>int[4]</code> and <code>int[]</code> are compatible types, and pretty much got rid of the concept of compatible type.</p>\n\n<p>Some specific conversions that are safe <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4325.html#118\" rel=\"nofollow\">are being considered for inclusion in a future version of C++</a>. They include your conversion as well.</p>\n"}], "owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 35243273, "answer_count": 2, "score": 5, "last_activity_date": 1454776080, "creation_date": 1447856573, "last_edit_date": 1495540347, "question_id": 33782518, "link": "https://stackoverflow.com/questions/33782518/difference-in-incomplete-array-pointer-conversion-rules-between-c-and-c", "title": "Difference in incomplete array pointer conversion rules between C and C++", "body": "<p>When I compile the following code with <code>gcc</code> and <code>g++</code>, <code>g++</code> gives error and not <code>gcc</code>. Note that the code converts from <code>int (*)[4]</code> to <code>int (*)[]</code> (which is pointer to incomplete array type).</p>\n\n<pre><code>int arr[4];\nint (*p_arr)[] = &amp;arr;\n</code></pre>\n\n<p>As discussed in <a href=\"https://stackoverflow.com/questions/33777054/incomplete-array-type\">Incomplete array type?</a>, <code>C</code> language allows this conversion. But why does <code>C++</code> disallow this and gives the error <code>error: cannot convert \u2018int (*)[4]\u2019 to \u2018int (*)[]\u2019 in assignment</code>. I know C++ is more type-safe than C, but does this assignment is really type-unsafe, because the later dereference of the pointer (e.g. <code>sizeof(*p_arr)</code>) anyway gives error in <code>C</code> as well?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1447856356, "post_id": 33782414, "comment_id": 55331427, "body": "Yo don&#39;t have a tag on the union, but a <code>typedef</code>. Btw: Is that C or C++? Pick one! Semantics are different here."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1447856415, "post_id": 33782414, "comment_id": 55331485, "body": "And: <code>return</code> is not a function, but a statement. You should not add parenthesis here."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1447856461, "post_id": 33782414, "comment_id": 55331516, "body": "<code>union DISCRETE_FLAGS_REG_TYPE DiscreteFlagsReg</code> \u2013 you probably wanted <code>DISCRETE_FLAGS_REG_TYPE DiscreteFlagsReg</code> instead."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1447857227, "post_id": 33782414, "comment_id": 55332096, "body": "Wonder why this was down voted?  Honest effort, good presentation, clearly presented question."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5576534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a7e86e00403d6a94fd430cc1528761?s=128&d=identicon&r=PG&f=1", "display_name": "LWein", "link": "https://stackoverflow.com/users/5576534/lwein"}, "edited": false, "score": 0, "creation_date": 1448443946, "post_id": 33782480, "comment_id": 55587466, "body": "Thanks. I&#39;ve fixed the definition and now it&#39;s ok."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 3, "last_activity_date": 1447856451, "creation_date": 1447856451, "answer_id": 33782480, "question_id": 33782414, "link": "https://stackoverflow.com/questions/33782414/compiler-error-invalid-use-of-undefined-type-union-what-is-wrong-in-the/33782480#33782480", "title": "compiler error: invalid use of undefined type &#39;union ...&#39; . What is wrong in the definition?", "body": "<p>The union itself has no name; \"DISCRETE_FLAGS_REG_TYPE\" is a typedef name.</p>\n\n<p>You can use the typedef name:</p>\n\n<pre><code>extern volatile DISCRETE_FLAGS_REG_TYPE DiscreteFlagsReg;\n</code></pre>\n\n<p>or name the union:</p>\n\n<pre><code>union DISCRETE_FLAGS_REG_TYPE\n{\n   /* ... */\n};\n</code></pre>\n\n<p>and use <code>union DISCRETE_FLAGS_REG_TYPE</code> in C, or <code>DISCRETE_FLAGS_REG_TYPE</code> in C++</p>\n\n<p>or, in C, combine the naming and the typedef:</p>\n\n<pre><code>typedef union DISCRETE_FLAGS_REG_TYPE\n{\n   /* ... */\n} DISCRETE_FLAGS_REG_TYPE;\n</code></pre>\n\n<p>(The last variant is an error in C++.)</p>\n"}], "owner": {"reputation": 11, "user_id": 5576534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a7e86e00403d6a94fd430cc1528761?s=128&d=identicon&r=PG&f=1", "display_name": "LWein", "link": "https://stackoverflow.com/users/5576534/lwein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447856796, "creation_date": 1447856261, "last_edit_date": 1447856796, "question_id": 33782414, "link": "https://stackoverflow.com/questions/33782414/compiler-error-invalid-use-of-undefined-type-union-what-is-wrong-in-the", "title": "compiler error: invalid use of undefined type &#39;union ...&#39; . What is wrong in the definition?", "body": "<p>My code is organized as following:</p>\n\n<p><strong>File: main.c</strong></p>\n\n<pre><code> #include \"init.h\"\n #include \"SpiComm.h\"\n //. . . . \n</code></pre>\n\n<p><strong>File:  init.h</strong></p>\n\n<pre><code>typedef union {\n\n    unsigned int wholeReg;\n\n    struct   {\n        unsigned CMD1_flag: 1; \n            . . . .\n\n    };\n\n}  DISCRETE_FLAGS_REG_TYPE;\n\nextern volatile union DISCRETE_FLAGS_REG_TYPE DiscreteFlagsReg; //register declaration\n</code></pre>\n\n<p><strong>File: SpiComm.c</strong></p>\n\n<pre><code>#include \"SpiComm.h\"\n\nvolatile union DISCRETE_FLAGS_REG_TYPE  DiscreteFlagsReg;\n\n\nunsigned char* SpiTxFrameSetup (void)\n{\n            . . . .                \n    SpiTxMsgByte1.dt1CmdFlag = L_DiscreteFlagsReg.regBits.DT1_HW_CMD_flag;\n            . . . . \n    spiTxMsg[4] = SpiTxMsgByte1.byte0Full;\n        . . . . \n    return (spiTxMsg);  //return the pointer to Tx message array;\n}\n</code></pre>\n\n<p>Compiler is notifying this for SpiComm.c file (and for any other .c file that attempts to use any field of this union):</p>\n\n<p>error: invalid use of undefined type 'union DISCRETE_FLAGS_REG_TYPE'</p>\n\n<p>What is wrong? Why other c files doesn't recognize the union type I've defined in init.h?</p>\n"}, {"tags": ["c", "concurrency", "hardware"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1447855582, "post_id": 33782123, "comment_id": 55330781, "body": "Probably it&#39;s just the result of some random benchmark the library creator ran on his machine, to give an idea of the kind of performance to expect from the library."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1447856052, "post_id": 33782123, "comment_id": 55331188, "body": "I am fully with you, the numbers seem a bit senseless. As the tutorial.html says: &quot;Enjoy your time with the library and send any questions you may have to libmill@freelists.org&quot;. You can just do that."}], "answers": [{"comments": [{"owner": {"reputation": 4412, "user_id": 917118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c48da7740ae44ea3120c546d7468dc8?s=128&d=identicon&r=PG", "display_name": "Bent Cardan", "link": "https://stackoverflow.com/users/917118/bent-cardan"}, "edited": false, "score": 1, "creation_date": 1453184553, "post_id": 33782881, "comment_id": 57478287, "body": "yes that&#39;s correct. i ran that benchmark in this PR: <a href=\"https://github.com/sustrik/libmill/pull/39\" rel=\"nofollow noreferrer\">github.com/sustrik/libmill/pull/39</a> and since then i&#39;ve seen better perf"}], "tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": true, "score": 4, "last_activity_date": 1447857541, "creation_date": 1447857541, "answer_id": 33782881, "question_id": 33782123, "link": "https://stackoverflow.com/questions/33782123/why-does-libmill-have-a-limited-number-of-coroutines-and-context-switches-per-se/33782881#33782881", "title": "Why does libmill have a limited number of coroutines and context switches per second?", "body": "<p>This is more boasting and not a serious constraint. What most likely happened is that they ran some sort of benchmark on a machine and are now advertising that fact. Much more akin to </p>\n\n<blockquote>\n  <p>\"Look! We made it so you can even execute 20 million coroutines and 50\n  million context switches per second! Impressive, huh?\"</p>\n</blockquote>\n\n<p>rather than</p>\n\n<blockquote>\n  <p>\"We have this technical limitation that says you can only execute 20\n  million coroutines and 50 million context switches per second.\"</p>\n</blockquote>\n\n<p>That you seem to have read into it :)</p>\n"}], "owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 33782881, "answer_count": 1, "score": 1, "last_activity_date": 1447857541, "creation_date": 1447855472, "question_id": 33782123, "link": "https://stackoverflow.com/questions/33782123/why-does-libmill-have-a-limited-number-of-coroutines-and-context-switches-per-se", "title": "Why does libmill have a limited number of coroutines and context switches per second?", "body": "<p>I'm reading up on <a href=\"http://libmill.org/index.html\" rel=\"nofollow\"><code>libmill</code></a>, and it's written on the landing page that \"It can execute up to 20 million coroutines and 50 million context switches per second.\"</p>\n\n<p>While this is impressive, why even include this number? Wouldn't these numbers vary with the type of hardware the library is being used on? If the limitation is imposed by the library or the language, why would such a limitation exist?</p>\n"}, {"tags": ["c", "compilation", "fortran", "icc", "intel-fortran"], "comments": [{"owner": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "edited": false, "score": 0, "creation_date": 1447856390, "post_id": 33781867, "comment_id": 55331459, "body": "the are introduced wit <code>-static</code>. As far as i understand it i need those to link the c standart lib static to redistribute this programm to useres without the Intel compiler."}, {"owner": {"reputation": 1203, "user_id": 2254721, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a0e169835f62b2858671daefd92fb017?s=128&d=identicon&r=PG", "display_name": "Sagar Masuti", "link": "https://stackoverflow.com/users/2254721/sagar-masuti"}, "edited": false, "score": 0, "creation_date": 1447857217, "post_id": 33781867, "comment_id": 55332082, "body": "Try <code>locate m</code> and see what path it gives. If it finds the library then add that in the <code>-L</code> option of yours. If it doesnt find then you need manually find <code>m</code> and add that."}, {"owner": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "reply_to_user": {"reputation": 1203, "user_id": 2254721, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a0e169835f62b2858671daefd92fb017?s=128&d=identicon&r=PG", "display_name": "Sagar Masuti", "link": "https://stackoverflow.com/users/2254721/sagar-masuti"}, "edited": false, "score": 0, "creation_date": 1447861130, "post_id": 33781867, "comment_id": 55335145, "body": "m seems to be the standart math lib for C. So it is not in my working dir."}, {"owner": {"reputation": 17025, "user_id": 2737715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/600bf8722446680e50fbbb6ecbbe2b44?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vogt", "link": "https://stackoverflow.com/users/2737715/alexander-vogt"}, "edited": false, "score": 1, "creation_date": 1447876311, "post_id": 33781867, "comment_id": 55345141, "body": "Have you run the <code>compilervars.sh</code> script before using <code>ifort</code> and <code>icc</code>?"}, {"owner": {"reputation": 1380, "user_id": 4151327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fsn8K.jpg?s=128&g=1", "display_name": "Anthony Scemama", "link": "https://stackoverflow.com/users/4151327/anthony-scemama"}, "reply_to_user": {"reputation": 1203, "user_id": 2254721, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a0e169835f62b2858671daefd92fb017?s=128&d=identicon&r=PG", "display_name": "Sagar Masuti", "link": "https://stackoverflow.com/users/2254721/sagar-masuti"}, "edited": false, "score": 0, "creation_date": 1447886027, "post_id": 33781867, "comment_id": 55350577, "body": "@Sagar Masuti : <code>locate libm.a</code> corresponds to <code>-lm</code> linked statically and <code>locate libm.so</code> without the static flag."}, {"owner": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "edited": false, "score": 0, "creation_date": 1447922083, "post_id": 33781867, "comment_id": 55363442, "body": "i did <code>compilervars.sh intel64</code>"}, {"owner": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "reply_to_user": {"reputation": 17025, "user_id": 2737715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/600bf8722446680e50fbbb6ecbbe2b44?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vogt", "link": "https://stackoverflow.com/users/2737715/alexander-vogt"}, "edited": false, "score": 0, "creation_date": 1447923470, "post_id": 33781867, "comment_id": 55364262, "body": "@AlexanderVogt apperently not. I didn&#39;t install the compiler. I now run the script and it fixed some parts. Changing <code>static</code> to <code>static-intel</code> does the trick. but i guess there are now still some dependencies to some lib left?"}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "edited": false, "score": 0, "creation_date": 1447923678, "post_id": 33791984, "comment_id": 55364404, "body": "I changed <code>static</code> to <code>static-intel</code> but without <code>-Wl, rpath=.&#47;lib</code> and now it works. But wont i have some dependencies now?"}, {"owner": {"reputation": 1380, "user_id": 4151327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fsn8K.jpg?s=128&g=1", "display_name": "Anthony Scemama", "link": "https://stackoverflow.com/users/4151327/anthony-scemama"}, "reply_to_user": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "edited": false, "score": 0, "creation_date": 1447972459, "post_id": 33791984, "comment_id": 55396966, "body": "@why.n0t : Yes, but you can put the dependencies in the lib directory. The <code>-Wl, rpath=.&#47;lib</code> adds the lib directory to the default path where to search for dynamic libraries."}, {"owner": {"reputation": 1380, "user_id": 4151327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fsn8K.jpg?s=128&g=1", "display_name": "Anthony Scemama", "link": "https://stackoverflow.com/users/4151327/anthony-scemama"}, "reply_to_user": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "edited": false, "score": 0, "creation_date": 1448008330, "post_id": 33791984, "comment_id": 55409596, "body": "@why.n0t : Singularity (<a href=\"http://gmkurtzer.github.io/singularity/\" rel=\"nofollow noreferrer\">gmkurtzer.github.io/singularity</a>) is also a possibility to solve your dependency problems."}], "tags": [], "owner": {"reputation": 1380, "user_id": 4151327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fsn8K.jpg?s=128&g=1", "display_name": "Anthony Scemama", "link": "https://stackoverflow.com/users/4151327/anthony-scemama"}, "is_accepted": true, "score": 3, "last_activity_date": 1447887011, "creation_date": 1447887011, "answer_id": 33791984, "question_id": 33781867, "link": "https://stackoverflow.com/questions/33781867/compile-and-link-fortran-and-c-with-ifort-and-icc/33791984#33791984", "title": "Compile and link Fortran and C with ifort and icc", "body": "<p>The <code>-static</code> flag will link <em>all</em> the libraries statically. In that case you need to have a static version (the <code>.a</code> files) of every library. For example, using <code>-lm</code> will search for <code>libm.a</code>. Those libraries are not installed by default, but may be in the <code>-dev</code> or <code>-devel</code> packages of your distribution.\nIf you only want to link statically the Intel libraries, then you should use <code>-static-intel</code>.</p>\n\n<p>A good trick to avoid static linking is to:</p>\n\n<p>1) Dynamically link your program with <code>-static-intel</code> and <code>-Wl,-rpath=./lib</code></p>\n\n<p>2) Use <code>ldd</code> to find which libraries your program needs</p>\n\n<p>3) Create a directory <code>lib</code> where you copy all the required dynamic libraries</p>\n\n<p>4) Instead of distributing your code as a single static binary you can disrtibute it as a binary + the lib directory (assuming the licenses of the libraries permit it).</p>\n\n<p>Finally, if you need to try more things, I have succeeded to link an Intel Fortran file with gcc using this command:</p>\n\n<pre><code>$ gcc fortran_file.o c_main_file.o -lifcore -lirc -lcomposerxe_gen_helpers_core_2.3\n</code></pre>\n\n<p>hope this helps...</p>\n"}], "owner": {"reputation": 302, "user_id": 2432130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6ffd4cdaeb60c71383c9bdd2eb89d?s=128&d=identicon&r=PG", "display_name": "why.n0t", "link": "https://stackoverflow.com/users/2432130/why-n0t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2045, "favorite_count": 0, "accepted_answer_id": 33791984, "answer_count": 1, "score": 2, "last_activity_date": 1447887011, "creation_date": 1447854821, "last_edit_date": 1447856157, "question_id": 33781867, "link": "https://stackoverflow.com/questions/33781867/compile-and-link-fortran-and-c-with-ifort-and-icc", "title": "Compile and link Fortran and C with ifort and icc", "body": "<p>I'm switching from gcc to Intel ifort and icc. </p>\n\n<p>The Fortran code is mostly legacy, likewise the the rest of the system.</p>\n\n<p>The main program is written in C. It handles the I/O and passes everything to a Fortran subroutine. </p>\n\n<p>For now I compile the Fortran part with:  </p>\n\n<pre><code>cd fortran   \nifort -I../inc -debug full -c *.[fF]\ncd ..\n</code></pre>\n\n<p>For C and linking I tried:</p>\n\n<pre><code>icc  -ansi -static -debug full -Wall -o testout \\\n     -I./inc -L./lib\\\n     main.c \\\n     fortran/*.o  \\\n     -lifcore -limf -lm\\\n</code></pre>\n\n<p>this gives me:</p>\n\n<pre><code>ld: cannot find -lm\nld: cannot find -lm\nld: cannot find -lc\nld: cannot find -ldl\nld: cannot find -lc\n</code></pre>\n\n<p>This is mostly copied from the former bash script to compile with gcc.</p>\n"}, {"tags": ["c", "linux", "io", "posix", "c-standard-library"], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "is_accepted": false, "score": 1, "last_activity_date": 1447855018, "creation_date": 1447855018, "answer_id": 33781949, "question_id": 33781852, "link": "https://stackoverflow.com/questions/33781852/migrate-from-posix-i-o-open-etc-to-c-standard-i-o-fopen-etc/33781949#33781949", "title": "Migrate from POSIX I/O (open, etc.) to C standard I/O (fopen, etc.)", "body": "<p>I would use <code>grep | sort | uniq</code> to find all the cases in the source\ncode, then work out their translations, and write a simple Python script\nto replace.</p>\n"}, {"tags": [], "owner": {"reputation": 9347, "user_id": 2214693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9O4uT.jpg?s=128&g=1", "display_name": "Claudio", "link": "https://stackoverflow.com/users/2214693/claudio"}, "is_accepted": false, "score": 0, "last_activity_date": 1447855963, "creation_date": 1447855963, "answer_id": 33782312, "question_id": 33781852, "link": "https://stackoverflow.com/questions/33781852/migrate-from-posix-i-o-open-etc-to-c-standard-i-o-fopen-etc/33782312#33782312", "title": "Migrate from POSIX I/O (open, etc.) to C standard I/O (fopen, etc.)", "body": "<p>You can write some C macros with parameters (called <code>open()</code>, <code>close()</code> etc.) that expand to the right call. However, it is error prone as well. Therefore, I'd rather rely on some powerful editor (e.g., vim) and regular expressions for changing all occurences. </p>\n"}], "owner": {"reputation": 513, "user_id": 1088224, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/fd5984e1d40b4a32a512925ac146cd52?s=128&d=identicon&r=PG", "display_name": "Sas", "link": "https://stackoverflow.com/users/1088224/sas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1447867721, "creation_date": 1447854785, "last_edit_date": 1447867721, "question_id": 33781852, "link": "https://stackoverflow.com/questions/33781852/migrate-from-posix-i-o-open-etc-to-c-standard-i-o-fopen-etc", "title": "Migrate from POSIX I/O (open, etc.) to C standard I/O (fopen, etc.)", "body": "<p>I'm trying to migrate project written using unbuffered I/O ( <code>open()</code>, <code>read()</code>, <code>write()</code> functions) to buffered I/O ( <code>fopen()</code>, <code>fread()</code>, <code>fwrite()</code> functions).</p>\n\n<p>I came across some dummy problem: Adapting zoo of <code>open()</code> flags to <code>fopen()</code> set <code>r,r+,w,w+,a,a+</code>.</p>\n\n<p>It seems to be boring and error-prone. Is there some other way to do this?</p>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1447854837, "post_id": 33781766, "comment_id": 55330174, "body": "Please edit the question and include input and output as a text (not images)."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1447855073, "post_id": 33781766, "comment_id": 55330373, "body": "You should use strdup to. copy the names."}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 0, "creation_date": 1447855201, "post_id": 33781766, "comment_id": 55330497, "body": "I don&#39;t see any memory beeing allocated for <code>struct data</code>&#39;s <code>name</code> field. Eighter allocate memory or make it a fixed size string in the struct declaration. Also <code>studentnode</code> is already a pointer, don&#39;t take it&#39;s address when you pass it to the <code>add_student</code> function."}, {"owner": {"reputation": 1031, "user_id": 3933895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3eff8d3f5166ea0f7974afbfcdd5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Samidamaru", "link": "https://stackoverflow.com/users/3933895/samidamaru"}, "edited": false, "score": 0, "creation_date": 1447855284, "post_id": 33781766, "comment_id": 55330564, "body": "You can copy and paste 100 lines of code, but not a 13 line output or a 14 line input file?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1447855473, "post_id": 33782054, "comment_id": 55330701, "body": "Nice catch -- also this <code>name</code> field of each student is merely shallow copying data from the stack in <code>readAndLoad</code> (not related to the immediate problem, but definitely another one)."}], "tags": [], "owner": {"reputation": 1858, "user_id": 3699691, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bb27331e7d100014ae30427ff7950a1?s=128&d=identicon&r=PG&f=1", "display_name": "downhillFromHere", "link": "https://stackoverflow.com/users/3699691/downhillfromhere"}, "is_accepted": false, "score": 4, "last_activity_date": 1447855281, "creation_date": 1447855281, "answer_id": 33782054, "question_id": 33781766, "link": "https://stackoverflow.com/questions/33781766/c-passing-char-array-to-function-using-structs/33782054#33782054", "title": "C Passing char array to function using structs", "body": "<pre><code>studentnode = malloc(sizeof(struct student));\n</code></pre>\n\n<p>only allocates memory for an instance of <code>student</code>. The memory for <code>studentnode-&gt;d</code> has not been allocated. Therefore any <code>n-&gt;d-&gt;something</code> in <code>add_student()</code> is invalid, thus invokes undefined behavior.</p>\n"}], "owner": {"reputation": 9, "user_id": 5576650, "user_type": "registered", "profile_image": "https://graph.facebook.com/1099458030079401/picture?type=large", "display_name": "Silvija", "link": "https://stackoverflow.com/users/5576650/silvija"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1447855679, "creation_date": 1447854536, "last_edit_date": 1447855679, "question_id": 33781766, "link": "https://stackoverflow.com/questions/33781766/c-passing-char-array-to-function-using-structs", "title": "C Passing char array to function using structs", "body": "<p>We have a small program where the input comes from a text file (see text sample below) and is used to scan and write certain student information to different struct variables. However, when the <strong>add_student()</strong> function is called it gives this bizzare output (see screenshot below).    </p>\n\n<pre><code>struct student_list sl;\nstruct teacher_list tl;\n\nstruct data {\n char *name;\n int number;\n char index;};\n\nstruct student {\n struct data *d;\n struct student *next;};\n\nstruct student_list{\n int size;\n struct student *front;\n struct student *tail;};\n\nstruct teacher{\n struct data *d;\n struct teacher *next;};\n\nstruct teacher_list{\n int size;\n struct teacher *front;\n struct teacher *tail;};\n\nvoid main()\n{   \n    readAndLoad();\n\n    print_students();\n}\n    void readAndLoad()\n{\n    int c;\n    int i=0;\n    char line[200];\n    int number, semNum;\n    char name[100];\n    char index;\n\n    while ((c=getchar())!=EOF)\n    {\n        if(c != '\\n')\n        {\n            line[i++] = c;\n            line[i] = '\\0';\n            /*printf(\"%c \", c);\n            printf(\"%s \\n\", line);*/\n        }else\n        {\n            //printf(\"\\n\");\n            int j, b; \n            b = 0;\n\n            for (j = 0; j &lt; sizeof(line); j++) \n            {\n                if (line[j] == ' ')\n                ++b;\n            } \n\n            //printf(\"%s \\n\", line);\n\n            if (b == 2)\n            {\n                if (line[0] == 'S')\n                {\n                    sscanf(line, \"S %d %s\", &amp;number, name);\n                    struct student *studentnode;\n\n                    studentnode = malloc(sizeof(struct student));\n                    add_student(&amp;studentnode, number, &amp;name);\n                } else if (line[0] == 'T')\n                {\n                    sscanf(line, \"T %d %s\", &amp;number, name);\n                    struct teacher *teachernode;\n\n                    teachernode = malloc(sizeof(struct teacher));\n                    add_teacher(&amp;teachernode, number, &amp;name);\n                }\n            }\n\n            memset(&amp;line[0], 0, sizeof(line));\n            i=0;\n        }\n    }\n    //printf(line);\n}\n\nvoid add_student(struct student *n, int student_number, char *student_name)\n{\n//---------------------------------------------------\n    printf(\"%s\\n\", student_name);\n    n-&gt;d-&gt;name = student_name;\n    n-&gt;d-&gt;number = student_number;\n    n-&gt;d-&gt;index = 'S';\n    n-&gt;next = 0;\n    printf(\"%s\\n\", n-&gt;d-&gt;name);\n//---------------------------------------------------\n    if (sl.size == 0)\n    {\n        sl.front = n;\n        sl.tail = n;\n        printf(\"%s %d \\n\", n-&gt;d-&gt;name, n-&gt;d-&gt;number);\n    } else\n    {\n        sl.tail-&gt;next = n;\n        sl.tail = n;\n        printf(\"%s %d \\n\", n-&gt;d-&gt;name, n-&gt;d-&gt;number);\n    }\n\n    sl.size++;\n    printf(\"Student added\\n\");\n}\n\nvoid add_teacher(struct teacher *n, int number, char *name)\n{\n    n-&gt;d-&gt;name = name;\n    n-&gt;d-&gt;number = number;\n    n-&gt;d-&gt;index = 'T';\n    n-&gt;next = 0;\n\n    if (tl.size == 0)\n    {\n        tl.front = n;\n        tl.tail = n;\n    } else\n    {\n        tl.tail-&gt;next = n;\n        tl.tail = n;\n    }\n\n    tl.size++;\n    printf(\"Teacher added\\n\");\n}\nvoid print_students()\n{\n    int i;\n    struct student *s = sl.front;\n\n    for (i = 0; i &lt; sl.size; i++)\n    //while (s-&gt;next != 0)\n    {\n        if (i == (sl.size - 2))\n        {\n            printf(\"%c %s %d\", s-&gt;d-&gt;index, s-&gt;d-&gt;name, s-&gt;d-&gt;number);\n        } else\n        {\n            printf(\"%c %s %d \\n\", s-&gt;d-&gt;index, s-&gt;d-&gt;name, s-&gt;d-&gt;number);\n\n            s = s-&gt;next;\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/UWvdA.png\" rel=\"nofollow\">Input text file sample</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/EJQSw.png\" rel=\"nofollow\">here is the output</a></p>\n\n<p>Between the highlighted part //------------------- \nin the code we can see a correct output of the name from the first printf() but when we go to the second printf() it only prints the blank space... Do you know what could be the problem?</p>\n\n<p><strong>Input text file:</strong></p>\n\n<pre><code>S 123456 Ivan\nS 654321 Georgi\nT 123456 Jesper\nT 123457 Ole\nT 123458 Lars\nT 123459 Erland\nC 31 CALI1 3\nC 11 WDDI1 1\nC 21 SDJI2 2\nE 123456 31\nE 123456 11\nE 654321 21\nA 123456 31\nA 123457 11\n</code></pre>\n\n<p><strong>Console output:</strong></p>\n\n<pre><code>Ivan\n\n 123456\nStudent added\nGeorgi\n\n,\u2592( 654321\nStudent added\nTeacher added\nTeacher added\nTeacher added\nTeacher added\nE 0\u2592( 2673448E 0\u2592( 2673448\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 2158, "user_id": 5275867, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TwbOc.jpg?s=128&g=1", "display_name": "Alexandre Beaudet", "link": "https://stackoverflow.com/users/5275867/alexandre-beaudet"}, "edited": false, "score": 2, "creation_date": 1447854419, "post_id": 33781720, "comment_id": 55329839, "body": "What have you achieved so far ?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447854481, "post_id": 33781720, "comment_id": 55329892, "body": "I&#39;m voting to close this question as off-topic because clearly a write my code request, not a question."}, {"owner": {"reputation": 95, "user_id": 3968248, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd22eee78bd3b1119c02d56d1fab38e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jullix993", "link": "https://stackoverflow.com/users/3968248/jullix993"}, "edited": false, "score": 0, "creation_date": 1447854482, "post_id": 33781720, "comment_id": 55329893, "body": "I have made a menu, and questions in a file. I just need a way to make the struct variables."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1447854503, "post_id": 33781720, "comment_id": 55329905, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first. :)"}, {"owner": {"reputation": 95, "user_id": 3968248, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd22eee78bd3b1119c02d56d1fab38e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jullix993", "link": "https://stackoverflow.com/users/3968248/jullix993"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447854569, "post_id": 33781720, "comment_id": 55329960, "body": "@SouravGhosh Um, no I just can&#39;t figure out how to get the values in the struct variable."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1447854933, "post_id": 33781720, "comment_id": 55330266, "body": "Assuming that the answers can be any kind of string, you need to use strings for those too."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 3968248, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd22eee78bd3b1119c02d56d1fab38e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jullix993", "link": "https://stackoverflow.com/users/3968248/jullix993"}, "edited": false, "score": 0, "creation_date": 1447854807, "post_id": 33781803, "comment_id": 55330147, "body": "Thanks, I need to get them from a file though. I think I should make a loop  and use fscanf(file, &quot;%s%d%d%d&quot;, Questions.question, Questions.answer1 and so forth"}, {"owner": {"reputation": 2158, "user_id": 5275867, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TwbOc.jpg?s=128&g=1", "display_name": "Alexandre Beaudet", "link": "https://stackoverflow.com/users/5275867/alexandre-beaudet"}, "reply_to_user": {"reputation": 95, "user_id": 3968248, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd22eee78bd3b1119c02d56d1fab38e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jullix993", "link": "https://stackoverflow.com/users/3968248/jullix993"}, "edited": false, "score": 0, "creation_date": 1447854955, "post_id": 33781803, "comment_id": 55330285, "body": "@Jullix993 Well, the thing is that answering to everything would be like writing a full tutorial... Just try to google with the keywords your giving here : first learn to make and use structs; then learn how files work in C, and maybe some pointers"}, {"owner": {"reputation": 2158, "user_id": 5275867, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TwbOc.jpg?s=128&g=1", "display_name": "Alexandre Beaudet", "link": "https://stackoverflow.com/users/5275867/alexandre-beaudet"}, "reply_to_user": {"reputation": 95, "user_id": 3968248, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd22eee78bd3b1119c02d56d1fab38e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jullix993", "link": "https://stackoverflow.com/users/3968248/jullix993"}, "edited": false, "score": 0, "creation_date": 1447855019, "post_id": 33781803, "comment_id": 55330330, "body": "@Jullix993 <a href=\"http://stackoverflow.com/questions/11280523/c-reading-from-file-into-structure\" title=\"c reading from file into structure\">stackoverflow.com/questions/11280523/&hellip;</a> here you go :)"}], "tags": [], "owner": {"reputation": 2158, "user_id": 5275867, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TwbOc.jpg?s=128&g=1", "display_name": "Alexandre Beaudet", "link": "https://stackoverflow.com/users/5275867/alexandre-beaudet"}, "is_accepted": false, "score": 0, "last_activity_date": 1447855077, "last_edit_date": 1495542190, "creation_date": 1447854644, "answer_id": 33781803, "question_id": 33781720, "link": "https://stackoverflow.com/questions/33781720/making-a-quiz-game-in-c/33781803#33781803", "title": "Making a quiz game in C", "body": "<pre><code>struct Books {\n   char  title[50];\n   char  author[50];\n   char  subject[100];\n   int   book_id;\n} book;  \n</code></pre>\n\n<hr>\n\n<pre><code>   struct Books Book1;        /* Declare Book1 of type Book */\n   struct Books Book2;        /* Declare Book2 of type Book */\n\n   /* book 1 specification */\n   strcpy( Book1.title, \"C Programming\");\n   strcpy( Book1.author, \"Nuha Ali\"); \n   strcpy( Book1.subject, \"C Programming Tutorial\");\n   Book1.book_id = 6495407;\n\n   /* book 2 specification */\n   strcpy( Book2.title, \"Telecom Billing\");\n   strcpy( Book2.author, \"Zara Ali\");\n   strcpy( Book2.subject, \"Telecom Billing Tutorial\");\n   Book2.book_id = 6495700;\n</code></pre>\n\n<p>You first define your struct (like here, at the top),</p>\n\n<p>Then you can use the members as if it was a variable. Kinda like an object</p>\n\n<p>Some ressources :<a href=\"http://www.tutorialspoint.com/cprogramming/c_structures.htm\" rel=\"nofollow noreferrer\">http://www.tutorialspoint.com/cprogramming/c_structures.htm</a></p>\n\n<p>And for some real code :<a href=\"https://stackoverflow.com/questions/11280523/c-reading-from-file-into-structure\">C, reading from file into structure</a></p>\n"}], "owner": {"reputation": 95, "user_id": 3968248, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd22eee78bd3b1119c02d56d1fab38e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jullix993", "link": "https://stackoverflow.com/users/3968248/jullix993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1096, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447855942, "creation_date": 1447854368, "last_edit_date": 1447855942, "question_id": 33781720, "link": "https://stackoverflow.com/questions/33781720/making-a-quiz-game-in-c", "title": "Making a quiz game in C", "body": "<p>I'm trying to make a quizgame in C, I have a file with question and answers formatted like this: </p>\n\n<p>Edinburgh is in which country?;Scotland; Ireland; England;</p>\n\n<p>Each line in the file has a question and three answers, the first answer in the file is always correct. \nI need to use a struct like this: </p>\n\n<pre><code>typedef struct{\nint answer1;\nint answer2;\nint answer3;\nchar*question;\n}Questions;\n</code></pre>\n\n<p>I need to get them from a file so I think I should make a loop and something like:</p>\n\n<pre><code>Questions q;\nfor(int i = 0; i &lt; fileLength; i++){\n fscanf(file, \"%s%d%d%d\", &amp;q.question, &amp;q.answer1,&amp;q.answer2, &amp;q.answer3);\n}\n</code></pre>\n\n<p>So I need to loop through the file and make a struct variable for each question and give it the values, and then place it in an array. My teacher told me to use a multi dimensional array, and also pointers. How can I accomplish this in the best way? Thanks in advance.</p>\n"}, {"tags": ["c", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 0, "creation_date": 1447854738, "post_id": 33781596, "comment_id": 55330085, "body": "More information about the structure of <code>datacontainer</code> and <code>dataList</code> would help, as well as knowing where <code>datadata</code> comes from."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447854935, "post_id": 33781596, "comment_id": 55330267, "body": "Have you <i>verified</i> that the data structure is valid before calling <code>delete</code>?"}, {"owner": {"reputation": 1, "user_id": 4405509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87cadab664e08f6ae28bf266ea06060?s=128&d=identicon&r=PG&f=1", "display_name": "Stewie Guya", "link": "https://stackoverflow.com/users/4405509/stewie-guya"}, "edited": false, "score": 0, "creation_date": 1447855032, "post_id": 33781596, "comment_id": 55330344, "body": "<code>dataList</code> is a struct with <code>char**</code> attributes and values. As well as, pointers prev and next. <code>dataContainer</code> and <code>datadata</code> are global variables of the type <code>dataList</code>."}, {"owner": {"reputation": 1, "user_id": 4405509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87cadab664e08f6ae28bf266ea06060?s=128&d=identicon&r=PG&f=1", "display_name": "Stewie Guya", "link": "https://stackoverflow.com/users/4405509/stewie-guya"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447855080, "post_id": 33781596, "comment_id": 55330383, "body": "@KarolyHorvath Yes. I tried printing the whole list with no errors on its contents."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447855134, "post_id": 33781596, "comment_id": 55330433, "body": "Is <code>attr_count</code> going to be valid for all the nodes? Is accesing <code>values[attr_count]</code> valid?"}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447855313, "post_id": 33781596, "comment_id": 55330585, "body": "There are so many questions without knowing the context. Produce an MCVE."}, {"owner": {"reputation": 1, "user_id": 4405509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87cadab664e08f6ae28bf266ea06060?s=128&d=identicon&r=PG&f=1", "display_name": "Stewie Guya", "link": "https://stackoverflow.com/users/4405509/stewie-guya"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447855885, "post_id": 33781596, "comment_id": 55331037, "body": "@KarolyHorvath Basically I have this linked list with 2 array of strings with the same number of elements. <code>attr_count</code> is the number of elements, so <code>values[attr_count]</code> may not be valid."}, {"owner": {"reputation": 1, "user_id": 4405509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87cadab664e08f6ae28bf266ea06060?s=128&d=identicon&r=PG&f=1", "display_name": "Stewie Guya", "link": "https://stackoverflow.com/users/4405509/stewie-guya"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447856015, "post_id": 33781596, "comment_id": 55331144, "body": "@KarolyHorvath The function checks which node in the list contains the <code>value</code> corresponding to the <code>attribute</code>, then deletes those nodes. It works  when the nodes found are not the first one, but if the first one matches, it produces segfault on the second call."}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "edited": false, "score": 0, "creation_date": 1447857679, "post_id": 33781596, "comment_id": 55332465, "body": "@StewieGuya: can you provide definition of <code>dataContainer</code>? it is more easier to help you when you show your structure."}], "answers": [{"tags": [], "owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "is_accepted": false, "score": -1, "last_activity_date": 1450720087, "last_edit_date": 1450720087, "creation_date": 1447858195, "answer_id": 33783142, "question_id": 33781596, "link": "https://stackoverflow.com/questions/33781596/segmentation-fault-on-second-call-when-deleting-first-node/33783142#33783142", "title": "Segmentation fault on second call when deleting first node", "body": "<p>You can see my explanation in comments:</p>\n\n<p>On second call datadata point on anything because tmp is freed on delete tmp you should update datadata like this datadata = tmp->next</p>\n\n<pre><code>    while(temp){\n        if(!(strcmp(temp-&gt;values[g], value))){\n            if(prev == NULL) {\n                //when dataContainer-&gt;prev == NULL - you are in the head\n                dataContainer = temp-&gt;prev;\n                // if prev means previous in this case:\n                // dataContainer = NULL, on the second call segmentation fault appears when calling starting from line dataContainer-&gt;attributes[g]\n            }else{\n                prev-&gt;prev = temp-&gt;prev;\n            }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4405509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87cadab664e08f6ae28bf266ea06060?s=128&d=identicon&r=PG&f=1", "display_name": "Stewie Guya", "link": "https://stackoverflow.com/users/4405509/stewie-guya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450720087, "creation_date": 1447854005, "question_id": 33781596, "link": "https://stackoverflow.com/questions/33781596/segmentation-fault-on-second-call-when-deleting-first-node", "title": "Segmentation fault on second call when deleting first node", "body": "<p>I have this function for removing a certain node, then I loop it until all nodes with such value is removed from the list.</p>\n\n<p>However, when I try to delete the first node it results to segmentation fault on the second call. It works fine for other parts of the list. </p>\n\n<p>Here is the function I am calling to delete a node:</p>\n\n<pre><code>int delete(char* value, char* attribute, int attr_count){\n    dataContainer = datadata; \n    dataList *temp, *prev;\n    temp = dataContainer;\n    prev = NULL;\n\n    int g = 0;\n\n\n    while(g &lt; attr_count){\n        if(strlen(dataContainer-&gt;attributes[g]) == 0){\n            break;\n        }\n        if(!(strcmp(attribute, dataContainer-&gt;attributes[g]))){\n            break;\n        }\n        g++;\n    }\n\n    while(temp){\n        if(!(strcmp(temp-&gt;values[g], value))){\n            if(prev == NULL) {\n                dataContainer = temp-&gt;prev;\n            }else{\n                prev-&gt;prev = temp-&gt;prev;\n            }\n            free(temp);\n            return 1;\n        }\n        temp = dataContainer;\n        prev = temp;\n        temp = temp-&gt;prev;\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "function", "struct", "malloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447853406, "post_id": 33781329, "comment_id": 55329085, "body": "You&#39;re updating <code>nRecords</code> but not using that in the for loop. Why?"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1447853501, "post_id": 33781329, "comment_id": 55329170, "body": "Your function readFile return -1 if fileIn is null but is of type void. Also make sure that  the function prototype is after the struct declaration."}, {"owner": {"reputation": 393, "user_id": 1015192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vR9UX.jpg?s=128&g=1", "display_name": "pedwards", "link": "https://stackoverflow.com/users/1015192/pedwards"}, "edited": false, "score": 0, "creation_date": 1447854735, "post_id": 33781329, "comment_id": 55330084, "body": "Why <code>char data[51]</code> for data?  You said you where parsing a &quot;dynamic structure&quot;.  If your input is &gt; 51 bytes, you will scribble over the stack pointer and be unable to return from <code>readFile()</code>.  I think you need to do two things.  1. rethink the way you manage memory as this is quite convoluted and will be hard to support.  2. Stop using any form of scanf as it&#39;s dangerous."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447860005, "post_id": 33781329, "comment_id": 55334278, "body": "Don&#39;t forget to free what you malloc."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1447854544, "post_id": 33781438, "comment_id": 55329943, "body": "Also, you update <code>nRecords</code>, which is a pointer. You should write <code>*nRecords++</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1447855313, "post_id": 33781438, "comment_id": 55330584, "body": "@PaulOgilvie Thanks, added the same. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1447855301, "last_edit_date": 1447855301, "creation_date": 1447853529, "answer_id": 33781438, "question_id": 33781329, "link": "https://stackoverflow.com/questions/33781329/segmentation-fault-core-dumped-when-passing-dynamic-struct-to-function/33781438#33781438", "title": "Segmentation Fault (core dumped) When Passing Dynamic Struct to Function", "body": "<p>C uses pass-by-value for function parameter passing. In your code, <code>dataIn</code> itself is passed to <code>readFile()</code> using pass-by-value. </p>\n\n<p>Now,  <code>dataIn</code> being a pointer itself, you can change the content of <code>dataIn</code> from the function, but you cannot change <code>dataIn</code> itself (look at the <code>realloc()</code>) from the function, and expect that to get reflected back to <code>main()</code>.</p>\n\n<p>So, after returning, your <code>dataIn</code> has just one element, as it was <code>malloc()</code>ed previously. Then, the for loop obviously try to access out of bound memory, creating <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>If you want to change <code>dataIn</code> from the function, you need to pass a pointer to it to the function.</p>\n\n<p>That said,</p>\n\n<ul>\n<li><p><code>nRecords</code> being a pointer, <code>nRecords++;</code> will <strong>not</strong> update the corresponding <code>int</code> value.</p></li>\n<li><p>The <code>void</code> function <code>readFile()</code> should not have a <code>return</code> statement with a value like <code>return 1;</code></p></li>\n</ul>\n"}], "owner": {"reputation": 7, "user_id": 4374872, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000464621578/picture?type=large", "display_name": "Neil Widdowson", "link": "https://stackoverflow.com/users/4374872/neil-widdowson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 33781438, "answer_count": 1, "score": 0, "last_activity_date": 1447855552, "creation_date": 1447853235, "last_edit_date": 1447855552, "question_id": 33781329, "link": "https://stackoverflow.com/questions/33781329/segmentation-fault-core-dumped-when-passing-dynamic-struct-to-function", "title": "Segmentation Fault (core dumped) When Passing Dynamic Struct to Function", "body": "<p>I am trying to get this to work for my assignment but I keep getting a segmentation fault error but I can't see a problem. </p>\n\n<pre><code>struct line{\n        int source;\n        int dest;\n        int type;\n        int port;\n        char data[51];\n};\n\n\nint main(){\n    struct line *dataIn;\n    dataIn = malloc(sizeof(struct line));\n    int nRecords = 0;\n\n    readFile(&amp;nRecords, dataIn);\n\n    int i=0;\n    for(i = 0; 1 &lt; 100; i++){\n        printf(\"Source: %d Data: %s\\n\", dataIn[i].source, dataIn[i].data);\n    }\n\n    return 0;\n}\n\nvoid readFile(int *nRecords, struct line *dataIn){\n    FILE *fileIn;\n    fileIn =fopen(\"data.txt\",\"r\");\n    if (!fileIn){\n        puts(\"File Open Error\");\n        return 1;\n    }\n    while(fscanf(fileIn, \"%d:%d:%d:%d:%[^\\n]\", &amp;dataIn[*nRecords].source, &amp;dataIn[*nRecords].dest, &amp;dataIn[*nRecords].type, &amp;dataIn[*nRecords].port, dataIn[*nRecords].data) == 5){\n        nRecords++;\n        dataIn = realloc(dataIn,(*nRecords+1)*sizeof(struct line));\n    }\n    fclose(fileIn);\n}\n</code></pre>\n\n<p>Also when I add the function prototype at the top:</p>\n\n<pre><code>void readFile(int*, struct line*);\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>Conflicting Types for 'readFile'</p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1447852801, "post_id": 33780986, "comment_id": 55328585, "body": "addEntry(&amp;persons[0]);"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1447852918, "post_id": 33780986, "comment_id": 55328671, "body": "@Nunchy the fact is that the &amp; is not needed, persons already stores the address of the array of struct. If you pass the array to the function the array doesn&#39;t need to be global if is defined in the caller function."}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1447852998, "post_id": 33780986, "comment_id": 55328728, "body": "Ok...you&#39;re right it isn&#39;t needed - it works, though so meh"}], "answers": [{"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": true, "score": 4, "last_activity_date": 1447853679, "last_edit_date": 1447853679, "creation_date": 1447852821, "answer_id": 33781197, "question_id": 33780986, "link": "https://stackoverflow.com/questions/33780986/working-with-arrays-and-pointers-in-ansi-c/33781197#33781197", "title": "Working with Arrays and Pointers in ANSI C", "body": "<p>You need to add at a particular index so you can pass like this -</p>\n\n<pre><code>addEntry(&amp;persons[i]); // Passing the Array to the Function\n                       // start i from 0 to n-1 (for example)\n</code></pre>\n\n<p>This index <code>i</code> will be changed in calling function itself . So you don't need to track index and worry about it in your function <code>addEntry</code> . </p>\n\n<p>And instead of using <code>gets</code> use <code>fgets</code> -</p>\n\n<pre><code>fgets(persons-&gt;name,sizeof persons-&gt;name,stdin);\n</code></pre>\n\n<p>Similarly for all in your function <code>addEntry</code>.</p>\n\n<blockquote>\n  <p>how to modify my function to accept an array of <code>t_person</code> WITHOUT making it a global. I want to handle this in my main function.</p>\n</blockquote>\n\n<p>You don't need to make it global . Declare it in <code>main</code> and then pass it your function.</p>\n"}, {"tags": [], "owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "is_accepted": false, "score": 0, "last_activity_date": 1447853669, "creation_date": 1447853669, "answer_id": 33781477, "question_id": 33780986, "link": "https://stackoverflow.com/questions/33780986/working-with-arrays-and-pointers-in-ansi-c/33781477#33781477", "title": "Working with Arrays and Pointers in ANSI C", "body": "<p>You can declare <code>persons</code> as array and you can push on it using <code>addEntry(&amp;persons[i]);</code> with a loop, you program will be like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX_RECORDS 30\n\ntypedef struct {\n    char name[20];\n    char first_name[15];\n    char number[15];\n} t_person;\n\nvoid addEntry(t_person *persons)\n{\n    //gets is deprecated because it's dangerous, it may cause buffer overflow, it recommanded to use fgets\n    printf(\"Name: \");\n    fgets(persons-&gt;name, sizeof(persons-&gt;name), stdin);\n    //gets(persons-&gt;name);\n    printf(\"First Name: \");\n    fgets(persons-&gt;first_name, sizeof(persons-&gt;first_name), stdin);\n    //gets(persons-&gt;first_name);\n    printf(\"Number: \");\n    fgets(persons-&gt;number, sizeof(persons-&gt;number), stdin);\n    //gets(persons-&gt;number);\n}\n\nint main (int argc, char **argv)\n{\n    t_person persons[MAX_RECORDS]; // MAX_RECORDS = 30\n    int i = 0;\n\n    while( i &lt; MAX_RECORDS)\n    {\n        addEntry(&amp;persons[i]);\n        i++;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1373, "user_id": 4165479, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ed71eed5c9cf3f219c4e303d76dd79ff?s=128&d=identicon&r=PG&f=1", "display_name": "LuMa", "link": "https://stackoverflow.com/users/4165479/luma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 33781197, "answer_count": 2, "score": 0, "last_activity_date": 1447853679, "creation_date": 1447852216, "question_id": 33780986, "link": "https://stackoverflow.com/questions/33780986/working-with-arrays-and-pointers-in-ansi-c", "title": "Working with Arrays and Pointers in ANSI C", "body": "<p>I just started learning C and now face some issues. I wanted to create a small address book. The theory is simple: Creating a structure with the address book logic and initializing a field of this structure.</p>\n\n<p>This is my structure:</p>\n\n<pre><code>typedef struct {\n    char name[20];\n    char first_name[15];\n    char number[15];\n} t_person;\n</code></pre>\n\n<p>This is global. In my main function I create a field/array:</p>\n\n<pre><code>t_person persons[MAX_RECORDS]; // MAX_RECORDS = 30\n</code></pre>\n\n<p>I face the following problem: I want to call a function, which handles the logic for adding a new person. But I'm confused with adresses/pointers, etc.</p>\n\n<p>Calling the Function:</p>\n\n<pre><code>addEntry(&amp;persons); // Passing the Array to the Function\n</code></pre>\n\n<p>The Function itself:</p>\n\n<pre><code>void addEntry(t_person *persons)\n{\n\n    int i = 0; // I know this won't work, because adding\n               // a new person will overwrite the previous one\n               // Just for testing\n\n    printf(\"Name: \");\n    gets(&amp;persons[i].name);\n    printf(\"First Name: \");\n    gets(&amp;persons[i].first_name);\n    printf(\"Number: \");\n    gets(&amp;persons[i].number);\n}\n</code></pre>\n\n<p>I understand, that my function awaits a pointer to t_person, but I pass an array of t_person. But I fail to understand, how to modify my function to to accept an array of t_person WITHOUT making it a global. I want to handle this in my main function.</p>\n\n<p>Any tips for me?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 5, "creation_date": 1447852030, "post_id": 33780804, "comment_id": 55328027, "body": "because it is not empty, it is uninitialized."}, {"owner": {"reputation": 8091, "user_id": 1502148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e44d7e02bc91648f306666787a329d25?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Bakos", "link": "https://stackoverflow.com/users/1502148/g%c3%a1bor-bakos"}, "edited": false, "score": 2, "creation_date": 1447852087, "post_id": 33780804, "comment_id": 55328072, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24797860/what-is-the-default-value-of-a-char-in-an-uninitialized-array-in-c\">What is the default value of a char in an uninitialized array, in C?</a>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1447852291, "post_id": 33780804, "comment_id": 55328228, "body": "<code>ar</code> is <b>NOT</b> an array of <code>int</code>. Its values are of type <code>int *</code> (pointer to int) and you need to use <code>&quot;%p&quot;</code> (and cast to <code>(void*)</code>) in the <code>printf()</code> call ... or ... redefine the array as array of ints: <code>int ar[3];</code>"}, {"owner": {"reputation": 3364, "user_id": 693294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5935d56f077497b60c12cf86b9d2e1?s=128&d=identicon&r=PG", "display_name": "Gilbert", "link": "https://stackoverflow.com/users/693294/gilbert"}, "edited": false, "score": 5, "creation_date": 1447852738, "post_id": 33780804, "comment_id": 55328527, "body": "Is &quot;x == 0&quot; a typo in the post? Your code should have &quot;x = 0&quot; or it evaluates to a 0 or 1, depending if uninitialized x is 0 or not. Follow the link from G&#225;bor Bakos on this."}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1447852942, "post_id": 33780804, "comment_id": 55328685, "body": "You should use post increment as opposed to pre, ++x is 1 before the first pass of the loop - AR[0] isn&#39;t being initialised - use x++"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "reply_to_user": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 4, "creation_date": 1447853901, "post_id": 33780804, "comment_id": 55329455, "body": "@Nunchy: That&#39;s wrong.  The final clause of a <code>for(;;)</code> loop happens <i>after</i> the loop has executed.  It doesn&#39;t matter whether you use <code>++x</code> or <code>x++</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5576882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/893be7f1151af56c4b66bb09766a603b?s=128&d=identicon&r=PG&f=1", "display_name": "sirbingo", "link": "https://stackoverflow.com/users/5576882/sirbingo"}, "is_accepted": false, "score": 1, "last_activity_date": 1447860276, "creation_date": 1447860276, "answer_id": 33783934, "question_id": 33780804, "link": "https://stackoverflow.com/questions/33780804/why-is-my-empty-int-array-not-returning-0-for-the-last-index-in-c/33783934#33783934", "title": "Why is my empty int array not returning 0 for the last index in C?", "body": "<p>\"int *ar[3]\" means array of pointers, its element is a pointer to int, and there is no assignment for this array, that means its element might be any garbage. BTW, the type of ar[x] is pointer, if you want to print ar[x], you should use \"%p\" instead of \"%d\", otherwise there is a vast from %p to %d, and the value maybe is not you expect.</p>\n"}], "owner": {"reputation": 21, "user_id": 4866009, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204755568433975/picture?type=large", "display_name": "Alex Wenger", "link": "https://stackoverflow.com/users/4866009/alex-wenger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447860276, "creation_date": 1447851754, "last_edit_date": 1592644375, "question_id": 33780804, "link": "https://stackoverflow.com/questions/33780804/why-is-my-empty-int-array-not-returning-0-for-the-last-index-in-c", "title": "Why is my empty int array not returning 0 for the last index in C?", "body": "<pre><code>int *ar[3];\nint x;\nfor (x == 0; x &lt; 3; ++x)\n    printf(&quot;AR[%d]: %d\\n&quot;, x, ar[x]);\n</code></pre>\n<p>this returns</p>\n<blockquote>\n<p>AR[0]: 0</p>\n<p>AR[1]: 0</p>\n<p>AR[2]: 4196432</p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "mpi"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1447851630, "post_id": 33780715, "comment_id": 55327769, "body": "<code>arrayN</code> should be an <code>int*</code> instead of <code>int</code> and <code>arrayN = i + 1;</code> should be <code>arrayN[i] = i + 1;</code>."}, {"owner": {"reputation": 69, "user_id": 5565087, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f5b7e552f8088e3de1e1eb8a3df69fe4?s=128&d=identicon&r=PG&f=1", "display_name": "cirval", "link": "https://stackoverflow.com/users/5565087/cirval"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1447860432, "post_id": 33780715, "comment_id": 55334622, "body": "actually i have it that way, i just made a mistake while rewriting code, because i have my nodes as vm. I think the problem is with numberE because if i change numberE to 2 and if input is 2 the code works"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 5497772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10b174124b48a74506d9bb98d16c44?s=128&d=identicon&r=PG&f=1", "display_name": "macelee", "link": "https://stackoverflow.com/users/5497772/macelee"}, "edited": false, "score": 1, "creation_date": 1447969486, "post_id": 33784445, "comment_id": 55395476, "body": "You have the &#39;root&#39; argument missing in your MPI_Scatter calls."}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 301, "user_id": 5497772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10b174124b48a74506d9bb98d16c44?s=128&d=identicon&r=PG&f=1", "display_name": "macelee", "link": "https://stackoverflow.com/users/5497772/macelee"}, "edited": false, "score": 0, "creation_date": 1448023166, "post_id": 33784445, "comment_id": 55418903, "body": "@macelee : you are right ! I will correct this mistake which also occurs in the code provided by the asker. Thanks for your accurate remark !"}], "tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": false, "score": 1, "last_activity_date": 1448023220, "last_edit_date": 1448023220, "creation_date": 1447861612, "answer_id": 33784445, "question_id": 33780715, "link": "https://stackoverflow.com/questions/33780715/mpi-scatter-of-1d-array/33784445#33784445", "title": "MPI_scatter of 1D array", "body": "<ul>\n<li><p>In <code>arrayNlocal[sizeArray];</code>, <code>sizeArray</code> is not initialized. The best way to go is to broadcast <code>numberE</code> to every processes and allocate memory for <code>arrayNlocal</code>. Something like:</p>\n\n<pre><code>MPI_Bcast( &amp;numberE, 1, MPI_Int, 0, MPI_COMM_WORLD)\n</code></pre></li>\n<li><p><code>arrayN</code> is an array of size <code>sizeArray = numberE * 4</code>, so:</p>\n\n<pre><code>arrayN = malloc(sizeArray * sizeof(int));\n</code></pre></li>\n<li><p><code>MPI_Scatter()</code> needs pointers to the data to be sent on root node, and a pointer to receive buffer on each process of the communicator. Since <code>arrayNlocal</code> is an array:</p>\n\n<pre><code> MPI_Scatter(arrayN, numberE, MPI_INT, arrayNlocal, numberE,MPI_INT,MASTER, MPI_COMM_WORLD);\n</code></pre></li>\n</ul>\n\n<p>or alternatively:</p>\n\n<pre><code>    MPI_Scatter(arrayN, numberE, MPI_INT, &amp;arrayNlocal[0], numberE,MPI_INT,MASTER, MPI_COMM_WORLD);\n</code></pre>\n\n<ul>\n<li><code>id</code> is not initialized in <code>id == MASTER</code>: it must be <code>rank==MASTER</code>.</li>\n</ul>\n\n<p>As is, the prints at the end might occur in a mixed way between processes. \nTry to compile your code using <code>mpicc main.c -o main -Wall</code> to enable all warnings: it can save you a few hours in the near future!</p>\n"}], "owner": {"reputation": 69, "user_id": 5565087, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f5b7e552f8088e3de1e1eb8a3df69fe4?s=128&d=identicon&r=PG&f=1", "display_name": "cirval", "link": "https://stackoverflow.com/users/5565087/cirval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1379, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448023220, "creation_date": 1447851481, "last_edit_date": 1447860464, "question_id": 33780715, "link": "https://stackoverflow.com/questions/33780715/mpi-scatter-of-1d-array", "title": "MPI_scatter of 1D array", "body": "<p>I new to MPI and I am trying to write program that uses MPI_scatter. I have 4 nodes(0, 1, 2, 3). Node0 is master, others are slaves. Master asks user for number of elements of array to send to slaves. Then it creates array of size number of elements * 4. Then every node prints it`s results.</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MASTER 0\n\nint main(int argc, char **argv) {\n   int id, nproc, len, numberE, i, sizeArray;\n   int *arrayN=NULL;\n   int arrayNlocal[sizeArray];\n\n   MPI_Init(&amp;argc, &amp;argv);\n   MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n   MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n   if (id == MASTER){\n     printf(\"Enter number of elements: \");\n     scanf(\"%d\", &amp;numberE);\n     sizeArray = numberE * 4;\n     arrayN = malloc(numberE * sizeof(int));\n     for (i = 0; i &lt; sizeArray; i++){\n       arrayN[i] = i + 1;\n     }\n   }\n   MPI_Scatter(arrayN, numberE, MPI_INT, &amp;arrayNlocal, numberE,MPI_INT, MPI_COMM_WORLD);\n   printf(\"Node %d has: \", id);\n   for (i = 0; i &lt; numberE; i++){ \n     printf(\"%d \",arrayNlocal[i]);\n   }\n   MPI_Finalize();\n   return 0;\n}\n</code></pre>\n\n<p>And as error i get:</p>\n\n<pre><code>BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES\nPID 9278 RUNNING AT 192.168.100.100\nEXIT CODE: 139\nCLEANING UP REMAINING PROCESSES\nYOU CAN IGNORE THE BELOW CLEANUP MESSAGES\n</code></pre>\n"}, {"tags": ["c++", "c", "include", "preprocessor-directive"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1447850588, "post_id": 33780405, "comment_id": 55327033, "body": "That&#39;s a good example why you should not mix C and C++"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1447850905, "post_id": 33780405, "comment_id": 55327263, "body": "C/C++ is not a language. Which of these two languages are you learning and which language is your question about?"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 16707, "user_id": 341065, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8e57fe4b0f7381288a8e1e4c6cd77a8e?s=128&d=identicon&r=PG", "display_name": "wilx", "link": "https://stackoverflow.com/users/341065/wilx"}, "edited": false, "score": 2, "creation_date": 1447851263, "post_id": 33780405, "comment_id": 55327501, "body": "(1) Don&#39;t aim to learn the non-existent language C/C++. Choose one. I&#39;d recommend C++. (2) Post <b>real code</b>. It appears that @wilx fixed your code. That was a service to readers but a disservice to you, because you really need to learn to post real code, so that others won&#39;t have to fix things for you, or be mislead by the errors in your posted code."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 5, "last_activity_date": 1447852497, "last_edit_date": 1447852497, "creation_date": 1447850775, "answer_id": 33780486, "question_id": 33780405, "link": "https://stackoverflow.com/questions/33780405/how-a-compiler-knows-from-a-header-file-that-a-source-file-exists-somewhere/33780486#33780486", "title": "How a compiler knows from a header file, that a source file exists somewhere?", "body": "<p>Actually, the compiler doesn't know anything about other source files, it only knows about the current <a href=\"http://en.wikipedia.org/wiki/Translation_unit_%28programming%29\" rel=\"nofollow\"><em>translation unit</em></a>. It's the job of the <a href=\"https://en.wikipedia.org/wiki/Linker_%28computing%29\" rel=\"nofollow\"><em>linker</em></a> to take all translation units and link them together with the libraries to create the executable program, and it's the linker that will resolve all definitions and that notice missing function definitions.</p>\n\n<p>Traditionally, working with C or C++ is a four step process:</p>\n\n<ol>\n<li>Edit files</li>\n<li>Compile source files into object files</li>\n<li>Link object files and libraries to generate the executable program</li>\n<li>Run the program.</li>\n</ol>\n\n<p><sub>The preprocessor is usually built into the compiler, so preprocessing and compiling is only a single step.</sub></p>\n\n<hr>\n\n<p>As for the \"missing\" <code>.h</code>, none of the C++-only standard library header files have that extension.</p>\n"}, {"tags": [], "owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": false, "score": 0, "last_activity_date": 1447852277, "last_edit_date": 1447852277, "creation_date": 1447851057, "answer_id": 33780572, "question_id": 33780405, "link": "https://stackoverflow.com/questions/33780405/how-a-compiler-knows-from-a-header-file-that-a-source-file-exists-somewhere/33780572#33780572", "title": "How a compiler knows from a header file, that a source file exists somewhere?", "body": "<p>Re</p>\n\n<blockquote>\n  <p><strong>&rdquo;</strong> How a compiler knows from a header file, that a source file exists somewhere?</p>\n</blockquote>\n\n<p>Generally, how a compiler locates header files, or if they <em>are</em> files, depends on the compiler.</p>\n\n<p>But usually one or more of the following mechanisms are used:</p>\n\n<ul>\n<li><p>The compiler knows its own program location, and can look for <strong>include directories</strong> for standard headers, relative to that location. g++ does this.</p></li>\n<li><p>The compiler can be configured with paths to include directories in one or more environment variables. E.g. g++ uses <code>CPATH</code> (among others), and Visual C++ uses <code>INCLUDE</code> (and possibly more).</p></li>\n<li><p>The compiler can accept include directory paths as command line options. Typically this is <code>-I</code> or with Visual C++, alternatively <code>/I</code>.</p></li>\n<li><p>The compiler can be configured via a configuration file in a well known location. For example, g++ uses a <code>specs</code> file.</p></li>\n<li><p>The compiler can accept one or more configuration files as command line options. E.g. Visual C++ accepts so called \"response files\", and g++ accepts specs files, although with slightly different semantics than the general configuration specs file.</p></li>\n</ul>\n\n<p>Possibly there are more mechanisms in use, but the above are the most common ones.</p>\n\n<hr>\n\n<p>Re</p>\n\n<blockquote>\n  <p><strong>&rdquo;</strong> But when and how does the compiler include the math functions, if I include math.h?</p>\n</blockquote>\n\n<p>It doesn't.</p>\n\n<p>The whole of the standard library is linked in regardless of what headers you include. Depending on the quality of the implementation the unused parts of the standard library are then discarded.</p>\n\n<p>When you use a 3<sup>rd</sup> party library you will generally have to explicitly link with that library, in addition to including one or more of its headers. The Visual C++ compiler supports <code>#pragma</code> directives that can be placed in headers and serve to automatically direct the linker. But this is not standardized, and e.g. g++ does not support that automagic mechanism.</p>\n\n<hr>\n\n<p>Re</p>\n\n<blockquote>\n  <p><strong>&rdquo;</strong> If I create a library, then where to put the .c/.cpp/.h files, and how to include them?</p>\n</blockquote>\n\n<p>Essentially you have free reins, you can do it any way you want. Which is problematic because users of a C++ library have to deal with different conventions and tools for each library, to the extent of using a different OS to \"configure\" things. However, nowadays it's popular to employ CMake for libraries with separate compilation, which helps to reduce the DIY problems.</p>\n\n<p>A nice alternative is to create a <strong>header only library</strong>, with all the code in headers. Large parts of Boost are header only. The advantage is that it's very easy to use, no configuration or toolset adaption or whatever, but with currently popular 1950's build technology it can cause longer build times.</p>\n"}, {"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 1, "last_activity_date": 1447855248, "creation_date": 1447855248, "answer_id": 33782039, "question_id": 33780405, "link": "https://stackoverflow.com/questions/33780405/how-a-compiler-knows-from-a-header-file-that-a-source-file-exists-somewhere/33782039#33782039", "title": "How a compiler knows from a header file, that a source file exists somewhere?", "body": "<p>Standard Template Library headers, such as &lt; algorithm > include source code for the template functions, which get instantiated at compile time, based on the  template type(s) involved in source code calls to template functions.</p>\n\n<p>A library is a collection of object files in a single library file. The linker normally only includes the object files needed to satisfy the references to functions or data to build the program, not the entire library file. The exception to this is a dynamic link library, since all of that library will be loaded (if not already loaded) at program load time.</p>\n\n<p>The compiler has default locations for headers using &lt; > and using \" \". The headers using \" \", can include relative or absolute paths. The relative path may vary depending on the tool set.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 6, "last_activity_date": 1447867330, "creation_date": 1447867330, "answer_id": 33786390, "question_id": 33780405, "link": "https://stackoverflow.com/questions/33780405/how-a-compiler-knows-from-a-header-file-that-a-source-file-exists-somewhere/33786390#33786390", "title": "How a compiler knows from a header file, that a source file exists somewhere?", "body": "<p>When you install the compiler, the standard header and library files are also installed into well-known locations.  For example, on a Linux or Unix system, the standard headers are typically installed under <code>/usr/include</code> or <code>/usr/local/include</code> and the standard libraries are typically installed under <code>/usr/lib</code> or <code>/usr/local/lib</code>.  </p>\n\n<p>When you <code>#include</code> the header file, the compiler will look for it in different places depending on whether you use the angle brackets (<code>#include &lt;stdio.h&gt;</code>) or quotes (<code>#include \"myfile.h\"</code>).  For example, if you include a header file in angle brackets, <code>gcc</code> will search for that header in the following directories:</p>\n\n<pre><code>/usr/local/include\n<em>libdir</em>/gcc/<em>target</em>/<em>version</em>/include\n/usr/<em>target</em>/include\n/usr/include\n</code></pre>\n\n<p>If you include a header file with quotes, <code>gcc</code> will first search the current working directory, then additional directories as specified by command-line options, and finally the standard include paths above.  </p>\n\n<p>Most compilers allow you to specify additional include paths as arguments to compile command, such as</p>\n\n<pre><code>gcc -o <em>executable-name</em> <strong>-I /<em>additional</em>/<em>include</em>/<em>path</em></strong> <em>source-files</em></code></pre>\n\n<blockquote>\n  <p>But sometimes the .h is missing:</p>\n  \n  <p><code>#include &lt;iostream&gt;</code></p>\n</blockquote>\n\n<p>This is the C++ convention<sup>1</sup>; C++ standard headers do not have the <code>.h</code> extension, I guess to make it <em>look</em> more object-oriented than it really is (that is, you can pretend you're importing the class directly, rather than including the text of the file that describes the class).  </p>\n\n<blockquote>\n  <p>I already know, that the header file contains the signatures of the functions only, and some preprocessor commands. But when and how does the compiler include the math functions, if I include math.h?</p>\n</blockquote>\n\n<p>The implementations of the math functions are typically kept in a separate library (code that's already been compiled and archived into a single binary file); depending on the compiler, the math library may or may not be automatically linked into the executable.  For example, <code>gcc</code> does not automatically link in any math library functions, even if you include the <code>math.h</code> header file.  You have to explicitly include the math library as part of the build command:</p>\n\n<pre><code>gcc -o <em>executable-name</em> <em>command-line-options</em> <em>source-files</em> <strong>-lm</strong></code></pre>\n\n<p>With <code>gcc</code>, the convention is that <code>-l<em>name</em></code> links in a library named <code>lib<em>name</em>.a</code><sup>2</sup>.  The standard math library file is named <code>libm.a</code>, so <code>-lm</code> tells <code>gcc</code> to link in the machine code that's contained within <code>libm.a</code>.   </p>\n\n<p>Like the standard headers, the compiler will search for the standard libraries in well-known locations.  You can specify additional search paths for libraries that aren't part of the standard installation, like so:</p>\n\n<pre><code>gcc -o <em>executable-name</em> <em>command-line-options</em> <em>source-files</em> -L /<em>additional</em>/<em>library</em>/<em>path</em> -l<em>additional-library</em></code></pre>\n\n<blockquote>\n  <p>If I create a library, then where to put the .c/.cpp/.h files, and how to include them?</p>\n</blockquote>\n\n<p>You can put the files pretty much anywhere you want; you'll specify where they are as part of the build command.  So, say you're creating a new library named <code>mylib</code>.  You create a new directory under your home directory:</p>\n\n<pre><code>mkdir ~/mylib\ncd ~/mylib\n</code></pre>\n\n<p>Then you create and edit your source files and headers:</p>\n\n<pre><code>cd ~/mylib\nvi mylib.h\nvi mylib.c\n</code></pre>\n\n<p>To build <code>mylib</code> as a static library, do the following:</p>\n\n<pre><code>cd ~/mylib\ngcc -c mylib.c\nar libmylib.a mylib.o\n</code></pre>\n\n<p>So when you're done, the directory <code>~/mylib</code> contains the following:</p>\n\n<pre><code>libmylib.a\nmylib.c \nmylib.h\nmylib.o\n</code></pre>\n\n<p>To use the functions collected in <code>mylib</code> in a program, you'd specify the header and library include paths as part of the compile command:</p>\n\n<pre><code>gcc -o <em>executable-name</em> <em>command-line-options</em> <em>source-files</em> -I ~/mylib -L ~/mylib -lmylib</code></pre>\n\n<p>So, if you <code>include \"mylib.h\"</code> in another program, this will tell the compiler to search for that header in <code>~/mylib</code>, and it will tell the linker that the <code>libmylib.a</code> library will be found under <code>~/mylib</code>.  </p>\n\n<p>In a real-world situation you'd handle all of the builds with makefiles instead of building everything by hand.  You'd also probably set it up so that as part of the build process, all the headers that anyone else would need to use your library would be copied to a separate <code>include</code> subdirectory, and the library would be written to a separate <code>lib</code> subdirectory, so you could distribute your library without exposing your source code.  In that case, the build command above would look more like:</p>\n\n<pre><code>gcc -o <em>executable-name</em> <em>command-line-options</em> <em>source-files</em> -I ~/mylib/include -L ~/mylib/lib -lmylib</code></pre>\n\n<p><hr>\n<sup>\n1. This hasn't always been the case; the earliest implementations of C++ used <code>iostream.h</code>, <code>vector.h</code>, etc.  I'm not sure exactly when that convention changed, but it's been a while.<br><br>\n2. Actually, I'm not sure anymore if this is a <code>gcc</code> convention or a <code>*nix</code> convention; the two have been joined at the hip for so long it's hard to remember sometimes.<br><br>\n</sup></p>\n"}], "owner": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2735, "favorite_count": 3, "accepted_answer_id": 33786390, "answer_count": 4, "score": 4, "last_activity_date": 1447867330, "creation_date": 1447850536, "last_edit_date": 1447850781, "question_id": 33780405, "link": "https://stackoverflow.com/questions/33780405/how-a-compiler-knows-from-a-header-file-that-a-source-file-exists-somewhere", "title": "How a compiler knows from a header file, that a source file exists somewhere?", "body": "<p>I just started to learn C/C++, but I'm a bit confused. I often see the <code>#include</code> preprocessor directive, with a header file argument:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream.h&gt; \n#include \"windows.h\"\n#include &lt;math.h&gt;\n</code></pre>\n\n<p>But sometimes the <code>.h</code> is missing:</p>\n\n<pre><code>#include &lt;iostream&gt;\n</code></pre>\n\n<p>I already know, that the header file contains the signatures of the functions only, and some preprocessor commands. But when and how does the compiler include the math functions, if I include <code>math.h</code>?</p>\n\n<p>If I create a library, then where to put the .c/.cpp/.h files, and how to include them?</p>\n"}, {"tags": ["python", "c", "numpy", "fftw"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1447852625, "post_id": 33780390, "comment_id": 55328449, "body": "What value are you passing as <code>size</code> in your calls to <code>memcpy</code> - it should be no of <i>bytes</i> but it looks like you might be passing no of <i>elements</i>?"}, {"owner": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1447853998, "post_id": 33780390, "comment_id": 55329515, "body": "Thanks, that is my first mistake! But it does not calculate the correct values..."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1447854431, "post_id": 33780390, "comment_id": 55329851, "body": "Your <code>memset</code> calls have a similar problem too, but that is also probably not particularly relevant in this instance."}, {"owner": {"reputation": 12989, "user_id": 2994596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YU9Zw.png?s=128&g=1", "display_name": "SleuthEye", "link": "https://stackoverflow.com/users/2994596/sleutheye"}, "edited": false, "score": 1, "creation_date": 1447855761, "post_id": 33780390, "comment_id": 55330929, "body": "differences on the order of 10^(-15) or less can be expected as floating point rounding errors."}, {"owner": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1447860405, "post_id": 33780390, "comment_id": 55334605, "body": "@PaulR: F*, I should not switch between python and C all the time, thanks!"}, {"owner": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "reply_to_user": {"reputation": 12989, "user_id": 2994596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YU9Zw.png?s=128&g=1", "display_name": "SleuthEye", "link": "https://stackoverflow.com/users/2994596/sleutheye"}, "edited": false, "score": 0, "creation_date": 1447860419, "post_id": 33780390, "comment_id": 55334610, "body": "@SleuthEye: Do you know how I can decrease them?"}], "answers": [{"tags": [], "owner": {"reputation": 12989, "user_id": 2994596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YU9Zw.png?s=128&g=1", "display_name": "SleuthEye", "link": "https://stackoverflow.com/users/2994596/sleutheye"}, "is_accepted": true, "score": 2, "last_activity_date": 1447901757, "creation_date": 1447901757, "answer_id": 33794465, "question_id": 33780390, "link": "https://stackoverflow.com/questions/33780390/using-fftw-fft-correctly/33794465#33794465", "title": "Using fftw fft correctly", "body": "<p>For <code>double</code> precision arithmetic, rounding errors on the order of 10<sup>-16</sup> to 10<sup>-15</sup> can be expected from many FFT implementations as shown in <a href=\"http://www.fftw.org/accuracy/index.html\" rel=\"nofollow\">FFTW accuracy benchmarks</a>.</p>\n\n<p>Note that 10<sup>-15</sup> is 300dB less than a peak magnitude of 1.0. Most practical signals have a much smaller dynamic range (eg. <a href=\"https://en.wikipedia.org/wiki/Dynamic_range#cite_note-Fries2005-12\" rel=\"nofollow\">16-bit CD quality audio has an SNR of ~90dB</a>). If your application does really need that much precision, you would likely need to use an arbitrary precision implementation of the FFT (that's what is used as a reference implementation in <a href=\"http://www.fftw.org/accuracy/method.html\" rel=\"nofollow\">FFTW accuracy measurements</a>).</p>\n"}], "owner": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 33794465, "answer_count": 1, "score": 1, "last_activity_date": 1447901757, "creation_date": 1447850496, "last_edit_date": 1447854125, "question_id": 33780390, "link": "https://stackoverflow.com/questions/33780390/using-fftw-fft-correctly", "title": "Using fftw fft correctly", "body": "<p>I want to use the fft-function from the fftw-library in my project, and therefore created the following functions:</p>\n\n<pre><code>void fft(const int size, DCOMPLEX *a, DCOMPLEX *b)\n{\n    fftw_plan p;\n    p = fftw_plan_dft_1d(size, a, b, FFTW_FORWARD, FFTW_ESTIMATE);\n    fftw_execute(p); /* repeat as needed */\n    fftw_destroy_plan(p);\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>static fftw_complex *in;\nstatic fftw_complex *out;\nstatic fftw_plan p_fft, p_ifft;\nvoid init_fft(const int N)\n{\n    in = (fftw_complex*) fftw_malloc(sizeof(fftw_complex)*N);\n    out = (fftw_complex*) fftw_malloc(sizeof(fftw_complex)*N);\n    if(fftw_init_threads() != 0)\n    {\n        printf(\"Using %d threads!\\n\", omp_get_max_threads());\n        fftw_plan_with_nthreads(omp_get_max_threads());\n    };\n    p_fft = fftw_plan_dft_1d(N, in, out, FFTW_FORWARD, FFTW_EXHAUSTIVE);\n    p_ifft = fftw_plan_dft_1d(N, in, out, FFTW_BACKWARD, FFTW_EXHAUSTIVE);\n    memset(in, 0, N);\n    memset(out, 0, N);\n\n}\nvoid fft_pre_plan(const int size, DCOMPLEX *a, DCOMPLEX *b)\n{\n    memcpy(in, a, size*sizeof(DCOMPLEX));\n    fftw_execute(p_ifft); /* repeat as needed */\n    memcpy(b, out, size*sizeof(DCOMPLEX));\n}\n</code></pre>\n\n<p>I compare the result with the results from <code>b = numpy.fft.fft(a)</code> while calling them either like</p>\n\n<pre><code>fft(a.size(), a, b)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>init_fft(a.size())//Called once\nfftw_pre_plan(a.size(), a, b)//Called for each fft\n</code></pre>\n\n<p>with <code>.size()</code> the length of the array (pseudo code). \nWhile the latter approach is a speedup of 2 compared to the numpy code, the results I obtain from it are not correct (i.e. wrong values). Why?<br>\nEdit: And if you suggest me to use the python wrappers: They do not offer me the same speedup as I get when using the latter solution (even slower than numpy).<br>\nWhen comparing them, I get the following values as output (for an array of <code>2**14</code> elements and the same inputs):</p>\n\n<pre><code>numpy.fft.fft: [ 0.00095184 -1.54074866e-32j  0.00095267 +6.52776772e-18j\n  0.00095349 +2.58018535e-18j ...,  0.00095432 +1.26416719e-16j\n  0.00095349 +2.61724648e-16j  0.00095267 +1.21645986e-16j]\n\nfft(): [ 0.00095184 -1.54074866e-32j  0.00095267 -5.98482633e-17j\n  0.00095349 -1.27638146e-16j ...,  0.00095432 -9.88543196e-16j\n  0.00095349 -9.30058376e-16j  0.00095267 -1.09881551e-15j]\n\nfft_pre_plan(): [ 0.00095184 -1.54074866e-32j  0.00095267 -1.09881551e-15j\n  0.00095349 -9.30058376e-16j ...,  0.00095432 -1.79405492e-16j\n  0.00095349 -1.27638146e-16j  0.00095267 -5.98482633e-17j]\n</code></pre>\n\n<p>Could the reason be that I have rounding errors?</p>\n"}, {"tags": ["c", "linux", "posix"], "comments": [{"owner": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "edited": false, "score": 0, "creation_date": 1447850614, "post_id": 33780364, "comment_id": 55327050, "body": "<code>C</code> and <code>C++</code> are different languages. Edit your tag."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1447850685, "post_id": 33780364, "comment_id": 55327097, "body": "You just didn&#39;t run the code nearly often enough to discover the failure mode.  Which only strikes once a month, at best.  Happens when another process also opens the file at <i>exactly</i> the wrong time, right between these two open() calls.  Very small odds, not zero."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1447850784, "post_id": 33780364, "comment_id": 55327171, "body": "The fact that some code runs successfully sometimes doesn&#39;t guarantee that it <i>always</i>  runs successfully. This isn&#39;t atomically at all, and during the time you move from <code>if</code> to <code>else</code> the conditions can be changed by some other thread."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447850856, "post_id": 33780364, "comment_id": 55327224, "body": "<a href=\"https://en.wikipedia.org/wiki/Race_condition#Example\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Race_condition#Example</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1447851340, "post_id": 33780364, "comment_id": 55327557, "body": "Firstly, the code is neither C nor C++ since <code>open()</code> is a posix function, not part of the standard C or C++ libraries.   Second, it has a failure mode due to a race condition, if another program also attempts to open the same file, and happens to succeed between the two <code>open()</code> calls.  Lastly, the use of <code>O_CREAT</code> does not guarantee atomicity - it simply guarantees the file is created if it does not exist.   A better mode might be <code>O_EXCL</code>."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1447851533, "post_id": 33780364, "comment_id": 55327694, "body": "@Peter: &quot;the code is neither C nor C++&quot;  oh come on.. ;) I understand what you&#39;re <i>trying</i> to say, but this is just plain wrong. Please rephrase it."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1447851902, "post_id": 33780364, "comment_id": 55327947, "body": "I&#39;m saying that tagging the code as C or C++ is wrong.   Tagging for posix (or maybe linux, depending on viewpoint) would be more appropriate."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1447852208, "post_id": 33780364, "comment_id": 55328160, "body": "@Peter: Oh come ooooon... if I use any not-100% <i>portable</i> library suddenly it&#39;s not C/C++ anymore? If I create my custom function suddenly it&#39;s not C/C++ because it&#39;s not part of the standard? Nonsense. Note: adding an <i>extra</i> tag makes sense, a bit pedantic to my liking, but fine."}, {"owner": {"reputation": 15, "user_id": 2645859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd92e9fd776125219c30f27258d9075?s=128&d=identicon&r=PG", "display_name": "user2645859", "link": "https://stackoverflow.com/users/2645859/user2645859"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1447852463, "post_id": 33780364, "comment_id": 55328342, "body": "@Peter I have changed the tags as you suggested. I understand that a context switch could happen between the two open calls but doesn&#39;t the use of O_CREAT in the second open call mean that if the file is created by another process, it will not be overwritten?"}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1447852645, "post_id": 33780364, "comment_id": 55328464, "body": "Please add a language tag. Pick C or C++. Honestly, even the choice between C/C++ is nitpicking because the semantics for the code don&#39;t differ, but I don&#39;t want to start another argument;)"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2645859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd92e9fd776125219c30f27258d9075?s=128&d=identicon&r=PG", "display_name": "user2645859", "link": "https://stackoverflow.com/users/2645859/user2645859"}, "edited": false, "score": 0, "creation_date": 1447856054, "post_id": 33781590, "comment_id": 55331192, "body": "I understand that the remedy is to use O_CREAT. My question primarily concerns the fact that if another process creates the file in between the two open() calls, the O_CREAT in the second open() call basically means that there still isn&#39;t a problem since it will find an existing file and therefore it will just open the file. So what can go wrong if use the above code?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 15, "user_id": 2645859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd92e9fd776125219c30f27258d9075?s=128&d=identicon&r=PG", "display_name": "user2645859", "link": "https://stackoverflow.com/users/2645859/user2645859"}, "edited": false, "score": 0, "creation_date": 1447857404, "post_id": 33781590, "comment_id": 55332245, "body": "No, the remedy is to use <code>O_EXCL</code> which will cause the call to fail if the file exists. Your code does not <i>create</i> a file atomically, it merely opens an existing file or creates it f it does not exist. What can go wrong is that another process has the file open for reading or writing and now you open the file for writing. Without the permissions in <code>mode</code> lots can go wrong."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1447853985, "creation_date": 1447853985, "answer_id": 33781590, "question_id": 33780364, "link": "https://stackoverflow.com/questions/33780364/creating-a-file-atomically/33781590#33781590", "title": "Creating a file atomically", "body": "<p>Atomicity is provided by the operating system: either the file exists, or it doesn't, however, between the calls to e.g. <code>access()</code> to check for existence and <code>open()</code> to create the file, another process may have created the file. So atomically creating a file must be done in one call:</p>\n\n<pre><code>if ((fd=open(\"filename.dat\", O_WRONLY | O_CREAT | O_EXCL, mode))&lt;0) {\n    // file exists or other error\n</code></pre>\n\n<p><code>O_EXCL</code> results in the call failing when the file exists.</p>\n\n<p><code>mode</code> is a parameter required with <code>O_CREAT</code> to specify the file's access/sharing permission. The flags differ between Linux and Windows.</p>\n"}], "owner": {"reputation": 15, "user_id": 2645859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd92e9fd776125219c30f27258d9075?s=128&d=identicon&r=PG", "display_name": "user2645859", "link": "https://stackoverflow.com/users/2645859/user2645859"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 33781590, "answer_count": 1, "score": -4, "last_activity_date": 1447853985, "creation_date": 1447850428, "last_edit_date": 1447852868, "question_id": 33780364, "link": "https://stackoverflow.com/questions/33780364/creating-a-file-atomically", "title": "Creating a file atomically", "body": "<p>I came across this piece of code and it is not supposed to work according to the author, however, it runs successfully. The author recommends the use of O_CREAT which does the same thing but guarantees atomicity. In my opinion whether two processes are running concurrently or not, the code should still work? </p>\n\n<pre><code>if((fd=open(\"filename.dat\", O_WRONLY) &lt; 0)){\n    if(errno != ENOENT){\n        perror(\"open error\");\n        exit(1);\n    }\n    else if((fd=open(\"filename.dat\", O_WRONLY | O_CREAT)) &lt; 0){ \n        perror(\"creation error\");\n        exit(1);\n    }\n}  \n</code></pre>\n"}, {"tags": ["c", "glibc", "libc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447858818, "post_id": 33780167, "comment_id": 55333351, "body": "&quot;Now which one of these printfs my program is using? How can I determine it?&quot; You should figure out how the library is built. This depends mostly on how the compiler is invoked, which is defined in Makefiles. Which are probably just as unreadable. Isn&#39;t glibc fun? (Spoiler: glibc isn&#39;t fun.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447858969, "post_id": 33780167, "comment_id": 55333467, "body": "Another spoiler: you&#39;ll eventually end up in the definition of <a href=\"http://osxr.org/glibc/source/stdio-common/vfprintf.c#0221\" rel=\"nofollow noreferrer\">vfprintf in stdio-common/vfprintf.c</a>, but to see the relationship between that and functions like <code>__printf</code>, you&#39;ll have to wade through a big soup of preprocessor macros and GCC-specific attribute declarations."}, {"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1447859065, "post_id": 33780167, "comment_id": 55333538, "body": "@Rhymoid Is the reason for all these to create/preserve portability?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447859572, "post_id": 33780167, "comment_id": 55333936, "body": "I can&#39;t say for sure, but here is my <i>guess</i>: there is one generic implementation that is absolutely portable, and then there are some adjustments for platform-specific optimisations (those <code>__nldbl</code> functions seem related to systems that have <code>long double</code>). To keep this solution <i>maintainable</i>, there is some layer of macros and wrapper functions. Over time, this layer grew, and turned into a maintenance burden. (Sadly, such scenarios are pretty common in software engineering.)"}, {"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1447859921, "post_id": 33780167, "comment_id": 55334214, "body": "@Rhymoid I see. Then it might be better to find an open source standard library implementation that is much more lightweight."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1447860040, "post_id": 33780167, "comment_id": 55334307, "body": "Well-known alternatives include musl, uClibc, and dietlibc, compared with glibc <a href=\"http://www.etalabs.net/compare_libcs.html\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1447851758, "post_id": 33780764, "comment_id": 55327857, "body": "<a href=\"http://osxr.org/glibc/source/sysdeps/ieee754/ldbl-opt/nldbl-vfprintf_chk.c#0005\" rel=\"nofollow noreferrer\">In this page</a>, <code>__vfprintf_chk</code> calls <code>__nldbl___vfprintf_chk</code>."}, {"owner": {"reputation": 46, "user_id": 5576416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7f76024fe5bbb725456b7637231bd6?s=128&d=identicon&r=PG&f=1", "display_name": "tauroid", "link": "https://stackoverflow.com/users/5576416/tauroid"}, "reply_to_user": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1447854318, "post_id": 33780764, "comment_id": 55329744, "body": "I see what you mean. Looks like I&#39;m not going to be much help, and I don&#39;t know how the recursion you mention is resolved but printf seems to be defined <a href=\"http://osxr.org/glibc/source/stdio-common/printf.c\" rel=\"nofollow noreferrer\">here</a>. Finding out which one gets used will require digging into which one gets compiled/linked by the build system, don&#39;t know much more than that."}], "tags": [], "owner": {"reputation": 46, "user_id": 5576416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7f76024fe5bbb725456b7637231bd6?s=128&d=identicon&r=PG&f=1", "display_name": "tauroid", "link": "https://stackoverflow.com/users/5576416/tauroid"}, "is_accepted": false, "score": 0, "last_activity_date": 1447851608, "creation_date": 1447851608, "answer_id": 33780764, "question_id": 33780167, "link": "https://stackoverflow.com/questions/33780167/how-to-understand-glibc-cross-reference/33780764#33780764", "title": "How to understand glibc cross-reference?", "body": "<p>I don't have a full answer but I'm unable to leave a comment. It looks like __vfprintf_chk calls vfprintf, which appears to be aliased to _IO_vfprintf_internal in /stdio-common/vfprintf.c. I don't know the origin of the last function, but I can't see the infinite loop here?</p>\n"}, {"comments": [{"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 1, "creation_date": 1447858282, "post_id": 33783126, "comment_id": 55332975, "body": "How am I supposed to know that it calls <i>that</i> <code>printf</code> and not others?"}, {"owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 1, "creation_date": 1447858711, "post_id": 33783126, "comment_id": 55333284, "body": "This is the main part that confuses me. For example, when you look for <code>vfprintf</code> in the cross-reference page, you get around a dozen <a href=\"http://osxr.org/glibc/ident?_i=vfprintf\" rel=\"nofollow noreferrer\">results</a> where 3 of them are stated as function definitions. Your link points to 2nd function definition among those results but how am I supposed to know that the 2nd <code>vprintf</code> is called and not 2 others?"}, {"owner": {"reputation": 5355, "user_id": 452079, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb85f91e35202c72ca16d54873b10c4?s=128&d=identicon&r=PG", "display_name": "rohit89", "link": "https://stackoverflow.com/users/452079/rohit89"}, "reply_to_user": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "edited": false, "score": 0, "creation_date": 1447861896, "post_id": 33783126, "comment_id": 55335779, "body": "There&#39;s no easy rule - you might have to check every option. <code>glibc</code> is pretty dense because of portability and compatibility requirements. That said, a simple way to weed out some options is to look at the file paths and filenames. <code>__printf_chk</code> takes you into the <code>sysdep</code> directory - you don&#39;t need to go into those types of directories for core implementations."}], "tags": [], "owner": {"reputation": 5355, "user_id": 452079, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb85f91e35202c72ca16d54873b10c4?s=128&d=identicon&r=PG", "display_name": "rohit89", "link": "https://stackoverflow.com/users/452079/rohit89"}, "is_accepted": false, "score": 0, "last_activity_date": 1447858157, "creation_date": 1447858157, "answer_id": 33783126, "question_id": 33780167, "link": "https://stackoverflow.com/questions/33780167/how-to-understand-glibc-cross-reference/33783126#33783126", "title": "How to understand glibc cross-reference?", "body": "<p>Implementation of <code>printf</code> is found in <a href=\"http://osxr.org/glibc/source/stdio-common/printf.c\" rel=\"nofollow\"><code>stdio-common/printf.c</code></a></p>\n\n<pre><code>int\n__printf (const char *format, ...)\n{\n   va_list arg;\n   int done;\n\n   va_start (arg, format);\n   done = vfprintf (stdout, format, arg);\n   va_end (arg);\n\n   return done;\n}\n</code></pre>\n\n<p>which calls <a href=\"http://osxr.org/glibc/source/stdio-common/vfprintf.c\" rel=\"nofollow\"><code>vfprintf</code></a></p>\n"}], "owner": {"reputation": 1697, "user_id": 3395831, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c76732996d10182885b6ac1046e13c95?s=128&d=identicon&r=PG&f=1", "display_name": "Utku", "link": "https://stackoverflow.com/users/3395831/utku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1447858157, "creation_date": 1447849904, "question_id": 33780167, "link": "https://stackoverflow.com/questions/33780167/how-to-understand-glibc-cross-reference", "title": "How to understand glibc cross-reference?", "body": "<p>I am trying to understand how does the hello world program works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv) {\n    printf(\"Hello World!\");\n    return 0;\n}\n</code></pre>\n\n<p>Most of it is straightforward, except the <code>printf</code> part. I don't know how it works. To understand it, I have looked for <a href=\"https://www.google.com.tr/search?q=glibc%20cross%20reference&amp;ie=utf-8&amp;oe=utf-8&amp;gws_rd=cr&amp;ei=EmhMVuPONuXLyAOBjqHIBw\" rel=\"nofollow\">glibc cross reference</a> and found <a href=\"http://osxr.org/glibc/ident\" rel=\"nofollow\">this page</a>.</p>\n\n<p>Then I searched for <code>printf</code> and it returned me lots of <a href=\"http://osxr.org/glibc/ident?_i=printf&amp;_identdefonly=1&amp;_remember=1\" rel=\"nofollow\">results</a>.</p>\n\n<p>Now which one of these <code>printf</code>s my program is using? How can I determine it?</p>\n\n<p>Also, for example when open the <a href=\"http://osxr.org/glibc/source/libio/bits/stdio2.h#0102\" rel=\"nofollow\">first result</a> in that page, the function in <code>printf</code> function leads me to <a href=\"http://osxr.org/glibc/source/sysdeps/ieee754/ldbl-opt/nldbl-printf_chk.c#0005\" rel=\"nofollow\">__printf_chk</a>, where the function in <code>__printf_chk</code> leads me to <a href=\"http://osxr.org/glibc/source/sysdeps/ieee754/ldbl-opt/nldbl-compat.c#0583\" rel=\"nofollow\">__nldbl___vfprintf_chk</a>, where the function in <code>__nldbl___vfprintf_chk</code> leads me to <a href=\"http://osxr.org/glibc/source/sysdeps/ieee754/ldbl-opt/nldbl-compat.c#0583\" rel=\"nofollow\">__vfprintf_chk</a>, where the function in <code>__vfprintf_chk</code> leads me to again <a href=\"http://osxr.org/glibc/source/sysdeps/ieee754/ldbl-opt/nldbl-compat.c#0583\" rel=\"nofollow\">__nldbl___vfprintf_chk</a>, which creates an infinite recursion. What's going on?</p>\n\n<p>So in short, how am I supposed to track the source of a given function/source code?</p>\n"}, {"tags": ["c", "data-structures", "struct", "segmentation-fault", "valgrind"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1447849515, "post_id": 33779975, "comment_id": 55326262, "body": "<code>(*vis_data_collection_tail)-&gt;next = p;</code> looks wrong, the caller could have supplied a pointer to a NULL pointer as the argument."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1447850204, "post_id": 33779975, "comment_id": 55326746, "body": "And the two strncpy()s are frowned upon. Are <code>p-&gt;ifaces</code> and <code>p-&gt;mac</code> really strings ?"}], "answers": [{"comments": [{"owner": {"reputation": 2382, "user_id": 987607, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/292c76bb4fd91cc23e2dadb982471d59?s=128&d=identicon&r=PG", "display_name": "Germano Massullo", "link": "https://stackoverflow.com/users/987607/germano-massullo"}, "edited": false, "score": 0, "creation_date": 1447850684, "post_id": 33780084, "comment_id": 55327096, "body": "What <code>LL</code> stands for?"}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": true, "score": 2, "last_activity_date": 1447851019, "last_edit_date": 1447851019, "creation_date": 1447849668, "answer_id": 33780084, "question_id": 33779975, "link": "https://stackoverflow.com/questions/33779975/segmentation-fault-in-copying-structures-data-into-a-linked-list/33780084#33780084", "title": "segmentation fault in copying structure&#39;s data into a linked list", "body": "<p>Replace</p>\n\n<pre><code>p-&gt;next = NULL;\n(*vis_data_collection_tail)-&gt;next = p;\n(*vis_data_collection_tail) = p;\n</code></pre>\n\n<p>by:</p>\n\n<pre><code>p-&gt;next = *vis_data_collection_tail;\n*vis_data_collection_tail = p;\n</code></pre>\n\n<p>This works even if <code>*vis_data_collection_tail</code> happens to be NULL; the ->next pointer would get a NULL value. If it is <strong>not</strong> NULL, the p->next actually <em>steals</em> the node pointed at by <code>*vis_data_collection_tail</code>, so <code>p</code> inserts itself into the <em>linked list</em> at the place where <code>*vis_data_collection_tail</code> pointed.</p>\n"}], "owner": {"reputation": 2382, "user_id": 987607, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/292c76bb4fd91cc23e2dadb982471d59?s=128&d=identicon&r=PG", "display_name": "Germano Massullo", "link": "https://stackoverflow.com/users/987607/germano-massullo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 33780084, "answer_count": 1, "score": 2, "last_activity_date": 1447851019, "creation_date": 1447849381, "question_id": 33779975, "link": "https://stackoverflow.com/questions/33779975/segmentation-fault-in-copying-structures-data-into-a-linked-list", "title": "segmentation fault in copying structure&#39;s data into a linked list", "body": "<p>I am trying to copy the data of a structure into a linked list. At line <a href=\"https://github.com/Germano0/alfred-custom/blob/testing/vis/vis.c#L757\" rel=\"nofollow\">757</a></p>\n\n<pre><code>(*vis_data_collection_tail)-&gt;next = p;\n</code></pre>\n\n<p>I am getting a segmentation fault. I attach the whole function here and some Valgrind output</p>\n\n<pre><code>void insert_netjson_entry(struct vis_v1_extended** vis_data_collection_tail, struct vis_v1* data)\n{\n    struct vis_v1_extended* p;\n    p = malloc(sizeof(struct vis_v1_extended));\n    if(p == NULL)\n    {\n        perror(\"malloc failure\\n\");\n        exit(EXIT_FAILURE);\n    }\n    p-&gt;entries_n = data-&gt;entries_n;\n    p-&gt;iface_n = data-&gt;iface_n;\n    strncpy(p-&gt;ifaces, data-&gt;ifaces, sizeof(p-&gt;ifaces));\n    strncpy(p-&gt;mac,data-&gt;mac,sizeof(p-&gt;mac));\n\n    p-&gt;next = NULL;\n    (*vis_data_collection_tail)-&gt;next = p;\n    (*vis_data_collection_tail) = p;\n}\n</code></pre>\n\n<p><strong>Valgrind output</strong>:</p>\n\n<pre><code>[user@localhost alfred-custom] valgrind -v --leak-check=full  --show-leak-kinds=all batadv-vis --format=netjson\n==3055== Memcheck, a memory error detector\n==3055== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==3055== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==3055== Command: batadv-vis --format=netjson\n==3055== \n--3055-- Valgrind options:\n--3055--    -v\n--3055--    --leak-check=full\n--3055--    --show-leak-kinds=all\n--3055-- Contents of /proc/version:\n--3055--   Linux version 4.1.7-200.fc22.x86_64 (mockbuild@bkernel02.phx2.fedoraproject.org) (gcc version 5.1.1 20150618 (Red Hat 5.1.1-4) (GCC) ) #1 SMP Mon Sep 14 20:19:24 UTC 2015\n--3055-- Arch and hwcaps: AMD64, LittleEndian, amd64-rdtscp-sse3\n--3055-- Page sizes: currently 4096, max supported 4096\n--3055-- Valgrind library directory: /usr/lib64/valgrind\n--3055-- Reading syms from /usr/local/sbin/batadv-vis\n--3055-- Reading syms from /usr/lib64/ld-2.21.so\n--3055--   Considering /usr/lib/debug/.build-id/ee/633c103f1997ad3ef59386f51c0cc17bebafaf.debug ..\n--3055--   .. build-id is valid\n--3055-- Reading syms from /usr/lib64/valgrind/memcheck-amd64-linux\n--3055--    object doesn't have a symbol table\n--3055--    object doesn't have a dynamic symbol table\n--3055-- Scheduler: using generic scheduler lock implementation.\n--3055-- Reading suppressions file: /usr/lib64/valgrind/default.supp\n==3055== embedded gdbserver: reading from /tmp/vgdb-pipe-from-vgdb-to-3055-by-caterpillar-on-localhost.localdomain\n==3055== embedded gdbserver: writing to   /tmp/vgdb-pipe-to-vgdb-from-3055-by-caterpillar-on-localhost.localdomain\n==3055== embedded gdbserver: shared mem   /tmp/vgdb-pipe-shared-mem-vgdb-3055-by-caterpillar-on-localhost.localdomain\n==3055== \n==3055== TO CONTROL THIS PROCESS USING vgdb (which you probably\n==3055== don't want to do, unless you know exactly what you're doing,\n==3055== or are doing some strange experiment):\n==3055==   /usr/lib64/valgrind/../../bin/vgdb --pid=3055 ...command...\n==3055== \n==3055== TO DEBUG THIS PROCESS USING GDB: start GDB like this\n==3055==   /path/to/gdb batadv-vis\n==3055== and then give GDB the following command\n==3055==   target remote | /usr/lib64/valgrind/../../bin/vgdb --pid=3055\n==3055== --pid is optional if only one valgrind process is running\n==3055== \n--3055-- REDIR: 0x4019840 (ld-linux-x86-64.so.2:strlen) redirected to 0x380c10d1 (???)\n--3055-- Reading syms from /usr/lib64/valgrind/vgpreload_core-amd64-linux.so\n--3055--    object doesn't have a symbol table\n--3055-- Reading syms from /usr/lib64/valgrind/vgpreload_memcheck-amd64-linux.so\n--3055--    object doesn't have a symbol table\n==3055== WARNING: new redirection conflicts with existing -- ignoring it\n--3055--     old: 0x04019840 (strlen              ) R-&gt; (0000.0) 0x380c10d1 ???\n--3055--     new: 0x04019840 (strlen              ) R-&gt; (2007.0) 0x04c2bce0 strlen\n--3055-- REDIR: 0x40195a0 (ld-linux-x86-64.so.2:index) redirected to 0x4c2b880 (index)\n--3055-- REDIR: 0x40197c0 (ld-linux-x86-64.so.2:strcmp) redirected to 0x4c2cd90 (strcmp)\n--3055-- REDIR: 0x401a500 (ld-linux-x86-64.so.2:mempcpy) redirected to 0x4c2fd70 (mempcpy)\n--3055-- Reading syms from /usr/lib64/librt-2.21.so\n--3055--   Considering /usr/lib/debug/.build-id/45/e5e61b48fb063d1ca0438dc8d43c347aab44c2.debug ..\n--3055--   .. build-id is valid\n--3055-- Reading syms from /usr/lib64/libc-2.21.so\n--3055--   Considering /usr/lib/debug/usr/lib64/libc-2.21.so.debug ..\n--3055--   .. CRC mismatch (computed cade4483 wanted 72225548)\n--3055-- Reading syms from /usr/lib64/libpthread-2.21.so\n--3055--   Considering /usr/lib/debug/.build-id/6e/1fb69fc4248ca0819107eed38c9e8db0b645b3.debug ..\n--3055--   .. build-id is valid\n--3055-- REDIR: 0x50cc360 (libc.so.6:strcasecmp) redirected to 0x4a2372e (_vgnU_ifunc_wrapper)\n--3055-- REDIR: 0x50ce650 (libc.so.6:strncasecmp) redirected to 0x4a2372e (_vgnU_ifunc_wrapper)\n--3055-- REDIR: 0x50cbaeb (libc.so.6:memcpy@GLIBC_2.2.5) redirected to 0x4a2372e (_vgnU_ifunc_wrapper)\n--3055-- REDIR: 0x50c9d90 (libc.so.6:rindex) redirected to 0x4c2b560 (rindex)\n--3055-- REDIR: 0x50cbb40 (libc.so.6:memset) redirected to 0x4a2372e (_vgnU_ifunc_wrapper)\n--3055-- REDIR: 0x50cbbb0 (libc.so.6:__GI_memset) redirected to 0x4c2ef60 (memset)\n--3055-- REDIR: 0x50c8090 (libc.so.6:strlen) redirected to 0x4c2bc20 (strlen)\n--3055-- REDIR: 0x50c8500 (libc.so.6:__GI_strncmp) redirected to 0x4c2c3d0 (__GI_strncmp)\n--3055-- REDIR: 0x50c84b0 (libc.so.6:strncmp) redirected to 0x4a2372e (_vgnU_ifunc_wrapper)\n--3055-- REDIR: 0x50c9d50 (libc.so.6:strncpy) redirected to 0x4a2372e (_vgnU_ifunc_wrapper)\n--3055-- REDIR: 0x50dbea0 (libc.so.6:__GI_strncpy) redirected to 0x4c2bfd0 (__GI_strncpy)\n{\n--3055-- REDIR: 0x50cbd10 (libc.so.6:__GI_mempcpy) redirected to 0x4c2faa0 (__GI_mempcpy)\n  \"type\" : \"NetworkGraph\",\n--3055-- REDIR: 0x50d30e0 (libc.so.6:strchrnul) redirected to 0x4c2f8a0 (strchrnul)\n  \"version\" : \"2015.1-23-ga6b7b07-dirty\",\n  \"metric\" : \"TQ\",\n  \"nodes\" : [\n    { \"id\" : \"08:00:27:8f:b1:c2\",\n      \"properties\" : {\n            \"clients\" : [\n        \"33:33:ff:ec:0a:dc\",\n        \"33:33:00:00:00:01\",\n        \"01:00:5e:00:00:01\",\n        \"f2:03:8b:ec:0a:dc\"\n            ]\n--3055-- REDIR: 0x50c0400 (libc.so.6:malloc) redirected to 0x4c28bc9 (malloc)\n==3055== Invalid write of size 8\n==3055==    at 0x40300B: insert_netjson_entry (vis.c:757)\n==3055==    by 0x40328D: vis_read_answer (vis.c:889)\n==3055==    by 0x403505: vis_get_data (vis.c:959)\n==3055==    by 0x403919: main (vis.c:1086)\n==3055==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==3055== \n==3055== \n==3055== Process terminating with default action of signal 11 (SIGSEGV)\n==3055==  Access not within mapped region at address 0x0\n==3055==    at 0x40300B: insert_netjson_entry (vis.c:757)\n==3055==    by 0x40328D: vis_read_answer (vis.c:889)\n==3055==    by 0x403505: vis_get_data (vis.c:959)\n==3055==    by 0x403919: main (vis.c:1086)\n==3055==  If you believe this happened as a result of a stack\n==3055==  overflow in your program's main thread (unlikely but\n==3055==  possible), you can try to increase the size of the\n==3055==  main thread stack using the --main-stacksize= flag.\n==3055==  The main thread stack size used in this run was 8388608.\n          }    }--3055-- REDIR: 0x50c0760 (libc.so.6:free) redirected to 0x4c29ce3 (free)\n==3055== \n==3055== HEAP SUMMARY:\n==3055==     in use at exit: 16 bytes in 1 blocks\n==3055==   total heap usage: 1 allocs, 0 frees, 16 bytes allocated\n==3055== \n==3055== Searching for pointers to 1 not-freed blocks\n==3055== Checked 225,312 bytes\n==3055== \n==3055== 16 bytes in 1 blocks are still reachable in loss record 1 of 1\n==3055==    at 0x4C28C50: malloc (in /usr/lib64/valgrind/vgpreload_memcheck-amd64-linux.so)\n==3055==    by 0x402F9B: insert_netjson_entry (vis.c:745)\n==3055==    by 0x40328D: vis_read_answer (vis.c:889)\n==3055==    by 0x403505: vis_get_data (vis.c:959)\n==3055==    by 0x403919: main (vis.c:1086)\n==3055== \n==3055== LEAK SUMMARY:\n==3055==    definitely lost: 0 bytes in 0 blocks\n==3055==    indirectly lost: 0 bytes in 0 blocks\n==3055==      possibly lost: 0 bytes in 0 blocks\n==3055==    still reachable: 16 bytes in 1 blocks\n==3055==         suppressed: 0 bytes in 0 blocks\n==3055== \n==3055== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n==3055== \n==3055== 1 errors in context 1 of 1:\n==3055== Invalid write of size 8\n==3055==    at 0x40300B: insert_netjson_entry (vis.c:757)\n==3055==    by 0x40328D: vis_read_answer (vis.c:889)\n==3055==    by 0x403505: vis_get_data (vis.c:959)\n==3055==    by 0x403919: main (vis.c:1086)\n==3055==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==3055== \n==3055== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\nErrore di segmentazione (core dump creato)\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1447849422, "post_id": 33779594, "comment_id": 55326213, "body": "With higher precision you may only be moving the problem further into more insignificant digits \u2013 there is no guarantee <code>599.9</code> can be represented exactly as a double either. That is, it may still round up or down at will in a direction unknown (for the OP at least). Suggestion: change <code>if (T&gt;=280. &amp;&amp; T&lt;=599.9)</code> to <code>if (T&gt;=280. &amp;&amp; T&lt;600.0)</code>."}, {"owner": {"reputation": 39, "user_id": 5576343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8104145d7d51af8c25ae30cc8927134?s=128&d=identicon&r=PG&f=1", "display_name": "ciprian", "link": "https://stackoverflow.com/users/5576343/ciprian"}, "edited": false, "score": 0, "creation_date": 1447849434, "post_id": 33779594, "comment_id": 55326220, "body": "I followed your advice (599.9f) and now it works. Thanks"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 4, "last_activity_date": 1447849572, "last_edit_date": 1447849572, "creation_date": 1447848247, "answer_id": 33779594, "question_id": 33779504, "link": "https://stackoverflow.com/questions/33779504/whats-wrong-with-the-ranges-for-my-variable/33779594#33779594", "title": "What&#39;s wrong with the ranges for my variable?", "body": "<p>It's to do with <em>floating point imprecision</em> and your mixing <code>double</code> and <code>float</code> types.</p>\n\n<p><code>599.9</code> is a double precision floating point literal, <code>T</code> is a <code>float</code>.</p>\n\n<p>The comparison <code>T &lt;= 599.9</code> will appear to misbehave for certain values of <code>T</code>. <code>T</code> will be promoted to a <code>double</code> prior to the expression being evaluated. It will retain the imprecision introduced by it being a <code>float</code> since the C standard mandates that <em>all</em> <code>float</code>s must be <em>exactly</em> representable by a <code>double</code>.</p>\n\n<p>You'd get more explainable boundaries if you were to either (i) use <code>599.9f</code> as the bounds (that's how you write a <code>float</code> literal), or (ii) use <code>double</code> for your types.</p>\n\n<p>But the floating point imprecision issues still hold: not all numbers can be represented exactly in that scheme: 599.9 is one such number under IEEE754. Assuming your compiler uses IEEE754, your specific problem arises because 599.9 in an IEEE754 32 bit is greater than 599.9 by a larger amount that 599.9 as an IEEE754 64 bit.</p>\n"}, {"tags": [], "owner": {"reputation": 1031, "user_id": 3933895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3eff8d3f5166ea0f7974afbfcdd5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Samidamaru", "link": "https://stackoverflow.com/users/3933895/samidamaru"}, "is_accepted": false, "score": 6, "last_activity_date": 1447848288, "creation_date": 1447848288, "answer_id": 33779604, "question_id": 33779504, "link": "https://stackoverflow.com/questions/33779504/whats-wrong-with-the-ranges-for-my-variable/33779604#33779604", "title": "What&#39;s wrong with the ranges for my variable?", "body": "<p>The reason is that unfortuantely, computers can't 100% accurately represent every number.</p>\n\n<p>If you print out your value of T after you read it in, you actually get 599.9000024 which is of course larger than 599.9 and uses the 3rd statement.</p>\n\n<p>You can temporarily get around this using double types instead of float which has a higher precision.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1447848424, "post_id": 33779609, "comment_id": 55325636, "body": "Not reliable? Floating point comparisons are not random. It&#39;s just that people have wrong expectations."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 1, "creation_date": 1447849391, "post_id": 33779609, "comment_id": 55326197, "body": "The comparisons are reliable, and wether or not you can do them while making sense is dependant on the actual number. There are values which can be finitely represented in both. The pitfall here is that people have false expectations when dealing with them."}, {"owner": {"reputation": 1804, "user_id": 4313775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kpFpj.jpg?s=128&g=1", "display_name": "David van rijn", "link": "https://stackoverflow.com/users/4313775/david-van-rijn"}, "edited": false, "score": 0, "creation_date": 1447853694, "post_id": 33779609, "comment_id": 55329314, "body": "Well, that&#39;s sort of what i meant. If you know your business, go ahead, but if you don&#39;t, dont trust <code>==</code> ;)"}], "tags": [], "owner": {"reputation": 1804, "user_id": 4313775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kpFpj.jpg?s=128&g=1", "display_name": "David van rijn", "link": "https://stackoverflow.com/users/4313775/david-van-rijn"}, "is_accepted": false, "score": 5, "last_activity_date": 1447848309, "creation_date": 1447848309, "answer_id": 33779609, "question_id": 33779504, "link": "https://stackoverflow.com/questions/33779504/whats-wrong-with-the-ranges-for-my-variable/33779609#33779609", "title": "What&#39;s wrong with the ranges for my variable?", "body": "<p>This is probably because you are converting floats and doubles, and thereby introducing rounding errors. It is sort of a rule of thumb that <code>float1 == float2</code> is never reliable. And the same for doubles. </p>\n"}], "owner": {"reputation": 39, "user_id": 5576343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8104145d7d51af8c25ae30cc8927134?s=128&d=identicon&r=PG&f=1", "display_name": "ciprian", "link": "https://stackoverflow.com/users/5576343/ciprian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 33779594, "answer_count": 3, "score": 1, "last_activity_date": 1447849572, "creation_date": 1447847965, "question_id": 33779504, "link": "https://stackoverflow.com/questions/33779504/whats-wrong-with-the-ranges-for-my-variable", "title": "What&#39;s wrong with the ranges for my variable?", "body": "<p>I have almost zero experience with programming but I have to write a simple C program which calculates the specific heat (Cp) as a function of temperature T.\nThe temperature range is split in smaller ranges in order to get accurate values for Cp.</p>\n\n<pre><code>#include &lt;stdio.h&gt;  \n#include &lt;math.h&gt;\n\nint main()\n{    \n    float T, cp1, cp2, cp3, cp4, cp5, cp6, cp7, cp8;                     /*variables */  \n\n    printf( \"Please enter temperature in Kelvin\\n\" );  /* Asks for temperature */\n    scanf( \"%f\", &amp;T );\n\n    cp1=1.67662377469456E-11*pow(T,6.)-4.1197828092268E-08*pow(T,5.)+0.0000418869586791152*pow(T,4.)-0.0225003443462658*pow(T,3.)+6.72987826198519*pow(T,2.)-1062.18721205927*T+73195.8387080729;\n    cp2=0.00525246395569212*pow(T,4.)-12.9485474717992*pow(T,3.)+11970.600895997*pow(T,2.)-4918448.82178862*T+757825839.152518;\n    cp3=6.63085194968153*pow(T,4.)-17170.4000395659*pow(T,3.)+16673480.6519115*pow(T,2.)-7196031423.69135*T+1164647463146.08;\n    cp4=-68.0819524480029*pow(T,5.)+222554.556013276*pow(T,4.)-291004129.724188*pow(T,3.)+190252342532.153*pow(T,2.)-62191220562433.3*T+8131793672657510;\n    cp5=9974.74747475981*pow(T,3.)-19674382.9004572*pow(T,2.)+12935329616.4157*T-2834856258114.32;\n    cp6=-4.14962557364299E-07*pow(T,6.)+0.000462300031790556*pow(T,5.)-0.0310330512189478*pow(T,4.)+62.8598088326175*pow(T,3.)-189691.032172151*pow(T,2.)+77129922.3433911*T-4056849697.67083;\n    cp7=1.47773054803578E-08*pow(T,6.)-0.0000239186385308144*pow(T,5.)+0.00563616606939476*pow(T,4.)+1.50391266948934*pow(T,3.)+9118.7111011683*pow(T,2.)-8897122.07353999*T+2172208386.41784;\n    cp8=-4.6626284146362E-08*pow(T,5.)+0.000192659539297423*pow(T,4.)-0.318404373982708*pow(T,3.)+263.141418952148*pow(T,2.)-108775.736711323*T+18001673.992402;\n\n\n    if (T&gt;=280. &amp;&amp; T&lt;=599.9) {                      /* 1st temp range !!! If 599.9 is entered, the program calculates cp2 instead of cp1*/ \n        printf (\"1st range Cp= %.6f J/kgK\",cp1);                    /* returns cp1 */\n    }\n    else if (T&gt;599.9 &amp;&amp; T&lt;=646.8) {            /* 2nd temp range */ \n        printf(\"2nd range Cp= %.6f J/kgK\",cp2);                 /* returns cp2 */\n    }\n    else if (T&gt;646.8 &amp;&amp; T&lt;=651.2) {            /* 3rd temp range !!! If 651.2 is entered, the program calculates cp4 instead of cp3*/ \n        printf(\"3rd range Cp= %.6f J/kgK\",cp3);                 /* returns cp3 */\n    }\n    else if (T&gt;651.2 &amp;&amp; T&lt;=655.8) {            /* 4th temp range */ \n        printf(\"4th range Cp= %.6f J/kgK\",cp4);                 /* returns cp4 */\n    }\n    else if (T&gt;655.8 &amp;&amp; T&lt;=656.6) {            /* 5th temp range */ \n        printf(\"5th range Cp= %.6f J/kgK\",cp5);                 /* returns cp5 */\n    }\n    else if (T&gt;656.6 &amp;&amp; T&lt;=662.) {            /* 6th temp range */ \n        printf(\"6th range Cp= %.6f J/kgK\",cp6);                 /* returns cp6 */\n    }\n    else if (T&gt;662. &amp;&amp; T&lt;=700.) {            /* 7th temp range */ \n        printf(\"7th range Cp= %.6f J/kgK\",cp7);                 /* returns cp7 */\n    }\n    else if (T&gt;700. &amp;&amp; T&lt;=900.) {            /* 8th temp range */ \n        printf(\"8th range Cp= %.6f J/kgK\",cp8);                 /* returns cp8 */\n    }\n    else {\n        printf(\"Cp= 4180 J/kgK\");     /* Executed if no other statement is */\n    }\n\n  return 0;\n}\n</code></pre>\n\n<p>The code may not be elegant but it works except for the 1st range and the 3rd range.</p>\n\n<p>For the first range</p>\n\n<pre><code>if (T&gt;=280. &amp;&amp; T&lt;=599.9) {                      /* 1st temp range If 599.9 is entered, the program calculates cp2 instead of cp1*/ \n        printf (\"1st range Cp= %.6f J/kgK\",cp1);                    /* returns cp1 */\n    }\n</code></pre>\n\n<p>if I enter T equal to 599.9 the calculation for value Cp is done with the equation cp2 instead of cp1.\nThe same happens for the 3rd temperature range. If I enter T equal to 651.2, Cp is calculated with cp4 instead cp3.\nI don't understand why. The rest works just fine.\nThe code is compiled with portable Dev-C++ 5.11.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "file", "cmake", "clion"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447847906, "post_id": 33779442, "comment_id": 55325287, "body": "Interesting, I think of a quick but ugly solution. To write a <code>POST_BUILD</code> command."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447848009, "post_id": 33779442, "comment_id": 55325356, "body": "I hope the duplicate question helps."}, {"owner": {"reputation": 11, "user_id": 5503770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7db69bfd6363fbbb26276024546aa3?s=128&d=identicon&r=PG&f=1", "display_name": "gent", "link": "https://stackoverflow.com/users/5503770/gent"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1447850262, "post_id": 33779442, "comment_id": 55326798, "body": "@iharob Thank you, the solution in the duplicate worked"}], "owner": {"reputation": 11, "user_id": 5503770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7db69bfd6363fbbb26276024546aa3?s=128&d=identicon&r=PG&f=1", "display_name": "gent", "link": "https://stackoverflow.com/users/5503770/gent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "closed_date": 1447847987, "answer_count": 0, "score": 1, "last_activity_date": 1447847761, "creation_date": 1447847761, "question_id": 33779442, "link": "https://stackoverflow.com/questions/33779442/how-to-tell-cmake-to-put-non-c-files-in-the-executable-directory", "closed_reason": "Duplicate", "title": "How to tell CMake to put non-c files in the executable directory?", "body": "<p>I'm trying to write a little webserver in C, using CLion. I do have some HTML files representing 404 error pages, default pages, etc. These files are in a folder inside the main project, and when I need to refer to them in the C source, the path I use is <code>./pages/page.html</code>.</p>\n\n<p>The program works fine if I compile and run it manually inside the main project directory, but when I try to use CLion to run the program, the HTML files are not found and the program crashes, because the executable is not inside the directory where the <code>pages</code> folder is. What I would like to do is to configure CMake so that the directory <code>./pages</code> will be copied and placed inside the folder where the executable will be put into.</p>\n\n<p>Is there a way to do such a thing?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "file", "save", "line"], "comments": [{"owner": {"reputation": 3, "user_id": 4882580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2VJ_Pb2NNrI/AAAAAAAAAAI/AAAAAAAAABg/iqSZO_8x7_k/photo.jpg?sz=128", "display_name": "lala lily", "link": "https://stackoverflow.com/users/4882580/lala-lily"}, "edited": false, "score": 0, "creation_date": 1447847451, "post_id": 33779295, "comment_id": 55324975, "body": "P.S. I need to store it in a variable as I still have something to do with it. :)"}, {"owner": {"reputation": 33210, "user_id": 211659, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31c59c3ebec3e38517c37e8b1d5cb9de?s=128&d=identicon&r=PG", "display_name": "\u0160imon T&#243;th", "link": "https://stackoverflow.com/users/211659/%c5%a0imon-t%c3%b3th"}, "edited": false, "score": 0, "creation_date": 1447847601, "post_id": 33779295, "comment_id": 55325075, "body": "You are skipping the first line because you are not using the content of <code>string_0</code>. You are just discarding it."}], "answers": [{"comments": [{"owner": {"reputation": 33210, "user_id": 211659, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31c59c3ebec3e38517c37e8b1d5cb9de?s=128&d=identicon&r=PG", "display_name": "\u0160imon T&#243;th", "link": "https://stackoverflow.com/users/211659/%c5%a0imon-t%c3%b3th"}, "edited": false, "score": 0, "creation_date": 1447848026, "post_id": 33779406, "comment_id": 55325372, "body": "Plus also read the remainder of the line if it&#39;s longer than 256 characters."}, {"owner": {"reputation": 3, "user_id": 4882580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2VJ_Pb2NNrI/AAAAAAAAAAI/AAAAAAAAABg/iqSZO_8x7_k/photo.jpg?sz=128", "display_name": "lala lily", "link": "https://stackoverflow.com/users/4882580/lala-lily"}, "edited": false, "score": 0, "creation_date": 1447957113, "post_id": 33779406, "comment_id": 55388289, "body": "Thank youuuuuu. I really appreciate it :D. I finally got it working, and I need every line to be saved in *words_per_line[100]. But the problem is that only the last line of the file is saved for every run of while loop. I followed your correction and just added for words_per_line[i]= line i. Sorry if Im bothering you, I just really need to store it in an array of strings. :&#39;)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1447848109, "last_edit_date": 1447848109, "creation_date": 1447847677, "answer_id": 33779406, "question_id": 33779295, "link": "https://stackoverflow.com/questions/33779295/how-to-save-every-line-in-file-in-c-in-a-variable/33779406#33779406", "title": "How to save every line in file (IN C) in a variable? :)", "body": "<p>You're skipping over the check every odd number of lines, as you have two successive <code>fgets()</code> calls and only one <code>strcmp()</code>. Reduce your code to</p>\n\n<pre><code>while(fgets(string_0,256,file) != NULL) \n    {    \n        if( ! strcmp(string_0, string2) )\n            printf(\"A match has been found\\n\");\n    }\n</code></pre>\n\n<p>FWIW, <code>fgets()</code> reads and stores the trailing newline, which can cause problem is string comparison, you need to take care of that, too.</p>\n\n<p>As a note, you should always check the return value of <code>fopen()</code> for success before using the returned pointer.</p>\n"}], "owner": {"reputation": 3, "user_id": 4882580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2VJ_Pb2NNrI/AAAAAAAAAAI/AAAAAAAAABg/iqSZO_8x7_k/photo.jpg?sz=128", "display_name": "lala lily", "link": "https://stackoverflow.com/users/4882580/lala-lily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1332, "favorite_count": 0, "accepted_answer_id": 33779406, "answer_count": 1, "score": 0, "last_activity_date": 1447848109, "creation_date": 1447847349, "question_id": 33779295, "link": "https://stackoverflow.com/questions/33779295/how-to-save-every-line-in-file-in-c-in-a-variable", "title": "How to save every line in file (IN C) in a variable? :)", "body": "<p>I need to save every line of text file in c in a variable.\nHere's my code</p>\n\n<pre><code>int main()\n{\n    char firstname[100];\n    char lastname[100];\n    char string_0[256];\n    char string[256] = \"Vanilla Twilight\";\n    char string2[256];\n\n    FILE *file;\n    file = fopen(\"record.txt\",\"r\");\n\n    while(fgets(string_0,256,file) != NULL) \n    {\n\n        fgets(string2, 256, file);\n        printf(\"%s\\n\", string2);\n\n\n        if(strcmp(string, string2)==0)\n            printf(\"A match has been found\");\n    }\n\n    fclose(file);\n    return 0;\n}\n</code></pre>\n\n<p>Some lines are stored in the variable and printed on the cmd but some are skipped. </p>\n\n<p>What should I do? When I tried sscanf(), all lines were complete but only the first word of each line is printed. I also tried ffscanf() but isn't working too. In fgets(), words per line are complete, but as I've said, some lines are skipped (even the first line).\nI'm just a beginner in programming, so I really need help. :(</p>\n"}, {"tags": ["c", "solaris", "iconv", "wchar-t", "libiconv"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1447846332, "post_id": 33778718, "comment_id": 55324283, "body": "Two Solaris 8 documents that should help are here:  <a href=\"http://docs.oracle.com/cd/E19455-01/816-3328/6m9k8pg1o/index.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19455-01/816-3328/6m9k8pg1o/index.html</a> and here:  <a href=\"http://docs.oracle.com/cd/E19455-01/816-3321/6m9k23sb4/index.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19455-01/816-3321/6m9k23sb4/index.html</a>"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1447847184, "post_id": 33778718, "comment_id": 55324817, "body": "Your application can call <a href=\"http://docs.oracle.com/cd/E23824_01/html/821-1465/setlocale-3c.html\" rel=\"nofollow noreferrer\"><code>setlocale</code></a> to change its locale."}, {"owner": {"reputation": 3991, "user_id": 1343979, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cde802f2b3fae0e23f43a65b507bd05?s=128&d=identicon&r=PG", "display_name": "Bass", "link": "https://stackoverflow.com/users/1343979/bass"}, "reply_to_user": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1447847917, "post_id": 33778718, "comment_id": 55325294, "body": "@ThomasDickey: Thanks, but <code>setlocale</code> is not thread-safe and is not suitable for multiple conversions from/to multiple (&gt;2) charsets."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 1, "creation_date": 1447895679, "post_id": 33778718, "comment_id": 55353975, "body": "Your sample program does not threading, and this detail was not mentioned in the question."}], "answers": [{"tags": [], "owner": {"reputation": 3991, "user_id": 1343979, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cde802f2b3fae0e23f43a65b507bd05?s=128&d=identicon&r=PG", "display_name": "Bass", "link": "https://stackoverflow.com/users/1343979/bass"}, "is_accepted": true, "score": 0, "last_activity_date": 1448007309, "creation_date": 1448007309, "answer_id": 33821893, "question_id": 33778718, "link": "https://stackoverflow.com/questions/33778718/iconv-open-returning-einval-on-solaris-8/33821893#33821893", "title": "iconv_open() returning EINVAL on Solaris 8", "body": "<p>Running <a href=\"https://docs.oracle.com/cd/E19455-01/806-3488/6jckpug1o/index.html\" rel=\"nofollow\"><code>sdtconvtool</code></a> shows most legacy codepages are supported. </p>\n\n<p>After re-running the same utility with <code>truss -u libc::iconv_open</code>, I learnt that conversion from one single-byte encoding to another single-byte one is done in two steps, with intermediate conversion to <code>UTF-8</code>.</p>\n\n<p>Speaking of conversion from <code>\"WCHAR_T\"</code>, <code>iconv(3)</code> also does support it, but <code>\"UCS-4\"</code> should be used as a source charset name since <code>sizeof(wchar_t)</code> is 4 on Solaris (for both x86 and SPARC).</p>\n"}], "owner": {"reputation": 3991, "user_id": 1343979, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cde802f2b3fae0e23f43a65b507bd05?s=128&d=identicon&r=PG", "display_name": "Bass", "link": "https://stackoverflow.com/users/1343979/bass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 33821893, "answer_count": 1, "score": 0, "last_activity_date": 1448007309, "creation_date": 1447845614, "question_id": 33778718, "link": "https://stackoverflow.com/questions/33778718/iconv-open-returning-einval-on-solaris-8", "title": "iconv_open() returning EINVAL on Solaris 8", "body": "<p>In <em>Solaris 8</em>, it looks like <code>iconv*()</code> family of functions is broken and only supports conversion between single-byte charsets and <code>UTF-8</code>, which can be verified using this code example:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;iconv.h&gt;\n\n#if defined(__sun) &amp;&amp; defined(__SVR4)\n#define CP1251 \"ansi-1251\"\n#define ISO_8859_5 \"ISO8859-5\"\n#else\n#define CP1251 \"CP1251\"\n#define ISO_8859_5 \"ISO-8859-5\"\n#endif\n\nvoid iconv_open_debug(const char *, const char *);\n\nint main() {\n    iconv_open_debug(CP1251, CP1251);\n    iconv_open_debug(CP1251, ISO_8859_5);\n    iconv_open_debug(CP1251, \"KOI8-R\");\n    iconv_open_debug(CP1251, \"UTF-8\");\n    iconv_open_debug(CP1251, \"WCHAR_T\");\n\n    iconv_open_debug(ISO_8859_5, CP1251);\n    iconv_open_debug(ISO_8859_5, ISO_8859_5);\n    iconv_open_debug(ISO_8859_5, \"KOI8-R\");\n    iconv_open_debug(ISO_8859_5, \"UTF-8\");\n    iconv_open_debug(ISO_8859_5, \"WCHAR_T\");\n\n    iconv_open_debug(\"KOI8-R\", CP1251);\n    iconv_open_debug(\"KOI8-R\", ISO_8859_5);\n    iconv_open_debug(\"KOI8-R\", \"KOI8-R\");\n    iconv_open_debug(\"KOI8-R\", \"UTF-8\");\n    iconv_open_debug(\"KOI8-R\", \"WCHAR_T\");\n\n    iconv_open_debug(\"UTF-8\", CP1251);\n    iconv_open_debug(\"UTF-8\", ISO_8859_5);\n    iconv_open_debug(\"UTF-8\", \"KOI8-R\");\n    iconv_open_debug(\"UTF-8\", \"UTF-8\");\n    iconv_open_debug(\"UTF-8\", \"WCHAR_T\");\n\n    iconv_open_debug(\"WCHAR_T\", CP1251);\n    iconv_open_debug(\"WCHAR_T\", ISO_8859_5);\n    iconv_open_debug(\"WCHAR_T\", \"KOI8-R\");\n    iconv_open_debug(\"WCHAR_T\", \"UTF-8\");\n    iconv_open_debug(\"WCHAR_T\", \"WCHAR_T\");\n\n    return 0;\n}\n\nvoid iconv_open_debug(const char *from, const char *to) {\n    errno = 0;\n    if (iconv_open(to, from) == (iconv_t) -1) {\n        fprintf(stderr, \"iconv_open(\\\"%s\\\", \\\"%s\\\") FAIL: errno = %d\\n\", to, from, errno);\n        perror(\"iconv_open()\");\n    } else {\n        fprintf(stdout, \"iconv_open(\\\"%s\\\", \\\"%s\\\") PASS\\n\", to, from);\n    }\n}\n</code></pre>\n\n<p>which only prints</p>\n\n<pre><code>iconv_open(\"UTF-8\", \"ansi-1251\") PASS\niconv_open(\"UTF-8\", \"ISO8859-5\") PASS\niconv_open(\"UTF-8\", \"KOI8-R\") PASS\niconv_open(\"ansi-1251\", \"UTF-8\") PASS\niconv_open(\"ISO8859-5\", \"UTF-8\") PASS\niconv_open(\"KOI8-R\", \"UTF-8\") PASS\n</code></pre>\n\n<p>to stdout and returns <code>EINVAL</code> for other pairs. Note that even conversion to the same charset (e.g. UTF-8 -> UTF-8) is not supported.</p>\n\n<h3>Questions</h3>\n\n<ol>\n<li>Can anyone reference a document describing the limitations of <em>Solaris</em> version of <code>iconv.h</code>?</li>\n<li>How can I convert a <code>wchar_t*</code> to a single- or multibyte string w/o relying on <em>GNU</em> <code>libiconv</code>? <code>wcstombs()</code> <em>would be</em> fine except that it relies on the current locale's charset, while I want a wide string converted to a regular string using a particular charset, possibly different from the default one.</li>\n</ol>\n"}, {"tags": ["c", "string"], "answers": [{"comments": [{"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 2, "creation_date": 1447845619, "post_id": 33778579, "comment_id": 55323813, "body": "Its not my intention to dishonor your answer, but how can you know that it isn&#39;t working as expected? I can&#39;t even extract from this OP, what he is expecting."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1447845760, "post_id": 33778579, "comment_id": 55323904, "body": "@Olaf edited to add a bit clarification, does it sound ok now?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1447845799, "post_id": 33778579, "comment_id": 55323933, "body": "@Zaibis well, I took reference of the previous printf statement and the o/p, that&#39;s all."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 2, "creation_date": 1447845984, "post_id": 33778579, "comment_id": 55324054, "body": "@Zaibis: Clairvoyance;-) Seriously: This is a typical beginners error (often because they don&#39;t read/understand the book properly or follow the lessons)."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1447845736, "last_edit_date": 1447845736, "creation_date": 1447845193, "answer_id": 33778579, "question_id": 33778538, "link": "https://stackoverflow.com/questions/33778538/equality-check-doesnt-work-as-expected/33778579#33778579", "title": "Equality check doesn&#39;t work as expected", "body": "<p>In your code,</p>\n\n<pre><code>temp[i] == temp[j]\n</code></pre>\n\n<p>is not going to work <em>as expected</em> as the operands are pointers and what you want is to compare the contents of the memory pointed by the pointers, not the pointers themselves.</p>\n\n<p>You need to use <a href=\"http://linux.die.net/man/3/strcmp\" rel=\"nofollow\"><code>strcmp()</code></a> to perform the comparisons.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 5210090, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b2bd4b9c62f931dadccb132a0e7ebd3e?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Sharma", "link": "https://stackoverflow.com/users/5210090/avinash-sharma"}, "is_accepted": false, "score": 1, "last_activity_date": 1447847397, "last_edit_date": 1495541242, "creation_date": 1447847397, "answer_id": 33779307, "question_id": 33778538, "link": "https://stackoverflow.com/questions/33778538/equality-check-doesnt-work-as-expected/33779307#33779307", "title": "Equality check doesn&#39;t work as expected", "body": "<p>The problem here is that your comparison involves two pointers i.e. temp[i] and temp[j] are nothing but pointers pointing to a memory\nWhat you need to compare is the value pointed by those pointers you can do that by dereferencing the pointers using asterisk (*) operator i.e \n(*temp[i]) and (*temp[j]) or if you do not want to do it manually then \nuse strcmp as mentioned.\nRefer this \n<a href=\"https://stackoverflow.com/questions/3933614/c-string-using-equality-operator-for-comparing-two-strings-for-equality\">C String -- Using Equality Operator == for comparing two strings for equality</a></p>\n"}], "owner": {"reputation": 331, "user_id": 905487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3a43277edd62eb7e14d107f34ec03632?s=128&d=identicon&r=PG", "display_name": "Goran Zooferic", "link": "https://stackoverflow.com/users/905487/goran-zooferic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 33778579, "answer_count": 2, "score": -2, "last_activity_date": 1448730551, "creation_date": 1447845074, "last_edit_date": 1448730551, "question_id": 33778538, "link": "https://stackoverflow.com/questions/33778538/equality-check-doesnt-work-as-expected", "title": "Equality check doesn&#39;t work as expected", "body": "<p>As you can see at followed sample, I am comparing words those inside lyric variable and I want to get count's unique word but result returns <code>0</code>. Although there are 3 similar words as you can see in result, it doesn't enter into if block. What can cause this problem? </p>\n\n<p>You can test through <a href=\"https://www.codechef.com/ide\" rel=\"nofollow\">this</a> application quickly.</p>\n\n<p><strong>Source</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char* argv[]) {\n\n    char lyric[] =\"lorem ipsum is printing\\nlorem ipsum is letters\";\n    int i = 0, j = 0, k = 0, y = 0, l = 0, s = 0;\n\n    s = sizeof(lyric)/sizeof(char);\n\n    for(k; k&lt;s; ++k)\n    {\n        if(lyric[k] == ' ')\n            ++l;\n\n        if(lyric[k] == '\\n')\n            ++l;\n    }\n\n    char *row;\n    char *temp[l];\n\n    row = strtok (lyric,\" \\n\");\n\n    while (row != NULL)\n    {\n        temp[i++] = row;\n        row = strtok (NULL, \" \\n\");\n    }\n\n    for (i=0;i&lt;l; ++i){\n        for (j=(i+1);j&lt;l; ++j){\n\n            printf(\"%s == %s\\n\", temp[i], temp[j]);\n            if(temp[i] == temp[j]){\n                y++;\n            }\n        }\n    }\n\n    printf(\"Unique word count : %d\",y);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Result</strong></p>\n\n<pre><code>lorem == ipsum\nlorem == is\nlorem == printing\nlorem == lorem\nlorem == ipsum\nlorem == is\nipsum == is\nipsum == printing\nipsum == lorem\nipsum == ipsum\nipsum == is\nis == printing\nis == lorem\nis == ipsum\nis == is\nprinting == lorem\nprinting == ipsum\nprinting == is\nlorem == ipsum\nlorem == is\nipsum == is\n\nUnique word count : 0\n</code></pre>\n"}, {"tags": ["c", "client-server", "winsock"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 5528505, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9696e2c3a5bf42b7ba588ef9df0775ed?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041f\u0443\u0448\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5528505/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9f%d1%83%d1%88%d0%ba%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1447851387, "post_id": 33779966, "comment_id": 55327595, "body": "Thx, i will test it and look the results. But what if there&#39;s a situation where i dont really know how bytes long is the packet that I wait to come?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 319, "user_id": 5528505, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9696e2c3a5bf42b7ba588ef9df0775ed?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041f\u0443\u0448\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5528505/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9f%d1%83%d1%88%d0%ba%d0%b8%d0%bd"}, "edited": false, "score": 1, "creation_date": 1447851603, "post_id": 33779966, "comment_id": 55327747, "body": "Then you need a protocol where you first send a header that includes the size, and then the actual data bytes. Or, if the protocol dictates a stop sequence, then you <code>recv</code> one byte at a time until you get the stop sequence."}, {"owner": {"reputation": 319, "user_id": 5528505, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9696e2c3a5bf42b7ba588ef9df0775ed?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041f\u0443\u0448\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5528505/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9f%d1%83%d1%88%d0%ba%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1447860699, "post_id": 33779966, "comment_id": 55334812, "body": "I see. At this point I think the quesion is clear, thanks a lot."}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 1, "last_activity_date": 1447849363, "creation_date": 1447849363, "answer_id": 33779966, "question_id": 33778181, "link": "https://stackoverflow.com/questions/33778181/c-programm-hangs-when-recv-not-expected-amount-of-bytes/33779966#33779966", "title": "C programm hangs when recv() not expected amount of bytes", "body": "<p>You should only read one message at a time. If there are 2 messages available in the socket, your current code will read both but only handle the first.</p>\n\n<p>Change your read to: </p>\n\n<pre><code>            iResult = recv(ClientSocket, buff + numRcvBytes, sizeof(send_packet) - numRcvBytes, 0);\n</code></pre>\n\n<p>Even better would be to extract the receiving to a separate function:</p>\n\n<pre><code>int recvBytes(int socket, size_t numBytes, void *buffer) {\n    int numRcvBytes = 0;\n    while (numRcvBytes &lt; numBytes)\n    {\n        iResult = recv(socket, buff + numRcvBytes, numBytes - numRcvBytes, 0);\n        if (iResult == SOCKET_ERROR)\n        { \n            // Leave cleanup to caller\n            return SOCKET_ERROR;\n        }\n        numRcvBytes += iResult;\n    }\n    return numRcvBytes;\n}\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 5528505, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9696e2c3a5bf42b7ba588ef9df0775ed?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041f\u0443\u0448\u043a\u0438\u043d", "link": "https://stackoverflow.com/users/5528505/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9f%d1%83%d1%88%d0%ba%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 33779966, "answer_count": 1, "score": 0, "last_activity_date": 1447849363, "creation_date": 1447844176, "question_id": 33778181, "link": "https://stackoverflow.com/questions/33778181/c-programm-hangs-when-recv-not-expected-amount-of-bytes", "title": "C programm hangs when recv() not expected amount of bytes", "body": "<p>I have server side app in C that must read data and process it. Now it handles two messages: send screenshot to client and click mouse. When debugging I found that it receives 16 bytes when client ask a screenshot, but when I send click mouse message, server receives 32 bytes and hangs. Why is that happening and how to process all incoming packets correctly? I'am pretty new at winsock and there not much explaning informations or example how to handle data in wild. Here's the main code of server:</p>\n\n<pre><code>struct coord\n{\n    int x;\n    int y;\n};\n\n\nstruct send_packet\n{\n    int magic;\n    int cmd;\n    coord Coords;\n};\n\n\nstruct recv_packet\n{\n    int magic;\n    int code;\n    int length;\n    BYTE body[0];\n\n};\ndo\n        {\n            ZeroMemory(&amp;buff, BUFLEN);\n            int numRcvBytes = 0;\n            while (numRcvBytes &lt; sizeof(send_packet))\n            {\n                iResult = recv(ClientSocket, buff + numRcvBytes, BUFLEN, 0);\n                //if (iResult &lt;= 0)\n                //  closesocket(ClientSocket);\n                if (iResult == SOCKET_ERROR)\n                {\n                    printf(\"Error %d\", WSAGetLastError());\n                    closesocket(ClientSocket);\n                    WSACleanup();\n                }\n                numRcvBytes += iResult;\n\n            }\n\n            numRcvBytes = 0;        \n\n\n            if (iResult &gt; 0)\n            {\n                send_packet *pkt;\n                pkt = (send_packet *)buff;\n                printf(\"magc %d  cmd %d\\n\", pkt-&gt;magic, pkt-&gt;cmd);\n                printf(\"Received %d %s\\n\", iResult, buff);\n                printf(\"m:%d c:%d x:%d y:%d\\n\", pkt-&gt;magic, pkt-&gt;cmd, pkt-&gt;Coords.x, pkt-&gt;Coords.y);\n\n                int command = pkt-&gt;cmd;\n                recv_packet *rcv_pkt;\n                int buff_size = 0;\n                BYTE *data_buffer = NULL;\n                int size;\n\n                int coordX;\n                int coordY;\n\n                wchar_t message[512];\n\n                switch (command)\n                {\n                    case GET_SCREEN:\n\n                        data_buffer = GetScreeny(75, &amp;buff_size);\n                        rcv_pkt = (recv_packet *)malloc(sizeof(recv_packet)+buff_size);\n                        rcv_pkt-&gt;magic = MAGIC;\n                        rcv_pkt-&gt;code = 0;\n                        rcv_pkt-&gt;length = buff_size;\n                        memcpy(rcv_pkt-&gt;body, data_buffer, buff_size);\n                        size = sizeof(rcv_pkt-&gt;magic) + sizeof(rcv_pkt-&gt;code) + sizeof(rcv_pkt-&gt;length) + buff_size;\n\n                        if (send(ClientSocket, (char *)rcv_pkt, size, 0) == SOCKET_ERROR)\n                        {\n                            printf(\"Error %d\\n\", WSAGetLastError());\n                            closesocket(ClientSocket);\n                            //WSACleanup();\n                            //return 1;\n                        }\n\n                        free(rcv_pkt);\n\n                   break;\n\n                   case CLICK_MOUSE:\n\n                        coordX = pkt-&gt;Coords.x;\n                        coordY = pkt-&gt;Coords.y;\n                        //wsprintf(message, L\"x:%d y:%d\", coordX, coordY);\n                        //MessageBox(NULL, message, NULL, MB_OK);                           \n                        MoveMouse(coordX, coordY);\n                        ClickMouse();   \n\n                    break;\n\n                    default:\n                    break;\n                }\n\n\n                /*\n                char send_buff[1024+1] = \"\";\n                ZeroMemory(&amp;send_buff, 1025);\n                memset(send_buff, 'A', 1024);\n                recv_packet *rcv_pkt = (recv_packet *)malloc(sizeof(recv_packet)+1024+1);\n                //recv_packet rcv_pkt = { 0 };\n                rcv_pkt-&gt;magic = MAGIC;\n                rcv_pkt-&gt;code = 0;\n                rcv_pkt-&gt;length = strlen(send_buff)+1;\n                memcpy(rcv_pkt-&gt;body, send_buff, 1025);\n                int size = sizeof(rcv_pkt-&gt;magic) + sizeof(rcv_pkt-&gt;code) + sizeof(rcv_pkt-&gt;length) + 1024 + 1;\n                //printf(\"%d\", size);\n                //getchar();\n                //return 0;\n                */\n\n            }\n\n        } while (iResult &gt; 0);\n</code></pre>\n\n<p>I would appreciate any help! Thank you.</p>\n"}, {"tags": ["c", "linux", "pam"], "answers": [{"comments": [{"owner": {"reputation": 1204, "user_id": 2340506, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f56dceffae63967700184f7146d1dd44?s=128&d=identicon&r=PG", "display_name": "gaetanm", "link": "https://stackoverflow.com/users/2340506/gaetanm"}, "edited": false, "score": 0, "creation_date": 1447849553, "post_id": 33778633, "comment_id": 55326287, "body": "The thing is that it&#39;s useless in my case to run check_user manually. I want it to run automatically when a user log in. If I have to do it manually I don&#39;t understand why I have to put those two lines in <code>&#47;etc&#47;pam.d&#47;check_user</code>."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 1204, "user_id": 2340506, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f56dceffae63967700184f7146d1dd44?s=128&d=identicon&r=PG", "display_name": "gaetanm", "link": "https://stackoverflow.com/users/2340506/gaetanm"}, "edited": false, "score": 0, "creation_date": 1447851555, "post_id": 33778633, "comment_id": 55327714, "body": "This is just a sample to understand how to include pam calls in a C. You should not use it in a production system. Starting an application on log in is a completely different question."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 1204, "user_id": 2340506, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f56dceffae63967700184f7146d1dd44?s=128&d=identicon&r=PG", "display_name": "gaetanm", "link": "https://stackoverflow.com/users/2340506/gaetanm"}, "edited": false, "score": 0, "creation_date": 1447851716, "post_id": 33778633, "comment_id": 55327832, "body": "Actually you can also use pam to customise the login. I am editing my answer."}], "tags": [], "owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "is_accepted": false, "score": 0, "last_activity_date": 1447851958, "last_edit_date": 1492086988, "creation_date": 1447845332, "answer_id": 33778633, "question_id": 33777899, "link": "https://stackoverflow.com/questions/33777899/where-to-put-a-pam-module/33778633#33778633", "title": "Where to put a PAM module?", "body": "<p>The file you are linking is not a pam module, is just a short application written in C that uses pam_unix.so. You have to compile and run check_user.</p>\n\n<p>Actually, you are browsing the Linux PAM Application Developer's Guide, you may want to check the guide to modules development: <a href=\"http://www.linux-pam.org/Linux-PAM-html/Linux-PAM_MWG.html\" rel=\"nofollow noreferrer\">http://www.linux-pam.org/Linux-PAM-html/Linux-PAM_MWG.html</a></p>\n\n<p>If you need to start an application on logon (as stated in your comment) and you want to use pam, you can relay on pam_exec (<a href=\"http://linux.die.net/man/8/pam_exec\" rel=\"nofollow noreferrer\">http://linux.die.net/man/8/pam_exec</a>). </p>\n\n<p>Add this line to /etc/pam.d/login: </p>\n\n<pre><code>session         optional        pam_exec.so /usr/local/bin/my_prog\n</code></pre>\n\n<p>See also this post: <a href=\"https://unix.stackexchange.com/questions/122424/execute-a-command-on-user-logon\">https://unix.stackexchange.com/questions/122424/execute-a-command-on-user-logon</a></p>\n"}, {"tags": [], "owner": {"reputation": 1204, "user_id": 2340506, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f56dceffae63967700184f7146d1dd44?s=128&d=identicon&r=PG", "display_name": "gaetanm", "link": "https://stackoverflow.com/users/2340506/gaetanm"}, "is_accepted": true, "score": 1, "last_activity_date": 1447937364, "creation_date": 1447937364, "answer_id": 33804472, "question_id": 33777899, "link": "https://stackoverflow.com/questions/33777899/where-to-put-a-pam-module/33804472#33804472", "title": "Where to put a PAM module?", "body": "<p>For those who want to create a PAM module, there is a very good example here: <a href=\"https://github.com/beatgammit/simple-pam\" rel=\"nofollow\">https://github.com/beatgammit/simple-pam</a>.</p>\n\n<p>In my case, the functions to call in my PAM module to exec something at login/logout are:</p>\n\n<pre><code>PAM_EXTERN int pam_sm_open_session(pam_handle_t *pamh, int  flags,int argc, const char **argv ) {\n    printf(\"Connected\\n\");\n    return PAM_SUCCESS;\n}\n\nPAM_EXTERN int pam_sm_close_session(pam_handle_t *pamh, int  flags,int argc, const char **argv ) {\n    printf(\"Disconnected\\n\");\n    return PAM_SUCCESS;\n}\n</code></pre>\n\n<p>As indicated in the <code>README</code>, the <code>so</code> file needs to be put into <code>/lib/security/</code>.</p>\n"}], "owner": {"reputation": 1204, "user_id": 2340506, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f56dceffae63967700184f7146d1dd44?s=128&d=identicon&r=PG", "display_name": "gaetanm", "link": "https://stackoverflow.com/users/2340506/gaetanm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 33804472, "answer_count": 2, "score": 2, "last_activity_date": 1447937364, "creation_date": 1447843405, "question_id": 33777899, "link": "https://stackoverflow.com/questions/33777899/where-to-put-a-pam-module", "title": "Where to put a PAM module?", "body": "<p>I'm currently trying to test a PAM module, this one: <a href=\"http://www.linux-pam.org/Linux-PAM-html/adg-example.html\" rel=\"nofollow\">http://www.linux-pam.org/Linux-PAM-html/adg-example.html</a>.</p>\n\n<p>There is no indication about where to put the <code>.o</code> file.</p>\n\n<p>I tried to put it in <code>/lib/security</code> and <code>/usr/lib/security</code> but it doesn't work.</p>\n\n<p>I had no error while compiling:</p>\n\n<pre><code>$ gcc -fPIC -c check_user.c\n$ ld -x --shared -o check_user.so check_user.o\n</code></pre>\n\n<p>As indicated, I put those lines in <code>/etc/pam.d/check_user</code>:</p>\n\n<pre><code>auth       required     pam_unix.so\naccount    required     pam_unix.so\n</code></pre>\n\n<p>It doesn't seem to work because when I try to log in with another account I don't have the message. What's wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447845248, "post_id": 33777792, "comment_id": 55323532, "body": "How did you identify the process hierarchy tree? Please post the output."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5575937"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447845920, "post_id": 33777792, "comment_id": 55324010, "body": "I have not yet, I&#39;m still trying to find out how to do all 4 grandchild first. Once I get it I will go with the position Id number."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447953637, "post_id": 33777792, "comment_id": 55386148, "body": "the posted code logic is not correct for what you are trying to perform.  strongly suggest modifying the code to be &#39;direct&#39; about what it wants to do, rather than twiddling with a loop counter, various calls to <code>exit()</code> and various calls to <code>lanzanieto()</code>.  In the end, the &#39;direct&#39; approach will work much better."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1447953707, "post_id": 33777792, "comment_id": 55386193, "body": "the posted code is using a &#39;int&#39; as the type returned from fork(), however it actually returns a &#39;pid_t&#39;.  Note: the &#39;pid_t&#39; is defined in unistd.h."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5575937"}, "edited": false, "score": 0, "creation_date": 1447849336, "post_id": 33778985, "comment_id": 55326173, "body": "Thanks for your comment, but what you suggest is what I&#39;m doing but instead of an &quot;if&quot; I use a switch and a function to launch childs (lanzanieto(i))."}, {"owner": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "edited": false, "score": 0, "creation_date": 1448016417, "post_id": 33778985, "comment_id": 55414705, "body": "I&#39;ve added the solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5575937"}, "edited": false, "score": 0, "creation_date": 1448024837, "post_id": 33778985, "comment_id": 55419789, "body": "Thanks you Valentin, I followed your recommendation and I did so. You can see the final result in another thread that I open with new doubts.<a href=\"http://stackoverflow.com/questions/33804467/how-to-count-the-fork-processes-position/33805716?noredirect=1#comment55381314_33805716\" title=\"how to count the fork processes position\">stackoverflow.com/questions/33804467/&hellip;</a>"}, {"owner": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "edited": false, "score": 0, "creation_date": 1448029211, "post_id": 33778985, "comment_id": 55422657, "body": "If it fits your need it&#39;s ok. Consider validating the solution in order to close the question. Thanks."}], "tags": [], "owner": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "is_accepted": false, "score": 4, "last_activity_date": 1448016483, "last_edit_date": 1448016483, "creation_date": 1447846418, "answer_id": 33778985, "question_id": 33777792, "link": "https://stackoverflow.com/questions/33777792/creating-as-many-processes-you-want-with-fork/33778985#33778985", "title": "Creating as many processes you want with Fork()", "body": "<h1>Concept</h1>\n\n<p>Firstly, create a <code>fork()</code> will look like this :</p>\n\n<pre><code>id = fork(); \nif (id &lt; 0) {\n    /* error */\n    exit(1);\n} \nelse if (i &gt; 0) { /* Parent &gt; 0 */\n    /* parent logic */\n} \nelse { /* Child = 0 */\n    /* child logic */\n}\n</code></pre>\n\n<p><code>fork()</code> will create a child process along side the parent process.</p>\n\n<p>Therefore, if you want to match your tree (and based on your existing code), the process diagram will look like :</p>\n\n<pre><code>parent : fork()\n           |--&gt; parent : fork()\n           |               |--&gt; parent\n           |               |--&gt; child_2\n           |\n           |--&gt; child_1 : fork()\n                           |--&gt; child_1\n                           |--&gt; sub_child_1\n</code></pre>\n\n<p>To put it simply, you have to recursively <code>fork()</code> inside the parent and every new child process. </p>\n\n<p>However acknowledge that forking process that way aren't nice looking.</p>\n\n<p>It could be better to have a function, let's say <code>create_child()</code>, which fork only from the parent :</p>\n\n<pre><code>parent : create_fork()\n               |--&gt; parent : create_child()\n               |        |\n               |        |--&gt; parent : create_child()\n               |        |      |\n               |        |      |--&gt; parent \n               |        |      |--&gt; child_3 : do_whatever()\n               |        |\n               |        |--&gt; child_2 : do_whatever()\n               |        \n               |--&gt; child_1 : do_whatever()\n</code></pre>\n\n<h1>Solution</h1>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nvoid print_pid(char *proc_name)\n{\n    printf(\"%s: %d\\n\", proc_name, getpid());\n}\n\nint create_child(void)\n{\n    pid_t child_pid = fork();\n    if (child_pid == 0)\n    {\n        print_pid(\"child\");\n    }\n    else if (child_pid &lt; 0)\n    {\n        perror(\"create_child\");\n    }\n    return (child_pid);\n}\n\nint make_babies(int babies_number)\n{\n    /* if no baby */\n    if (babies_number &lt;= 0)\n        return 0;\n\n    /* if baby(ies) */\n    pid_t child_pid = create_child();\n    if (child_pid &gt; 0)\n    {\n        make_babies(babies_number - 1);\n        waitpid(child_pid, NULL, 0);\n    }\n    return child_pid;\n}\n\nint main(void)\n{\n    print_pid(\"parent\");\n    make_babies(50);\n    return errno;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5575937"}, "edited": false, "score": 0, "creation_date": 1447853226, "post_id": 33779270, "comment_id": 55328911, "body": "I see your point but how do you suggest me to kill that extra process?"}, {"owner": {"reputation": 2385, "user_id": 611142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0025019789cb7cfdf7061f7f1f8715c?s=128&d=identicon&r=PG", "display_name": "ymett", "link": "https://stackoverflow.com/users/611142/ymett"}, "edited": false, "score": 0, "creation_date": 1447860085, "post_id": 33779270, "comment_id": 55334342, "body": "@krm76 You don&#39;t kill it; you must make sure not to create it. In <code>lanzanieto()</code> you know whether you are the parent or child by the return value from the <code>fork</code> so you can decide what to do. (In <code>main</code> I see you use <code>exit(0)</code> in the child to avoid continuing -- you could do something similar in <code>lanzanieto()</code>."}], "tags": [], "owner": {"reputation": 2385, "user_id": 611142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0025019789cb7cfdf7061f7f1f8715c?s=128&d=identicon&r=PG", "display_name": "ymett", "link": "https://stackoverflow.com/users/611142/ymett"}, "is_accepted": false, "score": 1, "last_activity_date": 1447847264, "creation_date": 1447847264, "answer_id": 33779270, "question_id": 33777792, "link": "https://stackoverflow.com/questions/33777792/creating-as-many-processes-you-want-with-fork/33779270#33779270", "title": "Creating as many processes you want with Fork()", "body": "<p>You must remember that both the child process and the parent process continue executing the same code. When you call <code>lanzanieto(i)</code> twice in <code>case 1:</code> in <code>main()</code>, both the parent and the child from the first call to <code>lanzanieto(i)</code> (which are the child and grandchild of the original parent) continue on to the second call to <code>lanzanieto(i)</code>, so both produce another child.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5575937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1448303686, "creation_date": 1447843108, "last_edit_date": 1447849249, "question_id": 33777792, "link": "https://stackoverflow.com/questions/33777792/creating-as-many-processes-you-want-with-fork", "title": "Creating as many processes you want with Fork()", "body": "<p>I'm trying to get my head around the system call fork() and I'd like to create as many grandchild processes as I'd like. Basically all I want to achieve is:</p>\n\n<p>1 parent process with -> 2 child processes -> each child -> has two child processes (which are a total of 4 grandchild processes from the parent).</p>\n\n<pre><code>              parent\n          /           \\\n         /             \\\n    child1             child2\n    /    \\               /  \\\n   /      \\             /    \\\n  /        \\           /      \\\ng.child1  g.child2  g.child3  g.child4\n</code></pre>\n\n<p>So far I can get 3 out of the 4 grandchild but I'm also getting a new child from one of the grandchilds. This is the output I'm getting so far:</p>\n\n<pre><code>Process Pid: 5960 PPid: 5958 (position: 1).\nProcess Pid: 5959 PPid: 5958 (position: 0).\nProcess Pid: 5962 PPid: 5959 (position: 0).\nProcess Pid: 5961 PPid: 5960 (position: 1).\nProcess Pid: 5963 PPid: 5961 (position: 1).\nProcess Pid: 5964 PPid: 5960 (position: 1).\n</code></pre>\n\n<p>Any tips?</p>\n\n<p>Thank you</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n#define NUM_HIJOS 2 \n\nvoid lanzanieto(int i)\n{\n    int proceso;\n\n    proceso = fork();\n        if (proceso &gt; 0) {\n                wait(NULL);\n        } else if (proceso == 0) {\n            printf(\"Process Pid: %d PPid: %d (position: %d).\\n\",getpid(),getppid(), i);\n        } else if (proceso == -1) {\n            perror(\"fallo en fork\");\n            exit(EXIT_FAILURE);\n        }\n}\nint main(void)\n{\n    int proceso, i;\n\n    for (i=0; i&lt;NUM_HIJOS; i++) {\n        proceso = fork();\n\n        if (proceso == 0) {\n\n            switch(i) {\n                case 0:\n                    printf(\"Process Pid: %d PPid: %d (position: %d).\\n\",getpid(),getppid(), i);\n                    lanzanieto(i);\n                    exit(0);\n                case 1:\n                    printf(\"Process Pid: %d PPid: %d (position: %d).\\n\",getpid(),getppid(), i);\n                    lanzanieto(i);\n                    lanzanieto(i);\n                    exit(0);        \n            }\n\n        }  else if (proceso == -1) {\n            perror(\"fallo en fork\");\n            exit(EXIT_FAILURE);\n        }\n\n    }\n    proceso = wait(NULL);\n    while (proceso &gt; 0) {\n        proceso = wait(NULL);\n    }\n    /* ************************************* */\n    if (proceso == -1 &amp;&amp; errno != ECHILD) {\n        perror(\"fallo en wait\");\n        exit(EXIT_FAILURE);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1447842919, "post_id": 33777611, "comment_id": 55321897, "body": "You&#39;re confused between the hex <i>value</i> of an integer literal (which gets converted to a float) and the hex <i>representation</i> of a float. <code>0x12345678</code> == <code>305419904</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1447843487, "post_id": 33777778, "comment_id": 55322313, "body": "That&#39;s undefined even if the sizes match.  There&#39;s no guarantee that you can reference an <code>int</code> as a <code>float</code> by casting the address.  See <a href=\"http://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\" title=\"what is the strict aliasing rule\">stackoverflow.com/questions/98650/&hellip;</a>"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1447845115, "post_id": 33777778, "comment_id": 55323445, "body": "@AndrewHenle Thanks. Changed it to use a union instead which afaik should be OK."}, {"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "edited": false, "score": 0, "creation_date": 1447846404, "post_id": 33777778, "comment_id": 55324334, "body": "@unwind can you please also write the answer when you print floatVal?"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1447847913, "post_id": 33777778, "comment_id": 55325292, "body": "@unwind Using a union is also technically undefined behavior. The one and only standard-compliant way to reinterpret data like this is with <code>memcpy</code>."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1447859211, "post_id": 33777778, "comment_id": 55333644, "body": "@Sneftel Footnote 82 of C99TC3 makes using a union sound more like implementation-defined behavior, though."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 4, "last_activity_date": 1447847021, "last_edit_date": 1447847021, "creation_date": 1447843082, "answer_id": 33777778, "question_id": 33777611, "link": "https://stackoverflow.com/questions/33777611/float-and-double-in-c/33777778#33777778", "title": "Float and double in C", "body": "<p>You're expecting the integer literal (<code>0x12345678</code>) to be used to set the bits of the <code>float</code>, but that isn't what happens.</p>\n\n<p>Instead you get the actual integer (<code>0x12345678</code> is <code>305419896</code> in decimal); your code is exactly the same as if it had said</p>\n\n<pre><code>float floatVal = 305419896;\n</code></pre>\n\n<p>The hexadecimal number is just an integer, that it's hex has no special meaning.</p>\n\n<p>To do what you want, you'd to use an actual <a href=\"http://www.exploringbinary.com/hexadecimal-floating-point-constants/\" rel=\"nofollow\">hexadecimal float constant</a> perhaps, but that's a bit complicated.</p>\n\n<p>You can use a <code>union</code> to the bits in there:</p>\n\n<pre><code>const union {\n int integer;\n float real;\n} pair = { .integer = 0x12345678 };\nfloat floatVal = pair.real;\n</code></pre>\n\n<p>Note that the above is undefined if the sizes mismatch, and also (as you seem to be aware) endian-specific.</p>\n\n<p>If you print using <code>%e</code> or <code>%g</code> you will get the result you expect:</p>\n\n<pre><code>printf(\"%g\\n\", floatVal);\n</code></pre>\n\n<p>prints <code>5.69046e-28</code> on ideone.com.</p>\n"}, {"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1447843092, "creation_date": 1447843092, "answer_id": 33777783, "question_id": 33777611, "link": "https://stackoverflow.com/questions/33777611/float-and-double-in-c/33777783#33777783", "title": "Float and double in C", "body": "<p>Firstly you're confused between the hex <em>value</em> of an integer literal (which gets converted to a float) and the hex <em>representation</em> of a float. <code>0x12345678</code> == <code>305419904</code>.</p>\n\n<p>As for the increment of a float using <code>++</code> seemingly not working as expected - this is simply due to the finite precision of a single precision floating point representation. If you start with a smaller number then you will see the expected behaviour:</p>\n\n<pre><code> float f = 1.0f;  // f = 1.0\n f++;             // f = 2.0\n</code></pre>\n\n<p>However in your example:</p>\n\n<pre><code> float f = 305419904.0f;  // f = 305419904.0\n f++;                     // f = 305419904.0\n</code></pre>\n\n<p>Note that using <code>double</code> will give the correct result for this case:</p>\n\n<pre><code> double g = 305419904.0;  // g = 305419904.0\n g++;                     // g = 305419905.0\n</code></pre>\n"}], "owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447853296, "creation_date": 1447842638, "last_edit_date": 1495535288, "question_id": 33777611, "link": "https://stackoverflow.com/questions/33777611/float-and-double-in-c", "title": "Float and double in C", "body": "<p>Is the output correct for the following programs? I am using a Cygwin64 GCC compiler on a X86_64 Windows system. The architecture is little endian.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int i = 0;\n    float floatVal = 0x12345678;\n    do\n    {\n        printf(\"Hello World %f\\n\", floatVal);\n        floatVal++;\n        i++;\n    } while ( i &lt; 10 );\n    return 0;\n}\n\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\nHello World 305419904.000000\n</code></pre>\n\n<p>Question 1:\nHowever this website gives me a completely different answer: <a href=\"http://www.binaryconvert.com/result_float.html?hexadecimal=12345678\" rel=\"nofollow noreferrer\">http://www.binaryconvert.com/result_float.html?hexadecimal=12345678</a></p>\n\n<p>Question 2:\nWhy is the value not incrementing? The increments happen however if I use double instead of float.</p>\n\n<p>What am I doing wrong?</p>\n\n<hr>\n\n<p>Edit, after getting the correct answers:</p>\n\n<p>After getting the correct answers from unwind, I have a further question and to do the same in Java. Since Java, does not use unions, is there a way to do the conversion from integer to float the same way as the accepted answer in C. I found the answer here : </p>\n\n<p><a href=\"https://stackoverflow.com/questions/1310491/how-can-i-get-set-individual-bits-in-a-float\">How can I get/set individual bits in a float?</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 6, "creation_date": 1447842777, "post_id": 33777527, "comment_id": 55321794, "body": "<code>fgets()</code> retains the <code>newline</code> entered, please remove it."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1447842822, "post_id": 33777527, "comment_id": 55321817, "body": "What does &quot;the second program does not work&quot; mean exactly?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1447842883, "post_id": 33777527, "comment_id": 55321864, "body": "... you can check this by changing your print statement to <code>printf(&quot;[%s]&quot;, dateiname);</code> then you can see the <code>newline</code> is there."}, {"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "edited": false, "score": 0, "creation_date": 1447842918, "post_id": 33777527, "comment_id": 55321894, "body": "means i enter &quot;test.txt&quot; and the first block of code will open and read whatever is in test.txt und the second block will just do nothing"}, {"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "edited": false, "score": 0, "creation_date": 1447843310, "post_id": 33777527, "comment_id": 55322182, "body": "Thanks to Weather Vane (thank you! ) i can see, that fgets() adds a new line to the filename. Can you tell me how to avoid that fgets() adds the new line, althought its nessecary pressing the enter button to confirm the text entered?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447843329, "post_id": 33777527, "comment_id": 55322200, "body": "Please see my answer."}], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "edited": false, "score": 0, "creation_date": 1447843400, "post_id": 33777821, "comment_id": 55322249, "body": "Thank you Mister Vane, you saved me a lot of time!"}, {"owner": {"reputation": 3040, "user_id": 121921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50465e002a23f2f438beabd3ef33fad7?s=128&d=identicon&r=PG", "display_name": "AAT", "link": "https://stackoverflow.com/users/121921/aat"}, "edited": false, "score": 0, "creation_date": 1447843506, "post_id": 33777821, "comment_id": 55322323, "body": "@Weather Vane: I think you are right with your diagnosis of the problem but I am not so sure about your suggested cure! Have you considered what happens if your <code>strcspn()</code> trick is applied to a string which does <i>not</i> contain a CRLF? (Or indeed if the line terminator is not <code>\\r\\n</code> on the OP&#39;s system?)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3040, "user_id": 121921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50465e002a23f2f438beabd3ef33fad7?s=128&d=identicon&r=PG", "display_name": "AAT", "link": "https://stackoverflow.com/users/121921/aat"}, "edited": false, "score": 0, "creation_date": 1447843659, "post_id": 33777821, "comment_id": 55322423, "body": "@AAT it is completely safe. If not found, the string length is returned, so it overwrites the existing terminator."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3040, "user_id": 121921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50465e002a23f2f438beabd3ef33fad7?s=128&d=identicon&r=PG", "display_name": "AAT", "link": "https://stackoverflow.com/users/121921/aat"}, "edited": false, "score": 1, "creation_date": 1447843737, "post_id": 33777821, "comment_id": 55322479, "body": "@AAT the <code>newline</code> does not have to be both of those. Any match will do, now please read the man page for <code>strcspn</code>, it is <i>not</i> <code>strstr()</code>!!"}, {"owner": {"reputation": 3040, "user_id": 121921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50465e002a23f2f438beabd3ef33fad7?s=128&d=identicon&r=PG", "display_name": "AAT", "link": "https://stackoverflow.com/users/121921/aat"}, "edited": false, "score": 0, "creation_date": 1447844177, "post_id": 33777821, "comment_id": 55322770, "body": "@WeatherVane - many apologies, you are quite right! I was indeed thinking about <code>strstr()</code> and I should have read the man page (or MSDN) first. I am happy to fully endorse your answer."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 4, "last_activity_date": 1447843178, "creation_date": 1447843178, "answer_id": 33777821, "question_id": 33777527, "link": "https://stackoverflow.com/questions/33777527/why-scanf-works-but-fgets-doesnt-works-in-c/33777821#33777821", "title": "Why &quot;scanf&quot; works but fgets doesn&#39;t works in C?", "body": "<p>The reason is that <code>fgets()</code> retains the <code>newline</code> entered. You can verify it is there by altering your print statement to</p>\n\n<pre><code>printf(\"[%s]\", filename);\n</code></pre>\n\n<p>when the <code>]</code> will appear on the next line. You can remove the  trailing <code>newline</code> like this</p>\n\n<pre><code>#include &lt;string.h&gt;\n\n...\n\nfilename [ strcspn(filename, \"\\r\\n\") ] = 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "edited": false, "score": 0, "creation_date": 1447857248, "post_id": 33779436, "comment_id": 55332115, "body": "i thank you for correcting my code. i am stunned somehow, as i have found the feof(stream) -way to solve the task in a computer science book that is used at my university. I do not yet get the full picture of the problem that you describe but the code you wrote works with my programm and i am glad that you shared this with me!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1447859879, "post_id": 33779436, "comment_id": 55334185, "body": "This was one of those rare occasions where <code>feof()</code> was being used correctly, checking <i>after</i> the file read and not <i>before</i>, but you are right about detecting errors, which are flagged by the <code>EOF</code> from <code>fgetc()</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447886990, "post_id": 33779436, "comment_id": 55350967, "body": "@Weather Vane: that&#39;s what I meant by <i>most of the time</i>.  Just like <code>strncpy</code>, <code>feof</code> is almost never the right tool for the job.  <code>scanf</code> is next on the list of mostly misused C library functions."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1447886806, "last_edit_date": 1447886806, "creation_date": 1447847740, "answer_id": 33779436, "question_id": 33777527, "link": "https://stackoverflow.com/questions/33777527/why-scanf-works-but-fgets-doesnt-works-in-c/33779436#33779436", "title": "Why &quot;scanf&quot; works but fgets doesn&#39;t works in C?", "body": "<p>The main problem you experienced is correctly solved by Weather Vane, but I want to point another problem with your code:  the loops for reading and writing the contents of the file are incorrect.  Testing the end of file with <code>feof(stream)</code> leads to incorrect behaviour most of the time. In your case, a read error from <code>stream</code> will cause your program to loop endlessly, writing <code>0xFF</code> bytes to <code>stdout</code>.</p>\n\n<p>There is a much simpler and idiomatic way to implement this loop:</p>\n\n<pre><code>if (stream) {\n    int ch;\n\n    while ((ch = fgetc(stream)) != EOF) {\n        putchar(ch);\n    }\n    fclose(stream);\n}\n</code></pre>\n\n<p>As you can see, it is simpler and correctly tests for <code>EOF</code> at the right time, when input fails.  It stores the return value of <code>fgetc()</code> into an <code>int</code> variable capable of holding all possible return values from <code>fgetc()</code>.  Using an <code>int</code> is necessary because comparing a <code>char</code> value to <code>EOF</code> either always fails if the <code>char</code> type is unsigned or potentially gives false positives if <code>char</code> is signed and has value <code>'\\377'</code>.</p>\n"}], "owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 33777821, "answer_count": 2, "score": 0, "last_activity_date": 1447886806, "creation_date": 1447842423, "last_edit_date": 1447845310, "question_id": 33777527, "link": "https://stackoverflow.com/questions/33777527/why-scanf-works-but-fgets-doesnt-works-in-c", "title": "Why &quot;scanf&quot; works but fgets doesn&#39;t works in C?", "body": "<p>Look here, those two programms should be equivalent in my opinion. But obviously they aren't, as the first programm works and the second doesn't. Can someone explain to me, why fgets() doesn't do the job? </p>\n\n<pre><code>// FIRST PROGRAM : WORKS FINE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    FILE *stream;\n    char fileName[67];\n    scanf(\"%s\", fileName);\n    printf(\"%s\", fileName);\n    stream = fopen(fileName, \"r\");\n    char ch;\n    if(stream){\n        ch = fgetc(stream);\n        while(!feof(stream)){\n            putchar(ch);\n            ch = fgetc(stream);\n        }\n        fclose(stream);\n    }\n}\n\n\n// SECOND PROGRAM: DOES NOT WORK \n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    FILE *stream;\n    char fileName[67];\n    fgets(fileName, 67, stdin);\n    printf(\"%s\", fileName);\n    stream = fopen(fileName, \"r\");\n    char ch;\n    if(stream){\n        ch = fgetc(stream);\n        while(!feof(stream)){\n            putchar(ch);\n            ch = fgetc(stream);\n        }\n        fclose(stream);\n    }\n}\n</code></pre>\n\n<p>I enter \"test.txt\" into the console both times and press enter then. Of course test.txt exists in the right directory </p>\n"}, {"tags": ["c", "file", "audio", "binary", "pulseaudio"], "comments": [{"owner": {"reputation": 9263, "user_id": 1536976, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cc2372591e00f2ab504b59b4f7cbed43?s=128&d=identicon&r=PG", "display_name": "Trilarion", "link": "https://stackoverflow.com/users/1536976/trilarion"}, "edited": false, "score": 0, "creation_date": 1447842510, "post_id": 33777417, "comment_id": 55321595, "body": "Could you maybe condense your example code and remove everything that is not necessary for the problem to appear? This would make the question easier to answer."}, {"owner": {"reputation": 6190, "user_id": 1944784, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dd8b3d0343bf4c734ebbd7a18e2a9fe0?s=128&d=identicon&r=PG&f=1", "display_name": "4ae1e1", "link": "https://stackoverflow.com/users/1944784/4ae1e1"}, "edited": false, "score": 0, "creation_date": 1447843287, "post_id": 33777417, "comment_id": 55322167, "body": "<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447849056, "post_id": 33777871, "comment_id": 55326002, "body": "Check for warnings:  60:9: warning: format \u2018%x\u2019 expects argument of type \u2018unsigned int\u2019, but argument 2 has type \u2018uint8_t *\u2019 [-Wformat=]          printf(&quot;%x&quot;, buf);          ^"}, {"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1447850850, "post_id": 33777871, "comment_id": 55327220, "body": "i changed it to printf(&quot;%x&quot;, (unsigned int)buf);  but doesn&#39;t work"}], "tags": [], "owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "is_accepted": true, "score": 0, "last_activity_date": 1447843326, "creation_date": 1447843326, "answer_id": 33777871, "question_id": 33777417, "link": "https://stackoverflow.com/questions/33777417/pulseaudiosound-recorded-but-plays-annoying-sound/33777871#33777871", "title": "PulseAudio:sound recorded but plays annoying sound", "body": "<p>I deleted <strong>pa_simple_drain()</strong> (it was my mistake that i used this function in recording program)function from record program and now it works. But in <strong>printf(\"%x\", buf)</strong>  it still gives me back same hex value over and over again. But programs work great. Can someone exmplain why does it print same value?</p>\n"}], "owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 33777871, "answer_count": 1, "score": 0, "last_activity_date": 1447843326, "creation_date": 1447842090, "last_edit_date": 1447843038, "question_id": 33777417, "link": "https://stackoverflow.com/questions/33777417/pulseaudiosound-recorded-but-plays-annoying-sound", "title": "PulseAudio:sound recorded but plays annoying sound", "body": "<p>I'm new with PulseAudio. I'm trying to make simple programs. One would record the sound and save it in baniry file, and the other one should open it and play. Here is my code for recording:</p>\n\n<pre><code>#ifdef HAVE_CONFIG_H\n   #include &lt;config.h&gt;\n#endif\n\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pulse/simple.h&gt;\n#include &lt;pulse/error.h&gt;\n\n#define BUFSIZE 32\n\nint main(int argc, char*argv[])\n{\n\n     /* The Sample format to use */\n    static const pa_sample_spec ss = {\n               .format = PA_SAMPLE_S16LE, //16bit iqneba agwerili tito sample\n               .rate = 44100, //number of samples played in each second\n               .channels = 2\n            };\n\n    pa_simple *s_in = NULL;\n    int ret = 1;\n    int error;\n    int siri =0;\n\n\n    //file info\n    FILE* pFile;\n    char* yourFilePath  = \"xma.bin\";\n    pFile = fopen(yourFilePath,\"wb\");\n\n\n\n\n\n    if (!(s_in = pa_simple_new(NULL, argv[0], PA_STREAM_RECORD, NULL, \"record\", &amp;ss, NULL, NULL, &amp;error)))\n    {\n        fprintf(stderr, __FILE__\": pa_simple_new() failed: %s\\n\", pa_strerror(error));\n        goto finish;\n    }\n\n    for (;siri&lt;10000;siri+=1) \n    {\n        uint8_t buf[BUFSIZE];\n        ssize_t r;\n\n        int   yorBufferSize = strlen(buf) + 1;\n\n\n        /* Write your buffer to disk. */\n\n\n        if (pa_simple_read(s_in, buf, sizeof(buf), &amp;error) &lt; 0) \n        {\n\n            fprintf(stderr, __FILE__\": read() failed: %s\\n\", strerror(errno));\n            goto finish;\n        }\n\n\n\n       if (pFile)\n       {\n            fwrite(buf, yorBufferSize, 1, pFile);\n            puts(\"Wrote to file!\");\n       }\n       else\n       {\n            puts(\"Something wrong writing to File.\");\n       }\n\n\n    }\n\n\n    ret = 0;\n\n    finish:\n\n    if (s_in)\n        pa_simple_free(s_in);\n\n\n    return ret;\n    fclose(pFile);\n}\n</code></pre>\n\n<p>And here is my recording program:</p>\n\n<pre><code>#ifdef HAVE_CONFIG_H\n#include &lt;config.h&gt;\n#endif\n\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pulse/simple.h&gt;\n#include &lt;pulse/error.h&gt;\n\n#define BUFSIZE 32\n\nint main(int argc, char*argv[]) \n{\n\n    /* The Sample format to use */\n    static const pa_sample_spec ss = {\n        .format = PA_SAMPLE_S16LE, //16bit iqneba agwerili tito sample\n        .rate = 44100, //number of samples played in each second\n        .channels = 2\n    };\n\n    pa_simple *s_out = NULL;\n    int ret = 1;\n    int error;\n\n\n    //file info\n    FILE* pFile;\n    char* yourFilePath  = \"xma.bin\";\n    pFile = fopen(yourFilePath, \"rb\");\n\n\n\n     /* Create a new playback stream */\n     if (!(s_out = pa_simple_new(NULL, argv[0], PA_STREAM_PLAYBACK, NULL, \"playback\", &amp;ss, NULL, NULL, &amp;error))) \n     {\n         fprintf(stderr, __FILE__\": pa_simple_new() failed: %s\\n\", pa_strerror(error));\n         goto finish;\n     }\n\n    for (;;) \n    {\n        uint8_t buf[BUFSIZE];\n        fread(buf, sizeof(buf), 1, pFile);\n        ssize_t r;\n\n        if(feof(pFile))\n        {\n            break;\n        }\n\n\n        printf(\"%x\", buf);\n\n        /* ... and play it */\n        if (pa_simple_write(s_out, buf, sizeof(buf), &amp;error) &lt; 0) \n        {\n            fprintf(stderr, __FILE__\": pa_simple_write() failed: %s\\n\", pa_strerror(error));\n            goto finish;\n        }\n\n\n    }\n\n\n    /* Make sure that every single sample was played */\n    if (pa_simple_drain(s_out, &amp;error) &lt; 0) \n    {\n        fprintf(stderr, __FILE__\": pa_simple_drain() failed: %s\\n\", pa_strerror(error));\n        goto finish;\n    }\n\n    ret = 0;\n\n    finish:\n\n    if (s_out)\n        pa_simple_free(s_out);\n\n    return ret;\n    fclose(pFile);\n}\n</code></pre>\n\n<p>For loop in record program is just for time to record something(could not figure out how to set a timer) and I know that I should not use gotos but its for educational purposes(example provided on PulseAudio website). I tried hexdump of <strong>xma.bin</strong> and it gave me totally different ouput\nthan <strong>printf(\"%x\", buf);</strong> Basically printf only gives back <em>bf9fe15c</em> repeatedly and it make annoying sound. Hope you can help. thanks.</p>\n"}, {"tags": ["c++", "c", "performance", "opencv", "cuda"], "comments": [{"owner": {"reputation": 15243, "user_id": 1231073, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lSwuI.jpg?s=128&g=1", "display_name": "sgarizvi", "link": "https://stackoverflow.com/users/1231073/sgarizvi"}, "edited": false, "score": 0, "creation_date": 1447844431, "post_id": 33777338, "comment_id": 55322958, "body": "The first optimization you can do is to remove the redundant memory allocations and deletions inside <code>cudaCvtThreshold</code>. Just do a single device memory allocation in the <code>cudaTest</code> function and use it for subsequent <code>cudaCvtThreshold</code> calls. Also, opencv uses CPU vector instructions like SSE, SSE2, AVX etc inside its primitives which is one of the reason for its speed."}, {"owner": {"reputation": 15243, "user_id": 1231073, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lSwuI.jpg?s=128&g=1", "display_name": "sgarizvi", "link": "https://stackoverflow.com/users/1231073/sgarizvi"}, "edited": false, "score": 0, "creation_date": 1447845010, "post_id": 33777338, "comment_id": 55323363, "body": "Inside the kernel, you may use a register to store the result of grayscale conversion, and then threshold that value so that now global memory would have to be written only once, reducing the overhead of 1 global read and 1 global write. (Although the gpu may cache the memory access, but it is still worth a try)"}, {"owner": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "edited": false, "score": 0, "creation_date": 1447845544, "post_id": 33777338, "comment_id": 55323757, "body": "The compiler will avoid the intermediate write/read from global in this case. Still, that&#39;s good advice given the compiler can&#39;t always do this, especially if aliasing information isn&#39;t given,"}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1447846021, "post_id": 33777338, "comment_id": 55324079, "body": "The short answer is that both CPU and CUDA code are poor. As I understand, you expect that naive CPU implementation would be slow. And for CUDA, you cannot just move the code in the kernel and expect it will magically work faster. Parallel programming requires completely different thinking, data layouts and patterns. Not even mentioning your malloc and kernel launches inside the loop."}, {"owner": {"reputation": 467, "user_id": 2975743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c9ccbcf05b7a7ccae5f7895c314bafbc?s=128&d=identicon&r=PG&f=1", "display_name": "drakon", "link": "https://stackoverflow.com/users/2975743/drakon"}, "reply_to_user": {"reputation": 15243, "user_id": 1231073, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lSwuI.jpg?s=128&g=1", "display_name": "sgarizvi", "link": "https://stackoverflow.com/users/1231073/sgarizvi"}, "edited": false, "score": 0, "creation_date": 1447848866, "post_id": 33777338, "comment_id": 55325870, "body": "@sgarizvi: I made the decision to do malloc and free inside the function cudaCvtThreshold in order to have a function ready to be used directly with Mat objects. However I will post the same test with external malloc and free. I will do also one memory access in the Cuda kernel but I don&#39;t think this can cause a significant performance penalty."}, {"owner": {"reputation": 467, "user_id": 2975743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c9ccbcf05b7a7ccae5f7895c314bafbc?s=128&d=identicon&r=PG&f=1", "display_name": "drakon", "link": "https://stackoverflow.com/users/2975743/drakon"}, "reply_to_user": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1447849027, "post_id": 33777338, "comment_id": 55325983, "body": "@drop: the CPU code is voluntarily naive. For the Cuda Kernel honestly I don&#39;t know how to write more efficient code. At most I can save a memory access as sgarizvi suggests..."}, {"owner": {"reputation": 467, "user_id": 2975743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c9ccbcf05b7a7ccae5f7895c314bafbc?s=128&d=identicon&r=PG&f=1", "display_name": "drakon", "link": "https://stackoverflow.com/users/2975743/drakon"}, "edited": false, "score": 0, "creation_date": 1447851487, "post_id": 33777338, "comment_id": 55327663, "body": "I edited my question adding the results with the modified code (single malloc and free)"}, {"owner": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "edited": false, "score": 0, "creation_date": 1447853208, "post_id": 33777338, "comment_id": 55328896, "body": "Huh, looks like I was wrong about working through a tmp. Odd."}, {"owner": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "edited": false, "score": 0, "creation_date": 1447853460, "post_id": 33777338, "comment_id": 55329125, "body": "@drakon I&#39;ve already answered with some suggestions regarding writing more efficient code..."}, {"owner": {"reputation": 1518, "user_id": 2064818, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/86cf4281383bf9b2818433f8292a32d6?s=128&d=identicon&r=PG", "display_name": "KiaMorot", "link": "https://stackoverflow.com/users/2064818/kiamorot"}, "reply_to_user": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "edited": false, "score": 0, "creation_date": 1447854390, "post_id": 33777338, "comment_id": 55329811, "body": "In addition to @Jez answer, I would also suggest this other answer to figure out if your problem, or parts of  it, is suitable for parallelization. <a href=\"http://stackoverflow.com/a/17484085/2064818\">stackoverflow.com/a/17484085/2064818</a>"}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1447863737, "post_id": 33777338, "comment_id": 55337151, "body": "@drakon A good starting point would be <a href=\"http://docs.nvidia.com/cuda/cuda-c-best-practices-guide/\" rel=\"nofollow noreferrer\">&quot;Best practices&quot; section in CUDA docs</a> (it&#39;s almost entirely about runtime performance). Also, there are plenty of books and online material if you are interested in high-performance coding. As you have a reference OpenCV implementation you do your comparison against, a good idea would be to download it&#39;s source code, review it and try to achieve same result or even better (and in that case to contribute it back into OpenCV repository ;) )"}, {"owner": {"reputation": 467, "user_id": 2975743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c9ccbcf05b7a7ccae5f7895c314bafbc?s=128&d=identicon&r=PG&f=1", "display_name": "drakon", "link": "https://stackoverflow.com/users/2975743/drakon"}, "edited": false, "score": 0, "creation_date": 1447867807, "post_id": 33777338, "comment_id": 55339994, "body": "Updated benchmarks with multiple pixels computation inside each gpu thread! Another step forward! :-)"}, {"owner": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "edited": false, "score": 0, "creation_date": 1447934760, "post_id": 33777338, "comment_id": 55372287, "body": "You really should be looking into shared memory."}, {"owner": {"reputation": 467, "user_id": 2975743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c9ccbcf05b7a7ccae5f7895c314bafbc?s=128&d=identicon&r=PG&f=1", "display_name": "drakon", "link": "https://stackoverflow.com/users/2975743/drakon"}, "edited": false, "score": 0, "creation_date": 1447958935, "post_id": 33777338, "comment_id": 55389355, "body": "Updated with OpenCV without IPP and SSE. No significant changes... :-("}, {"owner": {"reputation": 467, "user_id": 2975743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c9ccbcf05b7a7ccae5f7895c314bafbc?s=128&d=identicon&r=PG&f=1", "display_name": "drakon", "link": "https://stackoverflow.com/users/2975743/drakon"}, "reply_to_user": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "edited": false, "score": 0, "creation_date": 1447959334, "post_id": 33777338, "comment_id": 55389619, "body": "@Jez: sorry but I don&#39;t understand what you intend for &quot;shared memory&quot;. Maybe are you talking about memory shared by all the GPU threads inside a single block? If so, how could I get benefit from this? Anyway thanks for your helpfulness! :-)"}, {"owner": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "edited": false, "score": 0, "creation_date": 1447981149, "post_id": 33777338, "comment_id": 55400171, "body": "I am. I&#39;ve explained why you might want to use it in my answer. If you need something clarifying I suggest you comment on the answer."}], "answers": [{"tags": [], "owner": {"reputation": 1641, "user_id": 3760791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba57499364921acc1b276a2cca37b22?s=128&d=identicon&r=PG&f=1", "display_name": "Jez", "link": "https://stackoverflow.com/users/3760791/jez"}, "is_accepted": false, "score": 3, "last_activity_date": 1447853409, "last_edit_date": 1447853409, "creation_date": 1447845444, "answer_id": 33778676, "question_id": 33777338, "link": "https://stackoverflow.com/questions/33777338/cuda-performance-with-computer-vision-algorithm/33778676#33778676", "title": "CUDA performance with Computer Vision Algorithm", "body": "<p>There are two things going on here. </p>\n\n<h2>Overheads</h2>\n\n<p>You're spending roughly half of the GPU time allocating and copying memory to and from the GPU. The CPU-GPU connection is a relatively slow link, and straight away halves your performance compared to the situation where the data starts and ends on the GPU and memory is allocated once. There are some things you can do to help here, such as moving the allocations outside of the loop, and overlapping the data transfer for one frame with the calculation of the next, but the pattern of copy->execute->copy rarely produces great runtimes unless the execution is quite complex.</p>\n\n<h2>Kernel</h2>\n\n<p>Your kernel is expected to be memory bound. You are (ideally) moving 4 bytes/thread, with ~2 million threads (pixels) and a runtime of 853us you're getting about 10GB/s. The GTX 970's peak is 224GB/s. You're a long way off.</p>\n\n<p>The problem here is that you're doing 8 bit transactions. The solution in this case would be to use shared memory. If you load data into shared memory in a high performance manner (eg. cast the pointers to int4s, making sure of alignment) at the start of the kernel, you can then read from that memory, then write back out with 32+ bits per thread. This means you're have to process multiple pixels a thread, but that's not a problem.</p>\n\n<p>An alternative solution would be to find a library to do this operation. <a href=\"https://developer.nvidia.com/npp\" rel=\"nofollow\">NPP</a>, for example, covers a lot of image related tasks and may well be faster than hand-written code.</p>\n\n<hr>\n\n<p>With a good memory access pattern I would expect this kernel to go >10x faster. Due to Amdahl's Law, you're going to be dominated by overhead once you've done this, so unless you can get rid of them the runtime is only going to be ~2x faster.</p>\n"}], "owner": {"reputation": 467, "user_id": 2975743, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c9ccbcf05b7a7ccae5f7895c314bafbc?s=128&d=identicon&r=PG&f=1", "display_name": "drakon", "link": "https://stackoverflow.com/users/2975743/drakon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1447958652, "creation_date": 1447841878, "last_edit_date": 1447958652, "question_id": 33777338, "link": "https://stackoverflow.com/questions/33777338/cuda-performance-with-computer-vision-algorithm", "title": "CUDA performance with Computer Vision Algorithm", "body": "<p>I'm moving my first step in the CUDA C programming world!</p>\n\n<p>As first test I write simple algorithm to do gray conversion and thresholding on images (I am a fan of Computer Vision and OpenCV!).\nI decided to compare my CUDA performance result with an analogous algorithm on the CPU and with the corresponding OpenCV (cpu) functions. \nHere the result on a full hd video:</p>\n\n<pre><code>Frame Count: 4754\nFrame Resolution: 1920x1080\nTotal time CPU: 67418.6 ms\nFrame Avg CPU:  14.1814 ms\n\nFrame Count: 4754\nFrame Resolution: 1920x1080\nTotal time OpenCV: 23805.3 ms\nFrame Avg OpenCV:  5.00742 ms\n\nFrame Count: 4754\nFrame Resolution: 1920x1080\n==6149== NVPROF is profiling process 6149, command: ./OpenCV_test\nTotal time CUDA: 28018.2 ms\nFrame Avg CUDA:  5.89361 ms\n\n==6149== Profiling application: ./OpenCV_test\n==6149== Profiling result:\nTime(%)      Time     Calls       Avg       Min       Max  Name\n55.45%  4.05731s      4754  853.45us  849.54us  1.1141ms doThreshold(unsigned char const *, unsigned char*, unsigned int, unsigned int, unsigned int)\n34.03%  2.49028s      4754  523.83us  513.67us  1.3338ms  [CUDA memcpy HtoD]\n10.52%  769.46ms      4754  161.85us  161.15us  301.06us  [CUDA memcpy DtoH]\n\n==6149== API calls:\nTime(%)      Time     Calls       Avg       Min       Max  Name\n 80.11%  8.19501s      9508  861.91us  490.81us  2.7719ms  cudaMemcpy\n 12.82%  1.31106s      9508  137.89us  66.639us  218.56ms  cudaMalloc\n  5.74%  587.05ms      9508  61.742us  39.566us  2.0234ms  cudaFree\n  1.21%  124.16ms      4754  26.116us  16.990us  365.86us  cudaLaunch\n  0.06%  5.7645ms     23770     242ns      97ns  106.27us  cudaSetupArgument\n  0.05%  5.4291ms      4754  1.1410us     602ns  10.150us  cudaConfigureCall\n  0.01%  594.89us        83  7.1670us     249ns  282.44us  cuDeviceGetAttribute\n  0.00%  45.536us         1  45.536us  45.536us  45.536us  cuDeviceTotalMem\n  0.00%  35.649us         1  35.649us  35.649us  35.649us  cuDeviceGetName\n  0.00%  1.8960us         2     948ns     345ns  1.5510us  cuDeviceGetCount\n  0.00%     892ns         2     446ns     255ns     637ns  cuDeviceGet\n</code></pre>\n\n<p>As you can see OpenCV does much better than my cpu implementation and better than my Cuda algorithm! Where is the trick? My suspect is than OpenCV uses some special cpu hardware instruction set.\nI expected something more with CUDA: people talk about speedup of 20x-30x in primitive image processing! I missed something?</p>\n\n<p>Here some detail about my system configuration:</p>\n\n<ul>\n<li>Cpu Intel Core i7 5820k @4ghz</li>\n<li>GeForce GTX 970</li>\n<li>Linux Mint 17.2 Mate 64 bit</li>\n<li>Driver nVidia 352.55</li>\n<li>Cuda toolkit 7.5.18</li>\n</ul>\n\n<p>Here some information on my OpenCV 3.0 build:</p>\n\n<ul>\n<li>Cuda enabled</li>\n<li>OpenCL disabled</li>\n<li>TBB disabled (to try to force single thread cpu execution)</li>\n<li>Intel IPP enabled</li>\n</ul>\n\n<p>In the following the code executed for the test:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;numeric&gt;\n#include &lt;string&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;chrono&gt;\n\n#include &lt;opencv2/opencv.hpp&gt;\n\nusing namespace cv;\nusing namespace std;\nusing namespace std::chrono;\n\nconst char* file = \"PATH TO A VIDEO FILE\";\n\n__global__ void doThreshold(const uchar* bgrInput, uchar* output, uint inputSize, uint soglia, uint maxVal)\n{\n    uint i = blockIdx.x * blockDim.x + threadIdx.x;\n\n    if (i &lt; inputSize)\n    {\n        output[i] = 0.5f + ((bgrInput[3 * i] + bgrInput[3 * i + 1] + bgrInput[3 * i + 2]) / 3.0f); // gray conversion\n        output[i] = output[i] &gt; soglia ? maxVal : 0; // thresholding\n    }\n\n}\n\n\nvoid cudaCvtThreshold(const Mat&amp; mat, Mat&amp; result, uint soglia, uint maxVal)\n{\n    if (mat.type() == CV_8UC3)\n    {\n        uint size = mat.rows * mat.cols;\n        uint blockSize = 128; // no significant result varying this variable\n        uint gridSize = ceil(size/(float)blockSize);\n        uchar* d_bgrInput, *d_output;\n        cudaMalloc((void**)&amp;d_bgrInput, mat.channels() * size);\n        cudaMalloc((void**)&amp;d_output, size);\n        cudaMemcpy(d_bgrInput, mat.data, mat.channels() * size, cudaMemcpyHostToDevice);\n\n        doThreshold&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(d_bgrInput, d_output, size, soglia, maxVal);\n\n        result = Mat(mat.rows, mat.cols, CV_8UC1);\n        cudaMemcpy(result.data, d_output, size, cudaMemcpyDeviceToHost);\n        cudaFree(d_bgrInput);\n        cudaFree(d_output);\n    }\n    else\n        cerr &lt;&lt; \"Only CV_8UC3 matrix supported\" &lt;&lt; endl;\n\n}\n\nvoid cpuCvtThreshold(const Mat&amp; mat, Mat&amp; result, uint soglia, uint maxVal)\n{\n    if (mat.type() == CV_8UC3)\n    {\n        uint size = mat.rows * mat.cols;\n        result = Mat(mat.rows, mat.cols, CV_8UC1);\n        uchar* input = mat.data;\n        uchar* output = result.data;\n        for (uint i = 0; i &lt; size; ++i)\n        {\n            output[i] = 0.5f + ((input[3 * i] + input[3 * i + 1] + input[3 * i + 2]) / 3.0f); // gray conversion\n            output[i] = output[i] &gt; soglia ? maxVal : 0; // thresholding\n        }\n    }\n    else\n        cerr &lt;&lt; \"Only CV_8UC3 matrix supported\" &lt;&lt; endl;\n}\n\nvoid cudaTest(const string src)\n{\n    VideoCapture cap(src);\n    Mat frame, result;\n    uint frameCount = cap.get(CAP_PROP_FRAME_COUNT);\n    cout &lt;&lt; \"Frame Count: \" &lt;&lt; frameCount &lt;&lt; endl;\n    auto startTs = system_clock::now();\n    cap &gt;&gt; frame;\n    cout &lt;&lt; \"Frame Resolution: \" &lt;&lt; frame.cols &lt;&lt; \"x\" &lt;&lt; frame.rows &lt;&lt; endl;\n\n    while (not frame.empty()) {\n        cudaCvtThreshold(frame, result, 127, 255);\n        cap &gt;&gt; frame;\n    }\n\n    auto stopTs = system_clock::now();\n    auto diff = stopTs - startTs;\n    auto elapsed = chrono::duration_cast&lt;chrono::microseconds&gt;(diff).count() / (double)1e3;\n    cout &lt;&lt; \"Total time CUDA: \" &lt;&lt; elapsed &lt;&lt; \" ms\" &lt;&lt; endl;\n    cout &lt;&lt; \"Frame Avg CUDA:  \" &lt;&lt; elapsed / frameCount &lt;&lt; \" ms\" &lt;&lt; endl &lt;&lt; endl;\n}\n\nvoid naiveCpu(const string src)\n{\n    VideoCapture cap(src);\n    Mat frame, result;\n    uint frameCount = cap.get(CAP_PROP_FRAME_COUNT);\n    cout &lt;&lt; \"Frame Count: \" &lt;&lt; frameCount &lt;&lt; endl;\n    auto startTs = system_clock::now();\n    cap &gt;&gt; frame;\n    cout &lt;&lt; \"Frame Resolution: \" &lt;&lt; frame.cols &lt;&lt; \"x\" &lt;&lt; frame.rows &lt;&lt; endl;\n\n    while (not frame.empty()) {\n        cpuCvtThreshold(frame, result, 127, 255);\n        cap &gt;&gt; frame;\n    }\n    auto stopTs = system_clock::now();\n    auto diff = stopTs - startTs;\n    auto elapsed = chrono::duration_cast&lt;chrono::microseconds&gt;(diff).count() / (double)1e3;\n    cout &lt;&lt; \"Total time CPU: \" &lt;&lt; elapsed &lt;&lt; \" ms\" &lt;&lt; endl;\n    cout &lt;&lt; \"Frame Avg CPU:  \" &lt;&lt; elapsed / frameCount &lt;&lt; \" ms\" &lt;&lt; endl &lt;&lt; endl;\n}\n\n\nvoid opencv(const string src)\n{\n    VideoCapture cap(src);\n    Mat frame, result;\n    uint frameCount = cap.get(CAP_PROP_FRAME_COUNT);\n    cout &lt;&lt; \"Frame Count: \" &lt;&lt; frameCount &lt;&lt; endl;\n    auto startTs = system_clock::now();\n    cap &gt;&gt; frame;\n    cout &lt;&lt; \"Frame Resolution: \" &lt;&lt; frame.cols &lt;&lt; \"x\" &lt;&lt; frame.rows &lt;&lt; endl;\n\n    while (not frame.empty()) {\n        cv::cvtColor(frame, result, COLOR_BGR2GRAY);\n        threshold(result, result, 127, 255, THRESH_BINARY);\n        cap &gt;&gt; frame;\n    }\n    auto stopTs = system_clock::now();\n    auto diff = stopTs - startTs;\n    auto elapsed = chrono::duration_cast&lt;chrono::microseconds&gt;(diff).count() / (double)1e3;\n    cout &lt;&lt; \"Total time OpenCV: \" &lt;&lt; elapsed &lt;&lt; \" ms\" &lt;&lt; endl;\n    cout &lt;&lt; \"Frame Avg OpenCV:  \" &lt;&lt; elapsed / frameCount &lt;&lt; \" ms\" &lt;&lt; endl &lt;&lt; endl;\n}\n\nint main(void)\n{\n    naiveCpu(file);\n    opencv(file);\n    cudaTest(file);\n    return 0;\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Added / modified code</p>\n\n<pre><code>__global__ void doThreshold(const uchar* bgrInput, uchar* output, uint inputSize, uint soglia, uint maxVal)\n{\n    uint i = blockIdx.x * blockDim.x + threadIdx.x;\n\n    if (i &lt; inputSize)\n    {\n        uchar grayPix = 0.5f + ((bgrInput[3 * i] + bgrInput[3 * i + 1] + bgrInput[3 * i + 2]) / 3.0f); // gray conversion\n        output[i] = grayPix &gt; soglia ? maxVal : 0; // thresholding\n    }\n\n}\n\nvoid cudaCvtThreshold(const Mat&amp; mat, Mat&amp; result, uint soglia, uint maxVal, uchar* d_bgrInput, uchar* d_output)\n{\n    uint size = mat.rows * mat.cols;\n    uint blockSize = 128; // no significant result varying this variable\n    uint gridSize = ceil(size/(float)blockSize);\n    doThreshold&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(d_bgrInput, d_output, size, soglia, maxVal);\n}\n\nvoid cudaTestOutMallocFree(const string src)\n{\n    VideoCapture cap(src);\n    Mat frame;\n    uint frameCount = cap.get(CAP_PROP_FRAME_COUNT);\n    cout &lt;&lt; \"Frame Count: \" &lt;&lt; frameCount &lt;&lt; endl;\n    auto startTs = system_clock::now();\n    cap &gt;&gt; frame;\n    cout &lt;&lt; \"Frame Resolution: \" &lt;&lt; frame.cols &lt;&lt; \"x\" &lt;&lt; frame.rows &lt;&lt; endl;\n    uint size = frame.rows * frame.cols;\n\n    Mat result(frame.rows, frame.cols, CV_8UC1);\n    uchar* d_bgrInput, *d_output;\n    cudaMalloc((void**)&amp;d_bgrInput, frame.channels() * size);\n    cudaMalloc((void**)&amp;d_output, size);\n\n    while (not frame.empty())\n    {\n        cudaMemcpy(d_bgrInput, frame.data, frame.channels() * size, cudaMemcpyHostToDevice);\n        cudaCvtThreshold(frame, result, 127, 255, d_bgrInput, d_output);\n        cudaMemcpy(result.data, d_output, size, cudaMemcpyDeviceToHost);\n        cap &gt;&gt; frame;\n    }\n\n    cudaFree(d_bgrInput);\n    cudaFree(d_output);\n\n    auto stopTs = system_clock::now();\n    auto diff = stopTs - startTs;\n    auto elapsed = chrono::duration_cast&lt;chrono::microseconds&gt;(diff).count() / (double)1e3;\n    cout &lt;&lt; \"Total time CUDA (out malloc-free): \" &lt;&lt; elapsed &lt;&lt; \" ms\" &lt;&lt; endl;\n    cout &lt;&lt; \"Frame Avg CUDA (out malloc-free):  \" &lt;&lt; elapsed / frameCount &lt;&lt; \" ms\" &lt;&lt; endl &lt;&lt; endl;\n}\n\nint main(void)\n{\n    naiveCpu(file);\n    opencv(file);\n    cudaTest(file);\n    cudaTestOutMallocFree(file);\n    return 0;\n}\n</code></pre>\n\n<p>And results:</p>\n\n<pre><code>Frame Count: 4754\nFrame Resolution: 1920x1080\nTotal time CPU: 70972.6 ms\nFrame Avg CPU:  14.929 ms\n\nFrame Count: 4754\nFrame Resolution: 1920x1080\nTotal time OpenCV: 23475.4 ms\nFrame Avg OpenCV:  4.93804 ms\n\nFrame Count: 4754\nFrame Resolution: 1920x1080\n==4493== NVPROF is profiling process 4493, command: ./OpenCV_test\nTotal time CUDA: 27451.3 ms\nFrame Avg CUDA:  5.77435 ms\n\nFrame Count: 4754\nFrame Resolution: 1920x1080\nTotal time CUDA (out malloc-free): 26137.3 ms\nFrame Avg CUDA (out malloc-free):  5.49796 ms\n\n==4493== Profiling application: ./OpenCV_test\n==4493== Profiling result:\nTime(%)      Time     Calls       Avg       Min       Max  Name\n 53.74%  7.53280s      9508  792.26us  789.61us  896.17us  doThreshold(unsigned char const *, unsigned char*, unsigned int, unsigned int, unsigned int)\n 35.57%  4.98604s      9508  524.40us  513.54us  979.37us  [CUDA memcpy HtoD]\n 10.69%  1.49876s      9508  157.63us  157.09us  206.24us  [CUDA memcpy DtoH]\n\n==4493== API calls:\nTime(%)      Time     Calls       Avg       Min       Max  Name\n 88.22%  15.7392s     19016  827.68us  482.18us  1.7570ms  cudaMemcpy\n  7.07%  1.26081s      9510  132.58us  65.458us  198.86ms  cudaMalloc\n  3.26%  582.24ms      9510  61.223us  39.675us  304.16us  cudaFree\n  1.33%  236.64ms      9508  24.888us  13.497us  277.21us  cudaLaunch\n  0.06%  10.667ms     47540     224ns      96ns  347.09us  cudaSetupArgument\n  0.06%  9.9587ms      9508  1.0470us     504ns  9.4800us  cudaConfigureCall\n  0.00%  428.88us        83  5.1670us     225ns  228.70us  cuDeviceGetAttribute\n  0.00%  43.388us         1  43.388us  43.388us  43.388us  cuDeviceTotalMem\n  0.00%  34.389us         1  34.389us  34.389us  34.389us  cuDeviceGetName\n  0.00%  1.7010us         2     850ns     409ns  1.2920us  cuDeviceGetCount\n  0.00%     821ns         2     410ns     225ns     596ns  cuDeviceGet\n</code></pre>\n\n<p>Better performances with single malloc and free, but small improvement...</p>\n\n<p>EDIT2:</p>\n\n<p>As suggested by Jez I modified the Cuda Kernel in order to process multiple pixel (8 in the following execution) inside each GPU thread:</p>\n\n<p>Here the modified code:</p>\n\n<pre><code>__global__ void doThreshold(const uchar* bgrInput, uchar* output, uint inputSize, uint soglia, uint maxVal, uint pixelPerThread)\n{\n    uint i = pixelPerThread * (blockIdx.x * blockDim.x + threadIdx.x);\n\n    if (i &lt; inputSize)\n    {\n        for (uint j = 0; j &lt; pixelPerThread; j++) {\n            uchar grayPix = 0.5f + ( (bgrInput[3 * (i + j)] + bgrInput[3 * (i + j) + 1] + bgrInput[3 * (i + j) + 2]) / 3.0f ); // gray conversion\n            output[i + j] = grayPix &gt; soglia ? maxVal : 0; // thresholding\n        }\n    }\n}\n\nvoid cudaCvtThreshold(const Mat&amp; mat, Mat&amp; result, uint soglia, uint maxVal, uchar* d_bgrInput, uchar* d_output)\n{\n    uint size = mat.rows * mat.cols;\n    uint pixelPerThread = 8;\n    uint blockSize = 128; // no significant result varying this variable\n    uint gridSize = ceil(size/(float)(blockSize * pixelPerThread));\n    doThreshold&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(d_bgrInput, d_output, size, soglia, maxVal, pixelPerThread);\n}\n</code></pre>\n\n<p>Then the results:</p>\n\n<pre><code>Frame Count: 4754\nFrame Resolution: 1920x1080\nTotal time OpenCV: 23628.8 ms\nFrame Avg OpenCV:  4.97031 ms\n\nFrame Count: 4754\nFrame Resolution: 1920x1080\n==13441== NVPROF is profiling process 13441, command: ./OpenCV_test\nTotal time CUDA (out malloc-free): 25655.5 ms\nFrame Avg CUDA (out malloc-free):  5.39662 ms\n\n==13441== Profiling application: ./OpenCV_test\n==13441== Profiling result:\nTime(%)      Time     Calls       Avg       Min       Max  Name\n 49.30%  3.15853s      4754  664.39us  658.24us  779.04us  doThreshold(unsigned char const *, unsigned char*, unsigned int, unsigned int, unsigned int, unsigned int)\n 38.69%  2.47838s      4754  521.32us  513.35us  870.69us  [CUDA memcpy HtoD]\n 12.01%  769.53ms      4754  161.87us  161.31us  200.58us  [CUDA memcpy DtoH]\n\n==13441== API calls:\nTime(%)      Time     Calls       Avg       Min       Max  Name\n 95.78%  7.26387s      9508  763.97us  491.11us  1.6589ms  cudaMemcpy\n  2.51%  190.70ms         2  95.350ms  82.529us  190.62ms  cudaMalloc\n  1.53%  116.31ms      4754  24.465us  16.844us  286.56us  cudaLaunch\n  0.09%  6.7052ms     28524     235ns      98ns  233.19us  cudaSetupArgument\n  0.08%  5.9538ms      4754  1.2520us     642ns  12.039us  cudaConfigureCall\n  0.00%  263.87us        83  3.1790us     225ns  111.03us  cuDeviceGetAttribute\n  0.00%  174.45us         2  87.227us  52.521us  121.93us  cudaFree\n  0.00%  34.612us         1  34.612us  34.612us  34.612us  cuDeviceTotalMem\n  0.00%  29.376us         1  29.376us  29.376us  29.376us  cuDeviceGetName\n  0.00%  1.6950us         2     847ns     343ns  1.3520us  cuDeviceGetCount\n  0.00%     745ns         2     372ns     217ns     528ns  cuDeviceGet\n</code></pre>\n\n<p>Notice that the average time for the kernel execution is now 664,39 us instead of 792,26 us\nNot bad! :-)\nBut OpenCV (using Intel IPP) is still faster!</p>\n\n<p>EDIT3:\nI recompiled OpenCV WITHOUT IPP and the various SSE instructions. The OpenCV performances seem to be the same!!</p>\n\n<pre><code>Frame Count: 4754\nFrame Resolution: 1920x1080\nTotal time OpenCV: 23541.7 ms\nFrame Avg OpenCV:  4.95198 ms\n</code></pre>\n"}, {"tags": ["c", "openssl", "centos"], "comments": [{"owner": {"reputation": 2459, "user_id": 5273255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xj4dE.jpg?s=128&g=1", "display_name": "Can O&#39; Spam", "link": "https://stackoverflow.com/users/5273255/can-o-spam"}, "edited": false, "score": 0, "creation_date": 1447841947, "post_id": 33777302, "comment_id": 55321190, "body": "Can you post some code samples?"}], "answers": [{"tags": [], "owner": {"reputation": 1617, "user_id": 2277408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cfjxc.jpg?s=128&g=1", "display_name": "Vladimir Kunschikov", "link": "https://stackoverflow.com/users/2277408/vladimir-kunschikov"}, "is_accepted": false, "score": 0, "last_activity_date": 1447851275, "creation_date": 1447851275, "answer_id": 33780647, "question_id": 33777302, "link": "https://stackoverflow.com/questions/33777302/is-openssl-thread-safe/33780647#33780647", "title": "Is OpenSSL thread safe?", "body": "<p><strong>Yes</strong></p>\n\n<p><a href=\"https://www.openssl.org/docs/manmaster/crypto/threads.html\" rel=\"nofollow\">OpenSSL threads manual</a></p>\n\n<blockquote>\n  <p>OpenSSL can safely be used in multi-threaded applications provided\n  that at least two callback functions are set, locking_function and\n  threadid_func.</p>\n</blockquote>\n\n<p><a href=\"https://github.com/openssl/openssl/blob/master/demos/threads/mttest.c\" rel=\"nofollow\">Recommended library setup sample</a></p>\n\n<pre><code>void thread_setup(void)\n{\n    int i;\n\n    lock_cs = OPENSSL_malloc(CRYPTO_num_locks() * sizeof(HANDLE));\n    for (i = 0; i &lt; CRYPTO_num_locks(); i++) {\n        lock_cs[i] = CreateMutex(NULL, FALSE, NULL);\n    }\n\n    CRYPTO_set_locking_callback((void (*)(int, int, char *, int))\n                                win32_locking_callback);\n    /* id callback defined */\n}\n\nvoid thread_cleanup(void)\n{\n    int i;\n\n    CRYPTO_set_locking_callback(NULL);\n    for (i = 0; i &lt; CRYPTO_num_locks(); i++)\n        CloseHandle(lock_cs[i]);\n    OPENSSL_free(lock_cs);\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1232496, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/40aaa8419ffbe4fc441b080b11036a48?s=128&d=identicon&r=PG", "display_name": "Ansari", "link": "https://stackoverflow.com/users/1232496/ansari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1289, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1447851275, "creation_date": 1447841792, "last_edit_date": 1447842337, "question_id": 33777302, "link": "https://stackoverflow.com/questions/33777302/is-openssl-thread-safe", "title": "Is OpenSSL thread safe?", "body": "<p>Should there be an issue if I do SSL handshake in one thread and SSL_read and SSL_write in a separate thread?</p>\n"}, {"tags": ["c", "sorting", "directory"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1447842121, "post_id": 33777299, "comment_id": 55321326, "body": "You could print the first and last before the <code>while()</code> loop, and simplify the loop to just <code>free()</code> memory. You should also check if there is more than 1 file before printing the last entry."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5355129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2288763ec1b77b294cf741e7cc4cae9c?s=128&d=identicon&r=PG&f=1", "display_name": "Boring Loop", "link": "https://stackoverflow.com/users/5355129/boring-loop"}, "edited": false, "score": 0, "creation_date": 1447920069, "post_id": 33777949, "comment_id": 55362366, "body": "How can I make sure the Lowercase Items are first and the Uppercase the second. Eg (Aa.txt and aa.txt; output should be aa.txt, Aa.txt. It should not be Aa.txt, aa.txt which is currently happening)"}], "tags": [], "owner": {"reputation": 310, "user_id": 2700879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/M9RKD.jpg?s=128&g=1", "display_name": "Hugo Oshiro", "link": "https://stackoverflow.com/users/2700879/hugo-oshiro"}, "is_accepted": true, "score": 0, "last_activity_date": 1447845570, "last_edit_date": 1447845570, "creation_date": 1447843558, "answer_id": 33777949, "question_id": 33777299, "link": "https://stackoverflow.com/questions/33777299/improve-printing-first-and-last-name-of-sorted-directory/33777949#33777949", "title": "Improve Printing First and Last Name of Sorted Directory", "body": "<p>Maybe if you remove the while part and print just the third (to disconsider . and ..) and last entrance:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dirent.h&gt;\n\nint\nmain(void)\n{\n    struct dirent **namelist;\n    int n;\n    int i = 0;\n\n    n = scandir(\".\", &amp;namelist, NULL, alphasort);\n    if (n &lt; 0)\n    {\n        perror(\"scandir\");\n    }\n    else\n    {\n\n        printf(\"%s\\n\", (namelist[2])-&gt;d_name);\n        printf(\"%s\\n\", (namelist[n-1])-&gt;d_name);\n\n        while(i&lt;n)\n            free(namelist[i++]);\n        free(namelist);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>And don't forget the <code>return 0</code>; As you specified that you should return a <code>int</code> in your main. Now you can print your stuff in constant time, but memory still need \u0398(n) to be deallocated.\nIf you also want to disconsider hidden files (starting with '.') you should add a filter function as:</p>\n\n<pre><code>int filter(const struct dirent *entry) {\n    return entry-&gt;d_name[0] != '.';\n}\n</code></pre>\n\n<p>and add it to <code>scandir</code> arguments</p>\n\n<pre><code>scandir(\".\", &amp;namelist, filter, alphasort);\n</code></pre>\n\n<p>and then you should alter first print index, because '.' and '..' will be treat by filter.</p>\n\n<pre><code>printf(\"%s\\n\", (namelist[0])-&gt;d_name);\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5355129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2288763ec1b77b294cf741e7cc4cae9c?s=128&d=identicon&r=PG&f=1", "display_name": "Boring Loop", "link": "https://stackoverflow.com/users/5355129/boring-loop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 33777949, "answer_count": 1, "score": 0, "last_activity_date": 1447845570, "creation_date": 1447841786, "question_id": 33777299, "link": "https://stackoverflow.com/questions/33777299/improve-printing-first-and-last-name-of-sorted-directory", "title": "Improve Printing First and Last Name of Sorted Directory", "body": "<p>I am beginner at C and learning as I progress. I have adopted and modified a program to print the names of the files in the directory in sorted order.\nI only would like to print the First and Last file in the sorted order.\n(eg: c.txt, z.docx, f.jpg, a.docx: Output will be a.docx and z.docx)</p>\n\n<p>Directory Size: Almost 2,000,000 Files <br>\nFile Size: Each size is at most 2MB <br></p>\n\n<p>Hurdles <br>\nThe first name prints as \".\" and the second name is \"..\" <br>\nSorting is done via uppercase, how to switch to lowercase</p>\n\n<p>It would also be great to know, if there is a simpler or better way of executing the below code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dirent.h&gt;\n\nint\nmain(void)\n{\n    struct dirent **namelist;\n    int n;\n    int i = 0;\n\n    n = scandir(\".\", &amp;namelist, NULL, alphasort);\n    if (n &lt; 0)\n    {\n        perror(\"scandir\");\n    }\n    else\n    {\n        while (i&lt;n)\n        {\n            if (i == 0) // First Name\n            {\n                printf(\"%s\\n\", (namelist[i])-&gt;d_name);\n            }\n            if (i == n-1) // Last Name\n            {\n                printf(\"%s\\n\", (namelist[i])-&gt;d_name);\n            }\n            free(namelist[n]);\n            i++;\n        }\n        free(namelist);\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "embedded", "cortex-m3", "cortex-m"], "comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1447856584, "post_id": 33777128, "comment_id": 55331622, "body": "I think on a cortex-m the hardware pushes some number of registers for you so the handler doesnt have to that is one of the new things they added, so yes the hardware will do the same thing every time for each type of handler.   What software does after that (which it doesnt need to add any more usually other than that the compiler needs for that function) is specific to that function"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1447857323, "post_id": 33777128, "comment_id": 55332179, "body": "if you are examining the stack I assume you are using asm which means you should know how many items you added to the top of the stack?"}, {"owner": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1447857740, "post_id": 33777128, "comment_id": 55332510, "body": "Most of the project is written in C, some of it is written in asm, however. The HardFault_Handler is written in C. But for this type of issue I do have to analyse the disassembly to find which variable on the stack represents the programme counter from when the trap was triggered."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1447857854, "post_id": 33777128, "comment_id": 55332634, "body": "yeah so you cant really rely on the exact offset, same code compiled with different options or a different version of the compiler or even one line of code changed could vary the stack by the time you get to the middle of the function."}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "edited": false, "score": 0, "creation_date": 1447846149, "post_id": 33778108, "comment_id": 55324158, "body": "The first instruction after entering the HardFault_Handler is: `PUSH {r4-r6, lr}. In that case I assume that (R0-R3, R12, PC, LR &amp; PSR) are pushed to the stack first, then (R4-R6, LR) so the 10th register would be the PC? Thank you for the tutorial as well."}, {"owner": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "reply_to_user": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "edited": false, "score": 0, "creation_date": 1447850204, "post_id": 33778108, "comment_id": 55326747, "body": "Yes. After PUSH {r4-r6, lr}, the stack pointer would point at the pushed R4 value. (SP+4*1) would be the R5 value. (SP + 4*4) is the R0 value stacked by hardware and (SP+4*10) would be the PC value."}], "tags": [], "owner": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "is_accepted": true, "score": 1, "last_activity_date": 1447843991, "creation_date": 1447843991, "answer_id": 33778108, "question_id": 33777128, "link": "https://stackoverflow.com/questions/33777128/find-which-instruction-caused-a-trap-on-cortex-m3/33778108#33778108", "title": "Find which instruction caused a trap on Cortex M3", "body": "<p>The precise stack location of the return address depends on how much stack the interrupt handler requires. If you look at the disassembly of your HardFault_Handler, you should be able to see how much data is stored on the stack / how many registers are pushed in addition to the registers pushed by the hardware interrupt machinery (R0-R3, R12, PC, LR &amp; PSR)</p>\n\n<p>I found <a href=\"http://www.freertos.org/Debugging-Hard-Faults-On-Cortex-M-Microcontrollers.html\" rel=\"nofollow\">this</a> to be a pretty good idea on how to debug Hard Faults, though it requires a bit of inline assembly. </p>\n"}, {"comments": [{"owner": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "edited": false, "score": 0, "creation_date": 1447846665, "post_id": 33778361, "comment_id": 55324500, "body": "When you say you can&#39;t be sure how many, do you mean that for different exceptions the number of registers might change? With @Pinetwig &#39;s answer I found out that my HardFault_Handler stores 4 additional registers. I assume that the C compiler will always push the same 4 registers onto the stack before entering the HardFault_Handler, right? Your idea of moving the SP into R0 seems clever. Since you are overwriting R0, does that mean that the registers R0-R3 and R12 are there to be used by the developer or is it a way to store specific information about the trap itself?"}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "reply_to_user": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "edited": false, "score": 2, "creation_date": 1447847816, "post_id": 33778361, "comment_id": 55325223, "body": "@DavidWright Yes, the number of pushed registers can change. If you use more local variables in your handler, it is likely that the compiler will push more registers. The default CPU-pushed R0-R3 is just arbitrary, for developer/compiler use as you say. R0-R3 are considered by convention as volatile/scratchpad registers, and are also used for function parameters (that&#39;s why moving sp to R0 will work as if you passed sp as parameter)."}], "tags": [], "owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "is_accepted": false, "score": 2, "last_activity_date": 1447844627, "creation_date": 1447844627, "answer_id": 33778361, "question_id": 33777128, "link": "https://stackoverflow.com/questions/33777128/find-which-instruction-caused-a-trap-on-cortex-m3/33778361#33778361", "title": "Find which instruction caused a trap on Cortex M3", "body": "<p>As you said, exceptions (or interrupts) on ARM Cortex-M3 will automatically stack some registers, namely :</p>\n\n<blockquote>\n  <ul>\n  <li>Program Counter (PC)</li>\n  <li>Processor Status Register (xPSR)</li>\n  <li>r0-r3</li>\n  <li>r12</li>\n  <li>Link Register (LR).</li>\n  </ul>\n</blockquote>\n\n<p>For a total of 8 registers (reference : <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0337e/Babedgea.html\" rel=\"nofollow\">Cortex\u2122-M3 Technical Reference Manual, Chapter 5.5.1</a>).</p>\n\n<p>Now, if you write your exception handler in a language other than assembly, the compiler may stack additional registers, and you can't be sure how many.</p>\n\n<p>One simple solution is to add a small code before the real handler, to pass the address of the auto-stacked registers :</p>\n\n<pre><code>void myRealHandler( void * stack );\n\nvoid handler(void) {\n    asm volatile(\"mov r0, sp\");\n    asm volatile(\"b myRealHandler\");\n}\n</code></pre>\n\n<p>The register <code>BFAR</code> is specific to bus faults. It will contain the faulty address, not the address of the faulty instruction. For example, if there was an error reading an integer at address <code>0x30005632</code>, <code>BFAR</code> will be set to <code>0x30005632</code>.</p>\n"}], "owner": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2410, "favorite_count": 0, "accepted_answer_id": 33778108, "answer_count": 2, "score": 2, "last_activity_date": 1447844627, "creation_date": 1447841391, "last_edit_date": 1447843224, "question_id": 33777128, "link": "https://stackoverflow.com/questions/33777128/find-which-instruction-caused-a-trap-on-cortex-m3", "title": "Find which instruction caused a trap on Cortex M3", "body": "<p>I am currently debugging a hard fault trap which turned out to be a precise data bus error on a STM32F205 Cortex-M3 processor, using Keil uVision. Due to a lengthy debugging and googling process I found the assembly instruction that caused the trap. Now I am looking for a way to avoid this lengthy process next time a trap occurs.</p>\n\n<p>In the application note 209 by Keil it says: </p>\n\n<blockquote>\n  <p>PRECISEERR: Precise data bus error:\n  0 = no precise data bus error\n  1 = a data bus error has occurred, and the PC value stacked for the exception return points to the instruction that caused the fault. When the processor sets this bit it writes the faulting address to SCB->BFAR</p>\n</blockquote>\n\n<p>and also this:</p>\n\n<blockquote>\n  <p>An exception saves the state of registers R0-R3, R12, PC &amp; LR either the Main Stack or the Process Stack (depends on the stack in use when the exception occurred).</p>\n</blockquote>\n\n<p>The last quote I am interpreting as such that there should be 7 registers plus the respective stack. When I look up my SP address in the memory I see the address that caused the error at an address 10 words higher than the stack pointer address.</p>\n\n<p><strong>My questions are:</strong> </p>\n\n<ul>\n<li><p>Is the address of the instruction that caused the trap always saved 10 words higher than the current stack pointer? And could you please point out a document where I can read up on how and why this is?</p></li>\n<li><p>Is there another register that would contain this address as well?</p></li>\n</ul>\n"}]