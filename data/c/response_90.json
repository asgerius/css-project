[{"tags": ["c", "pointers", "data-structures", "tree"], "comments": [{"owner": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 3, "creation_date": 1475105251, "post_id": 39759015, "comment_id": 66814306, "body": "I appreciate whitespace in code, but here it is just distracting to the content.  Code indentations would also help with readability."}, {"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1475105454, "post_id": 39759015, "comment_id": 66814352, "body": "It appears that both prints are conditioned under <code>temp==NULL</code>"}, {"owner": {"reputation": 1269, "user_id": 807757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2fc6b61a625f11ec337706ead649ca1?s=128&d=identicon&r=PG", "display_name": "Hormigas", "link": "https://stackoverflow.com/users/807757/hormigas"}, "reply_to_user": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 0, "creation_date": 1475105553, "post_id": 39759015, "comment_id": 66814366, "body": "@iRove Agreed. Apologies"}, {"owner": {"reputation": 1269, "user_id": 807757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2fc6b61a625f11ec337706ead649ca1?s=128&d=identicon&r=PG", "display_name": "Hormigas", "link": "https://stackoverflow.com/users/807757/hormigas"}, "reply_to_user": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1475105571, "post_id": 39759015, "comment_id": 66814368, "body": "@Arun They&#39;re within different if constructs"}, {"owner": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 0, "creation_date": 1475105758, "post_id": 39759015, "comment_id": 66814403, "body": "Why are you assuming that <code>temp</code> is not null?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1475106028, "post_id": 39759015, "comment_id": 66814469, "body": "Time to compile with all warnings &amp; debug info (e.g. <code>gcc -Wall -g</code> if using <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>) and to <b>use the debugger</b> (e.g. <code>gdb</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 1269, "user_id": 807757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2fc6b61a625f11ec337706ead649ca1?s=128&d=identicon&r=PG", "display_name": "Hormigas", "link": "https://stackoverflow.com/users/807757/hormigas"}, "edited": false, "score": 0, "creation_date": 1475105841, "post_id": 39759182, "comment_id": 66814424, "body": "Indentation. Should do more of that. Thanks a bunch!"}], "tags": [], "owner": {"reputation": 2861, "user_id": 1008115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Nmtel.jpg?s=128&g=1", "display_name": "PnotNP", "link": "https://stackoverflow.com/users/1008115/pnotnp"}, "is_accepted": true, "score": 2, "last_activity_date": 1475105859, "last_edit_date": 1475105859, "creation_date": 1475105671, "answer_id": 39759182, "question_id": 39759015, "link": "https://stackoverflow.com/questions/39759015/unexpected-output-in-c-traversal-of-trees/39759182#39759182", "title": "Unexpected output in C (Traversal of Trees)", "body": "<p>To answer your question, you have your two <code>printfs</code> under same condition:</p>\n\n<pre><code>  if(temp==NULL) //&lt;---- temp == NULL condition\n            {\n                printf(\"Dequeue and Temp is NULL\\n\");\n                //break;\n            }\n  else if(temp-&gt;tree_element-&gt;right!=NULL)\n            {\n                enQueue(temp-&gt;tree_element-&gt;right);} //&lt;-- If you play little hide-n-seek with your beautifully aligned code you may find this hidden curly brace\n\n        if(temp==NULL) //&lt;---- Same condition\n            printf(\"Whatever\\n\");\n    }\n</code></pre>\n"}], "owner": {"reputation": 1269, "user_id": 807757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2fc6b61a625f11ec337706ead649ca1?s=128&d=identicon&r=PG", "display_name": "Hormigas", "link": "https://stackoverflow.com/users/807757/hormigas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 39759182, "answer_count": 1, "score": -2, "last_activity_date": 1475105859, "creation_date": 1475104406, "last_edit_date": 1475105474, "question_id": 39759015, "link": "https://stackoverflow.com/questions/39759015/unexpected-output-in-c-traversal-of-trees", "title": "Unexpected output in C (Traversal of Trees)", "body": "<p>I'm trying to code a program to go through a Tree in Breadth First Manner. </p>\n\n<p>Here is my code : </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct TreeNode \n{\n    struct TreeNode *right;\n    struct TreeNode *left ;\n    int    data;\n};\n\nstruct TreeNode* newTreeNode(int data) \n{\n    struct TreeNode* temp = (struct TreeNode*)malloc(sizeof(struct TreeNode));\n\n    temp-&gt;data = data;\n    temp-&gt;right=NULL;\n    temp-&gt;left=NULL;\n    return temp;\n}\n\nstruct QueueNode \n{\n    struct QueueNode *next;\n    struct TreeNode  *tree_element;\n} *head,*tail;\n\nvoid initQueue() \n{\n    head=NULL;\n    tail=NULL;\n}\n\nvoid enQueue(struct TreeNode *ptr) \n{\n    struct QueueNode *temp = (struct QueueNode *)malloc(sizeof(struct QueueNode));\n\n    if(head==NULL) \n        {\n            temp-&gt;next=NULL;\n            temp-&gt;tree_element = ptr;\n            head = temp;\n            tail = temp;\n        }\n    else \n        {\n            tail-&gt;next = temp;\n            tail = temp;\n            temp-&gt;tree_element = ptr;\n            temp-&gt;next = NULL;\n        }\n}\n\nstruct QueueNode* deQueue() \n{\n    struct QueueNode *temp = NULL;\n\n    if(head==NULL) /*Empty Queue so return NULL*/\n        {\n            printf(\"Empty queue\\n\");\n            return NULL;\n        }\n    {\n        temp = head;\n        head = head-&gt;next;\n        return temp;\n    }\n}\n\nint main() \n{\n    struct QueueNode *temp = NULL;\n\n    /* Initializing tree structure */\n    struct TreeNode *root = newTreeNode(1);\n\n    initQueue();\n    enQueue(root); /* Root in the queue */\n\n    temp = head;\n\n    while(temp!=NULL) \n        {\n            //printf(\"entering loop\");\n            temp = deQueue();\n            if(temp==NULL)\n                {\n                    printf(\"Dequeue and Temp is NULL\\n\");\n                    //break;\n                }\n            else if(temp!=NULL)\n                {\n                    if(temp-&gt;tree_element-&gt;left!=NULL)\n                        {\n                            enQueue(temp-&gt;tree_element-&gt;left) ;\n                        }\n                    if(temp-&gt;tree_element-&gt;right!=NULL)\n                        {\n                            enQueue(temp-&gt;tree_element-&gt;right);}\n                }\n            /*\n              if(temp-&gt;tree_element!=NULL)*/\n            if(temp==NULL)\n                printf(\"Whatever\\n\");\n        }\n\n    return 0;\n}\n</code></pre>\n\n<p>The output is : </p>\n\n<pre><code>Empty queue\n\nDequeue and Temp is NULL\n\nWhatever\n</code></pre>\n\n<p>My question is :</p>\n\n<p>How do</p>\n\n<pre><code>Dequeue and Temp is NULL\n</code></pre>\n\n<p><strong>and</strong></p>\n\n<pre><code>Whatever\n</code></pre>\n\n<p>get printed at the same time. <strong><em>temp</em></strong> can't be NULL and !NULL at the same time right ?</p>\n\n<p>Thank You</p>\n"}, {"tags": ["c", "logic", "expression"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1475104396, "post_id": 39758999, "comment_id": 66814079, "body": "&quot;When I enter the values &quot; --&gt; post the exact text of what your entered."}, {"owner": {"reputation": 1100, "user_id": 3693388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o5lGj.jpg?s=128&g=1", "display_name": "Stewart Smith", "link": "https://stackoverflow.com/users/3693388/stewart-smith"}, "edited": false, "score": 0, "creation_date": 1475104399, "post_id": 39758999, "comment_id": 66814081, "body": "You are doing integer arithmetic for a start. Because <code>x</code> and <code>y</code> are <code>int</code>s, it will truncate the results of each operation to be integers, which is then assigned to a float."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475104679, "post_id": 39758999, "comment_id": 66814148, "body": "check return value of <code>scanf</code>."}, {"owner": {"reputation": 51, "user_id": 6147699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6cc8bf29d5462847a48bed80937ffb09?s=128&d=identicon&r=PG&f=1", "display_name": "ceggleston55", "link": "https://stackoverflow.com/users/6147699/ceggleston55"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475104750, "post_id": 39758999, "comment_id": 66814170, "body": "@chux that negative number comes from the values"}, {"owner": {"reputation": 51, "user_id": 6147699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6cc8bf29d5462847a48bed80937ffb09?s=128&d=identicon&r=PG&f=1", "display_name": "ceggleston55", "link": "https://stackoverflow.com/users/6147699/ceggleston55"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475104819, "post_id": 39758999, "comment_id": 66814187, "body": "@chux ....2,3. I edited that in original question"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475105341, "post_id": 39758999, "comment_id": 66814323, "body": "If it can be read successfully, 5/10 ==&gt; become <code>0</code>. problem of the <code>locale</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 6883290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f76ab6eca8db678fb89838c535b2f46?s=128&d=identicon&r=PG&f=1", "display_name": "MrDonMatti", "link": "https://stackoverflow.com/users/6883290/mrdonmatti"}, "is_accepted": false, "score": 0, "last_activity_date": 1475105932, "last_edit_date": 1475105932, "creation_date": 1475104965, "answer_id": 39759093, "question_id": 39758999, "link": "https://stackoverflow.com/questions/39758999/solve-an-expression-based-on-user-input/39759093#39759093", "title": "Solve an expression based on user input", "body": "<p>Real fast fix would be something like this:<br>\n    <code>float E = (3 * (x*x) - 2 * (x*y) + 5) / ((float)y*y+1);</code><br>\nExplanation: promotion of denominator's expression to float value and, finally, whole expression yields float value.    </p>\n\n<p>EDIT: as Eisa said, in <code>scanf()</code> function all characters except format specifiers should be included in input - in this case <code>,</code> is between two integers, so possibilities are:      </p>\n\n<p>(whitespaces)first_number(whitespaces),(whitespaces)second_number(whitespaces)ENTER  </p>\n\n<p>(...) - optional</p>\n"}, {"tags": [], "owner": {"reputation": 256, "user_id": 6895884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eHvmo.jpg?s=128&g=1", "display_name": "Eisa", "link": "https://stackoverflow.com/users/6895884/eisa"}, "is_accepted": false, "score": 1, "last_activity_date": 1475105909, "last_edit_date": 1475105909, "creation_date": 1475105445, "answer_id": 39759147, "question_id": 39758999, "link": "https://stackoverflow.com/questions/39758999/solve-an-expression-based-on-user-input/39759147#39759147", "title": "Solve an expression based on user input", "body": "<p>Well if you want explicit x,y integers, either you should use MrDonMatti's approach or simply add a dot in front of one of the numbers in Float E expression. for example 3.</p>\n\n<pre><code>float E = (3. * (x*x) - 2 * (x*y) + 5) / (y*y+1);\n</code></pre>\n\n<p>This will fix the problem with returning 0 as your result.\n<strong>But</strong> the reason of getting a negative value is that you should give x,y to the program exactly like: \"2,3\". the comma is essential. If you don't use the comma, i.e.: \"2 3\" as input, it will set y as a not given or I don't know a -nan number that will ruin the formula.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1475106385, "last_edit_date": 1475106385, "creation_date": 1475106002, "answer_id": 39759216, "question_id": 39758999, "link": "https://stackoverflow.com/questions/39758999/solve-an-expression-based-on-user-input/39759216#39759216", "title": "Solve an expression based on user input", "body": "<p><code>-12586511</code> is certainly the result of invalid data entry.</p>\n\n<p>With input like <code>\"2 3\"</code> or <code>\"2 ,3\"</code> or <code>\"2 , 3\"</code>, <code>y</code> will not be set.</p>\n\n<pre><code>// Risky code\nscanf(\"%d,%d\", &amp;x, &amp;y);\n</code></pre>\n\n<p>Robust code checks the result of <code>scanf()</code> to insure proper input.</p>\n\n<pre><code>if (scanf(\"%d,%d\", &amp;x, &amp;y) != 2) {\n  puts(\"Error\");\n  return -1;\n}\n</code></pre>\n\n<p>Better to be generous and allow spaces after the number:</p>\n\n<pre><code>//           v \nif (scanf(\"%d ,%d\", &amp;x, &amp;y) != 2) {\n</code></pre>\n\n<p>Second issue involves the division being done using <code>int</code> math.  OP likely wants the equation to use FP math.</p>\n\n<pre><code>// float E = (3 * (x*x) - 2 * (x*y) + 5) / (y*y+1);\nfloat E = (3 * (x*x) - 2 * (x*y) + 5) / (y*y+1.0f);\n// or \nfloat E = (3.0f * (x*x) - 2 * (x*y) + 5) / (y*y+1.0f);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": false, "score": 0, "last_activity_date": 1475107105, "creation_date": 1475107105, "answer_id": 39759347, "question_id": 39758999, "link": "https://stackoverflow.com/questions/39758999/solve-an-expression-based-on-user-input/39759347#39759347", "title": "Solve an expression based on user input", "body": "<p>While the other posters showed you the possible error, let me add another two cents.</p>\n\n<p>If you mix integer with floating point arithmetic it is a good idea to keep the integer parts isolated as long as possible. It does not make much of a difference here, but you should keep it in mind.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void)\n{\n  int x, y;\n  float n, d;\n  int res;\n\n  printf(\"Enter two integer values (x, y): \");\n  res = scanf(\"%d,%d\", &amp;x, &amp;y);\n  if (res != 2) {\n    fprintf(stderr, \"scanf() did not get the expected input\\n\");\n    exit(EXIT_FAILURE);\n  }\n  // keep integer arithmetic as long as possible\n  // TODO: check for overflows\n  n = (3 * (x * x) - 2 * (x * y) + 5);\n  d = (y * y + 1);\n\n  float E = n / d;\n\n  printf(\"The expression value is: %.10f\\n\", E);\n\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>There <em>are</em> disadvantages, of course. The most significant is, that the integer parts may overflow where a full floating point calculation would just loose some accuracy. Checking for over/underflows adds some code which is might influence the runtime, too.</p>\n"}], "owner": {"reputation": 51, "user_id": 6147699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6cc8bf29d5462847a48bed80937ffb09?s=128&d=identicon&r=PG&f=1", "display_name": "ceggleston55", "link": "https://stackoverflow.com/users/6147699/ceggleston55"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1475110160, "creation_date": 1475104260, "last_edit_date": 1475110160, "question_id": 39758999, "link": "https://stackoverflow.com/questions/39758999/solve-an-expression-based-on-user-input", "title": "Solve an expression based on user input", "body": "<p>I am writing a program that asks the user for 2 inputs: x and y. these values are used to compute this formula: (3x^2-2xy+5)/(y^2+1). When I enter the values --> 2,3 it computes a really small negative number such as -12586511    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n\n    int x, y;\n\n    printf(\"Enter two integer values (x, y): \");\n    scanf(\"%d,%d\", &amp;x, &amp;y);\n\n    float E = (3 * (x*x) - 2 * (x*y) + 5) / (y*y+1);\n\n    printf(\"The expression value is: %.2f\\n\", E);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "memory-management", "linux-kernel", "kernel"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 4, "creation_date": 1475100665, "post_id": 39758462, "comment_id": 66812964, "body": "Same as non kernel code: know who owns the pointer."}, {"owner": {"reputation": 1478, "user_id": 2561445, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/82f658655317adab5cd37965d7db2f96?s=128&d=identicon&r=PG&f=1", "display_name": "bawejakunal", "link": "https://stackoverflow.com/users/2561445/bawejakunal"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1475100808, "post_id": 39758462, "comment_id": 66813018, "body": "@MooingDuck sorry I didn&#39;t get you. I&#39;m referring to a global pointer within the code, if that is what you meant ?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1475103530, "post_id": 39758462, "comment_id": 66813842, "body": "<code>Since double kfree() raises an error, what could be a good safeguard against that?</code> - The best safeguard is to eliminate all double <code>kfree</code>, as it is errorneous usage of kernel API. If you want to <b>debug concrete problem</b>, use any method which helps you in this concrete case. If you want to <b>allow</b> double <code>kfree</code> usage, then you need to mark pointer as already freed, the simplest way is to set some flag in the freed memory."}, {"owner": {"reputation": 1478, "user_id": 2561445, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/82f658655317adab5cd37965d7db2f96?s=128&d=identicon&r=PG&f=1", "display_name": "bawejakunal", "link": "https://stackoverflow.com/users/2561445/bawejakunal"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1475105113, "post_id": 39758462, "comment_id": 66814275, "body": "@Tsyvarev so my suggested strategy using NULL seems ok  ?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1475122701, "post_id": 39758462, "comment_id": 66818072, "body": "@bawejakunal How do you prevent double free in normal code?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1475136822, "post_id": 39758462, "comment_id": 66824470, "body": "@bawejakunal: It is always correct to call <code>kfree()</code> with NULL pointer. Such call does nothing. Is this an actual intention of your question?"}], "answers": [{"tags": [], "owner": {"reputation": 948, "user_id": 728333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf4315965a1b11f74402717e4ef30a4?s=128&d=identicon&r=PG", "display_name": "Ezequiel Garcia", "link": "https://stackoverflow.com/users/728333/ezequiel-garcia"}, "is_accepted": false, "score": 4, "last_activity_date": 1475167049, "creation_date": 1475167049, "answer_id": 39775690, "question_id": 39758462, "link": "https://stackoverflow.com/questions/39758462/prevent-double-kfree-in-kernel-code/39775690#39775690", "title": "Prevent double kfree in kernel code?", "body": "<p>Usually, you want to avoid that situation by <em>design</em>. Few examples:</p>\n\n<ul>\n<li><code>kmalloc()</code> on your driver's <code>.probe</code>, and you <code>kfree()</code> on your driver's <code>.remove</code>. Then you are good, the <code>probe/remove</code>  calls are balanced by the kernel.</li>\n<li><code>kmalloc()</code> on your char driver's <code>.open</code>, and you <code>kfree()</code> on your driver's <code>.release</code>. Also good, the <code>open/release</code> calls are balanced by the kernel.</li>\n</ul>\n\n<p>However, in certain cases, where for some reason you just want to deallocate the object <strong>if</strong> it was allocated, then your approach of NULLifying the pointer and check before <code>kfree()</code> is perfectly fine. (I would say it's a trace of something poorly designed... but I've been there and done it ;)</p>\n\n<p>In the future, when you have a question like this, where you want to see if an approach is popular enough, you can browse the kernel sources. Look for similar drivers and see what patterns are used. It will give you great insight!</p>\n"}], "owner": {"reputation": 1478, "user_id": 2561445, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/82f658655317adab5cd37965d7db2f96?s=128&d=identicon&r=PG&f=1", "display_name": "bawejakunal", "link": "https://stackoverflow.com/users/2561445/bawejakunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475167049, "creation_date": 1475100549, "question_id": 39758462, "link": "https://stackoverflow.com/questions/39758462/prevent-double-kfree-in-kernel-code", "title": "Prevent double kfree in kernel code?", "body": "<p>I am working on some system calls in the linux kernel. Since double <code>kfree()</code> raises an error, what could be a good safeguard against that ?</p>\n\n<p>One obvious idea I had in mind was to set the pointer to <code>NULL</code> after <code>kfree()</code> and check if it's <code>NULL</code> before next possible <code>kfree()</code>. I am not sure if this is the right way to do so. Please guide me.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 4, "creation_date": 1475100123, "post_id": 39758357, "comment_id": 66812749, "body": "read expects an address, <code>char c; read(file, &amp;c, 1);</code> should be enough."}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 0, "creation_date": 1475100199, "post_id": 39758357, "comment_id": 66812793, "body": "or <code>unsigned char c; read(file, &amp;c, 1)</code> to read byte."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475101499, "post_id": 39758357, "comment_id": 66813267, "body": "1) <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> 2) Don&#39;t compile C code with a C++ compiler. They are different languages! (just in case) 3) You have to pass <b>the address</b> of the buffer."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475102358, "post_id": 39758357, "comment_id": 66813508, "body": "@Olaf 1) The question seems quite clear to me; 2) Who said anything about a C++ compiler? 3) Don&#39;t answer in comments."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475102530, "post_id": 39758357, "comment_id": 66813548, "body": "&quot;I&#39;ve tried making buffer both a char and an int,&quot; only describe the code.  Better and clearer to post the code as it best conveys what you did.  Same for warnings.  Post the warning rather than describe it.  &quot;warnings that it expects a void * argument&quot; leaves open to interpretation what &quot;it&quot; is."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475103017, "post_id": 39758357, "comment_id": 66813690, "body": "@ca: 1) The question lacks the declaration of the names. 2) Read carefully: &quot;(just in case)&quot; 3) See 1, this is not an answer! 4) I&#39;m not a clairvoyant, YMMV"}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475100618, "post_id": 39758421, "comment_id": 66812938, "body": "Use <code>unsigned char</code> if you want to perform bitwise operations."}], "tags": [], "owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1475100788, "last_edit_date": 1475100788, "creation_date": 1475100381, "answer_id": 39758421, "question_id": 39758357, "link": "https://stackoverflow.com/questions/39758357/read-1-byte-from-file/39758421#39758421", "title": "Read 1 byte from file", "body": "<p>Binary operation can be performed on <code>char</code> data type with <code>unsigned</code>. Even if its an array binary operation can be done to the single element of the array. </p>\n\n<p>for your reference. </p>\n\n<p><code>ssize_t read(int fd, void *buf, size_t count);</code></p>\n\n<p>buffer has to be address of the <code>character</code> or <code>character array</code>, in your single <code>char</code> is sufficient. If you want to use array use the element <code>array[0]</code> and perform operation on that.</p>\n\n<p>As mentioned in the comments above</p>\n\n<pre><code>unsigned char c; \nread(file, &amp;c, 1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 1, "last_activity_date": 1475100484, "creation_date": 1475100484, "answer_id": 39758447, "question_id": 39758357, "link": "https://stackoverflow.com/questions/39758357/read-1-byte-from-file/39758447#39758447", "title": "Read 1 byte from file", "body": "<p>You can read into a char array as you (supposedly) know how to do, and then perform your binary operations on the first element of that array.</p>\n"}, {"comments": [{"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1475102523, "post_id": 39758501, "comment_id": 66813546, "body": "Simplicity wins every time. One line of code, no buffers, no pointers, no arrays. This is by far the best solution."}], "tags": [], "owner": {"reputation": 96, "user_id": 4126728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GghD1.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/4126728/greg"}, "is_accepted": false, "score": 6, "last_activity_date": 1475102350, "last_edit_date": 1475102350, "creation_date": 1475100775, "answer_id": 39758501, "question_id": 39758357, "link": "https://stackoverflow.com/questions/39758357/read-1-byte-from-file/39758501#39758501", "title": "Read 1 byte from file", "body": "<p>You could use the function <code>int fgetc (FILE *fp)</code>.\nThe return value will be an <code>int</code> value from 0 to 255 or <code>EOF</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "is_accepted": false, "score": 1, "last_activity_date": 1475101756, "creation_date": 1475101756, "answer_id": 39758641, "question_id": 39758357, "link": "https://stackoverflow.com/questions/39758357/read-1-byte-from-file/39758641#39758641", "title": "Read 1 byte from file", "body": "<pre><code>typedef unsigned char uint8_t; /* Not necessary if you are using C99, i.e. &lt;stdint.h&gt;. */\n\nuint8_t buffer[BUF_SIZE] = {0};\n    .\n    .\n    .\nif (fread(buffer, sizeof(buffer[0]), 1, file) == 1)\n{\n    buffer[0] ^= 0xFFu; /* Or any other bit-wise operation. */\n}\n</code></pre>\n\n<p>Refer -<br>\n1. <a href=\"https://linux.die.net/man/3/fread\" rel=\"nofollow\">https://linux.die.net/man/3/fread</a><br>\n2. <a href=\"http://en.cppreference.com/w/c/types/integer\" rel=\"nofollow\">http://en.cppreference.com/w/c/types/integer</a></p>\n"}], "owner": {"reputation": 625, "user_id": 6115394, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/25085ab420b50146c89a30ae543cde32?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6115394/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2272, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1475102350, "creation_date": 1475100036, "question_id": 39758357, "link": "https://stackoverflow.com/questions/39758357/read-1-byte-from-file", "title": "Read 1 byte from file", "body": "<p>I need to read a single byte from a file. Normally when reading, I use a char array as the buffer. However, I need to be able to perform binary operations with byte, which can't be done with a char array. Here's what I've got:</p>\n\n<pre><code>read(file, buffer, 1);\n</code></pre>\n\n<p>I've tried making buffer both a char and an int, but both give me warnings that it expects a void * argument. But of course, that doesn't allow for binary operations like &amp;.</p>\n\n<p>How can I store buffer such that I can perform binary operations on it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475100054, "post_id": 39758325, "comment_id": 66812727, "body": "1) Convert birthday to <code>time_t</code> with <code>mktime()</code>.  (might have trouble if born before Jan 1, 1970)  2) Get current time with <code>time()</code>  3) Get difference in seconds with <code>difftime()</code> then divide by (60*60*24)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1475100082, "post_id": 39758325, "comment_id": 66812732, "body": "<code>man mktime</code>, <code>man difftime</code>. <i>Update</i>: Ok, @chux wins..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475104567, "post_id": 39758325, "comment_id": 66814119, "body": "Why <code>&quot;Number of hours since birth&quot;</code> with the goal of &quot;get the amount of days&quot;?"}, {"owner": {"reputation": 41, "user_id": 6884558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc3d24f83b5d54a8386894e620b44f0?s=128&d=identicon&r=PG&f=1", "display_name": "Swannie", "link": "https://stackoverflow.com/users/6884558/swannie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475229004, "post_id": 39758325, "comment_id": 66870476, "body": "@chux sorry that should of been days"}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 4199141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_jGxyF86jpQ/AAAAAAAAAAI/AAAAAAAAAX0/r1vbGgE85DM/photo.jpg?sz=128", "display_name": "John Griffin", "link": "https://stackoverflow.com/users/4199141/john-griffin"}, "is_accepted": false, "score": 0, "last_activity_date": 1475170694, "creation_date": 1475170694, "answer_id": 39776709, "question_id": 39758325, "link": "https://stackoverflow.com/questions/39758325/get-days-between-a-date-and-now-using-the-time-function/39776709#39776709", "title": "Get days between a date and now using the time() function", "body": "<p>Subtract the julian day integer of the earlier date from the julian integer of the later date.  The following tells you exactly how to do that.</p>\n\n<p><a href=\"http://www.cs.utsa.edu/~cs1063/projects/Spring2011/Project1/jdn-explanation.html\" rel=\"nofollow\">http://www.cs.utsa.edu/~cs1063/projects/Spring2011/Project1/jdn-explanation.html</a></p>\n\n<p>Otherwise, <a href=\"http://pdc.ro.nu/jd-code.html\" rel=\"nofollow\">http://pdc.ro.nu/jd-code.html</a> already has a C version</p>\n\n<pre><code>long gregorian_calendar_to_jd(int y, int m, int d)\n{\n    y+=8000;\n    if(m&lt;3) { y--; m+=12; }\n    return (y*365) +(y/4) -(y/100) +(y/400) -1200820\n          +(m*153+3)/5-92\n          +d-1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 6884558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc3d24f83b5d54a8386894e620b44f0?s=128&d=identicon&r=PG&f=1", "display_name": "Swannie", "link": "https://stackoverflow.com/users/6884558/swannie"}, "edited": false, "score": 0, "creation_date": 1475522897, "post_id": 39818739, "comment_id": 66967657, "body": "im getting exception when trying to run your code i managed to figure out how to do it myself i have add my solution to the thread. may i ask why you have *days as a function parameter and not declared as a local variable?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 41, "user_id": 6884558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc3d24f83b5d54a8386894e620b44f0?s=128&d=identicon&r=PG&f=1", "display_name": "Swannie", "link": "https://stackoverflow.com/users/6884558/swannie"}, "edited": false, "score": 0, "creation_date": 1475524074, "post_id": 39818739, "comment_id": 66968316, "body": "@Swannie <code>*days</code> is used to return the days alive value.  The return value form this function indicates success or failure.  Concerning &quot;getting exception &quot;, how are you calling the function?  Like <code>double d; if( days_since_my_birth(3, 10, 2016, &amp;d) == SUCCESS) printf(&quot;%f\\n&quot;, d);</code>?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1475423294, "creation_date": 1475423294, "answer_id": 39818739, "question_id": 39758325, "link": "https://stackoverflow.com/questions/39758325/get-days-between-a-date-and-now-using-the-time-function/39818739#39818739", "title": "Get days between a date and now using the time() function", "body": "<blockquote>\n  <p>Get days between a date and now using the time() function</p>\n</blockquote>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;time.h&gt;\nint days_since_my_birth(int day, int month, int year, double *days) {\n\n  struct tm birthdate = { 0 };  // set all fields to 0\n  birthdate.tm_year = year - 1900;\n  birthdate.tm_mon = month - 1;  // Months since January\n  birthdate.tm_mday = day;\n  birthdate.tm_isdst = -1;  // Let system determine if DST was in effect\n\n  // Form timestamp for the birthdate.\n  time_t birth_time = mktime(&amp;birthdate);\n  if (birth_time == -1) return FAIL;\n\n  time_t now;\n  if (time(&amp;now) == -1) return FAIL;\n\n  // Calculate difference in seconds and convert to days.\n  // Round as desired  (rint(), floor(), etc.)\n  *days = floor(difftime(now, birth_time)/86400);\n  return SUCCESS;\n}\n</code></pre>\n\n<blockquote>\n  <p>Can I use the time() function to get the number of seconds from a date I entered?</p>\n</blockquote>\n\n<p>Maybe,  <code>time(NULL)</code> is not specified by C to return seconds nor since a certain epoch like Jan 1, 1970 - although that is commonly implemented that way.</p>\n\n<p><code>difftime()</code> returns the difference in seconds.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475524431, "post_id": 39838854, "comment_id": 66968490, "body": "This solution is prone to off-by-1 errors as 1) <code>mktime()</code> input is timezone sensitive, but the result discards time-zone data and 2) <code>double</code> to <code>int</code> truncation toward 0.  This affects the <code>(n &#47; 86400) - birthday</code> calculation.  Try this function with today&#39;s date, like <code>printf(&quot;%d\\n&quot;, days_since_my_birth(2, 10, 2016));   printf(&quot;%d\\n&quot;, days_since_my_birth(3, 10, 2016));   printf(&quot;%d\\n&quot;, days_since_my_birth(4, 10, 2016));</code> and see if you get 2 or 3 difference results.  Depending on <i>your</i> timezone, try this before and after midnight (midnight UTC time) to see the other problem."}], "tags": [], "owner": {"reputation": 41, "user_id": 6884558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc3d24f83b5d54a8386894e620b44f0?s=128&d=identicon&r=PG&f=1", "display_name": "Swannie", "link": "https://stackoverflow.com/users/6884558/swannie"}, "is_accepted": true, "score": 0, "last_activity_date": 1475522760, "last_edit_date": 1475522760, "creation_date": 1475522175, "answer_id": 39838854, "question_id": 39758325, "link": "https://stackoverflow.com/questions/39758325/get-days-between-a-date-and-now-using-the-time-function/39838854#39838854", "title": "Get days between a date and now using the time() function", "body": "<p>here is how i done it in the end. it doesnt work if the birthday entered is before 1970. thanks for all the help.</p>\n\n<p>i only just started learning c so there is probably more efficient ways to do it.</p>\n\n<pre><code>int days_since_my_birth(int day, int month, int year) {\n\n    //create a time struct and initailize it with the function parameters   \n    struct tm time_info = { 0 };\n    time_info.tm_year = year - 1900;\n    time_info.tm_mon = month -1;\n    time_info.tm_mday = day;\n\n    //get the number of seconds from 1970\n    int n = time(NULL);\n\n    // convert the birthdate to seconds\n    double birthday = mktime(&amp;time_info);\n    // convert the birthdate to days\n    birthday = (birthday / 86400);\n    //get the no of days alive by subtracting birthdate days\n    int result = (n / 86400) - birthday;\n\n    return result;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6884558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc3d24f83b5d54a8386894e620b44f0?s=128&d=identicon&r=PG&f=1", "display_name": "Swannie", "link": "https://stackoverflow.com/users/6884558/swannie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "accepted_answer_id": 39838854, "answer_count": 3, "score": 1, "last_activity_date": 1475522760, "creation_date": 1475099824, "last_edit_date": 1475228883, "question_id": 39758325, "link": "https://stackoverflow.com/questions/39758325/get-days-between-a-date-and-now-using-the-time-function", "title": "Get days between a date and now using the time() function", "body": "<p>I want to get a number of days from a certain date to current date.\nHere is my current code that gets the days from 1/1/1970.</p>\n\n<pre><code>int days_since_my_birth(int day, int month, int year) {\n\n    time_t sec;\n    sec = time(NULL);\n\n    printf(\"Number of days since birth is %ld \\n\", sec / 86400);\n\n    return d;\n}\n</code></pre>\n\n<p>Can I use the <code>time()</code> function to get the number of seconds from a date I entered?</p>\n"}, {"tags": ["c", "variables", "macros"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1475099248, "post_id": 39758193, "comment_id": 66812420, "body": "It&#39;s preferable to use a <code>const</code> over macro."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475100578, "post_id": 39758193, "comment_id": 66812924, "body": "Is the initializer a constant value or an expression?  I agree with the consensus that a <code>const</code> &#39;variable&#39; is better, but it is even more pronounced if the initializer is an elaborate run-time expression, especially if the value is used more than once. One additional advantage of not using a macro: the variable name will be in the symbol table of the program, whereas a macro will not be in the symbol table.  The absence of a symbol makes debugging harder than it need be."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475100787, "post_id": 39758193, "comment_id": 66813013, "body": "@EugeneSh.: <code>const i = 10; static int a[i];</code> does not work! In C you need a clear naming scheme anyway, no specific problem with macros. If you need a symbolic constant, use a macro. I&#39;m with you for function-like macros, though."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1475100807, "post_id": 39758193, "comment_id": 66813017, "body": "This question would be much better if you actually showed the code that you&#39;re talking about."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475101140, "post_id": 39758193, "comment_id": 66813136, "body": "@Olaf I didn&#39;t claim they are completely interchangeable. Recently I&#39;ve had to switch from <code>#define</code> to <code>const</code> to avoid a &quot;pointless comparison&quot; warning, as it was comparing the <code>#defined</code>constant zero against an unsigned (some version specific information)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1475101238, "post_id": 39758193, "comment_id": 66813179, "body": "&quot; Is a macro ALWAYS preferable in this case?&quot;  --&gt; the case is not clearly presented."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475101307, "post_id": 39758193, "comment_id": 66813204, "body": "@EugeneSh.: You are aware your example actually supports my point, do you? And there are alternatives. On some very low-level OS code, I sometimes also have unavoidable warnings. That&#39;s what <code>#pragma push ... pragma pop</code> is for."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475101353, "post_id": 39758193, "comment_id": 66813216, "body": "@chux: Nor is a <code>const</code> variable. I&#39;d CVed as too broad if I had CVs left (didn&#39;t know there is a dup, though). It is just that unreflected macro-bashing which upsets me."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475101523, "post_id": 39758193, "comment_id": 66813277, "body": "@olaf the initial pragma solution was rejected in the code review :) I don&#39;t argue your point. I am saying that const is preferable alternative if it is an actual alternative. In case you presented it is not."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475101741, "post_id": 39758193, "comment_id": 66813344, "body": "@EugeneSh.: Kick the reviewer where it hurts for being ignorant then;-) I know such ppl, too: just MISRA and nothing else in their head. My personal statement: those ppl don&#39;t really know the language, that&#39;s why they stick to some simple check-list document. In general, if I need &quot;symbolic&quot; constants, I use <code>const</code> in C++ and macros in C (<code>enums</code> are  often near useless due to their automatically choosen type and the constants being <code>int</code>-only). ..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475102176, "post_id": 39758193, "comment_id": 66813461, "body": "@EugeneSh.: ... FYI: on arch like ARM-MCUs, <code>const</code> variables have another problem: the compiler can emit load-instructions as they take the same code-space and <b>theoretically</b> cycles. For true constants, it generates 16 bit move instructions (upper/lower 16 bits). With a slow Flash and prefetch those are much faster than the loads which stall the prefetch and have to access a completely different part of Flash, with all waitstates included. That easily can add some 10 cycles (for a 150-200MHz CPU) to each load. Quite some time e.g. in an interrupt-handler."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475108800, "post_id": 39758193, "comment_id": 66815036, "body": "You could/should review <a href=\"http://stackoverflow.com/questions/1674032/static-const-vs-define-vs-enum/\"><code>static const</code> vs <code>#define</code> vs <code>enum</code></a> \u2014 it covers closely related ground even if it doesn&#39;t cover exactly your issue.  As I noted earlier, a lot depends on the nature of the initialization for the variable."}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1475099747, "post_id": 39758229, "comment_id": 66812607, "body": "This is not a variable - it cannot vary - hence <code>const</code>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475099853, "post_id": 39758229, "comment_id": 66812639, "body": "Please don&#39;t suggest UPPERCASE for non macros. Const and non-const variables are lower case."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1475099931, "post_id": 39758229, "comment_id": 66812670, "body": "It is perfectly reasonable to use UPPER CASE in this instance. It behaves similar to a macro. Does not require memory for the value"}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475099980, "post_id": 39758229, "comment_id": 66812699, "body": "@2501: It&#39;s totally legitimate to use an upper case name for a const variable."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1475100444, "post_id": 39758229, "comment_id": 66812874, "body": "That code above is still a variable in C. Try this at file-level and <code>int a[CONST_VALUE];</code>! Macros are the C-way to define symbolic constants. There is nothing wrong with them."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475100494, "post_id": 39758229, "comment_id": 66812890, "body": "@2501: While I agree with you, it is no concrete law."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475100640, "post_id": 39758229, "comment_id": 66812952, "body": "@Olaf: a flaw of the language shouldn&#39;t justify using macros to define symbolic constants when you are allowed to use the latter. It&#39;s simply bad practice, less safe and totally discouraged."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475101001, "post_id": 39758229, "comment_id": 66813092, "body": "@Jack: That is not a &quot;flaw of the language&quot;, but that&#39;s how the language is designed. If you are on Rome, speak like a Roman. Trying to enforce programming style for other languages in one language will only result in disaster. There is nothing wrong with such macros if you have a consistent naming scheme (you need that anyway in a mid-to-large C project)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475101102, "post_id": 39758229, "comment_id": 66813124, "body": "@Jack: Please provide a reference to where the standard discourages using constant-like macros."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475101102, "post_id": 39758229, "comment_id": 66813125, "body": "If <code>CONST_VALUE</code>, as a <code>const int</code>, was not <code>static</code> and outside a function, it collides with files that may use the same name for an object.  If <code>CONST_VALUE</code> was a macro,  --&gt; no collision."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475101287, "post_id": 39758229, "comment_id": 66813196, "body": "@Olaf: that&#39;s not a sensible comparison. The fact that the C specification doesn&#39;t allow a non <code>volatile const</code> variable which never has its address taken to be optimized away and used to specify the size of an array is a flaw of the specification per se. There is no drawback in using a <code>const int</code> instead of a macro, so I don&#39;t get how a macro textual replacement could be better than something that is semantically interpreted."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475102786, "post_id": 39758229, "comment_id": 66813625, "body": "@Jack: That is completely unrelated to the <code>volatile</code> qualifier! And optimisation shall not change the observable behaviour required by the abstract machine. If your compiler changes behaviour of a program due to optimisations, get your money back! The example is perfectly valid as-is and will not work in C, because <code>const</code> qualified <b>variables</b> are - well - <b>variables</b> and VLAs with static storage duration are not allowed. No offence, but it strongly seems as if you talk from a C++ viewpoint."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1475103304, "post_id": 39758229, "comment_id": 66813776, "body": "Indeed in the case of a symbolic constant which is not used to declare an array the observable behavior doesn&#39;t change. Any compiler will optimize it away if it&#39;s not involved in any edge case (and if it&#39;s not <code>volatile</code>, which is totally related to the question, since a <code>volatile const</code> can&#39;t be replaced with its value directly in optimization just because in that case you are effectively changing the observable behavior). Check this code <a href=\"https://godbolt.org/g/9etgnC\" rel=\"nofollow noreferrer\">godbolt.org/g/9etgnC</a> and tell me how <code>const int</code> has changed the observable behavior compared to a <code>#define</code>."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475103658, "post_id": 39758229, "comment_id": 66813872, "body": "@Olaf: just to be precise the online compiler is a C++ one because I haven&#39;t been able to find the same tool for C language but local results (clang-703.0.31) are exactly the same, compiled with <code>clang -S -O3 foo.c</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475103969, "post_id": 39758229, "comment_id": 66813957, "body": "@Jack: If you try this on some embedded systems, you will be surprised. As a general rule, true constants will result in less surprise and - on some (quite common!) targets - can result in much faster code."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475104754, "post_id": 39758229, "comment_id": 66814172, "body": "@Olaf: ok, that&#39;s the first reasonable comment I read. Yes, and that&#39;s true since C specification treats <code>const</code> differently from C++. But this doesn&#39;t justify blindly suggesting people to avoid using <code>const</code> (at least on x86/64 and arm) in favour of textual replacement (which you agree, is evil by definition). Undoubtedly it is worth warning that a <code>const int</code> used for a symbolic constant could require storage according to compiler and architecture (which I consider an edge case, since embedded systems are a requirement not the first case scenario)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475106485, "post_id": 39758229, "comment_id": 66814565, "body": "@Jack: The problems I mentioned at least very well can apply especially  to ARM (something like MSP430 or S08 typically does not have waitstates on memory)! Have a look at the instruction set. So it very well is appropriate to recommend using constant-like macros <b>in C</b>! If you use reasonable names (and not <code>A</code>, <code>i</code>, etc. which is bad style for variables as well), there is no true disadvantage. But you are always on the safe side."}], "tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": true, "score": -1, "last_activity_date": 1475099334, "creation_date": 1475099334, "answer_id": 39758229, "question_id": 39758193, "link": "https://stackoverflow.com/questions/39758193/should-i-use-a-macro-or-a-variable/39758229#39758229", "title": "Should I use a macro or a variable?", "body": "<p>A macro is basically never preferable compared to a variable, since a variable which doesn't change its value can be declared as <code>const</code> and it will likely be optimized away in any case.</p>\n\n<pre><code>const int CONST_VALUE = 1234;\n</code></pre>\n\n<p>is safer and clearly expresses the meaning more than a macro.</p>\n"}], "owner": {"reputation": 5455, "user_id": 1438271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/395b790c7dc655ec0cc760fd8f83a4be?s=128&d=identicon&r=PG", "display_name": "Eman", "link": "https://stackoverflow.com/users/1438271/eman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "closed_date": 1475100475, "accepted_answer_id": 39758229, "answer_count": 1, "score": -4, "last_activity_date": 1475099821, "creation_date": 1475099162, "question_id": 39758193, "link": "https://stackoverflow.com/questions/39758193/should-i-use-a-macro-or-a-variable", "closed_reason": "Duplicate", "title": "Should I use a macro or a variable?", "body": "<p>I am rewriting a function and I noticed one particular variable is never reassigned after initialization.  Is there any reason NOT to simply convert this variable to a macro?  Is a macro ALWAYS preferable in this case?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "linux", "string", "gdb"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475097909, "post_id": 39757748, "comment_id": 66811857, "body": "There are no <code>free</code> in the proposed code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475098236, "post_id": 39757748, "comment_id": 66811989, "body": "Should <code>if(*curr&gt;&#39;0&#39;){ hasValue = 1; }</code> be just before the <code>curr++</code> since you have already incremented it?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1475098274, "post_id": 39757748, "comment_id": 66812013, "body": "What does <code>valgrind</code> tell you?"}, {"owner": {"reputation": 1580, "user_id": 6667256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c939d82ad703536dcfc9f9eee6dd819?s=128&d=identicon&r=PG&f=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/6667256/franck"}, "edited": false, "score": 0, "creation_date": 1475098521, "post_id": 39757748, "comment_id": 66812119, "body": "if <code>argc = 1</code> then <code>argv[1]</code> is not supposed to be valid."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1475099664, "post_id": 39757748, "comment_id": 66812574, "body": "The error shown is because you have argc==1 but are accessing argv[1]. You need to use the &quot;args&quot; gdb command to specify the programs command line, and if you still get a problem, you need to open a new question about that issue, not hack on your already answered one."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475099935, "post_id": 39757748, "comment_id": 66812678, "body": "show code of <code>main</code>."}, {"owner": {"reputation": 22505, "user_id": 1411457, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XqssD.png?s=128&g=1", "display_name": "harmic", "link": "https://stackoverflow.com/users/1411457/harmic"}, "edited": false, "score": 0, "creation_date": 1475109346, "post_id": 39757748, "comment_id": 66815153, "body": "valgrind output indicates you are freeing the wrong thing. I&#39;ve updated my answer"}], "answers": [{"tags": [], "owner": {"reputation": 22505, "user_id": 1411457, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XqssD.png?s=128&g=1", "display_name": "harmic", "link": "https://stackoverflow.com/users/1411457/harmic"}, "is_accepted": false, "score": 3, "last_activity_date": 1475109291, "last_edit_date": 1475109291, "creation_date": 1475098493, "answer_id": 39758048, "question_id": 39757748, "link": "https://stackoverflow.com/questions/39757748/finding-cause-of-double-free-or-corruption-out-in-c/39758048#39758048", "title": "finding cause of &quot; double free or corruption (out):&quot; in C", "body": "<p>The problem you are seeing in gdb is different to the one you are seeing when you run the program normally.</p>\n\n<p>In the gdb output you can see <code>argc=1</code>. This means argv only has one element,  and <code>argv[1]</code> is out of bounds.</p>\n\n<p>You probably invoked the program with no arguments. Note that when you run a program under gdb, the arguments are supplied after the 'run' command inside gdb, <strong>not</strong> when you invoke gdb itself.</p>\n\n<p>I suggest you add a check that you have received the expected number of arguments and display an error message if not.</p>\n\n<p>As for the 'double free or corruption', this information in the valgrind output is probably important:</p>\n\n<pre><code>==12431==  Address 0xfff000250 is on thread 1's stack\n</code></pre>\n\n<p>It implies you are trying to free a local variable instead of a heap variable. Perhaps you are passing the wrong argument to TKDestroy?</p>\n"}, {"tags": [], "owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1475099530, "last_edit_date": 1475099530, "creation_date": 1475099024, "answer_id": 39758160, "question_id": 39757748, "link": "https://stackoverflow.com/questions/39757748/finding-cause-of-double-free-or-corruption-out-in-c/39758160#39758160", "title": "finding cause of &quot; double free or corruption (out):&quot; in C", "body": "<pre><code>int main(int argc, char * argv[])\n{\nif(argc&lt;2)\n{\n   printf(\"Usage : &lt; command line execution format&gt;\\n\");\n   return 0;\n}\n//your code\nreturn 0;\n}\n</code></pre>\n\n<p>If <code>argc = 1</code> means command line argument is <code>1</code> and i.e the file of the execution.\n<code>argv[0]</code> contains the file name of the file executed.\nif you try to access <code>argv[1]</code> which does not have any memory allocated which results in segmentation fault.</p>\n\n<p>To over come this you need to check the <code>argc</code> before accessing any element <code>argv[]</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 6884545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e757dd2a5bb2b0feda1fc86589f71e?s=128&d=identicon&r=PG&f=1", "display_name": "Chang Lib", "link": "https://stackoverflow.com/users/6884545/chang-lib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1475109291, "creation_date": 1475097166, "last_edit_date": 1475099346, "question_id": 39757748, "link": "https://stackoverflow.com/questions/39757748/finding-cause-of-double-free-or-corruption-out-in-c", "title": "finding cause of &quot; double free or corruption (out):&quot; in C", "body": "<p>New to C and getting errors when running my program on Linux, the program ran and worked fine in windows compiled using MinGW</p>\n\n<p>I get double free or corruption (out): when running the program.</p>\n\n<p>here is where I think the error is:</p>\n\n<pre><code>TokenizerT *TKCreate( char * ts ) {\n\nif(ts==NULL){\n    return NULL;\n}\n\nchar * tempstr;\n\ntempstr = ts;\n\n//Allocating memory for Tokenizer struct\nTokenizerT *Tokenizer= (TokenizerT *) malloc(sizeof(TokenizerT));\n\n\n//Allocating memory for token stream\nTokenizer-&gt;string = strdup(tempstr);\n\n\n//strcpy(Tokenizer-&gt;string, ts);\n\n//Check field to see wether or not strtok has went through its original call\nTokenizer-&gt;stepped = 0;\n\n\n    return Tokenizer;\n}\n</code></pre>\n\n<p>I also have a simple function that always works in windows, but returns wrong output in Linux:</p>\n\n<pre><code>int isOctal(const char * str){\nconst char *curr = str;\nint hasValue = 0;\n\n//Checking if token begins with 0\nif(*curr!='0'){\n    return 0;\n}\n\n++curr;\n\n//Ensuring 0-7 are only other digits used\nwhile(*curr!=0){\n    if ((*curr &gt;='0')&amp;&amp;(*curr&lt;='7')){\n        ++curr;\n    }else{\n        return 0;\n    }\n    if(*curr&gt;'0'){\n        hasValue = 1;\n    }\n\n}\n\nif(hasValue==0){\n    return 0;\n}\nreturn 1;\n\n}\n</code></pre>\n\n<p>This is what I get when using gdb:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x0000000000400ca5 in main (argc=1, argv=0x7fffffffe378) at tokenizer.c:365\n365             yoken = * TKCreate(argv[1]);\n</code></pre>\n\n<p>Really scratching my head here, thought I finally ironed out all the problems until I tried to compile on Linux</p>\n\n<p>Edit 1:\nAdded a check for the correct amount of arguments and it still gives the error. If i comment out my call to this function, the code works but I'm worried its not freeing memory then.</p>\n\n<pre><code>void TKDestroy( TokenizerT * tk ) {\n\nfree(tk-&gt;string);\nfree(tk);\n\n\n\n}\n</code></pre>\n\n<p>Edit 2:\nHere is some information from valgrind</p>\n\n<pre><code>==12431== Invalid free() / delete / delete[] / realloc()\n==12431==    at 0x4C2AD17: free (in /usr/lib64/valgrind/vgpreload_memcheck- amd64-linux.so)\n==12431==    by 0x400837: TKDestroy (tokenizer.c:76)\n==12431==    by 0x400E11: main (tokenizer.c:403)\n==12431==  Address 0xfff000250 is on thread 1's stack\n==12431==  in frame #2, created by main (tokenizer.c:355)\n</code></pre>\n\n<p>When I call the program with the incorrect amount of arguments it does not cause an error. The error only occurs when I use the program correctly</p>\n"}, {"tags": ["c", "strict-aliasing"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475097093, "post_id": 39757658, "comment_id": 66811465, "body": "Cannot reproduce on ideone: <a href=\"https://ideone.com/SUw1di\" rel=\"nofollow noreferrer\">ideone.com/SUw1di</a>. It probably uses an older version of gcc."}, {"owner": {"reputation": 1148, "user_id": 4966481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/27fef0fb61ca4732c48f1b021f66ca92?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Martin", "link": "https://stackoverflow.com/users/4966481/adam-martin"}, "edited": false, "score": 0, "creation_date": 1475097129, "post_id": 39757658, "comment_id": 66811481, "body": "I&#39;m not sure if this would cause this, but couldn&#39;t the compiler think it can move the first print statement before <code>*s = 100;</code>?  Not a language lawyer, but maybe check for that in the assembled code?"}, {"owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475097160, "post_id": 39757658, "comment_id": 66811498, "body": "I can reproduce on ideone, @2501. I&#39;ve just added such a link to the question"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475097377, "post_id": 39757658, "comment_id": 66811600, "body": "See also the analogous C++ question <a href=\"http://stackoverflow.com/questions/39757246/violating-strict-aliasing-even-without-any-casting\">Violating strict aliasing without any casting</a>."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1475097576, "post_id": 39757658, "comment_id": 66811702, "body": "Can reproduce with gcc 6.2 and clang 3.8 using -O2."}, {"owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "edited": false, "score": 1, "creation_date": 1475097577, "post_id": 39757658, "comment_id": 66811704, "body": "I&#39;ve just tweaked the start of the question to point out that the behaviour on ideone depends on whether &#39;C&#39; or &#39;C99 strict&#39; is selected as the language"}, {"owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "reply_to_user": {"reputation": 1148, "user_id": 4966481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/27fef0fb61ca4732c48f1b021f66ca92?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Martin", "link": "https://stackoverflow.com/users/4966481/adam-martin"}, "edited": false, "score": 0, "creation_date": 1475097824, "post_id": 39757658, "comment_id": 66811820, "body": "@AdamMartin, I&#39;m looking at the assember now, but it&#39;s a mystery to me :-). I&#39;ll try to simplify the C a little further, in the hope that the assember will seem more reasonable"}, {"owner": {"reputation": 1148, "user_id": 4966481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/27fef0fb61ca4732c48f1b021f66ca92?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Martin", "link": "https://stackoverflow.com/users/4966481/adam-martin"}, "edited": false, "score": 0, "creation_date": 1475098040, "post_id": 39757658, "comment_id": 66811908, "body": "@AaronMcDaid dbush&#39;s answer seems to indicate that that is the problem."}, {"owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "reply_to_user": {"reputation": 1148, "user_id": 4966481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/27fef0fb61ca4732c48f1b021f66ca92?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Martin", "link": "https://stackoverflow.com/users/4966481/adam-martin"}, "edited": false, "score": 0, "creation_date": 1475098043, "post_id": 39757658, "comment_id": 66811912, "body": "@AdamMartin, on second thoughts, I guess that&#39;s it. The two lines you refer to involve different types of lvalue, <code>int</code> and <code>short</code>, and there is no union in sight in either of those two lines. Therefore, it can swap them"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 2, "creation_date": 1475098517, "post_id": 39757658, "comment_id": 66812117, "body": "<a href=\"http://stackoverflow.com/questions/38798140/is-the-strict-aliasing-rule-incorrectly-specified/\">This question</a> might interest you, it comes to the same conclusion as the accepted answer here."}, {"owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1475099208, "post_id": 39757658, "comment_id": 66812408, "body": "Thanks @alain, I think I saw that recently too. And I was always happy to see, when the pointers are passed into another function, that the compiler can&#39;t be expected to have perfect knowledge of what might alias. I find this question here interesting because it all happens within one fucntion"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475099960, "post_id": 39757658, "comment_id": 66812690, "body": "This happens simply because the two pointers may not alias. It breaks strict aliasing. Even though they point to valid objects of correct respective types, they still alias, and they should not."}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1475156627, "post_id": 39757658, "comment_id": 66838378, "body": "Does <code>volatile int     * i = &amp;u.i;</code> prevent the undesired behavior?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1475165163, "post_id": 39757658, "comment_id": 66844442, "body": "@infixed No. The keyword volatile does not change/avoid aliasing rules."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1475099899, "post_id": 39757751, "comment_id": 66812655, "body": "UB is UB. Anything can happen."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 5, "last_activity_date": 1475608277, "last_edit_date": 1475608277, "creation_date": 1475097188, "answer_id": 39757751, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting/39757751#39757751", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p>Looks like this is a result of the optimizer doing its magic.</p>\n\n<p>With <code>-O0</code>, both lines print 100 as expected (assuming little-endian).  With <code>-O2</code>, there is some reordering going on.</p>\n\n<p>gdb gives the following output:</p>\n\n\n\n<pre><code>(gdb) start\nTemporary breakpoint 1 at 0x4004a0: file /tmp/x1.c, line 14.\nStarting program: /tmp/x1\nwarning: no loadable sections found in added symbol-file system-supplied DSO at 0x2aaaaaaab000\n\nTemporary breakpoint 1, main () at /tmp/x1.c:14\n14      {\n(gdb) step\n15          *i  = 2;\n(gdb)\n18          printf(\" *i = %d\\n\",  *i); // prints 2\n(gdb)\n15          *i  = 2;\n(gdb)\n16          *s  = 100;\n(gdb)\n18          printf(\" *i = %d\\n\",  *i); // prints 2\n(gdb)\n *i = 2\n19          printf(\"u.i = %d\\n\", u.i); // prints 100\n(gdb)\nu.i = 100\n22      }\n(gdb)\n0x0000003fa441d9f4 in __libc_start_main () from /lib64/libc.so.6\n(gdb)\n</code></pre>\n\n<p>The reason this happens, as others have stated, is because it is undefined behavior to access a variable of one type through a pointer to another type even if the variable in question is part of a union.  So the optimizer is free to do as it wishes in this case.</p>\n\n<p>The variable of the other type can only be read directly via a union which guarantees well defined behavior.</p>\n\n<p>What's curious is that even with <code>-Wstrict-aliasing=2</code>, gcc (as of 4.8.4) doesn't complain about this code.</p>\n"}, {"comments": [{"owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "edited": false, "score": 8, "creation_date": 1475098323, "post_id": 39757909, "comment_id": 66812035, "body": "&quot;... provided the memory is accessed through the union type&quot; I guess that&#39;s the crucial portion, in this context."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 4, "creation_date": 1475155440, "post_id": 39757909, "comment_id": 66837499, "body": "This is not a problem of the compiler, but the code invoking undefined behaviour. The lvalues of the dereferenced pointers are <b>not</b> <code>union</code>s, thus violate the <i>effective type rule</i> required by the standard. Using a compiler-option to work-around this is not the correct approach, as that can degrade optimisation quality. The correct way is to fix the actual fault in the code to become compliant. There is no reason not to make the pointers pointers to the <code>union</code>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1530204958, "post_id": 39757909, "comment_id": 89164584, "body": "@Olaf: The Standard makes no provision for an aggregate to be accessed using any lvalue of a non-character member type, <i>even if the lvalue in question happens to be a member-access expression</i>.  It relies upon quality compilers making at least some effort to support the use of derived lvalues, but leaves the amount of effort as a Quality of Implementation issue.  Given <code>union { uint32_t words[4]; uint16_t shorts[8];} u;</code> gcc can&#39;t even recognize the possibility of aliasing between <code>*(u.words+i)</code> and <code>*(u.shorts+j)</code> even though both lvalues are directly derived from the same union lvalue <code>u</code>."}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": true, "score": 56, "last_activity_date": 1505362295, "last_edit_date": 1505362295, "creation_date": 1475097824, "answer_id": 39757909, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting/39757909#39757909", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p>The disrepancy is issued by <code>-fstrict-aliasing</code> optimization option. Its behavior and possible traps are described in <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#index-fstrict-aliasing-906\" rel=\"nofollow noreferrer\">GCC documentation</a>:</p>\n\n<blockquote>\n  <p>Pay special attention to code like this:</p>\n\n<pre><code>      union a_union {\n        int i;\n        double d;\n      };\n\n      int f() {\n        union a_union t;\n        t.d = 3.0;\n        return t.i;\n      }\n</code></pre>\n  \n  <p>The practice of reading from a different union member than the one\n  most recently written to (called \u201ctype-punning\u201d) is common. Even with\n  <code>-fstrict-aliasing</code>, type-punning is allowed, <strong>provided the memory is accessed through the union type</strong>. So, the code above works as expected.\n  See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Structures-unions-enumerations-and-bit-fields-implementation.html#Structures-unions-enumerations-and-bit-fields-implementation\" rel=\"nofollow noreferrer\">Structures unions enumerations and bit-fields implementation</a>. <strong>However, this code might\n  not</strong>:</p>\n\n<pre><code>      int f() {\n        union a_union t;\n        int* ip;\n        t.d = 3.0;\n        ip = &amp;t.i;\n        return *ip;\n      }\n</code></pre>\n</blockquote>\n\n<p>Note that conforming implementation is perfectly allowed to take advantage of this optimization, as second code example exhibits <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a>. See <a href=\"https://stackoverflow.com/a/39758191/586873\">Olaf's</a> and others' answers for reference.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475100174, "post_id": 39758187, "comment_id": 66812774, "body": "As the lvalues are not <code>union</code>s, the member apparently is not used. <b>Where</b> they point to is not really relevant here, but how (i.e. through which type) they are accessed (that is typical for C). There is some parallel to <code>malloc</code>ed memory which also gets its type defined by the lvalue of the first write."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1530724962, "post_id": 39758187, "comment_id": 89339604, "body": "@Olaf: The type of lvalue of the form <code>aggregate.member</code> is the declared type of the member.  The authors of C89 likely thought compiler writers would have the common sense to recognize that applying a member-access operator to an aggregate would cause quality compilers to make a bona fide effort to associate actions on the lvalue with actions on the aggregate, nothing in the Standard indicates that it is required in cases where that lvalue is used directly, nor that quality implementations should be limited to handling that exact case."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 6, "last_activity_date": 1475099112, "creation_date": 1475099112, "answer_id": 39758187, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting/39758187#39758187", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p>You are probing a somewhat controversial area of the C standard.</p>\n\n<p>This is the strict aliasing rule:</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an lvalue\n  expression that has one of the following types: </p>\n  \n  <ul>\n  <li>a type compatible with the effective type of the object, </li>\n  <li>a qualified version of a type compatible with the effective type of the object,</li>\n  <li>a type  that  is  the  signed  or  unsigned  type  corresponding  to \n  the  effective  type  of  the object,</li>\n  <li>a type that is the signed or unsigned type corresponding to a qualified version of the effective type of the object,</li>\n  <li>an aggregate  or  union  type  that  includes one  of  the  aforementioned  types  among  its members (including, recursively, a member of a subaggregate or contained union),</li>\n  <li>a character type.</li>\n  </ul>\n</blockquote>\n\n<p>(C2011, 6.5/7)</p>\n\n<p>The lvalue expression <code>*i</code> has type <code>int</code>.  The lvalue expression <code>*s</code> has type <code>short</code>.  These types are not compatible with each other, nor both compatible with any other particular type, nor does the strict aliasing rule afford any other alternative that allows both accesses to conform if the pointers are aliased.</p>\n\n<p>If at least one of the accesses is non-conforming then the behavior is undefined, so the result you report -- or indeed any other result at all -- is entirely acceptable.  In practice, the compiler must produce code that reorders the assignments with the <code>printf()</code> calls, or that uses a previously loaded value of <code>*i</code> from a register instead of re-reading it from memory, or some similar thing.</p>\n\n<p>The aforementioned controversy arises because people will sometimes point to <em>footnote</em> 95:</p>\n\n<blockquote>\n  <p>If the member used to read the contents of a union object is not the same as the member last used to store a value in the object, the appropriate part of the object representation of the value is reinterpreted as  an  object  representation  in  the  new type  as  described  in  6.2.6  (a  process  sometimes  called  \u2018\u2018type punning\u2019\u2019).  This might be a trap representation.</p>\n</blockquote>\n\n<p>Footnotes are informational, however, not normative, so there's really no question which text wins if they conflict.  Personally, I take the footnote simply as an implementation guidance, clarifying the meaning of the fact that the storage for union members overlaps.</p>\n"}, {"comments": [{"owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "edited": false, "score": 0, "creation_date": 1475099429, "post_id": 39758191, "comment_id": 66812489, "body": "I guess the point is that <code>*i</code> and <code>u.i</code> are not really the same. Both are lvalue <code>int</code>s, and we know they refer to the same location. But the latter &#39;remembers&#39; that it is inside a union."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "edited": false, "score": 1, "creation_date": 1475099526, "post_id": 39758191, "comment_id": 66812526, "body": "@AaronMcDaid: Problem is not the <code>union</code>, but the pointers. You declared them with distinct types, so the lvalues are <b>not</b> the same. And they are not <code>union</code>s. The exception in the standard only applies to <code>union</code>s. Not sure, but as you write you know C++: I strongly doubt this is allowed in C++ either."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6836841"}, "edited": false, "score": 0, "creation_date": 1475251141, "post_id": 39758191, "comment_id": 66883953, "body": "By your last statement.. do you mean <code>int * i = &amp;u; short * s = &amp;u</code>?  And then you&#39;re free to assign an <code>int</code> or <code>short</code> to either pointer which you could then deref in the print statements?  If you could provide example code, I&#39;d be very grateful :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475251805, "post_id": 39758191, "comment_id": 66884323, "body": "@MattGalaxy: That would apparently be even worse and should generate a diagnostic for assigning the wrong type to the pointers. The lvalue for the read would be the same as in the original code. The pointers have to be declared pointers <b>to</b> that <code>union</code>. For this, of course the <code>union</code> needs a tag to be usable as distinct type, the pointers be declared with the union or a <code>typedef</code> for that <code>union</code> before any variable declaration."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 18, "last_activity_date": 1475253548, "last_edit_date": 1475253548, "creation_date": 1475099133, "answer_id": 39758191, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting/39758191#39758191", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5p7\">C standard (i.e. C11, n1570), 6.5p7</a>:</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an <strong>lvalue</strong> expression that has one of the following types:</p>\n  \n  <ul>\n  <li>...</li>\n  <li>an aggregate or union type that includes one of the aforementioned types among its members (including, recursively, a member of a subaggregate or contained union), or\n  a character type.</li>\n  </ul>\n</blockquote>\n\n<p>The lvalue expressions of your pointers are <strong>not</strong> <code>union</code> types, thus this exception does not apply. The compiler is correct exploiting this undefined behaviour.</p>\n\n<p>Make the pointers' types pointers to the <code>union</code> type and dereference with the respective member. That should work:</p>\n\n<pre><code>union {\n    ...\n} u, *i, *p;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 7, "last_activity_date": 1475608138, "last_edit_date": 1475608138, "creation_date": 1475100144, "answer_id": 39758384, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting/39758384#39758384", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p>This code indeed invokes UB, because you do not respect the strict aliasing rule. n1256 draft of C99 states in 6.5 Expressions \u00a77:</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an lvalue expression that has one of\n  the following types:<br/>\n  \u2014 a type compatible with the effective type of the object,<br/>\n  \u2014 a qualified version of a type compatible with the effective type of the object,<br/>\n  \u2014 a type that is the signed or unsigned type corresponding to the effective type of the\n  object,<br/>\n  \u2014 a type that is the signed or unsigned type corresponding to a qualified version of the\n  effective type of the object,<br/>\n  \u2014 an aggregate or union type that includes one of the aforementioned types among its\n  members (including, recursively, a member of a subaggregate or contained union), or<br/>\n  \u2014 a character type.</p>\n</blockquote>\n\n<p>Between the <code>*i = 2;</code> and the <code>printf(\" *i = %d\\n\",  *i);</code> only a short object is modified. With the help of the strict aliasing rule, the compiler is free to assume that the int object pointed by <code>i</code> has not been changed, and it can directly use a cached value without reloading it from main memory.</p>\n\n<p>It is blatantly not what a normal human being would expect, but the strict aliasing rule was precisely written to allow optimizing compilers to use cached values.</p>\n\n<p>For the second print, unions are referenced in same standard in 6.2.6.1 Representations of types / General \u00a77:</p>\n\n<blockquote>\n  <p>When a value is stored in a member of an object of union type, the bytes of the object\n  representation that do not correspond to that member but do correspond to other members\n  take unspecified values.</p>\n</blockquote>\n\n<p>So as <code>u.s</code> has been stored, <code>u.i</code> have taken a value <em>unspecified by standard</em></p>\n\n<p>But we can read later in 6.5.2.3 Structure and union members \u00a73 note 82:</p>\n\n<blockquote>\n  <p>If the member used to access the contents of a union object is not the same as the member last used to\n  store a value in the object, the appropriate part of the object representation of the value is reinterpreted\n  as an object representation in the new type as described in 6.2.6 (a process sometimes called \"type\n  punning\"). This might be a trap representation.</p>\n</blockquote>\n\n<p>Although notes are not normative, they do allow better understanding of the standard. When <code>u.s</code> have been stored through the <code>*s</code> pointer, the bytes corresponding to a short have been changed to the 2 value. Assuming a little endian system, as 100 is smaller that the value of a short, the representation as an int should now be 2 as high order bytes were 0.</p>\n\n<p>TL/DR: even if not normative, the note 82 should require that on a little endian system of the x86 or x64 families, <code>printf(\"u.i = %d\\n\", u.i);</code> prints 2. But per the strict aliasing rule, the compiler is still allowed to assumed that the value pointed by <code>i</code> has not changed and may print <code>100</code></p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530725258, "post_id": 39763310, "comment_id": 89339717, "body": "The strict aliasing rule also doesn&#39;t differentiate based upon whether the lvalues used for access are of the form <code>someAggregate.member</code>.  What is <i>should</i> recognize as a distinction is whether an lvalue used to access an object has an active association.  If code takes the address of one union member and passes it to a function, <i>and the function accesses the union exclusively via that pointer</i>, the pointer should be associated with the union.  If it then takes the address of a different member, that should break the association of the first pointer with anything that will be accessed..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530725401, "post_id": 39763310, "comment_id": 89339769, "body": "...in conflicting fashion via the second.  In the DR#028 example, it would be impossible for a function to receive pointers of distinct types that could both be actively associated with the same storage for purposes of conflicting accesses, so a compiler would be entitled to assume that wouldn&#39;t happen.  It may be reasonable for the Standard to process a dialect where the addresses of union members are essentially useless, but quality implementations of such a dialect should treat the address-of operator as yielding a pointer type that is not compatible with a pointer-to-member type."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 12, "last_activity_date": 1475131794, "creation_date": 1475131794, "answer_id": 39763310, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting/39763310#39763310", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p>Strict aliasing is underspecified in the C Standard, but the usual interpretation is that union aliasing (which supersedes strict aliasing) is only permitted when the union members are directly accessed by name.</p>\n\n<p>For rationale behind this consider:</p>\n\n<pre><code>void f(int *a, short *b) { \n</code></pre>\n\n<p>The intent of the rule is that the compiler can assume <code>a</code> and <code>b</code> don't alias, and generate efficient code in <code>f</code>.  But if the compiler had to allow for the fact that <code>a</code> and <code>b</code> might be overlapping union members, it actually couldn't make those assumptions.</p>\n\n<p>Whether or not the two pointers are function parameters or not is immaterial, the strict aliasing rule doesn't differentiate based on that.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1475514369, "creation_date": 1475514369, "answer_id": 39836802, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting/39836802#39836802", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p>Whether by accident or by design, C89 includes language which has been interpreted in two different ways (along with various interpretations in-between).  At issue is the question of when a compiler should be required to recognize that storage used for one type might be accessed via pointers of another.  In the example given in the C89 rationale, aliasing is considered between a global variable <em>which is clearly not part of any union</em> and a pointer to a different type, and nothing in the code would suggest that aliasing could occur.</p>\n\n<p>One interpretation horribly cripples the language, while the other would restrict the use of certain optimizations to \"non-conforming\" modes.  If those who didn't to have their preferred optimizations given second-class status had written C89 to unambiguously match their interpretation, those parts of the Standard would have been widely denounced and there would have been some sort of clear recognition of a non-broken dialect of C which would honor the non-crippling interpretation of the given rules.</p>\n\n<p>Unfortunately, what has happened instead is since the rules clearly don't require compiler writers apply a crippling interpretation, most compiler writers have for years simply interpreted the rules in a fashion which retains the semantics that made C useful for systems programming; programmers didn't have any reason to complain that the Standard didn't mandate that compilers behave sensibly because from their perspective it seemed obvious to everyone that they should do so despite the sloppiness of the Standard.  Meanwhile, however, some people insist that since the Standard has always allowed compilers to process a semantically-weakened subset of Ritchie's systems-programming language, there's no reason why a standard-conforming compiler should be expected to process anything else.</p>\n\n<p>The sensible resolution for this issue would be to recognize that C is used for sufficiently varied purposes that there should be multiple compilation modes--one required mode would treat all accesses of everything whose address was taken as though they read and write the underlying storage directly, and would be compatible with code which expects <em>any</em> level of pointer-based type punning support.  Another mode could be more restrictive than C11 except when code explicitly uses directives to indicate when and where storage that has been used as one type would need to be reinterpreted or recycled for use as another.  Other modes would allow some optimizations but support some code that would break under stricter dialects; compilers without specific support for a particular dialect could substitute one with more defined aliasing behaviors.</p>\n"}], "owner": {"reputation": 24394, "user_id": 146041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tFOb6.jpg?s=128&g=1", "display_name": "Aaron McDaid", "link": "https://stackoverflow.com/users/146041/aaron-mcdaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3193, "favorite_count": 11, "accepted_answer_id": 39757909, "answer_count": 7, "score": 58, "last_activity_date": 1505362295, "creation_date": 1475096763, "last_edit_date": 1475099038, "question_id": 39757658, "link": "https://stackoverflow.com/questions/39757658/violating-of-strict-aliasing-in-c-even-without-any-casting", "title": "Violating of strict-aliasing in C, even without any casting?", "body": "<p>How can <code>*i</code> and <code>u.i</code> print different numbers in this code, even though <code>i</code> is defined as <code>int *i = &amp;u.i;</code>? I can only assuming that I'm triggering UB here, but I can't see how exactly.</p>\n\n<p>(<a href=\"http://ideone.com/Gcv5Xm\">ideone demo</a> replicates if I select 'C' as the language. But as @2501 pointed out, not if 'C99 strict' is the language. But then again, I get the problem with <code>gcc-5.3.0 -std=c99</code>!)</p>\n\n<pre><code>// gcc       -fstrict-aliasing -std=c99   -O2\nunion\n{   \n    int i;\n    short s;\n} u;\n\nint     * i = &amp;u.i;\nshort   * s = &amp;u.s;\n\nint main()\n{   \n    *i  = 2;\n    *s  = 100;\n\n    printf(\" *i = %d\\n\",  *i); // prints 2\n    printf(\"u.i = %d\\n\", u.i); // prints 100\n\n    return 0;\n}\n</code></pre>\n\n<p>(gcc 5.3.0, with <code>-fstrict-aliasing -std=c99   -O2</code>, also with <code>-std=c11</code>)</p>\n\n<p>My theory is that <code>100</code> is the 'correct' answer, because the write to the union member through the <code>short</code>-lvalue <code>*s</code> is defined as such (for this platform/endianness/whatever). But I think that the optimizer doesn't realize that the write to <code>*s</code> can alias <code>u.i</code>, and therefore it thinks that <code>*i=2;</code> is the only line that can affect <code>*i</code>. Is this a reasonable theory?</p>\n\n<p>If <code>*s</code> can alias <code>u.i</code>, and <code>u.i</code> can alias <code>*i</code>, then surely the compiler should think that <code>*s</code> can alias <code>*i</code>? Shouldn't aliasing be 'transitive'?</p>\n\n<p>Finally, I always had this assumption that strict-aliasing problems were caused by bad casting. But there is no casting in this!</p>\n\n<p>(My background is C++, I'm hoping I'm asking a reasonable question about C here. My (limited) understanding is that, in C99, it is acceptable to write through one union member and then reading through another member of a different type.)</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "edited": false, "score": 1, "creation_date": 1475095536, "post_id": 39757211, "comment_id": 66810642, "body": "Depending on how you have your code structured you could do something like this: <code>#define printf printf(&quot;prepend &quot;);printf</code>"}], "answers": [{"comments": [{"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1475095734, "post_id": 39757363, "comment_id": 66810761, "body": "Possibly.  It&#39;s technically a mix of C &amp; Lua so output comes from several places.  #define won&#39;t work in the lua but I could replace every call to print with another routine I suppose.  It&#39;s still tedious."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475096015, "post_id": 39757363, "comment_id": 66810906, "body": "Tedious? Why? The only alternative would be to hook the <code>write</code> syscall, check the pid and handle it differently for different processes. <i>This</i> is tedious."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475096159, "post_id": 39757363, "comment_id": 66810969, "body": "How do you see <code>dup()</code>ing the file descriptor being useful?"}, {"owner": {"reputation": 2861, "user_id": 1008115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Nmtel.jpg?s=128&g=1", "display_name": "PnotNP", "link": "https://stackoverflow.com/users/1008115/pnotnp"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475096161, "post_id": 39757363, "comment_id": 66810971, "body": "@EugeneSh. It should work with multiple parameters as well."}, {"owner": {"reputation": 2861, "user_id": 1008115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Nmtel.jpg?s=128&g=1", "display_name": "PnotNP", "link": "https://stackoverflow.com/users/1008115/pnotnp"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475096232, "post_id": 39757363, "comment_id": 66811011, "body": "@JohnBollinger everything your write to <code>stdout</code> should go the log file isn&#39;t it?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475096564, "post_id": 39757363, "comment_id": 66811176, "body": "@NulledPointer, whether the output even goes to a file at all is entirely beside the point.  The problem is not for parent and child to send data to the same file -- that&#39;s easy, and in fact already works for the OP.  The problem is for the outputs coming from the child to have text prepended, without extensive modifications to the child for that purpose.  I don&#39;t see how <code>dup()</code>ing file descriptors (by itself) serves that purpose."}], "tags": [], "owner": {"reputation": 2861, "user_id": 1008115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Nmtel.jpg?s=128&g=1", "display_name": "PnotNP", "link": "https://stackoverflow.com/users/1008115/pnotnp"}, "is_accepted": false, "score": 0, "last_activity_date": 1475096101, "last_edit_date": 1475096101, "creation_date": 1475095648, "answer_id": 39757363, "question_id": 39757211, "link": "https://stackoverflow.com/questions/39757211/prepend-child-process-console-output/39757363#39757363", "title": "Prepend child process console output", "body": "<p>Couldn't you define <code>#define printf(a) printf(\"your text:\" a).</code></p>\n\n<p>Other alternative I can think of is using <a href=\"https://linux.die.net/man/2/dup\" rel=\"nofollow\">dup</a></p>\n\n<p>You open the same log file in your child process and <code>dup</code> your <code>stdout</code> to new file descriptor.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1475096670, "last_edit_date": 1475096670, "creation_date": 1475095984, "answer_id": 39757456, "question_id": 39757211, "link": "https://stackoverflow.com/questions/39757211/prepend-child-process-console-output/39757456#39757456", "title": "Prepend child process console output", "body": "<blockquote>\n  <p>I thought it might be smarter to have the parent process prepend output from the child process.</p>\n</blockquote>\n\n<p>I guess it depends on how you judge \"smart\".  It might be <em>simpler</em> to just make the child prepend the desired text to its outputs.  </p>\n\n<blockquote>\n  <p>I don't want to redirect the output because seeing the output inline with the parent process is beneficial. What's the best way to do this?</p>\n</blockquote>\n\n<p>When two processes share an open file, both access it independently, regardless of the nature of the relationship between those processes.  Thus, if your child inherits the parent's <code>stdout</code>, the parent has no mechanism even to notice that the child is sending output, much less to modify that output.</p>\n\n<p>If you want the parent to handle this, you would need to pass the child's output through the parent.  You could do that by creating a pipe, and associating the child's <code>stdout</code> with the write end of that pipe.  The parent would then need to monitor the read end, and forward suitably-modified outputs to its own <code>stdout</code>.  The parent would probably want to create a separate thread for that purpose.</p>\n\n<p>Additionally, if the child sometimes produces multi-line outputs that you want prefixed as a group, rather than per-line, then you'd probably need to build and use some kind of protocol for demarcating message boundaries, which would make the whole parent-moderation idea pretty pointless.</p>\n"}, {"comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1475097868, "post_id": 39757738, "comment_id": 66811837, "body": "nit: <code>&quot;s&#47;^&#47;PREFIX: &#47;&quot;</code> else expect <code>unterminated &#39;s&#39; command</code>"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1475098143, "last_edit_date": 1475098143, "creation_date": 1475097124, "answer_id": 39757738, "question_id": 39757211, "link": "https://stackoverflow.com/questions/39757211/prepend-child-process-console-output/39757738#39757738", "title": "Prepend child process console output", "body": "<p>You could create a second child process that performs</p>\n\n<pre><code>execlp(\"sed\", \"sed\", \"s/^/PREFIX: /\", (char *)NULL);\n</code></pre>\n\n<p>Connect the first child's stdout to this process's stdin with a pipe.</p>\n"}], "owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 39757738, "answer_count": 3, "score": 0, "last_activity_date": 1475206099, "creation_date": 1475095052, "last_edit_date": 1475206099, "question_id": 39757211, "link": "https://stackoverflow.com/questions/39757211/prepend-child-process-console-output", "title": "Prepend child process console output", "body": "<p>I have an app that spawns a child process.  That child process outputs information about what it's doing by printing to stdout.  The parent process does the same (i.e. prints to stdout).</p>\n\n<p>In the child process I can write to stdout with some text prepended, but I have to add that to every single location I print across many source files.</p>\n\n<p>I thought it might be smarter to have the parent process prepend output from the child process that it forks/exec's.  I don't want to redirect the output because seeing the output inline with the parent process is beneficial.  How do I do this?  I'm using fork/exec in the parent.</p>\n\n<p>Do I have to read the output and prepend each line manually or is there a simpler approach?</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>Thanks to Barmar. Here is how I'm doing it.  I also could read byte by byte in the parent process from the pipe until line end. But I chose not to use that approach for reasons of complexity in my single threaded lua+C app.</p>\n\n<pre><code>// Crude example of output filtering using sed to \n// prepend child process output text\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;libgen.h&gt;\n#include &lt;string.h&gt;\n\n\npid_t spawn(int fd[2], const char* path)\n{\n  printf(\"Create child\\n\");\n  pid_t pid = fork();\n  switch(pid){\n    case -1:\n      printf(\"Create process failed\");\n      return -1;\n    case 0:\n      dup2(fd[1], STDOUT_FILENO);\n      close(fd[0]);\n      close(fd[1]);\n      execl(path, path, NULL);\n      return 0;\n    default:\n      return pid;\n  }\n}\n\npid_t spawnOutputFilter(int fd[2])\n{\n  printf(\"Create sed\\n\");\n  pid_t pid = fork();\n  switch(pid){\n    case -1:\n      printf(\"Create sed failed\");\n      return -1;\n    case 0:\n      dup2(fd[0], STDIN_FILENO);\n      close(fd[0]);\n      close(fd[1]);\n      execlp(\"sed\", \"sed\", \"s/^/Engine: /\", (char *)NULL);\n      return -1;\n    default:\n      return pid;\n  }\n}\n\n\nint main(int argc, char* argv[])\n{\n  if (argc &gt; 1){\n    int options;\n    int fd[2];\n    pipe(fd);\n    pid_t pid = spawn(fd, argv[1]);\n    pid_t sed_pid = spawnOutputFilter(fd);\n\n    close(fd[0]);\n    close(fd[1]);\n    waitpid(pid, NULL, 0);\n    waitpid(sed_pid, NULL, 0);\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "printf", "output"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 12, "creation_date": 1475092663, "post_id": 39756569, "comment_id": 66808999, "body": "Why not simply <code>printf(&quot;The value of %f is greater than zero.\\n&quot;, value)</code>?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1475092721, "post_id": 39756569, "comment_id": 66809027, "body": "Please note that <code>&#39;\\n&#39;</code> is the end of line character, putting it at the start is kind of wierd."}, {"owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "edited": false, "score": 1, "creation_date": 1475092728, "post_id": 39756569, "comment_id": 66809033, "body": "Please refer the syntax of printf()"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1475092793, "post_id": 39756569, "comment_id": 66809069, "body": "By the way, note that in my previous comment i put the newline at the <i>end</i> of the string to be printed. That&#39;s because <code>stdout</code> (which <code>printf</code> writes to) is by default <i>line buffered</i>, which means that the text will be written to the output device on newline. Therefore will printing the newline first print the <i>previous</i> line but not the current (until next newline which may take a while and lead to &quot;missing&quot; output)."}, {"owner": {"reputation": 7, "user_id": 2884536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3601452f632811fa9b00225a676ab91d?s=128&d=identicon&r=PG&f=1", "display_name": "user2884536", "link": "https://stackoverflow.com/users/2884536/user2884536"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475093040, "post_id": 39756569, "comment_id": 66809211, "body": "@JoachimPileborg Thanks for the help!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475093220, "post_id": 39756569, "comment_id": 66809317, "body": "@JoachimPileborg Concerning buffering, suggest that &quot;by default line buffered which means that the text will be written to the output device on newline&quot;, although common,  is not specified by C.  See <a href=\"http://stackoverflow.com/q/39536212/2410359\">What are the rules of automatic flushing stdout buffer in C?</a>"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1477777935, "post_id": 39756569, "comment_id": 67903593, "body": "Hey @user2884536 if my answer (or anyone&#39;s) has solved your problem, please consider <a href=\"http://meta.stackexchange.com/q/5234/179419\">accepting it</a> by clicking the check-mark. This indicates to the wider community that you&#39;ve found a solution and gives some reputation to both the answerer and yourself. There is no obligation to do this. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "is_accepted": false, "score": 9, "last_activity_date": 1475093717, "last_edit_date": 1475093717, "creation_date": 1475093090, "answer_id": 39756705, "question_id": 39756569, "link": "https://stackoverflow.com/questions/39756569/can-a-string-be-outputted-after-a-variable-one-line-with-printf/39756705#39756705", "title": "Can a string be outputted after a variable? (One line with printf)", "body": "<p>You're thinking of something like Java. In C you can do this:</p>\n\n<pre><code>printf(\"The value of %f is greater than zero.\\n\", value);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1475095230, "last_edit_date": 1475095230, "creation_date": 1475094738, "answer_id": 39757128, "question_id": 39756569, "link": "https://stackoverflow.com/questions/39756569/can-a-string-be-outputted-after-a-variable-one-line-with-printf/39757128#39757128", "title": "Can a string be outputted after a variable? (One line with printf)", "body": "<p>The <code>printf()</code> function takes <em>one</em> format string and zero or more additional arguments to plug into that format.  @MDXF presented the most obvious approach to producing the output you want with a single <code>printf()</code>, but an important alternative is</p>\n\n<pre><code>printf(\"\\nThe value of %f%s\", value, \" is greater than zero.\");\n</code></pre>\n\n<p>Note there the second field descriptor in the format string (<code>%s</code>) that specifies where and how to format the second argument following the format.  It's kinda silly to do it that way when the string is given as a literal, but that would be the natural way to do it if you instead had a <code>char *</code> pointing to the string to print, which is a common case:</p>\n\n<pre><code>void printit(double value, const char *string) {\n    printf(\"\\nThe value of %f%s\", value, string);\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 2884536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3601452f632811fa9b00225a676ab91d?s=128&d=identicon&r=PG&f=1", "display_name": "user2884536", "link": "https://stackoverflow.com/users/2884536/user2884536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1495737346, "creation_date": 1475092585, "last_edit_date": 1495737346, "question_id": 39756569, "link": "https://stackoverflow.com/questions/39756569/can-a-string-be-outputted-after-a-variable-one-line-with-printf", "title": "Can a string be outputted after a variable? (One line with printf)", "body": "<p>Trying to print a string before and after a variable.\nDoes C have the capability to use one statement to display this output?</p>\n\n<p>This works:</p>\n\n<pre><code>float value = 5;\nprintf(\"\\nThe value of %f\", value);\nprintf(\" is greater than zero.\");\n</code></pre>\n\n<p>This is the desire (one statement):</p>\n\n<pre><code>float value = 5;\nprintf(\"\\nThe value of %f\", value, \" is greater than zero.\");\n</code></pre>\n\n<p>(Second string does not display)</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "edited": false, "score": 1, "creation_date": 1475092477, "post_id": 39756509, "comment_id": 66808885, "body": "When a process forks multiple times, does the parent finish executing before the children? Vice versa? Concurrently? - Concurrently and depends on the scheduler and its unpredictable."}, {"owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "edited": false, "score": 0, "creation_date": 1475092634, "post_id": 39756509, "comment_id": 66808983, "body": "you can use wait function call to wait until child process is finished and then the parent process will execute"}, {"owner": {"reputation": 627, "user_id": 5438128, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d0e061b267311381d8226c3bb60a20c?s=128&d=identicon&r=PG", "display_name": "ebyrob", "link": "https://stackoverflow.com/users/5438128/ebyrob"}, "edited": false, "score": 0, "creation_date": 1475093057, "post_id": 39756509, "comment_id": 66809221, "body": "How are you getting the pipes of the child processes?  Isn&#39;t this what <code>popen()</code> was designed for?  (Also, after <code>fork()</code> returns, two processes should exist, so at that point, whichever process you&#39;re in, a fully formed child process should exist with valid stdin and stdout)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475095898, "post_id": 39756509, "comment_id": 66810857, "body": "Why do you think the child will work from invalid stdin? If it tries to read the pipe before the parent has written anything, it will just wait, it won&#39;t return invalid data."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475131381, "post_id": 39756509, "comment_id": 66821355, "body": "It depends on how the forked processes are written.  Beginner shells (often seen on SO \u2014 starting in October, usually) often make the mistake of trying to run a pipeline so that the shell waits for the first child to finish before launching the second.  This is bad in general, though they often get away with because the child doesn&#39;t write more data than fits in a pipe buffer. You can arrange for the children not to do anything until the parent finishes; you can arrange for the parent not to do anything until the children finish; you can arrange for fully concurrent execution of them all, etc."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1572298951, "post_id": 39756509, "comment_id": 103510090, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/6696959/608639\">Can the order of execution of fork() be determined?</a>, <a href=\"https://stackoverflow.com/q/21586292/608639\">In fork() which will run first, parent or child?</a>, <a href=\"https://stackoverflow.com/q/46523164/608639\">Is there a good way to alter execution order of child processes created with fork()?</a>, <a href=\"https://stackoverflow.com/q/30276244/608639\">Using fork(), how can I make child process run always first?</a>, etc."}], "answers": [{"tags": [], "owner": {"reputation": 2724, "user_id": 4268602, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/730410991/picture?type=large", "display_name": "Daniel Paczuski Bak", "link": "https://stackoverflow.com/users/4268602/daniel-paczuski-bak"}, "is_accepted": false, "score": 0, "last_activity_date": 1475092483, "creation_date": 1475092483, "answer_id": 39756539, "question_id": 39756509, "link": "https://stackoverflow.com/questions/39756509/forked-processes-order-of-execution/39756539#39756539", "title": "Forked processes order of execution", "body": "<p>They will execute concurrently. This is basically the point of processes.</p>\n\n<p>Look into mutexes or other ways to deal with concurrency.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475095088, "post_id": 39756710, "comment_id": 66810390, "body": "One should not neglect to mention the <code>wait()</code> family of functions in this context."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475095294, "post_id": 39756710, "comment_id": 66810509, "body": "Right. I&#39;ll add some more."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 7, "last_activity_date": 1475095466, "last_edit_date": 1475095466, "creation_date": 1475093116, "answer_id": 39756710, "question_id": 39756509, "link": "https://stackoverflow.com/questions/39756509/forked-processes-order-of-execution/39756710#39756710", "title": "Forked processes order of execution", "body": "<p>The order of the execution is determined by the specific OS scheduling policy and not guaranteed by anything. In order to synchronize the processes there are special facilities for the inter-process communication (IPC) which are designed for this purpose. The mentioned pipes are one example. They make the reading process to actually <em>wait</em> for the other process to write it, creating a (one-way) synchronization point. The other examples would be FIFOs and sockets. For simpler tasks the <a href=\"https://linux.die.net/man/2/wait\" rel=\"nofollow\">wait()</a> family of functions or <a href=\"http://man7.org/linux/man-pages/man2/kill.2.html\" rel=\"nofollow\">signals</a> can be used.</p>\n"}, {"tags": [], "owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1475131136, "last_edit_date": 1495541354, "creation_date": 1475093864, "answer_id": 39756900, "question_id": 39756509, "link": "https://stackoverflow.com/questions/39756509/forked-processes-order-of-execution/39756900#39756900", "title": "Forked processes order of execution", "body": "<blockquote>\n  <p>When a process forks multiple times, does the parent finish executing before the children? Vice versa? Concurrently? - </p>\n</blockquote>\n\n<p>Concurrently and depends on the scheduler and its unpredictable.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12864265/using-pipe-to-pass-integer-values-between-parent-and-child\">Using pipe to pass integer values between parent and child</a></p>\n\n<p>This link explains in detail about sharing data between parent process and child.\nSince you have four child process you may need to create different individual pipes between each child process. </p>\n\n<p>Each byte of data written to a pipe will be read exactly once. It isn't duplicated to every process with the read end of the pipe open.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7152654/multiple-child-processes-reading-writing-on-the-same-pipe\">Multiple child processes reading/writing on the same pipe</a></p>\n\n<p>Alternatively you can try shared memory for the data transfer.  </p>\n"}], "owner": {"reputation": 625, "user_id": 6115394, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/25085ab420b50146c89a30ae543cde32?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6115394/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1475131136, "creation_date": 1475092399, "question_id": 39756509, "link": "https://stackoverflow.com/questions/39756509/forked-processes-order-of-execution", "title": "Forked processes order of execution", "body": "<p>I know there's another thread with the same name, but this is actually a different question.</p>\n\n<p>When a process forks multiple times, does the parent finish executing before the children? Vice versa? Concurrently?</p>\n\n<p>Here's an example. Lets say I have a for loop that forks 1 parent process into 4 children. At the end of that for loop, I want the parent process to feed some data to the children via pipes. The data is written to each child process' respective stdin.</p>\n\n<p>Will the parent send the data first, before any of the children execute their code? This is important, because we don't want it to start working from an invalid stdin.</p>\n"}, {"tags": ["c", "pointers", "structure", "unions"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1475091436, "post_id": 39756144, "comment_id": 66808298, "body": "what is <code>mpls_vpws_t</code>? If that&#39;s not an array typedef, you obviously can&#39;t use <code>Vpws_dat[lab]</code>. Maybe you meant <code>&amp;ser_dat_ch[lab].Vpws_dat</code>"}, {"owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1475091574, "post_id": 39756144, "comment_id": 66808377, "body": "@M.M Both structures are <code>typedef struct</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475091994, "post_id": 39756144, "comment_id": 66808605, "body": "You can&#39;t. C does not support pass by reference. But you can pass a pointer to the union (aka its address). See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You also want to read about operator preceedence."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1475092765, "post_id": 39756144, "comment_id": 66809058, "body": "saying &quot;C does not support pass by reference&quot; is like saying &quot;C does not support linked lists&quot;"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1475092933, "post_id": 39756144, "comment_id": 66809151, "body": "@M.M Olaf is actually right - You may say, C <i>simulates</i> PBR by passing around pointers. Effectively, it&#39;s the same thing, except when it isn&#39;t (you can&#39;t pass an <b>array</b> by reference, because it loses its array traits)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475093038, "post_id": 39756144, "comment_id": 66809209, "body": "@tofro You can pass a pointer to an array, just the same as a pointer to any other type.  The array doesn&#39;t lose its array traits. You don&#39;t see it very often because passing a pointer to the array&#39;s first element suffices for most purposes and has simpler syntax"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1475093337, "post_id": 39756144, "comment_id": 66809374, "body": "@M.M If it were a <i>true reference</i>, you could treat it with <code>sizeof</code> and you&#39;d get the size of the array. But you cannot. And exactly that array trait is lost. I hope you don&#39;t mix up C and C++ here. We&#39;re talking C"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475093820, "post_id": 39756144, "comment_id": 66809616, "body": "@tofro yes, you can use <code>sizeof</code> and get the size of the array. Yes this is a C question."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1475093902, "post_id": 39756144, "comment_id": 66809652, "body": "@M.M Now you&#39;ve made me interested. Can you give an example? My compilers can&#39;t do that."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475094221, "post_id": 39756144, "comment_id": 66809847, "body": "@tofro <a href=\"http://stackoverflow.com/questions/1810083/\">see here</a>. I suspect you are mixing up &quot;pointer to array&quot; with &quot;pointer to first element of array&quot;. The latter loses type information (i.e. length) about the array but the former doesn&#39;t"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1475094432, "post_id": 39756144, "comment_id": 66809995, "body": "Nice, thanks. I even used to know that long ago but apparently decided to forget because you don&#39;t use it much, normally."}], "answers": [{"comments": [{"owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "edited": false, "score": 0, "creation_date": 1475092534, "post_id": 39756461, "comment_id": 66808916, "body": "Thanks for the eye opener!"}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": true, "score": 2, "last_activity_date": 1475092180, "creation_date": 1475092180, "answer_id": 39756461, "question_id": 39756144, "link": "https://stackoverflow.com/questions/39756144/how-do-i-pass-a-member-of-a-union-by-reference/39756461#39756461", "title": "How do I pass a member of a union by reference", "body": "<p>I assume you have an array of such unions and one pointer to the start of that memory. Then, accessing one of the ith element's structure member would look like</p>\n\n<pre><code>ser_dat_ch[i].Vpws_dat\n</code></pre>\n\n<p>and a pointer to that union is</p>\n\n<pre><code>&amp;(ser_dat_ch[i])\n</code></pre>\n\n<p>and a pointer to one of the structs in the union (that is apparently what you're looking for) is</p>\n\n<pre><code>&amp;(ser_dat_ch[i].Vpws_dat)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 6849062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1faf59301153b877268600f86c070ebe?s=128&d=identicon&r=PG&f=1", "display_name": "nullverb", "link": "https://stackoverflow.com/users/6849062/nullverb"}, "is_accepted": false, "score": 0, "last_activity_date": 1475092933, "creation_date": 1475092933, "answer_id": 39756667, "question_id": 39756144, "link": "https://stackoverflow.com/questions/39756144/how-do-i-pass-a-member-of-a-union-by-reference/39756667#39756667", "title": "How do I pass a member of a union by reference", "body": "<p>I can't comment to your post (not enough reputation).  The error you're getting usually hints that the function parameter is not the correct type for the pointer.  I.e. passing a single dimension pointer to a multi dimension pointer.</p>\n\n<p>Additionally, your syntax is problematic:</p>\n\n<pre><code>rv = switch_mpls_vpws_data_get(lab, &amp;ser_dat_ch-&gt;Vpws_dat[lab]);\n</code></pre>\n\n<p><code>&amp;set_dat_ch-&gt;Vpws_dat[lab]</code> is messy syntax.  To be honest, I'm not even sure what would evaluate first <code>Vpws_dat[lab]</code> then <code>ser_dat_ch-&gt;</code> then finally <code>&amp;</code>.  You should just simplify this (although through parenthesis you could get the desired effect).  Either pass the internal struct <code>ser_dat_ch-&gt;Vpws_dat</code> and retrieve the variable inside the function, or prior to the function do something like:</p>\n\n<pre><code>int *var = ser_dat_ch-&gt;Vpws_dat\n</code></pre>\n\n<p>And then just pass var to the function.  Note: I just used an <code>int*</code> because I'm unsure what the internal implementation is.</p>\n"}], "owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 39756461, "answer_count": 2, "score": 0, "last_activity_date": 1475092933, "creation_date": 1475091133, "last_edit_date": 1475091535, "question_id": 39756144, "link": "https://stackoverflow.com/questions/39756144/how-do-i-pass-a-member-of-a-union-by-reference", "title": "How do I pass a member of a union by reference", "body": "<p>I have a union declared like:</p>\n\n<pre><code>typedef union {\n    mpls_vpls_t Vpls_dat; //typedef struct\n    mpls_vpws_t Vpws_dat; //typedef struct\n}ser_cache_t;\n</code></pre>\n\n<p>and I allocate memory for it:</p>\n\n<pre><code>ser_dat_ch = calloc(LABEL_T_CNT,sizeof(ser_cache_t));\nif (ser_dat_ch == NULL)\n    return ERROR;\n</code></pre>\n\n<p>while <code>static ser_cache_t *ser_dat_ch = NULL;</code> is global.</p>\n\n<p>Now I want to populate my union with data and hence I wantto pass a pointer to it to a function like:<br>\n<code>rv = switch_mpls_vpws_data_get(lab, &amp;ser_dat_ch-&gt;Vpws_dat[lab]);</code><br>\nBut here the compiler screams: <strong>expression must have pointer-to-object type</strong>\nwhy so, won't <code>&amp;ser_dat_ch-&gt;Vpws_dat[lab]</code> resolve to the address I'm looking for?</p>\n"}, {"tags": ["c", "opencv"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 2, "creation_date": 1475091889, "post_id": 39756116, "comment_id": 66808552, "body": "Don&#39;t use <b>obsolete</b> C api!"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 1, "creation_date": 1479849987, "post_id": 39756116, "comment_id": 68729985, "body": "Yeah don&#39;t use C api, as I am writing C program not C++ so I should write in C++ and then make externs? what a stupid approach"}], "owner": {"reputation": 162, "user_id": 4746861, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b02d093c0e7e10074b7d572396022657?s=128&d=identicon&r=PG&f=1", "display_name": "mmichal10", "link": "https://stackoverflow.com/users/4746861/mmichal10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475091177, "creation_date": 1475091010, "last_edit_date": 1475091177, "question_id": 39756116, "link": "https://stackoverflow.com/questions/39756116/c-and-opencv-compilation-error", "title": "C and OpenCV compilation error", "body": "<p>I am trying to compile my first program with using <em>OpenCV</em> library. My code (file is named '1.c'):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"opencv/highgui.h\"\n#include \"opencv/cv.h\"\n//#include &lt;opencv/cv.h\"\nint main(int argc, char** argv)\n{\n    IplImage* img = cvLoadImage (argv[1], 1);\n    cvNamedWindow(\"Example1\", CV_WINDOW_AUTOSIZE);\n    cvShowImage(\"Example1\",img);\n    cvWaitKey(0);\n    cvReleaseImage(&amp;img);\n    cvDestroyWindow(\"Example1\");\n}  \n</code></pre>\n\n<p>and CMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8)\nproject( 1 )\nfind_package( OpenCV REQUIRED )\nadd_executable( 1 1 )\ntarget_link_libraries( 1 ${OpenCV_LIBS} )\n</code></pre>\n\n<p>When I am running <em>CMake</em> it works correctly, but running <em>Make</em> gives me output like this:</p>\n\n<pre><code>CMakeFiles/1.dir/1.c.o: In function `cvPointFrom32f':\n1.c:(.text+0x559): undefined reference to `cvRound'\n1.c:(.text+0x56f): undefined reference to `cvRound'\nCMakeFiles/1.dir/1.c.o: In function `cvReadInt':\n1.c:(.text+0xda0): undefined reference to `cvRound'\nCMakeFiles/1.dir/1.c.o: In function `cvEllipseBox':\n1.c:(.text+0x101d): undefined reference to `cvRound'\n1.c:(.text+0x103f): undefined reference to `cvRound'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I saw other people having the same problem, but I couldn't solve my case even applying their solutions. I'm using <em>OpenCV 3.1.0</em>.</p>\n"}, {"tags": ["c", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475089899, "post_id": 39755732, "comment_id": 66807606, "body": "&quot;Not familiar with the rules/policy of stackoverflow if there is any.&quot; - After 11 months you should have taken the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 77, "user_id": 5425163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-jaK7JM73VTw/AAAAAAAAAAI/AAAAAAAAD1Y/0aPfOWrfhtg/photo.jpg?sz=128", "display_name": "mirza nehal Baig", "link": "https://stackoverflow.com/users/5425163/mirza-nehal-baig"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475090031, "post_id": 39755732, "comment_id": 66807660, "body": "this is my second or third time posting question and i don&#39;t visit stack overflow often"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475090069, "post_id": 39755732, "comment_id": 66807669, "body": "Ignorantia legis non excusat"}, {"owner": {"reputation": 77, "user_id": 5425163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-jaK7JM73VTw/AAAAAAAAAAI/AAAAAAAAD1Y/0aPfOWrfhtg/photo.jpg?sz=128", "display_name": "mirza nehal Baig", "link": "https://stackoverflow.com/users/5425163/mirza-nehal-baig"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475090267, "post_id": 39755732, "comment_id": 66807734, "body": "okay so what&#39;s my punishment for violating a rule even i was unaware of?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1475090482, "post_id": 39755732, "comment_id": 66807832, "body": "<code>newnode=(node*)malloc(sizeof(node*));</code> --&gt; <code>newnode = malloc(sizeof *newnode);</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1475091228, "post_id": 39755732, "comment_id": 66808193, "body": "<code>if(list==NULL){ list-&gt;head=newnode;</code> That should crash the program with a segfault."}], "answers": [{"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": true, "score": 2, "last_activity_date": 1475096597, "last_edit_date": 1475096597, "creation_date": 1475092415, "answer_id": 39756517, "question_id": 39755732, "link": "https://stackoverflow.com/questions/39755732/program-doesnt-display-linked-list-but-creates-a-linked-list-in-c/39756517#39756517", "title": "Program doesn&#39;t display Linked list but creates a linked list in c", "body": "<p>fix like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n\ntypedef struct node{\n    int data;\n    struct node *next;\n}node;\n\ntypedef struct LinkedList_ {\n    node *head;\n} LinkedList;\n\n void create( LinkedList *list ){\n    char choice='y';\n    if(!list || list-&gt;head){//guard\n        fprintf(stderr, \"Invalid call %s.\\n\", __func__);\n        return;\n    }\n\n    node *temp;\n    do{\n        node *newnode;\n        newnode = malloc(sizeof(*newnode));//or malloc(sizeof(node));\n        printf(\"\\nenter the data: \");\n        scanf(\"%d\", &amp;newnode-&gt;data);\n        newnode-&gt;next = NULL;\n        if(list-&gt;head == NULL){\n            list-&gt;head = newnode;\n            temp = newnode;\n        } else {\n            temp = temp-&gt;next = newnode;//There is no need to follow the link\n        }\n        printf(\"\\ndo you want to continue(y or no)?  \");\n        choice=getche();\n    }while(choice=='y');\n}\n\n\n void display( LinkedList *list ){\n    node *curr = list-&gt;head;//head should not be changed\n    printf(\"\\n[\");\n    while(curr != NULL){\n          printf(\"%d,\", curr-&gt;data);\n          curr = curr-&gt;next;\n    }\n    printf(\"]\\n\");\n}\n\nint main(void){\n    LinkedList head = { NULL };//requires entity\n    create(&amp;head);\n    display(&amp;head);\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5425163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-jaK7JM73VTw/AAAAAAAAAAI/AAAAAAAAD1Y/0aPfOWrfhtg/photo.jpg?sz=128", "display_name": "mirza nehal Baig", "link": "https://stackoverflow.com/users/5425163/mirza-nehal-baig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 39756517, "answer_count": 1, "score": -3, "last_activity_date": 1475096597, "creation_date": 1475089600, "last_edit_date": 1475091300, "question_id": 39755732, "link": "https://stackoverflow.com/questions/39755732/program-doesnt-display-linked-list-but-creates-a-linked-list-in-c", "title": "Program doesn&#39;t display Linked list but creates a linked list in c", "body": "<p>I am weak in linked list so please help me:</p>\n\n<p>My LinkedList is not displaying on screen(display function isn't working correctly) even the linked list is creating successfully and if i use <code>node *head</code> as a global pointer to structure and if i replaced <code>list-&gt;head</code> with <code>head</code> (which is the address of <code>node *head</code>) and <code>LinkedList *list</code> (in argument of function) with <code>node *head</code>, then it is printing the whole list but if i use <code>list-&gt;head</code> or <code>list</code> in place of <code>head</code> (which is the address of <code>node *head</code>) and declared <code>LinkedList *list</code> in term of <code>node *head</code> then it input the value in linked list but don't display the linked list.</p>\n\n<p>The code which causing problem is following: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;malloc.h&gt;\n\ntypedef struct node{\n    int data;\n    struct node *next;\n}node;\n\ntypedef struct LinkedList_\n {\n   node *head;\n } LinkedList;\n\n\n void create( LinkedList *list ){\n\n     char choice='y';\n     do{\n\n        node *newnode,*temp;\n        newnode=(node*)malloc(sizeof(node*));\n        printf(\"\\nenter the data: \");\n        scanf(\"%d\",&amp;newnode-&gt;data);\n        newnode-&gt;next=NULL;\n        if(list==NULL){\n            list-&gt;head=newnode;\n            temp=newnode;\n        }\n        else{\n            temp=list-&gt;head;\n            while(temp-&gt;next!=NULL){\n                temp=temp-&gt;next;\n            }\n            temp-&gt;next=newnode;\n        }\n        printf(\"\\ndo you want to continue(y or no)?  \");\n        choice=getche();\n\n        }while(choice=='y');\n }\n\n\n void display( LinkedList *list ){\n     printf(\"\\n[\");\n     while(list-&gt;head!=NULL){\n          printf(\"%d,\",list-&gt;head-&gt;data);\n          list-&gt;head=list-&gt;head-&gt;next;\n     }\n     printf(\"]\");\n }\n\n\nvoid main(){\n     LinkedList *head=NULL;\n     create(head);\n     display(head);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 377, "user_id": 4199141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_jGxyF86jpQ/AAAAAAAAAAI/AAAAAAAAAX0/r1vbGgE85DM/photo.jpg?sz=128", "display_name": "John Griffin", "link": "https://stackoverflow.com/users/4199141/john-griffin"}, "edited": false, "score": 4, "creation_date": 1475088272, "post_id": 39755217, "comment_id": 66806768, "body": "First, try a different book because for decades, the standard way to link a math library has been to use -lm instead of a full path to the library.  Second, <a href=\"https://gcc.gnu.org/releases.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/releases.html</a> contains the release changes."}, {"owner": {"reputation": 1368, "user_id": 6491853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EXPj3.jpg?s=128&g=1", "display_name": "J. Allan", "link": "https://stackoverflow.com/users/6491853/j-allan"}, "reply_to_user": {"reputation": 377, "user_id": 4199141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_jGxyF86jpQ/AAAAAAAAAAI/AAAAAAAAAX0/r1vbGgE85DM/photo.jpg?sz=128", "display_name": "John Griffin", "link": "https://stackoverflow.com/users/4199141/john-griffin"}, "edited": false, "score": 1, "creation_date": 1475088547, "post_id": 39755217, "comment_id": 66806934, "body": "@JohnGriffin: From the same book: <i>&quot;To avoid the need to specify long paths on the command line, the compiler provides a short-cut option \u2018-l\u2019 for linking against libraries. For example, the following command, <code>$ gcc -Wall calc.c -lm -o calc</code> is equivalent to the original command...&quot;</i>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475088670, "post_id": 39755217, "comment_id": 66807007, "body": "Note that the default these days is to link with dynamic libraries, not static libraries. Maybe what you meant to ask about was linking with <i>standard</i> libraries?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1475089728, "post_id": 39755217, "comment_id": 66807549, "body": "Recent versions of gcc fix this bug (failing to link libm by default)"}, {"owner": {"reputation": 63, "user_id": 6895430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pnIdIzKhApE/AAAAAAAAAAI/AAAAAAAAACg/DZN7sZasD2Y/photo.jpg?sz=128", "display_name": "Steven A", "link": "https://stackoverflow.com/users/6895430/steven-a"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1475116269, "post_id": 39755217, "comment_id": 66816532, "body": "@M.M, I am using gcc 5.4 (Kubuntu 16.04.1) and I must use the -lm flag.  Which version of gcc are you using?  I am new to Linux and tried installing gcc 6 on Debian 8 Jessie and ended up with a broken GUI desktop.  I formatted and installed Kubuntu because of the newer gcc compiler, although I wish that I was using gcc 6 of course."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1475181819, "post_id": 39755217, "comment_id": 66853545, "body": "the <code>-lm</code>  is part of the options to the compiler.  a <code>-L</code>  (capital &#39;L&#39;) is used to tell the compiler where libraries are located. I.E. /usr/lib.   certain libraries, like <code>libc.so</code> are included automatically; the <code>libm.so</code> is not one of them.  To tell the linker to search that specific library the <code>-lm</code>  (lower case &#39;L&#39;) parameter is used (at the end of the link statement.) How did <code>libm.so</code> become <code>m</code>? because when referencing libraries, the leading <code>lib</code> and trailing <code>.so</code> are dropped.  Similar considerations apply for static libraries like: <code>libm.a</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7107, "user_id": 459780, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55b2cca3b7a11df3a961d57a68705503?s=128&d=identicon&r=PG", "display_name": "Daniel Standage", "link": "https://stackoverflow.com/users/459780/daniel-standage"}, "is_accepted": false, "score": 2, "last_activity_date": 1475088589, "creation_date": 1475088589, "answer_id": 39755462, "question_id": 39755217, "link": "https://stackoverflow.com/questions/39755217/gcc-linking-with-static-libraries/39755462#39755462", "title": "gcc linking with static libraries", "body": "<p>I've noticed that on some operating systems, common libraries are available without explicit linking. In particular, I've often taken a working C project originally developed on my Mac, and the project would not compile on Linux until I explicitly linked against the libraries I used (like libm).</p>\n\n<p>Of course, this is typically for dynamic rather than static linking...</p>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475089198, "post_id": 39755485, "comment_id": 66807303, "body": "I get that error on Linux as well, but no error on OS X."}, {"owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475089404, "post_id": 39755485, "comment_id": 66807391, "body": "@Barmar no linker error on OS X with variables that can&#39;t be resolved at compile time? Sorry, I don&#39;t know about OS X. Probably something else is going on there."}, {"owner": {"reputation": 63, "user_id": 6895430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pnIdIzKhApE/AAAAAAAAAAI/AAAAAAAAACg/DZN7sZasD2Y/photo.jpg?sz=128", "display_name": "Steven A", "link": "https://stackoverflow.com/users/6895430/steven-a"}, "edited": false, "score": 0, "creation_date": 1475116642, "post_id": 39755485, "comment_id": 66816618, "body": "@taskinoor, thank you for your helpful answer.  Without the -lm flag, I get almost the identical error you mention above.  I am using gcc 5.4 and will try to upgrade if a newer version of gcc fixes this."}, {"owner": {"reputation": 63, "user_id": 6895430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pnIdIzKhApE/AAAAAAAAAAI/AAAAAAAAACg/DZN7sZasD2Y/photo.jpg?sz=128", "display_name": "Steven A", "link": "https://stackoverflow.com/users/6895430/steven-a"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475118771, "post_id": 39755485, "comment_id": 66817137, "body": "@Barmar, I don&#39;t get the linker error with taskinoor&#39;s snippet on VC 2013 but I must use the -lm flag with gcc 5.4"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475242395, "post_id": 39755485, "comment_id": 66878435, "body": "So the overall explanation is that the default set of libraries is implementation-dependent. I don&#39;t think the C language spec covers linking with system libraries, it just specifies the header files that contain the declarations."}, {"owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475243440, "post_id": 39755485, "comment_id": 66879099, "body": "@Barmar my point was on some compiler (e.g. gcc on Linux) there is no need to link with libraries with constant values if that can be resolved at compiler time. But yes, looks like that is implementation dependent."}], "tags": [], "owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "is_accepted": true, "score": 6, "last_activity_date": 1475089830, "last_edit_date": 1475089830, "creation_date": 1475088682, "answer_id": 39755485, "question_id": 39755217, "link": "https://stackoverflow.com/questions/39755217/gcc-linking-with-static-libraries/39755485#39755485", "title": "gcc linking with static libraries", "body": "<p><code>sqrt (2.0);</code></p>\n\n<p>Modern GCC is well capable to determine that you are trying to find square root of a constant and thus it is able to calculate that in compile time. Your object code does not contain an actual call to <code>sqrt</code>.</p>\n\n<p>If you use a variable which is input via <code>scanf</code> at run then it won't link without <code>libm</code>.</p>\n\n<pre><code>int main() {\n    double x;\n\n    scanf(\"%lf\", &amp;x);\n    printf(\"%lf\\n\", sqrt(x));\n\n    return 0;\n}\n</code></pre>\n\n<p>Without <code>libm</code> gcc 4.8.4 on Ubuntu 14.04 this results:</p>\n\n<pre><code>/tmp/ccVO2fRY.o: In function `main':\nsqrt.c:(.text+0x2c): undefined reference to `sqrt'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>But if I put a constant instead of <code>x</code> like your example then it links fine without <code>libm</code>.</p>\n\n<p>P.S: I don't know the exact version since when GCC is able to do this. Hopefully someone else can point to that.</p>\n"}], "owner": {"reputation": 63, "user_id": 6895430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pnIdIzKhApE/AAAAAAAAAAI/AAAAAAAAACg/DZN7sZasD2Y/photo.jpg?sz=128", "display_name": "Steven A", "link": "https://stackoverflow.com/users/6895430/steven-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "accepted_answer_id": 39755485, "answer_count": 2, "score": 6, "last_activity_date": 1475115475, "creation_date": 1475087779, "last_edit_date": 1475115475, "question_id": 39755217, "link": "https://stackoverflow.com/questions/39755217/gcc-linking-with-static-libraries", "title": "gcc linking with static libraries", "body": "<p>I am reading a book titled \"An Introduction to GCC\" and would like some clarification. The <strong>book indicates that the code below will cause an error</strong> but when I compile, it <strong>builds and runs</strong> perfectly:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\nint main (void) {\n  double x = sqrt (2.0);\n  printf (\"The square root of 2.0 is %f\\n\", x);\n  return 0;\n}\n</code></pre>\n\n<p>I quote from the book \"<em>Trying to create an executable from this source file alone causes the compiler to give an error at the link stage:</em>\"</p>\n\n<pre><code>$ gcc -Wall calc.c -o calc\n/tmp/ccbR6Ojm.o: In function `main':\n/tmp/ccbR6Ojm.o(.text+0x19): undefined reference \n  to `sqrt'\n</code></pre>\n\n<p>The solution that the book gives is that you are supposed to include the path to the math library \u2018<strong>libm.a</strong>\u2019 as follows:</p>\n\n<pre><code>$ gcc -Wall calc.c /usr/lib/libm.a -o calc\n</code></pre>\n\n<p>It would be very inconvenient to have to specify the paths to built in libraries that we use in our programs.  I can understand the reason for adding the path to my own custom libraries, but <strong>libm.a</strong> is built into gcc.  And although the book is quite old (published in 2004), <em>what has changed with more modern versions of gcc</em>, so that we do not need to include the path to <strong>libm.a</strong>?</p>\n\n<p><strong>* UPDATE *</strong></p>\n\n<p>I noticed that the answer given by taskinoor demonstrates updated code that requires that I use the <strong>-lm</strong> flag if the value passed to sqrt() is not known at compile time.</p>\n\n<p>I learned C/C++ using VS but my goal now is to learn and use gcc.  I have Visual Studio 2013 and the VS compiler/linker does not seem so picky.  For example, I am able to compile just about any simple program without having to specify mysterious compiler flags.</p>\n\n<p>I am learning on <strong>gcc version 5.4</strong> that comes with KUBUNTU 16.04.1</p>\n"}, {"tags": ["c", "casting", "void-pointers"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1475085971, "post_id": 39754645, "comment_id": 66805405, "body": "How does &quot;no dynamic allocations allowed&quot; mesh with <code>calloc()</code>?"}, {"owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1475086034, "post_id": 39754645, "comment_id": 66805447, "body": "I use <code>calloc()</code> for the whole area at the very beginning (inside my <code>init()</code> function) - which is allowed!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475086103, "post_id": 39754645, "comment_id": 66805483, "body": "@cerr, but <code>calloc()</code> performs dynamic allocation.  That leaves us uncertain what you mean by &quot;no dynamic allocations allowed&quot;."}, {"owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475086138, "post_id": 39754645, "comment_id": 66805503, "body": "@JohnBollinger I use <code>calloc()</code> for the whole area at the very beginning (inside my <code>init()</code> function) - which is allowed!"}], "answers": [{"tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": false, "score": 3, "last_activity_date": 1475086231, "creation_date": 1475086231, "answer_id": 39754760, "question_id": 39754645, "link": "https://stackoverflow.com/questions/39754645/how-to-keep-a-global-storage-area-type-independent-in-c/39754760#39754760", "title": "How to keep a global storage area type independent in C?", "body": "<p>You cannot index a void pointer, because the size of the element type is unknown. So first downcast your pointer to a particular type, and only then do the indexing:</p>\n\n<pre><code>rv = switch_mpls_vpws_data_get(lab, &amp;((mpls_vpws_t*)ser_dat_ch)[lab]);\n</code></pre>\n\n<p>The reason the compiler complains about the <code>+</code> operator is that <code>ser_dat_ch[lab]</code> is equivalent to <code>*(ser_dat_ch + lab)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 1, "creation_date": 1475086371, "post_id": 39754777, "comment_id": 66805659, "body": "Great approach, but bear in mind that the memory layout will be different (less compact), so caching might be less efficient. Not usually a problem, just something to be aware of in high-performance applications."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 0, "creation_date": 1475086915, "post_id": 39754777, "comment_id": 66806033, "body": "Its just as compact in the worst case though, when every single entry is of the larger type."}], "tags": [], "owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "is_accepted": true, "score": 6, "last_activity_date": 1475086848, "last_edit_date": 1475086848, "creation_date": 1475086285, "answer_id": 39754777, "question_id": 39754645, "link": "https://stackoverflow.com/questions/39754645/how-to-keep-a-global-storage-area-type-independent-in-c/39754777#39754777", "title": "How to keep a global storage area type independent in C?", "body": "<p>In this particular case, I think the simplest solution would be to create a buffer with 4K entries of an union type.</p>\n\n<pre><code>struct A {/**/};\nstruct B {/**/};\n\nunion AB {\n    struct A a;\n    struct B b;\n};\n\nunion AB ser_dat_ch[4000];\n</code></pre>\n"}], "owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 39754777, "answer_count": 2, "score": 1, "last_activity_date": 1475086848, "creation_date": 1475085802, "last_edit_date": 1475086618, "question_id": 39754645, "link": "https://stackoverflow.com/questions/39754645/how-to-keep-a-global-storage-area-type-independent-in-c", "title": "How to keep a global storage area type independent in C?", "body": "<p>I have to secure space in advance sufficient for up to 4k total entries divided between two different types, in any proportion, then fill it with data.  I thought I'd allocate space sufficient for 4k of the larger type, and then decide upon filling it up with data what kind it actually is.  I'm running into an issue where the compiler tells me <strong>error (etoa:1554): illegal type(s): ptr-to-void '+' int</strong>.</p>\n\n<p>In my init function, I allocate the space something like this:</p>\n\n<pre><code>ser_dat_ch = calloc(LABEL_T_CNT,\n        (sizeof(mpls_vpws_t) &gt; sizeof(mpls_vpls_t)\n        ? sizeof(mpls_vpws_t)\n        : sizeof(mpls_vpls_t)));\n</code></pre>\n\n<p>where <code>ser_dat_ch</code> is declared at file scope like so:</p>\n\n<pre><code>static void *ser_dat_ch = NULL;\n</code></pre>\n\n<p>When I load data into the structure, I wanted to do something like</p>\n\n<pre><code>rv = switch_mpls_vpws_data_get(lab, (mpls_vpws_t*)&amp;ser_dat_ch[lab]);\n</code></pre>\n\n<p>, but this is what gets the compiler barking at me.  What's the problem?</p>\n"}, {"tags": ["c", "arrays", "csv"], "comments": [{"owner": {"reputation": 5796, "user_id": 328730, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6f9395f6a8e5bf4970661b80194105b0?s=128&d=identicon&r=PG", "display_name": "Dr Rob Lang", "link": "https://stackoverflow.com/users/328730/dr-rob-lang"}, "edited": false, "score": 0, "creation_date": 1475091544, "post_id": 39754635, "comment_id": 66808357, "body": "Please include the code that you have to try and solve the problem so that we can help you fix it. It&#39;s OK to edit your question."}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 2414839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bf8a639129c21b737d1333265b4c67?s=128&d=identicon&r=PG", "display_name": "akinfermo", "link": "https://stackoverflow.com/users/2414839/akinfermo"}, "is_accepted": false, "score": 0, "last_activity_date": 1475086425, "creation_date": 1475086425, "answer_id": 39754809, "question_id": 39754635, "link": "https://stackoverflow.com/questions/39754635/converting-floating-point-csv-to-2d-array-in-c/39754809#39754809", "title": "Converting floating point csv to 2d array in c", "body": "<p>Take a look at <a href=\"https://sourceforge.net/projects/libcsv/\" rel=\"nofollow\">libcsv</a>, which is a CSV library written in ANSI C89. But be careful, libcsv is licensed under LGPL. </p>\n"}, {"comments": [{"owner": {"reputation": 16, "user_id": 6895699, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154677200727125/picture?type=large", "display_name": "Teddy Innah Areah Putus", "link": "https://stackoverflow.com/users/6895699/teddy-innah-areah-putus"}, "edited": false, "score": 0, "creation_date": 1475089025, "post_id": 39755558, "comment_id": 66807205, "body": "haha ignore that commented out i = 0, I was playing around with how format it"}], "tags": [], "owner": {"reputation": 16, "user_id": 6895699, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154677200727125/picture?type=large", "display_name": "Teddy Innah Areah Putus", "link": "https://stackoverflow.com/users/6895699/teddy-innah-areah-putus"}, "is_accepted": true, "score": 0, "last_activity_date": 1475110151, "last_edit_date": 1475110151, "creation_date": 1475088916, "answer_id": 39755558, "question_id": 39754635, "link": "https://stackoverflow.com/questions/39754635/converting-floating-point-csv-to-2d-array-in-c/39755558#39755558", "title": "Converting floating point csv to 2d array in c", "body": "<p>Use atof() to convert strings to floats.\n<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_atof.htm\" rel=\"nofollow\">Here</a> is a link if you want to read up on it</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n//counters\nint i = 0;\nint j = 0;\nint k = 0;\n\nchar c = 0; //for storing a char at a time\n\nchar result_char_array[4] = {0}; //float is a 32 bit number, so 4 bytes\n\nFILE *filep; //pointer to file structure\n\nfloat results[100] = {0}; //to store the float\n\nint main(void)\n{\n\n    filep = fopen(\"C:/Documents/test.csv\", \"r\");      //open file , read only\n    if (!filep)\n    {\n        fprintf (stderr, \"failed to open file for reading\\n\");\n        return -1; //return negative number so you know something went wrong\n    }\n\n    c = fgetc(filep); //get first character\n\n    while(c != EOF)\n    {\n        if((c == ',') || (c == '\\n')) //we want to stop at each comma or newline\n        {\n            //i = 0; //reset the count\n            results[j] = atof(result_char_array); //this converts a string to a float\n            j++; //increment j\n            memset(&amp;result_char_array, 0, sizeof(result_char_array)); //clear the array\n        }\n        else\n        {\n            strncat(&amp;result_char_array, &amp;c, 1);\n        }\n\n\n        c = fgetc(filep); //get next character\n        i++;\n    }\n\n    results[j] = atof(result_char_array); //convert last number\n\n    fclose (filep); //always close the file\n\n    for(k = 0; k &lt;= j; k++)\n    {\n        printf(\"Number %d is: %f\\n\",k, results[k]); //loop through the results and print line by line\n    }\n    getchar();\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6895413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9e8ca15b430cedc6849651348ca0a57?s=128&d=identicon&r=PG&f=1", "display_name": "Sree", "link": "https://stackoverflow.com/users/6895413/sree"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "closed_date": 1476479383, "accepted_answer_id": 39755558, "answer_count": 2, "score": -3, "last_activity_date": 1475110151, "creation_date": 1475085771, "last_edit_date": 1495542805, "question_id": 39754635, "link": "https://stackoverflow.com/questions/39754635/converting-floating-point-csv-to-2d-array-in-c", "closed_reason": "Needs more focus", "title": "Converting floating point csv to 2d array in c", "body": "<p>I need to convert a floating point csv to a 2D array in c. Have already saw an article (<a href=\"https://stackoverflow.com/questions/24266286/import-csv-elements-into-a-2d-array-in-c/24266565#24266565?newreg=0ccaa1c1b3ea4c1482255898ab2882c8\">Import CSV elements into a 2D array in C</a>) which explains the conversion to an integer array.Can any one help in modifying this code or a new approach that i could use to convert the csv to a floating point 2D array<br>\nfor eg: my csv contains values like 0.018869,0.015863,0.044758,0.027318,0.049394,0.040823,..... and is a 4400*500 values csv. so i would need to use a big array of size 4400*500 to include all of these values.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "string", "segmentation-fault"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475084474, "post_id": 39754239, "comment_id": 66804500, "body": "How do you know that is where the crash is? Because that is code that can&#39;t lead to crashes unless you have a stack overflow (and that would not manifest as a segmentation fault). Please use a debugger to catch the crash in action, and find out where in your code it <i>really</i> happens."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1475084602, "post_id": 39754239, "comment_id": 66804596, "body": "I have two guesses about the error though: Either one of the <code>strtok</code> Calls return a <code>NULL</code> pointer (which you do not check for). Or you forget that strings in C need an extra character for the terminating <code>&#39;\\0&#39;</code>, and you write out of bounds of your arrays. A third reason might be that <code>cria_jogadores</code> fails to allocate memory, or returns a pointer to alocal array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475084926, "post_id": 39754239, "comment_id": 66804781, "body": "<code>char str1[4], str2[4];</code> look pathetically small to read from a file strings that contain two tokens. That would mean input in the form of 3-char strings such as <code>&quot;a,b&quot;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475085157, "post_id": 39754239, "comment_id": 66804896, "body": "If the segfault happens where you commented, the damage previously happened at some other place in the program."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1475085785, "post_id": 39754239, "comment_id": 66805284, "body": "Please show a complete and minimal example that demonstrates your problem. By &quot;complete&quot; I mean that you should show the whole <code>main.c</code> file. By &quot;minimal&quot; I mean that you should remove everything that doesn&#39;t contribute to the problem."}], "answers": [{"tags": [], "owner": {"reputation": 1057, "user_id": 4153464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/D55Mz.jpg?s=128&g=1", "display_name": "Work of Artiz", "link": "https://stackoverflow.com/users/4153464/work-of-artiz"}, "is_accepted": false, "score": 1, "last_activity_date": 1475086052, "creation_date": 1475086052, "answer_id": 39754706, "question_id": 39754239, "link": "https://stackoverflow.com/questions/39754239/segmentation-fault-on-string-creation/39754706#39754706", "title": "Segmentation Fault on String Creation", "body": "<p>So I have a different theory, I think the next line is the culprit</p>\n\n<pre><code>mapa-&gt;mapa = cria_mapa(tamanho_mapa);\n</code></pre>\n\n<p>That is only if like in the code given here, you defined <code>mapa</code> like this</p>\n\n<pre><code>t_mapa *mapa;\n</code></pre>\n\n<p>You don't seem to initialise it to anything, but then dereference it using the <code>-&gt;</code> operator.</p>\n\n<p>Other than this I don't see anything wrong directly. We would need more of the code to give a better answer.</p>\n"}], "owner": {"reputation": 19, "user_id": 6895295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6361d9564bb22bb6daf012a916ac0f86?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme Resende", "link": "https://stackoverflow.com/users/6895295/guilherme-resende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1476599446, "answer_count": 1, "score": -1, "last_activity_date": 1475086052, "creation_date": 1475084275, "question_id": 39754239, "link": "https://stackoverflow.com/questions/39754239/segmentation-fault-on-string-creation", "closed_reason": "Not suitable for this site", "title": "Segmentation Fault on String Creation", "body": "<p>I've been developing a program to read a data from a file, then I received a Seg Fault when I tried to create a constant size string.</p>\n\n<pre><code>FILE *in = fopen(\"entrada.txt\", \"r\");\n\nt_mapa *mapa;\nt_jogador *jogadores;\njogadores = NULL;\n\nint i, num_jogadores, tamanho_mapa;\nchar *token1, *token2;\nchar str1[4], str2[4]; //RIGHT HERE WHEN I CREATE THE STRING, I RECEIVE A SEG FAULT\n\nif(in == NULL){\n    printf(\"Arquivo N\u00e3o pode ser aberto\");\n}\n\n\nfscanf(in, \"%d\", &amp;tamanho_mapa);\nprintf(\"%d\\n\", tamanho_mapa); //Debugger\nmapa-&gt;mapa = cria_mapa(tamanho_mapa);\npreenche_mapa(mapa, in, tamanho_mapa);\nfscanf(in, \"%d\", &amp;num_jogadores);\nprintf(\"%d %p\\n\", num_jogadores, jogadores); //Debugger\njogadores = cria_jogadores(num_jogadores);\n\n\nfor(i=0; i&lt;num_jogadores; i++){\n    fscanf(in, \"%s %s\", str1, str2);\n    token1 = strtok(str2, \",\");\n    token2 = strtok(NULL, \",\");\n    jogadores[i].linha = atoi(token1);\n    jogadores[i].coluna = atoi(token2);\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "dll"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1475085265, "post_id": 39754211, "comment_id": 66804959, "body": "From a command prompt, type <code>rundll32.exe printui.dll PrintUIEntry</code>, and look at the additional information it&#39;s expecting. What gives you the impression you can call it directly with none of those details? Where do you find the documentation for the parameters you&#39;re passing to it? And why on Earth would you expect it to be looking for the HMODULE of the DLL it&#39;s already been loaded from as one of those parameters?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1475085451, "post_id": 39754211, "comment_id": 66805073, "body": "What are you expecting us to tell you? Error is file not found. But then you knew that because you looked it up. Is that relevant? Maybe. What is value of cmd? Only you know."}, {"owner": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "edited": false, "score": 0, "creation_date": 1475085698, "post_id": 39754211, "comment_id": 66805240, "body": "The process is launched remotly I can&#39;t check the value of cmd, and sorry I&#39;ll add more details"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1475094207, "post_id": 39754211, "comment_id": 66809835, "body": "So in other words you have no idea what your code does and you want somebody to explain its behaviour."}, {"owner": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "edited": false, "score": 0, "creation_date": 1475226203, "post_id": 39754211, "comment_id": 66868625, "body": "No, I want to know why I get the error code <code>2</code>"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "edited": false, "score": 0, "creation_date": 1475225225, "post_id": 39755987, "comment_id": 66868061, "body": "One more question please I have code like this <code>Log() &lt;&lt; &quot;Before -&gt; &quot; &lt;&lt; GetLastError() &lt;&lt; &quot;.\\n&quot;;    PrintUIEntry(GetDesktopWindow(), printuiDll, cmd, SW_SHOW);    Log() &lt;&lt; &quot;After -&gt; &quot; &lt;&lt; GetLastError() &lt;&lt; &quot;.\\n&quot;;</code>  and it returns <code>after -&gt; 2</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "edited": false, "score": 0, "creation_date": 1475259697, "post_id": 39755987, "comment_id": 66888352, "body": "I addressed that in my answer."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1475259615, "last_edit_date": 1495540099, "creation_date": 1475090542, "answer_id": 39755987, "question_id": 39754211, "link": "https://stackoverflow.com/questions/39754211/how-to-fix-printuientry-returns-error-code-2/39755987#39755987", "title": "How to fix PrintUIEntry returns error code 2", "body": "<p>If you read the documentation:</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/164787\" rel=\"nofollow noreferrer\">INFO: Windows Rundll and Rundll32 Interface</a></p>\n\n<p><a href=\"https://technet.microsoft.com/en-us/library/ee624057.aspx\" rel=\"nofollow noreferrer\">Rundll32 printui.dll,PrintUIEntry</a></p>\n\n<p>You would see that your declaration of the <code>PrintUIEntryW</code> function pointer is wrong.  Most importantly, functions that are designed to be called by <code>rundll32</code> <strong>do not have a return value</strong>, and <code>PrintUIEntry</code> is not documented as using <code>SetLastError()</code> for error reporting.</p>\n\n<p>So you cannot do any kind of error checking in this situation.</p>\n\n<ol>\n<li><p>You are checking for a non-existent <code>BOOL</code> value, which means you are checking for whatever <em>random value</em> happens to be stored in the <code>EAX</code> cpu register when <code>PrintUIEntryW</code> exits.  <code>PrintUIEntryW</code> has no return value that you can check.</p></li>\n<li><p>You are calling <code>GetLastError()</code> to retrieve the last error code that was set by <code>SetLastError()</code>.  That may or may not be related to any <code>PrintUIEntryW</code> errors, since it not documented behavior.  For instance, <code>PrintUIEntryW</code> could be using other APIs internally, which might use <code>SetLastError()</code>/<code>GetLastError()</code> for their own error reporting, and would be handled by <code>PrintUIEntryW</code> internally.  Such errors should not be interpreted by any code that is calling <code>PrintUIEntryW</code>, since the code has no context in which to interpret the errors.</p></li>\n</ol>\n\n<p>In this case, this question becomes a duplicate of <a href=\"https://stackoverflow.com/questions/32505112/\">How to check the result of PrintUIEntry call</a>.</p>\n\n<p>Since you are trying to install a printer, consider using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd183343.aspx\" rel=\"nofollow noreferrer\"><code>AddPrinter()</code></a> or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd144997.aspx\" rel=\"nofollow noreferrer\"><code>InstallPrinterDriverFromPackage()</code></a> instead.</p>\n"}], "owner": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 39755987, "answer_count": 1, "score": -1, "last_activity_date": 1614679557, "creation_date": 1475084181, "last_edit_date": 1614679557, "question_id": 39754211, "link": "https://stackoverflow.com/questions/39754211/how-to-fix-printuientry-returns-error-code-2", "title": "How to fix PrintUIEntry returns error code 2", "body": "<p>I have some problem. Here is my code:</p>\n<pre><code>typedef BOOL (WINAPI *pPrintUIEntry)(HWND, HMODULE, wchar_t *, DWORD);\n\nprintuiDll = LoadLibrary(&quot;printui.dll&quot;);\n\nif (printuiDll == NULL)\n{\n  printf(&quot;Error LoadLibrary %d.\\n&quot;, GetLastError());\n\n  return -1;\n}\n\nPrintUIEntry = (pPrintUIEntry) GetProcAddress(printuiDll, &quot;PrintUIEntryW&quot;);\n\nif (PrintUIEntry == NULL)\n{\n  printf(&quot;Error GetProcAddress %d.\\n&quot;, GetLastError());\n\n  return -1;\n}\n//cmd is /ia /m &quot;Printer&quot; /f &quot;C:\\Program Files x86)\\\\drivers\\Printer\\Printer.inf\n\nif (PrintUIEntry(GetDesktopWindow(), printuiDll, cmd, SW_SHOW))\n{\n  printf(&quot;Error PrintUIEntry %d.\\n&quot;, GetLastError());\n\n  return -1;\n}\n</code></pre>\n<p>Sorry I can't copy the code its my university work. The problem I have is that <code>PrintUIEntry</code> returns 0 and it gives me error withe code <code>2</code>. I've tried to google little bit about this function but I could found much. Hope you can help. thanks.</p>\n<p>I've checked and file exists.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 1, "creation_date": 1475084151, "post_id": 39754159, "comment_id": 66804307, "body": "What is your question?"}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 3, "creation_date": 1475084152, "post_id": 39754159, "comment_id": 66804308, "body": "It is nice to know that you are trying to do that.  I am trying to find a good plumber."}, {"owner": {"reputation": 1926, "user_id": 3495940, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100000069061915/picture?type=large", "display_name": "Masnad Nihit", "link": "https://stackoverflow.com/users/3495940/masnad-nihit"}, "reply_to_user": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475084267, "post_id": 39754159, "comment_id": 66804374, "body": "@sabbahillel Sorry I was in a hurry while posting, added the question"}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475084317, "post_id": 39754159, "comment_id": 66804406, "body": "FYI looking at your code, you will have the value after the min and the value after the max added twice to the sum. Also if the min or max is the last entry, you will set the last value to something outside the array."}, {"owner": {"reputation": 1926, "user_id": 3495940, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100000069061915/picture?type=large", "display_name": "Masnad Nihit", "link": "https://stackoverflow.com/users/3495940/masnad-nihit"}, "reply_to_user": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475084409, "post_id": 39754159, "comment_id": 66804471, "body": "@sabbahillel I wrote on the top what I want to achieve, the problem is I am not sure how to achieve it."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475084424, "post_id": 39754159, "comment_id": 66804477, "body": "Are all of the values positive or do you have negative numbers?"}, {"owner": {"reputation": 1926, "user_id": 3495940, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100000069061915/picture?type=large", "display_name": "Masnad Nihit", "link": "https://stackoverflow.com/users/3495940/masnad-nihit"}, "reply_to_user": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475084691, "post_id": 39754159, "comment_id": 66804650, "body": "@sabbahillel all positives"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475085535, "post_id": 39754159, "comment_id": 66805130, "body": "Note: An array of grades is not needed, just a running min, max and sum."}], "answers": [{"comments": [{"owner": {"reputation": 1926, "user_id": 3495940, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100000069061915/picture?type=large", "display_name": "Masnad Nihit", "link": "https://stackoverflow.com/users/3495940/masnad-nihit"}, "edited": false, "score": 0, "creation_date": 1475085097, "post_id": 39754399, "comment_id": 66804864, "body": "Thanks, I needed to know how the for loops worked for max and min, solved the rest! Thanks!"}], "tags": [], "owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "is_accepted": true, "score": 1, "last_activity_date": 1475085229, "last_edit_date": 1475085229, "creation_date": 1475084859, "answer_id": 39754399, "question_id": 39754159, "link": "https://stackoverflow.com/questions/39754159/get-max-min-element-from-array-delete-them-and-sum-rest-of-the-array/39754399#39754399", "title": "get max min element from array, delete them and sum rest of the array", "body": "<p>Instead of looping through the array again, use the index. Note that in your code, you reset sum inside the loop so it will only show the last value and is not in scope when the loop is finished (so it will disappear). You also print inside the loop instead of after the full sum has been calculated.</p>\n\n<pre><code>int imin = 0, imax = 0;\nmax=a[0];\nfor(i=1; i&lt;size; i++){\n    if(max&lt;a[i]) {\n        imax = i;\n        max=a[i];\n    }\n}\n\nmin=a[0];\nfor(i=1; i&lt;size; i++){\n    if(min&gt;a[i]) {\n        min=a[i];\n        imin = i;\n    }\n}\n\na[imin] = 0; // Does not contribute to the sum\na[imax] = 0; // Does not contribute to the sum\n\nint sum = 0;\nfor (i=0; i&lt;size; i++) {\n    sum += a[i];\n}\nprintf(\"sum = %d\\n\", sum);   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1619, "user_id": 3342206, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92d5672ff3c806eb71d84d7298d5be43?s=128&d=identicon&r=PG&f=1", "display_name": "8bittree", "link": "https://stackoverflow.com/users/3342206/8bittree"}, "edited": false, "score": 0, "creation_date": 1475176708, "post_id": 39754665, "comment_id": 66850968, "body": "In your <code>i = 2</code> iteration, <code>a[3]</code> should be 5, not 6."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 1619, "user_id": 3342206, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92d5672ff3c806eb71d84d7298d5be43?s=128&d=identicon&r=PG&f=1", "display_name": "8bittree", "link": "https://stackoverflow.com/users/3342206/8bittree"}, "edited": false, "score": 0, "creation_date": 1475191494, "post_id": 39754665, "comment_id": 66856996, "body": "@8bittree Thanks, fixed! It&#39;s easier if next time you suggest these edits with the edit button at the bottom of the answer."}, {"owner": {"reputation": 1619, "user_id": 3342206, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92d5672ff3c806eb71d84d7298d5be43?s=128&d=identicon&r=PG&f=1", "display_name": "8bittree", "link": "https://stackoverflow.com/users/3342206/8bittree"}, "edited": false, "score": 1, "creation_date": 1475243711, "post_id": 39754665, "comment_id": 66879289, "body": "Yeah, I was thinking the fix would be too small for me to edit, but in retrospect, the comment ought to have brought me over the threshold."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 2, "last_activity_date": 1475191450, "last_edit_date": 1495540099, "creation_date": 1475085888, "answer_id": 39754665, "question_id": 39754159, "link": "https://stackoverflow.com/questions/39754159/get-max-min-element-from-array-delete-them-and-sum-rest-of-the-array/39754665#39754665", "title": "get max min element from array, delete them and sum rest of the array", "body": "<p>Here's your deleting code. The basic idea is if it's the min or max to replace it with the one after it.</p>\n\n<pre><code>for (i=0;i &lt; size ;i++) {\n    if(a[i] == min || a[i] == max){\n        a[i] = a[i+1];\n    }\n}\n</code></pre>\n\n<p>Ok, let's try it. <code>{4, 3, 6, 5}</code>. 3 is min, 6 is max.</p>\n\n<pre><code>i == 0\na[0] == 4\na[1] == 3\nNo change: {4, 3, 6, 5}\n\ni == 1\na[1] == 3 (the min)\na[2] == 6 (the max)\na[1] = a[2]: {4, 6, 6, 5}  /* whoops, you replaced the min with the max */\n\ni = 2\na[2] == 6 (the max)\na[3] == 5\na[2] = a[3]: {4, 6, 5, 5}\n\ni == 3\na[3] == 5\na[4] == garbage /* whoops, you walked off the array */\nNo change\n</code></pre>\n\n<p>So there's two problems. When you do the replacement you have to recheck the new value. This will be a problem if the min and max or next to each other, or if there's two max values.</p>\n\n<p>Second is you're walking off the array. <code>i + 1</code> is a red flag. If the min or max was the last value, you'd replace it with garbage. A memory checker such as <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a> will find these sorts of very, very common problems. I highly recommend you always run a memory checker and fix everything it complains about.</p>\n\n<hr>\n\n<p>Rather than altering the array, which gets tricky, it's much easier to do this in two passes. It's also non-destructive, you don't have to alter or copy the data.</p>\n\n<ol>\n<li>Find the min and the max.</li>\n<li>Take the average by ignoring the min and the max.</li>\n</ol>\n\n<p>You can find the min and max in one loop.</p>\n\n<pre><code>int min = a[0];\nint max = a[0];\nfor( i = 1; i &lt; size; i++ ) {\n    if( a[i] &lt; min ) {\n        min = a[i];\n    }\n    if( a[i] &gt; max ) {\n        max = a[i];\n    }\n}\n</code></pre>\n\n<p>Then take the average and ignore the min and max.</p>\n\n<pre><code>int sum = 0;\nint count = 0;\n\nfor( i = 0; i &lt; size; i++ ) {\n    if( a[i] != min &amp;&amp; a[i] != max ) {\n        sum += a[i];\n        count++;\n    }\n}\n\nint avg = sum / count;\n</code></pre>\n\n<hr>\n\n<p>This reveals another problem. What if there are multiple mins and maxes? What if the scores are <code>{3, 3, 3, 5, 5, 5}</code>? Do you want to throw them all out and get an average of 0? Probably not. You probably only want to throw out the highest and lowest single scores.</p>\n\n<p>You could make <code>seen_min</code> and <code>seen_max</code> boolean variables to only skip <code>min</code> and <code>max</code> once, but this gets complicated. <a href=\"https://stackoverflow.com/a/39754300/14660\">@MikeNakis solution</a> is better, store the index of the min and max and use that to do the skipping.</p>\n\n<pre><code>int min_idx = 0;\nint max_idx = 0;\nfor( i = 1; i &lt; size; i++ ) {\n    if( a[i] &lt; a[min_idx] ) {\n        min_idx = i;\n    }\n    if( a[i] &gt; a[max_idx] ) {\n        max_idx = i;\n    }\n}\n\nint sum = 0;\nint count = 0;\n\nfor( i = 0; i &lt; size; i++ ) {\n    /* Skip the min and max score */\n    if( i == min_idx || i == max_idx ) {\n        continue;\n    }\n\n    sum += a[i];\n\n    /* You could replace count with size - 2, but this way\n       there's one less assumption */\n    count++;\n}\n\ndouble avg = (double)sum / count;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475086651, "post_id": 39754782, "comment_id": 66805856, "body": "@sabbahillel <code>printf(&quot;sum = %u\\n&quot;, sum - min - max);</code> prints the sum <b>without</b> the min or max."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475086897, "post_id": 39754782, "comment_id": 66806023, "body": "OK I missed that. Of course using the sum later is still a problem unless you subtract them at the end (near the print). <code>sum -= (min+max);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1475087438, "post_id": 39754782, "comment_id": 66806323, "body": "@sabbahillel  Not much different than a quibble using <code>a[imax]</code> later in code finding it is 0 rather than the maximum value as in <a href=\"http://stackoverflow.com/a/39754399/2410359\">this answer</a>.  The point being <code>min,max,sum,a[]</code> are <i>intermediate</i> variables and OP&#39;s code implies that printing the result was the goal, not necessarily returning a variable containing the value nor maintaining <code>min, max, sum, i, a[]</code>, etc."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 1, "creation_date": 1475088708, "post_id": 39754782, "comment_id": 66807028, "body": "Yes you are right. either way it gets the correct sum. It only depends on what he needs to do in the rest of the code."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1475087014, "last_edit_date": 1475087014, "creation_date": 1475086304, "answer_id": 39754782, "question_id": 39754159, "link": "https://stackoverflow.com/questions/39754159/get-max-min-element-from-array-delete-them-and-sum-rest-of-the-array/39754782#39754782", "title": "get max min element from array, delete them and sum rest of the array", "body": "<p>No need to even have an array.  Calculate the min, max and sum as you go:</p>\n\n<pre><code>unsigned min = -1u;  // min is set to the greatest unsigned value\nunsigned max = 0;    // max is set to the least unsigned value\nunsigned sum = 0;\n\nfor (int i=0; i&lt;5; i++) {\n  unsigned judge;\n  printf(\"Judge one grade \");\n  if (scanf(\"%u\", &amp;judge) != 1) break; // validate input\n  if (judge &gt; max) max = judge;\n  if (judge &lt; min) min = judge;\n  sum += judge;\n}\n\nif (min &gt; max) {\n  printf(\"No valid input\\n\");\n  return -1;\n}\n\n// print sum less the min and max, which is OP's goal\nunsigned sum_less_min_max = sum - min - max;\nprintf(\"sum = %u\\n\", sum_less_min_max); \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 5871089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff20fcf28d5b028530ac5bb5a3a8933?s=128&d=identicon&r=PG&f=1", "display_name": "prasad", "link": "https://stackoverflow.com/users/5871089/prasad"}, "is_accepted": false, "score": 2, "last_activity_date": 1475087553, "creation_date": 1475087553, "answer_id": 39755150, "question_id": 39754159, "link": "https://stackoverflow.com/questions/39754159/get-max-min-element-from-array-delete-them-and-sum-rest-of-the-array/39755150#39755150", "title": "get max min element from array, delete them and sum rest of the array", "body": "<p>Logic you used in two for loops is wrong.\n1st for loop -</p>\n\n<pre><code>for (i=0;i &lt; size ;i++) {\n    if(a[i] == min || a[i] == max){\n        a[i] = a[i+1];\n    }\n}\n</code></pre>\n\n<p>Here you are copying next element to previous. Thus for array [2, 3, 4, 5, 6], you'll be copying 3 to 2 so array will become [3, 3, 4, 5, 6] which will give wrong result on summing up.</p>\n\n<p>2nd for loop -</p>\n\n<pre><code>for (i=0;i &lt; size ;i++) {\n    int sum = 0;\n    sum+= a[i];\n    printf(\"%d\\n\", sum);\n}\n</code></pre>\n\n<p>Here you are initializing sum to 0 in every iteration, thus a[i] always will get added to 0. Thus output will be last element value.\nYou should initialize sum before start of for loop.</p>\n\n<p><strong>Answer</strong>  -</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int judge1=2, judge2=3,judge3=4,judge4=5, judge5=6,i,max,min;\n    int size = 5;\n\n\n    int a[] = {judge1, judge2, judge3, judge4, judge5};\n    max=0;\n    for(i=1;i&lt;size;i++){\n        if(a[max]&lt;a[i])\n            max=i;\n    }\n    for (i=max;i&lt;size;i++) {\n        a[i] = a[i+1];\n    }\n    size--;\n\n    min=0;\n    for(i=1;i&lt;size;i++){\n        if(a[min]&gt;a[i])\n            min=i;\n    }\n    for (i=min;i &lt; size ;i++) {\n        a[i] = a[i+1];\n    }\n    size--;\n\n    int sum = 0;\n    for (i=0;i &lt; size ;i++) {\n        sum+= a[i];\n        printf(\"%d\\n\", sum);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Or if you just need the sum here's the easy solution</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int judge1=2, judge2 = 3,judge3 = 4,judge4 = 5, judge5 = 6, i;\n    int size = 5, sum = 0, max, min;\n    int a[] = {judge1, judge2, judge3, judge4, judge5};\n    max = a[0]; \n    min = a[0];\n    for (i=0;i &lt; size ;i++) {\n        if(max&lt;a[i])\n            max=a[i];\n        if(min&gt;a[i])\n            min=a[i];\n        sum+= a[i];\n    }\n    sum = sum - (max + min);\n    printf(\"%d\\n\", sum);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1926, "user_id": 3495940, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100000069061915/picture?type=large", "display_name": "Masnad Nihit", "link": "https://stackoverflow.com/users/3495940/masnad-nihit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1820, "favorite_count": 0, "accepted_answer_id": 39754399, "answer_count": 4, "score": 1, "last_activity_date": 1475191450, "creation_date": 1475084051, "last_edit_date": 1475084245, "question_id": 39754159, "link": "https://stackoverflow.com/questions/39754159/get-max-min-element-from-array-delete-them-and-sum-rest-of-the-array", "title": "get max min element from array, delete them and sum rest of the array", "body": "<p>I am trying to get 5 different grades from judges, and putting them in a array.\nThen I try to find the max and the min element from the array.\nexample {2,3,4,5,6}\nmax= 6 , min = 2.\nAfter that I have to delete 6 and 2, and then add 3+4+5 which gives me a sum of 12.\nHow do  delete and then add the sum? Since it looks like I am getting errors while deleting from the array .Here is the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int judge1, judge2,judge3,judge4, judge5,i,max,min;\n    int size = 4;\n\n\n    printf(\"Judge one grade\");\n    scanf(\"%d\", &amp;judge1);\n    printf(\"Judge one grade\");\n    scanf(\"%d\", &amp;judge2);\n    printf(\"Judge one grade\");\n    scanf(\"%d\", &amp;judge3);\n    printf(\"Judge one grade\");\n    scanf(\"%d\", &amp;judge4);\n    printf(\"Judge one grade\");\n    scanf(\"%d\", &amp;judge5);\n    int a[] = {judge1, judge2, judge3, judge4, judge5};\n    max=a[0];\n    for(i=1;i&lt;size;i++){\n        if(max&lt;a[i])\n            max=a[i];\n    }\n\n    min=a[0];\n    for(i=1;i&lt;size;i++){\n        if(min&gt;a[i])\n            min=a[i];\n    }\n\n    for (i=0;i &lt; size ;i++) {\n        if(a[i] == min || a[i] == max){\n            a[i] = a[i+1];\n        }\n    }\n\n    for (i=0;i &lt; size ;i++) {\n        int sum = 0;\n        sum+= a[i];\n        printf(\"%d\\n\", sum);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "terminal", "compiler-errors"], "comments": [{"owner": {"reputation": 2082, "user_id": 474197, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/ZRH5k.png?s=128&g=1", "display_name": "HKTonyLee", "link": "https://stackoverflow.com/users/474197/hktonylee"}, "edited": false, "score": 1, "creation_date": 1475084562, "post_id": 39754109, "comment_id": 66804560, "body": "Perhaps you should type <code>gcc -g ...</code> rather than <code>gcc - g ...</code>. Note the space between <code>-</code> and <code>g</code>"}, {"owner": {"reputation": 2082, "user_id": 474197, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/ZRH5k.png?s=128&g=1", "display_name": "HKTonyLee", "link": "https://stackoverflow.com/users/474197/hktonylee"}, "edited": false, "score": 1, "creation_date": 1475084911, "post_id": 39754109, "comment_id": 66804771, "body": "If you are copying from the website, ensure that there is no &quot;invisible&quot; spaces in the copied text."}, {"owner": {"reputation": 323, "user_id": 6347671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1107539829310897/picture?type=large", "display_name": "hiswendy", "link": "https://stackoverflow.com/users/6347671/hiswendy"}, "reply_to_user": {"reputation": 2082, "user_id": 474197, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/ZRH5k.png?s=128&g=1", "display_name": "HKTonyLee", "link": "https://stackoverflow.com/users/474197/hktonylee"}, "edited": false, "score": 0, "creation_date": 1475086217, "post_id": 39754109, "comment_id": 66805563, "body": "Yes that was part of the problem! Thank you @HKTonyLee"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475196175, "post_id": 39754109, "comment_id": 66858169, "body": "the <code>-</code> before the <code>g</code> is telling the compiler that the input is to be switched to stdin,  so anything after the <code>-</code> is seen as garbage.  To fix it, remove the space between the <code>-</code> and the <code>g</code>."}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 6347671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1107539829310897/picture?type=large", "display_name": "hiswendy", "link": "https://stackoverflow.com/users/6347671/hiswendy"}, "edited": false, "score": 0, "creation_date": 1475084524, "post_id": 39754178, "comment_id": 66804537, "body": "I tried your input, but I still got an error stating <code>clang: error: -E or -x required when input is from standard input clang: error: no such file or directory: &#39;g&#39;</code>"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 323, "user_id": 6347671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1107539829310897/picture?type=large", "display_name": "hiswendy", "link": "https://stackoverflow.com/users/6347671/hiswendy"}, "edited": false, "score": 0, "creation_date": 1475084611, "post_id": 39754178, "comment_id": 66804599, "body": "@SandraBae You could try rearranging it so that your input file is first, e.g. <code>gcc getit.c ...</code>"}], "tags": [], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "is_accepted": true, "score": 4, "last_activity_date": 1475084733, "last_edit_date": 1475084733, "creation_date": 1475084098, "answer_id": 39754178, "question_id": 39754109, "link": "https://stackoverflow.com/questions/39754109/how-to-compile-c-file-through-terminal/39754178#39754178", "title": "How to compile C file through Terminal", "body": "<p>As far as I know, the W in <code>-Wall</code> and <code>-Werror</code> need to be capitalized. A capital flag and a lowercase flag will have two completely different functions. So you would rewrite it as <code>gcc -Wall -Werror -std=c11 -o getit.out getit.c</code>.</p>\n\n<p>In response to your edit you could also try:</p>\n\n<ol>\n<li>writing <code>getit.c</code> as your first option</li>\n<li>making sure there is no space between <code>-</code> and <code>g</code> (<code>-g</code>)</li>\n<li>removing the <code>-std=c11</code> if it's not absolutely necessary</li>\n</ol>\n\n<p>It seems like you are typing something different than what's shown here. The error messages make it seem like there's a space between <code>-</code> and <code>g</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475084322, "post_id": 39754217, "comment_id": 66804411, "body": "This is the command to compile and link, i.e. to build an executable actually."}], "tags": [], "owner": {"reputation": 160, "user_id": 6581572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYz5H.jpg?s=128&g=1", "display_name": "inan", "link": "https://stackoverflow.com/users/6581572/inan"}, "is_accepted": false, "score": -2, "last_activity_date": 1475088871, "last_edit_date": 1475088871, "creation_date": 1475084195, "answer_id": 39754217, "question_id": 39754109, "link": "https://stackoverflow.com/questions/39754109/how-to-compile-c-file-through-terminal/39754217#39754217", "title": "How to compile C file through Terminal", "body": "<p>please use command as below to compile the C file </p>\n\n<p>gcc - g -Wall -Werror -o getit.out -std=c11 getit.c</p>\n"}, {"tags": [], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "is_accepted": false, "score": 1, "last_activity_date": 1475085551, "last_edit_date": 1592644375, "creation_date": 1475085169, "answer_id": 39754467, "question_id": 39754109, "link": "https://stackoverflow.com/questions/39754109/how-to-compile-c-file-through-terminal/39754467#39754467", "title": "How to compile C file through Terminal", "body": "<blockquote>\n<p>clang: error: unknown argument: '-wall'</p>\n<p>clang: error: unknown argument: '-werror'</p>\n</blockquote>\n<p>The W in -Wall and -Werror need to be capitalized. That explains the above errors showed by <code>gcc</code>.</p>\n<blockquote>\n<p>clang: error: -E or -x required when input is from standard input</p>\n<p>clang: error: no such file or directory: 'g'</p>\n</blockquote>\n<p>This error is due to space character between <code>g</code> flag option and <code>hypen(-)</code>. Remove the space and this error will run away.</p>\n<p>The command to compile your program should be like this:\n<code>gcc -Wall -Werror -std=c11 -o getit.out getit.c -g</code>.</p>\n"}], "owner": {"reputation": 323, "user_id": 6347671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1107539829310897/picture?type=large", "display_name": "hiswendy", "link": "https://stackoverflow.com/users/6347671/hiswendy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 39754178, "answer_count": 3, "score": 2, "last_activity_date": 1475088871, "creation_date": 1475083880, "last_edit_date": 1475084641, "question_id": 39754109, "link": "https://stackoverflow.com/questions/39754109/how-to-compile-c-file-through-terminal", "title": "How to compile C file through Terminal", "body": "<p>I'm trying to compile a C file that I have saved on my computer and I'm trying to compile the file with Terminal on my Mac OS X El Capitan by typing out <code>gcc - g -wall -werror -o getit.out -std=c11 getit.c</code>, but I keep getting this error stating: </p>\n\n<pre><code>    Sandra$ gcc -g -wall -werror -o getit.out -std=c11 getit.c\n    clang: error: unknown argument: '-wall'\n    clang: error: unknown argument: '-werror'\n    clang: error: -E or -x required when input is from standard input\n    clang: error: no such file or directory: 'g'\n</code></pre>\n\n<p>I have downloaded Xcode and installed it, but I'm not sure why I'm getting this error. If anyone could provide insight that would be greatly appreciated. Thank you!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>So as stated by @md xf I tried \n    gcc - g -Wall -Werror -o getit.out -std=c11 getit.c</p>\n\n<p>but I still got an error stating</p>\n\n<pre><code>clang: error: -E or -x required when input is from standard input\nclang: error: no such file or directory: 'g'\n</code></pre>\n\n<p>**Forgot to list all of my errors in my original post</p>\n"}, {"tags": ["c", "linux", "popen"], "comments": [{"owner": {"reputation": 579, "user_id": 3021884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d3f2a581a9269df60e02798d79d5855?s=128&d=identicon&r=PG&f=1", "display_name": "dbndhjefj", "link": "https://stackoverflow.com/users/3021884/dbndhjefj"}, "edited": false, "score": 2, "creation_date": 1475083831, "post_id": 39754045, "comment_id": 66804149, "body": "<code>sprintf(cmdExecute,&quot;%s\\n&quot;, &quot;ls -l&quot;);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475084002, "post_id": 39754045, "comment_id": 66804226, "body": "The only thing I can see is that in <code>bytes += (sizeof(outputCmd)-1);</code> you do not know if that number of bytes were read: that is the size of the buffer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 579, "user_id": 3021884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d3f2a581a9269df60e02798d79d5855?s=128&d=identicon&r=PG&f=1", "display_name": "dbndhjefj", "link": "https://stackoverflow.com/users/3021884/dbndhjefj"}, "edited": false, "score": 4, "creation_date": 1475084299, "post_id": 39754045, "comment_id": 66804395, "body": "Ah, I see.  To clarify what I think @szpal is trying to say, you&#39;re missing a comma in the <code>sprintf()</code> call he points out.  On the other hand, I don&#39;t see why you&#39;re using <code>sprintf()</code> in the first place, instead of <code>strcpy()</code> or just using the string literal directly."}, {"owner": {"reputation": 579, "user_id": 3021884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d3f2a581a9269df60e02798d79d5855?s=128&d=identicon&r=PG&f=1", "display_name": "dbndhjefj", "link": "https://stackoverflow.com/users/3021884/dbndhjefj"}, "edited": false, "score": 0, "creation_date": 1475084507, "post_id": 39754045, "comment_id": 66804523, "body": "Yes John, you are right."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475084661, "post_id": 39754045, "comment_id": 66804630, "body": "You are reading the value of <code>i</code> without ever having set it.  This produces undefined behavior, which <i>could</i> be a segfault, but is much more likely  to be harmless in this case."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1475085435, "post_id": 39754045, "comment_id": 66805062, "body": "I can&#39;t reproduce your segfault, and I don&#39;t see any reason to think that a segfault in <code>fgets()</code> is plausible.  I could, however, believe that the <code>sprintf()</code> discussed above segfaults, because the format given in (the original version of) it contains a field specifier without a corresponding argument."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475085926, "post_id": 39754045, "comment_id": 66805370, "body": "To elaborate on those comments, in C the expression <code>&quot;A&quot; &quot;B&quot;</code> creates a single string <code>&quot;AB&quot;</code>. So the call to <code>sprintf</code> without a comma passes a format string <code>&quot;%s\\nls -l&quot;</code> but no argument for the <code>%s</code> format specifier."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475086290, "post_id": 39754045, "comment_id": 66805596, "body": "And in fact, MSVC issues a compiler warning about this: &quot;not enough arguments passed for format string&quot;. So I hope you have all compiler warnings enabled ;)"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6592429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a37b69c6ccfe6c584d26ab5d3fbf7f?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/6592429/sandeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1475146410, "creation_date": 1475146410, "answer_id": 39768322, "question_id": 39754045, "link": "https://stackoverflow.com/questions/39754045/segmentation-fault-in-fgets-trying-to-run-shell-command-in-c-program/39768322#39768322", "title": "segmentation fault in fgets, trying to run shell command in c program", "body": "<p>I got the solution. I had done a strcat, it was the cause. I increased the size of finalOutputCmd[1000] to 50,000.</p>\n"}], "owner": {"reputation": 21, "user_id": 6592429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a37b69c6ccfe6c584d26ab5d3fbf7f?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/6592429/sandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475146410, "creation_date": 1475083646, "last_edit_date": 1475088334, "question_id": 39754045, "link": "https://stackoverflow.com/questions/39754045/segmentation-fault-in-fgets-trying-to-run-shell-command-in-c-program", "title": "segmentation fault in fgets, trying to run shell command in c program", "body": "<pre><code>dev_list* somefunc()\n{\n    FILE* ExecutionResult;\n    int deviceCount;\n    int deviceIndex[50];\n    char cmdExecute[50],finalOutputCmd[1000],outputCmd[100];\n    int i;\n    int bytes = 0;\n    char* temp = 0;\n    sprintf(cmdExecute,\"%s\\n\" \"ls -l\");\n    printf(\"command = %s\\n\",cmdExecute);\n    ExecutionResult = popen(cmdExecute,\"r\");\n    memset(finalOutputCmd,0,sizeof(finalOutputCmd));\n\n    deviceCount = 0;\n    deviceIndex[deviceCount] = 0;\n    if ( ExecutionResult )\n    {\n        if (fgets(outputCmd, sizeof(outputCmd)-1, ExecutionResult) == NULL)             {\n            printf(\"no bytes read\\n\");\n            bytes += (sizeof(outputCmd)-1);                                 \n        }\n    }\n    printf(\"hello %d,%d\\n\",i,bytes);\n    return  0; //deviceList;\n}\n</code></pre>\n\n<p>why there is seg fault on fgets? I run a shell command inside pipe, whose output is directed in a file. But when I am trying to read back, there is seg fault</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1475083499, "post_id": 39753974, "comment_id": 66803951, "body": "Don&#39;t do <code>fflush(stdin)</code>, it&#39;s an undefined operation to call <code>fflush</code> on input-only streams."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1475083547, "post_id": 39753974, "comment_id": 66803973, "body": "And if you want to read full lines, use <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1475083626, "post_id": 39753974, "comment_id": 66804021, "body": "As for your problem, where is <code>counter</code> defined? Where and how is it initialized or assigned to? Please create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, <b>Complete</b>, and Verifiable Example</a> and show us."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475083647, "post_id": 39753974, "comment_id": 66804031, "body": "When using <code>scanf</code> with the <code>%s</code> format you should not have a <code>&amp;</code> in front of the variable passed as argument."}, {"owner": {"reputation": 1, "user_id": 6895236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dab2b6efc7f67422516dddab55e42d?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/6895236/jim"}, "edited": false, "score": 0, "creation_date": 1475084041, "post_id": 39753974, "comment_id": 66804245, "body": "<a href=\"http://pastebin.com/vvxkxusC\" rel=\"nofollow noreferrer\">pastebin.com/vvxkxusC</a>   here is my actual program at the moment"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475084437, "post_id": 39753974, "comment_id": 66804485, "body": "In your pastebin the line <code>int counter=1;</code> defines a local variable, whose lifetime is only during the function call. At the next call, it is again initialised to <code>1</code>. You could define it as <code>static int counter = 1;</code> But apart from that, the code looks as if it was translated from BASIC with all those <code>goto</code> statements. In a C program they should only be used as a last resort to make a dirty jump from the program&#39;s flow control logic, if at all."}, {"owner": {"reputation": 1, "user_id": 6895236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dab2b6efc7f67422516dddab55e42d?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/6895236/jim"}, "edited": false, "score": 0, "creation_date": 1475084663, "post_id": 39753974, "comment_id": 66804631, "body": "yea i&#39;m still new to programming , anyway thanks guys :D"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1475085838, "post_id": 39753974, "comment_id": 66805320, "body": "Offsite links die. All of your code must be in the question, and you should minimize it so that only what&#39;s needed to reproduce the problem is left."}, {"owner": {"reputation": 1, "user_id": 6895236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dab2b6efc7f67422516dddab55e42d?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/6895236/jim"}, "edited": false, "score": 0, "creation_date": 1475088370, "post_id": 39753974, "comment_id": 66806830, "body": "yea my problem is when i try to view my list in the file handling the id# is only #1 that&#39;s why i want it to increment so basically I want to see in my file handling in each record the id# should be incremented"}, {"owner": {"reputation": 1, "user_id": 6895236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dab2b6efc7f67422516dddab55e42d?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/6895236/jim"}, "edited": false, "score": 0, "creation_date": 1475088570, "post_id": 39753974, "comment_id": 66806948, "body": "here&#39;s my new code (i&#39;m new to programming) <a href=\"http://pastebin.com/WmPh2234\" rel=\"nofollow noreferrer\">pastebin.com/WmPh2234</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1516198373, "creation_date": 1516198373, "answer_id": 48303156, "question_id": 39753974, "link": "https://stackoverflow.com/questions/39753974/how-to-auto-increment-a-number-with-file-handling/48303156#48303156", "title": "how to auto increment a number with file handling", "body": "<p>In your pastebin the line <code>int counter=1;</code> defines a local variable, whose lifetime is only during the function call. At the next call, it is again initialised to <code>1</code>. You could define it as <code>static int counter = 1;</code> \u2026\n                    &ndash;&nbsp;Weather Vane</p>\n"}], "owner": {"reputation": 1, "user_id": 6895236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dab2b6efc7f67422516dddab55e42d?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/6895236/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1281, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516198373, "creation_date": 1475083394, "question_id": 39753974, "link": "https://stackoverflow.com/questions/39753974/how-to-auto-increment-a-number-with-file-handling", "title": "how to auto increment a number with file handling", "body": "<pre><code>            printf(\"\\nID #: %d\",counter++);\n            fflush(stdin);\n            printf(\"\\nEnter Menu Name: \");\n            scanf(\"%[^\\n]s\",&amp;menus.name);\n            fflush(stdin);\n            printf(\"Enter what the menu made of (pork,beef,chicken): \");\n            fflush(stdin);\n            scanf(\"%[^\\n]s\",&amp;menus.make);\n            printf(\"Number of Servings: \");\n            fflush(stdin);\n            scanf(\"%d\",&amp;menus.numserve);\n            fflush(stdin);\n            printf(\"Price: \");\n            scanf(\"%f\",&amp;menus.price);\n            fflush(stdin);\n            fwrite(&amp;menus, 1, sizeof(menus), fp);\n            numofentrees--;\n</code></pre>\n\n<p>my problem is I want to auto generate my ID# so i incremented it, then I want my file handling to read the last number for example I wish to input 2 records then my ID number should generate 1 and 2 then after i fill up the records I wish to generate a record again then my next ID number should be 3 but in my program it would return ID#1 again. can someone explain it to me thanks. i'm using C language</p>\n"}, {"tags": ["c++", "c", "vim", "vim-plugin"], "comments": [{"owner": {"reputation": 29614, "user_id": 15934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66027fd61cc5e638b5d3057859e1be51?s=128&d=identicon&r=PG", "display_name": "Luc Hermitte", "link": "https://stackoverflow.com/users/15934/luc-hermitte"}, "edited": false, "score": 0, "creation_date": 1475085474, "post_id": 39753967, "comment_id": 66805087, "body": "Looks like an error in c.vim. The best is to contact the author or open an issue or the project forge."}, {"owner": {"reputation": 352, "user_id": 6623360, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e8607f3d22e18ba53106c651a564dab0?s=128&d=identicon&r=PG&f=1", "display_name": "aks", "link": "https://stackoverflow.com/users/6623360/aks"}, "reply_to_user": {"reputation": 29614, "user_id": 15934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66027fd61cc5e638b5d3057859e1be51?s=128&d=identicon&r=PG", "display_name": "Luc Hermitte", "link": "https://stackoverflow.com/users/15934/luc-hermitte"}, "edited": false, "score": 0, "creation_date": 1475247016, "post_id": 39753967, "comment_id": 66881572, "body": "@LucHermitte I will do that. Thank you for helping."}, {"owner": {"reputation": 29614, "user_id": 15934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66027fd61cc5e638b5d3057859e1be51?s=128&d=identicon&r=PG", "display_name": "Luc Hermitte", "link": "https://stackoverflow.com/users/15934/luc-hermitte"}, "edited": false, "score": 0, "creation_date": 1475247614, "post_id": 39753967, "comment_id": 66881948, "body": "Sorry I cannot do more (I&#39;m maintaining an alternative solution for C++, and thus I not using c.vim -- I wasn&#39;t even aware they introduced a support for CMake)"}], "answers": [{"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": true, "score": 0, "last_activity_date": 1480582540, "creation_date": 1480582540, "answer_id": 40906241, "question_id": 39753967, "link": "https://stackoverflow.com/questions/39753967/commands-given-for-cmake-and-doxygen-in-vimrc-give-error-on-gvim-start-up/40906241#40906241", "title": "Commands given for cmake and doxygen in _vimrc give error on gvim start up?", "body": "<p><em>(Posted on behalf of the OP)</em>.</p>\n\n<p>I <a href=\"https://github.com/WolfgangMehner/vim-plugins/issues/33\" rel=\"nofollow noreferrer\">opened an issue</a> on C-Support's Github page, and the problem was solved.</p>\n"}], "owner": {"reputation": 352, "user_id": 6623360, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e8607f3d22e18ba53106c651a564dab0?s=128&d=identicon&r=PG&f=1", "display_name": "aks", "link": "https://stackoverflow.com/users/6623360/aks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 40906241, "answer_count": 1, "score": 0, "last_activity_date": 1480582584, "creation_date": 1475083361, "last_edit_date": 1480582584, "question_id": 39753967, "link": "https://stackoverflow.com/questions/39753967/commands-given-for-cmake-and-doxygen-in-vimrc-give-error-on-gvim-start-up", "title": "Commands given for cmake and doxygen in _vimrc give error on gvim start up?", "body": "<p>I am a beginner to vim and just downloaded the c-support plugin (for C/C++ programming) from the following link: <a href=\"http://www.vim.org/scripts/script.php?script_id=213\" rel=\"nofollow noreferrer\">http://www.vim.org/scripts/script.php?script_id=213</a> <a href=\"http://www.vim.org/scripts/script.php?script_id=213\" rel=\"nofollow noreferrer\"></a></p>\n\n<p>As advised in the link, to enable cmake and doxygen, i added the following lines to my _vimrc:</p>\n\n<p><code>let  g:C_UseTool_cmake    = 'yes'\n let  g:C_UseTool_doxygen = 'yes'</code></p>\n\n<p>However, now when I start up gvim, I get the following error message dialog:</p>\n\n<pre><code>Could not load the tool \"cmake\" (Vim(let):E117: Unknown function: mmtoolbox#make#Interface)- occurred at C:\\Users\\Satyendra\\Vim\\vimfiles\\autoload\\mmtoolbox\\cmake.vim, line 219\n</code></pre>\n\n<p>My OS is Windows 10. How do I resolve this error?</p>\n"}, {"tags": ["c++", "c", "makefile"], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 5135639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTG5.png?s=128&g=1", "display_name": "aracyla", "link": "https://stackoverflow.com/users/5135639/aracyla"}, "edited": false, "score": 0, "creation_date": 1475084060, "post_id": 39754027, "comment_id": 66804257, "body": "<code>$(BUILD_DIR)&#47;%.o: %.c $(HEADERS)</code> I did this, but I&#39;m getting the same result. &gt; This was my original rule, but I&#39;ve changed because I saw someone using %.c.o on some site"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 48, "user_id": 5135639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTG5.png?s=128&g=1", "display_name": "aracyla", "link": "https://stackoverflow.com/users/5135639/aracyla"}, "edited": false, "score": 0, "creation_date": 1475087224, "post_id": 39754027, "comment_id": 66806203, "body": "@PescadorParrudo, <code>%.c.o</code> looks like a bogus amalgamation of a pattern rule and a suffix rule.  That &quot;someone used it on some other site&quot; is not much relevant.  It looks like a pattern rule is what you really want, and in that case the appropriate target is almost certainly <code>$(BUILD_DIR)&#47;%.o</code>."}, {"owner": {"reputation": 48, "user_id": 5135639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTG5.png?s=128&g=1", "display_name": "aracyla", "link": "https://stackoverflow.com/users/5135639/aracyla"}, "edited": false, "score": 0, "creation_date": 1475091182, "post_id": 39754027, "comment_id": 66808161, "body": "<code>%.c.o</code> Creates an .o file from .c one(according to manual). I tried this <code>$(BUILD_DIR)&#47;%.o</code>  and got stuck in the same error."}], "tags": [], "owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "is_accepted": false, "score": 1, "last_activity_date": 1475083584, "creation_date": 1475083584, "answer_id": 39754027, "question_id": 39753899, "link": "https://stackoverflow.com/questions/39753899/makefile-implicit-rule-not-working/39754027#39754027", "title": "Makefile implicit rule not working", "body": "<p>Take a hard look at your pattern rule:</p>\n\n<pre><code>$(BUILD_DIR)/%.c.o: %.c $(HEADERS)\n</code></pre>\n\n<p>It matches filenames with a <code>.c.o</code> extension. The error message indicates that you're trying to build <code>build/serial_test.o</code>, which doesn't match the pattern because the path doesn't end in <code>.c.o</code>.</p>\n\n<p>Fix your pattern in your build rule, or your <code>patsubst</code> to replace <code>.c</code> with <code>.c.o</code>, so that the pattern rule will match.</p>\n"}, {"comments": [{"owner": {"reputation": 48, "user_id": 5135639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTG5.png?s=128&g=1", "display_name": "aracyla", "link": "https://stackoverflow.com/users/5135639/aracyla"}, "edited": false, "score": 0, "creation_date": 1475257952, "post_id": 39758582, "comment_id": 66887488, "body": "I&#39;ve used TEST_OBJECTS to get a list of all test objects. Probably this was not the best design for my purpose, but what I were trying to do was a makefile(with two main rules, one for the real project executable and another for the tests). I struggled on the &quot;file tree organization&quot;. If you have any makefile design book(or site) I would appreciate."}, {"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "reply_to_user": {"reputation": 48, "user_id": 5135639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTG5.png?s=128&g=1", "display_name": "aracyla", "link": "https://stackoverflow.com/users/5135639/aracyla"}, "edited": false, "score": 0, "creation_date": 1475276328, "post_id": 39758582, "comment_id": 66894787, "body": "@PescadorParrudo read through the <a href=\"https://www.gnu.org/software/make/manual/\" rel=\"nofollow noreferrer\">manual</a> at least once, the <a href=\"http://make.mad-scientist.net/\" rel=\"nofollow noreferrer\">maintainer</a> also has some good info in the papers and musings section. Beware of make info online or in books, a lot of it is outdated because very few people are using plain make nowadays."}], "tags": [], "owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "is_accepted": true, "score": 1, "last_activity_date": 1475113799, "last_edit_date": 1475113799, "creation_date": 1475101353, "answer_id": 39758582, "question_id": 39753899, "link": "https://stackoverflow.com/questions/39753899/makefile-implicit-rule-not-working/39758582#39758582", "title": "Makefile implicit rule not working", "body": "<ul>\n<li>You're mixing pattern and suffix rules, stick with the pattern rule</li>\n<li>Not entirely sure what you're trying to do with <code>TEST_OBJECTS</code></li>\n<li>You're making every object depend on every header, use dependency generation instead</li>\n<li>The rule for <code>serial_test</code> is broken, <strong>always</strong> use <code>$@</code> as the output of any given rule</li>\n<li>Make the directories a prerequisite</li>\n<li>Recycle the built-in recipes (<code>COMPILE.c</code>, <code>LINK.o</code>)</li>\n</ul>\n\n<pre class=\"lang-none prettyprint-override\"><code>display_string := -Ddisplay_string\n\nsource_dir := src\nheader_dir := src\nbuild_dir  := build\nbin_dir    := bin\n\u00a0\nsources := $(wildcard $(source_dir)/*.c)\nobjects :=\u00a0$(sources:$(source_dir)/%.c=$(build_dir)/%.o)\n\u00a0\ntest_dir    := src/test\ntest_target := serial_test\n\u00a0\ntest_sources := $(wildcard $(test_dir)/*_test.c)\ntest_objects := $(test_sources:$(test_dir)/%.c=$(build_dir)/%.o) $(objects)\n\u00a0\ndeps := $(test_objects:%.o=%.d)\n\nCPPFLAGS := $(display_string) -I$(header_dir) -MMD -MP\n\u00a0 \u00a0 \n$(bin_dir)/serial_test: $(test_objects) | $(bin_dir)\n    $(LINK.o) $^ $(LDLIBS) -o $@\n\u00a0 \u00a0 \n$(build_dir)/%.o: $(source_dir)/%.c | $(build_dir)\n    $(COMPILE.c) $(OUTPUT_OPTION) $&lt;\n\u00a0\n$(build_dir) $(bin_dir): ; mkdir $@\n\u00a0 \u00a0 \nclean: ; $(RM) serial_test $(objects) $(deps)\n\n-include $(deps)\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 5135639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTG5.png?s=128&g=1", "display_name": "aracyla", "link": "https://stackoverflow.com/users/5135639/aracyla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 0, "accepted_answer_id": 39758582, "answer_count": 2, "score": 0, "last_activity_date": 1475113799, "creation_date": 1475083154, "last_edit_date": 1475100903, "question_id": 39753899, "link": "https://stackoverflow.com/questions/39753899/makefile-implicit-rule-not-working", "title": "Makefile implicit rule not working", "body": "<p>I have this makefile and i'm trying to write some test targets</p>\n\n<pre><code>#This a make file of serial communication driver that i'm writing.\n#serial_target would be a target to test this driver isolated.\n\u00a0\nCC = gcc\n\u00a0\nDISPLAY_STRING = -DDISPLAY_STRING\nLFLAGS = \nCFLAGS = $(DISPLAY_STRING) \n\u00a0\n#mains macros\nBUILD_DIR =build\nSOURCE_DIR =src\nHEADER_DIR =src\nBIN_DIR =bin\n\u00a0\nSOURCES = $(wildcard $(SOURCE_DIR)/*.c)\nOBJECTS = \u00a0$(patsubst $(SOURCE_DIR)/%.c, $(BUILD_DIR)/%.o, $(SOURCES))\nHEADERS = \u00a0$(patsubst $(SOURCE_DIR)/%.c, $(HEADER_DIR)/%.h, $(SOURCES))\n\u00a0\n\u00a0\n#serial_tests\nTEST_DIR=src/test\nTEST_TARGET=serial_test\n\u00a0\nTEST_SOURCES = $(wildcard $(TEST_DIR)/*_test.c) \\\n\u00a0 \u00a0 $(SOURCES)\nTEST_OBJECTS = $(filter %.o ,$(patsubst %.c, $(BUILD_DIR)/%.o, $(subst /, , $(TEST_SOURCES))))\nTEST_HEADERS = $(TEST_SOURCES:.c=.h)\n\u00a0\n\u00a0\nall:\n\u00a0 \u00a0 \nserial_test: $(TEST_OBJECTS)\n\u00a0 \u00a0 $(CC) $(CFLAGS) -I$(SOURCE_DIR) -I$(HEADER_DIR) -o $(BIN_DIR)/$@ $^\n\u00a0 \u00a0 \n$(BUILD_DIR)/%.c.o: %.c $(HEADERS)\n\u00a0 \u00a0 $(CC) $(CFLAGS) -I$(HEADER_DIR) -I$(SOURCE_DIR) -c $&lt; -o $@ \u00a0 \u00a0 \n\u00a0\nsetup:\n\u00a0 \u00a0 mkdir $(BUILD_DIR)\n\u00a0 \u00a0 mkdir $(BIN_DIR)\n\u00a0 \u00a0 \nclean:\n\u00a0 \u00a0 rm -rf $(EXEC) $(OBJECTS)\n</code></pre>\n\n<p>When running \"make serial_test\", I'm always getting this:</p>\n\n<pre><code>make: *** No rule to make target `build/serial_test.o', needed by `serial_test'. Stop.\n</code></pre>\n\n<p>Here's the doubt. Why I'm receiving this error if the rule $(BUILD_DIR)/%.c.o exists?</p>\n\n<blockquote>\n  <p>Edit</p>\n</blockquote>\n\n<p>To make sure that everything else was working I've tried this(this works fine)</p>\n\n<pre><code>serial_test: $(TEST_OBJECTS)\n    $(CC) $(CFLAGS) -I$(SOURCE_DIR) -I$(HEADER_DIR) -o $(BIN_DIR)/$@ $^\nbuild/serial_test.o: src/test/serial_test.c\n    $(CC) $(CFLAGS) -I$(HEADER_DIR) -I$(SOURCE_DIR) -c $&lt; -o $@ \nbuild/serialCom_xsens.o: src/serialCom_xsens.c\n    $(CC) $(CFLAGS) -I$(HEADER_DIR) -I$(SOURCE_DIR) -c $&lt; -o $@\n</code></pre>\n\n<p>To make sure that the variable BUILD_DIR was note empty i did this:</p>\n\n<pre><code>$(BUILD_DIR)/serial_test.o: %.c\n    $(CC) $(CFLAGS) -I$(HEADER_DIR) -I$(SOURCE_DIR) -c $&lt; -o $@\n</code></pre>\n\n<p>With this code above, I got another error: </p>\n\n<pre><code>make: *** No rule to make target `%.c', needed by `build/serial_test.o'. Stop.\n</code></pre>\n\n<ul>\n<li><p>Is there any chance of %.c and %.o rules are broken?</p></li>\n<li><p>If you have any design tips just answer. That would be helpful too.</p></li>\n</ul>\n"}, {"tags": ["c", "windows", "batch-file", "compiler-errors"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 2, "creation_date": 1475084568, "post_id": 39753882, "comment_id": 66804567, "body": "Not that it would make any difference but use <code>vcvarsall.bat</code> located under <i>%VSINSTALLDIR%\\VC</i> (that calls <code>vcvars32.bat</code> if no arguments given). Also, you need to be careful about the CPU architecture (it must be consistent across all modules). What is the <i>linker</i> command? Note: <i>Windows SDK</i> is automatically installed by <i>VStudio</i> (btw: what is your version?) or can be also installed separately. I have no reference of <i>%UCRTVersion%</i> in my file (<i>VStudio 10.0</i>)."}, {"owner": {"reputation": 127, "user_id": 3080936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51c5cc476d55a1ca229d8b9a9c3ac141?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy L.", "link": "https://stackoverflow.com/users/3080936/jeremy-l"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1475521122, "post_id": 39753882, "comment_id": 66966673, "body": "I used <code>vcvarsall.bat</code> and as you said it didn&#39;t make a difference. I have Visual Studio Express 14.0. I have not written any of the files that need to be built. They are all included in the SDK downloadable here: <a href=\"https://resources.qtronic.de/fmusdk/FmuSdk_reference.html#installation\" rel=\"nofollow noreferrer\">resources.qtronic.de/fmusdk/FmuSdk_reference.html#installati&zwnj;&#8203;on</a>"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1475844109, "post_id": 39753882, "comment_id": 67119001, "body": "OK, what exactly are you trying to do? There are many pieces of the puzzle that simply don&#39;t connect. There is <i>VStudio</i>, then there is the <i>FMUSDK</i> and <i>libxml2</i> (and probably some other code of your own) that are totally unrelated. <i>vsvars32.bat</i> is not used to build anything, it simply sets some env vars (which will be useful during build time). Please provide a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>, and don&#39;t let us guess what your error might be, and how can it be solved."}], "owner": {"reputation": 127, "user_id": 3080936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51c5cc476d55a1ca229d8b9a9c3ac141?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy L.", "link": "https://stackoverflow.com/users/3080936/jeremy-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475083095, "creation_date": 1475083095, "last_edit_date": 1495540112, "question_id": 39753882, "link": "https://stackoverflow.com/questions/39753882/using-vsvars32-bat-unresolved-external-symbol", "title": "Using vsvars32.bat - Unresolved external symbol", "body": "<p>I am not familiar with C/C++ but I have to use vsvars32.bat to build an executable file. When I run vsvars32.bat i get some <code>unresolved external symbol</code> errors. I did a little bit of research and it seems that they occur because the lib that contains the definition are not included (<a href=\"https://stackoverflow.com/questions/9928238/unresolved-external-symbol-in-object-files\">Unresolved external symbol in object files</a>).</p>\n\n<p>Here is a one of the error:\n<code>libxml2.lib(error.obj) : error LNK2001: unresolved external symbol ___iob_func</code></p>\n\n<p>I was provided the <code>libxml2.lib</code> file. I'm guessing that I'm getting this error because I need to copy it someplace where <code>vsvars32.bat</code> will look for it. I've been looking through the <code>vsvars32.bat</code> file and it looks like there's three libraries that are defined:</p>\n\n<ul>\n<li>Windows SDK (<code>%WindowsSdkDir%</code>)</li>\n<li>NETFXSDK (<code>%NETFXSDKDir%</code>)</li>\n<li>UCRTVersion (<code>%UCRTVersion%</code>)</li>\n</ul>\n\n<p>I was able to locate the NETFXSDK library folders on my machine but not the two others. I also noticed that I don't have any system variables named <code>WindowsSdkDir</code>, <code>NETFXSDKDir</code> or <code>UCRTVersion</code>. Is there something else that I should install or run? Am I on the totally wrong track?</p>\n"}, {"tags": ["c++", "c", "linux"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1475082787, "post_id": 39753735, "comment_id": 66803582, "body": "In short: No, its not possible."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1475083105, "post_id": 39753735, "comment_id": 66803744, "body": "In theory it is possible to mangle both libraries together in a single library, but practically there are no tools to do so. But this is completely irrelevant. Determining how a shared library is linked is not a big mystery. It is trivial to determine to which libraries a particular shared libraries is linked with. Either the shared library is linked with another library, or it&#39;s not. There is no vague, indeterminate, intermediate state. It should be possible to answer this question in no more than a few seconds."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1475664777, "post_id": 39753735, "comment_id": 67030594, "body": "Run the application in whatever debugger you use, you should get diagnostic messages telling you which libraries are being loaded in what order."}], "owner": {"reputation": 61, "user_id": 3510717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1c677f7080d2eb53c9eb36efdd374d1?s=128&d=identicon&r=PG&f=1", "display_name": "poloDD", "link": "https://stackoverflow.com/users/3510717/polodd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475082579, "creation_date": 1475082579, "question_id": 39753735, "link": "https://stackoverflow.com/questions/39753735/how-to-link-library-from-dynamic-to-static-without-binary-source-code", "title": "How to link library from dynamic to static without binary source code?", "body": "<p>I want to know if it's possible for a library linked dynamically to another library to make this link static without the library's source code, so without any possibility of library's recompilation.</p>\n\n<p>I suspect a library, linked dynamically to my application, not loading one of its own dynamically linked library properly, or too late, while the application is running, resulting in troubles. </p>\n\n<p>That's why I want to make the link static. </p>\n\n<p>I was thinking also to make the library causing troubles to link (static or dynamic) directly to the application. But the library would be linked twice. Sounds not good for me. </p>\n"}, {"tags": ["c", "gcc", "assembly", "inline-assembly"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1475082608, "post_id": 39753703, "comment_id": 66803497, "body": "Either reuse variables, or create tables (arrays) and use offsets into these arrays to get variables (inserted into the assembly code by your compiler)."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1475082890, "post_id": 39753703, "comment_id": 66803632, "body": "Consider emitting proper assembly instead of inline assembly. gcc has a limit of 30 operands for inline assembly and it is not planned to remove that limit."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 6, "creation_date": 1475083033, "post_id": 39753703, "comment_id": 66803708, "body": "Wouldn&#39;t generating C code be much easier and simpler to debug? And why don&#39;t you directly generate an Assmbler file? No offence, but that intermediate C stage looks much like nonsense to me."}, {"owner": {"reputation": 561, "user_id": 2127148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd1d9bdaa1feee2fd77396057fb8f10?s=128&d=identicon&r=PG", "display_name": "Johan Bj&#228;reholt", "link": "https://stackoverflow.com/users/2127148/johan-bj%c3%a4reholt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475083690, "post_id": 39753703, "comment_id": 66804068, "body": "@Olaf I would love to just write plain assembler because I don&#39;t see the use for the inline assembler honestly, but sadly it&#39;s a university assignment and to get a B I have to do it with a single inline asm statement."}, {"owner": {"reputation": 561, "user_id": 2127148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd1d9bdaa1feee2fd77396057fb8f10?s=128&d=identicon&r=PG", "display_name": "Johan Bj&#228;reholt", "link": "https://stackoverflow.com/users/2127148/johan-bj%c3%a4reholt"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475083737, "post_id": 39753703, "comment_id": 66804096, "body": "@JoachimPileborg Thanks for the suggestion, didn&#39;t think of that. While its just a workaround rather than a solution I&#39;ll do that if i don&#39;t come up with anything else."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1475084207, "post_id": 39753703, "comment_id": 66804336, "body": "@JohanBj&#228;reholt: Another nonsense constraint far from reality. Recommendation: switch course or university. You can cite me: Your tutor seems to have no idea about compilers. (I&#39;d understand compiling to C, though)"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 3, "creation_date": 1475084267, "post_id": 39753703, "comment_id": 66804375, "body": "I believe your input/output <code>&quot;+g&quot;</code> operands count as two operands. You should be able to make the <code>_s#</code> operands input-only operands and the rest output-only early-clobber <code>&quot;&amp;g&quot;</code> operands. You can refer to <code>io_read</code>. <code>io_write</code> and <code>print</code> directly in your assembly without using <code>asm</code> operands, though you&#39;ll have to find out whether your platform expects <code>_print</code> or <code>print</code>."}, {"owner": {"reputation": 561, "user_id": 2127148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd1d9bdaa1feee2fd77396057fb8f10?s=128&d=identicon&r=PG", "display_name": "Johan Bj&#228;reholt", "link": "https://stackoverflow.com/users/2127148/johan-bj%c3%a4reholt"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1475086015, "post_id": 39753703, "comment_id": 66805428, "body": "@RossRidge Thanks alot, that is incredibly useful. Didn&#39;t know that +g counted as two operands. With these optimizations i should hopefully be able to most things i had planned to do."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1475307771, "post_id": 39756695, "comment_id": 66900170, "body": "<code>&quot;=g&quot;</code> is write only.  <code>&quot;g&quot;</code> is read-only.  IDK why you want to output inline-asm at all.  That seems like a horrible idea.  Just output pure C, or pure asm (into a <code>.s</code> which defines <code>main</code>).  Making function calls from inside inline asm isn&#39;t even safe, because you can&#39;t tell gcc that you want to clobber the red-zone.  Taking function-pointers as inputs to your inline-asm is really horrible, since you get a register or memory-indirect call through an actual function pointer."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1476395857, "post_id": 39756695, "comment_id": 67340576, "body": "You&#39;re still leaving out any mention of <code>&quot;=m&quot;</code> or <code>&quot;=g&quot;</code>, which is what you should be using when the output is write-only.  I&#39;d recommend using as many +/=/<code>g</code> operands as gcc will allow, and +/=/<code>m</code> for the rest, since forcing everything to the stack will make garbage asm.  (Although if you already clobber all the registers and do register allocation yourself, which I guess you&#39;d have to since you need to avoid producing <code>addl mem, mem</code> or whatever, everything will be on the stack anyway, except immediate constants.  So you should still use <code>g</code> for inputs, to allow immediates.)"}], "tags": [], "owner": {"reputation": 561, "user_id": 2127148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd1d9bdaa1feee2fd77396057fb8f10?s=128&d=identicon&r=PG", "display_name": "Johan Bj&#228;reholt", "link": "https://stackoverflow.com/users/2127148/johan-bj%c3%a4reholt"}, "is_accepted": true, "score": 2, "last_activity_date": 1476393405, "last_edit_date": 1495542797, "creation_date": 1475093040, "answer_id": 39756695, "question_id": 39753703, "link": "https://stackoverflow.com/questions/39753703/how-to-prevent-error-more-than-30-operands-in-asm-with-inline-assesmbly-with/39756695#39756695", "title": "How to prevent error &quot;more than 30 operands in &#39;asm&#39;&quot; with inline assesmbly with gcc", "body": "<p>So I didn't find a direct solution to the issue, but thanks to <a href=\"https://stackoverflow.com/users/3826372/ross-ridge\">Ross Ridge</a> I was able to work around the issue pretty well.</p>\n\n<p>The first imrovement i did was changing \"+g\" with \"g\" where possible. Apparently \"+g\" counts as two operands because it allows both read+write so I replaced the onces possible with \"g\" which only allows write.</p>\n\n<p>Also, I was able to completely remove my functions as operands by moving them to a global scope and then calling then directly with \"call print\" instead of \"call %[print]\". It should be noted however that this only work with inline C and will not work with inline C++.</p>\n\n<p>If you are writing a compiler like me I would recommend staying away from inline assembly though. Seems like more trouble, simply calling C functions manually from Assembler would be easier, and I would certainly not make a compiler on a bigger scale with inline C.</p>\n\n<p>EDIT: I started forcing \"m\" and \"+m\" also instead of using \"g\" and force variables onto the stack which seems to work fine.</p>\n"}], "owner": {"reputation": 561, "user_id": 2127148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcd1d9bdaa1feee2fd77396057fb8f10?s=128&d=identicon&r=PG", "display_name": "Johan Bj&#228;reholt", "link": "https://stackoverflow.com/users/2127148/johan-bj%c3%a4reholt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 39756695, "answer_count": 1, "score": 1, "last_activity_date": 1476393405, "creation_date": 1475082465, "question_id": 39753703, "link": "https://stackoverflow.com/questions/39753703/how-to-prevent-error-more-than-30-operands-in-asm-with-inline-assesmbly-with", "title": "How to prevent error &quot;more than 30 operands in &#39;asm&#39;&quot; with inline assesmbly with gcc", "body": "<p>I have been writing a minimal lua compiler for educational purposes by translating the lua code to inline assembly in C with gcc.</p>\n\n<p>After a while when my generated output started to become longer with more operands for declared variables and functions in C, this error started to occur.</p>\n\n<pre><code>test.c: In function \u2018int main()\u2019:\ntest.c:100:6: error: more than 30 operands in \u2018asm\u2019\n     );\n</code></pre>\n\n<p>When googling the only other info i found was <a href=\"https://gcc.gnu.org/ml/gcc-help/2008-03/msg00109.html\" rel=\"nofollow\">some gcc mailing list from 2008</a>, but they said that there were no fixes except for recompiling gcc (which I am not interested in).</p>\n\n<p>The ironic thing is that often I don't even have 30 operands and I still get this error!</p>\n\n<p>Here's an minimal example (with 19 operands, still gives me that error)</p>\n\n<pre><code>// Standard functions\nvoid io_read(){}\nvoid io_write(){}\nvoid print(){}\nint main(){\n    // Working vars decl\n    long _t0, _t1, _t2, _t3, _t4, _t5, _t6, _t7, _t8;\n    long factorial, i, n, x;\n    // Strings decl\n    const char* _s0 = \"enter a number:\";\n    const char* _s1 = \"*number\";\n    const char* _s2 = \"factorial of \";\n    const char* _s3 = \" is \";\n    asm(\"\" // My inline asm code\n    : // Output symbols\n      [_s0] \"+g\" (_s0),\n      [_s1] \"+g\" (_s1),\n      [_s2] \"+g\" (_s2),\n      [_s3] \"+g\" (_s3),\n      [_t0] \"+g\" (_t0),\n      [_t1] \"+g\" (_t1),\n      [_t3] \"+g\" (_t3),\n      [_t4] \"+g\" (_t4),\n      [_t5] \"+g\" (_t5),\n      [_t6] \"+g\" (_t6),\n      [_t7] \"+g\" (_t7),\n      [_t8] \"+g\" (_t8),\n      [factorial] \"+g\" (factorial),\n      [i] \"+g\" (i),\n      [n] \"+g\" (n),\n      [x] \"+g\" (x)\n    : // Input symbols\n      [io_read] \"r\" (io_read),\n      [io_write] \"r\" (io_write),\n      [print] \"r\" (print)\n    : // Clobbers\n      \"cc\", \"rax\", \"rbx\", \"rcx\", \"rdx\"\n    );\n}\n</code></pre>\n\n<p>My gcc version is 6.2.1 20160830</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "memory", "memory-management"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1475081222, "post_id": 39753265, "comment_id": 66802717, "body": "Just because you release the memory doesn&#39;t mean the kernel will unmap the pages from your process. The virtual memory will be marked as free though, and can be reused when and if needed."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1475081497, "post_id": 39753265, "comment_id": 66802880, "body": "Try <code>pmap -x &lt;pid&gt;</code> and see whether there are unexpected memory mappings. It also shows you which mappings contribute to RSS."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475081634, "post_id": 39753265, "comment_id": 66802968, "body": "@JoachimPileborg malloc_stats() is showing the memory as free. (the &quot;system bytes&quot; minus the &quot;in use bytes&quot; should be the free memory. You have to look at every Arena and see the difference.  Arena 1 and 2 are holding on to 2GB more memory than what is used."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1475081895, "post_id": 39753265, "comment_id": 66803127, "body": "Well it&#39;s actually impossible for us to do anything but guess, since we have no idea what&#39;s happening in your code. The only one who has all the information needed to debug this issue is you. First of all try to minimize the code to the barest minimum to cause such a problem, use memory debuggers such as <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a> but also step through the code with an ordinary debugger. That&#39;s all the advice I can give you."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475082547, "post_id": 39753265, "comment_id": 66803474, "body": "@JoachimPileborg I manually counted all the RES memory from <code>pmap -x &lt;pid&gt;</code> and the total kB (at the bottom) says 5466224 and my calculator says 2120980.  Something is wrong."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475083947, "post_id": 39753265, "comment_id": 66804198, "body": "Sounds strange. Post complete <code>pmap -x &lt;pid&gt;</code> output."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475084056, "post_id": 39753265, "comment_id": 66804253, "body": "Can you perhaps modify your code to use <a href=\"http://man7.org/linux/man-pages/man3/mallinfo.3.html\" rel=\"nofollow noreferrer\">the <code>mallinfo</code> function</a> instead? Of special interest would be the <code>arena</code>, <code>uordblks</code> and <code>fordblks</code> members of the <code>mallinfo</code> structure. For example, does <code>uordblks + fordblks</code> equal <code>arena</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1475084183, "post_id": 39753265, "comment_id": 66804325, "body": "&quot;I think this version of malloc has a huge bug.&quot; That&#39;s not what <i>usually</i> happens."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475084282, "post_id": 39753265, "comment_id": 66804387, "body": "@MaximEgorushkin the output is too large for StackOverflow <a href=\"http://pastebin.com/BDyRzi5P\" rel=\"nofollow noreferrer\">pastebin.com/BDyRzi5P</a>"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1475084913, "post_id": 39753265, "comment_id": 66804773, "body": "@JohnnyV Your manual calculations are incorrect, the numbers correctly add up to total. Try <code>grep -v total ~&#47;Downloads&#47;BDyRzi5P.txt | awk &#39;$4 ~ &#47;[0-9]+&#47; {n += $4} END {print n}&#39; </code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1475085691, "post_id": 39753265, "comment_id": 66805232, "body": "If all else fails, try <code>mtrace()</code>  and see if you can spot some unaccounted-for allocations."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475087537, "post_id": 39753265, "comment_id": 66806373, "body": "@JoachimPileborg post was updated; I&#39;m even more confused now."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1475087575, "post_id": 39753265, "comment_id": 66806389, "body": "The memory allocator is in <code>glibc</code> and is standard across all distros. It has a lot of mileage on it, so it is unlikely to be buggy. Your allocations could be fragmenting memory. You could be leaking memory. You could use <code>mtrace</code>, write your own <code>malloc</code> hook functions, or call wrappers (e.g. change all calls to <code>malloc</code> to <code>mytrace_malloc</code>--this can be done with CPP macros, so no source edits, or using <code>LD_PRELOAD</code>). Consider <code>mcheck</code>. java okay [sort of], but JNI? Consider faking I/O so program runs 100x faster to get to error state in a minute instead of an hour. Post your code!?"}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475087910, "post_id": 39753265, "comment_id": 66806567, "body": "@CraigEstey - that is an understandable position.  I just updated the post with the info from <code>mallinfo</code> and the numbers don&#39;t add up.  The per-arena system bytes is much much larger than what malloc thinks is the total amount of allocated memory.  I&#39;ve seen this behavior come and go as Ubuntu is updated."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475089987, "post_id": 39753265, "comment_id": 66807646, "body": "As I suspected, it seems that the C library memory allocation system keeps (caches?) memory pages. Exactly what&#39;s going on here I don&#39;t know since I don&#39;t know the internals of the allocator. But it seems the pages are kept internally by the allocator as &quot;bytes in free blocks&quot;. It also seems that if and when the memory needs to be reclaimed the allocator releases those pages (going by your description). I&#39;d say it&#39;s nothing to worry about, and that it works as expected."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475090160, "post_id": 39753265, "comment_id": 66807703, "body": "@JoachimPileborg What do you think about the huge difference between the reported total values and that of the values inside of each arena?  It is my understanding the arena system used is supposed to equal the total system used.  I think that malloc is failing to free memory from the arenas."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475090248, "post_id": 39753265, "comment_id": 66807730, "body": "I&#39;m familiar with your issues. I&#39;ve written allocators from scratch. I&#39;ve also done what I&#39;ve suggested to track leaks and frags. If you get variance update-to-update, it might be your program has UB, but you get &quot;lucky&quot; on given revs. Consider writing your own hooks. Have the hooks do <code>mallinfo</code> and/or <code>malloc_stats</code> [you can divert <code>stderr</code> to grab its output] on each call. Does an arena creep up slowly or does one alloc cause a huge jump? The hook could log the <code>caller</code> to identify the culprit."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1475090755, "post_id": 39753265, "comment_id": 66807964, "body": "Try <code>malloc_trim(0)</code> and see whether that releases memory to the OS."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475091207, "post_id": 39753265, "comment_id": 66808177, "body": "<code>malloc</code> will only release memory from the arena if the arena is 100% unused [AFAIK] and only when it feels like it [needs to]. It uses anonymous <code>mmap</code> to get a new area from the OS. The reverse is an <code>munmap</code>. If an arena is created with (e.g.) 1MB, and only 20 bytes are used, it can&#39;t unmap a partial area."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475091311, "post_id": 39753265, "comment_id": 66808236, "body": "Also, IIRC, the kernel does anon mmap by mapping all pages to the R/O zero page. Only when a process writes to a page, generating a protection fault, does the kernel break the many-to-one mapping and assign a unique page [and restarts the write]. See my answer: <a href=\"http://stackoverflow.com/questions/37172740/how-does-mmap-improve-file-reading-speed/37173063#37173063\" title=\"how does mmap improve file reading speed\">stackoverflow.com/questions/37172740/&hellip;</a> and also the answers linked there for more details."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1475092663, "post_id": 39753265, "comment_id": 66809000, "body": "@MaximEgorushkin \t @CraigEstey   <code>malloc_trim(0)</code> actually frees all the memory.  this is bizzare."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1475092758, "post_id": 39753265, "comment_id": 66809054, "body": "I downloaded your test program, but it&#39;s missing the <code>net.emoten.*</code>. But, just because your program frees all its allocations doesn&#39;t help. In java, <i>any</i> variable is heap allocated by the JVM (e.g. <code>Field field</code> in <code>loadUnsafe</code>) via <code>malloc</code>. This is also subject to the whims of the JVM&#39;s GC. So, declaring <i>any</i> variable could hold an arena because the GC hasn&#39;t collected it. Or, if the GC did, it make keep its own reuse pool (i.e. doesn&#39;t call free) and only periodically do <code>free</code>. If your test pgm is absolute minimum, then rewrite it in 100% C and see what you get."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475092860, "post_id": 39753265, "comment_id": 66809105, "body": "@CraigEstey Just remove the dep for <code>net.emoten.*</code> and the rest should be portable.  Otherwise I have to send you the jar.  The Oracle JVM does not pool any memory called via Unsafe.  It is a raw pass through for malloc and free."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475092922, "post_id": 39753265, "comment_id": 66809146, "body": "If <code>malloc_trim</code> works, then <code>malloc</code> is fine, doing its job, nothing to worry about. Remember when I said &quot;only when it feels like it&quot;. Normally true, but that&#39;s <code>malloc_trim</code> is for--to tell <code>malloc</code> to &quot;feel like it&quot; now!"}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475093157, "post_id": 39753265, "comment_id": 66809284, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/124465/discussion-between-johnny-v-and-craig-estey\">continue this discussion in chat</a>."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1475097161, "post_id": 39753265, "comment_id": 66811499, "body": "Ugh, in the test code, where do you imagine jvm is getting memory for the array that you grow and shrink inbetwixt your indirect malloc calls? And what if random returns zero?"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1475097165, "post_id": 39753265, "comment_id": 66811500, "body": "<b>Does your application create many threads?</b> The thread stacks will contribute to the VM footprint size. By default they are two megabytes each, or something like that. A thousand threads and that&#39;s two gigabytes."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1475097621, "post_id": 39753265, "comment_id": 66811720, "body": "@kfsone  The jvm is pulling from the eden space of the heap.  The entire committed heap was 245MB.  You can tell the exact size of the used and unused heap as well as committed memory so the jvm isn&#39;t a contributing factor.  I&#39;m also using Unsafe for some kind of portability instead of my bypass.  Check the chat for the answer."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1475097652, "post_id": 39753265, "comment_id": 66811738, "body": "@Kaz Only 4 threads were utilizing memory.  Check the chat"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1475105509, "post_id": 39753265, "comment_id": 66814360, "body": "Use <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a> to check against memory leaks"}], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475093419, "post_id": 39756745, "comment_id": 66809405, "body": "The problem right now is that <code>malloc</code> reports that a small amount of memory can be released via <code>malloc_trim</code> however several gigabytes is actually released.  This leads me to believe that the counter is broken somehow and the automatic call to <code>malloc_trim</code> is not working."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475141573, "post_id": 39756745, "comment_id": 66827698, "body": "@JohnnyV <i>malloc reports that a small amount of memory can be released</i> - how does it report that?"}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475149962, "post_id": 39756745, "comment_id": 66833368, "body": "<code>mallinfo..keepcost</code> tells you how much free memory is at the top of the heap.  However, <code>malloc_trim</code> does a lot more than release just the memory listed in <code>keepcost</code>.  Craig will post a better explanation."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475150756, "post_id": 39756745, "comment_id": 66833965, "body": "@JohnnyV Craig&#39;s explanation is longer but it also boils down to <i><code>free</code> does not promise to return the freed memory to the OS</i>. This is all there is to it."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475255256, "post_id": 39756745, "comment_id": 66886049, "body": "Something of note: <code>MMPAP_THRESHOLD</code> is a very interesting parameter for <code>malloc</code> because all allocations above that value will be fully returned to the kernel upon <code>free</code>"}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475256268, "post_id": 39756745, "comment_id": 66886598, "body": "It seems like <code>free</code> doesn&#39;t even necessarily return empty pages to the kernel either.  The only time its guaranteed is if it is above the <code>M_MMAP_THRESHOLD</code>"}, {"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "reply_to_user": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 1, "creation_date": 1487272458, "post_id": 39756745, "comment_id": 71721950, "body": "@JohnnyV, malloc_trim has undocumented feature since 2007 (glibc 2.9) to <code>madvise(..MADV_DONTNEED)</code> for every free page inside the heap (in the middle. This is not documented by glibc authors (and not accounted in malloc info/stats) and not documented by author of man page malloc_trim, check <a href=\"http://stackoverflow.com/questions/28612438/can-malloc-trim-release-memory-from-the-middle-of-the-heap/42273711\" title=\"can malloc trim release memory from the middle of the heap\">stackoverflow.com/questions/28612438/&hellip;</a>. And yes, there <b>are no any automatic calls to malloc_trim</b> in glibc malloc/malloc, it is only comment &quot;When malloc_trim is called automatically from free&quot;."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1475151435, "last_edit_date": 1475151435, "creation_date": 1475093227, "answer_id": 39756745, "question_id": 39753265, "link": "https://stackoverflow.com/questions/39753265/malloc-is-using-10x-the-amount-of-memory-necessary/39756745#39756745", "title": "Malloc is using 10x the amount of memory necessary", "body": "<p><code>free</code> does not promise to return the freed memory to the OS. </p>\n\n<p>What you observe is the freed memory is kept in the process for possible reuse. More than that, <code>free</code> releasing memory to the OS can pose a performance problem when allocation and deallocation of large chunks happen frequently.  This is why there is an option to return the memory to the OS explicitly with <code>malloc_trim</code>.</p>\n\n<p>Try <code>malloc_trim(0)</code> and see if that reduces the RSS. This function is non-standard, so its behaviour is implementation specific, it might not do anything at all. You mentioned in the comments that calling it did reduce RSS.</p>\n\n<p>You may like to make sure that there are no memory leaks and memory corruption before you start digging deeper.</p>\n\n<hr>\n\n<p>With regards to <code>keepcost</code> member, see <code>man mallinfo</code>:</p>\n\n<blockquote>\n  <p><strong>BUGS</strong></p>\n  \n  <p><strong>Information is returned for  only  the  main  memory  allocation  area.\n         Allocations in other arenas are excluded.</strong>  See malloc_stats(3) and malloc_info(3) for alternatives that include information about other  arenas.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475143914, "post_id": 39761864, "comment_id": 66829370, "body": "<i>If free is called, it probably calls <code>munmap</code></i> - more like it does not because it is not required to."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475150513, "post_id": 39761864, "comment_id": 66833789, "body": "Why would the kernel move a page to disk if it was released?"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1475170920, "post_id": 39761864, "comment_id": 66847687, "body": "@MaximEgorushkin It&#39;s it the <code>glibc</code> source [which I had been looking at when I was writing the answer]. If the chunk was mmap&#39;ed, <code>free</code> <i>immediately</i> calls <code>munmap</code>. It only does the more traditional chunk combine/split for the <code>sbrk</code> allocated chunks"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475171088, "post_id": 39761864, "comment_id": 66847807, "body": "@CraigEstey Interesting. There would not be this question if it did unmap it for the OP..."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475177161, "post_id": 39761864, "comment_id": 66851209, "body": "@MaximEgorushkin OP&#39;s JNI allocs (65k) are small enough to use <code>sbrk</code>. <code>malloc</code> first tries to fill a request from existing areas, consolidating as possible/needed [huge amount of code for this]. If malloc needs to ask system for memory: An alloc of &gt;1MB is <code>mmap</code> if number of already mmap&#39;ed areas is below a threshold. Otherwise, it uses <code>sbrk</code>. But, if <code>sbrk</code> fails for some reason it falls back to <code>mmap</code>. <code>malloc</code>"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475178340, "post_id": 39761864, "comment_id": 66851828, "body": "@MaximEgorushkin To get a better baseline, OP may want to call <code>malloc_trim</code> after the JVM is &quot;up and running&quot;, and has done some GC to minimize its effects. The stats could be large because JVM is holding the memory, or it&#39;s released into malloc free areas but not back to kernel. Then, monitor <code>malloc_stats</code>, etc. during JNI allocs. Rather than use <code>malloc_trim</code> everywhere, the &quot;autotrim&quot; threshold can be set with <code>mallopt</code>"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475178733, "post_id": 39761864, "comment_id": 66852037, "body": "The kernel doesn&#39;t page to disk if it doesn&#39;t have to. Only &quot;dirty&quot; pages [pages modified, but not yet written to the &quot;backing store&quot;]. If a page is unmapped, it can just be discarded/reused <i>if</i> the backing store is the paging disk. If the backing store is a <i>file</i> [e.g. mmap to a file for writing], an unmap <i>must</i> write this page out before marking the page as reusable."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475179825, "post_id": 39761864, "comment_id": 66852566, "body": "That pmap result shows that those 64kB allocations are made with mmap."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475189502, "post_id": 39761864, "comment_id": 66856430, "body": "@MaximEgorushkin OP said 65k not 64k [so, typo or not?] I was reading from the glibc comments re. the 1MB. I just did an actual test program. <code>mmap</code> kicks in for allocations &gt;128KB. I&#39;m using glibc 2.21 [fc22], and this matches the manpage for <code>mallopt</code> and the <code>M_MMAP_THRESHOLD</code> default value. So, it seems somebody (JVM?) may be setting a different threshold."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475255737, "post_id": 39761864, "comment_id": 66886291, "body": "@CraigEstey Are we no longer sure that <code>mallinfo</code> reserved and free values are correct?  The situation in the question was one where there was significantly more memory allocated than what even <code>malloc</code> thought was."}, {"owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "edited": false, "score": 0, "creation_date": 1475256020, "post_id": 39761864, "comment_id": 66886453, "body": "If I set <code>M_MMAP_THRESHOLD</code> to a small value then the allocations will be immediately freed.  Right now I&#39;m setting it to 128K; I only added the ability to set that parameter yesterday.  The JVM starts with only 187MB in RSS."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 7, "last_activity_date": 1475125843, "creation_date": 1475125843, "answer_id": 39761864, "question_id": 39753265, "link": "https://stackoverflow.com/questions/39753265/malloc-is-using-10x-the-amount-of-memory-necessary/39761864#39761864", "title": "Malloc is using 10x the amount of memory necessary", "body": "<p>The full details can be a bit complex, so I'll try to simplify things as much as I can. Also, this is a rough outline and may be slightly inaccurate in places.</p>\n\n<hr>\n\n<p><strong>Requesting memory from the kernel</strong></p>\n\n<p><code>malloc</code> uses either <code>sbrk</code> or anonymous <code>mmap</code> to request a <em>contiguous</em> memory area from the kernel. Each area will be a multiple of the machine's page size, typically 4096 bytes. Such a memory area is called an <em>arena</em> in <code>malloc</code> terminology. More on that below.</p>\n\n<p>Any pages so mapped become part of the process's <em>virtual</em> address space. However, even though they have been mapped in, they may not be backed up by a <em>physical</em> RAM page [yet]. They are mapped [many-to-one] to the single \"zero\" page in R/O mode.</p>\n\n<p>When the process tries to write to such a page, it incurs a protection fault, the kernel breaks the mapping to the zero page, allocates a real physical page, remaps to it, and the process is restarted at the fault point. This time the write succeeds. This is similar to demand paging to/from the paging disk.</p>\n\n<p>In other words, page <em>mapping</em> in a process's virtual address space is <em>different</em> than page <em>residency</em> in a physical RAM page/slot. More on this later.</p>\n\n<hr>\n\n<p><strong>RSS (resident set size)</strong></p>\n\n<p>RSS is not really a measure of how much memory a process allocates or frees, but how many pages in its virtual address space have a physical page in RAM at the present time.</p>\n\n<p>If the system has a paging disk of 128GB, but only had (e.g.) 4GB of RAM, a process RSS could never exceed 4GB. The process's RSS goes up/down based upon paging in or paging out pages in its virtual address space.</p>\n\n<p>So, because of the zero page mapping at start, a process RSS may be much lower than the amount of virtual memory it has requested from the system. Also, if another process B \"steals\" a page slot from a given process A, the RSS for A goes down and goes up for B.</p>\n\n<p>The process \"working set\" is the minimum number of pages the kernel must keep resident for the process to prevent the process from excessively page faulting to get a physical memory page, based on some measure of \"excessively\". Each OS has its own ideas about this and it's usually a tunable parameter on a system-wide or per-process basis.</p>\n\n<p>If a process allocates a 3GB array, but only accesses the first 10MB of it, it will have a lower working set than if it randomly/scattershot accessed all parts of the array.</p>\n\n<p>That is, if the RSS is higher [or <em>can</em> be higher] than the working set, the process will run well. If the RSS is below the working set, the process will page fault excessively. This can be either because it has poor \"locality of reference\" or because other events in the system conspire to \"steal\" the process's page slots.</p>\n\n<hr>\n\n<p><strong>malloc and arenas</strong></p>\n\n<p>To cut down on fragmentation, <code>malloc</code> uses multiple arenas. Each arena has a \"preferred\" allocation size (aka \"chunk\" size). That is, smaller requests like <code>malloc(32)</code> come from (e.g.) arena A, but larger requests like <code>malloc(1024 * 1024)</code> come from a different arena (e.g.) arena B.</p>\n\n<p>This prevents a small allocation from \"burning\" the first 32 bytes of the last available chunk in arena B, making it too short to satisfy the next <code>malloc(1M)</code></p>\n\n<p>Of course, we can't have a separate arena for each requested size, so the \"preferred\" chunk sizes are typically some power of 2.</p>\n\n<p>When creating a new arena for a given chunk size, <code>malloc</code> doesn't just request an area of the chunk size, but some multiple of it. It does this so it can quickly satisfy subsequent requests of the same size without having to do an <code>mmap</code> for each one. Since the minimum size is 4096, arena A will have 4096/32 chunks or 128 chunks available.</p>\n\n<hr>\n\n<p><strong>free and munmap</strong></p>\n\n<p>When an application does a <code>free(ptr)</code> [<code>ptr</code> represents a chunk], the chunk is marked as available. <code>free</code> could choose to combine contiguous chunks that are free/available at that time or <em>not</em>.</p>\n\n<p>If the chunk is small enough, it does nothing more (i.e.) the chunk is available for reallocation, but, <code>free</code> does <em>not</em> try to release the chunk back to the kernel. For larger allocations, <code>free</code> will [try to] do <code>munmap</code> immediately.</p>\n\n<p><code>munmap</code> can unmap a single page [or even a small number of bytes], even if comes in the middle of an area that was multiple pages long. If so, the application now has a \"hole\" in the mapping.</p>\n\n<hr>\n\n<p><strong>malloc_trim and madvise</strong></p>\n\n<p>If <code>free</code> is called, it probably calls <code>munmap</code>. If an entire page has been unmapped, the RSS of the process (e.g. A) goes down.</p>\n\n<p>But, consider chunks that are still allocated, or chunks that were marked as free/available but were not unmapped.</p>\n\n<p>They are still part of the process A's RSS. If another process (e.g. B) starts doing lots of allocations, the system may have to page out some of process A's slots to the paging disk [reducing A's RSS] to make room for B [whose RSS goes up].</p>\n\n<p>But, if there is <em>no</em> process B to steal A's page slots, process A's RSS can remain high. Say process A allocated 100MB, used it a while back, but is only actively using 1MB now, the RSS will remain at 100MB.</p>\n\n<p>That's because without the \"interference\" from process B, the kernel had <em>no</em> reason to steal any page slots from A, so they \"remain on the books\" in the RSS.</p>\n\n<p>To tell the kernel that a memory area is not likely to be used soon, we need the <code>madvise</code> syscall with <code>MADV_WONTNEED</code>. This tells the kernel that the memory area is low priority and it should [more] aggressively page it out to the paging disk, thereby reducing the process's RSS.</p>\n\n<p>The pages <em>remain</em> mapped in the process's virtual address space, but get farmed out to the paging disk. Remember, page <em>mapping</em> is <em>different</em> than page <em>residency</em>.</p>\n\n<p>If the process accesses the page again, it incurs a page fault and the kernel will pull in the data from paging disk to a physical RAM slot and remap. The RSS goes back up. Classical demand paging.</p>\n\n<p><code>madvise</code> is what <code>malloc_trim</code> uses to reduce the RSS of the process.</p>\n"}], "owner": {"reputation": 690, "user_id": 6686490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1d7df5b32d64a4e83d268fb9c94cb8?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny V", "link": "https://stackoverflow.com/users/6686490/johnny-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1926, "favorite_count": 3, "accepted_answer_id": 39761864, "answer_count": 2, "score": 5, "last_activity_date": 1476475472, "creation_date": 1475081068, "last_edit_date": 1476475472, "question_id": 39753265, "link": "https://stackoverflow.com/questions/39753265/malloc-is-using-10x-the-amount-of-memory-necessary", "title": "Malloc is using 10x the amount of memory necessary", "body": "<p>I have a network application which allocates predicable 65k chunks as part of the IO subsystem.  The memory usage is tracked atomically within the system so I know how much memory I'm actually using.  This number can also be checked against malloc_stats()</p>\n\n<p>Result of <code>malloc_stats()</code></p>\n\n<pre><code>Arena 0:\nsystem bytes     =    1617920\nin use bytes     =    1007840\nArena 1:\nsystem bytes     = 2391826432\nin use bytes     =  247265696\nArena 2:\nsystem bytes     = 2696175616\nin use bytes     =  279997648\nArena 3:\nsystem bytes     =    6180864\nin use bytes     =    6113920\nArena 4:\nsystem bytes     =   16199680\nin use bytes     =     699552\nArena 5:\nsystem bytes     =   22151168\nin use bytes     =     899440\nArena 6:\nsystem bytes     =    8765440\nin use bytes     =     910736\nArena 7:\nsystem bytes     =   16445440\nin use bytes     =   11785872\nTotal (incl. mmap):\nsystem bytes     =  935473152\nin use bytes     =  619758592\nmax mmap regions =         32\nmax mmap bytes   =   72957952\n</code></pre>\n\n<p><strong>Items to note:</strong></p>\n\n<ul>\n<li>The <code>total in use bytes</code> is completely correct number according to my internal counter.  However, the application has a RES (from top/htop) of 5.2GB.  The allocations are almost always 65k; I don't understand the huge amount of fragmentation/waste I am seeing even more so when mmap comes into play.</li>\n<li><code>total system bytes</code> does not equal to the sum of <code>system bytes</code> in each Arena.</li>\n<li>I'm on Ubuntu 16.04 using glibc 2.23-0ubuntu3</li>\n<li>Arena 1 and 2 account for the large RES value the kernel is reporting.</li>\n<li>Arena 1 and 2 are holding on to 10x the amount of memory that is used.</li>\n<li>The mass majority of allocations are ALWAYS 65k (explicit multiple of the page size)</li>\n</ul>\n\n<p>How do I keep malloc for allocating an absurd amount of memory?</p>\n\n<p>I think this version of malloc has a huge bug.  Eventually (after an hour) a little more than half of the memory will be released.  This isn't a fatal bug but it is definitely a problem.</p>\n\n<p><strong>UPDATE - I added <code>mallinfo</code> and re-ran the test - the app is no longer processing anything at the time this was captured.  No network connections are attached. It is idle.</strong></p>\n\n<pre><code>Arena 2:\nsystem bytes     = 2548473856\nin use bytes     =    3088112\nArena 3:\nsystem bytes     = 3288600576\nin use bytes     =    6706544\nArena 4:\nsystem bytes     =   16183296\nin use bytes     =     914672\nArena 5:\nsystem bytes     =   24027136\nin use bytes     =     911760\nArena 6:\nsystem bytes     =   15110144\nin use bytes     =     643168\nArena 7:\nsystem bytes     =   16621568\nin use bytes     =   11968016\nTotal (incl. mmap):\nsystem bytes     = 1688858624\nin use bytes     =   98154448\nmax mmap regions =         32\nmax mmap bytes   =   73338880\narena (total amount of memory allocated other than mmap)                 = 1617780736\nordblks (number of ordinary non-fastbin free blocks)                     =       1854\nsmblks (number of fastbin free blocks)                                   =         21\nhblks (number of blocks currently allocated using mmap)                  =         31\nhblkhd (number of bytes in blocks currently allocated using mmap)        =   71077888\nusmblks (highwater mark for allocated space)                             =          0\nfsmblks (total number of bytes in fastbin free blocks)                   =       1280\nuordblks (total number of bytes used by in-use allocations)              =   27076560\nfordblks (total number of bytes in free blocks)                          = 1590704176\nkeepcost (total amount of releaseable free space at the top of the heap) =     439216\n</code></pre>\n\n<p><strong>My hypothesis is as follows:</strong> The difference between the <code>total system bytes</code> reported by <code>malloc</code> is much less than the amount reported in each <code>arena</code>. (1.6Gb vs 6.1GB)  This could mean that (A) <code>malloc</code> is actually releasing blocks but the arena doesn't or (B) that <code>malloc</code> is not compacting memory allocations at all and it is creating huge amount of fragmentation.</p>\n\n<p><strong>UPDATE</strong> Ubuntu released a kernel update which basically fixed everything as described in this post.  That said, there is a lot of good information in here on how malloc works with the kernel.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1475080167, "post_id": 39752944, "comment_id": 66802052, "body": "What didn&#39;t work? The commented code seems OK. Except to the fact that you won&#39;t be able to <code>free</code> it afterwars, as you loose the original pointer. So you&#39;ll have to save it before incrementing."}, {"owner": {"reputation": 984, "user_id": 6641516, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b__FzxzSmgU/AAAAAAAAAAI/AAAAAAAABqE/zRhjNLBdLQE/photo.jpg?sz=128", "display_name": "Derick Alangi", "link": "https://stackoverflow.com/users/6641516/derick-alangi"}, "edited": false, "score": 0, "creation_date": 1475080197, "post_id": 39752944, "comment_id": 66802068, "body": "do <code>while(*(frase + i))</code> and <code>toupper(*(frase + i))</code>. Change those to the ones I have written and try again :)"}, {"owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "edited": false, "score": 0, "creation_date": 1475080991, "post_id": 39752944, "comment_id": 66802566, "body": "Eugene, with the commented code i was getting lot of crashs and my pc restarting, probably due to bad memory manage or something..."}, {"owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "edited": false, "score": 0, "creation_date": 1475081034, "post_id": 39752944, "comment_id": 66802602, "body": "i ill try d3r1ck and give the feedback, thanks"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475081406, "post_id": 39752944, "comment_id": 66802824, "body": "Have you read the part about <code>free</code>?"}, {"owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "edited": false, "score": 0, "creation_date": 1475082345, "post_id": 39752944, "comment_id": 66803373, "body": "Yeah, now i understand what i did wrong and how bad memory management can be a trouble. I tried MD XF and Paul Ogilvie code&#39;s together and it work. Also d3r1ck code worked too. Thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "edited": false, "score": 0, "creation_date": 1475082468, "post_id": 39753211, "comment_id": 66803433, "body": "I agree that free is a problem, but my main problem was my while being a infinite loop until my pc crash... Anyway its solved now, thanks!"}], "tags": [], "owner": {"reputation": 256, "user_id": 6874831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WprAb.jpg?s=128&g=1", "display_name": "P.Bra", "link": "https://stackoverflow.com/users/6874831/p-bra"}, "is_accepted": false, "score": 3, "last_activity_date": 1475082210, "last_edit_date": 1475082210, "creation_date": 1475080899, "answer_id": 39753211, "question_id": 39752944, "link": "https://stackoverflow.com/questions/39752944/pointer-as-index-of-one-array-c/39753211#39753211", "title": "Pointer as index of one array - C", "body": "<p>The problem is that you free a pointer which has changed (indeed, <code>frase</code> has been incremented using <code>frase++</code>)\nthen <code>free(frase)</code> does not work.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "edited": false, "score": 0, "creation_date": 1475082591, "post_id": 39753218, "comment_id": 66803490, "body": "I used ur code within MD XF logic:  while(*pfrase) , toupper(*pfrase) and *pfrase++, and its working well. Thanks!"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 3, "last_activity_date": 1475086799, "last_edit_date": 1475086799, "creation_date": 1475080924, "answer_id": 39753218, "question_id": 39752944, "link": "https://stackoverflow.com/questions/39752944/pointer-as-index-of-one-array-c/39753218#39753218", "title": "Pointer as index of one array - C", "body": "<p>By using \"pointers only\" you point to an element, process it and then increment the pointer to point to the next element:</p>\n\n<pre><code>char *pfrase = frase;\nwhile(pfrase){\n    printf(\"%c\", toupper(pfrase));\n    pfrase++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1475082000, "creation_date": 1475082000, "answer_id": 39753554, "question_id": 39752944, "link": "https://stackoverflow.com/questions/39752944/pointer-as-index-of-one-array-c/39753554#39753554", "title": "Pointer as index of one array - C", "body": "<p>The value of the argument passed to <code>free</code> must be a pointer that was returned by one of the <code>malloc</code> family of functions. If a different value is passed to <code>free</code>, the program has undefined behavior.</p>\n\n<p>When you use:</p>\n\n<pre><code>frase = malloc(sizeof(char) * 100);\n\ngets(frase);\n\nwhile(*frase != '\\0'){\n   printf(\"%c\", *frase);\n   frase++;\n}\n\nfree(frase);\n</code></pre>\n\n<p>You are calling <code>free</code> using a pointer whose value is different than the value returned by <code>malloc</code>. That is cause for undefined behavior.</p>\n\n<p>One way to resolve this is what you have already done -- use an index to access the array.</p>\n\n<p>Another way to resolve this is to use a different variable to iterate over the contents of the array.</p>\n\n<pre><code>frase = malloc(sizeof(char) * 100);\n\ngets(frase);\n\n// Don't modify frase. Use another variable to iterate\nchar* cp = frase;\nwhile(*cp != '\\0'){\n   printf(\"%c\", *cp);\n   cp++;\n}\n\nfree(frase);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1475083619, "post_id": 39753886, "comment_id": 66804019, "body": "Ai!!! You can&#39;t free <code>pointer</code> because it was pointing to <code>frase</code>, and you <code>freed</code> <code>frase</code> already! - Remove the <code>free(pointer);</code>"}, {"owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1475083819, "post_id": 39753886, "comment_id": 66804139, "body": "hmmm, now i see it. Thanks!"}], "tags": [], "owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "is_accepted": false, "score": -1, "last_activity_date": 1475083109, "creation_date": 1475083109, "answer_id": 39753886, "question_id": 39752944, "link": "https://stackoverflow.com/questions/39752944/pointer-as-index-of-one-array-c/39753886#39753886", "title": "Pointer as index of one array - C", "body": "<p>With everyone responses, my algorithm is working now. Here is what its now:</p>\n\n<pre><code>      #include &lt;stdlib.h&gt;\n      #include &lt;stdio.h&gt;\n      #include &lt;ctype.h&gt;\n\n      int main(){\n\n           char* frase;\n           frase = malloc(sizeof(char) * 100);\n\n           gets(frase);\n\n           char* pointer = frase;\n           while(*pointer){\n                printf(\"%c\", toupper(*pointer));\n                *pointer++;\n                }\n\n\n           printf(\"\\n\");\n           free(frase);\n           free(pointer);\n           }\n</code></pre>\n\n<p>Both the problem of dont edit my \"frase\" array and the useless free problem seems to be solved. Also, i know about the gets problem, but this algorithm is for a exercise. Thanks everyone for the help!</p>\n"}], "owner": {"reputation": 19, "user_id": 6894954, "user_type": "registered", "profile_image": "https://graph.facebook.com/644736029023752/picture?type=large", "display_name": "Willian Santos", "link": "https://stackoverflow.com/users/6894954/willian-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1475087283, "creation_date": 1475080029, "last_edit_date": 1475087283, "question_id": 39752944, "link": "https://stackoverflow.com/questions/39752944/pointer-as-index-of-one-array-c", "title": "Pointer as index of one array - C", "body": "<p>I'm having trouble to make the following algorithm work without index (with index it works). It's a small exercise for my university, and one of the requirements is that I can only use \"pointer reference\" to walk through my allocated array (frase), not index. What I've tried last to make it work is commented, and I give up because anything I try doesn't work... Thanks for the help.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(){\n    char* frase;\n    frase = malloc(sizeof(char) * 100);\n\n    gets(frase);\n\n    /*\n    while(*frase != '\\0'){\n        printf(\"%c\", *frase);\n        frase++;\n    }\n    */\n    int i = 0;\n    while(frase[i]){\n        printf(\"%c\", toupper(frase[i]));\n        i++;\n    }\n\n    printf(\"\\n\");\n    free(frase);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "mac-address", "ioctl"], "comments": [{"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1475078893, "post_id": 39752504, "comment_id": 66801203, "body": "what kernel version ?"}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1475079323, "post_id": 39752504, "comment_id": 66801480, "body": "<a href=\"https://forums.gentoo.org/viewtopic-t-907162-start-0.html\" rel=\"nofollow noreferrer\">forums.gentoo.org/viewtopic-t-907162-start-0.html</a> may help"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 2, "creation_date": 1475079419, "post_id": 39752504, "comment_id": 66801540, "body": "take the interface down before changing the MAC address and back up after"}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475079882, "post_id": 39752504, "comment_id": 66801860, "body": "@tofro according to the link I posted above that&#39;s probably correct, but it&#39;s odd (i.e. probably a driver bug) that the change apparently succeeds and yet still returns <code>-ENFILE</code>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1475080518, "post_id": 39752504, "comment_id": 66802272, "body": "As a sanity check, do you get the same behavior if you put <code>errno = 0;</code> immediately before the <code>if(ioctl(sockfd, SIOCSIFHWADDR, &amp;ifr) &lt; 0)</code> line?"}, {"owner": {"reputation": 51, "user_id": 6367862, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-cZrfR6tyOAI/AAAAAAAAAAI/AAAAAAAAABo/gGj7CQco464/photo.jpg?sz=128", "display_name": "Kenneth Goveas", "link": "https://stackoverflow.com/users/6367862/kenneth-goveas"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1475403533, "post_id": 39752504, "comment_id": 66922457, "body": "@zwol I tried <code>errno = 0;</code> before the <code>ioctl</code> but the problem persists."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1475413945, "post_id": 39752504, "comment_id": 66924834, "body": "Then this is definitely a bug in the kernel.  System calls aren&#39;t supposed to succeed and yet return an error code."}], "owner": {"reputation": 51, "user_id": 6367862, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-cZrfR6tyOAI/AAAAAAAAAAI/AAAAAAAAABo/gGj7CQco464/photo.jpg?sz=128", "display_name": "Kenneth Goveas", "link": "https://stackoverflow.com/users/6367862/kenneth-goveas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475078646, "creation_date": 1475078646, "question_id": 39752504, "link": "https://stackoverflow.com/questions/39752504/ioctl-succeeds-in-changing-mac-address-but-returns-error", "title": "Ioctl succeeds in changing MAC address but returns error", "body": "<p>I'm trying to write a c program to change the MAC address of the wireless interface ('<code>wlp2s0</code>' on my system). The call to <code>ioctl</code> successfully changes the MAC address (which I verified using <code>ifconfig</code>) but returns an error (Too many open files). The following is my program</p>\n\n<pre><code>int main(void)\n{\n    struct ifreq ifr;\n    int sockfd;\n\n    bzero(ifr.ifr_name, IFNAMSIZ);\n    strcpy(ifr.ifr_name, \"wlp2s0\");\n\n    printf(\"Type in new MAC address here: \");\n    scanf(\"%hhx:%hhx:%hhx:%hhx:%hhx:%hhx\",\n           &amp;ifr.ifr_hwaddr.sa_data[0],\n           &amp;ifr.ifr_hwaddr.sa_data[1],\n           &amp;ifr.ifr_hwaddr.sa_data[2],\n           &amp;ifr.ifr_hwaddr.sa_data[3],\n           &amp;ifr.ifr_hwaddr.sa_data[4],\n           &amp;ifr.ifr_hwaddr.sa_data[5]\n    );\n\n    ifr.ifr_hwaddr.sa_family = ARPHRD_ETHER;\n\n    sockfd = socket(AF_INET, SOCK_DGRAM, 0);\n    if(sockfd &lt; 0)\n    {\n           perror(\"socket: Failed to open socket\");\n           exit(1);\n    }\n\n    if(ioctl(sockfd, SIOCSIFHWADDR, &amp;ifr) &lt; 0)\n    {\n           perror(\"ioctl: Failed to change MAC address\");\n           exit(2);\n    }\n\n    close(sockfd);\n\n    return 0;\n}\n</code></pre>\n\n<p>When I execute this program, I get the following error:</p>\n\n<pre><code>ioctl: Failed to change MAC address: Too many open files in system\n</code></pre>\n\n<p>But <code>ifconfig</code> shows that the MAC address has successfully been changed. Why then, am I getting this error?</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1475078647, "post_id": 39752475, "comment_id": 66801036, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475078729, "post_id": 39752475, "comment_id": 66801081, "body": "You should first read and then check for eof. Not the other way around as you  do in your loop..."}, {"owner": {"reputation": 11, "user_id": 6315535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Qhy.png?s=128&g=1", "display_name": "D.B.", "link": "https://stackoverflow.com/users/6315535/d-b"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1475078814, "post_id": 39752475, "comment_id": 66801146, "body": "Thanks, @PaulR. The thing is I used the debugger on this program, and it doesn&#39;t complain about seg faults. So I&#39;m not sure where the problem happens."}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 0, "creation_date": 1475078838, "post_id": 39752475, "comment_id": 66801168, "body": "One thing to keep it mind is that <code>malloc</code> does not initialize memory. If you rely on empty trie child pointers being <code>NULL</code>, you need to initialize the structure yourself (I&#39;m referring in the second call of <code>malloc</code>)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475078868, "post_id": 39752475, "comment_id": 66801191, "body": "You are testing for <code>EOF</code> in the wrong place, and the <code>for</code>  loop does not use the <code>i</code>. I suggest replacing those few lines with <code>int ch; while((ch = fgetc(inptr)) != EOF ) { if (ch != &#39;\\n&#39;) ... }</code>"}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 0, "creation_date": 1475078885, "post_id": 39752475, "comment_id": 66801193, "body": "<i>So I&#39;m not sure where the problem happens</i> - learn to use valgrind, it should help."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1475078922, "post_id": 39752475, "comment_id": 66801216, "body": "<code>return 2;</code> The function was defined as returning <code>bool</code>."}, {"owner": {"reputation": 11, "user_id": 6315535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Qhy.png?s=128&g=1", "display_name": "D.B.", "link": "https://stackoverflow.com/users/6315535/d-b"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475079105, "post_id": 39752475, "comment_id": 66801335, "body": "@EugeneSh. Ok, so this declaration is faulty: for (int i = 0, ch = 1; ch != EOF; i++), specifically the ch != EOF. Then I should put the if condition on ch = EOF inside the loop itself. I see some suggestion on replacing the for loop with a while"}, {"owner": {"reputation": 11, "user_id": 6315535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Qhy.png?s=128&g=1", "display_name": "D.B.", "link": "https://stackoverflow.com/users/6315535/d-b"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475079161, "post_id": 39752475, "comment_id": 66801372, "body": "@WeatherVane, won&#39;t the loop condition advance the cursor prematurely and skip the first character?"}, {"owner": {"reputation": 11, "user_id": 6315535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Qhy.png?s=128&g=1", "display_name": "D.B.", "link": "https://stackoverflow.com/users/6315535/d-b"}, "reply_to_user": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 0, "creation_date": 1475079352, "post_id": 39752475, "comment_id": 66801503, "body": "@kfx, this part of code is being stored in a library and is called upon by a different program, it doesn&#39;t have a main function, so valgrind can be executed only on the main program, and shows that all is good (I hope this lengthy explanation makes sense)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475079643, "post_id": 39752475, "comment_id": 66801694, "body": "Your favorite debugger is your friend."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1475079990, "post_id": 39752475, "comment_id": 66801930, "body": "You could replace <code>if (ch != &#39;\\n&#39;)</code> with <code>if (ch != &#39;\\n&#39; &amp;&amp; ch != EOF)</code>, which should work even if the newline is missing at the end of the file."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475080407, "post_id": 39752475, "comment_id": 66802210, "body": "@D.B. no the first character will not be skipped. You can easily check out things like this with a bit of gash code that prints out the known contents of a small file. Once you have successfully extracted all (and only) the words in the file, then you can think about the trie."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475082656, "post_id": 39752475, "comment_id": 66803520, "body": "Re your update: remove the second line of the <code>while</code> loop <code>ch = fgetc(inptr);</code> entirely. Its functionality has moved into the <code>while</code> statement, and is causing <i>two</i> characters to be read in each iteration."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1475086801, "post_id": 39752475, "comment_id": 66805969, "body": "From your code, it seems the input file strictly contains single words per line. Are you not allowed to read words?"}, {"owner": {"reputation": 11, "user_id": 6315535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Qhy.png?s=128&g=1", "display_name": "D.B.", "link": "https://stackoverflow.com/users/6315535/d-b"}, "reply_to_user": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1475095702, "post_id": 39752475, "comment_id": 66810750, "body": "@alvits, yes, the file has 1 word per line. I can also read words, but need to use either a trie or a hash structure to load the dictionary. I went with the trie where I store 1 character in each node at a time."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6315535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Qhy.png?s=128&g=1", "display_name": "D.B.", "link": "https://stackoverflow.com/users/6315535/d-b"}, "is_accepted": false, "score": -1, "last_activity_date": 1475086764, "creation_date": 1475086764, "answer_id": 39754911, "question_id": 39752475, "link": "https://stackoverflow.com/questions/39752475/segmentation-fault-when-loading-words-from-txt-file-to-a-trie-if-last-line-is-e/39754911#39754911", "title": "Segmentation fault when loading words from txt file to a trie, if last line is empty", "body": "<p>Thanks to the great help and support from the community, I have fixed the code and it now works as excepted. The loop is now as follows:</p>\n\n<pre><code>    //go thru each character in the file until end of file \n    while((ch = fgetc(inptr)) != EOF) \n    {\n\n        // if the character is a letter or an apostrophe \n        if (ch != '\\n')\n        {\n            //if the pointer for the character doesn't exist (equals NULL) allocate memory\n            if (current-&gt;letters[tolower(ch) - 'a'] == NULL)\n            {\n                current-&gt;letters[tolower(ch) - 'a'] = (struct trie*)malloc(sizeof(trie));\n            }\n            //move forward in our trie structure\n                current = current-&gt;letters[tolower(ch) - 'a'];\n        } \n\n        //if the character read indicates the end of the line\n        else \n        {\n            //indicate that this is a word in our dictionary in the trie\n            current-&gt;is_word = true;\n            //reset our current node to the beginning of the trie\n            current = head;\n            //count number of words loaded in the dictionary\n            words++;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6315535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Qhy.png?s=128&g=1", "display_name": "D.B.", "link": "https://stackoverflow.com/users/6315535/d-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475086764, "creation_date": 1475078556, "last_edit_date": 1475085879, "question_id": 39752475, "link": "https://stackoverflow.com/questions/39752475/segmentation-fault-when-loading-words-from-txt-file-to-a-trie-if-last-line-is-e", "title": "Segmentation fault when loading words from txt file to a trie, if last line is empty", "body": "<p>UPDATED (see below)</p>\n\n<p>I work on a CS50 problem set to load a dictionary of words from a text file to a trie structure. My code results in either: </p>\n\n<p>1) segmentation fault, when last line of the text file is empty, like:</p>\n\n<ol>\n<li>cat </li>\n<li>zoo</li>\n<li>zoom</li>\n<li>rite</li>\n<li></li>\n</ol>\n\n<p>or 2) last word is not loaded to the trie, when it's the last line of the text file:</p>\n\n<ol>\n<li>cat </li>\n<li>zoo</li>\n<li>zoom</li>\n<li>rite</li>\n</ol>\n\n<p>Here is the code I use to load the words to the trie:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include \"dictionary.h\"\n\n// declaring trie structure\ntypedef struct trie\n{\n    bool is_word;\n    struct trie* letters[27];\n} trie;\n\n//root node\ntrie* head; \n\n//global variable will be used to count words loaded into trie\nint words;\n\n/**\n * Loads dictionary into memory.  Returns true if successful else false.\n */\nbool load(const char* dictionary)\n{\n\n    // set global words variable to 0 before the count starts\n    words = 0;\n\n    //declaring first node of the trie and pointing in to NULL\n    head = (struct trie*)malloc(sizeof(trie));\n\n    //set all root node pointers to null\n    for (int i = 0; i &lt; 27; i++)\n    {\n        head-&gt;letters[i] = NULL;\n    }\n\n    // open dictionary file \n    FILE* inptr = fopen(dictionary, \"r\");\n    if (inptr == NULL)\n    {\n        printf(\"Could not open %s.\\n\", dictionary);\n        return 2;\n    }\n\n    //declare new trie to jump thru characters\n    trie* current = head;\n\n    //go thru each character in the file until end of file \n    for (int i = 0, ch = 1; ch != EOF; i++)\n    {\n        //read the current character from file\n        ch = fgetc(inptr);\n\n        // if the character is a letter or an apostrophe \n        if (ch != '\\n')\n        {\n            //if the pointer for the character doesn't exist (equals NULL) allocate memory\n            if (current-&gt;letters[tolower(ch) - 'a'] == NULL)\n            {\n                current-&gt;letters[tolower(ch) - 'a'] = (struct trie*)malloc(sizeof(trie));\n            }\n            //move forward in our trie structure\n            current = current-&gt;letters[tolower(ch) - 'a'];\n        } \n\n        //if the character read indicates the end of the line\n        else \n        {\n            //indicate that this is a word in our dictionary in the trie\n            current-&gt;is_word = true;\n            //reset our current node to the beginning of the trie\n            current = head;\n            //count number of words loaded in the dictionary\n            words++;\n        }\n    }\n\n    printf (\"%i words loaded to the dictionary\\n\", words);\n\n    // close infile\n    fclose(inptr);\n\n    return true;\n}\n</code></pre>\n\n<p>I guess the issue is with the way EOF and fgetc != '\\n' conditions are used. </p>\n\n<p>How can I indicate to the trie that is the word ends with EOF it's still a word AND avoid the seg fault, if EOF is on a new line?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Trying it with a while loop instead (here below). Finally don't have a seg fault in the case (1) as described above. But the last word is not written into the trie regardless of whether the last line is empty or not.\nPlus, the very first letter of the first word is not written since there's a double call to fgetc function at the beginning of the loop. </p>\n\n<p>Will continue to work with the debugger and the loop declaration. I'm welcoming more suggestions.</p>\n\n<pre><code>//go thru each character in the file until end of file \nwhile((ch = fgetc(inptr)) != EOF) \n{\n    //read the current character from file\n    ch = fgetc(inptr);\n\n    // if the character is a letter or an apostrophe \n    if (ch != '\\n')\n    {\n        //if the pointer for the character doesn't exist (equals NULL) allocate memory\n        if (current-&gt;letters[tolower(ch) - 'a'] == NULL)\n        {\n            current-&gt;letters[tolower(ch) - 'a'] = (struct trie*)malloc(sizeof(trie));\n        }\n        //move forward in our trie structure\n        current = current-&gt;letters[tolower(ch) - 'a'];\n    } \n\n    //if the character read indicates the end of the line\n    else \n    {\n        //indicate that this is a word in our dictionary in the trie\n        current-&gt;is_word = true;\n        //reset our current node to the beginning of the trie\n        current = head;\n        //count number of words loaded in the dictionary\n        words++;\n    }\n}\n</code></pre>\n\n<p>P.S. I'm still learning, don't judge me.</p>\n"}, {"tags": ["c", "pointers", "null", "initialization", "variable-assignment"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1475078274, "post_id": 39752362, "comment_id": 66800770, "body": "You can&#39;t just assign a variable outside of a function, when it is not a part of the initialization."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1475086361, "post_id": 39752362, "comment_id": 66805646, "body": "Note that all global variables are zero-initialized, there&#39;s no point in reinitializing them to zero like you do."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 7, "last_activity_date": 1475079440, "last_edit_date": 1475079440, "creation_date": 1475078576, "answer_id": 39752481, "question_id": 39752362, "link": "https://stackoverflow.com/questions/39752362/why-i-cannot-break-the-value-assignment-into-two-different-statements/39752481#39752481", "title": "Why I cannot break the value assignment into two different statements?", "body": "<p>In the first case, </p>\n\n<pre><code> node *root = NULL;\n</code></pre>\n\n<p>is an <strong><a href=\"https://en.wikipedia.org/wiki/Initialization_(programming)\" rel=\"nofollow\">initialization</a></strong> while declaration. That is explicitly allowed in global scope.</p>\n\n<p>On the other hand,</p>\n\n<pre><code>node *root;\nroot = NULL;\n</code></pre>\n\n<p>is a declaration <strong>and</strong> an <strong><a href=\"https://en.wikipedia.org/wiki/Assignment_(computer_science)\" rel=\"nofollow\">assignment</a></strong>, the later being a statement to be executed, it has to be in some function scope. It cannot reside in global scope.</p>\n\n<p>Thus, in your case, <code>root</code> being a global variable, is perfectly accessible from <code>main()</code> and the assignment statement is also legal there. No complains.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5806421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 39752481, "answer_count": 1, "score": 1, "last_activity_date": 1475079440, "creation_date": 1475078188, "last_edit_date": 1475079291, "question_id": 39752362, "link": "https://stackoverflow.com/questions/39752362/why-i-cannot-break-the-value-assignment-into-two-different-statements", "title": "Why I cannot break the value assignment into two different statements?", "body": "<pre><code>   #inlude &lt;stdio.h&gt;\n   typedef struct node\n   {\n     int data, height, count;\n     struct node *left, *right, *father;\n   }node;\n   node *root = NULL;\n   void main(){\n   //some code here\n   }\n</code></pre>\n\n<p>Above code gives no error, but</p>\n\n<pre><code>  #inlude &lt;stdio.h&gt;\n   typedef struct node\n   {\n     int data, height, count;\n     struct node *left, *right, *father;\n   }node;\n   node *root;\n   root = NULL;\n   void main(){\n   //some code here\n   }\n</code></pre>\n\n<p>this produces the following error:</p>\n\n<pre><code>sample.c:11:1: error: conflicting types for 'root' \nsample.c: 10:7 note: previous declaration of 'root' was here \nnode *root; \n      ^\n</code></pre>\n\n<p>The above error is not reproduced when the statement </p>\n\n<pre><code>root = NULL;\n</code></pre>\n\n<p>is declared within <code>main function</code></p>\n\n<p>What could be the reason?</p>\n"}, {"tags": ["c", "quickselect"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1475078094, "post_id": 39752166, "comment_id": 66800647, "body": "BTW, did you realize that you are calling <code>qselect</code> in a loop? Is that the intent?"}, {"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 0, "creation_date": 1475078405, "post_id": 39752166, "comment_id": 66800871, "body": "What did your debugger tell you about the segmentation fault? If you didn&#39;t use a debugger on the above code, you should have done so before asking here."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1475078456, "post_id": 39752166, "comment_id": 66800898, "body": "The only place you use <code>range</code> is the final <code>for</code> loop. Everywhere else you&#39;re using the defined constant <code>N</code> which is 194. You either need to use <code>N</code> everywhere, or <code>range</code> everywhere."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1475078587, "post_id": 39752166, "comment_id": 66800995, "body": "It will certainly go wrong if <code>range</code> is greater than <code>N</code>."}], "owner": {"reputation": 1, "user_id": 6894649, "user_type": "registered", "profile_image": "https://graph.facebook.com/1162089067183849/picture?type=large", "display_name": "Oscar Cerna", "link": "https://stackoverflow.com/users/6894649/oscar-cerna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475078713, "creation_date": 1475077630, "last_edit_date": 1475078214, "question_id": 39752166, "link": "https://stackoverflow.com/questions/39752166/ordering-floats-read-from-file-with-quick-select-give-segmentation-fault", "title": "Ordering floats read from file with quick select give segmentation fault", "body": "<p>I have to use quick select to sort and write the first N elements of an array and write them on a text.</p>\n\n<p>The problem is with the input file and the quantity of data I try to read from it.</p>\n\n<p>I use a constant, N, to define the max quantity of number I want to read from the file, but so far it only reads and sorts up to 194 elements from the file. I <em>should</em> be able to do it with 10 million, however.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;limits.h&gt;\n#define N 194\n\nfloat qselect(float *array,int ini, int fin, int k){\n    int i;\n    int st = ini;\n    float tmp;\n\n    //finding a pivot\n    for (i = 0; i &lt; fin - 1; i++) {\n      if (array[i] &lt; array[fin-1]) {\n\n        tmp = array[st];\n        array[st] = array[i];\n        array[i] = tmp;\n        st++;\n      }\n    }\n    //exchanging the pivot with the last element of the array\n    tmp = array[fin-1];\n    array[fin-1] = array[st];\n    array[st] = tmp;\n\n    //veryfing the pivot\n    if (k == st)\n        return array[st];\n    else if (st&gt;k)\n        return qselect(array,ini,st,k);//search on the left\n    else\n        return qselect(array,ini+st,fin,k);//search on the right \n}\nint main(void)\n{\n    FILE *input;\n    FILE *output;\n    int range;\n    //opening the files\n    input = fopen(\"numeros.txt\",\"r\");\n    output = fopen(\"out.txt\",\"w\");\n    printf(\"Select your N : \");\n    scanf(\"%d\",&amp;range);\n\n    float *array_x;\n    array_x = malloc(sizeof(float)*N);\n    float num;\n    int size=0;\n\n    for(int f=0;f&lt;N; f++){\n        fscanf(input,\"%f\",&amp;array_x[size]);\n\n        size++;\n    }\n\n    int i;\n    for (i = 0; i &lt; range; i++) {\n            fprintf(output,\"%f \",  qselect(array_x,0, size, i));\n    }\n    fclose(input);\n    fclose(output);\n    free(array_x);\n\n    return 0;        \n}\n</code></pre>\n\n<p>If I try to define N=195 or more, the code doesn't work.</p>\n"}, {"tags": ["c", "gcc", "macros", "c-preprocessor", "stringification"], "answers": [{"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1475629696, "post_id": 39859537, "comment_id": 67015855, "body": "I shall have to do some experimentation around this apparent-bug myself, but for right now, just to be clear, when I said &quot;the contents of the diagnostic may not be modified&quot;, I meant to rule out anything that would add extra quotation marks to the compiler&#39;s output."}, {"owner": {"reputation": 9958, "user_id": 2188562, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DMWEc.png?s=128&g=1", "display_name": "Peter Varo", "link": "https://stackoverflow.com/users/2188562/peter-varo"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1475657655, "post_id": 39859537, "comment_id": 67025898, "body": "@zwol I updated my answer, now all the unnecessary quotes are gone and it is working on both wished compilers!"}, {"owner": {"reputation": 9958, "user_id": 2188562, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DMWEc.png?s=128&g=1", "display_name": "Peter Varo", "link": "https://stackoverflow.com/users/2188562/peter-varo"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1476094730, "post_id": 39859537, "comment_id": 67191655, "body": "@zwol if you think this answer was helpful, please consider accepting it, before the end of the bounty-period! cheers!"}], "tags": [], "owner": {"reputation": 9958, "user_id": 2188562, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DMWEc.png?s=128&g=1", "display_name": "Peter Varo", "link": "https://stackoverflow.com/users/2188562/peter-varo"}, "is_accepted": true, "score": 2, "last_activity_date": 1475658221, "last_edit_date": 1475658221, "creation_date": 1475606539, "answer_id": 39859537, "question_id": 39752164, "link": "https://stackoverflow.com/questions/39752164/delayed-stringification-without-macro-expansion/39859537#39859537", "title": "Delayed stringification without macro expansion", "body": "<p>Maybe I misunderstood the question, but the following code is working and compiling on both <code>clang</code> and <code>gcc</code>, and tested with <code>-std=c99</code> and <code>-std=c11</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define deprecation_message(symbol) \\\n   #symbol \" will be removed from &lt;header.h&gt; in the next release\\n\" \\\n   \"of $LIBRARY. To use \" #symbol \", include &lt;moved/header.h&gt; instead.\"\n\n#define make_pw__(...) _Pragma(#__VA_ARGS__)\n#define make_pw_(...)  make_pw__(GCC warning #__VA_ARGS__)\n#define make_pw(...)   make_pw_(__VA_ARGS__)\n\n#define xmacro(a, b, c) puts(\"I'm working: \" #a #b #c \"!\")\n#define dmacro(a, b, c) make_pw(deprecation_message(dmacro)) xmacro(a, b, c)\n\nint\nmain(void)\n{\n    dmacro(x, y, z);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Now, the above code will expand this with <code>clang</code>:</p>\n\n<pre><code>int\nmain(void)\n{\n    #pragma GCC warning \"\\042dmacro\\042 \\042 will be removed from &lt;header.h&gt; in the next release\\134n\\042 \\042of $LIBRARY. To use \\042 \\042dmacro\\042 \\042, include &lt;moved/header.h&gt; instead.\\042\"\n    puts(\"I'm working: \" \"x\" \"y\" \"z\" \"!\");\n    return 0 /* Successful exit status.  */;\n}\n</code></pre>\n\n<p>and will produce the following warnings on <code>clang</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>src/main.c:18:5: warning: \"dmacro\" \" will be removed from &lt;header.h&gt; in the next release\\n\" \"of $LIBRARY. To use \" \"dmacro\" \", include &lt;moved/header.h&gt; instead.\" [-W#pragma-messages]\n    dmacro(x, y, z);\n    ^\n</code></pre>\n\n<p>and this on <code>gcc</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>src/main.c:18:13: warning: \"dmacro\" \" will be removed from &lt;header.h&gt; in the next release\\n\" \"of $LIBRARY. To use \" \"dmacro\" \", include &lt;moved/header.h&gt; instead.\"\n     dmacro(x, y, z);\n             ^~~~~~~~\n</code></pre>\n\n<p>Basically all I did was, to put the deprecation message into quotes...</p>\n\n<hr>\n\n<p><strong>UPDATE<sup>1</sup>:</strong></p>\n\n<p>Now, the funny thing is, if you remove the stringification from <code>make_pw_</code>, that is:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define make_pw_(...)  make_pw__(GCC warning __VA_ARGS__)\n</code></pre>\n\n<p>then <code>clang</code> will give you this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>src/main.c:18:5: warning: dmacro will be removed from &lt;header.h&gt; in the next releaseof $LIBRARY. To use dmacro, include &lt;moved/header.h&gt; instead. [-W#pragma-messages]\n    dmacro(x, y, z);\n    ^\n</code></pre>\n\n<p>Which is nice, as it does not have the unwanted quotes, however <code>GCC</code> will only give you this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>src/main.c:18:13: warning: dmacro\n     dmacro(x, y, z);\n             ^~~~~~~~\n</code></pre>\n\n<p>What is even more strange, is that if you change the <code>deprecation_message</code> to this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define deprecation_message(symbol) \"\" #symbol \"...\"\n</code></pre>\n\n<p>then it will give you an empty warning, like it was only using the first non-white-space token from the macro argument.</p>\n\n<p>To be honest with you, I don't know if this is a bug from <code>GCC</code>, or this is the well-defined behavior and <code>clang</code> is doing some extra work to make sense out of this, none the less, this is happening with the latest versions of the two compilers. <em>(If I have to bet, I would say, this is a bug :P)</em></p>\n\n<hr>\n\n<p><strong>UPDATE<sup>2</sup>:</strong></p>\n\n<p>Here is a slightly modified version, which works on both compilers as you described in your comment. The trick is, that the macro <code>DEPRECATED</code> has two stages, instead of one.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define DEPRECATED_(...) #__VA_ARGS__\n#define DEPRECATED(symbol)                                                     \\\n    DEPRECATED_(#symbol will be removed from &lt;header.h&gt; in the next release\\n  \\\n                of $LIBRARY. To use #symbol, include &lt;moved/header.h&gt; instead.)\n\n#define PRAGMA_WARN_(message) _Pragma(#message)\n#define PRAGMA_WARN(message)  PRAGMA_WARN_(GCC warning message)\n\n#define dmacro(a, b, c)                                                        \\\n    PRAGMA_WARN(DEPRECATED(dmacro))                                            \\\n    puts(\"I'm working: \" #a #b #c \"!\")\n\nint\nmain(void)\n{\n    dmacro(x, y, z);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>So this will produce the following output in <code>clang</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>src/main.c:19:5: warning: \"dmacro\" will be removed from &lt;header.h&gt; in the next release of $LIBRARY. To use \"dmacro\", include &lt;moved/header.h&gt; instead. [-W#pragma-messages]\n    dmacro(x, y, z);\n    ^\n</code></pre>\n\n<p>And the following one in <code>GCC</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>src/main.c:19:13: warning: \"dmacro\" will be removed from &lt;header.h&gt; in the next release\n of $LIBRARY. To use \"dmacro\", include &lt;moved/header.h&gt; instead.\n     dmacro(x, y, z);\n             ^~~~~~~~\n</code></pre>\n\n<p><strong><em>NOTE:</strong> I would highly recommend you, to remove the <code>\\n</code> character from your message!</em></p>\n"}], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 39859537, "answer_count": 1, "score": 1, "last_activity_date": 1475671543, "creation_date": 1475077610, "last_edit_date": 1475671543, "question_id": 39752164, "link": "https://stackoverflow.com/questions/39752164/delayed-stringification-without-macro-expansion", "title": "Delayed stringification without macro expansion", "body": "<p>Is it possible to modify the following code fragment to prevent the  diagnostic printed by <code>#pragma GCC warning</code> from changing if any of the identifier tokens in <code>deprecation_message</code> are defined as object-like macros at the point where <code>dmacro</code> is expanded, while preserving the ability to substitute <code>symbol</code> into the message?  Ugliness no object, GCC extensions are fair game as long as clang also implements them, but the contents of the diagnostic may not be modified.</p>\n\n<pre><code>#define deprecation_message(symbol) \\\n   #symbol will be removed from &lt;header.h&gt; in the next release\\n\\\n   of $LIBRARY. To use #symbol, include &lt;moved/header.h&gt; instead.\n\n#define make_pw(...) make_pw_(__VA_ARGS__)\n#define make_pw_(...) make_pw__(GCC warning #__VA_ARGS__)\n#define make_pw__(...) _Pragma(#__VA_ARGS_)\n\n#define dmacro(a,b,c) make_pw(deprecation_message(dmacro)) xmacro(a,b,c)\n\n// Uncommenting any of the following #define lines should *not*\n// change the text of the diagnostic in any way.\n//#define header\n//#define n f\n//#define will won't'\ndmacro(x,y,z)\n</code></pre>\n\n<p>(You might be tempted to reach for string-literal concatenation, but that won't work; both <code>_Pragma</code> itself and <code>#pragma GCC warning</code> accept only a single string literal.  <code>_Pragma(\"this\" \"that\")</code> is a syntax error.)</p>\n"}, {"tags": ["c", "avr", "atmega", "audio-player", "atmelstudio"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1475077667, "post_id": 39751940, "comment_id": 66800390, "body": "Sorry, the question, <i>&quot;How do I parse the directory structure of a FAT file system?&quot;</i> is too broad for stack overflow."}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 1, "creation_date": 1475077987, "post_id": 39751940, "comment_id": 66800585, "body": "There are already SD/FAT libraries around. You&#39;ve no need to monkey about with that kind of stuff manually. You should be far more interested in output and buffering of the data. A sector is 512 bytes long and you only have 2k of ram. You&#39;ll only be able to read 512 or 1024 bytes at a time."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475079045, "post_id": 39751940, "comment_id": 66801298, "body": "There are SD/FAT libraries arround that support a streaming interface and reduce the amount of buffering needed in the application significantly (to zero). You might want to have a thorough look here <a href=\"http://elm-chan.org/fsw/ff/00index_e.html\" rel=\"nofollow noreferrer\">elm-chan.org/fsw/ff/00index_e.html</a>"}, {"owner": {"reputation": 165, "user_id": 6148978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d69d8d768a29606831e1c5bcf7845af?s=128&d=identicon&r=PG&f=1", "display_name": "Ngenazy", "link": "https://stackoverflow.com/users/6148978/ngenazy"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1475079305, "post_id": 39751940, "comment_id": 66801469, "body": "@enhzflep Thank you for your advice,I will look into SD/FAT libraries"}], "owner": {"reputation": 165, "user_id": 6148978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d69d8d768a29606831e1c5bcf7845af?s=128&d=identicon&r=PG&f=1", "display_name": "Ngenazy", "link": "https://stackoverflow.com/users/6148978/ngenazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 721, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475076919, "creation_date": 1475076919, "question_id": 39751940, "link": "https://stackoverflow.com/questions/39751940/how-to-read-wav-files-using-atmega32", "title": "How to read (.WAV) files using Atmega32", "body": "<p>I am designing a Digital Audio Player using Atmega32.I am using a microSD card to store (.wav) files.The filesystem being used by the card is FAT32.So far I have successfully initialized the SD card and was able to read the Master Boot Record(MBR).Now I am stuck on how to read and play files from SD card.I used the code from the following link.\n<a href=\"http://www.dharmanitech.com/2009/01/sd-card-interfacing-with-atmega8-fat32.html\" rel=\"nofollow\">http://www.dharmanitech.com/2009/01/sd-card-interfacing-with-atmega8-fat32.html</a>\nBelow is a code snippet of a function to read a <strong>read data</strong> from boot sector`</p>\n\n<pre><code>unsigned char getBootSectorData (void)\n{\n    struct BS_Structure *bpb; //mapping the buffer onto the structure\n    struct MBRinfo_Structure *mbr;\n    struct partitionInfo_Structure *partition;\n    unsigned long dataSectors;\n\n    unusedSectors = 0;\n\n    SD_readSingleBlock(0);\n    bpb = (struct BS_Structure *)buffer;\n\nif(bpb-&gt;jumpBoot[0]!=0xE9 &amp;&amp; bpb-&gt;jumpBoot[0]!=0xEB)   //check if it is boot sector\n{\n    mbr = (struct MBRinfo_Structure *) buffer;       //if it is not boot sector, it must be MBR\n\n    if(mbr-&gt;signature != 0xaa55) return 1;       //if it is not even MBR then it's not FAT32\n\n    partition = (struct partitionInfo_Structure *)(mbr-&gt;partitionData);//first partition\n    unusedSectors = partition-&gt;firstSector; //the unused sectors, hidden to the FAT\n\n    SD_readSingleBlock(partition-&gt;firstSector);//read the bpb sector\n    bpb = (struct BS_Structure *)buffer;\n    if(bpb-&gt;jumpBoot[0]!=0xE9 &amp;&amp; bpb-&gt;jumpBoot[0]!=0xEB) return 1; \n}\n//I am sure the following parameters are useful but I am not sure how to use \n//them\nbytesPerSector = bpb-&gt;bytesPerSector;\nsectorPerCluster = bpb-&gt;sectorPerCluster;\nreservedSectorCount = bpb-&gt;reservedSectorCount;\nrootCluster = bpb-&gt;rootCluster;// + (sector / sectorPerCluster) +1;\nfirstDataSector = bpb-&gt;hiddenSectors + reservedSectorCount + (bpb-&gt;numberofFATs * bpb-&gt;FATsize_F32);\n\ndataSectors = bpb-&gt;totalSectors_F32\n          - bpb-&gt;reservedSectorCount\n          - ( bpb-&gt;numberofFATs * bpb-&gt;FATsize_F32);\ntotalClusters = dataSectors / sectorPerCluster;\n\n    if((getSetFreeCluster (TOTAL_FREE, GET, 0)) &gt; totalClusters)  //check if FSinfo free clusters count is valid\n    freeClusterCountUpdated = 0;\nelse\n freeClusterCountUpdated = 1;\nreturn 0;\n}\n</code></pre>\n\n<p>In his code there is also another fuction to read files,but the problem is that, the function take a pointer to filename as one of its arguments ,what  I need is to pass a flag to READ file and an array for saving the <strong>filename</strong> .I also want the function to return a first cluster of a file being read.Below is a function to read a file.</p>\n\n<pre><code>//***************************************************************************\n//Function: if flag=READ then to read file from SD card and send contents to UART \n//if flag=VERIFY then functions will verify whether a specified file is already existing\n//Arguments: flag (READ or VERIFY) and pointer to the file name\n//return: 0, if normal operation or flag is READ\n//        1, if file is already existing and flag = VERIFY\n//        2, if file name is incompatible\n//***************************************************************************\nunsigned char readFile (unsigned char flag, unsigned char *fileName)\n{\n    struct dir_Structure *dir;\n    unsigned long cluster, byteCounter = 0, fileSize, firstSector;\n    unsigned int k;\n    unsigned char j, error;\n\n    error = convertFileName (fileName); //convert fileName into FAT format\n    if(error) return 2;\n\n    dir = findFiles (GET_FILE, fileName); //get the file location\n    if(dir == 0) \n    return (0);\n\n    if(flag == VERIFY) return (1);  //specified file name is already existing\n\n    cluster = (((unsigned long) dir-&gt;firstClusterHI) &lt;&lt; 16) | dir-&gt;firstClusterLO;\n\n    fileSize = dir-&gt;fileSize;\n\n    TX_NEWLINE;\n    TX_NEWLINE;\n\nwhile(1)\n{\nfirstSector = getFirstSector (cluster);\n\nfor(j=0; j&lt;sectorPerCluster; j++)\n{\n     SD_readSingleBlock(firstSector + j);\n\n    for(k=0; k&lt;512; k++)\n{\n  transmitByte(buffer[k]);\n  if ((byteCounter++) &gt;= fileSize ) return 0;\n}\n  }\ncluster = getSetNextCluster (cluster, GET, 0);\n    if(cluster == 0) {transmitString_F(PSTR(\"Error in getting cluster\")); return 0;}\n    }\n    return 0;\n    }\n</code></pre>\n\n<p>Anyone who can help me i will greatly appreciate\nI also had a look at this  code\n<a href=\"http://blog.vinu.co.in/2012/02/tv-remote-controller-high-quality.html\" rel=\"nofollow\">http://blog.vinu.co.in/2012/02/tv-remote-controller-high-quality.html</a>\nThank you in advance.</p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 81656, "user_id": 8446, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8f9c683775bfbe76ed4855a19b73dc81?s=128&d=identicon&r=PG", "display_name": "Roger Lipscombe", "link": "https://stackoverflow.com/users/8446/roger-lipscombe"}, "edited": false, "score": 0, "creation_date": 1475076255, "post_id": 39751607, "comment_id": 66799453, "body": "Why do you think this has anything to do with endianness?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475076287, "post_id": 39751607, "comment_id": 66799472, "body": "What is your current output?"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475076332, "post_id": 39751607, "comment_id": 66799504, "body": "@LPs similar to input"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1475076339, "post_id": 39751607, "comment_id": 66799508, "body": "On windows, lines end with a carriage return followed by a line feed, so you&#39;ll never find two line feeds together."}, {"owner": {"reputation": 81656, "user_id": 8446, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8f9c683775bfbe76ed4855a19b73dc81?s=128&d=identicon&r=PG", "display_name": "Roger Lipscombe", "link": "https://stackoverflow.com/users/8446/roger-lipscombe"}, "edited": false, "score": 0, "creation_date": 1475078017, "post_id": 39751607, "comment_id": 66800599, "body": "Why do this in C? Use <code>findstr</code>: <a href=\"http://superuser.com/a/262777/4206\">superuser.com/a/262777/4206</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1475079496, "post_id": 39752572, "comment_id": 66801584, "body": "Yes. VMS, for example, stores text files as a sequence of variable length records that do not contain any line-ending characters at all."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1475079383, "last_edit_date": 1475079383, "creation_date": 1475078785, "answer_id": 39752572, "question_id": 39751607, "link": "https://stackoverflow.com/questions/39751607/opening-a-file-with-binary-mode-for-processing/39752572#39752572", "title": "Opening a file with binary mode for processing", "body": "<p>If you are processing a text file <em>as</em> text, then you should open it in text mode, not binary mode.  The physical distinction between a text file and a binary file is system-dependent, and on some systems there is no distinction, but portable programs need to be aware that it at least potentially makes a difference.  This is about the C view of the file's contents, not about the (stream) functions you use to access the contents.</p>\n\n<p>In particular, if you open a file in text mode then the I/O functions will translate between the system's standard convention for (text) line terminators externally and newlines internally.  If your program operates on input files that you assume will conform to the local system's idea of line termination, and you want your program to have a view of its input files in which each line is terminated by a newline (alone), then you need to open the files in text mode to engage that translation.  Beware, however, that that may have additional implications.</p>\n\n<p>If you cannot or will not open the files in text mode, then you need to establish and handle what a \"line\" means to your program.  It is entirely possible to make it recognize line terminators of different types, and even of mixed types.  In that case, it may be useful to know that lines of Windows text files are terminated by the two-byte sequence <code>\"\\r\\n\"</code>, whereas lines of Unix (including OS X) text files are terminated by a single newline.  Lines of classic MacOS text files were terminated by single carriage returns, but you probably don't need to worry about that these days.  Some other systems have other conventions or support multiple conventions.</p>\n"}], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 39752572, "answer_count": 1, "score": 0, "last_activity_date": 1475079383, "creation_date": 1475076098, "last_edit_date": 1592644375, "question_id": 39751607, "link": "https://stackoverflow.com/questions/39751607/opening-a-file-with-binary-mode-for-processing", "title": "Opening a file with binary mode for processing", "body": "<p>What I am basically doing is opening a file in binary mode, dumping it into a buffer, and processing it, and I finally realized that opening the file in binary mode is causing a problem and I searched a bit on google but I don't know how to fix it.</p>\n<p>The code's aim is to reduce the number of lines. Note: The logic of the program is correct.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint foo(const char *filename);\n\nint main(void)\n{\n    foo(&quot;file.txt&quot;);\n\n    fputs(&quot;Press any key to continue...&quot;, stderr);\n    getchar();\n    return 0;\n}\n\nint foo(const char *filename)\n{\n    /* open file in binary mode */\n    FILE *fp = fopen(filename, &quot;rb&quot;);\n    if (!fp) {\n        perror(filename);\n        return -1;\n    }\n\n    /* store file size and allocate memory accordingly */\n    long f_size;\n    fseek(fp, 0L, SEEK_END);\n    f_size = ftell(fp);\n    fseek(fp, 0L, SEEK_SET);\n    char *buf = (char *)malloc(f_size+1);\n    if (!buf) {\n        puts(&quot;Error - malloc failed.&quot;);\n        return -2;\n    }\n\n    /* store file contents in buffer */\n    size_t bytes_read = fread(buf, 1, f_size, fp);\n    if (bytes_read != f_size) {\n        fclose(fp);\n        free(buf);\n        puts(&quot;read error...&quot;);\n        return -3;\n    }\n    else {\n        fclose(fp);\n        buf[f_size] = '\\0';\n    }\n\n    bool f = 0;\n    size_t n = 0;\n    size_t m = 0;\n    while (buf[n]) {\n        if (buf[n] == '\\n') {\n            if (f) {\n                f = 0;\n                buf[m++] = '\\n';\n            }\n        }\n        else {\n            f = 1;\n            buf[m++] = buf[n];\n        }\n        n++;\n    }\n    /* NUL-terminate buffer at m*/\n    buf[m] = '\\0';\n\n    /* open file for writing */\n    fp = fopen(filename, &quot;wb&quot;);\n    if (!fp) {\n        perror(filename);\n        free(buf);\n        return -4;\n    }\n\n    /* write buffer to file */\n    size_t bytes_written = fwrite(buf, 1, m, fp);\n    if (bytes_written != m) {\n        puts(&quot;fwrite error...&quot;);\n    }\n    fclose(fp);\n    free(buf);\n    return 0;\n}\n</code></pre>\n<p>file.txt:</p>\n<blockquote>\n<p>00000000</p>\n<p>00000000</p>\n<p>00000000</p>\n</blockquote>\n<p>desired output:</p>\n<blockquote>\n<p>00000000<br />\n00000000<br />\n00000000</p>\n</blockquote>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 6321114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8630706356a39194bd8b713f3603b6ad?s=128&d=identicon&r=PG&f=1", "display_name": "Loring", "link": "https://stackoverflow.com/users/6321114/loring"}, "is_accepted": false, "score": 4, "last_activity_date": 1475076907, "creation_date": 1475076907, "answer_id": 39751931, "question_id": 39751520, "link": "https://stackoverflow.com/questions/39751520/understanding-double-and-integers/39751931#39751931", "title": "Understanding double and integers", "body": "<p>The C compiler will do integer arithmetic only if both operands are integers (integer / integer, integer + integer, etc.), otherwise it will do floating point arithmetic (double / integer, double + integer, etc.)</p>\n\n<p>First result:</p>\n\n<pre><code>11 (an integer) / 4 + (33.0) / 5\n</code></pre>\n\n<p>The first part (11/4) is computed with integer arithmetic, so the answer is 2\nThe second part (33.0 / 5) is computed with floating point arithmetic, so the answer is 6.6 and the sum is 8.6</p>\n\n<p>Second result:</p>\n\n<pre><code>(double) inum / 4 + (33) / 5;\n</code></pre>\n\n<p>\"(double) inum / 4\" is computed using floating point arithmetic, so the answer is 2.75.\n\"33 / 5\" is computed using integer arithmetic, so the answer is 6, and the sum is 8.75</p>\n\n<p>In the following:</p>\n\n<pre><code>int_result = (int) dnum * 10 + 1;\n</code></pre>\n\n<p>The variable dnum is first cast to an integer, so integer arithmetic is used: 2 * 10 + 1 == 21</p>\n\n<p>And finally:</p>\n\n<pre><code>int_result = (int) (dnum * 10 + 1);\n</code></pre>\n\n<p>In this case, \"dnum * 10 + 1\" is computed first, which is done using floating point arithmetic: 2.56 * 10 + 1 == 26.6.  Then the cast - (int) - truncates to give 26.</p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 6894472, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9cf1cb4f543ac1ef10e59b3b01155a07?s=128&d=identicon&r=PG&f=1", "display_name": "Newtoprogram", "link": "https://stackoverflow.com/users/6894472/newtoprogram"}, "edited": false, "score": 0, "creation_date": 1475078324, "post_id": 39751954, "comment_id": 66800806, "body": "Thank you both, I was really struggling to understand the logic but think I&#39;ve got it now!"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1475076958, "creation_date": 1475076958, "answer_id": 39751954, "question_id": 39751520, "link": "https://stackoverflow.com/questions/39751520/understanding-double-and-integers/39751954#39751954", "title": "Understanding double and integers", "body": "<p>When an arithmetic operator is given two integer arguments, the result is an <code>integers, so any fraction is discarded. So</code>11 / 4<code>is</code>2<code>, not</code>2.75`. But when you combine an integer with a floating point, the integer is first converted to floating point, and a floating point result is returned.</p>\n\n<p>As a result:</p>\n\n<pre><code>dec_result = inum / 4 + (3.0 * inum) / 5;\n           = 11   / 4 + (3.0 * 11)   / 5\n           = 11   / 4 + (3.0 * 11.0) / 5\n           =      2   +    33.0      / 5\n           =      2   +          6.6\n           =         8.6\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6894472, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9cf1cb4f543ac1ef10e59b3b01155a07?s=128&d=identicon&r=PG&f=1", "display_name": "Newtoprogram", "link": "https://stackoverflow.com/users/6894472/newtoprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1475077856, "creation_date": 1475075850, "last_edit_date": 1475077856, "question_id": 39751520, "link": "https://stackoverflow.com/questions/39751520/understanding-double-and-integers", "title": "Understanding double and integers", "body": "<p>Absolute beginner programmer and wondered if you could help me understand some results and terms. I'm trying to follow the programs logic and how it works out certain values. The following case is an example to try and understand these concepts.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main ()\n{\n    int inum = 11;\n    double dnum = 2.56;\n\n    double dec_result;\n    int int_result;\n\n    dec_result = inum / 4 + (3.0 * inum) / 5;\n    printf(\"value in dec_result is %.2f\\n\", dec_result);\n\n    dec_result = (double) inum / 4 + (3 * inum) / 5;\n    printf(\"value in dec_result is %.2f\\n\", dec_result);\n\n    int_result = (int) dnum * 10 + 1;\n    printf(\"value in int_result is %d\\n\", int_result);\n\n    int_result = (int) (dnum * 10 + 1);\n    printf(\"value in int_result is %d\\n\", int_result);\n\n}\n</code></pre>\n\n<p>I know the results as I've run it through Visual Basic. What I'm struggling to follow is how it works it out.</p>\n\n<p>My workings:<br>\n<code>inum</code> and <code>dnum</code> I presume are 'names for values' and could be used interchangeably with say x or y. Same with <code>int_result</code> and <code>dec_result</code>.</p>\n\n<p>First dec_result is 8.60</p>\n\n<pre><code>dec_result = inum / 4 + (3.0 * inum) / 5;\n         11 (an integer) / 4 + (3.0 * 11) / 5\n         11 (an integer) / 4 + (33.0) / 5\n</code></pre>\n\n<p>Then I'm a bit lost...  2.75 + 6.6?</p>\n\n<p>Somehow, due to inum being an integer, value is truncated if written as fraction. But as remaining inum in the brackets is multiplied first then it becomes a decimal place number?</p>\n\n<p>It's displayed as decimal places as specified by the placeholder and specified by data type double.</p>\n\n<p>Second dec_result is 8.75</p>\n\n<pre><code>dec_result = (double) inum / 4 + ( 3 * inum) / 5;\n       = as double is a cast operator you change inum from int to double, so therefore: \n\n       = (double) inum / 4 + (33) / 5;\nThen   = inum/4 becomes 2.75 + 33/5\n</code></pre>\n\n<p>Why does the 33/5 bit become 6?\nIt's displayed as decimal places as specified by the placeholder and specified by data type double.</p>\n\n<pre><code>int_result = (int) dnum * 10 + 1;\n       = cast operator alters dnum a double to integer so 2.56 becomes 2\n\n       = 2 * 10 + 1\n       = 20 + 1\n       = 21\n</code></pre>\n\n<p>should be an integer as specified before the bracket and also <code>%d</code> placeholder means to provide the value as number with no decimal point.</p>\n\n<pre><code>int_result = (int) (dnum * 10 + 1);\n</code></pre>\n\n<p>I got:\n           = (int) (2.56 * 10 + 1)\n           = (int) (25.6 + 1)\n           = (int) (26.6)\n           = 26 </p>\n\n<p>because the value should be an integer as specified before the bracket and also <code>%d</code> placeholder means to provide the value as number with no decimal point.</p>\n\n<p>Is my logic correct?</p>\n"}, {"tags": ["c", "audio", "while-loop", "infinite-loop"], "comments": [{"owner": {"reputation": 2866, "user_id": 327395, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lYouK.jpg?s=128&g=1", "display_name": "dazedandconfused", "link": "https://stackoverflow.com/users/327395/dazedandconfused"}, "edited": false, "score": 0, "creation_date": 1475075597, "post_id": 39751283, "comment_id": 66798969, "body": "There are several comparisons in your code to the value 4 but it appears that a whole note (SEMIBREVE) has a value of 1.0.  If 1.0 represents the length of a bar then these comparisons would seem to be incorrect."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1475075620, "post_id": 39751283, "comment_id": 66798986, "body": "<code>barTotal</code> is a <code>double</code>, and you&#39;re adding fractions to it. The likelihood of it exactly equaling 4 (and thus breaking from the loop) is extremely small I would think. Furthermore, you&#39;re comparing it to 4 instead of 4.0, I&#39;m not sure what the implications there are. Why not just have an <code>int</code> that keeps track of the number of notes?"}, {"owner": {"reputation": 178, "user_id": 2849016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000041967732/picture?type=large", "display_name": "Corey Ford", "link": "https://stackoverflow.com/users/2849016/corey-ford"}, "reply_to_user": {"reputation": 2866, "user_id": 327395, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lYouK.jpg?s=128&g=1", "display_name": "dazedandconfused", "link": "https://stackoverflow.com/users/327395/dazedandconfused"}, "edited": false, "score": 0, "creation_date": 1475075718, "post_id": 39751283, "comment_id": 66799048, "body": "@dazedandconfused I have amend the code I believe to change this."}, {"owner": {"reputation": 178, "user_id": 2849016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000041967732/picture?type=large", "display_name": "Corey Ford", "link": "https://stackoverflow.com/users/2849016/corey-ford"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1475075800, "post_id": 39751283, "comment_id": 66799101, "body": "@yano Correct me if I&#39;m wrong, but I want a random number of notes made up of the randomised note lengths to fill a bar of 4/4 - instead of just x number of notes."}, {"owner": {"reputation": 178, "user_id": 2849016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000041967732/picture?type=large", "display_name": "Corey Ford", "link": "https://stackoverflow.com/users/2849016/corey-ford"}, "edited": false, "score": 0, "creation_date": 1475076025, "post_id": 39751283, "comment_id": 66799269, "body": "If I made the while loop terminate when (barTotal &lt; 1), is it possible to calculate notes that will fill the remaining length of the bar?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1475076038, "post_id": 39751283, "comment_id": 66799279, "body": "So you just want to add random fractions from the <code>Length[]</code> array to <code>barTotal</code> until <code>barTotal</code> is equal to 1.0?"}, {"owner": {"reputation": 178, "user_id": 2849016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000041967732/picture?type=large", "display_name": "Corey Ford", "link": "https://stackoverflow.com/users/2849016/corey-ford"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1475076065, "post_id": 39751283, "comment_id": 66799303, "body": "@yano precisely, yes."}, {"owner": {"reputation": 2866, "user_id": 327395, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lYouK.jpg?s=128&g=1", "display_name": "dazedandconfused", "link": "https://stackoverflow.com/users/327395/dazedandconfused"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1475076098, "post_id": 39751283, "comment_id": 66799336, "body": "What happens when you run the altered code?  Also, @yano&#39;s comments about floating point precision should be considered.  Lastly, think about what happens if the first note you generate is a half note and the second note randomly chosen is a whole note.  Your statement barTotal = Length[randLength] + barTotal; is going to give you a value greater than 1.  I think you need to see if the proposed note will exceed the remaining space and, if so, reduce its length until it is acceptable."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1475076195, "post_id": 39751283, "comment_id": 66799411, "body": "I think the loop you have is a little convoluted for that, but the biggest problem I see (I think), is with those random fractions, what&#39;s the likelihood of landing exactly on 1.0? Maybe you&#39;ll go from 0.93 to 1.04,, then you&#39;re still stuck in the loop. Perhaps you should change the condition to exit on <code>&gt;= 1.0</code> unless you need it exactly at 1.0"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1475076303, "post_id": 39751283, "comment_id": 66799482, "body": "You can just replace <code>if (barTotal &lt; 1)</code> with <code>if (barTotal + Length[randLength] &lt;= 1)</code>. Then in the matching <code>else</code>, the additional test <code>if(barTotal != 1)</code> is redundant - you can just choose a new <code>randLength</code> regardless. (Note: this isn&#39;t very efficient, but it should at least work!)"}, {"owner": {"reputation": 178, "user_id": 2849016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000041967732/picture?type=large", "display_name": "Corey Ford", "link": "https://stackoverflow.com/users/2849016/corey-ford"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1475076849, "post_id": 39751283, "comment_id": 66799841, "body": "@IanAbbott This has certainly made the final value for bar total = 1.0. However now the random functions always seem to be returning the same values. Weird."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1475077167, "post_id": 39751283, "comment_id": 66800059, "body": "You&#39;ll need to seed the random function with time to get different values each time you run it: <a href=\"http://stackoverflow.com/questions/8314370/rand-with-seed-does-not-return-random-if-function-looped\" title=\"rand with seed does not return random if function looped\">stackoverflow.com/questions/8314370/&hellip;</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1475077768, "post_id": 39751283, "comment_id": 66800463, "body": "Other problems in the code: (1) The <code>l</code> in <code>%lf</code> is redundant. (2) <code>Length[millisec(bpm,randLength)]</code> should probably be <code>millisec(bpm,Length[randLength])</code>. (3) You should probably print that stuff about the current note <i>before</i> clobbering the <code>randLength</code> and <code>randPitch</code> variables with new values!"}], "answers": [{"tags": [], "owner": {"reputation": 2866, "user_id": 327395, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lYouK.jpg?s=128&g=1", "display_name": "dazedandconfused", "link": "https://stackoverflow.com/users/327395/dazedandconfused"}, "is_accepted": true, "score": 1, "last_activity_date": 1475084332, "creation_date": 1475084332, "answer_id": 39754251, "question_id": 39751283, "link": "https://stackoverflow.com/questions/39751283/how-to-solve-infinite-loop-for-generated-music/39754251#39754251", "title": "How to solve infinite loop for generated music?", "body": "<p>Consider thinking about the problem differently.  Think of a bar as \"n\" slots where n is the most granular note type you have.  So in your case a bar is a group of 32 slots.  Rather than representing your numbers as fractions, use integral types to show how many of those \"slots\" each takes.  So a DEMISEMIQUAVER takes 1 slot, which can be represented as an int rather than being (1.0 / 32.0) which introduces some potentially ugly issues.</p>\n\n<p>Once you do this the solution is more straightforward:</p>\n\n<p>1) How many slots are left in the current bar?\n2) Choose a random note from a pool of notes smaller than the remaining slots\n3) Recalculate how much room is left after adding the new note\n4) If the remaining room is zero, proceed to the next bar.</p>\n\n<p>Below is your code, adapted to this new approach.  Not fully tested but it should avoid most if not all of the pitfalls discussed thus far.</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n//macros\n#define SEMIBREVE       (32)\n#define MINIM           (16)\n#define CROTCHET        (8)\n#define QUAVER          (4)\n#define SEMIQUAVER      (2)\n#define DEMISEMIQUAVER  (1)\n\n#define C   (261.63)\n#define D   (293.66)\n#define E   (329.63)\n#define F   (349.23)\n#define G   (391.99)\n#define A   (440.00)\n#define B   (493.88)\n\nint GetMaxIndex(int remainingLength)\n{\n    // Returns the largest upper bound of the Length array that\n    // should be considered based on how much room remains in \n    // the current bar.\n    int result;\n    if(remainingLength == 32) result = 5;\n    if(remainingLength &lt; 32) result = 4;\n    if(remainingLength &lt; 16) result = 3;\n    if(remainingLength &lt; 8) result = 2;\n    if(remainingLength &lt; 4) result = 1;\n    if(remainingLength &lt; 2) result = 0;\n    return result;\n\n}\n\nint main()\n{\n    double Pitch[] = {C, D, E,F, G, A, B}; //Array of CMajor Scale Freq\n\n    int bpm = 120; //BPM Value\n    int Length[] = {DEMISEMIQUAVER, SEMIQUAVER, QUAVER, CROTCHET, MINIM, SEMIBREVE}; //Array of Note Lengths\n    char* Labels[] = {\"DEMISEMIQUAVER (Thirty Second)\", \"SEMIQUAVER (Sixteenth)\", \"QUAVER (Eighth)\", \"CROTCHET (Quarter)\", \"MINIM (Half)\", \"SEMIBREVE (Whole)\"}; \n    int remainingThisBar;\n    int barsToGenerate = 4;\n\n    int randLength = (rand() % 6); //random positions for note length\n    int randPitch; //random positions for note pitch\n    int maxIndex;\n    int randIndex;\n\n    srand(time(NULL));\n\n    for(int barNumber = 0; barNumber &lt; barsToGenerate; barNumber++)\n    {\n        printf(\"Beginning bar: %i\\n\", barNumber);\n        remainingThisBar = 32;\n\n        while(remainingThisBar &gt; 0)\n        {\n            maxIndex = GetMaxIndex(remainingThisBar);  // What is the biggest note index we still have room for?\n            randIndex = maxIndex == 0 ? 0 : (rand() % maxIndex); // Get a random note between 0 and maxIndex\n\n            randPitch = ( rand() % 7);      // Random positions for note pitch\n            randLength = Length[randIndex]; // Length in 32nds\n            remainingThisBar -= randLength; \n\n            // Output\n            printf(\"\\tNote: %s @ %f\\n\", Labels[randIndex], Pitch[randPitch]);\n            printf(\"\\t32nds remaining in bar: %i\\n\", remainingThisBar);\n            printf(\"\\n\");\n\n            /* TODO - Output note via aServe*/\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 178, "user_id": 2849016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000041967732/picture?type=large", "display_name": "Corey Ford", "link": "https://stackoverflow.com/users/2849016/corey-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 39754251, "answer_count": 1, "score": 2, "last_activity_date": 1547143939, "creation_date": 1475075162, "last_edit_date": 1547143939, "question_id": 39751283, "link": "https://stackoverflow.com/questions/39751283/how-to-solve-infinite-loop-for-generated-music", "title": "How to solve infinite loop for generated music?", "body": "<p>I have a program that I want to create a randomly generated bar of music (4 beats to a bar, using C Major scale). However, I'm having trouble understanding the math and keep overflowing my do while loop, creating more than 4 notes to the bar which I want to avoid.</p>\n\n<p>I am using aServe, which was created by my tutor, but basically opens a stream to an Oscillator that plays the arguments I've commented.</p>\n\n<pre><code>/* Program for randomly written bar of 4/4 in C Major */\n\n#include \"aservelibs/aservelib.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//macros\n#define SEMIBREVE       (1.0)\n#define MINIM           (1.0/2)\n#define CROTCHET        (1.0/4)\n#define QUAVER          (1.0/8)\n#define SEMIQUAVER      (1.0/16)\n#define DEMISEMIQUAVER  (1.0/32)\n\n#define C   (261.63)\n#define D   (293.66)\n#define E   (329.63)\n#define F   (349.23)\n#define G   (391.99)\n#define A   (440.00)\n#define B   (493.88)\n\nint millisec(int bpm, double note) {\n    return (int)(\n                 60      /* seconds */\n                 * 1000  /* milliseconds per second */\n                 * 4     /* crotchets per semibreve */\n                 * note\n                 / bpm\n                 );\n}\n\nint main()\n{\n    int bpm = 120; //BPM Value\n    double Length[] = {SEMIBREVE, MINIM, CROTCHET, QUAVER, SEMIQUAVER, DEMISEMIQUAVER}; //Array of Note Lengths\n    double Pitch[] = {C, D, E,F, G, A, B}; //Array of CMajor Scale Freq\n\n    int randLength = (rand() % 6); //random positions for note length\n    int randPitch = ( rand() % 7); //random positions for note pitch\n    double barTotal = 0; //amount of bar currently completed\n\n    do {\n        if(barTotal &lt; 1) //if bar total is smaller than 1\n        {\n            barTotal = Length[randLength] + barTotal; //add note to total\n\n            aserveOscillator(0, Pitch[randPitch], 1, 2); //Starts stream to oscialltor\n                //aserveOscillator(Index,Frequency,Amplitude,WaveType);\n            aserveSleep(millisec(bpm, Length[randLength])); //play the notes for the length of time specified in milliseconds\n\n            randLength = (rand() % 6); //prepare next random note\n            randPitch = (rand() % 7); //prepare next random pitch\n\n            //Output\n            printf(\"Note: \");\n            printf(\"%lf\", Pitch[randPitch]);\n            printf(\"\\n For: \");\n            printf(\"%lf\", Length[millisec(bpm,randLength)]);\n            printf(\"\\n With Bar Total: \");\n            printf(\"%lf\", barTotal);\n            printf(\"\\n\\n\");\n        }\n        else\n        {\n            if(barTotal != 1) //if bar total is bigger than 4\n            {\n                randLength = (rand() % 6); //try another number\n            }\n        }\n\n    } while (barTotal != 1); //will stop once reaches 4\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1475074459, "post_id": 39750899, "comment_id": 66798156, "body": "Maybe you can call <code>pause()</code> just before checking <code>timedout</code>? It will return just after the signal is processed."}, {"owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "edited": false, "score": 1, "creation_date": 1475074579, "post_id": 39750899, "comment_id": 66798239, "body": "Can you use an interrupt instead of polling?"}, {"owner": {"reputation": 39, "user_id": 6894380, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/807b3d9ac1c1de59b6d44638fcb74a76?s=128&d=identicon&r=PG&f=1", "display_name": "Titus", "link": "https://stackoverflow.com/users/6894380/titus"}, "edited": false, "score": 0, "creation_date": 1475074883, "post_id": 39750899, "comment_id": 66798475, "body": "Thanks rodrigo, can you please show me some example ?"}, {"owner": {"reputation": 39, "user_id": 6894380, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/807b3d9ac1c1de59b6d44638fcb74a76?s=128&d=identicon&r=PG&f=1", "display_name": "Titus", "link": "https://stackoverflow.com/users/6894380/titus"}, "edited": false, "score": 0, "creation_date": 1475075002, "post_id": 39750899, "comment_id": 66798557, "body": "Thanks Riley, can you please show me code ? thanks again"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475075624, "post_id": 39750899, "comment_id": 66798990, "body": "To me your question is a bit unclear. Are you asking &quot;how to measure time spend polling&quot; ? In that case see: <a href=\"http://stackoverflow.com/questions/2150291/how-do-i-measure-a-time-interval-in-c\" title=\"how do i measure a time interval in c\">stackoverflow.com/questions/2150291/&hellip;</a>"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1475075897, "post_id": 39750899, "comment_id": 66799173, "body": "@Titus: Example? Easy: <code>do { &#47;*...*&#47; ; pause(); if (timedout == 1) return -1; } while (temp_reg[0] != 0);</code>. <code>pause()</code> is an easy function. It just waits until your process receives a signal."}, {"owner": {"reputation": 39, "user_id": 6894380, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/807b3d9ac1c1de59b6d44638fcb74a76?s=128&d=identicon&r=PG&f=1", "display_name": "Titus", "link": "https://stackoverflow.com/users/6894380/titus"}, "edited": false, "score": 0, "creation_date": 1475076075, "post_id": 39750899, "comment_id": 66799311, "body": "Apologize, actually I want to reduce the CPU usage when I do poll method to read the register continuously. I hope you would get idea if you see my code."}, {"owner": {"reputation": 39, "user_id": 6894380, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/807b3d9ac1c1de59b6d44638fcb74a76?s=128&d=identicon&r=PG&f=1", "display_name": "Titus", "link": "https://stackoverflow.com/users/6894380/titus"}, "edited": false, "score": 0, "creation_date": 1475077136, "post_id": 39750899, "comment_id": 66800045, "body": "Thanks rodrigo, yes, I tried it. thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1475081908, "last_edit_date": 1495535246, "creation_date": 1475076140, "answer_id": 39751622, "question_id": 39750899, "link": "https://stackoverflow.com/questions/39750899/need-some-help-in-c-code-for-optimization-poll-delay-sleep/39751622#39751622", "title": "Need some help in C code for optimization (Poll + delay/sleep)", "body": "<p>Here are some pseudo code that might help:</p>\n\n<pre><code>do \n{\n    // Pseudo code\n    start_time = get_current_time(); \n\n    do \n    {\n        temp_reg[0] = read_reg();\n        //Read the register here and copy the value into char array (temp_reg\n\n        if (timedout == 1 )\n            return -1;//Timedout\n\n        // Pseudo code\n        stop_time = get_current_time();\n        if (stop_time - start_time &gt; some_limit) break;\n\n    } while (temp_reg[0] != 0 );\n\n    if (temp_reg[0] != 0) \n    {\n         usleep(some_time);\n         start_time = get_current_time(); \n     }    \n} while (temp_reg[0] != 0 );\n</code></pre>\n\n<p>To turn the pseudo code into real code, see <a href=\"https://stackoverflow.com/a/2150334/4386427\">https://stackoverflow.com/a/2150334/4386427</a></p>\n"}, {"comments": [{"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1475076856, "post_id": 39751743, "comment_id": 66799844, "body": "Note: I do not know whether your system has any peculiarities, but on most systems, if you decide to sleep, then sleep(1) will generally take you from 100% CPU utilization down to 1% CPU utilization.  Is it worth putting any extra effort to take it further down?  You decide."}, {"owner": {"reputation": 39, "user_id": 6894380, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/807b3d9ac1c1de59b6d44638fcb74a76?s=128&d=identicon&r=PG&f=1", "display_name": "Titus", "link": "https://stackoverflow.com/users/6894380/titus"}, "edited": false, "score": 0, "creation_date": 1475077053, "post_id": 39751743, "comment_id": 66799990, "body": "Thanks Mike, Actually I am doing i2c read transaction which will read the register of I2C camera. I hope this clarifies. Let me know if any suggestions."}, {"owner": {"reputation": 39, "user_id": 6894380, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/807b3d9ac1c1de59b6d44638fcb74a76?s=128&d=identicon&r=PG&f=1", "display_name": "Titus", "link": "https://stackoverflow.com/users/6894380/titus"}, "edited": false, "score": 0, "creation_date": 1475077502, "post_id": 39751743, "comment_id": 66800275, "body": "Mike, this is the code. <code>i2c_read(int handle, int reg, int count, char *buffer ); ret = i2c_read(hHandle, 0x4012, 0x1, buffer); &#47;&#47;It will read the address 0x4012 of I2C slave (handle) and update the 1byte return value in buffer</code>"}], "tags": [], "owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "is_accepted": false, "score": 1, "last_activity_date": 1475076417, "creation_date": 1475076417, "answer_id": 39751743, "question_id": 39750899, "link": "https://stackoverflow.com/questions/39750899/need-some-help-in-c-code-for-optimization-poll-delay-sleep/39751743#39751743", "title": "Need some help in C code for optimization (Poll + delay/sleep)", "body": "<blockquote>\n  <p>Currently I'm polling the register to get the expected value [...]</p>\n</blockquote>\n\n<p>wow wow wow, hold on a moment here, there is a huge story hidden behind this sentence; what is \"the register\"?  what is \"the expected value\"?  What does <code>read_reg()</code> do?  are you polling some external hardware?  Well then, it all depends on how your hardware behaves.</p>\n\n<p>There are two possibilities:</p>\n\n<ol>\n<li><p>Your hardware buffers the values that it produces. This means that the hardware will keep each value available until you read it; it will detect when you have read the value, and then it will provide the next value.</p></li>\n<li><p>Your hardware does not buffer values.  This means that values are being made available in real time, for an unknown length of time each, and they are replaced by new values at a rate that only your hardware knows.  </p></li>\n</ol>\n\n<p>If your hardware is buffering, then you do not need to be afraid that some values might be lost, so there is no need to poll at all: just try reading the next value once and only once, and if it is not what you expect, sleep for a while. Each value will be there when you get around to reading it.</p>\n\n<p>If your hardware is <em>not</em> buffering, then there is no strategy of polling and sleeping that will work for you.  Your hardware <em>must</em> provide an interrupt, and you <em>must</em> write an interrupt-handling routine that will read every single new value as quickly as possible from the moment that it has been made available.</p>\n"}], "owner": {"reputation": 39, "user_id": 6894380, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/807b3d9ac1c1de59b6d44638fcb74a76?s=128&d=identicon&r=PG&f=1", "display_name": "Titus", "link": "https://stackoverflow.com/users/6894380/titus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475081908, "creation_date": 1475074074, "question_id": 39750899, "link": "https://stackoverflow.com/questions/39750899/need-some-help-in-c-code-for-optimization-poll-delay-sleep", "title": "Need some help in C code for optimization (Poll + delay/sleep)", "body": "<p>Currently I'm polling the register to get the expected value and now I want reduce the CPU usage and increase the performance.\nSo, I think, if we do polling for particular time (Say for 10ms) and if we didn't get expected value then wait for some time (like udelay(10*1000) or usleep(10*1000) delay/sleep in ms) then continue to do polling for more more extra time (Say 100ms) and still if you didn't get the expected value then do sleep/delay for 100ms.....vice versa... need to do till it reach to maximum timeout value.</p>\n\n<p>Please let me know if anything.</p>\n\n<p>This is the old code:</p>\n\n<pre><code>#include &lt;sys/time.h&gt;       /* for setitimer */\n#include &lt;unistd.h&gt;     /* for pause */\n#include &lt;signal.h&gt;     /* for signal */\n\n#define INTERVAL    500 //timeout in ms\nstatic int timedout = 0;  \nstruct itimerval it_val;    /* for setting itimer */\nchar temp_reg[2];\n\nint main(void)\n{\n  /* Upon SIGALRM, call DoStuff().\n   * Set interval timer.  We want frequency in ms, \n   * but the setitimer call needs seconds and useconds. */\n  if (signal(SIGALRM, (void (*)(int)) DoStuff) == SIG_ERR) \n  {\n    perror(\"Unable to catch SIGALRM\");\n    exit(1);\n  }\n  it_val.it_value.tv_sec =     INTERVAL/1000;\n  it_val.it_value.tv_usec =    (INTERVAL*1000) % 1000000;   \n  it_val.it_interval = it_val.it_value;\n\n\n  if (setitimer(ITIMER_REAL, &amp;it_val, NULL) == -1) \n  {\n    perror(\"error calling setitimer()\");\n    exit(1);\n  }\n\n    do \n    {\n        temp_reg[0] = read_reg();\n        //Read the register here and copy the value into char array (temp_reg\n\n        if (timedout == 1 )\n            return -1;//Timedout\n\n    } while (temp_reg[0] != 0 );//Check the value and if not try to read the register again (poll)\n\n\n\n}\n\n/*\n * DoStuff\n */\nvoid DoStuff(void) \n{\n  timedout = 1;\n  printf(\"Timer went off.\\n\");\n}\n</code></pre>\n\n<p>Now I want to optimize and reduce the CPU usage and want to improve the performance.</p>\n\n<p>Can any one help me on this issue ?</p>\n\n<p>Thanks for your help on this.</p>\n"}, {"tags": ["c", "conditional", "logical-operators"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475074000, "post_id": 39750808, "comment_id": 66797791, "body": "Take a look at the <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence table</a> and answer it yourself."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1475074813, "post_id": 39750808, "comment_id": 66798411, "body": "Obviously it should have been written as <code>j??!!j!=1? printf(&quot;Welcome&quot;):printf(&quot;Bye&quot;);</code> instead, for clarity."}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 0, "creation_date": 1475158473, "post_id": 39750808, "comment_id": 66839802, "body": "It&#39;d be nice if you marked one of the answers as the Answer..."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "is_accepted": false, "score": 2, "last_activity_date": 1475073991, "creation_date": 1475073991, "answer_id": 39750863, "question_id": 39750808, "link": "https://stackoverflow.com/questions/39750808/execution-of-conditional-operators/39750863#39750863", "title": "execution of conditional operators", "body": "<p><code>!j!=1</code> is <code>(!j)!=1</code>, not <code>!(j!=1)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "is_accepted": false, "score": 2, "last_activity_date": 1475074142, "creation_date": 1475074142, "answer_id": 39750919, "question_id": 39750808, "link": "https://stackoverflow.com/questions/39750808/execution-of-conditional-operators/39750919#39750919", "title": "execution of conditional operators", "body": "<p>This is because <code>!</code> (NOT) has higher <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow\">operator precedence</a> than <code>!=</code> so...</p>\n\n<pre><code>j = 4; // 4\n!j // 0\n</code></pre>\n\n<p>In your condition, <code>0 != 1</code> will be true so \"Welcome\" is printed.</p>\n\n<p>For your desired outcome, your condition would have to be <code>!(j!=1)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9070, "user_id": 79591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rFGtY.jpg?s=128&g=1", "display_name": "GrahamS", "link": "https://stackoverflow.com/users/79591/grahams"}, "is_accepted": false, "score": 2, "last_activity_date": 1475074181, "creation_date": 1475074181, "answer_id": 39750928, "question_id": 39750808, "link": "https://stackoverflow.com/questions/39750808/execution-of-conditional-operators/39750928#39750928", "title": "execution of conditional operators", "body": "<p>The Logical NOT operator <code>!</code> has a higher precedence than the Not Equal To operator <code>!=</code></p>\n\n<p>So your condition is equivalent to <code>((!j) != 1)</code></p>\n\n<p>See <a href=\"https://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B#Operator_precedence\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B#Operator_precedence</a></p>\n"}, {"tags": [], "owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "is_accepted": false, "score": 2, "last_activity_date": 1475074214, "creation_date": 1475074214, "answer_id": 39750941, "question_id": 39750808, "link": "https://stackoverflow.com/questions/39750808/execution-of-conditional-operators/39750941#39750941", "title": "execution of conditional operators", "body": "<p>The unary operator <strong>'!'</strong> has a higher precedence than <strong>'!='</strong>.</p>\n\n<p>Read - <a href=\"https://www.tutorialspoint.com/cprogramming/c_operators_precedence.htm\" rel=\"nofollow\">https://www.tutorialspoint.com/cprogramming/c_operators_precedence.htm</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": true, "score": 2, "last_activity_date": 1475081443, "creation_date": 1475081443, "answer_id": 39753393, "question_id": 39750808, "link": "https://stackoverflow.com/questions/39750808/execution-of-conditional-operators/39753393#39753393", "title": "execution of conditional operators", "body": "<p><code>!</code> executed first because unary operator <code>!</code> has a higher precedence than <code>!=</code>.</p>\n\n<p><code>!4</code> become <code>0</code> then <code>0 != 1</code> become <code>true</code>.</p>\n\n<p>So, output is <code>Welcome</code>.</p>\n"}], "owner": {"reputation": 283, "user_id": 5180853, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/jfcSU.jpg?s=128&g=1", "display_name": "Arivarasan.K", "link": "https://stackoverflow.com/users/5180853/arivarasan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 39753393, "answer_count": 5, "score": 0, "last_activity_date": 1475081443, "creation_date": 1475073868, "last_edit_date": 1475074140, "question_id": 39750808, "link": "https://stackoverflow.com/questions/39750808/execution-of-conditional-operators", "title": "execution of conditional operators", "body": "<pre><code>int j=4;\n(!j!=1)?printf(\"Welcome\"):printf(\"Bye\");\n</code></pre>\n\n<p>In the above code segment, according to me, first <code>j!=1</code> will result in true and <code>!true</code> is false which must result in printing <code>Bye</code> but I get <code>Welcome</code> as the output. </p>\n\n<p>Can anyone explain this one?</p>\n"}, {"tags": ["android", "c", "android-ndk", "porting", "libx264"], "comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1475073529, "post_id": 39750574, "comment_id": 66797420, "body": "What exactly is wrong with <code>signal()</code>? Why do you want to get rid of it?"}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "reply_to_user": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1475073841, "post_id": 39750574, "comment_id": 66797658, "body": "Because NDK12 does not have <code>bsd_signal</code> symbol defined and throws the build errors mentioned in the edit. TL;DR = Because it causes build errors."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475075052, "post_id": 39750574, "comment_id": 66798592, "body": "But you don&#39;t present any usage of <code>bsd_signal()</code> in your example code, so what does it have to do with your question?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475075520, "post_id": 39750574, "comment_id": 66798932, "body": "Glibc&#39;s <code>signal()</code> works by calling <code>sigaction()</code>, if that&#39;s what you mean by &quot;usually&quot;.  That does not constitute any particular problem, because glibc also provides <code>sigaction()</code>."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475081960, "post_id": 39750574, "comment_id": 66803167, "body": "I haven&#39;t checked all libc implementations, so i kinda tried to remain reserved by saying &quot;usually&quot;. As far as android goes, it&#39;s libc - <code>bionic</code> - inlines <code>bsd_signal</code> which was removed two NDKs ago (might be better to just say in <code>android-21</code>) and because it broke alot of third-party libraries, they&#39;re considering to bring it back in the pending NDK13. As far as your other question goes - i have no invocations or usage of <code>bsd_signal</code> in the code, <code>grep</code> only finds it in <code>.o</code> and <code>.a</code> files, and the <code>.a</code> files can&#39;t be linked in to a shared library (<code>.so</code>) because the symbol is missing."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475082212, "post_id": 39750574, "comment_id": 66803295, "body": "But the answers you and Serhio gave me so far were very helpful and have greatly helped in understanding and confirming what should be done next."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475097993, "post_id": 39750574, "comment_id": 66811892, "body": "@JohnBollinger &quot;But you don&#39;t present any usage of bsd_signal() in your example code&quot; - See <a href=\"https://github.com/android-ndk/ndk/issues/160\" rel=\"nofollow noreferrer\">github.com/android-ndk/ndk/issues/160</a>. Old Android API levels defined <code>signal</code> as an inline function that called <code>bsd_signal</code>. New Android APIs rightly define <code>signal</code> out of line and no longer include a declaration for <code>bsd_signal</code>. If you build something for android-9 and then link it into something targeting android-21, you get the build failure. r13 puts back <code>bsd_signal</code> to handle this use case."}], "answers": [{"comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475081164, "post_id": 39751632, "comment_id": 66802683, "body": "From what i&#39;ve read, the NDK people are thinking about bringing <code>bsd_signal()</code> back in NDK 13, however i&#39;m not entirely sure i can just rely on that piece of information since their libc is currently unstable and kinda broken (because it&#39;s missing <code>rand()</code>)"}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475081653, "post_id": 39751632, "comment_id": 66802982, "body": "But basically, your solution #2 merely requires me to write a small piece of C code (copy/paste the bsd_signal() implementation from bionic) and include it in the build process without changing x264&#39;s code? Great, sounds promising. (y)"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475086754, "post_id": 39751632, "comment_id": 66805935, "body": "@Shark Not at all. Just recompile all the libraries that you use that didn&#39;t come as a part of the NDK."}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 2, "last_activity_date": 1475076170, "creation_date": 1475076170, "answer_id": 39751632, "question_id": 39750574, "link": "https://stackoverflow.com/questions/39750574/how-to-port-signal-to-sigaction/39751632#39751632", "title": "How to port signal() to sigaction()?", "body": "<p>According to info posted in your question, I see next points:</p>\n\n<ul>\n<li><p>You have prebuilt binaries, that were built for android-19 or lower (since they refer to <code>bsd_signal()</code>).</p></li>\n<li><p>You want to compile your code for android-21 or higher and link it against that old-targeted prebuilts.</p></li>\n</ul>\n\n<p>As you may know, prior to android-21 a lot of libc's functions were declared as <code>static</code> just right in headers. And actually all they were thin wrappers around more generic functions, that are exposed by libc binaries. Old versions of NDK have next definition in <code>&lt;signal.h&gt;</code>:</p>\n\n<pre><code>/* the default is bsd */\nstatic __inline__ __sighandler_t signal(int s, __sighandler_t f)\n{\n    return bsd_signal(s,f);\n}\n</code></pre>\n\n<p>That is from where <code>bsd_signal()</code> references stand in your binaries. You have two choices how to solve it.</p>\n\n<ul>\n<li><p>Recompile your dependencies totally for android-21 or higher. But, note that they won't run on older platforms.</p></li>\n<li><p>Provide <code>bsd_signal()</code> in your code, e.g. you can add an extra source file with implementation of this function. You can use <a href=\"https://android.googlesource.com/platform/bionic/+/f373b11/libc/bionic/signal.c#49\" rel=\"nofollow\">bionic's implementation</a> as reference. Also note that this function should be marked as hidden: <code>__attribute__ ((visibility (\"hidden\")))</code>. This is needed to prevent putting it to DSO dynamic symbol table, that may confuse dynamic linker on old platforms that have that function already exposed by <code>libc.so</code>.</p></li>\n</ul>\n\n<p>Also similar manipulations may be required for another libc functions, that previously were exported via similar <code>static</code> wrappers.</p>\n\n<p>Note, that no one of the proposed two solutions requires modifications in the code of your dependencies.</p>\n"}, {"comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475080984, "post_id": 39751664, "comment_id": 66802562, "body": "I think NDK&#39;s <code>signal()</code> implementation inlines the <code>bsd_signal()</code> implementation, however i&#39;m not entirely sure on that (yet). But it&#39;s my main suspicion so far. Serhio&#39;s post confirms it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 1, "creation_date": 1475083551, "post_id": 39751664, "comment_id": 66803980, "body": "@Shark, yes, inlining a call to <code>bsd_signal()</code> is one of the alternatives I described.  If you have a header that does this and a library implementation that does not provide <code>bsd_signal()</code>, then the two do not go together.  Possibly this is a major bug, but more likely you have a corrupt build environment with different versions of the headers and library.  Sorting that out (and afterward performing a clean build) ought to resolve the linker errors you presented.  Switching to <code>sigaction()</code> is not a bad idea, but it&#39;s probably not obligatory for you."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1475098339, "post_id": 39751664, "comment_id": 66812041, "body": "&quot;Possibly this is a major bug, but more likely you have a corrupt build environment with different versions of the headers and library.&quot; That&#39;s the case here. @serhio&#39;s answer covers the most likely cause."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475161421, "post_id": 39751664, "comment_id": 66841983, "body": "It&#39;s actually not the case here, NDK removed the <code>bsd_signal</code> symbol at some point (android-21) and are considering of bringing it back in NDK13 because they broke alot of third-party libs because of that..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475162129, "post_id": 39751664, "comment_id": 66842467, "body": "@Shark, when the function was removed and whether it might be brought back are irrelevant to the question of building your code <i>now</i> against the library you have <i>now</i>.  It is difficult to believe that NDK12 provides system headers that inline a call to a function that NDK12 does not, in fact, provide.  It is much more plausible that you&#39;re trying to use header files from an earlier NDK (perhaps unintentionally) with the C library from NDK 12."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 1, "creation_date": 1475162189, "post_id": 39751664, "comment_id": 66842509, "body": "@Shark, the reason to consider bringing back <code>bsd_signal()</code> in NDK 13 would be to support <i>existing</i> binaries built against NDK 11 or earlier, and to some extent to support code that calls it directly.  Binaries built against NDK 12 cannot possibly require the system to provide that function."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 1, "creation_date": 1475167367, "post_id": 39751664, "comment_id": 66845701, "body": "We make no guarantees that code built with NDK N-1 will work with NDK N. In general C code will be fine, but the C++ STLs are not ABI stable (this is why they&#39;re in the NDK and not provided by the system). I don&#39;t believe that&#39;s the problem you&#39;re having (a trivial call to <code>signal</code> works fine). It isn&#39;t NDK r11 -&gt; NDK r12 that&#39;s causing you problems, it&#39;s the API level change. r11 and r12 both had a bug with <code>bsd_signal</code> where code built against pre-L couldn&#39;t be linked into code built with L or newer, for the reasons outlined in @serhio&#39;s answer. This is the thing we now support in r13."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1475076550, "last_edit_date": 1475076550, "creation_date": 1475076236, "answer_id": 39751664, "question_id": 39750574, "link": "https://stackoverflow.com/questions/39750574/how-to-port-signal-to-sigaction/39751664#39751664", "title": "How to port signal() to sigaction()?", "body": "<blockquote>\n  <p>The reason i'm trying to get rid of signal() are these build errors [...]</p>\n</blockquote>\n\n<p>The code you present shows the functions in question calling <code>signal()</code>, whereas the linker errors indicate that they are calling <code>bsd_signal()</code> (directly).  If the code presented goes with the error messages presented, then that can only mean that there is an in-scope macro or inline function whose expansion includes a call to <code>bsd_signal()</code>.  Presumably, that macro is named <code>signal()</code>, so as to substitute for a call to the real <code>signal()</code> function.</p>\n\n<p>If that's <em>your</em> macro / inline function then you should be able to fix it to call <code>sigaction()</code> instead (see below).  On the other hand, if it is the <em>system's</em> macro / inline function then the system's header files do not correspond to its C library.  In that case, it is essential to establish a consistent build environment before you do anything else.</p>\n\n<blockquote>\n  <p>So the question is really this: what would be the quickest/easiest//fastest way to replace the <code>signal()</code> calls with <code>sigaction()</code> ones while preserving the current functionality?</p>\n</blockquote>\n\n<p>In order to answer that, one must first determine / divine what the current functionality <em>is</em>, or is supposed to be.  POSIX allows the semantics of using <code>signal()</code> to set a signal's disposition to anything other than <code>SIG_DFL</code> or <code>SIG_IGN</code> to vary.  Specifically, if you set a custom handler for a given signal then the disposition for that signal might or might not be reset to its default when the signal is received.  Additionally, behavior varies with respect to whether the signal being handled is blocked during the execution of the handler.  Resolving that issue was one of the primary purposes for introducing <code>sigaction()</code>.</p>\n\n<p>Supposing, based on the linker errors, that BSD behavior is what you are used to getting, the analog of</p>\n\n<pre><code>oldsig = signal( SIGILL, sigill_handler );\n</code></pre>\n\n<p>would be</p>\n\n<pre><code>struct sigaction old_action;\nstruct sigaction new_action = {\n    .sa_handler = sigill_handler\n};\n\nint result = sigaction(SIGILL, &amp;new_action, &amp;old_action);\nif (result) {\n    // handle error ...\n} else {\n    oldsig = old_action.sa_handler;\n}\n</code></pre>\n\n<p>If you want different semantics (emulating SysV <code>signal()</code> semantics, for instance) then you would use the <code>sa_flags</code> member of <code>new_action</code> to describe the details.  If you want to mask any other signals while the handler runs, then you would want to use the <code>sa_mask</code> member to indicate that.  In any case, you might also consider whether you need to preserve the flags or mask along with the previous handler.</p>\n\n<p>You can substitute that for calling <code>signal()</code> by defining your own macro (not inline function) for <code>signal()</code>, after including all needed system headers.  If your calls to <code>signal()</code> are spread across multiple files, then presumably you would want to put such a macro definition in a local header file.</p>\n"}], "owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1475076550, "creation_date": 1475073316, "last_edit_date": 1475075015, "question_id": 39750574, "link": "https://stackoverflow.com/questions/39750574/how-to-port-signal-to-sigaction", "title": "How to port signal() to sigaction()?", "body": "<p>due to recent problems discovered with NDK12 and NDK13b2, i'm thinking of 'porting' libx264's use of signal() (and missing bsd_signal() in ndk12) to use sigaction() instead.</p>\n\n<p>The problem is, I'm not quite sure what's the simple&amp;fastest way to replace signal() calls with sigaction() ones.</p>\n\n<p>For all i see, it's mainly used in x264-snapshot/common/cpu.c in the following manner:</p>\n\n<p>using the following signal handler:</p>\n\n<pre><code>static void sigill_handler( int sig )\n{\n    if( !canjump )\n    {\n        signal( sig, SIG_DFL );\n        raise( sig );\n    }\n\n    canjump = 0;\n    siglongjmp( jmpbuf, 1 );\n}\n</code></pre>\n\n<p>This is the problematic <code>x264_cpu_detect</code> function... currently, i'm guessing i only need to tackle the ARM version, but i';; still have to replace all occurances of <code>signal()</code> with <code>sigaction()</code> so i might just cover both of them to get the thing building...</p>\n\n<p>FYI - the NDK13 beta2 still has \"unstable\" libc and the build doesn't fail on this part, but rather the first invocation of the <code>rand()</code> function somewhere else... So i'm out of luck and replacing the signal() calls might be better than just waiting for the official NDK13 release. I'm doing this to get rid of text-relocations so i can run the library (and doubango) on API 24 (Android N)</p>\n\n<p>the problematic part of function that invokes <code>signal()</code>:</p>\n\n<pre><code>#elif SYS_LINUX\n\nuint32_t x264_cpu_detect( void )\n{\n    static void (*oldsig)( int );\n\n    oldsig = signal( SIGILL, sigill_handler );\n    if( sigsetjmp( jmpbuf, 1 ) )\n    {\n        signal( SIGILL, oldsig );\n        return 0;\n    }\n\n    canjump = 1;\n    asm volatile( \"mtspr 256, %0\\n\\t\"\n                  \"vand 0, 0, 0\\n\\t\"\n                  :\n                  : \"r\"(-1) );\n    canjump = 0;\n\n    signal( SIGILL, oldsig );\n\n    return X264_CPU_ALTIVEC;\n}\n#endif\n\n#elif ARCH_ARM\n\nvoid x264_cpu_neon_test( void );\nint x264_cpu_fast_neon_mrc_test( void );\n\nuint32_t x264_cpu_detect( void )\n{\n    int flags = 0;\n#if HAVE_ARMV6\n    flags |= X264_CPU_ARMV6;\n\n    // don't do this hack if compiled with -mfpu=neon\n#if !HAVE_NEON\n    static void (* oldsig)( int );\n    oldsig = signal( SIGILL, sigill_handler );\n    if( sigsetjmp( jmpbuf, 1 ) )\n    {\n        signal( SIGILL, oldsig );\n        return flags;\n    }\n\n    canjump = 1;\n    x264_cpu_neon_test();\n    canjump = 0;\n    signal( SIGILL, oldsig );\n#endif\n\n    flags |= X264_CPU_NEON;\n\n    // fast neon -&gt; arm (Cortex-A9) detection relies on user access to the\n    // cycle counter; this assumes ARMv7 performance counters.\n    // NEON requires at least ARMv7, ARMv8 may require changes here, but\n    // hopefully this hacky detection method will have been replaced by then.\n    // Note that there is potential for a race condition if another program or\n    // x264 instance disables or reinits the counters while x264 is using them,\n    // which may result in incorrect detection and the counters stuck enabled.\n    // right now Apple does not seem to support performance counters for this test\n#ifndef __MACH__\n    flags |= x264_cpu_fast_neon_mrc_test() ? X264_CPU_FAST_NEON_MRC : 0;\n#endif\n    // TODO: write dual issue test? currently it's A8 (dual issue) vs. A9 (fast      mrc)\n#endif\n    return flags;\n}\n\n#else\n\nuint32_t x264_cpu_detect( void )\n{\n    return 0;\n}\n</code></pre>\n\n<p>So the question is really this: what would be the quickest/easiest//fastest way to replace the <code>signal()</code> calls with <code>sigaction()</code> ones while preserving the current functionality? </p>\n\n<p>EDIT:\nThe reason i'm trying to get rid of <code>signal()</code> are these build errors:</p>\n\n<pre><code>/home/devshark/SCRATCH/doubango/thirdparties/android/armv5te/lib/dist/libx264.a(cpu.o):cpu.c:function sigill_handler: error: undefined reference to 'bsd_signal'\n\n/home/devshark/SCRATCH/doubango/thirdparties/android/armv5te/lib/dist/libx264.a(cpu.o):cpu.c:function x264_cpu_detect: error: undefined reference to 'bsd_signal'\n/home/devshark/SCRATCH/doubango/thirdparties/android/armv5te/lib/dist/libx264.a(cpu.o):cpu.c:function x264_cpu_detect: error: undefined reference to 'bsd_signal'\n\n/home/devshark/SCRATCH/doubango/thirdparties/android/armv5te/lib/dist/libx264.a(cpu.o):cpu.c:function x264_cpu_detect: error: undefined reference to 'bsd_signal'\n</code></pre>\n\n<p>I already know that this is a known NDK12 problem, that might be solved by bringing <code>bsd_signal</code> back to the libc in NDK13. However, in it' beta state with it's unstable libc - it's currently missing the rand() function and simply waiting for it might not do the trick. But in the worst-case scenario, i guess i'll just have to wait for it and retry after it's release.</p>\n\n<p>But as it currently is, the prebuilt version of the library i want to use has text-relocations and is being rejected by phones running newer API / version of the android OS.</p>\n\n<p>EDIT2:\nI also know that <code>signal()</code> <strong>usually</strong> works by using <code>sigaction()</code> under the hood, but <strong>maybe</strong> i won't get bsd_signal related build-errors... since i'm suspecting that this one isn't using it. It's obviously using bsd_signal, which may or may not be the same underlying thing :/</p>\n"}, {"tags": ["c", "console-application"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1475073291, "post_id": 39750498, "comment_id": 66797237, "body": "Probably not related, but remove the ampersand: <code>scanf(&quot;%s&quot;, &amp;fnamer);</code> -&gt; <code>scanf(&quot;%s&quot;, fnamer);</code>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1475073389, "post_id": 39750498, "comment_id": 66797303, "body": "<a href=\"http://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">why-is-the-gets-function-so-dangerous-that-it-should-not-be-&zwnj;&#8203;used</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475074078, "post_id": 39750498, "comment_id": 66797849, "body": "<code>scanf</code> is complicated to use and useless if the input does not match the scanf format string. Rather use <code>fgets</code>."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 4625665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/43b483e1b669d829b71b6c03b5f553bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ansh", "link": "https://stackoverflow.com/users/4625665/ansh"}, "edited": false, "score": 0, "creation_date": 1475076554, "post_id": 39750709, "comment_id": 66799648, "body": "Error message: Error\t3\terror LNK2019: unresolved external symbol __getchar referenced in function _main"}], "tags": [], "owner": {"reputation": 799, "user_id": 6827403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298f5ce4b083415e22f500eec317043e?s=128&d=identicon&r=PG&f=1", "display_name": "a.costa", "link": "https://stackoverflow.com/users/6827403/a-costa"}, "is_accepted": false, "score": 0, "last_activity_date": 1475073652, "creation_date": 1475073652, "answer_id": 39750709, "question_id": 39750498, "link": "https://stackoverflow.com/questions/39750498/console-not-waiting-for-input-c-language/39750709#39750709", "title": "Console not waiting for input. (C language)", "body": "<p>you have to flush your input after using scanf.</p>\n\n<p>put a <code>getchar()</code> after every scanf</p>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 4625665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/43b483e1b669d829b71b6c03b5f553bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ansh", "link": "https://stackoverflow.com/users/4625665/ansh"}, "edited": false, "score": 0, "creation_date": 1475076495, "post_id": 39750951, "comment_id": 66799606, "body": "So what would be solution? Adding the while statement?"}, {"owner": {"reputation": 76, "user_id": 6888829, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uoWuzp-86_M/AAAAAAAAAAI/AAAAAAAAAGI/c8Pl3RaNBTw/photo.jpg?sz=128", "display_name": "Alexander Nery", "link": "https://stackoverflow.com/users/6888829/alexander-nery"}, "reply_to_user": {"reputation": 155, "user_id": 4625665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/43b483e1b669d829b71b6c03b5f553bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ansh", "link": "https://stackoverflow.com/users/4625665/ansh"}, "edited": false, "score": 0, "creation_date": 1475094890, "post_id": 39750951, "comment_id": 66810274, "body": "Yes, after the scanf. Also consider not using gets(c), and using fgets(c, 1000, stdin); where 1000 is the size of the string that you are reading into."}], "tags": [], "owner": {"reputation": 76, "user_id": 6888829, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uoWuzp-86_M/AAAAAAAAAAI/AAAAAAAAAGI/c8Pl3RaNBTw/photo.jpg?sz=128", "display_name": "Alexander Nery", "link": "https://stackoverflow.com/users/6888829/alexander-nery"}, "is_accepted": false, "score": 0, "last_activity_date": 1475074250, "creation_date": 1475074250, "answer_id": 39750951, "question_id": 39750498, "link": "https://stackoverflow.com/questions/39750498/console-not-waiting-for-input-c-language/39750951#39750951", "title": "Console not waiting for input. (C language)", "body": "<p>You are encountering a very common problem when using stdin to receive input, which is after your first <strong>scanf</strong> call there is a dangling <strong>\\n</strong> character which gets stuck in the buffer from the enter key. To clear this buffer in a <em>portable</em> easy way, add something like</p>\n\n<pre><code>char c;\nwhile ( (c = getchar()) != '\\n' &amp;&amp; c != EOF ) { }  \n</code></pre>\n\n<p>This simply initializes a character, and then calls get char as many times as needed until it reaches '\\n' or 'EOF', which is immediately in your case.</p>\n\n<p>tl;dr : \nYour buffer looks like this </p>\n\n<pre><code>hello.txt\\n &lt;-- \"comes from the enter key\"\n</code></pre>\n\n<p>and when you try to use get(c) it takes the \\n as the next enter key.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1475076551, "creation_date": 1475076551, "answer_id": 39751794, "question_id": 39750498, "link": "https://stackoverflow.com/questions/39750498/console-not-waiting-for-input-c-language/39751794#39751794", "title": "Console not waiting for input. (C language)", "body": "<p>The rule is <strong>never mix scanf and [f]gets</strong>. <code>scanf</code> stops before the next unused character, generaly a blank, and the end of line is composed of blank characters.</p>\n\n<p>You could try to put a dummy <code>fgets</code> between the last <code>scanf</code> and the first real <code>fgets</code>. That will ensure that you are now positionned on a beginning of line before reading. Alternatively, you could read everything in lines with <code>fgets</code>, and parse the lines with <code>sscanf</code>. That is what I prefere as soon as I want my input to be line oriented. And always control return values of input functions, it will avoid a progam suddenly going mad without any indication simply because <strong>one</strong> input gave an ignored error.</p>\n\n<p>And last and not least: <strong>never use <code>gets</code> but only <code>fgets</code></strong>, the former is for decades in the hall of shame as the cause of uncountable buffer overflows</p>\n\n<p>Code could become:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nmain() {\n\n    FILE *fp;\n    char fnamer[100] = \"\";      //Storing File Path/Name of Image to Display\n    char c[1000], *ix;\n    int cr;\n    printf(\"\\n\\nPlease Enter the Full Path of the Image file you want to view: \\n\");\n    cr = scanf(\"%s\", &amp;fnamer);\n    if (cr != 1) {\n        // process error or abort with message\n    }\n    fp = fopen(fnamer, \"w\");\n    if (fp == NULL)\n    {\n        printf(\"\\n%s\\\" File NOT FOUND!\", fnamer);\n        return 1; // do not proceed after a fatal error!\n    }\n    for(;;) {  // read until a newline in input\n        ix = fgets(c, sizeof(c), stdin);\n        if (ix == NULL) {\n            // end of input: abort\n        }\n        if (strcspn(c, \"\\n\") &lt; strlen(c)) break;\n    }\n    printf(\"Enter a sentence:\\n\");\n    ix = fgets(c, sizeof(c), stdin);\n    c[strcspn(c, \"\\n\")] = '\\0'; // remove end of line to get same data as gets\n    fprintf(fp, \"%s\", c);\n    fclose(fp);\n    _getch();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3245, "user_id": 3703534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ApYeB.jpg?s=128&g=1", "display_name": "Sachith", "link": "https://stackoverflow.com/users/3703534/sachith"}, "is_accepted": false, "score": 0, "last_activity_date": 1475076713, "creation_date": 1475076713, "answer_id": 39751856, "question_id": 39750498, "link": "https://stackoverflow.com/questions/39750498/console-not-waiting-for-input-c-language/39751856#39751856", "title": "Console not waiting for input. (C language)", "body": "<pre><code>main() {\n\n  FILE *fp;\n    char fnamer[100]=\"\";        //Storing File Path/Name of Image to Display\n    printf(\"\\n\\nPlease Enter the Full Path of the Image file you want to view: \\n\");\n    fgets ( fnamer,100,stdin); //fgets(name, sizeof(name), stdin);\n    fp=fopen(fnamer,\"w\");\n            if(fp==NULL)\n        {\n            printf(\"\\n%s\\\" File NOT FOUND!\",fnamer);\n            getch();\n            exit(1);\n        }\n\n}\n</code></pre>\n\n<p>I Think best way to do,use <code>fgets</code> insted of <code>scanf</code>,Because \nfgets() can read any open file, but <code>scanf()</code> only reads standard input(user given).</p>\n\n<p><code>fgets()</code> reads a line of text from a file; <code>scanf()</code> can be used for that but also handles conversions\nfrom string to built in numeric types</p>\n"}], "owner": {"reputation": 155, "user_id": 4625665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/43b483e1b669d829b71b6c03b5f553bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ansh", "link": "https://stackoverflow.com/users/4625665/ansh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 963, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1475076713, "creation_date": 1475073120, "last_edit_date": 1475073304, "question_id": 39750498, "link": "https://stackoverflow.com/questions/39750498/console-not-waiting-for-input-c-language", "title": "Console not waiting for input. (C language)", "body": "<p>When I execute my code below. It waits for my input for entering a file name. But it doesn't wait for me to enter a filename, but rather just skips it to the _getch() part of it. I'm unable to add a sentence. </p>\n\n<p>Code not working:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nmain() {\n\n    FILE *fp;\n    char fnamer[100] = \"\";      //Storing File Path/Name of Image to Display\n    printf(\"\\n\\nPlease Enter the Full Path of the Image file you want to view: \\n\");\n    scanf(\"%s\", &amp;fnamer);\n    fp = fopen(fnamer, \"w\");\n    if (fp == NULL)\n    {\n        printf(\"\\n%s\\\" File NOT FOUND!\", fnamer);\n    }\n    char c[1000];\n    printf(\"Enter a sentence:\\n\");\n    gets(c);\n    fprintf(fp, \"%s\", c);\n    fclose(fp);\n    _getch();\n}\n</code></pre>\n\n<p>Code that works and waits for entering a sentence:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;  /* For exit() function */\nint main()\n{\n    char c[1000];\n    FILE *fptr;\n    fptr = fopen(\"program.txt\", \"w\");\n    if (fptr == NULL){\n        printf(\"Error!\");\n        exit(1);\n    }\n    printf(\"Enter a sentence:\\n\");\n    gets(c);\n    fprintf(fptr, \"%s\", c);\n    fclose(fptr);\n    return 0;\n}\n</code></pre>\n\n<p>Both are so similar right there in the end for the prompt asking for a sentence. It doesn't make sense.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1475072444, "post_id": 39750196, "comment_id": 66796612, "body": "First things first. Format your code properly. Second. Why are you initializing an <code>int</code> array` with a quoted constants? It&#39;s not an error, but strange."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475072543, "post_id": 39750196, "comment_id": 66796692, "body": "Did you try even basic debugging ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475072585, "post_id": 39750196, "comment_id": 66796720, "body": "Third. You have a total mess with the array elements and their indices in the loop. You have to rule it out. Before you can do it properly, I&#39;ll suggest you to avoid complex constructs within the <code>for</code> statement."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475072661, "post_id": 39750196, "comment_id": 66796782, "body": "Fourth: a pencil and paper may help here too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475072677, "post_id": 39750196, "comment_id": 66796794, "body": "<code>for (i = arr[0], j = arr[1]; i &lt; arr[n], j = arr[n]; i++, j++)</code> generates warning &quot;warning: left-hand operand of comma expression has no effect [-Wunused-value]&quot;  Review <code>i &lt; arr[n], j = arr[n]</code> as a test condition.  Also  enable all your compiler warnings to save time."}, {"owner": {"reputation": 112081, "user_id": 2231815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1597c347e309f696ff1738128444702b?s=128&d=identicon&r=PG", "display_name": "rakib_", "link": "https://stackoverflow.com/users/2231815/rakib"}, "edited": false, "score": 0, "creation_date": 1475073168, "post_id": 39750196, "comment_id": 66797147, "body": "Just <code>sort</code> the data then it&#39;s easy."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112081, "user_id": 2231815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1597c347e309f696ff1738128444702b?s=128&d=identicon&r=PG", "display_name": "rakib_", "link": "https://stackoverflow.com/users/2231815/rakib"}, "edited": false, "score": 0, "creation_date": 1475073558, "post_id": 39750196, "comment_id": 66797441, "body": "@rakib Just make the input data all zeros - it will make it even simpler..."}], "answers": [{"comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1475073460, "post_id": 39750491, "comment_id": 66797356, "body": "Loop condition needs to be <code>i+1 &lt; n</code> since the code accesses <code>arr[i+1]</code>."}], "tags": [], "owner": {"reputation": 799, "user_id": 6827403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298f5ce4b083415e22f500eec317043e?s=128&d=identicon&r=PG&f=1", "display_name": "a.costa", "link": "https://stackoverflow.com/users/6827403/a-costa"}, "is_accepted": false, "score": 0, "last_activity_date": 1475073094, "creation_date": 1475073094, "answer_id": 39750491, "question_id": 39750196, "link": "https://stackoverflow.com/questions/39750196/program-to-display-the-count-of-the-number-of-times-the-succeeding-element-is-gr/39750491#39750491", "title": "Program to display the count of the number of times the succeeding element is greater than the preceding element", "body": "<p>the problem is in the last for loop. you are doing something really strange for iterating.</p>\n\n<p>to simplify:</p>\n\n<pre><code>for(i=0;i&lt;n;i++){\n      if(arr[i]&lt;arr[i+1])\n          count++;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1475073908, "post_id": 39750559, "comment_id": 66797719, "body": "@KlasLindb&#228;ck Oops. I meant to put <code>j</code>. I fixed it. Thanks."}, {"owner": {"reputation": 1, "user_id": 6056327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed3e6f465963729588dcbfcf83560b2?s=128&d=identicon&r=PG&f=1", "display_name": "StephenCurry30", "link": "https://stackoverflow.com/users/6056327/stephencurry30"}, "edited": false, "score": 0, "creation_date": 1475508323, "post_id": 39750559, "comment_id": 66959684, "body": "Thank you for providing such a detailed solution."}], "tags": [], "owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "is_accepted": false, "score": 1, "last_activity_date": 1475074199, "last_edit_date": 1475074199, "creation_date": 1475073281, "answer_id": 39750559, "question_id": 39750196, "link": "https://stackoverflow.com/questions/39750196/program-to-display-the-count-of-the-number-of-times-the-succeeding-element-is-gr/39750559#39750559", "title": "Program to display the count of the number of times the succeeding element is greater than the preceding element", "body": "<p>Your last for loop is way off. It is usually easier to increment the index into the array.<br>\nFor example, lets say you have this array   :</p>\n\n<pre><code>5 4 3 2 1\n</code></pre>\n\n<p>Your code does this:</p>\n\n<ol>\n<li>Your for loop assigns: <code>5</code> to <code>i</code> and <code>4</code> to <code>j</code>.   </li>\n<li>Then you compare <code>i</code> and <code>j</code> (this is right <em>for now</em>)</li>\n<li>Next you increment <code>i</code> and <code>j</code>, so now they are <code>6</code> and <code>5</code> respectively. This is not what you want.</li>\n</ol>\n\n<p>Also, the condition in your loop is wrong. It will break out of the loop once the value you're looking at (e.g. the first element) is larger than the last element. In my example array it would break right away. (<code>i=5</code> is not less than <code>arr[n]=1</code>.</p>\n\n<hr>\n\n<p>Instead you should increment indexes into the array and break out of the loop when you reach the last index.</p>\n\n<pre><code>for(i = 0, j = 1; j &lt; n; i++, j++) {\n    if(arr[i]&lt;arr[j])\n        count++;\n}\n</code></pre>\n\n<hr>\n\n<p>You also want to make sure <code>n</code> is less than or equal to 10, otherwise you'll be writing outside the array.<br>\nAdd either</p>\n\n<pre><code>if(n &gt; 10) {\n    n = 10;\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if(n &gt; 10) {\n    printf(\"Max number of elements is 10.\\n\");\n    return -1;\n}\n</code></pre>\n\n<p>after you get <code>n</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6056327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed3e6f465963729588dcbfcf83560b2?s=128&d=identicon&r=PG&f=1", "display_name": "StephenCurry30", "link": "https://stackoverflow.com/users/6056327/stephencurry30"}, "edited": false, "score": 0, "creation_date": 1475508213, "post_id": 39750595, "comment_id": 66959610, "body": "Thank you for looking into it"}], "tags": [], "owner": {"reputation": 2950, "user_id": 1312871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c7e105a48afc68fc88adf6a72338da5d?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/1312871/raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1475073651, "last_edit_date": 1475073651, "creation_date": 1475073373, "answer_id": 39750595, "question_id": 39750196, "link": "https://stackoverflow.com/questions/39750196/program-to-display-the-count-of-the-number-of-times-the-succeeding-element-is-gr/39750595#39750595", "title": "Program to display the count of the number of times the succeeding element is greater than the preceding element", "body": "<p>This should do the job for you. The main ingredient is the loop </p>\n\n<pre><code>    for (i = 0; i &lt; n-1; i++)\n    {\n        if (arr[i] &lt; arr[i+1])\n            count++;\n    }\n</code></pre>\n\n<p>Lets say you have 5 elements. The <code>i</code> will be evaluated from 0 to 3.\nIn that case, you are comparing <code>arr[i]</code> to <code>arr[i+1]</code> It means, the loop will be comparing\n<code>arr[0]</code> to <code>arr[1]</code>, <code>arr[1]</code> to <code>arr[2]</code>, <code>arr[2]</code> to <code>arr[3]</code> and finally <code>arr[3]</code> to <code>arr[4]</code>, which is what you want to achieve.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX_ELEMENTS 10\n\nint main(void)\n{\n    int arr[MAX_ELEMENTS] = { '\\0' };\n    int i = 0, n = 0, count = 0;   \n    printf(\"\\nEnter the number of elements in the array: \");\n    scanf(\"%d\", &amp;n);\n\n    if (n &gt; MAX_ELEMENTS)\n    {\n        printf(\"Only %d elements supported\\n\", MAX_ELEMENTS);\n        return -1;\n    }\n\n    printf(\"\\nEnter the elements\");\n    for (i = 0; i &lt; n; i++)\n    {\n        scanf(\"%d\", &amp;arr[i]);\n    }\n\n    printf(\"\\nThe array elements are: \");\n\n    for (i = 0; i &lt; n; i++)\n    {\n        printf(\"%d\\t\", arr[i]);        \n    }\n\n    for (i = 0; i &lt; n-1; i++)\n    {\n        if (arr[i] &lt; arr[i+1])\n            count++;\n    }\n    printf(\"\\nThe count is: %d\", count);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6056327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed3e6f465963729588dcbfcf83560b2?s=128&d=identicon&r=PG&f=1", "display_name": "StephenCurry30", "link": "https://stackoverflow.com/users/6056327/stephencurry30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1475074199, "creation_date": 1475072305, "last_edit_date": 1475072566, "question_id": 39750196, "link": "https://stackoverflow.com/questions/39750196/program-to-display-the-count-of-the-number-of-times-the-succeeding-element-is-gr", "title": "Program to display the count of the number of times the succeeding element is greater than the preceding element", "body": "<p>I've been meaning to write a code to display the count for the number of times the suceceding element is greater than the preceding elements but I dont think I have got the logic right. Here's my code .Kindly give me suggestions to improve the code to get the desired output.</p>\n\n<pre><code>int main(void)\n{\n    int arr[10] = { '\\0' };\n    int i = 0, n = 0, count = 0, j = 0;\n    printf(\"\\nEnter the number of elements in the array: \");\n    scanf(\"%d\", &amp;n);\n    printf(\"\\nEnter the elements\");\n    for (i = 0; i &lt; n; i++)\n    {\n        scanf(\"%d\", &amp;arr[i]);\n    }\n    printf(\"\\nThe array elements are: \");\n    for (i = 0; i &lt; n; i++)\n    {\n        printf(\"%d\\t\", arr[i]);\n    }\n    for (i = arr[0], j = arr[1]; i &lt; arr[n], j = arr[n]; i++, j++)\n    {\n        if (i &lt; j)\n            count++;\n    }\n    printf(\"\\nThe count is: %d\", count);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "sockets", "udp", "data-processing"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6894052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0QdEl.jpg?s=128&g=1", "display_name": "nanasable", "link": "https://stackoverflow.com/users/6894052/nanasable"}, "edited": false, "score": 0, "creation_date": 1475137451, "post_id": 39750180, "comment_id": 66824891, "body": "Thank u very much! This helped :)"}], "tags": [], "owner": {"reputation": 2279, "user_id": 2767436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066110b639f57bb021509bfdc37461e0?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/2767436/rene"}, "is_accepted": true, "score": 1, "last_activity_date": 1475072255, "creation_date": 1475072255, "answer_id": 39750180, "question_id": 39750059, "link": "https://stackoverflow.com/questions/39750059/c-multiple-udp-socket-data-processing/39750180#39750180", "title": "C++ multiple UDP socket data processing", "body": "<p>Don't call select() for each socket separately. Set up a select with both sockets, and then process the available data (from one or two of the sockets).</p>\n"}, {"tags": [], "owner": {"reputation": 112081, "user_id": 2231815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1597c347e309f696ff1738128444702b?s=128&d=identicon&r=PG", "display_name": "rakib_", "link": "https://stackoverflow.com/users/2231815/rakib"}, "is_accepted": false, "score": 0, "last_activity_date": 1475072886, "creation_date": 1475072886, "answer_id": 39750424, "question_id": 39750059, "link": "https://stackoverflow.com/questions/39750059/c-multiple-udp-socket-data-processing/39750424#39750424", "title": "C++ multiple UDP socket data processing", "body": "<p><code>select</code> can handle multiple sockets, so use such way. Doing multiple <code>recvfrom</code> on a single loop is wrong. Rather use select to find out on which socket you have data and from remoteaddr parameter find out from where these data are coming from.</p>\n"}], "owner": {"reputation": 3, "user_id": 6894052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0QdEl.jpg?s=128&g=1", "display_name": "nanasable", "link": "https://stackoverflow.com/users/6894052/nanasable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 39750180, "answer_count": 2, "score": 0, "last_activity_date": 1475072886, "creation_date": 1475072009, "question_id": 39750059, "link": "https://stackoverflow.com/questions/39750059/c-multiple-udp-socket-data-processing", "title": "C++ multiple UDP socket data processing", "body": "<p>I'm a beginner in c++ socket programming and I have a problem that I'm trying to handle for some time. </p>\n\n<p>My task is to process data received from two different sensors. I receive the data through UDP socket and then process the packet (obviously all of that happens in a while loop). I use the data to real time visualisation so I need the whole process to be quick.</p>\n\n<p>Everything is all right as long as I try to receive data from one sensor. When I want to do it with two sensors (and hence with two recvfrom() functions in one loop), here is when my problems begin. The processing is really slow and consequently I miss some packets. I'm aware of the fact that the recvfrom() function is a blocking call and I handled it with select() function, thus I know it's not the source of the problem. </p>\n\n<p>Here is the part of the code that seems to be responsible for the fuss:</p>\n\n<pre><code> while (1)\n{\n    SingleSocketReceiver(&amp;socket_1, port_1, scene_1, ptrScene_1, model);\n    SingleSocketReceiver(&amp;socket_2, port_2, scene_2, ptrScene_2, model);\n }\n</code></pre>\n\n<p>When I comment the second SingleSocketReceiver() function, everything works fine. </p>\n\n<p>And here is what the SingleSocketReceiver() function comprises:</p>\n\n<pre><code>int SingleSocketReceiver(UDPsocket* socket, uint16_t port,pcl::PointCloud&lt;pcl::PointXYZ&gt; scene, pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr ptrScene,  pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr model)\n</code></pre>\n\n<p>{</p>\n\n<pre><code>struct timeval tv;\nfd_set rfds;\n\nFD_ZERO(&amp;rfds);\nFD_SET(socket-&gt;pSocket,&amp;rfds);\n\ntv.tv_sec = 1;\ntv.tv_usec = 0;\n\n    if ((socket-&gt;rc = select(FD_SETSIZE,&amp;rfds,NULL,NULL,&amp;tv)) &lt; 0)\n    {\n        printf(\"Port No. %d: ERROR! - no data received!\\n\", port);\n        return RESULT_ERROR;\n    }\n\n   else if (socket-&gt;rc == 0)\n    {\n      printf(\"Port No. %d: Timeout - no data received!\\n\", port);\n      return RESULT_ERROR;\n\n    }\n    socket-&gt;rc=recvfrom(socket-&gt;pSocket,(char*)socket-&gt;udpPacketBuf,UDP_PACKET_BUF_LEN,0,&amp;socket-&gt;remoteAddr,&amp;socket-&gt;remoteAddrLen);\n\n    if(socket-&gt;rc==SOCKET_ERROR)\n    {\n        printf(\"Socket for port No.%d: Error in recvfrom\\n\", port);\n        return RESULT_ERROR;\n    }\n\n    else\n    {\n        // Check the packet counter for missing packets\n        if (socket-&gt;previous_packet_counter_valid)\n        {\n\n            if ((socket-&gt;ph-&gt;PacketCounter - socket-&gt;previous_packet_counter) != 1)\n            {\n                printf(\"Port No.%d: Packet Counter jumped from %u to %u (missing packets; try to redirect output)\\n\", port, socket-&gt;previous_packet_counter, socket-&gt;ph-&gt;PacketCounter);\n\n                socket-&gt;startOfChannelFound = 0;\n            }\n        }\n        socket-&gt;previous_packet_counter = socket-&gt;ph-&gt;PacketCounter;\n        socket-&gt;previous_packet_counter_valid = 1;\n        // is this the channel with our data?\n        if (socket-&gt;ph-&gt;ChannelID == socket-&gt;customerDataChannel)\n        {\n\n\n            if (socket-&gt;ph-&gt;IndexOfPacketInChannel == 0)\n            {\n                socket-&gt;startOfChannelFound = 1;\n\n                if (socket-&gt;channel_buf_size == 0)\n                {\n                    socket-&gt;channel_buf_size = socket-&gt;ph-&gt;TotalLengthOfChannel;\n                    socket-&gt;channelBuf = (int8_t*) malloc(socket-&gt;channel_buf_size);\n                }\n\n                // as we reuse the buffer we clear it at the beginning of a transmission\n                memset(socket-&gt;channelBuf, 0, socket-&gt;channel_buf_size);\n                socket-&gt;pos_in_channel = 0;\n            }\n\n           if (socket-&gt;startOfChannelFound)\n            {\n                processPacket(socket-&gt;udpPacketBuf, socket-&gt;rc, socket-&gt;channelBuf, socket-&gt;channel_buf_size, &amp;socket-&gt;pos_in_channel);\n\n                if (socket-&gt;ph-&gt;IndexOfPacketInChannel == socket-&gt;ph-&gt;NumberOfPacketsInChannel -1)\n                {\n\n\n                    processChannel8(socket-&gt;channelBuf, socket-&gt;pos_in_channel);\n                    displayData();\n                    createPointCloud(scene, ptrScene, model);\n                 }\n            }\n        }\n}\nreturn RESULT_OK;\n</code></pre>\n\n<p>}</p>\n\n<p>I would be extremely grateful if someone suggest what the real problem might be and what are the possible ways of handling it. Unfortunately, I cannot show you my whole source code as I do it for my work and I am not allowed to present it publicly. </p>\n\n<p>Please forgive me my lack of knowledge in this field. I'd willingly answer all of the additional questions.</p>\n"}, {"tags": ["c", "algorithm", "for-loop"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1475072218, "post_id": 39750058, "comment_id": 66796436, "body": "What? You can&#39;t have the number of actual loops (the number of <code>for</code>s in the source code) depend on some run-time value. C is a compiled language, it doesn&#39;t work like that. This sounds like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1475072248, "post_id": 39750058, "comment_id": 66796461, "body": "You can&#39;t implement a nested loop with a variable depth. You can have a recursion, if you really want."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1475072852, "post_id": 39750058, "comment_id": 66796919, "body": "I agree: this sounds like an XY problem. What is the real problem you&#39;re trying to solve?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1475073308, "post_id": 39750058, "comment_id": 66797253, "body": "You can easily loop recursively through nested data of unknown size without using the intrinsically horrible language &quot;feature&quot; known as recursive functions. You just need some means to return to the previous level of iteration, is all."}, {"owner": {"reputation": 119, "user_id": 3932908, "user_type": "registered", "profile_image": "https://graph.facebook.com/1299182880/picture?type=large", "display_name": "Henry", "link": "https://stackoverflow.com/users/3932908/henry"}, "edited": false, "score": 0, "creation_date": 1475073663, "post_id": 39750058, "comment_id": 66797521, "body": "OK so I realize that there is no way to implement this directly, but the link I provided shows a solution that gives mimics this but only for the case where there is no code between the nested loops. It just seemed like it should be easy to generalize, but I haven&#39;t been able to figure it out yet."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1475073956, "post_id": 39750058, "comment_id": 66797750, "body": "If you don&#39;t want to function call recursion, you can have an array whose length is the number of nested loops, and whose elements contain the terminal count value and a loop counter for the corresponding loop. You also need some code to permute its way though all those loop counters and do something for each permutation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3261763"}, "edited": false, "score": 0, "creation_date": 1475076582, "post_id": 39750058, "comment_id": 66799664, "body": "be careful of the language functions properties : it is not the same algo if they transmit the arguments by values"}], "answers": [{"tags": [], "owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "is_accepted": false, "score": 3, "last_activity_date": 1476017463, "creation_date": 1476017463, "answer_id": 39943823, "question_id": 39750058, "link": "https://stackoverflow.com/questions/39750058/variable-number-of-for-loops-with-code-in-between/39943823#39943823", "title": "Variable Number of for loops with code in between", "body": "<p>The general approach is to </p>\n\n<ol>\n<li>Write a recursive function.</li>\n<li>If recursion is not for some reason appropriate for your code (e.g. very long recursion depth, or the ability to suspend the execution is required), then convert the recursive version to an iterative one by explicitly modeling the stack.</li>\n</ol>\n\n<p>Doing \u21161 is easy:</p>\n\n<pre><code>void f(int depth, int initial, int *cOR)\n{\n    if(your termination condition)\n    {\n        // some other stuff inside the final loop, and...\n        return;\n    }\n\n    for(int i = 0; i &lt; MAX; ++i)\n    {\n        cOR[depth] = initial + move[i];\n        f(depth+1, cOR[depth]);\n    }\n}\n</code></pre>\n\n<p>And call it like so:</p>\n\n<pre><code>f(0, initial, cOR);\n</code></pre>\n\n<p>Now we head to \u21162, i.e. converting to a non-recursive version. The extra state we need is what was stored on the stack before: the values of the <code>i</code> variables. So here we go:</p>\n\n<pre><code>int i[max_depth];\nint depth = 0;\n\nfor(;;)\n{\n    if(your termination condition)\n    {\n        // some other stuff inside the final loop, and...\n\n        do {\n            if(--depth &lt; 0)\n                return;\n        } while(++i[depth] &gt;= MAX);\n    }\n    else\n        i[depth] = 0;\n\n    cOR[depth] = (depth &gt; 0 ? cOR[depth-1] : initial) + move[i[depth]];\n    ++depth;\n}\n</code></pre>\n\n<p>If you can't estimate <code>max_depth</code> a priori then you can switch to a dynamically allocated array that grows as you need.</p>\n"}], "owner": {"reputation": 119, "user_id": 3932908, "user_type": "registered", "profile_image": "https://graph.facebook.com/1299182880/picture?type=large", "display_name": "Henry", "link": "https://stackoverflow.com/users/3932908/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "closed_date": 1476602575, "answer_count": 1, "score": 0, "last_activity_date": 1476017463, "creation_date": 1475072005, "last_edit_date": 1495540411, "question_id": 39750058, "link": "https://stackoverflow.com/questions/39750058/variable-number-of-for-loops-with-code-in-between", "closed_reason": "Needs more focus", "title": "Variable Number of for loops with code in between", "body": "<p>So the problem I have is that I want to implement N for loops in the following way (where N is a variable):</p>\n\n<pre><code>for i0=0:MAX\n   cOR[0] = initial + move[i0];\n       for i1=0:MAX\n           cOR[1] = cOR[0] + move[i1];\n                ....\n                some other stuff inside the final loop\n</code></pre>\n\n<p>(cOR is a vector of length equal to the number of for loops)</p>\n\n<p>So I found this solution that works when you just have the nested loops (<a href=\"https://stackoverflow.com/a/20577981/3932908\">https://stackoverflow.com/a/20577981/3932908</a>) but have been struggling to modify it for my particular case which requires code in between the for loops. Is there a simple way to implement this or is a different approach needed?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 1, "creation_date": 1475070680, "post_id": 39749388, "comment_id": 66795170, "body": "debugger, printfs, any research?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1475070886, "post_id": 39749388, "comment_id": 66795325, "body": "I cannot reproduce the behavior you describe."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1475070926, "post_id": 39749388, "comment_id": 66795357, "body": "<a href=\"https://linux.die.net/man/3/fgetc\" rel=\"nofollow noreferrer\">fgetc</a> returns an <code>int</code>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1475071047, "post_id": 39749388, "comment_id": 66795460, "body": "When you fail to open a file, it is extremely useful to tell the user why: <code>const char *path = argc &gt; 1 ? argv[1] : &quot;filename.opt&quot;; FILE *fp=fopen(path, &quot;r+&quot;); if(fp==NULL) { perror(path); exit(1);}</code>  <code>perror</code> will print the filename and the reason it failed to open on stderr."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1475071720, "post_id": 39749388, "comment_id": 66796037, "body": "Do not pass an integer literal as the third argument to <code>fseek()</code>, as no significance for any particular value is specified.  Instead, use one of the macros defined for this purpose (<code>SEEK_SET</code>, <code>SEEK_CUR</code>, or <code>SEEK_END</code>).  The values to which these macros expand are not specified."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475071748, "post_id": 39749388, "comment_id": 66796057, "body": "Do check the return values of your function calls for return values indicating errors."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475074651, "post_id": 39749388, "comment_id": 66798294, "body": "&quot;Why i am not able to read / as a single character in my code?&quot; and the first value read was a <code>&#39;&#47;&#39;</code> as you report output was &quot;0    /&quot;.  Looks like code is reading <code>&#39;&#47;&#39;</code> as a single character.  So what is the real problem/question?"}, {"owner": {"reputation": 1, "user_id": 6893194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576d34ec2d7421800e934f12ebd90e57?s=128&d=identicon&r=PG&f=1", "display_name": "phanindra", "link": "https://stackoverflow.com/users/6893194/phanindra"}, "edited": false, "score": 0, "creation_date": 1475078837, "post_id": 39749388, "comment_id": 66801166, "body": "Even i replaced third argument in the fseek  by SEEK_cur also i got the"}, {"owner": {"reputation": 1, "user_id": 6893194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576d34ec2d7421800e934f12ebd90e57?s=128&d=identicon&r=PG&f=1", "display_name": "phanindra", "link": "https://stackoverflow.com/users/6893194/phanindra"}, "edited": false, "score": 0, "creation_date": 1475079502, "post_id": 39749388, "comment_id": 66801587, "body": "actually i want output like   0    /   1   U     2   T ....; like this .Because i want file pointer takes  each character separately including  &#39;/&#39;   and i got the output as i required for all  remaining .opt files .But only this file iam unable to get .I want to know what is the reason behind that opt file."}, {"owner": {"reputation": 1, "user_id": 6893194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576d34ec2d7421800e934f12ebd90e57?s=128&d=identicon&r=PG&f=1", "display_name": "phanindra", "link": "https://stackoverflow.com/users/6893194/phanindra"}, "edited": false, "score": 0, "creation_date": 1475079587, "post_id": 39749388, "comment_id": 66801647, "body": "Hi chux in the output we have n-vale   character value;   where n-value is character pointer which starts from 0 i.e starting character of the file and its respective character value. here for both characters &#39;/&#39; and  &#39;U&#39; it&#39;s character point is 0 only."}], "owner": {"reputation": 1, "user_id": 6893194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576d34ec2d7421800e934f12ebd90e57?s=128&d=identicon&r=PG&f=1", "display_name": "phanindra", "link": "https://stackoverflow.com/users/6893194/phanindra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475070603, "creation_date": 1475070367, "last_edit_date": 1475070603, "question_id": 39749388, "link": "https://stackoverflow.com/questions/39749388/why-i-am-not-able-to-read-as-a-single-character-in-my-code", "title": "Why i am not able to read / as a single character in my code?", "body": "<pre><code>int main()\n{ \n    char name[50]; \n\n    FILE *fp;\n    fp=fopen(\"filename.opt\",\"r+\");\n    if(fp==NULL)\n    {\n        printf(\"error in opening file\");\n        return (1);\n    }   \n    long n=ftell(fp);\n\n    printf(\"%ld\\t\",n);\n    char ch=fgetc(fp);\n    printf(\"%c\\n\",ch);\n    n=ftell(fp);\n    printf(\"%ld\\t\",n);\n    ch=fgetc(fp);\n    printf(\"%c\\n\",ch);\n    n=ftell(fp);\n    printf(\"%ld\\t\",n);\n    ch=fgetc(fp);\n    printf(\"%c\\n\",ch);\n    fseek(fp,-1,1);\n    n=ftell(fp);\n    printf(\"%ld\\t\",n);\n    ch=fgetc(fp);\n    printf(\"%c\",ch);\n\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<p>input string in .opt file is like /UGTMN....</p>\n\n<p>output I got is like below </p>\n\n<pre><code>0    /\n0    U\n1    T\n1    U  ......&gt; \n</code></pre>\n\n<ol>\n<li>how it is actually taking. Is o/p varies if we use.opt file generated  from     different operating system(say linux) and compile the code in the windows.</li>\n<li>when i go back after initial reading it shows different character to   previous one? see.....>\nIF any one knows please help me!!!</li>\n</ol>\n"}, {"tags": ["c", "escaping"], "comments": [{"owner": {"reputation": 1699, "user_id": 1456253, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Wyv1R.jpg?s=128&g=1", "display_name": "code11", "link": "https://stackoverflow.com/users/1456253/code11"}, "edited": false, "score": 0, "creation_date": 1475069963, "post_id": 39749188, "comment_id": 66794543, "body": "Similar question <a href=\"http://stackoverflow.com/questions/9582781/c-sharp-two-double-quotes\" title=\"c sharp two double quotes\">stackoverflow.com/questions/9582781/c-sharp-two-double-quote&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 900, "user_id": 2074379, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZWMGe.jpg?s=128&g=1", "display_name": "The Apache", "link": "https://stackoverflow.com/users/2074379/the-apache"}, "edited": false, "score": 0, "creation_date": 1475069981, "post_id": 39749188, "comment_id": 66794561, "body": "If the braces are also to be printed, you gotta use <code>printf(&quot;\\(\\&quot;Whatever! \\&quot; He said \\&quot; The sparrows are flying  again. \\&quot;\\&quot;)&quot;);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475072187, "post_id": 39749188, "comment_id": 66796408, "body": "<code>printf(&quot;  \\&quot;  &quot; &quot;);</code> should generate a compiler error."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475072242, "post_id": 39749188, "comment_id": 66796456, "body": "<i>need to print</i> sample conatins smart quotes and not <code>&quot;</code>.  Is that the issue?"}], "answers": [{"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 1, "last_activity_date": 1475069960, "creation_date": 1475069960, "answer_id": 39749239, "question_id": 39749188, "link": "https://stackoverflow.com/questions/39749188/double-quotes-in-c-language/39749239#39749239", "title": "Double quotes in C language", "body": "<p>For each double-quote you wish to appear within the string, you need both the backslash and the double quote.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475072333, "post_id": 39749262, "comment_id": 66796535, "body": "<code>\\\u201c</code> is not a defined escape sequence.  OP is using smart quotes."}, {"owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "edited": false, "score": 0, "creation_date": 1475073996, "post_id": 39749262, "comment_id": 66797786, "body": "I will argue that the OP never said anything about &quot;smart quotes&quot; even if that is what came out when the post rendered.  MSWord does convenient stuff like that.  C, however, does not.  If the OP had asked about smart quotes, you would be correct."}], "tags": [], "owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "is_accepted": false, "score": 0, "last_activity_date": 1475070016, "creation_date": 1475070016, "answer_id": 39749262, "question_id": 39749188, "link": "https://stackoverflow.com/questions/39749188/double-quotes-in-c-language/39749262#39749262", "title": "Double quotes in C language", "body": "<p>You escape whatever quote you wish to be ignored as code and used as string.\nSo in your case it would look like:</p>\n\n<pre><code>printThis(\u201c\\\"Whatever!\\\u201d He said \\\u201cThe Sparrows are flying again.\\\u201d\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475072301, "post_id": 39749287, "comment_id": 66796510, "body": "<code>\\\u201c</code> is not a defined escape sequence.  OP is using smart quotes."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475073114, "post_id": 39749287, "comment_id": 66797113, "body": "Thanks. didn&#39;t see that"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475073360, "post_id": 39749287, "comment_id": 66797279, "body": "Embarrassing to post code that compiles with a warning like &quot;unknown escape sequence: &#39;\\224&#39;&quot;.  To my chagrin I&#39;ve made similar mistakes too often.  BTW <i>using the backslash would not cause a misbehaviour even though the double quotes are &quot;smart quotes&quot;</i> is not supported by the C spec."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475080379, "post_id": 39749287, "comment_id": 66802197, "body": "yeah... compiled it in a hurry online... no warnings there :("}], "tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 0, "last_activity_date": 1475073087, "last_edit_date": 1475073087, "creation_date": 1475070077, "answer_id": 39749287, "question_id": 39749188, "link": "https://stackoverflow.com/questions/39749188/double-quotes-in-c-language/39749287#39749287", "title": "Double quotes in C language", "body": "<p>the backslash is what allows you to use double quotes and other special charachters. For each one, you should use a single backslash:</p>\n\n<pre><code>printf(\"\\\"\") --&gt; \"\nprintf(\"\\'\") --&gt; '\nprintf(\"\\\\\") --&gt; \\\n</code></pre>\n\n<p>and so on</p>\n\n<p>so  <code>printf(\"\\\u201cWhatever!\\\u201d He said \\\u201cThe Sparrows are flying again.\\\u201d\")</code> would give you your desired output</p>\n\n<p><strong>EDIT:</strong> As Chux mentioned, <code>\u201d</code> is no regular double quotes  <code>\"</code> and in this case there is no need for a backslash and <code>printf(\"\u201cWhatever!\\\u201d He said \\\u201cThe Sparrows are flying again.\u201d\")</code> would suffice. <em>BUT</em>, using the backslash would not cause a misbehaviour even though the double quotes are \"smart quotes\"</p>\n"}, {"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1475087080, "creation_date": 1475087080, "answer_id": 39755003, "question_id": 39749188, "link": "https://stackoverflow.com/questions/39749188/double-quotes-in-c-language/39755003#39755003", "title": "Double quotes in C language", "body": "<p>This is a double-quote as recognized by the C compiler: <code>\"</code>. None of the following are: <code>\u201c\u201d</code>. See the difference?</p>\n\n<p>Thus, your code should read, simply:</p>\n\n<pre><code>printf(\"\u201cWhatever!\u201d He said \u201cThe Sparrows are flying again.\u201d\\n\");\n</code></pre>\n\n<p>If you don't want to use the \"smart\" quotes, you'll need to change to regular quotes and escape <em>all</em> of them:</p>\n\n<pre><code>printf(\"\\\"Whatever!\\\" He said \\\"The Sparrows are flying again.\\\"\\n\");\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6893928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10211087063349933/picture?type=large", "display_name": "Hamza Azam", "link": "https://stackoverflow.com/users/6893928/hamza-azam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1791, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1475087080, "creation_date": 1475069832, "last_edit_date": 1475070400, "question_id": 39749188, "link": "https://stackoverflow.com/questions/39749188/double-quotes-in-c-language", "title": "Double quotes in C language", "body": "<p>Whenever we need to print double quotes using backslash (escape character) do we have to use it twice while opening the quotes and closing it or just once for both. </p>\n\n<p>i.e like this: </p>\n\n<pre><code>printf(\"  \\\" \\\"  \");\n</code></pre>\n\n<p>or like this:</p>\n\n<pre><code>printf(\"  \\\"  \" \");\n</code></pre>\n\n<p>which one is correct?</p>\n\n<p>I need to print (<code>\u201cWhatever!\u201d He said \u201cThe Sparrows are flying again.\u201d</code>)</p>\n"}, {"tags": ["ios", "objective-c", "c", "iphone"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1475069865, "post_id": 39749115, "comment_id": 66794463, "body": "you use C++ files, but you tag your question as everything but C++. Can you edit the tags? and the error means that you&#39;re missing some includes. Maybe the C++ headers miss the <code>extern &quot;C&quot;</code> wrappers? Can you show <code>P2PLib.h</code> ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1475070743, "post_id": 39749115, "comment_id": 66795221, "body": "You don&#39;t have the definition of this function in your header. Check your header and/or spelling. Also don&#39;t post images of code, post the code as text!"}, {"owner": {"reputation": 3245, "user_id": 4970453, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/5IV5O.jpg?s=128&g=1", "display_name": "Varinder Singh  iPhone Dev", "link": "https://stackoverflow.com/users/4970453/varinder-singh-iphone-dev"}, "edited": false, "score": 0, "creation_date": 1475070807, "post_id": 39749115, "comment_id": 66795276, "body": "hi Jean-Fran&#231;ois Fabre,    My &quot;P2PLib.h&quot; File code is <a href=\"http://paste.ofcode.org/BDSXSP3e7yxg4bJEVP2DQk\" rel=\"nofollow noreferrer\">paste.ofcode.org/BDSXSP3e7yxg4bJEVP2DQk</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475071043, "post_id": 39749115, "comment_id": 66795455, "body": "Have you tried to actually compile it? It could be just the IDE false alarm."}, {"owner": {"reputation": 3245, "user_id": 4970453, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/5IV5O.jpg?s=128&g=1", "display_name": "Varinder Singh  iPhone Dev", "link": "https://stackoverflow.com/users/4970453/varinder-singh-iphone-dev"}, "edited": false, "score": 0, "creation_date": 1475071220, "post_id": 39749115, "comment_id": 66795620, "body": "Yes, i have  compiled it. it is showing error @ Eugene Sh."}, {"owner": {"reputation": 3245, "user_id": 4970453, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/5IV5O.jpg?s=128&g=1", "display_name": "Varinder Singh  iPhone Dev", "link": "https://stackoverflow.com/users/4970453/varinder-singh-iphone-dev"}, "edited": false, "score": 0, "creation_date": 1475071341, "post_id": 39749115, "comment_id": 66795740, "body": "Guys Basically i am objective c developer.i am using C++ library for iP Camera"}, {"owner": {"reputation": 159, "user_id": 5840898, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/d4d79286ad883d79aacd69cbca121036?s=128&d=identicon&r=PG&f=1", "display_name": "Mss iOS", "link": "https://stackoverflow.com/users/5840898/mss-ios"}, "edited": false, "score": 0, "creation_date": 1475071499, "post_id": 39749115, "comment_id": 66795881, "body": "I am facing same Error."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1475081451, "post_id": 39749115, "comment_id": 66802849, "body": "It might be something to do with the <code>P2P_API</code> macros in the header file, which seem to be defined as appropriate for MS Windows unless the <code>__linux</code> macro is defined. Is there a version of the header file that is more appropriate for iOS?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475194782, "post_id": 39749115, "comment_id": 66857816, "body": "it could be the compiler is not seeing both parameter to the function as <code>char *</code>"}], "owner": {"reputation": 3245, "user_id": 4970453, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/5IV5O.jpg?s=128&g=1", "display_name": "Varinder Singh  iPhone Dev", "link": "https://stackoverflow.com/users/4970453/varinder-singh-iphone-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475069655, "creation_date": 1475069655, "last_edit_date": 1495541212, "question_id": 39749115, "link": "https://stackoverflow.com/questions/39749115/how-to-remove-implicit-declaration-of-function-lib-is-invalid-in-c99", "title": "How to remove implicit declaration of function &quot;lib&quot; is invalid in c99", "body": "<p>How to resolve this error. i am using c++ files </p>\n\n<pre><code>#include \"typedef.h\"\n#include \"P2PLib.h\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/I2EjI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I2EjI.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have Checked this <a href=\"https://stackoverflow.com/a/15850385/4970453\">Link</a> but not working </p>\n"}, {"tags": ["c", "arrays", "sorting", "qsort"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475070559, "post_id": 39749111, "comment_id": 66795068, "body": "Note that <code>b - a</code> sorts in descending order."}, {"owner": {"reputation": 87, "user_id": 6813627, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2e8cedc6c4fe77742fbe6b18272fc66?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/6813627/aaa"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1475070633, "post_id": 39749111, "comment_id": 66795136, "body": "yes. I want descending order @Maxim Egorushkin"}], "answers": [{"tags": [], "owner": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "is_accepted": false, "score": 0, "last_activity_date": 1475070564, "creation_date": 1475070564, "answer_id": 39749479, "question_id": 39749111, "link": "https://stackoverflow.com/questions/39749111/storing-the-original-index-after-sorting-using-qsort/39749479#39749479", "title": "storing the original index after sorting using qsort", "body": "<p>You need to sort pairs of numbers, for example by storing each piece of information in a struct:</p>\n\n<pre><code>struct player {\n  int data;\n  int index;\n};\n\nstruct player A[] = {{2,0}, {3,1}, {5,2}, {4,3}, {1,4}};\n\nint compare (const void * a, const void * b)\n{\n   return ( ((struct player*)b)-&gt;data - ((struct player*)a)-&gt;data );\n}\n\nint main ()\n{\n  int n;\n  qsort (A, 5, sizeof(struct player), compare);\n  for (n=0; n&lt;5; n++)\n  printf (\"data=%d, index=%d\\n\", A[n].data, A[n].index);\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 4, "last_activity_date": 1475070696, "creation_date": 1475070696, "answer_id": 39749535, "question_id": 39749111, "link": "https://stackoverflow.com/questions/39749111/storing-the-original-index-after-sorting-using-qsort/39749535#39749535", "title": "storing the original index after sorting using qsort", "body": "<p>It is a common requirement. A possible way is to replace the array of ints with and array of 2 element structures:</p>\n\n<pre><code>struct PlayerScore {\n    int playerId;\n    int score;\n}\n</code></pre>\n\n<p>Your code could become:</p>\n\n<pre><code>#include &lt;stdio.h&gt;      \n#include &lt;stdlib.h&gt;     \n\nint A[] = {2,3,5,4,1};\n#define N sizeof(A)/sizeof(A[0])\n\nstruct PlayerScore {\n    int playerId;\n    int score;\n};\nint compare (const void * a, const void * b)\n{\n    return ( (*(struct PlayerScore*)b).score - (*(struct PlayerScore*)a).score );\n}\n\nint main ()\n{\n  int n;\n  struct PlayerScore ps[N];\n  for(n=0;n&lt;N; n++) {\n      ps[n].playerId = n;\n      ps[n].score = A[n];\n  }\n  qsort (ps, 5, sizeof(struct PlayerScore), compare);\n  for (n=0; n&lt;N; n++)\n      printf (\"%d (%d) \",ps[n].score, ps[n].playerId);\n  return 0;\n}\n</code></pre>\n\n<p>And you finally get:</p>\n\n<pre><code>5 (2) 4 (3) 3 (1) 2 (0) 1 (4)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "edited": false, "score": 1, "creation_date": 1475073085, "post_id": 39749543, "comment_id": 66797093, "body": "You are not answering the question."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "edited": false, "score": 1, "creation_date": 1475073622, "post_id": 39749543, "comment_id": 66797484, "body": "@vz0 I am, I&#39;m pointing out that this should be re-designed entirely. I would not do the OP a favour by pretending that their problem makes sense and lead them astray to complete obfuscation, by inventing some mess of magic numbers. This is essentially the same answer as posted as Serge, though he was perhaps a bit more pedagogic with his nice example."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1475070708, "creation_date": 1475070708, "answer_id": 39749543, "question_id": 39749111, "link": "https://stackoverflow.com/questions/39749111/storing-the-original-index-after-sorting-using-qsort/39749543#39749543", "title": "storing the original index after sorting using qsort", "body": "<p>Your problem has nothing to do with qsort as such, but merely program design. </p>\n\n<p>\"In this array, each of the index represents a player\" is the problem. You have invented a weird dependency between the array indexes and the contents, even though you want to change the array indexes.</p>\n\n<p>Instead of arrays of int, filled with cryptic \"magic numbers\", make an array of structs with meaningful data.</p>\n\n<p>It could for example be something like this:</p>\n\n<pre><code>typedef struct\n{\n  // whatever makes sense to store here, names, stats etc      \n} player_t;\n\nplayer_t players [] = \n{\n  {0, ...},\n  {1, ...},\n};\n</code></pre>\n\n<p>Now you can qsort that table based on whatever you like. </p>\n\n<p>Please note that for performance reasons, it might be better to declare an array of pointers-to-struct and then qsort that array. Far less data shuffling for qsort that way.</p>\n"}], "owner": {"reputation": 87, "user_id": 6813627, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2e8cedc6c4fe77742fbe6b18272fc66?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/6813627/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2022, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1475070708, "creation_date": 1475069650, "last_edit_date": 1475070346, "question_id": 39749111, "link": "https://stackoverflow.com/questions/39749111/storing-the-original-index-after-sorting-using-qsort", "title": "storing the original index after sorting using qsort", "body": "<p>Suppose I have the following array:</p>\n\n<pre><code>int A[5]={2,3,5,4,1};\n</code></pre>\n\n<p>In this array, each of the index represents a player. For example:</p>\n\n<pre><code>A[0]=player 0\nA[1]=player 1\n.....\n</code></pre>\n\n<p>I want to sort the array in descending order like this:</p>\n\n<pre><code>A[5]={5,4,3,2,1};\n</code></pre>\n\n<p>and also I want to trace the previous index of the players so that I can write the sorted array like this:</p>\n\n<pre><code>{player 2, player 4, player 1, player 0,player 4} \n</code></pre>\n\n<p>In a word, I want to trace the original index. I have written a program in C using qsort to arrange the elements in descending order.</p>\n\n<pre><code>#include &lt;stdio.h&gt;      \n#include &lt;stdlib.h&gt;     \n\nint A[] = {2,3,5,4,1};\n\nint compare (const void * a, const void * b)\n{\n   return ( *(int*)b - *(int*)a );\n}\n\nint main ()\n{\n  int n;\n  qsort (A, 5, sizeof(int), compare);\n  for (n=0; n&lt;5; n++)\n  printf (\"%d \",A[n]);\n  return 0;\n}\n</code></pre>\n\n<p>Is is possible to trace the original index also using this qsort? </p>\n"}, {"tags": ["c", "makefile"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3493202"}, "edited": false, "score": 0, "creation_date": 1475130960, "post_id": 39749791, "comment_id": 66821130, "body": "Thank you. I am always confused with makefiles and lack a handy oversight of commands to use with it. Any good clue for tutorials?"}, {"owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "edited": false, "score": 0, "creation_date": 1475133253, "post_id": 39749791, "comment_id": 66822405, "body": "@Sven  The commands within the recipe parts of a makefile are just shell commands, and are interpreted by the shell.  The make manual <a href=\"https://www.gnu.org/software/make/manual/make.html#toc-Writing-Recipes-in-Rules\" rel=\"nofollow noreferrer\">gnu.org/software/make/manual/&hellip;</a> has more details."}], "tags": [], "owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "is_accepted": true, "score": 0, "last_activity_date": 1475071289, "creation_date": 1475071289, "answer_id": 39749791, "question_id": 39748682, "link": "https://stackoverflow.com/questions/39748682/move-existing-file-with-a-makefile/39749791#39749791", "title": "Move existing file with a makefile", "body": "<p>Is the answer you're looking for as simple as:</p>\n\n<pre><code>$(CMD) $(APPL)/$(CLASS).class &gt;$(CLASS).raw_ujc\n-mv $(APPL)/rawf .\n</code></pre>\n\n<p>This moves the file <code>rawf</code> from the <code>$(APPL)</code> directory to the current directory after the <code>$(CMD)</code> has executed.  The <code>-</code> prefix ignores errors in the move (if the <code>rawf</code> file is not there for example) and might not be something you want.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3493202"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2014, "favorite_count": 0, "accepted_answer_id": 39749791, "answer_count": 1, "score": 0, "last_activity_date": 1475071289, "creation_date": 1475068598, "question_id": 39748682, "link": "https://stackoverflow.com/questions/39748682/move-existing-file-with-a-makefile", "title": "Move existing file with a makefile", "body": "<p>I have in my makefile the following code:</p>\n\n<pre><code>CONTIKI_PROJECT = blank\nUPNP = ..\nRT = $(UPNP)/../uJ/BUILDENV/RT/\nAPPL = $(UPNP)/../uJ/Applications/\n\nCCVT    ?= $(UPNP)/../classCvt/classCvt\nTOBIN   ?= $(UPNP)/../classCvt/tobinfile\nCMD = $(TOBIN) -c $(CCVT)\n\nupload:\n    CLASSPATH=$(RT)/real:$(RT)fake:$(RT)/fake/uj javac $(RT)/real/java/lang/*.java\n    CLASSPATH=$(RT)/real:$(RT)/fake:$(RT)/fake/uj javac $(APPL)/UJ*.java \n    CLASSPATH=$(RT)/real:$(RT)/fake:$(RT)/fake/uj \\\n        javac $(APPL)/UJ*.java $(APPL)/$(CLASS).java\n    find $(APPL)/ -iname \"$(CLASS).class\" &gt;&gt; temp_files\n    $(CMD) $(APPL)/$(CLASS).class &gt;$(CLASS).raw_ujc\n</code></pre>\n\n<p>The \".raw_ujc\" file appears in the directory of the makefile, as expected, and is a simple text file.\nThe tobinfile is a .c file that does printf and its output gets put into .raw_ujc.\nHowever, similarly it produces a binary file while doing the printf (by doing   fwrite(&amp;v,sizeof(v),1,rawf) with v being the byte and rawf being the file with a specific name).\nThis produces the binary file in the $(APPL) folder.\nI'd like to move this file to the folder of the makefile, where the .raw_ujc file also resides.</p>\n\n<p>I haven't been able to figure out how to do this. Any advice?</p>\n"}, {"tags": ["c", "github", "makefile", "header", "openssl"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475068616, "post_id": 39748662, "comment_id": 66793426, "body": "Do you have the <code>openssl-dev</code> package, or whatever name it has on OS X?"}, {"owner": {"reputation": 13, "user_id": 6893942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a13bc3d68b09e615bc9f883952bd8d1?s=128&d=identicon&r=PG&f=1", "display_name": "szoszu", "link": "https://stackoverflow.com/users/6893942/szoszu"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475068650, "post_id": 39748662, "comment_id": 66793450, "body": "I have the standard OpenSSL you obtain via brew command in terminal."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475068760, "post_id": 39748662, "comment_id": 66793530, "body": "I am not familiar with OSX, but on Linux distributions there are usually the basic &quot;runtime&quot; packages, providing the libraries for applications using them and the <code>dev</code> packages containing the sources/headers if you want to compile something using them. So you need the latter."}, {"owner": {"reputation": 13, "user_id": 6893942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a13bc3d68b09e615bc9f883952bd8d1?s=128&d=identicon&r=PG&f=1", "display_name": "szoszu", "link": "https://stackoverflow.com/users/6893942/szoszu"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475068807, "post_id": 39748662, "comment_id": 66793563, "body": "On OS X I have a folder with all these headers (.h) files."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475068862, "post_id": 39748662, "comment_id": 66793611, "body": "OK, in that case you have some other issue."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475069128, "post_id": 39748662, "comment_id": 66793834, "body": "Try adding <code>-I&#47;path&#47;to&#47;the&#47;folder&#47;containing&#47;openssl</code> to the <code>CFLAGS</code> in the <code>Makefile</code>."}, {"owner": {"reputation": 13, "user_id": 6893942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a13bc3d68b09e615bc9f883952bd8d1?s=128&d=identicon&r=PG&f=1", "display_name": "szoszu", "link": "https://stackoverflow.com/users/6893942/szoszu"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475070318, "post_id": 39748662, "comment_id": 66794854, "body": "I already have a couple of CFLAGS but none of them seem to have a path to tha. I simply make a new CFLAG = -I [...] ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1475070365, "post_id": 39748662, "comment_id": 66794900, "body": "<code>CFLAG +=</code>. It will add to the existing ones. Don&#39;t include the <code>openssl</code> folder itself, just the path up to it."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1475073276, "post_id": 39748662, "comment_id": 66797228, "body": "Please show the command that&#39;s producing the error. Please state exactly where you installed OpenSSL."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1475100035, "post_id": 39748662, "comment_id": 66812721, "body": "@Chill-Out Music - you need to provide the requested information or risk having the question closed. We can&#39;t provide useful information by guessing at things."}, {"owner": {"reputation": 13, "user_id": 6893942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a13bc3d68b09e615bc9f883952bd8d1?s=128&d=identicon&r=PG&f=1", "display_name": "szoszu", "link": "https://stackoverflow.com/users/6893942/szoszu"}, "edited": false, "score": 0, "creation_date": 1475179232, "post_id": 39748662, "comment_id": 66852294, "body": "the openssl is in /usr/local/opt/openssl"}, {"owner": {"reputation": 13, "user_id": 6893942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a13bc3d68b09e615bc9f883952bd8d1?s=128&d=identicon&r=PG&f=1", "display_name": "szoszu", "link": "https://stackoverflow.com/users/6893942/szoszu"}, "edited": false, "score": 0, "creation_date": 1475179240, "post_id": 39748662, "comment_id": 66852298, "body": "the command is &quot;MAKE&quot;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475190416, "post_id": 39748662, "comment_id": 66856706, "body": "the referenced code on github does not have any reference to <code>openssl</code> directory/library in the <code>makefile</code> nor any section in  <code>stript.ld</code>  So you need to add the appropriate information.  Note: the <code>script.ld</code> file seems to be missing the <code>MEMORY { ... }</code> statement."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475191544, "post_id": 39748662, "comment_id": 66857010, "body": "the referenced code contains dozens of the problem: &quot;warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]&quot;   It should be noted: the <code>-W</code> option suppresses all warnings.   I.E. You should not use that option.  Suggest: <code>-Wall -Wextra -pedantic -Wconversion -std=gnu99</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475193529, "post_id": 39748662, "comment_id": 66857520, "body": "in the <code>Makefile</code> this line: <code>ARFLAGS = crus</code> creates a problem/warning message.  Suggest using: <code>ARFLAGS := vrs</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475193757, "post_id": 39748662, "comment_id": 66857580, "body": "int the cache.S file, the gcc assember does not recognize @ as a valid start of comment. Suggest using / or // or #"}], "owner": {"reputation": 13, "user_id": 6893942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a13bc3d68b09e615bc9f883952bd8d1?s=128&d=identicon&r=PG&f=1", "display_name": "szoszu", "link": "https://stackoverflow.com/users/6893942/szoszu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1475068547, "creation_date": 1475068547, "question_id": 39748662, "link": "https://stackoverflow.com/questions/39748662/missing-headers-when-they-are-present", "title": "Missing Headers when they are present", "body": "<p>For some reason, on my OS X machine I can't MAKE any Github project. See, if in the C code is an \"include openssh/whatever.h\" or openssl, then even if I checked and the header is in the folder, It simply say: e.g.:</p>\n\n<pre><code>fatal error: 'openssl/aes.h' file not found\n</code></pre>\n\n<p>I tried SUDO, I tried reinstalling  / updating openssl / ssh, same issue over and over again. Seem to have an issue seeing these headers when they are clearly present. </p>\n\n<p>For reference, I tried compiling <a href=\"https://github.com/xerub/ibex\" rel=\"nofollow\">https://github.com/xerub/ibex</a></p>\n"}, {"tags": ["c", "gcc", "gcc-warning", "gcc4", "gcc4.7"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475066579, "post_id": 39747734, "comment_id": 66791845, "body": "Simplest fix: <code>char dummy; scanf(&quot;%d%c&quot;, &amp;choice, &amp;dummy);</code> Your <code>scanf</code> is reading the integer value and leave the <code>&#39;\\n&#39;</code> (the ASCII value of enter keyboard button) car into <code>stdin</code> buffer. So you have to spool it before to read something new."}, {"owner": {"reputation": 55, "user_id": 3213732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/649180a83f642781feb6034b13ca2669?s=128&d=identicon&r=PG&f=1", "display_name": "user3213732", "link": "https://stackoverflow.com/users/3213732/user3213732"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475066919, "post_id": 39747734, "comment_id": 66792113, "body": "It fixed the first problem. When i input saugat for choice it displays the output showing your name is saugat.. how do i fix it?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475067317, "post_id": 39747734, "comment_id": 66792392, "body": "I&#39;m not getting you. Could you elaborate? Your code is supposed to output  <code>printf(&quot;Your name is : %s&quot;,temp.name);</code> just after the name is input."}, {"owner": {"reputation": 55, "user_id": 3213732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/649180a83f642781feb6034b13ca2669?s=128&d=identicon&r=PG&f=1", "display_name": "user3213732", "link": "https://stackoverflow.com/users/3213732/user3213732"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475067472, "post_id": 39747734, "comment_id": 66792517, "body": "My code displays (What is Your choice : ) at that instant don&#39;t enter a number just type a string... it displays the name instead of executing if/else condition it doesn&#39;t function properly... please help me.."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475067690, "post_id": 39747734, "comment_id": 66792697, "body": "You cannot input a string if <code>scanf</code> format specifier is <code>%d</code>. You should check the return value of <code>scanf</code> to check if the it fails."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475070630, "post_id": 39749290, "comment_id": 66795133, "body": "Sorry, I triggered on the name, didn&#39;t read the code. My 5ct: I actually prefer e,g, &quot;drop&quot; or similar (&quot;emtpy&quot; is fine, too)."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1475071844, "post_id": 39749290, "comment_id": 66796121, "body": "On what base, pray tell, did you, whoever <i>you</i> is, downvote that code? With the exception of the forgotten return from <code>main</code> we would go into nitpicking territory quite rapidly and nits are not good reasons for a downvote, or are they?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1475072182, "post_id": 39749290, "comment_id": 66796401, "body": "@deamentiaemundi I don&#39;t care. Hater gonna hate ;)."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1475072347, "last_edit_date": 1475072347, "creation_date": 1475070088, "answer_id": 39749290, "question_id": 39747734, "link": "https://stackoverflow.com/questions/39747734/cannot-take-string-input-properly-in-gcc-ubuntu-linux/39749290#39749290", "title": "Cannot take string input properly in gcc ubuntu linux", "body": "<p>You have some problems into your code:</p>\n\n<ol>\n<li>scanf leave the <code>'\\n'</code> char into <code>stdin</code> and the next call to a function that reads from stdin exits immediately due to that character.</li>\n<li>You should check the return value of <code>scanf</code> to be sure that the user entered a valid number.</li>\n<li>Do not use old style function declaration with empty parameters. If no parameters are required use <code>(void)</code></li>\n<li>Your endless main loop should take care of <code>s</code> array size.</li>\n</ol>\n\n<p>You can add a empty function for <code>stdin</code> like:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct marks {\n    char subject[15];\n    int mark;\n};\n\nstruct student {\n    char name[10];\n    int roll;\n    struct marks m[3];\n};\n\nvoid displayData(struct student);\nint displayChoice(void);\nstruct student getNewRecord();\nvoid flush_stdin(void);\n\nint main(void)\n{\n    struct student s[5];\n    size_t count = 0;\n    int choice;\n\n    do{\n        choice = displayChoice();\n\n        if(choice == 1)\n        {\n            s[count] = getNewRecord();\n            count ++;\n        }\n        else if(choice == 4)\n            break;\n        else\n            printf(\"Invalid choice\");\n    }\n    while ((count &lt; sizeof(s)/sizeof(s[0]) ) &amp;&amp; (choice != 4));\n}\n\nstruct student getNewRecord(void)\n{\n    struct student temp;\n\n    printf(\"Enter your Name : \");\n\n    scanf(\"%s\", temp.name);\n\n    printf(\"Your name is : %s\", temp.name);\n\n    flush_stdin();\n\n    return temp;\n}\n\nint displayChoice(void) {\n    int choice;\n\n    printf(\"\\n\\nPlease select your choice :\\n\");\n    printf(\"1. Add new Record\\n\");\n    printf(\"2. Display All data \\n\");\n    printf(\"3. Remove last Record\\n\");\n    printf(\"4. Exit the program\\n\");\n    printf(\"What is your choice : \\n\");\n\n    if (scanf(\"%d\", &amp;choice) != 1)\n    {\n        choice = 99;\n    }\n\n    flush_stdin();\n\n    return choice;\n}\n\nvoid displayData(struct student s)\n{\n    printf(\"Your name : %s\", s.name);\n}\n\nvoid flush_stdin(void)\n{\n    int c;\n    while ( ((c = getchar()) != '\\n') &amp;&amp; (c != EOF) );\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 3213732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/649180a83f642781feb6034b13ca2669?s=128&d=identicon&r=PG&f=1", "display_name": "user3213732", "link": "https://stackoverflow.com/users/3213732/user3213732"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 872, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489099552, "creation_date": 1475066175, "last_edit_date": 1489099552, "question_id": 39747734, "link": "https://stackoverflow.com/questions/39747734/cannot-take-string-input-properly-in-gcc-ubuntu-linux", "title": "Cannot take string input properly in gcc ubuntu linux", "body": "<p>What is wrong in this program?? I am trying to figure out since 2 days but no help at all!!\nString output is only after string input and after selecting choice, default string input is new line character by default i guess. \nBesides if i type string while inputting choice, it shows me the name output by default. Here is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct marks {\n    char subject[15];\n    int mark;\n};\nstruct student {\n    char name[10];\n    int roll;\n    struct marks m[3];\n};\nvoid displayData(struct student);\nint displayChoice();\nstruct student getNewRecord();\nint main() {\n    struct student s[5];\n    int count = 0;\n    int choice;\n    do{\n        choice = displayChoice();\n        if(choice == 1){\n            s[count] = getNewRecord();\n            count ++;\n        }\n        else if(choice == 4)\n            break;\n        else\n            printf(\"Invalid choice\");\n    }while(1);\n}\nstruct student getNewRecord() {\n    struct student temp;\n    printf(\"Enter your Name : \");\n    fgets(temp.name, 10,stdin   );\n    printf(\"Your name is : %s\",temp.name);\n    return temp;\n\n}\nint displayChoice() {\n    int choice;\n    printf(\"\\n\\nPlease select your choice :\\n\");\n    printf(\"1. Add new Record\\n\");\n    printf(\"2. Display All data \\n\");\n    printf(\"3. Remove last Record\\n\");\n    printf(\"4. Exit the program\\n\");\n    printf(\"What is your choice : \\n\");\n    scanf(\"%d\", &amp;choice);\n    return choice;\n}\nvoid displayData(struct student s){\n    printf(\"Your name : %s\", s.name);\n}\n</code></pre>\n\n<p>And here are some screen shots:\n<img src=\"https://i.stack.imgur.com/ZnMcX.png\" alt=\"enter image description here\"></p>\n\n<p>I don't know and doesn't have any idea about what is going wrong. Please Help me..\nThanks in advance..</p>\n"}, {"tags": ["c", "linux", "timer", "kernel"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1475063712, "post_id": 39746688, "comment_id": 66789739, "body": "If you <a href=\"http://man7.org/linux/man-pages/man3/sleep.3.html\" rel=\"nofollow noreferrer\">read the <code>sleep</code> manual page</a> you will see that it sleeps until the number of seconds have passed. In other words it will sleep <i>at least</i> five second, but can sleep a little longer (depending on timer resolution and precision and such)."}, {"owner": {"reputation": 105, "user_id": 3541425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/1UCN7.png?s=128&g=1", "display_name": "Kumar2080", "link": "https://stackoverflow.com/users/3541425/kumar2080"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475064058, "post_id": 39746688, "comment_id": 66789981, "body": "thanks for reply @JoachimPileborg , but my clarification is about how the kernel will able to calculate that 5 seconds timing period."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475064260, "post_id": 39746688, "comment_id": 66790127, "body": "The same way as you already know? There are timers and counters in the hardware (on the CPU) that the kernel utilizes, and that can generate interrupts on specific intervals. A major difference between a &quot;micro-controller&quot; and an Intel i7 CPU is mostly the scale: One is small and the other is all but small."}, {"owner": {"reputation": 105, "user_id": 3541425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/1UCN7.png?s=128&g=1", "display_name": "Kumar2080", "link": "https://stackoverflow.com/users/3541425/kumar2080"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475065159, "post_id": 39746688, "comment_id": 66790793, "body": "can i get a code snippet in kernel for that (some example), that will be more helpful. Thanks @JoachimPileborg"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475065978, "post_id": 39746688, "comment_id": 66791395, "body": "There are <i>tens of millions</i> of lines of code in the kernel. Download the source yourself, find the architecture directory you are wondering about, and go look."}, {"owner": {"reputation": 105, "user_id": 3541425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/1UCN7.png?s=128&g=1", "display_name": "Kumar2080", "link": "https://stackoverflow.com/users/3541425/kumar2080"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475306800, "post_id": 39746688, "comment_id": 66899908, "body": "@JoachimPileborg i have read in internet that for timing reference there will be a variable is defined in,kernel i.e <b>jiffies</b>. which is define in &lt;linux/jiffies.h&gt;. so the jiffies variable is updated by the timer interrupts. what is your opinion about this <b>jiffies</b> variable?"}], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 1, "last_activity_date": 1475066703, "creation_date": 1475066703, "answer_id": 39747964, "question_id": 39746688, "link": "https://stackoverflow.com/questions/39746688/what-is-the-reference-for-timing-calculations-in-linux/39747964#39747964", "title": "what is the reference for timing calculations in linux", "body": "<p>Every operating system kernel (that I know of) has a whole machine independent framework for timers. This is pretty much one of the most central things a kernel must have because we need timers for everything, process scheduling, dealing with hardware errors, select/poll timeouts, network protocols, etc. At any point in time your kernel has dozens, if not thousands of timers waiting to be executed at some point in the future. Most of them will be canceled and never executed.</p>\n\n<p>The simplest framework that pretty much everyone uses sets up one of the many clocks in a machine to generate an interrupt at a set interval. 100Hz is the most common, Windows (at least in the past) sets it to 64Hz (but it can be changed by any application), some systems experimented with 1024Hz. The timer interrupt fires and the interrupt handler checks if there's anything queued up to do at that time and if there is, it is executed. There has been some work for Linux to improve this so that we can get shorter or longer intervals than 10ms depending on the next scheduled timer, both to improve the precision of the timers and to save power, but in general it works as described above.</p>\n\n<p>If I understand your question correctly, you think that there is something that measures how much certain sequence of instructions takes and then loops until some amount of time passes. This is something that is almost never done because it wastes power and it blocks anything else from running at the same time and is also quite unreliable. It is still done in modern kernels, but very rarely and only when high precision is required when talking to really, really stupid hardware. Last time I had to do it was 17 years ago to talk to some ethernet controller where you had to manually implement MII by bit-banging in software, it was terrible and hung the system for quite a long time every time you (un-)plugged an ethernet cable. Nobody builds hardware that requires this anymore because it really ruins the performance of modern systems.</p>\n\n<p>So in your question, sleep(5) will be implemented by registering a function in the timer framework to be called in 5 seconds from now and then putting the process to sleep. 5 seconds later the timer fires and the process gets awakened again.</p>\n"}], "owner": {"reputation": 105, "user_id": 3541425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/1UCN7.png?s=128&g=1", "display_name": "Kumar2080", "link": "https://stackoverflow.com/users/3541425/kumar2080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1475066703, "creation_date": 1475063544, "question_id": 39746688, "link": "https://stackoverflow.com/questions/39746688/what-is-the-reference-for-timing-calculations-in-linux", "title": "what is the reference for timing calculations in linux", "body": "<p>I want to clarify about timers in linux, how they are behaving?\nI know in micro-controllers the timers/counters we use the reference, timing of machine instruction to execute.so there we could make it loop for how much time we need sleep/timer/counter.</p>\n\n<p>But in linux where &amp; how it will take the reference that if i use sleep(5), exactly 5 seconds are elapsed.If any one know please clarify me kindly.</p>\n"}, {"tags": ["c", "string", "avr", "uart", "serial-communication"], "comments": [{"owner": {"reputation": 1628, "user_id": 4099675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v5gbD.jpg?s=128&g=1", "display_name": "Robin James Kerrison", "link": "https://stackoverflow.com/users/4099675/robin-james-kerrison"}, "edited": false, "score": 0, "creation_date": 1475061517, "post_id": 39745765, "comment_id": 66788276, "body": "&quot;PuTTY shows some random tokens and stops&quot; - which random tokens? Are you able to give us the output?"}, {"owner": {"reputation": 1628, "user_id": 4099675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v5gbD.jpg?s=128&g=1", "display_name": "Robin James Kerrison", "link": "https://stackoverflow.com/users/4099675/robin-james-kerrison"}, "edited": false, "score": 0, "creation_date": 1475061521, "post_id": 39745765, "comment_id": 66788278, "body": "Also, try to narrow down your problem if possible, giving a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>, perhaps through the <b>Divide and conquer</b> method which that help page suggests."}, {"owner": {"reputation": 158, "user_id": 6792759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8036b5701f5cac87b5726dfa995599f4?s=128&d=identicon&r=PG&f=1", "display_name": "gravell", "link": "https://stackoverflow.com/users/6792759/gravell"}, "edited": false, "score": 1, "creation_date": 1475061668, "post_id": 39745765, "comment_id": 66788366, "body": "&quot;PuTTY shows some random tokens and stops&quot; - sounds like wrong baud rate settings"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1475061861, "post_id": 39745765, "comment_id": 66788498, "body": "<code>char* ReceivedString;</code> is not been initialised, it does not point to any memory for the string. Also beware that a local string will go out of life when you exit the function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475061928, "post_id": 39745765, "comment_id": 66788541, "body": "And, in <code>memset(&amp;ReceivedString,0,sizeof(ReceivedString));</code> that is the size of the pointer. There is no definition anywhere of what size the string is (should be). In any case <code>&amp;ReceivedString</code> is wrong too, it should be <code>ReceivedString</code> without the <code>&amp;</code>."}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 1, "creation_date": 1475067365, "post_id": 39745765, "comment_id": 66792427, "body": "After you get the initialization issues settled, be aware that when you are making a <code>C</code> string that it needs a zero at the end to terminate it.  I&#39;m pretty sure the <code>strncpy(ReceivedString, ReceivedString, StringBit+1);</code> won&#39;t do it for you"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475067511, "post_id": 39745765, "comment_id": 66792546, "body": "So, do you use the Arduino framework or is that supposed to be plain C (not C++)?"}, {"owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "edited": false, "score": 0, "creation_date": 1475074397, "post_id": 39745765, "comment_id": 66798104, "body": "What&#39;s wrong with Serial? You can set databitsize, stopbits and parity there, if you need."}, {"owner": {"reputation": 113, "user_id": 6884600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d2292ef24ddc7d230f651bb9d17236?s=128&d=identicon&r=PG", "display_name": "useless-machine", "link": "https://stackoverflow.com/users/6884600/useless-machine"}, "reply_to_user": {"reputation": 1628, "user_id": 4099675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v5gbD.jpg?s=128&g=1", "display_name": "Robin James Kerrison", "link": "https://stackoverflow.com/users/4099675/robin-james-kerrison"}, "edited": false, "score": 0, "creation_date": 1475163819, "post_id": 39745765, "comment_id": 66843578, "body": "@RobinJamesKerrison I was not allowed to post a picture of the output in PuTTY because I don&#39;t have enough points yet on stackoverflow yet.  And what is your advice to narrow it down? I thought this was the minimal amount of code you needed."}, {"owner": {"reputation": 113, "user_id": 6884600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d2292ef24ddc7d230f651bb9d17236?s=128&d=identicon&r=PG", "display_name": "useless-machine", "link": "https://stackoverflow.com/users/6884600/useless-machine"}, "reply_to_user": {"reputation": 158, "user_id": 6792759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8036b5701f5cac87b5726dfa995599f4?s=128&d=identicon&r=PG&f=1", "display_name": "gravell", "link": "https://stackoverflow.com/users/6792759/gravell"}, "edited": false, "score": 0, "creation_date": 1475163829, "post_id": 39745765, "comment_id": 66843584, "body": "@Gravell it was not the wrong baud rate, because <code>UART0_PRINT</code> worked fine, but after <code>UART0_READ</code> it stopped and started doing weird stuff."}, {"owner": {"reputation": 113, "user_id": 6884600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d2292ef24ddc7d230f651bb9d17236?s=128&d=identicon&r=PG", "display_name": "useless-machine", "link": "https://stackoverflow.com/users/6884600/useless-machine"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475163848, "post_id": 39745765, "comment_id": 66843590, "body": "@WeatherVane thanks, I will try to apply your feedback asap"}, {"owner": {"reputation": 113, "user_id": 6884600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d2292ef24ddc7d230f651bb9d17236?s=128&d=identicon&r=PG", "display_name": "useless-machine", "link": "https://stackoverflow.com/users/6884600/useless-machine"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475163863, "post_id": 39745765, "comment_id": 66843601, "body": "@Olaf It is supposed to be plain C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475167942, "post_id": 39745765, "comment_id": 66846008, "body": "@TheCoffeeRanger: The it is better to use the AVR tag, not Arduino. Latter implies Arduino framework/context, which is not C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475168101, "post_id": 39745765, "comment_id": 66846102, "body": "Note: guards like <code>#ifndef UART_R #define UART_R </code> are unnecessary in implementation files, as you don&#39;t <code>#include</code> them in other files. And where is the header for that library? You should include it in the implementation, too to ensure the prototypes match the implementation."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475168245, "post_id": 39745765, "comment_id": 66846179, "body": "&quot;I was not allowed to post a picture of the output in PuTTY because&quot; - You are not allowed to edit your question and post the text? In case you tried posting an image of text: That is against site-rules anyway! Post text as text!"}, {"owner": {"reputation": 113, "user_id": 6884600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d2292ef24ddc7d230f651bb9d17236?s=128&d=identicon&r=PG", "display_name": "useless-machine", "link": "https://stackoverflow.com/users/6884600/useless-machine"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475168943, "post_id": 39745765, "comment_id": 66846545, "body": "@Olaf, thnks for your feedback. I will take into account next time.  Futhermore I could not copy the text from PuTTY, because it was forzen and could not reproduce the text."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475072058, "post_id": 39750038, "comment_id": 66796306, "body": "Nice answer, covered the short-comings well."}, {"owner": {"reputation": 113, "user_id": 6884600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d2292ef24ddc7d230f651bb9d17236?s=128&d=identicon&r=PG", "display_name": "useless-machine", "link": "https://stackoverflow.com/users/6884600/useless-machine"}, "edited": false, "score": 0, "creation_date": 1475163879, "post_id": 39750038, "comment_id": 66843611, "body": "Thanks, as soon as I have time I will try to apply your feedback.  I used to <code>memset</code> to fill <code>ReceivedString</code> with zeros. Then import all characters from the input, but <code>ReceivedString</code> should be full with zeros due to the <code>memset</code> function. Therefore I copied it onto itself removing the remaining zeros with <code>strncpy</code>."}], "tags": [], "owner": {"reputation": 22505, "user_id": 1411457, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XqssD.png?s=128&g=1", "display_name": "harmic", "link": "https://stackoverflow.com/users/1411457/harmic"}, "is_accepted": true, "score": 3, "last_activity_date": 1475072065, "last_edit_date": 1492087809, "creation_date": 1475071947, "answer_id": 39750038, "question_id": 39745765, "link": "https://stackoverflow.com/questions/39745765/problems-with-receiving-strings-via-uart0-on-arduino-uno/39750038#39750038", "title": "Problems with receiving strings via UART0 on Arduino UNO", "body": "<p>I think the main issue you have is that you have not allocated any buffer in which to store the received data (as pointed out in the comments by @WeatherVane).</p>\n\n<p>When writing a function in C that is going to return a string, you have two choices: either the caller provides a buffer and passes a pointer to it into the function, or the function allocates the buffer and returns a pointer to it. </p>\n\n<p>If the function is going to allocate it, then it will have to allocate it on the heap, using the <code>malloc</code> function. You could not use a local variable inside the function, because if you did then as soon as you exited the function, the variable is out of scope. In theory you could use a static variable as a buffer, but if you did that you could only read one string at a time.</p>\n\n<p>If the caller is going to provide a buffer then it could use a local variable, a static variable, or allocate from the heap.</p>\n\n<p>When the buffer is allocated on the heap, no matter who allocates it, the caller must free it when it is finished with it, using the <code>free</code> function.</p>\n\n<p>Embedded systems generally minimize the use of heap allocated variables - see <a href=\"https://arduino.stackexchange.com/questions/682/is-using-malloc-and-free-a-really-bad-idea-on-arduino\">this question</a> for some info about the reasons for that - so you might be better to allow the caller to allocate the buffer, like this:</p>\n\n<pre><code>void UART0_READ(char* buffer, int buflen)\n{\n//  ... here goes code to read into buffer\n}\n\n#define BUFSIZE 100\n\nint main(void)\n{\n    char input[BUFSIZE];\n    UART0_READ(input, BUFSIZE);\n    ...\n}\n</code></pre>\n\n<p>Note that I defined the <code>UART0_READ</code> function to take two arguments: the address of the buffer, and it's length. Another thing your program is missing is any guard against the buffer overflowing.</p>\n\n<p>Inside your input routine, use the buflen argument in eg. the call to memset, and inside the loop that reads characters to exit early if too many characters are read.</p>\n\n<p>The buffer is defined as a local character array in the calling function.</p>\n\n<p>Some other notes:</p>\n\n<ul>\n<li><p>Don't forget to add a zero, one past the last character added to the array. This also means that you must exit the loop after reading buflen-1 characters, so you have enough space for the 0.</p></li>\n<li><p>I'm not sure why you are calling <code>strncpy</code> ? You seem to be copying the string onto itself.</p></li>\n<li><p>Running a program with stray pointers in a full size OS will often result in a segfault. Embedded environments often lack the sophistication to detect  incorrect memory accesses so instead you might get less predictable behaivour (such as random garbage coming out the serial port).</p></li>\n</ul>\n"}], "owner": {"reputation": 113, "user_id": 6884600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d2292ef24ddc7d230f651bb9d17236?s=128&d=identicon&r=PG", "display_name": "useless-machine", "link": "https://stackoverflow.com/users/6884600/useless-machine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 39750038, "answer_count": 1, "score": 1, "last_activity_date": 1475169134, "creation_date": 1475060972, "last_edit_date": 1475169134, "question_id": 39745765, "link": "https://stackoverflow.com/questions/39745765/problems-with-receiving-strings-via-uart0-on-arduino-uno", "title": "Problems with receiving strings via UART0 on Arduino UNO", "body": "<p>I'm trying to write my own library for sending messages from my Arduino UNO via UART0 to my computer.</p>\n\n<p>The library works successfully except the part where I want to receive strings. The code of the library is:</p>\n\n<pre><code>#define F_CPU 16000000\n\n#define EVEN_P 0\n#define ODD_P 1\n\n#define BAUD_RATE 57600\n\n#include &lt;avr/io.h&gt;\n#include &lt;math.h&gt;\n#include &lt;avr/io.h&gt;\n#include &lt;string.h&gt;\n#include &lt;util/delay.h&gt;\n\n// Initialize UART0 communication\nvoid UART0_Init_Custom(unsigned long BaudRate, char AsyncDoubleSpeed, char DataSizeInBits, char ParityEVENorODD, char StopBits)\n{\n    uint16_t UBBR_Value = lrint (F_CPU / 16 / BaudRate - 1 ); // maybe 16L??\n\n    // Setting the U2X bit to 1 for double speed asynchronous (default = 0, normal speed)\n    if (AsyncDoubleSpeed == 1) UCSR0A = (1 &lt;&lt; U2X0);\n\n    // Upper part of the baud number (bits 8 to 11)\n    UBRR0H = (unsigned char)(UBBR_Value &gt;&gt; 8);\n    // Rest of the baud number\n    UBRR0L = (unsigned char)(UBBR_Value);\n\n    // Enable the receiver and transmitter\n    UCSR0B = (1 &lt;&lt; RXEN0) | (1 &lt;&lt; TXEN0);\n\n    // Set 2 stop bits (default = 1)\n    if (StopBits == 2) UCSR0C = (1 &lt;&lt; USBS0);\n\n    // Set parity\n    if (ParityEVENorODD == EVEN_P) UCSR0C |= (1 &lt;&lt; UPM01);\n    if (ParityEVENorODD == ODD_P) UCSR0C |= (3 &lt;&lt; UPM00);\n\n    // Set data length (default = 5 bits)\n    if (DataSizeInBits == 6) UCSR0C |= (1 &lt;&lt; UCSZ00); // 6-bit\n    if (DataSizeInBits == 7) UCSR0C |= (2 &lt;&lt; UCSZ00); // 7-bit\n    if (DataSizeInBits == 8) UCSR0C |= (3 &lt;&lt; UCSZ00); // 8-bit\n    if (DataSizeInBits == 9) UCSR0C |= (7 &lt;&lt; UCSZ00); // 9-bit\n}\n\nvoid UART0_Init(unsigned long BaudRate)\n{\n    if (BaudRate == 115200)\n    {\n        UART0_Init_Custom((BaudRate/2),1,8,0,2);\n    }\n    else\n    {\n        UART0_Init_Custom(BaudRate,0,8,0,2);\n    }\n}\n\n// Receive Data UART0\nchar UART0_GET(void)\n{\n    while (!(UCSR0A &amp; (1 &lt;&lt; RXC0)));\n    return UDR0;\n}\n\n// Transmit Data UART0\nvoid UART0_PUT(char data)\n{\n    while (!(UCSR0A &amp; (1 &lt;&lt; UDRE0)));\n    UDR0 = data;\n}\n\n// Transmit Data-String UART0\nvoid UART0_PRINT(char* String)\n{\n    while(*String)\n    {\n        UART0_PUT(*String++);\n    }   \n}\n\n// Receive Data-String UART0\nchar* UART0_READ(void)\n{\n    char* ReceivedString;\n    char ReceivedBit;\n    int StringBit = 0;\n    memset(&amp;ReceivedString,0,sizeof(ReceivedString));\n    while ((ReceivedBit=UART0_GET())!=13)\n    {\n        UART0_PUT(ReceivedBit);\n        ReceivedString[StringBit] = ReceivedBit;\n        StringBit++;\n    }\n    ReceivedString[StringBit] = 13;\n    ReceivedString[StringBit++] = 10;\n    UART0_PUT(10);\n    strncpy(ReceivedString, ReceivedString, StringBit+1);\n    return(ReceivedString);\n}\n\nchar* Input;\nint main(void)\n{\n    UART0_Init(BAUD_RATE);\n    UART0_PRINT((char*)\"Give a message and I will return it\\r\\n\");\n    while(1)\n    {   \n        Input = UART0_READ();\n        UART0_PRINT((char*)\"The message was:\");\n        UART0_PRINT(Input);\n    }\n}\n</code></pre>\n\n<p>When running this code, PuTTY shows some random tokens and stops. I cannot insert anything anymore.</p>\n"}, {"tags": ["c", "enums"], "comments": [{"owner": {"reputation": 2289, "user_id": 3351949, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1464667477/picture?type=large", "display_name": "ColdSteel", "link": "https://stackoverflow.com/users/3351949/coldsteel"}, "edited": false, "score": 2, "creation_date": 1475058917, "post_id": 39744967, "comment_id": 66786423, "body": "Try using printf(&quot;%d&quot;, f-&gt;type);"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 2289, "user_id": 3351949, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1464667477/picture?type=large", "display_name": "ColdSteel", "link": "https://stackoverflow.com/users/3351949/coldsteel"}, "edited": false, "score": 0, "creation_date": 1475058956, "post_id": 39744967, "comment_id": 66786457, "body": "@user3351949 then the whole point of having <code>MCSIMULATION</code> is lost, nop?"}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 2289, "user_id": 3351949, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1464667477/picture?type=large", "display_name": "ColdSteel", "link": "https://stackoverflow.com/users/3351949/coldsteel"}, "edited": false, "score": 0, "creation_date": 1475058997, "post_id": 39744967, "comment_id": 66786485, "body": "@user3351949 I will have 0, but I want to have a string value of enum."}, {"owner": {"reputation": 2289, "user_id": 3351949, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1464667477/picture?type=large", "display_name": "ColdSteel", "link": "https://stackoverflow.com/users/3351949/coldsteel"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1475059007, "post_id": 39744967, "comment_id": 66786492, "body": "@SouravGhosh The desired output is &quot;MCSIMULATION&quot; ?"}, {"owner": {"reputation": 2289, "user_id": 3351949, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1464667477/picture?type=large", "display_name": "ColdSteel", "link": "https://stackoverflow.com/users/3351949/coldsteel"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1475059028, "post_id": 39744967, "comment_id": 66786504, "body": "@SouravGhosh Sorry didn&#39;t get the Question"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "closed_date": 1475059122, "answer_count": 0, "score": 2, "last_activity_date": 1475059096, "creation_date": 1475058796, "last_edit_date": 1475059096, "question_id": 39744967, "link": "https://stackoverflow.com/questions/39744967/how-can-i-print-enum-in-c", "closed_reason": "Duplicate", "title": "How can I print enum in C?", "body": "<p>I have such <code>enum constuct</code> and <code>typedef struct</code>:</p>\n\n<pre><code>#define str(x) #x\n\ntypedef enum {\n    MCSIMULATION,\n} jobType;\n\ntypedef struct {\n    jobType type;\n}x, *xPtr;\n\nint main(){\n    xPtr f = malloc(sizeof(x));\n    f-&gt;type = MCSIMULATION;\n    return 0;\n}\n</code></pre>\n\n<p>Then I want to print the value of <code>f.type</code>:</p>\n\n<pre><code>printf(\"%s\", str(f-&gt;type));\n</code></pre>\n\n<p>But as output I have, when I expected to have \"MCSIMULATION\":</p>\n\n<pre><code>f-&gt;type\n</code></pre>\n\n<p>How to print it properly?</p>\n"}, {"tags": ["c", "math"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1475060112, "post_id": 39744851, "comment_id": 66787283, "body": "Pretty sure you have undefined behavior since you never initialize <code>o</code> before relying on it in the <code>while</code>."}], "answers": [{"comments": [{"owner": {"reputation": 514, "user_id": 3796896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e336ab34fb3526b8f5f1edc5099bdb?s=128&d=identicon&r=PG&f=1", "display_name": "acornagl", "link": "https://stackoverflow.com/users/3796896/acornagl"}, "reply_to_user": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475059063, "post_id": 39745002, "comment_id": 66786540, "body": "Good to know that it helps ;) Please press the top arrow"}, {"owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 1, "creation_date": 1475059114, "post_id": 39745002, "comment_id": 66786580, "body": "4 minutes until I&#39;m allowed to do so :P"}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "reply_to_user": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475061543, "post_id": 39745002, "comment_id": 66788293, "body": "@gusgxrha The 4 minutes are over now."}, {"owner": {"reputation": 514, "user_id": 3796896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e336ab34fb3526b8f5f1edc5099bdb?s=128&d=identicon&r=PG&f=1", "display_name": "acornagl", "link": "https://stackoverflow.com/users/3796896/acornagl"}, "reply_to_user": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475061777, "post_id": 39745002, "comment_id": 66788445, "body": "@gusgxrha Thank you!"}], "tags": [], "owner": {"reputation": 514, "user_id": 3796896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e336ab34fb3526b8f5f1edc5099bdb?s=128&d=identicon&r=PG&f=1", "display_name": "acornagl", "link": "https://stackoverflow.com/users/3796896/acornagl"}, "is_accepted": true, "score": 1, "last_activity_date": 1475058911, "creation_date": 1475058911, "answer_id": 39745002, "question_id": 39744851, "link": "https://stackoverflow.com/questions/39744851/how-often-is-a-number-divisible-without-a-rest/39745002#39745002", "title": "How often is a number divisible without a rest?", "body": "<p>Change the <code>while</code> loop condition in :</p>\n\n<pre><code>while(o.rem == 0 &amp;&amp; inp &gt;= 5) \n</code></pre>\n\n<p>In this way your division will stop after that you are inspecting the number 5.</p>\n\n<p>A suggestion: use a <code>const</code> variable to wrap the 5 ;)</p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475060575, "post_id": 39745458, "comment_id": 66787619, "body": "I read that the div function is faster than modulo. Isn&#39;t that true? I thought I would adapt to it as early as possible"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1475061854, "post_id": 39745458, "comment_id": 66788495, "body": "&quot;Faster&quot; in this case should not be a worry.  Correctness, cleanliness, and readability are far more important.  Regarding correctness: Shouldn&#39;t the output be 3, 5, and 25?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 1, "creation_date": 1475061930, "post_id": 39745458, "comment_id": 66788543, "body": "@gusgxrha I was wrong, it&#39;s standard, I just didn&#39;t remember and think it&#39;s kind of obscure. Don&#39;t optimize when you don&#39;t need to, code like this is better off being easy to read."}, {"owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475062337, "post_id": 39745458, "comment_id": 66788803, "body": "Thanks for your advice guys!"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475065018, "post_id": 39745458, "comment_id": 66790693, "body": "@gusgxrha Faster? A function call that still has to do division somehow will not be faster than just a modulo on anything built this century. And since <code>div</code> is used approximately never it will not be optimized by any reasonable compiler. Btw. I looked up a few C libraries I had lying around. <code>div</code> on them is implemented as: <code>r.qout = a &#47; b; r.rem = a % b;</code> and a few branches to make sure the rounding is done according to the standard."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1475065225, "post_id": 39745458, "comment_id": 66790840, "body": "@Art Thanks. I think the point of the function is that a CPU might return both the quotient and remainder in the same instruction, and <code>div()</code> allows that to be exploited. Nowadays integer divisions aren&#39;t much to worry about, and for this program certainly not so I still stand by my code."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1475071139, "post_id": 39745458, "comment_id": 66795541, "body": "@duffymo the result <code>0, 2, 3</code> seems correct. <code>5^2</code> is 25, <code>5^3</code> is 125 and zero represents the case with a non-zero remainder."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475071236, "post_id": 39745458, "comment_id": 66795636, "body": "@unwind - why calculate the remainder inside the loop? Checking it before the loop seems sufficient and spare a recalculation in each loop (when remainder is zero)."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475071621, "post_id": 39745458, "comment_id": 66795965, "body": "@4386427 Perhaps ... this was how the original code did it, and I like to keep close."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 2, "last_activity_date": 1475061901, "last_edit_date": 1475061901, "creation_date": 1475060082, "answer_id": 39745458, "question_id": 39744851, "link": "https://stackoverflow.com/questions/39744851/how-often-is-a-number-divisible-without-a-rest/39745458#39745458", "title": "How often is a number divisible without a rest?", "body": "<p>You're using <code>div()</code> to do the division, which I had to look up to verify that it's part of the standard. I think it's kind of rarely used, and more suited for cases where you <em>really</em> care about performance. This doesn't seem like such a case, and so I think it's a bit obscure.</p>\n\n<p>Anyhow, here's how I would expect it to look, without <code>div()</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned int count_factors(unsigned int n, unsigned int factor)\n{\n    unsigned int count = 0;\n    for(; n &gt;= factor; ++count)\n    {\n        const int remainder = n % factor;\n        if(remainder != 0)\n            break;\n        n /= factor;\n    }\n    return count;\n}\n\nint main(void) {\n    printf(\"%u\\n\", count_factors(17, 5));\n    printf(\"%u\\n\", count_factors(25, 5));\n    printf(\"%u\\n\", count_factors(125, 5));\n    return 0;\n}\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>0\n2\n3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1475071504, "last_edit_date": 1475071504, "creation_date": 1475070558, "answer_id": 39749472, "question_id": 39744851, "link": "https://stackoverflow.com/questions/39744851/how-often-is-a-number-divisible-without-a-rest/39749472#39749472", "title": "How often is a number divisible without a rest?", "body": "<p>As far as I understand you want to know whether the input is an integer power of 5 (or in general whether <code>v == N^x</code>) and if it is, you want to calculate and return the power (aka <code>x</code>). Otherwise return 0. This is more or less a <code>logN</code> function except that it requires integer results.</p>\n\n<p>I would go for code like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned int logN_special(unsigned int v, unsigned int n)\n{\n    unsigned int r = 0;\n\n    if (n == 0) return 0;           // Illegal\n    if (n == 1) return 0;           // Illegal\n    if (v &lt; n) return 0;            // Will always give zero\n    if (n*(v/n) != v) return 0;     // Make sure that v = n^x\n\n    // Find the x\n    while(v != 1) \n    {\n        v /= n;\n        ++r;\n    }\n    return r;\n}\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 39745002, "answer_count": 3, "score": 3, "last_activity_date": 1475071504, "creation_date": 1475058464, "last_edit_date": 1475060745, "question_id": 39744851, "link": "https://stackoverflow.com/questions/39744851/how-often-is-a-number-divisible-without-a-rest", "title": "How often is a number divisible without a rest?", "body": "<p>I am currently trying to write a method which checks how often a number is divisible by 5 with a rest of 0 (e.g. 25 is two times; 125 is three times).</p>\n\n<p>I thought my code is correct but it always states that it is possible one more time than it actually is (e.g. 25 is three times; wrong).</p>\n\n<p>My approach is the following:</p>\n\n<pre><code> int main()\n    {\n       div_t o;\n       int inp = 25, i = 0;\n       while(o.rem == 0){\n        o = div(inp, 5);\n        inp = o.quot;\n        i++\n       }\n        return 0;\n    }\n</code></pre>\n\n<p>I debugged the code already and figured that the issue is that it steps once more into the loop even though the rest is bigger 0. Why is that? I can't really wrap my head around it.</p>\n\n<pre><code>First: 25/5 = 5; Rest = 0;\nSecond: 5/5 = 1; Rest = 1; - Shouldn't it stop here?\nThird: 1/5 = 0; Rest = 1;\n</code></pre>\n\n<p>Ah... got it. The point where the remainder is 0 is reached when the division is done with the number which results in a rest bigger zero which is after i got increased.</p>\n\n<p>What is the cleanest approach to fix that? i -= 1 seems kinda like a workaround and I wanted to avoid using an if to break</p>\n"}, {"tags": ["c++", "c", "exc-bad-access", "fread", "fseek"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475058214, "post_id": 39744713, "comment_id": 66785958, "body": "<i>Could this be because when the pointer *p is created it isn&#39;t pointing to a memory address?</i>........ but your code init it to buffer address, so it is pointing to something valid as far as buffer size can is enough"}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475058339, "post_id": 39744713, "comment_id": 66786038, "body": "Any idea of an example of how to point to a memory address? Sorry, I&#39;m quite new to this and am stuck on how to do this..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475058447, "post_id": 39744713, "comment_id": 66786120, "body": "<code>const char *current = &#39;myfile&#39;;</code> is a syntax error, should be <code>const char *current = &quot;myfile&quot;;</code>"}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475058601, "post_id": 39744713, "comment_id": 66786227, "body": "Weather Vane, how is that relevant to this question?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475058667, "post_id": 39744713, "comment_id": 66786276, "body": "Because if you are executing compiled code, this is not the code that you compiled. Please post the actual code."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475058766, "post_id": 39744713, "comment_id": 66786334, "body": "Weather Vane, I&#39;ve just used this filename as an example, its not in the final code."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475058823, "post_id": 39744713, "comment_id": 66786372, "body": "sorry, dhke, I do not understand a word you are saying..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1475058871, "post_id": 39744713, "comment_id": 66786396, "body": "Then this is a perfect example of why the <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> is requested. Is there anything else that only resembles the actual code?"}, {"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 1, "creation_date": 1475058883, "post_id": 39744713, "comment_id": 66786402, "body": "@Ke. The code in your question is supposed to be a minimally, working example that demonstrates your problem. If you change your code to something that doesn&#39;t compile, you are making life harder for those that want to help you. That said, we are also debugging different code than the one you are running, which kind of moot, isn&#39;t it?"}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475059050, "post_id": 39744713, "comment_id": 66786523, "body": "Weather Vane, it is impossible for me to supply the exact code, because it is c/c++ embedded within another program. It is not running inside the OS, and is an adapted framework for building c/c++ programs. This should not deter from the fact that the code would still have the error, irrespective of this discussion. Clearly it&#39;s an issue with a pointer. Do you have any examples how to tackle this problem, or are you just here to critique other peoples code?"}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475059110, "post_id": 39744713, "comment_id": 66786578, "body": "dhke, not it isnt moot, I&#39;ve tested this code and it still has the same problem..."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1475059253, "post_id": 39744713, "comment_id": 66786674, "body": "@Ke. <code>&#47;&#47;Create buffer the correct size</code> -- You are doing a high-wire act here.  If you&#39;re off by a single byte, you are invoking undefined behavior.  .  Second, you tagged this as C++, but this <code>char buffer[sz3];</code> is not valid C++, as arrays cannot be declared using a variable as the number of entries."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1475059344, "post_id": 39744713, "comment_id": 66786747, "body": "&quot;I&#39;ve tested this code&quot; - wouldn&#39;t it be great if <i>we could do the same</i>.   I highly suspect your math in computing the size of the buffer (<code>sz3</code>) in comparison to how much data you&#39;re actually <i>writing</i> is not correct. or perhaps an automatic var overflow. Given, I can&#39;t verify that, but <i>you apparently can</i>, and should via your stated capability to &quot;test&quot; this."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475059368, "post_id": 39744713, "comment_id": 66786764, "body": "Hi PaulMcKenzie, yes I can mix c and c++ in this program at the same time. I&#39;m guessing this is going to be much easier if i just rewrite the whole thing in c++."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1475059674, "post_id": 39744713, "comment_id": 66786958, "body": "@Ke. -- As stated, that computation of the exact buffer size is a recipe for disaster.  I&#39;ve seen it fail more times than work, and the many times it did fail were only detected <i>after</i> months (sometimes years) of the program &quot;running ok&quot; with the hidden bug."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475059964, "post_id": 39744713, "comment_id": 66787171, "body": "Hi Paul Mackenzie, would you suggest for me to rewrite it as c++, will it be easier to compute the buffer size, or not necessary? I say this because I&#39;ve already tried to write this program in c++ and it seemed to me more difficult."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1475060029, "post_id": 39744713, "comment_id": 66787223, "body": "What is the value of <code>sz3</code>? Your array is allocated on the stack and the stack is of limited size on OS X."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475060089, "post_id": 39744713, "comment_id": 66787263, "body": "Hi Hristo Lliev, it is variable (the size of the file), I&#39;m wondering how I could put this on the heap - sorry Im a bit of a newb..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475063302, "post_id": 39744713, "comment_id": 66789411, "body": "This is not a solution, but just try to replace <code>char buffer[sz3];</code> by <code>char buffer[sz * 2];</code> and look if the problem goes away. If yes, it is a strong indication that something is seriously wrong with the calculation of the buffer length."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475064593, "post_id": 39744713, "comment_id": 66790373, "body": "Put it into heap using <a href=\"http://man7.org/linux/man-pages/man3/free.3.html\" rel=\"nofollow noreferrer\">malloc</a>: <code>char *p = malloc(sz3); if (p != NULL){...} free(p);</code>"}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475068245, "post_id": 39744713, "comment_id": 66793124, "body": "Hi LPs, I get a &quot;cannot initialize a variable of type char * with an rvalue of type void *"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475091792, "post_id": 39744713, "comment_id": 66808494, "body": "Are you compiling with c++? Btw remember to use @ char before the nick to warn a user."}], "answers": [{"comments": [{"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475059910, "post_id": 39745297, "comment_id": 66787135, "body": "Hi user3059968, yes agree, but it&#39;s happening above in the first sprintf statement... agreed it must have to do with my byte calculations..."}, {"owner": {"reputation": 31, "user_id": 3059968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2bd10db7514901edfcc48e57f1318e3?s=128&d=identicon&r=PG&f=1", "display_name": "Vrana", "link": "https://stackoverflow.com/users/3059968/vrana"}, "reply_to_user": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475060102, "post_id": 39745297, "comment_id": 66787274, "body": "@Ke Can you please tell me what are the value of tabs, sz2 and sz3."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475060218, "post_id": 39745297, "comment_id": 66787348, "body": "So the program basically chops up the string of bytes into 80 character chunks (hence the /80) and then adds 1 new line to the beginning, 1 new line to the end, and 7 tabs + 1 newline on each line in between."}, {"owner": {"reputation": 31, "user_id": 3059968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2bd10db7514901edfcc48e57f1318e3?s=128&d=identicon&r=PG&f=1", "display_name": "Vrana", "link": "https://stackoverflow.com/users/3059968/vrana"}, "reply_to_user": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475060541, "post_id": 39745297, "comment_id": 66787584, "body": "That&#39;s fine but can you print the values of tabs,sz2 and sz3, from those values we will get the better idea."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1475062975, "post_id": 39745297, "comment_id": 66789227, "body": "Hi Vrana,  sz1: 516276 ,  sz2: 516116 , sz3: 1083857 , tabs: 51608 many thanks for helping with this"}, {"owner": {"reputation": 31, "user_id": 3059968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2bd10db7514901edfcc48e57f1318e3?s=128&d=identicon&r=PG&f=1", "display_name": "Vrana", "link": "https://stackoverflow.com/users/3059968/vrana"}, "reply_to_user": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 1, "creation_date": 1475071350, "post_id": 39745297, "comment_id": 66795753, "body": "Please make sure that the code which you shared and which you are running are same. In the above comment you told that value of sz1, sz2, sz3 and tabs are 516276, 516116, 1083857 and 51608 respectively.     But as per the statement &quot;tabs = (sz2 / 80) *16&quot; value of tabs should be 103216.  If tabs value is 103216 then sz3 will be 1135465 and your program will run fine. I checked it through a dummy program."}], "tags": [], "owner": {"reputation": 31, "user_id": 3059968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2bd10db7514901edfcc48e57f1318e3?s=128&d=identicon&r=PG&f=1", "display_name": "Vrana", "link": "https://stackoverflow.com/users/3059968/vrana"}, "is_accepted": false, "score": 1, "last_activity_date": 1475059610, "creation_date": 1475059610, "answer_id": 39745297, "question_id": 39744713, "link": "https://stackoverflow.com/questions/39744713/exc-bad-access-caused-by-sprintf/39745297#39745297", "title": "exc_bad_access caused by sprintf", "body": "<p>First of all *p is pointing to valid memory in your program because of line\nchar *p = buffer;</p>\n\n<p>But I think the problem is in buffer size, please make sure that buffer size is enough to hold the strings which you are putting in.\nI am sure that statement \"p += sprintf(p, \"%s\", \"\\t\\t\\t\\t\\t\\t\\t\");\n\" is the cause of problem and it may be due to the insufficient size of buffer array which is pointed by pointer p.</p>\n"}], "owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1475059610, "creation_date": 1475058086, "last_edit_date": 1475058811, "question_id": 39744713, "link": "https://stackoverflow.com/questions/39744713/exc-bad-access-caused-by-sprintf", "title": "exc_bad_access caused by sprintf", "body": "<p>I'm getting an error exc_bad_access in xcode when executing the following code.</p>\n\n<p>The error is caused by the following line:</p>\n\n<pre><code>//Add new line at beginning of hex decode\np += sprintf(p, \"%s\", \"\\n\");\n</code></pre>\n\n<p>Could this be because when the pointer *p is created it isn't pointing to a memory address? If so, any idea how to point it to a memory address?</p>\n\n<pre><code>const char *current = \"myfile\";\nFILE *f = fopen(current, \"rb\");\nif (!f)\n{\nprintf(  \"Unable to open file! %s\", current);\n    return;\n}\nchar ch;\nint loop = 1;\nint sz1,sz2,sz3;\n\nint seeker = offsetof(struct myStruct, contents.datas);\n\nstruct myStruct c;\n\nfseek(f,16,SEEK_SET);\n\n//Find specific ID part of struct for printing later\nsize_t n = fread(&amp;c.ID, sizeof(int), 1, f);\n\nif (n != 1) {\n    printf(  \"Error Reading File\" );\n    return;\n} else {\n    printf(\"Success reading ID\" );\n}\n\nint val;\nval=fseek(f,0L,SEEK_SET);\n\nif(val!=0)\n{\n    post( \"problem fseeking\" );\n    return;\n}\n\n//find total length of file\nfseek(f, 0L, SEEK_END);\nsz1 = ftell(f);\n\n//total length minus length from position which seeker is set\nfseek(f, seeker, SEEK_SET);\nsz2 = sz1 - ftell(f) + 1;\n\n//Determine count for 80 chars and 7 tabs per new line \nint tabs = (sz2 / 80) * 16;// Total size / size of chunk * 8 - 7 tabs and 1 new line char\nsz3 = ((sz2 * 2) + tabs + 1 + 16) ;//Total size + nuls + tabs * 2 for 2 bytes\n\n//Create buffer the correct size\nchar buffer[sz3];\nbuffer[0] = '\\0';\n\n//Create pointer variable to copy to buffer\nchar *p = buffer;\n\n//Add new line at beginning of hex decode\np += sprintf(p, \"%s\", \"\\n\");\n\nwhile (loop &lt; sz2)\n{\n    if(loop % 40 -\n        //Add 7 tabs to the beginning of each new line 1 == 4 ){\n        p += sprintf(p, \"%s\", \"\\t\\t\\t\\t\\t\\t\\t\");\n    }\n    //Error happening here\n    size_t nn = fread(&amp;ch, 1, 1, f);\n    if (nn != 1) {\n        printf(\"Errorno: %s\", strerror(errno) );\n        return;\n    } else {\n        //printf(\"Sucess\");\n    }\n\n    fread(&amp;ch, 1, 1, f);\n    if(loop &gt; 4){\n        //Convert char to hex\n        p += sprintf(p, \"%02X\", (ch &amp; 0x00FF));\n    }\n\n    if(loop % 40 == 4){\n        if(loop &gt; 4){\n            //Add a new line every 80 chars\n            p += sprintf(p, \"%s\", \"\\n\");\n        }\n    }\n    loop++;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 5, "creation_date": 1475057040, "post_id": 39744115, "comment_id": 66785118, "body": "My crystal ball thinks that you forgot to set <code>head</code> to <code>NULL</code> when you created the initial, empty, list."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1475057160, "post_id": 39744115, "comment_id": 66785218, "body": "show <code>void mallocList(LinkedList* list)</code> and call this."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1475057362, "post_id": 39744115, "comment_id": 66785375, "body": "Please show how you call <code>mallocList</code>, <code>insertToStart</code> and <code>printList</code>. Also read about this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1475057552, "post_id": 39744115, "comment_id": 66785502, "body": "You don&#39;t want anything to &quot;point to null&quot; (useless for a linked list), you want some pointers to <b>be</b> NULLs."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475060681, "post_id": 39744115, "comment_id": 66787686, "body": "Given the &quot;infinite loop&quot; vs a likely &quot;crash and burn&quot; for an indeterminate pointer, coupled with the apparent configure-this parameter interface for <code>mallocList</code>, I&#39;d almost wager <code>mallocList</code> is someone&#39;s idea of setting up some unnecessary  &quot;sentinel&quot; node for the initial <code>head</code>, and they setup a single-node circular list while doing so. Of course, without code to reproduce this, wags (wild ass guesses) as the best you can get, and that was mine. Best of luck."}], "answers": [{"comments": [{"owner": {"reputation": 1688, "user_id": 2711645, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4ead722b48b0a9b070c81b3a53a8c386?s=128&d=identicon&r=PG&f=1", "display_name": "Cantfindname", "link": "https://stackoverflow.com/users/2711645/cantfindname"}, "edited": false, "score": 1, "creation_date": 1475060098, "post_id": 39744332, "comment_id": 66787271, "body": "This is not correct, with the first line, <code>newNode-&gt;next</code> points to the old list head, and with the second line, <code>list-&gt;head</code> is moved to point to the new list head, which is now <code>newNode</code>."}, {"owner": {"reputation": 997, "user_id": 5903546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090029ba7b6c1adda964f65d37898526?s=128&d=identicon&r=PG&f=1", "display_name": "lfgtm", "link": "https://stackoverflow.com/users/5903546/lfgtm"}, "reply_to_user": {"reputation": 1688, "user_id": 2711645, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4ead722b48b0a9b070c81b3a53a8c386?s=128&d=identicon&r=PG&f=1", "display_name": "Cantfindname", "link": "https://stackoverflow.com/users/2711645/cantfindname"}, "edited": false, "score": 0, "creation_date": 1475060420, "post_id": 39744332, "comment_id": 66787490, "body": "Apologies you are correct. Have removed that statement."}], "tags": [], "owner": {"reputation": 997, "user_id": 5903546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090029ba7b6c1adda964f65d37898526?s=128&d=identicon&r=PG&f=1", "display_name": "lfgtm", "link": "https://stackoverflow.com/users/5903546/lfgtm"}, "is_accepted": false, "score": 0, "last_activity_date": 1475060430, "last_edit_date": 1475060430, "creation_date": 1475057183, "answer_id": 39744332, "question_id": 39744115, "link": "https://stackoverflow.com/questions/39744115/how-do-i-make-the-last-element-in-my-linked-list-point-to-null-in-c/39744332#39744332", "title": "How do i make the last element in my linked list point to null in C", "body": "<p>NULL == 0. So set your <code>next</code> ptr to 0. To represent the termination of your linked list.</p>\n\n<p>i.e</p>\n\n<pre><code>next = 0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1688, "user_id": 2711645, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4ead722b48b0a9b070c81b3a53a8c386?s=128&d=identicon&r=PG&f=1", "display_name": "Cantfindname", "link": "https://stackoverflow.com/users/2711645/cantfindname"}, "is_accepted": true, "score": 0, "last_activity_date": 1475060343, "creation_date": 1475060343, "answer_id": 39745551, "question_id": 39744115, "link": "https://stackoverflow.com/questions/39744115/how-do-i-make-the-last-element-in-my-linked-list-point-to-null-in-c/39745551#39745551", "title": "How do i make the last element in my linked list point to null in C", "body": "<p>You should initialize <code>list-&gt;head</code> to <code>NULL</code>.\nThen as you add elements to the head of the list with <code>insertToStart</code>, the last element in the list will keep its <code>next</code> equal to <code>NULL</code>, and thus you will have a correct tail on your list.\nYou also have to be careful if you also want to implement the removal of nodes from the list. In this case, make sure that when you remove the tail node its previous node has its <code>next</code> pointer set to <code>NULL</code>.</p>\n"}], "owner": {"reputation": 17, "user_id": 6892598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/788e6960a69ed58707d5d00e14f2448a?s=128&d=identicon&r=PG&f=1", "display_name": "B. Wayne", "link": "https://stackoverflow.com/users/6892598/b-wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 39745551, "answer_count": 2, "score": 0, "last_activity_date": 1475060430, "creation_date": 1475056673, "question_id": 39744115, "link": "https://stackoverflow.com/questions/39744115/how-do-i-make-the-last-element-in-my-linked-list-point-to-null-in-c", "title": "How do i make the last element in my linked list point to null in C", "body": "<p>I was trying to implement a linked list in C. In my linked list i want to insert elements to the start of the list, so i have the following method...</p>\n\n<pre><code>void insertToStart(LinkedList* list, Student st)\n{\n  LinkedListNode* newNode = (LinkedListNode*)malloc(sizeof(LinkedListNode)); \n  newNode-&gt;data = st;\n  newNode-&gt;next = list-&gt;head;\n  list-&gt;head = newNode;\n}\n</code></pre>\n\n<p>my problem comes when I try to print my list... i get an infinite loop. This is my printList method</p>\n\n<pre><code>void printList(LinkedList* list)\n{\n  LinkedListNode* current;\n  current = list-&gt;head;\n  while(current != NULL)\n  {\n    printf(\"Name: %s ID: %d\\n\", current-&gt;data.name , current-&gt;data.ID);\n    current = current-&gt;next;\n  }\n}\n</code></pre>\n\n<p>If figured it might be because the last element's next in my list does not point to null but I don't know how to make the last element's next point to null. How can I do this?\nThis is my header file...</p>\n\n<pre><code>#ifndef LINKEDLIST_H\n#define LINKEDLIST_H\n\ntypedef struct{\n  char name[20];\n  int ID;\n} Student;\n\ntypedef struct LinkedListNode{\n  Student data;\n  struct LinkedListNode* next;\n} LinkedListNode;\n\ntypedef struct {\n  LinkedListNode* head;\n} LinkedList;\n\nvoid mallocList(LinkedList* list);\nvoid insertToStart(LinkedList* list, Student st);\nvoid printList(LinkedList* list);\n\n#endif\n</code></pre>\n"}, {"tags": ["c", "arrays", "unsigned-char"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1475056746, "post_id": 39744100, "comment_id": 66784890, "body": "Your code makes a &quot;deep copy&quot; as is."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1475060384, "post_id": 39744100, "comment_id": 66787457, "body": "Note that <code>sizeof (unsigned char)</code> is always 1, so it&#39;s just an annoying way to write <code>1</code> (wihch in case of a multiplication is pretty pointless). Consider removing it."}, {"owner": {"reputation": 173, "user_id": 4315067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65bf9059642039809aefaf1a3c4c0cfa?s=128&d=identicon&r=PG&f=1", "display_name": "litao3rd", "link": "https://stackoverflow.com/users/4315067/litao3rd"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1475064440, "post_id": 39744100, "comment_id": 66790253, "body": "@unwind actually on different platform, <code>sizeof(unsigned char)</code> is not always 1. So I think it&#39;s not a good idea to remove it."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 173, "user_id": 4315067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65bf9059642039809aefaf1a3c4c0cfa?s=128&d=identicon&r=PG&f=1", "display_name": "litao3rd", "link": "https://stackoverflow.com/users/4315067/litao3rd"}, "edited": false, "score": 0, "creation_date": 1475064595, "post_id": 39744100, "comment_id": 66790376, "body": "@litao3rd No. You are mistaken, that&#39;s simply not true. The return value from <code>sizeof</code> is units of <code>char</code>, so by definition <code>sizeof (char)</code> is 1."}, {"owner": {"reputation": 173, "user_id": 4315067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65bf9059642039809aefaf1a3c4c0cfa?s=128&d=identicon&r=PG&f=1", "display_name": "litao3rd", "link": "https://stackoverflow.com/users/4315067/litao3rd"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1475064919, "post_id": 39744100, "comment_id": 66790617, "body": "@unwind yep, sizeof(char) is not always 1 on different architecture. And <code>sizeof</code> is executed in compile time, so I think <code>sizeof(unsigned char)</code> is better than a magic number <code>1</code>."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 173, "user_id": 4315067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65bf9059642039809aefaf1a3c4c0cfa?s=128&d=identicon&r=PG&f=1", "display_name": "litao3rd", "link": "https://stackoverflow.com/users/4315067/litao3rd"}, "edited": false, "score": 0, "creation_date": 1475065088, "post_id": 39744100, "comment_id": 66790741, "body": "@litao3rd C11 draft, section 6.5.3.4 &#167;4: &quot;When <code>sizeof</code> is applied to an operand that has type <code>char</code>, <code>unsigned char</code>, or <code>signed char</code>, (or a qualified version thereof) the result is 1.&quot; And I&#39;m aware it&#39;s compile-time, my suggestion was to remove it altogether, not replace by a literal <code>1</code>."}, {"owner": {"reputation": 173, "user_id": 4315067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65bf9059642039809aefaf1a3c4c0cfa?s=128&d=identicon&r=PG&f=1", "display_name": "litao3rd", "link": "https://stackoverflow.com/users/4315067/litao3rd"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1475065479, "post_id": 39744100, "comment_id": 66791027, "body": "@unwind yep, you&#39;re right. I misunderstand you."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 2, "last_activity_date": 1475057328, "creation_date": 1475057328, "answer_id": 39744394, "question_id": 39744100, "link": "https://stackoverflow.com/questions/39744100/c-unsigned-char-bytes-array-copying-elements-to-other-unsigned-char-array/39744394#39744394", "title": "C: unsigned char * bytes array copying elements to other unsigned char * array", "body": "<p><code>new_bytes_array[j]</code> evaluates to an <code>unsigned char</code>. </p>\n\n<p>Assuming <code>old_bytes_array[i]</code> does as well, then this</p>\n\n<pre><code>new_bytes_array[j] = old_bytes_array[i];\n</code></pre>\n\n<p>copies an <code>unsigned char</code> and not a pointer, not an <code>unsigned char*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1475065942, "creation_date": 1475065942, "answer_id": 39747653, "question_id": 39744100, "link": "https://stackoverflow.com/questions/39744100/c-unsigned-char-bytes-array-copying-elements-to-other-unsigned-char-array/39747653#39747653", "title": "C: unsigned char * bytes array copying elements to other unsigned char * array", "body": "<p>Yes, the assignment you show assigns a single <code>unsigned char</code>, i.e. \"a byte\" on most typical computers, it doesn't copy pointers but raw data.</p>\n\n<p>Here's a complete function that does what you want, and fixes a few minor problems:</p>\n\n<pre><code>void * copy_every_second_byte(const void *src, size_t length)\n{\n  if(src == NULL || length == 0)\n    return NULL;\n  unsigned char *out = malloc(length / 2);\n  for(size_t i = 0, j = 0; i &lt; length; ++i)\n  {\n    if(i % 2 == 0) continue;\n    out[j++] = ((unsigned char *) src)[i];\n  }\n  return out;\n}\n</code></pre>\n"}], "owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1122, "favorite_count": 0, "accepted_answer_id": 39744394, "answer_count": 2, "score": 1, "last_activity_date": 1475065942, "creation_date": 1475056632, "question_id": 39744100, "link": "https://stackoverflow.com/questions/39744100/c-unsigned-char-bytes-array-copying-elements-to-other-unsigned-char-array", "title": "C: unsigned char * bytes array copying elements to other unsigned char * array", "body": "<p>I think that copying elements of array like this: </p>\n\n<pre><code>unsigned char *new_bytes_array = malloc(sizeof(unsigned char)*length/2); \nfor(int i=0, j=0; i&lt;length; i++) {\n  if(i % 2 == 0) continue; \n  new_bytes_array[j] = old_bytes_array[i]; \n  j++;\n</code></pre>\n\n<p>}</p>\n\n<p>is making copy but value not by reference, but I would like to make sure that this will be deep copy not just shallow copy of references or pointers. </p>\n\n<p>I know that this is maybe easy and ridiculous qustion, but I cannot find similar on stack rather memcpy() all array, but I want to copy only some elements for example every second element, or copy 1-3 elements and skip 4th element, (if i%4 == 0 skip element). </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1475056846, "post_id": 39744031, "comment_id": 66784967, "body": "<code>scanf(&quot;%s %d %d&quot;,&amp;name,&amp;hours,&amp;rate);</code> --&gt; <code>scanf(&quot;%s %d %d&quot;,name,&amp;hours,&amp;rate);</code> or <code>scanf(&quot;%s %d %d&quot;,&amp;name[0],&amp;hours,&amp;rate);</code>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1475056934, "post_id": 39744031, "comment_id": 66785033, "body": "<code>main()</code> --&gt; <code>int main(void)</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475057657, "post_id": 39744031, "comment_id": 66785579, "body": "You can define a <code>struct</code> to hold that information, then an array of that <code>struct</code> can hold the information for a number of employees."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475069374, "post_id": 39744031, "comment_id": 66794025, "body": "Tip: Rather than describe the output &quot;but only displays one output.&quot;, better to post the exact output received.  Good to post what you want, better to post what you want as text than as a picture.  Post the input used too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475069914, "post_id": 39744031, "comment_id": 66794503, "body": "If your input was &quot;Jane 39 10.00\\n&quot; &quot;Henry 40 10.00\\n&quot; ... then the present answer will not fix your issue.  Posting your sample input will help.  Not posting input leaves this post unclear."}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1475146298, "post_id": 39744666, "comment_id": 66830908, "body": "You do not need &amp;name[0] - name will do"}, {"owner": {"reputation": 1669, "user_id": 6652664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PhfUI.jpg?s=128&g=1", "display_name": "sinsuren", "link": "https://stackoverflow.com/users/6652664/sinsuren"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1475146540, "post_id": 39744666, "comment_id": 66831045, "body": "but is &amp;name[0] is wrong?? . I know name will do. Please correct me if i am wrong. @edHeal . That is why i have mentioned it in or statement."}], "tags": [], "owner": {"reputation": 1669, "user_id": 6652664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PhfUI.jpg?s=128&g=1", "display_name": "sinsuren", "link": "https://stackoverflow.com/users/6652664/sinsuren"}, "is_accepted": false, "score": 0, "last_activity_date": 1475142571, "last_edit_date": 1475142571, "creation_date": 1475057991, "answer_id": 39744666, "question_id": 39744031, "link": "https://stackoverflow.com/questions/39744031/scanf-and-loops-with-multiple-inputs-c/39744666#39744666", "title": "scanf and loops with multiple inputs - c", "body": "<p>As already mentioned by @LPs in comments. \nChange following line<br>\n<code>scanf(\"%s %d %d\",&amp;name,&amp;hours,&amp;rate);</code> <br> to this <br> <code>scanf(\"%s %d %d\",name,&amp;hours,&amp;rate);</code><br> or <br><code>scanf(\"%s %d %d\",&amp;name[0],&amp;hours,&amp;rate);</code></p>\n"}, {"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1475146263, "post_id": 39745815, "comment_id": 66830878, "body": "You do not need <code>&amp;name[0]</code> - <code>name</code> will do"}], "tags": [], "owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "is_accepted": false, "score": 0, "last_activity_date": 1475145769, "last_edit_date": 1475145769, "creation_date": 1475061139, "answer_id": 39745815, "question_id": 39744031, "link": "https://stackoverflow.com/questions/39744031/scanf-and-loops-with-multiple-inputs-c/39745815#39745815", "title": "scanf and loops with multiple inputs - c", "body": "<p>Try this one...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() { //it must be int main()\n    // Declaring variables\n    char name[25];\n    int hours, rate, gross, bonus, counter;\n\n    printf(\" A program to determine the gross pay for six Employees\\n Please Enter the Name, No. of hours worked and hourly rate respectively\\n\");\n\n    for (counter = 1; counter &lt;= 6; counter++) {\n        scanf(\"%s %d %d\", &amp;name[0], &amp;hours, &amp;rate); //you are reading string as input, use either &amp;name[0] or name (base address)\n        gross = hours*rate; // determining the gross pay\n        printf(\"%s %d %d %d\\n\", name, hours, rate, gross);\n    }\n    return 0; //on successful completion \n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6892837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2517d4028def059c2072d7435ea04377?s=128&d=identicon&r=PG", "display_name": "Junta", "link": "https://stackoverflow.com/users/6892837/junta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1741, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1475145769, "creation_date": 1475056496, "last_edit_date": 1475145715, "question_id": 39744031, "link": "https://stackoverflow.com/questions/39744031/scanf-and-loops-with-multiple-inputs-c", "title": "scanf and loops with multiple inputs - c", "body": "<p>How can I make my program accept multiple inputs ( using <code>scanf</code> &amp; loops) &amp; print the results respectively after calculations?</p>\n\n<p>My program accepts six inputs but only displays one output. I would like to get the following output: <img src=\"https://i.stack.imgur.com/MS3jv.jpg\" alt=\"sample output I want\">.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n\n    main() {\n        // Declaring variables\n        char name[25];\n        int hours, rate, gross, bonus, counter;\n\n        printf(\" A program to determine the gross pay for six Employees\\n Please Enter the Name, No. of hours worked and hourly rate respectively\\n\");\n\n        for (counter = 1; counter &lt;= 6; counter++) {\n            scanf(\"%s %d %d\", &amp;name, &amp;hours, &amp;rate);\n            gross = hours * rate; // determining the gross pay\n            printf(\"%s %d %d %d\\n\", name, hours, rate, gross);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c", "double", "precision", "floating-accuracy"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475057138, "post_id": 39743906, "comment_id": 66785197, "body": "The decimal number <code>0.0001</code> cannot be precisely represented by <code>double</code> or even by <code>long double</code> in the same way that <code>1 &#47; 7</code> cannot be precisely represented in decimal notation."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475057403, "post_id": 39743906, "comment_id": 66785405, "body": "Here is <a href=\"http://stackoverflow.com/questions/588004/is-floating-point-math-broken\">another duplicate</a>"}, {"owner": {"reputation": 23, "user_id": 6808027, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p008Jal_ViY/AAAAAAAAAAI/AAAAAAAANr4/-4R7aZEJ0Lw/photo.jpg?sz=128", "display_name": "Pelayo Pe&#241;arroya", "link": "https://stackoverflow.com/users/6808027/pelayo-pe%c3%b1arroya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475057724, "post_id": 39743906, "comment_id": 66785620, "body": "@WeatherVane thanks but my question&#180;s aim is not to understand what happens (I already did) but to obtain a solution that could help me handle this deficiency... any ideas? separate the number in two ints (one for the integer and other for the decimal)? I need this to work accurately."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475057969, "post_id": 39743906, "comment_id": 66785775, "body": "You could use fixed-point arithmetic, for example 64 bit <code>int</code> can represent about 19 decimal digits. But you&#39;ll still have the same problem with other numbers such as <code>1&#47;7</code> or <code>1&#47;3</code> and so on. You simply cannot represent an infinite possibility of numbers in a finite space. You have to put up with approximations."}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1475102881, "post_id": 39743906, "comment_id": 66813652, "body": "If you want exact representation of terminating decimal fractions, and exact addition, consider a decimal arithmetic library. If you need exact representation of all rational numbers look for a rational arithmetic library. Use <code>double</code> when you want very efficient, very close approximations to a wide range of numbers."}], "owner": {"reputation": 23, "user_id": 6808027, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p008Jal_ViY/AAAAAAAAAAI/AAAAAAAANr4/-4R7aZEJ0Lw/photo.jpg?sz=128", "display_name": "Pelayo Pe&#241;arroya", "link": "https://stackoverflow.com/users/6808027/pelayo-pe%c3%b1arroya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1475057276, "answer_count": 0, "score": 0, "last_activity_date": 1475057868, "creation_date": 1475056256, "last_edit_date": 1475057868, "question_id": 39743906, "link": "https://stackoverflow.com/questions/39743906/how-can-i-improve-precision-in-double-operations", "closed_reason": "Duplicate", "title": "How can I improve precision in double operations?", "body": "<p>I am trying to sum this:</p>\n\n<p><code>2449210.0000000000 + 0.00010000000000000000</code></p>\n\n<p>and I get this:</p>\n\n<pre><code>2449210.0000999998\n</code></pre>\n\n<p>both numbers are defined as <code>double</code> and I am programming in C using VS10.</p>\n\n<p>I have been reading about precission in this field but I have come to no profitable solution (something with <code>long double</code>??). I need this sumation to be correct. Any ideas?</p>\n\n<p>EDIT: I dont want to know why this happens (already do), but how to run around this deficiency.</p>\n\n<p>thanks</p>\n"}, {"tags": ["c", "file", "character"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 7, "creation_date": 1475056228, "post_id": 39743770, "comment_id": 66784398, "body": "<code>for (int i = 0; i &lt;= 26; ++i)</code> breaks the array bounds."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 7, "creation_date": 1475056277, "post_id": 39743770, "comment_id": 66784439, "body": "I would also not use a <code>char</code> array, it won&#39;t work on larger files. Use <code>unsigned int</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1475056346, "post_id": 39743770, "comment_id": 66784512, "body": "Moreover you are reading and discarding the first character in the file."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475056348, "post_id": 39743770, "comment_id": 66784513, "body": "well, @WeatherVane gave you the answer. <code>char</code> range is not enough for your test file."}, {"owner": {"reputation": 21, "user_id": 6892787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cff995a7b4201e49cf14d499fc262?s=128&d=identicon&r=PG&f=1", "display_name": "Nora", "link": "https://stackoverflow.com/users/6892787/nora"}, "edited": false, "score": 0, "creation_date": 1475056557, "post_id": 39743770, "comment_id": 66784709, "body": "Thank you Weather Vane! Seems to be that fixing the char to unsigned int and changing  i &lt;= 26; to i&lt; 26; solved my problem. :D Thank you!"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1475056817, "post_id": 39743770, "comment_id": 66784948, "body": "<code>int ch = fgetc(f);</code> drop one character."}], "answers": [{"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 0, "last_activity_date": 1475056547, "last_edit_date": 1475056547, "creation_date": 1475056399, "answer_id": 39743973, "question_id": 39743770, "link": "https://stackoverflow.com/questions/39743770/most-common-character-in-a-file-in-c/39743973#39743973", "title": "Most common character in a file in C", "body": "<p>You should use &lt; operator in the second for loop. Because of that when you are checking frequency[i] > maxCount, at frequency[26] it behaves undefined behaviour, meaning the value at that index may be less or higher than the compared value.</p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 6876715, "user_type": "registered", "profile_image": "https://graph.facebook.com/936032563165346/picture?type=large", "display_name": "Ziggy192", "link": "https://stackoverflow.com/users/6876715/ziggy192"}, "is_accepted": false, "score": 0, "last_activity_date": 1475070857, "creation_date": 1475070857, "answer_id": 39749609, "question_id": 39743770, "link": "https://stackoverflow.com/questions/39743770/most-common-character-in-a-file-in-c/39749609#39749609", "title": "Most common character in a file in C", "body": "<p>Your code do have some problems. However, they are so tiny so the code still works well with small tests.</p>\n\n<ol>\n<li><p><code>int ch = fgetc(f);</code> drop the first char in the file</p></li>\n<li><p><code>for (int i = 0; i &lt;= 26; ++i)</code> break out of the array 's range (only from 0-->25)</p></li>\n</ol>\n\n<p><strong>Beside these small mistakes, your code is awesomely fine. Well done #thumbsup</strong></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1475071559, "last_edit_date": 1495541969, "creation_date": 1475071246, "answer_id": 39749773, "question_id": 39743770, "link": "https://stackoverflow.com/questions/39743770/most-common-character-in-a-file-in-c/39749773#39749773", "title": "Most common character in a file in C", "body": "<ol>\n<li><p>Loop runs out-of-bounds.  <a href=\"https://stackoverflow.com/questions/39743770/most-common-character-in-a-file-in-c#comment66784398_39743770\">@Weather Vane</a></p>\n\n<pre><code>// for (int i = 0; i &lt;= 26; ++i) {\nfor (int i = 0; i &lt; 26; ++i) {\n</code></pre></li>\n<li><p>Code throws away result of the first character. <a href=\"https://stackoverflow.com/questions/39743770/most-common-character-in-a-file-in-c#comment66784948_39743770\">@BLUEPIXY</a></p>\n\n<pre><code>int ch = fgetc(f);\nif (ch == EOF) {\n  return 0;\n}\n// This value of ch is not subsequently used.\n</code></pre></li>\n</ol>\n\n<p>Other fixes as below</p>\n\n<pre><code>int most_common_character(char *filename) {\n    ...\n\n    // Use a more generous count @Weather Vane\n    // char frequency[26];\n    // Consider there may be more than 26 different letters\n    // fgetc return EOF and value in the unsigned char range\n    int frequency[UCHAR_MAX + 1] = { 0 };\n\n    // Not needed as array was initialize above\n    // for (ch = 0; ch &lt; 26; ch++) { frequency[ch] = 0; }\n\n    // BTW correct type declaration of int, avoided rookie mistake of using char\n    int ch;\n\n    // Codes use tolower(), islower() as that is the portable way to \n    // handle type-of-character detection\n    while ((ch = fgetc(f)) != EOF) {\n      frequency[tolower(ch)]++;  // could add check to insure frequency[] does not overflow\n    } \n\n    int maxCount = 0;\n    int maxChar = -1;\n    for (int i = 0; i &lt;= UCHAR_MAX; ++i) {\n      if (islower(i) &amp;&amp; frequency[i] &gt; maxCount) {\n        maxCount = frequency[i];\n        maxChar = i;\n      }\n    }\n\n    fclose(f);\n    return maxChar;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6892787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cff995a7b4201e49cf14d499fc262?s=128&d=identicon&r=PG&f=1", "display_name": "Nora", "link": "https://stackoverflow.com/users/6892787/nora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1475071559, "creation_date": 1475055953, "last_edit_date": 1475056414, "question_id": 39743770, "link": "https://stackoverflow.com/questions/39743770/most-common-character-in-a-file-in-c", "title": "Most common character in a file in C", "body": "<p>I'm doing my C programming course homework and I need to find a most common character in given file. </p>\n\n<p>My testing with a testfile, emptyfile and other small amount text files works great (or at least I think so), but in the last long testfile something goes wrong and the error message is: <strong>\"Should have returned 'e' (101) for file rfc791.txt. You returned 'b' (98)\"</strong>. </p>\n\n<p>So what I'm asking that what might be wrong with my code, when suddenly the most common letter is not what is should be? </p>\n\n<pre><code>int most_common_character(char *filename) {\n    FILE *f;\n    if ((f = fopen(filename, \"r\")) == NULL) {\n        fprintf(stderr, \"Not opened: %s\\n\", strerror(errno));\n        return -1;\n    }\n\n    char frequency[26];\n    int ch = fgetc(f);\n    if (ch == EOF) {\n        return 0;\n    }\n\n    for (ch = 0; ch &lt; 26; ch++) {\n        frequency[ch] = 0;\n    }\n\n    while (1) {\n        ch = fgetc(f);\n        if (ch == EOF) {\n            break;\n        }\n        if ('a' &lt;= ch &amp;&amp; ch &lt;= 'z') {\n            frequency[ch - 'a']++;\n        }\n        else if ('A' &lt;= ch &amp;&amp; ch &lt;= 'Z') {\n            frequency[ch - 'A']++;\n        }\n    }\n    int maxCount = 0;\n    int maxChar = 0;\n    for (int i = 0; i &lt;= 26; ++i) {\n        if (frequency[i] &gt; maxCount) {\n            maxCount = frequency[i];\n            maxChar = i;\n        }\n    }\n    fclose(f);\n    return maxChar + 'a';\n}\n</code></pre>\n\n<p>I would be very grateful if someone has any hints to fix my code :) I've tried to search the solution to this problem from many other related topics but nothing seems to work.</p>\n"}, {"tags": ["c", "string", "pointers", "initialization", "braces"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1475055248, "post_id": 39743416, "comment_id": 66783683, "body": "Pointers are not arrays, arrays are not pointers. The can be used in similar contexts, but they are not the same. One way they are not the same is how they are initialized."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475055598, "post_id": 39743416, "comment_id": 66783926, "body": "<code>&quot;AB&quot;</code> is a string literal as you point out, but <code>{ &#39;A&#39;, &#39;B&#39; }</code> is not, nor any kind of array. It is data used to initialise the variable, so a) is of the wrong type, and b) more than one initialiser was provided."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1475057556, "post_id": 39743416, "comment_id": 66785505, "body": "This <code>char *str3  = (char[]) {&#39;A&#39;, &#39;B&#39;};</code> would work ... :-)"}, {"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1475144035, "post_id": 39743416, "comment_id": 66829441, "body": "Thanks to all ( @alk @WeatherVane @JoachimPileborg) :)   That makes sense:  1) &quot;AB&quot; is an unnamed string already allocated by the compiler, that then can be pointed to by an array or a char pointer (without the need of allocating new memory). 2) {&#39;A&#39;, &#39;B&#39;} are only initializers.   So in the end the ones that do not behave as conceptually expected are the arrays, since they can be initialized both: 1) allocating memory and initializing them(<code>char v3[ ]  = {&#39;A&#39;, &#39;B&#39;};</code>)  2) not allocating memory but only making them point to an already allocated unnamed string (<code>char v1[ ]  =  &quot;AB&quot;;</code>)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475180480, "post_id": 39743416, "comment_id": 66852897, "body": "these two lines: <code>char v4[2]  =  &quot;AB&quot;;      char v5[2]  = {&quot;AB&quot;};</code> are not correct.   Because a character string is always terminated with a NUL byte.  However, these two variable declarations are only allowing for 2 bytes while the actual string length is 3, not 2"}, {"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475311374, "post_id": 39743416, "comment_id": 66900952, "body": "Thanks for the comment @user3629249 I didn&#39;t want to declare a string, just an array of chars, I don&#39;t need the NULL character. So I could use that declaration and the compiler didn&#39;t complain (please correct me if you think I am wrong). Do you mean that there is an implicity declaration of the final \\0 character in those strings and that I am doing something not correct that can cause a problem?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475311735, "post_id": 39743416, "comment_id": 66901044, "body": "when you supply the double quotes around the array initializer, the result is a NUL terminated string of characters"}, {"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "edited": false, "score": 0, "creation_date": 1475313496, "post_id": 39743416, "comment_id": 66901472, "body": "It&#39;s strange, the compiler didn&#39;t complain. Maybe it discards the NULL character in these cases, because if the declaration was with 3 chars like &quot;ABC&quot; (plus the \\0 added) and the declared array length only 2, the compiler would indeed complain. Thanks in any case for the help :)"}, {"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "edited": false, "score": 0, "creation_date": 1475487611, "post_id": 39743416, "comment_id": 66947029, "body": "Just for the record, two links where they state the final \\0 it is ignored by the compiler, and it is not a mistake: a) <a href=\"http://en.cppreference.com/w/c/language/array_initialization\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/array_initialization</a>  b) <a href=\"https://www.securecoding.cert.org/confluence/display/c/STR11-C.+Do+not+specify+the+bound+of+a+character+array+initialized+with+a+string+literal\" rel=\"nofollow noreferrer\">securecoding.cert.org/confluence/display/c/&hellip;</a>"}, {"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "edited": false, "score": 0, "creation_date": 1475488640, "post_id": 39743416, "comment_id": 66947629, "body": "A more detailed example, with reference to the Standard: <a href=\"https://balau82.wordpress.com/2011/05/31/a-nasty-string-initialization-bug-in-c/\" rel=\"nofollow noreferrer\">balau82.wordpress.com/2011/05/31/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "edited": false, "score": 0, "creation_date": 1475144428, "post_id": 39745175, "comment_id": 66829707, "body": "Then, if for an array is not necessary to allocate memory, why this code is correct? <code>char v3[ ]  = {&#39;A&#39;, &#39;B&#39;};</code> Here you need to allocate memory and then initialize the array of characters with each element."}, {"owner": {"reputation": 1, "user_id": 6886106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52fd63f975f6988b03d75816a9209ef?s=128&d=identicon&r=PG&f=1", "display_name": "M.zanousi", "link": "https://stackoverflow.com/users/6886106/m-zanousi"}, "reply_to_user": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "edited": false, "score": 0, "creation_date": 1475305293, "post_id": 39745175, "comment_id": 66899566, "body": "When you make an array in c language, a memory is allocated automatically but for pointers, you need to allocate memory by &quot;malloc function&quot; like this : str3 = (char *)malloc(sizeof(char)*Num);"}, {"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "edited": false, "score": 0, "creation_date": 1475312553, "post_id": 39745175, "comment_id": 66901231, "body": "Thanks for the feedback @M.zanousi :) I know about pointers and dynamic memory allocation. Just wondering the consistency of the array declarations in C. A) when we declare an array in C some memory is allocated automatically, and B) for a string (&quot;&quot;) memory is allocated but not for a character (&#180;&#180;). Then this code <code>char v3[ ]  = {&#39;A&#39;, &#39;B&#39;};</code> makes sense (array allocates and chars dont, so they are put there). However, this code does not make sense for me <code>char v1[ ]  =  &quot;AB&quot;;</code> because there are 2 memory allocations, 1 made for the array and the other for the string &quot;AB&quot;. What am I missing?"}], "tags": [], "owner": {"reputation": 1, "user_id": 6886106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52fd63f975f6988b03d75816a9209ef?s=128&d=identicon&r=PG&f=1", "display_name": "M.zanousi", "link": "https://stackoverflow.com/users/6886106/m-zanousi"}, "is_accepted": false, "score": 0, "last_activity_date": 1475059328, "creation_date": 1475059328, "answer_id": 39745175, "question_id": 39743416, "link": "https://stackoverflow.com/questions/39743416/pointer-to-char-initialization-in-c/39745175#39745175", "title": "Pointer to Char Initialization in C", "body": "<p>(\" \") is for string and (' ') is for character. for an string a memory has been allocated and for character not. pointers points to a memory and you must allocate an specified memory to it but for array of characters is not necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "edited": false, "score": 0, "creation_date": 1475142853, "post_id": 39745933, "comment_id": 66828614, "body": "Thank you very much @JoachimPileborg for the detailed answer, now I understand it much better :) I think the key point I was missing is &quot;constant string literals are themselves arrays&quot; and its explanation.   Regarding the <i>constant</i> part, I didn&#39;t know that either. I will check that thoroughly since I normally use char *str with strings (&quot;AB&quot;) and modify its char elements."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1475061461, "creation_date": 1475061461, "answer_id": 39745933, "question_id": 39743416, "link": "https://stackoverflow.com/questions/39743416/pointer-to-char-initialization-in-c/39745933#39745933", "title": "Pointer to Char Initialization in C", "body": "<p>There is one thing you need to learn about constant string literals. Except when used to initialize an array (for example in the case of <code>v1</code> in your example code) constant string literals are themselves arrays. For example if you use the literal <code>\"AB\"</code> it is stored somewhere by the compiler as an array of three characters: <code>'A'</code>, <code>'B'</code> and the terminator <code>'\\0'</code>.</p>\n\n<p>When you initialize a pointer to point to a literal string, as in the case of <code>str1</code> and <code>str2</code>, then you are making those pointers point to the first character in those arrays. You don't actually create an array named <code>str1</code> (for example) you just make it point somewhere.</p>\n\n<p>The definition</p>\n\n<pre><code>char *str1 = \"AB\";\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>char *str1;\nstr1 = \"AB\";\n</code></pre>\n\n<p>Or rather</p>\n\n<pre><code>char unnamed_array_created_by_compiler[] = \"AB\";\nchar *str1 = unnamed_array_created_by_compiler;\n</code></pre>\n\n<hr>\n\n<p>There are also other problematic things with the definitions you show. First of all the arrays <code>v3</code>, <code>v4</code>, <code>v5</code> and <code>v6</code>. You tell the compiler they will be arrays of two <code>char</code> elements. That means you can not use them as strings in C, since strings needs the special terminator character <code>'\\0'</code>.</p>\n\n<p>In fact if you check the sizes of <code>v1</code> and <code>v2</code> you will see that they are indeed <em>three</em> bytes large, once for each of the characters plus the terminator.</p>\n\n<p>Another important thing you miss is that while constant string literals are arrays of <code>char</code>, you miss the <em>constant</em> part. String literals are really read-only, even if not stored as such. That's why you should never create a pointer to <code>char</code> (like <code>str1</code> and <code>str2</code>) to point to them, you should create pointers to <em>constant</em> <code>char</code>. I.e.</p>\n\n<pre><code>const char *str1 = \"AB\";\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 6892577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871d574cf46242569247c7a4037df4bd?s=128&d=identicon&r=PG&f=1", "display_name": "J L", "link": "https://stackoverflow.com/users/6892577/j-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1390, "favorite_count": 0, "accepted_answer_id": 39745933, "answer_count": 2, "score": 0, "last_activity_date": 1485876244, "creation_date": 1475055097, "last_edit_date": 1485876244, "question_id": 39743416, "link": "https://stackoverflow.com/questions/39743416/pointer-to-char-initialization-in-c", "title": "Pointer to Char Initialization in C", "body": "<p>If this code is correct:</p>\n\n<pre><code>char v1[ ]  =  \"AB\";     \nchar v2[ ]  = {\"AB\"};\nchar v3[ ]  = {'A', 'B'};\nchar v4[2]  =  \"AB\";     \nchar v5[2]  = {\"AB\"};\nchar v6[2]  = {'A', 'B'};\nchar *str1  =  \"AB\";\nchar *str2  = {\"AB\"};\n</code></pre>\n\n<p>Then why this other one is not?</p>\n\n<pre><code>char *str3  = {'A', 'B'};\n</code></pre>\n\n<p>To the best of my knowledge (please correct me if I'm wrong at any point) \"AB\" is a string literal and 'A' and 'B' are characters (integers,scalars). In char *str1 = \"AB\"; the string literal \"AB\" is defined and the char pointer is set to point to that string literal (to the first element). With char *str3  = {'A', 'B'}; two characters are defined and stored in subsequent memory positions, and the char pointer \"should\" be set to point to the first one. Why is that not correct?</p>\n\n<p>In a similar way, a regular char array like v3[] or v6[2] can indeed be initialized with {'A', 'B'}. The two characters are defined, the array is set to point to them and thus, being \"turned into\" or treated like a string literal. Why a char pointer like char *str3 does not behave in the same way? </p>\n\n<p>Just for the record, gcc compiler warnings I get are \"initialization makes pointer from integer without a cast\" when it gets to the 'A', and \"excess elements in scalar initializer\" when it gets to the 'B'.  </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "multithreading", "function", "ffmpeg"], "comments": [{"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475113134, "post_id": 39742504, "comment_id": 66815841, "body": "Do you mean you have a file with two audio streams? Check AVPacket.stream_index. Note that each stream will require its own AVCodecContext."}, {"owner": {"reputation": 241, "user_id": 6830324, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/198815f44f02c47247166609db58738a?s=128&d=identicon&r=PG&f=1", "display_name": "Meugiwara", "link": "https://stackoverflow.com/users/6830324/meugiwara"}, "reply_to_user": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475148411, "post_id": 39742504, "comment_id": 66832243, "body": "@RonaldS.Bultje, Not exactly, I mean I have one file which gives one audio stream that I want to duplicate to get two audio streams."}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475162416, "post_id": 39742504, "comment_id": 66842659, "body": "Ah; use av_copy_packet() or av_packet_clone(), depending on whether you want to actually copy the data (copy), i.e. allowing you to modify one without affecting the other array, or just copy the reference to the data (clone), which means the data pointer is still the same (and modifying one will modify both), you now just have 2 references to it."}, {"owner": {"reputation": 241, "user_id": 6830324, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/198815f44f02c47247166609db58738a?s=128&d=identicon&r=PG&f=1", "display_name": "Meugiwara", "link": "https://stackoverflow.com/users/6830324/meugiwara"}, "reply_to_user": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475222032, "post_id": 39742504, "comment_id": 66866446, "body": "@RonaldS.Bultje, Thank you, it works. Now, I have another question about filters. I want to apply the bass filter and the treble filter. How can I do with packets (If filters can be used with packets or other) ?"}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475241908, "post_id": 39742504, "comment_id": 66878137, "body": "You need to decode the compressed data to get an AVFrame. Then, the AVFrame can be input in a filter chain, see <a href=\"http://stackoverflow.com/a/38103053/4726410\">stackoverflow.com/a/38103053/4726410</a> for a related example."}, {"owner": {"reputation": 241, "user_id": 6830324, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/198815f44f02c47247166609db58738a?s=128&d=identicon&r=PG&f=1", "display_name": "Meugiwara", "link": "https://stackoverflow.com/users/6830324/meugiwara"}, "reply_to_user": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475320403, "post_id": 39742504, "comment_id": 66903294, "body": "@RonaldS.Bultje, Thank you for the help. I have some questions about the FFmpeg library. Do you think that I can add you on Skype (microzion) to discuss on my project ?"}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475436485, "post_id": 39742504, "comment_id": 66932036, "body": "I prefer email over skype. Any reason you can&#39;t use the public mailinglist?"}, {"owner": {"reputation": 241, "user_id": 6830324, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/198815f44f02c47247166609db58738a?s=128&d=identicon&r=PG&f=1", "display_name": "Meugiwara", "link": "https://stackoverflow.com/users/6830324/meugiwara"}, "reply_to_user": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475479803, "post_id": 39742504, "comment_id": 66942975, "body": "@RonaldS.Bultje, I just prefer email that&#39;s more simple. At which email may I join you ?"}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "edited": false, "score": 0, "creation_date": 1475578311, "post_id": 39742504, "comment_id": 66988607, "body": "rsbultje@gmail.com works"}], "owner": {"reputation": 241, "user_id": 6830324, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/198815f44f02c47247166609db58738a?s=128&d=identicon&r=PG&f=1", "display_name": "Meugiwara", "link": "https://stackoverflow.com/users/6830324/meugiwara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 702, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475052810, "creation_date": 1475052810, "question_id": 39742504, "link": "https://stackoverflow.com/questions/39742504/how-to-get-multiple-av-read-frame-with-ffmpeg", "title": "How to get multiple av_read_frame with FFmpeg", "body": "<p>I want to get \"2 signals\" when I read an audio file. I know that I must use the FFmpeg function av_read_frame, but I have just that I call \"1 signal\". How can I have multiple signals to treat each signal in different way ?</p>\n\n<p>My code is like that :</p>\n\n<pre><code>while (av_read_frame(pFormatCtx, packet) &gt;= 0)\n{\n    /* AVPacket == Audio */\n    if (packet-&gt;stream_index == audioStream)\n    {\n        /* D\u00e9codage des packets */\n        ret = avcodec_decode_audio4(pCodecCtx, pFrame, &amp;got_picture, packet);\n        if (ret &lt; 0)\n        {\n            fprintf(stderr, \"%s\\n\", \"Error in decoding audio frame\");\n            return (-1);\n        }\n        if (got_picture &gt; 0)\n        {\n            /* Convertissage de l'audio */\n            swr_convert(au_convert_ctx, &amp;out_buffer, MAX_AUDIO_FRAME_SIZE, (const uint8_t **)pFrame-&gt;data, pFrame-&gt;nb_samples);\n\n#if 1\n\n            /* Affichage des informations dans la console */\n            printf(\"Index : %5d\\t Points : %lld\\t Packet size : %d\\n\", index, packet-&gt;pts, packet-&gt;size);\n\n#endif /* 1 */\n\n#if OUTPUT_PCM\n\n            /* Fonction pour \u00e9crire dans le fichier */\n            fwrite(out_buffer, 1, out_buffer_size, pFile);\n\n#endif /* OUTPUT_PCM */\n\n            /* Incr\u00e9mentation */\n            index = index + 1;\n        }\n\n#if USE_SDL\n\n        while (audio_len &gt; 0)\n            SDL_Delay(1);\n        /* Attribution des valeurs avec les variables globales */\n        audio_chunk = (Uint8 *)out_buffer;\n        audio_len = out_buffer_size;\n        audio_pos = audio_chunk;\n        SDL_PauseAudio(0);\n\n#endif /* USE_SDL */\n\n    }\n    /* Lib\u00e9rer la structure AVPacket */\n    av_free_packet(packet);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "operating-system", "system-calls"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 2, "creation_date": 1475052653, "post_id": 39742407, "comment_id": 66781840, "body": "There is only one <code>read</code> in C, the other is the shell command <code>read</code>."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1475052773, "post_id": 39742407, "comment_id": 66781930, "body": "<a href=\"https://linux.die.net/man/1/read\" rel=\"nofollow noreferrer\"><code>read</code>(1)</a> is most likely referring to the <b>bash builtins</b> command,  the other <a href=\"https://linux.die.net/man/2/read\" rel=\"nofollow noreferrer\"><code>read</code>(2)</a> is the C function."}], "owner": {"reputation": 1, "user_id": 6667140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0694a36e0330810f7d3c745a328d8eb?s=128&d=identicon&r=PG&f=1", "display_name": "zalamon", "link": "https://stackoverflow.com/users/6667140/zalamon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "closed_date": 1475052659, "answer_count": 0, "score": 0, "last_activity_date": 1475052564, "creation_date": 1475052564, "question_id": 39742407, "link": "https://stackoverflow.com/questions/39742407/different-between-read2-and-read1", "closed_reason": "Duplicate", "title": "Different between read(2) and read(1)?", "body": "<p>I am newbie for about system calls. In sample code always used <code>int x=read(...)</code>\nBut man page shows different read functions. What is the difference between them? And how to use read(1) instead of read(2)?</p>\n"}, {"tags": ["c", "multithreading", "semaphore"], "comments": [{"owner": {"reputation": 5428, "user_id": 29061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2OmsL.png?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/29061/jackson"}, "edited": false, "score": 0, "creation_date": 1475053594, "post_id": 39742229, "comment_id": 66782482, "body": "It&#39;s not clear to me as to what problem you are encountering - it is not sync - isn&#39;t very informative.  Also you really should provide a minimum working code example, trying to work out what is wrong from just the pseudo code isn&#39;t really possible in most cases.  Also creating working code that re-creates the problem is often the fastest way to actually solve the problem yourself!"}, {"owner": {"reputation": 347, "user_id": 5207376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/929972057068521/picture?type=large", "display_name": "Xu Chen", "link": "https://stackoverflow.com/users/5207376/xu-chen"}, "reply_to_user": {"reputation": 5428, "user_id": 29061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2OmsL.png?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/29061/jackson"}, "edited": false, "score": 0, "creation_date": 1475054012, "post_id": 39742229, "comment_id": 66782775, "body": "@Jackson thanks for ur feedbacks. in fact, i would say the working code snippets is 90% similar to the pseudo code. And without including all the set-up, it is not possible to have some working codes. Thats why i did not just copy paste my codes.   Elaborated more on the problem."}, {"owner": {"reputation": 5428, "user_id": 29061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2OmsL.png?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/29061/jackson"}, "edited": false, "score": 0, "creation_date": 1475054437, "post_id": 39742229, "comment_id": 66783103, "body": "Without a working code example we can&#39;t see if your handling errors correctly, creating the semaphore correctly or doing something else that is causing you a problem.  Your unlikely to get a sensible answer and your question will end up closed.  If you haven&#39;t already done so read the help sections on asking questions and creating minimal working examples."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1475054500, "post_id": 39742229, "comment_id": 66783145, "body": "The problem with pseudo code is that is only shows the expected processing, which seems correct here. So the problem should hide in unshowed details, like is <code>array</code> volatile, or how is the semaphore initialized?"}, {"owner": {"reputation": 5428, "user_id": 29061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2OmsL.png?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/29061/jackson"}, "edited": false, "score": 0, "creation_date": 1475054787, "post_id": 39742229, "comment_id": 66783333, "body": "I&#39;d also suggest looking at <a href=\"http://stackoverflow.com/questions/16400820/c-how-to-use-posix-semaphores-on-forked-processes\" title=\"c how to use posix semaphores on forked processes\">stackoverflow.com/questions/16400820/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 6782742, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p71fgirQoLo/AAAAAAAAAAI/AAAAAAAADHY/xiQNRdyfJw8/photo.jpg?sz=128", "display_name": "Manali Bhadsalkar", "link": "https://stackoverflow.com/users/6782742/manali-bhadsalkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1475056210, "creation_date": 1475056210, "answer_id": 39743881, "question_id": 39742229, "link": "https://stackoverflow.com/questions/39742229/synchronization-between-processes-with-for-loops-using-semaphores/39743881#39743881", "title": "Synchronization between processes with for loops using semaphores", "body": "<p>In psuedo code for problem case, the parent thread requires semaphore as soon as it is released by itself. Now since, the semaphore is available, parent will go on executing. When its time slice expires, the kernel may switch to child process, but it is waiting for semaphore. The semaphore is acquired by parent process. So again parent will continue to execute.</p>\n\n<p>In this scenario, parent executed twice and child did not execute. </p>\n\n<p>This might have resulted in out of sync execution. </p>\n"}, {"comments": [{"owner": {"reputation": 347, "user_id": 5207376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/929972057068521/picture?type=large", "display_name": "Xu Chen", "link": "https://stackoverflow.com/users/5207376/xu-chen"}, "edited": false, "score": 0, "creation_date": 1475109933, "post_id": 39751525, "comment_id": 66815275, "body": "The semaphore is indeed created in the shared memory inside the function newSemaphore function. I indicated that in the comment. Also, if a semaphore is not init properly. The previous greedy version should not be working as well."}, {"owner": {"reputation": 5428, "user_id": 29061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2OmsL.png?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/29061/jackson"}, "reply_to_user": {"reputation": 347, "user_id": 5207376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/929972057068521/picture?type=large", "display_name": "Xu Chen", "link": "https://stackoverflow.com/users/5207376/xu-chen"}, "edited": false, "score": 0, "creation_date": 1475137760, "post_id": 39751525, "comment_id": 66825093, "body": "In that case what is being returned from the calls to sem_wait() and sem_post()?  If the calls are failing in the child you aren&#39;t detecting this and the program will proceed as if it has the lock when it does not.  That would be the next thing to check."}, {"owner": {"reputation": 347, "user_id": 5207376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/929972057068521/picture?type=large", "display_name": "Xu Chen", "link": "https://stackoverflow.com/users/5207376/xu-chen"}, "edited": false, "score": 0, "creation_date": 1475162381, "post_id": 39751525, "comment_id": 66842642, "body": "I found out the problem. sem_init, which was used originally, is not working on OS X properly. So I changed to sem_open, and problem solved. Thank you for pointing out the error message checking!"}], "tags": [], "owner": {"reputation": 5428, "user_id": 29061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2OmsL.png?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/29061/jackson"}, "is_accepted": true, "score": 0, "last_activity_date": 1475075867, "creation_date": 1475075867, "answer_id": 39751525, "question_id": 39742229, "link": "https://stackoverflow.com/questions/39742229/synchronization-between-processes-with-for-loops-using-semaphores/39751525#39751525", "title": "Synchronization between processes with for loops using semaphores", "body": "<p>Looking at your actual code I think the problem is with how you are creating your semaphore. If you read the man page on sem_init:</p>\n\n<blockquote>\n  <p>If pshared is nonzero, then the semaphore is shared between\n   processes, <strong>and should be located in a region of shared memory</strong> (see\n   shm_open(3), mmap(2), and shmget(2)).  (Since a child created by\n   fork(2) inherits its parent's memory mappings, it can also access the\n   semaphore.)  Any process that can access the shared memory region can\n   operate on the semaphore using sem_post(3), sem_wait(3), and so on.</p>\n</blockquote>\n\n<p>The key here is the text in bold - your semaphore isn't in shared memory so it's not really shared between the two processes hence the contention you are seeing.</p>\n"}], "owner": {"reputation": 347, "user_id": 5207376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/929972057068521/picture?type=large", "display_name": "Xu Chen", "link": "https://stackoverflow.com/users/5207376/xu-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 39751525, "answer_count": 2, "score": 0, "last_activity_date": 1475162478, "creation_date": 1475052111, "last_edit_date": 1592644375, "question_id": 39742229, "link": "https://stackoverflow.com/questions/39742229/synchronization-between-processes-with-for-loops-using-semaphores", "title": "Synchronization between processes with for loops using semaphores", "body": "<h2>Context:</h2>\n<ul>\n<li><p>I am trying to have two processes writing to the same array in the shared memory space.</p>\n</li>\n<li><p>Each process will write half of the array with a for loop.</p>\n</li>\n<li><p>The first element of the array will always store the index of the next element to be written.</p>\n</li>\n<li><p>IPC is done through a semaphore in the shared memory.</p>\n</li>\n</ul>\n<h2>Preconditions:</h2>\n<ol>\n<li>Both the array and semaphore are properly set up in the shared memory.</li>\n<li>The programme works fine if I wait sem_wait and sem_post outside of the for loop, meaning make the whole process atomic. (This is also the reason why I believe the semaphore and array has been set up properly)</li>\n</ol>\n<h2>Problem</h2>\n<p>However, when I try to reduce the critical region by putting sem_wait and sem_post into the for loop. It is not sync as there are part of the array which are not written. But the two processes finished their loops where the total loop counts should be equal to the array length.</p>\n<p>Many thanks to suggestions why this happens???</p>\n<hr />\n<p><strong>UPDATE</strong></p>\n<p>On OS X, sem_init() is not working as expected. Used sem_open() to solve the problem.\nReference: <a href=\"http://lists.apple.com/archives/darwin-dev//2008/Oct/msg00044.html\" rel=\"nofollow noreferrer\">http://lists.apple.com/archives/darwin-dev//2008/Oct/msg00044.html</a></p>\n"}, {"tags": ["c", "string", "struct", "char", "stack"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1475052078, "post_id": 39742157, "comment_id": 66781454, "body": "<code>stack st = (stack)(malloc(sizeof(stack)));</code> --&gt; <code>stack st = malloc(sizeof(*st));</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1475052291, "post_id": 39742157, "comment_id": 66781618, "body": "<code>stacklist[NumberOfStacks]-&gt;name</code> :  <code>stacklist[NumberOfStacks]</code> maybe uninitialize. Because it increments to this before (<code>NumberOfStacks++;</code>)"}, {"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475052313, "post_id": 39742157, "comment_id": 66781630, "body": "Sorry, I was wrong. It is still not working, same segmentation fault. NumberOfStacks is initialized (0). I changed the malloc and it is still faulting."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1475052494, "post_id": 39742157, "comment_id": 66781735, "body": "<code>void *</code> does not need to cast in C."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 1, "creation_date": 1475053525, "post_id": 39742157, "comment_id": 66782429, "body": "I&#39;m guessing that you&#39;ve defined <code>stackname</code> in <code>main</code> as <code>char stackname[50]</code>. In that case <code>scanf(&quot;%s&quot;, &amp;stackname);</code> means that you&#39;re passing a <b>pointer to array of char</b>, not a <b>pointer to char</b>. Just pass <code>stackname</code> as is: <code>scanf(&quot;%s&quot;, stackname);</code>. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">The <b>array of char</b> expression is automatically converted to <b>pointer to char</b> expression</a> that points to the 1st element. You&#39;re also allowing the buffer to overrun in this case."}, {"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "edited": false, "score": 0, "creation_date": 1475055451, "post_id": 39742157, "comment_id": 66783816, "body": "I changed <code>&amp;stackname</code> to just <code>stackname</code>. The error, of course, persists. What do you mean by buffer overrunning? Is the problem here that I am copying the string wrong or did not allocate memory for it?"}], "answers": [{"comments": [{"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "edited": false, "score": 0, "creation_date": 1475054593, "post_id": 39743066, "comment_id": 66783208, "body": "Thank you for the hints. My declarations are here:      <code>unsigned int exit = 0, NumberOfStacks = 0;</code>       <code>unsigned int MAXSTACKS = 50;</code>       <code>stack stacklist[MAXSTACKS];       for(j=0;j&lt;MAXSTACKS;j++) {       stacklist[j] = NULL;     }</code>  (I suck at formatting.)  Now that I look at it, my stacklist is an array of stack-types, which are pointers to stacks. Is that a wise thing to do?"}, {"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "edited": false, "score": 0, "creation_date": 1475055146, "post_id": 39743066, "comment_id": 66783610, "body": "<i>If you want to copy a string, you must allocate a buffer of the size of the string (with malloc) and use strcpy.</i>  If that was my error, wouldn&#39;t I get a segfault when creating a new stack, since the memory for the string was not allocated? Does     <code>st-&gt;name = stackname</code> not work, do I have to use strcpy in this case?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "edited": false, "score": 1, "creation_date": 1475056364, "post_id": 39743066, "comment_id": 66784527, "body": "@mneumann Since you need to both allocate memory and copy the data, <code>st-&gt;name=strdup(stackname)</code> would be a good choice."}, {"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1475056918, "post_id": 39743066, "comment_id": 66785017, "body": "@KlasLindb&#228;ck thank you. I still get the same segfault, though."}, {"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "edited": false, "score": 1, "creation_date": 1475063438, "post_id": 39743066, "comment_id": 66789528, "body": "@Pouet_forever Wow, I just found the error and feel stupid. Since I incremented, printf received NumberOfStacks + 1... Thanks for the help!"}], "tags": [], "owner": {"reputation": 101, "user_id": 6882602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UGDix.png?s=128&g=1", "display_name": "Pouet_forever", "link": "https://stackoverflow.com/users/6882602/pouet-forever"}, "is_accepted": false, "score": 0, "last_activity_date": 1475054320, "creation_date": 1475054320, "answer_id": 39743066, "question_id": 39742157, "link": "https://stackoverflow.com/questions/39742157/segmentation-fault-when-calling-member-of-a-struct/39743066#39743066", "title": "Segmentation Fault when calling member of a struct", "body": "<p>For the warning, scanf is waiting for a type 'pointer to char'. Your variable 'stackname' is declared as 'char stackname[50]' (I think, you haven't posted the declaration).\nUse &amp;stackname means you want to access the address of the array. Use of stackname or &amp;stackname is almost the same because in the first case, the array will be converted to a pointer to the first case of the array and in the second case, it will be the address of the array wich is the first case of the array.</p>\n\n<p>If you want to copy a string, you must allocate a buffer of the size of the string (with malloc) and use strcpy.</p>\n\n<p>For the segfault, show us the declaration of stacklist and NumberOfStacks. The cause may be the value of NumberOfStacks is greater than the size of the array.</p>\n"}, {"comments": [{"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "edited": false, "score": 0, "creation_date": 1475064066, "post_id": 39746602, "comment_id": 66789985, "body": "Thanks a lot! I already incorporated all the changes you proposed, and it works now. The problem was my incrementation, where you changed the position of it."}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 1, "last_activity_date": 1475063326, "creation_date": 1475063326, "answer_id": 39746602, "question_id": 39742157, "link": "https://stackoverflow.com/questions/39742157/segmentation-fault-when-calling-member-of-a-struct/39746602#39746602", "title": "Segmentation Fault when calling member of a struct", "body": "<p>There are a couple of bugs in your code. Most have been addressed in the comments. I have made the corrections and it seems to work without segfault.\nThe modifications are indicated by comments in the code.</p>\n\n<p>This is the code I ended up with:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n// Prototype for malloc\n#include &lt;stdlib.h&gt;\n// Prototype for strdup\n#include &lt;string.h&gt;\n\ntypedef void *link; /* Added to make it compile - you may have a different definition in your code */\n\nstruct stack_t {\n    /* Stack-Datentyp */\n    /* Stacks have a head-node, a length, and a name.\n     * Stacks are filled with links (nodes) that are defined below. \n     * These links have\n     * a generic data pointer and a pointer to the next link */\n    link head;\n    unsigned int length;\n    char *name;                     //stack name\n};\n\ntypedef struct stack_t *stack;\n\nstack stack_new(char *stackname) {\n    /* creates a new, empty stack */\n    stack st = malloc(sizeof(*st));    // changed to use the variable name\n    if (st == NULL) {\n        fprintf(stderr, \"Error: Memory for Stack could not be allocated!\\n\");\n        return NULL;\n    }\n    st-&gt;head = NULL;\n    printf(\"head works.\\n\");\n    st-&gt;length = 0;\n    printf(\"length works.\\n\");\n    st-&gt;name = strdup(stackname);  // Changed: Duplicate the name so it won't get overwritten when creating the next stack\n    printf(\"stackname works.\\n\");\n    return st;\n}\n\n\nint main(void)\n{\n    char stackname[50];       // Added declaration for stackname.\n    stack stacklist[50];      // Added declaration. Can handle up to 50 stacks.\n    int NumberOfStacks = 0;\n\n    printf(\"Please enter stackname:\\n\");\n    scanf(\"%s\", stackname);              // Changed. Removed the \"&amp;\" since stackname is a char*.\n    printf(\"Debug: Input works.\\n\");\n    stacklist[NumberOfStacks] = stack_new(stackname);\n    printf(\"stack created works-\\n\");\n    // All data is at index 0, so cannot use increased value of NumberOfStacks to get get the data. Also changed the text to \"has index\" since a 0 will be printed for stacknumber.\n    printf(\"A new stack with the name '%s' was created!\\nIt has index %d in stack list.\\n\", stacklist[NumberOfStacks]-&gt;name, NumberOfStacks);\n    NumberOfStacks++;    // Moved this line down.\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 39746602, "answer_count": 2, "score": -1, "last_activity_date": 1475063780, "creation_date": 1475051897, "last_edit_date": 1475063780, "question_id": 39742157, "link": "https://stackoverflow.com/questions/39742157/segmentation-fault-when-calling-member-of-a-struct", "title": "Segmentation Fault when calling member of a struct", "body": "<p>sorry if this has been asked a million times before, but I think I have a problem understanding how strings (char arrays) work in C.</p>\n\n<p>In my program, I have a \"stack\" struct, which looks like this (in stack.h):</p>\n\n<pre><code>struct stack_t {\n/* Stack-Datentyp */\n/* Stacks have a head-node, a length, and a name.\nStacks are filled with links (nodes) that are defined below. These links have\na generic data pointer and a pointer to the next link */\nlink head;                      \nunsigned int length;            \nchar *name;                     //stack name\n};\n\ntypedef struct stack_t *stack;\n</code></pre>\n\n<p>in my main.c, I call a function called \"stack_new\" which seems to work properly, since all the printf-calls work:</p>\n\n<pre><code>stack stack_new(char *stackname) {\n  /* creates a new, empty stack */\nstack st = (stack)(malloc(sizeof(stack)));\nif (st == NULL) {\nfprintf(stderr, \"Error: Memory for Stack could not be allocated!\\n\");\nreturn NULL;\n}\nst-&gt;head = NULL;\nprintf(\"head works.\\n\");\nst-&gt;length = 0;\nprintf(\"length works.\\n\");\nst-&gt;name = stackname;\nprintf(\"stackname works.\\n\");\nreturn st;\n}\n</code></pre>\n\n<p>Now, when I call this function in main.c, I get a seg fault. Here is the call:</p>\n\n<pre><code>if (strcmp(input,\"newstack\") == 0) {\n    printf(\"Please enter stackname:\\n\");\n    scanf(\"%s\", &amp;stackname);\n    printf(\"Debug: Input works.\\n\");\n    stacklist[NumberOfStacks] = stack_new(stackname);\n    printf(\"stack created works-\\n\");\n    NumberOfStacks++;\n    printf(\"A new stack with the name '%s' was created!\\nIt is number %d in stack list.\", stacklist[NumberOfStacks]-&gt;name, NumberOfStacks);\n    continue;\n}\n</code></pre>\n\n<p>The seg fault happens when I try to print the member name of the struct stacklist[NumberOfStacks] points to. What am I doing wrong here?</p>\n\n<p>I also get a bunch of warnings that tell me about how my scanf for stackname expects a different type:</p>\n\n<blockquote>\n  <p>warning: format \u2018%s\u2019 expects argument of type \u2018char <em>\u2019, but argument 2 has type \u2018char (</em>)[50]\u2019 [-Wformat=]\n       scanf(\"%s\", &amp;stackname);</p>\n</blockquote>\n\n<p>Other warnings I get tell me that I am not typecasting from my void-pointer I use for data storage in the stack nodes, but I don't think that this is relevant to my problem here.</p>\n\n<p>Thank you for your help!</p>\n\n<p>Edit:\nThe problem was that I incremented NumberOfStacks before using it as index for printing the member of a struct saved in the array.</p>\n\n<pre><code>NumberOfStacks++;\n    printf(\"A new stack with the name '%s' was created!\\nIt is      number %d in stack list.\", stacklist[NumberOfStacks]-&gt;name, NumberOfStacks);\n</code></pre>\n\n<p>This part of the program works fine now, thanks!</p>\n"}, {"tags": ["c", "arrays", "syntax"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1475052102, "post_id": 39742123, "comment_id": 66781479, "body": "You also need to pass the length of the array. You cannot compute it in the function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475052222, "post_id": 39742123, "comment_id": 66781568, "body": "The function argument <code>float *arr[]</code> is an <i>array of pointers</i>. I suggest either <code>float arr[]</code> or <code>float *arr)</code>. In any case, you need to tell the function how many elements the array has."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1475052361, "post_id": 39742123, "comment_id": 66781654, "body": "You should not compare floating point values for equality."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475052425, "post_id": 39742123, "comment_id": 66781690, "body": "Aside: checking floating point values for equality is not good, please see <a href=\"http://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475052487, "post_id": 39742123, "comment_id": 66781731, "body": "Well, my intention is to verify the user&#39;s input. I want to check if he put a &quot;legit&quot; coin in the machine (1 dollar coin for example). Is there a more suitable approach than what I am doing?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475052560, "post_id": 39742123, "comment_id": 66781787, "body": "It is better to work in integer cents."}, {"owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475052670, "post_id": 39742123, "comment_id": 66781851, "body": "I could convert the cents into dollars easily but what do I do about the output? For example if the integer has 820 cents how do I format it properly aka: 8.20$?"}, {"owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "edited": false, "score": 0, "creation_date": 1475052712, "post_id": 39742123, "comment_id": 66781881, "body": "new post---------"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1475053540, "post_id": 39742123, "comment_id": 66782442, "body": "If you want to print cent as dollars take a look at <a href=\"http://ideone.com/NeFYtc\" rel=\"nofollow noreferrer\">ideone.com/NeFYtc</a>"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1475059137, "post_id": 39744782, "comment_id": 66786596, "body": "&quot;<i>the second argument is a pointer(because of *) to an array(because of[])</i>&quot; this is not quiet right, In the context of defining function parameters a <code>float a[]</code> is equivalent to <code>float *a</code> and <code>float *a[]</code> is equivalent to <code>float**a</code>. None of those <code>a</code>s is a pointer to an array of float. The first is a pointer to <code>float</code> the second a pointer to pointer to <code>float</code>. A pointer to an array of <code>float</code> would be defined like <code>float (*a)[42]</code>. <code>a</code> points to a <code>float[42]</code>. The explicit mentioning of the size is mandatory."}, {"owner": {"reputation": 56, "user_id": 4695640, "user_type": "registered", "profile_image": "https://graph.facebook.com/940038436036231/picture?type=large", "display_name": "Dimitroff", "link": "https://stackoverflow.com/users/4695640/dimitroff"}, "edited": false, "score": 0, "creation_date": 1475062020, "post_id": 39744782, "comment_id": 66788611, "body": "Huh I knew that passing an array promotes it to a pointer, but wasn&#39;t aware pointers to arrays were promoted to double pointers."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1475142179, "post_id": 39744782, "comment_id": 66828167, "body": "Pointers of arrays are not promoted to double pointers. Arrays of Pointers are promoted to double pointers. So <code>float (*a)[42]</code> will not be promoted to <code>float **a</code>, but <code>float *a[]</code> will."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1576462567, "post_id": 39744782, "comment_id": 104895520, "body": "<code>sizeof(arr)</code> when <code>arr</code> is an array and an argument to the function will give the size of the pointer, not the size of the array."}], "tags": [], "owner": {"reputation": 56, "user_id": 4695640, "user_type": "registered", "profile_image": "https://graph.facebook.com/940038436036231/picture?type=large", "display_name": "Dimitroff", "link": "https://stackoverflow.com/users/4695640/dimitroff"}, "is_accepted": true, "score": -2, "last_activity_date": 1475058264, "creation_date": 1475058264, "answer_id": 39744782, "question_id": 39742123, "link": "https://stackoverflow.com/questions/39742123/c-if-value-in-array/39744782#39744782", "title": "C - If value in array", "body": "<pre><code>float arr[] = ...;\n</code></pre>\n\n<p>declares an array(because of []) of floats(because of the float keyword) that is called arr. Similarly in a function declaration:</p>\n\n<pre><code>int valueinarray(float val, float *arr[]);\n</code></pre>\n\n<p>means that the second argument is a pointer(because of *) to an array(because of[]) which isn't what you need at all. You need to accept just an array:</p>\n\n<pre><code>int valueinarray(float val, float arr[]);\n</code></pre>\n\n<p>folowing this logic your code would look like this:</p>\n\n<pre><code>int valueinarray(float val, float arr[])\n{\n    int i;\n    for(i = 0; i &lt; sizeof(arr) / sizeof(arr[0]); i++)\n    {\n        if(arr[i] == val)\n            return 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Notice a number of changes:</p>\n\n<ol>\n<li><p>The function parameter arr is now an array.</p></li>\n<li><p>The expression</p>\n\n<p>sizeof(arr) / sizeof(arr[0])\nfirst takes the size of arr the array in bytes. Then divides it by the size in bytes of the first element in it. And now we are left with the number of elements. If it were a char array, then this is not needed is 1 char takes up 1 byte. For any other type it is necessary. As a side note you could've divided by sizeof(float), but this makes it harder for you if you change the type and is a worse practice than sizeof(arr[0]).</p></li>\n</ol>\n\n<p>If you didn't divide you could have an array of 10 floats, but you could try to access 40. So you'd be meddling with 120 bytes of the memory right after your array that aren't yours.</p>\n\n<p>Also the asterisk * dereferences outside of declarations. If you have:</p>\n\n<pre><code>int a[5];\nint x = 5;\nint *pointerToInt = &amp;x;\n</code></pre>\n\n<p>then x is a label for some memory (variable) that stores the value 5. &amp;x is a pointer to the memory that stores the label. The opposite of &amp; is *. Whlie pointerToInt equals &amp;x, *pointerToInt equals x. Also *a equals a[0], but isn't literally the same, *(a+1) equals a[1].</p>\n"}], "owner": {"reputation": 135, "user_id": 6826249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/163a506ee66bf0563f79f86734cb8513?s=128&d=identicon&r=PG&f=1", "display_name": "gusgxrha", "link": "https://stackoverflow.com/users/6826249/gusgxrha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43814, "favorite_count": 1, "accepted_answer_id": 39744782, "answer_count": 1, "score": 6, "last_activity_date": 1475059409, "creation_date": 1475051791, "last_edit_date": 1475051926, "question_id": 39742123, "link": "https://stackoverflow.com/questions/39742123/c-if-value-in-array", "title": "C - If value in array", "body": "<p>I am new to C and am currently studying arrays. I would like to check if a certain value is in an array but I am running in some issues (not only syntax-wise but also from understanding-wise).</p>\n\n<p>My goal is to have a function which I can call, give it two arguments - the value to search for and the array to search in - and get a 0 or 1 based on whether it was found or not back.</p>\n\n<p>My approach is the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint valueinarray(float val, float *arr[]);\n\nint main()\n{\n    float arr[] = {5, 4.5, 4, 3.5, 3, 2.5,};\n    int test = valueinarray(4.5, *arr[]);\n    printf(\"%d\", test);\n\n    return 0;\n}\n\nint valueinarray(float val, float *arr[]){\n    int i;\n    for(i = 0; i &lt; sizeof(*arr[]); i++){\n        if(*arr[i] == val) return 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I have two questions now especially regarding the syntax:</p>\n\n<ol>\n<li><p>If I create a function with a pointer as one of its' parameters, do I have to refer to it using \"*arr[]\" inside the function the whole time? Or is \"arr[]\" or even \"arr\" enough?</p></li>\n<li><p>Do I understand it correctly that I am unable to pass a whole array to a function so I use a pointer instead?</p></li>\n</ol>\n\n<p>Moreover, my approach is wrong and I do not see why. Iterating over the array seems to work just fine and even checking if a certain value is in it works as well, the issue seems to be in the way I call the function. I read about double pointers, is this a scenario where they're needed? If not, what are they needed for?</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 83, "user_id": 6533749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f31c9fecd0446f3ebcc854dcf6c0943?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Gasol", "link": "https://stackoverflow.com/users/6533749/paulo-gasol"}, "reply_to_user": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1475051934, "post_id": 39742103, "comment_id": 66781360, "body": "@M.SChaudhari Thanks. I read it before ask but still confused! any help?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1475052027, "post_id": 39742103, "comment_id": 66781423, "body": "Isn&#39;t <a href=\"http://stackoverflow.com/a/14088911/3684343\">stackoverflow.com/a/14088911/3684343</a> exactly the answer you want? Also we cannot say what you did wrong, if you do not show us your code."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1475053862, "creation_date": 1475053862, "answer_id": 39742876, "question_id": 39742103, "link": "https://stackoverflow.com/questions/39742103/c-function-return-2d-array/39742876#39742876", "title": "C - Function return 2D array", "body": "<p>Beware, returning arrays in C is a beginner's trap, because it is highly dependant on the storage duration:</p>\n\n<ul>\n<li>static or global: no problem, but content will be overwritten by next call</li>\n<li>automatic : <strong>never do that!</strong> What is actually returned is a <em>dangling pointer</em>, because the array's life ends at the end of the return statement</li>\n<li>dynamic (malloc-ed): fine, but caller must free it later.</li>\n</ul>\n\n<p>An more idiomatic way is that the caller passes an array that it owns, along with its size(s).</p>\n"}, {"tags": [], "owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "is_accepted": false, "score": 0, "last_activity_date": 1475060083, "last_edit_date": 1475060083, "creation_date": 1475056579, "answer_id": 39744078, "question_id": 39742103, "link": "https://stackoverflow.com/questions/39742103/c-function-return-2d-array/39744078#39744078", "title": "C - Function return 2D array", "body": "<p>You can not return an array as a result of a function no matter whether it has one dimension or two. You can return a pointer to the first element of the array. Also, strictly speaking, there are no two dimensional arrays in C. What is closest to this, is an array containing another array as elements. I.e. a definition like:</p>\n\n<pre><code>int twoDimArray[2][3];\n</code></pre>\n\n<p>If dimensions of such array are determined dynamically you can not define it on file scope. You can define it locally withing some function only. Such an array will be a local variable, will be stored in system stack and will disappear when control leaves the function. Personally, I'd use such a pattern. I.e. a code like:</p>\n\n<pre><code>int main() {\n    int rows, cols;\n    ...\n    getDimensions(&amp;rows, &amp;cols);\n    // definition with dynamic dimensions in function scope is O.K.\n    int a[rows][cols];\n    init(rows, cols, a);\n    proceed(rows, cols, a);\n    ...\n}\n</code></pre>\n\n<p>where <code>init</code> function can be defined like:</p>\n\n<pre><code>void init(int rows, int cols, int a[rows][cols]) {\n    int i,j;\n    for(i=0; i&lt;rows; i++) {\n        for(j=0; j&lt;cols; j++) {\n            a[i][j] = i*100+j;\n        }\n    }\n}\n</code></pre>\n\n<p>If such a pattern can not be used (the array is too big and your system stack too small for example), I'd use:</p>\n\n<pre><code>int main() {\n    int rows, cols;\n    getDimensions(&amp;rows, &amp;cols);\n    int (*a)[cols] = malloc(sizeof(int [rows][cols]));\n    init(rows, cols, a);\n    proceed(rows, cols, a);\n    free(a);\n}\n</code></pre>\n\n<p>If you insist on functions returning such an array I'd use void pointers:</p>\n\n<pre><code>void *allocate2DintArray(int rows, int cols) {\n    return(malloc(sizeof(int [rows][cols])));\n}\n\nvoid *allocateAndInit(int rows, int cols) {\n    int i,j;\n    int (*a)[cols] = allocate2DintArray(rows, cols);\n    for(i=0; i&lt;rows; i++) {\n        for(j=0; j&lt;cols; j++) {\n            a[i][j] = i*100+j;\n        }\n    }\n    return(&amp;a[0][0]);\n}\n\nint main() {\n    int rows, cols;\n    ...\n    getDimensions(&amp;rows, &amp;cols);\n    int (*a)[cols] = allocateAndInit(rows, cols);\n    proceed(rows, cols, a);\n    ...\n    free(a);\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6533749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f31c9fecd0446f3ebcc854dcf6c0943?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Gasol", "link": "https://stackoverflow.com/users/6533749/paulo-gasol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1804, "favorite_count": 0, "closed_date": 1475066171, "answer_count": 2, "score": 2, "last_activity_date": 1475060083, "creation_date": 1475051694, "question_id": 39742103, "link": "https://stackoverflow.com/questions/39742103/c-function-return-2d-array", "closed_reason": "Duplicate", "title": "C - Function return 2D array", "body": "<p>Maybe my question is easy but I am newby in C. </p>\n\n<p>I create a function which read some data from a file and then pass them to a another function which parse them given number of rows and columns and create a 2D array. </p>\n\n<p>I want to return this array in order to perform some operantions in its rows. How can I return a 2D array in C</p>\n\n<p>Can someone give me an example or what may I did wrong?</p>\n\n<p>Regards</p>\n"}, {"tags": ["c", "static-libraries", "avr", "atmega", "atmel"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475051641, "post_id": 39742005, "comment_id": 66781144, "body": "You should post the compiler command."}, {"owner": {"reputation": 740, "user_id": 4627080, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/es6rF.png?s=128&g=1", "display_name": "hoboBob", "link": "https://stackoverflow.com/users/4627080/hobobob"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475051707, "post_id": 39742005, "comment_id": 66781197, "body": "I don&#39;t know what that is"}], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 4627080, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/es6rF.png?s=128&g=1", "display_name": "hoboBob", "link": "https://stackoverflow.com/users/4627080/hobobob"}, "edited": false, "score": 0, "creation_date": 1475052478, "post_id": 39742295, "comment_id": 66781727, "body": "Top man thanks, I didn&#39;t want to spend hours on the wrong track as seems to happen sometimes."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 1, "last_activity_date": 1475052267, "creation_date": 1475052267, "answer_id": 39742295, "question_id": 39742005, "link": "https://stackoverflow.com/questions/39742005/c-library-creation-for-atmel328/39742295#39742295", "title": "c library creation for ATMEL328", "body": "<p>You can't refer to an undeclared identifier, that makes it impossible for the compiler to figure out what you mean.</p>\n\n<p>You should probably add</p>\n\n<pre><code>#include &lt;avr/io.h&gt;\n</code></pre>\n\n<p>to your library's source code.</p>\n"}], "owner": {"reputation": 740, "user_id": 4627080, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/es6rF.png?s=128&g=1", "display_name": "hoboBob", "link": "https://stackoverflow.com/users/4627080/hobobob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39742295, "answer_count": 1, "score": 0, "last_activity_date": 1475052267, "creation_date": 1475051413, "question_id": 39742005, "link": "https://stackoverflow.com/questions/39742005/c-library-creation-for-atmel328", "title": "c library creation for ATMEL328", "body": "<p>I am trying to create a library in C for use in a ATMEL 328pu. I have made the source and header files in C but come unstuck when I try to compile the library. I think I need another AVR library containing the types:</p>\n\n<ul>\n<li>TWDR</li>\n<li>TWCR</li>\n</ul>\n\n<p>Which are the i2c registers in the ATMEGA328. A shortened version of the error message can be seen below followed by a portion of the .cpp file where the error message refers too.</p>\n\n<p>Error message:</p>\n\n<blockquote>\n  <p>Build: Debug in my_i2c (compiler: GNU GCC Compiler)\n  Code_blocks/my_i2c/my_i2c/my_i2c.cpp|39|error: use of undeclared identifier 'TWCR'|\n  Build failed: 19 error(s), 0 warning(s) (0 minute(s), 0 second(s))</p>\n</blockquote>\n\n<p>Extract from.cpp file:</p>\n\n<pre><code>#include \"my_i2c.h\"\n\n/////////////////////WRITE BIT////////////////////\nvoid my_i2c :: i2cWriteBit (uint8_t i2cAdd, uint8_t i2cReg, uint8_t i2cBit, bool i2cBool) {\nuint8_t writeBuff;\nwriteBuff = i2cRead(i2cAdd, i2cReg); //read uint8_t\ni2cBool == true ? writeBuff |= 1 &lt;&lt; i2cBit : writeBuff &amp;= ~(1 &lt;&lt; i2cBit);\ni2cWrite (i2cAdd, i2cReg, writeBuff);\n}\n\n\n/////////////////////WRITE uint8_t////////////////////\nvoid my_i2c :: i2cWrite (uint8_t i2cAdd, uint8_t i2cReg, uint8_t i2cData) {\n/////START CONDITION////\nTWCR = 0b10100100; //(TWINT)(TWSTA)(TWEN) - Set START condition\nwhile (!(TWCR &amp; 0b10000000)) { //Wait for TWI to set TWINT\n}\n</code></pre>\n\n<p>Do I need to define the what TWCR and TWDR are for the compiler to understand the functions? and how do I do this, is it like I was thinking by including another library?</p>\n"}, {"tags": ["c", "arduino", "particles", "photon"], "comments": [{"owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "edited": false, "score": 0, "creation_date": 1475051935, "post_id": 39742003, "comment_id": 66781363, "body": "noiseValue is a function. Thus <code>noiseValue &lt; 130.00</code> does not make sense"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475052107, "post_id": 39742003, "comment_id": 66781489, "body": "BTW what is <code>h</code>  here: <code>if (noiseValue &gt;= 130.00 &amp;&amp; h &lt; 145.00) </code> ? Shouldn&#39;t it be <code>noisevalue</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4243022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e540f8e88a06072d5aca3350a32160f?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lindberg S&#248;rensen", "link": "https://stackoverflow.com/users/4243022/jacob-lindberg-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1475053643, "post_id": 39742188, "comment_id": 66782518, "body": "Thank you so much! So what exactly did I do wrong? apart from comparing noiseValue to &quot;h&quot; which does not make sense. You process noiseValue as nv?"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1475052415, "last_edit_date": 1475052415, "creation_date": 1475051983, "answer_id": 39742188, "question_id": 39742003, "link": "https://stackoverflow.com/questions/39742003/invalid-operands-of-types-float-and-double-to-binary-operator-void-loop/39742188#39742188", "title": "invalid operands of types &#39;float()&#39; and &#39;double&#39; to binary &#39;operator&lt;&#39; void loop()", "body": "<p>You want this:</p>\n\n<pre><code>void loop() {\n  //Serial.println(noiseValue());\n  //delay(10000);\n  Particle.publish(\"Sound\", String(noiseValue()));\n  delay(5000);\n\n  float nv = noiseValue();\n\n  if (nv &lt; 130.00)\n    Particle.publish(\"noiseValue\", \"Green\", PUBLIC);\n\n  if (nv &gt;= 130.00 &amp;&amp; nv &lt; 145.00)                          //&lt;&lt;&lt; h replaced by nv !!\n     Particle.publish(\"noiseValue\", \"Yellow\", PUBLIC);\n\n  if (nv &gt;= 145.00)\n     Particle.publish(\"noiseValue\", \"Red\", PUBLIC);\n\n  delay(10000);\n}\n</code></pre>\n\n<p>You call <code>noisevalue</code> once here: <code>float nv = noisevalue();</code> and then you process <code>nv</code>.</p>\n\n<p>BTW <code>h</code> should probably be replaced by <code>nv</code>, see comment in the code.</p>\n\n<p>Be aware that following is most likeky wrong even if it compiles:</p>\n\n<pre><code> if (noiseValue() &lt; 130.00)\n    Particle.publish(\"noiseValue\", \"Green\", PUBLIC);\n\n  if (noiseValue() &gt;= 130.00 &amp;&amp; noiseValue() &lt; 145.00)                          \n     Particle.publish(\"noiseValue\", \"Yellow\", PUBLIC);\n\n  if (noiseValue() &gt;= 145.00)\n     Particle.publish(\"noiseValue\", \"Red\", PUBLIC);\n</code></pre>\n\n<p>this calls <code>noisevalue</code> multiple times and the <code>noisevalue</code> function looks expensive. So it's better to call it only <em>once</em> as suggested in the first part of this answer.</p>\n"}], "owner": {"reputation": 99, "user_id": 4243022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e540f8e88a06072d5aca3350a32160f?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lindberg S&#248;rensen", "link": "https://stackoverflow.com/users/4243022/jacob-lindberg-s%c3%b8rensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 39742188, "answer_count": 1, "score": 0, "last_activity_date": 1475052415, "creation_date": 1475051411, "last_edit_date": 1475051781, "question_id": 39742003, "link": "https://stackoverflow.com/questions/39742003/invalid-operands-of-types-float-and-double-to-binary-operator-void-loop", "title": "invalid operands of types &#39;float()&#39; and &#39;double&#39; to binary &#39;operator&lt;&#39; void loop()", "body": "<p>I am just starting to learn how to program using a particle Photon.\nI am trying to get my Photon to measure sound levels using an Adafruit MAX 9814.</p>\n\n<p>I can get it to output a voltage, but when I try to categorize noise levels, I get this error:</p>\n\n<blockquote>\n  <p>invalid operands of types 'float()' and 'double' to binary 'operator&lt;' void loop() {</p>\n</blockquote>\n\n<pre><code>#include \"math.h\"\n\nvoid setup() {\npinMode(A0, INPUT);\n// Serial.begin(9600);\n//Serial.println(\"setup\");\n}\n\nvoid loop() {\n//Serial.println(noiseValue());\n//delay(10000);\nParticle.publish(\"Sound\", String(noiseValue()));\ndelay(5000);\n\nif (noiseValue &lt; 130.00) Particle.publish(\"noiseValue\", \"Green\", PUBLIC);\nif (noiseValue &gt;= 130.00 &amp;&amp; h &lt; 145.00) Particle.publish(\"noiseValue\",      \"Yellow\", PUBLIC);\nif (noiseValue &gt;= 145.00) Particle.publish(\"noiseValue\", \"Red\", PUBLIC);\ndelay(10000);\n}\n\nfloat noiseValue() {\nint sampleWindow = 50; // Sample window width. 50ms = 20Hz\nint signalMax = 0;\nint signalMin = 4095;\nunsigned long startMillis = millis();\nunsigned int sample;\nunsigned int peakToPeak;\n\nwhile (millis() - startMillis &lt; sampleWindow) {\nsample = analogRead(A0);\nif (sample &lt; 4095) {\n  if (sample &gt; signalMax) {\n    signalMax = sample;\n  } else if (sample &lt; signalMin) {\n    signalMin = sample;\n  }\n}\n}\n\npeakToPeak = signalMax - signalMin;\n\nreturn 20 * log(peakToPeak);\n}\n</code></pre>\n"}, {"tags": ["c", "oracle", "clob"], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4841090, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ab5d5796dea082c45e93646426cb8385?s=128&d=identicon&r=PG&f=1", "display_name": "J&#246;rg Mohren", "link": "https://stackoverflow.com/users/4841090/j%c3%b6rg-mohren"}, "is_accepted": false, "score": 0, "last_activity_date": 1475069202, "creation_date": 1475069202, "answer_id": 39748922, "question_id": 39741891, "link": "https://stackoverflow.com/questions/39741891/selecting-clob-in-oracle-using-c-and-embedded-sql/39748922#39748922", "title": "Selecting CLOB in Oracle using C and embedded SQL", "body": "<p>I finally found the problem myself. All the other PRO-C modules are compiled using the option CHAR_SET=STRING. This does not work with LOB. When removing the option for this module, I could compile it, and it works fine.</p>\n\n<p>Best regards\nJ\u00f6rg</p>\n"}], "owner": {"reputation": 87, "user_id": 4841090, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ab5d5796dea082c45e93646426cb8385?s=128&d=identicon&r=PG&f=1", "display_name": "J&#246;rg Mohren", "link": "https://stackoverflow.com/users/4841090/j%c3%b6rg-mohren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 673, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495674130, "creation_date": 1475051040, "last_edit_date": 1475054042, "question_id": 39741891, "link": "https://stackoverflow.com/questions/39741891/selecting-clob-in-oracle-using-c-and-embedded-sql", "title": "Selecting CLOB in Oracle using C and embedded SQL", "body": "<p>Perhaps somebody here can help me; I've run out of ideas.</p>\n\n<p>I try to implement an select statement on a table containing a CLOB in Oracle. This is the definition of the table:</p>\n\n<pre><code>PQUE\n ID                    NOT NULL NUMBER(13)\n PGA_ID                NUMBER(13)\n WS_CODE               NUMBER(5)\n OPERATION             VARCHAR2(30)\n RF_NR                 NUMBER(13)\n STATUS                NUMBER(5)\n SENDER                NUMBER(5)\n EMPFAENGER            NUMBER(5)\n START_ZEIT            TIMESTAMP(6)\n DATEN                 CLOB\n</code></pre>\n\n<p>My SELECT-Statement looks this way:</p>\n\n<pre><code>void pap_pque_select(long        *sql_ptr,\n                     PQUE_RECORD *pque_ptr)\n{\n   OCIClobLocator *clob=NULL ;\n   long           bufsize=4294967295, start=1, i=0 ;\n   long           old_size, new_size=1 ;\n   char           buffer[2048] ;\n\n   EXEC SQL ALLOCATE :clob ;\n   EXEC SQL\n      SELECT   PQUE.ID,\n               PQUE.PGA_ID,\n               PQUE.WS_CODE,\n               NVL(PQUE.OPERATION, ' '),\n               PQUE.RF_NR,\n               PQUE.STATUS,\n               PQUE.SENDER,\n               PQUE.EMPFAENGER,\n               TO_CHAR(PQUE.START_ZEIT, 'YYYYMMDDHH24MISSFF2'),\n               NVL(PQUE.DATEN, EMPTY_CLOB())\n        INTO   :(pque_ptr-&gt;pque_id),\n               :(pque_ptr-&gt;pga_id),\n               :(pque_ptr-&gt;ws_code),\n               :(pque_ptr-&gt;operation),\n               :(pque_ptr-&gt;rf_nr),\n               :(pque_ptr-&gt;status),\n               :(pque_ptr-&gt;sender),\n               :(pque_ptr-&gt;empfaenger),\n               :(pque_ptr-&gt;start_zeit),\n               :clob\n        FROM   PQUE\n       WHERE   PQUE.ID = :(pque_ptr-&gt;pque_id) ;\n   *sql_ptr = sqlca.sqlcode ;\n\n   if (sqlca.sqlcode == 0)\n   {\n      ds_trim(pque_ptr-&gt;operation) ;\n      do\n      {\n         if (i++ == 0)\n            EXEC SQL LOB READ :bufsize FROM :clob AT :start INTO :buffer ;\n         else\n            EXEC SQL LOB READ :bufsize FROM :clob INTO :buffer ;\n         if (sqlca.sqlcode == 0 || sqlca.sqlcode == 1403)\n         {\n            old_size = new_size ;\n            new_size += bufsize ;\n            if (pque_ptr-&gt;daten == NULL)\n               pque_ptr-&gt;daten = calloc(new_size, sizeof(char)) ;\n            else\n               pque_ptr-&gt;daten = realloc(pque_ptr-&gt;daten,               \n                                         new_size*sizeof(char)) ;\n            memcpy(pque_ptr-&gt;daten+old_size-1, buffer, bufsize) ;\n            pque_ptr-&gt;daten[new_size-1] = '\\0' ;\n         }\n      }\n      while (sqlca.sqlcode == 0) ;\n   }\n   EXEC SQL FREE :clob ;\n\n   *sql_ptr = sqlca.sqlcode ;\n\n   return ;\n}\n</code></pre>\n\n<p>Using the Pro-C-Precompiler, I get the error:</p>\n\n<blockquote>\n  <p>Semantic error at line 59, column 67, file pap_pque_sel.pc:\n      EXEC SQL LOB READ :bufsize FROM :clob AT :start INTO :buffer ;\n      ..................................................................1\n      PCC-S-02428, Buffer type is incompatible with LOB type</p>\n</blockquote>\n\n<p>Anybody got an idea, why char[...] should be incompatible with CLOB? I sed the same construct with other CLOBs in my database, and it worked fine.</p>\n\n<p>Thank you in advance\nBest regards\nJ\u00f6rg</p>\n"}, {"tags": ["c++", "c", "visual-studio-2013", "elapsed"], "comments": [{"owner": {"reputation": 925, "user_id": 6478256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BNq9q.jpg?s=128&g=1", "display_name": "ilotXXI", "link": "https://stackoverflow.com/users/6478256/ilotxxi"}, "edited": false, "score": 0, "creation_date": 1475047905, "post_id": 39740619, "comment_id": 66778854, "body": "Just use debugger."}], "answers": [{"tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": false, "score": 2, "last_activity_date": 1475047918, "creation_date": 1475047918, "answer_id": 39740844, "question_id": 39740619, "link": "https://stackoverflow.com/questions/39740619/finding-the-elapsed-time/39740844#39740844", "title": "Finding the elapsed time", "body": "<p>The line <code>int substract(calculate N1, calculate N2);</code> inside your <code>main</code> function does not call the previously defined <code>subtract</code> method, but it actually declares another function with the same name.\nTo actually call the method write:</p>\n\n<pre><code>   int res = subtract(N1, N2);\n</code></pre>\n\n<p>Afterwards <code>res</code> should be 0 and the (global) variables <code>resulthr,resultmin,resultsec</code> should have the desired values.</p>\n\n<p>Btw: please read about global and local variables and passing parameters.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6875846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d7a2c0a1aef5a35e8c85162456eb37c?s=128&d=identicon&r=PG&f=1", "display_name": "Newbiehere", "link": "https://stackoverflow.com/users/6875846/newbiehere"}, "edited": false, "score": 0, "creation_date": 1475105663, "post_id": 39742027, "comment_id": 66814382, "body": "Thanks. also, I had a mistake on int substract function...                   resultsec = 60 + resultmin should have been resultmin = 60 + resultmin"}], "tags": [], "owner": {"reputation": 412, "user_id": 2301806, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/z1OTQ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/2301806/tushar"}, "is_accepted": true, "score": 0, "last_activity_date": 1475051448, "creation_date": 1475051448, "answer_id": 39742027, "question_id": 39740619, "link": "https://stackoverflow.com/questions/39740619/finding-the-elapsed-time/39742027#39742027", "title": "Finding the elapsed time", "body": "<p>call <strong>substract(N1, N2);</strong> instead of <strong>int substract(calculate N1, calculate N2);</strong> in the main function.</p>\n\n<p>You were declaring it, not calling it.</p>\n"}], "owner": {"reputation": 3, "user_id": 6875846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d7a2c0a1aef5a35e8c85162456eb37c?s=128&d=identicon&r=PG&f=1", "display_name": "Newbiehere", "link": "https://stackoverflow.com/users/6875846/newbiehere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 39742027, "answer_count": 2, "score": 0, "last_activity_date": 1475051448, "creation_date": 1475047275, "last_edit_date": 1475051070, "question_id": 39740619, "link": "https://stackoverflow.com/questions/39740619/finding-the-elapsed-time", "title": "Finding the elapsed time", "body": "<p>This is what I have so far. I am learning structure, and I had to use a structure for the assignment. I don't get what is wrong with my code. When I debug, I get 0 for hour, minute, seconds. Please look at my code.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct calculate\n{\n    int hours;\n    int minutes;\n    int seconds;\n};\n\nstruct calculate N1;\nstruct calculate N2;\nint resulthr, resultmin, resultsec;\n\nint substract(struct calculate N1, struct calculate N2)\n{\n    resultsec = N2.seconds - N1.seconds;\n    if (resultsec &lt; 0)\n    {\n        resultsec = 60 + resultsec;\n        --N2.minutes;\n    }\n\n    resultmin = N2.minutes - N1.minutes;\n    if (resultmin &lt; 0)\n    {\n        resultsec = 60 + resultmin;\n        --N2.hours;\n    }\n\n    resulthr = N2.hours - N1.hours;\n    if (resulthr &lt; 0)\n    {\n        resulthr = 24 + resultsec;\n    }\n    return 0;\n}\n\nint main(void)\n{\n    printf(\"Enter two times.(hh:mm:ss) \");\n    scanf(\"%i:%i:%i\", &amp;N1.hours, &amp;N1.minutes, &amp;N1.seconds);\n    scanf(\"%i:%i:%i\", &amp;N2.hours, &amp;N2.minutes, &amp;N2.seconds);\n\n    int substract(calculate N1, calculate N2);\n\n    printf(\"The elasped time is %i:%i:%i.\\n\", resulthr, resultmin, resultsec);\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/VlYVL.png\" rel=\"nofollow\">http://i.stack.imgur.com/VlYVL.png</a></p>\n"}, {"tags": ["c", "operating-system"], "comments": [{"owner": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1475045900, "post_id": 39740092, "comment_id": 66777636, "body": "I was with you until &quot;brackets&quot;..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 5, "creation_date": 1475046074, "post_id": 39740092, "comment_id": 66777744, "body": "They&#39;re man page <i>sections</i>. See: <a href=\"http://unix.stackexchange.com/questions/3586/what-do-the-numbers-in-a-man-page-mean\">What do the numbers in a man page mean?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1252, "user_id": 5057449, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e61f47a00cc4f5402872e1bdfb6e967d?s=128&d=identicon&r=PG&f=1", "display_name": "GPS", "link": "https://stackoverflow.com/users/5057449/gps"}, "is_accepted": false, "score": 3, "last_activity_date": 1475047166, "last_edit_date": 1475047166, "creation_date": 1475046203, "answer_id": 39740247, "question_id": 39740092, "link": "https://stackoverflow.com/questions/39740092/what-exactly-does-the-2-mean-when-someone-writes-read2-while-specifying-the/39740247#39740247", "title": "What exactly does the &#39;2&#39; mean when someone writes read(2) while specifying the system call?", "body": "<p>They are the man page section identifiers. you should try</p>\n\n<pre><code>man 2 read\n</code></pre>\n\n<p>or</p>\n\n<pre><code>man 1 open\n</code></pre>\n\n<p>to see specific versions of those identifiers.</p>\n"}, {"tags": [], "owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "is_accepted": true, "score": 7, "last_activity_date": 1475046213, "creation_date": 1475046213, "answer_id": 39740250, "question_id": 39740092, "link": "https://stackoverflow.com/questions/39740092/what-exactly-does-the-2-mean-when-someone-writes-read2-while-specifying-the/39740250#39740250", "title": "What exactly does the &#39;2&#39; mean when someone writes read(2) while specifying the system call?", "body": "<p>The bracket is used to specify the section of man pages. Man pages are organized into different sections and that section number specifies what type of \"thing\" it is. From <a href=\"https://en.wikipedia.org/wiki/Man_page\">Wikipedia</a>, a common organization of sections(on Research Unix, BSD, OS X and Linux) is like this:</p>\n\n<pre><code>1   General commands\n2   System calls\n3   Library functions, covering in particular the C standard library\n4   Special files (usually devices, those found in /dev) and drivers\n5   File formats and conventions\n6   Games and screensavers\n7   Miscellanea\n8   System administration commands and daemons\n</code></pre>\n\n<p>For example, by <code>read(2)</code> it meant it is talking about OS system call <code>read</code>.</p>\n"}], "owner": {"reputation": 874, "user_id": 4803814, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/92e1a4d76915c4efe25b4dbc2edc83d7?s=128&d=identicon&r=PG&f=1", "display_name": "Raunaq Kochar", "link": "https://stackoverflow.com/users/4803814/raunaq-kochar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "closed_date": 1475052535, "accepted_answer_id": 39740250, "answer_count": 2, "score": 2, "last_activity_date": 1475047675, "creation_date": 1475045818, "last_edit_date": 1475046126, "question_id": 39740092, "link": "https://stackoverflow.com/questions/39740092/what-exactly-does-the-2-mean-when-someone-writes-read2-while-specifying-the", "closed_reason": "Duplicate", "title": "What exactly does the &#39;2&#39; mean when someone writes read(2) while specifying the system call?", "body": "<p>What does someone mean when they say read(2), or open(1)? What do the numbers in the brackets actually mean?</p>\n\n<p>Edit:\nRephrased the title of the question.</p>\n"}, {"tags": ["c", "arrays", "multithreading", "segmentation-fault"], "comments": [{"owner": {"reputation": 5668, "user_id": 966376, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L6Wh4.jpg?s=128&g=1", "display_name": "GreenScape", "link": "https://stackoverflow.com/users/966376/greenscape"}, "edited": false, "score": 2, "creation_date": 1475045185, "post_id": 39739792, "comment_id": 66777206, "body": "Because <code>1024</code> bytes may be not enough for the stack so your program overwrites internal data of <code>malloc()</code> due to stack overflow. On the other hand when you use current stack as a buffer then your program still causes overflow but without visible effect, because main stack is usually big (~<code>4 MiB</code>) and overflow does not cause any harm."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1475045223, "post_id": 39739792, "comment_id": 66777228, "body": "Run this under <code>gdb</code> (or your favorite debugger) and <code>valgrind</code> and see what blew up. Its the only thing you&#39;ve not apparently done, and the first thing you probably should have."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1475046795, "post_id": 39739792, "comment_id": 66778173, "body": "Is the stack you&#39;re getting aligned? Doesn&#39;t &quot;been_here&quot; need to be volatile?"}, {"owner": {"reputation": 123, "user_id": 5290212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f23e6b5b55efb6345c37000751a5d5c1?s=128&d=identicon&r=PG&f=1", "display_name": "dr_ate", "link": "https://stackoverflow.com/users/5290212/dr-ate"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475076448, "post_id": 39739792, "comment_id": 66799568, "body": "@WhozCraig, yes, you&#39;re correct. Those should&#39;ve been done earlier. I tried to run it on <code>gdb</code>. Compiled with <code>gcc -g -Wall thread.c test.c</code>, ran <code>gdb .&#47;a.out</code>, typed <code>run</code> on the prompt and it worked. It simply worked printing <code>[Inferior 1 (process 6007) exited normally]</code>. When I ran outside <code>gdb</code>, I got a segmentation fault again. As for <code>valgrind</code>, I couldn&#39;t really get anything out of it. There were some invalid reads, but it didn&#39;t segfault. Here is the <a href=\"https://gist.github.com/luis181/d77251ee76c3902d59bc798b678c418a\" rel=\"nofollow noreferrer\">whole output</a>."}, {"owner": {"reputation": 123, "user_id": 5290212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f23e6b5b55efb6345c37000751a5d5c1?s=128&d=identicon&r=PG&f=1", "display_name": "dr_ate", "link": "https://stackoverflow.com/users/5290212/dr-ate"}, "reply_to_user": {"reputation": 5668, "user_id": 966376, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L6Wh4.jpg?s=128&g=1", "display_name": "GreenScape", "link": "https://stackoverflow.com/users/966376/greenscape"}, "edited": false, "score": 0, "creation_date": 1475076964, "post_id": 39739792, "comment_id": 66799918, "body": "@GreenScape, I followed @Pouet_forever&#39;s advice and changed the stack size to <code>SIGSTKSZ</code>, but it didn&#39;t work. Now, when I tried some more ridiculous stack size, 10*1024*1024, it worked perfectly! Even without those warnings from <code>valgrind</code>. Any ideas on how to narrow down to a smaller value other than some sort of binary search?"}, {"owner": {"reputation": 5668, "user_id": 966376, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L6Wh4.jpg?s=128&g=1", "display_name": "GreenScape", "link": "https://stackoverflow.com/users/966376/greenscape"}, "edited": false, "score": 0, "creation_date": 1475234564, "post_id": 39739792, "comment_id": 66873708, "body": "@dr_ate I&#39;ve made some research and posted it as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5290212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f23e6b5b55efb6345c37000751a5d5c1?s=128&d=identicon&r=PG&f=1", "display_name": "dr_ate", "link": "https://stackoverflow.com/users/5290212/dr-ate"}, "edited": false, "score": 0, "creation_date": 1475075883, "post_id": 39740799, "comment_id": 66799164, "body": "I can see your point, stack grows upwards and it would be possible that I should set the stack pointer to the lower end of the memory area allocated. However, the example on the <code>makecontext</code> manual page does just what I do, and I&#39;ve seen the same on other sources too. Am I missing something?"}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 0, "last_activity_date": 1475047797, "creation_date": 1475047797, "answer_id": 39740799, "question_id": 39739792, "link": "https://stackoverflow.com/questions/39739792/segmentation-when-using-malloc-to-allocate-stack-for-context-but-not-when-using/39740799#39740799", "title": "Segmentation when using malloc to allocate stack for context, but not when using local array", "body": "<p>It happens to work if <code>cstack</code> is on your normal stack because you set up the stack pointer incorrectly and you're getting away with overwriting memory on the real stack rather than overwriting memory you got from malloc.</p>\n\n<p>In which direction does the stack grow on your machine? If it grow like on a normal CPU (pretty much anything other than PA-RISC), where in your memory block should the initial stack pointer point? If you can't answer those two questions with \"oh, of course, that's a silly mistake\" you should reconsider this project, it only gets harder after here.</p>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 5290212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f23e6b5b55efb6345c37000751a5d5c1?s=128&d=identicon&r=PG&f=1", "display_name": "dr_ate", "link": "https://stackoverflow.com/users/5290212/dr-ate"}, "edited": false, "score": 0, "creation_date": 1475075297, "post_id": 39741060, "comment_id": 66798764, "body": "Thank you. <code>SIGSTKSZ</code> was 8192 on my computer too, so I&#39;ve used that as size of the stack now. Still, the problem persists."}], "tags": [], "owner": {"reputation": 101, "user_id": 6882602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UGDix.png?s=128&g=1", "display_name": "Pouet_forever", "link": "https://stackoverflow.com/users/6882602/pouet-forever"}, "is_accepted": false, "score": 0, "last_activity_date": 1475048535, "creation_date": 1475048535, "answer_id": 39741060, "question_id": 39739792, "link": "https://stackoverflow.com/questions/39739792/segmentation-when-using-malloc-to-allocate-stack-for-context-but-not-when-using/39741060#39741060", "title": "Segmentation when using malloc to allocate stack for context, but not when using local array", "body": "<p>According to the man page, you should allocate at leat SIGSTKSZ for the stack size.\nOn my pc, this constant is equal to 8192. On your computer this constant may be greater than 1024.</p>\n"}, {"tags": [], "owner": {"reputation": 5668, "user_id": 966376, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L6Wh4.jpg?s=128&g=1", "display_name": "GreenScape", "link": "https://stackoverflow.com/users/966376/greenscape"}, "is_accepted": true, "score": 1, "last_activity_date": 1475234537, "creation_date": 1475234537, "answer_id": 39790374, "question_id": 39739792, "link": "https://stackoverflow.com/questions/39739792/segmentation-when-using-malloc-to-allocate-stack-for-context-but-not-when-using/39790374#39790374", "title": "Segmentation when using malloc to allocate stack for context, but not when using local array", "body": "<p>According to <a href=\"http://www.delorie.com/gnu/docs/glibc/libc_465.html\" rel=\"nofollow\">this</a></p>\n\n<blockquote>\n  <p><strong>stack_t uc_stack</strong> Stack used for this context. The value need not be\n  (and normally is not) the stack pointer. See section 24.9 Using a\n  Separate Signal Stack.</p>\n</blockquote>\n\n<p>and <a href=\"http://www.delorie.com/gnu/docs/glibc/libc_516.html\" rel=\"nofollow\">this</a></p>\n\n<blockquote>\n  <p><strong>size_t ss_size</strong> </p>\n  \n  <p>This is the size (in bytes) of the signal stack which\n  'ss_sp' points to. You should set this to however much space you\n  allocated for the stack. There are two macros defined in 'signal.h'\n  that you should use in calculating this size:</p>\n  \n  <p><strong>SIGSTKSZ</strong> </p>\n  \n  <p>This is the canonical size for a signal stack. It is judged\n  to be sufficient for normal uses.</p>\n  \n  <p><strong>MINSIGSTKSZ</strong></p>\n  \n  <p>This is the amount of signal stack space the operating\n  system needs just to implement signal delivery. The size of a signal\n  stack must be greater than this. For most cases, just using </p>\n</blockquote>\n\n<p>the minimum required size of <em>stack</em> is governed by <strong>MINSIGSTKSZ</strong> macro.</p>\n"}], "owner": {"reputation": 123, "user_id": 5290212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f23e6b5b55efb6345c37000751a5d5c1?s=128&d=identicon&r=PG&f=1", "display_name": "dr_ate", "link": "https://stackoverflow.com/users/5290212/dr-ate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 1, "accepted_answer_id": 39790374, "answer_count": 3, "score": 1, "last_activity_date": 1475234537, "creation_date": 1475044827, "question_id": 39739792, "link": "https://stackoverflow.com/questions/39739792/segmentation-when-using-malloc-to-allocate-stack-for-context-but-not-when-using", "title": "Segmentation when using malloc to allocate stack for context, but not when using local array", "body": "<p>I am trying to make a user level thread library, but when I tried to set the context of one of those threads, I received a segmentation fault error. I made a stripped version of all my code and narrowed it down (I think) to one weird thing. If I use <code>malloc()</code> to provide a stack for the thread context, it doesn't work. Weirdly though, if I declare an array of same size on the current function's stack, it works as expected. I thought that, apart for the different areas in memory, both approaches would be <em>completely</em> equivalent. After all, they are both pointers to some area of memory that's free to use.</p>\n\n<p>The important lines are:</p>\n\n<ul>\n<li><code>char cstack[1024];</code>, and</li>\n<li><code>char *cstack = (char *)malloc(1024);</code></li>\n</ul>\n\n<p>Both in <code>thread.c</code>, shown below. If I comment the first one and not the second, segmentation fault ensues. If I do the opposite, all is (seems?) fine.</p>\n\n<p>This is the program I used to test it, <code>test.c</code>:</p>\n\n\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include \"thread.h\"\n\nint main(int argc, char** argv) {\n    ccreate(NULL, NULL);\n    return 0;\n}\n</code></pre>\n\n<p>Here is <code>thread.h</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#ifndef __cthread__\n#define __cthread__\n\nint ccreate (void* (*start)(void*), void *arg);\n\n#endif\n</code></pre>\n\n<p>Here is (most importantly) <code>thread.c</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;ucontext.h&gt;\n#include \"logging.c\"\n#include \"cdata.h\"\n#include \"thread.h\"\n\n#undef LOGLEVEL\n#define LOGLEVEL 5\n\nucontext_t m;\nint been_here;\n\nstatic TCB_t *TCB_init(int tid) {\n    floginfo(\"initializing TCB %d\", tid);\n    TCB_t *thr = (TCB_t *)malloc(sizeof(TCB_t));\n\n    thr-&gt;tid = tid;\n    thr-&gt;state = PROCST_APT;\n\n    flogdebug(\"initializing context at address %p\", &amp;(thr-&gt;context));\n    if (getcontext(&amp;(thr-&gt;context)) == -1) logerror(\"error initializing context\");\n    thr-&gt;context.uc_link = &amp;m;\n\n    return thr;\n}\n\nstatic void say_hey(void) {\n    been_here = 1;\n    loginfo(\"hey\");\n}\n\nint ccreate (void* (*start)(void*), void *arg) {\n    static int last_tid = -1;\n\n    //char cstack[1024]; /* doesn't segfault */\n    char *cstack = (char *)malloc(1024); /* segfaults */\n\n    floginfo(\"creating thread %d.\", last_tid + 1);\n    TCB_t *thr;\n    thr = TCB_init(++last_tid);\n    thr-&gt;context.uc_stack.ss_sp = cstack;\n    thr-&gt;context.uc_stack.ss_size = 1024;\n\n    been_here = 0;\n    getcontext(&amp;m);\n\n    if (!been_here) {\n\n        flogdebug(\"making context at address %p\", &amp;(thr-&gt;context));\n        logdebug(\"calling: makecontext(&amp;(thr-&gt;context), say_hey, 0);\");\n        makecontext(&amp;(thr-&gt;context), say_hey, 0);\n\n        flogdebug(\"setting context at address %p\", &amp;(thr-&gt;context));\n        logdebug(\"calling: setcontext(&amp;(thr-&gt;context))\");\n        setcontext(&amp;(thr-&gt;context));\n    }\n    logdebug(\"came back from setcontext\");\n\n    logdebug(\"exiting\");\n\n    return 0;\n}\n</code></pre>\n\n<p>This is where the <code>TCB_t</code> (thread control block) type is defined, <code>cdata.h</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#ifndef __cdata__\n#define __cdata__\n\n#define PROCST_CRE  0\n#define PROCST_APT  1\n#define PROCST_EXEC 2\n#define PROCST_BLOC 3\n#define PROCST_TERM 4\n\ntypedef struct s_TCB {\n    int     tid;\n    int     state;\n    ucontext_t  context;\n} TCB_t;\n\n#endif\n</code></pre>\n\n<p>And here is (very unimportant, I think) <code>logging.c</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdarg.h&gt;\n\n#define LOGLEVEL 6\n#define LVL_DEBUG 5\n#define LVL_INFO 4\n#define LVL_WARNING 3\n#define LVL_ERROR 2\n#define LVL_CRITICAL 1\n\nvoid logdebug(const char *msg) {\n    if (LOGLEVEL &gt;= LVL_DEBUG) {\n        fprintf(stderr, \"DEBUG:    %s\\n\", msg);\n    }\n}\n\nvoid loginfo(const char *msg) {\n    if (LOGLEVEL &gt;= LVL_INFO) {\n        fprintf(stderr, \"INFO:     %s\\n\", msg);\n    }\n}\n\nvoid logwarning(const char *msg) {\n    if (LOGLEVEL &gt;= LVL_WARNING) {\n        fprintf(stderr, \"WARNING:  %s\\n\", msg);\n    }\n}\n\nvoid logerror(const char *msg) {\n    if (LOGLEVEL &gt;= LVL_ERROR) {\n        fprintf(stderr, \"ERROR:    %s\\n\", msg);\n    }\n}\n\nvoid logcritical(const char *msg) {\n    if (LOGLEVEL &gt;= LVL_CRITICAL) {\n        fprintf(stderr, \"CRITICAL: %s\\n\", msg);\n    }\n}\n\nvoid flogdebug(const char *fmt, ...) {\n    char buff[1024];\n    va_list args;\n    va_start(args, fmt);\n    vsprintf(buff, fmt, args);\n    va_end(args);\n    logdebug((const char *)buff);\n}\n\nvoid floginfo(const char *fmt, ...) {\n    char buff[1024];\n    va_list args;\n    va_start(args, fmt);\n    vsprintf(buff, fmt, args);\n    va_end(args);\n    loginfo((const char *)buff);\n}\n\nvoid flogwarning(const char *fmt, ...) {\n    char buff[1024];\n    va_list args;\n    va_start(args, fmt);\n    vsprintf(buff, fmt, args);\n    va_end(args);\n    logwarning((const char *)buff);\n}\n\nvoid flogerror(const char *fmt, ...) {\n    char buff[1024];\n    va_list args;\n    va_start(args, fmt);\n    vsprintf(buff, fmt, args);\n    va_end(args);\n    logerror((const char *)buff);\n}\nvoid flogcritical(const char *fmt, ...) {\n    char buff[1024];\n    va_list args;\n    va_start(args, fmt);\n    vsprintf(buff, fmt, args);\n    va_end(args);\n    logcritical((const char *)buff);\n}\n</code></pre>\n\n<p>Finally, compiling all with <code>gcc -Wall thread.c test.c</code> gives no warning. If <code>char cstack[1024];</code> is uncommented, I get this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>INFO:     creating thread 0.\nINFO:     initializing TCB 0\nDEBUG:    initializing context at address 0x16d5018\nDEBUG:    making context at address 0x16d5018\nDEBUG:    calling: makecontext(&amp;(thr-&gt;context), say_hey, 0);\nDEBUG:    setting context at address 0x16d5018\nDEBUG:    calling: setcontext(&amp;(thr-&gt;context))\nINFO:     hey\nDEBUG:    came back from setcontext\nDEBUG:    exiting\n</code></pre>\n\n<p>If <code>char *cstack = (char *)malloc(1024);</code> is uncommented, I get this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>INFO:     creating thread 0.\nINFO:     initializing TCB 0\nDEBUG:    initializing context at address 0x12f8428\nDEBUG:    making context at address 0x12f8428\nDEBUG:    calling: makecontext(&amp;(thr-&gt;context), say_hey, 0);\nDEBUG:    setting context at address 0x12f8428\nDEBUG:    calling: setcontext(&amp;(thr-&gt;context))\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>Any ideas <em>at all</em> are appreciated. I am mostly confused and pondering all I thought I knew.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1475045908, "post_id": 39739780, "comment_id": 66777643, "body": "<code>*args[count] = ...</code> - that doesn&#39;t do what you think it does. Look carefully at the <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence table for C</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1475045980, "post_id": 39739780, "comment_id": 66777686, "body": "Since your code compiles, could you provide us with a <a href=\"/help/mcve\">Minimal, Complete, and Verifiable Example</a>?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1475048273, "post_id": 39739780, "comment_id": 66779106, "body": "Warning: when allocation memory to store words, you&#39;re missing the last <code>\\0</code> : <code>strlen</code> does not include the <code>\\0</code> <code>strcpy</code> takes care of it."}, {"owner": {"reputation": 1, "user_id": 6891466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aKD7QmX_2Jc/AAAAAAAAAAI/AAAAAAAAALI/AE8BNa2DD5Q/photo.jpg?sz=128", "display_name": "Quiksilv26", "link": "https://stackoverflow.com/users/6891466/quiksilv26"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475075559, "post_id": 39739780, "comment_id": 66798949, "body": "@WhozCraig Thank you! Something stupidly obvious now that I know where the issue is."}, {"owner": {"reputation": 1, "user_id": 6891466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aKD7QmX_2Jc/AAAAAAAAAAI/AAAAAAAAALI/AE8BNa2DD5Q/photo.jpg?sz=128", "display_name": "Quiksilv26", "link": "https://stackoverflow.com/users/6891466/quiksilv26"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1475075723, "post_id": 39739780, "comment_id": 66799051, "body": "@purplepsycho I&#39;ve actually got that in the working version. Oops. Thank you."}], "owner": {"reputation": 1, "user_id": 6891466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aKD7QmX_2Jc/AAAAAAAAAAI/AAAAAAAAALI/AE8BNa2DD5Q/photo.jpg?sz=128", "display_name": "Quiksilv26", "link": "https://stackoverflow.com/users/6891466/quiksilv26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "closed_date": 1475421668, "answer_count": 0, "score": 0, "last_activity_date": 1475044800, "creation_date": 1475044800, "question_id": 39739780, "link": "https://stackoverflow.com/questions/39739780/passing-a-triple-pointer-for-an-array-of-strings-in-c", "closed_reason": "Duplicate", "title": "Passing a triple pointer for an array of strings in C", "body": "<p>So this is more a plea for explanations and resources than anything. I've done some searching on here and online, and haven't found anything that really answers the question.</p>\n\n<p>I was given an assignment to parse a string into tokens, implemented using the following prototype verbatim:\n<code>int makearg(char *s, char ***args);</code></p>\n\n<p>I did so using something like the following:</p>\n\n<pre><code>int makearg(char *s, char ***args){\n  char temp[255];\n  int count = 0;\n\n  ///////\n  //Count words in string\n  ///////\n\n  *args = calloc( count , sizeof(char*));\n  //OR: *args = (char**) malloc(count * sizeof(char*));\n\n  count = 0; \n\n  while( //Not at end of s// ){\n\n    //Copy word into temp\n    if( //end of word// ){\n      *args[count]=calloc( strlen(temp),  sizeof(char));\n      //OR: *args[count] = (char*) malloc(count * sizeof(char));\n\n      strcpy(*args[count],temp);\n\n      count++;\n    }\n  }\nreturn count;\n}\n\nint main(){\n  char inp[255];\n  char **tokens = NULL;\n  int count;\n\n  printf(\"ENTER COMMAND: \");\n  fgets(inp,255,stdin);\n  count = makearg(inp,&amp;tokens);\n\n  printf(\"Number of arguments:%d\\nArguments:\",count);\n  int i = 0;\n  for(i=0;i&lt;count;i++)\n    printf(\"\\n%s\", tokens[i]);\n  printf(\"\\n\");\n  return 0;\n}\n</code></pre>\n\n<p>If I gave something like <code>\"testcommand\"</code> the program appeared to work, but if I gave an input with two or more words, such as <code>\"This is my test command\"</code>, it would start segfaulting on the second calloc/malloc line. Poking around with GDB showed that <code>*args[0]</code> returned as expected (<code>\"This\"</code>), but <code>*args[1]</code> was attempting to access a point in memory it shouldn't. </p>\n\n<p>I got it working using the following: </p>\n\n<pre><code>int makearg(char *s, char ***args){\n  char temp[255];\n  int count = 0;\n  char** tempargs;\n\n  ///////\n  //Count words in string\n  ///////\n\n  tempargs = calloc( count , sizeof(char*));\n\n  count = 0; \n\n  while( //Not at end of s// ){\n\n    //Copy word into temp\n    if( //end of word// ){\n      tempargs[count]=calloc( strlen(temp),  sizeof(char));\n\n      strcpy(tempargs[count],temp);\n\n      count++;\n    }\n  }\n *args = tempargs;\n return count;\n}\n</code></pre>\n\n<p>My question is, what's the difference here? From my understanding, <code>*args</code> should be the same as using <code>tokens</code>, especially for the purposes of <code>malloc</code>. The bit at the end with <code>*args = tempargs</code> is just setting <code>tokens</code> to point at the same chunk of memory as <code>tempargs</code>. How is this different from pointing <code>*args</code> at the <code>malloc</code> memory in the first place?</p>\n\n<p>My professor described the above solution as the way he usually does it, but didn't give a better explanation than \"it strips off a layer of redirection in the body of the function\". This makes sense, and is a convention I've seen elsewhere on here while trying to find answers, but doesn't help me understand. I asked around a bit in person, but the best answer I got was \"eh. Scope/compiler shenanigans probably. It <em>looks</em> the same?\".</p>\n\n<p>Where should I go to find more on this?</p>\n"}, {"tags": ["c", "io"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1475044542, "post_id": 39739641, "comment_id": 66776840, "body": "The lack of <i>any</i> code showing what you&#39;re <i>really</i> doing doesn&#39;t help your question whatsoever. Provide a <a href=\"https://stackoverflow.com/help/mcve\">minimal, <b>complete</b>, and verifiable example</a> of what you have, and what you&#39;ve done so far to narrow down the problem."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475044685, "post_id": 39739641, "comment_id": 66776915, "body": "What makes you think that this approach is mistaken ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1475044745, "post_id": 39739641, "comment_id": 66776951, "body": "BTW: <code>fputs</code> is not the function you need here. You must use the <code>fwrite</code> function."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475044750, "post_id": 39739641, "comment_id": 66776954, "body": "On my machine, the data at 0x18 will overlap with the data at 0x1C for machine type <code>long</code>.  You must be using a 32-bit system.  However, <code>fseek()</code> and <code>fwrite()</code> are the functions you need."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475044872, "post_id": 39739641, "comment_id": 66777038, "body": "No, I&#39;m using a 64-bit system. I might be mistaken, but I thought long ints were 32 bits and long long ints were 64; I could very well be mistaken, though."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475044889, "post_id": 39739641, "comment_id": 66777049, "body": "@WhozCraig, I&#39;ll paste my code in just a second, sorry."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475045840, "post_id": 39739641, "comment_id": 66777599, "body": "You could be using a 64-bit Windows system; they use 32-bit <code>long</code>.  Unix-based 64-bit systems all use 64-bit <code>long</code> (as well as 64-bit <code>long long</code>) \u2014 the difference between LP64 and LLP64 (look it up, along with ILP32 for 32-bit systems).  Note, if you&#39;re on Windows, you need to add <code>b</code> to the mode string for <code>fopen()</code> for reliability, and you would not be using <code>&quot;w&quot;</code> (or <code>&quot;wb&quot;</code>) because those clobber the file contents.  You need <code>&quot;r+b&quot;</code>!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475046145, "post_id": 39739641, "comment_id": 66777777, "body": "<code>char fname[sizeof(argv[1])];</code> is wrong, <code>sizeof(argv[1])</code>is not what you think it is. If you want to get the length of the <code>argv[1]</code> string, you need the use the <code>strlen</code> function. And you need to allocate one more char for the terminating NUL character. So you should write <code>strlen(argv[1]) + 1</code> instead of <code>sizeof(argv[1])</code>. But actually there is not need to copy the filename. You can just pass <code>argv[1]</code> to the <code>modify_data</code> function."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1475050388, "post_id": 39739641, "comment_id": 66780372, "body": "use intN_t and uintN_t for that. if you use any other type, the size will be different at some platform."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1475050582, "post_id": 39739641, "comment_id": 66780505, "body": "you should also check for errors in fseek(), fopen() and and fwrite(). generel, check every possible error, only of you sure you cant do anything about it, only then ignore it."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475045187, "post_id": 39739850, "comment_id": 66777207, "body": "Yeah, that&#39;s what I thought, but the documentation for fwrite said they were for binary files, which I may have misinterpreted. I&#39;ll give this a go. Can you explain why I have to use the &amp; operator? Would just saying value1 not write value1?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475045264, "post_id": 39739850, "comment_id": 66777258, "body": "So is your file a binary file or not, maybe you should show that file, or at least the beginning of that file. <code>fwrite</code> wants a memory address therefore you need the &amp; operator, read the fwrite man page. The string &quot;18000&quot; and the number 18000 are two very different things."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475045360, "post_id": 39739850, "comment_id": 66777306, "body": "It&#39;s definitely not plaintext, if that&#39;s what you mean. It would look pretty ugly to copy and paste the hex here. It&#39;s an audio file."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475045398, "post_id": 39739850, "comment_id": 66777335, "body": "Then you certainly need <code>fwrite</code>. BTW in the final verson of your program you need to add error checking, especially testing if <code>fopen</code> return <code>NULL</code>, which means that the file could not be opened for some reason (mostly, because it does not exist)."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475045862, "post_id": 39739850, "comment_id": 66777616, "body": "I made edits to my code and it now edits the addresses properly, but it also makes every other value 0 and crashes immediately after editing 0x1C, making me think it&#39;s creating a new file. Do I need w+ for overwriting?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475045906, "post_id": 39739850, "comment_id": 66777639, "body": "@Kurausukun: Note that the use of <code>&quot;w&quot;</code> means that the file is clobbered (truncated to zero length).  If the intent is to update the file, the mode should be <code>&quot;r+&quot;</code> or <code>&quot;r+b&quot;</code> (the <code>b</code> matters critically on Windows and matters not at all on Unix)."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475046252, "post_id": 39739850, "comment_id": 66777845, "body": "Thanks for the help; the program still crashes, though, and it&#39;s not writing the correct values. I assume the issue with the values is because I&#39;m using the wrong size in some capacity, but I have no idea why it&#39;s crashing."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475046314, "post_id": 39739850, "comment_id": 66777878, "body": "@Kurausukun concerning your program crashing you probably should ask another question and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Did you check if <code>fopen</code> returns NULL ? If it returns NULL and you don&#39;t check, it&#39;s quite normal your program crashes. Also read by last comment in your original question, that may be a cause for the crash."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475046841, "post_id": 39739850, "comment_id": 66778196, "body": "Alright, I fixed the crashing, but I&#39;m still writing the wrong values. I wrote some code to check, and it turns out that on my system, both int and long int are 4 bytes, so there shouldn&#39;t be a problem there."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1475046453, "last_edit_date": 1475046453, "creation_date": 1475044983, "answer_id": 39739850, "question_id": 39739641, "link": "https://stackoverflow.com/questions/39739641/how-to-write-to-a-specific-address-in-a-file-in-c/39739850#39739850", "title": "How to Write to a Specific Address in a File in C", "body": "<p>Non error checking non tested code fragment:</p>\n\n<pre><code>long value1 = 18000;\nlong value2 = 60000;\n\nFILE *fp = fopen(\"thefile\", \"r+\");  // or \"r+b\" on Windows\nfseek(fp, 0x18, SEEK_SET);\nfwrite(&amp;value1, sizeof long, 1, fp);\nfseek(fp, 0x1c SEEK_SET);\nfwrite(&amp;value2, sizeof long, 1, fp);\n</code></pre>\n\n<p>If the size of <code>long</code> is not 32 bits on your platform, you need to subsitute <code>long</code> with an appropriate 32 bit type, most likely <code>int</code>.</p>\n\n<p>Your solution with <code>fputs</code> wont work.</p>\n\n<pre><code>fputs(\"180000\", newfile);\n</code></pre>\n\n<p>writes the string \"180000\" to the file and not the 32 bit value 18000.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475047210, "post_id": 39740511, "comment_id": 66778414, "body": "I just realized the problem: it IS writing properly, but it&#39;s writing in little-endian; I need it to be big-endian. I don&#39;t suppose there&#39;s a good way to do that?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475047378, "post_id": 39740511, "comment_id": 66778521, "body": "Easy, you just need to <a href=\"http://stackoverflow.com/questions/2182002/convert-big-endian-to-little-endian-in-c-without-using-provided-func\">convert your value to big endian</a> prior to writing it to the file."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475047450, "post_id": 39740511, "comment_id": 66778570, "body": "Well yes, but the issue is how I do that. I&#39;ve never worked with bitshift operators before, which is what I feel like I would need to use to do this. Unless there&#39;s a built-in function in some library (there probably isn&#39;t)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475047476, "post_id": 39740511, "comment_id": 66778588, "body": "Click on the link in my comment."}, {"owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "edited": false, "score": 0, "creation_date": 1475048386, "post_id": 39740511, "comment_id": 66779173, "body": "Finally got it working after tracking down the library. Thanks a lot for putting up with me."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1475046915, "creation_date": 1475046915, "answer_id": 39740511, "question_id": 39739641, "link": "https://stackoverflow.com/questions/39739641/how-to-write-to-a-specific-address-in-a-file-in-c/39740511#39740511", "title": "How to Write to a Specific Address in a File in C", "body": "<p>You probably want this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid modify_data(unsigned int samp1, unsigned int samp2, char fname[])\n{\n  FILE * newfile;\n  newfile = fopen(fname, \"r+\");  // or \"r+b\" on Windows\n  if (newfile != NULL)\n  {\n    printf(\"Could not open file\");\n    return;\n  }\n\n  fseek(newfile, 0x18, SEEK_SET);\n  fwrite(&amp;samp1, sizeof (unsigned int), 1, newfile);\n  fseek(newfile, 0x1c, SEEK_SET);\n  fwrite(&amp;samp2, sizeof (unsigned int), 1, newfile);\n}\n\nint main(int argc, char * argv[])\n{\n  modify_data(0, 0, argv[1]); // the first two arguments are placeholders while I test\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5957687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W6V3gpzKbtM/AAAAAAAAAAI/AAAAAAAAAa8/GvwTExEvL6o/photo.jpg?sz=128", "display_name": "Kurausukun", "link": "https://stackoverflow.com/users/5957687/kurausukun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 39740511, "answer_count": 2, "score": 0, "last_activity_date": 1475046915, "creation_date": 1475044369, "last_edit_date": 1475044968, "question_id": 39739641, "link": "https://stackoverflow.com/questions/39739641/how-to-write-to-a-specific-address-in-a-file-in-c", "title": "How to Write to a Specific Address in a File in C", "body": "<p>All I want to do is write one long int to offset 0x18 and another separate long int to offset 0x1C into a file I've opened. These offsets always contain the relevant data for the file format I'm processing, so there's no need to worry about that--all I need to do is make the value at these addresses equal to some specified number. I have no problem opening the file, but I'm not sure how to accomplish this since I'm not very experienced with C. </p>\n\n<p>Right now I'm opening the file in write mode with fopen(), seeking to 0x18 with fseek, writing \"XXXXX\" with fputs (XXXXX is just some number), seeking again to 0x1C, doing the same thing again, and closing the file. Not only do I feel like this approach is mistaken, it also does nothing and I have no idea why. Am I right and I should be going about this some other way, or am I just missing something?</p>\n\n<p>EDIT: Code:</p>\n\n<pre><code>void modify_data(unsigned long int samp1, unsigned long int samp2, char fname[]) {\nFILE * newfile;\nnewfile = fopen(fname, \"w\");\nfseek(newfile, 0x18, SEEK_SET);\nfputs(\"180000\", newfile); // 180000 is a placeholder while I test\nfseek(newfile, 0x1C, SEEK_SET);\nfputs(\"600000\", newfile); // 600000 is a placeholder while I test\nfclose(newfile);\n}\n\nint main(int argc, char * argv[]) {\nchar fname[sizeof(argv[1])];\nstrcpy(fname, argv[1]);\nmodify_data(0, 0, fname); // the first two arguments are placeholders while I test\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "dll", "dllimport"], "comments": [{"owner": {"reputation": 4651, "user_id": 6138713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kDSMP.jpg?s=128&g=1", "display_name": "jegtugado", "link": "https://stackoverflow.com/users/6138713/jegtugado"}, "edited": false, "score": 1, "creation_date": 1475043966, "post_id": 39739484, "comment_id": 66776549, "body": "What are the OS of the two computers?"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1475044060, "post_id": 39739484, "comment_id": 66776590, "body": "What about dependencies of the DLL on others DLL (maybe runtime library ) ?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1475046467, "post_id": 39739484, "comment_id": 66777973, "body": "It is a basic DLL Hell problem.  It found the DLL you want to use and loaded it without any problems but it doesn&#39;t have the function you want to call.  Deploy the <i>exact</i> same file you used on your dev machine.  Assuming you properly tested it on your dev machine, never skip that.  Use Dumpbin.exe /exports on the DLL for another way to verify."}, {"owner": {"reputation": 153, "user_id": 2237142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd7306a0e4c160bf597bfd4fc3285ec?s=128&d=identicon&r=PG", "display_name": "firetiger77", "link": "https://stackoverflow.com/users/2237142/firetiger77"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1475204213, "post_id": 39739484, "comment_id": 66859887, "body": "@HansPassant , I would upvote your comment if I had the rep. Deploying the exact same dependent DLLs helped guide me to the solution."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 2237142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd7306a0e4c160bf597bfd4fc3285ec?s=128&d=identicon&r=PG", "display_name": "firetiger77", "link": "https://stackoverflow.com/users/2237142/firetiger77"}, "edited": false, "score": 0, "creation_date": 1475204400, "post_id": 39739679, "comment_id": 66859937, "body": "This solution was helpful to dispel the &quot;just copy it to system32&quot; myth; it just didn&#39;t happen to address my specific problem."}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": false, "score": 3, "last_activity_date": 1475044464, "creation_date": 1475044464, "answer_id": 39739679, "question_id": 39739484, "link": "https://stackoverflow.com/questions/39739484/c-dllimport-call-throws-an-exception-on-one-computer-but-works-on-another/39739679#39739679", "title": "C# DllImport call throws an exception on one computer, but works on another", "body": "<p>Don't copy your DLLs to the system folder. That belongs to the system and you should not modify it. Remove those DLLs from any system folders they have been placed in. </p>\n\n<p>Instead put your DLLs in the same directory as the executable. After that the other step that is needed is to make sure that any dependencies, typically the VC runtime, are available. Depending on exactly how you want to deploy this will likely involve installing the VC redistributable package on any target machine. </p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 2237142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd7306a0e4c160bf597bfd4fc3285ec?s=128&d=identicon&r=PG", "display_name": "firetiger77", "link": "https://stackoverflow.com/users/2237142/firetiger77"}, "is_accepted": true, "score": 0, "last_activity_date": 1475205110, "creation_date": 1475205110, "answer_id": 39783066, "question_id": 39739484, "link": "https://stackoverflow.com/questions/39739484/c-dllimport-call-throws-an-exception-on-one-computer-but-works-on-another/39783066#39783066", "title": "C# DllImport call throws an exception on one computer, but works on another", "body": "<p>An older version of a dependency (a Jungo DLL in this case), which did not export the same set of functions as the newer version, had been installed to the machine with the error. Copying the newer version over solved the problem.</p>\n\n<p>So, while the dependent file was present on both machines, the necessary set of exported functions were not. C# specified a \"procedure could not be found\" error on DLL A, when technically, it was on a dependency of a dependency.</p>\n\n<p>Dependency walker proved useful in identifying what the dependencies were in the first place and indicating that there was a missing import in one of them.</p>\n"}], "owner": {"reputation": 153, "user_id": 2237142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd7306a0e4c160bf597bfd4fc3285ec?s=128&d=identicon&r=PG", "display_name": "firetiger77", "link": "https://stackoverflow.com/users/2237142/firetiger77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 39783066, "answer_count": 2, "score": 0, "last_activity_date": 1475205110, "creation_date": 1475043868, "question_id": 39739484, "link": "https://stackoverflow.com/questions/39739484/c-dllimport-call-throws-an-exception-on-one-computer-but-works-on-another", "title": "C# DllImport call throws an exception on one computer, but works on another", "body": "<p>Upon running the following C# application which references an unmanaged DLL (written in C), I get an DllNotFound exception with the following information:</p>\n\n<blockquote>\n  <p>Additional information: Unable to load DLL 'C:\\Windows\\System32\\myLib.dll': The specified procedure could not be found. (Exception from HRESULT: 0x8007007F)</p>\n</blockquote>\n\n<p><strong>What I've tried:</strong></p>\n\n<ul>\n<li>I've verified that the DLL is present in the expected path (in fact, I get a different error message when the DLL is not there)</li>\n<li>I've copied the exe and accompanying dll to another computer (in the same path), and it works without issue.</li>\n<li>I've copied the DLL to the System32 directory (and referenced it there) as suggested by certain other answers here.</li>\n<li>I've double-checked the Access rights, and disabled MS Security Essentials.</li>\n<li>I've ensured the platform targets match.</li>\n</ul>\n\n<p>This is baffling as there appear to be so few dependencies required to load a DLL.</p>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475043368, "post_id": 39739306, "comment_id": 66776270, "body": "First of all, if you have an array use array-indexing syntax, like e.g. <code>function_ptr[pick - 1]</code> instead, it makes it much clearer what you are doing. Secondly, you don&#39;t actually <i>call</i> the functions."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475043474, "post_id": 39739306, "comment_id": 66776328, "body": "Oh, and thirdly, think again about your loop condition..."}, {"owner": {"reputation": 11196, "user_id": 1079907, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a7c69e39fbec2c781db5f27b40f63023?s=128&d=identicon&r=PG", "display_name": "Sunil Bojanapally", "link": "https://stackoverflow.com/users/1079907/sunil-bojanapally"}, "edited": false, "score": 0, "creation_date": 1475043503, "post_id": 39739306, "comment_id": 66776339, "body": "<code>int pick = 0; while(pick != 0) {...</code> Here while loop never gets a chance."}, {"owner": {"reputation": 5, "user_id": 4024767, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/40526fdb3e78e83ab421d944245db144?s=128&d=identicon&r=PG&f=1", "display_name": "MD_90", "link": "https://stackoverflow.com/users/4024767/md-90"}, "edited": false, "score": 0, "creation_date": 1475044925, "post_id": 39739306, "comment_id": 66777068, "body": "Sorry bout that my official code didnt have that while loop fail. My issue in general was with the array of function pointers"}, {"owner": {"reputation": 5, "user_id": 4024767, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/40526fdb3e78e83ab421d944245db144?s=128&d=identicon&r=PG&f=1", "display_name": "MD_90", "link": "https://stackoverflow.com/users/4024767/md-90"}, "edited": false, "score": 0, "creation_date": 1475045201, "post_id": 39739306, "comment_id": 66777213, "body": "The compiler complained no matter what i did to pass the array into it because of array of void and such errors. Basically, the user enters 1 - 3 to choose one of those 3 functions to print out a message and if the user enters 0 then program ends"}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1475043551, "post_id": 39739345, "comment_id": 66776370, "body": "In other words, <i>exactly</i> as it is declared in <code>main</code>, less the initializer."}, {"owner": {"reputation": 5, "user_id": 4024767, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/40526fdb3e78e83ab421d944245db144?s=128&d=identicon&r=PG&f=1", "display_name": "MD_90", "link": "https://stackoverflow.com/users/4024767/md-90"}, "edited": false, "score": 0, "creation_date": 1475082575, "post_id": 39739345, "comment_id": 66803486, "body": "I changed main to this int main() {  \tvoid(*fun_ptr[])(void) = {fun1, fun2, fun3, fun4}; \tpickFun(fun_ptr); \treturn (0); } I changed the pickFun to this voidpickFun(void(*function_ptr[])(void)) { }  inside pick fun I used function_ptr[pick - 1] for each of the 3 legal answers and 0 to terminate  My pickFun declaration is this                                 void selectFunction(void (*[]));  The complier errors saying the following  \t&#39;void pickFun(void *[])&#39;: cannot convert argument 1 from &#39;void (__cdecl *[4])(void)&#39; to &#39;void *[]&#39;"}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1475044049, "last_edit_date": 1475044049, "creation_date": 1475043341, "answer_id": 39739345, "question_id": 39739306, "link": "https://stackoverflow.com/questions/39739306/arrays-and-function-pointers/39739345#39739345", "title": "Arrays and function pointers", "body": "<p>Function parameter <code>void *function_ptr[]</code> is of type <code>pointer to pointer to</code>void`. You need to change it to   </p>\n\n<pre><code>void pickFun(void (*function_ptr[])(void));  \n</code></pre>\n\n<p>Also note that, as others pointed out in comments, program never enters the loop body. Better to use <code>do while</code> loop here  </p>\n\n<pre><code>void pickFun(void *function_ptr[])\n{\n   do\n   {\n        scanf(\"%i\", &amp;pick);\n        //*(function_ptr + (pick - 1));\n        function_ptr[pick-1]();     //Function call. pick should not be greater than 3\n   } while(pick != 0)\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1475044258, "post_id": 39739540, "comment_id": 66776707, "body": "This doesn&#39;t answer the question &quot;How to pass an array of pointers to functions as a argument to a function?&quot;"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1475044308, "post_id": 39739540, "comment_id": 66776737, "body": "It answers the question, &quot;How do you access the functions?&quot;"}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 0, "last_activity_date": 1475044045, "creation_date": 1475044045, "answer_id": 39739540, "question_id": 39739306, "link": "https://stackoverflow.com/questions/39739306/arrays-and-function-pointers/39739540#39739540", "title": "Arrays and function pointers", "body": "<p>Also, you can call your functions with:</p>\n\n<pre><code>(*function_ptr[pick-1])();\n</code></pre>\n\n<p>or (yuck):</p>\n\n<pre><code>(*(function_ptr + (pick-1)))();\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>function_ptr[pick-1]();\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>(function_ptr + (pick-1))();\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4024767, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/40526fdb3e78e83ab421d944245db144?s=128&d=identicon&r=PG&f=1", "display_name": "MD_90", "link": "https://stackoverflow.com/users/4024767/md-90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1475046745, "creation_date": 1475043186, "question_id": 39739306, "link": "https://stackoverflow.com/questions/39739306/arrays-and-function-pointers", "title": "Arrays and function pointers", "body": "<p>How do pass an array of pointers to functions as a argument to a function? If the types of the functions are void and so is the pointer, how do you access the functions? </p>\n\n<pre><code>int main() {\n\n  void(*fun_ptr[])(void) = {fun1, fun2, fun3};\n  pickFun(fun_ptr);\n  return 0;\n}\n</code></pre>\n\n<p>All 3 functions only print a message and are declared as void</p>\n\n<pre><code>void pickFun(void *function_ptr[])\n{\n   int pick = 0;\n   while(pick != 0)\n   {\n     scanf(\"%i\", &amp;pick);\n    *(function_ptr + (pick - 1));\n   }\n }\n</code></pre>\n\n<p>I can never get the function's printf statements to appear when a function is chosen. The program just loops and never prints the message contained in each function. Any suggestions or clues?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475042849, "post_id": 39739175, "comment_id": 66775996, "body": "Fyi, likely <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">a much better man page</a>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1475042854, "post_id": 39739175, "comment_id": 66776000, "body": "<code>text</code> is a pointer to......nothing. You must create something to point to: using <a href=\"http://man7.org/linux/man-pages/man3/free.3.html\" rel=\"nofollow noreferrer\">malloc</a> or a static array. The same for <code>num</code>."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1475042907, "post_id": 39739175, "comment_id": 66776025, "body": "<code>text</code> points to a random block of memory, which scanf will attempt to overwrite"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1475043036, "post_id": 39739175, "comment_id": 66776094, "body": "<code>char text[sizeof ebuf]; int num;</code> ... <code>sscanf(ebuf, &quot;%[^_]_%i.&quot;, text, &amp;num);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475043418, "post_id": 39739175, "comment_id": 66776294, "body": "There are many issues: one of them : <code>strncpy (ebuf,tfp-&gt;d_name,strlen(tfp-&gt;d_name));</code> -&gt; <code>strncpy (ebuf,tfp-&gt;d_name,strlen(tfp-&gt;d_name) + 1);</code>, otherwise you won&#39;t copy the terminating NUL character. But BTW you don&#39;t need to copy the <code>tfp-&gt;d_name</code> string to <code>ebuf</code>, you can directly scan from <code>tfp-&gt;d_name</code>."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1475043928, "last_edit_date": 1495535266, "creation_date": 1475043208, "answer_id": 39739309, "question_id": 39739175, "link": "https://stackoverflow.com/questions/39739175/i-have-a-filename-abcd-81018293-txt-i-try-sscanf-to-get-abcd-as-text-and-the-di/39739309#39739309", "title": "I have a filename ABCD_81018293.txt. I try sscanf to get ABCD as text and the digits as an int", "body": "<p>Your pointer are not inizialize, so are pointing to nothing consistent.</p>\n\n<p>You can allocate space for them using malloc, like:</p>\n\n<pre><code>char *text = malloc(max_len);\nint *num = malloc(sizeof(int));\n// ....\nfree(text);\nfree(num);\n</code></pre>\n\n<p>As you can see <code>malloc</code>ated memory must be <code>free</code>d to release the allocated memory.</p>\n\n<p>Otherwise you can use a simple variable and an array to store your <a href=\"/questions/tagged/c-string\" class=\"post-tag\" title=\"show questions tagged &#39;c-string&#39;\" rel=\"tag\">c-string</a></p>\n\n<pre><code>char text[max_len];\nint num;\n// ...\nsscanf (ebuf, \"%s_%i.txt\", text, &amp;num);\n</code></pre>\n\n<p>Take a look at this <a href=\"https://stackoverflow.com/questions/8141208/sscanf-with-delimiter-in-c\">SO question</a> to understand how you can manage to trigger a '_' as string delimiter.\nSo, as BLUEPIXY commented you:</p>\n\n<pre><code>sscanf(ebuf, \"%[^_]_%i.\", text, &amp;num);\n</code></pre>\n\n<p>Last thing, you can avoid the <code>strncpy</code>, and <code>sscanf</code> directly to <code>tfp-&gt;d_name</code></p>\n\n<pre><code>sscanf(tfp-&gt;d_name, \"%[^_]_%i.\", text, &amp;num);\n</code></pre>\n\n<p>This also avoid the \"explosion\" of <code>sscanf</code> due to the no null terminated <code>ebuf</code> string: You should use <code>strlen(tfp-&gt;d_name)+1</code> as third parameter of your <code>strncpy</code> to copy to <code>ebuf</code> the null terminator too.</p>\n\n<p>As <a href=\"http://man7.org/linux/man-pages/man3/strlen.3.html\" rel=\"nofollow noreferrer\">strlen Man</a> says:</p>\n\n<blockquote>\n  <p><strong>DESCRIPTION</strong></p>\n  \n  <p>The strlen() function calculates the length of the string pointed to\n         by s, <strong><em>excluding the terminating null byte ('\\0')</em></strong>.</p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n"}], "owner": {"reputation": 1, "user_id": 6891369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/352187ec11e7eeac00b1c2a51768a83d?s=128&d=identicon&r=PG&f=1", "display_name": "inbits", "link": "https://stackoverflow.com/users/6891369/inbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1475043844, "answer_count": 1, "score": -1, "last_activity_date": 1475164334, "creation_date": 1475042704, "last_edit_date": 1475164334, "question_id": 39739175, "link": "https://stackoverflow.com/questions/39739175/i-have-a-filename-abcd-81018293-txt-i-try-sscanf-to-get-abcd-as-text-and-the-di", "closed_reason": "Duplicate", "title": "I have a filename ABCD_81018293.txt. I try sscanf to get ABCD as text and the digits as an int", "body": "<p>One of the many forms I have tried is</p>\n\n<pre><code>    char *text, ebuf[32];\n    int *num;     \n    strncpy (ebuf,tfp-&gt;d_name,strlen(tfp-&gt;d_name));\n    sscanf (ebuf, \"%s_%i.txt\", text, num);\n</code></pre>\n\n<h2>I started originally with tfp->d_name in place of the ebuf hack, with the same results: segment faults. I understood from the man page that perhaps the %s should be %4c (text string has 4 characters - but not always). Anyway %4c or 4%c didn't make any difference.</h2>\n\n<p>Thanks to all who responded. Your clarifications - especially WhozCraig's \"better man page\" - put me on the right track.</p>\n\n<p>The initialization issue was not my major problem, it was the syntax of the sscanf. For my program, once initialization was out of the way, the single line I really needed was:</p>\n\n<pre><code>      sscanf (tfp-&gt;d_name, \"%[^_]_%i\", &amp;text[0], &amp;num);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1475041494, "post_id": 39738865, "comment_id": 66775343, "body": "Do you initialize <code>lyrics_buffer</code> anywhere? If you don&#39;t and it&#39;s a local variable then using it in <code>strcat</code> will lead to <i>undefined behavior</i>."}, {"owner": {"reputation": 231, "user_id": 6333557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/--1MSz4HvnpQ/AAAAAAAAAAI/AAAAAAAAACI/t7w7ELSEXCo/photo.jpg?sz=128", "display_name": "nanjero echizen", "link": "https://stackoverflow.com/users/6333557/nanjero-echizen"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475041542, "post_id": 39738865, "comment_id": 66775372, "body": "@JoachimPileborg Yes its a local variable. Should I also declare it in the main?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 5, "creation_date": 1475041548, "post_id": 39738865, "comment_id": 66775378, "body": "<code>for (i=0; i&lt;arr_num; i++);</code> remove last <code>;</code> and <code>% 5</code> --&gt; <code>% 6</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475042212, "post_id": 39738865, "comment_id": 66775696, "body": "maybe <code>i&lt;arr_num</code> --&gt; <code>i&lt;=arr_num</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2861, "user_id": 1008115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Nmtel.jpg?s=128&g=1", "display_name": "PnotNP", "link": "https://stackoverflow.com/users/1008115/pnotnp"}, "reply_to_user": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "edited": false, "score": 0, "creation_date": 1475042043, "post_id": 39738921, "comment_id": 66775608, "body": "@aragaer how exactly?"}], "tags": [], "owner": {"reputation": 2861, "user_id": 1008115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Nmtel.jpg?s=128&g=1", "display_name": "PnotNP", "link": "https://stackoverflow.com/users/1008115/pnotnp"}, "is_accepted": false, "score": 0, "last_activity_date": 1475042006, "last_edit_date": 1475042006, "creation_date": 1475041540, "answer_id": 39738921, "question_id": 39738865, "link": "https://stackoverflow.com/questions/39738865/c-how-can-i-concatenate-an-array-of-strings-into-a-buffer/39738921#39738921", "title": "C - How can I concatenate an array of strings into a buffer?", "body": "<p>Update the buffer address after each print after initializing buffer with 0. </p>\n\n<pre><code>char temp_buffer[10000] = {0};\nfor (i=0; i&lt;arr_num; i++) //removed semicolon from here\n{\n    sprintf(temp_buffer + strlen(temp_buffer), \"%s\\n\", twinkle[i]);\n}\n</code></pre>\n\n<p><code>temp_buffer</code> should contain final output. Make sure you have enough buffer size</p>\n\n<p>You don't need <code>strcat</code></p>\n"}, {"comments": [{"owner": {"reputation": 231, "user_id": 6333557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/--1MSz4HvnpQ/AAAAAAAAAAI/AAAAAAAAACI/t7w7ELSEXCo/photo.jpg?sz=128", "display_name": "nanjero echizen", "link": "https://stackoverflow.com/users/6333557/nanjero-echizen"}, "edited": false, "score": 0, "creation_date": 1475041954, "post_id": 39738966, "comment_id": 66775561, "body": "Thanks for the clear answer. Unfortunately I am not using an IDE. I am using a linux vm machine and I am not a linux user so I am not sure how to use a debugger in linux console."}, {"owner": {"reputation": 231, "user_id": 6333557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/--1MSz4HvnpQ/AAAAAAAAAAI/AAAAAAAAACI/t7w7ELSEXCo/photo.jpg?sz=128", "display_name": "nanjero echizen", "link": "https://stackoverflow.com/users/6333557/nanjero-echizen"}, "edited": false, "score": 0, "creation_date": 1475042000, "post_id": 39738966, "comment_id": 66775593, "body": "will there be any consequence if I initialize temp_buffer anyway? Maybe I will initialize all arrays in the future just to be safe"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 231, "user_id": 6333557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/--1MSz4HvnpQ/AAAAAAAAAAI/AAAAAAAAACI/t7w7ELSEXCo/photo.jpg?sz=128", "display_name": "nanjero echizen", "link": "https://stackoverflow.com/users/6333557/nanjero-echizen"}, "edited": false, "score": 0, "creation_date": 1475042048, "post_id": 39738966, "comment_id": 66775610, "body": "@nanjeroechizen Not a problem. There&#39;s really only one debugger in the Linux world anyway, and it&#39;s the same that is used by the popular Linux IDE&#39;: GDB. Try running the command <code>gdb</code> or install the <code>gdb</code> package."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 231, "user_id": 6333557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/--1MSz4HvnpQ/AAAAAAAAAAI/AAAAAAAAACI/t7w7ELSEXCo/photo.jpg?sz=128", "display_name": "nanjero echizen", "link": "https://stackoverflow.com/users/6333557/nanjero-echizen"}, "edited": false, "score": 0, "creation_date": 1475042136, "post_id": 39738966, "comment_id": 66775648, "body": "@nanjeroechizen Regarding the initialization, it really depends on if the compiler can optimize it in any way, or if it calls e.g. <code>memset</code> automatically at the start of the function. It might incur a slight overhead for each call to your function. But for such a small array it won&#39;t be noticeable on modern multi-GHz computers."}, {"owner": {"reputation": 231, "user_id": 6333557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/--1MSz4HvnpQ/AAAAAAAAAAI/AAAAAAAAACI/t7w7ELSEXCo/photo.jpg?sz=128", "display_name": "nanjero echizen", "link": "https://stackoverflow.com/users/6333557/nanjero-echizen"}, "edited": false, "score": 0, "creation_date": 1475042160, "post_id": 39738966, "comment_id": 66775667, "body": "Thank you very much for the quick and concise answers. I will install and practice using debugger."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1475041766, "creation_date": 1475041766, "answer_id": 39738966, "question_id": 39738865, "link": "https://stackoverflow.com/questions/39738865/c-how-can-i-concatenate-an-array-of-strings-into-a-buffer/39738966#39738966", "title": "C - How can I concatenate an array of strings into a buffer?", "body": "<p>There are two problems: The first was found by BLUEPIXY and it's that your loop never does what you think it does. You would have found this out <em>very</em> easily if you just used a debugger to step through the code (please do that first in the future).</p>\n\n<p>The second problem is that contents of non-static local variables (like your <code>lyrics_buffer</code> is <em>indeterminate</em>. Using such variables without initialization leads to <em>undefined behavior</em>. The reason this happens is because the <code>strcat</code> function looks for the end of the destination string, and it does that by looking for the terminating <code>'\\0'</code> character. _If the contents of the destination string is indeterminate it will seem random, and the terminator may not be anywhere in the array.</p>\n\n<p>To initialize the array you simply do e.g.</p>\n\n<pre><code>char lyrics_buffer[10000] = { 0 };\n</code></pre>\n\n<p>That will make the compiler initialize it all to zero, which is what <code>'\\0'</code> is.</p>\n\n<p>This initialization is not needed for <code>temp_buffer</code> because <code>sprintf</code> unconditionally starts to write at the first location, it doesn't examine the content in any way. It does, in other words, initialize the buffer.</p>\n"}], "owner": {"reputation": 231, "user_id": 6333557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/--1MSz4HvnpQ/AAAAAAAAAAI/AAAAAAAAACI/t7w7ELSEXCo/photo.jpg?sz=128", "display_name": "nanjero echizen", "link": "https://stackoverflow.com/users/6333557/nanjero-echizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 39738966, "answer_count": 2, "score": 0, "last_activity_date": 1475042594, "creation_date": 1475041310, "question_id": 39738865, "link": "https://stackoverflow.com/questions/39738865/c-how-can-i-concatenate-an-array-of-strings-into-a-buffer", "title": "C - How can I concatenate an array of strings into a buffer?", "body": "<p>I am trying to concatenate a random number of lines from the song twinkle twinkle. Into the buffer before sending it out because I need to count the size of the buffer.</p>\n\n<p>My code:</p>\n\n<pre><code>char temp_buffer[10000];\nchar lyrics_buffer[10000];\nchar *twinkle[20];\nint arr_num;\nint i;\n\ntwinkle[0] = \"Twinkle, twinkle, little star,\";\ntwinkle[1] = \"How I wonder what you are!\";\ntwinkle[2] = \"Up above the world so high,\";\ntwinkle[3] = \"Like a diamond in the sky.\";\ntwinkle[4] = \"When the blazing sun is gone,\";\ntwinkle[5] = \"When he nothing shines upon,\";\n\nsrand(time(NULL));\narr_num = rand() % 5;\n\nfor (i=0; i&lt;arr_num; i++);\n{\n    sprintf(temp_buffer, \"%s\\n\", twinkle[i]);\n    strcat(lyrics_buffer, temp_buffer);\n}\n\nprintf(\"%s%d\\n\", lyrics_buffer, arr_num);\n</code></pre>\n\n<p>My current code only prints 1 line even when I get a number greater than 0.</p>\n"}, {"tags": ["c", "divide"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 8, "creation_date": 1475039902, "post_id": 39738578, "comment_id": 66774753, "body": "The error is because you don&#39;t have a <code>return;</code> statement after the <code>do-while</code> loop in your function . Do one thing  if value is not found <code>return</code> <code>0</code> after loop ends , so there won&#39;t be a check required and error would be resolved ."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1475040573, "post_id": 39738578, "comment_id": 66774992, "body": "There are a few mistakes."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1475041216, "post_id": 39738578, "comment_id": 66775236, "body": "&quot;the program might run forever without a return&quot; - that&#39;s not what the error means."}, {"owner": {"reputation": 1, "user_id": 5696299, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153849641694165/picture?type=large", "display_name": "Freddy Kong", "link": "https://stackoverflow.com/users/5696299/freddy-kong"}, "edited": false, "score": 0, "creation_date": 1475042509, "post_id": 39738578, "comment_id": 66775844, "body": "thanks for the hasty response, adding return 0 afterwards solved the issue.   i&#39;ve notice other issues in the program, but i think i can solve those myself! (was hard to troubleshoot when the program didnt run)  thank you for your help."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5696299, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153849641694165/picture?type=large", "display_name": "Freddy Kong", "link": "https://stackoverflow.com/users/5696299/freddy-kong"}, "edited": false, "score": 0, "creation_date": 1475437865, "post_id": 39739213, "comment_id": 66932462, "body": "hi, thanks for your help! that&#39;s what i thought too regarding the formula for mid, but that only works for the first instance.  all instances after (search left and right), i had to modify the code to       mid = ((max + min) / 2) + min"}, {"owner": {"reputation": 145, "user_id": 5762491, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/nqJ2d.jpg?s=128&g=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/5762491/suman-kumar"}, "reply_to_user": {"reputation": 1, "user_id": 5696299, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153849641694165/picture?type=large", "display_name": "Freddy Kong", "link": "https://stackoverflow.com/users/5696299/freddy-kong"}, "edited": false, "score": 0, "creation_date": 1475497813, "post_id": 39739213, "comment_id": 66952707, "body": "@FreddyKong On the basis of where the <code>value</code> will be, we are changing the value of <code>min</code> and <code>max</code>. At very first time min will be <code>(mid+min)&#47;2</code> i.e. (0+n)/2 and now suppose <code>value</code> you are searching is left side of <code>mid</code> then the <code>min</code> will be 0 and <code>max</code> will be <code>mid-1</code> and then calculate the mid formula is same <code>(max+min)&#47;2</code> only value of <code>max</code> is changes. Hope I am clear."}, {"owner": {"reputation": 1, "user_id": 5696299, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153849641694165/picture?type=large", "display_name": "Freddy Kong", "link": "https://stackoverflow.com/users/5696299/freddy-kong"}, "edited": false, "score": 0, "creation_date": 1475556261, "post_id": 39739213, "comment_id": 66977832, "body": "oh yes you&#39;re right. my formula was (max - min) / 2 + min. I think i&#39;ve over complicated things.  (max + min) / 2 + min is just plain wrong."}], "tags": [], "owner": {"reputation": 145, "user_id": 5762491, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/nqJ2d.jpg?s=128&g=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/5762491/suman-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1475042871, "creation_date": 1475042871, "answer_id": 39739213, "question_id": 39738578, "link": "https://stackoverflow.com/questions/39738578/divide-and-conquer-in-c-may-reach-end-of-non-void-function/39739213#39739213", "title": "Divide and Conquer in C, may reach end of non-void function", "body": "<p>Every branch of code should have a <code>return</code> if function suppose to return a value.\nIn your case after <code>while</code> you have to put a <code>return</code>. How ever, Your logic is also slightly wrong. In your code there is not any need of <code>sorted</code> variable and the terminating condition is also wrong as well as the way of calculating <code>mid</code> is also wrong. Don't worry here is your updated code:</p>\n\n<pre><code>bool search(int value, int values[], int n)\n{\n    //int sorted = 0;\n    int min = 0;\n    int max = n;\n    int mid = n / 2;  // S1\n\n    do\n    {\n        //mid=(max+min)/2;  // S2\n        //mid is value\n        if (value == values[mid])\n        {\n            //printf(\"value found!\");\n            //sorted = 1;\n            return 1;\n        }\n        //search right\n        else if (values[mid] &lt; value)\n        {\n            min = mid + 1;\n            mid = (max + min) / 2 ;  // S3\n        }\n        //search left\n        else if (values[mid] &gt; value)\n        {\n            max = mid - 1;\n            mid = (max + min) / 2;  //S4\n        }\n        // DNE\n        else\n        {\n            //printf(\"value not found\");\n            //sorted = 1;\n            return 0;\n        }\n    }\n    while(min!=max);\n    return 0;\n}\n</code></pre>\n\n<p>So if your function is returning <code>1</code> it mean value found otherwise value doesn't found.\nyou also can comment S1, S3 and S4 and uncomment S2 for minimum line of code.\nAnd the way of finding <code>mid</code> will be <code>mid=(max+min)/2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 0, "last_activity_date": 1475044570, "creation_date": 1475044570, "answer_id": 39739713, "question_id": 39738578, "link": "https://stackoverflow.com/questions/39738578/divide-and-conquer-in-c-may-reach-end-of-non-void-function/39739713#39739713", "title": "Divide and Conquer in C, may reach end of non-void function", "body": "<p>Ignoring other problems in your code (the loop will never terminate under certain conditions although I didn't study it too closely), let's just look at why the compiler complains, because it's quite interesting.</p>\n\n<p>Your compiler complains about that you don't have a return at the end of the function (pretty much what we can read from the warning message) after the while loop. You loop runs:</p>\n\n<pre><code>while(sorted == 0);\n</code></pre>\n\n<p>And everywhere you change <code>sorted</code>, you do this:</p>\n\n<pre><code>        sorted = 1;\n        return X;\n</code></pre>\n\n<p>So it is pretty obvious to you and me that the while condition will always be true and you won't fall out of the while loop and need a return after it. Every time you make the while condition not true, you also return immediately. But the compiler doesn't know that. It probably could figure it out with a little bit more effort, but it can never be written to know in all cases and you wouldn't accept a compiler that slow anyway. The problem of fully analyzing any arbitrary bit of code to know what you and I know (that we'll never fall out of the loop) is pretty much the halting problem (if you don't know what it is, you should, google it).</p>\n\n<p>In situations like this we need to work with the compiler and help it understand. I would add a <code>return sorted;</code> at the end of the function, change the loop condition to <code>while (1)</code> and replace <code>sorted = 1; return X;</code> with <code>sorted = X; break;</code> to break out of the loop and have the function return from just one place (it is much easier to read functions that have just one or very few return statements). Or just remove the <code>sorted</code> variable, do the returns properly and loop forever.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5773760, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BWP3xgOS4zM/AAAAAAAAAAI/AAAAAAAAALs/ab3OEAi1V0Y/photo.jpg?sz=128", "display_name": "Umair Ahmad", "link": "https://stackoverflow.com/users/5773760/umair-ahmad"}, "is_accepted": false, "score": 0, "last_activity_date": 1475050340, "last_edit_date": 1475050340, "creation_date": 1475046123, "answer_id": 39740217, "question_id": 39738578, "link": "https://stackoverflow.com/questions/39738578/divide-and-conquer-in-c-may-reach-end-of-non-void-function/39740217#39740217", "title": "Divide and Conquer in C, may reach end of non-void function", "body": "<p>I think your compiler doesn't like your understanding of <strong>Control Flow</strong>. As a beginner this is one of the most cringing problems.</p>\n\n<p><strong>Your error explained:</strong> <em>Control may reach end of non-void function.</em> Whenever you branch your code (i.e. use loops, if, switch etc) you have to explicitly write what each branch will do. So in your code, you must return a bool by any means necessary.</p>\n\n<blockquote>\n  <p>I am unable to discern where the error might be, it would be great if someone can show me.</p>\n</blockquote>\n\n<p>See we have two <code>return x;</code> statements, one in <code>if</code> block and second in <code>else</code> block. Now we think that  control should <code>return</code> from either of these blocks conveniently. But your compiler is <em>\"concerned\"</em> about what will happen if control didn't enter either of these blocks and loop ends. Moreover, what will happen after the loop, how can control ever <code>return</code> to main? Hence the error.</p>\n\n<p>Now what we can do to fix the problem is add a <code>return 0;</code> just before the end of the function. That will surely make the error disappear. However, there are better ways to solve this problem:</p>\n\n<pre><code>bool search(int value, int values[], int n) {\n    int min = 0, max = n;\n    int mid = n / 2;\n    bool is_found = 0;\n    while (min != max) {\n        if (value == values[mid]) {\n            is_found = 1;\n            break;\n        }\n        else if (value &gt; values[mid]) {\n            min = mid + 1;\n            mid = (max + min) / 2;\n        }\n        else if (value &lt; values[mid]) {\n            max = mid - 1;\n            mid = (max + min) / 2;\n        }\n        else break;\n    }\n    return is_found;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5696299, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153849641694165/picture?type=large", "display_name": "Freddy Kong", "link": "https://stackoverflow.com/users/5696299/freddy-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1475050340, "creation_date": 1475039840, "last_edit_date": 1475044450, "question_id": 39738578, "link": "https://stackoverflow.com/questions/39738578/divide-and-conquer-in-c-may-reach-end-of-non-void-function", "title": "Divide and Conquer in C, may reach end of non-void function", "body": "<p>I am trying to get this divide and conquer to work, but the compiler is giving me:</p>\n\n<blockquote>\n  <p>control may reach end of non-void function</p>\n</blockquote>\n\n<p>I have read through similar scenarios, and understand the error implies the program might run forever without a return. I have reviewed some scenarios, which were resolved by using \"else\" instead of \"if else\" (as you should to begin with). However, that didn't help. </p>\n\n<p>I am aware that using a do while loop and return in this scenario is redundant, I was fiddling with it in hopes to trick the compiler.</p>\n\n<p>Where is the error?</p>\n\n<pre><code>bool search(int value, int values[], int n)\n{\n    int sorted = 0;\n    int min = 0;\n    int max = n;\n    int mid = n / 2;\n\n    do\n    {\n        //mid is value\n        if (value == values[mid])\n        {\n            printf(\"value found!\");\n            sorted = 1;\n            return 1;\n        }\n        //search right\n        else if (values[mid] &lt; value)\n        {\n            min = mid + 1;\n            mid = (max - mid) / 2 ;\n        }\n        //search left\n        else if (values[mid] &gt; value)\n        {\n            max = mid - 1;\n            mid = (max - mid) / 2;\n        }\n        // DNE\n        else\n        {\n            printf(\"value not found\");\n            sorted = 1;\n            return 0;\n        }\n    }\n    while(sorted == 0);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 5, "creation_date": 1475039384, "post_id": 39738497, "comment_id": 66774561, "body": "By not using larger values than the types can handle."}, {"owner": {"reputation": 244, "user_id": 1791840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24982152015db606796091557c43431e?s=128&d=identicon&r=PG", "display_name": "Jun Yuan", "link": "https://stackoverflow.com/users/1791840/jun-yuan"}, "edited": false, "score": 0, "creation_date": 1475039717, "post_id": 39738497, "comment_id": 66774688, "body": "Either change (unsigned char y2) to int, or avoid using a number that&#39;s greater than max value of unsigned char"}, {"owner": {"reputation": 34061, "user_id": 616460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yiloe.png?s=128&g=1", "display_name": "Jason C", "link": "https://stackoverflow.com/users/616460/jason-c"}, "edited": false, "score": 0, "creation_date": 1475039808, "post_id": 39738497, "comment_id": 66774721, "body": "What did you expect, trying to convert 319 to <a href=\"https://www.tutorialspoint.com/cprogramming/c_data_types.htm\" rel=\"nofollow noreferrer\">an <code>unsigned char</code></a>?"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1475040124, "post_id": 39738497, "comment_id": 66774846, "body": "Since we are dealing with <code>unsigned char</code>s, the value would be &quot;wrapped&quot;."}, {"owner": {"reputation": 71, "user_id": 6891559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lvbdtxjBuoM/AAAAAAAAAAI/AAAAAAAAAJ4/gCyxj6i5GAQ/photo.jpg?sz=128", "display_name": "Sha", "link": "https://stackoverflow.com/users/6891559/sha"}, "edited": false, "score": 0, "creation_date": 1475040128, "post_id": 39738497, "comment_id": 66774848, "body": "Then what will be the possible method to pass 319 to that function?"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1475040646, "post_id": 39738662, "comment_id": 66775012, "body": "Or pass a smaller value (e.g. 255 instead of 319)."}, {"owner": {"reputation": 71, "user_id": 6891559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lvbdtxjBuoM/AAAAAAAAAAI/AAAAAAAAAJ4/gCyxj6i5GAQ/photo.jpg?sz=128", "display_name": "Sha", "link": "https://stackoverflow.com/users/6891559/sha"}, "edited": false, "score": 0, "creation_date": 1475055644, "post_id": 39738662, "comment_id": 66783954, "body": "After changing it to unsigned short. It looks fine. void Address_set(unsigned short x1,unsigned short y1,unsigned short x2,unsigned short y2)"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1475040242, "creation_date": 1475040242, "answer_id": 39738662, "question_id": 39738497, "link": "https://stackoverflow.com/questions/39738497/warning-message-large-integer-implicitly-truncated-to-unsigned-type-woverflow/39738662#39738662", "title": "Warning message: large integer implicitly truncated to unsigned type [-Woverflow]", "body": "<p>The range of <code>unsigned char</code> is [0 ... 255], the value 319 is truncated (wrap-around) to <code>319 % 256 = 63</code></p>\n\n<blockquote>\n  <p>How to avoid this warning.</p>\n</blockquote>\n\n<p>The value is still truncated even if you can avoid this warning using a cast:</p>\n\n<pre><code>Address_set(0,0,239,(unsigned char)319);\n</code></pre>\n\n<p>Use a longer type, i.e: <code>unsigned short</code></p>\n"}], "owner": {"reputation": 71, "user_id": 6891559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lvbdtxjBuoM/AAAAAAAAAAI/AAAAAAAAAJ4/gCyxj6i5GAQ/photo.jpg?sz=128", "display_name": "Sha", "link": "https://stackoverflow.com/users/6891559/sha"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36567, "favorite_count": 1, "closed_date": 1475040594, "answer_count": 1, "score": 3, "last_activity_date": 1475046515, "creation_date": 1475039335, "last_edit_date": 1475046515, "question_id": 39738497, "link": "https://stackoverflow.com/questions/39738497/warning-message-large-integer-implicitly-truncated-to-unsigned-type-woverflow", "closed_reason": "Duplicate", "title": "Warning message: large integer implicitly truncated to unsigned type [-Woverflow]", "body": "<p>Written a function with <code>unsigned char</code> arguments as shown below</p>\n\n<pre><code>void Address_set(unsigned char x1,unsigned char y1,unsigned char x2,unsigned char y2)\n</code></pre>\n\n<p>The above function is called in <code>main()</code> function of C Code as</p>\n\n<pre><code>Address_set(0,0,239,319);\n</code></pre>\n\n<p>I received a warning as </p>\n\n<p>large integer implicitly truncated to <code>unsigned type [-Woverflow]</code></p>\n\n<p>How to avoid this warning.</p>\n"}, {"tags": ["c", "for-loop", "mips"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1475039455, "post_id": 39738415, "comment_id": 66774585, "body": "What is your actual question? Hint: question should normally have a question mark at the end, especially in a QA site like this :-)"}, {"owner": {"reputation": 1, "user_id": 6053113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df561de9fbb4dff648f98ab4ea702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nuf", "link": "https://stackoverflow.com/users/6053113/nuf"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1475039789, "post_id": 39738415, "comment_id": 66774711, "body": "I added a question mark but let me know if you need more of an explanation"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6053113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df561de9fbb4dff648f98ab4ea702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nuf", "link": "https://stackoverflow.com/users/6053113/nuf"}, "edited": false, "score": 0, "creation_date": 1475040358, "post_id": 39738557, "comment_id": 66774919, "body": "So i would  <code>addi $t0, 5</code> in my code and than a <code>lw</code> to load it?"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "reply_to_user": {"reputation": 1, "user_id": 6053113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df561de9fbb4dff648f98ab4ea702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nuf", "link": "https://stackoverflow.com/users/6053113/nuf"}, "edited": false, "score": 0, "creation_date": 1475042051, "post_id": 39738557, "comment_id": 66775611, "body": "The instruction <code>lw $t7,  0($t5)</code> goes to zero offsets / bytes ahead of the number (which should be a valid address) contained in <code>$t5</code> and loads the  <code>word</code> at that address in <code>$t7</code> - that is not what you want. You want to add <code>5</code> to the register which has the value of <code>c[i]</code>, to do that you need to use <code>addi</code>. HTH."}], "tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": false, "score": 1, "last_activity_date": 1475039722, "creation_date": 1475039722, "answer_id": 39738557, "question_id": 39738415, "link": "https://stackoverflow.com/questions/39738415/converting-a-c-to-mips/39738557#39738557", "title": "converting a C to MIPS", "body": "<p><code>5</code> is a constant number here. Doing something like <code>lw $t7, 0($t5)</code> will not not load <code>$t7</code> with <code>5</code> unless the address (word to be exact) zero offsets from <code>$t5</code> has a <code>5</code> in it (and you have not stored <code>5</code> at the said location in your code). </p>\n\n<p>If you want to add the constant <code>5</code> to a register (say <code>$t0</code>) why not do <code>addi $t0, 5</code>?</p>\n"}], "owner": {"reputation": 1, "user_id": 6053113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df561de9fbb4dff648f98ab4ea702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nuf", "link": "https://stackoverflow.com/users/6053113/nuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475039722, "creation_date": 1475038914, "last_edit_date": 1475039665, "question_id": 39738415, "link": "https://stackoverflow.com/questions/39738415/converting-a-c-to-mips", "title": "converting a C to MIPS", "body": "<p>I'm trying to make this C code translated directly to mips, without modifying any instructions:</p>\n\n<pre><code>  for (i=0; i&lt;128; i++)\n\n           { a[i] = b[i] - c[i] + 5; }\n</code></pre>\n\n<p>I'm just trying to understand some things. Here what I have so far </p>\n\n<pre><code>add $t4, $zero, $zero    # I1 i is initialized to 0, $t4 = 0\nLoop:\nadd $t5, $t4, $t1        # I2 temp reg $t5 = address of b[i]\nlw $t6, 0($t5)          # I3 temp reg $t6 = b[i]\nadd $t5, $t4, $t2        # I4 temp reg $t5 = address of c[i]\nlw $t7, 0($t5)          # I5 temp reg $t7 = c[i] + 5\nsub $t6, $t6, $t7        # I6 temp reg $t6 = b[i] - c[i] + 5\nadd $t5, $t4, $t0        # I7 temp reg $t5 = address of a[i]\nsw $t6, 0($t5)          # I8 a[i] = b[i] - c[i] + 5 \naddi $t4, $t4, 4            # I9 i = i + 1\nslti $t5, $t4, 256      # I10 $t5 = 1 if $t4 &lt; 128, i.e. i &lt; 10\nbne $t5, $zero, Loop        # I11 go to Loop if $t4 &lt; 128\nexit:\n</code></pre>\n\n<p>I not sure if I need to load 5 by itself or if its ok the way that I have it where it loads with c[i]? Any tips would be helpful since I'm still trying to learn mips. Thanks!</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "edited": false, "score": 0, "creation_date": 1475038658, "post_id": 39738210, "comment_id": 66774346, "body": "you can try fread. size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475043393, "post_id": 39738210, "comment_id": 66776283, "body": "<code>if (j + 1 == col) printf(&quot;\\n&quot;);</code> is wong. <code>j</code> isn&#39;t number of column."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475195296, "post_id": 39738210, "comment_id": 66857935, "body": "from the man page for fscanf():   On success, these functions return the number of input  items  success\u2010        fully  matched  and  assigned;  this can be fewer than provided for, or        even zero, in the event of an early matching failure.         The value EOF is returned if the end of input is reached before  either        the  first  successful conversion or a matching failure occurs.  EOF is        also returned if a read error occurs, in which case the error indicator        for the stream (see ferror(3)) is set, and errno is set to indicate the        error."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475195763, "post_id": 39738210, "comment_id": 66858055, "body": "in general the posted code logic is quite &#39;iffy&#39; as it assumes that each line of the input contains the same number of columns.  the posted code assumes that each column is the same width.  The posted code assumes that each line has the same number of columns.   None of these assumptions are backed by the question text."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475195835, "post_id": 39738210, "comment_id": 66858073, "body": "the expression: <code>sizeof(char)</code> is defined in the C standard as 1. Multiplying by 1 has no effect. Suggest removing that expression from this line: <code>jz[i] = malloc(col * keyLength*sizeof(char));</code> and any other line where this expression is being used."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 5660949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966cfbd35ce07b0e3b69b34dcf191e1a?s=128&d=identicon&r=PG&f=1", "display_name": "sav_a", "link": "https://stackoverflow.com/users/5660949/sav-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1475044043, "creation_date": 1475044043, "answer_id": 39739539, "question_id": 39738210, "link": "https://stackoverflow.com/questions/39738210/how-to-store-fixed-length-string-in-c/39739539#39739539", "title": "How to store fixed length string in c", "body": "<p>simple example of reading from file with fgets()   </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define LINE_LENGTH 6\n\nint main(int argc, char** argv)\n{\n  int i = 0;\n  FILE *file_ptr;\n  char *string=(char*)calloc(LINE_LENGTH,sizeof(char));\n\n  file_ptr = fopen(\"file.txt\", \"r\");\n\n  while(1)\n    {\n      if(fgets(string, LINE_LENGTH, file_ptr) == NULL)\n         break;\n      fgetc(file_ptr);\n      printf(\"\\nline[%d] = %s\\n\", i+1, string);\n      i++;\n    }\n\n  fclose(file_ptr);\n\n  return 0;\n}\n</code></pre>\n\n<p>file.txt</p>\n\n<pre><code>12344 45678 99870 33389 11234\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1475088102, "creation_date": 1475088102, "answer_id": 39755317, "question_id": 39738210, "link": "https://stackoverflow.com/questions/39738210/how-to-store-fixed-length-string-in-c/39755317#39755317", "title": "How to store fixed length string in c", "body": "<p>When <code>row</code> and <code>col</code> are determined<br>\nallocate by following way:</p>\n\n<pre><code>char (*jz)[col][keyLength] = malloc(row * col * keyLength);//meant char jz[row][col][keyLength]\n</code></pre>\n\n<p>Read from a file: </p>\n\n<pre><code>for(i = 0; i &lt; row; ++i){\n    for(j = 0; j &lt; col; ++j){\n        fscanf(fp, \"%s\", jz[i][j]);\n    }\n}\n</code></pre>\n\n<p>Print the matrix:</p>\n\n<pre><code>for(i = 0; i &lt; row; ++i){\n    for(j = 0; j &lt; col; ++j){\n        if(j)\n            putchar(' ');\n        printf(\"%s\", jz[i][j]);\n    }\n    putchar('\\n');\n}\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 4753664, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/831060370294066/picture?type=large", "display_name": "bslqy", "link": "https://stackoverflow.com/users/4753664/bslqy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 39739539, "answer_count": 2, "score": 2, "last_activity_date": 1475088102, "creation_date": 1475037810, "question_id": 39738210, "link": "https://stackoverflow.com/questions/39738210/how-to-store-fixed-length-string-in-c", "title": "How to store fixed length string in c", "body": "<p>I would like to read some fixed length string in a text file and store them in an array. \nThe way I read the strings is by fscanf(fp,\"%c\",&amp;char[]);</p>\n\n<p>However, as the data are seperated by white space, I would like the array index to indicate each string instead of each character.</p>\n\n<p>How would I do that? Should I use <code>fgets()</code> with certain length instead of <code>fgetc()</code>?\nThanks</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#define MAX 1000000  //one row of double = sizeof(Double) *4400\n#define keyLength  15\n\n\nvoid readKey(char* fileName)\n{\n    FILE *fp;\n    int i, j;\n    char  ch;\n\n\n    if ((fp = fopen(fileName, \"r\")) == NULL) {\n    printf(\"can not open this file!\\n\");\n    exit(1);\n    }\n\n  int row = 0;\n  while ((ch = fgetc(fp)) != EOF)\n  {\n    if (ch == '\\n')\n    row++;\n  }   //Count the line\n\n  rewind(fp); //Going back to the head of the matrix\n\n  int col = 0;\n  while ((ch = fgetc(fp)) != '\\n') //(ch=fgetc(fp))!='\\n'&amp;&amp;(ch=fgetc(fp))!='\\r'\n  {\n    if (ch == ' ')\n        col++;\n  }\n  col++; //Count the col\n\n  char** jz = malloc(row * sizeof(char*)); //Allocate spaces\n  for (i = 0; i &lt; row; i++)\n    jz[i] = malloc(col * keyLength*sizeof(char));\n\n  rewind(fp);\n\n  for (i = 0; i &lt; row; i++) //Read in the data\n    for (j = 0; j &lt; col * keyLength; j++) {\n      if (!fscanf(fp, \"%c\", &amp;jz[i][j])) {\n        break;\n      }\n    }\n\n//Print the matrix\n  for (i = 0; i &lt; row; i++)\n    for (j = 0; j &lt; col * keyLength; j++) {\n      printf(\"%c\", jz[i][j]);\n      if (j + 1 == col) printf(\"\\n\");\n    }\n  fclose(fp);\n\n  printf(\"%d row, %d  col \",row,col);\n\n}\n\n\n\n int main(void) {\n\nreadKey(\"keys.txt\");\n\n}\n</code></pre>\n\n<p>I print the matrix to check if the scanning is successful.\n<a href=\"https://i.stack.imgur.com/equ6R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/equ6R.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/JvgCy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JvgCy.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475038979, "post_id": 39738163, "comment_id": 66774430, "body": "I think 2nd <code>fflush(stdin)</code> unnecessary ."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1475041857, "post_id": 39738163, "comment_id": 66775524, "body": "<a href=\"http://stackoverflow.com/questions/35356322/difference-between-int-and-char-in-getchar-fgetc-and-putchar-fputc\"><code>getchar</code> returns an <b>int</b></a>"}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1491097852, "post_id": 39738163, "comment_id": 73402318, "body": "@BLUEPIXY it shouldn&#39;t be used at all! It&#39;s UB."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": -1, "last_activity_date": 1475038051, "last_edit_date": 1495540922, "creation_date": 1475038051, "answer_id": 39738251, "question_id": 39738163, "link": "https://stackoverflow.com/questions/39738163/usage-of-getchar-and-fflushstdin/39738251#39738251", "title": "Usage of getchar() and fflush(stdin)", "body": "<p>The problem occurs when you scan a character using <code>scanf(\"%c\", &amp;repeat);</code>  Generally a user will enter the character 'y' or 'n' and then press enter. The character is read into the <code>repeat</code> variable, but the enter character (\\n) remains in the buffer. </p>\n\n<p>When you try to read the character again, in the loop, you will read this <code>\\n</code> not a 'y' or 'n' as you expect.</p>\n\n<p>The solution for this is to change the scanf statement to </p>\n\n<pre><code>scanf(\" %c\", &amp;repeat);\n</code></pre>\n\n<p>The space character in fromt of the %c will read any whitespace character and only store the 'y' or 'n' in repeat. In this case, you will not need fflush.</p>\n\n<p><code>fflush(stdin)</code> is not a good practice. For more information you should look at <a href=\"https://stackoverflow.com/questions/2979209/using-fflushstdin\">Using fflush(stdin)</a></p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 5504102, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/52199c9737d34ecb2f4f8ff15fce9dbb?s=128&d=identicon&r=PG&f=1", "display_name": "12johnny", "link": "https://stackoverflow.com/users/5504102/12johnny"}, "edited": false, "score": 0, "creation_date": 1475038446, "post_id": 39738256, "comment_id": 66774282, "body": "hi but if i assign ch = getchar() and use while (ch != &#39;\\n&#39;), it does not work as well"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 61, "user_id": 5504102, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/52199c9737d34ecb2f4f8ff15fce9dbb?s=128&d=identicon&r=PG&f=1", "display_name": "12johnny", "link": "https://stackoverflow.com/users/5504102/12johnny"}, "edited": false, "score": 0, "creation_date": 1475038593, "post_id": 39738256, "comment_id": 66774330, "body": "@12johnny, <code>while ( (ch = getchar()) != &#39;\\n&#39; )</code> does two things. It assigns the character read from <code>stdin</code> to <code>ch</code> and stops the loop if the value of <code>ch</code> is <code>&#39;\\n&#39;</code>. You need both of them in your code."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1475041961, "post_id": 39738256, "comment_id": 66775572, "body": "<code>fflush</code> on input streams is defined by POSIX 2008."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1475042092, "post_id": 39738256, "comment_id": 66775629, "body": "@AnttiHaapala, if you can provide a link, I will happy to update my answer."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1475042143, "post_id": 39738256, "comment_id": 66775654, "body": "the link is in your answer already (though it doesn&#39;t say that this is 2008, but not 2001)."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1475042585, "last_edit_date": 1475042585, "creation_date": 1475038110, "answer_id": 39738256, "question_id": 39738163, "link": "https://stackoverflow.com/questions/39738163/usage-of-getchar-and-fflushstdin/39738256#39738256", "title": "Usage of getchar() and fflush(stdin)", "body": "<blockquote>\n  <p>why cant I use <code>while (getchar() != '\\n')</code> instead of assigning it to a variable <code>ch</code></p>\n</blockquote>\n\n<p>If you do that, you won't be able to use the value returned by <code>getchar()</code> in the block of code in the <code>while</code> statement: the <code>if</code> statements, the <code>else if</code> statement, the <code>switch</code> statement.</p>\n\n<blockquote>\n  <p>why <code>fflush(stdin)</code> must be used?</p>\n</blockquote>\n\n<p><code>fflush</code> is meant to be used for output streams, not input streams. Hence, <code>fflush(stdin)</code> is undefined behavior. See <a href=\"http://en.cppreference.com/w/cpp/io/c/fflush\" rel=\"nofollow\">http://en.cppreference.com/w/cpp/io/c/fflush</a><sup>1</sup>.</p>\n\n<p>It seems that the intent of <code>fflush(stdin)</code> in your code is to read and discard everything until the end of the line. Write a function to do that.</p>\n\n<pre><code>void readAndDiscardRestOfLine(FILE* in)\n{\n   int c;\n   while ( (c = fgetc(in)) != EOF &amp;&amp; c != '\\n');\n}\n</code></pre>\n\n<p>and use </p>\n\n<pre><code>readAndDiscardRestOfLine(stdin);\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>fflush(stdin);\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup>POSIX extends the definition of <code>fflush</code> for input streams. However, it extends them only to seekable devices. The extension does not apply to <code>stdin</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 5504102, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/52199c9737d34ecb2f4f8ff15fce9dbb?s=128&d=identicon&r=PG&f=1", "display_name": "12johnny", "link": "https://stackoverflow.com/users/5504102/12johnny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2532, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475042585, "creation_date": 1475037536, "last_edit_date": 1475038464, "question_id": 39738163, "link": "https://stackoverflow.com/questions/39738163/usage-of-getchar-and-fflushstdin", "title": "Usage of getchar() and fflush(stdin)", "body": "<p>I am supposed to come up with a program to calculate the number of words, vowels, lowercase letters and alphabetic letters for an assignment.</p>\n\n<p>And I have two questions, why cant I use <code>while (getchar() != '\\n')</code> instead of assigning it to a variable <code>ch</code> and why <code>fflush(stdin)</code> must be used???</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;ctype.h&gt;\n\n    int main(void)\n    {\n\n        char ch, repeat;\n        int numVowel = 0, numLower = 0, numAlpha = 0, numWords = 0, inWord = 0;\n\n        // Tells user what the program does\n        printf(\"This program prompts a user to enter a piece of text and\\ncalculates the number of alphabetic letters, lowercase letters, \\nvowels and words in that piece of text.\\n\\n\");\n\n\n        do\n        {\n             printf(\"Type the text here (hit \\\"Enter\\\" to end): \");  \n\n             while ((ch = getchar()) != '\\n')         //*dont understand this part*\n            {\n                    if (ch == ' ')                             \n                        inWord = 0;\n\n            else if (inWord == 0 &amp;&amp; isalpha(ch))     \n            {                                       \n                inWord = 1;\n                numWords += 1;\n            }\n\n            if (isalpha(ch))             \n                numAlpha += 1;\n\n            if (islower(ch))             \n                numLower += 1;\n\n            switch(ch)                   \n            {\n                case 'a':\n                case 'A':\n                case 'e':\n                case 'E':\n                case 'i':\n                case 'I':\n                case 'o':\n                case 'O':\n                case 'u':\n                case 'U': numVowel += 1;\n                          break;\n            }\n        }\n\n        printf(\"\\nNumber of alphabetical letters: %-4d\\n\", numAlpha);\n        printf(\"Number of lowercase letters   : %-4d\\n\", numLower);\n        printf(\"Number of vowels              : %-4d\\n\", numVowel);\n        printf(\"Number of words               : %-4d\\n\\n\", numWords);\n\n        do\n        {\n            printf(\"Do you want to try again? (Y/N): \");\n\n            scanf(\"%c\", &amp;repeat);\n            repeat = toupper(repeat);\n            if (repeat != 'Y' &amp;&amp; repeat != 'N')         \n                printf(\"Invalid answer. Please enter 'Y' or 'N'.\\n\\n\");\n            fflush(stdin);               //*why is this required?*               \n\n        } while (repeat != 'N' &amp;&amp; repeat != 'Y');       \n\n        printf(\"\\n\");\n        fflush(stdin);                   //*why is this required?*\n        numVowel = 0, numLower = 0, numAlpha = 0, numWords = 0, inWord = 0;  \n\n    } while (repeat == 'Y');           \n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc", "stack-overflow", "buffer-overflow"], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1475036795, "post_id": 39738016, "comment_id": 66773811, "body": "And of course, the point of this is to foil exactly the kind of attack the OP contemplates.  The widespread availability of this feature makes such attacks much less viable than once they were."}, {"owner": {"reputation": 163, "user_id": 6891327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fa5c2a504d2686f897a23457eb8b01?s=128&d=identicon&r=PG&f=1", "display_name": "nrabbit", "link": "https://stackoverflow.com/users/6891327/nrabbit"}, "edited": false, "score": 0, "creation_date": 1475111353, "post_id": 39738016, "comment_id": 66815540, "body": "I used execstack both with gcc <code>-z execstack</code> and using <code>sudo execstack -s vuln</code> and verified that the GNU stack was set to RWE (read, write execute) with <code>readelf -l vuln</code> and I still get similar errors. Thoughts as to what I&#39;m doing wrong? I did notice that the amount I need to overflow the buffer with is more than 108 bytes, but rather 116 bytes."}, {"owner": {"reputation": 1100, "user_id": 3693388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o5lGj.jpg?s=128&g=1", "display_name": "Stewart Smith", "link": "https://stackoverflow.com/users/3693388/stewart-smith"}, "reply_to_user": {"reputation": 163, "user_id": 6891327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fa5c2a504d2686f897a23457eb8b01?s=128&d=identicon&r=PG&f=1", "display_name": "nrabbit", "link": "https://stackoverflow.com/users/6891327/nrabbit"}, "edited": false, "score": 0, "creation_date": 1475111882, "post_id": 39738016, "comment_id": 66815624, "body": "@nrabbit I don&#39;t have time to do it now, but will experiment on my machine and get back to you."}, {"owner": {"reputation": 1100, "user_id": 3693388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o5lGj.jpg?s=128&g=1", "display_name": "Stewart Smith", "link": "https://stackoverflow.com/users/3693388/stewart-smith"}, "reply_to_user": {"reputation": 163, "user_id": 6891327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fa5c2a504d2686f897a23457eb8b01?s=128&d=identicon&r=PG&f=1", "display_name": "nrabbit", "link": "https://stackoverflow.com/users/6891327/nrabbit"}, "edited": false, "score": 0, "creation_date": 1475124673, "post_id": 39738016, "comment_id": 66818623, "body": "@nrabbit It appeared to be working on by machine. I added details about debugging buffer overflow attempts."}, {"owner": {"reputation": 163, "user_id": 6891327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fa5c2a504d2686f897a23457eb8b01?s=128&d=identicon&r=PG&f=1", "display_name": "nrabbit", "link": "https://stackoverflow.com/users/6891327/nrabbit"}, "edited": false, "score": 0, "creation_date": 1475181464, "post_id": 39738016, "comment_id": 66853377, "body": "Thanks @sdsmith, I&#39;ll mess around with it some more in GDB and see if possibly my shellcode is messed up."}, {"owner": {"reputation": 163, "user_id": 6891327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fa5c2a504d2686f897a23457eb8b01?s=128&d=identicon&r=PG&f=1", "display_name": "nrabbit", "link": "https://stackoverflow.com/users/6891327/nrabbit"}, "edited": false, "score": 1, "creation_date": 1475200542, "post_id": 39738016, "comment_id": 66859132, "body": "I finally figured out the issue. GCC was aligning my instructions and variables to 16-byte boundaries. As such, it was adding assembly instructions i.e. <code>lea ecx,[esp+0x4]</code> etc. at the prologue and similar on the function epilogue which shifted the stack pointer around a bit and was messing around with the layout of the stack."}], "tags": [], "owner": {"reputation": 1100, "user_id": 3693388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o5lGj.jpg?s=128&g=1", "display_name": "Stewart Smith", "link": "https://stackoverflow.com/users/3693388/stewart-smith"}, "is_accepted": true, "score": 4, "last_activity_date": 1475124618, "last_edit_date": 1492086984, "creation_date": 1475036634, "answer_id": 39738016, "question_id": 39737813, "link": "https://stackoverflow.com/questions/39737813/disabling-stack-protection-in-gcc-not-working/39738016#39738016", "title": "Disabling stack protection in GCC not working", "body": "<p>Linux follows the <a href=\"https://en.wikipedia.org/wiki/W%5EX\" rel=\"nofollow noreferrer\">W^X</a> principle: it marks memory pages as non-executable unless they are part of the code section. This goes beyond the scope of your compiled application, and for good reason. The OS assumes this responsibility to defend against buffer overflow attacks from any program executed on the system; especially programs that are actively attempting to perform a buffer overflow attacks, like yours.</p>\n\n<p>You are attempting to write code on the stack via <code>buf</code> and overwrite the function's return address to jump execution into the newly injected code. When the function returns, the program counter is set to the overridden return address, which now points to stack memory. The <code>SIGSEGV</code> is thrown when the program counter attempts to execute the next instruction due to the revoked execute permissions on stack memory pages. </p>\n\n<p>To execute from the stack, the OS stack protection must be disabled. </p>\n\n<p>Fortunately Linux provides <a href=\"https://linux.die.net/man/8/execstack\" rel=\"nofollow noreferrer\">execstack</a> for such a case to be used at the discretion of the user.</p>\n\n<p>See <a href=\"https://unix.stackexchange.com/questions/66802/disable-stack-protection-on-ubuntu-for-buffer-overflow-without-c-compiler-flags\">this</a> Unix &amp; Linux Stack Exchange post for more general information.</p>\n\n<hr>\n\n<p><strong>Debugging Injected Data</strong></p>\n\n<p>If you are getting a <code>SIGSEGV</code> in gdb, it probably means that there is some error in your buffer overrun attempt. To avoid messing with the clean-up at the end of <code>main</code>, I would suggest making a function that you call from main to do your buffer overrun:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar injection_code[] = \"\"; // buffer overrun data here\n\n\nvoid foo () {\n    char buf[100];\n\n    // memcpy used to copy the full injection string, including any nested 0s\n    memcpy(buf, injection_code, 108); // +8 here to handle 64-bit system RAs\n}\n\nint main (int argc, char** argv) {\n    foo();\n    printf(\"Done!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Use GDB to debug. I suggest putting a break point at the end of <code>foo</code> and checking the registers line up with what you'd expect with <code>info registers</code>. You'll probably be most interested in the instruction pointer, which you can check with <code>info registers rip</code> (64-bit) or <code>info registers eip</code> (32-bit).</p>\n\n<p>You can explore what the stack looks like by using <code>print</code> or <a href=\"http://visualgdb.com/gdbreference/commands/x\" rel=\"nofollow noreferrer\"><code>x/x</code></a> in GDB. For instance, you can check <code>$rbp+8</code> to see what the return address (RA) is on the stack. </p>\n\n<p>GDB will <code>SIGSEGV</code> on the <code>ret</code> instruction if the RA points to an invalid location:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x00000000004005bc in foo () at bufferoverflow.c:27\n</code></pre>\n\n<p>You can check to see if it faulted on the <code>ret</code> instruction by checking the instruction pointer address at the time of fault (in the example above, it would be <code>0x00000000004005bc</code>) against the program's assembly (use <code>disassemble function_name</code> in GDB).</p>\n\n<p>If the return address points back in the stack, it may throw a <code>SIGILL</code> for an illegal instruction, which means your return address may not be aligned properly, or your injected instructions are is malformed:</p>\n\n<pre><code>Program received signal SIGILL, Illegal instruction.\n0x00007fffffffdc13 in ?? ()\n</code></pre>\n\n<p>Again, you can use GDB to explore your stack to see why.</p>\n\n<p>GDB is useful for getting the structure of the buffer overflow correct.\nOnce it works as intended however, remember that memory addresses may be shifted when executed outside of GDB, especially if you compile without the debug flag (<code>-g</code>). You will have to play around with the return address a little bit to get it where you want it in a 'live' environment.</p>\n\n<hr>\n\n<p><strong>An Aside</strong></p>\n\n<p>In general, buffer overflow attacks that directly run injected code are <em>generally</em> not feasible with today's stack protection mechanisms. Normally there needs to be additional vulnerabilities present to be able to execute arbitrary code.</p>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 6891327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fa5c2a504d2686f897a23457eb8b01?s=128&d=identicon&r=PG&f=1", "display_name": "nrabbit", "link": "https://stackoverflow.com/users/6891327/nrabbit"}, "is_accepted": false, "score": 1, "last_activity_date": 1475200607, "creation_date": 1475200607, "answer_id": 39782528, "question_id": 39737813, "link": "https://stackoverflow.com/questions/39737813/disabling-stack-protection-in-gcc-not-working/39782528#39782528", "title": "Disabling stack protection in GCC not working", "body": "<p>I finally figured out the issue. GCC was aligning my instructions and variables to 16-byte boundaries. As such, it was adding assembly instructions i.e. <code>lea ecx,[esp+0x4]</code> etc. at the prologue and similar on the function epilogue which shifted the stack pointer around a bit and was messing around with the layout of the stack. I recompiled with <code>-mpreferred-stack-boundary=2</code> which fixed the issue in GDB. Now I just need to play with those return addresses like you mentioned. Thanks!!</p>\n"}], "owner": {"reputation": 163, "user_id": 6891327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fa5c2a504d2686f897a23457eb8b01?s=128&d=identicon&r=PG&f=1", "display_name": "nrabbit", "link": "https://stackoverflow.com/users/6891327/nrabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5354, "favorite_count": 2, "accepted_answer_id": 39738016, "answer_count": 2, "score": 3, "last_activity_date": 1475200607, "creation_date": 1475035206, "question_id": 39737813, "link": "https://stackoverflow.com/questions/39737813/disabling-stack-protection-in-gcc-not-working", "title": "Disabling stack protection in GCC not working", "body": "<p>I'm trying to recreate a stack buffer overflow using the classic overflow with strcpy using this function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nvoid main(int argc, char **argv) {\n    char buf[100];\n    strcpy(buf,argv[1]);\n    printf(\"Done!\\n\");\n}\n</code></pre>\n\n<p>I have tried compiling with all the various flags in order to remove the stack protection <code>gcc -o vuln vuln.c -fno-stack-protector -g -z execstack</code> as well as removing ASLR with <code>sudo echo 0 &gt; /proc/sys/kernel/randomize_va_space</code>.</p>\n\n<p>I can get my nop-shellcode-address to overwrite the saved EIP but it crashes on the RET. I figured out to disable SIGSEGV in gdb with <code>HANDLE SIGSEGV ignore</code> etc. however running outside GDB I continue to get Segmentation Fault regardless of where I set the return address to.</p>\n\n<p>Any thoughts besides getting an older version of gcc? Currently using gcc version 6.1.1.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 6, "creation_date": 1475035487, "post_id": 39737809, "comment_id": 66773468, "body": "They invented these things called arrays so that you don&#39;t need to write the same code out 12 times for the assignments, etc.  However, there&#39;s a chance that you&#39;ve not covered those yet \u2014 but 22 entries is a bit cruel if they&#39;ve not covered arrays yet."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1475035576, "post_id": 39737809, "comment_id": 66773489, "body": "You&#39;ve forgotten to ask for the scores for quiz 5 and quiz 6, so you get quasi-random garbage in your calculation."}, {"owner": {"reputation": 59, "user_id": 6891122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TS9sC.png?s=128&g=1", "display_name": "Ardowi", "link": "https://stackoverflow.com/users/6891122/ardowi"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475036134, "post_id": 39737809, "comment_id": 66773637, "body": "Thanks for the tip Jonathan, I understand but I&#39;ve just started the class and the professor wants everything written the long way for the time being!"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1475037378, "post_id": 39737809, "comment_id": 66773988, "body": "Note that scanf does not recover from invalid input. Therefore you should normally <i>always</i> check its return value, or your program might do unexpected things."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1475039173, "post_id": 39737809, "comment_id": 66774488, "body": "@Erdowi since your question is not generally useful (it was just about a bug  that you yourself would have found if you looked carefully enough at the code, no need to even read any manuals or so), the question is not useful as a general reference and 5 people have voted to close the question so that it doesn&#39;t get any more spam answers."}, {"owner": {"reputation": 59, "user_id": 6891122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TS9sC.png?s=128&g=1", "display_name": "Ardowi", "link": "https://stackoverflow.com/users/6891122/ardowi"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1475066370, "post_id": 39737809, "comment_id": 66791693, "body": "@AnttiHaapala This is my first post, how would I go about closing it? I do not see it under edit."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1475066403, "post_id": 39737809, "comment_id": 66791716, "body": "@Erdowi closed already :D that&#39;s what the on hold means"}, {"owner": {"reputation": 59, "user_id": 6891122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TS9sC.png?s=128&g=1", "display_name": "Ardowi", "link": "https://stackoverflow.com/users/6891122/ardowi"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1475066454, "post_id": 39737809, "comment_id": 66791751, "body": "@AnttiHaapala My mistake, thanks!!"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1475035608, "post_id": 39737863, "comment_id": 66773496, "body": "You must explain the change.  You&#39;re right, but no explanation is no good."}], "tags": [], "owner": {"reputation": 291, "user_id": 6886053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428b06621c37ea85e670fed66adab8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Iqbal", "link": "https://stackoverflow.com/users/6886053/iqbal"}, "is_accepted": false, "score": 2, "last_activity_date": 1475036821, "last_edit_date": 1475036821, "creation_date": 1475035578, "answer_id": 39737863, "question_id": 39737809, "link": "https://stackoverflow.com/questions/39737809/c-lang-what-is-wrong-with-my-code/39737863#39737863", "title": "C Lang - What is wrong with my code?", "body": "<pre><code>you forgot to take input from user of Q5 and Q6 which I have added in that           lines and rest of all are right    \n#include &lt;stdio.h&gt;\n\nint main() {\nint a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, // integers for      variables\nq1, q2, q3, q4, q5, q6, t1, t2, t3, t4, sum, total = 2200;\nfloat per;\n\n printf(\"\\nEnter the score for Assignment 1: \"); // Assignment statements\n scanf(\"%d\", &amp;a1);\n printf(\"\\nEnter the score for Assignment 2: \");\n scanf(\"%d\", &amp;a2);   \n printf(\"\\nEnter the score for Assignment 3: \");\n scanf(\"%d\", &amp;a3);   \n printf(\"\\nEnter the score for Assignment 4: \");\n scanf(\"%d\", &amp;a4);\n printf(\"\\nEnter the score for Assignment 5: \");\n scanf(\"%d\", &amp;a5);   \n printf(\"\\nEnter the score for Assignment 6: \");\n scanf(\"%d\", &amp;a6);      \n printf(\"\\nEnter the score for Assignment 7: \");\n scanf(\"%d\", &amp;a7);\n printf(\"\\nEnter the score for Assignment 8: \");\n scanf(\"%d\", &amp;a8);   \n printf(\"\\nEnter the score for Assignment 9: \");\n scanf(\"%d\", &amp;a9);   \n printf(\"\\nEnter the score for Assignment 10: \");\n scanf(\"%d\", &amp;a10);\n printf(\"\\nEnter the score for Assignment 11: \");\n scanf(\"%d\", &amp;a11);   \n printf(\"\\nEnter the score for Assignment 12: \");\n scanf(\"%d\", &amp;a12);       \n printf(\"\\nEnter the score for Quiz 1: \"); // Quiz statements\n scanf(\"%d\", &amp;q1);\n printf(\"\\nEnter the score for Quiz 2: \");\n scanf(\"%d\", &amp;q2);  \n printf(\"\\nEnter the score for Quiz 3: \");\n scanf(\"%d\", &amp;q3);\n printf(\"\\nEnter the score for Quiz 4: \");\n scanf(\"%d\", &amp;q4);\n printf(\"\\nEnter the score for Quiz 5: \");\n scanf(\"%d\", &amp;q5);\n printf(\"\\nEnter the score for Quiz 6: \");\n scanf(\"%d\", &amp;q6);\n printf(\"\\nEnter the score for Test 1: \");\n scanf(\"%d\", &amp;t1);\n printf(\"\\nEnter the score for Test 2: \");\n scanf(\"%d\", &amp;t2);\n printf(\"\\nEnter the score for Test 3: \");\n scanf(\"%d\", &amp;t3);   \n printf(\"\\nEnter the score for Test 4: \");\n scanf(\"%d\", &amp;t4);  \n\n sum = a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8 + a9 + a10 + a11 + a12 +\n q1 + q2 + q3 + q4 + q5 + q6 + t1 + t2 + t3 + t4;\n\n per = (sum * 100) / total;\n printf(\"\\nPercentage : %f\", per);\n\n return (0);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 6891122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TS9sC.png?s=128&g=1", "display_name": "Ardowi", "link": "https://stackoverflow.com/users/6891122/ardowi"}, "edited": false, "score": 0, "creation_date": 1475036515, "post_id": 39737870, "comment_id": 66773737, "body": "Thanks a ton! Can&#39;t believe I missed that. Is there any tricks to minimizing the amount of zero&#39;s that show up to the right of the decimal?"}, {"owner": {"reputation": 29810, "user_id": 423170, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H9kNQ.png?s=128&g=1", "display_name": "Frxstrem", "link": "https://stackoverflow.com/users/423170/frxstrem"}, "reply_to_user": {"reputation": 59, "user_id": 6891122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TS9sC.png?s=128&g=1", "display_name": "Ardowi", "link": "https://stackoverflow.com/users/6891122/ardowi"}, "edited": false, "score": 0, "creation_date": 1475036793, "post_id": 39737870, "comment_id": 66773810, "body": "@Erdowi Use <code>%.0f</code>, where you can replace 0 with whatever number of decimals you want."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1475037144, "post_id": 39737870, "comment_id": 66773913, "body": "There is this thing called &quot;close votes&quot; too."}, {"owner": {"reputation": 59, "user_id": 6891122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TS9sC.png?s=128&g=1", "display_name": "Ardowi", "link": "https://stackoverflow.com/users/6891122/ardowi"}, "edited": false, "score": 0, "creation_date": 1475039027, "post_id": 39737870, "comment_id": 66774441, "body": "What are &quot;close votes&quot;?"}], "tags": [], "owner": {"reputation": 29810, "user_id": 423170, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H9kNQ.png?s=128&g=1", "display_name": "Frxstrem", "link": "https://stackoverflow.com/users/423170/frxstrem"}, "is_accepted": true, "score": 3, "last_activity_date": 1475035939, "last_edit_date": 1475035939, "creation_date": 1475035615, "answer_id": 39737870, "question_id": 39737809, "link": "https://stackoverflow.com/questions/39737809/c-lang-what-is-wrong-with-my-code/39737870#39737870", "title": "C Lang - What is wrong with my code?", "body": "<p>You forgot to read in values for quizzes 5 and 6. Therefore, the values for <code>q5</code> and <code>q6</code> are not defined, and trying to use them lead to so-called <em>undefined behavior</em>, which is C slang for \"anything can happen\". This is why you get so large values for  <code>per</code>.</p>\n\n<p>It's easy to fix though: just add these lines reading in the variables q5 and q6, and your code should be fine:</p>\n\n<pre><code>printf(\"\\nEnter the score for Quiz 5: \");\nscanf(\"%d\", &amp;q5);\nprintf(\"\\nEnter the score for Quiz 6: \");\nscanf(\"%d\", &amp;q6);\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6891122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TS9sC.png?s=128&g=1", "display_name": "Ardowi", "link": "https://stackoverflow.com/users/6891122/ardowi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "closed_date": 1475037296, "accepted_answer_id": 39737870, "answer_count": 2, "score": 0, "last_activity_date": 1475036821, "creation_date": 1475035172, "last_edit_date": 1475035538, "question_id": 39737809, "link": "https://stackoverflow.com/questions/39737809/c-lang-what-is-wrong-with-my-code", "closed_reason": "Not suitable for this site", "title": "C Lang - What is wrong with my code?", "body": "<p>With my below code, I am trying to a have the percent of the overall class grade shown. I have everything set up and it seems as though everything works up until the sum. This is my first assignment in C and I cannot see what is wrong.</p>\n\n<p>I just need it to give the percentage as the output but instead it gives me 1490.0000 when I use 1 as the score, but the output should be 1% (22 assignments / 2200 points)</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n   int a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, // integers for variables\n   q1, q2, q3, q4, q5, q6, t1, t2, t3, t4, sum, total = 2200;\n   float per;\n\n   printf(\"\\nEnter the score for Assignment 1: \"); // Assignment statements\n   scanf(\"%d\", &amp;a1);\n   printf(\"\\nEnter the score for Assignment 2: \");\n   scanf(\"%d\", &amp;a2);   \n   printf(\"\\nEnter the score for Assignment 3: \");\n   scanf(\"%d\", &amp;a3);   \n   printf(\"\\nEnter the score for Assignment 4: \");\n   scanf(\"%d\", &amp;a4);\n   printf(\"\\nEnter the score for Assignment 5: \");\n   scanf(\"%d\", &amp;a5);   \n   printf(\"\\nEnter the score for Assignment 6: \");\n   scanf(\"%d\", &amp;a6);      \n   printf(\"\\nEnter the score for Assignment 7: \");\n   scanf(\"%d\", &amp;a7);\n   printf(\"\\nEnter the score for Assignment 8: \");\n   scanf(\"%d\", &amp;a8);   \n   printf(\"\\nEnter the score for Assignment 9: \");\n   scanf(\"%d\", &amp;a9);   \n   printf(\"\\nEnter the score for Assignment 10: \");\n   scanf(\"%d\", &amp;a10);\n   printf(\"\\nEnter the score for Assignment 11: \");\n   scanf(\"%d\", &amp;a11);   \n   printf(\"\\nEnter the score for Assignment 12: \");\n   scanf(\"%d\", &amp;a12);       \n   printf(\"\\nEnter the score for Quiz 1: \"); // Quiz statements\n   scanf(\"%d\", &amp;q1);\n   printf(\"\\nEnter the score for Quiz 2: \");\n   scanf(\"%d\", &amp;q2);  \n   printf(\"\\nEnter the score for Quiz 3: \");\n   scanf(\"%d\", &amp;q3);\n   printf(\"\\nEnter the score for Quiz 4: \");\n   scanf(\"%d\", &amp;q4);\n   printf(\"\\nEnter the score for Test 1: \");\n   scanf(\"%d\", &amp;t1);\n   printf(\"\\nEnter the score for Test 2: \");\n   scanf(\"%d\", &amp;t2);\n   printf(\"\\nEnter the score for Test 3: \");\n   scanf(\"%d\", &amp;t3);   \n   printf(\"\\nEnter the score for Test 4: \");\n   scanf(\"%d\", &amp;t4);  \n\n   sum = a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8 + a9 + a10 + a11 + a12 +\n   q1 + q2 + q3 + q4 + q5 + q6 + t1 + t2 + t3 + t4;\n\n   per = (sum * 100) / total;\n   printf(\"\\nPercentage : %f\", per);\n\n    return (0);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "static-libraries", "yocto"], "comments": [{"owner": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 0, "creation_date": 1475151987, "post_id": 39737629, "comment_id": 66834927, "body": "How this magic flag should be passed? Environment variable? <code>EXTRA_OEMAKE</code>? <code>EXTRA_OECONF</code>?"}, {"owner": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "reply_to_user": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 0, "creation_date": 1475153636, "post_id": 39737629, "comment_id": 66836128, "body": "Environment variable"}], "answers": [{"comments": [{"owner": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "edited": false, "score": 0, "creation_date": 1475052558, "post_id": 39741716, "comment_id": 66781785, "body": "the problem is i only have acces to .bbappend file. for this we need to have .bb file"}, {"owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "reply_to_user": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "edited": false, "score": 0, "creation_date": 1475062631, "post_id": 39741716, "comment_id": 66789012, "body": "and what prevents you from adding another .bb-file?"}, {"owner": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "edited": false, "score": 0, "creation_date": 1475063353, "post_id": 39741716, "comment_id": 66789450, "body": "its from another bb layer. so I am not allowed to touch those files"}, {"owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "reply_to_user": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "edited": false, "score": 0, "creation_date": 1475065276, "post_id": 39741716, "comment_id": 66790886, "body": "Yes but what prevents you from adding another bb file to your own layer?"}, {"owner": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "edited": false, "score": 0, "creation_date": 1475071005, "post_id": 39741716, "comment_id": 66795427, "body": "for that i need to copy code from the other meta-layer to my layer. this is not expected"}, {"owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "reply_to_user": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "edited": false, "score": 0, "creation_date": 1475134148, "post_id": 39741716, "comment_id": 66822958, "body": "If you named the the library, the layer and the special configuration you need, then maybe someone could provide more accurate help...."}], "tags": [], "owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "is_accepted": false, "score": 0, "last_activity_date": 1475050566, "creation_date": 1475050566, "answer_id": 39741716, "question_id": 39737629, "link": "https://stackoverflow.com/questions/39737629/how-to-build-same-library-more-than-once-in-yocto/39741716#39741716", "title": "How to build same library more than once in Yocto?", "body": "<p>If the different configurations really produce different installed files, then you'll have no problems adding two separate recipes that just happen to have the same SRC_URI</p>\n"}, {"tags": [], "owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "is_accepted": false, "score": 0, "last_activity_date": 1475124011, "creation_date": 1475124011, "answer_id": 39761542, "question_id": 39737629, "link": "https://stackoverflow.com/questions/39737629/how-to-build-same-library-more-than-once-in-yocto/39761542#39761542", "title": "How to build same library more than once in Yocto?", "body": "<p>Well, you can't, not without two recipes.</p>\n\n<p>Your two applications, can't influence in any way, how the library is being used. Thus, your options (as long as both these two applications should be available for the same machine / distro combination) basically are:</p>\n\n<ol>\n<li><p>Create a 2nd recipe (in this case, likely in your layer, though preferably in the upstream layer). If the recipe you're copying uses in <code>.inc</code> and a small <code>.bb</code> that mostly includes that file, you can easily do just the same. Otherwise, your options are to either copy the recipe and modify it, or to have your new recipe </p>\n\n<pre><code>require &lt;PATH_FROM COREBASE-TO-THE-UPSTREAM-RECIPE&gt;/upstream-recipe.bb\n</code></pre></li>\n<li><p>If possible, modify the upstream recipe (preferably using a <code>.bbappend</code>) to simultaneously build both versions that you require.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "is_accepted": true, "score": 3, "last_activity_date": 1475157938, "creation_date": 1475157938, "answer_id": 39772569, "question_id": 39737629, "link": "https://stackoverflow.com/questions/39737629/how-to-build-same-library-more-than-once-in-yocto/39772569#39772569", "title": "How to build same library more than once in Yocto?", "body": "<p>If you're limited to <code>.bbappend</code> and you don't want to duplicate the recipe, you can add some additional <a href=\"http://www.yoctoproject.org/docs/2.1/bitbake-user-manual/bitbake-user-manual.html#tasks\" rel=\"nofollow\">tasks</a> then. In these additional tasks (after regular installation) you can do configuration/compilation/installation once again but with any kind of additional actions/variable overrides or whatever. Something like this:</p>\n\n<pre><code>do_special_configure() {\n        oe_runmake clean\n        export MAGIC_VARIABLE=\"magic value\"\n        do_configure\n}\n\ndo_special_compile() {\n        export MAGIC_VARIABLE=\"magic value\"\n        do_compile\n}\n\nfakeroot do_special_install() {\n        export MAGIC_VARIABLE=\"magic value\"\n        do_install\n}\n\ndo_special_configure[dirs] = \"${B}\"\ndo_special_compile[dirs] = \"${B}\"\ndo_special_install[dirs] = \"${B}\"\n\naddtask special_configure after do_install before do_special_compile\naddtask special_compile after do_special_configure before do_special_install\naddtask special_install after do_special_compile before do_package do_populate_sysroot\n</code></pre>\n"}], "owner": {"reputation": 890, "user_id": 2803693, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/64d57036e35aaa27be1e38a61b8149b3?s=128&d=identicon&r=PG&f=1", "display_name": "jsaji", "link": "https://stackoverflow.com/users/2803693/jsaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 39772569, "answer_count": 3, "score": 2, "last_activity_date": 1475157938, "creation_date": 1475033963, "question_id": 39737629, "link": "https://stackoverflow.com/questions/39737629/how-to-build-same-library-more-than-once-in-yocto", "title": "How to build same library more than once in Yocto?", "body": "<p>I have 2 application, both uses the same library but the library should be build with a flag enabled in one and disabled in other. this is a static library, so at run time there won't be a conflict in runtime. But the library is separate ie, the application is build separately and the library is separate. In each configuration, the library will be build with a different name which is taken care by the makefile. This can be done manually. but now I need to add it to Yocto.\nIn yocto, how can I build the same library 2 times in separate configuration?</p>\n"}, {"tags": ["c", "linux"], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 580, "user_id": 1746547, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/IDJ1c.jpg?s=128&g=1", "display_name": "cartman", "link": "https://stackoverflow.com/users/1746547/cartman"}, "edited": false, "score": 0, "creation_date": 1475037424, "post_id": 39737630, "comment_id": 66773997, "body": "And it is even documented, @walker, in the docs for <code>mkdir(3)</code>.  For example, the Linux version says &quot;The file permission bits of the new directory shall be initialized from <code>mode</code>. <b>These file permission bits of the <code>mode</code> argument shall be modified by the process&#39; file creation mask</b>&quot;  (emphasis added)."}, {"owner": {"reputation": 580, "user_id": 1746547, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/IDJ1c.jpg?s=128&g=1", "display_name": "cartman", "link": "https://stackoverflow.com/users/1746547/cartman"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475045096, "post_id": 39737630, "comment_id": 66777157, "body": "@JohnBollinger I just tried to call chmod after mkdir to solve the issue. it also works. My question is what&#39;s the different between two ways? Which way is more recommended?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1475045575, "post_id": 39737630, "comment_id": 66777450, "body": "I think <code>umask()</code>, <code>mkdir()</code>, <code>umask()</code> is probably better, unless you need to set the <code>S_ISVTX</code> (sticky bit)  or the <code>S_ISGUID</code> bit on the directory.  For those, on macOS Sierra (and Mac OS X before it), you need to use <code>chmod()</code> because <code>mkdir(2)</code> says: <i>Note: the behavior of mkdir() is undefined when mode bits other than the low 9 bits are used. Use chmod(2) after mkdir() to explicitly set the other bits.</i>. So, if you need to call <code>chmod()</code> anyway, use <code>mkdir()</code> plus <code>chmod()</code> \u2014 otherwise use <code>umask()</code>, <code>mkdir()</code>, <code>umask()</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475070421, "post_id": 39737630, "comment_id": 66794959, "body": "Yes, wherever possible, it is best to create files / directories with the intended mode from the beginning, instead of changing the mode after creation.  Additionally, if you need to create multiple directories and / or files, then modifying the umask once for all (and maybe restoring it later) saves you from performing a <code>chmod()</code> on each."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1592605166, "post_id": 39737630, "comment_id": 110495511, "body": "Contrary opinion: <a href=\"https://stackoverflow.com/a/12391417\">File Permission Problems In Unix</a> - umask is global, not per thread; treat it as a user configuration that you don&#39;t mess with.  You can always start with very restricted permissions and relax them with <code>chmod</code>.  Unless I&#39;m mistaken, a <code>umask</code> setting can&#39;t give more permissions that <code>mkdir()</code> specified so the TOCTOU-like vulnerability is impossible."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1592607568, "post_id": 39737630, "comment_id": 110496154, "body": "@PeterCordes \u2014 thread-safety is an important point; thank you.  I&#39;ve revised the answer to account for that.  Using 0 for the mode in the call to <code>mkdir()</code> and then using <code>chmod()</code> should always be safe.  No <code>umask</code> setting adds bits to the value specified in <code>mkdir()</code> or any other &#39;create file&#39; operation; it can only remove bits."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 8, "last_activity_date": 1592608044, "last_edit_date": 1592608044, "creation_date": 1475033972, "answer_id": 39737630, "question_id": 39737609, "link": "https://stackoverflow.com/questions/39737609/why-cant-my-program-set-0777-mode-with-the-mkdir-system-call/39737630#39737630", "title": "Why can&#39;t my program set 0777 mode with the mkdir system call?", "body": "<p>Run <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/umask.html\" rel=\"nofollow noreferrer\"><code>umask</code></a> in the shell; it will report <code>022</code>.  The bits set in the <code>umask</code> value are removed from permissions when creating files or directories.</p>\n\n<p>In a single-threaded program, one way to really set <code>0777</code> permissions is to dink with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/umask.html\" rel=\"nofollow noreferrer\"><code>umask()</code></a>:</p>\n\n<pre><code>mode_t old_mask = umask(0);\nmkdir(\"/tmp/mkdir-test\", 0777);\numask(old_mask);\n</code></pre>\n\n<p>That preserves the current setting except when you are sure you need to override it.  However, this is dangerous in multi-threaded programs because the <code>umask</code> value is global per-process, not per-thread (and thanks to <a href=\"https://stackoverflow.com/users/224132/peter-cordes\">Peter Cordes</a> for <a href=\"https://stackoverflow.com/questions/39737609/why-cant-my-program-set-0777-mode-with-the-mkdir-system-call/39737630?noredirect=1#comment110495511_39737630\">pointing this out</a>).</p>\n\n<p>The other option for setting the permissions is to use <code>chmod()</code>, and doing so is safe with multi-threaded programs too:</p>\n\n<pre><code>const char *dirname = \"/tmp/mkdir-test\";\nmode_t target_mode = 0777;\nif (mkdir(dirname, 0) == 0)\n    chmod(dirname, target_mode);\n</code></pre>\n\n<p>The permissions set by the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/chmod.html\" rel=\"nofollow noreferrer\"><code>chmod()</code></a> function are not affected by <code>umask</code> values.</p>\n\n<p>The permissions on the call to <code>mkdir()</code> are probably best set to <code>0</code> as shown;  it will always work reliably and doesn't risk affecting other threads by modifying the <code>umask</code> value.  Alternatively, you could use the desired target permissions in the call to <code>mkdir()</code> if you wanted to (and a previous version of this answer suggested doing so, using <code>0777</code> as the hard-coded target permissions).</p>\n\n<pre><code>const char *dirname = \"/tmp/mkdir-test\";\nmode_t target_mode = 0777;\nif (mkdir(dirname, target_mode) == 0)\n    chmod(dirname, target_mode);\n</code></pre>\n\n<p>If you use this idiom, it is important that the mode passed to <code>mkdir()</code> is the same as, or less permissive than, the mode passed to <code>chmod()</code> \u2014 and <code>0</code> is less permissive than any other mode (and always works).\nIf you use a more relaxed mode in the call to <code>mkdir()</code>, there's a TOCTOU (Time-of-Check, Time-of-Use) style vulnerability between the <code>mkdir()</code> and <code>chmod()</code> calls during which someone (some process) could get into the directory with relaxed permissions and wreak havoc; this could be a security risk.</p>\n\n<p>Note that <code>umask()</code> is a very simple system call and therefore very quick too (as system calls go, compared with heavyweights such as <code>open()</code>, <code>mkdir()</code> or <code>chmod()</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 2603, "user_id": 7310077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jPkF.jpg?s=128&g=1", "display_name": "Mostafa Ghadimi", "link": "https://stackoverflow.com/users/7310077/mostafa-ghadimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1595857305, "creation_date": 1595857305, "answer_id": 63116644, "question_id": 39737609, "link": "https://stackoverflow.com/questions/39737609/why-cant-my-program-set-0777-mode-with-the-mkdir-system-call/63116644#63116644", "title": "Why can&#39;t my program set 0777 mode with the mkdir system call?", "body": "<p>You can simply do it using the following code:</p>\n<p><strong>mkdirfile.cpp</strong></p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n\nint main() {\n    long result;\n    result = syscall(__NR_mkdir, &quot;/tmp/mkdir-test&quot;, 0777);\n    printf(&quot;The result is %ld.\\n&quot;, result);\n    return 0;\n}\n</code></pre>\n<p>Then compile the code using gcc and run it:</p>\n<pre><code>gcc mkdirfile.cpp &amp;&amp; ./a.out\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1746547, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/IDJ1c.jpg?s=128&g=1", "display_name": "cartman", "link": "https://stackoverflow.com/users/1746547/cartman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2253, "favorite_count": 1, "accepted_answer_id": 39737630, "answer_count": 2, "score": 0, "last_activity_date": 1595857305, "creation_date": 1475033782, "last_edit_date": 1475083943, "question_id": 39737609, "link": "https://stackoverflow.com/questions/39737609/why-cant-my-program-set-0777-mode-with-the-mkdir-system-call", "title": "Why can&#39;t my program set 0777 mode with the mkdir system call?", "body": "<p>I wrote following code to try to create a directory with 0777 mode on Linux:</p>\n\n<pre><code>#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n\nint main () {\n\n    mkdir(\"/tmp/mkdir-test\", 0777);\n    return 0;\n\n}\n</code></pre>\n\n<p>But actually, the new directory has 0755 mode. </p>\n\n<pre><code># stat /tmp/mkdir-test\n  File: `/tmp/mkdir-test'\n  Size: 4096        Blocks: 8          IO Block: 4096   directory\nDevice: 802h/2050d  Inode: 1772304     Links: 2\nAccess: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)\nAccess: 2016-09-27 20:23:54.000000000 -0700\nModify: 2016-09-27 20:23:54.000000000 -0700\nChange: 2016-09-27 20:23:54.000000000 -0700\n</code></pre>\n\n<p>Can someone explain this? And how can the program create a real 0777 mode directory?</p>\n"}, {"tags": ["c++", "c", "assembly", "bitwise-operators"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1475031554, "post_id": 39737309, "comment_id": 66772541, "body": "You shouldn&#39;t start your identifiers with underscores.  Those identifiers are reserved for your compiler&#39;s implementation."}, {"owner": {"reputation": 3420, "user_id": 1547399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/695ba9e5f57752495d02d32190e15e38?s=128&d=identicon&r=PG", "display_name": "Joey.Z", "link": "https://stackoverflow.com/users/1547399/joey-z"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1475031676, "post_id": 39737309, "comment_id": 66772573, "body": "@PaulMcKenzie those are macro definitions which will be replaced before compilation, but you are right, I shouldn&#39;t."}, {"owner": {"reputation": 34061, "user_id": 616460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yiloe.png?s=128&g=1", "display_name": "Jason C", "link": "https://stackoverflow.com/users/616460/jason-c"}, "edited": false, "score": 1, "creation_date": 1475031735, "post_id": 39737309, "comment_id": 66772583, "body": "The and itself shouldn&#39;t be costly but perhaps you&#39;re confusing the crap out of the branch predictor, especially if there&#39;s no real pattern to whether or not that condition is true. Then you spend a lot of time waiting for the pipeline to flush."}], "answers": [{"comments": [{"owner": {"reputation": 34061, "user_id": 616460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yiloe.png?s=128&g=1", "display_name": "Jason C", "link": "https://stackoverflow.com/users/616460/jason-c"}, "edited": false, "score": 0, "creation_date": 1475031960, "post_id": 39737359, "comment_id": 66772628, "body": "In that case wouldn&#39;t you expect to see the larger time on the preceding movzx line?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 34061, "user_id": 616460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yiloe.png?s=128&g=1", "display_name": "Jason C", "link": "https://stackoverflow.com/users/616460/jason-c"}, "edited": false, "score": 2, "creation_date": 1475032097, "post_id": 39737359, "comment_id": 66772660, "body": "@JasonC I am not 100% sure if the profiler has attributed the timing correctly here, but you are right, the reading instruction is on the <code>movzx</code> line."}, {"owner": {"reputation": 3420, "user_id": 1547399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/695ba9e5f57752495d02d32190e15e38?s=128&d=identicon&r=PG", "display_name": "Joey.Z", "link": "https://stackoverflow.com/users/1547399/joey-z"}, "edited": false, "score": 0, "creation_date": 1475033813, "post_id": 39737359, "comment_id": 66773075, "body": "That&#39;s right, the swap result in a 50% drop of time consumption. Again the compiler may not timing perciselly at the directive level. But the overall time also dropped by 40%-50%."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 3, "creation_date": 1475042917, "post_id": 39737359, "comment_id": 66776034, "body": "The profiler probably measures things correctly. The load starts quickly, but the CPU doesn&#39;t wait for it to finish until the result of that load is actually needed. And that happens when the register we&#39;re loading is used, in the and instruction. This is why profiling on an instruction level is pretty much useless today. You shouldn&#39;t think about single lines of code or instructions. Timing bottlenecks happen on whole large sections of code or even whole programs."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 9, "last_activity_date": 1475031969, "last_edit_date": 1475031969, "creation_date": 1475031811, "answer_id": 39737359, "question_id": 39737309, "link": "https://stackoverflow.com/questions/39737309/performance-hit-at-bitwise-operation/39737359#39737359", "title": "performance hit at bitwise operation", "body": "<p>The hit is not because you are using a bit-wise instruction, but because the instruction reads from memory - a more expensive operation than offset computation that uses registers.</p>\n\n<p>The problem with the code is that it does not read memory consecutively, because according to <code>IJ_REF</code> your image is stored by rows, but you read it by column.</p>\n\n<p>You should be able to improve the performance by increasing the number of cache hits if you swap the order of your loops:</p>\n\n<pre><code>for (int iy = 0; iy &lt; ny_; ++iy) {\n    for (int ix = 0; ix &lt; nx_; ++ix) {\n        int32 r = IJ_REF(ix, iy);\n        if (!HAS_BIT(image_[r], FLAG)) {\n            int32 k = r * 4;\n            pTex[k] = pTex[k + 1] = pTex[k + 2] = pTex[k + 3] = 255;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": false, "score": 1, "last_activity_date": 1475062672, "creation_date": 1475062672, "answer_id": 39746350, "question_id": 39737309, "link": "https://stackoverflow.com/questions/39737309/performance-hit-at-bitwise-operation/39746350#39746350", "title": "performance hit at bitwise operation", "body": "<p>Can you profile this variant (without branching) and post the result? I'm curious... (may be slower, if you write those 255 into pTex rarely, as this code will touch every pTex byte with <code>or</code>).</p>\n\n<pre><code>#include &lt;string&gt;\n\n#define IJ_REF(_i, _j) ((_j)*nx_+(_i))\n#define HAS_BIT(_v, _bit)     (((_v) &amp; (_bit)) == (_bit))\n\nint main()\n{\n    constexpr uint32_t ny_ = 350, nx_ = 350;\n    constexpr uint8_t FLAG = 2;\n    uint8_t image_[ny_*nx_];\n    uint8_t pTex[ny_*nx_*4];\n\n    // let access pTex by uint32_t directly\n    uint32_t *pTex32bPtr = reinterpret_cast&lt;uint32_t *&gt;(pTex);\n\n    // debug input\n    image_[IJ_REF(nx_-2, ny_-1)] = FLAG;\n    image_[IJ_REF(nx_-1, ny_-1)] = ~FLAG;\n    pTex32bPtr[IJ_REF(nx_-2, ny_-1)] = 0x12345678;\n    pTex32bPtr[IJ_REF(nx_-1, ny_-1)] = 0x12345678;\n\n    // prepare for loop\n    const uint32_t endOfs = ny_*nx_;\n    constexpr uint32_t pTexORValue[2] = {0, 0xFFFFFFFF};\n    // loop trough all [x,y] values\n    for (uint32_t srcOfs = 0; srcOfs &lt; endOfs; ++srcOfs) {\n        unsigned ORindex = !HAS_BIT(image_[srcOfs], FLAG);\n        // if you know FLAG is always 2, it can be:\n        // ORindex = image_[srcOfs]&amp;2; with pTexORValue array:\n        // [3] = {0xFFFFFFFF, 0, 0};\n        pTex32bPtr[srcOfs] |= pTexORValue[ORindex];\n    }\n\n    // debug output\n    for (size_t i = IJ_REF(nx_-2, ny_-1) * 4; i &lt; IJ_REF(nx_, ny_-1)*4; ++i) {\n        printf(\" %02x\", pTex[i]);\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Also I sort of wonder, why your compiler does <code>movzx edx</code> + <code>and edx</code>, while it could do <code>test byte ptr [eax+ecx],2</code> instead. What is type of <code>FLAG</code>? Oh, now I see, it's because of your <code>HAS_BIT</code> macro. It's actually \"has_all_bits\" test.</p>\n\n<p>If you plan to test only single bit, or any-of-bits is good, you should try (this should allow for <code>test</code> usage):</p>\n\n<pre><code>#define HAS_SOME_BIT(_v, _bits)     (((_v) &amp; (_bits)) != 0)\n</code></pre>\n\n<p>It may help even that code I posted above to be optimized better.</p>\n\n<hr>\n\n<p>And in assembly with FLAG fixed as 2 it would be even possible to calculate the OR value as:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>    mov    ebx,image_offset\nloop:\n    movzx  eax,Image_[ebx]\n    ; copy bit 0x02 to all 32 bits\n    shl    eax,30\n    sar    eax,31\n    not    eax     ; flip it to \"not HAS_BIT\"\n    or     pTex[ebx*4],eax\n    ...\n</code></pre>\n"}], "owner": {"reputation": 3420, "user_id": 1547399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/695ba9e5f57752495d02d32190e15e38?s=128&d=identicon&r=PG", "display_name": "Joey.Z", "link": "https://stackoverflow.com/users/1547399/joey-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 39737359, "answer_count": 2, "score": 2, "last_activity_date": 1475062672, "creation_date": 1475031396, "last_edit_date": 1475032054, "question_id": 39737309, "link": "https://stackoverflow.com/questions/39737309/performance-hit-at-bitwise-operation", "title": "performance hit at bitwise operation", "body": "<pre><code>// nx_, ny_ is like 350 * 350\n#define   IJ_REF(_i, _j) ((_j)*nx_+(_i))\n#define HAS_BIT(_v, _bit)     (((_v) &amp; (_bit)) == (_bit))\n\nfor (int ix = 0; ix &lt; nx_; ++ix) {              // 0.019s\n    for (int iy = 0; iy &lt; ny_; ++iy) {          // 0.716s\n        int32 r = IJ_REF(ix, iy);               // 0.548s\n        if (!HAS_BIT(image_[r], FLAG)) {        // 3.016s\n            int32 k = r * 4;                    // 0.242s\n            pTex[k] = pTex[k + 1] = pTex[k + 2] = pTex[k + 3] = 255;  // 1.591s\n        }\n    }\n}\n</code></pre>\n\n<p>The assembly of the HAS_BIT line is:\n<a href=\"https://i.stack.imgur.com/ozLkO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ozLkO.png\" alt=\"enter image description here\"></a></p>\n\n<p>I guess the <code>and</code> directive is a <code>&amp;</code> operation, so is it suppose to be so costly?</p>\n\n<p>PS: FLAG is 0x2 so I guess the compiler did some optimization to generate a single directive for the <code>HAS_BIT</code>. And I use Vtune to profile.</p>\n"}, {"tags": ["c", "computer-science", "cs50"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 6, "creation_date": 1475031298, "post_id": 39737252, "comment_id": 66772484, "body": "There are three-too-many <code>return</code> statements in that code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6891104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14c6e54061a9965f5f90262aedbf87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Dude", "link": "https://stackoverflow.com/users/6891104/mr-dude"}, "edited": false, "score": 0, "creation_date": 1475035182, "post_id": 39737285, "comment_id": 66773373, "body": "How would I remove the return on roundf(x) without it displaying the error message:    ignoring return value of function declared with const attribute [-Werror,-Wunused-value]         roundf(x);"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "reply_to_user": {"reputation": 1, "user_id": 6891104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14c6e54061a9965f5f90262aedbf87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Dude", "link": "https://stackoverflow.com/users/6891104/mr-dude"}, "edited": false, "score": 0, "creation_date": 1475058137, "post_id": 39737285, "comment_id": 66785888, "body": "You shouldn&#39;t be returning it at all; see @cdlane&#39;s answer."}], "tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 5, "last_activity_date": 1475031203, "creation_date": 1475031203, "answer_id": 39737285, "question_id": 39737252, "link": "https://stackoverflow.com/questions/39737252/i-am-trying-to-create-a-greedy-algorithm-but-my-code-wont-return-a-value-at-the/39737285#39737285", "title": "I am trying to create a greedy algorithm but my code won&#39;t return a value at the end", "body": "<p>As soon as your program hits <code>return roundf(x);</code> it will stop (since <code>main</code> has returned), which is why it produces no output after reading the first number.</p>\n"}, {"tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 1, "last_activity_date": 1475039051, "creation_date": 1475039051, "answer_id": 39738442, "question_id": 39737252, "link": "https://stackoverflow.com/questions/39737252/i-am-trying-to-create-a-greedy-algorithm-but-my-code-wont-return-a-value-at-the/39738442#39738442", "title": "I am trying to create a greedy algorithm but my code won&#39;t return a value at the end", "body": "<p>This code only needs one <code>return</code> statement, but it's the one you forgot.  The others are syntax errors so you'll want to review what it is that <code>return</code> actually does.  Your code has most of what you need, but not in the correct order.  The rework below does what you intended the code to do at this point and hints where to go next:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;cs50.h&gt;\n\nint main(void)\n{\n    printf(\"O hai! How much change is owed?\\n\");\n\n    float x = GetFloat();\n    x = x * 100;\n    x = roundf(x);\n\n    int coins[] = { 25 };\n\n    int coin = 0;\n\n    do\n    {\n        int c = 0;\n\n        while (x &gt;= coins[coin])\n        {\n            x = x - coins[coin];\n            c = c + 1;\n        }\n\n        printf(\"%d coins worth %d\\n\", c, coins[coin]);\n    }\n    while (--coin &gt;= 0);\n\n    return 0;\n}\n</code></pre>\n\n<p>I.e. you need to expand the array <code>coins</code> to contain the other denominations and set the <code>coin</code> variable to the index of the largest coin in <code>coins</code>.  Each time through your loop, change <code>coin</code> to index the next largest coin until there aren't any more.</p>\n\n<p>I changed your inner <code>do { ... } while()</code> to a simple <code>while() { ... }</code> loop as you can't assume a given coin will be needed to make change.</p>\n"}], "owner": {"reputation": 1, "user_id": 6891104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14c6e54061a9965f5f90262aedbf87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Dude", "link": "https://stackoverflow.com/users/6891104/mr-dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1475039051, "creation_date": 1475030909, "question_id": 39737252, "link": "https://stackoverflow.com/questions/39737252/i-am-trying-to-create-a-greedy-algorithm-but-my-code-wont-return-a-value-at-the", "title": "I am trying to create a greedy algorithm but my code won&#39;t return a value at the end", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;cs50.h&gt;\n\nint main(void)\n{\n    float x;\n     printf(\"O hai! How much change is owed?\\n\");\n    do\n    {\n        x = GetFloat();\n        x = x * 100;\n        return roundf(x);\n        int c = 0;\n        do\n        { \n            return x = x - 25;\n            return c = c + 1;\n        }\n        while (x &gt;= 25);\n        printf(\"%d coins\\n\", c);\n    }\n    while (x &lt;= 0);\n}\n</code></pre>\n\n<p>When I input a float such as .60 it is supposed to convert it to an integer then detect if it is greater than 25. This will be the first in a process of graduating decreases in coin from quarter to dime to nickel etc. but when I first tried to test it with printing out the value I got after the first sequence had been completed it returned nothing.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1475030582, "post_id": 39737092, "comment_id": 66772336, "body": "this seems like a <code>c</code> question instead of <code>c++</code>, you should correct the tag"}, {"owner": {"reputation": 306, "user_id": 5749775, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1666bcc1d74c9fe8a3eb1303d147276c?s=128&d=identicon&r=PG&f=1", "display_name": "APaul", "link": "https://stackoverflow.com/users/5749775/apaul"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1475406431, "post_id": 39737092, "comment_id": 66923040, "body": "@appleapple you&#39;re right - I have to use C libs in certain parts of the code, but the overall project I&#39;m working for is technically using C++"}], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 5749775, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1666bcc1d74c9fe8a3eb1303d147276c?s=128&d=identicon&r=PG&f=1", "display_name": "APaul", "link": "https://stackoverflow.com/users/5749775/apaul"}, "edited": false, "score": 0, "creation_date": 1475406581, "post_id": 39737134, "comment_id": 66923078, "body": "Yeah, for some reason I thought the modes would go together (as in &quot;r&quot; and &quot;w&quot; together should be &quot;rw&quot;). My error was literally as simple as changing &quot;rw&quot; to &quot;r+&quot; :/"}], "tags": [], "owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "is_accepted": true, "score": 0, "last_activity_date": 1475030416, "last_edit_date": 1475030416, "creation_date": 1475030100, "answer_id": 39737134, "question_id": 39737092, "link": "https://stackoverflow.com/questions/39737092/fwrite-fails-without-writing-anything-to-existing-file/39737134#39737134", "title": "fwrite() fails without writing anything to existing file", "body": "<p><code>fopen</code> do not have <code>\"rw\"</code> mode, and you should open the file in binary mode since you <code>fwrite</code> to it.</p>\n\n<p>What you want is <code>\"wb\"</code>, <code>\"w+b\"</code> or <code>\"r+b\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 0, "last_activity_date": 1475030120, "creation_date": 1475030120, "answer_id": 39737137, "question_id": 39737092, "link": "https://stackoverflow.com/questions/39737092/fwrite-fails-without-writing-anything-to-existing-file/39737137#39737137", "title": "fwrite() fails without writing anything to existing file", "body": "<pre><code>fd = fopen(\"out\",\"rw\");\n</code></pre>\n\n<p>\"rw\" is not one of the valid open modes.</p>\n\n<p>See the <a href=\"http://manpages.courier-mta.org/htmlman3/fopen.3.html\" rel=\"nofollow\">fopen(3) manual page</a> for more information.</p>\n\n<p>You did not specify your platform, or C library. On Linux, this <code>fopen()</code> call fails.</p>\n"}], "owner": {"reputation": 306, "user_id": 5749775, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1666bcc1d74c9fe8a3eb1303d147276c?s=128&d=identicon&r=PG&f=1", "display_name": "APaul", "link": "https://stackoverflow.com/users/5749775/apaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 39737134, "answer_count": 2, "score": 0, "last_activity_date": 1475406439, "creation_date": 1475029802, "last_edit_date": 1475406439, "question_id": 39737092, "link": "https://stackoverflow.com/questions/39737092/fwrite-fails-without-writing-anything-to-existing-file", "title": "fwrite() fails without writing anything to existing file", "body": "<p>Sorry for this basic problem guys, but I'm having an issue just getting <code>fwrite()</code> to work properly?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nusing namespace std;\n\nint main() {\n\n    FILE* fd = NULL;\n    fd = fopen(\"out\",\"rw\");\n\n    if (fd == NULL) {\n        printf(\"Open failed\\n\");\n        return -1;\n    }\n\n    int error = 0;\n\n    printf(\"Attempting write ... \\n\");\n    char buff[] = {\"hello?\\n\"};\n\n    if( (error = fwrite(buff, 1, 7, fd)) != 7 ) {\n        printf(\"fwrite() failed with code %d \\n\", error);\n        return -1;\n    }\n\n    fclose(fd);\n\n    return 0;\n}\n</code></pre>\n\n<p>This code fails - <code>fwrite()</code> just returns 0 when it should return 7 instead for seven 1b characters written to the file. The file does exist in the same directory; I've tried this with the full file path instead; I've chmod'd the output file <code>out</code> to 777 in case that was the issue (it wasn't); <code>fread()</code> and <code>fseek()</code> both work as expected but I've taken them out for brevity.</p>\n\n<p>What am I doing wrong here? Any help is appreciated.</p>\n"}, {"tags": ["c", "error-handling", "shared-libraries", "errno"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475038441, "post_id": 39737056, "comment_id": 66774279, "body": "Using <code>errno</code> has a problem; it means you can&#39;t report errors that aren&#39;t already standard system errors.  Often they&#39;re sufficient, but if you&#39;re compiling regexes, for example, the errors available from <code>&lt;errno.h&gt;</code> are mostly not appropriate for the possible regex errors \u2014 reporting <code>EINVAL</code> for everything that&#39;s wrong isn&#39;t very helpful.  Also note that no standard library function in either standard C or standard POSIX ever sets <code>errno</code> to zero.  You should be careful if you do that in your code:  <code>int old_errno = errno; errno = 0; \u2026your code\u2026; if (errno == 0) errno = old_errno;</code> is OK."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475080983, "post_id": 39737056, "comment_id": 66802560, "body": "C does not support <i>methods</i>, only <i>functions</i>"}, {"owner": {"reputation": 35, "user_id": 6875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67ccd6f82c24591f69fcb699cfc58b?s=128&d=identicon&r=PG&f=1", "display_name": "AspiringCodeMonkey", "link": "https://stackoverflow.com/users/6875091/aspiringcodemonkey"}, "edited": false, "score": 0, "creation_date": 1475206897, "post_id": 39737056, "comment_id": 66860532, "body": "Jonathan Leffler - that&#39;s everything I&#39;m not supposed to do. So can you tell me a reasonable approach to handling user input? Let&#39;s use an example of a library only accepting uppercase letters. A user gives a lower case letter or letters. What is a standard method of dealing with bad input?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67ccd6f82c24591f69fcb699cfc58b?s=128&d=identicon&r=PG&f=1", "display_name": "AspiringCodeMonkey", "link": "https://stackoverflow.com/users/6875091/aspiringcodemonkey"}, "edited": false, "score": 0, "creation_date": 1475032897, "post_id": 39737431, "comment_id": 66772854, "body": "I like how your implementation doesn&#39;t alter errno. I&#39;m not sure I can use this, however. All of my methods simply convert strings to other data types, do something with them, then give them back to the user. I think maybe I&#39;m over thinking this.   Perhaps I should just document my library well and give the user back their faulty input and a short message on why it&#39;s bad."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475046786, "post_id": 39737431, "comment_id": 66778171, "body": "Writing a function like the above clearly indicates to you interviewers that you don&#39;t know <code>perror</code> exists. It also indicates that you don&#39;t know how to properly name your functions - A function that&#39;s named &quot;<code>...quit</code>&quot; and doesn&#39;t has a wrong name."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475066163, "post_id": 39737431, "comment_id": 66791542, "body": "That code will fail with multithreading. There is just no synchronisation betwenn threads and <code>errno</code> is thread local. And the error output stream is <code>stderr</code>."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475079526, "post_id": 39737431, "comment_id": 66801603, "body": "@tofro Thank you for pointing those things out. I forgot to add the <code>exit</code> at the end of my function and I have fixed that. <code>perror</code> is only really helpful to the developer, as it does not give any information about what failed and where. It only prints the error."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475079622, "post_id": 39737431, "comment_id": 66801675, "body": "@Olaf Thank you for pointing out the <code>stderr</code> problem, I messed up while typing that. I apologize to everyone who had to see that terrible code. I was very tired when I answered the question... But I don&#39;t think AspiringCodeMonkey ever stated that he needed multithreading and I think a &#39;newb&#39; will be fine using this function. It&#39;s not meant for operating systems, it just helps with basic programming."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475079838, "post_id": 39737431, "comment_id": 66801829, "body": "@MDXF Your man pages seem to be broken - <code>perror</code> does the exact same thing your function does, except exiting."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475080911, "post_id": 39737431, "comment_id": 66802512, "body": "Problem is, this does not answer the question (which itself is too broad and/or opinion based)."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475081112, "post_id": 39737431, "comment_id": 66802647, "body": "@Olaf except... it does answer the question because it was accepted as the answer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475081235, "post_id": 39737431, "comment_id": 66802725, "body": "@MDXF: From an objective viewpoint, it does not. It shows one way to <b>report</b> an error, but not how the library should handle this (see the rest of my comment). From the viewpoint of a user lacking experience: I will not comment about that..."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475081376, "post_id": 39737431, "comment_id": 66802803, "body": "@Olaf I&#39;m just trying to help out in the simplest and least confusing way. I didn&#39;t want to overload anyone with too much code or information. I gave him the base of what he asked for."}, {"owner": {"reputation": 35, "user_id": 6875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67ccd6f82c24591f69fcb699cfc58b?s=128&d=identicon&r=PG&f=1", "display_name": "AspiringCodeMonkey", "link": "https://stackoverflow.com/users/6875091/aspiringcodemonkey"}, "edited": false, "score": 2, "creation_date": 1475208224, "post_id": 39737431, "comment_id": 66860915, "body": "MDXF - It seems like you&#39;re capable of reading the context of a question. So thanks for providing an answer that is completely suitable for what I asked.  @else: The question is general for a reason. I wanted discussion about error reporting for simple cases, within the scope of a newb library. Instead of offering resources or insight, there seems to be a lot of &quot;don&#39;t do this&quot; vs &quot;hey, read this,&quot; or &quot;a better case practice is x.&quot; You might all be good developers but you have a lot to learn about teaching, which is typically associated with good leadership."}], "tags": [], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "is_accepted": true, "score": -1, "last_activity_date": 1489014799, "last_edit_date": 1489014799, "creation_date": 1475032325, "answer_id": 39737431, "question_id": 39737056, "link": "https://stackoverflow.com/questions/39737056/how-should-a-c-library-alert-the-user-to-bad-input-and-other-intro-library-conc/39737431#39737431", "title": "How should a C library alert the user to bad input, and other intro library concerns", "body": "<p><code>errno</code> is the most useful method in the standard library for error reporting. <code>string.h</code> also defines a helpful function called <code>strerror</code> that will transform the error code to a string. Here's a sample function you can use to report errors.</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\nvoid error_quit(char *message)\n{\n    int errcode = errno;\n    fprintf(stderr,\"Error at %s: %s\\n\",message,strerror(errcode));\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>Call this setting <code>message</code> to whatever error reporting message you want. For example, if you want to check if <code>read</code> fails (helpful for checking user input):</p>\n\n<pre><code>int n = read(fd,buf,sizeof(buf));\nif (n &lt;= 0)\n    error_quit(\"read\");\n</code></pre>\n\n<p>It will give the user descriptive information about why <code>read</code> failed. Any problems with the user input will be displayed.</p>\n\n<h1>There's also a <em>very</em> useful macro for Windows.</h1>\n\n<pre><code>#define PERR(bSuccess, api) {if(!(bSuccess)) printf(\"%s: Error %d from %s on line %d\\n\", __FILE__, (int) GetLastError(), api, (int) __LINE__);}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67ccd6f82c24591f69fcb699cfc58b?s=128&d=identicon&r=PG&f=1", "display_name": "AspiringCodeMonkey", "link": "https://stackoverflow.com/users/6875091/aspiringcodemonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 39737431, "answer_count": 1, "score": 1, "last_activity_date": 1489014799, "creation_date": 1475029516, "question_id": 39737056, "link": "https://stackoverflow.com/questions/39737056/how-should-a-c-library-alert-the-user-to-bad-input-and-other-intro-library-conc", "title": "How should a C library alert the user to bad input, and other intro library concerns", "body": "<p>I am writing a small, C shared library, with a fairly basic set of tasks. </p>\n\n<p>The reason I am writing it is that it's part of an interview process. It is expected that people attempting this exercise are junior/intro developers.</p>\n\n<p>I am fairly new to C and have completed the exercise handily, in the specified environment, but I have never built a library before. Since my methods will be called from inside another program, how should I deal with faulty user input? </p>\n\n<p>I am allowed to ask questions and asked one about dealing with this facet explicitly, but received the reply that it is up to the candidate to choose how to deal with errors. </p>\n\n<p>I have read some things about using errno, some good, some bad. Is it standard to report errors using this macro? </p>\n\n<p>I am starting to think about things like portability, but part of the assignment is to use a certain version of Linux and to use the gcc compiler. I think as long as I make a reasonable attempt to make my solution portable, I will be fine. </p>\n\n<p>Are there other things a newb trying to write a library should think about? </p>\n"}, {"tags": ["c", "security", "printf", "variadic-functions"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1475033323, "post_id": 39736922, "comment_id": 66772950, "body": "The &#39;user input&#39; shown doesn&#39;t crash <code>printf()</code>.  It might crash it if you used <code>printf(user_input, &quot;just one argument&quot;)</code> or other variants where the user input controls the formatting.  Your <code>safe_printf</code> is called incorrectly; you have the second double quote \u2026 in the wrong place; or actually, it&#39;s missing altogether.  And your crash may be because you try to remove the percent symbols from a non-modifiable character string literal; they&#39;re not writable in general."}, {"owner": {"reputation": 1, "user_id": 6891021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c561eea4a943bc0b7ae06ab7a3ec7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "melkel", "link": "https://stackoverflow.com/users/6891021/melkel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475089867, "post_id": 39736922, "comment_id": 66807594, "body": "I was confused about the behavior of <code>printf()</code>. I didn&#39;t realize that the format string is the only argument able to cause such a crash. Thanks for clarifying."}], "answers": [{"tags": [], "owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1475028714, "creation_date": 1475028714, "answer_id": 39736966, "question_id": 39736922, "link": "https://stackoverflow.com/questions/39736922/write-a-function-like-printf-that-can-sanitize-all-arguments-after-the-first-to/39736966#39736966", "title": "Write a function like printf, that can sanitize all arguments after the first to be free from the `%` symbol", "body": "<p>The string formatting vulnerability exists if user provided input is passed to the <code>printf(3)</code> function. You can prevent this by not allowing that happen, <em>ever</em>. There is absolutely not reason to have a dynamic format string because you should know ahead of time the required format, and therefore you can put the format string in read only memory through the use of a <code>const char *</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6891021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c561eea4a943bc0b7ae06ab7a3ec7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "melkel", "link": "https://stackoverflow.com/users/6891021/melkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1475031140, "creation_date": 1475028367, "last_edit_date": 1475031140, "question_id": 39736922, "link": "https://stackoverflow.com/questions/39736922/write-a-function-like-printf-that-can-sanitize-all-arguments-after-the-first-to", "title": "Write a function like printf, that can sanitize all arguments after the first to be free from the `%` symbol", "body": "<pre><code>user_input = \"%s%s%s%s%s%s%s%s\";\nprintf(\"user input is: %s\", user_input);\n</code></pre>\n\n<p>... crash!</p>\n\n<p>The above lines cause an error. I want to write a function which can be used like <code>printf</code> but can sanitize all arguments after the first to make sure they do not contain the <code>%</code> symbol. The function should be used like 'printf' in that it can take any number of arguments and it print outs a string in the same manner. If the other arguments contain the <code>%</code> symbol, I just want that symbol taken out before it is put in the format string.</p>\n\n<p>If this new function were called <code>safe_printf</code>, I would want the behavior to be like this:</p>\n\n<pre><code>user_input = \"%s%s%s%s%s%s%s%s\";\nsafe_printf(\"user input is: %s, user_input);\n</code></pre>\n\n<p>user input is: ssssssss</p>\n\n<p>It seems like writing a function like this may not be possible, (I can't figure out how to preprocess the char *s in the va_list without knowing how many there are) if that's the case please let me know. Thanks!</p>\n"}, {"tags": ["c", "windows", "visual-studio"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475022429, "post_id": 39736168, "comment_id": 66770371, "body": "&quot;I am getting chinese characters when using _snwprintf &quot; and &quot;file name is written in chinese characters&quot; - What is the problem?? See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 23, "user_id": 6890753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c430f9c2e906dbafb50aaba883d187ce?s=128&d=identicon&r=PG&f=1", "display_name": "Better Fly", "link": "https://stackoverflow.com/users/6890753/better-fly"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475022511, "post_id": 39736168, "comment_id": 66770393, "body": "The problem it self in the title ! i get every time chinese characters when using the first code, but the right characters when using the second code ! i am looking for a solution to solve the first code in order to use random filename."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1475022956, "post_id": 39736168, "comment_id": 66770521, "body": "Welcome to Stack Overflow.  Which platform are you working on (o/s and compiler)?  Most likely, it seems you are working on Windows with MS Visual Studio \u2014 the names prefixed with an underscore match the way MS does business, rather than the way standard C does business.  It matters because you have to look at Microsoft&#39;s manual pages, rather than trying to look at the C standard. <i>[\u2026continued\u2026]</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475022971, "post_id": 39736168, "comment_id": 66770525, "body": "<i>[\u2026continuation\u2026]</i> The C standard doesn&#39;t define a function <code>_snwprint()</code>, but does define <code>swprintf()</code> in <code>&lt;wchar.h&gt;</code> with the prototype <code>int swprintf(wchar_t * restrict s, size_t n, const wchar_t * restrict format, ...);</code> which includes the length implied by the <code>snwprintf()</code> name in Microsoft&#39;s realm, without including the <code>n</code> in the function name.  There&#39;s also no standard C <code>_wfopen()</code> or <code>wfopen()</code> function at all."}], "answers": [{"comments": [{"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1475027187, "post_id": 39736743, "comment_id": 66771491, "body": "Alternatively, if you can&#39;t conveniently change the argument to a wide string, you can use <code>%hs</code> to specify that the argument is a narrow string."}, {"owner": {"reputation": 23, "user_id": 6890753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c430f9c2e906dbafb50aaba883d187ce?s=128&d=identicon&r=PG&f=1", "display_name": "Better Fly", "link": "https://stackoverflow.com/users/6890753/better-fly"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1475054989, "post_id": 39736743, "comment_id": 66783492, "body": "@HarryJohnston i used your solution and solved the problem thank&#39;s."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 2, "last_activity_date": 1475027045, "creation_date": 1475027045, "answer_id": 39736743, "question_id": 39736168, "link": "https://stackoverflow.com/questions/39736168/get-chinese-characters-unexpectedly-when-using-snwprintf/39736743#39736743", "title": "Get Chinese characters unexpectedly when using _snwprintf", "body": "<pre><code>wchar_t outfile[1024];\nchar const*outf = \"test\";\n_snwprintf(outfile, 1024, L\"%s.zip\", outf);\n_wfopen(outfile, L\"wb\");\n</code></pre>\n\n<p><code>outf</code> is ANSI (<code>char</code>), but <code>outfile</code> is UTF-16 (<code>wchar_t</code>), and <code>_snwprintf</code> expects <code>wchar_t</code>. Visual Studio 2015 issues the following warning:</p>\n\n<blockquote>\n<pre><code>warning C4477: '_snwprintf' : format string '%s' requires an argument\nof type 'wchar_t *', but variadic argument 1 has type 'const char *'\n</code></pre>\n</blockquote>\n\n<p>You need to change the code to use <code>wchar_t</code>:</p>\n\n<pre><code>wchar_t outfile[1024];\nconst wchar_t* outf = L\"test\";\n_snwprintf(outfile, 1024, L\"%s.zip\", outf);\nwprintf(L\"%s\\n\", outfile);\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6890753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c430f9c2e906dbafb50aaba883d187ce?s=128&d=identicon&r=PG&f=1", "display_name": "Better Fly", "link": "https://stackoverflow.com/users/6890753/better-fly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 39736743, "answer_count": 1, "score": -1, "last_activity_date": 1475027472, "creation_date": 1475021724, "last_edit_date": 1475027472, "question_id": 39736168, "link": "https://stackoverflow.com/questions/39736168/get-chinese-characters-unexpectedly-when-using-snwprintf", "title": "Get Chinese characters unexpectedly when using _snwprintf", "body": "<p>When using _snwprintf, I am getting Chinese characters instead of English.</p>\n\n<pre><code>wchar_t outfile[1024];\nchar const*outf = \"test\";\n_snwprintf(outfile, 1024, L\"%s.zip\", outf);\n_wfopen(outfile, L\"wb\");\n</code></pre>\n\n<p>The file name should just be \"test\" but in the output file it is in Chinese.</p>\n\n<p>When I try like this there no problem, the output file contains English as expected:</p>\n\n<pre><code>_snwprintf(outfile, 1024, L\"justtest.zip\");\n_wfopen(outfile, L\"wb\");\n</code></pre>\n\n<p>How can I correct the first code block, in order to get the file name shown correctly in the output file?</p>\n"}, {"tags": ["c", "equation-solving"], "comments": [{"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 1, "creation_date": 1475021529, "post_id": 39736130, "comment_id": 66770132, "body": "<code>x</code> and <code>y</code> need to be <code>float</code>, too."}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1475021553, "post_id": 39736130, "comment_id": 66770141, "body": "You may want to change your integer division into floating point division. Adding a single dot after the 60&#39;s will take care of that (<code>60.</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1475021617, "post_id": 39736130, "comment_id": 66770160, "body": "@deamentiaemundi not necessarily, if (for some reason) you want to enforce integer speeds. The latter is not recommended though."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475023276, "post_id": 39736130, "comment_id": 66770612, "body": "1 / 60 is 0; multiply by 0 and the result is zero.  Use decimal points to indicate floating point constants: <code>1.0 &#47; 60.0</code> for example (I prefer the trailing 0; not everyone cares)."}, {"owner": {"reputation": 1, "user_id": 6890727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f6d57c765439afa6db96160e83de4e1?s=128&d=identicon&r=PG&f=1", "display_name": "jwloszek", "link": "https://stackoverflow.com/users/6890727/jwloszek"}, "edited": false, "score": 0, "creation_date": 1475023485, "post_id": 39736130, "comment_id": 66770662, "body": "I added the decimals behind the 60s to indicate floating point constants. I&#39;m now getting an output. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 6160020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YKm7XmRRzWk/AAAAAAAAAAI/AAAAAAAABMA/0SMhweWTkPY/photo.jpg?sz=128", "display_name": "aneesh jose", "link": "https://stackoverflow.com/users/6160020/aneesh-jose"}, "is_accepted": false, "score": 0, "last_activity_date": 1475028677, "creation_date": 1475028677, "answer_id": 39736962, "question_id": 39736130, "link": "https://stackoverflow.com/questions/39736130/i-keep-getting-zero-from-my-equations-and-do-not-know-why/39736962#39736962", "title": "I keep getting zero from my equations and do not know why", "body": "<p>Your first equation is equivalent to</p>\n\n<pre><code>a = ((((((x * 1) / 60) * 1) / 60) * 1) / 60) * 1000;\n</code></pre>\n\n<p>ie;</p>\n\n<pre><code>a = (x/(60*60*60)) * 1000;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>a = (x/(216000)) * 1000;\n</code></pre>\n\n<p>Even though your a is a float, RHS of your equation is doing integer division.</p>\n\n<p>Hence any value less than 216000 assigned to x will result in 0.</p>\n"}], "owner": {"reputation": 1, "user_id": 6890727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f6d57c765439afa6db96160e83de4e1?s=128&d=identicon&r=PG&f=1", "display_name": "jwloszek", "link": "https://stackoverflow.com/users/6890727/jwloszek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1475028677, "creation_date": 1475021455, "question_id": 39736130, "link": "https://stackoverflow.com/questions/39736130/i-keep-getting-zero-from-my-equations-and-do-not-know-why", "title": "I keep getting zero from my equations and do not know why", "body": "<p>Here is my full code. I keep getting zero for my equations no matter what i do. Any help would be greatly appreciated.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main(void)\n{\nint x, y;\nfloat a,t;\n//Inputs\nprintf(\"What is the speed that the jet is traveling in km/hr? \\nWhat is the distance traveled in meters? \\n\");\nscanf(\"%d , %d\", &amp;x, &amp;y );\n\n\n//Calculations\n\na = x * 1 / 60 * 1 / 60 * 1 / 60 * 1000 ;\n\nt = sqrt( y * a / 2  ) ;\n\n//Outputs\nprintf(\"The acceleration of the jet is %f meters per second squared. \\n\", a);\nprintf(\"The time it takes for the jet to reach takeoff speed is %f seconds. \\n\", t);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["ios", "c", "swift", "linker-errors", "libpd"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475020919, "post_id": 39736040, "comment_id": 66769975, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6284720/undefined-reference-c\">Undefined reference C++</a>"}, {"owner": {"reputation": 594, "user_id": 4987332, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Ag9Ke.png?s=128&g=1", "display_name": "PlateReverb", "link": "https://stackoverflow.com/users/4987332/platereverb"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475021398, "post_id": 39736040, "comment_id": 66770094, "body": "@Olaf I don&#39;t see any way that my .C file is being linked to more than once.  That other reference doesn&#39;t seem to apply to my problem, but if it does, could you tell me how it might?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475021460, "post_id": 39736040, "comment_id": 66770113, "body": "Is that a <code>.C</code> or a <code>.c</code> file? The first would be C++, not C."}, {"owner": {"reputation": 594, "user_id": 4987332, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Ag9Ke.png?s=128&g=1", "display_name": "PlateReverb", "link": "https://stackoverflow.com/users/4987332/platereverb"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475021606, "post_id": 39736040, "comment_id": 66770152, "body": "@Olaf It is a <code>.c</code> file (I corrected in the question title).  Most of my app is written in Swift.  I&#39;m just linking to this external via the bridging-header.  I&#39;ve had zero problems doing this until the latest Xcode 8 release."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1475021674, "post_id": 39736040, "comment_id": 66770173, "body": "Is the C file a target member of your executable?"}, {"owner": {"reputation": 594, "user_id": 4987332, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Ag9Ke.png?s=128&g=1", "display_name": "PlateReverb", "link": "https://stackoverflow.com/users/4987332/platereverb"}, "reply_to_user": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1475021725, "post_id": 39736040, "comment_id": 66770190, "body": "@zneak Yes, it is."}, {"owner": {"reputation": 22991, "user_id": 1169096, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b4d93e08b2830786a7992e8af35514c6?s=128&d=identicon&r=PG", "display_name": "uml&#228;ute", "link": "https://stackoverflow.com/users/1169096/uml%c3%a4ute"}, "edited": false, "score": 0, "creation_date": 1476987258, "post_id": 39736040, "comment_id": 67592134, "body": "btw, the error is about <code>x86_64</code> (aka <code>amd64</code>), i don&#39;t think that changing anything with <code>arm64</code> will solve this."}], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 4987332, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Ag9Ke.png?s=128&g=1", "display_name": "PlateReverb", "link": "https://stackoverflow.com/users/4987332/platereverb"}, "is_accepted": false, "score": 0, "last_activity_date": 1475022936, "creation_date": 1475022936, "answer_id": 39736297, "question_id": 39736040, "link": "https://stackoverflow.com/questions/39736040/c-file-via-bridging-header-not-working-after-xcode-8-update/39736297#39736297", "title": ".c File via Bridging Header Not Working After Xcode 8 Update", "body": "<p>Solved by @danomatika on GitHub: <a href=\"https://github.com/libpd/libpd/issues/149\" rel=\"nofollow\">https://github.com/libpd/libpd/issues/149</a></p>\n\n<p>\"You generally shouldn't include/import an implementation file aka .c, .cpp, .m, etc. This is what is causing the duplicate symbol issue.</p>\n\n<p>This is what the \"forward function declaration\" in the header file is for: to tell the compiler that a function exists and what data it takes/returns. The compiler then assumes the actual implementation of the function exists in an implementation file. If it can't be found, then you get an \"undefined symbol error.\" If you somehow end up declaring the function twice, aka include both a header with the forward declaration and the implemetaton of the function itself in the .c file, then you get a \"duplicate symbol error.\"</p>\n\n<p>This is all lower-level stuff that is only really an issue since Pd externals are designed around being dynamic libraries, so are not built or provided with headers which include the function declarations. This is why you have to do a little extra work and do it yourself.</p>\n\n<p>Their are two easy fixes for this, both of which involve declaring the required function you want to call from the .c file in a header file.</p>\n\n<ol>\n<li><p>Simply declare the function in the bridging header:</p>\n\n<p><code>void uzi_setup();</code></p></li>\n<li><p>Create a header, say Externals.h, and declare all of the externals stuff there:</p>\n\n<p><code>// forward declare setup functions only found in .c implementations \nvoid uzi_setup();</code></p>\n\n<p><code>// convenience wrapper function\nvoid externals_setup() {\n    uzi_setup();\n}</code></p>\n\n<p>Then import the file in your bridging header:</p>\n\n<p><code>#import \"Externals.h\"</code></p>\n\n<p>And in swift, you can now do:</p>\n\n<p><code>externals_setup()</code></p></li>\n</ol>\n"}], "owner": {"reputation": 594, "user_id": 4987332, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Ag9Ke.png?s=128&g=1", "display_name": "PlateReverb", "link": "https://stackoverflow.com/users/4987332/platereverb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1475022936, "creation_date": 1475020648, "last_edit_date": 1475021679, "question_id": 39736040, "link": "https://stackoverflow.com/questions/39736040/c-file-via-bridging-header-not-working-after-xcode-8-update", "title": ".c File via Bridging Header Not Working After Xcode 8 Update", "body": "<p>The app I've been working on uses an external library, pdlib, which has it's own externals (.c files) which I've been importing via the bridging header <code>#import \"Uzi.c\"</code> and calling in my main Swift file via Uzi.c's setup function <code>Uzi_setup()</code> in my <code>ViewController</code> class.  I've had no problem with this until after updating to new public Xcode 8 a few days ago (I had no problem with Xcode 8 Beta 1 over the Summer).  </p>\n\n<p>Here are the 7 errors I get, listed under a single \"Mach-O Linker Error\" umbrella:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n\"_Uzi_bang\", referenced from:\n  _Uzi_setup in ViewController.o\n\"_Uzi_class\", referenced from:\n  _Uzi_setup in ViewController.o\n\"_Uzi_float\", referenced from:\n  _Uzi_setup in ViewController.o\n\"_Uzi_new\", referenced from:\n  _Uzi_setup in ViewController.o\n\"_Uzi_pause\", referenced from:\n  _Uzi_setup in ViewController.o\n\"_Uzi_resume\", referenced from:\n  _Uzi_setup in ViewController.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Those undefined symbols are 6 functions and a class declare from Uzi.c.  Here's a link to the whole c file: <a href=\"https://github.com/electrickery/pd-miXedSon/blob/master/hammer/Uzi.c\" rel=\"nofollow\">https://github.com/electrickery/pd-miXedSon/blob/master/hammer/Uzi.c</a></p>\n\n<p>I've tried every solution I've found online for dealing with similar problems, with no solution yet... I tried changing the \"Architecture\" and \"Valid Architecture\" settings to only armv7 and armv7s (no arm64) and changed \"Build Active Architecture Only\" to \"No\".  These step seem to help others in similar situations, but they didn't work for me (and taking away arm64 causes additional errors to appear).</p>\n\n<p>XCode 8 is pretty recent (the public version was released Sept. 13), so there are virtually no other questions about this upgrade causing a similar problem.  </p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["c", "gcc", "ansi", "c89"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475020320, "post_id": 39735926, "comment_id": 66769821, "body": "MSVC does only support C90 (aka ISO-C90, aka ANSI-C89). It is not compliant to the C standard since ca. 17 years. Not sure what your problem is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 2, "creation_date": 1475020479, "post_id": 39735926, "comment_id": 66769868, "body": "Curious: why do you want to use C89? If you need to support some very old platform, perhaps it&#39;s better to try and compile on that directly?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475020657, "post_id": 39735926, "comment_id": 66769909, "body": "@Olaf: Apparently the problem is that it&#39;s not properly diagnosing code that is invalid in C89/C90, such as <code>&#47;&#47;</code> comments and mixed declarations and statements."}, {"owner": {"reputation": 123, "user_id": 5530737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/07894e756d5afbbda04c6a4973b1f90e?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf Jama", "link": "https://stackoverflow.com/users/5530737/yusuf-jama"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475021031, "post_id": 39735926, "comment_id": 66770003, "body": "@Olaf how can I force the compiler in MSVC 2013 to do what I said? (The // comments as well as declaring all variable at the top of a function)"}, {"owner": {"reputation": 123, "user_id": 5530737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/07894e756d5afbbda04c6a4973b1f90e?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf Jama", "link": "https://stackoverflow.com/users/5530737/yusuf-jama"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475021128, "post_id": 39735926, "comment_id": 66770030, "body": "@Olaf As in I want the errors to display stating these issues. It is not doing so"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475021163, "post_id": 39735926, "comment_id": 66770040, "body": "@YusufJama: Sorry, I don&#39;t use not standard compliant compilers and definitively not VS. And I don&#39;t use ancient C dialects either. There are good reasons to use modern C aside line-comments and mixing declarations and statements. Not sure why you don&#39;t want line-comments, they are very useful for commenting the code."}, {"owner": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475023596, "post_id": 39735926, "comment_id": 66770675, "body": "@Olaf When working in embedded systems modern C can not be used in a lot of cases (no modern compiler for the target platform / customers do not want to update to a new compiler / you build a multi-target engine and want to support old platforms / ... )"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "edited": false, "score": 0, "creation_date": 1475023969, "post_id": 39735926, "comment_id": 66770732, "body": "@GuillaumeGeorge: Do tell! That does not excuse using standard C on platforms you can get modern compilers which do support the standard. Re. embedded: Even MISRA moved on to C99 (though not standard C) and allows e.g. line-comments (which sane developer would not want those??). And with e.g. gcc there is a modern compiler at least for modern embedded CPUs (ARM, MSP430, many 8 bit MCUs, etc.). Support from modern compilers is one factor of design-decission. Sticking with outdated hardware and tools is often more expensive than moving on. ..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "edited": false, "score": 0, "creation_date": 1475024120, "post_id": 39735926, "comment_id": 66770767, "body": "@GuillaumeGeorge: ... and is one task of good embedded consulting/system architecture. First rule: the customer does not know about current development. Without external help they&#39;d stick with their 1980/90ies tools forever. (maintenance of legacies is a much more complicated subject)"}, {"owner": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475025124, "post_id": 39735926, "comment_id": 66771004, "body": "@Olaf Of course no developer want to stick to these old standards, but if you are in a software company targeting embedded systems you only develop libraries for your customers and your customers choose the hard they want (I am currently working on a GUI library for embedded systems). To come back to the subject, OP may not have the choice."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "edited": false, "score": 0, "creation_date": 1475025327, "post_id": 39735926, "comment_id": 66771045, "body": "@GuillaumeGeorge: Well, I happen to have an embedded systems company and provide consulting from hardware to application-software. And I can assure you there is much less need to use those legacies than one might think after a first talk with a new customer. But it does require some efforts at convincing, good arguments and a good overal concept. From my experience, most developers just try to avoid these discussions. Until now my customers are very satisfied with my recommendations. YMMV, just don&#39;t claim your experiences are universally valid."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "edited": false, "score": 0, "creation_date": 1475025621, "post_id": 39735926, "comment_id": 66771114, "body": "@GuillaumeGeorge: OP apparently uses MSVC. Do you know a platform it supports which is not also supported by at least gcc and clang? Re. &quot;No developer wants ...&quot; - There are way too many developers who stick with what they learned once and put a serious effort into <b>avoiding</b> to learn new tricks. Actually they are often the toughest problem when it comes to introducing new techiques in a company."}], "owner": {"reputation": 123, "user_id": 5530737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/07894e756d5afbbda04c6a4973b1f90e?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf Jama", "link": "https://stackoverflow.com/users/5530737/yusuf-jama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475019687, "creation_date": 1475019687, "question_id": 39735926, "link": "https://stackoverflow.com/questions/39735926/running-c89-on-visual-studio-2013", "title": "running c89 on visual studio 2013", "body": "<p>How can I force c89 standards in Visual Studio 2013?\nI've switch \"Disable Language Extensions\" in to \"Yes (/Za) and set warning to -Wall. The errors I want Visual studio to display is if I use // comments or also if I don't declare all variable at the top of a function. </p>\n"}]