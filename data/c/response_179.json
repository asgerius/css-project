[{"tags": ["python", "c", "python-3.x", "python-c-api"], "answers": [{"comments": [{"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1528932017, "post_id": 50847555, "comment_id": 88698576, "body": "You were correct, it builds the code, but the Interpreter still crashes.  I will edit my post to make it  a little more reproducible."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1528932064, "post_id": 50847555, "comment_id": 88698589, "body": "By &quot;<i>crashes</i>&quot; you mean <code>NameError</code>?"}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1528932167, "post_id": 50847555, "comment_id": 88698616, "body": "No.   I mean the interpreter opens momentarily and closes (I added an <code>input()</code> so I know something is wrong).  If I run it from the IDLE <code>Shell</code> comes up.  There are no errors unfortunately."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1528932482, "post_id": 50847555, "comment_id": 88698672, "body": "And only when you access <code>DEFINED</code> ? Try other members (<code>restart</code>) as well. Anyway <code>PyModule_New</code>  and <code>PyModule_Create</code> doesn;t seem right to me. Try <code>return value;</code> (and initialize it <code>value = PyModule_Create(&amp;func);</code>)."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1528932668, "post_id": 50847555, "comment_id": 88698706, "body": "Yep exactly the same I&#39;m afraid,  it closes when I import the module."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1528932750, "post_id": 50847555, "comment_id": 88698723, "body": "I tried <code>return value;</code> I got <code>SystemError: initialization of Utilities did not return an extension module</code>"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 1, "creation_date": 1528932996, "post_id": 50847555, "comment_id": 88698788, "body": "That should be the way. Watch out for <b>U</b>tilities vs <b>u</b>tilities (including in your <i>setup.py</i>). All should match. Also <code>spammethods</code> should end in <code>{NULL, NULL, 0, NULL}</code>. But anyway I&#39;m confused, in the question there is some code that&#39;s working. Don&#39;t change it after posting the question (or if you do adapt the question accordingly)."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1528933297, "post_id": 50847555, "comment_id": 88698840, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173105/discussion-between-simon-and-cristifati\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 2, "last_activity_date": 1534976249, "last_edit_date": 1534976249, "creation_date": 1528931517, "answer_id": 50847555, "question_id": 50847365, "link": "https://stackoverflow.com/questions/50847365/using-pymodule-addintconstant-in-an-extension/50847555#50847555", "title": "Using PyModule_AddIntConstant() in an extension", "body": "<p><code>PyModule_AddIntConstant(value, \"DEFINED\", DEFINED_VALUE);</code> is correct (assuming that <code>DEFINED_VALUE</code> is a (<em>C</em>) <code>long</code>).</p>\n\n<p>That, combined with the linker error at the end (and with the fact that you're writing code then testing, and so on ...) tells me that the linker is not able to write the new <em>.pyd</em> file (that contains the latest changes - including <code>DEFINED</code> variable), because it's in use by a previously started <em>python.exe</em> process that imported your module.</p>\n\n<ul>\n<li>Close <strong>every</strong> running interpreter that imported your module (to \"unlock\" <em>WinUtils.cp36-win32.pyd</em>)</li>\n<li>Build (this time, the linker will be able to overwrite the file)</li>\n<li>Test (run your <em>Python</em> code)</li>\n</ul>\n\n<p>Note: you could check the function return value (<a href=\"https://docs.python.org/3.5/c-api/module.html#c.PyModule_AddIntConstant\" rel=\"nofollow noreferrer\">[Python]: int <strong>PyModule_AddIntConstant</strong>(<em>PyObject *module, const char *name, long value</em>)</a>).</p>\n\n<p><strong><em>@EDIT0</em></strong> (regarding the 2<sup>nd</sup> problem):</p>\n\n<p>As I pecified in my one of my comments, use <code>PyModule_Create</code> (as according to <a href=\"https://docs.python.org/3/c-api/module.html#c.PyModule_New\" rel=\"nofollow noreferrer\">[Python]: PyObject* <strong>PyModule_New</strong>(<em>const char *name</em>)</a>, you're getting <em>Undefined Behavior</em>):</p>\n\n<pre><code>PyMODINIT_FUNC PyInit_utilities() {\n    PyObject *mod = PyModule_Create(&amp;func);\n    PyModule_AddIntConstant(mod, \"DEFINED\", AF_INET);\n    return mod;\n}\n</code></pre>\n"}], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 50847555, "answer_count": 1, "score": 0, "last_activity_date": 1534976249, "creation_date": 1528930080, "last_edit_date": 1528933723, "question_id": 50847365, "link": "https://stackoverflow.com/questions/50847365/using-pymodule-addintconstant-in-an-extension", "title": "Using PyModule_AddIntConstant() in an extension", "body": "<p>I have seen <a href=\"https://stackoverflow.com/questions/23788140/adding-symbolic-constants-with-hex-values-to-python-extension-module\">Adding symbolic constants with hex values to Python extension module</a> and I am trying to reproduce this effect:</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;Windows.h&gt;\n\nstatic PyObject * sys_shutdown(PyObject *self, PyObject *args) {\n    int val;\n\n    if (!PyArg_ParseTuple(args, \"i\", &amp;val))\n        val = SHTDN_REASON_MINOR_OTHER; // Provide failsafe\n\n    ExitWindowsEx(EWX_POWEROFF, val); // Shutdown\n    return Py_BuildValue(\"\");\n}\n\nstatic PyObject * sys_restart(PyObject *self, PyObject *args) {\n    int val;\n\n    if (!PyArg_ParseTuple(args, \"i\", &amp;val))\n        val = SHTDN_REASON_MINOR_OTHER; // Provide failsafe\n    ExitWindowsEx(EWX_REBOOT, val); // Restart\n    return Py_BuildValue(\"\");\n}\n\nstatic PyObject * sys_log_out(PyObject *self, PyObject *args) {\n    int val;\n\n    if (!PyArg_ParseTuple(args, \"i\", &amp;val))\n        val = SHTDN_REASON_MINOR_OTHER; // Provide failsafe\n\n    ExitWindowsEx(EWX_LOGOFF, val); // Log out\n    return Py_BuildValue(\"\");\n}\n\nstatic PyMethodDef localMethods[] = {\n    {\"shutdown\", (PyCFunction)sys_shutdown, METH_VARARGS, \"...\"},\n    {\"restart\", (PyCFunction)sys_restart, METH_VARARGS, \"...\"},\n    {\"log_out\", (PyCFunction)sys_log_out, METH_VARARGS, \"...\"},\n    {NULL, NULL, 0, NULL}\n};\n\nstatic struct PyModuleDef func = {\n    PyModuleDef_HEAD_INIT,\n    \"utilities\",\n    \"...\",\n    -1,\n    localMethods,\n};\n\nPyMODINIT_FUNC PyInit_utilities(void) {\n    PyObject *value;\n\n    value = PyModule_New(&amp;func);\n\n    PyModule_AddIntConstant(value, \"DEFINED\", AF_INET);\n\n    return PyModule_Create(&amp;func);\n}\n</code></pre>\n\n<p>Setup Script:</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nmodule = Extension(\n    \"utilities\", \n    sources = [\"main.c\"],\n        libraries = [\"user32\"]\n)\n\nsetup (\n    name = \"Utilities\",\n    version = \"1.0\",\n    ext_modules = [module])\n</code></pre>\n\n<p>Everything builds as expected, however I cannot use <code>DEFINED</code> in my extension:</p>\n\n<pre><code>import utilities\nfor i in utilities.__dict__: print(i)\nutilities.DEFINED # AttributeError: module 'utilities' has no attribute 'DEFINED'\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>__name__\n__doc__\n__package__\n__loader__\n__spec__\nshutdown\nrestart\nlog_out\n__file__\n</code></pre>\n\n<p>I thought of returning <code>value</code> like so:</p>\n\n<pre><code>return PyModule_Create(&amp;value);\n</code></pre>\n\n<p>But that returns:</p>\n\n<blockquote>\n  <p>LINK : fatal error LNK1104: cannot open file 'build\\lib.win32-3.6\\WinUtils.cp36-win32.pyd'\n  error: command 'C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\WDExpress\\VC\\Tools\\MSVC\\14.14.26428\\bin\\HostX86\\x86\\link.exe' failed with exit status 1104</p>\n</blockquote>\n\n<p>How can I add the <code>DEFINED</code> value to my extension (so that I can run <code>utilities.DEFINED</code>)?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>As mentioned in the answer below closing everything and trying again builds the extension successfully, however using <code>return PyModule_Create(&amp;value);</code> still crashes.</p>\n"}, {"tags": ["c", "char", "typedef"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528929196, "post_id": 50847133, "comment_id": 88697849, "body": "There is incomplete code, when a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> is usual. Minor: <code>int choix</code> is uninitialsed, so a better loop might be <code>while((choix = menu(automate)) != 6) { switch &#47;* etc *&#47; }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529077539, "post_id": 50847133, "comment_id": 88759829, "body": "Header files are for 1) function signatures 2) data definitions 3) macros  NOT for source code.  The source code should be in a separate .C file,  Compile both .C files, then link them together.  Both .C files should <code>#include</code> the header file."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528929359, "post_id": 50847199, "comment_id": 88697893, "body": "Also: <code>scanf(&quot;%c&quot;, &amp;transition.etiquette);</code>"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1528929541, "last_edit_date": 1528929541, "creation_date": 1528929070, "answer_id": 50847199, "question_id": 50847133, "link": "https://stackoverflow.com/questions/50847133/typedef-struct-and-char-in-c-programming/50847199#50847199", "title": "typedef struct and char in C programming", "body": "<p>The <code>menu()</code> function probably isn't reading the newline after the menu selection. Either fix that function, or change your <code>scanf()</code> format string to skip over whitespace before the character.</p>\n\n<pre><code>        scanf(\" %c\",&amp;automate-&gt;alphabet[automate-&gt;nbre_caracteres]);\n</code></pre>\n\n<p>You should do the same thing for all the other <code>scanf()</code> operations that use <code>%c</code>.</p>\n\n<p>A better option may be to use <code>fgets()</code> to read whole lines into strings, rather than using <code>scanf()</code> to read user input. You can use <code>sscanf()</code> to parse the input lines.</p>\n"}], "owner": {"reputation": 97, "user_id": 8732749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4296ca4f71db4d120553df75c59b203f?s=128&d=identicon&r=PG&f=1", "display_name": "K.J Fogang Fokoa", "link": "https://stackoverflow.com/users/8732749/k-j-fogang-fokoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528929541, "creation_date": 1528928660, "last_edit_date": 1528928907, "question_id": 50847133, "link": "https://stackoverflow.com/questions/50847133/typedef-struct-and-char-in-c-programming", "title": "typedef struct and char in C programming", "body": "<p>I find myself stuck for a few minutes on a piece of code that does not work as I wish. Indeed I would like to insert a character into a structure that contains an array of characters.</p>\n\n<p>Here's an excerpt from the code snippet \"automates.h\":</p>\n\n<pre><code>void ajouterCaractere(Automate *automate) {\n    if(automate-&gt;nbre_caracteres &gt;= MAX_CARACTERES){\n        printf(\"Vous avez deja atteint le nombre de caracteres maximal pour l'alphabet de votre automate !\\n\");\n    }\n    else {\n        printf(\"Veuillez inserer un caractere dans alphabet :\\n\");\n        scanf(\"%c\",&amp;automate-&gt;alphabet[automate-&gt;nbre_caracteres]);\n        automate-&gt;nbre_caracteres++;\n    }\n}\n\n// Remplir les \u00e9tats\nvoid ajouterEtat(Automate *automate) {\n    if (automate-&gt;nbre_etats &gt;= MAX_ETATS) {\n        printf(\"Vous avez deja atteint le nombre d'etats maximal pour votre automate !\\n\");\n    }\n    else {\n        printf(\"Veuillez inserer un etat de votre automate :\\n\");\n        scanf(\"%d\", &amp;automate-&gt;tableau_Etat[automate-&gt;nbre_etats]);\n        automate-&gt;nbre_etats++;\n    }\n}\n\n// Remplir les \u00e9tats initiaux\nvoid ajouterEtatInitial(Automate *automate) {\n    if (automate-&gt;nbre_etats_initiaux &gt;= MAX_ETATS_INITIAUX) {\n        printf(\"Vous avez deja atteint le nombre d'etats initiaux maximal pour votre automate !\\n\");\n    }\n    else {\n        printf(\"Veuillez inserer les etats initiaux de votre automate :\\n\");\n        scanf(\"%d\",&amp;automate-&gt;tableau_EI[automate-&gt;nbre_etats_initiaux]);\n        automate-&gt;nbre_etats_initiaux++;\n    }\n}\n\n// Remplir les \u00e9tats finaux\nvoid ajouterEtatFinal(Automate *automate) {\n    if (automate-&gt;nbre_etats_finaux &gt;= MAX_ETATS_FINAUX) {\n        printf(\"Vous avez deja atteint le nombre d'etats finaux maximal pour votre automate !\\n\");\n    }\n    else {\n        printf(\"Veuillez inserer les etats finaux de votre automate :\\n\");\n        scanf(\"%d\",&amp;automate-&gt;tableau_EF[automate-&gt;nbre_etats_finaux]);\n        automate-&gt;nbre_etats_finaux++;\n    }\n}\n\n// Remplir les transitions\nvoid ajouterTransition(Automate *automate) {\n    Transition transition;\n    int i;\n\n    if (automate-&gt;nbre_transitions &gt;= MAX_TRANSITIONS) {\n        printf(\"Vous avez deja atteint le nombre de transition maximal pour votre automate !\\n\");\n    }\n    else {\n        printf(\"Transition %d\\n\", automate-&gt;nbre_transitions+1);\n        printf(\"\\t Etat de depart :   \");           /* L'\u00e9tat de d\u00e9part de la transition */\n        scanf(\"%d\", &amp;transition.etat_depart);\n        printf(\"\\t Etiquette :   \");                /* L'\u00e9tiquette de la transition */\n        scanf(\"%c\", &amp;transition.etiquette);         \n        printf(\"\\t Etat d'arrive :   \");            /* L'\u00e9tat d'arriv\u00e9 de la transition */\n        scanf(\"%d\", &amp;transition.etat_final);\n\n        automate-&gt;tableau_transition[automate-&gt;nbre_transitions] = transition;\n        automate-&gt;nbre_transitions++;\n    }\n}\n</code></pre>\n\n<p>Here's my main.c :</p>\n\n<pre><code>Automate *automate;\n    int choix;\n\n    automate = (Automate *) malloc (sizeof(Automate));\n    if (automate == NULL)\n        printf(\"Erreur lors de l'allocation de la m\u00e9moire \u00e0 l'automate !\\n\");\n\n    initialisation(automate);\n    //consigne();\n    while(choix != 6) {\n        choix = menu(automate);\n        switch(choix) {\n            case 1:\n                ajouterCaractere(automate);\n                break;\n            case 2:\n                ajouterEtat(automate);\n                break;\n            case 3:\n                ajouterEtatInitial(automate);\n                break;\n            case 4:\n                ajouterEtatFinal(automate);\n                break;\n            case 5:\n                ajouterTransition(automate);\n                break;\n            default :\n                printf(\"Faites un choix correcte !\");\n                break;\n        }\n    }\n</code></pre>\n\n<p>When i compile i get this :</p>\n\n<pre><code>******** MENU ********\n1.  Ajouter un caractere dans l'alphabet\n2.  Quitter !\nFaites votre choix :   \n1\nVeuillez inserer un caractere dans alphabet :\n\n******** MENU ********\n1.  Ajouter un caractere\n2.  Ajouter un etat\n3.  Ajouter un etat initial\n4.  Ajouter un etat final\n5.  Ajouter une transition\n6.  Quitter\nFaites votre choix :\n</code></pre>\n\n<p>As you can see, when I type 1, it does not allow to insert a character in the table.</p>\n\n<p>How to fix this problem?</p>\n\n<p>Thank you in advance !</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1528928687, "post_id": 50847121, "comment_id": 88697719, "body": "I don&#39;t know about anybody else, but I don&#39;t consider a short read to be an error at all."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1528928747, "post_id": 50847121, "comment_id": 88697732, "body": "You&#39;d probably have to have your short read return <code>M</code>, and then have the next call return <code>-EIO</code>."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 4, "creation_date": 1528929219, "post_id": 50847121, "comment_id": 88697856, "body": "My opinion: @SteveSummit is exactly right. Most char devices return the short count (except 0, in which case they return an error code, e.g. -EIO). The error can be reported on the next read, via a separate call (ioctl() for example; compare to how sockets use <code>MSG_ERRQUE</code> flag to receive error data), or via a signal (as e.g. O_ASYNC descriptor status flag does; POSIX realtime signals are queued and can have one long or pointer as payload). I would use the ioctl() approach, with the signal as an option (also set via fcntl()); or report the error on the next read if important (data was lost)."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1528931010, "post_id": 50847121, "comment_id": 88698354, "body": "I&#39;d expect a short read and -EIO on the read after that."}], "owner": {"reputation": 4728, "user_id": 2457733, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/LG30R.png?s=128&g=1", "display_name": "It&#39;sPete", "link": "https://stackoverflow.com/users/2457733/itspete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528928592, "creation_date": 1528928592, "question_id": 50847121, "link": "https://stackoverflow.com/questions/50847121/linux-device-driver-error-reporting-for-partial-read-write", "title": "Linux Device Driver: Error reporting for partial read()/write()", "body": "<p>I am implementing a Linux device driver that can have partial reads and writes.  For example, the caller may have requested to read N bytes from the device, but part of the way through an error was encountered and now the driver has M bytes available to pass back to userspace.</p>\n\n<p>How do I report the error back to userspace?  For example, I would normally do something like <code>return -EIO;</code> in the event of an I/O error, but this does not tell the whole story (i.e., the caller might be interested in the fact that there still are M usable bytes).</p>\n\n<p>I'm aware of the fact that setting <code>errno</code> isn't a thing in kernel space (see here: <a href=\"https://stackoverflow.com/questions/40574018/errno-undeclared-when-compile-linux-kernel?noredirect=1&amp;lq=1\">&quot;&#39;errno&#39; undeclared&quot; when compile Linux kernel</a>), but is there any way that in my scenario I can return M, but also indicate the cause of the short read?  How is this generally handled by other device drivers?  Do you just return the error code and don't try to indicate that part of the buffer might be usable?</p>\n"}, {"tags": ["python", "c", "python-3.x", "python-c-api"], "comments": [{"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1529693431, "post_id": 50845740, "comment_id": 88982596, "body": "Note that if this is not a system runtime, this is a way to do it with the anwer below"}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "is_accepted": true, "score": 2, "last_activity_date": 1528922056, "creation_date": 1528922056, "answer_id": 50845854, "question_id": 50845740, "link": "https://stackoverflow.com/questions/50845740/dealing-with-error-lnk2001-unresolved-external-symbol-imp-exitwindowsex8-in/50845854#50845854", "title": "Dealing with error LNK2001: unresolved external symbol __imp__ExitWindowsEx@8 in Python extensions", "body": "<p>Right I found the solution.  The linker path is already set for system runtimes.  All I had to do was link the runtime itself.  This can be done using the <code>library</code> attribute in the setup script:</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nmodule = Extension(\n    \"sys_shutdown\", \n    sources = [\"main.c\"],\n    libraries = [\"user32\"] # &lt;-- Here it is\n)\n\nsetup (\n    name = \"sys_shutdown\",\n    version = \"1.0\",\n    ext_modules = [module])\n</code></pre>\n"}], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "accepted_answer_id": 50845854, "answer_count": 1, "score": 0, "last_activity_date": 1528922056, "creation_date": 1528921601, "question_id": 50845740, "link": "https://stackoverflow.com/questions/50845740/dealing-with-error-lnk2001-unresolved-external-symbol-imp-exitwindowsex8-in", "title": "Dealing with error LNK2001: unresolved external symbol __imp__ExitWindowsEx@8 in Python extensions", "body": "<p>I am trying to build a C project.  I think the source is fine, however I am getting this error:</p>\n\n<blockquote>\n  <p>error LNK2001: unresolved external symbol __imp__ExitWindowsEx@8</p>\n</blockquote>\n\n<p>Or for the complete traceback:</p>\n\n<pre><code>C:\\Users\\Simon\\Desktop\\Learn&gt;python setup.py build\nrunning build\nrunning build_ext\nbuilding 'sys_shutdown' extension\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\WDExpress\\VC\\Tools\\MSVC\\14.14.26428\\bin\\HostX86\\x86\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MT -IC:\\Users\\Simon\\AppData\\Local\\Programs\\Python\\Python36-32\\include -IC:\\Users\\Simon\\AppData\\Local\\Programs\\Python\\Python36-32\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\WDExpress\\VC\\Tools\\MSVC\\14.14.26428\\include\" \"-IC:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\include\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17134.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17134.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17134.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17134.0\\winrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17134.0\\cppwinrt\" /Tcmain.c /Fobuild\\temp.win32-3.6\\Release\\main.obj\nmain.c\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\WDExpress\\VC\\Tools\\MSVC\\14.14.26428\\bin\\HostX86\\x86\\link.exe /nologo /INCREMENTAL:NO /LTCG /nodefaultlib:libucrt.lib ucrt.lib /DLL /MANIFEST:EMBED,ID=2 /MANIFESTUAC:NO /LIBPATH:C:\\Users\\Simon\\AppData\\Local\\Programs\\Python\\Python36-32\\libs /LIBPATH:C:\\Users\\Simon\\AppData\\Local\\Programs\\Python\\Python36-32\\PCbuild\\win32 \"/LIBPATH:C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\WDExpress\\VC\\Tools\\MSVC\\14.14.26428\\lib\\x86\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\lib\\um\\x86\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.17134.0\\ucrt\\x86\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.17134.0\\um\\x86\" /EXPORT:PyInit_sys_shutdown build\\temp.win32-3.6\\Release\\main.obj /OUT:build\\lib.win32-3.6\\sys_shutdown.cp36-win32.pyd /IMPLIB:build\\temp.win32-3.6\\Release\\sys_shutdown.cp36-win32.lib\n   Creating library build\\temp.win32-3.6\\Release\\sys_shutdown.cp36-win32.lib and object build\\temp.win32-3.6\\Release\\sys_shutdown.cp36-win32.exp\nmain.obj : error LNK2001: unresolved external symbol __imp__ExitWindowsEx@8\nbuild\\lib.win32-3.6\\sys_shutdown.cp36-win32.pyd : fatal error LNK1120: 1 unresolved externals\nerror: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2017\\\\WDExpress\\\\VC\\\\Tools\\\\MSVC\\\\14.14.26428\\\\bin\\\\HostX86\\\\x86\\\\link.exe' failed with exit status 1120\n</code></pre>\n\n<p>I worked out from <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/706bea92-1931-4abf-9af5-41020c909a70/problem-using-exitwindowsex?forum=vcgeneral\" rel=\"nofollow noreferrer\">here</a> that <code>__imp__ExitWindowsEx@8</code> is caused by the necessary runtime not being found.</p>\n\n<blockquote>\n  <p>Don't link using the #using but link using the linker command line. You can do that by adding the user32.lib to the linker command</p>\n</blockquote>\n\n<p>I tried this in my setup script using <a href=\"https://docs.python.org/3/distutils/apiref.html#distutils.core.Extension\" rel=\"nofollow noreferrer\"><code>extra_objects</code></a>:</p>\n\n<pre><code>import setup, Extension\n\nmodule = Extension(\n    \"sys_shutdown\", \n    sources = [\"main.c\"],\n        extra_objects = [\"C:\\\\Program Files (x86)\\\\Windows Kits\\\\10\\Lib\\\\10.0.17134.0\\\\um\\\\arm64\\\\User32.Lib\"]\n)\n\nsetup (\n    name = \"sys_shutdown\",\n    version = \"1.0\",\n    ext_modules = [module])\n</code></pre>\n\n<p>My <code>main.c</code> file (so you know why and what I need to link to):</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;Windows.h&gt;\n\n\n/* The functions that need to be created */\n\nstatic PyObject * sys_shutdown(PyObject *self) {\n    ExitWindowsEx(EWX_POWEROFF, SHTDN_REASON_MINOR_OTHER); // Shutdown\n    return Py_BuildValue(\"\");\n}\n\nstatic PyObject * sys_restart(PyObject *self) {\n    ExitWindowsEx(EWX_REBOOT, SHTDN_REASON_MINOR_OTHER); // Restart\n    return Py_BuildValue(\"\");\n}\n\nstatic PyObject * sys_log_out(PyObject *self) {\n    ExitWindowsEx(EWX_LOGOFF, SHTDN_REASON_MINOR_OTHER); // Log out\n    return Py_BuildValue(\"\");\n}\n\nstatic PyMethodDef allMethods[] = {\n    {\"sys_shutdown\", (PyCFunction)sys_shutdown, METH_NOARGS, \"Shuts down the device\"},\n    {\"sys_restart\", (PyCFunction)sys_restart, METH_NOARGS, \"Restarts the device\"},\n    {\"sys_log_out\", (PyCFunction)sys_log_out, METH_NOARGS, \"Closes all processes and logs out the user from the device\"},\n    {NULL, NULL, 0, NULL}\n};\n\nstatic struct PyModuleDef allModule = {\n    PyModuleDef_HEAD_INIT,\n    \"System Functions\",\n    \"sys_shutdown\",\n    -1,\n    allMethods\n};\n\nPyMODINIT_FUNC PyInit_sys_shutdown(void) {\n    return PyModule_Create(&amp;allModule);\n}\n</code></pre>\n\n<p>This extension requires the <code>ExitWindowsEx()</code> function provided by the <code>user32.dll</code></p>\n\n<p>How can I link the <code>user32.dll</code> to my extension (or if I have missed the plot completely how can I make it compile correctly)?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1528920614, "post_id": 50845418, "comment_id": 88694441, "body": "Related: <a href=\"https://stackoverflow.com/q/19452971/1606345\">stackoverflow.com/q/19452971/1606345</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528920886, "post_id": 50845418, "comment_id": 88694562, "body": "Is your question essentially &quot;<i>I would like to define my own __arraycount macro, which will not compile when given a pointer to array.</i>&quot; ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528921461, "post_id": 50845418, "comment_id": 88694880, "body": "I think you might utilize the fact that <code>(some_int_type) p == (some_int_type)&amp;p</code> for arrays, but not for pointers"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528921938, "post_id": 50845418, "comment_id": 88695143, "body": "@KamilCuk Cool. They use the method I just proposed.. I can be proud of myself :)"}], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "closed_date": 1528924283, "answer_count": 0, "score": 1, "last_activity_date": 1528920841, "creation_date": 1528920435, "last_edit_date": 1528920841, "question_id": 50845418, "link": "https://stackoverflow.com/questions/50845418/how-to-check-if-an-array-is-of-constant-known-size", "closed_reason": "Duplicate", "title": "How to check if an array is of constant known size?", "body": "<p>In C we have pointers to arrays objects and <a href=\"http://en.cppreference.com/w/c/language/array\" rel=\"nofollow noreferrer\">arrays of constant known size</a>.<br>\nThe NetBSD defines an <a href=\"http://netbsd.gw.com/cgi-bin/man-cgi?__arraycount+3\" rel=\"nofollow noreferrer\">__arraycount</a> macro, which is defined as <code>#define __arraycount(x) (sizeof(x)/sizeof(x[0]))</code>.<br>\nI wouls like to define my own <code>__arraycount</code> macro, which will not compile when given a pointer to array. To do that, i need a <code>__is_array_of_constant_known_size</code> macro.<br>\nI would like to have a macro that is a compile time constant which for arrays of constant known size will return true/nonzero and for pointers to array objects (or any other pointers) will return false/zero.<br>\nThis is what i've come up with:</p>\n\n<pre><code>#if __GNUC__\n#define __is_array_of_constant_known_size(x)  ( __builtin_constant_p((void*)x == (void*)&amp;x)?1:0 )\n#else\n#define __is_array_of_constant_known_size(x)  ( (void*)&amp;x[0] == (void*)&amp;x )\n#endif\n\n// __arraycount may look like this:\n#define __arraycount(x)  ( sizeof(char[__is_array_of_constant_known_size(x) ? 1 : -1]) ? (sizeof(x)/sizeof(x[0])) : -1 )\n\n// tests:\nstatic char var1[5];\ntypedef char type1[__is_array_of_constant_known_size(var1)?1:-1];\nstatic const int int1 = __is_array_of_constant_known_size(var1);\nstatic const int sizeof1 = sizeof(char[__is_array_of_constant_known_size(var1)?1:-1]);\n\nstatic char * var2;\ntypedef char type2[__is_array_of_constant_known_size(var2)?1:-1]; // should error\nstatic const int int2 = __is_array_of_constant_known_size(var2);\nstatic const int sizeof2 = sizeof(char[__is_array_of_constant_known_size(var2) 1:-1]); // should error\n</code></pre>\n\n<p>For GNUC compilers (clang6.0.0 and gcc8.1) tests are ok, ie. the lines containing <code>type2</code> and <code>sizeof2</code> fail to compile with <code>error: size of array is negative</code>.<br>\nHowever when GNUC is not defined, then i get:</p>\n\n<pre><code>&lt;source&gt;:8:1: warning: variably modified 'type1' at file scope\n typedef char type1[__is_array_of_constant_known_size(var1)?1:-1];\n ^~~~~~~\n&lt;source&gt;:10:21: error: initializer element is not constant\n const int sizeof1 = sizeof(char[__is_array_of_constant_known_size(var1)?1:-1]);\n                     ^~~~~~\n&lt;source&gt;:13:14: error: variably modified 'type2' at file scope\n typedef char type2[__is_array_of_constant_known_size(var2)?1:-1];\n              ^~~~~\n&lt;source&gt;:4:47: error: initializer element is not constant\n #define __is_array_of_constant_known_size(x)  ( (void*)&amp;x[0] == (void*)&amp;x )\n                                               ^\n&lt;source&gt;:14:18: note: in expansion of macro '__is_array_of_constant_known_size'\n const int int2 = __is_array_of_constant_known_size(var2)?1:-1;\n                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n&lt;source&gt;:15:21: error: initializer element is not constant\n const int sizeof2 = sizeof(char[__is_array_of_constant_known_size(var2)?1:-1]);\n</code></pre>\n\n<p>The line <code>int1 = __is_array_of_constant_known_size(var1)</code> compiles without error. That means, that <code>__is_array_of_constant_known_size(var1)</code> is a constant expression, because </p>\n\n<blockquote>\n  <p>All the expressions in an initializer for an object that has static\n  storage duration shall be constant expressions or string literals\n  from 6.7.8 in\n  <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\">C99</a>.</p>\n</blockquote>\n\n<p>But the line <code>sizeof1 = sizeof(char[__is_array_of_constant_known_size(var1)])</code> fails to compile with <code>error: initializer is not compile time constant</code>. Why is that?<br>\nWhy <code>(void*)&amp;var1[0] == (void*)&amp;var1</code> is a constant expression, but <code>sizeof(char[((void*)&amp;var1[0] == (void*)&amp;var1)])</code> is not?<br>\nIs there a better way to implement compile time assertion inside the <code>__arraycount</code> macro rather then <code>sizeof(char[__is_array_of_constant_known_size(var1)?1:-1])</code>?</p>\n"}, {"tags": ["c", "lua"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528919968, "post_id": 50845264, "comment_id": 88694118, "body": "This question doesn&#39;t seem to have anything to do with c++."}, {"owner": {"reputation": 73, "user_id": 5800039, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/844e21264d1ff2254ec6334add410509?s=128&d=identicon&r=PG&f=1", "display_name": "Kurieita", "link": "https://stackoverflow.com/users/5800039/kurieita"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1528920059, "post_id": 50845264, "comment_id": 88694167, "body": "The code get compile as C++ and I do use some C++ headers as well as <code>extern C</code>. I thought I might as well add it."}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 2725326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zeiuz.png?s=128&g=1", "display_name": "Yvens Rebou&#231;as Serpa", "link": "https://stackoverflow.com/users/2725326/yvens-rebou%c3%a7as-serpa"}, "is_accepted": true, "score": 1, "last_activity_date": 1548859834, "creation_date": 1548859834, "answer_id": 54443316, "question_id": 50845264, "link": "https://stackoverflow.com/questions/50845264/lua-c-extension-how-to-set-metatable-on-new-library/54443316#54443316", "title": "Lua C Extension: how to set metatable on new library", "body": "<p>You have to set the metatable to your table by pushing it to the top of the stack and then calling <code>lua_setmetatable</code>.</p>\n\n<pre><code>luaL_newlib(lua, lib);\nlua_pushvalue(lua, -1);\nlua_setmetatable(lua, -2);\n</code></pre>\n\n<p>The call to <code>lua_pushvalue</code> will push the value on position -1 (the top of the stack) to the stack again, duplicating it. Then, we call <code>lua_setmetatable</code>(Documentation here <a href=\"http://pgl.yoyo.org/luai/i/lua_setmetatable\" rel=\"nofollow noreferrer\">doc</a>) to pop a table on top of the stack and set it as the metatable for the table in the given index (-2, that is our lib, pushed by the <code>luaL_newlib</code> command).</p>\n\n<p>By doing this and running your example, I got the following results:</p>\n\n<pre><code>local rpc = require \"DiscordRPC\"\nprint(rpc['a']) \n-- First, calls the __index function, printing\n-- 'Was indexeda'\n-- Then prints nil, since the key 'a' holds nothing\nrpc.initialize();\n-- Prints ran\n</code></pre>\n\n<p>If you have more questions towards this, I suggest you to read the chapter about <a href=\"https://www.lua.org/pil/28.html\" rel=\"nofollow noreferrer\">Userdata and Object-Oriented Access</a> in Programming in Lua Book.</p>\n"}], "owner": {"reputation": 73, "user_id": 5800039, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/844e21264d1ff2254ec6334add410509?s=128&d=identicon&r=PG&f=1", "display_name": "Kurieita", "link": "https://stackoverflow.com/users/5800039/kurieita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 54443316, "answer_count": 1, "score": 1, "last_activity_date": 1548859834, "creation_date": 1528919767, "last_edit_date": 1528920262, "question_id": 50845264, "link": "https://stackoverflow.com/questions/50845264/lua-c-extension-how-to-set-metatable-on-new-library", "title": "Lua C Extension: how to set metatable on new library", "body": "<p>After multiple attempts and hours of googling I finally came to realize SOF is probably my best place to solve this.</p>\n\n<p>I am currently using the Lua C API to create an extension, a shared library that you can use by requiring it via <code>require</code>. I am trying to do something very similar to this (sorry about the formatting):</p>\n\n<pre><code>local data = {\n    something = \"some\"\n}\n\nlocal rpc = {}\n\nfunction rpc.method()\n    print('ran')\n end\n\n function rpc.method2()\n    print('ran222')\n  end\n\n   local metatable = {}\n   metatable.__index = function(self, key) \n       return data[key] \n    end\n   setmetatable(rpc, metatable)\n--------------------------------------------\nrpc.method()\nprint(rpc['something'])\nrpc.method2()\n</code></pre>\n\n<p>My current C code look something like this:</p>\n\n<pre><code>static int lua_index(lua_State* lua) { //idk\n    std::cout &lt;&lt; \"Was indexed\";\n    const char* a = luaL_checkstring(lua, 2);\n    std::cout &lt;&lt; a &lt;&lt; std::endl;\n    return 0;\n}\n\nstatic int lua_initialize(lua_State* lua) {\n    std::cout &lt;&lt; \"ran\";\n    return 0;\n}\n\nstatic const struct luaL_Reg lib[] = {\n    { \"initialize\", lua_initialize },\n    {\"__index\", lua_index},\n    { NULL, NULL }\n};\n\nextern \"C\" int DISCORD_RPC_EXPORT luaopen_DiscordRPC(lua_State* lua) {\n    luaL_newlib(lua, lib);\n    lua_setmetatable(lua, 1);\n\n    return 1;\n}\n</code></pre>\n\n<p>And using this as an example:</p>\n\n<pre><code>local rpc = require \"DiscordRPC\"\n\nprint(rpc['a'])\n\nrpc.initialize();\n</code></pre>\n\n<p>Now obviously <code>rpc['a']</code> would return nil (yes <code>lua_index</code> does in fact run) because <code>lua_index</code> isn't doing anything but why can't I call <code>initialize</code>? It clearly there. It says: <code>lua: main.lua:5: attempt to call a nil value (field 'initialize')</code> So it is nil. If I would to remove <code>lua_setmetatable(lua, 1);</code> I would be able to call that function but I can not index it <code>DiscordRPC</code> as I want to. Also I would like to point out that when I remove it the <code>__index</code> metamethod get called two times, obviously it would.</p>\n\n<p>My question: how can I achieve this? I am trying to set a metatable on a table and return the entire metatable. \nAny help is very much appreciated as I am complete lost. Thank you.</p>\n"}, {"tags": ["c", "base64", "iot"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528918039, "post_id": 50844834, "comment_id": 88693098, "body": "base64 won&#39;t save you much space. As for &quot;how&quot; - implement a function or use an existing library."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1528918118, "post_id": 50844834, "comment_id": 88693140, "body": "What&#39;s the problem?  Encoding 32-bits requires 6 bytes of Base-64 encoding (5 groups of 6 bits, one group of 2 bits).  That&#39;s two bytes better than simple hex encoding, and four bytes better than decimal encoding  Go for it!"}, {"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528918329, "post_id": 50844834, "comment_id": 88693251, "body": "@EugeneSh. the previous version of the code was simply printing the number in decimal, so it was eating more SMS charaters than necessary,  for the how yes actually the goal was to put the answer i came up with here :) , when googling i only found generic solution for encoding array of bytes that were using loops and malloc"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528918398, "post_id": 50844834, "comment_id": 88693289, "body": "Which characters SMS is able to transmit?"}, {"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 0, "creation_date": 1528918803, "post_id": 50844834, "comment_id": 88693520, "body": "I would have said any printable characters of ASCII to be safe, it should be possible to use other encoding but I don&#39;t enough stuff about SMS yet."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528919115, "post_id": 50844834, "comment_id": 88693688, "body": "If any printable character is safe (what is printable by the way?), then you can encode the number into base-X, where X is the number of the available characters."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1528925924, "post_id": 50844834, "comment_id": 88696825, "body": "encoding binary data using <code>base64</code> EXPANDS it.  Each base64 output digit can encode only only 6 bits"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1528933031, "post_id": 50844834, "comment_id": 88698792, "body": "<a href=\"https://en.wikipedia.org/wiki/Ascii85\" rel=\"nofollow noreferrer\">Base85</a> only requires 5 characters to pack a 32-bit timestamp."}, {"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1528994708, "post_id": 50844834, "comment_id": 88727095, "body": "@bruceg yes i&#39;m aware of this, but i can&#39;t transmit it as binary as it needs to go through SMS , my baseline was more the base10 serialisation that is used currently"}], "answers": [{"tags": [], "owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1528918554, "last_edit_date": 1528918554, "creation_date": 1528918168, "answer_id": 50844889, "question_id": 50844834, "link": "https://stackoverflow.com/questions/50844834/c-convert-a-timestamp-uint-32-into-base64/50844889#50844889", "title": "C - convert a timestamp (uint_32) into base64", "body": "<p>For the moment I came up with this </p>\n\n<pre><code>void base64_encode_timestamp(\n    uint32_t timestamp,\n    char encoded_data[6]\n) {\n\n    // 26 because we encode 6 bits by 6, and it's a 32 bits integer\n    // so  32 - 6 = 26\n    // and &amp; 0x3F is a mask for 0b111_111\n    encoded_data[0] = encoding_table[(timestamp &gt;&gt; 26) &amp; 0x3F];\n    encoded_data[1] = encoding_table[(timestamp &gt;&gt; 20) &amp; 0x3F];\n    encoded_data[2] = encoding_table[(timestamp &gt;&gt; 14) &amp; 0x3F];\n    encoded_data[3] = encoding_table[(timestamp &gt;&gt; 8) &amp; 0x3F];\n    encoded_data[4] = encoding_table[(timestamp &gt;&gt; 2) &amp; 0x3F];\n    // here &lt;&lt; 4 is actually \"&gt;&gt; -2\" because we have 2 bits remaining\n    // that we need to pad with four '0' \n    encoded_data[5] = encoding_table[(timestamp &lt;&lt; 4) &amp; 0x3F];\n}\n\n// a main to show that it works\nint main() {\n\n    // Wednesday, 13-Jun-18 09:56:27 UTC\n    uint32_t timestamp = 1528883787;\n    char timestamp_base64[6] = {};\n    base64_encode_timestamp(timestamp, timestamp_base64);\n    printf(\"%.6s\\n\", timestamp_base64);\n}\n</code></pre>\n\n<p>note that it's not exactly valid as it's missing the <code>==</code> for padding, but in python one can do </p>\n\n<p>(my_string + '===').decode('base64')</p>\n\n<p>and it will works (even if there's already some padding) , which is a good tradeoff for a 25% decrease in space.  </p>\n"}], "owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528918554, "creation_date": 1528917958, "question_id": 50844834, "link": "https://stackoverflow.com/questions/50844834/c-convert-a-timestamp-uint-32-into-base64", "title": "C - convert a timestamp (uint_32) into base64", "body": "<p>For some IoT communication I need to transmit some information over SMS, some of them being timestamp precise to the seconds, in order to save as much place as possible, I would like to encode them in base64</p>\n\n<p>How to do this in C ? (if possible without malloc)</p>\n\n<p>(of course I'm glad to hear if there's a more efficient, \"no too custom\" method of encoding an int32 in a SMS-compliant way)</p>\n"}, {"tags": ["c", "binaryfiles"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1528917488, "post_id": 50844643, "comment_id": 88692809, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please. <i>You</i> need to determine where the problem is first."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528918241, "post_id": 50844643, "comment_id": 88693208, "body": "Got a crash? Great time to strap the debugger on to your executable and see what&#39;s going on internally."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1528918241, "post_id": 50844643, "comment_id": 88693209, "body": "In the <code>while</code> where you parse the file data, you read past the end of the array. Try <code>while (importedData[i] &amp;&amp; isdigit(importedData[i])....</code>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1528918274, "post_id": 50844643, "comment_id": 88693220, "body": "Also, I don&#39;t see any zeros in the data, so you probably want to offset row and column by -1."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1528918567, "post_id": 50844643, "comment_id": 88693379, "body": "Quote: &quot;Binary file contains numbers that determine the coords and the desired number e.g 367 means 3rd row 6th column and number 7&quot; oh, dear... will teacher never learn"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1528918725, "post_id": 50844643, "comment_id": 88693467, "body": "OT: &quot;My program allocates a 2D array dynamically...&quot; No, it doesn&#39;t. It allocates a 1D array of pointers where each pointer points to a 1D array. See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\" title=\"correctly allocating multi dimensional arrays\">stackoverflow.com/questions/42094465/&hellip;</a> for the correct way"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1528918920, "post_id": 50844643, "comment_id": 88693581, "body": "OT: &quot;Filename must be given to command line as a parameter&quot; But you read it using <code>scanf</code>. Instead you should take it from <code>argv</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1528918958, "post_id": 50844643, "comment_id": 88693604, "body": "OT: Never - like in never ever - do <code>scanf(&quot;%s&quot;,filename);</code> Always put a limit like <code>scanf(&quot;%99s&quot;,filename);</code>"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1528920253, "post_id": 50844643, "comment_id": 88694259, "body": "@MichaelBeer Actually you are right. This is not a true binary file, it&#39;s just a file created with fopen(filename,&quot;wb&quot;) and giving numbers using fwrite. In this case it&#39;s just called binary due to the .bin extension."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528920271, "post_id": 50844643, "comment_id": 88694265, "body": "Did you get that file from the teacher? It does look like a binary file for this purpose."}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528920371, "post_id": 50844643, "comment_id": 88694316, "body": "@4386427 No, i created this myself. All you need to do is open a binary file using fopen and input numbers with fwrite. It;s not a true binary file, it&#39;s called so due to .bin extension."}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528920676, "post_id": 50844643, "comment_id": 88694470, "body": "@4386427 Thanks for the link that was a good read. Sadly i can&#39;t use this way of allocating as the project requires to allocate the array using a char **. BTW when i said that &quot;filename must be given as a parameter from command line&quot;, i didn&#39;t mean as argv[0], all i need to do is just to enter it from keyboard using scanf.  Will edit to clarify."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1528921493, "post_id": 50844643, "comment_id": 88694913, "body": "Since it&#39;s not a &quot;binary&quot; file, you could try <code>while (3 == fscanf(fp, &quot;%1d%1d%1d&quot;, &amp;row, &amp;col, &amp;num)) ;</code>"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1528921825, "post_id": 50844643, "comment_id": 88695097, "body": "@JohnnyMopp But am i reading integers from my &quot;binary&quot; file this way? Because my teacher told me that fread fills the desired buffer with raw bytes (chars) and in this case those data should be handled as 1 byte integers. Actually his words were &quot;chars are just integers that have less range and take less space on ram&quot; , but i find that hard to believe. If that&#39;s the case why doesn&#39;t C call chars as tinyints ?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1528922146, "post_id": 50844643, "comment_id": 88695247, "body": "@JohnM. The basic problem here is that the direction from your teacher is all wrong. The sentence: &quot;Binary file contains numbers that determine the coords and the desired number e.g 367 means 3rd row 6th column and number 7&quot; is completely useless as a specification. It should at least specify the size of each object but still it&#39;s useless without an encoding specifier. Anyway - if it was true binary, you would not do the <code>- 48</code> stuff."}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528922310, "post_id": 50844643, "comment_id": 88695320, "body": "@4386427 Understood. Wish i could do it this way but you know... specifications are specifications... (more like restrictions in this case i would say)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529077079, "post_id": 50844643, "comment_id": 88759577, "body": "regarding the contents of <code>sudokulib.h</code>  a header file should NOT contain code (but yours does)  A header file should only contain function signatures, data definitions, macros"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1529077282, "post_id": 50844643, "comment_id": 88759685, "body": "when writing an error message that resulted from a call to a C library function, call <code>perror( &quot;your error message&quot; );  exit( EXIT_FAILURE );</code>  This will properly output the error message to <code>stderr</code> and output the text reason the system thinks the error occurred to <code>stderr</code>"}], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 2, "creation_date": 1528920450, "post_id": 50845258, "comment_id": 88694362, "body": "In order to check for number of bytes should i check the return value of fread? Is it considered good practice?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 1, "creation_date": 1528920605, "post_id": 50845258, "comment_id": 88694439, "body": "@JohnM. Exactly"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1528922045, "post_id": 50845258, "comment_id": 88695194, "body": "Thanks A LOT! All i needed to do was to substract 1 from row and column like you said and it worked. How stupid of me to forget to substract 1 from indexes."}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1528922546, "post_id": 50845258, "comment_id": 88695432, "body": "Something i would like to note also is the fact that number 243 is produced from multiplying 9*9*3 (9 rows * 9 columns * (2 coords + 1 number)). Tried to find a better solution but i can&#39;t think of anything better as my teacher demands that it should even solve puzzles that have already been solved. Looks pretty dumb though."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 1, "creation_date": 1528922654, "post_id": 50845258, "comment_id": 88695488, "body": "@JohnM. Do <code>#define ROWS 9 #define COLUMNS ...</code> and use these defines in your code instead of hard code numbers"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1528922329, "last_edit_date": 1528922329, "creation_date": 1528919755, "answer_id": 50845258, "question_id": 50844643, "link": "https://stackoverflow.com/questions/50844643/program-crashes-after-reading-from-binary-file-and-assigning-to-matrix/50845258#50845258", "title": "Program crashes after reading from binary file and assigning to matrix", "body": "<p>Notice that arrays are zero indexed. So you need to subtract one more to get the correct index, example:</p>\n\n<pre><code>row=importedData[i] - 48 - 1;\n</code></pre>\n\n<p>Also notice that you have too few numbers in your file. There is only 96 but you need 243.</p>\n\n<p>Further...</p>\n\n<p>Look at this:</p>\n\n<pre><code>importedData=(char *)malloc(sizeof(char)*81*3);\n...\nfread(importedData,1,243,fp);\n</code></pre>\n\n<p>now you have 243 chars in <code>importedData</code> (something that you should check by looking at the return code from <code>fread</code>. In your case the file only has 96 chars (bad...) but let's just assume it worked).</p>\n\n<p>Then you do:</p>\n\n<pre><code>    i=0;\nwhile (importedData[i] != ' ' &amp;&amp; \n       importedData[i+1] != ' ' &amp;&amp; \n       importedData[i+2] != ' ' &amp;&amp; \n       importedData[i] &gt;= '1' &amp;&amp; \n       importedData[i+1] &gt;= '1' &amp;&amp; \n       importedData[i+2] &gt;= '1' &amp;&amp; \n       importedData[i] &lt;= '9' &amp;&amp; \n       importedData[i+1] &lt;= '9' &amp;&amp; \n       importedData[i+2] &lt;= '9')\n{\n    ....\n}\n</code></pre>\n\n<p>So if the 243 chars that you read all made the condition above true, you'll keep on reading beyond the memory allocated for <code>importedData</code>. So you have undefined behavior.</p>\n\n<p>You need to add:</p>\n\n<pre><code>&amp;&amp; i &lt; 243;\n</code></pre>\n\n<p>to the condition.</p>\n\n<p>BTW: All these hard code numbers are bad. Use a <code>#define</code> instead.</p>\n\n<p>BTW: Don't do </p>\n\n<pre><code>row=importedData[i] - 48 -1;\n</code></pre>\n\n<p>but</p>\n\n<pre><code>row=importedData[i] - '0' - 1;\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 50845258, "answer_count": 1, "score": 1, "last_activity_date": 1528922329, "creation_date": 1528917193, "last_edit_date": 1528920775, "question_id": 50844643, "link": "https://stackoverflow.com/questions/50844643/program-crashes-after-reading-from-binary-file-and-assigning-to-matrix", "title": "Program crashes after reading from binary file and assigning to matrix", "body": "<p>I have an assignment, to create a program that solves 9x9 sudoku puzzle. The specifications are the following:</p>\n\n<ul>\n<li>Filename must be given to command line as a parameter (EDIT: <code>argv[0]</code> isn't necessary, just need to input from keyboard with <code>scanf</code> function)</li>\n<li>File must be binary</li>\n<li>All arrays must be dynamically allocated</li>\n<li>Binary file contains numbers that determine the coords and the desired number\ne.g 367 means 3rd row 6th column and number 7</li>\n</ul>\n\n<p>My program allocates a 2D array dynamically, then allocates space to save the filename, then opens the binary file to read data. Using <code>printf</code> to debug my program it seems that data gets saved to <code>importedData</code> array appropriately and when assigning those data on sudoku puzzle, either the program crashes, or doesn't assign the values properly. Here is my code:</p>\n\n<p>Sudoku.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"sudokulib.h\"\n\n#define MALLOC_ERROR 0xFF\n#define FILE_NOT_FOUND 0xFFF\n\nint main(int argc,char ** argv)\n{\n    char **matrix;\n    int i,j; \n    int row,column,num;\n    FILE * fp;\n    char * filename;\n    char * importedData;\n    matrix=(char **)malloc(9*sizeof(char *));\n    if (!matrix)\n    exit(MALLOC_ERROR);\n    for (i=0;i&lt;9;++i)\n    {\n        matrix[i]=(char *)malloc(9*sizeof(char));\n        if (!matrix[i])\n        exit(MALLOC_ERROR);\n    } \n    initSudoku(matrix);\n    printf (\"Give me the name of data file: \");\n    filename=(char *)malloc(100*sizeof(char));\n    if (!filename)\n    exit(MALLOC_ERROR);\n    scanf(\"%s\",filename);\n    fp=fopen(filename,\"rb\");\n    if (!fp)\n    {\n        printf (\"File not found\\n\");\n        exit(FILE_NOT_FOUND);\n    }\n    importedData=(char *)malloc(sizeof(char)*81*3);\n    if (!importedData)\n    exit (MALLOC_ERROR);\n    fread(importedData,1,243,fp);\n    i=0;\nwhile (importedData[i] != ' ' &amp;&amp; importedData[i+1] != ' ' &amp;&amp; importedData[i+2] != ' ' &amp;&amp; importedData[i] &gt;= '1' &amp;&amp; importedData[i+1] &gt;= '1' &amp;&amp; importedData[i+2] &gt;= '1' &amp;&amp; importedData[i] &lt;= '9' &amp;&amp; importedData[i+1] &lt;= '9' &amp;&amp; importedData[i+2] &lt;= '9')\n    {\n        row=importedData[i] - 48; /* Convert from ascii code to number */\n        column=importedData[i+1] - 48;\n        num=importedData[i+2] - 48;\n        matrix[row][column]=num;\n        i=i+3;  \n    } \n    printf(\"Sudoku after importing data:\\n\\n\");\n    printSudoku(matrix);\n    system(\"pause\");\n    if (solvePuzzle(matrix))\n    {\n        printSudoku(matrix);\n    }\n    else\n    printf (\"Puzzle has no solution\\n\");\n    fclose(fp);\n    free(filename);\n    for (i=0;i&lt;9;++i)\n    {\n        free(matrix[i]);\n    }\n    free(matrix);\n    return 0;\n}\n</code></pre>\n\n<p>Sudokulib.h</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n/* Function Prototypes Begin Here */\n\nvoid printSudoku(char **);\nvoid initSudoku(char **);\nint checkRow(char **,int,int);\nint checkCol(char **,int,int);\nint check3x3(char **,int,int,int);\nint checkIfEmpty(char **,int*,int*);\nint solvePuzzle (char **);\n\n/* Function Prototypes End Here */\n\nvoid printSudoku(char ** Mat)\n{\n    int i,j;\n    for (i=0;i&lt;9;++i)\n    {\n        printf (\"-------------------\\n\");\n        printf(\"|\");\n        for (j=0;j&lt;9;++j)\n        {\n            printf(\"%d|\",Mat[i][j]);\n        }\n    printf(\"\\n\");\n    }\n    printf (\"-------------------\\n\");\n}\n\nvoid initSudoku(char ** Mat)\n{\n    int i,j;\n    for (i=0;i&lt;9;++i)\n    for (j=0;j&lt;9;++j)\n    Mat[i][j]=0;\n} \n\n\nint checkRow (char ** Mat,int row, int num) // if row is free returns 1 else returns 0\n{\n    int col;\n    for (col = 0; col &lt; 9; col++)\n    {\n        if (Mat[row][col] == num-48) \n        return 0;\n    }\n    return 1;\n}\n\nint checkCol (char ** Mat,int col , int num) // if column is free returns 1 else returns 0\n{\n    int row;\n    for (row = 0; row &lt; 9; row++)\n    {\n        if (Mat[row][col] == num-48) \n        return 0;\n    }\n    return 1;\n}\n\nint check3x3 (char ** Mat, int row, int col, int num) // if number doesnt exist in the 3x3 grid returns 1 else returns 0\n{\n    row = (row/3) * 3; // set to first row in the grid\n    col = (col/3) * 3; // set to first col in the grid\n    int i;\n    int j;\n    for (i = 0; i &lt; 3; i++) // grid is 3x3\n    {\n        for (j = 0; j &lt; 3; j++)\n        {\n            if (Mat[row+i][col+j] == num-48)\n            return 0;\n        }\n    }\n    return 1;\n}\n\nint checkIfEmpty(char ** Mat, int *row, int *col) // if a block of the entire puzzle is empty returns 1 else returns 0 also saves the target row and column it found empty\n{\n        for (*row = 0; *row &lt; 9; *row++)\n        {\n            for (*col = 0; *col &lt; 9; *col++)\n            {\n                if (Mat[*row][*col] == 0)\n                return 1;\n            }\n        }\n    return 0;\n}\n\nint solvePuzzle (char ** Mat)\n{\n    int num;\n    int row;\n    int col;\n    row = 0;\n    col = 0;\n    if (!checkIfEmpty(Mat,&amp;row,&amp;col)) // if puzzle is solved return 1\n    return 1;\n    for (num = 1; num &lt; 9; num++)\n    {\n        if (checkRow (Mat,row,num) &amp;&amp; checkCol (Mat,col,num) &amp;&amp; check3x3 (Mat,row,col,num))\n        {\n            Mat[row][col] = num-48;\n        }\n    if (solvePuzzle (Mat))\n    {\n        return 1;\n    }\n    Mat[row][col] = 0;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Any help to resolve the aforementioned issue is appreciated.\nAlso keep in mind that <code>int solvePuzzle()</code> is not quite finished and any suggestions to improve this function are welcome.</p>\n\n<p>EDIT: Here are the contents of binary file <code>data2.bin</code> that causes wrong assignment</p>\n\n<pre><code>142156177191216228257289311329364375418422441484534546562579625663682698739743787794824855883896\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Give me the name of data file: data2.bin\nSudoku after importing data:\n\n-------------------\n|0|0|0|0|0|0|0|0|0|\n-------------------\n|0|0|0|0|2|6|0|7|0|\n-------------------\n|0|6|8|0|0|7|0|0|9|\n-------------------\n|0|1|9|0|0|0|4|5|0|\n-------------------\n|0|8|2|0|1|0|0|0|4|\n-------------------\n|0|0|0|4|6|0|2|9|0|\n-------------------\n|0|0|5|0|0|0|3|0|2|\n-------------------\n|0|0|0|9|3|0|0|0|7|\n-------------------\n|0|0|4|0|0|5|0|0|3|\n-------------------\nPress any key to continue . . .\n</code></pre>\n\n<p>EDIT 2: Found out that if a very small binary file is used that contains very few data e.g. <code>123245321</code> works fine, but if data exceed 9 bytes, then the puzzle gets messed up.</p>\n"}, {"tags": ["c", "char", "strcmp"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1528916886, "post_id": 50844066, "comment_id": 88692512, "body": "Why are you passing a <code>NULL</code> pointer to <code>strcpy</code>?"}, {"owner": {"reputation": 4041, "user_id": 624766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad47bf54542ea73c2dcda9a1002e6ec?s=128&d=identicon&r=PG", "display_name": "pelya", "link": "https://stackoverflow.com/users/624766/pelya"}, "edited": false, "score": 0, "creation_date": 1528917264, "post_id": 50844066, "comment_id": 88692689, "body": "If you want to set an empty value into the string, use <code>strcpy(registro[i].trecho, &quot;&quot;);</code> - using NULL will make it crash."}, {"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528917476, "post_id": 50844066, "comment_id": 88692799, "body": "@tadman. Sorry. If value equals to &quot;\u2014\u2014\u2014&quot; I want to assign &quot;NULL&quot; to struct field, but both (NULL or &quot;&quot;) crashes the program. Any idea ?"}, {"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "reply_to_user": {"reputation": 4041, "user_id": 624766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad47bf54542ea73c2dcda9a1002e6ec?s=128&d=identicon&r=PG", "display_name": "pelya", "link": "https://stackoverflow.com/users/624766/pelya"}, "edited": false, "score": 0, "creation_date": 1528917768, "post_id": 50844066, "comment_id": 88692949, "body": "@pelya. I&#39;ve tried both (NULL or &quot;&quot;) and any string and program crashes. Any idea ?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528917773, "post_id": 50844066, "comment_id": 88692951, "body": "The reason you see &#249; instead of \u2013 is because your terminal&#39;s encoding is not set the same as whatever the source file is. This could be a Windows-1252 vs. ISO-8859-1 encoding incompatibility."}, {"owner": {"reputation": 4041, "user_id": 624766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad47bf54542ea73c2dcda9a1002e6ec?s=128&d=identicon&r=PG", "display_name": "pelya", "link": "https://stackoverflow.com/users/624766/pelya"}, "edited": false, "score": 0, "creation_date": 1528918290, "post_id": 50844066, "comment_id": 88693228, "body": "Other than this <code>strcpy</code>, that code should not crash. Which means it crashes because of something else. Probably your <code>i</code> variable goes beyond the <code>registro</code> array max size."}, {"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "reply_to_user": {"reputation": 4041, "user_id": 624766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad47bf54542ea73c2dcda9a1002e6ec?s=128&d=identicon&r=PG", "display_name": "pelya", "link": "https://stackoverflow.com/users/624766/pelya"}, "edited": false, "score": 0, "creation_date": 1528920678, "post_id": 50844066, "comment_id": 88694472, "body": "@pelya. YOU&#39;RE RIGHT !!! I don&#39;t know how, but  a program line appears in another part of the code and even compiling did not give error, only in execution. I removed the line, replaced the &quot;---&quot; with the &quot;\\ x97 \\ x97 \\ x97&quot; suggested by &quot;bruceg&quot; and the program is running perfectly. Thank you very much."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "edited": false, "score": 0, "creation_date": 1528915515, "post_id": 50844118, "comment_id": 88691863, "body": "Thank you Ben. I will try it and post result later."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1528915697, "post_id": 50844118, "comment_id": 88691954, "body": "In case that you can&#39;t type your extended characters, you can always use  the \\x escape sequence to insert a character with its hexadecimal code. So, in your case you can type: &quot;\\x97\\x97\\x97&quot;, since 97 is hex for 151 decimal."}, {"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "edited": false, "score": 0, "creation_date": 1528916815, "post_id": 50844118, "comment_id": 88692472, "body": "@Ben. I did the changes but the program crashes... I change the string to &quot;&#249;&#249;&#249;&quot; and fails too."}, {"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1528918317, "post_id": 50844118, "comment_id": 88693243, "body": "@bruceg. I change the &quot;\u2014\u2014\u2014&quot; with &quot;\\x97\\x97\\x97&quot; but the program still crashes. (ALT + 151 is different from ALT + 0151 that&#39;s in the text file). Any idea ?"}, {"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1528921098, "post_id": 50844118, "comment_id": 88694683, "body": "@bruceg. Your suggestion worked !!! I do not know how, but there was a line of code that was in another part of the program and only gave error at runtime. Now the program is running perfectly. Could you put your answer so I can mark it as correct? Thank you very much."}], "tags": [], "owner": {"reputation": 177, "user_id": 1264972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454aa83bb047d3ddb1cb64a2f1096284?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1264972/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1528915203, "creation_date": 1528915203, "answer_id": 50844118, "question_id": 50844066, "link": "https://stackoverflow.com/questions/50844066/c-how-to-compare-extended-char-sequence-with-function-strcmp/50844118#50844118", "title": "C - How to compare extended char sequence with function strcmp()?", "body": "<p>strcmp only fails on null, you can pretty much just do </p>\n\n<pre><code>if (strcmp(inputString,\"\u2014\u2014\u2014\")==0){\n   printf(\"Strings Equal\\n\")\n} else{\n   printf(\"Strings unequal\")\n}\n</code></pre>\n\n<p>If you're trying to just see if the string is in the larger string, strstr is the function your looking for not strcmp.</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "edited": false, "score": 0, "creation_date": 1528918578, "post_id": 50844745, "comment_id": 88693388, "body": "I&#39;m &quot;newbie&quot; in C language. I tried both (NULL or &quot;&quot;) and &quot;\\x97\\x97\\x97&quot; like bruceg told me and even any string and the program doesn&#39;t works."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "edited": false, "score": 1, "creation_date": 1528918627, "post_id": 50844745, "comment_id": 88693415, "body": "Try not to say &quot;doesn&#39;t work&quot;, that really doesn&#39;t communicate anything useful. Does it give you an error? Does it crash? Does it give unexpected results? I think you have an encoding issue here as well. Can you make a test file with <code>xxx</code> in it instead of this non-ASCII character? Unless the encoding in your program and in the file match this won&#39;t properly identify the token. You could always put some debugging in like <code>printf(&quot;Token: %02x\\n&quot;, token[0]);</code> to see if the character is 0x97 as you expect or perhaps something else."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "edited": false, "score": 0, "creation_date": 1528918733, "post_id": 50844745, "comment_id": 88693473, "body": "Remember that a debugger is a very useful tool for situations like this. Most have a way of inspecting the memory directly and showing it as hex."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1528917625, "creation_date": 1528917625, "answer_id": 50844745, "question_id": 50844066, "link": "https://stackoverflow.com/questions/50844066/c-how-to-compare-extended-char-sequence-with-function-strcmp/50844745#50844745", "title": "C - How to compare extended char sequence with function strcmp()?", "body": "<p><code>strcpy</code> is for one thing and one thing <strong>only</strong>, and that is copying one string to another. If you give it <code>NULL</code>, that's not a string, and dereferencing a NULL pointer is going to cause a crash.</p>\n\n<p>What you want is this:</p>\n\n<pre><code> if (strcmp(token, \"\u2014\u2014\u2014\") == 0)\n    // Assign NULL pointer\n    registro[i].trecho = NULL;\n else\n    // Copy string to buffer\n    strcpy(registro[i].trecho, token);\n</code></pre>\n\n<p>Remember <code>strcpy</code> is a very risky function to use as it assumes a lot of things about the destination buffer. If <code>trecho</code> isn't large enough to hold the <code>token</code> string, <em>including NULL terminator</em>, you get undefined behaviour. If <code>token</code> isn't properly NULL terminated you get undefined behaviour. There's a lot of ways this seemingly harmless code can go haywire.</p>\n"}, {"comments": [{"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1528993506, "post_id": 50846345, "comment_id": 88726503, "body": "So, you are expecting &#39;\u2014&#39; to be in the execution character set but not in the source character set? It is possible but much more likely than the source character set being ASCII."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1529001680, "post_id": 50846345, "comment_id": 88730310, "body": "@TomBlodget The problem could be any place from the editor on down the pipeline. It&#39;s always safest to use 7-bit ASCII in the source code file, but like you say, not always necessary."}], "tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 1, "last_activity_date": 1528924301, "creation_date": 1528924301, "answer_id": 50846345, "question_id": 50844066, "link": "https://stackoverflow.com/questions/50844066/c-how-to-compare-extended-char-sequence-with-function-strcmp/50846345#50846345", "title": "C - How to compare extended char sequence with function strcmp()?", "body": "<p>Often in C, you can only use 7-bit ASCII in a quoted string, so for upper ASCII you need to use the \\x escape sequence with the hexadecimal code of the character.  So, in your case you can type: \"\\x97\\x97\\x97\", since 97 is hex for 151 decimal.</p>\n\n<pre><code>case 3:\n{\n      if(strcmp(token, \"\\x97\\x97\\x97\") == 0) \n          strcpy(registro[i].trecho, NULL);\n      else\n          strcpy(registro[i].trecho, token);\n      break;\n}\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 3151927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42aa72d03c6ce3896859fc5e5a2cbce7?s=128&d=identicon&r=PG&f=1", "display_name": "Adalberto Jos&#233; Brasaca", "link": "https://stackoverflow.com/users/3151927/adalberto-jos%c3%a9-brasaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 50846345, "answer_count": 3, "score": 0, "last_activity_date": 1528924301, "creation_date": 1528914975, "last_edit_date": 1528918066, "question_id": 50844066, "link": "https://stackoverflow.com/questions/50844066/c-how-to-compare-extended-char-sequence-with-function-strcmp", "title": "C - How to compare extended char sequence with function strcmp()?", "body": "<p>I need to compare whether string is equals or not to the following extended char sequence: \"\u2014\u2014\u2014\" ( ALT + 0151 code repeated three times) that is in text file. How to do it with function strcmp() ?</p>\n\n<p>A piece of the example text file (TSV):</p>\n\n<p>Piracicaba  Av. Armando Salles de Oliveira  Lado par    13400-005   Centro\nPiracicaba  Tv. Agostinho Frasson   \u2014\u2014\u2014 13400-008   Centro\nPiracicaba  Av. Armando Salles de Oliveira  Lado \u00edmpar  13400-010   Centro</p>\n\n<p>When I read the file and print the field is displayed \"\u00f9\u00f9\u00f9\" on monitor.</p>\n\n<p>The structure:</p>\n\n<pre><code>typedef struct {\n    char cidade[50];\n    char tipoLogradouro[20];\n    char logradouro[50];\n    char trecho[30];\n    char cep[10];\n    char bairro[50];\n} Endereco;\n</code></pre>\n\n<p>The test is inside 'switch case' and the program is crashing in this part:</p>\n\n<pre><code>case 3:\n      {\n          if(strcmp(token, \"\u2014\u2014\u2014\") == 0) // Change to \"\u00f9\u00f9\u00f9\" and fails too. \n              strcpy(registro[i].trecho, NULL);\n          else\n              strcpy(registro[i].trecho, token);\n          break;\n      }\n</code></pre>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1528914951, "post_id": 50844024, "comment_id": 88691594, "body": "Um, the exact same way you do with a full disk.  Simply <code>CreateFile()</code> to open the file, then <code>WriteFile()</code> to write garbage to the file, then <code>CloseHandle()</code> to close the file, and <code>DeleteFile()</code> to delete the file.  Alternatively, you can use <code>CreateFile()</code>+<code>CreateFileMapping()</code>+<code>MapViewOfFile()</code> to map the file into memory, and then you can write garbage into the memory, which will write it directly to the file."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 5, "creation_date": 1528914973, "post_id": 50844024, "comment_id": 88691601, "body": "Not so easy on an SSD though."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 2, "creation_date": 1528915104, "post_id": 50844024, "comment_id": 88691655, "body": "Just trying to write over the existing file might not clear the contents of the old file from the disk, especially if the original file is not stored contiguously."}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 0, "creation_date": 1528915108, "post_id": 50844024, "comment_id": 88691659, "body": "Now, theres where the problem starts. Will the writefile value be written at Test.txt+1 location or at Test.txt location. Because it would be pointless to writefile at Test.txt+1 as that would overwrite some other data possibly and also not delete the Test.txt or fill it up with garbage values."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1528915151, "post_id": 50844024, "comment_id": 88691690, "body": "When you open a file, its current position starts at 0, so writing new data to the file will overwrite existing data in the file. To overwrite the whole file, simply retrieve the file&#39;s current size, and then write that many new bytes to the file."}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "reply_to_user": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1528915167, "post_id": 50844024, "comment_id": 88691697, "body": "@FredK Exactly! How do I go about doing it to individual files?"}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 0, "creation_date": 1528915288, "post_id": 50844024, "comment_id": 88691756, "body": "Remy, if you suggest a way to do it as a code snippet in C, I&#39;ll try it out! Thanks a lot!"}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 1, "creation_date": 1528915356, "post_id": 50844024, "comment_id": 88691790, "body": "Remy, will it be the same in case of an SSD as well?"}, {"owner": {"reputation": 800, "user_id": 3254405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4cdHb.png?s=128&g=1", "display_name": "boateng", "link": "https://stackoverflow.com/users/3254405/boateng"}, "edited": false, "score": 0, "creation_date": 1528915683, "post_id": 50844024, "comment_id": 88691940, "body": "What if you open your text file delete everything, then load a text stream of blank.gif into it then save, then delete your text file.. or write and read from heap instead of using a file.."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1528915903, "post_id": 50844024, "comment_id": 88692063, "body": "When overwriting an existing file, the operating system COULD make a copy of the original file and then do the overwrites on the copy, replacing the system&#39;s pointer to the file with a pointer to the new disk start. I know of at least one OS that did this when the original file was extremely fragmented."}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 0, "creation_date": 1528916067, "post_id": 50844024, "comment_id": 88692133, "body": "How about mapping the locations in the disk where the file is and writing those areas with garbage values? That works in theory, but how would I map the locations where the file is present. Specially if its fragmented highly like you mentioned."}, {"owner": {"reputation": 800, "user_id": 3254405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4cdHb.png?s=128&g=1", "display_name": "boateng", "link": "https://stackoverflow.com/users/3254405/boateng"}, "edited": false, "score": 0, "creation_date": 1528916467, "post_id": 50844024, "comment_id": 88692321, "body": "If OS is a problem you may need to overwrite/disable it first, forensically..lol"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1528916669, "post_id": 50844024, "comment_id": 88692409, "body": "The solution to this problem is not programming, it&#39;s a <b>drive shredder</b>. You can&#39;t wipe disks like you used to. Even HDDs are starting to have SSD accelerator components on them, and those are hard to zero out properly. You can&#39;t recover a drive from tiny particles of plastic, metal and glass."}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 0, "creation_date": 1528917325, "post_id": 50844024, "comment_id": 88692731, "body": "Its easy to zero out if the complete disk is under consideration like I mentioned. You can serially zero out a complete drive or a physical disk for that matter. But doing it to a file/directory is where it gets complex."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528917749, "post_id": 50844024, "comment_id": 88692938, "body": "As @tadman says,  but OP mentions forensic techniques, which might be able to recover residual magnetic data at the edges of the track in the physical medium. My favourite method is with a hammer and chisel. But even then, I understand that the US was able to peice together remnants from a paper shredder last century."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528917951, "post_id": 50844024, "comment_id": 88693047, "body": "@WeatherVane And eye protection! With an SSD drive, even a hybrid, you&#39;re going to have to smash up any little chips you find as well unless you know exactly what the flash chips look like. They can be pretty tiny and hide in non-obvious places. Same principle here applies to phones and other electronic devices with persistent storage."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1528917984, "post_id": 50844024, "comment_id": 88693070, "body": "Note that journalled file systems \u2014 where SSD is &#39;just&#39; a variant on the theme \u2014 make it remarkably hard to overwrite old data."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528918086, "post_id": 50844024, "comment_id": 88693121, "body": "CD/DVD is bad! Flakes everywhere. Smash it inside a bag (you are outside)."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528918925, "post_id": 50844024, "comment_id": 88693584, "body": "Good luck <i>testing</i> that code :)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1528919137, "post_id": 50844024, "comment_id": 88693698, "body": "@TotalAnimeImmersion even with the full disk scenario, you cannot reliably erase the contents. Even if you serially write zeros, some sectors could have been replaced by backup sectors and the old ones could still have your data. So the solution is not through software."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528919285, "post_id": 50844024, "comment_id": 88693773, "body": "Why don&#39;t you use some sort of encryption and store the key in a place which can be reliably erased, like a piece of paper. Although this reduces the problem to erasing the key, the key size is significantly smaller than the data and probably easy to realiably erase."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1528930923, "post_id": 50844024, "comment_id": 88698335, "body": "An AES encryption key of 128-bits with a key generated from random bits is not brute forcible in the life of the universe and a 256-bit key will withstand future quantum computers. The catch is the key, that is why when using a password it must not be on a 10 million frequently used passwords list and a key extension or derivation method that takes ~100ms is required such as bcrypt, PBKDF2 or Argon2 is required."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1528957904, "post_id": 50844024, "comment_id": 88704612, "body": "<code>FSCTL_GET_RETRIEVAL_POINTERS</code> can be used to retrieve this data. It&#39;s probably just as good to zero the file directly as first suggested by  @RemyLebeau - If file size doesn&#39;t change then location on disk won&#39;t change. But maybe the disk was defragmented earlier then there is no solution. SSD&#39;s have their own software to deal with this."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528919932, "post_id": 50845252, "comment_id": 88694101, "body": "Nice try, but at some point you have to type in that key. Then the system swaps out the memory to disk .. etc."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528919975, "post_id": 50845252, "comment_id": 88694126, "body": "@WeatherVane pin the pages that hold the key :) write custom key board drivers!"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528920031, "post_id": 50845252, "comment_id": 88694151, "body": "Or a even simpler option, disable the secondary storage after the encrypted stuff has been read."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528920818, "post_id": 50845252, "comment_id": 88694527, "body": "Do I have to do that every time I enter a password too?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528921113, "post_id": 50845252, "comment_id": 88694693, "body": "@WeatherVane, the password is entered only after HD is unmounted. And is remounted only after a reboot. RAM is easy to clean. I agree at this point it is getting less and less usable. But the point of my answer is highlighting that a pure software solution is very difficult to implement. Your comments actually support that."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 3, "last_activity_date": 1528919736, "creation_date": 1528919736, "answer_id": 50845252, "question_id": 50844024, "link": "https://stackoverflow.com/questions/50844024/forensic-wipe-a-file-from-hard-disk-in-c/50845252#50845252", "title": "Forensic wipe a file from hard disk in C", "body": "<p>Any kind of software technique cannot reliably zero out a file system, let alone a single file or directory. You need to abandon this approach. </p>\n\n<p>Now your other option is to physically destroy to bits. Yes it works, but come on. You cannot destroy a disk every time you want to destroy a file. </p>\n\n<p>The other more feasible option is to always encrypt your data while storing in the file. This reduces the problem to erasing only the key. But since it is significantly smaller, you can put it on a piece of paper. Now you just have to tear that paper and do a normal delete on the file. Even if \"they\" recover the encrypted contents, they can't do anything with it. </p>\n\n<p>Although there are factors to consider. When reading the file, you have to be careful that the data remains \"in memory\" only. You might say, I will never write the unencrypted stuff to the disk. But the OS might do it. Say it swaps your process out. </p>\n\n<p>So you need to carefully design your viewer. It should decrypt the file only into memory pages which are pinned. You might need to write some kernel modules for it. You also have to be careful about how you send the data to your display driver and what it does with it. Yes, it is doable with enough kernel modules. But each step from decryption to drawing pixels on the screen needs to be carefully audited. </p>\n"}, {"comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1528996287, "post_id": 50855176, "comment_id": 88727774, "body": "You can still encrypt individual files in Home edition using APIs or external libraries. This relies on some level obfuscation but it&#39;s good enough in practice."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 2, "last_activity_date": 1528971659, "creation_date": 1528971659, "answer_id": 50855176, "question_id": 50844024, "link": "https://stackoverflow.com/questions/50844024/forensic-wipe-a-file-from-hard-disk-in-c/50855176#50855176", "title": "Forensic wipe a file from hard disk in C", "body": "<p>[Meta answer]</p>\n\n<p>Good news: </p>\n\n<blockquote>\n  <p><strong>Turn on device encryption</strong></p>\n  \n  <p>Device encryption helps protect your data by encrypting it. Only someone with the right encryption key (such as a password) can decrypt it.</p>\n</blockquote>\n\n<p>Bad news:</p>\n\n<blockquote>\n  <p>Device encryption is not available in Windows 10 Home.</p>\n</blockquote>\n\n<p>The Lord giveth and the Lord taketh away, see: <a href=\"https://support.microsoft.com/en-gb/help/4028713/windows-10-turn-on-device-encryption\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-gb/help/4028713/windows-10-turn-on-device-encryption</a></p>\n"}], "owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1528971659, "creation_date": 1528914858, "last_edit_date": 1528915832, "question_id": 50844024, "link": "https://stackoverflow.com/questions/50844024/forensic-wipe-a-file-from-hard-disk-in-c", "title": "Forensic wipe a file from hard disk in C", "body": "<p>I know how to go about forensic wiping a complete disk for example. I could just use createfile and then writefile to write the entire disk. For example D:\\ with random garbage bits of data so that when I fire up a utility like easus recovery manager, I won't be able to find any trace of any file or recover them. Now I'm trying to accomplish the same with a particular file or directory in a disk. Suppose there is a file called Test.txt and I want to delete it and also fill the space occupied by it with garbage values so the space is not left out to be overwritten as windows usually works. Is it possible to do it in C? If so, how do I go about it? A code snippet would be extremely helpful!</p>\n"}, {"tags": ["c", "algorithm", "matrix-multiplication"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1528913941, "post_id": 50843776, "comment_id": 88691068, "body": "Do you really expect somebody to read this and answer &quot;what&#39;s wrong&quot; ?"}, {"owner": {"reputation": 14963, "user_id": 834261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vxyWz.png?s=128&g=1", "display_name": "hatchet - done with SOverflow", "link": "https://stackoverflow.com/users/834261/hatchet-done-with-soverflow"}, "edited": false, "score": 0, "creation_date": 1528914607, "post_id": 50843776, "comment_id": 88691416, "body": "In your question, you should explain what is wrong, i.e. inputs, expected outputs, actual outputs. <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 83, "user_id": 7920332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70120e97d87a1af2b9912b57e76102f2?s=128&d=identicon&r=PG&f=1", "display_name": "JustStartedCoding", "link": "https://stackoverflow.com/users/7920332/juststartedcoding"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528915938, "post_id": 50843776, "comment_id": 88692080, "body": "@Eugene Sh. Someone just did."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1528916951, "post_id": 50843776, "comment_id": 88692550, "body": "I would say you were <i>very</i> lucky."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7920332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70120e97d87a1af2b9912b57e76102f2?s=128&d=identicon&r=PG&f=1", "display_name": "JustStartedCoding", "link": "https://stackoverflow.com/users/7920332/juststartedcoding"}, "edited": false, "score": 0, "creation_date": 1528915379, "post_id": 50844068, "comment_id": 88691800, "body": "Wow! Thank you so much for your effort."}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 3, "last_activity_date": 1528914983, "creation_date": 1528914983, "answer_id": 50844068, "question_id": 50843776, "link": "https://stackoverflow.com/questions/50843776/whats-wrong-with-this-c-code-for-matrix-multiplication-using-strassens-algorit/50844068#50844068", "title": "What&#39;s wrong with this C code for Matrix Multiplication using Strassen&#39;s Algorithm?", "body": "<p>In <em>conquer for the divide &amp; conquer algorithm</em> algorithm you <strong>don't use</strong> <code>subSquareMatrices</code> function. Now look at definition of this function </p>\n\n<pre><code>int i; int j;\nfor(i = 0; j &lt; n; i++)  // &lt;-------\n{\n    for(j = 0; j &lt; n; j++)\n    {\n        subtractedMatrix[i][j] = matrixA[i][j] - matrixB[i][j];\n    }\n}\n</code></pre>\n\n<p><code>j</code> should be replaced by <code>i</code> in outer for loop.</p>\n"}], "owner": {"reputation": 83, "user_id": 7920332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70120e97d87a1af2b9912b57e76102f2?s=128&d=identicon&r=PG&f=1", "display_name": "JustStartedCoding", "link": "https://stackoverflow.com/users/7920332/juststartedcoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 50844068, "answer_count": 1, "score": 0, "last_activity_date": 1528914983, "creation_date": 1528913890, "question_id": 50843776, "link": "https://stackoverflow.com/questions/50843776/whats-wrong-with-this-c-code-for-matrix-multiplication-using-strassens-algorit", "title": "What&#39;s wrong with this C code for Matrix Multiplication using Strassen&#39;s Algorithm?", "body": "<pre><code>// Probably some mistake in \"conquer\" part of the recursive function \"multiplySquareMatrices\".\n\n#include&lt;stdio.h&gt;\n\nvoid showSquareMatrix(int n, int[][n]);\nvoid copyMatrix_Complete2Part(int n, int[][n], int, int, int, int, int m, \nint[][m]);\nvoid subSquareMatrices(int n, int[][n], int[][n], int[][n]);\nvoid addSquareMatrices(int n, int[][n], int[][n], int[][n]);\nvoid copyMatrix_Part2Complete(int n, int[][n], int m, int[][m], int, int, int, int);\nvoid multiplySquareMatrices(int n, int[][n], int[][n], int[][n]);\nvoid acceptSquareMatrix(int n, int[][n]);\n\nint main()\n{\n    int n = 2;\n    int matrixA[n][n];\n    int matrixB[n][n];\n    int matrixAB[n][n];\n\n    acceptSquareMatrix(n, matrixA);\n    acceptSquareMatrix(n, matrixB);\n\n    multiplySquareMatrices(n, matrixAB, matrixA, matrixB);\n    showSquareMatrix(n, matrixAB);\n}\n\nvoid acceptSquareMatrix(int n, int matrix[][n])     // matrix[][columns] should not be changed.\n{\n    int i;\n    int j;\n    for(i = 0; i &lt; n; i++)\n    {\n        for(j = 0; j &lt; n; j++)\n        {\n            printf(\"\\n[%d][%d]: \", i, j);\n            scanf(\"%d\", &amp;matrix[i][j]);\n        }\n    }\n}\n\nvoid multiplySquareMatrices(int n, int matrixAB[][n], int matrixA[][n], int matrixB[][n])\n{\n    if(n == 1)\n    {\n        matrixAB[0][0] = matrixA[0][0] * matrixB[0][0];\n    }\n    else\n    {\n        //divide\n        int matrix_a[n / 2][n / 2];\n        int matrix_b[n / 2][n / 2];\n        int matrix_c[n / 2][n / 2];\n        int matrix_d[n / 2][n / 2];\n\n        int matrix_e[n / 2][n / 2];\n        int matrix_f[n / 2][n / 2];\n        int matrix_g[n / 2][n / 2];\n        int matrix_h[n / 2][n / 2];\n\n        int rowStart_a = 0;     int rowEnd_a = (n/2) - 1;     int columnStart_a = 0;        int columnEnd_a = (n/2) - 1;\n        int rowStart_b = 0;     int rowEnd_b = (n/2) - 1;     int columnStart_b = n/2;      int columnEnd_b = n - 1;\n        int rowStart_c = n/2;   int rowEnd_c = n - 1;         int columnStart_c = 0;        int columnEnd_c = (n/2) - 1;\n        int rowStart_d = n/2;   int rowEnd_d = n - 1;         int columnStart_d = n/2;      int columnEnd_d = n - 1;\n\n        int rowStart_e = 0;     int rowEnd_e = (n/2) - 1;     int columnStart_e = 0;        int columnEnd_e = (n/2) - 1;\n        int rowStart_f = 0;     int rowEnd_f = (n/2) - 1;     int columnStart_f = n/2;      int columnEnd_f = n - 1;\n        int rowStart_g = n/2;   int rowEnd_g = n - 1;         int columnStart_g = 0;        int columnEnd_g = (n/2) - 1;\n        int rowStart_h = n/2;   int rowEnd_h = n - 1;         int columnStart_h = n/2;      int columnEnd_h = n - 1;\n\n        copyMatrix_Part2Complete(n / 2, matrix_a, n, matrixA, rowStart_a, rowEnd_a, columnStart_a, columnEnd_a);\n        copyMatrix_Part2Complete(n / 2, matrix_b, n, matrixA, rowStart_b, rowEnd_b, columnStart_b, columnEnd_b);\n        copyMatrix_Part2Complete(n / 2, matrix_c, n, matrixA, rowStart_c, rowEnd_c, columnStart_c, columnEnd_c);\n        copyMatrix_Part2Complete(n / 2, matrix_d, n, matrixA, rowStart_d, rowEnd_d, columnStart_d, columnEnd_d);\n\n        copyMatrix_Part2Complete(n / 2, matrix_e, n, matrixB, rowStart_e, rowEnd_e, columnStart_e, columnEnd_e);\n        copyMatrix_Part2Complete(n / 2, matrix_f, n, matrixB, rowStart_f, rowEnd_f, columnStart_f, columnEnd_f);\n        copyMatrix_Part2Complete(n / 2, matrix_g, n, matrixB, rowStart_g, rowEnd_g, columnStart_g, columnEnd_g);\n        copyMatrix_Part2Complete(n / 2, matrix_h, n, matrixB, rowStart_h, rowEnd_h, columnStart_h, columnEnd_h);\n\n        //conquer\n        /*\n        //conquer for divide and conquer algorithm\n        int matrix_r[n / 2][n / 2];\n        int matrix_s[n / 2][n / 2];\n        int matrix_t[n / 2][n / 2];\n        int matrix_u[n / 2][n / 2];\n\n        int matrix_ae[n / 2][n / 2];\n        int matrix_bg[n / 2][n / 2];\n        int matrix_af[n / 2][n / 2];\n        int matrix_bh[n / 2][n / 2];\n        int matrix_ce[n / 2][n / 2];\n        int matrix_dg[n / 2][n / 2];\n        int matrix_cf[n / 2][n / 2];\n        int matrix_dh[n / 2][n / 2];\n\n        multiplySquareMatrices(n / 2, matrix_ae, matrix_a, matrix_e);\n        multiplySquareMatrices(n / 2, matrix_bg, matrix_b, matrix_g);\n        multiplySquareMatrices(n / 2, matrix_af, matrix_a, matrix_f);\n        multiplySquareMatrices(n / 2, matrix_bh, matrix_b, matrix_h);\n        multiplySquareMatrices(n / 2, matrix_ce, matrix_c, matrix_e);\n        multiplySquareMatrices(n / 2, matrix_dg, matrix_d, matrix_g);\n        multiplySquareMatrices(n / 2, matrix_cf, matrix_c, matrix_f);\n        multiplySquareMatrices(n / 2, matrix_dh, matrix_d, matrix_h);\n\n        addSquareMatrices(n / 2, matrix_r, matrix_ae, matrix_bg);\n        addSquareMatrices(n / 2, matrix_s, matrix_af, matrix_bh);\n        addSquareMatrices(n / 2, matrix_t, matrix_ce, matrix_dg);\n        addSquareMatrices(n / 2, matrix_u, matrix_cf, matrix_dh);\n        */\n\n        //conquer for Strassen's algorithm\n        int matrix_fSubH[n / 2][n / 2];\n        int matrix_aAddB[n / 2][n / 2];\n        int matrix_cAddD[n / 2][n / 2];\n        int matrix_gSubE[n / 2][n / 2];\n        int matrix_aAddD[n / 2][n / 2];\n        int matrix_eAddH[n / 2][n / 2];\n        int matrix_bSubD[n / 2][n / 2];\n        int matrix_gAddH[n / 2][n / 2];\n        int matrix_aSubC[n / 2][n / 2];\n        int matrix_eAddF[n / 2][n / 2];\n\n        subSquareMatrices(n / 2, matrix_fSubH, matrix_f, matrix_h); //S1 = B12 - B22\n        addSquareMatrices(n / 2, matrix_aAddB, matrix_a, matrix_b); //S2 = A11 + A12\n        addSquareMatrices(n / 2, matrix_cAddD, matrix_c, matrix_d); //S3 = A21 + A22\n        subSquareMatrices(n / 2, matrix_gSubE, matrix_g, matrix_e); //S4 = B21 - B11\n        addSquareMatrices(n / 2, matrix_aAddD, matrix_a, matrix_d); //S5 = A11 + A22\n        addSquareMatrices(n / 2, matrix_eAddH, matrix_e, matrix_h); //S6 = B11 + B22\n        subSquareMatrices(n / 2, matrix_bSubD, matrix_b, matrix_d); //S7 = A12 - A22\n        addSquareMatrices(n / 2, matrix_gAddH, matrix_g, matrix_h); //S8 = B21 + B22\n        subSquareMatrices(n / 2, matrix_aSubC, matrix_a, matrix_c); //S9 = A11 - A21\n        addSquareMatrices(n / 2, matrix_eAddF, matrix_e, matrix_f); //S10= B11 + B12\n\n        int matrix_p1[n / 2][n / 2];\n        int matrix_p2[n / 2][n / 2];\n        int matrix_p3[n / 2][n / 2];\n        int matrix_p4[n / 2][n / 2];\n        int matrix_p5[n / 2][n / 2];\n        int matrix_p6[n / 2][n / 2];\n        int matrix_p7[n / 2][n / 2];\n\n        multiplySquareMatrices(n / 2, matrix_p1, matrix_a,     matrix_fSubH); //P1 = A11*S1\n        multiplySquareMatrices(n / 2, matrix_p2, matrix_aAddB, matrix_h);     //P2 = S2*B22\n        multiplySquareMatrices(n / 2, matrix_p3, matrix_cAddD, matrix_e);     //P3 = S3*B11\n        multiplySquareMatrices(n / 2, matrix_p4, matrix_d,     matrix_gSubE); //P4 = A22*S4\n        multiplySquareMatrices(n / 2, matrix_p5, matrix_aAddD, matrix_eAddH); //P5 = S5*S6\n        multiplySquareMatrices(n / 2, matrix_p6, matrix_bSubD, matrix_gAddH); //P6 = S7*S8\n        multiplySquareMatrices(n / 2, matrix_p7, matrix_aSubC, matrix_eAddF); //P7 = S9*S10\n\n        int matrix_r[n / 2][n / 2];\n        int matrix_s[n / 2][n / 2];\n        int matrix_t[n / 2][n / 2];\n        int matrix_u[n / 2][n / 2];\n\n        int matrix_rTemp1[n / 2][n / 2];\n        int matrix_rTemp2[n / 2][n / 2];\n        int matrix_uTemp1[n / 2][n / 2];\n        int matrix_uTemp2[n / 2][n / 2];\n\n        addSquareMatrices(n / 2, matrix_rTemp1,        matrix_p5,            matrix_p4); //P5 + P4\n        subSquareMatrices(n / 2, matrix_rTemp2,        matrix_rTemp1,        matrix_p2); //(P5 + P4) - P2\n        addSquareMatrices(n / 2, matrix_r,             matrix_rTemp2,        matrix_p6); //C11 = (P5 + P4 - P2) + P6\n\n        addSquareMatrices(n / 2, matrix_s,             matrix_p1,            matrix_p2); //C12 = P1 + P2\n\n        addSquareMatrices(n / 2, matrix_t,             matrix_p3,            matrix_p4); //C21 = P3 + P4\n\n        addSquareMatrices(n / 2, matrix_uTemp1,        matrix_p5,            matrix_p1); //P5 + P1\n        subSquareMatrices(n / 2, matrix_uTemp2,        matrix_uTemp1,        matrix_p3); //(P5 + P1) - P3\n        subSquareMatrices(n / 2, matrix_u,             matrix_uTemp2,        matrix_p7); //C22 = (P5 + P1 - P3) - P7\n\n        //combine\n        int rowStart_r = 0;     int rowEnd_r = (n/2) - 1;     int columnStart_r = 0;        int columnEnd_r = (n/2) - 1;\n        int rowStart_s = 0;     int rowEnd_s = (n/2) - 1;     int columnStart_s = n/2;      int columnEnd_s = n - 1;\n        int rowStart_t = n/2;   int rowEnd_t = n - 1;         int columnStart_t = 0;        int columnEnd_t = (n/2) - 1;\n        int rowStart_u = n/2;   int rowEnd_u = n - 1;         int columnStart_u = n/2;      int columnEnd_u = n - 1;\n\n        copyMatrix_Complete2Part(n, matrixAB, rowStart_r, rowEnd_r, columnStart_r, columnEnd_r, (n / 2), matrix_r);\n        copyMatrix_Complete2Part(n, matrixAB, rowStart_s, rowEnd_s, columnStart_s, columnEnd_s, (n / 2), matrix_s);\n        copyMatrix_Complete2Part(n, matrixAB, rowStart_t, rowEnd_t, columnStart_t, columnEnd_t, (n / 2), matrix_t);\n        copyMatrix_Complete2Part(n, matrixAB, rowStart_u, rowEnd_u, columnStart_u, columnEnd_u, (n / 2), matrix_u);\n\n    }\n}\n\nvoid copyMatrix_Part2Complete(int destN, int destMatrix[][destN], int srcN, \nint srcMatrix[][srcN], int rowS, int rowE, int colS, int colE)\n{\n    int i; int j;\n    int k; int l;\n\n    for(i = rowS, k = 0; k &lt; destN; i++, k++)\n    {\n        for(j = colS, l = 0; l &lt; destN; j++, l++)\n        {\n            destMatrix[k][l] = srcMatrix[i][j];\n        }\n    }\n}\n\nvoid addSquareMatrices(int n, int addedMatrix[][n], int matrixA[][n], int matrixB[][n])\n{\n    int i; int j;\n    for(i = 0; i &lt; n; i++)\n    {\n        for(j = 0; j &lt; n; j++)\n        {\n            addedMatrix[i][j] = matrixA[i][j] + matrixB[i][j];\n        }\n    }\n}\n\nvoid subSquareMatrices(int n, int subtractedMatrix[][n], int matrixA[][n], int matrixB[][n])\n{\n    int i; int j;\n    for(i = 0; j &lt; n; i++)\n    {\n        for(j = 0; j &lt; n; j++)\n        {\n            subtractedMatrix[i][j] = matrixA[i][j] - matrixB[i][j];\n        }\n    }\n}\n\nvoid copyMatrix_Complete2Part(int destN, int destMatrix[][destN], int rowStart, int rowEnd, int columnStart, int columnEnd, int srcN, int srcMatrix[][srcN])\n{\n    int i; int j;\n    int k; int l;\n\n    for(i = 0, k = rowStart; k &lt;= rowEnd; i++, k++)\n    {\n        for(j = 0, l = columnStart; l &lt;= columnEnd; j++, l++)\n        {\n            destMatrix[k][l] = srcMatrix[i][j];\n        }\n    }\n}\n\nvoid showSquareMatrix(int n, int matrix[][n])\n{\n    int i;\n    int j;\n    for(i = 0; i &lt; n; i++)\n    {\n        printf(\"\\n\");\n        for(j = 0; j &lt; n; j++)\n        {\n            printf(\"\\t%d\", matrix[i][j]);\n        }\n    }\n}\n</code></pre>\n\n<p>In the conquer part of the recurseve fuction \"multiplySquareMatrices\", there may be some problem.</p>\n\n<p>If I replace the \"conquer for Strassen's algorithm\" part of the code with \"conquer for the Divide &amp; Conquer algorithm\" by decommenting the \"conquer for the divide &amp; conquer algorithm\" part &amp; commenting the \"conquer for Strassen's algorithm\" part, the code works. I'm unable to understand why?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 4, "creation_date": 1528911596, "post_id": 50843188, "comment_id": 88689936, "body": "You never allocated any memory for <code>my_record</code> to point to. Why are you using a pointer instead of just a regular struct?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1528911619, "post_id": 50843188, "comment_id": 88689948, "body": "<code>abc my_record = malloc(sizeof *my_record);</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1528911651, "post_id": 50843188, "comment_id": 88689967, "body": "Also see <a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">is it a good idea to typedef pointers</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528912033, "post_id": 50843188, "comment_id": 88690171, "body": "Although it might not be obvious, in this code you loaded the gun, aimed precisely at your foot, and fired. <code>abc</code> is a random pointer, it&#39;s never initialized properly, and when you use it you&#39;re experiencing <i>undefined behaviour</i>."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528915375, "post_id": 50843188, "comment_id": 88691797, "body": "It&#39;s important to understand that you have defined <code>abc</code> to be a type that is a pointer to <code>struct rec</code>s. That&#39;s why @tadman is saying that <code>my_record</code> is a random pointer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529074635, "post_id": 50843188, "comment_id": 88758228, "body": "It is a poor programming practice to hide pointers inside a typedef"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529074777, "post_id": 50843188, "comment_id": 88758308, "body": "The callable function: <code>system()</code> is exposed in the header file: <code>stdlib.</code>  However, the posted code is missing the <code>#include</code> statement for that header file."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529074992, "post_id": 50843188, "comment_id": 88758442, "body": "Error messages should be output to <code>stderr</code>, not <code>stdout</code> and when the &#39;error&#39; is from a C library function, should also output the text reason the system thinks the error occurred.  One easy way to handle that operation is to call <code>perror( &quot;your error message&quot; );</code>"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1528912015, "creation_date": 1528912015, "answer_id": 50843302, "question_id": 50843188, "link": "https://stackoverflow.com/questions/50843188/assign-value-to-a-pointer-of-structure/50843302#50843302", "title": "Assign value to a pointer of structure", "body": "<p>You have several problems.</p>\n\n<p>First, you didn't allocate memory for <code>my_record</code> to point to. The warning about using an uninitialized variable is because you didn't do:</p>\n\n<pre><code>abc my_record = malloc(sizeof(struct rec));\n</code></pre>\n\n<p>Second, the first argument to <code>fwrite()</code> should be the pointer to the structure you want to write, but you're using a pointer to the pointer.</p>\n\n<p>Third, the second argument to <code>fwrite()</code> should be the size of the structure, but you're giving the size of the pointer.</p>\n\n<p>There doesn't seem to be any good reason to define <code>abc</code> as a pointer in the first place. You should just declare a variable containing the structure itself.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct rec\n{\n    int x, y, z;\n} abc;\n\nint main()\n{\n    int counter;\n    FILE *ptr_myfile;\n    //struct rec my_record;\n    abc my_record;\n\n    ptr_myfile = fopen(\"test.bin\", \"wb\");\n    if (!ptr_myfile)\n    {\n        printf(\"Unable to open file!\");\n        return 1;\n    }\n    for (counter = 1; counter &lt;= 10; counter++)\n    {\n        my_record.x = counter;\n        fwrite(&amp;my_record, sizeof my_record, 1, ptr_myfile);\n    }\n    fclose(ptr_myfile);\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 658, "user_id": 9622607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nw0OF.jpg?s=128&g=1", "display_name": "Alyson Maia", "link": "https://stackoverflow.com/users/9622607/alyson-maia"}, "is_accepted": false, "score": 1, "last_activity_date": 1528912183, "creation_date": 1528912183, "answer_id": 50843341, "question_id": 50843188, "link": "https://stackoverflow.com/questions/50843188/assign-value-to-a-pointer-of-structure/50843341#50843341", "title": "Assign value to a pointer of structure", "body": "<p>Try this:</p>\n\n<pre><code>// Include this\n#include &lt;stdlib.h&gt;\n\ntypedef struct rec {\n    int x, y, z;\n} abc;\n\nint main() {\n    ...\n\n    abc *my_record = (abc*) malloc( sizeof(abc) );\n\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 3, "last_activity_date": 1528914023, "last_edit_date": 1528914023, "creation_date": 1528912252, "answer_id": 50843360, "question_id": 50843188, "link": "https://stackoverflow.com/questions/50843188/assign-value-to-a-pointer-of-structure/50843360#50843360", "title": "Assign value to a pointer of structure", "body": "<p>There are couple of issues in your code like</p>\n\n<ul>\n<li><p>In this <code>abc my_record;</code> the <code>abc</code> is <code>struct rec*</code> and compiler is rightly complaining about <code>my_record</code> not being initialized. As it looks like </p>\n\n<p><code>struct rec *my_record; /* un-initilized struct ptr */</code></p>\n\n<p>So first allocate the memory for it like</p>\n\n<p><code>abc my_record = malloc(sizeof(struct rec));</code></p></li>\n<li><p>Here in <code>fwrite(&amp;my_record, sizeof(abc), 1, ptr_myfile);</code> the second argument <code>sizeof(abc)</code> is wrong as <code>abc</code> is structure pointer, it won't yield in correct result. Also first arguement of <code>fwrite()</code> is wrong, as it should be pointer to structure <code>my_record</code> not <code>&amp;my_record</code>.</p>\n\n<p><code>fwrite(my_record, sizeof(struct rec), 1, ptr_myfile);</code> </p></li>\n</ul>\n\n<p>And also you want to see <a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to typedef pointers?</a> After reading this link you might want to avoid <code>typedef</code> a pointer as you did above in your code &amp; you want to do like below</p>\n\n<pre><code>typedef struct rec {\n    int x, y, z;\n}abc;\nint main(void) {\n    int counter;\n    FILE *ptr_myfile;\n    abc *my_record = malloc(sizeof(struct rec));\n    ptr_myfile = fopen(\"test.bin\", \"wb\");\n    if (!ptr_myfile) {\n        printf(\"Unable to open file!\");\n        return 1;\n    }\n    for (counter = 1; counter &lt;= 10; counter++) {\n        my_record-&gt;x = counter;\n        fwrite(my_record, sizeof(abc), 1, ptr_myfile);\n    }\n    fclose(ptr_myfile);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9937525, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6pS1I12MQno/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0lBPbzjCxYJOQrcMt_kwTXDOfsAA/mo/photo.jpg?sz=128", "display_name": "Lance", "link": "https://stackoverflow.com/users/9937525/lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 50843302, "answer_count": 3, "score": 0, "last_activity_date": 1528914023, "creation_date": 1528911509, "last_edit_date": 1528911920, "question_id": 50843188, "link": "https://stackoverflow.com/questions/50843188/assign-value-to-a-pointer-of-structure", "title": "Assign value to a pointer of structure", "body": "<p>I'm trying to assign value to <code>my_record</code> but the compiler keeps indicating that my line <code>my_record-&gt;x = counter;</code> is having an error: </p>\n\n<blockquote>\n  <p>uninitialized local variable 'my_record' used.</p>\n</blockquote>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct rec\n{\n    int x, y, z;\n} *abc;\n\nint main()\n{\n    int counter;\n    FILE *ptr_myfile;\n    //struct rec my_record;\n    abc my_record;\n\n    ptr_myfile = fopen(\"test.bin\", \"wb\");\n    if (!ptr_myfile)\n    {\n        printf(\"Unable to open file!\");\n        return 1;\n    }\n    for (counter = 1; counter &lt;= 10; counter++)\n    {\n        my_record-&gt;x = counter;\n        fwrite(&amp;my_record, sizeof(abc), 1, ptr_myfile);\n    }\n    fclose(ptr_myfile);\n    system(\"pause\");\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "shell", "unix"], "comments": [{"owner": {"reputation": 54765, "user_id": 309412, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9739ec5574d9977b522d1c80fb8de84?s=128&d=identicon&r=PG", "display_name": "Lie Ryan", "link": "https://stackoverflow.com/users/309412/lie-ryan"}, "edited": false, "score": 0, "creation_date": 1528911496, "post_id": 50843093, "comment_id": 88689889, "body": "What&#39;s the error you&#39;re getting?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528911499, "post_id": 50843093, "comment_id": 88689891, "body": "Your <code>parsed</code> is probably bad. You should show how you obtain it."}, {"owner": {"reputation": 45, "user_id": 7861742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1122558827889522/picture?type=large", "display_name": "Patrick Hession", "link": "https://stackoverflow.com/users/7861742/patrick-hession"}, "reply_to_user": {"reputation": 54765, "user_id": 309412, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9739ec5574d9977b522d1c80fb8de84?s=128&d=identicon&r=PG", "display_name": "Lie Ryan", "link": "https://stackoverflow.com/users/309412/lie-ryan"}, "edited": false, "score": 0, "creation_date": 1528912522, "post_id": 50843093, "comment_id": 88690405, "body": "The error I am getting is &#39;bad address&#39;  @LieRyan"}], "answers": [{"tags": [], "owner": {"reputation": 54765, "user_id": 309412, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9739ec5574d9977b522d1c80fb8de84?s=128&d=identicon&r=PG", "display_name": "Lie Ryan", "link": "https://stackoverflow.com/users/309412/lie-ryan"}, "is_accepted": true, "score": 5, "last_activity_date": 1528912902, "last_edit_date": 1528912902, "creation_date": 1528912547, "answer_id": 50843440, "question_id": 50843093, "link": "https://stackoverflow.com/questions/50843093/i-am-working-on-creating-my-own-unix-shell-and-some-times-when-i-run-ls-comman/50843440#50843440", "title": "I am working on creating my own UNIX shell and some times when I run &#39;ls&#39; command it gives an error bad address", "body": "<p>According to <a href=\"https://www.gnu.org/software/libc/manual/html_node/Error-Codes.html\" rel=\"noreferrer\">https://www.gnu.org/software/libc/manual/html_node/Error-Codes.html</a>:</p>\n\n<pre><code>Macro: int EFAULT\n\n    \u201cBad address.\u201d An invalid pointer was detected.\n</code></pre>\n\n<p>If you receive this error from execvp, that means that some of the pointer in <code>parsed</code> was invalid. You should look into the rest of the program and make sure any strings in the <code>parsed</code> array are not free()-ed until the execvp calls are completed. </p>\n\n<p>Another very common mistake is that since you're not passing the length of the argument array to execvp, the <code>argv</code> argument must be a NULL-terminated array, so that execvp knows when to stop reading arguments. That means that if you're receiving command that looks like so: <code>ls -lah /bin</code> then your <code>argv</code> array should be one larger and end it with a NULL pointer:</p>\n\n<pre><code>char** argv = {\"ls\", \"-lah\", \"/bin\", NULL};\n</code></pre>\n\n<p>If you don't end the argv with a NULL pointer, execvp will try to dereference whatever comes next in the memory as an pointer address, and unless it happens to contain NULL bytes, then the derefence likely will fail or may dereference to unexpected things.</p>\n"}], "owner": {"reputation": 45, "user_id": 7861742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1122558827889522/picture?type=large", "display_name": "Patrick Hession", "link": "https://stackoverflow.com/users/7861742/patrick-hession"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 50843440, "answer_count": 1, "score": 1, "last_activity_date": 1528912902, "creation_date": 1528911099, "question_id": 50843093, "link": "https://stackoverflow.com/questions/50843093/i-am-working-on-creating-my-own-unix-shell-and-some-times-when-i-run-ls-comman", "title": "I am working on creating my own UNIX shell and some times when I run &#39;ls&#39; command it gives an error bad address", "body": "<p>I am wondering if there is an error with execvp calling ls that can cause it to fail occassionally and then work properly other times.</p>\n\n<pre><code>void lookInsideCurrentDirectory(char **parsed){\n    char* line = NULL;\n    pid_t pid = fork();\n\n    if(pid == -1){\n        return;\n    }\n    else if(pid == 0){\n        if(execvp(parsed[0], parsed) == -1){\n            perror(\"Error: \");\n        }\n        exit(0);\n    }\n    else{\n        wait(NULL); \n        return;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "types", "linux-kernel", "endianness", "integer-promotion"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1528910892, "post_id": 50842942, "comment_id": 88689592, "body": "This code snippet does not depend on endianness. It does depend on the <i>signedness</i> of <code>char</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528911304, "post_id": 50842942, "comment_id": 88689784, "body": "It is <i>converted</i> to uint32_t, yes. But how it is done is depending on whether it is signed or not."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1528911642, "post_id": 50842942, "comment_id": 88689964, "body": "<code>*d</code> is one byte, so no order matters."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528912319, "post_id": 50842942, "comment_id": 88690296, "body": "It doesn&#39;t matter. It is internal to the compiler and used only for the calculation."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1528913917, "post_id": 50842942, "comment_id": 88691056, "body": "The single byte <code>*d</code> will be either sign-extended to 32 bits or zero-extended to 32 bits, depending on whether <code>char</code> is signed or not."}, {"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529343409, "post_id": 50842942, "comment_id": 88829578, "body": "@IanAbbott So to avoid this signedness of char, I could write it as val = ((u32)(unsigned char)*d &amp; mask) &gt;&gt; step; ?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529402906, "post_id": 50842942, "comment_id": 88850562, "body": "Yes, but does it need to be <code>char *</code> to start with, rather than, say, a <code>u8 *</code>?"}, {"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529406297, "post_id": 50842942, "comment_id": 88852663, "body": "@IanAbbott the code snippet I showed in the post was written before me, and I&#39;m wondering why it cant&#39; be <code>unsigned char *d</code>, probably for efficiency reasons?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529408010, "post_id": 50842942, "comment_id": 88853707, "body": "It woudn&#39;t be for efficiency reasons. It might be because it was passed as a <code>char *</code> from further up."}], "answers": [{"comments": [{"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 0, "creation_date": 1528912150, "post_id": 50843266, "comment_id": 88690216, "body": "thanks for comments. So after promotion to <code>int</code> and later on conversion ti <code>u32</code> (or <code>uint32_t</code>), the endiannes matters. Will it be the host endiannes? I updated the question, because I see the same in linux kernel, where is processes network socket buffers, so whatever has arrived from the network is stored in <code>skb</code>, and it is in <code>network</code> byte-order."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528912254, "post_id": 50843266, "comment_id": 88690266, "body": "How did you conclude the endianess matter? In your posted code the value of <code>val</code> <i>does not depend</i> on the endianness of the machine"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 1, "creation_date": 1528912257, "post_id": 50843266, "comment_id": 88690270, "body": "@Mark The endiness matters only after you&#39;ve read each byte individually and have to interpret them.  <code>*d</code> only pulls one byte from the buffer, not 4."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528912525, "post_id": 50843266, "comment_id": 88690409, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.8\" rel=\"nofollow noreferrer\">This is</a> (and <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.3\" rel=\"nofollow noreferrer\">this</a>)how it is converted. Note the lack of any endianess reference."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 1, "creation_date": 1528912654, "post_id": 50843266, "comment_id": 88690477, "body": "@Mark <code>*d</code> is one byte, holding a value from -128 to 127.  When it is converted, it will still have a value in that range.  Converting <code>*d</code> to a larger type doesn&#39;t automatically pull the next 3 bytes after the one <code>d</code> points to."}, {"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 0, "creation_date": 1528917364, "post_id": 50843266, "comment_id": 88692753, "body": "@dbush, so it means that <code>printf(&quot;%08x&quot;, *d)</code> will produce the same result on any byte-order machines?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 2, "creation_date": 1528917480, "post_id": 50843266, "comment_id": 88692803, "body": "@Mark Correct.  It&#39;s only a single byte, so endianness does not come into play."}, {"owner": {"reputation": 10586, "user_id": 170383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d9f7a30948dca1bbd05eaf27f277ae6?s=128&d=identicon&r=PG", "display_name": "David R Tribble", "link": "https://stackoverflow.com/users/170383/david-r-tribble"}, "edited": false, "score": 1, "creation_date": 1528922438, "post_id": 50843266, "comment_id": 88695390, "body": "CPU registers do not have endianness. Once a byte has been read from memory into a register, any binary bit-masking (and-ing) and shifting operate on the arithmetic binary value of the register as a whole."}, {"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "reply_to_user": {"reputation": 10586, "user_id": 170383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d9f7a30948dca1bbd05eaf27f277ae6?s=128&d=identicon&r=PG", "display_name": "David R Tribble", "link": "https://stackoverflow.com/users/170383/david-r-tribble"}, "edited": false, "score": 0, "creation_date": 1529077660, "post_id": 50843266, "comment_id": 88759892, "body": "@DavidRTribble is it always guaranteed that operands (in this case bitwise operations) will be in CPU registers?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 0, "creation_date": 1529080036, "post_id": 50843266, "comment_id": 88761015, "body": "@Mark As far as the C language is concerned no, although in practice it will probably be the case."}, {"owner": {"reputation": 10586, "user_id": 170383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d9f7a30948dca1bbd05eaf27f277ae6?s=128&d=identicon&r=PG", "display_name": "David R Tribble", "link": "https://stackoverflow.com/users/170383/david-r-tribble"}, "reply_to_user": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 1, "creation_date": 1529334004, "post_id": 50843266, "comment_id": 88824697, "body": "@Mark, It&#39;s hard to conceive of an existing CPU architecture that does not load its registers with expression operands at some point. But my point is that integer operands do not have an endianness within evaluated expressions, just binary values of some bit width. In other words, <code>1 &lt;&lt; 12</code> will be the same value regardless of CPU endianness. Endianness is simply not relevant to integer expression evaluation."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1528911894, "creation_date": 1528911894, "answer_id": 50843266, "question_id": 50842942, "link": "https://stackoverflow.com/questions/50842942/integer-promotion-of-bit-wise-operation-and-endiannes-issue/50843266#50843266", "title": "integer promotion of bit-wise operation and endiannes issue", "body": "<p>Because <code>d</code> has type <code>char *</code> it reads a <em>single</em> byte at the address pointed to by <code>d</code>.  So the expression <code>*d</code> has type <code>char</code> which has the value of the byte pointed to by <code>d</code>.  Endianness doesn't matter here because only a single byte is read from <code>d</code>.</p>\n\n<p>In the larger expression <code>*d &amp; mask</code>, the value <code>*d</code> which has type <code>char</code> is <em>converted</em> to <code>uint32_t</code> for use in the expression.</p>\n"}], "owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 50843266, "answer_count": 1, "score": 0, "last_activity_date": 1528911894, "creation_date": 1528910466, "last_edit_date": 1528911212, "question_id": 50842942, "link": "https://stackoverflow.com/questions/50842942/integer-promotion-of-bit-wise-operation-and-endiannes-issue", "title": "integer promotion of bit-wise operation and endiannes issue", "body": "<p>Consider the following snippet from code running in the Linux kernel:</p>\n\n<pre><code>    char *d;\n    u32 mask, step, val;\n    ...\n    /* d is initialized with valid pointer pointing at buffer,\nand mask, step and val are initialized to some sane values as well. */\n    ...\n    val = (*d &amp; mask) &gt;&gt; step;\n</code></pre>\n\n<p>As you see only <code>d</code> is of <code>char *</code> type, the rest are unsigned integers. I know that C performs type conversions automatically when\nvalues of differing types participate in expressions, in this case\nbit-wise operation. So, I'm assuming it is guaranteed that <code>*d</code> will be promoted to <code>uint32_t</code> as well?</p>\n\n<p>If this assumption is correct, my 2nd question would be about the <em>byte-order</em> of 4 bytes located at memory pointed by <code>d</code>. I think it has to be whatever byte-order the host implements, or if it's networking, then strictly big-endian.</p>\n"}, {"tags": ["c", "linux", "bluetooth"], "comments": [{"owner": {"reputation": 741, "user_id": 5429584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvb2K.jpg?s=128&g=1", "display_name": "Mike Petrichenko", "link": "https://stackoverflow.com/users/5429584/mike-petrichenko"}, "edited": false, "score": 0, "creation_date": 1528911090, "post_id": 50842804, "comment_id": 88689688, "body": "Bluetooth keyboard implements Bluetooth HID profile. You can use any kind of lib but better to use l2cap socket connection and receive HID packets from your keyboard. (Of course, if the keyboard is not something special)"}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "reply_to_user": {"reputation": 741, "user_id": 5429584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvb2K.jpg?s=128&g=1", "display_name": "Mike Petrichenko", "link": "https://stackoverflow.com/users/5429584/mike-petrichenko"}, "edited": false, "score": 0, "creation_date": 1528911958, "post_id": 50842804, "comment_id": 88690131, "body": "In this case, do I need to initiate the transfer anyhow, perhaps with some sequence our smth. like that?"}, {"owner": {"reputation": 741, "user_id": 5429584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvb2K.jpg?s=128&g=1", "display_name": "Mike Petrichenko", "link": "https://stackoverflow.com/users/5429584/mike-petrichenko"}, "edited": false, "score": 0, "creation_date": 1528912222, "post_id": 50842804, "comment_id": 88690250, "body": "I am not so familiar with HID profile but on first look it is very similar to USB HID. SDP provides device descriptors (as in USB) and HID control channel implemented above L2CAP. You can find full HID specification there: <a href=\"https://www.bluetooth.com/specifications/profiles-overview\" rel=\"nofollow noreferrer\">bluetooth.com/specifications/profiles-overview</a>"}], "owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528909939, "creation_date": 1528909939, "question_id": 50842804, "link": "https://stackoverflow.com/questions/50842804/read-key-press-on-a-bluetooth-keyboard", "title": "Read key press on a bluetooth keyboard", "body": "<p>In my linux program I need to read the key presses on a bluetooth keyboard.\nI tried to follow a set of examples using libbluetooth, but have so far no success.</p>\n\n<p>At the last stage I am totally confused on what API to use.\nAs I understood, the library provides SDP and HCI interfaces and they both seem to be suitable for my need. I even could read out some information about the keyboard, but I cannot get further how to receive key presses.</p>\n\n<p>So, I need you help to understand:</p>\n\n<ul>\n<li><p>do I need in general to use the libbluetooth or I have to use native BT sockets?</p></li>\n<li><p>assuming, that I do need to use the lib, which API to use: SDP or HCI (perhaps another..)?</p></li>\n<li><p>is the lib only required to initiate data transfer from the BT device, or also to receive the data</p></li>\n</ul>\n"}, {"tags": ["c", "linked-list", "pass-by-reference"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528909843, "post_id": 50842694, "comment_id": 88689013, "body": "Do some searching for <i>emulating pass by reference in C</i>."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 3, "creation_date": 1528909868, "post_id": 50842694, "comment_id": 88689023, "body": "Your <code>delete_num</code> looks okay to me, but where you call it you need to do <code>head = delete_num (wanted, head);</code>."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1528911085, "post_id": 50842694, "comment_id": 88689683, "body": "<code>temp = NULL</code> should be <code>free(temp)</code>, shouldn&#39;t it?"}, {"owner": {"reputation": 47, "user_id": 9937276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5a5b40fbba344bf7f44af8f370c2da?s=128&d=identicon&r=PG&f=1", "display_name": "Sexy mf", "link": "https://stackoverflow.com/users/9937276/sexy-mf"}, "edited": false, "score": 0, "creation_date": 1528919178, "post_id": 50842694, "comment_id": 88693712, "body": "First of all, thank you for taking the time to help me."}, {"owner": {"reputation": 47, "user_id": 9937276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5a5b40fbba344bf7f44af8f370c2da?s=128&d=identicon&r=PG&f=1", "display_name": "Sexy mf", "link": "https://stackoverflow.com/users/9937276/sexy-mf"}, "edited": false, "score": 0, "creation_date": 1528920014, "post_id": 50842694, "comment_id": 88694146, "body": "I watch some videos of a professor of computer science, unfortunately he teaches in C++ so he uses the delete function and as I try to learn C i translate the delete function to free function, but someone told me that if you use free function it erases the information inside but does not delete the variable."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9937276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5a5b40fbba344bf7f44af8f370c2da?s=128&d=identicon&r=PG&f=1", "display_name": "Sexy mf", "link": "https://stackoverflow.com/users/9937276/sexy-mf"}, "edited": false, "score": 0, "creation_date": 1528985882, "post_id": 50848328, "comment_id": 88721916, "body": "Thank you Andres, the       head = delete_num(wanted, head); solved it but I still do not get why, I just added &quot;head = &quot;  I stiil have a problem with the reverse function..."}], "tags": [], "owner": {"reputation": 76, "user_id": 9902937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57720c03c45cd1358c1c225ffa9493a?s=128&d=identicon&r=PG", "display_name": "Andres di Giovanni", "link": "https://stackoverflow.com/users/9902937/andres-di-giovanni"}, "is_accepted": true, "score": 0, "last_activity_date": 1528939027, "creation_date": 1528939027, "answer_id": 50848328, "question_id": 50842694, "link": "https://stackoverflow.com/questions/50842694/delete-first-element-in-a-linked-sorted-list/50848328#50848328", "title": "Delete first element in a linked sorted list", "body": "<p>As a rule of thumb with recursive functions that manage data structures. Operations on the structure should return the structure.</p>\n\n<p>By definition, a linked list is either:</p>\n\n<ul>\n<li>An empty list.</li>\n<li>A node with a value, and a linked list as its tail.</li>\n</ul>\n\n<p>A linked list has a recursive nature. You need to be very careful, recursive functions are very complex, despite the short amount of code.</p>\n\n<p>In your main function you have a head pointer. It's not safe to assume that the head will remain the same. In fact, your problem comes when you remove the first element (head).</p>\n\n<p>Your delete should be something like this:</p>\n\n<pre><code>struct Node * delete_num(int wanted, struct Node * head){\n    if( head == NULL)\n        return NULL;    //Reached the end of the line, nothing to do.\n\n    if( head-&gt;data != wanted )\n        head-&gt;next = delete_num(wanted, head-&gt;next);    //Haven't reached it yet, but \n                                                        //the element must be down \n                                                        //the line, I want to update\n                                                        //my next in case it's the \n                                                        //next node.\n\n    if(head-&gt;data == wanted){\n         struct Node * aux = head;\n         head = head-&gt;next;\n         free(aux);\n    }\n\n    return head;\n}\n</code></pre>\n\n<p>This is assuming you only want to remove one element and your list doesn't admit repeated values.</p>\n\n<p>Your call to this function from main should be:</p>\n\n<pre><code>head = delete_num(wanted, head);\n</code></pre>\n\n<p>Andres</p>\n"}], "owner": {"reputation": 47, "user_id": 9937276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5a5b40fbba344bf7f44af8f370c2da?s=128&d=identicon&r=PG&f=1", "display_name": "Sexy mf", "link": "https://stackoverflow.com/users/9937276/sexy-mf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 50848328, "answer_count": 1, "score": 0, "last_activity_date": 1555751618, "creation_date": 1528909533, "last_edit_date": 1555751618, "question_id": 50842694, "link": "https://stackoverflow.com/questions/50842694/delete-first-element-in-a-linked-sorted-list", "title": "Delete first element in a linked sorted list", "body": "<p>I'm new here and this is actually my first question.</p>\n\n<p>I wrote this code and I can't delete the first element of the list, somehow I can delete other elements.\nI have also a problem with the function reverse_list and I believe it is because I did not pass the argument as a reference.</p>\n\n<p>Can I use the &amp; in the argument in C programming?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Node {\n    int data;\n    struct Node * next;\n};\n\n\nstruct Node * build_sorted_list () {\n    struct Node * head = NULL, * temp, * rear, * front;\n    int num;\n    printf (\"please enter a number:\");\n    scanf (\"%d\", &amp;num);\n    while (num != 0) {\n        temp = (struct Node *) malloc (sizeof (struct Node));\n        if (temp == NULL) {\n            printf (\"god damn\");\n            break;\n        }\n        temp -&gt; data = num;\n        if (head == NULL) {\n            temp -&gt; next = NULL;\n            head = temp;\n        }\n        else if (num &lt;= head -&gt; data) {\n            temp -&gt; next = head;\n            head = temp;\n        }\n        else {\n            rear = head;\n            front = rear -&gt; next;\n            while (front != NULL &amp;&amp; front -&gt; data &lt;= num) {\n                rear = front;\n                front = front -&gt; next;\n            }\n            temp -&gt; next = front;\n            rear -&gt; next = temp;\n        }\n        printf (\"enter number please:\\n\");\n        scanf (\"%d\", &amp;num);\n    }\n    return head;\n}\n\n\nstruct Node * reverse_list (struct Node * head) {\n    struct Node * rear, * mid, * front;\n    if (head != NULL || head -&gt; next == NULL) {\n        return head;\n    }\n    rear = head;\n    mid = rear -&gt;next;\n    front = mid -&gt; next;\n    while (front != NULL) {\n        mid -&gt; next = rear;\n        rear = mid;\n        mid = front;\n        front = front -&gt;next;\n    }\n    mid -&gt; next = rear;\n    head -&gt; next = NULL;\n    head = mid;\n    return head;\n}\n\n\nstruct Node * delete_num (int wanted, struct Node * head) {\n    struct Node * rear, * front;\n    if (head == NULL) {\n        return head;\n    }\n    if (head -&gt; data == wanted) {\n        struct Node * temp = head;\n        head = head -&gt; next;\n        temp = NULL;\n        return head;\n    }\n    rear = head;\n    front = head -&gt; next;\n    while (front != NULL) {\n        if (front -&gt; data == wanted) {\n            break;\n        }\n        rear = front;\n        front = front -&gt; next;\n    }\n    if (front != NULL) {\n        rear -&gt; next = front -&gt; next;\n    }\n    free (front);\n    return head;\n}\n\n\nint main() {\n    struct Node * head;\n    int wanted;\n    head = build_sorted_list(); /* Please pretend this function exists */\n    reverse_list (head);\n\n    printf (\"please enter a number to delete:\");\n    scanf (\"%d\", &amp;wanted);\n    delete_num (wanted, head);\n\n    free_list (head);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "algorithm", "performance", "parallel-processing"], "comments": [{"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "edited": false, "score": 1, "creation_date": 1528907787, "post_id": 50841944, "comment_id": 88687935, "body": "What you call repeats are repetitions for statistics or actually different set of parameters?"}, {"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "edited": false, "score": 0, "creation_date": 1528908008, "post_id": 50841944, "comment_id": 88688050, "body": "Of course the trivial parallelization is to do Option 1 or Option 1 with the two for loops inverted that for me looks more natural :P. Nevertheless, that trivial parallelization is basically the same as taking out the loop from your C code and launch the executable from a script as many times as cores you have. And the advantage in this case is that is way more flexible and you can also put it trivially in a cluster."}, {"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "edited": false, "score": 0, "creation_date": 1528908265, "post_id": 50841944, "comment_id": 88688178, "body": "But of course there are specifics of your problem. If one computation time of the different algorithms differ, you won&#39;t want to put each algorithm in a thread, because one thread will be done faster and you will be wasting computation power/time. So, option 2 wouldn&#39;t be a good idea if that&#39;s the case. And option 1 sounds better. As for option 3: well, here you will probably need to work much much more about it, first estimating whether you would get any advantage compared with option 1."}, {"owner": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "reply_to_user": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "edited": false, "score": 0, "creation_date": 1528910005, "post_id": 50841944, "comment_id": 88689100, "body": "@myradio the repeats begin with a different random seed but always the same paramaters"}], "answers": [{"comments": [{"owner": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "edited": false, "score": 0, "creation_date": 1528910328, "post_id": 50842549, "comment_id": 88689291, "body": "How would I run the same script multiple times using a shell script?"}, {"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "reply_to_user": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "edited": false, "score": 1, "creation_date": 1528911577, "post_id": 50842549, "comment_id": 88689926, "body": "If you have your algorithms in C then you would run the executable binary from a shell script. You can run <code>.&#47;binary.exe &amp;</code> in a for loop in a script and it won&#39;t wait to it to finish (due to the <code>&amp;</code>).  It does not need to be a binary executable (I said that because you used the c tag) you can do the same replacing ./binary.exe with any executable (and that includes matlab since that seems to be your code) in a shell. But I guess this is going a bit outside the scope of the question."}, {"owner": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "edited": false, "score": 0, "creation_date": 1528913696, "post_id": 50842549, "comment_id": 88690956, "body": "so the <code>&amp;</code> tells the script to run it in parallel? will it automatically run on different threads? I am writing in C, the code I provided was just pseudo code."}, {"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "reply_to_user": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "edited": false, "score": 1, "creation_date": 1528915058, "post_id": 50842549, "comment_id": 88691637, "body": "No. The <code>&amp;</code> just let you execute a command in a script and send it to background instead of waiting for it to finish. If you put <code>.&#47;binary.exe</code> in a loop in a script, each iteration of the script will wait for the program to finish, while putting the <code>&amp;</code> allows you to run it in the background letting the script to go to the next iteration. And yes, if you run the same (single core) executable several times the OS will attempt to distribute it in the different cores. You can test that by launching your executable several times and monitor the system which in unix you would do with <code>top</code>."}, {"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "reply_to_user": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "edited": false, "score": 1, "creation_date": 1528991542, "post_id": 50842549, "comment_id": 88725459, "body": "You can ask a new question about parallelizing code using a script. Also, feel free to accept the answer if you think it answers to your question ^^"}], "tags": [], "owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "is_accepted": true, "score": 1, "last_activity_date": 1528909023, "creation_date": 1528909023, "answer_id": 50842549, "question_id": 50841944, "link": "https://stackoverflow.com/questions/50841944/how-to-make-best-use-of-multithreading-with-monte-carlo-simulations/50842549#50842549", "title": "How to make best use of multithreading with monte carlo simulations?", "body": "<p>It depends in how long would it take to each repetition and each algorithm to be executed. Assuming that each repetition takes the same as the others (for each particular algorithm), most likely the best for these kind of cases is to trivially split the outer for in different threads (switching the two for loops to have repetitions that take the same time).</p>\n\n<p>Running each algorithm in a different thread instead would have no advantage, since the algorithms are not going to take exactly the same time and you will end up wasting computational power.</p>\n\n<p>Option 3 sounds very unlikely for a case like this. Besides the fact that you will have to think and make a significantly more complex program, I doubt you can gain something from paralellizing the different parts of the algorithm and I think is more likely that the code will be slower due to the different threads having to wait each other.</p>\n\n<p>As a side note, as I said in the comments, for this very simple cases of parallelization I would recommend you to consider splitting the runs outside the C code but in a shell script. Each job you launch will be run in a different core and you will gain a lot of flexibility. You will also be able to run in in a cluster with almost no changes if any.</p>\n"}], "owner": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 1, "accepted_answer_id": 50842549, "answer_count": 1, "score": 1, "last_activity_date": 1528909023, "creation_date": 1528906769, "question_id": 50841944, "link": "https://stackoverflow.com/questions/50841944/how-to-make-best-use-of-multithreading-with-monte-carlo-simulations", "title": "How to make best use of multithreading with monte carlo simulations?", "body": "<p>I am writing a code to benchmark simulation algorithms using the basics of Monte carlo simulations - so I am generating a random system (just an integer) and running the simulation algorithms on the randomly generated system. I need to do this many many times and although the algorithms are relatively conceptually simple they take a few seconds to run because they contain many loops.</p>\n\n<pre><code>for i=1:number of algorithms\n    for i=1:number of repeats\n        if algo = 1\n            //run the first algorithm [for loops]\n        if algo = 2\n            //run the second algorithm [while]\n        if algo = 3\n            //run the third algorithm [while]\n</code></pre>\n\n<p>where each algorithm works differently. The first algorithm can be further broken down into for loops where it is run many times and the highest score is selected so I imagine even the algorithm could be multithreaded. The other two would be much more complex to make multithreaded.</p>\n\n<p>My question is how to split the program into different threads. There appears to be many different ways I could approach this and I am very new to multithreading so I have no idea what would be best.</p>\n\n<p><strong>Option 1</strong>: Split the threads immediately and run different algorithms on each thread.</p>\n\n<p><strong>Option 2</strong>: Split the threads with the second for loop, so the number of repeats are split up over the different threads. </p>\n\n<p><strong>Option 3</strong>: Try to break down the algorithm steps into smaller chunks which can be parallelized</p>\n"}, {"tags": ["c", "printf", "restrict"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3956566"}, "edited": false, "score": 0, "creation_date": 1528967772, "post_id": 50841881, "comment_id": 88710400, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/173127/discussion-on-question-by-ajay-brahmakshatriya-why-is-the-format-in-printf-marke\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528910880, "post_id": 50842539, "comment_id": 88689586, "body": "When I was reading before posting the question, I was convinced that <code>restrict</code> matters only if there is write, but <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.3.1p8\" rel=\"nofollow noreferrer\">this</a> example confused me. It clearly only says accesses won&#39;t clash. Doesn&#39;t say anything about writes."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528911112, "post_id": 50842539, "comment_id": 88689699, "body": "@AjayBrahmakshatriya Maybe the wording is a bit sloppy? The pointers in the example have to point to different things because one of them is written to."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528911283, "post_id": 50842539, "comment_id": 88689777, "body": "Yes, the wording wasn&#39;t exactly clear to me. I agree that if none of the two is written, it shouldn&#39;t matter. My concern was if the standard says they should not alias for reads too, can the compiler make some aliasing assumptions based on that."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528914440, "post_id": 50842539, "comment_id": 88691345, "body": "@HolyBlackCat so my final take from this is that the two pointers are allowed to alias if there is not modification on the object. If that is correct, I am satisfactorily understand why <code>printf</code> has <code>restrict</code>, for optimizations ofcourse. My original confusion stemmed from my (wrong) assumption that they are not allowed to alias even if both just read. Only if this could be backed by some statement from the standard. But I will take the word of cpp reference to be true for now. Thanks1"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1528914478, "post_id": 50842539, "comment_id": 88691358, "body": "@HolyBlackCat I think it&#39;s a bit better now. As I understand it the reason for <code>restrict</code> is to say: &quot;The pointer used for receiving the result of a <code>%..n</code> specifier is not allowed to be the same as the pointer to the format string&quot;. Kind of make sense. I&#39;ll remove DV and clean up comments. Thanks."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528914645, "post_id": 50842539, "comment_id": 88691437, "body": "@4386427 I had tried to make clear in the question itself that I understand the how restrict helps in the <code>%..n</code> case. I just wanted to know if it disallows using <code>printf(format, format)</code>. Perhaps I should have made it more clear in the question."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528915124, "post_id": 50842539, "comment_id": 88691674, "body": "@AjayBrahmakshatriya I think your question was very interesting. And I did understand that you wasn&#39;t asking about the meaning of <code>restrict</code>. Now that I understand the answer from HolyBlackCat, my guess is that use of <code>restrict</code> on the format string allows an implementation of <code>printf</code> to update the pointer used for <code>%hhn</code> at any time, i.e. as each char is printed. Without <code>restrict</code> that wouldn&#39;t be allowed."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528915414, "post_id": 50842539, "comment_id": 88691817, "body": "@4386427 yes, without <code>restrict</code>, it would have to make a copy first. That I kind of knew while writing the question itself. My confusion was because I thought it also applies when both pointers are only going to read. You cleared that they are allowed to alias. I think the main problem was that the wordings in the standard weren&#39;t clear enough for me."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 8, "last_activity_date": 1528914079, "last_edit_date": 1592644375, "creation_date": 1528908978, "answer_id": 50842539, "question_id": 50841881, "link": "https://stackoverflow.com/questions/50841881/why-is-the-format-in-printf-marked-as-restrict/50842539#50842539", "title": "Why is the format in printf marked as restrict?", "body": "<blockquote>\n<h3><a href=\"http://en.cppreference.com/w/c/language/restrict\" rel=\"noreferrer\">cppreference</a></h3>\n<p>During each execution of a block in which a restricted pointer <code>P</code> is declared (typically each execution of a function body in which <code>P</code> is a function parameter), <strong>if some object that is accessible through <code>P</code></strong> (directly or indirectly) <strong>is modified, by any means</strong>, <strong>then all accesses to that object</strong> (both reads and writes) <strong>in that block must occur through <code>P</code></strong> (directly or indirectly), otherwise the behavior is undefined.</p>\n</blockquote>\n<p><sup>(emphasis mine)</sup></p>\n<p>It means that:</p>\n<pre><code>char format[] = &quot;%s&quot;;\nprintf(format, format);\n</code></pre>\n<p>Is well-defined because <code>printf</code> won't attempt to modify <code>format</code>.</p>\n<p>The only thing that <code>restrict</code> makes undefined is 'writing to the format string using <code>%\u2026n</code> while <code>printf</code> is running' (e.g. <code>char f[] = &quot;%hhn&quot;; printf(f, (signed char *)f);</code>).</p>\n<blockquote>\n<p>Why was the <code>restrict</code> keyword added to the format argument of <code>printf</code>?</p>\n</blockquote>\n<p><code>restrict</code> is essentially a hint the compiler might use to optimize your code better.</p>\n<p>Since <code>restrict</code> may or may not make code run faster, but it can never make it slower (assuming the compiler is sane), it should be used <em>always</em>, unless:</p>\n<ul>\n<li>Using it would cause UB</li>\n<li>It makes no significant performance improvement in this specific case</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528918113, "post_id": 50844805, "comment_id": 88693139, "body": "Also, I am clear about how it protects the function from modifying the format as a side effect. I also mentioned that in the question. My question was does the non aliasing constraint also apply if the pointers are only going to read? And if yes, does it make the example I have mentioned in the question invalid?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1528918169, "post_id": 50844805, "comment_id": 88693168, "body": "Oh, <code>stdout</code> here is the <code>FILE*</code> object. Got it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528918490, "post_id": 50844805, "comment_id": 88693341, "body": "With <code>char format[] = &quot;%s&quot;; printf(format, format);</code>  is not a problem."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528918565, "post_id": 50844805, "comment_id": 88693377, "body": "@AjayBrahmakshatriya My answer focuses on answering the title question &quot;Why is the format in printf marked as restrict?&quot;"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528918634, "post_id": 50844805, "comment_id": 88693419, "body": "Yes, I understand <code>restrict</code> better now and why it is important for <code>printf</code>. Thanks!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528918791, "post_id": 50844805, "comment_id": 88693514, "body": "@AjayBrahmakshatriya FWIW, <code>restrict</code> is not an easy keyword to digest.  Someday I hope for a post on<code>foo(char *p1, char *p2, char * restrict r1, char * restrict r2);</code> and sort that mess out."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1528918884, "post_id": 50844805, "comment_id": 88693561, "body": "yes, that example with 2 restrict and 2 non restrict should clear all the cases. If you do indeed write a post, please link it here in the comments (and/or post)."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1528918515, "last_edit_date": 1528918515, "creation_date": 1528917832, "answer_id": 50844805, "question_id": 50841881, "link": "https://stackoverflow.com/questions/50841881/why-is-the-format-in-printf-marked-as-restrict/50844805#50844805", "title": "Why is the format in printf marked as restrict?", "body": "<blockquote>\n  <p>Why is the format in printf marked as restrict?</p>\n</blockquote>\n\n<pre><code>int printf(const char * restrict format, ...);\n</code></pre>\n\n<p>The <code>restrict</code> in <code>some_type * restrict format</code> is a \"contract\" between the calling code and the function <code>printf()</code>.  It allows the <code>printf()</code> to assume the only possible changes to the data pointed to by <code>format</code> occur to what the function does directly and not a side effect of other pointers.</p>\n\n<p>This allows <code>printf()</code> to consist of code that does not concern itself with a changing format string by such side effects.</p>\n\n<p>Since <code>format</code> points to <code>const</code> data, <code>printf()</code> is not also allowed to change the data.  Yet this is ancillary to the <code>restrict</code> feature.</p>\n\n<hr>\n\n<p>Consider pathological code below.  It violates the contract as <code>printf()</code> may certainly alter the state of <code>*stdout</code>, which in turn can alter <code>.ubuf</code>.</p>\n\n<pre><code>strcpy(stdout-&gt;ubuf, \"%s\");\nprintf(stdout-&gt;ubuf, \"Hello World!\\n\");\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/50842539/2410359\">@HolyBlackCat</a> has a good <code>\"%n\"</code> example.</p>\n\n<p>Key: <code>restrict</code> requires the calling code to not pass as <code>format</code>, any pointer to a string that may change due to <code>printf()</code> operation.</p>\n"}], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1676, "favorite_count": 1, "accepted_answer_id": 50842539, "answer_count": 2, "score": 8, "last_activity_date": 1528918515, "creation_date": 1528906526, "question_id": 50841881, "link": "https://stackoverflow.com/questions/50841881/why-is-the-format-in-printf-marked-as-restrict", "title": "Why is the format in printf marked as restrict?", "body": "<p>I just happened to look at the prototype of the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.3\" rel=\"noreferrer\"><code>printf</code></a> (and other <code>fprintf</code> class of functions) - </p>\n\n<pre><code>int printf(const char * restrict format, ...);\n</code></pre>\n\n<p>The keyword <code>restrict</code> if I understand correctly disallows access to the same object through two pointers if one of them is marked <code>restrict</code>.</p>\n\n<p>An example that cites the same from the C standard is <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.3.1p8\" rel=\"noreferrer\">here</a>.</p>\n\n<p>One benefit of marking the format as <code>restrict</code> I think is saving the function from the chance that the format string might get modified during the execution (say because of the <code>%n</code> format specifier). </p>\n\n<p>But does this impose a bigger constraint? Does this make the following function call invalid?</p>\n\n<pre><code>char format[] = \"%s\";\nprintf(format, format);\n</code></pre>\n\n<p>Because there is clearly an aliasing here. Why was the <code>restrict</code> keyword added to the <code>format</code> argument of <code>printf</code>?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1528906426, "post_id": 50841792, "comment_id": 88687227, "body": "<code>y</code> is uninitialized.  Undefined behavior."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1528907121, "post_id": 50841792, "comment_id": 88687620, "body": "Noting else used the stack between calling <code>foo1</code> and calling <code>foo2</code>. It&#39;s just an accident."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1528910719, "post_id": 50841792, "comment_id": 88689490, "body": "Why, oh why, do instructors give &quot;assignments&quot; like this one?  They don&#39;t teach any useful lesson,  They confuse the learners.  They lead to pointless questions (and pointless answers) here on SO.  They lead, in some nonzero percentage of cases, to people writing actual code that (deliberately or accidentally) depends on such quirks and happenstances.  Overall, just a big fat negative, lose-lose experience.  Hey, all you misguided C instructors out there: PLEASE STOP!  [Sorry for this unseemly outburst.  I know it won&#39;t change anything, but I feel a little better now.]"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1528912642, "post_id": 50841792, "comment_id": 88690463, "body": "@SteveSummit for the sake of our sanity, lets assume it is some compiler/assembly language course and the teacher is trying to explain how stack frames work through this example. Or maybe it is a systems security course and the teacher is explaining how left over values on the stack can be used in case for exploiting a format string vulnerability. We can only hope."}, {"owner": {"reputation": 2446, "user_id": 1532454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aNEeA.jpg?s=128&g=1", "display_name": "Jeff Learman", "link": "https://stackoverflow.com/users/1532454/jeff-learman"}, "edited": false, "score": 0, "creation_date": 1528920615, "post_id": 50841792, "comment_id": 88694443, "body": "Welcome to StackOverflow.  In the future, please post text rather than pictures of text."}, {"owner": {"reputation": 33, "user_id": 7179393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DcnaLvlPWpg/AAAAAAAAAAI/AAAAAAAAAFI/RTUPXOd_s4o/photo.jpg?sz=128", "display_name": "Alessandro Lunardi", "link": "https://stackoverflow.com/users/7179393/alessandro-lunardi"}, "edited": false, "score": 0, "creation_date": 1529050061, "post_id": 50841792, "comment_id": 88744525, "body": "Thank you all guys!"}], "answers": [{"comments": [{"owner": {"reputation": 2446, "user_id": 1532454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aNEeA.jpg?s=128&g=1", "display_name": "Jeff Learman", "link": "https://stackoverflow.com/users/1532454/jeff-learman"}, "edited": false, "score": 1, "creation_date": 1528920844, "post_id": 50842305, "comment_id": 88694541, "body": "Right -- this can be useful information when debugging, but one should (almost) never write code that depends on the layout of stack frames.  (The exception is for debugging utilities, like those that dump the stack frame on error.)"}], "tags": [], "owner": {"reputation": 966, "user_id": 1386127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/01cef9fb064e908463d83e6cb1f08cf8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumen", "link": "https://stackoverflow.com/users/1386127/soumen"}, "is_accepted": true, "score": 2, "last_activity_date": 1528908076, "creation_date": 1528908076, "answer_id": 50842305, "question_id": 50841792, "link": "https://stackoverflow.com/questions/50841792/exercise-using-pointers-in-c-give-ambiguous-output/50842305#50842305", "title": "Exercise using pointers in C give ambiguous output", "body": "<pre><code>stack after call                     stack after call \nto foo1()                            to foo2()\n+----------------+                   +----------------+    |\n| stack frame of |                   | stack frame of |    |\n| main()         |                   | main()         |    v\n++++++++++++++++++ &lt;-- same addr --&gt; ++++++++++++++++++   stack\n| stack frame of |                   | stack frame of |   growth\n| foo1()         |                   | foo2()         |\n+----------------+                   +----------------+\n</code></pre>\n\n<p>Now the address of x in stack frame of foo1() is same as address of y in stack frame of foo2().</p>\n\n<p>This is because both functions have same number and type of arguments and local variables (which are pushed onto stack). In call of foo1() the value in address of x (0x7fff63387a84 in your case) is set to 7. This value persists as there is no other function call between foo1() and foo2().</p>\n\n<p><strong>NOTE</strong> This answer is only for your understanding. You should not rely on the value of y as it is uninitialized (as pointed out in the previous comments). This is mere an accidental phenomena. I suggest you to go through how stack frames are formed.</p>\n"}], "owner": {"reputation": 33, "user_id": 7179393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DcnaLvlPWpg/AAAAAAAAAAI/AAAAAAAAAFI/RTUPXOd_s4o/photo.jpg?sz=128", "display_name": "Alessandro Lunardi", "link": "https://stackoverflow.com/users/7179393/alessandro-lunardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 50842305, "answer_count": 1, "score": -2, "last_activity_date": 1528943205, "creation_date": 1528906230, "last_edit_date": 1528943205, "question_id": 50841792, "link": "https://stackoverflow.com/questions/50841792/exercise-using-pointers-in-c-give-ambiguous-output", "title": "Exercise using pointers in C give ambiguous output", "body": "<p>This is the code of my teacher:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid foo1(int xval){\n    int x;\n    x = xval;\n    printf(\"Address of x: %p\\nValue of x: %d\\n\", &amp;x, x);\n}\nvoid foo2(int dummy){\n    int y;\n    printf(\"Address of y: %p\\nValue of y: %d\\n\", &amp;y, y);\n}\nint main(void){\n    foo1(7);\n    foo2(11);\n    return 0;\n}\n</code></pre>\n\n<p>And this is the output generated:</p>\n\n<p><img src=\"https://i.stack.imgur.com/7zyk4.png\" alt=\"screenshot of the output of the execution\"></p>\n\n<p>Anyone can explain me why?</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528905374, "post_id": 50841447, "comment_id": 88686591, "body": "You have seen the code. We haven&#39;t. What kind of help or answer do you expect?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1528905385, "post_id": 50841447, "comment_id": 88686596, "body": "<i>&quot;I&#39;ve seen the code to it&quot;</i> - then you&#39;re one up on us, because we haven&#39;t. We don&#39;t know how it works or what it does, so telling you how to test it would be folly. My pitiful slab of foggy glass excuse for a crystal ball says it does <i>something</i> for each sub-string in the string pointed to by <code>s</code>, in descending length as it moves up the sequence one char at a time. If <a href=\"https://github.com/illiatdesdindes/libft/blob/master/ft_striter.c\" rel=\"nofollow noreferrer\">this is your function</a>, that&#39;s <i>exactly</i> what it does."}, {"owner": {"reputation": 9, "user_id": 9310363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa0e7c3bba61dcea803b8046d599e95?s=128&d=identicon&r=PG&f=1", "display_name": "This is Glory", "link": "https://stackoverflow.com/users/9310363/this-is-glory"}, "edited": false, "score": 0, "creation_date": 1528972194, "post_id": 50841447, "comment_id": 88713261, "body": "Hello, thanks for your reply. I&#39;d like to apologise for not writing the function out - we are recoding the C library and these are part of the extra functions. We had to use the explanation I gave on what it does in order to code it, from this I made the assumption that you would understand what it does. Still getting used to this platform, I&#39;ll be better with my approach to asking next time - still have a lot of questions to clear."}], "answers": [{"tags": [], "owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1528905747, "creation_date": 1528905747, "answer_id": 50841638, "question_id": 50841447, "link": "https://stackoverflow.com/questions/50841447/function-which-applies-a-function-passed-as-second-parameter-to-each-index-of-ar/50841638#50841638", "title": "Function which applies a function passed as second parameter to each index of array pointed to by pointer s", "body": "<p>considering you have a <em>null-terminated</em> <code>char*</code></p>\n\n<pre><code>void ft_striter(char* str, void(*func)(char*)) {\n    while (*str)\n        func(str++);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": false, "score": 1, "last_activity_date": 1528906216, "last_edit_date": 1528906216, "creation_date": 1528905886, "answer_id": 50841683, "question_id": 50841447, "link": "https://stackoverflow.com/questions/50841447/function-which-applies-a-function-passed-as-second-parameter-to-each-index-of-ar/50841683#50841683", "title": "Function which applies a function passed as second parameter to each index of array pointed to by pointer s", "body": "<p>There is still something unclear in your question but I took the text literally:</p>\n\n<p><code>ft_striter()</code> iterates through string <code>s</code>. OP didn't define a termination condition. Hence, I used the usual &ndash; 0 terminator.</p>\n\n<p><code>do_something()</code> is another function to demonstrate how <code>f</code> is called. It is important that <code>do_something()</code> matches the signature required for parameter <code>f</code> in <code>ft_striter()</code>. Otherwise, in best case the compiler complains, in worst case &ndash; undefined behavior.</p>\n\n<p>Sample code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid ft_striter(char *s, void (*f)(char*))\n{\n  for (; *s; ++s) f(s);\n}\n\nvoid do_something(char *s)\n{\n  printf(\"s: '%s'\\n\", s);\n}\n\nint main()\n{\n  char test[] = \"Hello World.\";\n  ft_striter(test, &amp;do_something);\n  /* done */\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>s: 'Hello World.'\ns: 'ello World.'\ns: 'llo World.'\ns: 'lo World.'\ns: 'o World.'\ns: ' World.'\ns: 'World.'\ns: 'orld.'\ns: 'rld.'\ns: 'ld.'\ns: 'd.'\ns: '.'\n</code></pre>\n\n<p><kbd><a href=\"https://wandbox.org/permlink/DorodTJgzvnXLGW8\" rel=\"nofollow noreferrer\"><strong>Live Demo on wandbox</strong></a></kbd></p>\n"}], "owner": {"reputation": 9, "user_id": 9310363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa0e7c3bba61dcea803b8046d599e95?s=128&d=identicon&r=PG&f=1", "display_name": "This is Glory", "link": "https://stackoverflow.com/users/9310363/this-is-glory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "closed_date": 1531233833, "answer_count": 2, "score": -1, "last_activity_date": 1528972264, "creation_date": 1528905156, "last_edit_date": 1528972264, "question_id": 50841447, "link": "https://stackoverflow.com/questions/50841447/function-which-applies-a-function-passed-as-second-parameter-to-each-index-of-ar", "closed_reason": "Not suitable for this site", "title": "Function which applies a function passed as second parameter to each index of array pointed to by pointer s", "body": "<p><a href=\"https://i.stack.imgur.com/Z627q.png\" rel=\"nofollow noreferrer\">enter image description here</a>I have the following function: </p>\n\n<pre><code>void ft_striter(char *s, void (*f)(char *));\n</code></pre>\n\n<p>This function is meant to apply the function <code>f</code> to each index of the array pointed to by <code>s</code>.</p>\n\n<p>I've seen the code to it but my problem is that I do not understand the function itself and how I would write a test for it. I would like to be able to understand it clearly and apply it. Can someone kindly break it down for me?</p>\n\n<p>Please see the link to the function in question:</p>\n"}, {"tags": ["c++", "c", "visual-studio", "dll"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1528905564, "post_id": 50841206, "comment_id": 88686685, "body": "A DLL produced in Debug mode contains symbolic information.  A DLL produced in Release mode has reduced symbol information.  A release mode DLL may be optimized.  Reminder:  C++ may <i>mangle</i> names."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1528916600, "post_id": 50841206, "comment_id": 88692378, "body": "What you see from dumpbin.exe is affected by whether or not it can find the .pdb file for the dll.  In particular the &quot;=foo&quot; part comes from the .pdb file.  Delete the .pdb file to feel better.  I&#39;d guess you next need to look why dumpbin.exe is so confused.  My crystal ball says it has something to do with the /debug:fastlink linker option."}], "answers": [{"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 3, "last_activity_date": 1528906455, "creation_date": 1528906455, "answer_id": 50841851, "question_id": 50841206, "link": "https://stackoverflow.com/questions/50841206/difference-between-debug-and-release-when-exporting-c-functions-from-dll-as-c/50841851#50841851", "title": "Difference between Debug and Release when exporting C++ functions from DLL as C", "body": "<p>What you're seeing is the result of COMDAT folding (merging of identical function definitions).</p>\n\n<p>COMDAT folding is activated by default in Release mode (<code>/OPT:ICF</code>). To disable you can use <code>/OPT:NOICF</code>.</p>\n\n<p>But why would you want to do that? It's not like it breaks your Release DLL or anything.</p>\n\n<p>When you see <code>testFunction1 = testFunction1</code> the first part is the actual export name and the second part is the corresponding debug symbol.</p>\n\n<p>If you link without debug symbols, you'll see just <code>testFunction1</code>, without the <code>=</code> part. </p>\n"}], "owner": {"reputation": 189, "user_id": 6828175, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6e9d001d0030aca9d02a98b0f6456de8?s=128&d=identicon&r=PG&f=1", "display_name": "hal9000", "link": "https://stackoverflow.com/users/6828175/hal9000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 1, "accepted_answer_id": 50841851, "answer_count": 1, "score": 1, "last_activity_date": 1528906455, "creation_date": 1528904341, "question_id": 50841206, "link": "https://stackoverflow.com/questions/50841206/difference-between-debug-and-release-when-exporting-c-functions-from-dll-as-c", "title": "Difference between Debug and Release when exporting C++ functions from DLL as C", "body": "<p>I am building a DLL, which exports its functions as \"C\".</p>\n\n<p>I am testing using a dummy function:</p>\n\n<p>In my .cpp file </p>\n\n<pre><code>_MACRO(int) testFunction1()\n{\n    return 1;\n}\n</code></pre>\n\n<p>In my header file</p>\n\n<pre><code>_MACRO(int) testFunction1();\n</code></pre>\n\n<p>This macro is defined as </p>\n\n<pre><code>#  define  _MACRO(ret)  extern __declspec (dllimport) ret __stdcall\n#  define  _MACRO(ret)  __declspec (dllexport) ret __stdcall\n</code></pre>\n\n<p>Since I want these functions to be exported as C, i do </p>\n\n<pre><code> \\Debug&gt;dumpbin /exports demo.dll\n</code></pre>\n\n<p>This correctly gives me an output of </p>\n\n<pre><code> ordinal hint RVA      name\n\n      1    0 000026C0 testFunction1 = testFunction1\n</code></pre>\n\n<p>But when I do the same for Release</p>\n\n<pre><code>\\Release&gt;dumpbin /exports demo.dll\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>  1    0 00001080 testFunction1 = _get_startup_argv_mode\n</code></pre>\n\n<p>How can I make it print out the function name for release configuration? Any changes in release settings?</p>\n"}, {"tags": ["c", "multithreading", "random", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1528904665, "post_id": 50841077, "comment_id": 88686177, "body": "The &quot;user&quot; times need to be divided by the number of cores, and the &quot;sys&quot; times need to be subtracted from the &quot;real&quot; times to see what&#39;s actually happening."}], "answers": [{"tags": [], "owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "is_accepted": true, "score": 2, "last_activity_date": 1528904666, "creation_date": 1528904666, "answer_id": 50841295, "question_id": 50841077, "link": "https://stackoverflow.com/questions/50841077/why-is-there-no-speed-up-when-using-openmp-to-generate-random-numbers/50841295#50841295", "title": "Why is there no speed up when using OpenMP to generate random numbers?", "body": "<p>Note that the <code>time</code> command <a href=\"https://unix.stackexchange.com/questions/40694/why-real-time-can-be-lower-than-user-time\">adds up the time spent on all cores</a> when it prints the <code>user</code> and <code>sys</code> values. Observe that your wall time (<code>real</code>) is nearly constant.</p>\n\n<p>Also, your benchmark is too small. There is a significant cost of creating and managing threads. This overhead may be overshadowing the actual execution time of the random number generation. A million values isn't that many. In other words, the time taken to actually compute the random numbers is so small that it's lost in the noise and dwarfed by the setup/teardown costs. If you generate a whole lot more, you may start to see the advantage due to parallelism.</p>\n"}], "owner": {"reputation": 970, "user_id": 1179272, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/55d8aa49a1a1efe643b321fb4b3cb862?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/1179272/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 50841295, "answer_count": 1, "score": 0, "last_activity_date": 1528904666, "creation_date": 1528903925, "question_id": 50841077, "link": "https://stackoverflow.com/questions/50841077/why-is-there-no-speed-up-when-using-openmp-to-generate-random-numbers", "title": "Why is there no speed up when using OpenMP to generate random numbers?", "body": "<p>I am looking to run a type of monte carlo simulations which require the generation of random numbers, and a set of instructions based on those random numbers.</p>\n\n<p>I wish to make use of parallel processing but when testing my code (written in C) there seems to be an inverse speed up with more cores! I'm not sure what I could be doing wrong. I then copied the code form <a href=\"https://stackoverflow.com/questions/4287531/how-to-generate-random-numbers-in-parallel\">another answer</a> and still get this effect.</p>\n\n<p>The code slightly modified form the answer is</p>\n\n<pre><code>#define NRANDS 1000000\nint main() {\n\n    int a[NRANDS];\n\n    #pragma omp parallel default(none) shared(a)\n    {\n        int i;\n        unsigned int myseed = omp_get_thread_num();\n        #pragma omp for\n        for(i=0; i&lt;NRANDS; i++)\n                a[i] = rand_r(&amp;myseed);\n    }\n    double sum = 0.;\n    for (long int i=0; i&lt;NRANDS; i++) {\n        sum += a[i];\n    }\n    printf(\"sum = %lf\\n\", sum);\n\n    return 0;\n}\n</code></pre>\n\n<p>where I have just then run the <code>time</code> command in terminal in order to time how long it takes to run. I varied the number of threads allowed using <code>export OMP_NUM_THREADS=2</code>. The output of my terminal is:</p>\n\n<pre><code>Thread total: 1\nsum = 1074808568711883.000000\nreal    0m0,041s\nuser    0m0,036s\nsys 0m0,004s\n\nThread total: 2\nsum = 1074093295878604.000000\nreal    0m0,037s\nuser    0m0,058s\nsys 0m0,008s\n\nThread total: 3\nsum = 1073700114076905.000000\nreal    0m0,032s\nuser    0m0,061s\nsys 0m0,010s\n\nThread total: 4\nsum = 1073422298606608.000000\n\nreal    0m0,035s\nuser    0m0,074s\nsys 0m0,024s\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528904145, "post_id": 50841015, "comment_id": 88685878, "body": "<b>WARNING</b>: Using <a href=\"https://channel9.msdn.com/Events/GoingNative/2013/rand-Considered-Harmful\" rel=\"nofollow noreferrer\"><code>rand()</code> is considered harmful</a> and you\u2019re strongly encouraged to use an appropriate <a href=\"http://en.cppreference.com/w/cpp/numeric/random\" rel=\"nofollow noreferrer\">random number generator facility in the Standard Library</a> that produces actually random values. Your use of <code>time(NULL)</code> as a random number seed means that this will produce identical results if run in the same second, and on many platforms <code>rand()</code> is <a href=\"http://dilbert.com/strip/2001-10-25\" rel=\"nofollow noreferrer\"><i>barely</i> random at all</a>."}, {"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 5, "creation_date": 1528904238, "post_id": 50841015, "comment_id": 88685939, "body": "You&#39;re getting the same number because you print the iterator and not the value referenced by it. That being said, since your code is C++, it would be best to use actual C++ idioms, e.g. stdout instead of printf and <a href=\"http://en.cppreference.com/w/cpp/numeric/random\" rel=\"nofollow noreferrer\">random</a> instead of C&#39;s <code>rand()</code>. As to the edit: if you want to use \u201cplain C\u201d, I do not see why you use vectors and iterators at all, C doesn&#39;t have them."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1528904269, "post_id": 50841015, "comment_id": 88685958, "body": "&quot;Plain C&quot; because why? You have 99% functional C++ code here."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 0, "creation_date": 1528904363, "post_id": 50841015, "comment_id": 88686014, "body": "If you want plain C, you&#39;ll need to remove all the vectors. Is that what you want?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528904373, "post_id": 50841015, "comment_id": 88686020, "body": "@tadman <i>C++ is a superset of C, it&#39;s true</i> No, that&#39;s not true.  Not at all."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1528904415, "post_id": 50841015, "comment_id": 88686046, "body": "I don&#39;t know how you expect a C solution when this is very much C++ code."}, {"owner": {"reputation": 133, "user_id": 5047865, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh5.googleusercontent.com/-xxOs-5Ldp_4/AAAAAAAAAAI/AAAAAAAAADQ/x5r4SZuesuI/photo.jpg?sz=128", "display_name": "MegaCleptomaniac", "link": "https://stackoverflow.com/users/5047865/megacleptomaniac"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528904747, "post_id": 50841015, "comment_id": 88686223, "body": "@tadman could you please provice me a small example or code snippet how to use one of those random number generators?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528904756, "post_id": 50841015, "comment_id": 88686229, "body": "@tadman <i>I&#39;m not going to get super pedantic here.</i> I&#39;m not sure what you mean by that, but claiming C++ is a superset of C doesn&#39;t require much pedantic precision to sow confusion <a href=\"https://stackoverflow.com/questions/1201593/where-is-c-not-a-subset-of-c\">given the significant differences between the two languages that prevent C++ from being a superset of C.</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1528904871, "post_id": 50841015, "comment_id": 88686297, "body": "@AndrewHenle I&#39;m retracting my comments because apparently you do want to get super pedantic."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1528906902, "post_id": 50841015, "comment_id": 88687487, "body": "I&#39;m voting to close this question as off-topic because this is such a weird question. At present it boils down to &quot;please fix my random number generator, and convert this C++ code to C&quot;. On the latter point it&#39;s too broad."}], "answers": [{"comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 2, "creation_date": 1528904716, "post_id": 50841240, "comment_id": 88686206, "body": "The main problem is there is no <code>std::vector</code> in C."}], "tags": [], "owner": {"reputation": 2364, "user_id": 8349252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/224zf.png?s=128&g=1", "display_name": "Kaldrr", "link": "https://stackoverflow.com/users/8349252/kaldrr"}, "is_accepted": false, "score": 1, "last_activity_date": 1528904467, "creation_date": 1528904467, "answer_id": 50841240, "question_id": 50841015, "link": "https://stackoverflow.com/questions/50841015/random-filled-vector-always-returns-the-same-numbers/50841240#50841240", "title": "Random-filled vector always returns the same numbers", "body": "<p>The main problem in your code is in your last loop</p>\n\n<pre><code>for (std::vector&lt;long&gt;::const_iterator i = entries.begin(); i != entries.end(); ++i) {\n    printf(\"%ld\\n\", i);\n}  \n</code></pre>\n\n<p>You're not printing a value from the vector, but an iterator that's pointing to it</p>\n\n<p>Change the line inside the loop to <code>printf(\"%ld\\n\", *i);</code> to fix it.</p>\n\n<p>Better yet, you can use a range-loop to make it even simplier</p>\n\n<pre><code>for(auto&amp; number : entries){\nstd::cout&lt;&lt;number&lt;&lt;'\\n'; //or printf(\"%ld\\n\",number), like in your code\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528904904, "post_id": 50841357, "comment_id": 88686322, "body": "Every time you <code>srand(time(NULL))</code> an angel loses their wings."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528904981, "post_id": 50841357, "comment_id": 88686374, "body": "I know, I wept inside while writing this."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528905847, "post_id": 50841357, "comment_id": 88686833, "body": "@tadman Inspired by your comment, I rewrote the srand() part from another SO answer. Also, I made a RandomInt() function to prevent bias toward certain values."}, {"owner": {"reputation": 133, "user_id": 5047865, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh5.googleusercontent.com/-xxOs-5Ldp_4/AAAAAAAAAAI/AAAAAAAAADQ/x5r4SZuesuI/photo.jpg?sz=128", "display_name": "MegaCleptomaniac", "link": "https://stackoverflow.com/users/5047865/megacleptomaniac"}, "edited": false, "score": 0, "creation_date": 1528906221, "post_id": 50841357, "comment_id": 88687089, "body": "I had to use sys/teimeb.h instead of your apporach and gett errors that the timeval struct time is incomplete"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1528907019, "post_id": 50841357, "comment_id": 88687549, "body": "<code>rand()&#47;RAND_MAX</code> is at odds with the function docs. It <i>will</i> draw 1, and hence the function itself <i>can</i> return <code>toNumber</code>."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1528907665, "post_id": 50841357, "comment_id": 88687871, "body": "@Bathsheba Argh, you&#39;re right. Thanks for your comment! I wrote the function from memory, and you made me look back at old code. I&#39;ll update my answer."}], "tags": [], "owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "is_accepted": false, "score": 1, "last_activity_date": 1528908248, "last_edit_date": 1528908248, "creation_date": 1528904873, "answer_id": 50841357, "question_id": 50841015, "link": "https://stackoverflow.com/questions/50841015/random-filled-vector-always-returns-the-same-numbers/50841357#50841357", "title": "Random-filled vector always returns the same numbers", "body": "<p>If you want your solution to be pure C, you'll need to use arrays instead of vectors.</p>\n\n<p>I'm missing some informations here, but a basic C program that uses srand() and rand() would look like this :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/time.h&gt;\n\n#define NB_ENTRIES (20)\n#define RANDOM_MAX_RANGE (50) // you should update that\n\n// Don't use srand(time(NULL)) because if you start many time this\n// program too quickly, you'll have the same values in all instances.\nvoid Randomize(void)\n{\n  struct timeval time; \n  gettimeofday(&amp;time,NULL);\n  srand((time.tv_sec * 1000) + (time.tv_usec / 1000));\n}\n\n// Returns a value between 0 and toNumber-1\n// Thanks to Bathsheba for pointing out an error with my first version.\nint RandomInt(int toNumber)\n{\n  return (int)(rand()/(RAND_MAX + 1.0) * toNumber);\n}\n\n// This better but slower version of RandomInt() will ensure\n// an even distribution of random values if toNumber is\n// greater than around three quarter of RAND_MAX\n// NOTE : toNumber must be between 0 and RAND_MAX.\nint BetterRandomInt(int toNumber)\n{\n  const int randomSize = RAND_MAX / toNumber;\n  int returnValue;\n  do \n  {\n    returnValue = rand() / randomSize;\n  }\n  while (returnValue &gt;= toNumber);\n\n  return returnValue;\n}\n\nint main(void)\n{\n  int entries[NB_ENTRIES];\n  int step;\n\n  Randomize();\n\n  for (step = 0; step &lt; NB_ENTRIES; step++)\n  {\n    entries[step] = RandomInt(RANDOM_MAX_RANGE);\n    // entries[step] = BetterRandomInt(RANDOM_MAX_RANGE);\n  }\n\n  for (step = 0; step &lt; NB_ENTRIES; step++)\n  {\n    printf(\"%d\\n\", entries[step]);\n  }       \n\n  return 0;\n}\n</code></pre>\n\n<p>Note that I'm using a fixed number of entries. You can make your array dynamic by using pointers and malloc(). Just comment if you need that, but I felt it was out of scope of the question.</p>\n"}], "owner": {"reputation": 133, "user_id": 5047865, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh5.googleusercontent.com/-xxOs-5Ldp_4/AAAAAAAAAAI/AAAAAAAAADQ/x5r4SZuesuI/photo.jpg?sz=128", "display_name": "MegaCleptomaniac", "link": "https://stackoverflow.com/users/5047865/megacleptomaniac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1528908248, "creation_date": 1528903716, "last_edit_date": 1528904236, "question_id": 50841015, "link": "https://stackoverflow.com/questions/50841015/random-filled-vector-always-returns-the-same-numbers", "title": "Random-filled vector always returns the same numbers", "body": "<p>I am completely new in C and try to fill a vector with random integers and output it afterwards. However, it seems that the vector is always filled with the same number. What do I need to change to really get random payments? There is no limit, the number should only be within the value range of long. Here's my code:</p>\n\n<pre><code>    #include \"stdafx.h\"\n    #include &lt;stdlib.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;vector&gt;\n    #include &lt;time.h&gt;\n\nint main()\n{\n    long x = 20;\n    long y = 12;\n    std::vector&lt;long&gt; entries;\n\n    //initialize simple random number generator using current time\n    srand(time(NULL));\n\n    for (int step = 0; step &lt; x; step++) {      \n        entries.push_back(rand());\n        ++entries[step];\n    }\n\n    for (std::vector&lt;long&gt;::const_iterator i = entries.begin(); i != entries.end(); ++i) {\n        printf(\"%ld\\n\", i);\n    }       \n\n    return 0;\n}\n</code></pre>\n\n<p>EDIT:\n<strong>I want to solve the issue using plain C not c++!</strong></p>\n"}, {"tags": ["c", "data-structures", "filereader"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1528903713, "post_id": 50840966, "comment_id": 88685620, "body": "<code>file_buf</code> is a <code>char *</code> array but should be a <code>char</code> array."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529075421, "post_id": 50840966, "comment_id": 88758678, "body": "when calling <code>strtok()</code>, always check (!=NULL) the returned value before using that value; to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529075590, "post_id": 50840966, "comment_id": 88758770, "body": "To help us determine the problem(s) with your code, when asking a question about a run time problem, as this question is doing, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>  Which, in this case, should also include a couple sample line from the input file"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529075674, "post_id": 50840966, "comment_id": 88758811, "body": "which line is #33?"}], "owner": {"reputation": 1, "user_id": 9936919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fef0b2e26ad344b6e56e36ad3b379f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Ioana ", "link": "https://stackoverflow.com/users/9936919/ioana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528903547, "creation_date": 1528903547, "question_id": 50840966, "link": "https://stackoverflow.com/questions/50840966/debug-assertion-failed-fileread", "title": "Debug Assertion Failed fileread", "body": "<pre><code>FILE * f;\nf = fopen(\"Depozite.txt\", \"r\");\n\nchar* token, file_buf[LINESIZE], sep_list[] = \",\";\nwhile (fgets(file_buf, sizeof(file_buf), f)) {\n    token = strtok(file_buf, sep_list);\n    tmpDepozit.idDepozit = (char*)malloc((strlen(token) + 1) * sizeof(char));\n    strcpy(tmpDepozit.idDepozit, token);\n\n    token = strtok(NULL, sep_list);\n    tmpDepozit.capacitate = atoi(token);\n\n    token = strtok(NULL, sep_list);\n    tmpDepozit.nrTipuriCereale = atoi(token);\n\n    tmpDepozit.listaCereale = (char**)malloc(tmpDepozit.nrTipuriCereale * sizeof(char*));\n\n    for (int i = 0; i&lt;tmpDepozit.nrTipuriCereale; i++) {\n        token = strtok(NULL, sep_list);\n        tmpDepozit.listaCereale[i] = (char*)malloc((strlen(token) + 1) * sizeof(char));\n        strcpy(tmpDepozit.listaCereale[i], token);\n    }\n\n    token = strtok(NULL, sep_list);\n    tmpDepozit.procentIncarcare = (float)atof(token);\n\n    inserareHTable(HTable, tmpDepozit, DIM);\n}\n</code></pre>\n\n<p>Debug Assertion Failed!</p>\n\n<pre><code>             Program:\n\n             C:\\Users\\Matthew\\Documents\\project\\homework\\debug\\\n\n             File: minkernel \\crts \\ ucrt \\ src \\ appcrt \\stdio\\ fgets.cpp\n\n             Line: 33\n\n             Expression: stream.valid()\n\n             Abort   Retry  Ignore\n</code></pre>\n\n<p>That windows pops in every time i try to run my program in Visual Studio 2017. I would like to read a txt file in but this is always mess up my program. Any idea how to prevent it? (my txt file is in the same file with the source.c)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 5, "creation_date": 1528903213, "post_id": 50840783, "comment_id": 88685324, "body": "1) those are bytes, not bits.  2) Show us code.  See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Also tell us the CPU you are running on; I suspect endianness may be in play here."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1528903510, "post_id": 50840783, "comment_id": 88685497, "body": "Questions seeking debugging help (<b>&quot;why isn&#39;t this code working?&quot;</b>) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1528903596, "post_id": 50840783, "comment_id": 88685543, "body": "<code>(a &lt;&lt; 8) | b</code>. With some care not to shift signed/negative operands."}], "answers": [{"tags": [], "owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "is_accepted": false, "score": 1, "last_activity_date": 1528903632, "creation_date": 1528903632, "answer_id": 50840981, "question_id": 50840783, "link": "https://stackoverflow.com/questions/50840783/how-to-append-two-bytes-in-c/50840981#50840981", "title": "How to append two bytes in C", "body": "<p>Let's suppose that you are talking about bytes instead of bits, the MSB is 0xf1, the LSB is 0x5e and you want to get all together in 2bytes:</p>\n\n<pre><code>uint16_t result = ((uint16_t)MSB&lt;&lt;8) | (LSB);\n</code></pre>\n\n<p>(The number 8 must be replaced by a define in order to avoid magic numbers)</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1528903710, "post_id": 50840987, "comment_id": 88685616, "body": "However, this invokes undefined behavior on 8/16 bit CPU."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1528903805, "post_id": 50840987, "comment_id": 88685685, "body": "@Lundin Thanks. Fixed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1528903848, "post_id": 50840987, "comment_id": 88685706, "body": "...and no, changing to long does not fix it. <code>m</code> get integer-promoted to <code>int</code>, which is 16 bits on 8/16 bit CPUs. And then you shift 0xf1 into the sign bits, invoking undefined behavior."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1528904534, "post_id": 50840987, "comment_id": 88686111, "body": "I&#39;m being stupid today. Made it unsigned and added casts (2 for good measure) on the RHS. Now it should be fixed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1528905084, "post_id": 50840987, "comment_id": 88686418, "body": "Yep. Common bug on the mentioned kind of CPUs. This is where MISRA-C is useful."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1528904334, "last_edit_date": 1528904334, "creation_date": 1528903651, "answer_id": 50840987, "question_id": 50840783, "link": "https://stackoverflow.com/questions/50840783/how-to-append-two-bytes-in-c/50840987#50840987", "title": "How to append two bytes in C", "body": "<p>Use bit ops:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\ntypedef unsigned char uchar;\nint main()\n{\n    uchar m=0xf1;\n    uchar l=0x5e;\n    unsigned ml=((unsigned)m)&lt;&lt;8|(unsigned)l; \n    //doing it in unsigned (at least 16 bits guaranteed, no sign bit)\n    printf(\"%06x\\n\", ml); //prints 00f15e\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9936846, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gm3FID6wCDQ/AAAAAAAAAAI/AAAAAAAAAKQ/-zZRNJFOA6s/photo.jpg?sz=128", "display_name": "Engineering_peasant", "link": "https://stackoverflow.com/users/9936846/engineering-peasant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1060, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528904334, "creation_date": 1528903034, "question_id": 50840783, "link": "https://stackoverflow.com/questions/50840783/how-to-append-two-bytes-in-c", "title": "How to append two bytes in C", "body": "<p>I am fairly new to programming in C and I have a problem that I have to fix. When I receive my data the most significant bit is printed like 00f1 and my least significant bit is printed 005e.\nHow do I get it so that the value can be 00f15e? \nAs of right now I can only get them to print 5ef100</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528902237, "post_id": 50840185, "comment_id": 88684695, "body": "you can use a <a href=\"https://stackoverflow.com/questions/7684359/how-to-use-nanosleep-in-c-what-are-tim-tv-sec-and-tim-tv-nsec/7684399\">brief sleep</a> to take the load off the cpu."}, {"owner": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528902687, "post_id": 50840185, "comment_id": 88685009, "body": "@SanderDeDycker how many time do you use to overload the cpu? I tested with 500 ms, my cpu is always at 25% using (with a quadcore)"}, {"owner": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528902759, "post_id": 50840185, "comment_id": 88685044, "body": "@SanderDeDycker I added the follinwing lines in my program : <code>if(g_wait)         {             struct timespec waiting;             waiting.tv_sec = 0;             waiting.tv_nsec = 500000;             nanosleep(&amp;waiting, NULL);         }</code>"}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1528903533, "post_id": 50840185, "comment_id": 88685511, "body": "you can use <a href=\"http://man7.org/linux/man-pages/man3/pthread_yield.3.html\" rel=\"nofollow noreferrer\">yeild</a> and i think g_wait should be an atomic"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1528906140, "post_id": 50840185, "comment_id": 88687027, "body": "What does, &quot;wait for the main program&quot; mean? What is it that you want the main thread to <i>do</i> before the child thread is allowed to stop waiting?"}, {"owner": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "reply_to_user": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1528958141, "post_id": 50840185, "comment_id": 88704731, "body": "@Tyker <code>pthread_yield</code> didn&#39;t overload the processor"}, {"owner": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1528958322, "post_id": 50840185, "comment_id": 88704817, "body": "@jameslarge I want to be able to stop temporary the main thread, and this has as consequence of full utilisation of one processor because the child thread isn&#39;t waiting -&gt; I would like to add some lines to let the cpu free of charge during this waiting"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1588553515, "post_id": 50840185, "comment_id": 108934674, "body": "@damadam Why is the thread using 100% of the CPU anyway? What is it doing exactly? The code you&#39;ve shown should block in <code>read</code> until there&#39;s data for it to read. If the thread is using 100% of the CPU when it has no work to do, that&#39;s likely just some bug in the thread&#39;s existing code. If it has nothing to do, what is it doing?"}], "answers": [{"comments": [{"owner": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "edited": false, "score": 0, "creation_date": 1528963007, "post_id": 50852065, "comment_id": 88707389, "body": "there is a <code>while</code> funtion in my child thread, so i&#39;m not sure I will be able to use the <code>pthread_mutex_unlock</code> like that, and it&#39;s my user who decide to pause and resume the program, not an arbitrary value which define the waiting time"}, {"owner": {"reputation": 573, "user_id": 8168483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c739c33f9cbd40c31fed10707f1a8e88?s=128&d=identicon&r=PG&f=1", "display_name": "kerrytazi", "link": "https://stackoverflow.com/users/8168483/kerrytazi"}, "reply_to_user": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "edited": false, "score": 0, "creation_date": 1528964014, "post_id": 50852065, "comment_id": 88708089, "body": "@damadam, pause is used just for example, of course u can use loops and other stuff."}], "tags": [], "owner": {"reputation": 573, "user_id": 8168483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c739c33f9cbd40c31fed10707f1a8e88?s=128&d=identicon&r=PG&f=1", "display_name": "kerrytazi", "link": "https://stackoverflow.com/users/8168483/kerrytazi"}, "is_accepted": false, "score": 0, "last_activity_date": 1528961832, "creation_date": 1528961832, "answer_id": 50852065, "question_id": 50840185, "link": "https://stackoverflow.com/questions/50840185/how-to-make-a-child-thread-waiting-for-the-main-thread/50852065#50852065", "title": "How to make a child thread waiting for the main thread", "body": "<p>So, if you want to pause main thread until child thread signals about it ends, you can use mutexes to lock main thread:</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"pthread.h\"\n\n/* I work on windows now, so i need windows sleep function to test example */\n/* platform independed sleep function */\n#ifdef _WIN32\n# include \"windows.h\"\n# define platform_sleep(ms) Sleep(ms)\n#else\n# include \"unistd.h\"\n# define platform_sleep(s) sleep(s / 1000)\n#endif\n\n\npthread_mutex_t mtx;\n\n\nvoid *\nchild_func(void *arg)\n{\n    /* simulate some hard work */\n    platform_sleep(3000); /* 3 secs */\n\n    /* after this \"hard work\" we allow main thread to continue */\n    pthread_mutex_unlock(&amp;mtx);\n}\n\n\n\nint\nmain()\n{\n    pthread_mutex_init(&amp;mtx, NULL);\n    pthread_mutex_lock(&amp;mtx);\n\n    pthread_t child;\n    pthread_create(&amp;child, NULL, child_func, NULL);\n\n    /* mutex is already locked by main thread, so it waits */\n    /* until child thread unlock it */\n    pthread_mutex_lock(&amp;mtx);\n    pthread_mutex_destroy(&amp;mtx);\n\n    /* do work after child ends */\n}\n</code></pre>\n"}], "owner": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1588548142, "creation_date": 1528901312, "last_edit_date": 1528962814, "question_id": 50840185, "link": "https://stackoverflow.com/questions/50840185/how-to-make-a-child-thread-waiting-for-the-main-thread", "title": "How to make a child thread waiting for the main thread", "body": "<p>I've got 2 threads : one child which detects mouse events, and the other main one which execute the program. </p>\n\n<p><em>global variable :</em></p>\n\n<pre><code>int g_wait = 0; \n</code></pre>\n\n<p><em>child thread :</em></p>\n\n<pre><code>void *mouseEvent2(void *arg) \n{\nint fd;\nstruct input_event ev;\nconst char* pFile = \"/dev/input/event0\";\n\nsignal(SIGINT, SAMPLE_VGS_HandleSig);\nsignal(SIGTERM, SAMPLE_VGS_HandleSig);\n\nfd = open(pFile, O_RDONLY);\nif (fd == -1) {\n    printf(\"ERROR Opening %s\\n\", pFile);\n    return NULL;\n}\n\nwhile(scroll != -1) {\n    read(fd, &amp;ev, sizeof(ev));\n\n    [... Some code with if statement ... ]\n    if(...) //left mouse button\n        g_wait = !g_wait;\n\n    [need waiting so the thread won't use at 100% a core]\n}\nclose(fd);\n(void) arg;\npthread_exit(NULL);\n}\n</code></pre>\n\n<p><em>Main thread :</em></p>\n\n<pre><code>int main() {\n[... some code and initilisation here ...]\nif(pthread_create(&amp;scrollThread, NULL, mouseEvent2, NULL))\n    goto _FAILURE_;\ndo {\n    [...]\n    while(g_wait);\n}\n[... some deinit ...]\n_FAILURE_ :\npthread_join(scrollThread, NULL);\n[... some other deinit ...]\nreturn 0;\n}\n</code></pre>\n\n<p>My problem is : when my main is waiting, my child thread is using at 100% 1 core processor, so which function can I use to pause the child thread with the main one?</p>\n\n<p>I already consult <a href=\"https://stackoverflow.com/questions/11624545/how-to-make-main-thread-wait-for-all-child-threads-finish\">How to make main thread wait for all child threads finish?</a> but it didn't help me totally.</p>\n"}, {"tags": ["c", "loops", "while-loop", "format"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528901187, "post_id": 50840130, "comment_id": 88683986, "body": "And what&#39;s the question ? What problem did you run into when trying to do this ? What did you try ?"}, {"owner": {"reputation": 1208, "user_id": 9123163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CgKR.jpg?s=128&g=1", "display_name": "ltd9938", "link": "https://stackoverflow.com/users/9123163/ltd9938"}, "edited": false, "score": 0, "creation_date": 1528901223, "post_id": 50840130, "comment_id": 88684005, "body": "What constitutes a wrong format?"}, {"owner": {"reputation": 13, "user_id": 9936720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d568832b648e8473a84d0aeacd1854?s=128&d=identicon&r=PG&f=1", "display_name": "Efkan &#214;zkeles", "link": "https://stackoverflow.com/users/9936720/efkan-%c3%96zkeles"}, "edited": false, "score": 0, "creation_date": 1528901238, "post_id": 50840130, "comment_id": 88684021, "body": "i need to add a loop in code so the program asks me again to enter 2 values if you enter the wrong format"}, {"owner": {"reputation": 13, "user_id": 9936720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d568832b648e8473a84d0aeacd1854?s=128&d=identicon&r=PG&f=1", "display_name": "Efkan &#214;zkeles", "link": "https://stackoverflow.com/users/9936720/efkan-%c3%96zkeles"}, "edited": false, "score": 0, "creation_date": 1528901267, "post_id": 50840130, "comment_id": 88684035, "body": "@itd9938 anything else than float"}, {"owner": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "edited": false, "score": 0, "creation_date": 1528901276, "post_id": 50840130, "comment_id": 88684043, "body": "I&#39;m assuming perhaps a string can be entered instead of a float, which would case issues with scanf_s using the &quot;%f %f&quot; format specifier."}, {"owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "edited": false, "score": 2, "creation_date": 1528901290, "post_id": 50840130, "comment_id": 88684052, "body": "And to check for the &quot;wrong format&quot;, you should get the input as a string and parse it... Using <code>scanf</code> will cause all sorts of trouble. Look for <code>fgets</code>."}, {"owner": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "reply_to_user": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "edited": false, "score": 1, "creation_date": 1528901373, "post_id": 50840130, "comment_id": 88684106, "body": "@EnzoFerber is correct. your scanf_s will not parse anything other than floats by using that format string. If you want to validate the input, you should scan a broader range of inputs then check to see if they are indeed floats."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528904133, "post_id": 50840130, "comment_id": 88685868, "body": "I think what you really need is this great tutorial on reading input: <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html</a>  or this: <a href=\"https://stackoverflow.com/questions/35178520/how-to-read-parse-input-in-c-the-faq\" title=\"how to read parse input in c the faq\">stackoverflow.com/questions/35178520/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1528902290, "post_id": 50840195, "comment_id": 88684743, "body": "Wouldn&#39;t that turn into an endless loop in case of ever anything non-conforming being entered?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528902357, "post_id": 50840195, "comment_id": 88684782, "body": "@Yunnosch: Indeed it would. If that&#39;s objectionable then use an additional counter."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1528903832, "post_id": 50840195, "comment_id": 88685699, "body": "If I enter &quot;no&quot;, it will be an endless loop, failing to scan that &quot;no&quot;, how does a counter solve that problem?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528904138, "post_id": 50840195, "comment_id": 88685871, "body": "@Yunnosch: Oops. I&#39;ve put in the idiomatic stream clearer."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528904290, "post_id": 50840195, "comment_id": 88685974, "body": "Now it is the kind of answer I expect to see above your name. ;-) Take that as a compliment."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528904303, "post_id": 50840195, "comment_id": 88685982, "body": "@Yunnosch: Oh you&#39;re so nice ;-)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528905645, "post_id": 50840195, "comment_id": 88686731, "body": "<a href=\"https://en.wiktionary.org/wiki/mutual_admiration_society\" rel=\"nofollow noreferrer\">MAS</a> aside, the text explains the <code>do</code> loop should be called after a failure (or after a previous input that left a <code>&#39;\\n&#39;</code>), yet that that prior requirement is not apparent in the code itself. Suggest a code comment"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1528904114, "last_edit_date": 1528904114, "creation_date": 1528901344, "answer_id": 50840195, "question_id": 50840130, "link": "https://stackoverflow.com/questions/50840130/how-to-loop-scanf-s-until-success/50840195#50840195", "title": "How to loop scanf_s() until success?", "body": "<p>The best way of checking the validity of the input is to check the return value of <code>scanf_s</code> which tells you the number of variables that were successfully set. In your case, if it's 2 then all is well; otherwise you need to repeat.</p>\n\n<p>In other words</p>\n\n<pre><code>do {\n    int c;\n    while ((c = getchar()) != '\\n' &amp;&amp; c != EOF); // clear the input stream\n    printf(\"Enter 2 numbers: \\n\");\n} while (scanf_s(\"%f %f\", &amp;x, &amp;y) != 2);\n</code></pre>\n\n<p>is an appropriate control structure, rather than <code>if (getchar() == '\\n')</code>, which you should drop.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528904277, "post_id": 50840539, "comment_id": 88685964, "body": "<code>len = strlen(buf) - 1;         buf[len] = 0;</code> can be hacked and a  <code>&#39;\\n&#39;</code> may not exist in <code>buf</code>.  Consider <code>buf[strcspn(buf, &quot;\\n&quot;)] = &#39;\\0&#39;;</code> instead to lop off the potential trailing <code>\\n</code>."}, {"owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528907033, "post_id": 50840539, "comment_id": 88687561, "body": "@chux I like the <code>strcspn</code> suggestion and changed the answer to use it. (about the <code>90</code>, not even I know why... I updated it)"}], "tags": [], "owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "is_accepted": false, "score": 1, "last_activity_date": 1528907341, "last_edit_date": 1528907341, "creation_date": 1528902331, "answer_id": 50840539, "question_id": 50840130, "link": "https://stackoverflow.com/questions/50840130/how-to-loop-scanf-s-until-success/50840539#50840539", "title": "How to loop scanf_s() until success?", "body": "<p>What I don't like about using <code>scanf</code> family of functions is that it will go berserk and crash your program when you input something wrong. For example, if you have <code>scanf(\"%f\", &amp;a)</code>, try inputing <code>stack overflow</code>. It goes nuts!</p>\n\n<p>So, as I said in the comments, I think you should build your own validating function, and get user input as just a string using <code>fgets</code>.</p>\n\n<p>Here is a simple code that will get you started in it. This is very ugly code and you should refactor it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;  /* printf, fgets */\n#include &lt;ctype.h&gt;  /* isdigit, isspace */\n#include &lt;string.h&gt; /* strlen */\n\nint is_valid_float(char *s, int len)\n{\n    int i;\n\n    for(i = 0; i &lt; len; i++) {\n        /* floats may have a decimal point */\n        if(s[i] == '.') continue;\n\n        /* spaces should be ignored, since they separete the nubmers */\n        if(isspace(s[i])) continue;\n\n        /* is there's anything besides a number, we abort */\n        if(!isdigit(s[i])) return 0;\n    }\n\n    /* if we got here, then the input contains two valid floats.\n     * \n     * Does it? Test it!\n     */\n    return 1;\n}\n\n\nint main(void)\n{\n    float a, b;\n    char buf[100];\n    int len;\n\n    do {\n        fprintf(stderr, \"Enter A and B: \");\n        fgets(buf, sizeof buf, stdin);\n\n        /* fgets will store a newline at the end of the string, we\n         * just overwrite it with a null terminator\n         *\n         * Thanks to @chux for the strcspn() suggestion.\n         */\n        buf[strcspn(buf, \"\\n\")] = 0;    \n    } while(!is_valid_float(buf, len));\n\n    /* now, after we know the string is valid and won't cause scanf to go\n     * berserk, we can use it in our validated string.\n     *\n     * Here is where you should really take a moment and look at the\n     * validation function and improve it. Not valid strings will cause\n     * your program to go nuts.\n     */\n    sscanf(buf, \"%f %f\", &amp;a, &amp;b);\n\n    /* Did it scan the numbers correctly? */\n    printf(\"A: %f\\n\", a);\n    printf(\"B: %f\\n\", b);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9936720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d568832b648e8473a84d0aeacd1854?s=128&d=identicon&r=PG&f=1", "display_name": "Efkan &#214;zkeles", "link": "https://stackoverflow.com/users/9936720/efkan-%c3%96zkeles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 50840195, "answer_count": 2, "score": 1, "last_activity_date": 1528907341, "creation_date": 1528901139, "last_edit_date": 1528902340, "question_id": 50840130, "link": "https://stackoverflow.com/questions/50840130/how-to-loop-scanf-s-until-success", "title": "How to loop scanf_s() until success?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    float x,y;\n\n    printf(\"Enter 2 numbers: \\n\");\n    scanf_s(\"%f %f\", &amp;x, &amp;y);\n\n    if (getchar() == '\\n')\n    {\n    printf(\"Division: %f\\n\", x / y);\n    printf(\"Product: %f\\n\", x * y);\n    printf(\"Sum: %f\\n\", x + y);\n    printf(\"Difference: %f\\n\", x - y);\n    }\n    else\n    {\n        printf(\"no Float-Value!\");\n    }\n\ngetchar();\nreturn 0;\n}\n</code></pre>\n\n<p>we need to get a loop in so if we enter the wrong format the program should ask again to enter two numbers</p>\n"}, {"tags": ["c", "loops", "linked-list"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1528900449, "post_id": 50839857, "comment_id": 88683455, "body": "Why are you redefining <code>struct Node</code> inside <code>main</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1528900496, "post_id": 50839857, "comment_id": 88683502, "body": "<code>push(&amp;head, object);</code> is a type error. Doesn&#39;t your compiler complain about this?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1528900537, "post_id": 50839857, "comment_id": 88683527, "body": "<code>tmp = malloc(...); tmp = ...</code> is a memory leak."}, {"owner": {"reputation": 243, "user_id": 9807062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003216fd0dc9e2efba50b25da4f35c16?s=128&d=identicon&r=PG&f=1", "display_name": "Platon Makovsky", "link": "https://stackoverflow.com/users/9807062/platon-makovsky"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1528900548, "post_id": 50839857, "comment_id": 88683532, "body": "@melpomene I&#39;m learning how to pass objects to functions, assign objects oneanother and create lists consisting of multiple fields."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1528900566, "post_id": 50839857, "comment_id": 88683548, "body": "That answers literally none of my questions."}, {"owner": {"reputation": 243, "user_id": 9807062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003216fd0dc9e2efba50b25da4f35c16?s=128&d=identicon&r=PG&f=1", "display_name": "Platon Makovsky", "link": "https://stackoverflow.com/users/9807062/platon-makovsky"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1528900676, "post_id": 50839857, "comment_id": 88683616, "body": "@melpomene &#39;function&#39; - incompatible types - from &#39;Node *&#39; to &#39;Node *&#39;  is what I get in VS, but it doesn&#39;t make much sense to me."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1528900719, "post_id": 50839857, "comment_id": 88683648, "body": "You have two different struct types in your program. For some reason you&#39;ve given them both the name <code>Node</code>, but they&#39;re still different types."}, {"owner": {"reputation": 243, "user_id": 9807062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003216fd0dc9e2efba50b25da4f35c16?s=128&d=identicon&r=PG&f=1", "display_name": "Platon Makovsky", "link": "https://stackoverflow.com/users/9807062/platon-makovsky"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1528900815, "post_id": 50839857, "comment_id": 88683728, "body": "@melpomene What makes their types different? They consist of the same fields, only naming is different."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1528900982, "post_id": 50839857, "comment_id": 88683836, "body": "Why should they be the same? There are clearly two separate <code>struct { ... }</code> definitions in the code, each of which creates a new type."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1528901079, "post_id": 50839857, "comment_id": 88683915, "body": "<code>tmp = object;</code> ==&gt; <code>*tmp = *object</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1528901272, "post_id": 50839857, "comment_id": 88684041, "body": "Don&#39;t &quot;repeat&quot; <code>struct Node</code> inside <code>main</code>"}, {"owner": {"reputation": 243, "user_id": 9807062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003216fd0dc9e2efba50b25da4f35c16?s=128&d=identicon&r=PG&f=1", "display_name": "Platon Makovsky", "link": "https://stackoverflow.com/users/9807062/platon-makovsky"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528901365, "post_id": 50839857, "comment_id": 88684100, "body": "@4386427 Worked like a charm, why are the * required there? Neither tmp or object are double pointers."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1528901399, "post_id": 50839857, "comment_id": 88684123, "body": "As far as the compiler is concerned, you&#39;ve defined two different <code>Node</code> structs. Whether you think they&#39;re the same outside of simple naming is not relevant. The compiler doesn&#39;t just assume you mean the same thing. Why do you have a redefined <code>Node</code>?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1528901569, "post_id": 50839857, "comment_id": 88684254, "body": "@OlegPlachkov Without the * you are assigning the <b>value</b> of a pointer to another pointer. That&#39;s not what you want! You want to assign the <b>value of the struct</b> pointed to by <code>object</code> to be assigned to the struct pointed to by <code>tmp</code>. Hence the *"}, {"owner": {"reputation": 243, "user_id": 9807062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003216fd0dc9e2efba50b25da4f35c16?s=128&d=identicon&r=PG&f=1", "display_name": "Platon Makovsky", "link": "https://stackoverflow.com/users/9807062/platon-makovsky"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1528901642, "post_id": 50839857, "comment_id": 88684302, "body": "@lurker I thought in order to assign 2 structures one another they had to be of the same type. Plus the name I gave the object in main initially wasn&#39;t accepted by the compiler when I passed it to functions so I had to use what worked."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1528901954, "post_id": 50839857, "comment_id": 88684515, "body": "You&#39;ve defined two structures, with different scopes, using the same name. Your <code>push</code> function accepts a pointer to <code>Node</code>, but you call it with the address of a <i>different</i> <code>Node</code>. Why don&#39;t you just use the same type definition for the <code>Node</code> used inside <code>main</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1528902370, "creation_date": 1528902370, "answer_id": 50840556, "question_id": 50839857, "link": "https://stackoverflow.com/questions/50839857/cant-traverse-through-a-c-linked-list/50840556#50840556", "title": "Can&#39;t traverse through a C linked list", "body": "<p>There are two major problems in your code:</p>\n\n<ul>\n<li><p>You define <code>struct Node</code> both outside <code>main</code> and inside <code>main</code></p></li>\n<li><p>Here <code>tmp = object;</code> you copy the value of a pointer to another pointer but you really want to copy the value of a struct to another struct, i.e. <code>*tmp = *object;</code>.</p></li>\n</ul>\n\n<p>Besides that - don't put <code>head</code> as a global variable.</p>\n\n<p>So the code should be more like:</p>\n\n<pre><code>typedef struct Node {\n    int a;\n    char asd[30];\n    struct Node *next;\n}Node;\n\nvoid push(Node**head, struct Node* object);\nvoid printList(Node *head);\n\nint main() {\n    Node *head = NULL;\n\n    struct Node *object = malloc(sizeof(struct Node));\n\n    int c = 0;\n    while (1) {\n        printf(\"This int will be stored in Node %d.\\n\", ++c);\n        scanf(\"%d\", &amp;object-&gt;a);\n        getchar();\n        if (!object-&gt;a) {\n            break;\n        }\n        printf(\"This string will be stored in Node %d.\\n\", c);\n        gets_s(object-&gt;asd, 30);\n        if (!(strcmp(object-&gt;asd, \"\\0\"))) {\n            break;\n        }\n        push(&amp;head, object);\n    }\n    printList(head);\n\n    return 0;\n}\n\nvoid push(Node ** head,  struct Node* object)\n{\n    Node *tmp = malloc(sizeof(Node));\n    *tmp = *object;                    // Copy the struct\n    tmp-&gt;next = (*head);\n    (*head) = tmp;\n}\n\n\nvoid printList(Node *head) {\n    if (head == NULL) {\n        puts(\"No list exists.\");\n        exit(9);\n    }\n\n        while (1) {\n            printf(\"-------------------------------\\n\");\n            printf(\"|Int: &lt;%d&gt; |||| String: &lt;%s&gt;.|\\n\", head-&gt;a, head-&gt;asd);\n            printf(\"-------------------------------\\n\");\n            if (head-&gt;next) {\n                printf(\"\\n\\n%p\\n\\n\", head-&gt;next);\n\n                head = head-&gt;next;\n            }\n            else {\n                break;\n            }\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 9807062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003216fd0dc9e2efba50b25da4f35c16?s=128&d=identicon&r=PG&f=1", "display_name": "Platon Makovsky", "link": "https://stackoverflow.com/users/9807062/platon-makovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 50840556, "answer_count": 1, "score": 0, "last_activity_date": 1528902370, "creation_date": 1528900377, "question_id": 50839857, "link": "https://stackoverflow.com/questions/50839857/cant-traverse-through-a-c-linked-list", "title": "Can&#39;t traverse through a C linked list", "body": "<p>Task is to create a linked list consisting of objects. User inputs data for each individual <code>Node</code> in the <code>main</code> and then the object is being passed to <code>push</code>, which creates the list.</p>\n\n<p>The problem comes in the <code>printList</code> function, where the condition for a <code>break</code> is never met.\nFor some reason the line <code>head = head-&gt;next</code> doesn't do anything, as the address of <code>next</code> with every iteration remains the same.</p>\n\n<pre><code>typedef struct Node {\n    int a;\n    char asd[30];\n    struct Node *next;\n}Node;\n\nNode *head = NULL;\n\nvoid push(Node**head, struct Node* object);\nvoid printList(Node *head);\n\nint main() {\n\n    struct Node {\n        int oA;\n        char oAsd[30];\n        struct Node *next;\n    };\n\n    struct Node *object = malloc(sizeof(struct Node));\n\n    int c = 0;\n    while (1) {\n        printf(\"This int will be stored in Node %d.\\n\", ++c);\n        scanf(\"%d\", &amp;object-&gt;oA);\n        getchar();\n        if (!object-&gt;oA) {\n            break;\n        }\n        printf(\"This string will be stored in Node %d.\\n\", c);\n        gets_s(object-&gt;oAsd, 30);\n        if (!(strcmp(object-&gt;oAsd, \"\\0\"))) {\n            break;\n        }\n        push(&amp;head, object);\n    }\n    printList(head);\n\n    return 0;\n}\n\nvoid push(Node ** head,  struct Node* object)\n{\n    Node *tmp = malloc(sizeof(Node));\n    tmp = object;\n    tmp-&gt;next = (*head);\n    (*head) = tmp;\n}\n\n\nvoid printList(Node *head) {\n    if (head == NULL) {\n        puts(\"No list exists.\");\n        exit(9);\n    }\n\n        while (1) {\n            printf(\"-------------------------------\\n\");\n            printf(\"|Int: &lt;%d&gt; |||| String: &lt;%s&gt;.|\\n\", head-&gt;a, head-&gt;asd);\n            printf(\"-------------------------------\\n\");\n            if (head-&gt;next) {\n                printf(\"\\n\\n%p\\n\\n\", head-&gt;next);\n\n                head = head-&gt;next;\n            }\n            else {\n                break;\n            }\n        }\n}`\n</code></pre>\n"}, {"tags": ["c", "gcc", "gcc-warning"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1528899392, "post_id": 50839428, "comment_id": 88682715, "body": "I always found that setting buggy as can be. <code>-fno-strict-aliasing</code> is the way to go. Tells the UB to get lost, the C standard be damned."}, {"owner": {"reputation": 4565, "user_id": 1535516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cd12e7701f83e50fb4d29d1918be0f?s=128&d=identicon&r=PG", "display_name": "xaizek", "link": "https://stackoverflow.com/users/1535516/xaizek"}, "edited": false, "score": 0, "creation_date": 1528899766, "post_id": 50839428, "comment_id": 88682999, "body": "&quot;quick&quot;, &quot;least accurate&quot;, &quot;front end only&quot;.  See no reason to consider this a bug. Docs on level 2 say: &quot;few false negatives (but possibly more than level 1)&quot;, so false negatives seem to be expected on level 1 too."}, {"owner": {"reputation": 5310, "user_id": 1790864, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/u8BJF.png?s=128&g=1", "display_name": "Rev", "link": "https://stackoverflow.com/users/1790864/rev"}, "reply_to_user": {"reputation": 4565, "user_id": 1535516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cd12e7701f83e50fb4d29d1918be0f?s=128&d=identicon&r=PG", "display_name": "xaizek", "link": "https://stackoverflow.com/users/1535516/xaizek"}, "edited": false, "score": 0, "creation_date": 1528958889, "post_id": 50839428, "comment_id": 88705113, "body": "@xaizek: True. But since &quot;line 2&quot; is such an obvious case, I would really not have expected a false negative there. But I don&#39;t pretend to know much about compiler construction, there are probably &quot;reasons&quot; why it is the way it is."}, {"owner": {"reputation": 4565, "user_id": 1535516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cd12e7701f83e50fb4d29d1918be0f?s=128&d=identicon&r=PG", "display_name": "xaizek", "link": "https://stackoverflow.com/users/1535516/xaizek"}, "edited": false, "score": 0, "creation_date": 1528996252, "post_id": 50839428, "comment_id": 88727762, "body": "I&#39;ve tried your code at compiler explorer and GCC stops producing warnings at 7.2 onwards even after removing UB related to <code>buffer</code> not being initialized. Warnings appear if <code>uint8_t</code> is changed to <code>float</code>, which reminded me that <code>unsigned char</code> is allowed to alias anything and code for <code>-Wstrict-aliasing=1</code> just compares alias sets of types (on trunk at least). However, I&#39;m not sure this is a valid explanation. There are multiple bug tickets related to strict aliasing, but maybe it&#39;s warranted to open another one asking for clarification about your example."}], "owner": {"reputation": 5310, "user_id": 1790864, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/u8BJF.png?s=128&g=1", "display_name": "Rev", "link": "https://stackoverflow.com/users/1790864/rev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1528899217, "creation_date": 1528899217, "question_id": 50839428, "link": "https://stackoverflow.com/questions/50839428/wstrict-aliasing-3-throws-warning-where-wstrict-aliasing-1-does-not", "title": "-Wstrict-aliasing=3 throws warning where -Wstrict-aliasing=1 does not", "body": "<p>Using GCC 5.4.0.</p>\n\n<p>The example is trivial. The code violates the strict aliasing rule on two occasions. </p>\n\n<blockquote>\n  <p>\"dereferencing type-punned pointer will break strict-aliasing rules\"</p>\n</blockquote>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nint main() {\n    uint8_t buffer[100]; // line 1\n    uint32_t test = *((uint32_t*)(&amp;buffer[10]));  // line 2\n    uint32_t* pTest2 = (uint32_t*)(&amp;buffer[10]);  // line 3\n    test = *pTest2;  // line 4\n}\n</code></pre>\n\n<ul>\n<li>-Wstrict-aliasing=3 warns about line 2 only</li>\n<li>-Wstrict-aliasing=2 warns about line 2 and 3</li>\n<li>-Wstrict-aliasing=1 <strong>throws no warning at all</strong></li>\n</ul>\n\n<p>From the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html\" rel=\"nofollow noreferrer\">GCC documentation</a>:</p>\n\n<blockquote>\n  <p>Level 1: Most aggressive, quick, least accurate. Possibly useful when higher levels do not warn but -fstrict-aliasing still breaks the code, as it has very few false negatives. However, it has many false positives. <strong>Warns for all pointer conversions between possibly incompatible types, even if never dereferenced.</strong> Runs in the front end only.</p>\n</blockquote>\n\n<p>Now I am unsure about how reliable -Wstrict-aliasing=1 actually is. Is this an issue with GCC 5.4.0?</p>\n"}, {"tags": ["c++", "c", "memory-management", "dlopen", "jemalloc"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1528899709, "post_id": 50839284, "comment_id": 88682963, "body": "I do not think those libraries are designed to be open with <code>dlopen</code>."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1528900304, "post_id": 50839284, "comment_id": 88683357, "body": "Seems like an issue in jemalloc version you have. In any case this is not really good idea to use dynamic library loading nether dlopen nor LoadLibrary for memory allocators. Imagine what is going to happen, when you call to a <code>free</code> function when allocator is already unloaded. Link shared libraries to the executable instead."}, {"owner": {"reputation": 603, "user_id": 6304206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bxeU_Wvk3RQ/AAAAAAAAAAI/AAAAAAAABAE/WUQH4BtsS-I/photo.jpg?sz=128", "display_name": "EnzoMolion", "link": "https://stackoverflow.com/users/6304206/enzomolion"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1528901889, "post_id": 50839284, "comment_id": 88684473, "body": "@SergeyA What do you mean by not &quot;designed to be open with <code>dlopen</code>&quot;, please ? @VictorGubin I am aware of this pitfall. I am trying to design a subsystem to be able to use multple allocation strategies within the same program. Linking sharing libraries is thus not enough and making sure to free allocated memory with the good allocator is part of the program design."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1528902236, "post_id": 50839284, "comment_id": 88684694, "body": "They are designed to be linked automatically through dynamic loader and become available before program starts executing."}, {"owner": {"reputation": 4747, "user_id": 611560, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/25ee461bdf2849f6db82054c73192ea1?s=128&d=identicon&r=PG", "display_name": "Yann Droneaud", "link": "https://stackoverflow.com/users/611560/yann-droneaud"}, "edited": false, "score": 0, "creation_date": 1528920811, "post_id": 50839284, "comment_id": 88694523, "body": "One has to use <code>dlsym()</code> to retrieve the <code>calloc()</code>, <code>free()</code>, <code>malloc()</code> and <code>realloc()</code>  functions provided by the allocator dynamic library <i>and</i> one has to be very careful not to free or reallocate a pointer provided by one allocator with the functions of another allocator."}], "answers": [{"tags": [], "owner": {"reputation": 603, "user_id": 6304206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bxeU_Wvk3RQ/AAAAAAAAAAI/AAAAAAAABAE/WUQH4BtsS-I/photo.jpg?sz=128", "display_name": "EnzoMolion", "link": "https://stackoverflow.com/users/6304206/enzomolion"}, "is_accepted": true, "score": 1, "last_activity_date": 1528912386, "creation_date": 1528912386, "answer_id": 50843393, "question_id": 50839284, "link": "https://stackoverflow.com/questions/50839284/how-to-dlopen-jemalloc-dynamic-library/50843393#50843393", "title": "How to dlopen jemalloc dynamic library", "body": "<p>I was able to find a solution to this thanks to <code>jemalloc</code>'s GitHub repository <a href=\"https://github.com/jemalloc/jemalloc/issues/1237\" rel=\"nofollow noreferrer\">issue #1237</a>. </p>\n\n<p>This solution was to recompile <code>jemalloc</code> using the <code>--disable-initial-exec-tls</code> according to the <a href=\"https://github.com/jemalloc/jemalloc/blob/dev/INSTALL.md\" rel=\"nofollow noreferrer\">INSTALL.md</a>, my bad.</p>\n"}], "owner": {"reputation": 603, "user_id": 6304206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bxeU_Wvk3RQ/AAAAAAAAAAI/AAAAAAAABAE/WUQH4BtsS-I/photo.jpg?sz=128", "display_name": "EnzoMolion", "link": "https://stackoverflow.com/users/6304206/enzomolion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 50843393, "answer_count": 1, "score": 0, "last_activity_date": 1528912386, "creation_date": 1528898797, "question_id": 50839284, "link": "https://stackoverflow.com/questions/50839284/how-to-dlopen-jemalloc-dynamic-library", "title": "How to dlopen jemalloc dynamic library", "body": "<p>I am trying to <code>dlopen</code> memory allocators at runtime. \nI have no problem with <code>libc</code>, <code>tcmalloc</code> and <code>tbbmalloc</code>. But trying to <code>dlopen</code> <code>jemalloc</code> results in the following error (caught via <code>dlerror</code>) : </p>\n\n<p><code>/path/to/lib/libjemalloc.so: cannot allocate memory in static TLS block</code> </p>\n\n<p>Do you have any idea of the reason for this error and hence how I could tackle this ?</p>\n"}, {"tags": ["c", "linux", "multithreading", "semaphore"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1528898744, "post_id": 50839203, "comment_id": 88682267, "body": "If you just want three things happen one after the other, don&#39;t create any threads. Threads are for things that happen one after, before, or simultaneously with the other. If you already have threads and want something in one thread to happen after something else in another thread, semaphores are the wrong tool for the job. You need condition variables."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1528915498, "post_id": 50839203, "comment_id": 88691858, "body": "@n.m. &#39;semaphores are the wrong tool for the job&#39; - no, they are one right tool, as PSkocik demonstrates in the answer."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1528916479, "post_id": 50839203, "comment_id": 88692326, "body": "@MartinJames my bad, I read semaphore and think mutex."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1528899722, "creation_date": 1528899722, "answer_id": 50839616, "question_id": 50839203, "link": "https://stackoverflow.com/questions/50839203/multithreading-printf-with-semaphores-in-c/50839616#50839616", "title": "Multithreading printf() with semaphores in c", "body": "<p>You should initialize semaphores B and C to 0 and semaphore A to 1.\nThis works:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;semaphore.h&gt;\n\nsem_t Asem;\nsem_t Bsem;\nsem_t Csem;\n\nvoid *print_WhatA(){\n    while(1){\n        sem_wait(&amp;Asem);\n        printf(\"What A \");\n        sem_post(&amp;Bsem);\n    }\n} \n\nvoid *print_Wonderful(){\n    while(1){\n        sem_wait(&amp;Bsem);\n        printf(\"Wonderful \");\n        sem_post(&amp;Csem);\n    }\n}\n\nvoid *print_World(){\n    while(1){\n        sem_wait(&amp;Csem);\n        printf(\"World!\\n\");\n        sem_post(&amp;Asem);\n    }\n}\n\nvoid main(){\n    sem_init(&amp;Asem,0,1);    //initialization of the first semaphore\n    sem_init(&amp;Bsem,0,0);    //initialization of the second semaphore\n    sem_init(&amp;Csem,0,0);    //initialization of the third semaphore\n    pthread_t A_thread;    \n    pthread_t B_thread;\n    pthread_t C_thread;\n    pthread_create(&amp;A_thread,NULL, print_WhatA,NULL);       //thread creation for print_WhatA function \n    pthread_create(&amp;B_thread,NULL, print_Wonderful,NULL);  //thread creation for print_Wonderful function\n    pthread_create(&amp;C_thread,NULL, print_World,NULL);       //thread creation for print_World function\n    pthread_join(A_thread,NULL);\n    pthread_join(B_thread,NULL);\n    pthread_join(C_thread,NULL);\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 9269308, "user_type": "registered", "profile_image": "https://graph.facebook.com/199011024012083/picture?type=large", "display_name": "Jonathan Baxevanidis", "link": "https://stackoverflow.com/users/9269308/jonathan-baxevanidis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 1, "accepted_answer_id": 50839616, "answer_count": 1, "score": 1, "last_activity_date": 1528900657, "creation_date": 1528898566, "last_edit_date": 1528900657, "question_id": 50839203, "link": "https://stackoverflow.com/questions/50839203/multithreading-printf-with-semaphores-in-c", "title": "Multithreading printf() with semaphores in c", "body": "<p>What I want to achieve is for the three separate prints to be executed one after the other, printing the message \u201cWhat a wonderful world!\u201d. What I get instead is \u201cwhat a what a what a wonderful wonderful wonderful world world world\u201d. I think there is something wrong with the pthread_join(). The program will end when the user inputs ctrl+c.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;semaphore.h&gt;\n\nsem_t Asem;\nsem_t Bsem;\nsem_t Csem;\n\nvoid *print_WhatA(){\n    while(1){\n        sem_wait(&amp;Asem);\n        printf(\"What A \");\n        sem_post(&amp;Bsem);\n    }\n} \n\nvoid *print_Wonderful(){\n    while(1){\n        sem_wait(&amp;Bsem);\n        printf(\"Wonderful \");\n        sem_post(&amp;Csem);\n    }\n}\n\nvoid *print_World(){\n    while(1){\n        sem_wait(&amp;Csem);\n        printf(\"World!\\n\");\n        sem_post(&amp;Asem);\n    }\n}\n\nvoid main(){\n    sem_init(&amp;Asem,0,0);    //initialization of the first semaphore\n    sem_init(&amp;Bsem,0,1);    //initialization of the second semaphore\n    sem_init(&amp;Csem,0,2);    //initialization of the third semaphore\n    pthread_t A_thread;    \n    pthread_t B_thread;\n    pthread_t C_thread;\n    pthread_create(&amp;A_thread,NULL, print_WhatA,NULL);       //thread creation for print_WhatA function \n    pthread_create(&amp;B_thread,NULL, print_Wonderfull,NULL);  //thread creation for print_Wonderful function\n    pthread_create(&amp;C_thread,NULL, print_World,NULL);       //thread creation for print_World function\n    pthread_join(A_thread,NULL);\n    pthread_join(B_thread,NULL);\n    pthread_join(C_thread,NULL);\n}\n</code></pre>\n"}, {"tags": ["c", "string", "merge", "line", "multiple-columns"], "comments": [{"owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "edited": false, "score": 0, "creation_date": 1528898317, "post_id": 50838896, "comment_id": 88681967, "body": "I would recommend to write a own function that splits up your line into single tokens(columns) by simply returning an string pointer within line and a length. Then use this function in your LinetoKey implementation. This reduces the complexity of the code. Test both functions separately and combined."}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1528899302, "post_id": 50838896, "comment_id": 88682650, "body": "With <code>(char *)malloc(sizeof(char));</code> you are only allocating memory for a <i>single character</i> - so you when you write more than one character to <code>col2</code> you will be writing to unallocated memory."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1528900386, "post_id": 50838896, "comment_id": 88683410, "body": "<i>&quot;The line is like &quot;hello world hello world&quot;&quot;</i> What&#39;s the expected output?"}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "reply_to_user": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1528900807, "post_id": 50838896, "comment_id": 88683724, "body": "@ZDF: If <code>c1</code> is <code>0</code> and <code>c3</code> is <code>3</code> I presume the expected output would be <code>&quot;helloworld&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1528903872, "post_id": 50840838, "comment_id": 88685726, "body": "Instead of passing <code>c1</code> and <code>c2</code>, why not pass an array containing <code>c1, c2</code>? If you are only concerned with 2 columns, then it doesn&#39;t matter, but if the number of columns you are interested in may vary, then passing an array, and the number of elements in that array would allow you to loop over the array making the column number comparisons without hardcoding tests for only 2."}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1528908692, "post_id": 50840838, "comment_id": 88688392, "body": "@DavidC.Rankin: Here is an attempt at that: <a href=\"http://codepad.org/AOjspirA\" rel=\"nofollow noreferrer\">link</a>. (Haven&#39;t posted here because it seems the OP wants something more specific.)"}], "tags": [], "owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "is_accepted": false, "score": 0, "last_activity_date": 1528904023, "last_edit_date": 1528904023, "creation_date": 1528903198, "answer_id": 50840838, "question_id": 50838896, "link": "https://stackoverflow.com/questions/50838896/merge-two-specific-columns-from-a-line-in-c-language/50840838#50840838", "title": "Merge two specific columns from a line in C language", "body": "<p>Here's a possible solution using <code>strtok()</code>. It can handle an arbitrary number of columns (increase the size of <code>buf</code> if necessary), and will still work if the order of the columns is reversed (i.e. <code>c1</code> > <code>c2</code>). The function returns <code>1</code> on success (tokens successfully merged), <code>0</code> otherwise.</p>\n\n<p>Note that <code>strtok()</code> modifies its argument - so I have copied <code>input</code> to a temporary buffer, <code>char buf[64]</code>.</p>\n\n<pre><code>/*\n * Merge space-separated 'tokens' in a string.\n * Columns are zero-indexed.\n *\n * Return: 1 on success, 0 on failure\n */\nint merge_cols(char *input, int c1, int c2, char *dest) {\n    char buf[64];\n    int col = 0;\n    char *tok = NULL, *first = NULL, *second = NULL, *tmp = NULL;\n\n    if (c1 == c2) {\n        fprintf(stderr, \"Columns can not be the same !\");\n        return 0;\n    }\n\n    if (strlen(input) &gt; sizeof(buf) - 1) return 0;\n\n    /*\n     * strtok() is _destructive_, so copy the input to\n     * a buffer.\n     */\n    strcpy(buf, input);\n\n    tok = strtok(buf, \" \");\n    while (tok) {\n        if (col == c1 || col == c2) {\n            if (!first)\n                first = tok;\n            else if (first &amp;&amp; !second)\n                second = tok;\n        }\n        if (first &amp;&amp; second) break;\n        tok = strtok(NULL, \" \");\n        col++;\n    }\n    // In case order of columns is swapped ...\n    if (c1 &gt; c2) {\n        tmp = second;\n        second = first;\n        first = tmp;\n    }\n    if (first) strcpy(dest, first);\n    if (second) strcat(dest, second);\n\n    return first &amp;&amp; second;\n}\n</code></pre>\n\n<p>Sample usage:</p>\n\n<pre><code>char *input = \"one two three four five six seven eight\";\nchar dest[128];\n\n// The columns can be reversed ...\nint merged = merge_cols(input, 7, 1, dest);\nif (merged)\n    puts(dest);\n</code></pre>\n\n<p>Note also that it is very easy to use different delimiters when using <code>strtok()</code> - so if you wanted to use comma- or tab-separated input instead of spaces, you just change the second argument when calling it.</p>\n"}, {"tags": [], "owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "is_accepted": false, "score": 0, "last_activity_date": 1528980264, "creation_date": 1528980264, "answer_id": 50857876, "question_id": 50838896, "link": "https://stackoverflow.com/questions/50838896/merge-two-specific-columns-from-a-line-in-c-language/50857876#50857876", "title": "Merge two specific columns from a line in C language", "body": "<p>It is not clear what you're trying to do. If what David Collins suggested is what you're looking for - word concatenation by word index - here's a starting point (<a href=\"https://ideone.com/0uKTLe\" rel=\"nofollow noreferrer\">demo</a>):</p>\n\n<ul>\n<li>Your function must <strong>minimize the number of string traversals</strong>. To help this, the code below is using <code>char**</code> instead of <code>char*</code> (sort of \"char streams\").</li>\n<li>The function must be able to <strong>count the number of characters the result will have</strong>, prior to actual concatenation, in order to be able to allocate the destination string on free store. If <code>catwords</code> is called with null destination, it only counts the length of the result string. </li>\n</ul>\n\n<p>Regarding the actual implementation, you will have to traverse the string <strong>word by word</strong> and decide whether to <strong>copy</strong> or <strong>skip</strong> the word. See the code below for the following functions:</p>\n\n<ul>\n<li><code>nextword</code> - skips white-spaces until it finds a non-white-space character.</li>\n<li><code>copyword</code> - copies the current word if destination is valid or skips it if not. It returns the number of copied/skipped characters.</li>\n</ul>\n\n<p><br></p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid nextword( const char** ps )\n{\n  while ( **ps &amp;&amp; isspace( **ps ) )\n    ++*ps;\n}\n\nint copyword( char** const pd, const char** ps )\n{\n  // remember the starting point\n  const char* b = *ps;\n\n  // actual copy\n  if ( pd &amp;&amp; *pd ) while ( **ps &amp;&amp; !isspace( **ps ) )\n    *( *pd )++ = *( *ps )++;\n\n  // skip the word (no destination)\n  else while ( **ps &amp;&amp; !isspace( **ps ) )\n    ( *ps )++;\n\n  // return the length\n  return *ps - b;\n}\n\nint catwords( char* d, const char* s, const int* c )\n{\n  int len = 0;\n  int iw = 0;\n  int ic = 0;\n  const char** ps = &amp;s;\n  char** pd = &amp;d;\n\n  for ( nextword( ps ); **ps &amp;&amp; c[ ic ] &gt; -1; nextword( ps ), ++iw )\n    if ( iw == c[ ic ] )\n    {\n      len += copyword( pd, ps );\n      ++ic;\n    }\n    else\n    {\n      copyword( 0, ps ); // just skip the current word\n    }\n\n  if ( d )\n    **pd = '\\0';\n\n  return len;\n}\n\nint main()\n{\n  // static buffer test\n  {\n    char d[ 1024 ];\n    int t[] = { 0, 3, -1 };\n    catwords( d, \"Hello world. Hello world!\", t );\n    puts( d );\n  }\n\n  // dynamic buffer test\n  {\n    const char* s = \"The greatness of a man is not in how much wealth he acquires, but in his integrity and his ability to affect those around him positively.\";\n    int t[] = { 1, 5, 16, -1 };\n    int dstcharcount = catwords( 0, s, t ) + 1;\n    char* d = (char*)malloc( dstcharcount * sizeof( char ) );\n    catwords( d, s, t );\n    puts( d );\n    free( d );\n  }\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9936326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a934a0590f8fc2d875af4068699017?s=128&d=identicon&r=PG&f=1", "display_name": "H-J. Zhang", "link": "https://stackoverflow.com/users/9936326/h-j-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528980264, "creation_date": 1528897658, "question_id": 50838896, "link": "https://stackoverflow.com/questions/50838896/merge-two-specific-columns-from-a-line-in-c-language", "title": "Merge two specific columns from a line in C language", "body": "<p>I want to merge two specific columns from a line in C language. The line is like \"hello world  hello world\". It consists of some words and some white space. The below is my code. In this function, c1 and c2 represent the number of the column, and array key is mergeed string. But it's not good to run.</p>\n\n<pre><code>char *LinetoKey(char *line, int c1, int c2, char key[COLSIZE]){\n    char *col2 = (char *)malloc(sizeof(char));\n    while (*line != '\\0' &amp;&amp; isspace(*line) )\n        line++;\n    while(*line != '\\0' &amp;&amp; c1 != 0){\n        if(isspace(*line)){\n            while(*line != '\\0' &amp;&amp; isspace(*line))\n                line++;\n            c1--;\n            c2--;\n        }else\n            line++;\n    }\n    while (*line != '\\0' &amp;&amp; *line != '\\n' &amp;&amp; (isspace(*line)==0))\n        *key++ = *line++;\n    *key = '\\0';\n    while(*line != '\\0' &amp;&amp; c2 != 0){\n        if(isspace(*line)){\n            while(*line != '\\0' &amp;&amp; isspace(*line))\n                line++;\n            c2--;\n        }else\n            line++;\n    }\n    while (*line != '\\0' &amp;&amp; *line != '\\n' &amp;&amp; isspace(*line)==0)\n        *col2++ = *line++;\n    *col2 = '\\0';\n    strcat(key,col2);\n    return key;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "edited": false, "score": 0, "creation_date": 1528897167, "post_id": 50838615, "comment_id": 88681182, "body": "Please note that you have some typos in your post. Also, you don&#39;t need to cast the output of malloc."}, {"owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "edited": false, "score": 0, "creation_date": 1528897255, "post_id": 50838615, "comment_id": 88681234, "body": "See: <a href=\"https://stackoverflow.com/questions/8164000/how-to-dynamically-allocate-memory-space-for-a-string-and-get-that-string-from-u\" title=\"how to dynamically allocate memory space for a string and get that string from u\">stackoverflow.com/questions/8164000/&hellip;</a>"}, {"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "edited": false, "score": 0, "creation_date": 1528897287, "post_id": 50838615, "comment_id": 88681249, "body": "I saw you corrected the typos. I don&#39;t understand what you want to do. Can you post the actual code where the problem is? In your first two malloc&#39;s you are getting memory blocks of the size of 1 char only, and I assume that is not what you want. In the third malloc, you actually reserve a bigger block of memory, that might be the reason why whatever you are doing works on that case."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1528897332, "post_id": 50838615, "comment_id": 88681279, "body": "Show us the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1528897826, "post_id": 50838615, "comment_id": 88681610, "body": "@Lundin Not to mention another one about <i>strings</i>."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1528897858, "post_id": 50838615, "comment_id": 88681632, "body": "I just edited my post putting the code that works, I commented the other malloc declaration which doesnt perfectly works."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1528898663, "post_id": 50838615, "comment_id": 88682212, "body": "You should not change the content of the question that heavily, by removing the problem you have from the question and replacing it with the solution all answers get wrong, because they do reference a now non existent problem. Please rollback to the last revision."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1528899206, "post_id": 50838875, "comment_id": 88682584, "body": "Thank you man, really, just one quesiton, what does this assignament do? *str3 = 0x0;"}, {"owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "reply_to_user": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1528899299, "post_id": 50838875, "comment_id": 88682648, "body": "@GeneNight That <code>*str3 = 0x0</code> makes the first byte of <code>str3</code> a <code>NULL</code> byte (the indicator of end of string). Since you will be using <code>strcat</code>, you need this (because malloc most likely will return a chunk of memory that contains garbage in it). It is similar to do <code>str3[0] = 0x0</code> or <code>str3[0] = &#39;\\0&#39;</code>."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1528899578, "post_id": 50838875, "comment_id": 88682860, "body": "That really explains everything, thank you very much the answers, I have no more doubts."}], "tags": [], "owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "is_accepted": false, "score": 3, "last_activity_date": 1528898785, "last_edit_date": 1528898785, "creation_date": 1528897610, "answer_id": 50838875, "question_id": 50838615, "link": "https://stackoverflow.com/questions/50838615/how-to-declare-a-dynamic-array-of-char-in-c/50838875#50838875", "title": "How to declare a dynamic array of char in c", "body": "<p>To get some memory to your string, you have to tell <code>malloc</code> how many bytes of memory you want. <code>sizeof(char)</code> returns <code>1</code>, therefore, you'll only have 1 byte. In C, strings are terminated by the <code>NULL</code> byte (<code>\\0</code>), and <code>printf</code> and others will print until they find that <code>NULL</code> terminator. </p>\n\n<p>If you do something like this:</p>\n\n<pre><code>char *str = malloc(1);\n*str = 'a';\nprintf(\"%s\", str);\n</code></pre>\n\n<p>You will probably get a very strange output, since you have no <code>NULL</code> terminator. </p>\n\n<p>When you use the <code>unsigned x; str = malloc(x);</code>, it's actually undefined how many bytes you have, since that <code>x</code> variable is not initialized.</p>\n\n<p>Since your question is very unclear, what I can tell you (from what <em>I think</em> you're asking) is how to actually get space for a string of 63 characters plus the <code>NULL</code> terminating byte.</p>\n\n<pre><code>char *str = malloc(64);\nstrcpy(str, \"Stack Overflow\");\nprintf(\"%s\", str);\n</code></pre>\n\n<p>That will do it. </p>\n\n<p>Also note that the memory block returned by <code>malloc</code> will not be zeroed, therefore you can't possibly know what's in it (that could be the reason you're getting garbage when you're printing).</p>\n\n<p><strong>I recommend you read about memory allocation in a good C book or in <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow noreferrer\">Wikipedia</a>...</strong></p>\n\n<hr>\n\n<h2>After your edit and \"MCVE\"</h2>\n\n<p>I made some edits to what I think it is you want. The modifications are explained in the comments of the source. Let me know if you have any doubts.</p>\n\n<pre><code>#include &lt;stdio.h&gt;  /* printf */\n#include &lt;stdlib.h&gt; /* malloc, free, realloc */\n#include &lt;string.h&gt; /* strcat */\n#include &lt;ctype.h&gt;  /* isalnum */\n#include &lt;conio.h&gt;  /* getch */\n\nint main(void)\n{\n    char add[2];\n    char str2[200];\n    char c;\n    int temp = -1;\n    int num = 0;\n    char *str3;\n\n    /* I just think 'count' is an int, since you didn't put it in the code, \n     * I also deduced that @count will be used as the length of @str3 \n     */\n    int count;\n\n    /* Here, count is not initialized, so you MUST initialize it in order \n     * to call malloc with it! Since it seems you want to add character by\n     * character using realloc, then we just malloc() 2 bytes - 1 for a \n     * character and one for the NULL terminator.\n     */\n    count = 2;\n    str3 = malloc(count);\n\n    /* You will be using @strcat to append strings to @str3, so you need\n     * to put a NULL terminator in it, because strcat will look for that\n     * NULL byte to find where it should append\n     */\n    *str3 = 0x0;\n\n    while((c = getch()) != '\\r') {\n        for (int i = 0;i &lt; 200; i++) {\n            if (str2[i] =='\\0') {\n                num = i;\n                break;\n            }\n        }\n\n        if ((temp == -32) || (temp == 0)) {\n            /* empty */ \n        } else {\n            if(isalnum((char)c) == 0)\n            {\n                if((c == '\\'') || (c == -118) || (c == -115) || (c == -107) || (c == -123) || (c == -105)|| (c == 32))\n                {\n                    /* this is not the optimal way of using realloc, because\n                     * you should first check for errors, but will do for\n                     * this example.\n                     * You must assign the returned value of realloc to str3. \n                     *\n                     * Also, since @count contains the length\n                     * of @str3, you need to increment it.\n                     */\n                    str3 = realloc(str3, ++count);\n                    printf(\"true: %c\\n\",c);\n                    add[1] = '\\0';\n                    add[0] = c;\n                    strcat(str3,add);\n                    strcat(str2,add);\n                    printf(\"str2: %s\\n\",str2);\n                    printf(\"str3: %s\\n\",str3);\n                } else if (c == 8) {\n                    printf(\"Deleting something...\\n\");\n                }\n            } else {\n                /* see notes above on realloc */\n                str3 = realloc(str3, ++count);\n                printf(\"true: %c\\n\",c);\n                add[1] = '\\0';\n                add[0] = c;\n                strcat(str3,add);\n                strcat(str2,add);\n                printf(\"str2: %s\\n\",str2);\n                printf(\"str3: %s\\n\",str3);\n            }\n        }\n        printf(\"ASCII Code: %d\\n\",c);\n        temp = c;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1528897697, "creation_date": 1528897697, "answer_id": 50838907, "question_id": 50838615, "link": "https://stackoverflow.com/questions/50838615/how-to-declare-a-dynamic-array-of-char-in-c/50838907#50838907", "title": "How to declare a dynamic array of char in c", "body": "<p>In the first two cases, you are only allocating enough space for a single <code>char</code>.  If you attempt to write more than one to that block of memory, you'll write past the end of the memory that was allocated for you.  Doing so invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, which in this case manifests as printing strange characters.</p>\n\n<p>In the third case, you allocate <code>x</code> bytes of memory, however <code>x</code> is uninitialized and has an indeterminate value.  Reading an indeterminate value is also undefined behavior.  In this case it happens to work because the indeterminate value happens to be a valid value and is large enough to hold the string you want, however you can't depend on that behavior.</p>\n\n<p>You need to allocate a byte for every character that you'll need, plus 1 for the terminating null byte that ends a string in C.</p>\n"}, {"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1528897757, "creation_date": 1528897757, "answer_id": 50838928, "question_id": 50838615, "link": "https://stackoverflow.com/questions/50838615/how-to-declare-a-dynamic-array-of-char-in-c/50838928#50838928", "title": "How to declare a dynamic array of char in c", "body": "<p>Note that the first allocation, this one</p>\n\n<pre><code>str = malloc(sizeof(char));\n</code></pre>\n\n<p>is exactly equivalent to<sup>1</sup></p>\n\n<pre><code>str = malloc(1);\n</code></pre>\n\n<p>so you don't have room except for one character which is a problem, because it only represents an empty string.</p>\n\n<p>If you allocate this much space you will very likely access memory out of the allocated space, causing <em>undefined</em> and unpredictable behavior. You need to understand what a string in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> is,</p>\n\n<ul>\n<li><em>A string in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> is a sequence of non-null characters followed by a null character, so for a string with N characters you need N + 1 array elements (for ascii this equals bytes)</em></li>\n</ul>\n\n<p>According to that definition of <em>string</em> if you wanted to store the string <code>\"Hello\"</code> you would need at least the following code</p>\n\n<pre><code>char *str = malloc(6);\nif (str != NULL) {\n    str[0] = 'H';\n    str[1] = 'e';\n    str[2] = 'l';\n    str[3] = 'l';\n    str[4] = 'o';\n    str[5] = '\\0'; // Or equivalently str[5] = 0;\n}\n</code></pre>\n\n<p>as you can see, the last character being <code>'\\0'</code> or <code>0</code> &mdash; <em>which is the same</em> &mdash; is very important.</p>\n\n<p>All the functions in the standard library of <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> which expect a string parameter expect that there is the <em>null</em> terminator. For instance <code>strlen()</code> will count characters until it reaches the <code>'\\0'</code>, if it's not there then you can't predict where it is going to stop counting, this causing <em>undefined behavior</em>.</p>\n\n<hr>\n\n<p><sup>1</sup><sub><code>sizeof(char)</code> is as defined by the <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> standard always equal to one.</sub></p>\n"}], "owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1528898785, "creation_date": 1528896859, "last_edit_date": 1528897797, "question_id": 50838615, "link": "https://stackoverflow.com/questions/50838615/how-to-declare-a-dynamic-array-of-char-in-c", "title": "How to declare a dynamic array of char in c", "body": "<p>I'm trying to declare an array of <code>char</code> dynamically, what I need to do is adding the newest character to the string which works fine, the problem is that when I try to print it out, at the beginning of the string there are some unknown characters.</p>\n\n<pre><code>char add[2];\nchar str2[200];\nchar c;\nint temp = -1;\nint num = 0;\nchar *str3;\nstr3 = malloc( (size_t)count ); //str3 = malloc(sizeof(char)) not working\nwhile((c= getch()) !='\\r')\n{\n    for (int i = 0;i&lt;200;i++)\n    {\n        if (str2[i] =='\\0')\n        {\n            num = i;\n            break;\n        }\n    }\n    //printf(\"Num: %d\\n\",num);\n\n    if ((temp == -32) || (temp == 0))\n    {\n    }\n    else\n    {\n        if(isalnum((char)c) == 0)\n        {\n            if((c == '\\'') || (c == -118) || (c == -115) || (c == -107) || (c == -123) || (c == -105)|| (c == 32))\n            {\n                realloc(str3,sizeof(char)+2);\n                printf(\"true: %c\\n\",c);\n                //realloc(str2,sizeof(char)+1);\n                add[1] = '\\0';\n                add[0] = c;\n                strcat(str3,add);\n                strcat(str2,add);\n                printf(\"%s\\n\",str2);\n                printf(\"%s\\n\",str3);\n            }\n            else if (c == 8)\n            {\n                printf(\"Deleting something...\\n\");\n            }\n        }\n        else\n        {\n            realloc(str3,sizeof(char)+2);\n            printf(\"true: %c\\n\",c);\n            //realloc(str2,sizeof(char)+1);\n            add[1] = '\\0';\n            add[0] = c;\n            strcat(str3,add);\n            strcat(str2,add);\n            printf(\"%s\\n\",str2);\n            printf(\"%s\\n\",str3);\n        }\n    }\n    printf(\"ASCII Code: %d\\n\",c);\n    temp = c;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1528897055, "post_id": 50838571, "comment_id": 88681103, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope\">Can a local variable&#39;s memory be accessed outside its scope?</a>"}, {"owner": {"reputation": 966, "user_id": 1386127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/01cef9fb064e908463d83e6cb1f08cf8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumen", "link": "https://stackoverflow.com/users/1386127/soumen"}, "edited": false, "score": 2, "creation_date": 1528897250, "post_id": 50838571, "comment_id": 88681231, "body": "That&#39;s because latt is a stack variable. You should not return the address of a stack variable from a function"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1528897263, "post_id": 50838571, "comment_id": 88681239, "body": "Because your create function doesn&#39;t allocate the structure."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1528897422, "post_id": 50838571, "comment_id": 88681341, "body": "In addition to the local variable issue, you shouldn&#39;t allocate 2D arrays this way. See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>."}, {"owner": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528898126, "post_id": 50838571, "comment_id": 88681820, "body": "@SanderDeDycker My problem was that I didn&#39;t realise that I still have stuff in local scope (the length variable), so it isn&#39;t quite a duplicate I feel. Although for people not interested in this specific code it will probably be the same issue as the other post, not sure what the guidelines are for duplicated stuff in this case!"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1528898958, "post_id": 50838571, "comment_id": 88682425, "body": "@DanielJ : me marking as duplicate does not mean you shouldn&#39;t have asked the question (you couldn&#39;t have known there was another question addressing the cause of your problem since you didn&#39;t know what the cause was). It&#39;s rather intended for future viewers of this question as you yourself indicated. Or to put it differently : in this case, the question isn&#39;t a duplicate, but the answer is."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1528899267, "post_id": 50838571, "comment_id": 88682621, "body": "Unrelated to your problem, but instead of looping through every element and zeroing them, you can just use <code>calloc</code> instead of <code>malloc</code> when allocating space."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "edited": false, "score": 0, "creation_date": 1528897397, "post_id": 50838734, "comment_id": 88681321, "body": "Thanks! So would using malloc to assign memory for everything in the struct solve my issue?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "edited": false, "score": 0, "creation_date": 1528898448, "post_id": 50838734, "comment_id": 88682050, "body": "@DanielJ You can either <code>malloc()</code> the structure and return a pointer to it, or you can return the structure itself."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 2, "last_activity_date": 1528897194, "creation_date": 1528897194, "answer_id": 50838734, "question_id": 50838571, "link": "https://stackoverflow.com/questions/50838571/c-moving-free-statements-into-separate-function-causes-memory-leak/50838734#50838734", "title": "C: Moving free statements into separate function causes memory leak", "body": "<p>Your <code>Create()</code> function returns the address of a local variable:</p>\n\n<pre><code>struct Lattice* Create(int size){\n    struct Lattice latt;  // this is a local variable - it only exists\n                          // as long as the function Create() is running\n    int i,j,k,l;\n\n    latt.length = size;\n    latt.latt = malloc(sizeof(int*) * latt.length);\n\n    for(i=0; i&lt;latt.length; i++){\n        latt.latt[i] = malloc(sizeof(int) * latt.length);\n    }\n\n        for(j=0; j&lt;latt.length; j++){\n            for(k=0; k&lt;latt.length; k++){\n                latt.latt[j][k] = 0;\n            }\n        }\n\n    struct Lattice* lattp = &amp;latt;  // this takes the address of a local variable\n    return lattp; // after this return, latt no longer exists\n}\n</code></pre>\n\n<p>This is <a href=\"https://stackoverflow.com/questions/367633/what-are-all-the-common-undefined-behaviours-that-a-c-programmer-should-know-a\">undefined behavior</a>.</p>\n"}], "owner": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528897194, "creation_date": 1528896723, "question_id": 50838571, "link": "https://stackoverflow.com/questions/50838571/c-moving-free-statements-into-separate-function-causes-memory-leak", "title": "C: Moving free statements into separate function causes memory leak", "body": "<p>I have the following structure and initialisation of it in a C file:</p>\n\n<pre><code>struct Lattice {\n    int length;\n    int** latt;\n};\n\nstruct Lattice* Create(int size){\n    struct Lattice latt;\n    int i,j,k,l;\n\n    latt.length = size;\n    latt.latt = malloc(sizeof(int*) * latt.length);\n\n    for(i=0; i&lt;latt.length; i++){\n        latt.latt[i] = malloc(sizeof(int) * latt.length);\n    }\n\n        for(j=0; j&lt;latt.length; j++){\n            for(k=0; k&lt;latt.length; k++){\n                latt.latt[j][k] = 0;\n            }\n        }\n\n    struct Lattice* lattp = &amp;latt;\n    return lattp;\n</code></pre>\n\n<p>And I also have the memory freeing function:</p>\n\n<pre><code>void Destroy(struct Lattice* lattp){\n    int l;\n    for (l=0; l&lt;(lattp-&gt;length); l++){\n        free(lattp-&gt;latt[l]);\n    }\n    free(lattp-&gt;latt);\n}\n</code></pre>\n\n<p>But whenever I run the code:</p>\n\n<pre><code>int main(){\n    struct Lattice* lattp = Create(5);\n    Destroy(lattp);\n\n    return 0;\n}\n</code></pre>\n\n<p>I get a memory leak (according to Valgrind it is 40 bytes definitely lost and a further 80 indirectly lost, if this makes any difference). </p>\n\n<p>But if I have identical code except that I write the free statements, which are identical to the ones in Destroy, into Create (and modify the return statements appropriately), I don't get a memory leak. Why does moving the free statements into a separate function cause a memory leak?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 4, "creation_date": 1528896234, "post_id": 50838379, "comment_id": 88680529, "body": "i am not sure if i understand this correct, can you provide proper example code? to me this sounds like a &quot;just do that right in front of the loop&quot; problem"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 4, "creation_date": 1528896253, "post_id": 50838379, "comment_id": 88680544, "body": "Do you mean every first iteration for a loop or just once in the whole program run?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528896538, "post_id": 50838379, "comment_id": 88680754, "body": "What do you mean by &quot;first execution&quot;? How many executions will there be? Executions of what? The whole program? A function? The body of a loop?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1528896587, "post_id": 50838379, "comment_id": 88680782, "body": "Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might be helpful for making this questions clearer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1528902162, "post_id": 50838379, "comment_id": 88684642, "body": "On a typical bare metal system, you put the variable inside whatever.c, create a function whatever_init that sets the variable, make the function available through whatever.h and then call that function once from main, before you hit the eternal loop."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1528906571, "post_id": 50838379, "comment_id": 88687307, "body": "Your question is really unclear.  Why not just initialize <code>text</code> to <code>NULL</code> when it is defined?"}], "answers": [{"tags": [], "owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1528897038, "last_edit_date": 1528897038, "creation_date": 1528896709, "answer_id": 50838567, "question_id": 50838379, "link": "https://stackoverflow.com/questions/50838379/execute-only-for-first-iteration/50838567#50838567", "title": "execute only for first iteration", "body": "<p>Completly without context the following is a way to implement this. But there might be better ways depending on the circumstances.</p>\n\n<p>To execute a certain bit of code only once in the lifetime of the process, I usually use a construct like this. </p>\n\n<pre><code>static int first_time = 1; // create and initiallize to 1\nif (first_time) // equal to first_time != 0\n{\n  text = NULL;\n  first_time = 0;\n}\n</code></pre>\n\n<p>This creates a variable with static storage duration which is initilized to <code>1</code> the first time the code is reached. From that point on this variable is present in the corresponding function ( it will not be deleted at the end of the function) and the value only changes with a normal assignment. The initialisation will be skipped in all but the first call, because the variable already exists. </p>\n\n<p>This way you can check whether or not a certain part of the code got executed.</p>\n\n<p>For more information see <a href=\"https://stackoverflow.com/questions/572547/what-does-static-mean-in-c\">this</a></p>\n"}, {"tags": [], "owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "is_accepted": false, "score": -1, "last_activity_date": 1528905352, "creation_date": 1528905352, "answer_id": 50841517, "question_id": 50838379, "link": "https://stackoverflow.com/questions/50838379/execute-only-for-first-iteration/50841517#50841517", "title": "execute only for first iteration", "body": "<p>It's rather unclear exactly what you are looking for, but the other answer covers how to execute your text=NULL line only once on first call of a repeating process and never again.  If you're looking to run a process only once upon startup of the microprocessor you can perform it in main() before you begin your repeating while(1) loop.</p>\n\n<p>I.E.</p>\n\n<pre><code>int main(void){\n/*Perform one-time on boot initializations here*/\ntext = NULL;\n     while(1){\n          /*Repeating code here*/\n     }\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7836927, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5b281d1296488a9f8d122a44585b419c?s=128&d=identicon&r=PG&f=1", "display_name": "Shreevatsa Y S", "link": "https://stackoverflow.com/users/7836927/shreevatsa-y-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1529175776, "creation_date": 1528896151, "last_edit_date": 1529175776, "question_id": 50838379, "link": "https://stackoverflow.com/questions/50838379/execute-only-for-first-iteration", "title": "execute only for first iteration", "body": "<p>I am facing a problem in the pure embedded c, thats with my logic. There exists a variable <strong>text</strong>. I am clearing it in one place using</p>\n\n<pre><code>text = NULL;\n</code></pre>\n\n<p>but this code must be executed only once that too when the first time execution comes to this place. </p>\n\n<p>Please suggest me with the best logic to implement other than using of a flag variable </p>\n"}, {"tags": ["c", "sdl"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1528895979, "post_id": 50837849, "comment_id": 88680336, "body": "Its probably not theoretical, but it&#39;s also certainly not easy to find in the documentation.  Have you poured through the <i><a href=\"http://wiki.libsdl.org/SDL_Rect\" rel=\"nofollow noreferrer\">wiki pages</a></i>?"}, {"owner": {"reputation": 13, "user_id": 9906811, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ah7ECTat1rw/AAAAAAAAAAI/AAAAAAAAB4c/K6vSDEcWrfk/photo.jpg?sz=128", "display_name": "Charles Leroy", "link": "https://stackoverflow.com/users/9906811/charles-leroy"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1528908675, "post_id": 50837849, "comment_id": 88688381, "body": "@ryyker SDL&#39;s Wiki is not really helpful, I think I&#39;ll die if read it one more time XD"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1528911264, "post_id": 50837849, "comment_id": 88689766, "body": "@CharlesLeroy wiki is surely easier to understand than this question. I&#39;ve read it 3 times and I&#39;m still not sure what question is. Blit takes two rects - source and destination - each relative to their surfaces."}, {"owner": {"reputation": 13, "user_id": 9906811, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ah7ECTat1rw/AAAAAAAAAAI/AAAAAAAAB4c/K6vSDEcWrfk/photo.jpg?sz=128", "display_name": "Charles Leroy", "link": "https://stackoverflow.com/users/9906811/charles-leroy"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1528911668, "post_id": 50837849, "comment_id": 88689973, "body": "@keltar, well I can&#39;t see in the rect wiki where is the info saying that the retcs are relative to their surfaces, can you make it as a response ?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1528916780, "post_id": 50837849, "comment_id": 88692458, "body": "Read through the tutorial I have linked below, and it&#39;s predecessor <i><a href=\"http://www.sdltutorials.com/sdl-tutorial-basics\" rel=\"nofollow noreferrer\">SDL Basics</a></i>.  This is a very good accompaniment to the wiki pages, and should help to clear up your questions."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9906811, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ah7ECTat1rw/AAAAAAAAAAI/AAAAAAAAB4c/K6vSDEcWrfk/photo.jpg?sz=128", "display_name": "Charles Leroy", "link": "https://stackoverflow.com/users/9906811/charles-leroy"}, "edited": false, "score": 0, "creation_date": 1528921887, "post_id": 50843820, "comment_id": 88695123, "body": "I&#39;m learning SDL with 1.2 not 2.0, SDL_CreateWindow is only on 2.0 according to the exemple of the wiki"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 13, "user_id": 9906811, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ah7ECTat1rw/AAAAAAAAAAI/AAAAAAAAB4c/K6vSDEcWrfk/photo.jpg?sz=128", "display_name": "Charles Leroy", "link": "https://stackoverflow.com/users/9906811/charles-leroy"}, "edited": false, "score": 0, "creation_date": 1528922249, "post_id": 50843820, "comment_id": 88695295, "body": "Its <i><a href=\"https://www.libsdl.org/license.php\" rel=\"nofollow noreferrer\">open source</a></i>.  Is there a reason you are choosing not to use the most current version?  But given you cannot, then I have not really answered your question, and you should de-select the accepted check so others will not be discouraged from seeing if they can help."}, {"owner": {"reputation": 13, "user_id": 9906811, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ah7ECTat1rw/AAAAAAAAAAI/AAAAAAAAB4c/K6vSDEcWrfk/photo.jpg?sz=128", "display_name": "Charles Leroy", "link": "https://stackoverflow.com/users/9906811/charles-leroy"}, "edited": false, "score": 0, "creation_date": 1528922430, "post_id": 50843820, "comment_id": 88695388, "body": "yeah the MOOC I&#39;m following is based on SDL1.2 and C. The next one is C++ and Qt."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1528917462, "last_edit_date": 1528917462, "creation_date": 1528914069, "answer_id": 50843820, "question_id": 50837849, "link": "https://stackoverflow.com/questions/50837849/sdl-relative-position/50843820#50843820", "title": "SDL Relative Position", "body": "<p>You may be making some wrong assumptions about the relative positions of your cursors.  There is a very good, and detailed set of tutorials at the linked location that may clear things up for you...  </p>\n\n<p>From <em><a href=\"http://www.sdltutorials.com/sdl-coordinates-and-blitting\" rel=\"nofollow noreferrer\">HERE</a></em>...  </p>\n\n<blockquote>\n  <p>Using the first tutorial as our base, we'll delve more into the world\n  of SDL surfaces. As I attempted to explain in the last lesson, SDL\n  Surfaces are basically images stored in memory. Imagine we have a\n  blank 320x240 pixel surface. Illustrating the SDL coordinate system,\n  we have something like this:  </p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/lQFAZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lQFAZ.jpg\" alt=\"enter image description here\"></a>  </p>\n\n<blockquote>\n  <p>This coordinate system is quite different than the normal one you are\n  familiar with. Notice how the Y coordinate increases going down, and\n  the X coordinate increases going right. Understanding the SDL\n  coordinate system is important in order to properly draw images on the\n  screen.  </p>\n</blockquote>\n\n<p>Some additional terms that may help clarify:  </p>\n\n<p><em><a href=\"https://wiki.libsdl.org/SDL_CreateWindow\" rel=\"nofollow noreferrer\">SDL Window</a></em> : You can think of this as physical pixels, or <em>your monitor</em>.<br>\n<em><a href=\"https://wiki.libsdl.org/SDL_Renderer\" rel=\"nofollow noreferrer\">SDL Renderer</a></em> : Controls the properties/settings of what is created in that window.</p>\n"}], "owner": {"reputation": 13, "user_id": 9906811, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ah7ECTat1rw/AAAAAAAAAAI/AAAAAAAAB4c/K6vSDEcWrfk/photo.jpg?sz=128", "display_name": "Charles Leroy", "link": "https://stackoverflow.com/users/9906811/charles-leroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528917462, "creation_date": 1528894525, "last_edit_date": 1528899669, "question_id": 50837849, "link": "https://stackoverflow.com/questions/50837849/sdl-relative-position", "title": "SDL Relative Position", "body": "<p>I have a theoretical question about SDL' Surface cursor.\nIf I want to display surface_A on my screen I'll use a cursor created with <code>SDL_Rect cursor;</code> and I'll use it with <code>SDL_BlitSurface();</code>.\nThe cursor will contain a position relative to the top-left corner of my window.</p>\n\n<p>But if I want to display surface_B inside surface_A, do I have to indicate a cursor relative the top-left corner of my window or the top-left corner of surface_A ?</p>\n"}, {"tags": ["c++", "c", "signal-processing", "fft", "correlation"], "comments": [{"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 1, "creation_date": 1528894687, "post_id": 50837658, "comment_id": 88679455, "body": "<code>storage[windowSize+1] </code> is the second element of the next window"}, {"owner": {"reputation": 33, "user_id": 9935966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df750ba0507e5e1b15629a35596da778?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9935966/stefano"}, "reply_to_user": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1528896559, "post_id": 50837658, "comment_id": 88680768, "body": "Hi @doug you&#39;re right. However, this is just an example of a possible cross-correlation I would like to compute, namely  between the first element of the first window and the second one of the next window"}, {"owner": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1528897289, "post_id": 50837658, "comment_id": 88681251, "body": "Could it be that you are looking for <a href=\"https://en.wikipedia.org/wiki/Cross-correlation#Zero-normalized_cross-correlation_(ZNCC)\" rel=\"nofollow noreferrer\">normalized cross-correlation</a> ? This is generally closer to what I would expect in physics, a value in <code>[-1, 1]</code> instead of arbitrarily large. I&#39;m not versed in any way in signal processing, though, so I simply don&#39;t know what the unnormalized correlation is good for."}, {"owner": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1528897416, "post_id": 50837658, "comment_id": 88681337, "body": "Oh, also, shouldn&#39;t it be the SUM of multiplication between fourier terms? Something like <code>cor[n] = SUM( storage[m] * conj(storage(windowSize+m+n)))</code> ?"}, {"owner": {"reputation": 33, "user_id": 9935966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df750ba0507e5e1b15629a35596da778?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9935966/stefano"}, "reply_to_user": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1528898277, "post_id": 50837658, "comment_id": 88681935, "body": "Hi @GeckoGeorge ,  normalized cross-correlation is exactly what I want. I did not try as you said, summing up all the contributions, I am going to see"}], "answers": [{"tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": false, "score": 1, "last_activity_date": 1528914470, "creation_date": 1528914470, "answer_id": 50843917, "question_id": 50837658, "link": "https://stackoverflow.com/questions/50837658/fftw3-compute-cross-correlation-in-the-same-signal/50843917#50843917", "title": "FFTW3 compute cross-correlation in the same signal", "body": "<p>The line <code>storage[counter] = creal(fft_result[i]) + cimag(fft_result[i]);</code> makes storage purely real. Since computing <code>correlation = storage[0]*conj(storage[windowSize+1]);</code> is the next step in the computation of the cross correlation, there is a problem. Indeed, there is no point in conjugating a real number.</p>\n\n<p>Trying <code>storage[counter] = fft_result[i];</code> could partly resolve the issue.\nIn addition, <code>correlation = storage[0]*conj(storage[windowSize+1]);</code> should be modified to <code>correlation = storage[0]*conj(storage[windowSize]);</code></p>\n\n<p>By performing <code>correlation = storage[0]*conj(storage[windowSize]);</code>, the magnitude of index [0] of the DFT of the correlation is obtained. Indeed, <code>storage[0]</code> corresponds to the average of the first frame, while <code>storage[windowSize]</code> corresponds to the average of the second frame. It is not equal to the averages, but much larger, as it is scaled by the length of the frame <code>windowSize</code>.</p>\n\n<p>To compute the correlation between the two signals, the next step should be:</p>\n\n<pre><code>for (i=0; i&lt;windowSize;i++)\n{\n    dftofcorrelation[i]=storage[i]*conj(storage[i+windowSize]\n}\n</code></pre>\n\n<p>Then, the inverse DFT must be applied to the array <code>dftofcorrelation</code> to get the correlation as an array. It must be kept in mind that neither the forward nor the backward DFT of FFTW include any scaling, see <a href=\"http://www.fftw.org/fftw3_doc/The-1d-Discrete-Fourier-Transform-_0028DFT_0029.html#The-1d-Discrete-Fourier-Transform-_0028DFT_0029\" rel=\"nofollow noreferrer\">what FFTW really computes</a>:</p>\n\n<pre><code>fftw_execute(plan_backward);\n</code></pre>\n\n<p>If two scalars are to be retained of this correlation array, it's its maximum (high if the signal are similar up to a delay) and the index of the maximum, that is the estimated time offset between the two signals.</p>\n\n<p>The overall scaling induced by FFTW is a power of <code>windowSize</code> (windowSize^3?). It can be checked by computing the autocorrelation of a uniform signal (which is uniform).</p>\n"}], "owner": {"reputation": 33, "user_id": 9935966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df750ba0507e5e1b15629a35596da778?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9935966/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528914470, "creation_date": 1528893929, "last_edit_date": 1528896484, "question_id": 50837658, "link": "https://stackoverflow.com/questions/50837658/fftw3-compute-cross-correlation-in-the-same-signal", "title": "FFTW3 compute cross-correlation in the same signal", "body": "<p>I am currently creating a C code, which takes as an input a <code>wav</code> file (specifically just one channel of the original <code>wav</code> file), and it performs the short-time Fourier transform.\nThe main part of the code is this one:</p>\n\n<pre><code>stft_data = (fftw_complex*)(fftw_malloc(sizeof(fftw_complex)*windowSize));\n\nfft_result= (fftw_complex*)(fftw_malloc(sizeof(fftw_complex)*windowSize));\n\nstorage = (fftw_complex*)(fftw_malloc(sizeof(fftw_complex)*storage_capacity));\n\n//define the fftw plane\nfftw_plan plan_forward;\nplan_forward = fftw_plan_dft_1d(windowSize, stft_data, fft_result, FFTW_FORWARD, FFTW_ESTIMATE);\n\n//integer indexes\nint i,counter ;\ncounter = 0 ;\n//create a Hamming window\ndouble hamming_result[windowSize];\nhamming(windowSize, hamming_result);\n\n//implement the stft position indexes\nint chunkPosition = 0; //actual chunk position\nint readIndex ; //read the index of the wav file\n\nwhile (chunkPosition &lt; wav_length ){\n    //read the window\n    for(i=0; i&lt;windowSize; i++){\n\n      readIndex = chunkPosition + i;\n\n      if (readIndex &lt; wav_length){\n        stft_data[i] = wav_data[readIndex]*hamming_result[i]*_Complex_I  + 0.0*I;\n      }\n      else{\n        //if we are beyond the wav_length\n        stft_data[i] = 0.0*_Complex_I + 0.0*I;//padding\n        break;\n      }\n    }\n    //compute the fft\n    fftw_execute(plan_forward);\n    //store the stft in a data structure\n    for (i=0; i&lt;windowSize;i++)\n    {\n      //printf(\"RE: %.2f  IM: %.2f\\n\", creal(fft_result[i]),cimag(fft_result[i]));\n      storage[counter] = creal(fft_result[i]) + cimag(fft_result[i]);\n      counter+=1;\n    }\n\n    //update indexes\n    chunkPosition += hop_size;\n    printf(\"Chunk Position %d\\n\", chunkPosition);\n    printf(\"Counter position %d\\n\", counter);\n    printf(\"Fourier transform done\\n\");\n\n}  \n</code></pre>\n\n<p>Once the FFT has been computed onto the selected window, I am storing the FFT real and imaginary part into a <code>storage</code> variable.</p>\n\n<p>After that I would like to compute the cross correlation among the data points in each of the N windows I have in the end. \nAs an example, I would like to compute the correlation between the  first data point of the first window ( <code>storage[0]</code> ) with the first element of the second window (<code>storage[windowSize+1]</code>).\nHowever, I am facing some problems and I don't have reasonable values. According to what I studied, the correlation in the Fourier space it is just the complex multiplication between two Fourier terms. Thus,\nwhat I am doing is something like : </p>\n\n<pre><code>correlation = storage[0]*conj(storage[windowSize+1]);\n</code></pre>\n\n<p>However, I got very huge values, which makes me wonder if I am really computing a correlation. </p>\n\n<p>Where am I wrong? \nHow should I scale my correlation results? \nHow should I compute the correlation with the Fourier values?\nand then, how should I plot the Fourier values I have from FFTW3 calculations? should I shift all the values or are they already shifted?</p>\n\n<p>Thanks very much</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1528893498, "post_id": 50837413, "comment_id": 88678640, "body": "The other answer is probably better because it specifies the type of the value, I only went for the general idea."}], "tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": false, "score": 1, "last_activity_date": 1528893237, "creation_date": 1528893237, "answer_id": 50837413, "question_id": 50837329, "link": "https://stackoverflow.com/questions/50837329/whats-the-meaning-of-bit-in-this-linux-kernel-macro/50837413#50837413", "title": "What&#39;s the meaning of BIT() in this linux kernel macro?", "body": "<p>The <code>BIT</code> macro shifts the value <code>1</code> left by the value given to it, so <code>BIT(10)</code> == <code>(1 &lt;&lt; (10))</code>. It can be used to get a specific boolean value from a bit field.</p>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 7400340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6380568a3888fda9ed87f3e4f13ea4?s=128&d=identicon&r=PG&f=1", "display_name": "sdobak", "link": "https://stackoverflow.com/users/7400340/sdobak"}, "is_accepted": false, "score": 4, "last_activity_date": 1528893249, "creation_date": 1528893249, "answer_id": 50837416, "question_id": 50837329, "link": "https://stackoverflow.com/questions/50837329/whats-the-meaning-of-bit-in-this-linux-kernel-macro/50837416#50837416", "title": "What&#39;s the meaning of BIT() in this linux kernel macro?", "body": "<p>BIT is a macro defined in <code>include/linux/bitops.h</code> in the kernel tree:</p>\n\n<pre><code>#define BIT(nr)         (1UL &lt;&lt; (nr))\n</code></pre>\n\n<p>So BIT(10) is basically an unsigned long with tenth bit set.</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 9936005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfbd5c3c0d95d5b734dc007c7ee640?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Traud", "link": "https://stackoverflow.com/users/9936005/alex-traud"}, "is_accepted": true, "score": 11, "last_activity_date": 1528893603, "creation_date": 1528893603, "answer_id": 50837545, "question_id": 50837329, "link": "https://stackoverflow.com/questions/50837329/whats-the-meaning-of-bit-in-this-linux-kernel-macro/50837545#50837545", "title": "What&#39;s the meaning of BIT() in this linux kernel macro?", "body": "<p>looks like you can find the answer inside the first header file included, i.e. <a href=\"https://github.com/torvalds/linux/blob/410feb75de245664d66bc05ab2e2412751d10acf/include/linux/bitops.h\" rel=\"noreferrer\">bitops.h</a>!</p>\n\n<pre><code>#define BIT(nr) (1UL &lt;&lt; (nr))\n</code></pre>\n\n<p>i.e. <code>BIT</code> defines a bit mask for the specified bit number from 0 (least significant, or rightmost bit) to whatever fits into an unsigned long.<br>\nSo <code>BIT(10)</code> should evaluate to the numeric value of 1024 (which is <code>1 &lt;&lt; 10</code>).</p>\n"}], "owner": {"reputation": 3223, "user_id": 7253993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgLGK.jpg?s=128&g=1", "display_name": "kingJulian", "link": "https://stackoverflow.com/users/7253993/kingjulian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6501, "favorite_count": 0, "accepted_answer_id": 50837545, "answer_count": 3, "score": 6, "last_activity_date": 1528893603, "creation_date": 1528893004, "question_id": 50837329, "link": "https://stackoverflow.com/questions/50837329/whats-the-meaning-of-bit-in-this-linux-kernel-macro", "title": "What&#39;s the meaning of BIT() in this linux kernel macro?", "body": "<p>I was browsing the Linux kernel code and in the <a href=\"https://github.com/torvalds/linux/blob/410feb75de245664d66bc05ab2e2412751d10acf/include/linux/hid.h\" rel=\"noreferrer\">file</a> <code>hid.h</code>, the <code>HID_QUIRK_ALWAYS_POLL</code> macro is defined as:</p>\n\n<pre><code>#define HID_QUIRK_ALWAYS_POLL   BIT(10)\n</code></pre>\n\n<p>What is the meaning of <code>BIT(10)</code>? I am not really familiar with <code>C</code> but from what I know (and researched) there is no such bit manipulation function.</p>\n"}, {"tags": ["c", "data-structures", "binary-tree", "tree-traversal"], "comments": [{"owner": {"reputation": 1904, "user_id": 315016, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9fc2d6a1dd457e6a99106b29fef69a5d?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/315016/daniel"}, "edited": false, "score": 0, "creation_date": 1528892941, "post_id": 50837278, "comment_id": 88678254, "body": "It&#39;s not totally clear what you&#39;re asking. What steps do work and which one has a problem?"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1528893024, "post_id": 50837278, "comment_id": 88678314, "body": "When I compile your code, I get errors from the return type of DELETE. You&#39;re trying to return a pointer, and using the returned value of DELETE as a pointer, but DELETE converts it to an int. I&#39;m not saying that that&#39;s the issue, but it&#39;s an issue."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1528894441, "post_id": 50837646, "comment_id": 88679278, "body": "I believe this code has memory leaks.  (I cannot find the <code>free()</code> function anywhere, but I do see a very poorly done <code>malloc()</code> statement.)"}, {"owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1528894566, "post_id": 50837646, "comment_id": 88679359, "body": "Oh well simply using free() will not work. You have to recursively free nodes of the tree and it needs a separate function. I am writing that separate function"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1528896256, "post_id": 50837646, "comment_id": 88680546, "body": "You should make the topic of your edit more visible by adding the memory leak as a 3rd issue in the top of your post: <i>There were 3 issues:</i>"}, {"owner": {"reputation": 27, "user_id": 9935695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eabff83ffa6d17995f129ae457a620aa?s=128&d=identicon&r=PG&f=1", "display_name": "H.Kwon", "link": "https://stackoverflow.com/users/9935695/h-kwon"}, "edited": false, "score": 0, "creation_date": 1528935663, "post_id": 50837646, "comment_id": 88699269, "body": "Thank you so much! X) But there is one more problem. I don&#39;t want &#39;Queue is empty!&#39;."}], "tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": true, "score": 1, "last_activity_date": 1528895374, "last_edit_date": 1528895374, "creation_date": 1528893895, "answer_id": 50837646, "question_id": 50837278, "link": "https://stackoverflow.com/questions/50837278/binary-tree-level-order-traversal-using-double-pointer/50837646#50837646", "title": "Binary tree level order traversal using double pointer", "body": "<p>There were 2 issues:</p>\n\n<ol>\n<li><p>in <code>LevelOrder</code> function you were incorrectly using <code>(str==NULL)</code> instead of <code>(p == NULL)</code></p></li>\n<li><p>incorrect return type for <code>DELETE()</code></p></li>\n</ol>\n\n<p>Below is the working code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node **queue;\nint front = 0, rear = -1, nodeCnt = 0;\n\nstruct node\n{\n  struct node *llink;\n  int data;\n  struct node *rlink;\n};\n\nstruct node *\nbinaryTree (int a[], int left, int right)\n{               //Creating Tree\n  int mid;\n  struct node *p = NULL;\n  if (left &lt;= right)\n    {\n      mid = (left + right) / 2;\n      p = (struct node *) malloc (sizeof (struct node));\n      nodeCnt++;\n      printf (\"%d\\n\", a[mid]);\n      p-&gt;data = a[mid];\n      p-&gt;llink = binaryTree (a, left, mid - 1);\n      p-&gt;rlink = binaryTree (a, mid + 1, right);\n    }\n\n  return p;\n}\n\nint\nADD (struct node *data)\n{               //Queue Add function\n  if (rear == nodeCnt)\n    {\n      printf (\"Queue is full!\\n\");\n      return -1;\n    }\n\n  queue[++rear] = data;\n  return 0;\n}\n\nstruct node *\nDELETE ()\n{               //Queue Delete function\n  struct node *node = NULL;\n  if (front &gt; rear)\n    {\n      printf (\"Queue is empty!\");\n      return NULL;\n    }\n\n  node = queue[front++];\n  return node;\n}\n\nvoid\nLevelOrder (struct node *str)\n{               //Level order traversal function\n  struct node *p = NULL;\n  if (str != NULL)\n    {\n      ADD (str);        //call ADD()\n      while (1)\n    {\n      p = DELETE ();\n      if (p == NULL)\n        break;\n      printf (\"%d  \", p-&gt;data); //I think here and under this code is the problem\n      if (p-&gt;llink != NULL)\n        ADD (p-&gt;llink);\n      if (p-&gt;rlink != NULL)\n        ADD (p-&gt;rlink);\n    }\n    }\n}\n\nint\nmain ()\n{\n  int a[] = { 3, 5, 7, 10, 15, 17, 20, 25, 28, 31, 33, 35 };\n  struct node *root;\n  int n = sizeof (a) / sizeof (int);\n  int i;\n\n  root = binaryTree (a, 0, n - 1);  //call binaryTree function\n\n  printf (\"\\n\");\n  printf (\"\\n\");\n\n  queue = (struct node **) malloc (sizeof (struct node *) * nodeCnt);\n  //define queue with struct node type double pointer\n\n  LevelOrder (root);\n\n\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>17\n7\n3\n5\n10\n15\n28\n20\n25\n33\n31\n35\n\n\n17  7  28  3  10  20  33  5  15  25  31  35  Queue is empty!\n</code></pre>\n\n<p>Also, you need to completely delete the binary tree.\nHere is the function to delete the complete binary tree:</p>\n\n<pre><code>void\ndeletetree (struct node *root)\n{\n  if (root == NULL)\n    return;\n\n\n  deletetree (root-&gt;llink);\n  deletetree (root-&gt;rlink);\n\n  printf (\"\\n Deleting node: %d\", root-&gt;data);\n  free (root);\n  root = NULL;\n}\n</code></pre>\n\n<p>At the end of main function you need to add:</p>\n\n<pre><code>  deletetree (root);\n  free (queue);\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9935695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eabff83ffa6d17995f129ae457a620aa?s=128&d=identicon&r=PG&f=1", "display_name": "H.Kwon", "link": "https://stackoverflow.com/users/9935695/h-kwon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 50837646, "answer_count": 1, "score": 0, "last_activity_date": 1528895374, "creation_date": 1528892838, "question_id": 50837278, "link": "https://stackoverflow.com/questions/50837278/binary-tree-level-order-traversal-using-double-pointer", "title": "Binary tree level order traversal using double pointer", "body": "<p>Creating binary tree doesn't matter. I can see printed result of LevelOrder but it keeps put up a error. How can I fix changes while minimizing them? I need to be hurry :(\nI think print DELETE() is the problem. I tried a lot of things but I can't fix it. I must use double pointer, struct node type and queue.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node **queue;\nint front = 0, rear = -1, nodeCnt = 0;\n\nstruct node {\n    struct node *llink;\n    int data;\n    struct node *rlink;\n};\n\nstruct node *binaryTree(int a[], int left, int right) { //Creating Tree\n    int mid;\n    struct node *p = NULL;\n    if (left &lt;= right) {\n        mid = (left + right) / 2;\n        p = (struct node *)malloc(sizeof(struct node));\n        nodeCnt++;\n        printf(\"%d\\n\", a[mid]);\n        p-&gt;data = a[mid];\n        p-&gt;llink = binaryTree(a, left, mid - 1);\n        p-&gt;rlink = binaryTree(a, mid + 1, right);\n    }\n\n    return p;\n}\n\nint ADD(struct node *data) { //Queue Add function\n    if (rear == nodeCnt) {\n        printf(\"Queue is full!\\n\");\n        return -1;\n    }\n\n    queue[++rear] = data;\n    return 0;\n}\n\nint DELETE() { //Queue Delete function\n    struct node *node = NULL;\n    if (front &gt; rear) {\n        printf(\"Queue is empty!\");\n        return -1;\n    }\n\n    node = queue[front++];\n    return node;\n}\n\nint LevelOrder(struct node *str) { //Level order traversal function\n    struct node *p = NULL; \n    if (str != NULL) {  \n        ADD(str); //call ADD()\n        while (1) {\n            p = DELETE();\n            if (str == NULL)\n                break;\n            printf(\"%d  \", p-&gt;data); //I think here and under this code is the problem\n            if (p-&gt;llink != NULL)\n                ADD(p-&gt;llink);\n            if (p-&gt;rlink != NULL)\n                ADD(p-&gt;rlink);\n        }\n    }\n}\n\nint main() {\n    int a[] = { 3, 5, 7, 10, 15, 17, 20, 25, 28, 31, 33, 35 };\n    struct node *root;\n    int n = sizeof(a) / sizeof(int);\n    int i;\n\n    root = binaryTree(a, 0, n - 1); //call binaryTree function\n\n    printf(\"\\n\");\n    printf(\"\\n\");\n\n    queue = (struct node **)malloc(sizeof(struct node *) *nodeCnt);\n    //define queue with struct node type double pointer\n\n    LevelOrder(root);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "random", "malloc"], "comments": [{"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 1, "creation_date": 1528893068, "post_id": 50837245, "comment_id": 88678345, "body": "That&#39;s c and not c++."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1528893382, "post_id": 50837245, "comment_id": 88678551, "body": "octal 1000 == decimal 512, and you&#39;re reading numbers as octal."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1528893494, "post_id": 50837245, "comment_id": 88678638, "body": "<code>I&#39;m a total beginner in C++</code> From what I can see in your question, what little you learned is C not C++."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1528896168, "post_id": 50837245, "comment_id": 88680470, "body": "You don&#39;t need any dynamic memory allocation as you only use 1 element at a time and free the memory afterwards. You could well do with a simple <code>float</code> variable instead of those arrays. Also your loops go beyond the end of your memory: <code>(int i=0;i&lt;j+2;i+=1)</code> should be <code>(int i=0; i&lt;j; i+=1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "is_accepted": false, "score": 0, "last_activity_date": 1528893727, "creation_date": 1528893727, "answer_id": 50837586, "question_id": 50837245, "link": "https://stackoverflow.com/questions/50837245/making-big-samples-with-parkmiller-rngs/50837586#50837586", "title": "Making big samples with Park&amp;Miller RNGs?", "body": "<pre><code>scanf(\"%lo\",&amp;j);\n</code></pre>\n\n<p>This interprets the number you enter as an octal integer, that is a number with only the digits 0 to 7.</p>\n\n<p>Replace the o from the pattern with u.</p>\n\n<pre><code>scanf(\"%lu\",&amp;j);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9513104, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alx", "link": "https://stackoverflow.com/users/9513104/alx"}, "edited": false, "score": 0, "creation_date": 1528894424, "post_id": 50837618, "comment_id": 88679266, "body": "Thank you a lot it was exactly that ! I didn&#39;t notice that &quot;lo&quot; was for &quot;Long Octal&quot;. It works perfectly"}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": false, "score": 0, "last_activity_date": 1528893808, "creation_date": 1528893808, "answer_id": 50837618, "question_id": 50837245, "link": "https://stackoverflow.com/questions/50837245/making-big-samples-with-parkmiller-rngs/50837618#50837618", "title": "Making big samples with Park&amp;Miller RNGs?", "body": "<p>Your issue is your format specifiers.  The specifier \"%lo\" tells <code>scanf</code> to read a string representation of an unsigned octal integer and store it in the <code>long</code> object pointed to by the corresponding argument.</p>\n\n<p>That means when you input \"1000\", its interpreted as octal, and 1000<sub>8</sub> is the same as 512<sub>10</sub>.  You then add 2 to that number, which explains why you see 514 iterations for the input \"1000\".</p>\n\n<p>Use \"d\" instead of \"o\" in your format specifiers to indicate a decimal integer:</p>\n\n<pre><code>scanf(\"%ld\", &amp;j);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9513104, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alx", "link": "https://stackoverflow.com/users/9513104/alx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528893808, "creation_date": 1528892722, "last_edit_date": 1528893722, "question_id": 50837245, "link": "https://stackoverflow.com/questions/50837245/making-big-samples-with-parkmiller-rngs", "title": "Making big samples with Park&amp;Miller RNGs?", "body": "<p>i'm trying to <strong>generate pseudo-random numbers</strong> with Park&amp;Miller RNG ran0 1 2 3(3 doesn't work for the moment) in C++ from <em>\"Numerical Recipes in C\"</em>.\nTheses generators work correctly because it makes samples uniformaly distributed between 0 and 1. \nMy goal is to have a huge sample (10^10 at least) so i used malloc() function to allocate memory.\nMy problem is that the sample is always to small (i'd like to have \"j\" random numbers generated, for example: if i initialize <strong>j=1000 i'll have 514 random numbers instead of 1000</strong>, in order to test things i made different \"for\" loops).\nI'm a total beginner in C++ (and in programming) and i fear a pointer problem, but i do not understand how to fix it. If someone has a solution or just a advice it would help me a lot because this problem seriously curb me in my internship (please be lenient with my approximative english :')). Here's the code:</p>\n\n<pre><code>int main(){\nFILE* simulationr0 = fopen(\"E:/Simulation_stage/SimulationRan0\",\"w\");\nFILE* simulationr1 = fopen(\"E:/Simulation_stage/SimulationRan1\",\"w\");\nFILE* simulationr2 = fopen(\"E:/Simulation_stage/SimulationRan2\",\"w\");\nFILE* simulationr3 = fopen(\"E:/Simulation_stage/SimulationRan3\",\"w\");\nfloat d;\nlong j;\nlong seed;\nprintf(\"tapez 0 pour utiliser ran0\\ntapez 1 pour utiliser ran1\\ntapez 2 pour utiliser ran2\\ntapez 3 pour utiliser ran3\\ntapez 4 pour les utiliser tous\");\nscanf(\"%f\",&amp;d);\nif( d!=0 &amp; d!=1 &amp; d!= 2 &amp; d!= 3 &amp; d!=4){\n    printf(\"Erreur: valeur incorrecte//incorrect value\\n\");\n    exit(0);}\nprintf(\"Combien de nombres pseudo-aleatoires ?// How many random numbers ?\\n\");\nscanf(\"%lo\",&amp;j);\nprintf(\"Quelle graine ? Which seed ?\\n\");\nscanf(\"%lo\", &amp;seed);\nlong *pseed=&amp;seed;\nif(d==4){\n    float * ranp0;\n    float * ranp1;\n    float * ranp2;\n    float * ranp3;\n    ranp0 = (float*) malloc (j*sizeof(float));\n    ranp1 = (float*) malloc (j*sizeof(float));\n    ranp2 = (float*) malloc (j*sizeof(float));\n    ranp3 = (float*) malloc (j*sizeof(float));\n    for (int i=0;i&lt;j+2;i+=1){\n        ranp0[i]=ran0(pseed);\n        ranp1[i]=ran1(pseed);\n        ranp2[i]=ran2(pseed);\n        ranp3[i]=ran3(pseed);\n        fprintf(simulationr0,\"%f\\n\", ranp0[i]);\n        fprintf(simulationr1,\"%f\\n\", ranp1[i]);\n        fprintf(simulationr2,\"%f\\n\", ranp2[i]);\n        fprintf(simulationr3,\"%f\\n\", ranp3[i]);\n    }\n    fclose(simulationr0);\n    fclose(simulationr1);\n    fclose(simulationr2);\n    fclose(simulationr3);\n    system(\"PAUSE\");\n    free(ranp0);\n    free(ranp1);\n    free(ranp2);\n    free(ranp3);}\nif(d==0){\n    float * ranp0;\n    ranp0 = (float*) malloc (j*sizeof(float));\n    for (int i=0;i&lt;j+2;i++){\n        ranp0[i]=ran0(pseed);\n        fprintf(simulationr0,\"%f\\n\", ranp0[i]);}\n    fclose(simulationr0);\n    system(\"PAUSE\");\n    free(ranp0);}\nif(d==1){\n    float * ranp1;\n    ranp1 = (float*) malloc (j*sizeof(float));\n    for (int i=0;i&lt;j+2;i++){\n        ranp1[i]=ran1(pseed);\n        fprintf(simulationr1,\"%f\\n\", ranp1[i]);}\n    fclose(simulationr1);\n    system(\"PAUSE\");\n    free(ranp1);}\nif(d==2){\n    float * ranp2;\n    ranp2 = (float*) malloc(j*sizeof(long));\n    for (int i=0;i!=j;i=i+1){\n        ranp2[i]=ran2(pseed);\n        fprintf(simulationr2,\"%f\\n\", ranp2[i]);}\n    fclose(simulationr2);\n    system(\"PAUSE\");\n    free(ranp2);}\nif(d==3){\n    float * ranp3;\n    ranp3 = (float*) malloc(j*sizeof(float));\n    for (int i=0;i&lt;j+2;i++){\n        ranp3[i]=ran3(pseed);\n        fprintf(simulationr3,\"%f\\n\", ranp3[i]);}\n    fclose(simulationr3);\n    system(\"PAUSE\");\n    free(ranp3);}\nsystem(\"PAUSE\");\nexit(1);}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "openmp"], "comments": [{"owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "edited": false, "score": 1, "creation_date": 1528892236, "post_id": 50836953, "comment_id": 88677742, "body": "non of the variables defined at the top of <code>calculate_forces ()</code> need to be placed there. Place them closest to the first point at which they&#39;re needed (or if you&#39;re using c99, at the place you assign them). Because of this you forgot to declare <code>r</code> private."}, {"owner": {"reputation": 13, "user_id": 9709380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911342edf0daefe429b22af5c2e7c98a?s=128&d=identicon&r=PG&f=1", "display_name": "SMAD", "link": "https://stackoverflow.com/users/9709380/smad"}, "reply_to_user": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "edited": false, "score": 0, "creation_date": 1528892896, "post_id": 50836953, "comment_id": 88678219, "body": "@Lanting I was given the code and told to add the OpenMP directives. So that means I shouldn&#39;t change anything , but you are correct I forgot to declare as private."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1528901631, "post_id": 50836953, "comment_id": 88684296, "body": "Is the question about performance (as the title indicates)? Then you must report specific performance results. Or is the question about correctness - then you must report specific expectation and how the actual result differs. In any case, please include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Or is the question already solved by Lanting&#39;s comment?"}], "owner": {"reputation": 13, "user_id": 9709380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911342edf0daefe429b22af5c2e7c98a?s=128&d=identicon&r=PG&f=1", "display_name": "SMAD", "link": "https://stackoverflow.com/users/9709380/smad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528891845, "creation_date": 1528891845, "question_id": 50836953, "link": "https://stackoverflow.com/questions/50836953/increasing-n-body-program-performance-using-openmp", "title": "Increasing n-body program performance using OpenMP", "body": "<p>My goal is to increase the performance of a code that simulates the n-body problem. </p>\n\n<p>This is where the time is to be calculated. The two functions that need to be parallelized are the <strong><em>calculate_forces()</em></strong> and the <strong>*move_bodies()</strong> functions but since the loop control variable <strong><em>t</em></strong> is a double I cannot have a <strong><em>#pragma omp parallel for</em></strong> statement there.</p>\n\n<pre><code>t0 = gettime ();\n  for (t = 0; t &lt; t_end; t += dt)\n    {\n      // draw bodies\n      show_bodies (window);\n\n      // computation\n      calculate_forces ();\n      move_bodies ();\n    }\n\n  // print out calculation speed every second\n  t0 = gettime () - t0;\n</code></pre>\n\n<p>The two functions <strong><em>calculate_forces()</em></strong> and <strong><em>move_bodies()</em></strong> with the respective directives that I used are the following:</p>\n\n<pre><code>static void\ncalculate_forces ()\n{\n  double distance, magnitude, factor, r;\n  vector_t direction;\n  int i, j;\n #pragma omp parallel private(distance,magnitude,factor,direction)\n {\n   #pragma omp for private(i,j)\n   for (i = 0; i &lt; n_body - 1; i++)\n    {\n      for (j = i + 1; j &lt; n_body; j++)\n        {\n          r = SQR (bodies[i].position.x - bodies[j].position.x) + SQR (bodies[i].position.y - bodies[j].position.y);\n          // avoid numerical instabilities\n          if (r &lt; EPSILON)\n            {\n             // this is not how nature works :-)\n              r += EPSILON;\n            }\n          distance = sqrt (r);\n          magnitude = (G * bodies[i].mass * bodies[j].mass) / (distance * distance);\n\n          factor = magnitude / distance;\n          direction.x = bodies[j].position.x - bodies[i].position.x;\n          direction.y = bodies[j].position.y - bodies[i].position.y;\n\n          // +force for body i\n        #pragma omp critical\n         {\n          bodies[i].force.x += factor * direction.x;\n          bodies[i].force.y += factor * direction.y;\n\n          // -force for body j \n          bodies[j].force.x -= factor * direction.x;\n          bodies[j].force.y -= factor * direction.y;\n          }\n        }\n    }\n }\n\n}\nstatic void\nmove_bodies ()\n{\n  vector_t delta_v, delta_p;\n  int i;\n #pragma omp parallel private(delta_v,delta_p,i)\n {\n #pragma omp for \n for (i = 0; i &lt; n_body; i++)\n    {\n      // calculate delta_v\n      delta_v.x = bodies[i].force.x / bodies[i].mass * dt;\n      delta_v.y = bodies[i].force.y / bodies[i].mass * dt;\n\n      // calculate delta_p\n      delta_p.x = (bodies[i].velocity.x + delta_v.x / 2.0) * dt;\n      delta_p.y = (bodies[i].velocity.y + delta_v.y / 2.0) * dt;\n\n      // update body velocity and position\n      #pragma omp critical\n      {\n      bodies[i].velocity.x += delta_v.x;\n      bodies[i].velocity.y += delta_v.y;\n      bodies[i].position.x += delta_p.x;\n      bodies[i].position.y += delta_p.y;\n      }\n      // reset forces\n      bodies[i].force.x = bodies[i].force.y = 0.0;\n\n\n      if (bounce)\n        {\n          // bounce on boundaries (i.e. it's more like billard)\n          if ((bodies[i].position.x &lt; -body_distance_factor) || (bodies[i].position.x &gt; body_distance_factor))\n            bodies[i].velocity.x = -bodies[i].velocity.x;\n          if ((bodies[i].position.y &lt; -body_distance_factor) || (bodies[i].position.y &gt; body_distance_factor))\n            bodies[i].velocity.y = -bodies[i].velocity.y;\n        }\n    }\n}\n</code></pre>\n\n<p>The values of bodies.velocity and bodies.position are changed in the move bodies function, but I couldn't use a reduction. </p>\n\n<p>There is also a checksum function to calculate if the calculated checksum is equal to the reference checksum. That function looks like this:</p>\n\n<pre><code>static unsigned long\nchecksum()\n{\n  unsigned long checksum = 0;\n\n  // initialize bodies\n  for (int i = 0; i &lt; n_body; i++)\n    {\n      // random position vector\n      checksum += (unsigned long)round(bodies[i].position.x);\n      checksum += (unsigned long)round(bodies[i].position.y);\n    }\n\n  return checksum;\n}\n</code></pre>\n\n<p>This function uses the previously calculated values of bodies.position.x and bodies.position.y which were calculated in the move_bodies function hence the reason why I used a critical block while calculating those value which didn't seem to yield a correct answer. Can anyone give me some insight on where I am going wrong? Thank you in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1528891348, "post_id": 50836716, "comment_id": 88677187, "body": "there is no string or byte type in c :)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528891364, "post_id": 50836716, "comment_id": 88677200, "body": "if c++, you might use <code>decltype</code> to have that information."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1528891441, "post_id": 50836716, "comment_id": 88677265, "body": "related: <a href=\"https://stackoverflow.com/questions/22358864/operations-with-different-int-types\" title=\"operations with different int types\">stackoverflow.com/questions/22358864/&hellip;</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1528894482, "post_id": 50836716, "comment_id": 88679309, "body": "<code>is it a double, long, int, string or byte?</code> -- perfect example for no effort shown!!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1528894906, "post_id": 50836716, "comment_id": 88679612, "body": "<a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">Implicit type promotion rules</a>."}, {"owner": {"reputation": 754, "user_id": 8402500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XZRs6.jpg?s=128&g=1", "display_name": "G.Alexander", "link": "https://stackoverflow.com/users/8402500/g-alexander"}, "edited": false, "score": 0, "creation_date": 1528897196, "post_id": 50836716, "comment_id": 88681202, "body": "@Andi Perkaa Use <code>float</code> or &#39;double&#39; to take result."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1528891932, "last_edit_date": 1528891932, "creation_date": 1528891227, "answer_id": 50836754, "question_id": 50836716, "link": "https://stackoverflow.com/questions/50836716/what-will-this-c-expression-return-in-typeint-double/50836754#50836754", "title": "What will this C expression return in type?(int/double)", "body": "<p>It's a <code>double</code>. The <em>arithmetic conversion</em> rules come in to play when you have an expression containing mixed types:</p>\n\n<p><code>x</code> is converted to a <code>double</code> in the evaluation of <code>x / y</code>, and 2 is converted to a <code>double</code> when added to that term.</p>\n\n<p>Note that this is true regardless of the range of <code>int</code> (and <code>double</code>) on your platform.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1528891878, "post_id": 50836880, "comment_id": 88677523, "body": "I&#39;d avoid implying an <i>order</i> of evaluation, using the term <i>grouping</i> is preferable: the type of 2 + x / y is also a <code>double</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1528892103, "post_id": 50836880, "comment_id": 88677660, "body": "It is not &quot;implicit typecasting&quot; but <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.8\" rel=\"nofollow noreferrer\">arithmetic conversions</a>. The word <i>cast</i> in C means the thing that is explicit, i.e. <code>(type)expression</code> ."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 2, "last_activity_date": 1528896225, "last_edit_date": 1528896225, "creation_date": 1528891608, "answer_id": 50836880, "question_id": 50836716, "link": "https://stackoverflow.com/questions/50836716/what-will-this-c-expression-return-in-typeint-double/50836880#50836880", "title": "What will this C expression return in type?(int/double)", "body": "<p>It returns <code>double</code> type.</p>\n\n<p>In  <code>(x / y + 2)</code> first <code>x/y</code> performed and here variable <code>x</code> is of <code>int</code> type and <code>y</code> is of <code>double</code> type, so you are performing division operator between two different type, hence  <strong>arithmetic type conversation</strong> happens i.e temporarily <code>int</code> gets converted or promoted to <code>double</code> i.e <code>x/y</code> yields in <code>double</code> type.</p>\n\n<p>And next  <code>(x/y)(double)</code> + 2<code>(int)</code> again yields in <code>double</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1528896966, "creation_date": 1528896966, "answer_id": 50838642, "question_id": 50836716, "link": "https://stackoverflow.com/questions/50836716/what-will-this-c-expression-return-in-typeint-double/50838642#50838642", "title": "What will this C expression return in type?(int/double)", "body": "<p>The resulting type of the expression will be <code>double</code>.  This is detailed in section 6.3.1.8 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> which details the <strong>Usual arithmetic conversions</strong>:</p>\n\n<blockquote>\n  <p>First, if the corresponding real type of either operand is <code>long double</code>, the other operand is converted, without change of type domain, to a type whose corresponding real type is <code>long double</code>.</p>\n  \n  <p><strong>Otherwise, if the corresponding real type of either operand is <code>double</code>, the other operand is converted, without change of type domain, to a type whose corresponding real type is <code>double</code>.</strong></p>\n  \n  <p>Otherwise, if the corresponding real type of either operand is <code>float</code>, the other operand is converted, without change of type domain, to a type whose corresponding real type is <code>float</code>.</p>\n  \n  <p>Otherwise, the integer promotions are performed on both operands.</p>\n</blockquote>\n\n<p>The paragraph in bold states that if one operand is a <code>double</code> and the other has an integer type, both operands will have type <code>double</code>.  This is the case in your expression.</p>\n\n<p>Since <code>x</code> has type <code>double</code> and <code>y</code> has type <code>int</code>, the value of <code>y</code> is converted to <code>double</code> and the full expression <code>x / y</code> has type <code>double</code>.  From there, <code>x / y</code> has type double and <code>2</code> has type <code>int</code>, the value <code>2</code> is converted to <code>double</code> and so <code>x / y + 2</code> has type <code>double</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 8283264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1f8c0ae12e2ab4b000290c3339782a?s=128&d=identicon&r=PG&f=1", "display_name": "Andi Perkaa", "link": "https://stackoverflow.com/users/8283264/andi-perkaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1528896966, "creation_date": 1528891138, "last_edit_date": 1528891277, "question_id": 50836716, "link": "https://stackoverflow.com/questions/50836716/what-will-this-c-expression-return-in-typeint-double", "title": "What will this C expression return in type?(int/double)", "body": "<p>Hi I would like to ask the result of an expression,</p>\n\n<pre><code>int x = 7;\ndouble y = 2;\n</code></pre>\n\n<p>what will the type be when (x / y + 2)?</p>\n\n<p>is it a double, long, int, string or byte?\nthanks</p>\n"}, {"tags": ["c", "pipe", "posix"], "comments": [{"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 4, "creation_date": 1528891158, "post_id": 50836632, "comment_id": 88677053, "body": "As I understand the man page, <code>pclose</code> should return the exit code. You are testing for <code>&lt;0</code> here, which would be true if <code>pclose</code> itself fails. Testing for <code>&gt;0</code> would then test if the called program failed (had exit code &gt;0)."}, {"owner": {"reputation": 966, "user_id": 1386127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/01cef9fb064e908463d83e6cb1f08cf8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumen", "link": "https://stackoverflow.com/users/1386127/soumen"}, "edited": false, "score": 0, "creation_date": 1528891548, "post_id": 50836632, "comment_id": 88677338, "body": "&quot;The pclose() function waits for the associated process to terminate and returns the exit status of the command as returned by wait4.&quot; Do you have the binary &#39;foo&#39; from where you are running this program?"}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "reply_to_user": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1528892036, "post_id": 50836632, "comment_id": 88677625, "body": "@KarstenKoop Thanks! If you turn you comment into an answer I will accept it."}], "answers": [{"tags": [], "owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "is_accepted": true, "score": 2, "last_activity_date": 1528893202, "creation_date": 1528893202, "answer_id": 50837399, "question_id": 50836632, "link": "https://stackoverflow.com/questions/50836632/how-do-i-detect-a-failing-command-in-popen/50837399#50837399", "title": "How do I detect a failing command in popen?", "body": "<p>As I understand the <a href=\"https://linux.die.net/man/3/pclose\" rel=\"nofollow noreferrer\">man page</a>, <code>pclose</code> should return the exit code. You are testing for &lt;0 here, which would be true if <code>pclose</code> itself fails. Testing for >0 would then test if the called program failed (had exit code >0).</p>\n\n<p>Man page of <code>pclose</code>:</p>\n\n<blockquote>\n  <p>The pclose() function waits for the associated process to terminate and returns the exit status of the command as returned by wait4.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>The pclose() function returns -1 if wait4 returns an error, or some other error is detected. </p>\n</blockquote>\n"}], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 50837399, "answer_count": 1, "score": 0, "last_activity_date": 1528893202, "creation_date": 1528890877, "question_id": 50836632, "link": "https://stackoverflow.com/questions/50836632/how-do-i-detect-a-failing-command-in-popen", "title": "How do I detect a failing command in popen?", "body": "<p>I'm trying to figure out how to detect when a command invoked by <em>popen</em> fails. In the program <code>test.c</code> below, <em>popen</em> returns non-null although the command fails. Any clues?</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    FILE *fp;\n    int status;\n\n    fp = popen(\"foo\", \"r\");\n    if (fp != NULL) {\n        puts(\"command successful\");\n        status = pclose(fp);\n        if (status &lt; 0) {\n            perror(NULL);\n            exit(EXIT_FAILURE);\n        }\n    } else {\n        perror(NULL);\n        exit(EXIT_FAILURE);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ ./test\ncommand successful\nsh: 1: foo: not found\n</code></pre>\n"}, {"tags": ["c", "char", "int", "interpretation"], "answers": [{"comments": [{"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1528887585, "post_id": 50835482, "comment_id": 88674777, "body": "Your answer suggests that you cannot compare apples with oranges, but you can convert an apple into an orange - no offense :-)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1528890735, "post_id": 50835482, "comment_id": 88676775, "body": "@andreee A more accurate analogy might be:"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1528890743, "post_id": 50835482, "comment_id": 88676780, "body": "Imagine the C compiler being a fruit warehouse worker getting tasked with comparing 3 apples to 5 oranges. The worker is unwilling to admit that the requested task makes no sense, let alone that he doesn&#39;t understand the comparison criteria. So instead the worker grabs 3 bananas and 5 bananas and sneaks off into another room, comparing the bananas with each other instead. Aha, they are all yellow. Pleased with himself, he then delivers bananas to the customer, who then tries to sell them as apples. After which the fruit store goes bankrupt.  And so the term &quot;going bananas&quot; was invented."}], "tags": [], "owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "is_accepted": false, "score": 1, "last_activity_date": 1528887446, "creation_date": 1528887446, "answer_id": 50835482, "question_id": 50835423, "link": "https://stackoverflow.com/questions/50835423/how-an-integer-and-character-is-stored-in-c/50835482#50835482", "title": "how an integer and character is stored in c", "body": "<p>The internal storage is the compiler's decision, and often depends on the target architecture.</p>\n\n<p>However, this has nothing to do with the result your code shows; in the comparison, the char gets promoted to an int before comparing (because you can't compare apples with oranges; read the language rules). Therefore, it compares an int with an int, and they are equal.</p>\n"}, {"tags": [], "owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "is_accepted": false, "score": 3, "last_activity_date": 1528887707, "creation_date": 1528887707, "answer_id": 50835574, "question_id": 50835423, "link": "https://stackoverflow.com/questions/50835423/how-an-integer-and-character-is-stored-in-c/50835574#50835574", "title": "how an integer and character is stored in c", "body": "<p>The computer is able to compare a char to an int on a binary level because of <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">Implicit type promotion rules</a>.</p>\n\n<blockquote>\n  <p>If an int can represent all values of the original type (as restricted by the width, for a bit-field), the value is converted to an int; otherwise, it is converted to an unsigned int. These are called the integer promotions.</p>\n</blockquote>\n\n<p>This means your char is promoted to an <code>int</code> before your processor compares the two.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1528890035, "creation_date": 1528890035, "answer_id": 50836325, "question_id": 50835423, "link": "https://stackoverflow.com/questions/50835423/how-an-integer-and-character-is-stored-in-c/50836325#50836325", "title": "how an integer and character is stored in c", "body": "<p>C is a very flawed language, so there are many dirty, irrational things going on between the lines here:</p>\n\n<ul>\n<li><code>char</code> has implementation-defined signedness, so how it stores data depends on compiler. <a href=\"https://stackoverflow.com/questions/2054939/is-char-signed-or-unsigned-by-default\">Is char signed or unsigned by default?</a></li>\n<li><code>'A'</code> is a character literal, and as it happens, character literals are actually of type <code>int</code> in C. This doesn't make any sense, but that's just how it is.</li>\n<li>In the line <code>char d='A';</code>, the literal <code>'A'</code> (type <code>int</code>) gets converted to <code>char</code>. Which may or may not be signed. Signedness shouldn't in practice affect the basic character set A to Z though. </li>\n<li>Most likely <code>'A'</code> will be stored as the value <code>65</code>, although this is not guaranteed by the standard. For that reason it is better to always write <code>'A'</code> and never <code>65</code> (the former is also most readable).</li>\n<li>In the expression <code>a==d</code>, the character operand is a <em>small integer type</em>. Small integer types undergo an implicit promotion to <code>int</code> when used in most expressions. This integer promotion is part of a set of rules for how expressions are balanced, to ensure that both operands of an operator are always of the same type. These rules are called <em>the usual arithmetic conversions</em>. For details see: <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">Implicit type promotion rules</a></li>\n</ul>\n"}], "owner": {"reputation": 29, "user_id": 7599112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432ab2e4e39597f80239a97613cb2dff?s=128&d=identicon&r=PG&f=1", "display_name": "losara ambika", "link": "https://stackoverflow.com/users/7599112/losara-ambika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1528890171, "creation_date": 1528887282, "question_id": 50835423, "link": "https://stackoverflow.com/questions/50835423/how-an-integer-and-character-is-stored-in-c", "title": "how an integer and character is stored in c", "body": "<pre><code>#include&lt;stdio.h&gt;\nvoid main()\n{\n  int a=65;\n  char d='A';\n   if(a==d)\n    printf(\"both are same\");\n }\n</code></pre>\n\n<p>The output is both  are same.here a is a integer so 65 is stored in 32 bits and d is a char which is stored in 8 bits how could they be same as is computer everything is converted to binary for any operation.</p>\n"}, {"tags": ["android", "c", "string", "android-ndk", "strcpy"], "comments": [{"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "edited": false, "score": 1, "creation_date": 1528885765, "post_id": 50834825, "comment_id": 88673689, "body": "Did you allocated memory? <code>char *callerURI= (char *) malloc(sizeof(char *) * THE_SIZE);     strcpy(callerURI, reqParticipants.URI[idUser]);</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1528885788, "post_id": 50834825, "comment_id": 88673702, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37549594/crash-or-segmentation-fault-when-data-is-copied-scanned-read-to-an-uninitializ\">Crash or &quot;segmentation fault&quot; when data is copied/scanned/read to an uninitialized pointer</a>"}, {"owner": {"reputation": 5080, "user_id": 1307987, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bbce19ea91ac93a7fdb9a25b4ad0a4?s=128&d=identicon&r=PG", "display_name": "rosu alin", "link": "https://stackoverflow.com/users/1307987/rosu-alin"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1528886525, "post_id": 50834825, "comment_id": 88674106, "body": "@AndrewHenle I don&#39;t think it&#39;s the same issue, because then my strlen shold have worked? Please check my edit"}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "edited": false, "score": 0, "creation_date": 1528886659, "post_id": 50834825, "comment_id": 88674180, "body": "You have to get ride of the &#39;*&#39; when you allocate your pointer, it must be <code>callerURI= (char *) malloc(sizeof(char *) * (strlen(callerTemp) + 1 ));</code>"}, {"owner": {"reputation": 5080, "user_id": 1307987, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bbce19ea91ac93a7fdb9a25b4ad0a4?s=128&d=identicon&r=PG", "display_name": "rosu alin", "link": "https://stackoverflow.com/users/1307987/rosu-alin"}, "edited": false, "score": 0, "creation_date": 1528886820, "post_id": 50834825, "comment_id": 88674277, "body": "But it doesn&#39;t even get at the line before that. why does it crash in strlen(callerTemp)"}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "edited": false, "score": 1, "creation_date": 1528887057, "post_id": 50834825, "comment_id": 88674434, "body": "Because <code>strlen</code> returns a <code>size_t</code> not a string, so you have to change the format, try by putting %ld instead of %s in your &#39;13&#39; LOG"}, {"owner": {"reputation": 5080, "user_id": 1307987, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bbce19ea91ac93a7fdb9a25b4ad0a4?s=128&d=identicon&r=PG", "display_name": "rosu alin", "link": "https://stackoverflow.com/users/1307987/rosu-alin"}, "edited": false, "score": 1, "creation_date": 1528887108, "post_id": 50834825, "comment_id": 88674470, "body": "yes, yes, just noticed this, sorry. And this is the correct answer. it works now"}], "answers": [{"comments": [{"owner": {"reputation": 5080, "user_id": 1307987, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bbce19ea91ac93a7fdb9a25b4ad0a4?s=128&d=identicon&r=PG", "display_name": "rosu alin", "link": "https://stackoverflow.com/users/1307987/rosu-alin"}, "edited": false, "score": 0, "creation_date": 1528885792, "post_id": 50834898, "comment_id": 88673705, "body": "ok, so how should I proceed? I do not know the length of the string I want to copy, when I init it. So do I need to reinit it before strcpy?"}, {"owner": {"reputation": 5080, "user_id": 1307987, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bbce19ea91ac93a7fdb9a25b4ad0a4?s=128&d=identicon&r=PG", "display_name": "rosu alin", "link": "https://stackoverflow.com/users/1307987/rosu-alin"}, "edited": false, "score": 0, "creation_date": 1528886496, "post_id": 50834898, "comment_id": 88674091, "body": "I have edited my question, tried but something is still off"}], "tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": true, "score": 2, "last_activity_date": 1528886029, "last_edit_date": 1528886029, "creation_date": 1528885657, "answer_id": 50834898, "question_id": 50834825, "link": "https://stackoverflow.com/questions/50834825/android-ndk-strcpy-crashes-when-i-try-to-put-copy-a-string/50834898#50834898", "title": "Android NDK strcpy crashes when I try to put copy a String", "body": "<pre><code>static char* callerURI;\n</code></pre>\n\n<p>You are not allocating memory here, so <code>callerURI</code> is just a doormat, not a house where you can enter.\nBefore calling <code>strcpy</code> you have to allocate memory for <code>callerURI</code>. Maybe you can use <code>reqParticipants.URI[idUser]</code> to find out the memory you need to allocate.</p>\n"}], "owner": {"reputation": 5080, "user_id": 1307987, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bbce19ea91ac93a7fdb9a25b4ad0a4?s=128&d=identicon&r=PG", "display_name": "rosu alin", "link": "https://stackoverflow.com/users/1307987/rosu-alin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 50834898, "answer_count": 1, "score": 0, "last_activity_date": 1528886472, "creation_date": 1528885390, "last_edit_date": 1528886472, "question_id": 50834825, "link": "https://stackoverflow.com/questions/50834825/android-ndk-strcpy-crashes-when-i-try-to-put-copy-a-string", "title": "Android NDK strcpy crashes when I try to put copy a String", "body": "<p>This is what I am trying to do:</p>\n\n<pre><code>static char* callerURI; //declared globally\nstrcpy(callerURI, reqParticipants.URI[idUser]);\n</code></pre>\n\n<p>Where :</p>\n\n<pre><code>@var VidyoClientRequestParticipants::URI [out]\n    Array of values for Vidyo URI of remote participants in a conference.\n</code></pre>\n\n<p>I get this from a SDK so not sure what it is.</p>\n\n<p>If I log:    <code>LOGI(\"VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 1 REAL: %s\" ,reqParticipants.URI[idUser]);</code> I will get a string.</p>\n\n<p>Now if I do:</p>\n\n<pre><code>callerURI = reqParticipants.URI[idUser];\n</code></pre>\n\n<p>This will work, and will set that String to my callerURI, but it gets unassigned somehow. So I assumed strcpy is the right way to do this.\nBut trying <code>strcpy(callerURI, reqParticipants.URI[idUser]);</code> results in this error:</p>\n\n<pre><code>06-13 05:14:08.044: E/SQLiteDatabase(1165): Error inserting value=true key=com.vidyo.vidyomod\n06-13 05:14:08.044: E/SQLiteDatabase(1165): android.database.sqlite.SQLiteException: no such table: KeyValueMap (code 1): , while compiling: INSERT INTO KeyValueMap(value,key) VALUES (?,?)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:889)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:500)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.database.sqlite.SQLiteProgram.&lt;init&gt;(SQLiteProgram.java:58)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.database.sqlite.SQLiteStatement.&lt;init&gt;(SQLiteStatement.java:31)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at     android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1467)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.database.sqlite.SQLiteDatabase.insert(SQLiteDatabase.java:1339)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.jb.ga0.commerce.util.io.DataBaseHelper.insert(ZeroCamera:323)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.jiubang.commerce.tokencoin.database.d.a(KeyValueMapTable.java:47)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.jiubang.commerce.tokencoin.integralwall.c$1.onAppUninstalled(AppAdsDataManager.java:101)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.jb.ga0.commerce.util.observer.AppChangeObserver.notifyAppUninstalled(ZeroCamera:129)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.jb.ga0.commerce.util.observer.AppChangeObserver.onReceive(ZeroCamera:158)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.jb.ga0.commerce.util.observer.AppChangeObserver.access$100(ZeroCamera:18)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.jb.ga0.commerce.util.observer.AppChangeObserver$AppChangedReceiver.onReceive(ZeroCamera:215)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:768)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.os.Handler.handleCallback(Handler.java:733)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.os.Handler.dispatchMessage(Handler.java:95)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.os.Looper.loop(Looper.java:136)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at android.app.ActivityThread.main(ActivityThread.java:5017)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at java.lang.reflect.Method.invokeNative(Native Method)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at java.lang.reflect.Method.invoke(Method.java:515)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:794)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:610)\n06-13 05:14:08.044: E/SQLiteDatabase(1165):     at dalvik.system.NativeStart.main(Native Method)\n</code></pre>\n\n<h1>EDIT:</h1>\n\n<p>I have tried this:</p>\n\n<pre><code> LOGI(\"VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 1 REAL: %s\" ,reqParticipants.URI[idUser]);\nchar* callerTemp = reqParticipants.URI[idUser];\nLOGI(\"VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 12 REAL: %s\" ,callerTemp);\nLOGI(\"VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 13 REAL: %s\" ,strlen(callerTemp));\n*callerURI= (char *) malloc(sizeof(char *) * (strlen(callerTemp) + 1 ));\nstrcpy(callerURI, reqParticipants.URI[idUser]);\nLOGI(\"VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 2 REAL: %s\" ,reqParticipants.URI[idUser]);\nLOGI(\"VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 2 : %s\" ,callerURI);\n</code></pre>\n\n<p>But I only this gets logged:</p>\n\n<pre><code>06-13 05:40:27.294: I/VidyoMobile app/src/main/jni/ndkVidyoSample.c(19744): VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 1 REAL: scip:CsAPI1528869039-4c6-42722300022166be-d30ff886a73e0ebc;transport=TLS\n06-13 05:40:27.294: I/VidyoMobile app/src/main/jni/ndkVidyoSample.c(19744): VIDYO_CLIENT_OUT_EVENT_VIDEO_FRAME_RECEIVED AskViewType callerURI 12 REAL: scip:CsAPI1528869039-4c6-42722300022166be-d30ff886a73e0ebc;transport=TLS\n</code></pre>\n\n<p>So also strlen() crashes for some reason. Why is this?</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 2, "creation_date": 1528885092, "post_id": 50834656, "comment_id": 88673278, "body": "One possibility is that either <code>spi</code> or <code>Buffer</code> is a NULL pointer."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528885234, "post_id": 50834656, "comment_id": 88673363, "body": "If you catch the crash in a debugger, is the location in your code where you think it is? And what is the values of all involved variables when the crash happens?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1528885499, "post_id": 50834656, "comment_id": 88673532, "body": "you need use <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/wdm/nf-wdm-rtlequalunicodestring\" rel=\"nofollow noreferrer\"><code>RtlEqualUnicodeString</code></a> instead <code>wcscmp</code> here. and in first element <code>spi-&gt;ImageName.Buffer</code> is always 0"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 3, "creation_date": 1528885594, "post_id": 50834656, "comment_id": 88673594, "body": "<code>wcscmp</code> is for null-terminated strings. and the second argument that you pass is not null-terminated"}, {"owner": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "edited": false, "score": 0, "creation_date": 1529665677, "post_id": 50834656, "comment_id": 88967794, "body": "As an extension to the posts already here, if you plan on doing this one day in kernel-mode using routines like NtQuerySystemInformation, it is not always &quot;safe&quot;. You will not have a lock and thus the data you try to access with the structure (e.g. a pointer to the SYSTEM_PROCESS_INFORMATION structure) can change even whilst you&#39;re enumerating it, and thus could land you into a crash. Therefore, it is safer to let user-mode handle this, and just exchange results unless you truly need to do it in kernel-mode."}, {"owner": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "edited": false, "score": 0, "creation_date": 1529665845, "post_id": 50834656, "comment_id": 88967860, "body": "So under those circumstances, it would be a better idea to monitor process creation via PsSetCreateProcessNotifyRoutine/Ex/Ex2 and keep your own table of running processes (you can link up additional information like the process name, image path on disk, etc.), and just remove entries when the callback is invoked for termination for a process on your cache list. This is better than using Zw/NtQuerySystemInformation with SystemProcessInformation on-demand for the reasons I explained in the above comment. However only really applicable if your driver starts early and stays active."}], "answers": [{"comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 0, "creation_date": 1528887590, "post_id": 50835006, "comment_id": 88674780, "body": "@TotalAnimeImmersion - only by some error in your code. not in my answer"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 3, "last_activity_date": 1528886033, "creation_date": 1528886033, "answer_id": 50835006, "question_id": 50834656, "link": "https://stackoverflow.com/questions/50834656/wcscmp-access-violation-while-using-this-function/50835006#50835006", "title": "wcscmp - Access violation while using this function", "body": "<p>for compare <code>UNICODE_STRING</code> need use <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/wdm/nf-wdm-rtlequalunicodestring\" rel=\"nofollow noreferrer\"><code>RtlEqualUnicodeString</code></a> function, if we need use only ==, !=, or <a href=\"https://msdn.microsoft.com/en-us/library/mt708867(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>RtlCompareUnicodeString</code></a> if need >,&lt;,= . in general case <code>UNICODE_STRING</code> can be not 0 terminating, containing 0 internally or have  <code>Buffer == 0</code> - this is exactly your case (first element of <code>SYSTEM_PROCESS_INFORMATION</code> array containing <code>UNICODE_STRING</code> with all 0).</p>\n\n<p>so code for compare names can look like:</p>\n\n<pre><code>static const UNICODE_STRING Test = RTL_CONSTANT_STRING(L\"Test.exe\");\nRtlEqualUnicodeString(&amp;Test, &amp;pspi-&gt;ImageName, TRUE);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 0, "creation_date": 1528915943, "post_id": 50844291, "comment_id": 88692081, "body": "I just ignored the first entry where spi-&gt;ImageName.Buffer = NULL and then used wcscmp with the rest, seems to work fine, I&#39;ll switch it around with this, if it makes the application more robust!"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 1, "creation_date": 1528917615, "post_id": 50844291, "comment_id": 88692868, "body": "@TotalAnimeImmersion -instead of ignoring first entry - why not use only correct <code>RtlEqualUnicodeString</code> ? in concrete case <code>wcsncmp</code> will be work ok, but in general case - no, because <code>UNICODE_STRING</code> can have 0 symbols inside string"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1528919209, "post_id": 50844291, "comment_id": 88693731, "body": "<code>wcsncmp()</code> can handle NULL input.  A NULL string pointer is treated as a string with a length of 0 chars."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1528922818, "post_id": 50844291, "comment_id": 88695555, "body": "@remy RbMm means that the UNICODE_STRING contains null characters that are not terminators."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1528923049, "post_id": 50844291, "comment_id": 88695670, "body": "yes, i mean exactly this (0 characters inside string). as result in general case - <code>wcsncmp</code> can not correct handle <code>UNICODE_STRING</code> because it stop on first 0 characters. but in concrete case - when string containing process name - this never happens"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1528923068, "post_id": 50844291, "comment_id": 88695677, "body": "@DavidHeffernan I was referring to TotalAnime&#39;s comment about skipping <code>ImageName.Buffer == NULL</code>, not RbMm&#39;s comment about <code>UNICODE_STRING</code> containing nul characters"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1528915839, "creation_date": 1528915839, "answer_id": 50844291, "question_id": 50834656, "link": "https://stackoverflow.com/questions/50834656/wcscmp-access-violation-while-using-this-function/50844291#50844291", "title": "wcscmp - Access violation while using this function", "body": "<p><code>wcscmp()</code> expects null-terminated strings, but the <code>ImageName</code> is a <code>UNICODE_STRING</code>, which is not guaranteed to be null-terminated.  It has a <code>Length</code> member to indicate how many bytes it contains (divide that by <code>sizeof(WCHAR)</code> to get the number of characters).</p>\n\n<p>You can use <a href=\"https://msdn.microsoft.com/en-us/library/eywx8zcx.aspx\" rel=\"nofollow noreferrer\"><code>wcsncmp()</code></a> instead:</p>\n\n<pre><code>if (wcsncmp(L\"Test.exe\", spi-&gt;ImageName.Buffer, spi-&gt;ImageName.Length / sizeof(WCHAR)))\n</code></pre>\n\n<p>Otherwise, use <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/wdm/nf-wdm-rtlequalunicodestring\" rel=\"nofollow noreferrer\"><code>RtlEqualUnicodeString()</code></a> instead:</p>\n\n<pre><code>UNICODE_STRING fileName = RTL_CONSTANT_STRING(L\"Test.exe\");\nif (!RtlEqualUnicodeString(&amp;fileName, &amp;(spi-&gt;ImageName), FALSE))\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 50844291, "answer_count": 2, "score": 1, "last_activity_date": 1528915839, "creation_date": 1528884860, "question_id": 50834656, "link": "https://stackoverflow.com/questions/50834656/wcscmp-access-violation-while-using-this-function", "title": "wcscmp - Access violation while using this function", "body": "<p>Basically, I was trying to compare the <code>*PSYSTEM_PROCESS_INFO spi</code> (its ImageName field) with a string using <code>wcsmp</code> as follows :</p>\n\n<pre><code>if (wcscmp(L\"Test.exe\", spi-&gt;ImageName.Buffer))\n</code></pre>\n\n<p>This seems to give me an access violation error. Also from what I know, ImageName is of the type <code>UNICODE_STRING</code> and <code>UNICODE_STRING</code> structure uses <code>PWSTR</code> for the Buffer field. So is it right to compare 2 <code>PWSTR</code> using <code>wcscmp</code>? If not what are the alternatives to compare the <code>spi-&gt;ImageName.Buffer</code> to a string in C?</p>\n"}, {"tags": ["c", "void-pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528883311, "post_id": 50834072, "comment_id": 88672061, "body": "Functions. Make a set of functions for handling your special &quot;generic&quot; array. Then the code using the array only have to use your functions and don&#39;t have to bother with the details of how it is implemented. Then you can quite easily make it even <i>more</i> generic, to store any kind of homogeneous data (including structures)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1528883360, "post_id": 50834072, "comment_id": 88672084, "body": "On an unrelated note, remember that <a href=\"http://en.cppreference.com/w/c/memory/malloc\" rel=\"nofollow noreferrer\"><code>malloc</code></a> returns a <code>void *</code>, so the cast is not needed (and you shouldn&#39;t really <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">cast the result of <code>malloc</code> anyway</a>)."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1528884352, "post_id": 50834072, "comment_id": 88672782, "body": "In addition to Prog. Dude: May be, <a href=\"http://en.cppreference.com/w/c/algorithm/qsort\" rel=\"nofollow noreferrer\"><code>qsort()</code></a> can provide some inspiration. It implements the sorting of arrays in C-like generic way - sounds a bit similar to what you intend to do."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1528885254, "post_id": 50834072, "comment_id": 88673377, "body": "How do you return <code>newArr</code> from this function? It&#39;s also unclear why you need to multiply the floating point number with anything (<code>iBase</code>?) before casting? What it the exact input and output of this function?"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1528885522, "post_id": 50834072, "comment_id": 88673539, "body": "Having a single function do three different things looks like there are three smaller functions trying to get out. Consider using <code>foo8(x,y)</code> instead of <code>foo(x,y,8)</code>."}, {"owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528890216, "post_id": 50834072, "comment_id": 88676418, "body": "thx for the answers with possible solution. I personal perfer the qsort and Prog. Dude&#39;s solution, since they make my code stay clean..."}, {"owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1528890470, "post_id": 50834072, "comment_id": 88676573, "body": "@Groo i would not like to put the whole code since the rest part isn&#39;t relativ to this question as well as they may confuse the people with where the problem is. I multiply iBase before casting is just because i am transforming the floating format of a audiodate to fixpoint format, newArr will be written to a file and if i need the result, i will add a pointer as parameter to get newArr. But again, do u really need these information in order to help with &quot;how to save a switch case&quot; or &quot;how to implement a dynamic type of variable&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1528886328, "post_id": 50835047, "comment_id": 88673989, "body": "Anyway, please try and post well-defined, compilable code next time. You allocing <code>sizeof(int8_t)*len</code>  where you likely meant <code>sizeof(int16_t)*len</code> (or you go out of bounds in the second switch) is confusing."}, {"owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528890678, "post_id": 50835047, "comment_id": 88676731, "body": "thank with the reply, yes it was a mistake (meant sizeof(int16_t)*len). could u pls explain me, what have your second code block done? especially the ((void (<i>[])(void *,double const</i>, int)){ [1]=to8, [2]=to16, [4]=to32, })[iBits](newArr,arr,len); it kinda confusing for me to understand what happens there, thx again"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528891092, "post_id": 50835047, "comment_id": 88676999, "body": "<code>MK_FN</code> makes the functions <code>to8</code>, <code>to16</code>, and <code>to32</code> (<code>##</code>-does token concatenation, but I think the macro part should be clear; run <code>gcc -E</code> to see the pp output if it isn&#39;). The functions incorporate the loop too because with function call overhead, keeping the loop would slow things down unnecessarily.  Now to the weird part. It could be written as <code>void (*functions[5])(void *,double const*, int) = { [0]=NULL,  [1]=to8, [2]=to16, [3]=NULL, [4]=to32 }; (functions[iBits])(newArr,arr,len);</code> I&#39;m just using a compound literal, inferred array sizing and implicit zeroing to make things compact."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528891233, "post_id": 50835047, "comment_id": 88677111, "body": "@user152531 The second piece is indeed a little convoluted, which is why I think the switch is preferable."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528891420, "post_id": 50835047, "comment_id": 88677248, "body": "I&#39;m going easy on the casts too. C casts are powerful and dangerous (why C++ splits them into static_cast&#39;s and reinterpret_cast&#39;s). It&#39;s best to avoid them as much as possible."}, {"owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528891486, "post_id": 50835047, "comment_id": 88677293, "body": "ah yes, macro part is clear i know that but barely use that. the part of void (*functions[5]) is still not understandable for me, it seems a new syntax for me, do u have any links or literature for help? thx"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528891725, "post_id": 50835047, "comment_id": 88677424, "body": "It&#39;s not new syntax. It&#39;s the old convoluted declaration syntax C has always had. (the initializer with the targeted indices (<code>[5]=something</code>) is newer) <code>typedef void (*the_fn_ptr_tp)(void *, const double*, int); the_fn_ptr_tp functions[5];</code> is how you could rewrite it with a <code>typedef</code>. In human speak, it&#39;s an array of 5 functions pointers (some NULL) and you use <code>iBits</code> as index to select the one you want."}, {"owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "edited": false, "score": 0, "creation_date": 1528891878, "post_id": 50835047, "comment_id": 88677524, "body": "ah, ok i understand now, just haven&#39;t thought in the way of typedef"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 0, "last_activity_date": 1528887635, "last_edit_date": 1528887635, "creation_date": 1528886142, "answer_id": 50835047, "question_id": 50834072, "link": "https://stackoverflow.com/questions/50834072/dynamic-type-variable-with-void-pointer-eventuelly-dynamic-typecasting-in-c/50835047#50835047", "title": "dynamic type variable with void pointer (eventuelly dynamic typecasting) in C", "body": "<p>Making a few assumptions about what you probably meant where your example code is undefined (commented), here's how I might do it:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\nvoid *foo(double * arr, int len, int iBits)  //should return the malloced array not void\n{\n      void * newArr;\n      int iBytePerElement, iBase, i;\n\n      iBytePerElement = iBits / 8;\n      iBase = (1 &lt;&lt; (iBits - 1)) - 1;\n\n      if(NULL==(newArr = malloc(iBits/CHAR_BIT))) return NULL; //replace the first switch\n      //which obviously meant to alloc sizeof(int16_t)*len in the case 2 branch (not (sizeof(int8_t)*len) etc\n\n      for (i = 0; i &lt; len; ++i) {\n          switch(iBytePerElement){\n          break; case 1: ((int8_t *)newArr)[i] = arr[i]*iBase; \n          break; case 2: ((int16_t *)newArr)[i] = arr[i]*iBase;\n          break; case 4: ((int32_t *)newArr)[i] = arr[i]*iBase;\n          }\n      }\n      return newArr;\n}\n</code></pre>\n\n<p>Basically, you only need the second switch.</p>\n\n<p>If you wanted to get rid of the 2nd switch, you could replace it with some function pointer play.\nFor example:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n\n#define MK_FN(Bits) \\\nvoid to##Bits(void *newArr, double const*arr, int len) \\\n{ \\\n    int i; for(i=0; i &lt; len; i++) ((int##Bits##_t *)newArr)[i] = arr[i]*((1&lt;&lt;(Bits-1)-1));  \\\n} \nMK_FN(8)\nMK_FN(16)\nMK_FN(32)\n\n\n\nvoid *foo(double * arr, int len, int iBits)  //should return the malloced array not void\n{\n      void * newArr;\n      int iBytePerElement = iBits / 8;\n\n      if(NULL==(newArr = malloc(iBits/CHAR_BIT))) return NULL;\n      ((void (*[])(void *,double const*, int)){ [1]=to8, [2]=to16, [4]=to32, })[iBits](newArr,arr,len);\n      return newArr;\n}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 50835047, "answer_count": 1, "score": 1, "last_activity_date": 1528891291, "creation_date": 1528883065, "last_edit_date": 1528891291, "question_id": 50834072, "link": "https://stackoverflow.com/questions/50834072/dynamic-type-variable-with-void-pointer-eventuelly-dynamic-typecasting-in-c", "title": "dynamic type variable with void pointer (eventuelly dynamic typecasting) in C", "body": "<p>im just came into the question with dynamic type of variable (not really dynamic, but should be determind in the runtime), the situation is like this:</p>\n\n<p>i have a function which accept a double array convert it into the integer and write to a file, the integer can have different Bitlength, like 8, 16 and 32. As it is a array, i want to use a pointer to access the final result (array). So i use the void pointer with malloc and switch case now, but it will be needed to add switch case every where when i trying to access or modify this array, my question is, is there a better way to do this?</p>\n\n<p>current code is like:</p>\n\n<pre><code>void foo(double * arr, int len, int iBits, FILE *fh)\n{\n      void * newArr;\n      int iBytePerElement, iBase,i;\n\n      iBytePerElement = iBits / 8;\n      iBase = (1 &lt;&lt; (iBits - 1)) - 1;\n\n      switch (iBytePerElement)\n      {\n             case 1:\n                  {\n                         newArr = (int8_t *) malloc(sizeof(int8_t)*len);\n                         break;\n                  }\n             case 2:\n                  {\n                         newArr = (int16_t *) malloc(sizeof(int16_t)*len);\n                         break;\n                  }\n             case 4:\n                  {\n                         newArr = (int32_t *) malloc(sizeof(int32_t)*len);\n                         break;\n                  }\n      }\n\n      for (i = 0; i &lt; len; ++i)\n      {\n              switch (iBitPerElement)\n              {\n                     case 1:\n                          {\n                                ((int8_t *)newArr)[i] = (int8_t)(arr[i]*iBase);\n                                 break;\n                          }\n                     case 2:\n                          {\n                                ((int16_t *)newArr)[i] = (int16_t)(arr[i]*iBase);\n                                 break;\n                          }\n                     case 4:\n                          {\n                                ((int32_t *)newArr)[i] = (int32_t)(arr[i]*iBase);\n                                 break;\n                          }\n              }\n      }\n      fwrite(newArr, iBytePerElement, iBytePerElement*len,fh);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "sizeof", "realloc", "dynamic-allocation"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1528882800, "post_id": 50833961, "comment_id": 88671665, "body": "What is <code>int *amount = 9;</code> supposed to do? That makes <code>amount</code> <i>point to address <code>9</code></i>, and there&#39;s probably not anything useful there. Why make <code>amount</code> a pointer to begin with? What problem is that supposed to solve?"}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 1, "creation_date": 1528882803, "post_id": 50833961, "comment_id": 88671667, "body": "One curious thing is that you assing 9 to int pointer."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1528882993, "post_id": 50833961, "comment_id": 88671824, "body": "Yeah - why a pointer?  Get rid of that star!"}, {"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528883769, "post_id": 50833961, "comment_id": 88672359, "body": "@Someprogrammerdude As far as I know, you can immediately initialise the value of which the pointer is pointing when you&#39;re declaring the variable, thus <code>int *amount = 9;</code>. I tried doing this instead: <code>int *amount</code> and <code>amount = 9;</code> and it turnt out to be the same. I assume what I&#39;m doing is correct (as I also remember my lecturer telling me that)? Also, I am trying to pass it by reference later on to a function. Is there another way I can do that?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528883934, "post_id": 50833961, "comment_id": 88672475, "body": "If you want to <i>emulate</i> &quot;pass by reference&quot; you pass a pointer to a variable using the address-of operator <code>&amp;</code>. As in <code>int amount = 9; ...; some_function(&amp;amount);</code> and use the dereference operator <code>*</code> to access what the pointer is pointing to inside the function."}, {"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528884677, "post_id": 50833961, "comment_id": 88672994, "body": "@Someprogrammerdude I see, thank you! However, what did I do wrong in my previous code? Isn&#39;t it supposed to be correct?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528885183, "post_id": 50833961, "comment_id": 88673327, "body": "As I said in my first comment, <code>int *amount = 9;</code> makes <code>amount</code> <i>point to the address <code>9</code></i>. It doesn&#39;t make <code>amount</code> point to some integer which have the value <code>9</code>, that would be something like <code>int real_amount = 9; int *amount = &amp;real_amount;</code>"}, {"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528885346, "post_id": 50833961, "comment_id": 88673421, "body": "@Someprogrammerdude Hmm... I see. Thank you once again for the answers :-D!"}], "answers": [{"comments": [{"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1528884641, "post_id": 50834263, "comment_id": 88672967, "body": "I don&#39;t quite understand what you meant by &quot;A pointer should only be a null pointer of point to a valid object&quot; and &quot;only use that for memory mapped hardware registers&quot;. Could you explain them in simpler terms?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1528889182, "post_id": 50834263, "comment_id": 88675753, "body": "@WealthyPlayer: A pointer should only be assigned addresses. <code>int a; int *pt = &amp;a</code>, null, <code>int *pt = NULL;</code> of values of other pointers <code>int a; int *pa = &amp;a; int *pb = pa;</code>. <code>int *amount = xxx;</code> where xxx is an integer value is a code smell. The only correct use case I know is when you directly access the hardware (in kernel mode or embedded systems). In that case you may have io ports or display memory mapped at well known addresses. For example in MS/DOS, the text screen display was mapped at address 0xB0000."}, {"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1528889625, "post_id": 50834263, "comment_id": 88676038, "body": "Ah! I see, I think you meant &quot;or&quot; instead of &quot;of&quot;? Thank you!"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1528890019, "post_id": 50834263, "comment_id": 88676291, "body": "@WealthyPlayer: Yes, and sorry for it. <code>F</code> and <code>R</code> keys are too close for me :-("}, {"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1529034087, "post_id": 50834263, "comment_id": 88739404, "body": "No problem :-) You&#39;ve answered my questions, I should be thanking you."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1528883607, "creation_date": 1528883607, "answer_id": 50834263, "question_id": 50833961, "link": "https://stackoverflow.com/questions/50833961/using-realloc-by-multiplying-a-pointer-integer-and-sizeofint-not-working/50834263#50834263", "title": "Using realloc by multiplying a pointer integer and sizeof(int) not working", "body": "<p>You are just using the fact that your implementation allows for safe conversion between pointers and integers, but this:</p>\n\n<pre><code>int *amount = 9;      // only use that for memory mapped hardware registers\nprintf(\"%d\", amount); //re-interpreting the pointer value as an int\narray = realloc(array, amount * sizeof(int));   // hopefully you got a diagnostic\n</code></pre>\n\n<p>is terrible. A pointer should only be a null pointer of point to a valid object. Full stop. And pointer arithmetics only makes sense inside an array.</p>\n\n<p>If a variable is supposed to contain integer values, then it shall be of an integer type:</p>\n\n<pre><code>int amount = 9;\nprintf(\"%d\", amount); //Printing\narray = realloc(array, amount * sizeof(int)); //Problem is here\n</code></pre>\n\n<p>If you need a pointer to it, just declare it and use it <em>as a pointer</em>:</p>\n\n<pre><code>int amount = 9;\nint *p_amount = &amp;amount;\nprintf(\"%d - %d\\n\", amount, *p_amount); //Printing\narray = realloc(array, (*p_amount) * sizeof(int)); //No problem now\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1528885675, "post_id": 50834547, "comment_id": 88673626, "body": "Hmm I see. So is it safe to say that from the very beginning (i.e. <code>int *amount = 9</code>), I&#39;ve already misinterpreted the meaning of that line? I think I know how it works now, I&#39;ve also tried reading <a href=\"https://www.gribblelab.org/CBootCamp/8_Pointers.html\" rel=\"nofollow noreferrer\">gribblelab.org/CBootCamp/8_Pointers.html</a> while waiting for an answer. Thank you!"}, {"owner": {"reputation": 11, "user_id": 9924182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4774bfab35743ebee36ad85480244023?s=128&d=identicon&r=PG&f=1", "display_name": "Iead", "link": "https://stackoverflow.com/users/9924182/iead"}, "reply_to_user": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1528889844, "post_id": 50834547, "comment_id": 88676180, "body": "yes. You wanted something that points to the value 9, but got something that points to position 9. Sometimes C and C++ can be quiet tricky to what a line exactly means."}], "tags": [], "owner": {"reputation": 11, "user_id": 9924182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4774bfab35743ebee36ad85480244023?s=128&d=identicon&r=PG&f=1", "display_name": "Iead", "link": "https://stackoverflow.com/users/9924182/iead"}, "is_accepted": false, "score": 1, "last_activity_date": 1528884499, "creation_date": 1528884499, "answer_id": 50834547, "question_id": 50833961, "link": "https://stackoverflow.com/questions/50833961/using-realloc-by-multiplying-a-pointer-integer-and-sizeofint-not-working/50834547#50834547", "title": "Using realloc by multiplying a pointer integer and sizeof(int) not working", "body": "<p><code>amount</code> has the type <code>int *</code>. The reason <code>printf</code> prints 9 is not that <code>amount</code> points to the value 9, but rather it is the value 9 casted to a pointer.</p>\n\n<p>Now in your <code>array = realloc(array, amount * sizeof(int));</code> statement. You try to multiply the pointer (not the value pointed to by <code>amount</code>). Ask yourself what the semantics of that should be. Rather than <code>int *amount = 9;</code> you probably want</p>\n\n<pre><code>int *amount = calloc(1, sizeof(int));\n*amount = 9;\n</code></pre>\n\n<p>which declares a pointer and allocates space for one integer and rather than <code>array = realloc(array, amount * sizeof(int));</code> you probably want</p>\n\n<pre><code>array = realloc(array, *amount * sizeof(int));\n</code></pre>\n\n<p>you should try to learn the concept of pointers and pointer arithmetics. Just declaring a pointer does not reserve space at the end of it.</p>\n"}, {"tags": [], "owner": {"reputation": 3268, "user_id": 182634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d5b602ab0bc363e3e990f2e904b671d?s=128&d=identicon&r=PG", "display_name": "eyalm", "link": "https://stackoverflow.com/users/182634/eyalm"}, "is_accepted": false, "score": 0, "last_activity_date": 1528885167, "creation_date": 1528885167, "answer_id": 50834757, "question_id": 50833961, "link": "https://stackoverflow.com/questions/50833961/using-realloc-by-multiplying-a-pointer-integer-and-sizeofint-not-working/50834757#50834757", "title": "Using realloc by multiplying a pointer integer and sizeof(int) not working", "body": "<p><code>amount</code> should be defined as an <code>int</code> and not <code>int *</code>.</p>\n\n<pre><code>int amount = 9;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1529034000, "post_id": 50837634, "comment_id": 88739391, "body": "I see, thank you for the very clear answer! Some questions, though, how or when does <code>realloc</code> fail to work? Is it very technical and a difficult issue and should I just ignore it for now? And thank you for the tip about using <code>sizeof(pointervariable)</code> instead of typing the variable type explicitly :-D"}, {"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1529034348, "post_id": 50837634, "comment_id": 88739443, "body": "Oh and how do I print out the memory address of which the pointer is pointing (i.e. what type should I use since <code>%d</code> is incorrect)?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1529035150, "post_id": 50837634, "comment_id": 88739571, "body": "@WealthyPlayer: Use <code>%p</code> to print pointer values.  <code>realloc</code> will fail if there\u2019s not a large enough chunk of available memory to satisfy the request.  That won\u2019t happen unless you\u2019re trying to set aside <i>very large</i> chunks of memory, or if you\u2019ve made a very large number of small allocations such that the heap is very fragmented (i.e., you may have so many Mb available, but not in a single, contiguous block).  I\u2019ve never encountered it in practice, but it\u2019s something to be aware of."}, {"owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "edited": false, "score": 0, "creation_date": 1529043116, "post_id": 50837634, "comment_id": 88741628, "body": "Okay thank you! I&#39;ve read this too (and the answer was also from you :-D): <a href=\"https://stackoverflow.com/questions/18217525/why-or-when-do-you-need-to-dynamically-allocate-memory-in-c\" title=\"why or when do you need to dynamically allocate memory in c\">stackoverflow.com/questions/18217525/&hellip;</a> and I found it very helpful on trying to understand for what purpose dynamic memory allocation is."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1528893864, "creation_date": 1528893864, "answer_id": 50837634, "question_id": 50833961, "link": "https://stackoverflow.com/questions/50833961/using-realloc-by-multiplying-a-pointer-integer-and-sizeofint-not-working/50837634#50837634", "title": "Using realloc by multiplying a pointer integer and sizeof(int) not working", "body": "<p>A couple of things:</p>\n\n<p>First,</p>\n\n<pre><code>int *amount = 9;\n</code></pre>\n\n<p>does not do the same thing as </p>\n\n<pre><code>*amount = 9;\n</code></pre>\n\n<p>In the first case, the <code>*</code> is only there to indicate that <code>amount</code> has pointer type, and we are initializing the <em>pointer</em> value (i.e, the address) to <code>9</code>, which is most likely not a valid pointer value, and attempting to dereference it may lead to a runtime error.  </p>\n\n<p>In the second case, we are assigning the integer value <code>9</code> to the object <code>amount</code> is pointing to.</p>\n\n<p>Why didn\u2019t this break when you passed <code>amount</code> to <code>printf</code>?  Basically, you invoked undefined behavior by passing an argument of the wrong type (<code>%d</code> expects an <code>int</code>, you passed an <code>int *</code>).  One of the possible results of undefined behavior is getting the expected result.  For whatever reason, <code>printf</code> was able to treat that <code>int *</code> value as an <code>int</code>.  Most compilers should flag that type mismatch, but you may heed to crank up the warning level to see it.</p>\n\n<p>There\u2019s a constraint on the binary <code>*</code> operator that both operands have arithmetic type.  <code>int *</code> is not an arithmetic type, hence the diagnostic.</p>\n\n<p>Based on how you are actually using <code>amount</code> in your code, you should not have declared it as a pointer, but as a regular <code>int</code>:</p>\n\n<pre><code>int amount = 9;\n</code></pre>\n\n<p>Secondly, as a rule, you do not want to assign the result of <code>realloc</code> to the original pointer.  If <code>realloc</code> fails, it will return <code>NULL</code> and leave the original block of memory as-is.  However, if you assign that <code>NULL</code> back to your original pointer, you will lose any access to that memory.  Best practice is to assign the result of <code>realloc</code> to a temporary, and then verify that the temporary is valid before assigning it back to the original:</p>\n\n<pre><code>int *tmp = realloc( array, amount * sizeof *array );\nif ( tmp )\n{\n  array = tmp;\n}\nelse\n{\n  // handle realloc error\n}\n</code></pre>\n\n<p>Note the use of <code>sizeof *array</code> instead of <code>sizeof (int)</code>.  <code>sizeof</code> is an operator like unary <code>*</code> or unary <code>+</code>, and its operand can either be a parenthesized type name or an expression.  The <em>expression</em> <code>*array</code> has type <code>int</code>, so <code>sizeof *array == sizeof (int)</code>.  This helps make code a bit easier to read, and if you ever change the type of <code>array</code> (say to <code>double *</code>), you won\u2019t have to update the <code>realloc</code> call.  It\u2019s also very useful when allocating multidimensional array types - would you rather write</p>\n\n<pre><code>int (*arr)[10] = malloc( sizeof (int) * 10 * rows);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int (*arr)[10] = malloc( sizeof *arr * rows );\n</code></pre>\n\n<p>?</p>\n"}], "owner": {"reputation": 5853, "user_id": 9060223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCtnx.png?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9060223/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 50837634, "answer_count": 4, "score": -1, "last_activity_date": 1528893864, "creation_date": 1528882724, "question_id": 50833961, "link": "https://stackoverflow.com/questions/50833961/using-realloc-by-multiplying-a-pointer-integer-and-sizeofint-not-working", "title": "Using realloc by multiplying a pointer integer and sizeof(int) not working", "body": "<p>Code:</p>\n\n<pre><code>void main() {\n    int *array = calloc(5, sizeof(int));\n    int *amount = 9;\n    array[0] = 1;\n    array[1] = 2;\n    array[3] = 5;\n\n    int i = 0;\n    while (i &lt; 5) {\n        printf(\"%d \", array[i]);\n        i += 1;\n    }\n\n    printf(\"%d\", amount); //Printing\n    array = realloc(array, amount * sizeof(int)); //Problem is here\n    printf(\"\\n\");\n    i = 0;\n    while (i &lt; 9) {\n        printf(\"%d \", array[i]);\n        i += 1;\n    }\n    free(array);\n}\n</code></pre>\n\n<p>It says \"invalid operands to binary * (have 'int *' and 'unsigned int'), but when I tried printing \"amount\", it's actually 9? I'm trying to use a pointer integer so that I can pass it by reference.</p>\n"}, {"tags": ["c", "linked-list"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9934879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7833a51be39aff0a75b2ca98573ea5?s=128&d=identicon&r=PG", "display_name": "Fever", "link": "https://stackoverflow.com/users/9934879/fever"}, "is_accepted": false, "score": 0, "last_activity_date": 1528882894, "creation_date": 1528882894, "answer_id": 50834011, "question_id": 50833877, "link": "https://stackoverflow.com/questions/50833877/what-is-the-name-of-node-after-pushing-the-new-node-as-a-head-in-c/50834011#50834011", "title": "What is the name of node after pushing the new node as a head in c?", "body": "<p>Head will always be your first list node. If you want to have access to the second one, you will use <code>head-&gt;next</code>.</p>\n\n<p>When you add a new element in a list, your current node becomes the next pointer of the new node, and the new node pointer becomes the head.</p>\n\n<p>If you want to have access to the third, then you need to have access to the next pointer of the next pointer of the new head, which makes it <code>head-&gt;next-next</code></p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 0, "last_activity_date": 1528884487, "last_edit_date": 1528884487, "creation_date": 1528883233, "answer_id": 50834129, "question_id": 50833877, "link": "https://stackoverflow.com/questions/50833877/what-is-the-name-of-node-after-pushing-the-new-node-as-a-head-in-c/50834129#50834129", "title": "What is the name of node after pushing the new node as a head in c?", "body": "<p><em>What if I want print from the second node?</em>  for this pass the particular node address to <code>printlist()</code> function.</p>\n\n<p>For e.g in your main function, after creating the linked list ask the user from which node you want to print. Let's say <code>n=2</code></p>\n\n<p>For e.g</p>\n\n<p><code>InsertNodeAtFirst(&amp;head);</code></p>\n\n<p><code>struct node *temp = head;</code></p>\n\n<p><code>/* make temp to point to the node which you want */</code></p>\n\n<p><code>/* Find particular node address from where you want to print */</code></p>\n\n<p><code>for(int row= 0; row &lt; n; row++){</code></p>\n\n<pre><code>   if(temp-&gt;next != NULL)\n\n           temp = temp-&gt;next;\n</code></pre>\n\n<p><code>}</code></p>\n\n<p>And now call the <code>printlist()</code> as</p>\n\n<p><code>printlist(temp);</code></p>\n\n<p><em>I also learned that random access is not possible in linked list ?</em> it's only possible  if you know the address of that node &amp; to get that, you have to traverse from <code>head</code> node.</p>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1528884347, "creation_date": 1528884347, "answer_id": 50834495, "question_id": 50833877, "link": "https://stackoverflow.com/questions/50833877/what-is-the-name-of-node-after-pushing-the-new-node-as-a-head-in-c/50834495#50834495", "title": "What is the name of node after pushing the new node as a head in c?", "body": "<blockquote>\n  <p>When I insert a node at front, I made it as a head. So whenever I want\n  to print, I'll call the printlist(head). What if I want print from the\n  second node? Initially I named it as head. Now what will it be?</p>\n</blockquote>\n\n<p>The name <code>head</code> refers to the head, the expression <code>head-&gt;next</code> refers to the element that follows the head, etc.</p>\n\n<blockquote>\n  <p>I also learned that random access is not possible in linked list. But\n  I can print from wherever node I want. Please clarify.</p>\n</blockquote>\n\n<p><strong>Random access</strong> has special meaning. It means that you are able to access any element you want, generally with its index, in <strong>an efficient way</strong>. There is no random access possible in a true linked list because if you want to access element n, you need to start from head, then find next, then next, etc. So the total cost to access element n is n operations. This is not really efficient as the number of operations needed to access an element increases with the index of that element. Very common random access structures are arrays.</p>\n"}], "owner": {"reputation": 3, "user_id": 8182385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3Dx1B6IeV-c/AAAAAAAAAAI/AAAAAAAAVj8/UJu65YrzASk/photo.jpg?sz=128", "display_name": "Sandy JN", "link": "https://stackoverflow.com/users/8182385/sandy-jn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 50834129, "answer_count": 3, "score": 0, "last_activity_date": 1528884487, "creation_date": 1528882495, "question_id": 50833877, "link": "https://stackoverflow.com/questions/50833877/what-is-the-name-of-node-after-pushing-the-new-node-as-a-head-in-c", "title": "What is the name of node after pushing the new node as a head in c?", "body": "<p>I started learning the linked list. I've pasted my code down below. I have one doubt. When I insert a node at front, I made it as a head. So whenever I want to print, I'll call the printlist(head). What if I want print from the second node? Initially I named it as head. Now what will it be? I also learned that random access is not possible in linked list. But I can print from wherever node I want. Please clarify.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct node{\n    char data;\n    struct node* next;\n};\n\nvoid printlist(struct node* n)\n{\n    while(n!=NULL)\n    {\n        printf(\"%c\\n\",n-&gt;data);\n        n=n-&gt;next;\n    }\n}\n\nvoid InsertNodeAtFirst(struct node** head_ref)\n{\n    printf(\"Node insertion at first\\n\");\n    struct node* newnode = (struct node*)malloc(sizeof(struct node*));\n    newnode-&gt;data='a';\n    newnode-&gt;next= *head_ref;\n    *head_ref = newnode;\n    printf(\"\\n\");\n    printlist(newnode);\n}\n\nvoid InsertNodeAfter(struct node* previous_node)\n{\n    if(previous_node==NULL)\n        printf(\"Previous node cannot be blank or NULL\\n\");\n\n    printf(\"Node insertion at middle\\n\");   \n    struct node* middlenode = (struct node*)malloc(sizeof(struct node*));\n    middlenode-&gt;data='c';\n    middlenode-&gt;next=previous_node-&gt;next;\n    previous_node-&gt;next = middlenode;\n    printf(\"\\n\");\n    printlist(previous_node);\n}\n\nvoid InsertNodeAtEnd(struct node** LastNode)\n{\n    printf(\"Node insertion at End\\n\");\n    struct node* newnode = (struct node*)malloc(sizeof(struct node*));\n    struct node* last = *LastNode;\n\n    newnode-&gt;data='f';\n    newnode-&gt;next=NULL;\n\n    while(last-&gt;next!=NULL)\n    {\n        last=last-&gt;next;\n    }\n\n    last-&gt;next=newnode;\n    printf(\"\\n\");\n\n}\n\nint main(void)\n{\n    struct node* head = (struct node*)malloc(sizeof(struct node*));\n    struct node* second = (struct node*)malloc(sizeof(struct node*));\n    struct node* third = (struct node*)malloc(sizeof(struct node*));\n\n    head-&gt;data='b';\n    head-&gt;next=second;\n    second-&gt;data='d';\n    second-&gt;next=third;\n    third-&gt;data='e';\n    third-&gt;next=NULL;\n\n    printlist(head);\n    InsertNodeAtFirst(&amp;head);\n    InsertNodeAfter(head);\n    InsertNodeAtEnd(&amp;head);\n    printlist(head);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2651, "user_id": 3371258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmVpr.png?s=128&g=1", "display_name": "Candy Gumdrop", "link": "https://stackoverflow.com/users/3371258/candy-gumdrop"}, "edited": false, "score": 1, "creation_date": 1528882782, "post_id": 50833814, "comment_id": 88671651, "body": "<a href=\"https://stackoverflow.com/questions/13366083\">This question</a> seems like a better duplicate target to me."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1528882997, "post_id": 50833814, "comment_id": 88671829, "body": "nice find, added"}], "owner": {"reputation": 161, "user_id": 1252254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b2acb10284bf94e3d16c9ddfd838a86?s=128&d=identicon&r=PG", "display_name": "Fran&#231;ois", "link": "https://stackoverflow.com/users/1252254/fran%c3%a7ois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "closed_date": 1528882469, "answer_count": 0, "score": 1, "last_activity_date": 1528882932, "creation_date": 1528882324, "question_id": 50833814, "link": "https://stackoverflow.com/questions/50833814/in-c-why-were-two-different-operators-and-defined-to-work-with-structure", "closed_reason": "Duplicate", "title": "In C, why were two different operators (. and -&gt;) defined to work with structures?", "body": "<p>Let's be clear:</p>\n\n<p><strong>I know the difference between the . and the -> operators</strong></p>\n\n<p>When working with a structure, the . operator is a simple offset added to the address of the structure. When working with a pointer to a structure, the -> operator first dereferences the pointer and then adds the offset.</p>\n\n<p>My question is: <strong>Why were two operators introduced in the first place?</strong></p>\n\n<p>The compiler obviously knows whether I'm working with a structure or with a pointer to a structure, so it shouldn't require me to use the proper operator. With the single . operator, it could dereference the pointer by itself first <strong>if</strong> working with a pointer to a structure.</p>\n\n<p>I ask myself this question every single time I use the improper operator, and I couldn't find the answer.</p>\n"}, {"tags": ["c", "binary", "int", "hex"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1528882283, "post_id": 50833695, "comment_id": 88671331, "body": "Please create <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your current implementation."}, {"owner": {"reputation": 45, "user_id": 8747585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-liLv1rOaWo4/AAAAAAAAAAI/AAAAAAAAAAo/fYLAst2Gu9o/photo.jpg?sz=128", "display_name": "Appie", "link": "https://stackoverflow.com/users/8747585/appie"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1528883060, "post_id": 50833695, "comment_id": 88671886, "body": "I hope it&#39;s clear by now, thx!"}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 8747585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-liLv1rOaWo4/AAAAAAAAAAI/AAAAAAAAAAo/fYLAst2Gu9o/photo.jpg?sz=128", "display_name": "Appie", "link": "https://stackoverflow.com/users/8747585/appie"}, "is_accepted": true, "score": 0, "last_activity_date": 1528891528, "creation_date": 1528891528, "answer_id": 50836861, "question_id": 50833695, "link": "https://stackoverflow.com/questions/50833695/reading-bin-file-as-int16/50836861#50836861", "title": "Reading bin file as int16", "body": "<p>Never mind, I solved it.</p>\n\n<p>in the function <code>Push</code> I should've used <code>int8_t</code> instead of <code>int32_t</code></p>\n"}], "owner": {"reputation": 45, "user_id": 8747585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-liLv1rOaWo4/AAAAAAAAAAI/AAAAAAAAAAo/fYLAst2Gu9o/photo.jpg?sz=128", "display_name": "Appie", "link": "https://stackoverflow.com/users/8747585/appie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 50836861, "answer_count": 1, "score": 0, "last_activity_date": 1528891528, "creation_date": 1528882000, "last_edit_date": 1528882877, "question_id": 50833695, "link": "https://stackoverflow.com/questions/50833695/reading-bin-file-as-int16", "title": "Reading bin file as int16", "body": "<p>After reading a binary file into my program, I have a <code>D6</code> which is <code>HEX</code>. \nThe problem is I get <code>214</code> instead of <code>-42</code> from the interpretation <code>D6</code>. After lots of research on the internet, I understood that I need to use <code>int16</code> to get <code>-42</code>. \nCan someone please tell me how I can do this in C? </p>\n\n<p>It's a very long file of code, I tried as minimum as possible to post my code here:</p>\n\n<pre><code>uint32_t prog_size;\nbyte_t *text_buffer;\nint program_counter = 0;\nfread(&amp;prog_size,sizeof(uint32_t),1,fp); // you can assume the first 4 bytes \n                                         //of the binary code indicates the \n                                         //size of the program\nprog_size = swap_uint32(prog_size); // for little-endianness\ntext_buffer = malloc(sizeof(byte_t)*prog_size);\nfread(text_buffer,sizeof(byte_t),prog_size,fp);\n\nvoid match(int program_counter)\n{\n    switch (text_buffer[program_counter])\n    {\n      case OP_BIPUSH:\n        program_counter++;\n        push(text_buffer[program_counter]);\n        break;\n    }\n}\nprintf printf(\"%u\\n\", text_buffer[program_counter] );\n// assume that text_buffer[program_counter] is D6 in HEX\n</code></pre>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["c", "windows", "mingw", "openmp", "libgomp"], "owner": {"reputation": 2274, "user_id": 498981, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce68ec2df353b8c31749686e40ed1eb8?s=128&d=identicon&r=PG", "display_name": "Piotr Lopusiewicz", "link": "https://stackoverflow.com/users/498981/piotr-lopusiewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1528968143, "creation_date": 1528881979, "last_edit_date": 1528968143, "question_id": 50833682, "link": "https://stackoverflow.com/questions/50833682/openmp-not-seeing-all-the-cpus", "title": "OpenMP not seeing all the CPUs", "body": "<p>I use OpenMP with MinGW on Windows. GCC version 7.2.0 x86-64-posix-sev-rev1, Built by MinGW-W64 project.\nOn a computer with 2 x Xeon E5-2699 V4 running Windows Server 2016. I am running:</p>\n\n<pre><code>printf(\"%d \", omp_get_num_procs());\nprintf(\"%d \", omp_get_max_threads());\nprintf(\"%d \", omp_get_thread_limit());\nprintf(\"%d \", omp_get_proc_bind());\n</code></pre>\n\n<p>which produces:</p>\n\n<pre><code>44, 44, 2147483647, 0\n</code></pre>\n\n<p>There are 44 physical cores total with hyperthreading. OpenMP doesn't see one of the CPUs at all.</p>\n\n<p>EDIT:\nAfter confirming the same code works correctly with CLang and looking into source of libgomp I discovered it's related to implementation of libgomp. They use old way to count processors on Windows (iterating over output of GetProcessAffinityMask which only works if there are less than 64 logical cores on the system)</p>\n"}, {"tags": ["c", "encoder"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528880185, "post_id": 50833008, "comment_id": 88669972, "body": "can it be turned more than 180 degrees at a time ?"}, {"owner": {"reputation": 130, "user_id": 1036372, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cjnmW.png?s=128&g=1", "display_name": "ifraaank", "link": "https://stackoverflow.com/users/1036372/ifraaank"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528880288, "post_id": 50833008, "comment_id": 88670031, "body": "Well, yes, but since it&#39;s human input, it is very unlikely, and you&#39;d have to be very fast."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528880622, "post_id": 50833008, "comment_id": 88670256, "body": "then it&#39;s technically impossible to know which direction it was turned, because eg. a 90 degrees clockwise turn could also have been a 270 degrees counter-clockwise turn. If your magnetic encoder doesn&#39;t indicate the direction of the rotation, the best you can do is guess (eg. shortest distance - ie. 90 degrees clockwise is more likely than 270 degrees counter-clockwise), but then you might sometimes get it wrong"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1528880740, "post_id": 50833008, "comment_id": 88670326, "body": "You must be sure that the samples read from encoder are faster than a turn. Avoiding to miss a full turn the direction can be simply obtained examining the sign of the difference between actual count and last one. You can also understand when the turn is complete and count the turns."}, {"owner": {"reputation": 130, "user_id": 1036372, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cjnmW.png?s=128&g=1", "display_name": "ifraaank", "link": "https://stackoverflow.com/users/1036372/ifraaank"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528880842, "post_id": 50833008, "comment_id": 88670379, "body": "@SanderDeDycker Yes, I figured. But since it 99% of the time will only be turned in 30 degree steps  (the encoder has dents in these intervals) it should be possible to get it right most of the time. I just can&#39;t figure out the logic"}, {"owner": {"reputation": 130, "user_id": 1036372, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cjnmW.png?s=128&g=1", "display_name": "ifraaank", "link": "https://stackoverflow.com/users/1036372/ifraaank"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1528880897, "post_id": 50833008, "comment_id": 88670402, "body": "@Frankie_C Yes, i read it fairly often, so that shouldn&#39;t be a problem."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1528881138, "post_id": 50833008, "comment_id": 88670564, "body": "The point is to read as often to keep track if the angle is increasing or decreasing, and consequently act on passing through the 0. Of course as @SanderDeDycker also said if the encoder doesn&#39;t provide a direction can happen that you read wrong values. But if this is a manual tracker on a device generally is not a big deal. The user will correct automatically."}, {"owner": {"reputation": 130, "user_id": 1036372, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cjnmW.png?s=128&g=1", "display_name": "ifraaank", "link": "https://stackoverflow.com/users/1036372/ifraaank"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1528882091, "post_id": 50833008, "comment_id": 88671178, "body": "@Frankie_C Yeah, I read the angle as often as possible, and the turns are human and very slow/precise. When printing the angle, it&#39;s very easy to see which direction it goes. Programmatically I just find it hard to detect the point where it resets."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1528883128, "post_id": 50833008, "comment_id": 88671938, "body": "The encoder gives you just a pulse?"}, {"owner": {"reputation": 130, "user_id": 1036372, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cjnmW.png?s=128&g=1", "display_name": "ifraaank", "link": "https://stackoverflow.com/users/1036372/ifraaank"}, "edited": false, "score": 0, "creation_date": 1528885004, "post_id": 50833008, "comment_id": 88673225, "body": "Nope, it gives me the absolute angle via I2C."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1528885568, "post_id": 50833008, "comment_id": 88673572, "body": "There is a reason that quadrature encoders were invented."}], "answers": [{"tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": true, "score": 3, "last_activity_date": 1528881497, "creation_date": 1528881497, "answer_id": 50833505, "question_id": 50833008, "link": "https://stackoverflow.com/questions/50833008/detect-if-magnetic-encoder-passes-360-or-0-and-in-which-direction-roll-over-wra/50833505#50833505", "title": "Detect if magnetic encoder passes 360 or 0 and in which direction (roll-over/wraparound direction?) - C", "body": "<p>Since the magnetic encoder can be turned more than 180 degrees at a time (albeit unlikely), it's technically impossible to know which direction it was turned, because eg. a 90 degrees clockwise turn could also have been a 270 degrees counter-clockwise turn.</p>\n\n<p>If your magnetic encoder doesn't indicate the direction of the rotation, the best you can do is guess (eg. shortest distance - ie. 90 degrees clockwise is more likely than 270 degrees counter-clockwise), but then you might sometimes get it wrong.</p>\n\n<p>If that's acceptable, it's relatively easy to do (assuming integer angles in degrees between 0 and 360) :</p>\n\n<pre><code>int rotation_angle(int old_angle, int new_angle) {\n  int result = (360 + new_angle - old_angle) % 360;\n  return (result &gt; 180) ? result - 360 : result;\n}\n</code></pre>\n\n<p>Then :</p>\n\n<pre><code>printf(\"%d\\n\", rotation_angle(0, 330)); // prints : -30\nprintf(\"%d\\n\", rotation_angle(330, 0)); // prints : 30\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1528985178, "post_id": 50855721, "comment_id": 88721444, "body": "This does not work: going from <code>10</code> to <code>350</code> gives a difference of <code>340</code> which is positive eventhough the move was negative."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1528987117, "post_id": 50855721, "comment_id": 88722680, "body": "@chqrlie It should work. With the sampling fast enough to guarantee that we never read in excess of 180&#176;, we can assume that each difference greater that 180&#176; is considered a wraparound and the sense of rotation (cw or ccw) is not changed. It should be clear from code, I update <code>bClockWise</code> only if the <b>absolute value of the difference</b> is less than 180&#176;. Else we are wrapping around the 0&#176; from cw or ccw, and in this case is valid the last rotational sense."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1528988024, "post_id": 50855721, "comment_id": 88723261, "body": "@chqrlie See updated answer for real angle tracking. This answer supply: -rotating/still flag, -rotational sens flag, -wraparound flag and angle tracking. There should be enough for a simple track-knob."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1528989166, "post_id": 50855721, "comment_id": 88723996, "body": "Here is a much simpler test: <code>diff = (540 + CurrAngle - LastAngle) % 360 - 180; bClockWise = (diff &gt;= 0);</code>"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1529004596, "post_id": 50855721, "comment_id": 88731703, "body": "@chqrlie of course the algorithm can be simplified. But I used a linear approach that made easy to understand the principles of the logic that should be the scope of SO answers. A too squeezed formula resembles black magic and make difficult to explain how it works."}], "tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1529050150, "last_edit_date": 1529050150, "creation_date": 1528973396, "answer_id": 50855721, "question_id": 50833008, "link": "https://stackoverflow.com/questions/50833008/detect-if-magnetic-encoder-passes-360-or-0-and-in-which-direction-roll-over-wra/50855721#50855721", "title": "Detect if magnetic encoder passes 360 or 0 and in which direction (roll-over/wraparound direction?) - C", "body": "<p>If you can guarantee that the polling happen more frequently of the fastest rotation of a half turn (180\u00b0), the following considerations should be true:</p>\n\n<ol>\n<li>the absolute difference between current reading and the last one could not exceed half turn=180\u00b0</li>\n<li>If absolute difference is <code>&gt;= 180\u00b0</code> we have crossed the <code>0\u00b0</code>. The count of degree we moved is calculated by adding or subtracting a full turn (360\u00b0) depending on current sense of rotation (cw add, ccw subtract).</li>\n<li>If absolute difference is <code>&lt; 180\u00b0</code> and the difference sign is positive we have moved clockwise (increment angle)</li>\n<li>If absolute difference is <code>&lt; 180\u00b0</code> and the difference sign is negative we have moved counter clockwise (decrement angle)</li>\n<li>If the difference <code>== 0</code> then no move have happened.</li>\n</ol>\n\n<p>In code:</p>\n\n<pre><code>int LastAngle = GetAngle();    // Init angle reading\nbool bClockWise = true;\n...\n// polling or interrupt handler\nint CurrAngle = GetAngle();\nint diff = CurrAngle - LastAngle;\nif (diff==0)\n{\n    //No move\n    ...\n}\nelse if (abs(diff) &lt; 180)   //Angle changed from last read\n{\n    //if we are here diff is not 0\n    //we update rotation accordingly with the sign\n    if (diff &gt; 0)\n        bClockWise = true;     //we were rotating clockwise\n    else\n        bClockWise = false;    //we were rotating counterclockwise\n}\n//If absolute difference was &gt; 180\u00b0 we are wrapping around the 0\n//in this case we simply ignore the diff sign and leave the rotation\n//to the last known verse.\n...\n</code></pre>\n\n<p>If you want count the turns you can code:</p>\n\n<pre><code>int Turns = 0;\nif ((diff != 0) &amp;&amp; (abs(diff) &gt; 180))\n{\n    if (bClockWise)\n        Turns++;     //Increase turns count\n    else\n        Turns--;     //Decrease turns count\n}\n</code></pre>\n\n<p>The following macros can be used to check for motion and rotation sense:</p>\n\n<pre><code>#define IsMoving    (diff)        //Give a value !=0 if there is a movement\n#define IsCw        (bClockWise)  //Give true if clockwise rotation\n#define IsWrap      (abs(diff) &gt;= 180)  //Give true if knob wrapped\n</code></pre>\n\n<p><strong>P.S.</strong> Please note that the <code>diff</code> variable is functional for rotational sense detection and movement, <strong>is not the absolute difference in degrees between movements</strong>.</p>\n\n<p>If you want compute the real movement you should take into account the wraparound:</p>\n\n<pre><code>int Angle = 0;    //the real angle tracked from code start\nif (diff != 0)\n{\n    if (abs(diff) &gt;= 180)\n    {\n        if (bClockWise)\n            Angle += diff + 360;     //Adjust for positive rollover\n        else\n            Angle += diff - 360;     //Adjust for negative rollover\n    }\n    else\n        Angle += diff;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1529245542, "last_edit_date": 1529245542, "creation_date": 1528989286, "answer_id": 50860805, "question_id": 50833008, "link": "https://stackoverflow.com/questions/50833008/detect-if-magnetic-encoder-passes-360-or-0-and-in-which-direction-roll-over-wra/50860805#50860805", "title": "Detect if magnetic encoder passes 360 or 0 and in which direction (roll-over/wraparound direction?) - C", "body": "<p>Here is a very simple solution:</p>\n\n<pre><code>int rotation_angle(int new_reading, int old_reading) {\n    /* angle readings are in [0..360] range */\n    /* compute the difference modulo 360 and shift it in range [-180..179] */\n    return (360 + 180 + new_reading - old_reading) % 360 - 180;\n}\n</code></pre>\n\n<p><code>rotation_angle()</code> return the signed angle difference.</p>\n\n<p>Notes:</p>\n\n<ul>\n<li>since <code>new_reading</code> and <code>old_reading</code> are assumed to be in range [<code>0</code>..<code>360</code>], the range for their difference is [<code>-360</code>..<code>360</code>], adding 360 ensures that the modulo operation returns a positive value between <code>0</code> and <code>359</code>.</li>\n<li>adding <code>180</code> before the modulo and subracting <code>180</code> from the result shifts the range of output values to [<code>-180</code>..<code>180</code>].</li>\n<li><code>0</code> means no change in angle</li>\n<li>a negative value means a turn toward smaller angle values.</li>\n<li>a positive value means a turn toward large angle values</li>\n<li>if the angle change can exceed <code>180</code> degrees, the interpretation of the return value is most likely incorrect. Angle sampling must be performed sufficiently quickly to prevent such conditions.</li>\n</ul>\n"}], "owner": {"reputation": 130, "user_id": 1036372, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cjnmW.png?s=128&g=1", "display_name": "ifraaank", "link": "https://stackoverflow.com/users/1036372/ifraaank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 50833505, "answer_count": 3, "score": 2, "last_activity_date": 1529245542, "creation_date": 1528880059, "last_edit_date": 1528880479, "question_id": 50833008, "link": "https://stackoverflow.com/questions/50833008/detect-if-magnetic-encoder-passes-360-or-0-and-in-which-direction-roll-over-wra", "title": "Detect if magnetic encoder passes 360 or 0 and in which direction (roll-over/wraparound direction?) - C", "body": "<p>I use a magnetic encoder, which reacts on hand inputs. When turning, it calculates the angle, and that part works perfectly. That means that if I turn the encoder 360 degrees, the angle is reset. (therefore it's 0 again). However, I would like to detect if the encoder has passed 360 and goes back to 0 or if it goes from 0 back up to 360. I need to know which direction the encoder is turned, in 30 degree steps. </p>\n\n<p>So: \nHow do I know if the encoder is turned in the clockwise direction (going fx. from 0 -> 360 -> 0 -> 360) or if it is turned in the counter-clockwise direction (going fx. from 360 -> 0 -> 360 -> 0) </p>\n\n<p>Right now it sees the step from 360 to 0 as a counter-clockwise turn, where it actually is a clockwise turn... </p>\n\n<p>Any suggestions? </p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1528880459, "post_id": 50832893, "comment_id": 88670143, "body": "You are missing a main function... You just wrote a function but there is no program that uses it"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1528880477, "post_id": 50832893, "comment_id": 88670162, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10766256/linker-returns-relocation-has-an-invalid-symbol-at-symbol-index\">Linker returns &quot;relocation has an invalid symbol at symbol index...&quot;</a>"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1528880533, "post_id": 50832893, "comment_id": 88670206, "body": "If you want to stick to C then this might be a more appropiate dupe: <a href=\"https://stackoverflow.com/questions/26408288/what-happens-during-a-relocation-has-invalid-symbol-index-error/43487844\" title=\"what happens during a relocation has invalid symbol index error\">stackoverflow.com/questions/26408288/&hellip;</a>"}, {"owner": {"reputation": 101, "user_id": 9866076, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0fLTSnakHiU/AAAAAAAAAAI/AAAAAAAAYRQ/M0HklZ0lkvg/photo.jpg?sz=128", "display_name": "Abdul Kalam", "link": "https://stackoverflow.com/users/9866076/abdul-kalam"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1528880766, "post_id": 50832893, "comment_id": 88670336, "body": "Thank you so much."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1528880930, "post_id": 50832893, "comment_id": 88670421, "body": "next time try to look up the error in a search engine first. this might very well give you a good hint what the problem is."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7985121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3256fcc54829f19cc76cda8ecf984043?s=128&d=identicon&r=PG&f=1", "display_name": "VivekP", "link": "https://stackoverflow.com/users/7985121/vivekp"}, "is_accepted": false, "score": 0, "last_activity_date": 1528880852, "creation_date": 1528880852, "answer_id": 50833295, "question_id": 50832893, "link": "https://stackoverflow.com/questions/50832893/unable-to-create-a-program-using-a-function-in-cs50-ide/50833295#50833295", "title": "Unable to create a Program using a function in CS50 IDE", "body": "<p>You are most probably missing the main function. Please add the following code to your code and see if the code gives correct output.</p>\n\n<pre><code>int main() {\n    int a = add_real(5,10);\n    printf(\"%d\", a);\n}\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 9866076, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0fLTSnakHiU/AAAAAAAAAAI/AAAAAAAAYRQ/M0HklZ0lkvg/photo.jpg?sz=128", "display_name": "Abdul Kalam", "link": "https://stackoverflow.com/users/9866076/abdul-kalam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528880852, "creation_date": 1528879744, "last_edit_date": 1528879846, "question_id": 50832893, "link": "https://stackoverflow.com/questions/50832893/unable-to-create-a-program-using-a-function-in-cs50-ide", "title": "Unable to create a Program using a function in CS50 IDE", "body": "<p>I tried to make a \"sum\" Function in C, and this is the error I get. I am an amateur and I don't understand what I did wrong. Any help?`</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\nint add_real(int a, int b);\n\n\nint add_real(int a, int b)\n{\n   int c = a + b;\n\n    return c;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aZOwF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aZOwF.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1528879186, "post_id": 50832668, "comment_id": 88669384, "body": "The <code>.cpp</code> suffix is for C++, so you&#39;re programming in C++ and not C. And C++ have a <code>bool</code> type without needing the <code>&lt;stdbool.h&gt;</code> header file."}, {"owner": {"reputation": 1499, "user_id": 1424395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=128&d=identicon&r=PG", "display_name": "myradio", "link": "https://stackoverflow.com/users/1424395/myradio"}, "edited": false, "score": 1, "creation_date": 1528879210, "post_id": 50832668, "comment_id": 88669395, "body": "Why do you choose C++ file in the compiler? There&#39;s no C option?"}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1528879516, "post_id": 50832668, "comment_id": 88669577, "body": "C# is so much easier to learn. I admire you for going so low level but learning languages especially your first takes years. If you find C too hard give C# a try."}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "reply_to_user": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1528880164, "post_id": 50832668, "comment_id": 88669958, "body": "@JeremyThompson What you wrote is true, but .NET with its very large libraries makes many things seem like they are working &quot;by magic&quot;. There is a very big abstraction that doesn&#39;t show you what your computer can do and how it can do it. Starting from C (with its &quot;low level&quot; feel) I fell you have better instruments to explore the inner working of .NET"}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "reply_to_user": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1528964792, "post_id": 50832668, "comment_id": 88708548, "body": "@xanatos you&#39;re right. I wish I had the patience to learn C 20 yrs ago"}], "answers": [{"comments": [{"owner": {"reputation": 11220, "user_id": 2609288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3634e5c231c72e362f00ae39b637734f?s=128&d=identicon&r=PG", "display_name": "Baldrick", "link": "https://stackoverflow.com/users/2609288/baldrick"}, "edited": false, "score": 1, "creation_date": 1528879242, "post_id": 50832707, "comment_id": 88669419, "body": "I would also set the project to &#39;compile as C&#39;."}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "reply_to_user": {"reputation": 11220, "user_id": 2609288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3634e5c231c72e362f00ae39b637734f?s=128&d=identicon&r=PG", "display_name": "Baldrick", "link": "https://stackoverflow.com/users/2609288/baldrick"}, "edited": false, "score": 0, "creation_date": 1528879802, "post_id": 50832707, "comment_id": 88669740, "body": "@Baldrick The default setting should be something akin &quot;autosense&quot;. If I add a .c file and then write <code>bool test = true</code> I get errors both on <code>bool</code> and <code>true</code>... Some <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/tc-tp-tc-tp-specify-source-file-type\" rel=\"nofollow noreferrer\">msdn</a> on this: <i>By default, CL assumes that files with the .c extension are C source files and files with the .cpp or the .cxx extension are C++ source files.</i>"}, {"owner": {"reputation": 11220, "user_id": 2609288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3634e5c231c72e362f00ae39b637734f?s=128&d=identicon&r=PG", "display_name": "Baldrick", "link": "https://stackoverflow.com/users/2609288/baldrick"}, "edited": false, "score": 0, "creation_date": 1528882920, "post_id": 50832707, "comment_id": 88671764, "body": "Fair enough. I guess with the project compile setting you could probably force .cpp files to compile as C too. Thanks for the info!"}], "tags": [], "owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "is_accepted": false, "score": 2, "last_activity_date": 1528879620, "last_edit_date": 1528879620, "creation_date": 1528879149, "answer_id": 50832707, "question_id": 50832668, "link": "https://stackoverflow.com/questions/50832668/learning-c-my-compiler-already-knows-bool-visual-studio-2017/50832707#50832707", "title": "Learning C, my compiler already knows bool (Visual Studio 2017)", "body": "<p>Give the (your) file the extension <code>.c</code>, not <code>.cpp</code>. In this way the Visual Studio will use the C language instead of using the C++ language. But note the response of Bathsheba... and a <a href=\"https://stackoverflow.com/q/48615184/613130\">so answer</a> that expands on what he wrote.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1528879197, "creation_date": 1528879197, "answer_id": 50832718, "question_id": 50832668, "link": "https://stackoverflow.com/questions/50832668/learning-c-my-compiler-already-knows-bool-visual-studio-2017/50832718#50832718", "title": "Learning C, my compiler already knows bool (Visual Studio 2017)", "body": "<p>Despite pretentions to the contrary, The C++ compiler that ships with Visual Studio is <strong>not</strong> a C compiler (it is in my opinion an excellent C++ compiler for targeting Windows). Even if you name a source file <code>.c</code> and are careful with the compiler settings it is still <strong>not</strong> a C compiler.</p>\n\n<p>Your best bet here is to use a genuine C compiler if you want to write C programs; gcc in cygwin is a good toolset.</p>\n"}], "owner": {"reputation": 31, "user_id": 8791937, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155399085334340/picture?type=large", "display_name": "Jimmy Gustavsson", "link": "https://stackoverflow.com/users/8791937/jimmy-gustavsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "closed_date": 1528880360, "answer_count": 2, "score": 0, "last_activity_date": 1549693251, "creation_date": 1528879033, "last_edit_date": 1549693251, "question_id": 50832668, "link": "https://stackoverflow.com/questions/50832668/learning-c-my-compiler-already-knows-bool-visual-studio-2017", "closed_reason": "Duplicate", "title": "Learning C, my compiler already knows bool (Visual Studio 2017)", "body": "<p>I'm learning C over the summer with the book \"C Programming - A modern approach\", now to the problem:</p>\n\n<p>When I write:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n</code></pre>\n\n<p>the compiler can't run the program because it can't include bool. When I use bool straight away it knows what it's supposed to do.</p>\n\n<p>Is this something new in Visual Studio 2017 or do I start the documents wrong and get C# or C++? (I don't know those languages but I supposed boolean is well integrated in them)</p>\n\n<p>I start my compiler by \"Windows Desktop Wizard -> Empty project -> Source file -> Add -> New project -> C++ file (.cpp)\"</p>\n\n<p>It's not a huge problem (since it mostly makes things easier) but I want to learn C and not C++/C#.</p>\n"}, {"tags": ["c++", "c", "wmi"], "owner": {"reputation": 181, "user_id": 940964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e0d3e4fdd4d26f269ce7d90965ca37?s=128&d=identicon&r=PG", "display_name": "Aleksei Guzev", "link": "https://stackoverflow.com/users/940964/aleksei-guzev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1528965887, "creation_date": 1528878236, "last_edit_date": 1528965887, "question_id": 50832435, "link": "https://stackoverflow.com/questions/50832435/how-to-implement-void-wmi-method", "title": "How to implement void WMI method?", "body": "<p>There is WMI class with a void method.\nMOF for the class looks like this:</p>\n\n<pre><code>class MSFT_SomeClass\n{\n     void Method1(\n                     [in] uint32 Arg1, \n                     [in] uint32 Arg2, \n                     [out] uint32 Arg3, \n                     [out] object Arg4);\n\u2026\n}\n</code></pre>\n\n<p>But convert-MOFToProvider does not support <code>void</code> and there is no <code>MI_*</code> macro for void return type in <code>MI_MethodDecl</code> structure.</p>\n\n<p>How can I implement this method?</p>\n"}, {"tags": ["c", "return-value", "numerical"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 6, "creation_date": 1528876672, "post_id": 50831887, "comment_id": 88667985, "body": "Can you give us an example input, where it returns 0 unexpectedly?"}, {"owner": {"reputation": 4252, "user_id": 3103891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mZxsu.jpg?s=128&g=1", "display_name": "GalAbra", "link": "https://stackoverflow.com/users/3103891/galabra"}, "edited": false, "score": 0, "creation_date": 1528876718, "post_id": 50831887, "comment_id": 88668015, "body": "What is the part with the <code>if</code> conditions supposed to do?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1528876932, "post_id": 50831887, "comment_id": 88668160, "body": "you shouldn&#39;t use <code>pow</code> for squaring. use <code>sqrt(Dx*Dx + Dy*Dy)</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1528877559, "post_id": 50831887, "comment_id": 88668516, "body": "How do you call the function?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1528878322, "post_id": 50831887, "comment_id": 88668915, "body": "Why is the distance between two particles a function of <code>a</code>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1528878587, "post_id": 50831887, "comment_id": 88669060, "body": "@halfer: Do feel empowered to correct obvious mistakes in English; perhaps respecting the fact that English might not be the native language of the OP."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1528878590, "post_id": 50831887, "comment_id": 88669063, "body": "How do you know it is zero? If you are debugging then you should be able to work though the issue. If not, then it may not be equal to zero, it may be you are printing a very small number. Does the return fail the the test (pdist() == 0.0)"}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1528878950, "post_id": 50831887, "comment_id": 88669249, "body": "Are you using very small numbers? You may want to use doubles. Also pick sensible units as you may be running out of range. Remember you are squaring so you need double the number of places for the intermediate calculation."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1528879716, "post_id": 50831887, "comment_id": 88669684, "body": "@Bathsheba: of course. I was asking because I genuinely was unsure how to correct it. Sometimes it is worth checking, rather than veering the question&#39;s text away from the author&#39;s intended meaning."}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 3, "last_activity_date": 1528878612, "creation_date": 1528878612, "answer_id": 50832545, "question_id": 50831887, "link": "https://stackoverflow.com/questions/50831887/c-function-returns-0-when-shouldnt/50832545#50832545", "title": "C function returns 0 when shouldn&#39;t", "body": "<p>The problem comes from <a href=\"https://linux.die.net/man/3/abs\" rel=\"nofollow noreferrer\"><code>abs</code></a> function which will return an integer:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nfloat pdist(float x1, float y1, float x2, float y2, float a) {\n    float Dx = abs(x2-x1);\n    float Dy = abs(y2-y1);\n    if(Dx &gt;a/2) Dx = a-Dx;\n    if(Dy &gt;a/2) Dy = a-Dy;\n    return sqrt(pow(Dx,2)+pow(Dy,2));\n}\n\nfloat pdist2(float x1, float y1, float x2, float y2, float a) {\n    float Dx = fabsf(x2-x1);\n    float Dy = fabsf(y2-y1);\n    if(Dx &gt;a/2) Dx = a-Dx;\n    if(Dy &gt;a/2) Dy = a-Dy;\n    return sqrt(pow(Dx,2)+pow(Dy,2));\n }\n\nint main(void)\n{\n    printf(\"first form: %f\\n\", pdist(.1, .1, .2, .2, .5));\n    printf(\"second form: %f\\n\", pdist2(.1, .1, .2, .2, .5));\n}\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>first form: 0.000000\nsecond form: 0.141421\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 9934348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJrfW.jpg?s=128&g=1", "display_name": "Antonio Ram&#237;rez", "link": "https://stackoverflow.com/users/9934348/antonio-ram%c3%adrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1528879567, "accepted_answer_id": 50832545, "answer_count": 1, "score": 1, "last_activity_date": 1528878612, "creation_date": 1528876493, "last_edit_date": 1528878559, "question_id": 50831887, "link": "https://stackoverflow.com/questions/50831887/c-function-returns-0-when-shouldnt", "closed_reason": "Not suitable for this site", "title": "C function returns 0 when shouldn&#39;t", "body": "<p>I'm making a set of functions in C for simulate a microcanonial ensamble (a periodic-bounded box with N particles with fixed Energy and Volume). The point is that one of my main functions is <strong>to get the distance between 2 particles</strong>, and <strong>sometimes it returns 0 even if the particles are not that close</strong>.</p>\n\n<p>The function is</p>\n\n<pre><code>// Determinar la m\u00ednima distancia dadas dos coordenadasy una longitud de caja periodica\nfloat pdist(float x1, float y1, float x2, float y2, float a) {\n   float Dx = abs(x2-x1);\n   float Dy = abs(y2-y1);\n   if(Dx &gt;a/2) Dx = a-Dx;\n   if(Dy &gt;a/2) Dy = a-Dy;\n   return sqrt(pow(Dx,2)+pow(Dy,2));\n}\n</code></pre>\n\n<p>If you want to see all the code, you can see it in\n<a href=\"https://gitlab.com/jarr.tecn/statistical_mechanics\" rel=\"nofollow noreferrer\">https://gitlab.com/jarr.tecn/statistical_mechanics</a></p>\n\n<p>in the file box.h\nand one example in ejemplo.h</p>\n"}, {"tags": ["c", "url", "libcurl"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1528877334, "post_id": 50831572, "comment_id": 88668401, "body": "<code>&amp;arg[i]</code> is totally meaningless. It&#39;s not an encoding issue."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1528877688, "post_id": 50831572, "comment_id": 88668580, "body": "<code>fprintf(f, &quot;Some text: %c\\n&quot;, &amp;arg[i])</code> Whatever <code>arg</code> might be or not, an address is never printed with <code>%c</code> format specifier."}, {"owner": {"reputation": 325, "user_id": 5427239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205174633831157/picture?type=large", "display_name": "Yakov Kemer", "link": "https://stackoverflow.com/users/5427239/yakov-kemer"}, "edited": false, "score": 0, "creation_date": 1528877754, "post_id": 50831572, "comment_id": 88668608, "body": "fprintf(f, &quot;entire string: %s\\n&quot;,&amp;arg) also gives me an unreadable thing"}, {"owner": {"reputation": 325, "user_id": 5427239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205174633831157/picture?type=large", "display_name": "Yakov Kemer", "link": "https://stackoverflow.com/users/5427239/yakov-kemer"}, "edited": false, "score": 0, "creation_date": 1528883458, "post_id": 50831572, "comment_id": 88672143, "body": "So it is impossible to write it into the file?"}, {"owner": {"reputation": 325, "user_id": 5427239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205174633831157/picture?type=large", "display_name": "Yakov Kemer", "link": "https://stackoverflow.com/users/5427239/yakov-kemer"}, "edited": false, "score": 0, "creation_date": 1528978548, "post_id": 50831572, "comment_id": 88717074, "body": "I have updated code. I&#39;ve pasted part from libcurl. All i need is to get value of arg and save it to text file. I am making it in curl itself."}, {"owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1529012973, "post_id": 50831572, "comment_id": 88735183, "body": "&#39;arg&#39; is not a char pointer - it is a va_list, you first need to get the char pointer using <code>va_arg()</code> and then access the string using <i>that</i> pointer."}, {"owner": {"reputation": 325, "user_id": 5427239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205174633831157/picture?type=large", "display_name": "Yakov Kemer", "link": "https://stackoverflow.com/users/5427239/yakov-kemer"}, "edited": false, "score": 0, "creation_date": 1529137292, "post_id": 50831572, "comment_id": 88774020, "body": "Thank you very much. You are amazing"}], "owner": {"reputation": 325, "user_id": 5427239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205174633831157/picture?type=large", "display_name": "Yakov Kemer", "link": "https://stackoverflow.com/users/5427239/yakov-kemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528978475, "creation_date": 1528875411, "last_edit_date": 1528978475, "question_id": 50831572, "link": "https://stackoverflow.com/questions/50831572/finding-out-the-request-address-in-libcurl", "title": "Finding out the request address in libcurl", "body": "<p>I have a software that uses a libcurl version 7.59. I need to export the url that it uses and write it to the text file. Url is set by </p>\n\n<pre><code>CURLcode curl_easy_setopt(struct Curl_easy *data, CURLoption tag, ...)\n</code></pre>\n\n<p>According to libcurl documentation the parameter type is char * ad it is being set like <code>curl_easy_setopt(curl, CURLOPT_URL, \"http://example.com\");</code></p>\n\n<p>Type of parameter in libcurl is <code>va_list arg</code></p>\n\n<p>I have added code in curl_easy_setopt</p>\n\n<pre><code>if (tag == CURLOPT_URL) {\n  FILE *f = fopen(\"file.txt\", \"a+\");\n\n  if (f == NULL)\n  {\n      printf(\"Error opening file!\\n\");\n      exit(1);\n  }\n\n\n  int len = strlen(&amp;arg);\n  for (int i = 0; i &lt; len; i++) {\n      fprintf(f, \"Some text: %c\\n\", &amp;arg[i]);\n  }\n\n\n\n\n\n  fclose(f);\n</code></pre>\n\n<p>}</p>\n\n<p>But I have some problems with encoding.</p>\n\n<pre><code>Some text: \nSome text: \nSome text: \nSome text: \nSome text: \nSome text:  \nSome text: !\nSome text: \"\nSome text: #\nSome text: $\nSome text: %\nSome text: D\n</code></pre>\n\n<p>I know that i can check the address by wireshark, but I need to do it exactly this way because I will need to change this address later.\nCurl code</p>\n\n<pre><code>CURLcode curl_easy_setopt(struct Curl_easy *data, CURLoption tag, ...)\n{\n  va_list arg;\n  CURLcode result;\n\n\n\n\n\n\n  if(!data)\n    return CURLE_BAD_FUNCTION_ARGUMENT;\n\n\n\n\n  va_start(arg, tag);\n\n\n\n\n  result = Curl_vsetopt(data, tag, arg);\n\n\n\n\n\n  va_end(arg);\n  return result;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1155, "user_id": 3813027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4934957ca1eb3f29fa990674595b9726?s=128&d=identicon&r=PG", "display_name": "senerh", "link": "https://stackoverflow.com/users/3813027/senerh"}, "edited": false, "score": 1, "creation_date": 1528873308, "post_id": 50830843, "comment_id": 88666016, "body": "Maybe it&#39;s wrong, but can you try this: mem_set(((void**)(&amp;cb_p)), &amp;mem_pos)"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 5, "creation_date": 1528873552, "post_id": 50830843, "comment_id": 88666145, "body": "You shoud never cast to or from <code>void *</code> in C language..."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1528873811, "post_id": 50830843, "comment_id": 88666301, "body": "@SergeBallesta what&#39;s your rationale? In fact, that&#39;s what <code>void*</code> is used for. You wouldn&#39;t be able to perform a simple <code>malloc</code> without (implicitly) casting from <code>void*</code> to your destination pointer type."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1528873826, "post_id": 50830843, "comment_id": 88666307, "body": "A <code>float*</code> will happily degrade into <code>void*</code>, but I doubt that <code>float**</code> will degrade into a <code>void**</code>"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "reply_to_user": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1528873861, "post_id": 50830843, "comment_id": 88666333, "body": "@andreee <code>int* x = malloc(sizeof(int));</code> compiles just fine in C"}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1528873890, "post_id": 50830843, "comment_id": 88666347, "body": "Yes, and it <i>implicitly</i> casts the returned <code>void*</code> to <code>int*</code>. I agree that <i>explicit</i> casts shouldn&#39;t be done, if that&#39;s what you meant."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "reply_to_user": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 3, "creation_date": 1528874021, "post_id": 50830843, "comment_id": 88666411, "body": "@andreee no, it <i>converts</i> implicitly. Casts are always explicit"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1528874055, "post_id": 50830843, "comment_id": 88666436, "body": "@SergeBallesta I thought arguments for <code>%p</code> in printf have to be cast to <code>void*</code>?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1528874080, "post_id": 50830843, "comment_id": 88666453, "body": "@andreee - There are no implicit casts. A cast is an explicit <i>conversion</i>. You are right that there is an implicit conversion here. As is Serge"}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1528874171, "post_id": 50830843, "comment_id": 88666507, "body": "Okay, agree. Never took notice of the distinction between cast and conversion in this context. Thanks for pointing out."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1528875170, "post_id": 50830843, "comment_id": 88667105, "body": "In the first place, why do you need your <code>mem_set</code> function? Just for the purpose of assigning a pointer? If you have any <code>void*</code> pointer, you can simply assign any other object pointer to it. You should not hide such a basic operation in a function and let the compiler do its job."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1528875286, "post_id": 50830843, "comment_id": 88667174, "body": "@JensGustedt It&#39;s more than that, just not shown here for simplicity."}], "answers": [{"tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": false, "score": 1, "last_activity_date": 1528874269, "creation_date": 1528874269, "answer_id": 50831211, "question_id": 50830843, "link": "https://stackoverflow.com/questions/50830843/cast-and-reference-in-one-line/50831211#50831211", "title": "Cast and reference in one line", "body": "<p>Try this:</p>\n\n<pre><code>mem_set (  (void **)&amp;cb_p, &amp;mem_pos);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1077, "user_id": 4703818, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFTgPgsyPAk/AAAAAAAAAAI/AAAAAAAAABM/EVrRpcieykg/photo.jpg?sz=128", "display_name": "LAV VISHWAKARMA", "link": "https://stackoverflow.com/users/4703818/lav-vishwakarma"}, "is_accepted": false, "score": 1, "last_activity_date": 1528877849, "last_edit_date": 1528877849, "creation_date": 1528874405, "answer_id": 50831254, "question_id": 50830843, "link": "https://stackoverflow.com/questions/50830843/cast-and-reference-in-one-line/50831254#50831254", "title": "Cast and reference in one line", "body": "<p>Actually, the syntax for casting in C is.</p>\n\n<pre><code>(type)value\n</code></pre>\n\n<p>Here your value is <code>&amp;cb_p</code> and type is <code>void**</code> not the <code>void*</code></p>\n\n<pre><code>mem_set ( (void**)&amp;cb_p, &amp;mem_pos );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1528878893, "post_id": 50831535, "comment_id": 88669216, "body": "@SergeBallesta - True. I guess it depends on how much the OP&#39;s example is illustrative."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1528876187, "last_edit_date": 1528876187, "creation_date": 1528875295, "answer_id": 50831535, "question_id": 50830843, "link": "https://stackoverflow.com/questions/50830843/cast-and-reference-in-one-line/50831535#50831535", "title": "Cast and reference in one line", "body": "<p>Casting <code>&amp;cb_p</code> is ill-advised. A <code>float**</code> and a <code>void**</code> are not compatible pointer types. The assumption that \"all pointers are the same\" need not hold in general.</p>\n\n<p>You can however do something that almost looks like a cast, but isn't one. You can use a compound literal. That expression creates an lvalue, unlike the regular value a cast produces. And you can take the address of an lvalue:</p>\n\n<pre><code>mem_set( &amp;(void*){cb_p}, &amp;mem_pos );  \n</code></pre>\n\n<p><code>(void*){cb_p}</code> produces an unnamed void pointer (this is the compound literal expression), which is initialized from <code>cb_p</code>. And since it's an lvalue, the address can be legally taken. That will avoid the named temporary as you wish.</p>\n\n<p>Just make certain that your compiler supports <a href=\"/questions/tagged/c99\" class=\"post-tag\" title=\"show questions tagged &#39;c99&#39;\" rel=\"tag\">c99</a> or later.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1528878832, "post_id": 50832557, "comment_id": 88669187, "body": "Good point. I kinda focused on the OP&#39;s comment <code>&#47;&#47; works, but clumsy</code> and figured they actually have working code they want to refactor."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "edited": false, "score": 0, "creation_date": 1528881094, "post_id": 50832557, "comment_id": 88670531, "body": "My bad: should have said &quot;compiles, but clumsy&quot;. I was sure it would work. Sorry."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 2, "last_activity_date": 1528878638, "creation_date": 1528878638, "answer_id": 50832557, "question_id": 50830843, "link": "https://stackoverflow.com/questions/50830843/cast-and-reference-in-one-line/50832557#50832557", "title": "Cast and reference in one line", "body": "<p>Beware when using temporaries!</p>\n\n<p>This will not change the value of <code>cb_p</code>:</p>\n\n<pre><code>void* temp = (void*)cb_p;\nmem_set( &amp;temp, &amp;mem_pos ); // works, but clumsy         \n</code></pre>\n\n<p>Because temp is a different pointer that initially points at the same object as <code>cb_p</code> does. So <code>mem_set</code> only changes the value of <code>temp</code> and leaves <code>cb_p</code> untouched.</p>\n\n<p>That also means that this (otherwise fully standard conformant) solution does not change <code>cb_p</code> either:</p>\n\n<pre><code>mem_set( &amp;(void*){&amp;cb_p}, &amp;mem_pos );\n</code></pre>\n\n<p><code>&amp;(void*){&amp;cb_p}</code> creates a temporary <code>void *</code> pointer, here again initialized with the <em>value</em> of <code>cb_p</code> and only the temporay is changed by <code>mem_set</code>.</p>\n\n<p>Demo code:</p>\n\n<pre><code>float f1 = 1., f2 = 2.;\nvoid* mem_pos = &amp;f2;\nfloat* cb_p = &amp;f1;\n\n//void* temp = (void*)cb_p;\nmem_set(&amp;(void*){&amp;cb_p}, &amp;mem_pos ); // works, but clumsy         \n\nprintf(\"%f\\n\", *cb_p);\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>1.000000\n</code></pre>\n\n<p>If you want to change <code>cb_p</code>, you have to pass its own address:</p>\n\n<pre><code>mem_set((void**)&amp;cb_p, &amp;mem_pos );\n</code></pre>\n\n<p>With this line, above demo outputs <code>2.000000</code>.</p>\n\n<p>The only implementation dependant feature required here is that pointers to any type shall have same alignment and representation. <code>mem_pos</code> is a <code>void *</code> that was initialized from a <code>float *</code>. So it can legally be casted back to a <code>float *</code> and will receive the original value.</p>\n\n<p><code>cb_p</code> is a <code>float *</code> and <code>&amp;cb</code> if a <code>float **</code>. The cast causes a conversion to a <code>void **</code>. Next the pointed value receives another pointer value. Here it is required that <code>void*</code> and <code>float*</code> do have same representation, and this point is not guaranteed by the standard but it is true in all implementations I know: a pointer is no more than the memory address of the first byte of an object (*).</p>\n\n<p>If this point is allowed by the implementation, <code>cb_p</code> has been assigned the value of a <code>void *</code> that was initialized from a <code>float *</code>. Here again provided all pointers have same representation, <code>cb_p</code> current representation is the representation of a pointer to a float object: <code>cb_p</code> points to that object.</p>\n\n<hr>\n\n<p>(*) Unfortunately, draft n1570 for C11 says in 6.2.6.1 General</p>\n\n<blockquote>\n  <p>1 The representations of all types are unspecified except as stated in this subclause.</p>\n</blockquote>\n\n<p>and the subclause does not state anything for pointers representation</p>\n"}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 50832557, "answer_count": 4, "score": 0, "last_activity_date": 1528878638, "creation_date": 1528873023, "question_id": 50830843, "link": "https://stackoverflow.com/questions/50830843/cast-and-reference-in-one-line", "title": "Cast and reference in one line", "body": "<p>Check the code:</p>\n\n<pre><code>void mem_set( void** mem_input, void** mem_current )\n{\n    *mem_input = *mem_current;\n    ...\n}\n\nmain()\n{\n    ...\n    void* mem_pos = ...;\n    float* cb_p = ...;\n\n    void* temp = (void*)cb_p;\n    mem_set( ( &amp;temp, &amp;mem_pos ); // works, but clumsy         \n}\n</code></pre>\n\n<p>I would like to avoid having to create and populate a temporary variable when calling <code>mem_set</code>(because I have many <code>mem_set</code> calls). Can the call somehow be done in one line? </p>\n\n<p><code>mem_set( ( &amp;( (void*)cb_p ), &amp;mem_pos )</code> doesn't work. </p>\n\n<p>p.s.<br>\nPlease advise a better title for the question.</p>\n"}, {"tags": ["c", "gcc", "format-specifiers", "openbsd"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1528871119, "post_id": 50830312, "comment_id": 88664879, "body": "The more portable example would probably be with <code>int64_t</code>. But not a bad Q&amp;A"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 8, "creation_date": 1528872311, "post_id": 50830312, "comment_id": 88665464, "body": "The <code>q</code> length modifier is a non-portable, non-reliable, antiquated, deprecated way of writing <code>ll</code>.  Use <code>ll</code> in your code; encourage those who maintain the code on GitHub to upgrade to standard C99 formats."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1593894790, "post_id": 50830312, "comment_id": 110938747, "body": "<code>printf</code> formats are implemented by the runtime library, not by the compiler. This is not a gcc (or egcs, or llvm) issue. On my Ubuntu 20.04 system, for example, <code>%qd</code> works with gcc and glibc, but fails with gcc and musl -- same compiler, different runtime libraries."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1528871224, "post_id": 50830324, "comment_id": 88664923, "body": "By the way, for future reference. There is a &quot;answer your own question&quot; checkbox at the bottom of the <a href=\"https://stackoverflow.com/questions/ask\">ask a question</a> form. It allows you to post them together, and not rush to post them a minute apart."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 10, "creation_date": 1528871947, "post_id": 50830324, "comment_id": 88665255, "body": "C99 says nothing about length modifier <code>q</code>, and neither does C11 (see <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p7\" rel=\"nofollow noreferrer\">&#167;7.21.6.1 The <code>fprintf</code> function &#182;7</a>).  The macOS (BSD) manual page for <code>fprintf()</code> marks <code>q</code> as deprecated.  The Wikipedia page does not describe it as a C99 extension, but rather as a platform-specific option that existed prior to the C99 extensions being created."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1528875538, "post_id": 50830324, "comment_id": 88667312, "body": "It is important to emphasis that this is a GNU C extension, it has never been part of the C language. I added the gcc tag to the question."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 8, "last_activity_date": 1528872122, "last_edit_date": 1592644375, "creation_date": 1528870951, "answer_id": 50830324, "question_id": 50830312, "link": "https://stackoverflow.com/questions/50830312/what-is-the-purpose-of-format-specifier-qd-in-printf/50830324#50830324", "title": "What is the purpose of format specifier &quot;%qd&quot; in `printf()`?", "body": "<p><code>q</code> means <strong>quad word</strong> format specifier in printf function which is used to handle <strong>64 bits</strong> comfortably on all machines.</p>\n<p>From <a href=\"https://en.wikipedia.org/wiki/Printf_format_string\" rel=\"noreferrer\">Wikipedia</a>:</p>\n<blockquote>\n<p>Additionally, several platform-specific length options came to exist prior to widespread use of the ISO C99 extensions:</p>\n<p>\u2026</p>\n<p><code>q</code> - For integer types, causes printf to expect a 64-bit (quad word)\ninteger argument. Commonly found in BSD platforms</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1593894785, "post_id": 50831271, "comment_id": 110938746, "body": "<code>printf</code> formats are implemented by the runtime library, not by the compiler. This is not a gcc (or egcs, or llvm) issue. On my Ubuntu 20.04 system, for example, <code>%qd</code> works with gcc and glibc, but fails with gcc and musl -- same compiler, different runtime libraries."}], "tags": [], "owner": {"reputation": 4091, "user_id": 5674223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f059211e7c3ee8ebb957ab8c29331e71?s=128&d=identicon&r=PG&f=1", "display_name": "UmFraWJ1bCBJc2xhbQ", "link": "https://stackoverflow.com/users/5674223/umfrawj1bcbjc2xhbq"}, "is_accepted": true, "score": 17, "last_activity_date": 1593892528, "last_edit_date": 1593892528, "creation_date": 1528874456, "answer_id": 50831271, "question_id": 50830312, "link": "https://stackoverflow.com/questions/50830312/what-is-the-purpose-of-format-specifier-qd-in-printf/50831271#50831271", "title": "What is the purpose of format specifier &quot;%qd&quot; in `printf()`?", "body": "<blockquote>\n<p><code>%qd</code> was intended to handle 64 bits comfortably on all\nmachines, and was originally a bsd-ism (<code>quad_t</code>).</p>\n<p>However, <code>egcs</code> (and <code>gcc</code> before that) treats it as equivalent to <code>ll</code>, which\nis not always equivalent: openbsd-alpha is configured so that <code>long</code> is\n64 bits, and hence <code>quad_t</code> is typedef'ed to <code>long</code>.\nIn that particular case, the printf-like attribute doesn't work as\nintended.</p>\n</blockquote>\n<blockquote>\n<p>If <code>sizeof(long long) == sizeof(long)</code> on openbsd-alpha, it should work\nanyway - i.e. <code>%ld</code>, <code>%lld</code>, and <code>%qd</code> should be interchangeable. On OpenBSD/alpha, <code>sizeof(long) == sizeof(long long) == 8</code>.</p>\n</blockquote>\n<p>Several platform-specific length options came to exist prior to widespread use of the ISO C99 extensions, <code>q</code> was one of them. It was used for integer types, which causes <code>printf</code> to expect a 64-bit (quad word) integer argument. It is commonly found in BSD platforms.</p>\n<p>However, both of the C99 and C11 says nothing about length modifier <code>q</code>. The macOS (BSD) manual page for <code>fprintf()</code> marks <code>q</code> as deprecated. So, using <code>ll</code> is recommended in stead of <code>q</code>.</p>\n<p><strong>References:</strong></p>\n<p><a href=\"https://gcc.gnu.org/ml/gcc-bugs/1999-02n/msg00166.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/ml/gcc-bugs/1999-02n/msg00166.html</a></p>\n<p><a href=\"https://en.wikipedia.org/wiki/Printf_format_string\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Printf_format_string</a></p>\n<p><a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#7.21.6.1p7\" rel=\"nofollow noreferrer\">https://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p7</a></p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1528911395, "post_id": 50832024, "comment_id": 88689838, "body": "Since the minimum size of <code>long</code> is 32-bits, the fact that <code>sizeof(long long) &gt;= sizeof(long)</code> only allows you to infer that the size of <code>long long</code> must be at least 32 bits.  However, <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.2.4.2.1\" rel=\"nofollow noreferrer\">C11 &#167;5.2.4.2.1 Sizes of integer types <code>&lt;limits.h&gt;</code></a> says: <i>\u2026 Their implementation-defined values shall be equal or greater in magnitude (absolute value) to those shown, with the same sign. \u2026 minimum value for an object of type long long int <code>LLONG_MIN</code> <code>-9223372036854775807</code> // \u2212(2\u2076&#179; \u2212 1)</i> which does require <code>long long</code> to be a 64-bit type."}], "tags": [], "owner": {"reputation": 1710, "user_id": 3590237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EsWLO.jpg?s=128&g=1", "display_name": "Aravinda Meewalaarachchi", "link": "https://stackoverflow.com/users/3590237/aravinda-meewalaarachchi"}, "is_accepted": false, "score": 5, "last_activity_date": 1528911654, "last_edit_date": 1528911654, "creation_date": 1528876900, "answer_id": 50832024, "question_id": 50830312, "link": "https://stackoverflow.com/questions/50830312/what-is-the-purpose-of-format-specifier-qd-in-printf/50832024#50832024", "title": "What is the purpose of format specifier &quot;%qd&quot; in `printf()`?", "body": "<p>One of most interesting C language related question to answer. The symbolic literal <code>\u201c%qd\u201d</code> represent as quad word, which is specified as used to handle 64 bits effectively with the <code>printf</code> function in the C programming language. Also just remember that, from 1999 edition of the C standard states that <code>sizeof(long long) &gt;= sizeof(long)</code>, and one can infer that the range of <code>long long</code> has a size of at least 64 bits.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1919, "favorite_count": 2, "accepted_answer_id": 50831271, "answer_count": 3, "score": 19, "last_activity_date": 1593892528, "creation_date": 1528870892, "last_edit_date": 1566670463, "question_id": 50830312, "link": "https://stackoverflow.com/questions/50830312/what-is-the-purpose-of-format-specifier-qd-in-printf", "title": "What is the purpose of format specifier &quot;%qd&quot; in `printf()`?", "body": "<p>I saw format specifier <code>%qd</code> when browsing <a href=\"https://github.com/Microsoft/clang/blob/master/test/Sema/format-strings.c\" rel=\"nofollow noreferrer\">github</a> code. Then I checked in GCC compiler, it's working fine.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{  \n    long long num = 1;\n    printf(\"%qd\\n\", num);\n    return 0;\n}\n</code></pre>\n\n<p>What is the purpose of format specifier <code>%qd</code> in <code>printf()</code>?</p>\n"}, {"tags": ["c#", "c", "openssl", "rsa", "marshalling"], "comments": [{"owner": {"reputation": 85, "user_id": 6034019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b7fc397327fa55d2a913ef29be3c0?s=128&d=identicon&r=PG&f=1", "display_name": "saygins", "link": "https://stackoverflow.com/users/6034019/saygins"}, "edited": false, "score": 1, "creation_date": 1528871839, "post_id": 50830264, "comment_id": 88665200, "body": "di you try <a href=\"http://openssl.6102.n7.nabble.com/OPENSSL-Uplink-0099E000-07-no-OPENSSL-Applink-td20125.html\" rel=\"nofollow noreferrer\">this</a> ?"}, {"owner": {"reputation": 273, "user_id": 9079735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d9644fb5c6a99c19e7906ce8e113b?s=128&d=identicon&r=PG", "display_name": "Shervin Rafiee", "link": "https://stackoverflow.com/users/9079735/shervin-rafiee"}, "reply_to_user": {"reputation": 85, "user_id": 6034019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b7fc397327fa55d2a913ef29be3c0?s=128&d=identicon&r=PG&f=1", "display_name": "saygins", "link": "https://stackoverflow.com/users/6034019/saygins"}, "edited": false, "score": 0, "creation_date": 1528872712, "post_id": 50830264, "comment_id": 88665694, "body": "@saygins Yes not working"}], "owner": {"reputation": 273, "user_id": 9079735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d9644fb5c6a99c19e7906ce8e113b?s=128&d=identicon&r=PG", "display_name": "Shervin Rafiee", "link": "https://stackoverflow.com/users/9079735/shervin-rafiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528870705, "creation_date": 1528870705, "question_id": 50830264, "link": "https://stackoverflow.com/questions/50830264/applink-c-not-working-after-marshalling-in-c", "title": "applink.c not working after marshalling in C#", "body": "<p>I've got a method that uses <code>PEM_write_RSAPrivateKey</code> named <code>GenerateKeys</code></p>\n\n<pre><code>extern \"C\" {\n__declspec(dllexport) void GenerateKeys(const char* pcszPassphrase)\n{\n    const EVP_CIPHER* pCipher = NULL;\n    EVP_PKEY* pPrivKey = NULL;\n    FILE*     pFile = NULL;\n    RSA *rsa = NULL;\n\n    pPrivKey = create_rsa_key();\n    if (pPrivKey)\n    {\n        char buff[MAX_PATH];\n        sprintf(buff, \"%s%s\", currentDirectory, \"\\\\Keys\\\\prikey.pem\");\n        if ((pFile = fopen(buff, \"wt\")) &amp;&amp; (pCipher = EVP_aes_256_cbc()))\n        {\n            rsa = EVP_PKEY_get1_RSA(pPrivKey);\n            if (!PEM_write_RSAPrivateKey(pFile, rsa, pCipher,\n                (unsigned char*)pcszPassphrase,\n                (int)strlen(pcszPassphrase), NULL, NULL))\n            {\n                 // Not important code\n            }\n        }\n    }\n}\n}\n</code></pre>\n\n<p><code>PEM_write_RSAPrivateKey</code> method needs <strong>applink.c</strong> code block to works properly so I added it too and everything works fine.</p>\n\n<pre><code>#define APPLINK_STDIN   1\n#define APPLINK_STDOUT  2\n#define APPLINK_STDERR  3\n#define APPLINK_FPRINTF 4\n#define APPLINK_FGETS   5\n#define APPLINK_FREAD   6\n#define APPLINK_FWRITE  7\n#define APPLINK_FSETMOD 8\n#define APPLINK_FEOF    9\n#define APPLINK_FCLOSE  10  /* should not be used */\n\n#define APPLINK_FOPEN   11  /* solely for completeness */\n#define APPLINK_FSEEK   12\n#define APPLINK_FTELL   13\n#define APPLINK_FFLUSH  14\n#define APPLINK_FERROR  15\n#define APPLINK_CLEARERR 16\n#define APPLINK_FILENO  17  /* to be used with below */\n\n#define APPLINK_OPEN    18  /* formally can't be used, as flags can vary */\n#define APPLINK_READ    19\n#define APPLINK_WRITE   20\n#define APPLINK_LSEEK   21\n#define APPLINK_CLOSE   22\n#define APPLINK_MAX 22  /* always same as last macro */\n\nstatic void *app_stdin(void) { return stdin; }\nstatic void *app_stdout(void) { return stdout; }\nstatic void *app_stderr(void) { return stderr; }\nstatic int   app_feof(FILE *fp) { return feof(fp); }\nstatic int   app_ferror(FILE *fp) { return ferror(fp); }\nstatic void  app_clearerr(FILE *fp) { clearerr(fp); }\nstatic int   app_fileno(FILE *fp) { return _fileno(fp); }\nstatic int   app_fsetmod(FILE *fp, char mod)\n{\n    return _setmode(_fileno(fp), mod == 'b' ? _O_BINARY : _O_TEXT);\n}\n\nextern \"C\" {\n    __declspec(dllexport)\n    void **\n    OPENSSL_Applink()\n{\n    static int once = 1;\n    static void *OPENSSL_ApplinkTable[APPLINK_MAX + 1] = { (void *)APPLINK_MAX };\n\n    if (once)\n    {\n        OPENSSL_ApplinkTable[APPLINK_STDIN] = app_stdin;\n        OPENSSL_ApplinkTable[APPLINK_STDOUT] = app_stdout;\n        OPENSSL_ApplinkTable[APPLINK_STDERR] = app_stderr;\n        OPENSSL_ApplinkTable[APPLINK_FPRINTF] = fprintf;\n        OPENSSL_ApplinkTable[APPLINK_FGETS] = fgets;\n        OPENSSL_ApplinkTable[APPLINK_FREAD] = fread;\n        OPENSSL_ApplinkTable[APPLINK_FWRITE] = fwrite;\n        OPENSSL_ApplinkTable[APPLINK_FSETMOD] = app_fsetmod;\n        OPENSSL_ApplinkTable[APPLINK_FEOF] = app_feof;\n        OPENSSL_ApplinkTable[APPLINK_FCLOSE] = fclose;\n\n        OPENSSL_ApplinkTable[APPLINK_FOPEN] = fopen;\n        OPENSSL_ApplinkTable[APPLINK_FSEEK] = fseek;\n        OPENSSL_ApplinkTable[APPLINK_FTELL] = ftell;\n        OPENSSL_ApplinkTable[APPLINK_FFLUSH] = fflush;\n        OPENSSL_ApplinkTable[APPLINK_FERROR] = app_ferror;\n        OPENSSL_ApplinkTable[APPLINK_CLEARERR] = app_clearerr;\n        OPENSSL_ApplinkTable[APPLINK_FILENO] = app_fileno;\n\n        OPENSSL_ApplinkTable[APPLINK_OPEN] = _open;\n        OPENSSL_ApplinkTable[APPLINK_READ] = _read;\n        OPENSSL_ApplinkTable[APPLINK_WRITE] = _write;\n        OPENSSL_ApplinkTable[APPLINK_LSEEK] = _lseek;\n        OPENSSL_ApplinkTable[APPLINK_CLOSE] = _close;\n\n        once = 0;\n    }\n\n    return OPENSSL_ApplinkTable;\n}\n}\n</code></pre>\n\n<p>The problem is I want to use this code in <strong>C#</strong> .After marshalling and calling the <code>GenerateKeys</code> method, the <strong>C#</strong> app closes in <code>PEM_write_RSAPrivateKey</code> line with this error message:</p>\n\n<p><strong>OPENSSL_Uplink(0F3C26E0,08): no OPENSSL_Applink</strong></p>\n\n<p>And its the same error that occured if I don't include <strong>applink.c</strong> in my <strong>C</strong> code\nIt seems that the problem is <code>OPENSSL_Applink</code> function is <code>extern</code> method itself but I don't know how to fix the problem.</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1528868389, "post_id": 50829641, "comment_id": 88663704, "body": "<code>fork()</code> creates a new <i>process</i>, not a new <i>thread</i>. Use <code>std::thread</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1528868453, "post_id": 50829641, "comment_id": 88663732, "body": "A PThread-ID might very well be <i>unique to a process only</i>."}, {"owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "edited": false, "score": 0, "creation_date": 1528869080, "post_id": 50829641, "comment_id": 88663969, "body": "So should I create a thread and then threads of this thread? I don&#39;t know about c++(std::thread), do you know how could I do it in C? Thanks guys!!"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1528869575, "post_id": 50829641, "comment_id": 88664175, "body": "If you want a C solution then why is the question tagged C++?"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 1, "creation_date": 1528870117, "post_id": 50829641, "comment_id": 88664404, "body": "@Maet Mataias : Currently you create a new process with <code>fork</code> and then inside it a second thread using <code>pthread_create</code> . For concurrency, you only need either a new process or a new thread. Decide for one Option."}, {"owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1528870384, "post_id": 50829641, "comment_id": 88664522, "body": "I used this &quot;unlink&quot; because I followed a book where it teaches how to do a socket communication, so no special reasons to use it. @JesperJuhl I thought you knew C too, sorry :)."}, {"owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528870571, "post_id": 50829641, "comment_id": 88664612, "body": "@MichaelBeer hmm, got it, I will try to do it, because it looks confusing for me, to create something on &quot;connection level&quot; I mean, I&#39;m not sure what I&#39;ve to remove to turn it in full threads"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528870612, "post_id": 50829641, "comment_id": 88664628, "body": "OK, just try without your fork - call ... And remove the <code>unlink</code>"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528871037, "post_id": 50829641, "comment_id": 88664853, "body": "remove <code>if(fork() == 0) { close(sock_fd);</code> and the closing bracket... And get yourself familiar with processes vs. threads ;)"}, {"owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528871230, "post_id": 50829641, "comment_id": 88664929, "body": "@MichaelBeer Removing &quot;unlink&quot; it fails to bind. And removing the if(fork==0) condition, the second client doesn&#39;t run, because I think I should replace if for(something I don&#39;t know, maybe be threads, but dont know how)"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528871337, "post_id": 50829641, "comment_id": 88664970, "body": "However, I doubt that the Programm will do what you want - whenever a new connection arrives, you create several threads, block your entire Server until the threads are done, close the connection and only afterwards become ready for a new one. Usually you want multithreading to serve several connection at once?"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528871620, "post_id": 50829641, "comment_id": 88665100, "body": "You could try to remove the Form, don&amp;amp;#39;t join on your threads, remove the thread_id array, and have the client socket closed in the thread (your <code>operacoes</code> function ... Then you had one thread per connection, probably what you want..."}, {"owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "edited": false, "score": 0, "creation_date": 1528871768, "post_id": 50829641, "comment_id": 88665163, "body": "removing &quot;close(sock_fd)&quot; still doesnt allow the second client. Kind of... I think. I want to create a new thread for each new connection, and the those threads will &quot;fight&quot; or &quot;dispute&quot; for a system functionality, as edit a file, for example, and then other clients will wait mutex unlock to access this file."}, {"owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528873033, "post_id": 50829641, "comment_id": 88665853, "body": "I&#39;ve changed thread_id array to pthread thread_id; and now it is now running the thread anymore, not even a single time. @MichaelBeer"}, {"owner": {"reputation": 966, "user_id": 1386127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/01cef9fb064e908463d83e6cb1f08cf8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumen", "link": "https://stackoverflow.com/users/1386127/soumen"}, "edited": false, "score": 0, "creation_date": 1528873229, "post_id": 50829641, "comment_id": 88665968, "body": "@MartMataias I think if only create a thread to handle a client just after the accept() call, it should work fine. Then you are not required to close sock_fd."}, {"owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "reply_to_user": {"reputation": 966, "user_id": 1386127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/01cef9fb064e908463d83e6cb1f08cf8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumen", "link": "https://stackoverflow.com/users/1386127/soumen"}, "edited": false, "score": 0, "creation_date": 1528874189, "post_id": 50829641, "comment_id": 88666517, "body": "@Soumen it is the problem, I think I undestood how to create a thread, and how to use mutex to lock and unlock things, but It seems strange for me to create a thread to handle a connection, because a thread calls a functions, but how to do it for the client, this is what i&#39;m getting confused."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1528875511, "post_id": 50829641, "comment_id": 88667298, "body": "@MartMataias You are right with the <code>unlink</code>. I oversaw that you deal with UNIX domain sockets here ..."}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "is_accepted": false, "score": 0, "last_activity_date": 1528875048, "creation_date": 1528875048, "answer_id": 50831459, "question_id": 50829641, "link": "https://stackoverflow.com/questions/50829641/run-mutex-but-fails-to-create-multiple-threads/50831459#50831459", "title": "Run mutex, but fails to create multiple threads", "body": "<p>Assuming I understand correctly what you want to achieve:</p>\n\n<ol>\n<li>Create a unix domain socket and listen for incoming connections</li>\n<li>Treat each connection in parallel</li>\n<li>Have one global mutex being locked/unlocked during treatment of the connections</li>\n</ol>\n\n<p>try this:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/un.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\npthread_mutex_t mutexA = PTHREAD_MUTEX_INITIALIZER;\n\nstruct oarg_t {\n    int con_socket;\n};\n\nvoid* operacoes (void *arg)\n{\n\n    struct oarg_t* oarg = arg;\n    int id = pthread_self();\n    printf(\"Thread number: %d \\n\", id);\n    pthread_mutex_lock (&amp;mutexA);\n    printf(\"Locked\\n\");\n    sleep(10);\n    pthread_mutex_unlock (&amp;mutexA);\n    printf(\"Unlocked\\n\");\n\n    close(oarg-&gt;con_socket);\n    free(oarg);\n\n    return 0;\n\n}\n\nint main()\n\n{\n\n    const char* domain_name = \"socket_unix.teste\";\n    int i = 0;\n    int j = 0;\n\n    int sock_fd;\n\n    sock_fd = socket(AF_UNIX, SOCK_STREAM,0);\n\n    if(sock_fd&lt;0) goto error;\n    unlink(domain_name);\n\n    struct sockaddr_un sock_ser = {\n        .sun_family = AF_UNIX,\n    };\n\n    strncpy(sock_ser.sun_path, domain_name, sizeof(sock_ser.sun_path));\n\n    if(0 != bind(sock_fd, (struct sockaddr*) &amp;sock_ser, sizeof(sock_ser)))\n        goto error;\n\n    listen(sock_fd,5);\n\n    size_t counter = 0;\n\n    while(1) {\n\n        struct sockaddr_un sock_cli = {0};\n\n        int sock_len = sizeof(sock_cli);\n        int sock_novo =\n            accept(sock_fd, (struct sockaddr*)&amp;sock_cli, &amp;sock_len);\n\n        if(0 &gt; sock_novo) {\n           printf(\"Error accepting:% s\\n\", strerror(errno));\n           continue;\n        }\n\n        printf(\"Connection no %zu\\n\", counter++);\n\n        struct oarg_t* oarg = calloc(1, sizeof(struct oarg_t));\n        oarg-&gt;con_socket = sock_novo;\n\n        pthread_t id = 0;\n\n        pthread_create (&amp;id, NULL, operacoes, oarg);\n\n    }\n\n    return EXIT_SUCCESS;\n\nerror:\n\n    printf(\"ERROR: %s\\n\", strerror(errno));\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9933857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cae086e81eb3f9e641a0ed9aac61e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mart Mataias ", "link": "https://stackoverflow.com/users/9933857/mart-mataias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528875048, "creation_date": 1528867862, "last_edit_date": 1528871869, "question_id": 50829641, "link": "https://stackoverflow.com/questions/50829641/run-mutex-but-fails-to-create-multiple-threads", "title": "Run mutex, but fails to create multiple threads", "body": "<p>I am trying to simulate a server/client socket communication, and using threads for each client and then use mutex to lock and unlock those clients.</p>\n\n<p>Mutex is working fine, even if I open another terminal and run the client script, it gets blocked till server unlocks it, but for some bad coding reason, this second client gets the same ID from the first client.</p>\n\n<p>So, I want to create a new thread every time I run a new client. But I think that this \"fork\" is being the problem, for some reason... </p>\n\n<pre><code>int counter = 0;\nint i = 0;\nint j = 0;\nvoid* operacoes (void*);\npthread_mutex_t mutexA = PTHREAD_MUTEX_INITIALIZER;\npthread_t thread_id [10];\nint var;\nint jo = 0;\nint t = 0;\nint main()\n{\n    int sock_fd, sock_len, sock_novo, sock_novo_len,num;\n    struct sockaddr_un sock_ser, sock_cli;\n    char msg[100];\n\n    sock_fd = socket(AF_UNIX, SOCK_STREAM,0);\n\n    if(sock_fd&lt;0)\n    {\n    printf(\"ERROR\\n\");\n    exit(0);\n    }\n    unlink(\"socket.unix.teste\");\n    bzero((char*)&amp;sock_ser, sizeof(sock_ser));\n    sock_ser.sun_family = AF_UNIX;\n    strcpy(sock_ser.sun_path,\"socket.unix.teste\");\n    sock_len = strlen(sock_ser.sun_path) +sizeof(sock_ser.sun_family);\n    if(bind(sock_fd,(struct sockaddr*)&amp;sock_ser,sock_len)&lt;0)\n    {\n    printf(\"ERROR\\n\");\n    exit(0);\n    }\n\n    listen(sock_fd,5);\n\n    for(;;)\n    {\n    sock_novo_len = sizeof(sock_cli);\n    sock_novo = accept(sock_fd, (struct sockaddr*)&amp;sock_cli,&amp;sock_novo_len);\n\n    if(fork() == 0)\n    {\n        close(sock_fd);\n        num = atoi(msg);\n\n        counter++;\n        for (i = jo; i&lt;counter; i++)\n        {\n        pthread_create (&amp;thread_id[i], NULL, operacoes, (void *)num);        \n        jo++; \n        }\n        for (j = t; j&lt;counter; j++)\n        {\n        pthread_join(thread_id[j], NULL);;\n        t++;\n        }\n        exit(0);\n    }\n    close(sock_novo);\n    }\n    return 0;\n}\n\nvoid* operacoes (void *arg)\n{\n    if(arg == 1)\n    {\n        int id = pthread_self();\n        printf(\"Thread nummber: %d \\n\", id);\n        pthread_mutex_lock (&amp;mutexA);\n        printf(\"Locked\\n\");\n        sleep(10);      \n        pthread_mutex_unlock (&amp;mutexA);\n        printf(\"Unlocked\\n\");   \n    }\nreturn 0;\n}\n</code></pre>\n\n<p>On client side, I only send a single variable 'msg'.</p>\n\n<p>How could I solve it? I tried to use those two variables 'jo' and 't', but every new client I create, it reads the whole code, and it gets back to 0 so I cant get next phthread_create's vector position.</p>\n"}, {"tags": ["c", "string", "segmentation-fault", "newline", "null-terminated"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1528864645, "post_id": 50829151, "comment_id": 88662536, "body": "You can&#39;t modify string literals.  You need an array <code>char str[] = &quot;a\\nb\\nc\\n&quot;;</code>.  More precisely, any attempt to modify a string literal leads to undefined behaviour, and the most frequent expression of this specific subspecies of undefined behaviour is a segmentation fault and crash."}, {"owner": {"reputation": 45, "user_id": 2124236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ane5.png?s=128&g=1", "display_name": "Alex Wicks", "link": "https://stackoverflow.com/users/2124236/alex-wicks"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528864755, "post_id": 50829151, "comment_id": 88662571, "body": "Thanks! That seems to work fine. Why does that work, whereas my example doesn&#39;t?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1528865038, "post_id": 50829151, "comment_id": 88662641, "body": "Typically, the string literals are stored in a read-only memory segment, so any attempt to modify them attempts to subvert the memory protection provided by the o/s, and the o/s takes a dim view of such attempts. When you use an array, it&#39;s modifiable like any other variable. You should strictly use <code>const char *str = &quot;a\\n&quot;;</code> but historical code (from before there was a C standard) didn&#39;t use <code>const</code> (it was added to the standard), so the standard couldn&#39;t mandate it. Note that string literals may share the same space, so modifying one could modify many \u2014 whereas arrays are defined separately."}, {"owner": {"reputation": 45, "user_id": 2124236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ane5.png?s=128&g=1", "display_name": "Alex Wicks", "link": "https://stackoverflow.com/users/2124236/alex-wicks"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528865578, "post_id": 50829151, "comment_id": 88662812, "body": "Thanks for the thorough answer, that makes a lot of sense now I know that&#39;s what&#39;s happening!"}], "owner": {"reputation": 45, "user_id": 2124236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ane5.png?s=128&g=1", "display_name": "Alex Wicks", "link": "https://stackoverflow.com/users/2124236/alex-wicks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1528864754, "answer_count": 0, "score": 0, "last_activity_date": 1528864542, "creation_date": 1528864542, "question_id": 50829151, "link": "https://stackoverflow.com/questions/50829151/c-overwriting-newline-escape-character-with-null-terminator-causes-segfault", "closed_reason": "Duplicate", "title": "c - overwriting newline escape character with null terminator causes segfault", "body": "<p>So I have a string with multiple newline escape sequences within it. I would like to cut the string to the first n lines, like the head program from coreutils. For example say I have the string \"a\\nb\\nc\\n\", I would want the first line so I would want my output string to be \"a\". In other cases where I needed to cut a string I simply placed a null terminator in the position where I wanted the string to end. However when I run something like this:</p>\n\n<pre><code>void main() {\n    char *str = \"a\\nb\\nc\\n\";\n    str[1] = '\\0';\n}\n</code></pre>\n\n<p>I get a segfault. I really don't understand why. What can I do to fix this?</p>\n"}, {"tags": ["c", "text"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1528863999, "post_id": 50829064, "comment_id": 88662369, "body": "Read it out loud. Check a character is valid. If it is read another character and write it to file. See the problem?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528864155, "post_id": 50829064, "comment_id": 88662411, "body": "Quick quiz: Is <code>char</code> signed or unsigned? What values could <code>ch</code> take on that you need to test for? What values are invalid that you want to exclude? Could this code take the form of a <code>switch</code> statement?"}], "answers": [{"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 2, "last_activity_date": 1528983678, "last_edit_date": 1528983678, "creation_date": 1528865463, "answer_id": 50829268, "question_id": 50829064, "link": "https://stackoverflow.com/questions/50829064/copy-text-file-error/50829268#50829268", "title": "Copy text file error", "body": "<p>The statement</p>\n\n<pre><code>char ch = NULL;\n</code></pre>\n\n<p>is wrong as <code>ch</code> is of <code>char</code> type and <code>NULL</code> is not <code>char</code> type it's of <code>(void*)0</code> type.</p>\n\n<p>Also  <code>fgetc()</code> returns <code>int</code> not <code>char</code>, check the manual page of <code>fgetc()</code>. It says</p>\n\n<blockquote>\n  <p>fgetc() reads the next character from\u00a0streamand returns it as\n  an\u00a0unsigned\u00a0char cast to an\u00a0int, or\u00a0EOF\u00a0on end of file or error.</p>\n</blockquote>\n\n<p>For e.g </p>\n\n<pre><code>int ch = 0;\n\nwhile( (ch = fgetc(fp)) != EOF) {\n\n    if (ch &lt;= 255 &amp;&amp; ch &gt;= 0) /* what you are checking here ? Check whether it's really required */\n\n           fputc(ch, fp1);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9741326, "user_type": "registered", "profile_image": "https://graph.facebook.com/621652501502423/picture?type=large", "display_name": "Nguy\u1ec5n Ho&#224;ng Thi&#234;n &#194;n", "link": "https://stackoverflow.com/users/9741326/nguy%e1%bb%85n-ho%c3%a0ng-thi%c3%aan-%c3%82n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1528865552, "accepted_answer_id": 50829268, "answer_count": 1, "score": -1, "last_activity_date": 1528983678, "creation_date": 1528863868, "last_edit_date": 1528863975, "question_id": 50829064, "link": "https://stackoverflow.com/questions/50829064/copy-text-file-error", "closed_reason": "Duplicate", "title": "Copy text file error", "body": "<p>I wrote this program to read a paragraph written in a file in a text file and copy it to another file. The program worked ok but when I open the copy file it had a garbage character in the end. I attach my source code below.\nI keep having the \"\u00ff\" character at EOF. Can anyone help me with this?</p>\n\n<pre><code>    void main()\n{\n    FILE *fp;\n    char ch = NULL;\n    fp = fopen(\"vanban.txt\", \"r\");\n    if (fp != NULL)\n    {\n        printf(\"Mo File thanh cong!\\n\");\n        printf(\"Doc File thanh cong!\\n\");\n        char ch = NULL;\n        FILE *fp1;\n        fp1 = fopen(\"vanban1.txt\", \"w\");\n        do\n        {\n            if (ch &lt;= 255 &amp;&amp; ch &gt;= 0)\n            {\n                ch = fgetc(fp);\n                fputc(ch, fp1);\n            }\n        } while (ch != EOF);\n        fclose(fp1);\n    }\n    else\n    {\n        printf(\"FIle khong mo duoc hoac khong ton tai.\\n\");\n    }\n    fclose(fp);\n</code></pre>\n"}, {"tags": ["c", "data-structures", "dynamic", "stack", "allocation"], "comments": [{"owner": {"reputation": 35205, "user_id": 2891664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9df9d7af70d46f8db2ecd4392bb76087?s=128&d=identicon&r=PG&f=1", "display_name": "Radiodef", "link": "https://stackoverflow.com/users/2891664/radiodef"}, "edited": false, "score": 0, "creation_date": 1528863744, "post_id": 50829028, "comment_id": 88662320, "body": "What language is this? C, C++, or some other variant? Please edit the question and add proper tags so people can find it. Also see <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>."}, {"owner": {"reputation": 1, "user_id": 9933639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e350a663621688e750f9342b0363f9a3?s=128&d=identicon&r=PG&f=1", "display_name": "ad1998", "link": "https://stackoverflow.com/users/9933639/ad1998"}, "reply_to_user": {"reputation": 35205, "user_id": 2891664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9df9d7af70d46f8db2ecd4392bb76087?s=128&d=identicon&r=PG&f=1", "display_name": "Radiodef", "link": "https://stackoverflow.com/users/2891664/radiodef"}, "edited": false, "score": 0, "creation_date": 1528863890, "post_id": 50829028, "comment_id": 88662348, "body": "Please help. I am not getting anywhere. When i write capacity = 8 . Then It gives correct answer. So i think there is problem in reallocation."}, {"owner": {"reputation": 1072, "user_id": 8334818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe68206f35fbef93f6b90b3e606e401?s=128&d=identicon&r=PG&f=1", "display_name": "Pramod More", "link": "https://stackoverflow.com/users/8334818/pramod-more"}, "edited": false, "score": 0, "creation_date": 1528864311, "post_id": 50829028, "comment_id": 88662452, "body": "Can you please add some more important tags to this question"}, {"owner": {"reputation": 35205, "user_id": 2891664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9df9d7af70d46f8db2ecd4392bb76087?s=128&d=identicon&r=PG&f=1", "display_name": "Radiodef", "link": "https://stackoverflow.com/users/2891664/radiodef"}, "edited": false, "score": 1, "creation_date": 1528864339, "post_id": 50829028, "comment_id": 88662457, "body": "I think you have a bug in <code>pushStack</code>. If <code>isFullStack(S)</code> is true, then the new value is not actually pushed. The push shouldn&#39;t be done in an else block."}, {"owner": {"reputation": 1, "user_id": 9933639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e350a663621688e750f9342b0363f9a3?s=128&d=identicon&r=PG&f=1", "display_name": "ad1998", "link": "https://stackoverflow.com/users/9933639/ad1998"}, "reply_to_user": {"reputation": 35205, "user_id": 2891664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9df9d7af70d46f8db2ecd4392bb76087?s=128&d=identicon&r=PG&f=1", "display_name": "Radiodef", "link": "https://stackoverflow.com/users/2891664/radiodef"}, "edited": false, "score": 0, "creation_date": 1528864595, "post_id": 50829028, "comment_id": 88662525, "body": "Thanks @Radiodef . The solution is working."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 3, "creation_date": 1528864945, "post_id": 50829028, "comment_id": 88662615, "body": "Please don\u2019t just copy paste the text multiple times. There\u2019s a reason why you have to write more text. You need to explain the situation properly, what should happen, what\u2019s happening, what the code even does etc. Please read the <a href=\"https://stackoverflow.com/help\">help center</a> for more information."}, {"owner": {"reputation": 1, "user_id": 9933639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e350a663621688e750f9342b0363f9a3?s=128&d=identicon&r=PG&f=1", "display_name": "ad1998", "link": "https://stackoverflow.com/users/9933639/ad1998"}, "edited": false, "score": 0, "creation_date": 1528880173, "post_id": 50829028, "comment_id": 88669964, "body": "Maybe next time i will. jk. thanks for the info."}], "owner": {"reputation": 1, "user_id": 9933639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e350a663621688e750f9342b0363f9a3?s=128&d=identicon&r=PG&f=1", "display_name": "ad1998", "link": "https://stackoverflow.com/users/9933639/ad1998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528864707, "creation_date": 1528863623, "last_edit_date": 1528864707, "question_id": 50829028, "link": "https://stackoverflow.com/questions/50829028/stack-implementation-using-dynamic-array-and-repeated-doubling", "title": "Stack implementation using dynamic array and repeated doubling", "body": "<p>My code is giving output 10 10 30\nbut what it should give is 5 5 10.\nplease someone help.\ni am new in data structures and want some help.\nI think there is something wrong with allocation.\nplease someone guide me.\nMy code is giving output 10 10 30\nbut what it should give is 5 5 10.\nplease someone help.\ni am new in data structures and want some help.\nI think there is something wrong with allocation.\nplease someone guide me.\ni am new in data structures and want some help.\nI think there is something wrong with allocation.\nplease someone guide me.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n    struct DynArrayStack{\n        int top;\n        int capacity;\n        int *array;\n    };\nstruct DynArrayStack *CreateStack(){\n    struct DynArrayStack *S=malloc(sizeof(struct DynArrayStack));\n    if(!S){\n        return NULL;\n    }\n        S-&gt;capacity=1;\n        S-&gt;top=-1;\n        S-&gt;array=malloc(S-&gt;capacity*sizeof(int));\n    if(!S-&gt;array){\n        return NULL;\n    }\n    return S;\n}\nint isEmptyStack(struct DynArrayStack *S){\n    return(S-&gt;top==-1);\n}\nint isFullStack(struct DynArrayStack *S){\n    return(S-&gt;top==S-&gt;capacity-1);\n}\nvoid DoubleStack(struct DynArrayStack *S){\n    S-&gt;capacity*=2;\n    S-&gt;array=realloc(S-&gt;array,S-&gt;capacity*sizeof(int));\n}\nvoid pushStack(struct DynArrayStack *S, int data){\n    if(isFullStack(S)){\n        DoubleStack(S);\n    }\n    else{\n        S-&gt;array[++S-&gt;top]=data;\n    }\n}\nint popStack(struct DynArrayStack *S){\n    if(isEmptyStack(S)){\n        printf(\"Stack Underflow.\\n\");\n        return 0;\n    }\n    else{\n        return(S-&gt;array[S-&gt;top--]);\n\n    }\n}\nint Top(struct DynArrayStack *S){\n    if(isEmptyStack(S)){\n        return 0;\n    }\n    return S-&gt;array[S-&gt;top];\n}\nvoid deleteStack(struct DynArrayStack *S){\n    if(S){\n        if(S-&gt;array){\n            free(S-&gt;array);\n        }\n        free(S);\n    } \n}\nvoid insertBottom(struct DynArrayStack *S, int data){\n    int temp;\n    if(isEmptyStack(S)){\n        pushStack(S, data);\n        return;\n    }\n    temp=popStack(S);\n    insertBottom(S, data);\n    pushStack(S, temp);\n}\nvoid reverseStack(struct DynArrayStack *S){\n    int data;\n    if(isEmptyStack(S)){\n        return;\n    }\n    data=popStack(S);\n    reverseStack(S);\n    insertBottom(S, data);\n}\nint main(){\n    struct DynArrayStack *Stack=CreateStack();\n    pushStack(Stack, 30);\n    pushStack(Stack, 20);\n    pushStack(Stack, 10);\n    pushStack(Stack, 05);\n    printf(\"%d\\n\", Top(Stack));\n    printf(\"%d\\n\", popStack(Stack));\n    printf(\"%d\\n\", Top(Stack));\n    /*reverseStack(Stack);\n    printf(\"%d\\n\", Top(Stack));*/\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "visual-studio", "memory-leaks"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1528861187, "post_id": 50828528, "comment_id": 88661846, "body": "Get a full process dump and run a heap analysis in WinDBG. 200MB is a big chunk of change to misplace. Peruse the allocated heaps and see if you recognize repetitious data patterns. Regarding leaks of seen in the past that were elusive, leaked views on file mappings was one such rabbit hole. Closing the handle isn&#39;t enough, each view has to be unmapped as well or leaks will ensue. Just another thing to check (though, if I remember correctly, such a case doesn&#39;t turn up as private bytes; just consumption in the address space until it exhausts (32bit process in my case, thank God)."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1528868649, "post_id": 50828528, "comment_id": 88663819, "body": "You are actually distributing a debug build to the client for testing? _Crt* stuff mostly disappears in release builds (and the license requires that you not distribute the debug libraries). If you do have them run a debug build and don&#39;t see anything amiss as said it may well not be a CRT memory leak but some other resource."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1528920051, "post_id": 50828528, "comment_id": 88694163, "body": "with out the actual code, all we can do is make guesses.  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem."}, {"owner": {"reputation": 444, "user_id": 9865869, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p2qxnOoReHw/AAAAAAAAAAI/AAAAAAAACOo/Ex_LUebVKPg/photo.jpg?sz=128", "display_name": "Tim Boddy", "link": "https://stackoverflow.com/users/9865869/tim-boddy"}, "edited": false, "score": 0, "creation_date": 1528976814, "post_id": 50828528, "comment_id": 88716022, "body": "Is your application windows-specific or is it possible to compile it for Linux and run there?"}, {"owner": {"reputation": 41, "user_id": 6794518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153955536203174/picture?type=large", "display_name": "Chris Pugmire", "link": "https://stackoverflow.com/users/6794518/chris-pugmire"}, "edited": false, "score": 0, "creation_date": 1529008300, "post_id": 50828528, "comment_id": 88733422, "body": "I don&#39;t have a minimal complete verifiable example, I have one instance on one customers system (out of a thousand) where the leak occurs and a few hundred thousand lines  of code. I cannot isolate the problem or reproduce it, but it is consistent on the customers system. I have not seen it occur on linux (but it may).  Thanks for the process dump suggestion I&#39;ll see what that can do, I don&#39;t see how a heap analysis will help since the usage is external to the heap as reported by crtdbg?"}], "owner": {"reputation": 41, "user_id": 6794518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153955536203174/picture?type=large", "display_name": "Chris Pugmire", "link": "https://stackoverflow.com/users/6794518/chris-pugmire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528859023, "creation_date": 1528859023, "question_id": 50828528, "link": "https://stackoverflow.com/questions/50828528/memory-leak-not-detected-by-crtdbg-visual-studio-2008", "title": "Memory Leak not detected by CRTDBG Visual Studio 2008", "body": "<p>I have a multi threaded server application, written in 'c' that does a lot of network/tcp stuff.  On one customer system the server leaks memory at the rate of about 200mb per day. The server is running windows 2012r2</p>\n\n<p>My internal memory allocation functions don't record the leak.</p>\n\n<p>Using CRTDBG functions to analyze total memory use the leak is also not recorded.</p>\n\n<p>All private dll's we use log all memory allocations, and don't show any memory leaks.</p>\n\n<p>The only other dll's in use are standard default libraries.</p>\n\n<p>It's a 32bit build.</p>\n\n<p>The usual suspects I've eliminated already:\n1) thread creation/destruction, if I instead re-use threads the leak remains the same.\n2) memory fragmentation causing an apparent leak, I use the non fragmenting malloc, and I've tried pre allocating all the needed memory so no fragmentation will occur, and it still leaks at the same rate.</p>\n\n<p>The leak shows as peak working set, or private working set slowly increases.</p>\n\n<p>I don't see any handle leaks in taskmanager.</p>\n\n<p>So, I'm out of ideas.  Please make crazy suggestions of what else might be using up this amount of memory and NOT recorded by CRTDBG memory logging functions.</p>\n\n<p>Thanks Heaps! (pun intended) :-)</p>\n"}, {"tags": ["c", "string", "scanf", "fgets"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1528856546, "post_id": 50828218, "comment_id": 88661000, "body": "<a href=\"https://stackoverflow.com/a/50544774/3386109\">Mixing scanf and fgets is a bad idea</a>"}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 3, "last_activity_date": 1528857115, "creation_date": 1528857115, "answer_id": 50828304, "question_id": 50828218, "link": "https://stackoverflow.com/questions/50828218/why-wont-it-call-fgets/50828304#50828304", "title": "Why won&#39;t it call fgets?", "body": "<p><code>scanf</code> and <code>fscanf</code> have so many caveats <a href=\"http://c-faq.com/stdio/scanfprobs.html\" rel=\"nofollow noreferrer\">they get their own page in the C FAQ</a>. Your particular problem of <a href=\"http://c-faq.com/stdio/scanfinterlace.html\" rel=\"nofollow noreferrer\">mixing fscanf and fgets is covered by 12.18a</a>.</p>\n\n<p>In short, you typed <code>Hello\\n</code>. <code>fscanf(stdin, \"%s\", ss)</code> is reading the string <code>Hello</code>, but not the newline. That's still on <code>stdin</code>. <code>fgets</code> then reads the newline and stops. When debugging these sorts of things, it's good to put quotes around the debugging output so you can see these things. <code>printf(\"'%s'\", gs);</code></p>\n\n<p>In general, don't mix <code>fscanf</code> and <code>fgets</code>. Stick to one or the other. Generally avoid <code>scanf</code> and <code>fscanf</code> to read and parse lines, lumping reading and parsing together causes lots of problems. Instead, use <code>fgets</code> to read the whole line and <code>sscanf</code> to parse it.</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 1, "last_activity_date": 1528857234, "creation_date": 1528857234, "answer_id": 50828320, "question_id": 50828218, "link": "https://stackoverflow.com/questions/50828218/why-wont-it-call-fgets/50828320#50828320", "title": "Why won&#39;t it call fgets?", "body": "<p>It's not working as expected because when you do <code>fscanf(stdin, \"%s\", ss);</code> and when you  presses <code>ENTER</code>, it will leave <code>ENTER</code> into second buffer. Note that <code>ENTER</code> is a valid character. Hence it will read the <code>\\n</code> for second input and it will not wait for <code>fgets(gs, 10, stdin);</code>. for this you need to clear the <code>stdin</code> buffer after this </p>\n\n<pre><code>fscanf(stdin, \"%s\", ss);\n</code></pre>\n\n<p>One way of getting it done is use <code>getchar()</code>. for e.g</p>\n\n<pre><code>//fscanf block\n\n  getchar();/* help to clear the stdin buffer */\n\n//fgets block\n</code></pre>\n\n<p>Also read here why one shouldn't use <code>scanf()</code> &amp; what should be used instead of <code>scanf()</code> <a href=\"http://c-faq.com/stdio/scanfprobs.html\" rel=\"nofollow noreferrer\">http://c-faq.com/stdio/scanfprobs.html</a></p>\n"}], "owner": {"reputation": 1245, "user_id": 9270843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1f497c45bb6c42a363ad660e09c3e?s=128&d=identicon&r=PG&f=1", "display_name": "dng", "link": "https://stackoverflow.com/users/9270843/dng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1528862946, "accepted_answer_id": 50828304, "answer_count": 2, "score": 1, "last_activity_date": 1528857234, "creation_date": 1528856285, "question_id": 50828218, "link": "https://stackoverflow.com/questions/50828218/why-wont-it-call-fgets", "closed_reason": "Duplicate", "title": "Why won&#39;t it call fgets?", "body": "<p>The purpose of the code is to see how the strings are stored (whether it ends with <code>\\n</code> or <code>\\0</code>). </p>\n\n<pre><code>void print(char*);\n\nint main(void) {\n\n    //fscanf block\n    char *ss;\n    ss = malloc(sizeof(char)*100);\n    printf(\"String for fscanf: \");\n    fscanf(stdin, \"%s\", ss);\n    printf(\"For fscanf:\\n\");\n    print(ss);\n\n    //fgets block\n    char *gs;\n    gs = malloc(sizeof(char)*100);\n    printf(\"String for fgets: \");\n    fgets(gs, 10, stdin);\n    printf(\"For fgets:\\n\");\n    print(gs);\n\n    free(ss);\n    free(gs); \n}\n\nvoid print(char* str) {\n    int done = 0;\n    for (int i=0; i&lt;100; i++){\n        if (done == 3) {\n            break;\n        }\n        if (str[i] == '\\0') {\n            printf(\"Zero: %d\\n\", i);\n            done++;\n        }\n        if (str[i] == '\\n') {\n            printf(\"Return: %d\\n\", i);\n            done++;\n        }\n    }\n}\n</code></pre>\n\n<p>However for some reason, when I put the fscanf block first, it won't stop and req for the fgets string, it just jumps over and outputs: </p>\n\n<pre><code>String for fscanf: Hello\nFor fscanf:\nZero: 5\nZero: 6\nString for fgets: For fgets:\nReturn: 0\nZero: 1\n</code></pre>\n\n<p>But when I put the fgets block first it works fine:</p>\n\n<pre><code>String for fgets: Hello\nFor fgets:\nReturn: 5\nZero: 6\nString for fscanf: Hello \nFor fscanf:\nZero: 5\nZero: 6\n</code></pre>\n\n<p>Why does this occur?</p>\n"}, {"tags": ["c", "clang"], "answers": [{"comments": [{"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 1, "creation_date": 1528854416, "post_id": 50828004, "comment_id": 88660582, "body": "Interestingly enough, changing the call to <code>(*func)(&quot;%s&quot;, 42);</code> seems to break this... nevertheless a solution I can work with. :)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1528854900, "post_id": 50828004, "comment_id": 88660675, "body": "@Siguza Hmm, strange. But as long as it works for you, that&#39;s all that matters :)"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1528857631, "post_id": 50828004, "comment_id": 88661199, "body": "If you&#39;re using a macro, why not <code>static checkargs void log(...) { ... }</code>?"}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 3, "last_activity_date": 1528859320, "last_edit_date": 1528859320, "creation_date": 1528853950, "answer_id": 50828004, "question_id": 50827834, "link": "https://stackoverflow.com/questions/50827834/attribute-on-function-pointers/50828004#50828004", "title": "__attribute__ on function pointers", "body": "<p>Putting the attribute specifier on the line with the pointer declaration works (i.e. results in a warning about mismatched arguments)</p>\n\n<pre><code>log_t func __attribute__((format(printf, 1, 2))) = log; \n</code></pre>\n\n<p>So I think you're stuck with using a macro if the goal is to minimize typing and keep the code clean. Something like this:</p>\n\n<pre><code>#define checkargs __attribute__((format(printf, 1, 2)))\n\ntypedef void (*log_t)(const char*, ...);\n\nstatic checkargs void log(const char *fmt, ...)\n{\n    va_list va;\n    va_start(va, fmt);\n    vprintf(fmt, va);\n    va_end(va);\n}\n\nint main(void)\n{\n    log_t checkargs func = log;\n    func(\"%s\", 42);\n}\n</code></pre>\n"}], "owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 50828004, "answer_count": 1, "score": 3, "last_activity_date": 1528859320, "creation_date": 1528852336, "question_id": 50827834, "link": "https://stackoverflow.com/questions/50827834/attribute-on-function-pointers", "title": "__attribute__ on function pointers", "body": "<p>Sometimes I write wrappers around printf-style functions for a variety of reasons, and I really like having clang tell me about type mismatches between format specifiers and actual arguments. Consider:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n\nstatic __attribute__((format(printf, 1, 2))) void log(const char *fmt, ...)\n{\n    va_list va;\n    va_start(va, fmt);\n    vprintf(fmt, va);\n    va_end(va);\n}\n\nint main(void)\n{\n    log(\"%s\", 42);\n    return 0;\n}\n</code></pre>\n\n<p>If compiled with <code>-Wall</code>, it neatly informs me about that type mistake:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>test.c:14:15: warning: format specifies type 'char *' but the argument has type 'int' [-Wformat]\n    log(\"%s\", 42);\n         ~~   ^~\n         %d\n</code></pre>\n\n<p>That works very well for functions, but when it comes to function <em>pointers</em>, <code>__attribute__((format(printf, 1, 2)))</code> seems to have no effect anymore. The following code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef void (*log_t)(const char*, ...) __attribute__((format(printf, 1, 2)));\n\nstatic __attribute__((format(printf, 1, 2))) void log(const char *fmt, ...)\n{\n    va_list va;\n    va_start(va, fmt);\n    vprintf(fmt, va);\n    va_end(va);\n}\n\nint main(void)\n{\n    log_t func = &amp;log;\n    (*func)(\"%s\", 42);\n    return 0;\n}\n</code></pre>\n\n<p>compiles without warnings under <code>-Wall</code>, but the resulting program segfaults. I tried putting the attribute specifier in every part of the typedef, but it didn't seem to make a difference.</p>\n\n<p>Is there a way with clang to specify attributes (or <em>this</em> attribute) for function pointers so that it is actually picked up during compilation?<br>\nIf it matters, my clang reports its version as: <code>Apple LLVM version 9.0.0 (clang-900.0.39.2)</code>.</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1528851321, "post_id": 50827719, "comment_id": 88659983, "body": "I think you made a copy of the <code>mutex</code>."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1528851387, "post_id": 50827719, "comment_id": 88659999, "body": "<i>However, this does not work. Rather, it only prints master says hi and hangs.</i>  I did copy&amp;paste (the first code where you pass the lock as a thread argument) and I worked without a problem. But instead of doing <code>pthread_mutex_t lock = * (pthread_mutex_t *) arg;</code> (which creates a copy of the lock), I&#39;d do <code>pthread_mutex_t *lock =  arg;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1003, "user_id": 1628347, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/433d7beaf81227f1e762918d1eec39da?s=128&d=identicon&r=PG", "display_name": "allstar", "link": "https://stackoverflow.com/users/1628347/allstar"}, "edited": false, "score": 0, "creation_date": 1528904700, "post_id": 50827762, "comment_id": 88686198, "body": "Ahhh so it&#39;s the dereferencing of the pointer to a struct that makes a <i>copy</i> of that struct?!"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 1003, "user_id": 1628347, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/433d7beaf81227f1e762918d1eec39da?s=128&d=identicon&r=PG", "display_name": "allstar", "link": "https://stackoverflow.com/users/1628347/allstar"}, "edited": false, "score": 1, "creation_date": 1528933125, "post_id": 50827762, "comment_id": 88698804, "body": "@allstar Yup, that&#39;s the issue. The mutex is just a struct, and the code was making a copy."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 3, "last_activity_date": 1528851554, "creation_date": 1528851554, "answer_id": 50827762, "question_id": 50827719, "link": "https://stackoverflow.com/questions/50827719/using-pthread-mutex-t-lock-passed-to-thread/50827762#50827762", "title": "Using pthread_mutex_t lock passed to thread", "body": "<p>The <code>worker</code> function is making a copy of the mutex, when it should just use the existing mutex. The fix is to declare the <code>lock</code> variable as a pointer to the mutex:</p>\n\n<pre><code>void* worker(void* arg) {\n\n    pthread_mutex_t *lock = arg;\n\n    pthread_mutex_lock(lock);\n    printf(\"worker says hi\\n\");\n    pthread_mutex_unlock(lock);\n\n    return NULL;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1003, "user_id": 1628347, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/433d7beaf81227f1e762918d1eec39da?s=128&d=identicon&r=PG", "display_name": "allstar", "link": "https://stackoverflow.com/users/1628347/allstar"}, "edited": false, "score": 0, "creation_date": 1528904722, "post_id": 50827783, "comment_id": 88686208, "body": "Thank you for your answer as well, I think sorted by time the other one came in just before yours :P"}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1528852139, "last_edit_date": 1528852139, "creation_date": 1528851728, "answer_id": 50827783, "question_id": 50827719, "link": "https://stackoverflow.com/questions/50827719/using-pthread-mutex-t-lock-passed-to-thread/50827783#50827783", "title": "Using pthread_mutex_t lock passed to thread", "body": "<p>I did copy&amp;paste all your examples and not a single one hanged or showed your behaviour.</p>\n\n<p>I'm not quite sure, but I assume the problem lies in the thread function here:</p>\n\n<pre><code>pthread_mutex_t lock = * (pthread_mutex_t *) arg;\n</code></pre>\n\n<p>This creates a bitwise copy of the original mutex and depending on the contents\nof the structure, this could lead to the problems you are seeing. Hence different implementations/versions of glibc+pthreads might yield different results.</p>\n\n<p>I always pass my locks as a parameter to the thread, and I don't have the\nproblem, however I don't create copies of my locks, so I'd try this instead:</p>\n\n<pre><code>void* worker(void* arg) {\n    pthread_mutex_t *lock = arg;\n\n    pthread_mutex_lock(lock);\n    printf(\"worker says hi\\n\");\n    pthread_mutex_unlock(lock);\n\n    return NULL;\n}\n</code></pre>\n\n<p>this should solve your problem.</p>\n"}], "owner": {"reputation": 1003, "user_id": 1628347, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/433d7beaf81227f1e762918d1eec39da?s=128&d=identicon&r=PG", "display_name": "allstar", "link": "https://stackoverflow.com/users/1628347/allstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 50827762, "answer_count": 2, "score": 2, "last_activity_date": 1528852139, "creation_date": 1528851040, "question_id": 50827719, "link": "https://stackoverflow.com/questions/50827719/using-pthread-mutex-t-lock-passed-to-thread", "title": "Using pthread_mutex_t lock passed to thread", "body": "<p>I'm learning about concurrency in C. I understand there are a few ways to initialize a pthread_mutex_t.</p>\n\n<p>This simple program runs fine:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\nvoid* worker(void* arg) {\n\n    pthread_mutex_lock(&amp;lock); \n    printf(\"worker says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    return NULL;\n}\n\nint main(int argc, char *argv[]) {\n\n    pthread_t p;\n    pthread_create(&amp;p, NULL, worker, NULL);\n\n    pthread_mutex_lock(&amp;lock);\n    printf(\"master says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    pthread_join(p, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p>However, if I don't want the lock to be defined globally, I would think I can define it in my main thread and pass it to the other thread as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid* worker(void* arg) {\n    pthread_mutex_t lock = * (pthread_mutex_t *) arg;\n\n    pthread_mutex_lock(&amp;lock);\n    printf(\"worker says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    return NULL;\n}\n\nint main(int argc, char *argv[]) {\n\n    pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n    pthread_t p;\n    pthread_create(&amp;p, NULL, worker, &amp;lock);\n\n    pthread_mutex_lock(&amp;lock);\n    printf(\"master says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    pthread_join(p, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p>However, this does <em>not</em> work. Rather, it only prints  <code>master says hi</code> and hangs.</p>\n\n<p>I thought this might be deadlock, so I inserted some sleep time into the master as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid* worker(void* arg) {\n    pthread_mutex_t lock = * (pthread_mutex_t *) arg;\n\n    pthread_mutex_lock(&amp;lock);\n    printf(\"worker says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    return NULL;\n}\n\nint main(int argc, char *argv[]) {\n\n    pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n    pthread_t p;\n    pthread_create(&amp;p, NULL, worker, &amp;lock);\n\n    sleep(1);\n\n    pthread_mutex_lock(&amp;lock);\n    printf(\"master says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    pthread_join(p, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p>As expected, this printed out <code>worker says hi</code> followed by <code>master says hi</code> one second later.</p>\n\n<p>However, if I move the sleep into the worker, below as follows, it hangs again:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid* worker(void* arg) {\n    pthread_mutex_t lock = * (pthread_mutex_t *) arg;\n\n    sleep(1);\n\n    pthread_mutex_lock(&amp;lock);\n    printf(\"worker says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    return NULL;\n}\n\nint main(int argc, char *argv[]) {\n\n    pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n    pthread_t p;\n    pthread_create(&amp;p, NULL, worker, &amp;lock);\n\n    pthread_mutex_lock(&amp;lock);\n    printf(\"master says hi\\n\");\n    pthread_mutex_unlock(&amp;lock);\n\n    pthread_join(p, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p>If I put the sleep function <em>above</em> the line <code>pthread_mutex_t lock = * (pthread_mutex_t *) arg;</code> then it <em>doesn't</em> hang. I'm not sure how to explain this behavior.</p>\n"}, {"tags": ["c", "sockets", "centos", "multicast"], "comments": [{"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1528864887, "post_id": 50827679, "comment_id": 88662602, "body": "Just wondering - could it be an IPV6 problem.  Have you tried it with IPV4?"}, {"owner": {"reputation": 352, "user_id": 6531099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03754110918f2e93967a568315fb514b?s=128&d=identicon&r=PG&f=1", "display_name": "Squirrel", "link": "https://stackoverflow.com/users/6531099/squirrel"}, "reply_to_user": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1530813590, "post_id": 50827679, "comment_id": 89376536, "body": "Have not tried with IPv4 because the applications rely on IPv6 features. Looking in Wireshark, as root I can see the ICMPv6 listener report messages, but as a normal user I can not."}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1531059794, "post_id": 50827679, "comment_id": 89444861, "body": "That sounds like the packets is not leaving the source machine. Have you tried <code>iptables -P OUTPUT ACCEPT</code>?"}, {"owner": {"reputation": 2690, "user_id": 4536543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITNsf.png?s=128&g=1", "display_name": "Maxim Mazurok", "link": "https://stackoverflow.com/users/4536543/maxim-mazurok"}, "edited": false, "score": 0, "creation_date": 1531341483, "post_id": 50827679, "comment_id": 89565158, "body": "<code>selinux</code> may be the pain in the ass, as always. Try to disable it, also on both machines."}, {"owner": {"reputation": 352, "user_id": 6531099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03754110918f2e93967a568315fb514b?s=128&d=identicon&r=PG&f=1", "display_name": "Squirrel", "link": "https://stackoverflow.com/users/6531099/squirrel"}, "reply_to_user": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1531349113, "post_id": 50827679, "comment_id": 89567794, "body": "@mnistic Wouldn&#39;t it be ip6tables? Also, I don&#39;t have iptables/ip6tables running (service for the former is disabled, the latter doesn&#39;t exist)."}, {"owner": {"reputation": 352, "user_id": 6531099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03754110918f2e93967a568315fb514b?s=128&d=identicon&r=PG&f=1", "display_name": "Squirrel", "link": "https://stackoverflow.com/users/6531099/squirrel"}, "reply_to_user": {"reputation": 2690, "user_id": 4536543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITNsf.png?s=128&g=1", "display_name": "Maxim Mazurok", "link": "https://stackoverflow.com/users/4536543/maxim-mazurok"}, "edited": false, "score": 0, "creation_date": 1531349116, "post_id": 50827679, "comment_id": 89567795, "body": "@Maxim-Mazurok SELinux was and is set to permissive."}, {"owner": {"reputation": 2690, "user_id": 4536543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITNsf.png?s=128&g=1", "display_name": "Maxim Mazurok", "link": "https://stackoverflow.com/users/4536543/maxim-mazurok"}, "edited": false, "score": 0, "creation_date": 1531349222, "post_id": 50827679, "comment_id": 89567822, "body": "@Squirrel, to be sure, it&#39;s better to disable it completely"}, {"owner": {"reputation": 2690, "user_id": 4536543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITNsf.png?s=128&g=1", "display_name": "Maxim Mazurok", "link": "https://stackoverflow.com/users/4536543/maxim-mazurok"}, "edited": false, "score": 0, "creation_date": 1531349582, "post_id": 50827679, "comment_id": 89567907, "body": "also, which port are you using to create a socket?"}, {"owner": {"reputation": 270, "user_id": 9670273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4233a5654b8e2e70efa591a7ecafb67?s=128&d=identicon&r=PG&f=1", "display_name": "damadam", "link": "https://stackoverflow.com/users/9670273/damadam"}, "edited": false, "score": 0, "creation_date": 1531384392, "post_id": 50827679, "comment_id": 89578501, "body": "@Squirrel did you try with a little <code>sudo</code>?"}, {"owner": {"reputation": 563, "user_id": 3618320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2005e31bff3e25f39dab185abffab571?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3618320/aleksey"}, "edited": false, "score": 0, "creation_date": 1531389108, "post_id": 50827679, "comment_id": 89581661, "body": "Given this description of the issue, I have a strong suspicion that with the way your program is written something doesn&#39;t let it join the multicast group when it&#39;s run without root privileges. Are you carefully checking return codes from every function you use to set up your multicast listener? For instance, as far as I recall <code>SO_BINDTODEVICE</code> requires root privileges. Sometimes, there are troubles with the interface index. Perhaps, you can show the MVP (minimal viable product) code for the listener?"}], "owner": {"reputation": 352, "user_id": 6531099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03754110918f2e93967a568315fb514b?s=128&d=identicon&r=PG&f=1", "display_name": "Squirrel", "link": "https://stackoverflow.com/users/6531099/squirrel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1530824419, "creation_date": 1528850614, "last_edit_date": 1530824419, "question_id": 50827679, "link": "https://stackoverflow.com/questions/50827679/centos-7-4-user-cannot-receive-multicast-packets", "title": "CentOS 7.4: User Cannot Receive Multicast Packets", "body": "<h3>Setup</h3>\n\n<ul>\n<li><p><strong>Machine 1</strong> (CentOS 7.4) has a process sending multicast UDP datagrams to an IPv6 site-local multicast group. The process is running as root.</p></li>\n<li><p><strong>Machine 2</strong> (also CentOS 7.4) has a process whose UDP datagram socket joins the multicast group machine one is sending to, then continuously calls the (in this socket's case, blocking) <code>recv()</code> function.</p></li>\n</ul>\n\n<p>Both applications are written in C.</p>\n\n<h3>Problem</h3>\n\n<p>When running as <em>root</em> on machine two, the datagrams <strong>can</strong> be received without issue.\nWhen running as a <em>user</em> however, the datagrams are <strong>not</strong> received with the blocking <code>recv()</code> call. </p>\n\n<p>The firewalld device has been stopped in both cases, and in both cases the socket creation is successful (no errors on the socket API calls... creation, joining, receive, etc.).</p>\n\n<h3>Question</h3>\n\n<p>What permissions, if any, might be preventing my process running as a user from receiving the same multicast packets that the process running as root can?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 2, "creation_date": 1528848985, "post_id": 50827471, "comment_id": 88659513, "body": "check the field spec in the scan statement."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1528849064, "post_id": 50827471, "comment_id": 88659530, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon.  Do not tag C questions with the C++ tag.  Do indent your code more meaningfully (avoid tabs when creating code to be displayed in SO).  Assume that your compiler and IDE are perfect \u2014 you&#39;re unlikely to have found a bug in either, and thinking that it might not be a fault in your code shows that you are a tyro.  It&#39;s always your fault \u2014 even if you&#39;ve been programming 30 years."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1528849182, "post_id": 50827471, "comment_id": 88659547, "body": "One basic debugging technique: print values that are read after you&#39;ve read them.  You have <code>scanf(&quot;%lf&quot;, &amp;choose);</code>.  You should check that it succeeded, and you should review the type that <code>&quot;%lf&quot;</code> looks for and the type that <code>choose</code> has.  If your compiler did not tell you about the problem, turn up the warnings or get a better compiler.  (You should also check the other uses of <code>scanf()</code> \u2014 if you don&#39;t get <code>1</code> returned each time, you&#39;ve got input problems, such as a letter instead of a number in the input.)"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1528852895, "post_id": 50827471, "comment_id": 88660278, "body": "It&#39;s never Lupus. It&#39;s always scanf()."}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 1, "last_activity_date": 1528850911, "last_edit_date": 1528850911, "creation_date": 1528850070, "answer_id": 50827619, "question_id": 50827471, "link": "https://stackoverflow.com/questions/50827471/why-the-switch-statement-displays-default-in-this-c-calculator/50827619#50827619", "title": "Why the switch statement displays default in this C calculator?", "body": "<p>You are reading in a double for <code>choose</code></p>\n\n<pre><code>scanf(\"%lf\", &amp;choose);\n</code></pre>\n\n<p>Change to reading a decimal</p>\n\n<pre><code>scanf(\"%d\", &amp;choose);\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9932955, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-a70GYsSHwtE/AAAAAAAAAAI/AAAAAAAAAAA/thACZWjPasw/photo.jpg?sz=128", "display_name": "Abdullah Zareaa", "link": "https://stackoverflow.com/users/9932955/abdullah-zareaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50827619, "answer_count": 1, "score": 0, "last_activity_date": 1528857253, "creation_date": 1528848741, "last_edit_date": 1528857253, "question_id": 50827471, "link": "https://stackoverflow.com/questions/50827471/why-the-switch-statement-displays-default-in-this-c-calculator", "title": "Why the switch statement displays default in this C calculator?", "body": "<p>When I run this program, it ignores everything in the <code>switch</code> statement, and displays the <code>default</code>. \nI am using Code::Blocks. \nPlease explain to me why this logic error is encountered and maybe it is an error in Code::Blocks and not from the code \u2014 should I try it on another IDE?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n    int main()\n    {\n        double a,b;\n        int choose,subtract,divide;\n        printf(\"My first Calculater in c\\n\");\n        printf(\"\\n\");\n        printf(\"Enter your two numbers\\n\");\n        scanf(\"%lf\",&amp;a);\n        scanf(\"%lf\",&amp;b);\n        printf(\"Please choose an operation\\n\");\n         printf(\"1.add two no.(s)\\n\");\n         printf(\"2.subtract two no.(s)\\n\");\n         printf(\"3.multiply two no.(s)\\n\");\n         printf(\"4.divide two no.(s)\\n\");\n         printf(\"please choose an operation \");\n           scanf(\"%lf\", &amp;choose);\n\n    switch(choose){\n\n     case 1:\n        printf(\"sum of a+b is : %lf\\n\",(a+b));\n        break;\n\n     case 2:\n        printf(\"1.a-b?\\n\");\n        printf(\"2.b-a?\\n\");\n        scanf(\"%d\", &amp;subtract);\n        switch(subtract)\n        {\n         case 1:\n            printf(\"\\ndiff of a-b is : %lf\",(a-b));\n            break;\n\n         case 2:\n            printf(\"\\ndiff of b-a is : %lf\",(b-a));\n             break;\n\n        }\n     case 3:\n            printf(\"\\nproduct of a*b is : %lf\",(a*b));\n             break;\n\n     case 4:\n            printf(\"\\n1.divide a/b?,a!=0\");\n            printf(\"\\n2.divide b/a?,b!=0\");\n            scanf(\"%d\", &amp;divide);\n            switch(divide)\n            {\n            case 1:\n                if(b==0)\n                    printf(\"\\ndivision by zero is undefined\");\n                    else\n                       printf(\"\\nquotient of a/b is : %lf\",(a/b));\n                    break;\n            case 2:\n\n                if(a==0)\n                    printf(\"\\ndivision by zero is undefined\");\n                    else\n                        printf(\"\\nquotient of b/a is : %lf\",(b/a));\n                        break;\n           }\n     default:\n          printf(\"please choose either 1,2,3 or 4 options\\n\");\n        }\n\n    }\n</code></pre>\n"}, {"tags": ["c", "math", "bit-manipulation"], "comments": [{"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 0, "creation_date": 1528849034, "post_id": 50827390, "comment_id": 88659523, "body": "You can&#39;t test for a positive value with a single bit test; not with any of the standard methods of representing signed binary integers anyway.  What your code in that image will do (assuming twos complement) is return 1 on a positive odd number, or 0 on any other positive number."}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "reply_to_user": {"reputation": 19081, "user_id": 6246044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMZMd.jpg?s=128&g=1", "display_name": "Rory Daulton", "link": "https://stackoverflow.com/users/6246044/rory-daulton"}, "edited": false, "score": 0, "creation_date": 1528849287, "post_id": 50827390, "comment_id": 88659567, "body": "@RoryDaulton done!"}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 0, "creation_date": 1528849444, "post_id": 50827390, "comment_id": 88659591, "body": "Try that code on a positive even number, 42 for example.  You&#39;ll compute 1 at the &quot;positive sign&quot; bit after inverting <code>lsb</code>; and then <code>1 &amp; 42</code> returns a zero."}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "reply_to_user": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 0, "creation_date": 1528849527, "post_id": 50827390, "comment_id": 88659603, "body": "@MikeHousky I thought (from lectures) that only 31 bits are used for magnitude and the last bit is used for the sign, so I used the right shift to move this to the very right so that could determine whether it is a 0 or 1, 0 being positive and 1 being negative. From there, I then used the exclusive or with 1, which would return 1 if lsb is 0 or 0 if lsb is 1. So at this point, it is 1 if x is positive and 0 if x is negative, correct?  Now I add the &amp; x in order to take care of the 0 case.  At least, this is the logic I have in my mind, where have I gone wrong?"}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 1, "creation_date": 1528849645, "post_id": 50827390, "comment_id": 88659630, "body": "Never mind; you modified x in the process of computing lsb. The final value of x is just the non-inverted sign bit of the original number and lsb is the inverted value of that bit.  Your result is <i>always</i> zero."}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "reply_to_user": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 0, "creation_date": 1528849682, "post_id": 50827390, "comment_id": 88659635, "body": "@MikeHousky I was also under the impression that 1 &amp; 42 should return 1 in C? Is it not the case that any number that is not zero is true?"}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 0, "creation_date": 1528849813, "post_id": 50827390, "comment_id": 88659662, "body": "&quot;Positive&quot; means &quot;greater than zero&quot;, and in most formats both zero and positive values have 0 as a sign bit."}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 1, "creation_date": 1528849865, "post_id": 50827390, "comment_id": 88659668, "body": "That the definition of &amp;&amp;, not bitwise &amp;."}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 0, "creation_date": 1528849992, "post_id": 50827390, "comment_id": 88659701, "body": "If you&#39;re allowed to use &amp;&amp; (returns 1 if both operands are nonzero, or 0 otherwise) then simply using <code>return x &amp;&amp; (x&gt;&gt;31);</code> will get your positive test done in one statement.  But &amp;&amp; is not a bitwise operation."}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "reply_to_user": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "edited": false, "score": 0, "creation_date": 1528850336, "post_id": 50827390, "comment_id": 88659766, "body": "@MikeHousky Ah... Ok, yes &amp;&amp; is not an acceptable operation in this case for the assignment, so I will have to figure out either a completely new process or some other way to account for x being 0. It is my first day so most problems are very challenging to me, sorry for the trouble!  I had seen a solution for checking if any integer x is zero which simply returned !x and that is why I was under the impression that 0 --&gt; false, all other integers --&gt; true."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1528927881, "post_id": 50827390, "comment_id": 88697508, "body": "Xor-invert and not-invert, gives you the same, <code>lsb == result</code>. This could be simplified (I think) to <code>return !((x &gt;&gt; 31) | !x)</code>, but this invokes undefined, (er, implementation-defined,) behaviour if not cast, <a href=\"https://stackoverflow.com/a/4009954/2472827\">stackoverflow.com/a/4009954/2472827</a>."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529110738, "post_id": 50827390, "comment_id": 88770309, "body": "If <code>x</code> is a <code>signed int</code> - it ought to be ;) - shifting it right is implementation specific if <code>x</code> happens to become negative."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 1, "creation_date": 1528850428, "post_id": 50827624, "comment_id": 88659786, "body": "For these particular problems, we are given restrictions on the operators we may use, the legal ones being:  ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528852937, "post_id": 50827624, "comment_id": 88660290, "body": "Are you specifically on a machine where <code>int</code> is 32 bits and two&#39;s-complement and you are allowed to use the do casting?"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528853441, "post_id": 50827624, "comment_id": 88660391, "body": "In which case, one would probably start by casting <code>int</code> to <code>unsigned</code> for ease of bit manipulation. <code>and</code> it with -1 cast to unsigned and take the negation."}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 1, "creation_date": 1528854364, "post_id": 50827624, "comment_id": 88660567, "body": "No casting I believe, but I have since posting solved the problem by returning !(result | !x);  Yes, the machine we are testing under should be int at 32 bits and two&#39;s complement. No casting of any form is allowed for the solutions however."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528859100, "post_id": 50827624, "comment_id": 88661472, "body": "One can use <code>INT_MAX</code> in <code>limits.h</code> to get bit-length agnostic tests, but I&#39;m not sure how portable it is. I&#39;d be sure to test the edge cases and parity flips: <code>INT_MIN, -2, -1, 0, 1, 2, INT_MAX</code>."}], "tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 1, "last_activity_date": 1528928941, "last_edit_date": 1528928941, "creation_date": 1528850084, "answer_id": 50827624, "question_id": 50827390, "link": "https://stackoverflow.com/questions/50827390/bitwise-arithmetic-in-c-checking-if-a-number-is-positive/50827624#50827624", "title": "Bitwise Arithmetic in C: Checking if a number is positive", "body": "<p><a href=\"https://graphics.stanford.edu/~seander/bithacks.html#CopyIntegerSign\" rel=\"nofollow noreferrer\">https://graphics.stanford.edu/~seander/bithacks.html#CopyIntegerSign</a></p>\n\n<p>Technically, an <code>int</code> could be a different size on different machines; use of an C99 <code>int32_t</code> from <code>inttypes.h</code> may help with portability. It might not even be encoded in the format you expect, <a href=\"https://stackoverflow.com/q/12276957/2472827\">Are there any non-twos-complement implementations of C?</a>.</p>\n\n<p>The really portable easy way, is of course,</p>\n\n<pre><code>static int is_positive(const int a) {\n    return a &gt; 0;\n}\n</code></pre>\n\n<p>The compiler will probably do a better job optimising it.</p>\n\n<p>Edit: From comments, I came up with this; I tried to make it agnostic of the <code>int</code>-size. It is very much the same style as your own, checking whether the number is negative or zero, and inverting.</p>\n\n<pre><code>#include &lt;stdio.h&gt;  /* printf */\n#include &lt;limits.h&gt; /* INT_ */\n#include &lt;assert.h&gt; /* assert */\n\n/** Assumes a is a 2's-compliment number\n and ~INT_MAX = 0b100..00, (checks if negative.) */\nstatic int is_positive(const int a) {\n    unsigned b = a;\n    return !((b &amp; ~INT_MAX) | !b);\n}\n\nstatic int is_really_positive(const int a) {\n    return a &gt; 0;\n}\n\nstatic void test(const int a) {\n    printf(\"Number %d. Is positive %d.\\n\", a, is_positive(a));\n    assert(is_positive(a) == is_really_positive(a));\n}\n\nint main(void) {\n    test(INT_MIN);\n    test(-2);\n    test(-1);\n    test(0);\n    test(1);\n    test(2);\n    test(INT_MAX);\n    return 0;\n}\n</code></pre>\n\n<p>Also related, <a href=\"https://stackoverflow.com/a/3532331/2472827\">https://stackoverflow.com/a/3532331/2472827</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528855625, "post_id": 50827702, "comment_id": 88660835, "body": "Hello,  I was giving your solution some thought because it looked interesting and I wanted to understand it; I think (if you don&#39;t mind), it would help me to see what is happening to the bits as we are manipulating it through the code, more specifically what is going on during the double negation.  I also have a few questions:  Is it not that the 0x80000000 &amp; a returns 0x80000000 if it is negative? What exactly do you do with this after? And so this result is true because it is non-zero correct when you use the ! operator, correct?"}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528855839, "post_id": 50827702, "comment_id": 88660872, "body": "Also, your method may have given me an idea for another solution; roughly speaking, I would start with 0x80000000 and compare x with this, returning 0x80000000 again if it is negative. I would then shift it &gt;&gt; 31 (call this b), then use a int 0x1 and the &amp; operator to determine the value of the shifted bit. If b &amp; 0x1 returns 1, the original value was negative and if it returns 0 then i know it was positive.  But I guess this still runs into the issue of when the value is zero; for this assignment, positive is x &gt; 0, so 0 should actually return the same value as what a negative value would."}, {"owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "reply_to_user": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528888411, "post_id": 50827702, "comment_id": 88675234, "body": "@dan You are right about the <code>0x80000000</code> returned by the bitwise-and. To overcome that fact, I double negate the result. So, what is <code>!0x80000000</code>? It is <code>0</code>. Than, that result gets negated again, and what&#39;s the result of <code>!0</code>? It&#39;s <code>1</code>. And this also accounts for the zero case. If you negate zero twice, what do you get? <code>!0 = 1</code>, and then <code>!1 = 0</code>. Note that the zero case and the positive case are the same thing, since the bitwise-and will return zero on positive numbers and zero. All clear?"}, {"owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "reply_to_user": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528889562, "post_id": 50827702, "comment_id": 88675999, "body": "@dan I added a code to the answer to help you visualize what is happening. Tell me if that helps or if you have any other doubts."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529111763, "post_id": 50827702, "comment_id": 88770432, "body": "That&#39;s the most elegant answer given the assumptions that its 32 bits and two&#39;s complement wer are dealing with - I actually don&#39;t really understand why other answers fiddle around with shifting back and forth when it all boils down to checking if the MSB is set or not...?"}], "tags": [], "owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "is_accepted": false, "score": 1, "last_activity_date": 1528889526, "last_edit_date": 1528889526, "creation_date": 1528850906, "answer_id": 50827702, "question_id": 50827390, "link": "https://stackoverflow.com/questions/50827390/bitwise-arithmetic-in-c-checking-if-a-number-is-positive/50827702#50827702", "title": "Bitwise Arithmetic in C: Checking if a number is positive", "body": "<p>If you know the representation is <a href=\"https://stackoverflow.com/questions/1049722/what-is-2s-complement\">2's complement</a>, then you can do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define IS_NEG(a)   (!!((1 &lt;&lt; 31) &amp; (a)))\n\nint main(void)\n{\n    int n;\n\n    while(1) {\n        scanf(\"%d\", &amp;n);\n        printf(\"negative: %d\\n\", IS_NEG(n));\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Explanation:</p>\n\n<ol>\n<li><code>(1 &lt;&lt; 31)</code> will take the number 1 and shift it 31 times to the left, thus giving you <code>1000 0000 0000 0000 0000 0000 0000 0000</code>. If you don't want to use the shift, you could use <code>0x80000000</code> too.</li>\n<li><code>&amp; (a)</code> does a bitwise test with that big binary number. Since an AND operation only returns <code>TRUE</code> when both operands are <code>TRUE</code>, it follows that only if your number is negative (<strong>in 2's complement representation</strong>) that this will return <code>TRUE</code>.</li>\n<li><code>!!(...)</code> This double negation accounts for the fact that when you do that bitwise AND, the returned value by the expression will be <code>(1 &lt;&lt; 31)</code> if the number is really negative. So we invert it (giving us zero), than invert it again (giving us 1). Therefore, this ensures that we get a ZERO or a ONE as a final result.</li>\n<li><code>IS_NEG</code> will return 0 on positive numbers AND 0, and returns 1 on all negative numbers.  </li>\n</ol>\n\n<p>Since the MSB will be a one when the number is negative, just test that bit. Note that this will only work for 32 bit integers (so you have to check that with a <code>sizeof(int)</code>. The example returns 1 if a number is <em>negative</em>, but should be no problem reworking it to return 1 for positive numbers.</p>\n\n<p>Let me know if this doesn't solve the problem. As I understand, you just want to test if any given <code>int</code> is positive/negative.\n<hr>\n<strong>Edit</strong>: From the comments, I made a program to help you see what's going on. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define IS_NEG(a)   (!!(0x80000000 &amp; (a)))\n\nchar buf[65];\n/* converts an integer @n to binary represention of @bits bits */\nchar *bin(int n, unsigned int bits)\n{\n    char *s = buf;\n    for(bits = (1 &lt;&lt; (bits - 1)); bits &gt; 0; bits = bits &gt;&gt; 1)\n        /* look! double negation again! Why this? :) */\n        *s++ = !!(n &amp; bits) + 48;\n\n    *s = 0;\n    return buf;\n}\n\nint main(void)\n{\n    /* R will be our partial result through-out the loop */\n    int r, n;\n\n    while(1) {\n        /* get the number */\n        scanf(\"%d\", &amp;n);\n\n        /* this is the inner part of the macro\n         * after this, we could say IS_NEG \"becomes\"\n         * (!!(r))\n         */\n        r = n &amp; 0x80000000;\n        printf(\"n &amp; 0x80000000: 0x%x\\n\", r);\n        printf(\"  n = %s\\n\", bin(n, 32));\n        printf(\"  r = %s\\n\", bin(r, 32));\n\n        /* now we print what R is, so you see that the bitwise AND will\n         * return 0x80000000 on negative numbers. It will also print\n         * the NEGATION of R...\n         * \n         * After the printf(), we just assign the negated value to R.\n         */\n        printf(\"r = 0x%x, !r = 0x%x\\n\", r, !r);\n        r = !r;\n        printf(\"  r = %s\\n\", bin(r, 32));\n        /* After this, IS_NEG \"becomes\" (!(r)) */\n\n        /* In the MACRO, this would be the second negation. */\n        printf(\"r = 0x%x, !r = 0x%x\\n\", r, !r);\n        r = !r;\n        printf(\"  r = %s\\n\", bin(r, 32));\n\n        /* Now, if R is 0, it means the number is either ZERO or \n         * POSITIVE.\n         *\n         * If R is 1, then the number is negative\n         */\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528854178, "post_id": 50827828, "comment_id": 88660530, "body": "I will make sure to go over this solution! I usually have to write it all out and trace the code to make sense of it all. Thank You!  One more note, although not really that important (and I have since our previous exchanges solved the problem), we are restricted to only 8 total operators to solve the problem.  My solution was to return !(result | !x); it appears to pass all the tests as of now, and I got full marks for the function."}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "reply_to_user": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528860877, "post_id": 50827828, "comment_id": 88661783, "body": "@dan Careful. That ! operator isn&#39;t a bitwise operator either.  (...but it will give you a &quot;not zero&quot; test.)"}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528869845, "post_id": 50827828, "comment_id": 88664283, "body": "Thanks, I had the operators mixed up; it is one of the logical operators that were allowed for the problem. I&#39;ll make sure to review up on exactly which operators are logical and which are bitwise so I don&#39;t mix them up in the future."}], "tags": [], "owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "is_accepted": false, "score": 0, "last_activity_date": 1528852269, "creation_date": 1528852269, "answer_id": 50827828, "question_id": 50827390, "link": "https://stackoverflow.com/questions/50827390/bitwise-arithmetic-in-c-checking-if-a-number-is-positive/50827828#50827828", "title": "Bitwise Arithmetic in C: Checking if a number is positive", "body": "<p>You can get a 32-bit wide zero-or-nonzero test using bitwise or and shifts as follows:</p>\n\n<pre><code>int t;\nt = x | (x&gt;&gt;16);\nt = t | (t &gt;&gt; 8);\nt = t | (t &gt;&gt; 4);\nt = t | (t &gt;&gt; 2)\nt = (t | (t&gt;&gt;1)) &amp; 1;\n</code></pre>\n\n<p>This sets <code>t</code> to the \"OR\" of the low 32 bits of x and will 0 if and only if the low 32 bits are all zero.  If the <code>int</code> type is 32 bits or less, this will be equivalent to <code>(x != 0)</code>.  You can combine that with your sign bit test:</p>\n\n<pre><code>return t &amp; (~x &gt;&gt; 31);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528853854, "post_id": 50827842, "comment_id": 88660475, "body": "Hi,  so in your solution, is the case where x is 0 accounted for? As this should not return that it is positive for my assignment. Also, we are restricted to only bit manipulation, meaning we cannot use the if-else statement that you included at the end! I have however, since my original post, found a solution that uses all that I had originally written, however my return statement now makes use of the | operator instead."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "edited": false, "score": 0, "creation_date": 1528855587, "post_id": 50827842, "comment_id": 88660831, "body": "Well then @dan -- it looks like you have some further work to do on <i>your assignment</i>."}, {"owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1528855934, "post_id": 50827842, "comment_id": 88660893, "body": "@DavidC.Rankin Indeed, I am really now just exploring the other suggestions and see what techniques people use, I have already moved on to the next problem! :)"}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1528856102, "last_edit_date": 1528856102, "creation_date": 1528852429, "answer_id": 50827842, "question_id": 50827390, "link": "https://stackoverflow.com/questions/50827390/bitwise-arithmetic-in-c-checking-if-a-number-is-positive/50827842#50827842", "title": "Bitwise Arithmetic in C: Checking if a number is positive", "body": "<p>To check whether given number is positive or negative. As you mentioned <code>x</code> is an <code>int</code> &amp; I assume its 32-bit long signed int. for e.g</p>\n\n<pre><code>int x = 0x7fffffff;\n</code></pre>\n\n<p>How above <code>x</code> represented in binary </p>\n\n<pre><code> x  =&gt;  0111 1111 | 1111 1111 | 1111 1111 | 1111 1111 \n        |                                           |\n        MSB                                         LSB\n</code></pre>\n\n<p>Now to check given number is positive or negative using bitwise opaertor, just find out the status of last(MSB or 31st(longint)  or 15th(short int)) bit status whether it's <code>0</code> or <code>1</code>, if last bit is found as <code>0</code> means given number is positive otherwise negative.</p>\n\n<p>Now How to check last bit(31st) status ? Shift last(31st) bit to <code>0th</code> bit and perform bitwise AND &amp; operation with <code>1</code>.</p>\n\n<pre><code>x     =&gt;  0111 1111 | 1111 1111 | 1111 1111 | 1111 1111\nx&gt;&gt;31 =&gt;  0000 0000 | 0000 0000 | 0000 0000 | 0000 0000  \n          --------------------------------------------- \n                                                      &amp;\n  1   =&gt;  0000 0000 | 0000 0000 | 0000 0000 | 0000 0001\n          ---------------------------------------------\n          0000 0000 | 0000 0000 | 0000 0000 | 0000 0000 =&gt; its binary of zero( 0 ) so its a positive number\n</code></pre>\n\n<p>Now how to program above</p>\n\n<pre><code>static inline int sign_bit_check(int x) { \n        return (x&gt;&gt;31) &amp; 1;\n}\n</code></pre>\n\n<p>And call the <code>sign_bit_check()</code> like </p>\n\n<pre><code>int main(void) {\n        int x = 0x7fffffff;\n        int ret = sign_bit_check(x);\n        if(ret) {\n                printf(\"Negative\\n\");\n        }\n        else {\n                printf(\"positive \\n\");\n        }\n        return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1528906474, "post_id": 50828033, "comment_id": 88687256, "body": "Or just the other way around, test is_negative with <code>return x &amp; (1U&lt;&lt;(CHAR_BIT*sizeof x-1))</code>, which hides the unsigned conversion (it is implicit)."}, {"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529113501, "post_id": 50828033, "comment_id": 88770640, "body": "@MichaelBeer Not a rhetorical question: so what?  Is there some representation and value for which this gives a wrong result?  I might be about to scrape egg off my face, but high bit zero, some nonzero other bits defines nonzero positive in every value representation I know of and I think this detects them all and no others."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529114986, "post_id": 50828033, "comment_id": 88770804, "body": "@jthill I just wonder... reading 6.2.6.2 of the c11 standard, I can&#39;t currently even see that it is stating that the sign bit needs to be the MSB?"}, {"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529117105, "post_id": 50828033, "comment_id": 88771034, "body": "@MichaelBeer Again: so what? Instead of spouting yet another random paragraph, how about answering the question: so, what?  Work out the actual consequences."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529143406, "post_id": 50828033, "comment_id": 88775238, "body": "I did not want to bash your answer, I was just keen to know what I asked. If I apply your first function onto a 16 bit/ 2 byte signed magnitude encoded int (sign bit MSB) the function seems to fail - it returns true if the bit is set? Hence my question: Did you design then for all allowed encodings? Did I just misapply your function?"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529146031, "post_id": 50828033, "comment_id": 88775771, "body": "The root problem I wonder about is: Why do you bother coing up with a clumsy way like this? As you said, (and if I understand correctly): In all 3 representations allowed the sign bit determines the wether the int is negative or not. And if you assume that the sign bit always resides at a specific position (the MSB ?), it all boils down to check for that particular bit being set. Why not just do <code>return  x &amp; (1 &lt;&lt; (CHAR_BIT * sizeof(x) - 1))</code> ? You would also circumvent the necessity of casting the <code>x</code> because you wont shift it righ, right?"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529146504, "post_id": 50828033, "comment_id": 88775872, "body": "... Forgot the <code>!</code>."}, {"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529148367, "post_id": 50828033, "comment_id": 88776290, "body": "@MichaelBeer your method fails on zero."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1529148728, "post_id": 50828033, "comment_id": 88776380, "body": "If you think so... The entire point I was interested in were the question I posed. Ostensibly I fail in explain my question to you. Sorry."}, {"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "edited": false, "score": 0, "creation_date": 1529153226, "post_id": 50828033, "comment_id": 88777416, "body": "If you have a question, there&#39;s this website built for getting answers. Your questions are utterly irrelevant to <i>this</i> answer to <i>this</i> question.  Please, stop the ignorant posturing."}], "tags": [], "owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "is_accepted": false, "score": 1, "last_activity_date": 1529207394, "last_edit_date": 1529207394, "creation_date": 1528854268, "answer_id": 50828033, "question_id": 50827390, "link": "https://stackoverflow.com/questions/50827390/bitwise-arithmetic-in-c-checking-if-a-number-is-positive/50828033#50828033", "title": "Bitwise Arithmetic in C: Checking if a number is positive", "body": "<p>Given the allowed operators from your comment,  <code>! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</code>, edit: with the later constraint of no casts only the second alternative fits:</p>\n\n<pre><code>static int is_positive(unsigned x)\n{\n        return ~x+1 &gt;&gt; (CHAR_BIT*sizeof x-1);\n}\n</code></pre>\n\n<p>Here's the deal: conversion to unsigned is very carefully specified in C: if the signed value is unrepresentable in the unsigned type, one plus the maximum value representable in the unsigned type is added (or subtracted, no idea what prompted them to include this possibility) to the incoming value until the result <em>is</em> representable.  </p>\n\n<p>So the result depends only on the incoming value, not its representation. -1 is converted to UINT_MAX, no matter what. This is correct, since <a href=\"http://www.inwap.com/pdp10/hbaker/hakmem/hacks.html#item154\" rel=\"nofollow noreferrer\">the universe itself runs on  twos-complement notation</a> . That it also makes the conversion a simple no-op reinterpretation on most CPUs is just a bonus.</p>\n"}], "owner": {"reputation": 17, "user_id": 9205480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee7409f7b2d884fac593ec10ee3f93a?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9205480/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1610, "favorite_count": 1, "answer_count": 5, "score": 0, "last_activity_date": 1529207394, "creation_date": 1528847873, "last_edit_date": 1528854541, "question_id": 50827390, "link": "https://stackoverflow.com/questions/50827390/bitwise-arithmetic-in-c-checking-if-a-number-is-positive", "title": "Bitwise Arithmetic in C: Checking if a number is positive", "body": "<p>x is an int,</p>\n\n<p>I should be able to get the correct result when 0 is not involved. In attempts to account for the 0 case, I added \"&amp; x\", which I believe now should return that a number is positive iff x > 0 and x is not 0 (because in c, any number other than 0 evaluates to true, correct?)</p>\n\n<p>But, when running my tests, it says it has failed to evaulate 0x7fffffff as positive and I am not sure why!</p>\n\n<p>Here is my code:</p>\n\n<pre><code>int mask = 0x1;\nx = x &gt;&gt; 31;\nint lsb = mask &amp; x;\nreturn ( (lsb) ^ 0x1) &amp; (x) )\n</code></pre>\n\n<p>Edit: I have solved the problem by changing the code to the one below! Feedback is still very much appreciated, or any problems you may spot.</p>\n\n<pre><code>int mask = 0x1;\nint lsb = (x &gt;&gt; 31) &amp; mask;\nint result = !(lsb ^ 0x1);\nreturn !(result | !x);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 754, "user_id": 8402500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XZRs6.jpg?s=128&g=1", "display_name": "G.Alexander", "link": "https://stackoverflow.com/users/8402500/g-alexander"}, "edited": false, "score": 0, "creation_date": 1528847197, "post_id": 50827217, "comment_id": 88659182, "body": "Please tell more detail about your code. What is the &quot;right format&quot;? You mean that, you allow <code>float</code> only?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528847469, "post_id": 50827217, "comment_id": 88659226, "body": "Read a <i>line</i> of user input with <code>fgets()</code>, then convert to <code>float</code> with <code>strtof()</code>."}, {"owner": {"reputation": 199, "user_id": 4314069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/47b6638bb41afd6f697c7dba91980c51?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Sanchez", "link": "https://stackoverflow.com/users/4314069/abraham-sanchez"}, "edited": false, "score": 0, "creation_date": 1528847585, "post_id": 50827217, "comment_id": 88659245, "body": "You need to read the return value coming from scanf_s to check if an input failure occurred."}, {"owner": {"reputation": 59, "user_id": 9706897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LLVV7T94LFc/AAAAAAAAAAI/AAAAAAAAAYA/SkHkQQBfqL0/photo.jpg?sz=128", "display_name": "Serkan K.", "link": "https://stackoverflow.com/users/9706897/serkan-k"}, "reply_to_user": {"reputation": 754, "user_id": 8402500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XZRs6.jpg?s=128&g=1", "display_name": "G.Alexander", "link": "https://stackoverflow.com/users/8402500/g-alexander"}, "edited": false, "score": 0, "creation_date": 1528847787, "post_id": 50827217, "comment_id": 88659288, "body": "@A.Godnov Yes exactly."}, {"owner": {"reputation": 59, "user_id": 9706897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LLVV7T94LFc/AAAAAAAAAAI/AAAAAAAAAYA/SkHkQQBfqL0/photo.jpg?sz=128", "display_name": "Serkan K.", "link": "https://stackoverflow.com/users/9706897/serkan-k"}, "edited": false, "score": 0, "creation_date": 1528848270, "post_id": 50827217, "comment_id": 88659384, "body": "Thanks for your answers. It helped me alot."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528848328, "post_id": 50827386, "comment_id": 88659391, "body": "<code>float input; IsRightFormat(input)</code> cannot check if input is in the correct format.  It can only check values of <code>input</code>, if the <code>scanf_s()</code> was successful."}], "tags": [], "owner": {"reputation": 567, "user_id": 9919541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6433068cc0af15d64b33a390f7393c3?s=128&d=identicon&r=PG&f=1", "display_name": "yakobyd", "link": "https://stackoverflow.com/users/9919541/yakobyd"}, "is_accepted": true, "score": 0, "last_activity_date": 1528847846, "creation_date": 1528847846, "answer_id": 50827386, "question_id": 50827217, "link": "https://stackoverflow.com/questions/50827217/how-do-i-add-a-loop-for-scanf-in-c/50827386#50827386", "title": "How do I add a loop for scanf in C?", "body": "<p>You should define what a right format is. But in a form of pseudo-code</p>\n\n<pre><code>float input;\n\n// First get the input\ndo { \n    sacnf_s(\"%f\", &amp;input);\n} while (!IsRightFormat(input));  // If the input was not correct get it again\n\n\n// Do your stuff here\n// ...\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9706897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LLVV7T94LFc/AAAAAAAAAAI/AAAAAAAAAYA/SkHkQQBfqL0/photo.jpg?sz=128", "display_name": "Serkan K.", "link": "https://stackoverflow.com/users/9706897/serkan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 50827386, "answer_count": 1, "score": 0, "last_activity_date": 1528847888, "creation_date": 1528846377, "last_edit_date": 1528847888, "question_id": 50827217, "link": "https://stackoverflow.com/questions/50827217/how-do-i-add-a-loop-for-scanf-in-c", "title": "How do I add a loop for scanf in C?", "body": "<p>I have a short question:\nHow can I expand my program so that it checks if I entered the right format?... if not the program should repeat the scanf.</p>\n\n<p>This is how far I came:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    float zahlen[2];\n    int i = 0;\n\n        while (i &lt; 2 &amp;&amp; zahlen != EOF) {\n            printf(\"%d. Zahl\", i + 1);\n            scanf_s(\"%f\", &amp;zahlen[i]);\n        }\n\n\n        printf(\"Division: %f\\n\", zahlen[0] / zahlen[1]);\n        printf(\"Produkt: %f\\n\", zahlen[0] * zahlen[1]);\n        printf(\"Summe: %f\\n\", zahlen[0] + zahlen[1]);\n        printf(\"Diffenrenz: %f\\n\", zahlen[0] - zahlen[1]);\n        printf(\"Mittelwert: %f\\n\", (zahlen[0] + zahlen[1]) / 2);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>Would appreciate any help of you. Have a nice day/night.</p>\n"}, {"tags": ["c", "matrix", "multidimensional-array", "user-input", "getchar"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1528844616, "post_id": 50826970, "comment_id": 88658606, "body": "I would start with a simpler task. Create a 1D array. Use <code>getchar</code> to fill it. Then use <code>printf</code> to show it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528844621, "post_id": 50826970, "comment_id": 88658609, "body": "A loop might be a good idea, if you want to read multiple characters. And note that <a href=\"http://en.cppreference.com/w/c/io/getchar\" rel=\"nofollow noreferrer\"><code>getchar</code></a> returns an <code>int</code>. This is very important when you want to check for errors and end-of-file (or end-of-input in your case)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528845705, "post_id": 50826970, "comment_id": 88658904, "body": "Why do you need to use <code>getchar()</code> \u2014 is that a requirement of the class exercise?  It probably isn&#39;t a good choice unless your hands are tied by your instructor, or you&#39;re sure that all the numbers will be single-digit numbers."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528845885, "post_id": 50826970, "comment_id": 88658940, "body": "As to where to begin: start by defining a matrix \u2014 your variable <code>matrixA</code> is not (by any reasonable definition of the term) a matrix.  If you don&#39;t know how to do that, you need to hit the text book."}, {"owner": {"reputation": 9, "user_id": 9853571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RkRehm", "link": "https://stackoverflow.com/users/9853571/rkrehm"}, "edited": false, "score": 0, "creation_date": 1528846363, "post_id": 50826970, "comment_id": 88659020, "body": "Using getchar is a requirement, and all input is assumed to be positive numbers of upto 6 digits."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528847618, "post_id": 50826970, "comment_id": 88659253, "body": "Hmmm &quot;all input is assumed to be positive numbers of upto 6 digits&quot; and <code>1 2 3; 4 5 6; 7 8 9</code> does not quite jibe as input apparently includes digits, <code>;</code>, spaces and likely a line-feed."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528849631, "post_id": 50826970, "comment_id": 88659628, "body": "So, time to get busy writing a function to read a number, and loops in <code>main()</code> to invoke your function to read the numbers.  What&#39;s trickier is how to deal with the semicolons.  If you&#39;re dealing with 3x3 matrices only, then they&#39;re superfluous \u2014 you can simply skip them (unless you&#39;re not allowed to assume that the data is perfect).  If you need to count the number of values before the first semicolon to deduce the size of the matrix, life is harder.  You&#39;ve still not said anything about the scope of the problem. What you&#39;ve shown will fail at the first byte of input \u2014 you have digits first."}, {"owner": {"reputation": 9, "user_id": 9853571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RkRehm", "link": "https://stackoverflow.com/users/9853571/rkrehm"}, "edited": false, "score": 0, "creation_date": 1528854322, "post_id": 50826970, "comment_id": 88660560, "body": "Here is what I have after more research on using getchar: The use of the semicolons is to identify a new row. The user is not required to input the dimensions of the matrix, therefore, the spaces and semi colon in the user input identify the rows and columns. while((input1 = getchar())!= &#39;\\n&#39;)     {         if((input1 &gt; &#39;0&#39;) || (input1 &lt; &#39;9&#39;)){             matrixA[row][col] = input1;             if(input1 == &#39; &#39;){             col++;             matrixA[row][col] = input1;         }         if(input1 == &#39;;&#39;){             matrixA[row][col]=input1;             row++;         }"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1528855814, "post_id": 50826970, "comment_id": 88660864, "body": "@RkRehm - add your code <b>to the end</b> of your question as an <b>edit</b> (do not delete any part of your existing question -- or the comments will no longer make sense). It is quite OK to <b>edit</b> and <b>add to</b> your question as you get more information."}, {"owner": {"reputation": 9, "user_id": 9853571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RkRehm", "link": "https://stackoverflow.com/users/9853571/rkrehm"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1528858861, "post_id": 50826970, "comment_id": 88661443, "body": "@DavidC.Rankin noted, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 9853571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RkRehm", "link": "https://stackoverflow.com/users/9853571/rkrehm"}, "is_accepted": false, "score": 0, "last_activity_date": 1528876176, "creation_date": 1528876176, "answer_id": 50831788, "question_id": 50826970, "link": "https://stackoverflow.com/questions/50826970/using-getchar-to-read-in-user-input-and-create-2d-matrix/50831788#50831788", "title": "Using getchar to read in user input and create 2D matrix", "body": "<p>After some more refining: \nit only prints the first character that the user inputs or first two, depending on the number of inputs before the first semi colon is encountered. My print statement is outside the loop. </p>\n\n<pre><code>char matrixA[100][100];\n\nchar matrixB[100][100];\nchar input1, input2;\nint row=0, col=0, num = 0;\n\nprintf(\"Enter matrix A:\\n\");\n\nwhile(input1 != '\\n'){\n\n    input1 = getchar();\n\n    if((input1 &gt; '0') &amp;&amp; (input1 &lt; '9') &amp;&amp; (input1 != ' ') &amp;&amp; (input1 != ';')){\n        //num = (num*10) + (input1 - '0');\n        matrixA[row][col] = input1; \n    }  \n\n    if(input1 == ' '){\n        col++;\n    }\n    if (input1 == ';'){\n        row++;        \n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9853571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RkRehm", "link": "https://stackoverflow.com/users/9853571/rkrehm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528876176, "creation_date": 1528844333, "last_edit_date": 1528866059, "question_id": 50826970, "link": "https://stackoverflow.com/questions/50826970/using-getchar-to-read-in-user-input-and-create-2d-matrix", "title": "Using getchar to read in user input and create 2D matrix", "body": "<p>The user is prompted to input a string.</p>\n\n<p>input: <code>1 2 3; 4 5 6; 7 8 9</code></p>\n\n<p>output:</p>\n\n<pre><code>1 2 3\n\n4 5 6\n\n7 8 9\n</code></pre>\n\n<p>Entries on the same row are separated by a single space. Rows are separated with a semicolon and a space. I need to use the getchar function to manually parse through the line of input so that I can create this matrix and do other operations with it. </p>\n\n<p>Not even sure where to begin. I was thinking of using a loop that increments each time a semicolon is read. But I really don't know how to use getchar at all!</p>\n\n<pre><code>while((input1 = getchar())!= '\\n')\n{\n    if((input1 &gt; '0') || (input1 &lt; '9')){\n        matrixA[row][col] = input1;\n        if(input1 == ' '){\n        col++;\n        matrixA[row][col] = input1;\n    }\n    if(input1 == ';'){\n        matrixA[row][col]=input1;\n        row++;\n    }\n</code></pre>\n\n<p>edit: this code print (null)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528844299, "post_id": 50826908, "comment_id": 88658507, "body": "Did you mean to use <code>sizeof(cipher)</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528844307, "post_id": 50826908, "comment_id": 88658511, "body": "It&#39;s probably better to use <code>char*</code> in preference to <code>char[]</code> for consistency&#39;s sake here."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528846060, "post_id": 50826908, "comment_id": 88658970, "body": "You define <code>x</code>; you never use it.  You define <code>cipher</code>; you never initialize it.  You don&#39;t make <code>cipher</code> big enough to hold the null byte at the end of a string.  The length of a string does not include the null byte, though the &quot;value&quot; of the string does include it (at least, the string ends at the first null byte)."}, {"owner": {"reputation": 55, "user_id": 3684843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f5c1d709e570bb172352950dec6edc?s=128&d=identicon&r=PG&f=1", "display_name": "NoleloN", "link": "https://stackoverflow.com/users/3684843/nolelon"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528846738, "post_id": 50826908, "comment_id": 88659090, "body": "@JonathanLeffler Thank you. I apologize, this was from a big function I cut down to try and isolate this question and in haste left some mess. I&#39;ve been really confused on how to initialize a c-string of the same size as the string I pass in."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1528844367, "post_id": 50826940, "comment_id": 88658532, "body": "That and <code>cipher</code> goes out of scope the moment that function ends, so it can&#39;t be returned."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528844451, "post_id": 50826940, "comment_id": 88658557, "body": "There is no &quot;chance&quot; for undefined behaviour. Either it is UB or it isn&#39;t."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528845961, "post_id": 50826940, "comment_id": 88658951, "body": "@Ctx: While a particular code path with particular data might deterministically have behavior not defined by the C standard or not, it can be non-deterministic whether the code goes down that path with that data. For example, if a jump is conditional on indeterminate data, it might or might not go down a path with behavior not defined by the C standard."}, {"owner": {"reputation": 55, "user_id": 3684843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f5c1d709e570bb172352950dec6edc?s=128&d=identicon&r=PG&f=1", "display_name": "NoleloN", "link": "https://stackoverflow.com/users/3684843/nolelon"}, "edited": false, "score": 0, "creation_date": 1528846440, "post_id": 50826940, "comment_id": 88659037, "body": "Thank you for your answer. I&#39;m confused now because I&#39;ve seen code like <code>char myString[10];</code> That makes space for 10 characters, with the last being a null terminated string. I thought that since I was passing 8 into the brackets I&#39;d be making space in memory for an 8 char array?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1528846682, "post_id": 50826940, "comment_id": 88659075, "body": "@EricPostpischil, its behavior will be 100% deterministic. We just won&#39;t be able to predict what it is."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1528846866, "post_id": 50826940, "comment_id": 88659113, "body": "@LeeDanielCrocker: Randomness is deliberately injected into processes nowadays, as with Address Space Layout Randomization, and that randomness is fed with thermal noise and other sources of entropy."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 55, "user_id": 3684843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f5c1d709e570bb172352950dec6edc?s=128&d=identicon&r=PG&f=1", "display_name": "NoleloN", "link": "https://stackoverflow.com/users/3684843/nolelon"}, "edited": false, "score": 0, "creation_date": 1528847858, "post_id": 50826940, "comment_id": 88659302, "body": "@NoleloN &quot;...I thought that since I was passing 8 into the brackets ...&quot; is not supported by the post.  Edit into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 55, "user_id": 3684843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f5c1d709e570bb172352950dec6edc?s=128&d=identicon&r=PG&f=1", "display_name": "NoleloN", "link": "https://stackoverflow.com/users/3684843/nolelon"}, "edited": false, "score": 0, "creation_date": 1528870144, "post_id": 50826940, "comment_id": 88664418, "body": "@NoleloN An array of eight elements can store a string of <i>seven</i> characters. If you want a string of <code>len</code> characters, then you need an array of <code>len + 1</code> elements, to be able to fit the terminator. And you need to initialize the array before you start passing it around."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1528927263, "post_id": 50826940, "comment_id": 88697328, "body": "@EricPostpischil Undefined behaviour is invoked by a certain code pattern and the actual behaviour is completely independent of this. Your statements are completely irrelevant with regard to this"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1528929701, "post_id": 50826940, "comment_id": 88697992, "body": "@Someprogrammerdude: An array of eight <code>char</code> can store eight <code>char</code>. Generally, cryptographic code does not use null-terminated strings for ciphertext, because the bytes of ciphertext are arbitrary values generated by the encryption algorithm, so some of them will be zero values. Use fixed-length blocks is common in cryptographic code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1528929783, "post_id": 50826940, "comment_id": 88698025, "body": "@EricPostpischil True, but in this case the OP is using the array as a null-terminated string (passing it to <code>strlen</code>)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528929896, "post_id": 50826940, "comment_id": 88698062, "body": "@Ctx: The C standard specifies several types of incompletely specified behavior, of which undefined behavior is only one. There are also implementation-defined behavior and unspecified values (C 2011 3.19.3). Code could depend on unspecified values in such a way that some branches yield defined behavior and some branches do not. Hence, it is effectively chance whether a branch to defined behavior or a branch to undefined behavior is taken."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1528929938, "post_id": 50826940, "comment_id": 88698076, "body": "@Someprogrammerdude: Yes, but the likely fix is not to use <code>strlen</code>, rather than to try appending a null terminator to data that may contain internal zeros."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1528985807, "post_id": 50826940, "comment_id": 88721870, "body": "@EricPostpischil This sounds a bit constructed... DR451 states, that &quot;library functions will exhibit undefined behavior when used on indeterminate values&quot; and J.2 states, that &quot;The behavior is undefined in the following circumstances: The value of an object with automatic storage duration is used while it is indeterminate&quot;. There isn&#39;t much room left for your argumentation."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1529012401, "post_id": 50826940, "comment_id": 88735028, "body": "@Ctx: You may consider it \u201cconstructed\u201d if you wish, whatever that means, but such an opinion has no bearing on the truth of the assertion that undefined behavior cannot happen by chance. It is false. As simple code as <code>unsigned char a[9]; if (a[9]) RoutineWithUndefinedBehavior();</code> is, as far as the C standard is concerned, non-deterministically defined or undefined, and it avoids both of your points about library routines or objects with automatic storage duration. (The full rule for the latter excludes objects that cannot be declared with <code>register</code>, thus excluding array elements.)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1529016605, "post_id": 50826940, "comment_id": 88736157, "body": "Correction: I intended <code>if (a[4])\u2026</code>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1529049891, "post_id": 50826940, "comment_id": 88744450, "body": "@EricPostpischil This claim collides with the statement in the standard J.2 which says, that &quot;The behavior is undefined in the following circumstances: The value of an object with automatic storage duration is used while it is indeterminate&quot;."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1529051847, "post_id": 50826940, "comment_id": 88745356, "body": "@Ctx: Annex J is not a normative part of the standard. It is a summary. Read the actual rule in 6.3.2.1 2. It only applies to objects that could have been declared with <code>register</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1528844170, "creation_date": 1528844170, "answer_id": 50826940, "question_id": 50826908, "link": "https://stackoverflow.com/questions/50826908/setting-char-array-length-with-strlen-returns-wrong-size/50826940#50826940", "title": "Setting char array length with strlen() returns wrong size", "body": "<p>The array <code>cipher</code> is <em>uninitialized</em>. It's contents is <em>indeterminate</em> (and will seem almost random). It might not contain the string-terminator at all, which means <code>strlen</code> will go out of bounds in its search for it. In your specific case you seem to be \"lucky\" that the second element in your array just happens to be the terminator.</p>\n\n<p>And you seem to forget that <code>char</code> strings are really called <strong><em>null-terminated</strong> byte strings</em>. That <em>null-terminator</em> also needs space. And exist of course.</p>\n\n<p>All in all plenty of chances for <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n"}], "owner": {"reputation": 55, "user_id": 3684843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f5c1d709e570bb172352950dec6edc?s=128&d=identicon&r=PG&f=1", "display_name": "NoleloN", "link": "https://stackoverflow.com/users/3684843/nolelon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 50826940, "answer_count": 1, "score": 2, "last_activity_date": 1528844170, "creation_date": 1528843960, "question_id": 50826908, "link": "https://stackoverflow.com/questions/50826908/setting-char-array-length-with-strlen-returns-wrong-size", "title": "Setting char array length with strlen() returns wrong size", "body": "<p>I am trying to create a new c-string with the length of a passed in c-string. I set a variable to the length of the old string and then try to set a new c-string with that length but checking that length returns 1. Why does this happen?</p>\n\n<pre><code>//This function will return a pointer to a char array\nchar *encrypt(char plainText[], char code[]){\n    int i = 0,j = 0;\n    //length of plainText\n    int len = strlen(plainText);\n    printf(\"len %i\\n\",len); //8\n    //I am declaring a pointer here\n    char *x;\n    //make a string for the cipherText\n    char cipher[len];\n    printf(\"cipher %lu\\n\",strlen(cipher)); //1\n    return \"Nothing\";\n}\n</code></pre>\n"}, {"tags": ["c", "sorting"], "comments": [{"owner": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 3, "creation_date": 1528841818, "post_id": 50826569, "comment_id": 88657872, "body": "you might find this interesting:  <a href=\"https://www.youtube.com/watch?v=kPRA0W1kECg\" rel=\"nofollow noreferrer\">15 sorting algorithms shown visually</a>"}, {"owner": {"reputation": 11455, "user_id": 10888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/adbf81127c90a370ceab11b3087a8e4e?s=128&d=identicon&r=PG", "display_name": "Leonard", "link": "https://stackoverflow.com/users/10888/leonard"}, "edited": false, "score": 2, "creation_date": 1528842198, "post_id": 50826569, "comment_id": 88657978, "body": "I&#39;m not sure why you think this isn&#39;t a bubble sort.  It looks like a bubble sort to me. In any event this is an Order - N squared sort, and it fares poorly against the best of sortsi."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1528842233, "post_id": 50826569, "comment_id": 88657985, "body": "I would call this a selection sort. Still n-squared, so no better than a bubble."}, {"owner": {"reputation": 176, "user_id": 7427260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23211b9a02ba9fd2249dbb7af69e2127?s=128&d=identicon&r=PG&f=1", "display_name": "360NS", "link": "https://stackoverflow.com/users/7427260/360ns"}, "reply_to_user": {"reputation": 11455, "user_id": 10888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/adbf81127c90a370ceab11b3087a8e4e?s=128&d=identicon&r=PG", "display_name": "Leonard", "link": "https://stackoverflow.com/users/10888/leonard"}, "edited": false, "score": 0, "creation_date": 1528842752, "post_id": 50826569, "comment_id": 88658159, "body": "@Leonard i thought the same thing in the beginning, i doubt it&#39;s a bubble sort because the function starts with a value and compares the whole array against it and then it increments, where in bubble sort you just compare two adjacent values and swap, but i might be mistaken, hence the question"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528842807, "post_id": 50826569, "comment_id": 88658171, "body": "Why do you think your algorithm is not a bubble sort?  It isn&#39;t a selection sort, in my book, but it may be that my book isn&#39;t the same as other people&#39;s.  Whatever the name of the sub-species of sort, it is a quadratic sorting algorithm (O(N&#178;) in Big-O notation), and therefore not very efficient on big data sets.  It isn&#39;t worth spending much time optimizing it; there are better algorithms with O(N.logN) complexity that can be used instead."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528842993, "post_id": 50826569, "comment_id": 88658222, "body": "You should have a size argument, not a <code>SIZE</code> constant. Also <code>array+i</code> and <code>array[i]</code> are two sides of the same coin."}, {"owner": {"reputation": 176, "user_id": 7427260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23211b9a02ba9fd2249dbb7af69e2127?s=128&d=identicon&r=PG&f=1", "display_name": "360NS", "link": "https://stackoverflow.com/users/7427260/360ns"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528843403, "post_id": 50826569, "comment_id": 88658314, "body": "@tadman yeah you&#39;re right about the parameter, i just made it a constant to illustrate, as for array+i see my edit and function swapValues"}, {"owner": {"reputation": 176, "user_id": 7427260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23211b9a02ba9fd2249dbb7af69e2127?s=128&d=identicon&r=PG&f=1", "display_name": "360NS", "link": "https://stackoverflow.com/users/7427260/360ns"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1528843630, "post_id": 50826569, "comment_id": 88658364, "body": "@LeeDanielCrocker i think you&#39;re right! after looking for selection sort i found this <a href=\"https://visualgo.net/en/sorting\" rel=\"nofollow noreferrer\">link</a>, it resembles the sorting behaviour of this function"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1528843802, "post_id": 50826569, "comment_id": 88658411, "body": "You&#39;re correct; this isn&#39;t bubblesort. It&#39;s selection sort (albeit backward from the traditional mechanics of that algorithm). A bubblesort indeed compares adjacent elements scanning one direction, and after each pass, the next extreme value has been &quot;bubbled&quot; and the next pass will be reduced one slot to exclude it. It also has a benefit of termination detection. If any sequence pass results in <i>no swaps</i>, the sequence must be sorted and the algorithm is terminated. This means bubblesort has best-case O(n) on an already sorted sequence."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1528844093, "post_id": 50826569, "comment_id": 88658474, "body": "That <code>swapValues</code> function is pointless. Just do it in the loop. You don&#39;t need to abstract out the obvious."}, {"owner": {"reputation": 176, "user_id": 7427260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23211b9a02ba9fd2249dbb7af69e2127?s=128&d=identicon&r=PG&f=1", "display_name": "360NS", "link": "https://stackoverflow.com/users/7427260/360ns"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1528846252, "post_id": 50826569, "comment_id": 88658992, "body": "@WhozCraig does the fact that bubble sort has a better best-case O(n) compared to this algorithm mean that bubble sort is better? since both have average and worst case of O(n&#178;)?"}, {"owner": {"reputation": 176, "user_id": 7427260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23211b9a02ba9fd2249dbb7af69e2127?s=128&d=identicon&r=PG&f=1", "display_name": "360NS", "link": "https://stackoverflow.com/users/7427260/360ns"}, "edited": false, "score": 0, "creation_date": 1528846709, "post_id": 50826569, "comment_id": 88659081, "body": "or generally speaking, if there is two sorting algorithms of the same complexity, how can we know which one performance is better?"}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1528848133, "post_id": 50826569, "comment_id": 88659359, "body": "@WhozCraig This is indeed a selection sort, but the primary thing that&#39;s backward is the missing optimization of one swap per outer loop.  Typically, this runs faster than bubblesort, but is not a stable sort.  When sorting structs instead of ints, this can matter.  The reason to know this sort (with optimizations) is that at most (n-1) swaps can be more important that O(n log n) compares in a small sort."}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 9296351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd849c3912d29374daa736a253a3a1a5?s=128&d=identicon&r=PG", "display_name": "FLASH", "link": "https://stackoverflow.com/users/9296351/flash"}, "is_accepted": true, "score": 0, "last_activity_date": 1529058418, "creation_date": 1529058418, "answer_id": 50873714, "question_id": 50826569, "link": "https://stackoverflow.com/questions/50826569/sorting-algorithm-implementation-in-c/50873714#50873714", "title": "sorting algorithm implementation in c", "body": "<p>Your implementation is using selection sort. It's not bubble sort. Since in bubble sort we compare two consecutive elements at once, therefore this isn't it. This is selection sort where in you compare one element with the rest of elements at a time in an array, and swap accordingly.</p>\n"}], "owner": {"reputation": 176, "user_id": 7427260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23211b9a02ba9fd2249dbb7af69e2127?s=128&d=identicon&r=PG&f=1", "display_name": "360NS", "link": "https://stackoverflow.com/users/7427260/360ns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 50873714, "answer_count": 1, "score": 0, "last_activity_date": 1529058418, "creation_date": 1528841671, "last_edit_date": 1528843154, "question_id": 50826569, "link": "https://stackoverflow.com/questions/50826569/sorting-algorithm-implementation-in-c", "title": "sorting algorithm implementation in c", "body": "<p>in order to sort an array in ascending order, i thought of the following:\n<br>\n<br></p>\n\n<pre><code>#define SIZE 10 //as an example\n\nvoid swapValues(int *x, int *y)\n{\n    int temp = *x;\n    *x = *y;\n    *y = temp;\n}\n\nvoid sort(int *array)\n{\n    int i, j;\n    for(i = 0; i &lt; SIZE-1; i++) {\n        for(j = i + 1; j &lt; SIZE; j++) {\n\n            if(array[i] &gt; array[j]) {\n                swapValues( (array+i) , (array+j) );\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p><br>\nthe function works, but after taking a look on \n<a href=\"https://en.wikipedia.org/wiki/Sorting_algorithm#Comparison_of_algorithms\" rel=\"nofollow noreferrer\">this</a>, i'm a bit curious, this looks like a bubble sort algorithm, but it isn't, so: <br></p>\n\n<ol>\n<li>is this function an implementation of an already known sorting algorithm?</li>\n<li>how would this function fare in comparison to other simple sorting algorithms like bubble sort or selection sort?</li>\n</ol>\n"}, {"tags": ["c", "sockets", "tcp", "network-programming"], "comments": [{"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 1, "creation_date": 1528841658, "post_id": 50826550, "comment_id": 88657829, "body": "I&#39;m certain the answer lies somewhere in you code, which unfortunately you forgot to add to the question..."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 4, "creation_date": 1528841700, "post_id": 50826550, "comment_id": 88657839, "body": "You need to specify the port in network byte order (i.e. use <code>htons(SERVER_PORT)</code>)"}, {"owner": {"reputation": 952, "user_id": 756120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6dd959f2244e7078d7fe2f824c34f39?s=128&d=identicon&r=PG", "display_name": "Abhishek Sagar", "link": "https://stackoverflow.com/users/756120/abhishek-sagar"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528841874, "post_id": 50826550, "comment_id": 88657890, "body": "@Ctx, that worked...  :p"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1528856574, "post_id": 50826550, "comment_id": 88661006, "body": "If it&#39;s 53255 every time, it isn&#39;t random. Be precise. It&#39;s wrong (by which I mean not as you expected), but it isn&#39;t random."}, {"owner": {"reputation": 952, "user_id": 756120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6dd959f2244e7078d7fe2f824c34f39?s=128&d=identicon&r=PG", "display_name": "Abhishek Sagar", "link": "https://stackoverflow.com/users/756120/abhishek-sagar"}, "edited": false, "score": 0, "creation_date": 1528866566, "post_id": 50826550, "comment_id": 88663091, "body": "it was random , every time, it was being assigned a different port number also ..."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1528870628, "post_id": 50826550, "comment_id": 88664642, "body": "Nonsense. That can only happen if you specified zero, and you didn&#39;t. Either it was random or it was 53255. Make up your mind.  Your question specifically states it was 53255, which is the byte-swap of 2000. Which is why the answer you accepted works."}, {"owner": {"reputation": 952, "user_id": 756120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6dd959f2244e7078d7fe2f824c34f39?s=128&d=identicon&r=PG", "display_name": "Abhishek Sagar", "link": "https://stackoverflow.com/users/756120/abhishek-sagar"}, "edited": false, "score": 0, "creation_date": 1528871090, "post_id": 50826550, "comment_id": 88664872, "body": "Yes, you are right, I tried different port numbers and it gave the byte swap of those, so i thought it is generating port numbers as random."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 9902937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57720c03c45cd1358c1c225ffa9493a?s=128&d=identicon&r=PG", "display_name": "Andres di Giovanni", "link": "https://stackoverflow.com/users/9902937/andres-di-giovanni"}, "is_accepted": true, "score": 3, "last_activity_date": 1528855817, "creation_date": 1528855817, "answer_id": 50828178, "question_id": 50826550, "link": "https://stackoverflow.com/questions/50826550/tcp-server-takes-wrong-port-number-on-ubuntu-14-04/50828178#50828178", "title": "TCP server takes wrong port number on ubuntu 14.04", "body": "<p>You should use <code>htons(SERVER_PORT)</code> instead of <code>SERVER_PORT</code></p>\n"}], "owner": {"reputation": 952, "user_id": 756120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6dd959f2244e7078d7fe2f824c34f39?s=128&d=identicon&r=PG", "display_name": "Abhishek Sagar", "link": "https://stackoverflow.com/users/756120/abhishek-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 50828178, "answer_count": 1, "score": -1, "last_activity_date": 1529463561, "creation_date": 1528841545, "last_edit_date": 1529463561, "question_id": 50826550, "link": "https://stackoverflow.com/questions/50826550/tcp-server-takes-wrong-port-number-on-ubuntu-14-04", "title": "TCP server takes wrong port number on ubuntu 14.04", "body": "<p>I am doing socket programming in C, and when i am starting my tcpserver on address INADDR_ANY and port no 2000, it starts well. But using command 'netstat -tulpn' , it shows the server is assigned port number <code>53255</code>. Clients are able to connect to this server when they connect using server port number <code>53255</code>, but get connection refusals when they try connect to port number '2000'. </p>\n\n<p>Can somebody pls explain why the system is assigning the wrong port no to my tcpserver instead of one i am want to use which is 2000.</p>\n\n<pre><code>vm@vm:~/Documents/csepracticals/webserver/TCPWebserver$ netstat -tulpn\n...\n...\ntcp        0      0 0.0.0.0:53255           0.0.0.0:*               LISTEN      16291/webserver`\n\n\nserver_addr.sin_family = AF_INET;\nserver_addr.sin_port = SERVER_PORT; /*#defined to 2000*/\nserver_addr.sin_addr.s_addr = INADDR_ANY;\nbind(master_sock_tcp_fd, (struct sockaddr *)&amp;server_addr, sizeof(struct sockaddr));\n</code></pre>\n"}, {"tags": ["c", "linux", "file", "heap-memory"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1528840952, "post_id": 50826431, "comment_id": 88657621, "body": "No it&#39;s not really possible. And certainly not desirable as it would make performance of your application go down the dump. You can <i>memory map</i> the file on the other hand, and use it as a <i>part</i> of your virtual address-space."}, {"owner": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "edited": false, "score": 0, "creation_date": 1528840995, "post_id": 50826431, "comment_id": 88657639, "body": "Say, you can. But what is the use case?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 3, "creation_date": 1528841377, "post_id": 50826431, "comment_id": 88657762, "body": "You can override calls to malloc/realloc/calloc/free with symbol interposition (i.e. LD_PRELOAD) and provide an implementation, which returns addresses pointing into a previously mmapp()ed file."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "edited": false, "score": 0, "creation_date": 1528841885, "post_id": 50826431, "comment_id": 88657892, "body": "I agree with @IterAtor, what is the use-case for this? What is the <i>actual</i> and <i>real</i> problem you want to solve? This has the undeniable smell of an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. So that&#39;s why <a href=\"http://idownvotedbecau.se/unclearquestion\" rel=\"nofollow noreferrer\">idownvotedbecau.se/unclearquestion</a>"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1528841989, "post_id": 50826431, "comment_id": 88657913, "body": "You can override the malloc/calloc/realloc/free symbols with interposition (another library or LD_PRELOAD) but a libc implementation, as provider for the allocator functions can keep using the standard allocator regardless of the overrides. You also won&#39;t be able to stop other library functions (wheteher in libc or elsewhere) from allocating from making direct syscalls to mmap or sbrk."}, {"owner": {"reputation": 1213, "user_id": 3263864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41c98358d847c68ff3b45bffc099d98f?s=128&d=identicon&r=PG&f=1", "display_name": "DeepDeadpool", "link": "https://stackoverflow.com/users/3263864/deepdeadpool"}, "edited": false, "score": 2, "creation_date": 1528842810, "post_id": 50826431, "comment_id": 88658172, "body": "This is not an XY problem. I want to do this because I want to do this."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528844387, "post_id": 50826431, "comment_id": 88658543, "body": "Then you should update your question to explicitly state that this is only for curiosity and not for a real use-case. (&quot;I want to do this because I want to do this&quot; isn&#39;t really a valid use-case otherwise). And remember, curiosity killed the cat... ;)"}], "answers": [{"tags": [], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "is_accepted": false, "score": 0, "last_activity_date": 1528841286, "creation_date": 1528841286, "answer_id": 50826509, "question_id": 50826431, "link": "https://stackoverflow.com/questions/50826431/how-can-i-tell-a-linux-process-to-use-a-file-as-its-entire-heap/50826509#50826509", "title": "How can I tell a Linux process to use a file as its entire heap?", "body": "<p>It's not straightforwardly possible to redirect all memory allocation to a mapped file, without editing glibc. However, there is <a href=\"http://dmalloc.com/\" rel=\"nofollow noreferrer\">dmalloc</a>, which allows you to use a <em>differently named but equivalent</em> function to allocate from a file. (You could just <code>#define malloc dmalloc</code>, but that wouldn't affect libraries, and could screw up other headers.)</p>\n"}], "owner": {"reputation": 1213, "user_id": 3263864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41c98358d847c68ff3b45bffc099d98f?s=128&d=identicon&r=PG&f=1", "display_name": "DeepDeadpool", "link": "https://stackoverflow.com/users/3263864/deepdeadpool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528841286, "creation_date": 1528840819, "question_id": 50826431, "link": "https://stackoverflow.com/questions/50826431/how-can-i-tell-a-linux-process-to-use-a-file-as-its-entire-heap", "title": "How can I tell a Linux process to use a file as its entire heap?", "body": "<p>Say I have a 10MB file on my hard drive. Say I also have a C program and it mallocs a bunch of data and sets various bytes. Is it possible for me to tell this program to target this file as though it were the only memory available on the system, thus redirecting malloc calls to allocate from the 10MB file instead of my system's real memory?</p>\n"}, {"tags": ["c", "linux", "algorithm", "linux-kernel", "operating-system"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1528840223, "post_id": 50826280, "comment_id": 88657363, "body": "Pedantic, but <code>if (certain_conditions = TRUE)</code> is not what you want (use <code>==</code>): please post acutal code not &quot;something-like&quot; code."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1528840449, "post_id": 50826280, "comment_id": 88657454, "body": "Can I do X if I can guarantee X will work? No, because somebody on StackOverflow says you&#39;re forbidden. :D JK. I think the answer&#39;s obvious, but if I were you I&#39;d use the trywait variant (I think all reasonable semaphore implementation should have those) and <code>assert()</code> success."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1528840808, "post_id": 50826280, "comment_id": 88657583, "body": "If what you claim really is true, is the mysterious missing puzzle piece  that a way it can <i>not</i> be guaranteed to work is by releasing that mutex prior to the wait, someone else acquiring it, and thereafter breaking the warrant that the upcoming wait on this thread &quot;can not get blocked for sure&quot; ? Honestly, it sounds like you have a design hurdle, but with so little to go on that&#39;s just speculation."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1528841160, "post_id": 50826280, "comment_id": 88657700, "body": "If you can guarantee that the resource protected by the semaphore is always available, then why use a semaphore to protect it?"}, {"owner": {"reputation": 353, "user_id": 4446712, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001082593799/picture?type=large", "display_name": "Subhajit Kundu", "link": "https://stackoverflow.com/users/4446712/subhajit-kundu"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1528842081, "post_id": 50826280, "comment_id": 88657937, "body": "@Jim: It isn&#39;t always avaiable. Its only available hn certain conditions are true. My basic question is can one call semaphore wait frm within mutex_lock?"}, {"owner": {"reputation": 353, "user_id": 4446712, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001082593799/picture?type=large", "display_name": "Subhajit Kundu", "link": "https://stackoverflow.com/users/4446712/subhajit-kundu"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528842257, "post_id": 50826280, "comment_id": 88657993, "body": "@WeatherVane: Edited and made the correction. My basic question is can one call wait from within mutex_lock. Actual code is yet to be developed and I&#39;m writing an algo as part of design. Above code is what I intend to do."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 3, "creation_date": 1528842315, "post_id": 50826280, "comment_id": 88658012, "body": "Well, sure. It <i>can</i> be done. The worst that can happen is that the call will block, thus leaving the mutex acquired for an extended period. Which, granted, could lead to deadlock if for some unexpected reason the resource isn&#39;t available. But there&#39;s no language or runtime reason you can&#39;t call a sem_wait while you have a mutex."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1528876950, "post_id": 50826280, "comment_id": 88668169, "body": "Is this the code for run in <i>Linux kernel</i>? If so, drop <code>operating-system</code> tag - it is for questions about OS <i>in general</i>."}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1529052691, "post_id": 50833985, "comment_id": 88745760, "body": "&#39;you need to lock the Mutex protecting the queue before calling your &quot;wait&quot; primitive&#39; - why is that?  If the mutex is locked, nothing else can push anything onto the queue.  It&#39;s normal to wait on the semaphore and then lock the mutex to access the queue."}], "tags": [], "owner": {"reputation": 176, "user_id": 1902264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hf6eA.jpg?s=128&g=1", "display_name": "Paolo Tagliapietra", "link": "https://stackoverflow.com/users/1902264/paolo-tagliapietra"}, "is_accepted": false, "score": 1, "last_activity_date": 1528882820, "creation_date": 1528882820, "answer_id": 50833985, "question_id": 50826280, "link": "https://stackoverflow.com/questions/50826280/semaphore-wait-within-mutex-lock/50833985#50833985", "title": "Semaphore wait within mutex lock", "body": "<p>Basically, the answer to your question is:<br/><strong>Yes. You can call a \"wait\" primitive on a semaphore within a Mutex lock context</strong>.</p>\n\n<p>Actually, that is something that is constantly done. Think of, for example, implementation of Message Queue IPC services with Counting Semaphores: you need to lock the Mutex protecting the queue before calling your \"wait\" primitive on the Counting Semaphore.</p>\n\n<p>Thinking of POSIX, if you have to implement a Mailbox (typical Producer/Consumer example), you can safely and easily do it with Mutex and Condition Variables (which would be used as your Semaphores). What you want to do is nothing strange as long as you're in control of the situation.</p>\n"}], "owner": {"reputation": 353, "user_id": 4446712, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001082593799/picture?type=large", "display_name": "Subhajit Kundu", "link": "https://stackoverflow.com/users/4446712/subhajit-kundu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528882820, "creation_date": 1528839987, "last_edit_date": 1528841827, "question_id": 50826280, "link": "https://stackoverflow.com/questions/50826280/semaphore-wait-within-mutex-lock", "title": "Semaphore wait within mutex lock", "body": "<p>Can I call <code>semaphore.wait()</code> within mutex_lock if in the path somehow it can be guaranteed that resource protected by the semaphore is available?</p>\n\n<p>I.e. I want to do something like following:</p>\n\n<pre><code>void some_function {\n\n    mutex_lock()\n    // Do something\n    if (certain_conditions == TRUE) {\n        semaphore_wait()   // Guaranteed that resource is available.\n                           // Can not get blocked for sure.\n    } \n    // Do some more things\n    mutex_unlock()\n\n}\n</code></pre>\n"}, {"tags": ["c", "oracle", "gcc", "pragma", "unused-variables"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1528837910, "post_id": 50825846, "comment_id": 88656604, "body": "It&#39;s because the warning can&#39;t be generated until the block they were defined in ends. So a possible solution might be to enclose the code containing the unused variables you don&#39;t want warnings about in their own block using <code>{}</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528837913, "post_id": 50825846, "comment_id": 88656606, "body": "What happens if you move the pop after the return or after the <code>}</code> ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1528837917, "post_id": 50825846, "comment_id": 88656607, "body": "Usually people silence such a warnings by putting something like <code>(void)b;</code> But better clean up your code."}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528837993, "post_id": 50825846, "comment_id": 88656633, "body": "@Someprogrammerdude I can&#39;t this generated code is used later in other parts of the code."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528838001, "post_id": 50825846, "comment_id": 88656635, "body": "That works perfectly for <code>Apple LLVM version 9.1.0 (clang-902.0.39.2)</code>. Did you tried another gcc version?"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1528838042, "post_id": 50825846, "comment_id": 88656648, "body": "Is it not an option to just pass <code>-Wno-unused-variable</code> on the command line? Since the code is auto-generated, do you really care about gcc&#39;s warnings - do you plan to use the warning output as some kind of a sanity check on the precompiler&#39;s output?"}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528838051, "post_id": 50825846, "comment_id": 88656654, "body": "@Yunnosch Then it won&#39;t warn about my code that I do want to get warnings about, so it&#39;s not an option"}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528838102, "post_id": 50825846, "comment_id": 88656666, "body": "@EugeneSh. I would if I had control of the code, it&#39;s generated..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1528838105, "post_id": 50825846, "comment_id": 88656667, "body": "Then perhaps put all the generated code in its own source file, where you can disable any warnings you feel like?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1528838144, "post_id": 50825846, "comment_id": 88656679, "body": "@SimonW You are trying to add pragmas into the code, so I assumed that you have the control..."}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528838148, "post_id": 50825846, "comment_id": 88656684, "body": "@Jean-BaptisteYun&#232;s It&#39;s a redhat machine I have no control of... I wish I could..."}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1528838196, "post_id": 50825846, "comment_id": 88656706, "body": "@TypeIA no, part of the code is generated and part not, I do want to get warnings about my code"}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1528838290, "post_id": 50825846, "comment_id": 88656742, "body": "@Someprogrammerdude The generated code is required for running the rest of the code. Part of the code is written using special syntax that is precompiled to regular C so I can&#39;t separate them :("}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528838332, "post_id": 50825846, "comment_id": 88656765, "body": "@SimonW How does those codes are mixed up? Seems to be an X-Y problem... Compile the generated code with unused-variable disabled that&#39;s all."}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528838418, "post_id": 50825846, "comment_id": 88656793, "body": "@Jean-BaptisteYun&#232;s see previous answer, Part of the code is written using special syntax that is precompiled to regular C so I can&#39;t separate them"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528838773, "post_id": 50825846, "comment_id": 88656920, "body": "@SimonW I seriously doubt you can&#39;t separate code in some way... Generated code presumably produces result you use after, then isolate generated code in its own function/module, add appropriate return value and parameters and call that from another module."}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528840203, "post_id": 50825846, "comment_id": 88657357, "body": "@EugeneSh. I add the pragmas from outside - in the make file"}, {"owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528840443, "post_id": 50825846, "comment_id": 88657452, "body": "@Jean-BaptisteYun&#232;s The generated code I want to ignore warnings for, creates glabal variables in the top of the file, that some are later used in the generated code at the rest of the file where the generated code and my code are mixed. I think I can find some way to add an attribute that will ignore errors per variable somehow but it&#39;s a really ugly solution :/"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 5, "creation_date": 1528840857, "post_id": 50825846, "comment_id": 88657599, "body": "Although it&#39;s unlikely to yield a short-term solution, I would urge you to complain to the Pro*C people.  It&#39;s pretty irresponsible to generate code that yields blatant warnings like these. Wanting your code to compile without warnings (as you do) isn&#39;t some kind of fairy tale, it&#39;s common and recommended industry practice."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1528842425, "post_id": 50825846, "comment_id": 88658053, "body": "You could use <code>awk</code> or another text processing tool to strip out warnings pertaining to the Pro*C variables, assuming you can identify them by name"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1528842746, "post_id": 50825846, "comment_id": 88658158, "body": "Maybe you could refactor your code so that all the Pro*C is in dedicated functions and then disable that warning for the entire section"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1529232674, "post_id": 50825846, "comment_id": 88791766, "body": "Note: I added the Oracle-tag (apparently pro*-c is too sparse to exists) and had to remove the &quot;C&quot; tag."}], "answers": [{"tags": [], "owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "is_accepted": true, "score": 2, "last_activity_date": 1529448143, "last_edit_date": 1529448143, "creation_date": 1529230030, "answer_id": 50895610, "question_id": 50825846, "link": "https://stackoverflow.com/questions/50825846/ignore-unused-variables-in-a-block-of-code-in-c/50895610#50895610", "title": "Ignore unused variables in a block of code in c", "body": "<p>The solution I found was to add <code>__attribute__((unused))</code> before the generated variables that were problematic. In this situation there are always only 4 relevant variables so it was possible.</p>\n\n<p>I wrote a bash command in the make file right after the Pro*C precompiler:</p>\n\n<pre><code>for var in varA varB varC varD; do sed -i \"0,/${var}/{s/\\(${var}\\)/__attribute__((unused))\\1/}\" $file_name; done\n</code></pre>\n\n<p>Hope it can be helpful for someone.</p>\n"}], "owner": {"reputation": 5509, "user_id": 1574376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/944c6fd3081e1d9b8a8e63ccfa400e98?s=128&d=identicon&r=PG", "display_name": "SimonW", "link": "https://stackoverflow.com/users/1574376/simonw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 50895610, "answer_count": 1, "score": 2, "last_activity_date": 1529448143, "creation_date": 1528837703, "last_edit_date": 1529264302, "question_id": 50825846, "link": "https://stackoverflow.com/questions/50825846/ignore-unused-variables-in-a-block-of-code-in-c", "title": "Ignore unused variables in a block of code in c", "body": "<p>I have a large codebase of C code which part of it is generated code from the Oracle Pro*C precompiler.</p>\n\n<p>We use the GNU gcc compiler.</p>\n\n<p>The Pro*C precompiler generates code that contains unused variables that emits many warnings related to <code>-Wunused-variable</code> which I'd like to ignore.</p>\n\n<p>I've tried the following which I found in other questions but it doesn't see to work for C code (cut down to a minimal example).</p>\n\n<pre><code> int main(void)\n {\n #pragma GCC diagnostic push\n #pragma GCC diagnostic ignored \"-Wunused-variable\"\n         int  a=0;\n #pragma GCC diagnostic pop\n         int b=0;\n         return 0;\n }\n</code></pre>\n\n<p>I still get the <code>-Wunused-variable</code> error for variable <code>a</code>.</p>\n\n<pre><code> aa.c: In function 'main':\n aa.c:8:13: warning: unused variable 'b' [-Wunused-variable]\n          int b=0;\n              ^\n aa.c:6:14: warning: unused variable 'a' [-Wunused-variable]\n          int  a=0;\n               ^\n</code></pre>\n\n<p>GCC command:</p>\n\n<pre><code>gcc-8 -Wall -Wextra -pedantic aa.c -o a\n</code></pre>\n\n<p>Incase you are wondering, if I remove the <code>pop</code> pragma, no warnings are issued.</p>\n"}, {"tags": ["c", "gcc", "makefile", "compiler-errors", "linker-errors"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1528837219, "post_id": 50825735, "comment_id": 88656347, "body": "What&#39;s  <code>-l make</code>? The compiler should have passed <code>-lm</code> to link the math library"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1528837416, "post_id": 50825735, "comment_id": 88656422, "body": "Possible <a href=\"https://stackoverflow.com/questions/16344445/undefined-reference-to-pow-even-with-math-h-and-the-library-link-lm\">duplicate question</a> may be others are better."}, {"owner": {"reputation": 291, "user_id": 8825683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/TU9YZ.png?s=128&g=1", "display_name": "starboy", "link": "https://stackoverflow.com/users/8825683/starboy"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528837944, "post_id": 50825735, "comment_id": 88656618, "body": "@Eugene Sh, apologies. I&#39;ve now corrected it to <code>-lm</code>. @Weather Vane It&#39;s not a duplicate, I&#39;ve read several posts and tried their answers but none of them worked for me."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528838729, "post_id": 50825735, "comment_id": 88656905, "body": "@weather: xpdf is written in C++ and there is no need to link C++ programs against <code>-lm</code>; it is supposed to be automatic."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1528839893, "post_id": 50825735, "comment_id": 88657261, "body": "@rici thank you, I did say other previous Qs could be better. Any suggestions?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528840109, "post_id": 50825735, "comment_id": 88657324, "body": "@weather i can&#39;t find a better q and i&#39;m in a cafe w/o a laptop. To me it feels like a glibc version mismatch where some DSO was compiled against an old glibc. (2.2.5? Rly?)"}, {"owner": {"reputation": 291, "user_id": 8825683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/TU9YZ.png?s=128&g=1", "display_name": "starboy", "link": "https://stackoverflow.com/users/8825683/starboy"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1528879228, "post_id": 50825735, "comment_id": 88669403, "body": "@rici. I used gcc as the compiler rather than g++. Maybe thats why <code>-lm</code> wasn&#39;t linked automatically"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1528892839, "post_id": 50825735, "comment_id": 88678181, "body": "@mywrath: yes, if you are linking a c++ project, you should use g++ to get the right link options."}], "answers": [{"tags": [], "owner": {"reputation": 291, "user_id": 8825683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/TU9YZ.png?s=128&g=1", "display_name": "starboy", "link": "https://stackoverflow.com/users/8825683/starboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1528897141, "creation_date": 1528897141, "answer_id": 50838714, "question_id": 50825735, "link": "https://stackoverflow.com/questions/50825735/make-doesnt-link-math-lib-when-compiling/50838714#50838714", "title": "make doesn&#39;t link math lib when compiling", "body": "<p>I realised I had to use the g++ compiler instead of gcc after reading the man page for gcc which stated:</p>\n\n<blockquote>\n  <p>The usual way to run GCC is to run the executable called gcc, or\n  machine-gcc when cross-compiling, or machine-gcc-version to run a\n  specific\n         version of GCC.  When you compile C++ programs, you should invoke GCC as g++ instead.</p>\n</blockquote>\n"}], "owner": {"reputation": 291, "user_id": 8825683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/TU9YZ.png?s=128&g=1", "display_name": "starboy", "link": "https://stackoverflow.com/users/8825683/starboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 50838714, "answer_count": 1, "score": 0, "last_activity_date": 1528897141, "creation_date": 1528837046, "last_edit_date": 1528837769, "question_id": 50825735, "link": "https://stackoverflow.com/questions/50825735/make-doesnt-link-math-lib-when-compiling", "title": "make doesn&#39;t link math lib when compiling", "body": "<p>I get the following error while compiling xpdf using <code>make</code>. I've tried using the command: </p>\n\n<p><code>LIBS=-lm make</code> </p>\n\n<p>However, it doesn't work. I know the problem is that the c compiler cannot recognise the math symbols in the source code because the math library is not available to it, but I don't know how to fix it.</p>\n\n<pre><code>[ 71%] Linking CXX executable pdftohtml \n    /usr/bin/ld: CMakeFiles/xpdf_objs.dir/Gfx.cc.o: undefined reference to symbol 'acos@@GLIBC_2.2.5'\n    //usr/lib64/libm.so.6: error adding symbols: DSO missing from command line\n    collect2: error: ld returned 1 exit status\n    make[2]: *** [xpdf/CMakeFiles/pdftohtml.dir/build.make:219: xpdf/pdftohtml] Error 1\n    make[1]: *** [CMakeFiles/Makefile2:428: xpdf/CMakeFiles/pdftohtml.dir/all] Error 2\n    make: *** [Makefile:130: all] Error 2\n</code></pre>\n\n<p>I have put my <a href=\"https://pastebin.com/hFCR77Ts\" rel=\"nofollow noreferrer\">Makefile</a> and <a href=\"https://pastebin.com/3cFJLS1Y\" rel=\"nofollow noreferrer\">makeLists.txt</a> on pastebin for more information</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528836916, "post_id": 50825629, "comment_id": 88656233, "body": "Don&#39;t you get compiler warnings? What about <code>uneTrace-&gt;comment[40]= &quot;CommentaireDeLaTrace&quot;;</code> This writes an incompatible value (<code>char *</code> pointer to <code>char</code>) out of the bounds of the array. Use <code>strcpy</code> to copy a string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1528837050, "post_id": 50825629, "comment_id": 88656279, "body": "You can&#39;t assign to an array, that should be <code>strcpy(uneTrace-&gt;comment, &quot;CommentaireDeLaTrace&quot;)</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1528837183, "post_id": 50825629, "comment_id": 88656334, "body": "Please use the <code>MAX</code> from <code>#define MAX 4096</code> and not hard code <code>4096</code>."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 9905618, "user_type": "registered", "profile_image": "https://graph.facebook.com/646524305692767/picture?type=large", "display_name": "Tran Quoc Gia Cat", "link": "https://stackoverflow.com/users/9905618/tran-quoc-gia-cat"}, "edited": false, "score": 0, "creation_date": 1528837896, "post_id": 50825800, "comment_id": 88656600, "body": "why set variable count = tmax/dt? explain me, pls?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 99, "user_id": 9905618, "user_type": "registered", "profile_image": "https://graph.facebook.com/646524305692767/picture?type=large", "display_name": "Tran Quoc Gia Cat", "link": "https://stackoverflow.com/users/9905618/tran-quoc-gia-cat"}, "edited": false, "score": 1, "creation_date": 1528837954, "post_id": 50825800, "comment_id": 88656624, "body": "Your loop increases <code>t</code> from <code>0</code> to <code>tmax</code> by <code>dt</code>. That means it performs <code>tmax&#47;dt</code> iterations, so that&#39;s how many elements it will put into the arrays. Simple arithmetic."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1528837388, "creation_date": 1528837388, "answer_id": 50825800, "question_id": 50825629, "link": "https://stackoverflow.com/questions/50825629/how-to-change-array-in-struct-to-pointer-in-c/50825800#50825800", "title": "How to change array in struct to pointer in C", "body": "<p>Use <code>malloc</code></p>\n\n<pre><code>typedef struct{\n    char comment[40];\n    int nbpts;\n    float *time;\n    float *value;\n} trace;\n\nvoid simuTrace(int tmax, float dt, float params[], trace* uneTrace){\n    int i = 0;\n    float v = 0, w = 0, dv = 0, dw = 0, t = 0;\n    int count = tmax/dt;\n    uneTrace-&gt;time = malloc(count * sizeof(float));\n    uneTrace-&gt;value = malloc(count * sizeof(float));\n    while (i &lt; count){\n        dv = (params[0]-v)*(v-1)*v - w;\n        dw = params[4]*(params[1]*v-params[2]*w-params[3]);\n        v += dv*dt;\n        w += dw*dt;\n        uneTrace-&gt;time[i] = t;\n        uneTrace-&gt;value[i] = v;\n        i++;\n        t += dt;\n    }\n    uneTrace-&gt;nbpts = i+1;\n    strcpy(uneTrace-&gt;comment, \"CommentaireDeLaTrace\");\n}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 9905618, "user_type": "registered", "profile_image": "https://graph.facebook.com/646524305692767/picture?type=large", "display_name": "Tran Quoc Gia Cat", "link": "https://stackoverflow.com/users/9905618/tran-quoc-gia-cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528837388, "creation_date": 1528836498, "last_edit_date": 1528836985, "question_id": 50825629, "link": "https://stackoverflow.com/questions/50825629/how-to-change-array-in-struct-to-pointer-in-c", "title": "How to change array in struct to pointer in C", "body": "<p>I had stuct and my function:</p>\n\n<pre><code>#define MAX 4096\ntypedef struct{\n   char comment[40];\n   int nbpts;\n   float time[4096];\n   float value[4096];\n} trace;\nvoid simuTrace(int tmax, float dt, float params[], trace* uneTrace){\n    int i = 0;\n    float v = 0, w = 0, dv = 0, dw = 0, t = 0;\n    while (t&lt;tmax &amp;&amp; i &lt; MAX){\n        dv = (params[0]-v)*(v-1)*v - w;\n        dw = params[4]*(params[1]*v-params[2]*w-params[3]);\n        v += dv*dt;\n        w += dw*dt;\n        uneTrace-&gt;time[i] = t;\n        uneTrace-&gt;value[i] = v;\n        i++;\n        t += dt;\n    }\n    uneTrace-&gt;nbpts = i+1;\n    uneTrace-&gt;comment[40]= \"CommentaireDeLaTrace\";\n}\n</code></pre>\n\n<p>and I want to change struct here, it's not limit MAX but I don't know how to make. how to change some value in function by the new struct></p>\n\n<pre><code>typedef struct{\n    char comment[40];\n    int nbpts;\n    float *time;\n    float *value;\n} trace;\n</code></pre>\n"}, {"tags": ["c", "windows", "codeblocks", "c11", "threads.h"], "comments": [{"owner": {"reputation": 29, "user_id": 4229665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30909e500607b5a1331bfe86cadc7da6?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/4229665/mihai"}, "reply_to_user": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1528836884, "post_id": 50825123, "comment_id": 88656224, "body": "This is the first link when you search on google. It may be duplicate, but keep in mind that the marked answer was last edited in 2015. It is possible to not been implemented at that moment of time. Thank you!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528844035, "post_id": 50825123, "comment_id": 88658462, "body": "Maybe nothing has changed since 2015 w.r.t to <code>&lt;threads.h&gt;</code>?  If you still think it isn&#39;t a duplicate, then you should certainly list the alternative and explain why you think this is not a duplicate of that."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1528844315, "post_id": 50825123, "comment_id": 88658515, "body": "It&#39;s interesting that Pelles C claims conformance to C17 when <a href=\"https://www.iso.org/search.html?q=iso%2Fiec%209899&amp;hPP=10&amp;idx=all_en&amp;p=0\" rel=\"nofollow noreferrer\">ISO</a> still doesn&#39;t recognize it as a published standard."}, {"owner": {"reputation": 29, "user_id": 4229665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30909e500607b5a1331bfe86cadc7da6?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/4229665/mihai"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528844784, "post_id": 50825123, "comment_id": 88658651, "body": "Yes, you&#39;re right. I need this is for a project for faculty. I already asked my teacher how did he solved this problem, because he showed us some examples. He was not aware of it. He told me that he just  installed Code::Blocks with MinGW. I think that maby there is still a problem regarding some CPUs or I dont know. I didn&#39;t found any documentation regarding this."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528845545, "post_id": 50825123, "comment_id": 88658868, "body": "IIRC, Code::Blocks uses whatever compiler(s) you tell it to use.  So the issue is not so much which version of Code::Blocks (an IDE) your colleagues have; it is a question of which compiler they use, and which o/s they use."}, {"owner": {"reputation": 29, "user_id": 4229665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30909e500607b5a1331bfe86cadc7da6?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/4229665/mihai"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1528846289, "post_id": 50825123, "comment_id": 88659004, "body": "You are right, it is about the last version of Code::Blocks with MinGW using TDM-GCC (version 5.1.0, 32 bit, SJLJ) on Windows operating system. It is really strange that the library threads.h works for him. I don&#39;t know which version of Windows is he using. Thank You!"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4229665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30909e500607b5a1331bfe86cadc7da6?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/4229665/mihai"}, "edited": false, "score": 0, "creation_date": 1528844959, "post_id": 50826235, "comment_id": 88658711, "body": "I have already tried this macro-test:  #if <b>STDC_NO_THREADS</b> == 0 #include &lt;threads.h&gt; #else #error &quot;No threading support&quot; #endif  The result is still &quot;No such file or directory&quot;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 29, "user_id": 4229665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30909e500607b5a1331bfe86cadc7da6?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/4229665/mihai"}, "edited": false, "score": 0, "creation_date": 1528845336, "post_id": 50826235, "comment_id": 88658817, "body": "@Mihai: That probably indicates that the implementation does not define <code>__STDC_NO_THREADS__</code> even though it does not implement <code>&lt;threads.h&gt;</code>.  The standard can only say what a conforming compiler must do; non-conforming compilers can do whatever they like, and what they like is usually not what you, or the standards committee, would like."}], "tags": [], "owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "is_accepted": false, "score": 1, "last_activity_date": 1528844480, "last_edit_date": 1528844480, "creation_date": 1528839726, "answer_id": 50826235, "question_id": 50825123, "link": "https://stackoverflow.com/questions/50825123/c11-threads-h-library/50826235#50826235", "title": "C11 threads.h library", "body": "<p>TDM-GCC was last seen at 5.1.0 version (released 28th June 2015). They haven't updated their site or downloads since.</p>\n\n<p>As for C11 threads themselves, they're an optional feature not necessary for the compiler vendor to provide. Test if <code>__STDC_NO_THREADS__</code> is even present in your compiler. Then based on the tests try to include <code>threads.h</code>.</p>\n\n<p>C11 threads functions are based off <code>pthreads</code> and most functions and structures are nearly a direct one-on-one mapping of POSIX threads interface.</p>\n\n<p>So if you're inclined to still try C11 threads on Windows (because you're using TDM), I suggest you give it up now and use a slightly older but stable <code>winpthreads</code> library which provides nearly the same functionality. Upgrade your compiler to latest <a href=\"https://mingw-w64.org/doku.php\" rel=\"nofollow noreferrer\">MingW-w64</a> to benefit from it.</p>\n\n<p>Sadly, not C11 threads yet on Windows that I know of.</p>\n"}], "owner": {"reputation": 29, "user_id": 4229665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30909e500607b5a1331bfe86cadc7da6?s=128&d=identicon&r=PG&f=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/4229665/mihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5338, "favorite_count": 0, "closed_date": 1528843938, "answer_count": 1, "score": 0, "last_activity_date": 1528845455, "creation_date": 1528834192, "last_edit_date": 1528845455, "question_id": 50825123, "link": "https://stackoverflow.com/questions/50825123/c11-threads-h-library", "closed_reason": "Duplicate", "title": "C11 threads.h library", "body": "<p>What I am trying to do is to use <code>threads.h</code> from C11 standard on Windows 10.\nI had been installed Code::Blocks with MinGW. I've set in the Compiler Settings <code>-std=c11</code> flag, but with no luck. I have been also installed a Win64 version of MinGW and I have set it as default with <code>-std=c11</code> with no positive results also. I have downloaded the latest version of <a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"nofollow noreferrer\">tdm-gcc</a> and nothing changed. </p>\n\n<p>All that I get is: <code>fatal error: threads.h: No such file or directory</code> </p>\n\n<p>I know somebody that had been just installed the latest version of Code::Blocks and he has <code>threads.h</code>. I did it the same, but it seems that it doesn't work. I have read all the questions here, I almost know the responses and the comments just reading the first phrase in the question. </p>\n\n<p>I found that <a href=\"http://www.smorgasbordet.com/pellesc/\" rel=\"nofollow noreferrer\">Pelles C</a> windows development kit has C11 standard available to use. The <code>threads.h</code> optional library is already integrated. I have been installed it, but I have a lot of GNU static libraries (.a) which should be compiled to Windows static or dynamic libraries, so it will be very time consuming. </p>\n\n<p>Any help or any new information will be appreciated. </p>\n"}, {"tags": ["c", "function", "struct", "parameters"], "comments": [{"owner": {"reputation": 10872, "user_id": 3135417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b989009ea961e780793f80ea6d53240?s=128&d=identicon&r=PG&f=1", "display_name": "Abdou", "link": "https://stackoverflow.com/users/3135417/abdou"}, "edited": false, "score": 0, "creation_date": 1528833826, "post_id": 50824969, "comment_id": 88654875, "body": "Almost all your functions have <code>Q</code> and a number in common. So, you could just have one function with three arguments: a <code>student[]</code> value, an <code>int</code> value and a <code>Q</code> value or <code>Final</code> value. For example <code>int highestQ1(student[], int, char[]);</code> should do. The third argument could be <code>&quot;Q1&quot;</code> or <code>&quot;Q2&quot;</code> or <code>&quot;Q3&quot;</code> or <code>&quot;Q4&quot;</code> or <code>&quot;Final&quot;</code>."}, {"owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 0, "creation_date": 1528834629, "post_id": 50824969, "comment_id": 88655222, "body": "What you have written is  not possible in C."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9932234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4e77faa9aabfc72908389df1264238?s=128&d=identicon&r=PG&f=1", "display_name": "Typhus", "link": "https://stackoverflow.com/users/9932234/typhus"}, "edited": false, "score": 0, "creation_date": 1528833983, "post_id": 50825015, "comment_id": 88654949, "body": "How would I go about that? I would understand that if each element in the array was an array, but I&#39;m trying to pass an array of structs, and then specify which data member I want to use of each struct in the array."}], "tags": [], "owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "is_accepted": false, "score": 0, "last_activity_date": 1528834133, "last_edit_date": 1528834133, "creation_date": 1528833729, "answer_id": 50825015, "question_id": 50824969, "link": "https://stackoverflow.com/questions/50824969/pass-different-data-members-in-function-in-c/50825015#50825015", "title": "Pass different data members in function in C", "body": "<p>You can make a more general function to which you pass the <code>index</code> of the data member that will be used for the calculation.</p>\n\n<p>For instance, this index can be a <code>one to one</code> map to your <code>Q</code>. Say, if you pass <code>1</code> you consider <code>Q1</code> for the calculation, <code>2</code> consider <code>Q2</code> and so on.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528838888, "post_id": 50825541, "comment_id": 88656956, "body": "<code>sizeof(all_students)&#47;sizeof(student)</code> is an interesting combination of size of a variable and size of a type.  Consider <code>sizeof all_students&#47;sizeof all_students[0]</code> as it is easier to code right, review and maintain."}], "tags": [], "owner": {"reputation": 10872, "user_id": 3135417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b989009ea961e780793f80ea6d53240?s=128&d=identicon&r=PG&f=1", "display_name": "Abdou", "link": "https://stackoverflow.com/users/3135417/abdou"}, "is_accepted": false, "score": 1, "last_activity_date": 1528839135, "last_edit_date": 1528839135, "creation_date": 1528836112, "answer_id": 50825541, "question_id": 50824969, "link": "https://stackoverflow.com/questions/50824969/pass-different-data-members-in-function-in-c/50825541#50825541", "title": "Pass different data members in function in C", "body": "<p>Let's say you wanted to find the highest mark from an array of students given a wildcard/group value, the following comes pretty close to answering your question:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\ntypedef struct student {\n    char * name;\n    int mark;\n    char * wildcard;\n} student;\n\n\nint highestMark(student[], int, char *);\n\nint main() {\n    // Make an array of students\n    student all_students[] = {\n        {.name = \"John\", .mark = 75, .wildcard = \"Final\"},\n        {.name = \"Mark\", .mark = 83, .wildcard = \"Q1\"},\n        {.name = \"Melanie\", .mark = 81, .wildcard = \"Q2\"},\n        {.name = \"Ashley\", .mark = 92, .wildcard = \"Q3\"},\n        {.name = \"Sandra\", .mark = 90, .wildcard = \"Final\"},\n        {.name = \"Jacob\", .mark = 79, .wildcard = \"Q1\"},\n        {.name = \"Marlene\", .mark = 74, .wildcard = \"Q2\"},\n        {.name = \"Layla\", .mark = 70, .wildcard = \"Q4\"},\n        {.name = \"John\", .mark = 84, .wildcard = \"Final\"},\n        {.name = \"Mark\", .mark = 83, .wildcard = \"Q2\"},\n        {.name = \"Melanie\", .mark = 100, .wildcard = \"Q2\"},\n        {.name = \"Ashley\", .mark = 97, .wildcard = \"Q3\"},\n        {.name = \"Aysha\", .mark = 100, .wildcard = \"Final\"},\n        {.name = \"Devin\", .mark = 95, .wildcard = \"Q1\"},\n    };\n    // Call the highestMark function for wildcards of value \"Final\"\n    // int arr_length = sizeof(all_students)/sizeof(student);\n    int arr_length = sizeof all_students/sizeof all_students[0];\n    printf(\"%d\\n\", highestMark(all_students, arr_length, \"Final\"));\n}\n\n// Grab the highest mark number given a wildcard\n// Wildcards can be Q1, Q2, Q3, Q4 or Final\nint highestMark(student students[], int size, char * wildcard) {\n    int highest = 0;\n    for (int i=0; i &lt; size; i++) {\n        if (students[i].wildcard != wildcard) {\n            continue;\n        }\n        if (highest &lt; students[i].mark) {\n            highest = students[i].mark;\n        }\n    }\n    return highest;\n}\n</code></pre>\n\n<p>I hope this proves useful.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528838257, "post_id": 50825743, "comment_id": 88656723, "body": "<i>&quot;if Q&#39;s are of the same type&quot;</i>: it is not needed. <code>offsetof</code> will do its job."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528838432, "post_id": 50825743, "comment_id": 88656798, "body": "@Jarod42 Yes it is required, if not you won&#39;t be able to correctly type the dereferencing."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528838825, "post_id": 50825743, "comment_id": 88656932, "body": "Where is the issue with <code>struct S {int a, char b;} s[2] = {{42, &#39;*&#39;}, {42, &#39;*&#39;}}; char c = *((char*)((char*)(&amp;s[1]) + offsetof(s, b))); int i = *((int*)((char*)(&amp;s[1]) + offsetof(s, a)));</code> ?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528838999, "post_id": 50825743, "comment_id": 88656987, "body": "@Jarod42 There is no issue with your code, but OP wants to factorize everything in a single function...I suppose that means same type for every needed member. Isn&#39;t it?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1528839110, "post_id": 50825743, "comment_id": 88657005, "body": "Need one function by type by algorithm. Ok, I understand what you mean."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528839310, "post_id": 50825743, "comment_id": 88657075, "body": "@Jarod42 Do you think I need to improve the answer by including your final comment?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1528839547, "post_id": 50825743, "comment_id": 88657155, "body": "Up to you. but clarification won&#39;t hurt ;-)"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 1, "last_activity_date": 1528840013, "last_edit_date": 1528840013, "creation_date": 1528837096, "answer_id": 50825743, "question_id": 50824969, "link": "https://stackoverflow.com/questions/50824969/pass-different-data-members-in-function-in-c/50825743#50825743", "title": "Pass different data members in function in C", "body": "<p>if Q's are of the same type, then you can pass their offset:</p>\n\n<pre><code>struct Student {\n    int q1, q2, q3, q4;\n};\n\nint highestQ(struct Student students[], int size, size_t offset) {\n  for (int i=0; i&lt;size; i++) {\n    struct Student *s = students+i;\n    int *q = (int *)(((char *)s) + offset);\n    // do something with *q\n  }\n  return something;\n}\n\n// Example of a call\nstruct Student student_array[10] = { /* whatever to initialize */};\nhighestQ(student_array, 10, offsetof(struct Student, q2));\n</code></pre>\n\n<p>You may also use an embedded array:</p>\n\n<pre><code>struct Student {\n    int q[4];\n};\n\nint highestQ(struct Student students[], int size, int idx) {\n  for (int i=0; i&lt;size; i++) {\n    int q = students[i].q[idx];\n    // do what you want with q\n  }\n  return something;\n}\n\n// call example\nstruct Student student_array[10] = { /* whatever to initialize */};\nhighestQ(student_array, 10, 2);\n</code></pre>\n\n<p>If Q's are not of the same type or algorithm applied to them may not be the same then similar things have to be applied separately for each case.</p>\n"}, {"comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528840110, "post_id": 50825991, "comment_id": 88657325, "body": "Wasn&#39;t it what I proposed?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1528842744, "post_id": 50825991, "comment_id": 88658157, "body": "@Jean-BaptisteYun&#232;s: Yes, Proposed mostly at the same time. upvoted your solution Btw."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 0, "last_activity_date": 1528838423, "creation_date": 1528838423, "answer_id": 50825991, "question_id": 50824969, "link": "https://stackoverflow.com/questions/50824969/pass-different-data-members-in-function-in-c/50825991#50825991", "title": "Pass different data members in function in C", "body": "<p>You might use offset as pointer on data member:</p>\n\n<pre><code>void print(const student* students, int size, int offset)\n{\n    for (int i = 0; i != size; ++i) {\n        const int member = *((const int*)(((const char*) &amp;students[i]) + offset));\n\n        printf(\"%d \", member);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>with call similar to:</p>\n\n<pre><code>print(students, size, offsetof(student, q1));\n</code></pre>\n\n<p><a href=\"https://ideone.com/up4LB3\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 43, "user_id": 9932234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4e77faa9aabfc72908389df1264238?s=128&d=identicon&r=PG&f=1", "display_name": "Typhus", "link": "https://stackoverflow.com/users/9932234/typhus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 50825991, "answer_count": 4, "score": 1, "last_activity_date": 1528840013, "creation_date": 1528833554, "last_edit_date": 1528834880, "question_id": 50824969, "link": "https://stackoverflow.com/questions/50824969/pass-different-data-members-in-function-in-c", "title": "Pass different data members in function in C", "body": "<p>Just a question about programming in C, as I'm new to it.</p>\n\n<p>So I have a <code>typedef struct</code> called <code>students</code>, and I've created an array of them. Each of them has data members of <code>q1</code>, <code>q2</code>, <code>q3</code>, <code>q4</code>, <code>final</code>.</p>\n\n<p>I'm trying to do calculations on each of those data members and currently i have separate functions for each like so:</p>\n\n<pre><code>int highestQ1(student[], int);\nint highestQ2(student[], int);\nint highestQ3(student[], int);\nint highestQ4(student[], int);\nint highestFinal(student[], int);\nint highestQ1(student[], int);\n</code></pre>\n\n<p>But this makes the code really long, and I'm wondering if there's a way for me to create a function that will allow me to specify which data member of the structure to use for calculation as the parameter, that way I can just use one function and lean out my code.</p>\n\n<p>An example of my goal would be</p>\n\n<pre><code>int highestVal(student[] data, int size, char[] wildcard)\n{\n    int i = data[x].wildcard;\n}\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "unicode", "normalization", ".a"], "comments": [{"owner": {"reputation": 4158, "user_id": 51700, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/43c427f1fe62eb5f74fe6782a257f2ac?s=128&d=identicon&r=PG", "display_name": "Mark Essel", "link": "https://stackoverflow.com/users/51700/mark-essel"}, "edited": false, "score": 0, "creation_date": 1528833219, "post_id": 50824556, "comment_id": 88654590, "body": "the dynamic linking is correctly getting any dependent shared libs, while the static compilation may be pulling in older code with bugs?"}, {"owner": {"reputation": 1, "user_id": 9932140, "user_type": "registered", "profile_image": "https://graph.facebook.com/1595841373832486/picture?type=large", "display_name": "Ding Shaobin", "link": "https://stackoverflow.com/users/9932140/ding-shaobin"}, "reply_to_user": {"reputation": 4158, "user_id": 51700, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/43c427f1fe62eb5f74fe6782a257f2ac?s=128&d=identicon&r=PG", "display_name": "Mark Essel", "link": "https://stackoverflow.com/users/51700/mark-essel"}, "edited": false, "score": 0, "creation_date": 1532377120, "post_id": 50824556, "comment_id": 89942351, "body": "The problem is the looking table for the saslprep. It is a .h file generated by a perl script. The script has bugs which I tested, it gave me 2 different result ran in Redhat vs MacOs. The latest script seems solve the bugs..... Anyway, it is solved now.  Thanks. @MarkEssel"}], "owner": {"reputation": 1, "user_id": 9932140, "user_type": "registered", "profile_image": "https://graph.facebook.com/1595841373832486/picture?type=large", "display_name": "Ding Shaobin", "link": "https://stackoverflow.com/users/9932140/ding-shaobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528834643, "creation_date": 1528831989, "last_edit_date": 1528834643, "question_id": 50824556, "link": "https://stackoverflow.com/questions/50824556/libidn-build-a-and-so-lib-giving-different-result", "title": "libidn build .a and .so lib giving different result", "body": "<p>I am trying to use GNU libidn, compiled from source code. If I build my application with <code>libidn.so</code>, the function is working fine. (Only interested in the function <code>stringprep_profile()</code>. This function is using for the unicoded password normalization.)</p>\n\n<p>However, when I tried to build with <code>.a</code> file, the same input got the segmentation fault. Kind of confused right now. </p>\n"}, {"tags": ["c", "fizzbuzz"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1528832663, "post_id": 50824517, "comment_id": 88654320, "body": "And what is the problem? Why do you think this is any better (or worse) than any other solution?"}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1528832882, "post_id": 50824517, "comment_id": 88654427, "body": "Because a for loop looks cleaner that&#39;s all."}, {"owner": {"reputation": 295, "user_id": 9911093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f993fb65fe7902f2f75f9f420b705b3b?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9911093/j-doe"}, "edited": false, "score": 1, "creation_date": 1528839517, "post_id": 50824517, "comment_id": 88657147, "body": "BTW, you might want to check out <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a> for stuff like this"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9932085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a533b2f3ff0dd0058fc190e95f9c31f?s=128&d=identicon&r=PG&f=1", "display_name": "compeccentric", "link": "https://stackoverflow.com/users/9932085/compeccentric"}, "edited": false, "score": 0, "creation_date": 1528833597, "post_id": 50824895, "comment_id": 88654760, "body": "Thanks so much!  That really helped clarify the benefits of using a for loop.  Being new to coding I am still trying to understand which approach works best for a particular problem."}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 1, "last_activity_date": 1528833235, "creation_date": 1528833235, "answer_id": 50824895, "question_id": 50824517, "link": "https://stackoverflow.com/questions/50824517/why-not-use-a-while-loop-for-fizzbuzz-in-c/50824895#50824895", "title": "Why not use a while loop for FIZZBUZZ in C?", "body": "<p>Your loop can be neatly folded into a <code>for</code> loop:</p>\n\n<pre><code>for(int num = 1; num &lt;= 100; ++num)\n</code></pre>\n\n<p>There are two advantages here:</p>\n\n<ul>\n<li><p><code>num</code> is scoped inside the loop, when before it was bleeding into whatever scope followed the <code>while</code>. Restricting variables to the minimum possible scope is a good rule of thumb, because it minimizes the amount of variables to think about at any given point.</p></li>\n<li><p>The range over which your program will operate is now summarized in a single place: you can see the bounds (1 to 100) and the step (1) inside the <code>for</code>. That kind of ranges is pretty well balanced to be read and memorized quickly before reading the body of the loop. For example, if you now wanted to only check odd numbers, it would be immediately clear from reading the <code>num += 2</code> in the <code>for</code> header, rather than stumbling upon it at the very end of the loop's body.</p></li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 9932085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a533b2f3ff0dd0058fc190e95f9c31f?s=128&d=identicon&r=PG&f=1", "display_name": "compeccentric", "link": "https://stackoverflow.com/users/9932085/compeccentric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "closed_date": 1528846745, "accepted_answer_id": 50824895, "answer_count": 1, "score": 0, "last_activity_date": 1528833235, "creation_date": 1528831820, "last_edit_date": 1528832550, "question_id": 50824517, "link": "https://stackoverflow.com/questions/50824517/why-not-use-a-while-loop-for-fizzbuzz-in-c", "closed_reason": "Opinion-based", "title": "Why not use a while loop for FIZZBUZZ in C?", "body": "<p>Only been coding in C for about a month, but wondered why the while loop wasn't used more often for FIZZBUZZ.  Is it not as clean or some other reason?  Here's what I came up with:</p>\n\n<pre><code>int main()\n{\n    int num=1;\n    while(num&lt;=100)\n    {\n        if (num%3==0 &amp;&amp; num%5==0)\n        {\n            printf(\"FIZZBUZZ!!!\\n\");\n        }\n        else if (num%3==0)\n        {\n            printf(\"FIZZ!!!\\n\");\n        }\n        else if (num%5==0)\n        {\n            printf(\"BUZZ!!!\\n\");\n        }\n        else\n        {\n            printf(\"%d\\n\", num);\n        }\n        num++;\n    }\n\n    return 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1528831547, "post_id": 50824401, "comment_id": 88653857, "body": "Please show sample input and output and compare to desired output. What is wrong?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9932114"}, "edited": false, "score": 1, "creation_date": 1528832553, "post_id": 50824449, "comment_id": 88654259, "body": "Thnx Sachin, Actually you&#39;re your code is working properly. And thnx with the guidance !"}], "tags": [], "owner": {"reputation": 90, "user_id": 9521356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqRng.jpg?s=128&g=1", "display_name": "Sachin Liyanage", "link": "https://stackoverflow.com/users/9521356/sachin-liyanage"}, "is_accepted": true, "score": -1, "last_activity_date": 1528831554, "creation_date": 1528831554, "answer_id": 50824449, "question_id": 50824401, "link": "https://stackoverflow.com/questions/50824401/error-with-sorting-code-in-c/50824449#50824449", "title": "Error with sorting code in C", "body": "<p>You're right emely,There were some issues in your algorithm.\nIn the 6th line the gap should be n/2, not n.\nAnd in the 12th line it should be j-gap.</p>\n\n<p>After correcting those errors,I rewrote the code.\n<strong>Hope it might help.\nCheers.</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid sort(int a[],int n)\n{\n    int gap,i,j,temp;\n    for(gap=n/2;gap&gt;0;gap/=2)\n    {\n        for(i=gap;i&lt;n;i+=1)\n        {\n            temp=a[i];\n\n            for(j=i;j&gt;=gap&amp;&amp;a[j-gap]&gt;temp;j-=gap)\n                a[j]=a[j-gap];\n\n            a[j]=temp;\n        }\n    }\n}\n\nint main()\n{\n    int a[20],i,n;\n\n    printf(\"Number of elements:\");\n    scanf(\"%d\",&amp;n);\n\n    printf(\"Enter array elements:\\n\");\n    for(i=0;i&lt;n;++i)\n        scanf(\"%d\",&amp;a[i]);\n\n    printf(\"Array elements before the sort:\\n\");\n    for(i=0;i&lt;n;++i)\n        printf(\"%d\",a[i]);\n\n    sort(a,n);\n\n    printf(\"\\nAfter shell sort:\\n\");\n    for(i=0;i&lt;n;++i)\n        printf(\"%d \",a[i]);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9932114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 50824449, "answer_count": 1, "score": -1, "last_activity_date": 1528845945, "creation_date": 1528831377, "last_edit_date": 1528845945, "question_id": 50824401, "link": "https://stackoverflow.com/questions/50824401/error-with-sorting-code-in-c", "title": "Error with sorting code in C", "body": "<p>I think there was something wrong with the algorithm.\nIt shows wrong answers.\nI changed every line by line, but I didn't get the proper answer.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid sort(int a[],int n)\n{\n    int gap,i,j,temp;\n    for(gap=n;gap&gt;0;gap/=2)\n    {\n        for(i=gap;i&lt;n;i+=1)\n        {\n            temp=a[i];\n\n            for(j=i;j&gt;=gap&amp;&amp;a[j]&gt;temp;j=gap)\n                a[j]=a[j];\n\n            a[j]=temp;\n        }\n    }\n}\n\nint main()\n{\n    int a[20],i,n;\n\n    printf(\"Number of elements:\");\n    scanf(\"%d\",&amp;n);\n\n    printf(\"Enter array elements:\\n\");\n    for(i=0;i&lt;n;++i)\n        scanf(\"%d\",&amp;a[i]);\n\n    printf(\"Array elements before the sort:\\n\");\n    for(i=0;i&lt;n;++i)\n        printf(\"%d\",a[i]);\n\n    sort(a,n);\n\n    printf(\"\\nAfter sort:\\n\");\n    for(i=0;i&lt;n;++i)\n        printf(\"%d \",a[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Please help me with this code.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 2, "creation_date": 1528830262, "post_id": 50824111, "comment_id": 88653268, "body": "You can&#39;t oblige the user to write or not to write something. You can accept what you want from whatever was written."}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 1, "creation_date": 1528830402, "post_id": 50824111, "comment_id": 88653344, "body": "are you talking about <code>getch</code> from <code>conio.h</code>?  I don&#39;t think that is standard c. If you are talking about something else, I apologize"}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1528830554, "post_id": 50824111, "comment_id": 88653411, "body": "Yes, I&#39;m using it from conio.h"}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "reply_to_user": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 0, "creation_date": 1528830723, "post_id": 50824111, "comment_id": 88653488, "body": "@NiVeR I know that... the point is I have to check every single ASCII code and check if it is different beetween the ones that I allow to the user. It will take really long, I dont wanna be lazy, what I&#39;m asking is if there is already something like this."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1528830816, "post_id": 50824111, "comment_id": 88653528, "body": "The language has functions like <code>isalpha</code> and <code>isdigit</code> which are defined in <code>ctype.h</code>"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1528830930, "post_id": 50824111, "comment_id": 88653588, "body": "It&#39;s good to be lazy and let the computer do the work for you, or use what others have written."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1528833884, "post_id": 50824111, "comment_id": 88654901, "body": "For ASCII text, you could use a 128/256 byte lookup table for ultimate flexibility."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1528834161, "post_id": 50824111, "comment_id": 88655018, "body": "@user3386109 Thanks for the replay, by using isalnum and some execptions such as: &#39;\\&#39;&#39; , &#39;&#232;&#39;, &#39;&#249;&#39; &#39;&#224;&#39; &#39;&#236;&#39; &#39;&#242;&#39;, I&#39;m almost there, unfortunate F8, F9,F10,F11 and the arrows return as output 1 true and 1 false, if users fail to press one of them it will still be compromised."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1528835058, "post_id": 50824111, "comment_id": 88655416, "body": "@GeneNight Yes, the arrow keys and function keys are a little harder. They generate a sequence of characters. <a href=\"https://stackoverflow.com/questions/41026812\">Here&#39;s a question that may help</a>."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1528837045, "post_id": 50824111, "comment_id": 88656277, "body": "Well, only by printing the output as an integer I managed to do it, I will add my code down below, thank you guys the comments."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "is_accepted": false, "score": 1, "last_activity_date": 1528836930, "last_edit_date": 1528836930, "creation_date": 1528834634, "answer_id": 50825231, "question_id": 50824111, "link": "https://stackoverflow.com/questions/50824111/taking-as-input-only-numbers-and-letters-with-getch-in-c/50825231#50825231", "title": "Taking as input only numbers and letters with getch() in c", "body": "<pre><code>char c;\nint temp = 0;\nwhile((c= getch()) !='\\r')\n{\n    if ((temp == -32) || (temp == 0))\n    {\n    }\n    else\n    {\n        if(isalnum((char)c) == 0)\n        {\n            if((c == '\\'') || (c == -118) || (c == -115) || (c == -107) || (c == -123) || (c == -105))\n            {\n                printf(\"true: %c\\n\",c);\n            }\n            else\n                printf(\"false: %d\\n\",c);\n        }\n        else\n        {\n            printf(\"true: %c\\n\",c);\n        }\n    }\n    temp = c;\n}\n</code></pre>\n\n<p>For anyone else who's trying to accomplish the same result, this works fine for me.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1529010301, "creation_date": 1529010301, "answer_id": 50865914, "question_id": 50824111, "link": "https://stackoverflow.com/questions/50824111/taking-as-input-only-numbers-and-letters-with-getch-in-c/50865914#50865914", "title": "Taking as input only numbers and letters with getch() in c", "body": "<blockquote>\n  <p>Is there any <em>write function</em> that allows the user to write only certain characters, such as: letters, numbers, and apostrophe. (?)</p>\n</blockquote>\n\n<p>Code can instead selectivity write</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n\nint c; // use type `int` here to distinguish all (256) characters from EOF\nwhile((c = getch()) != '\\r' &amp;&amp; c != '\\n'  &amp;&amp; c != EOF) {\n  if (isalnum(c) || '\\'') {\n    putchar(c);\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529010301, "creation_date": 1528830098, "question_id": 50824111, "link": "https://stackoverflow.com/questions/50824111/taking-as-input-only-numbers-and-letters-with-getch-in-c", "title": "Taking as input only numbers and letters with getch() in c", "body": "<p>what I'm trying to accomplish is a simultaneous research by using the fuction getch. I know that this fuction returns a integer value, which represents the ASCII code of a key. Is there any wroten fuction that allows the user to write only certain characters, such as: letters, numbers, and apostrophe. </p>\n"}, {"tags": ["c", "runtime-error"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528827285, "post_id": 50823353, "comment_id": 88651777, "body": "The link seems broken. Please add the problem here."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528827587, "post_id": 50823353, "comment_id": 88651929, "body": "&quot;404 Error Occured! Page could not be found&quot;. But the challenge is supposed to test <i>you</i>. Try making some test cases yourself with values at the limits of the problem&#39;s constraints, and see how it behaves. The debugger can help you."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528827789, "post_id": 50823353, "comment_id": 88652029, "body": "Aside: are you sure you should be printing &quot;Input:&quot; and &quot;Output:&quot;? Print <i>exactly</i> what the problem tells you to. Your output is checked by a machine."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528827872, "post_id": 50823353, "comment_id": 88652085, "body": "Your loop doesn&#39;t have a termination condition. I have no idea how it is supposed to work."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528828050, "post_id": 50823353, "comment_id": 88652180, "body": "@EugeneSh. the termination condition is <code>if(input==42) {  scanf(&quot;%d&quot;); break; }</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528828217, "post_id": 50823353, "comment_id": 88652269, "body": "@WeatherVane It <i>might</i> be one... But if there is no such an input, <code>i</code> will overflow"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1528828325, "post_id": 50823353, "comment_id": 88652325, "body": "@EugeneSh. generally true but such problems have constraints and guarantees so that you can make assumptions about some limits. If OP can&#39;t answer the problem, it matters little whether it is &quot;Compilation error&quot;, &quot;Wrong answer&quot;, &quot;Seg fault&quot; of &quot;Time limit&quot; although the reason will give a clue."}, {"owner": {"reputation": 3, "user_id": 9921443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f22cc2567d89111d05767731984b0?s=128&d=identicon&r=PG&f=1", "display_name": "M.Soumen", "link": "https://stackoverflow.com/users/9921443/m-soumen"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528960409, "post_id": 50823353, "comment_id": 88705895, "body": "@WeatherVane I updated  the problem link."}, {"owner": {"reputation": 3, "user_id": 9921443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f22cc2567d89111d05767731984b0?s=128&d=identicon&r=PG&f=1", "display_name": "M.Soumen", "link": "https://stackoverflow.com/users/9921443/m-soumen"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528961009, "post_id": 50823353, "comment_id": 88706203, "body": "@WeatherVane Thank u very much for print advice."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 9854827, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rUfmblVIqiE/AAAAAAAAAAI/AAAAAAAAAAs/QybIDmcFw4g/photo.jpg?sz=128", "display_name": "vbextreme vbextreme", "link": "https://stackoverflow.com/users/9854827/vbextreme-vbextreme"}, "is_accepted": true, "score": 2, "last_activity_date": 1528827642, "creation_date": 1528827642, "answer_id": 50823467, "question_id": 50823353, "link": "https://stackoverflow.com/questions/50823353/test-runtime-error-sigsegv/50823467#50823467", "title": "TEST - Runtime Error SIGSEGV", "body": "<p>the variable in the second scanf is missing</p>\n"}], "owner": {"reputation": 3, "user_id": 9921443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349f22cc2567d89111d05767731984b0?s=128&d=identicon&r=PG&f=1", "display_name": "M.Soumen", "link": "https://stackoverflow.com/users/9921443/m-soumen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50823467, "answer_count": 1, "score": -1, "last_activity_date": 1528960250, "creation_date": 1528827203, "last_edit_date": 1528960250, "question_id": 50823353, "link": "https://stackoverflow.com/questions/50823353/test-runtime-error-sigsegv", "title": "TEST - Runtime Error SIGSEGV", "body": "<p>please help me <a href=\"http://codechef.com/problems/TEST\" rel=\"nofollow noreferrer\">Here is a problem of Codechef</a> . And this is my submission:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define M 60\n\nint main()\n{\n    int i,arr[M],input;\n    int s=0;\n    puts(\"Input:\");\n    for(i=0;;i++){\n        scanf(\"%d\",&amp;input);\n        if(input==42){\n            scanf(\"%d\");\n            break;\n        }\n        else{\n            arr[i]=input;\n            s++;\n            }\n        }\n    puts(\"Output:\");\n    for(i=0;i&lt;s;i++){\n        printf(\"%d\\n\",arr[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When i create the code it successfully ran with GCC 4.9.2, but when i submit this Codechef said that it has a runtime error. I tried but could not found the error. \nSo\nPlease help me to find out the error ...</p>\n"}, {"tags": ["c", "struct", "atomic", "c11"], "answers": [{"comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1528839237, "post_id": 50824083, "comment_id": 88657053, "body": "The standard guarantees that <i>all</i> objects that are atomic qualified are consistent."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1528841554, "post_id": 50824083, "comment_id": 88657804, "body": "@JensGustedt: Guarantees of consistency are meaningless if the program invokes Undefined Behavior."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1528874432, "post_id": 50824083, "comment_id": 88666680, "body": "yes, so what? Your premise for a rant on the C committee is that there could be <i>&quot;atomic structures for which an implementation cannot offer proper semantics&quot;</i> . This premise is simply false. All <code>struct</code> types can be qualified atomic and the standard offers proper semantics for all of them. So no implementation of the C standard can ever be in such a situation."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1528901087, "post_id": 50824083, "comment_id": 88683923, "body": "@JensGustedt: Perhaps I should have said &quot;offer proper semantics <i>for member access</i>&quot; [which I would consider part of the semantics of a structure]?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1528901763, "post_id": 50824083, "comment_id": 88684391, "body": "perhaps, but I even understand less what that means. One of the properties of atomics is to be indivisible, asking in general for atomic <code>struct</code> to access individual members is going against that. Nobody should expect such an operation to be &quot;easy&quot; on any platform. Generally for <code>struct</code> this will be a sequence of load, modify the copy, and compare-exchange in a loop."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1528902744, "post_id": 50824083, "comment_id": 88685035, "body": "@JensGustedt: What is important with atomics is that <i>operations</i> on them are indivisible.  If one has a structure with an &quot;enable&quot; field along with some data, one may need to atomically set the &quot;enable&quot; field and load the data, but at other times one may want to be able to clear the enable field without having to do anything with the other data.  If &quot;enable&quot; will usually be false, code might benefit from reading the enable field and then, only if it&#39;s true, reading the entire structure (recognizing that if &quot;enable&quot; becomes false between the two reads, the effort of reading would be wasted)."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1528830004, "creation_date": 1528830004, "answer_id": 50824083, "question_id": 50823320, "link": "https://stackoverflow.com/questions/50823320/purpose-of-atomic-structures/50824083#50824083", "title": "Purpose of atomic structures", "body": "<p>Some implementations might be able to guarantee atomic behavior for structures meeting certain criteria.  I don't know whether any implementations that did so actually existed before the publication of the C11 Standard, but it would certainly seems plausible.  If an implementation usefully supported such structures, it would have been rather annoying for the Standard to demand that they be treated as a constraint violation.</p>\n\n<p>It would have been helpful if the Standard mandated, or at least suggested, that implementations treat as constraint violations any attempts to define atomic structures <em>for which they cannot offer proper semantics</em>, but for whatever reason the authors of the Standard seem extremely loath to recognize a category of programs that would be rejected by some implementations but have defined behavior on implementations that don't reject it.  A good standard should seek to maximize the number of useful programs that would fall into that category, but the Standard instead tends to regard constructs which some implementations will support and others won't as Undefined Behavior, letting implementations support them or not at their leisure, but not offering any safe way to determine whether they are supported.</p>\n"}, {"comments": [{"owner": {"reputation": 739, "user_id": 2359990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f7130d72f637bce50544029ccd6998a?s=128&d=identicon&r=PG", "display_name": "Max Maier", "link": "https://stackoverflow.com/users/2359990/max-maier"}, "edited": false, "score": 0, "creation_date": 1529735222, "post_id": 50826111, "comment_id": 88991161, "body": "Interesting, I wouldn&#39;t have expected such a behavior. If I can access the whole structure atomically, then I would have expected that I can also access a single element atomically. For me it seems like an overhead if I want to modify a single element, then I have to copy the whole structure two times. But I can imagine that such a behavior is far easier to specify and guarantee the same behavior on many architectures. Thanks for your answer!"}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 3, "last_activity_date": 1528839420, "last_edit_date": 1528839420, "creation_date": 1528839102, "answer_id": 50826111, "question_id": 50823320, "link": "https://stackoverflow.com/questions/50823320/purpose-of-atomic-structures/50826111#50826111", "title": "Purpose of atomic structures", "body": "<p>You can not access individual members, but always the structure as a whole. Accessing parts of something that is meant to be an atomic unit, makes not much sense, I think.</p>\n\n<p>A typical use case for an atomic structure is the combination of two pointers, e.g. the head and tail of a list. To manipulate such a <code>struct</code> you would have to copy the current value from the atomic to a temporary, modify that, and then copy back. By that you'd always have a guarantee that the stored value is consistent at any time.</p>\n\n<p>Per default all such operations on a whole atomic <code>struct</code> have sequential consistency.</p>\n"}], "owner": {"reputation": 739, "user_id": 2359990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f7130d72f637bce50544029ccd6998a?s=128&d=identicon&r=PG", "display_name": "Max Maier", "link": "https://stackoverflow.com/users/2359990/max-maier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 1, "accepted_answer_id": 50826111, "answer_count": 2, "score": 4, "last_activity_date": 1528839420, "creation_date": 1528827091, "last_edit_date": 1528831169, "question_id": 50823320, "link": "https://stackoverflow.com/questions/50823320/purpose-of-atomic-structures", "title": "Purpose of atomic structures", "body": "<p>According to C11 \u00a7 6.5.2.3</p>\n\n<pre><code>Accessing a member of an atomic structure or union object results\nin undefined behavior.\n</code></pre>\n\n<p>This makes sense since you cannot access a whole structure in general. Still why is <code>_Atomic</code> then also a type qualifier and not only a type specifier?</p>\n\n<p>In other words what is the purpose of a structure which is qualified as <code>_Atomic</code>? I'm not allowed to either read or write to any element of it.</p>\n\n<pre><code>#include &lt;stdatomic.h&gt;\n\nstruct {\n    int x;\n} _Atomic foo;\n\nint main(void) {\n    foo.x = 42;     // write error\n    return foo.x;   // read error\n}\n</code></pre>\n\n<p>Both accesses of <code>foo.x</code> result in a warning/error in GCC/Clang---which is perfectly fine w.r.t. the C11 standard. Why would I want to qualifier then a structure as <code>_Atomic</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3270, "user_id": 3059385, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc876278926d67b3da29594601fdc82a?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Schneider", "link": "https://stackoverflow.com/users/3059385/christopher-schneider"}, "edited": false, "score": 1, "creation_date": 1528827292, "post_id": 50823284, "comment_id": 88651784, "body": "The stack? This is called a variadic function. I would guess this is undefined behavior. Check out the <a href=\"http://www.gnu.org/software/libc/manual/html_node/Variadic-Functions.html\" rel=\"nofollow noreferrer\">docs</a> to see how to properly use it."}], "answers": [{"comments": [{"owner": {"reputation": 52, "user_id": 9846205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "T\u1d0f\u1d0d\u1d07\u0280 W\u1d0f\u029f\u0299\u1d07\u0280\u0262", "link": "https://stackoverflow.com/users/9846205/t%e1%b4%8f%e1%b4%8d%e1%b4%87%ca%80-w%e1%b4%8f%ca%9f%ca%99%e1%b4%87%ca%80%c9%a2"}, "edited": false, "score": 0, "creation_date": 1528828006, "post_id": 50823394, "comment_id": 88652152, "body": "is there a way to do it without stdarg? I&#39;m more interested in how it&#39;s working."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 52, "user_id": 9846205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "T\u1d0f\u1d0d\u1d07\u0280 W\u1d0f\u029f\u0299\u1d07\u0280\u0262", "link": "https://stackoverflow.com/users/9846205/t%e1%b4%8f%e1%b4%8d%e1%b4%87%ca%80-w%e1%b4%8f%ca%9f%ca%99%e1%b4%87%ca%80%c9%a2"}, "edited": false, "score": 1, "creation_date": 1528828182, "post_id": 50823394, "comment_id": 88652250, "body": "@T\u1d0f\u1d0d\u1d07\u0280W\u1d0f\u029f\u0299\u1d07\u0280\u0262 You&#39;ll need to dig into your specific compiler internals to see how it works.  While integer arguments tend to be passed on the stack, floating point arguments tend to be passed via floating point registers.  You would need to write some assembly to do what you want."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1528827382, "creation_date": 1528827382, "answer_id": 50823394, "question_id": 50823284, "link": "https://stackoverflow.com/questions/50823284/getting-arguments-from-the-stack-in-c/50823394#50823394", "title": "Getting arguments from the stack in c", "body": "<p>The way arguments are passed to a function are implementation dependent.  To read variable arguments in a portable way, you need to use the <code>stdarg</code> family of functions.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdarg.h&gt;\n\nvoid Test1(double first_arg, ...)\n{\n    printf(\"arg[0]=%f\\n\", first_arg);\n\n    va_list ap;\n    va_start(ap, first_arg);\n    double arg1 = va_arg(ap, double);\n    printf(\"arg[1]=%f\\n\", arg1);\n    double arg2 = va_arg(ap, double);\n    printf(\"arg[2]=%f\\n\", arg2);\n    va_end(ap);\n}\n\nint main()\n{\n    printf(\"Test1:\\n\");\n    Test1(1.0, 2.0, 3.0);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 52, "user_id": 9846205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "T\u1d0f\u1d0d\u1d07\u0280 W\u1d0f\u029f\u0299\u1d07\u0280\u0262", "link": "https://stackoverflow.com/users/9846205/t%e1%b4%8f%e1%b4%8d%e1%b4%87%ca%80-w%e1%b4%8f%ca%9f%ca%99%e1%b4%87%ca%80%c9%a2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 50823394, "answer_count": 1, "score": 3, "last_activity_date": 1528827382, "creation_date": 1528826987, "question_id": 50823284, "link": "https://stackoverflow.com/questions/50823284/getting-arguments-from-the-stack-in-c", "title": "Getting arguments from the stack in c", "body": "<p>I just started to learn c and I was trying to create a function that gets it's arguments from the stack when I know all the arguments are from the same type, but it worked only for int.</p>\n\n<p>This is what I did:</p>\n\n<pre><code>void Test1(double first_arg, ...)\n{\n    double *a = &amp;first_arg;\n    printf(\"arg[0]: %f\\narg[1]: %f \\narg[2]: %f\\n\", a[0], a[1], a[2]);\n}\nvoid Test2(int first_arg, ...)\n{\n    int *a = &amp;first_arg;\n    printf(\"arg[0]: %d\\narg[1]: %d \\narg[2]: %d\\n\", a[0], a[1], a[2]);\n}\nint main()\n{\n    printf(\"Test1:\\n\");\n    Test1(1.0, 2.0, 3.0);\n    printf(\"\\nTest2:\\n\");\n    Test2(1, 2, 3);\n    return 0;\n}\n\nConsole:\nTest1:\narg[0]: 1.000000\narg[1]: 0.000000\narg[2]: 0.000000\n\nTest2:\narg[0]: 1\narg[1]: 2\narg[2]: 3\n</code></pre>\n\n<p>What am I missing here? And what should I do to fix this.</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1528827168, "post_id": 50823256, "comment_id": 88651711, "body": "Are you actually building a module object, etc.? Normally I&#39;d just assume that was all done correctly, but since you&#39;re saying you don&#39;t even know if you did the <code>setup.py</code> right, that doesn&#39;t seem like a safe assumption\u2026"}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1528827214, "post_id": 50823256, "comment_id": 88651733, "body": "Also,. what platform are you on that has Unix-style paths, but has <code>-lmath</code> instead of <code>-lm</code>, so this even compiles in the first place?"}, {"owner": {"reputation": 13, "user_id": 8877919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80fb3bd31ea2706113824548eba89e4e?s=128&d=identicon&r=PG&f=1", "display_name": "jamestheasiangenius", "link": "https://stackoverflow.com/users/8877919/jamestheasiangenius"}, "reply_to_user": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1528827586, "post_id": 50823256, "comment_id": 88651928, "body": "@abarnert macOS. It might still be -lm, I&#39;ll give that a try. But even without the math, it still errors when I return a list."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1528833468, "post_id": 50823256, "comment_id": 88654707, "body": "Also, why have you tagged this <code>c++</code> when your code is valid as C, invalid as C++, stored in a <code>.c</code> file, and compiled as C by distutils? Is your real code C++, or did you use the wrong tag? If the latter, fix it. If you <i>are</i> using C++, or even if you&#39;re just open to the possibility of switching, have you considered using PyCxx, boost::python, or one of the other wrappers that does all the annoying boilerplate stuff for you, automatically manages refcounts with RAII, etc.?"}, {"owner": {"reputation": 13, "user_id": 8877919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80fb3bd31ea2706113824548eba89e4e?s=128&d=identicon&r=PG&f=1", "display_name": "jamestheasiangenius", "link": "https://stackoverflow.com/users/8877919/jamestheasiangenius"}, "reply_to_user": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1528891561, "post_id": 50823256, "comment_id": 88677344, "body": "@abarnert I only tagged it as Python. Somehow it must\u2019ve auto tagged."}], "answers": [{"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1528832947, "post_id": 50823537, "comment_id": 88654459, "body": "I&#39;ve made a minor change to the formatting, putting a block of text in <code>&lt;sup&gt;</code> can cause accessibility problems."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1528833344, "post_id": 50823537, "comment_id": 88654651, "body": "@DietrichEpp It&#39;s a footnote, which isn&#39;t going to be interesting to most people. Displaying it in full-size is just distracting. Is there a better way to display it in unobtrusive small text that works on SO that doesn&#39;t cause the accessibility problems of using <code>sub</code>?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1528836643, "post_id": 50823537, "comment_id": 88656135, "body": "I don&#39;t have a good answer for that. Feel free to revert the edit, the main reason I commented was so you would have a chance to revert if you like."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1528837620, "post_id": 50823537, "comment_id": 88656492, "body": "@DietrichEpp I found <a href=\"https://meta.stackexchange.com/a/253759/230882\">my own answer on a feature request from over 3 years ago</a>, and two years later <a href=\"https://meta.stackexchange.com/a/302182/230882\">that feature request was declined</a>, accepting that the <code>sub</code> workaround is, while ugly, good enough for SO."}, {"owner": {"reputation": 13, "user_id": 8877919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80fb3bd31ea2706113824548eba89e4e?s=128&d=identicon&r=PG&f=1", "display_name": "jamestheasiangenius", "link": "https://stackoverflow.com/users/8877919/jamestheasiangenius"}, "edited": false, "score": 0, "creation_date": 1528891689, "post_id": 50823537, "comment_id": 88677403, "body": "Thanks, I\u2019ll give it a try when I get to school today!"}, {"owner": {"reputation": 13, "user_id": 8877919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80fb3bd31ea2706113824548eba89e4e?s=128&d=identicon&r=PG&f=1", "display_name": "jamestheasiangenius", "link": "https://stackoverflow.com/users/8877919/jamestheasiangenius"}, "edited": false, "score": 0, "creation_date": 1528893010, "post_id": 50823537, "comment_id": 88678299, "body": "@abarnert Great, you were right about the <code>PyObject *pos = PyTuple_Pack(tl, x, y);</code>. Seems like it&#39;s a trap for anyone not used to anything but Python :)"}, {"owner": {"reputation": 592, "user_id": 6672815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6c8d74588b5dbf028aeed0e33b8ee5?s=128&d=identicon&r=PG&f=1", "display_name": "virgesmith", "link": "https://stackoverflow.com/users/6672815/virgesmith"}, "edited": false, "score": 1, "creation_date": 1528894180, "post_id": 50823537, "comment_id": 88679089, "body": "FWIW -2.0 in bit representation is actually 0xc000000000000000 (little-endian)."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "reply_to_user": {"reputation": 592, "user_id": 6672815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6c8d74588b5dbf028aeed0e33b8ee5?s=128&d=identicon&r=PG&f=1", "display_name": "virgesmith", "link": "https://stackoverflow.com/users/6672815/virgesmith"}, "edited": false, "score": 0, "creation_date": 1528913150, "post_id": 50823537, "comment_id": 88690689, "body": "@virgesmith Oops; forgot that x86 stores floats in big-endian but ints (and pointers) in little-endian\u2026 I&#39;ll edit; thanks."}], "tags": [], "owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "is_accepted": true, "score": 1, "last_activity_date": 1528913196, "last_edit_date": 1528913196, "creation_date": 1528827918, "answer_id": 50823537, "question_id": 50823256, "link": "https://stackoverflow.com/questions/50823256/python-c-extension-throws-segmentation-fault/50823537#50823537", "title": "Python C Extension throws Segmentation Fault", "body": "<p>There may be multiple problems here, but, assuming the module boilerplate is correct (you haven't included it), and your setup.py is correct to actually build the code (it isn't as posted), and you're calling this in the obvious way, there's at least one likely segfault here:</p>\n\n<pre><code>PyObject *pos = PyTuple_Pack(tl, x, y);\n</code></pre>\n\n<p>As <a href=\"https://docs.python.org/3/c-api/tuple.html#c.PyTuple_Pack\" rel=\"nofollow noreferrer\"><code>PyTuple_Pack</code></a> documents:</p>\n\n<blockquote>\n  <p>Return a new tuple object of size <em>n</em>, or <em>NULL</em> on failure. The tuple values are initialized to the subsequent <em>n</em> C arguments <strong>pointing to Python objects</strong>.</p>\n</blockquote>\n\n<p>You're not passing it pointers to Python objects, you're passing it doubles. So, it will try to interpret each double as a pointer, which is very likely to segfault.<sup>1</sup></p>\n\n<p>You either need to construct two Python <code>float</code> objects with <a href=\"https://docs.python.org/3/c-api/float.html#c.PyFloat_FromDouble\" rel=\"nofollow noreferrer\"><code>PyFloat_FromDouble</code></a>, or <a href=\"https://docs.python.org/3/c-api/arg.html#c.Py_BuildValue\" rel=\"nofollow noreferrer\"><code>Py_BuildValue</code></a> to convert them on the fly:</p>\n\n<pre><code>PyObject *pos = Py_BuildValue(\"(ff)\", x, y);\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://gist.github.com/abarnert/c00ea060364ae6cb88a687c5886746a8\" rel=\"nofollow noreferrer\">A completed and cleaned-up version with this fix</a> seems to work.</p>\n\n<hr>\n\n<p><sub>1. If you don't know enough C, but want to know why it crashes: Assuming 64-bit here, you're asking it to interpret the 64 bits of the double as a pointer. For, say, <code>-2.0</code>, that's a pointer to <code>0xC000000000000000</code>. Which is likely to not be in allocated memory, much less a pointer to a valid <code>PyObject</code> struct whose pointers themselves point to allocated memory, and even if all such pages are allocated, it's likely that one of them pages will be readonly so, e.g., a reference count increment fails.</sub></p>\n"}], "owner": {"reputation": 13, "user_id": 8877919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80fb3bd31ea2706113824548eba89e4e?s=128&d=identicon&r=PG&f=1", "display_name": "jamestheasiangenius", "link": "https://stackoverflow.com/users/8877919/jamestheasiangenius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 50823537, "answer_count": 1, "score": 1, "last_activity_date": 1528913196, "creation_date": 1528826877, "last_edit_date": 1528891726, "question_id": 50823256, "link": "https://stackoverflow.com/questions/50823256/python-c-extension-throws-segmentation-fault", "title": "Python C Extension throws Segmentation Fault", "body": "<pre><code>#include &lt;Python.h&gt;\n#include &lt;math.h&gt;\n\nstatic PyObject* interpolate(PyObject* self, PyObject* args) {\n    const Py_ssize_t tl = 2;\n    const Py_ssize_t ll = 0;\n    int nx, ny, angle, distance;\n    if (!PyArg_ParseTuple(args, \"iiii\", &amp;nx, &amp;ny, &amp;angle, &amp;distance)) {\n        return NULL;\n    }\n    PyObject* pos_list = PyList_New(ll);\n    for (int i = 0; i &lt; distance; i++) {\n        double x = -i * cos(angle * M_PI / 180);\n        double y = -i * sin(angle * M_PI / 180);\n        PyObject *pos = PyTuple_Pack(tl, x, y);\n        PyList_Append(pos_list, pos);\n    }\n    return pos_list;\n}\n</code></pre>\n\n<p>Code keeps throwing a segmentation fault when I import the module from Python. Not too sure why this is happening as I'm really new to C and C Extensions. I'm not sure if I'm doing my setup.py code correctly either. I think the error is related to my returning the pos_list variable and math.h not being included properly. When I removed the math.h sin and cos stuff and switched to Py_BuildValue a simple integer, it works.</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nmodule1 = Extension('gameMath',\n                    sources = ['interpolate.c'],\n                    include_dirs = ['/usr/include'],\n                    libraries = ['math'])\nsetup (name = 'gameMath',\n        version = '1.0',\n        description = 'game math',\n        ext_modules = [module1])\n</code></pre>\n"}, {"tags": ["c", "variadic-functions"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 4, "creation_date": 1528826745, "post_id": 50823215, "comment_id": 88651498, "body": "<code>stdarg.h</code> is of no use here. The function has to have at least one (plain) parameter for it to work."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1528826795, "post_id": 50823215, "comment_id": 88651523, "body": "The first one is deprecated since C99, or am I wrong?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1528826946, "post_id": 50823215, "comment_id": 88651599, "body": "I think you&#39;re right that the first one is deprecated. And the second one doesn&#39;t compile. So this question needs some work."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1528827270, "post_id": 50823215, "comment_id": 88651763, "body": "<code>int f() {...}</code> <i>defines</i> a function taking 0 arguments. This is not the same as <code>int f();</code> which <i>declares</i> a function taking an unspecified number of arguments."}, {"owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1528829505, "post_id": 50823215, "comment_id": 88652921, "body": "@DeiDei What exactly is the feature that was deprecated in C99? Just declaring a function with unspecified parameters or defining a function with empty parameter list? Gcc with the appropriate flags seems to accept both of these features."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1528828046, "post_id": 50823411, "comment_id": 88652178, "body": "If you define a function with <code>int f() { }</code>, which, as you say, indicates it takes no arguments, and call it using <code>f(1, 2)</code> for example, then what can that lead to? The function will return successfully assuming it doesn&#39;t need the actual arguments?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 2, "creation_date": 1528830663, "post_id": 50823411, "comment_id": 88653452, "body": "@bjorn93: The behavior is undefined (<a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011 online draft</a>, 6.5.2.2/6)."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 5, "last_activity_date": 1528827430, "creation_date": 1528827430, "answer_id": 50823411, "question_id": 50823215, "link": "https://stackoverflow.com/questions/50823215/variadic-function-f-vs-f-in-c/50823411#50823411", "title": "Variadic function f() vs. f(...) in C", "body": "<p>An empty parameter list in a function <em>declaration</em> indicates that the function takes an unspecified number of arguments (which is not the same as a <em>variable</em> number of arguments).  An empty parameter list in a function <em>definition</em> (such as in the first definition of <code>f</code>) indicates that the function takes <em>no</em> arguments.  This is an obsolescent style and should not be used - to indicate that a function takes no parameters, use <code>void</code> as the identifier list.  </p>\n\n<p>As of C89, a variadic function declarator must have <em>at least</em> one fixed parameter, followed by the <code>...</code>.  So the second definition of <code>f</code> won't work either.</p>\n\n<pre><code>int f( void ) // f takes no arguments\n{\n  // do something\n}\n\nint f( T fixed, ... ) // one fixed parameter of some type, additional parameters as needed\n{\n  // do something\n}\n</code></pre>\n\n<p><code>printf</code> is as good an example of a variadic function in the standard library as any - its prototype is</p>\n\n<pre><code>int printf( const char *fmt, ... );\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 50823411, "answer_count": 1, "score": 2, "last_activity_date": 1528829616, "creation_date": 1528826634, "last_edit_date": 1528829616, "question_id": 50823215, "link": "https://stackoverflow.com/questions/50823215/variadic-function-f-vs-f-in-c", "title": "Variadic function f() vs. f(...) in C", "body": "<p>What is the difference between the following two variadic function definitions?</p>\n\n<pre><code>int f()\n{\n    /* function definition */\n}\n\nint f(...)\n{\n    /* function definition */\n}\n</code></pre>\n\n<p><code>f()</code> is actually defined as a variadic function. I'm also assuming <code>&lt;stdarg.h&gt;</code> can be included and used.</p>\n"}, {"tags": ["c", "linux", "macos", "debugging", "gdb"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1528828513, "post_id": 50823089, "comment_id": 88652424, "body": "<code>step</code> jumps to the next source line. gdb probably doesn&#39;t consider assembly to be source."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1528828616, "post_id": 50823089, "comment_id": 88652484, "body": "Try using &quot;stepi&quot; to go through assembly."}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1528901746, "post_id": 50823089, "comment_id": 88684379, "body": "It doesn&#39;t work"}], "answers": [{"comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "reply_to_user": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1528830109, "post_id": 50823745, "comment_id": 88653199, "body": "It doesn&#39;t work as in it does that same thing as step? Or something else?"}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1528874599, "post_id": 50823745, "comment_id": 88666777, "body": "Sorry for the delay, it does the same thing of step, it jumps the get function until swap."}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1528876313, "post_id": 50823745, "comment_id": 88667744, "body": "this is the output when I use stepi,I changed something now it see the function get but doesn&#39;t show me what&#39;s happening     [ (gdb) stepi 10\t\tshort c= get(a,b); (gdb)  0x00001eb5\t10\t\tshort c= get(a,b); ]"}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1528876699, "post_id": 50823745, "comment_id": 88668004, "body": "When I type &quot;info locals&quot; while gdb is in get it says :&quot;No symbol table info available.&quot;"}], "tags": [], "owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "is_accepted": false, "score": 4, "last_activity_date": 1611073690, "last_edit_date": 1611073690, "creation_date": 1528828735, "answer_id": 50823745, "question_id": 50823089, "link": "https://stackoverflow.com/questions/50823089/gdb-doesnt-step-into-a-function-when-use-command-s/50823745#50823745", "title": "GDB doesn&#39;t step into a function when use command &quot;s&quot;", "body": "<p>From <em><a href=\"http://sourceware.org/gdb/onlinedocs/gdb/Continuing-and-Stepping.html\" rel=\"nofollow noreferrer\">Continuing and Stepping</a></em> (emphasis mine)</p>\n<blockquote>\n<p><em>step</em></p>\n<p>Continue running your program until control reaches a different source line, then stop it and return control to GDB. This command is abbreviated s.</p>\n<p>Warning: <strong>If you use the step command while control is within a function that was compiled without debugging information, execution proceeds until control reaches a function that does have debugging information.</strong> Likewise, it will not step into a function which is compiled without debugging information. <strong>To step through functions without debugging information, use the stepi command</strong>, described below.</p>\n</blockquote>\n<p>You can use the <code>stepi</code> command instead:</p>\n<blockquote>\n<p><em>stepi</em></p>\n<p><em>stepi arg</em></p>\n<p><em>si</em></p>\n<p>Execute one machine instruction, then stop and return to the debugger.</p>\n<p>It is often useful to do \u2018display/i $pc\u2019 when stepping by machine instructions. This makes GDB automatically display the next instruction to be executed, each time your program stops. See Automatic Display.</p>\n<p>An argument is a repeat count, as in step.</p>\n</blockquote>\n"}], "owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1838, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1611073690, "creation_date": 1528826124, "last_edit_date": 1611073625, "question_id": 50823089, "link": "https://stackoverflow.com/questions/50823089/gdb-doesnt-step-into-a-function-when-use-command-s", "title": "GDB doesn&#39;t step into a function when use command &quot;s&quot;", "body": "<p>I have a problem with GDB. When I use &quot;s&quot; to step into a function called from the <code>main</code> function, GDB jumps to another function without showing me the function that I need.</p>\n<p>To be clear, I use step here:</p>\n<p>In file <em>main.c</em>:</p>\n<pre><code>short c = get(a, b);\n</code></pre>\n<p>Now get has a 36 lines code and at line 27 it calls an other function &quot;swap&quot; here:</p>\n<p>In file <em>get.s</em>:</p>\n<pre><code>call _swap;\n</code></pre>\n<p>When I use step (s) with GDB on &quot;get&quot;, it jumps all of the <em>get</em> function and it shows me the <em>_swap</em> function.\nThese are three different files: <em>main.c</em>, <em>get.s</em>, and *swap.c compiled in this way:</p>\n<pre><code>gcc -g -m32 main.c swap.c get.s -o IA-main\n</code></pre>\n<p>-m32 because <em>get.s</em> is IA-32 assembly. Why does it jump the &quot;get&quot; function and show me only &quot;_swap&quot;?</p>\n<p>I work on <a href=\"https://en.wikipedia.org/wiki/MacOS_Sierra\" rel=\"nofollow noreferrer\">Mac OS X v10.12.6</a> (Sierra), so GDB is a little annoying.</p>\n"}, {"tags": ["c", "binary", "integer"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528826394, "post_id": 50823034, "comment_id": 88651300, "body": "You don&#39;t even need to calculate the number of digits in advance. You can write digits from <code>num % 2</code> into a buffer until <code>(num &#47;= 2) == 0</code>, and then print them in reverse order, or, store them in a buffer in reverse order."}, {"owner": {"reputation": 43, "user_id": 9895795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57e6d1d980891c1c684c8ed61ea94ca?s=128&d=identicon&r=PG&f=1", "display_name": "RONALDO69", "link": "https://stackoverflow.com/users/9895795/ronaldo69"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528826602, "post_id": 50823034, "comment_id": 88651423, "body": "@WeatherVane thanks, i was trying to do in the forward way..did it using the reverse way correctly.."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528826659, "post_id": 50823034, "comment_id": 88651453, "body": "I was editing as you typed: you can store them in reverse order without needing to know how many. Start at the end of a large enough buffer, then print the buffer from where you stopped. If that was at <code>binary[90]</code> then you can <code>printf(&quot;%s&quot;, binary + 90);</code> But you need a <code>NUL</code> terminator, and also to add <code>&#39;0&#39;</code> to each digit as it goes into the buffer."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9895795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57e6d1d980891c1c684c8ed61ea94ca?s=128&d=identicon&r=PG&f=1", "display_name": "RONALDO69", "link": "https://stackoverflow.com/users/9895795/ronaldo69"}, "edited": false, "score": 0, "creation_date": 1528826495, "post_id": 50823093, "comment_id": 88651353, "body": "why is floating point calculation wrong? Is log function not implemented correctly in mat.h..any replacements? could you give an example of undershooting...here i am not getting it.."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 43, "user_id": 9895795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57e6d1d980891c1c684c8ed61ea94ca?s=128&d=identicon&r=PG&f=1", "display_name": "RONALDO69", "link": "https://stackoverflow.com/users/9895795/ronaldo69"}, "edited": false, "score": 0, "creation_date": 1528826805, "post_id": 50823093, "comment_id": 88651529, "body": "You\u2019ve seen an example in your code! Get the debugger out. The natural logarithm function is more than good enough for very many scientific applications, but it could be out on the 15th significant figure or perhaps worse than that, but your use of ceil essentially converts a smooth function to a discontinuous one, and that\u2019s where all hell breaks loose."}, {"owner": {"reputation": 43, "user_id": 9895795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57e6d1d980891c1c684c8ed61ea94ca?s=128&d=identicon&r=PG&f=1", "display_name": "RONALDO69", "link": "https://stackoverflow.com/users/9895795/ronaldo69"}, "edited": false, "score": 1, "creation_date": 1528827144, "post_id": 50823093, "comment_id": 88651698, "body": "thanks, but the log2 was a mistake..floor(log2) works great"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 43, "user_id": 9895795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57e6d1d980891c1c684c8ed61ea94ca?s=128&d=identicon&r=PG&f=1", "display_name": "RONALDO69", "link": "https://stackoverflow.com/users/9895795/ronaldo69"}, "edited": false, "score": 0, "creation_date": 1528827284, "post_id": 50823093, "comment_id": 88651776, "body": "@RONALDO69 <code>round</code> might be better than <code>floor</code> or <code>ceil</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1528827333, "post_id": 50823093, "comment_id": 88651804, "body": "Be very very careful when using logs to count digits. I like the answer you accepted but it could bite you. That said, round would nail this."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1528827371, "last_edit_date": 1528827371, "creation_date": 1528826135, "answer_id": 50823093, "question_id": 50823034, "link": "https://stackoverflow.com/questions/50823034/integer-to-binary-conversion-program-fails-for-some-inputs/50823093#50823093", "title": "Integer to Binary Conversion Program Fails for Some Inputs", "body": "<p>Your use of a logarithmic function to compute the number of digits in conjunction with ceil will suffer due to floating point undershoot.</p>\n\n<p>A more reliable way of calculating the number of binary digits is to divide by two repeatedly until zero is attained.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1528827188, "post_id": 50823276, "comment_id": 88651722, "body": "Ha. Good spot. Even so, there is the potential for undershoot. Less likely with binary floating point, but still be very careful. I\u2019ll upvote this answer though."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1528827221, "post_id": 50823276, "comment_id": 88651737, "body": "<code>round</code> might be better than <code>ceil</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528827284, "post_id": 50823276, "comment_id": 88651775, "body": "@WeatherVane: Indeed it would."}], "tags": [], "owner": {"reputation": 182, "user_id": 1988355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b6522568728b68ea9d7ea5d22b7115?s=128&d=identicon&r=PG", "display_name": "DGounaris", "link": "https://stackoverflow.com/users/1988355/dgounaris"}, "is_accepted": true, "score": 2, "last_activity_date": 1528826951, "creation_date": 1528826951, "answer_id": 50823276, "question_id": 50823034, "link": "https://stackoverflow.com/questions/50823034/integer-to-binary-conversion-program-fails-for-some-inputs/50823276#50823276", "title": "Integer to Binary Conversion Program Fails for Some Inputs", "body": "<p>C's log function gives result with a base of e, not 2. This is why some numbers give unexpected result in your program since you calculate using that. There is a function <a href=\"http://www.cplusplus.com/reference/cmath/log2/\" rel=\"nofollow noreferrer\">log2</a> which is what you need i think.</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 8385813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mP4pQ.jpg?s=128&g=1", "display_name": "Arnab Sinha", "link": "https://stackoverflow.com/users/8385813/arnab-sinha"}, "is_accepted": false, "score": 0, "last_activity_date": 1528827168, "creation_date": 1528827168, "answer_id": 50823341, "question_id": 50823034, "link": "https://stackoverflow.com/questions/50823034/integer-to-binary-conversion-program-fails-for-some-inputs/50823341#50823341", "title": "Integer to Binary Conversion Program Fails for Some Inputs", "body": "<p>The first mistake is to use log(n), which calculates log of n base e. </p>\n\n<p>Instead use log2(n)</p>\n\n<p>Hope it helps. :-)</p>\n"}], "owner": {"reputation": 43, "user_id": 9895795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57e6d1d980891c1c684c8ed61ea94ca?s=128&d=identicon&r=PG&f=1", "display_name": "RONALDO69", "link": "https://stackoverflow.com/users/9895795/ronaldo69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 50823276, "answer_count": 3, "score": 3, "last_activity_date": 1528827371, "creation_date": 1528825918, "question_id": 50823034, "link": "https://stackoverflow.com/questions/50823034/integer-to-binary-conversion-program-fails-for-some-inputs", "title": "Integer to Binary Conversion Program Fails for Some Inputs", "body": "<p>I wrote code for getting binary form of an integer. It works well for inputs like 1 or 10. However, it is failing for inputs like 256. (It gives 0000000 s output and misses the one).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint number_of_binary_digits_required(int n){\n\nreturn ceil(log(n))+1;\n\n}\n\nvoid print_array(int * a, int n){\n\n    int i = 0;\n    for (;i&lt;n;i++){\n        printf(\"%d\\t\", a[i]);\n    }\n\n}\n\n\nint main(){\n\nint num = 256;\nint binary[100];\nint n = number_of_binary_digits_required(num);\nint bin_digits = n-1;\n\nwhile (num){\n\n   int temp = num%2;\n   num = num / 2;\n   binary[bin_digits] = temp;\n   //printf(\"%d\\n\", bin_digits);\n   bin_digits--;\n\n}\n\nprint_array(binary, n);\n\n//printf(\"%d\", number_of_binary_digits_required(num));\n//for(bin_digits = 0;bin_digits &lt; number_of_binary_digits_required(num);bin_digits++)\n//printf(\"%d\",binary[bin_digits]);\n\n\n}\n</code></pre>\n\n<p>Why is the issue coming and how to resolve it?</p>\n\n<p>Thanks you!</p>\n"}, {"tags": ["c", "printf", "scanf"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1528824351, "post_id": 50822596, "comment_id": 88650213, "body": "<code>scanf</code> returns a value from the function: the number of items converted, as the man page will tell you. The man page should be your first stop with any function you use."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1528824446, "post_id": 50822596, "comment_id": 88650261, "body": "You did not read anything on scanf(), did you? <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/io/fscanf</a>"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1528824854, "post_id": 50822596, "comment_id": 88650506, "body": "What answer do you get when you type in a non-digit character?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 8547725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fe457c19964e2bc29bfa8f3fe60b78?s=128&d=identicon&r=PG&f=1", "display_name": "leet101", "link": "https://stackoverflow.com/users/8547725/leet101"}, "edited": false, "score": 0, "creation_date": 1528824829, "post_id": 50822668, "comment_id": 88650488, "body": "The intention of my question was just to know the reason behind the result...Thank you"}], "tags": [], "owner": {"reputation": 1522, "user_id": 8792891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a662505d48981335d92196c59d90758?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8792891/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1528825947, "last_edit_date": 1528825947, "creation_date": 1528824456, "answer_id": 50822668, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822668#50822668", "title": "How does a scanf() inside printf() work?", "body": "<p>The documentation of scanf() says the return value is:</p>\n\n<p><code>Number of receiving arguments successfully assigned (which may be zero in case a matching failure occurred before the first receiving argument was assigned), or EOF if input failure occurs before the first receiving argument was assigned.</code></p>\n\n<p>The code you would instead want is: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n\n    int n;\n    scanf(\"%d\",&amp;n);\n    printf(\"%d\\n\",scanf(\"%d\",&amp;n));\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 8547725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fe457c19964e2bc29bfa8f3fe60b78?s=128&d=identicon&r=PG&f=1", "display_name": "leet101", "link": "https://stackoverflow.com/users/8547725/leet101"}, "edited": false, "score": 0, "creation_date": 1528824797, "post_id": 50822671, "comment_id": 88650462, "body": "The intention of my question was just to know the reason behind the result...Thank you"}], "tags": [], "owner": {"reputation": 4513, "user_id": 3416272, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xL2ZJ.jpg?s=128&g=1", "display_name": "Md Johirul Islam", "link": "https://stackoverflow.com/users/3416272/md-johirul-islam"}, "is_accepted": false, "score": 1, "last_activity_date": 1528824508, "last_edit_date": 1528824508, "creation_date": 1528824464, "answer_id": 50822671, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822671#50822671", "title": "How does a scanf() inside printf() work?", "body": "<p>In your program <code>scanf</code> returns 1 when successfully some value is taken by <code>scanf</code> into n and that is why you are always getting 1 from your <code>printf(\"%d\\n\",scanf(\"%d\",&amp;n));</code>.\nYou should modify your code like following</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n\n        int n;\n        scanf(\"%d\",&amp;n);\n        printf(\"%d\\n\",n);\n        return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528824677, "post_id": 50822700, "comment_id": 88650397, "body": "The input format spec is <code>%d</code>. If an integer cannot be extracted from the input, <code>scanf</code> returns <code>0</code> - that is what the return value is for. That is not &quot;always 1&quot;."}, {"owner": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1528824912, "post_id": 50822700, "comment_id": 88650543, "body": "@WeatherVane I assumed that the author of question will always input a legal <code>%d</code>... It&#39;s my mistake, thank you."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1528824976, "post_id": 50822700, "comment_id": 88650582, "body": "Yes, the purpose of the return value is to detect if user did not enter a value that can be converted to the type."}], "tags": [], "owner": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "is_accepted": false, "score": 1, "last_activity_date": 1528824680, "last_edit_date": 1592644375, "creation_date": 1528824580, "answer_id": 50822700, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822700#50822700", "title": "How does a scanf() inside printf() work?", "body": "<p>In <a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\"><code>man scanf</code></a>,</p>\n<blockquote>\n<p>Return Value</p>\n<p>These functions return the number of input items successfully matched and assigned, which can be fewer than provided for, or even zero in the event of an early matching failure.</p>\n</blockquote>\n<p>In your program, it just match 1 input, so the function <code>scanf</code> will return 1, if you input an legal value that can match a <code>%d</code>, else it will return 0.</p>\n<p>In your situation, you might always satisfy this requirements, so it <em>always</em> return 1.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1528824962, "last_edit_date": 1528824962, "creation_date": 1528824657, "answer_id": 50822717, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822717#50822717", "title": "How does a scanf() inside printf() work?", "body": "<p>The program is just about exactly equivalent to</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int n;\n    int r = scanf(\"%d\", &amp;n);\n    printf(\"%d\\n\", r);\n    return 0;\n}\n</code></pre>\n\n<p>So if you run this program, and if you type (say) 45, then <code>scanf</code> will read the 45, and assign it to <code>n</code>, and return 1 to tell you it has done so.  The program prints the value 1 returned by <code>scanf</code> (which is <em>not</em> the number <em>read</em> by <code>scanf</code>!).</p>\n\n<p>Try running the program and typing \"A\", instead.  In that case <code>scanf</code> should return, and your program should print, 0.</p>\n\n<p>Finally, if you can, try running the program and giving it no input at all.  If you're on Unix, Mac, or Linux, try typing control-D immediately after running your program (that is, without typing anything else), or run it with the input redirected:</p>\n\n<pre><code>myprog &lt; /dev/null\n</code></pre>\n\n<p>On Windows, you might be able to type control-Z (perhaps followed by the Return key) to generate an end-of-file conditions.  In any of these cases, <code>scanf</code> should return, and your program should print, -1.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 8547725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fe457c19964e2bc29bfa8f3fe60b78?s=128&d=identicon&r=PG&f=1", "display_name": "leet101", "link": "https://stackoverflow.com/users/8547725/leet101"}, "edited": false, "score": 0, "creation_date": 1528825016, "post_id": 50822762, "comment_id": 88650605, "body": "The intention of my question was just to know the reason behind the result as I encountered such an objective question in a book...Thank you"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 113, "user_id": 8547725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fe457c19964e2bc29bfa8f3fe60b78?s=128&d=identicon&r=PG&f=1", "display_name": "leet101", "link": "https://stackoverflow.com/users/8547725/leet101"}, "edited": false, "score": 2, "creation_date": 1528825289, "post_id": 50822762, "comment_id": 88650756, "body": "@jishnupramod, If I were you, I would drop that book. A book should teach principles and fundamental aspects of the language. Using questions like that is what I call &quot;smart-assery&quot;. It&#39;s not teaching."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 4, "last_activity_date": 1528824835, "creation_date": 1528824835, "answer_id": 50822762, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822762#50822762", "title": "How does a scanf() inside printf() work?", "body": "<p>I suspect you wanted to use</p>\n\n<pre><code>int n;\nscanf(\"%d\", &amp;n);\nprintf(\"%d\\n\", n);\n</code></pre>\n\n<p>but what you wrote is equivalent to</p>\n\n<pre><code>int n;\nint num = scanf(\"%d\", &amp;n); // num is the number of successful reads.\nprintf(\"%d\\n\", num);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1528825797, "post_id": 50822818, "comment_id": 88650990, "body": "A more accurate term is &quot;successful conversions&quot;."}, {"owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528828690, "post_id": 50822818, "comment_id": 88652524, "body": "True. I will change it."}], "tags": [], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "is_accepted": false, "score": 1, "last_activity_date": 1528828737, "last_edit_date": 1528828737, "creation_date": 1528825057, "answer_id": 50822818, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822818#50822818", "title": "How does a scanf() inside printf() work?", "body": "<p><code>scanf</code> returns number of successful conversions. \nTry changing your <code>scanf</code> to as shown below.... \nyou will notice printing 2 after inputting two valid integers.</p>\n\n<pre><code>int n1 =0;\nint n2 =0;\nint i = scanf(\"%d %d\",&amp;n1,&amp;n2);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7004, "user_id": 6615163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSNqz.png?s=128&g=1", "display_name": "hygull", "link": "https://stackoverflow.com/users/6615163/hygull"}, "is_accepted": true, "score": 1, "last_activity_date": 1528825330, "creation_date": 1528825330, "answer_id": 50822892, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822892#50822892", "title": "How does a scanf() inside printf() work?", "body": "<p><strong>@jishnu</strong>, good question and the output which you're getting is also correct as you are only reading one value from standard input (<code>stdin</code>).</p>\n\n<blockquote>\n  <p><code>scanf()</code> reads the values supplied from standard input and return number of values successfully read from standard input (keyboard).</p>\n  \n  <p>In C, <code>printf()</code> returns the number of characters successfully written on the output and <code>scanf()</code> returns number of items successfully read. Visit <a href=\"https://www.geeksforgeeks.org/g-fact-10/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/g-fact-10/</a> and read more about it.</p>\n</blockquote>\n\n<p>Have a look at the following 2 code samples.</p>\n\n<blockquote>\n  <p>Try the below code online at <a href=\"http://rextester.com/HNJE76121\" rel=\"nofollow noreferrer\">http://rextester.com/HNJE76121</a>.\n      //clang 3.8.0</p>\n</blockquote>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n\n    int n, n2;\n    printf(\"%d\\n\",scanf(\"%d%d\",&amp;n, &amp;n2));   //2\n    return 0;\n}\n</code></pre>\n\n<p>In your code, <code>scanf()</code> is reading only 1 value from the keyboad (<code>stdin</code>), that is why output is 1.</p>\n\n<pre><code>//clang 3.8.0\n\n#include&lt;stdio.h&gt;\nint main(){\n\n    int n;\n    printf(\"%d\\n\",scanf(\"%d\",&amp;n));   //1\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1528825993, "last_edit_date": 1528825993, "creation_date": 1528825654, "answer_id": 50822968, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50822968#50822968", "title": "How does a scanf() inside printf() work?", "body": "<p><code>scanf</code> returns the number of successful conversion and assignments.  In your case, you're only scanning for one argument, so <code>scanf</code> will either return a <code>1</code> on success, a <code>0</code> on a <em>matching failure</em> (where the first non-whitespace input character is not a decimal digit), or <code>EOF</code> on end-of-file or error.  </p>\n\n<p>When you call <code>printf</code>, each of its arguments is <em>evaluated</em> and the result is passed to the function.  In this case, evaluation involves calling the <code>scanf</code> function.  The value returned by <code>scanf</code> is then passed to <code>printf</code>.  </p>\n\n<p>It's essentially the same as writing</p>\n\n<pre><code>int count = scanf( \"%d\", &amp;n );\nprintf( \"%d\\n\", count );\n</code></pre>\n\n<p>For giggles, see what happens when you enter <code>abc</code> or type <kbd>Ctrl</kbd><kbd>D</kbd> (or <kbd>Ctrl</kbd><kbd>Z</kbd> on Windows).</p>\n\n<p>Note that <code>printf</code> <em>also</em> returns a value (the number of bytes written to the stream), so you can write something ridiculous<sup>1</sup> like</p>\n\n<pre><code>printf( \"num bytes printed = %d\\n\", printf( \"num items read = %d\\n\", scanf( \"%d\", &amp;n ) ) );\n</code></pre>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>Joke.  Don't do that.\n</ol>\n\n<p></sup></p>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528840460, "post_id": 50824028, "comment_id": 88657459, "body": "You mean &quot;Return values&quot;, not &quot;Outputs&quot;. What you are trying to say with the implicit-declaration-warning is unclear to me."}, {"owner": {"reputation": 90, "user_id": 9521356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqRng.jpg?s=128&g=1", "display_name": "Sachin Liyanage", "link": "https://stackoverflow.com/users/9521356/sachin-liyanage"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1528862198, "post_id": 50824028, "comment_id": 88662040, "body": "Yeah, It\u2019s the return value !"}], "tags": [], "owner": {"reputation": 90, "user_id": 9521356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqRng.jpg?s=128&g=1", "display_name": "Sachin Liyanage", "link": "https://stackoverflow.com/users/9521356/sachin-liyanage"}, "is_accepted": false, "score": 0, "last_activity_date": 1528862247, "last_edit_date": 1528862247, "creation_date": 1528829771, "answer_id": 50824028, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/50824028#50824028", "title": "How does a scanf() inside printf() work?", "body": "<p>If you use this code as an example,\nIt shows : warning: implicit declaration of function 'printf' [-Wimplicit-function declaration]</p>\n\n<pre><code>int main()\n{\nchar b[40]; \nprintf(\" %d\", scanf(\"%s\", b));\ngetchar();\n} \n</code></pre>\n\n<p>Return value : -1</p>\n\n<p>Outputs of the functions like <strong>printf</strong> and <strong>scanf</strong> can be use as a parameter to another function.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10014292, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A-A5ZojrHvg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0UQTyqWICOLZMOtxkfLHeforkx0g/mo/photo.jpg?sz=128", "display_name": "Hardik Khatri", "link": "https://stackoverflow.com/users/10014292/hardik-khatri"}, "is_accepted": false, "score": 0, "last_activity_date": 1530358877, "last_edit_date": 1530358877, "creation_date": 1530354492, "answer_id": 51114061, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/51114061#51114061", "title": "How does a scanf() inside printf() work?", "body": "<p><code>scanf()</code> is a function which is integer return type function. It returns total number of conversion characters in it. For ex if a statement is written as :</p>\n\n<pre><code>int c;\nc=scanf(\"%d %d %d\");\nprintf(\"%d\",c);\n</code></pre>\n\n<p>Then output of this program will be <code>3</code>.\nThis is because <code>scanf()</code> is integer return type function and it returns total no of conversion characters, thus being <code>3</code> conversion characters it will return <code>3</code> to <code>c</code>.\nSo in your code <code>scanf()</code> returns <code>1</code> to <code>printf()</code> and thus output of program is <code>1</code>.\nThis is because if more than one statement are used in <code>printf()</code> execution orders starts from right to left.\nThus <code>scanf()</code> is executed first followed by <code>printf()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 10326781, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wCC7tlYRpQA/AAAAAAAAAAI/AAAAAAAAAA8/AdpBgQhSDNM/photo.jpg?sz=128", "display_name": "Saptarshi das", "link": "https://stackoverflow.com/users/10326781/saptarshi-das"}, "is_accepted": false, "score": 1, "last_activity_date": 1606221501, "creation_date": 1606221501, "answer_id": 64986695, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work/64986695#64986695", "title": "How does a scanf() inside printf() work?", "body": "<p><strong>In <code>C</code> programming, <code>scanf()</code> takes the inputs from <code>stdin()</code> which is the keyboard and returns the number of successful inputs read\nand <code>printf()</code> returns the number of characters written to <code>stdout()</code> which is the display monitor.</strong></p>\n<p><em>In your program <code>scanf()</code> is reading only one input which is getting returned and is printed by <code>printf()</code>. So, whatever may be the input the output is always 1 as it is reading only one input.</em></p>\n<p>Here take a look at this C program:</p>\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n\n        int n, n2;\n        printf(&quot;%d\\n&quot;,scanf(&quot;%d %d&quot;,&amp;n,&amp;n2));\n        return 0;\n}\n</code></pre>\n<p>It takes input or reads two integers from <code>stdin()</code> using <code>scanf()</code>, so the output will always be 2.</p>\n<p>**<em><strong>Note: The output is 0 if your input is not integer, as it reads integer only.</strong></em></p>\n"}], "owner": {"reputation": 113, "user_id": 8547725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fe457c19964e2bc29bfa8f3fe60b78?s=128&d=identicon&r=PG&f=1", "display_name": "leet101", "link": "https://stackoverflow.com/users/8547725/leet101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2880, "favorite_count": 0, "accepted_answer_id": 50822892, "answer_count": 11, "score": -1, "last_activity_date": 1606221501, "creation_date": 1528824208, "last_edit_date": 1528824289, "question_id": 50822596, "link": "https://stackoverflow.com/questions/50822596/how-does-a-scanf-inside-printf-work", "title": "How does a scanf() inside printf() work?", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main(){\n\n        int n;\n        printf(\"%d\\n\",scanf(\"%d\",&amp;n));\n        return 0;\n}\n</code></pre>\n\n<p>I wonder why the output of this program is always '1' ?!\nWhat's actually happening here ?</p>\n"}, {"tags": ["c", "arrays", "memory", "struct", "realloc"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1528825756, "post_id": 50822578, "comment_id": 88650975, "body": "why is the <code>size</code> field of the dict_int struct a pointer to an int?  Do you allocate what it&#39;s pointing to? Alos, what is this line supposed to do? <code>dict_int dictionary = Dict_int(2, &quot;first&quot;, 0, &quot;second&quot;, 1);</code> This looks like a C++ constructor call."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1528827392, "post_id": 50822578, "comment_id": 88651836, "body": "Why do you call <code>realloc</code> every time through the loop? You know that you need to add <code>len</code> more elements, increase the size by that much just once."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1528827484, "post_id": 50822578, "comment_id": 88651885, "body": "What is <code>dictionary-&gt;size[0] * 4 + 4</code> supposed to be? You should be multiplying by <code>sizeof(char *)</code> for <code>dictionary-&gt;keys</code>, and <code>sizeof(int)</code> for <code>dictionary-&gt;values</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1528827528, "post_id": 50822578, "comment_id": 88651901, "body": "And why do you add 4 after multiplying? What is the extra element for?"}], "owner": {"reputation": 1, "user_id": 9143069, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Az-fs4bu47s/AAAAAAAAAAI/AAAAAAAAABQ/WWIh4XT2LBE/photo.jpg?sz=128", "display_name": "Matthias M.", "link": "https://stackoverflow.com/users/9143069/matthias-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1528827134, "creation_date": 1528824147, "last_edit_date": 1528827134, "question_id": 50822578, "link": "https://stackoverflow.com/questions/50822578/c-realloc-error-dynamic-array-in-struct", "title": "C Realloc Error - Dynamic Array in struct", "body": "<p>first of all thank you so much for trying to help me, or at least have a look at my problem and maybe tell me, what I am doing wrong.</p>\n\n<p>Ok, so I've recently encountered the problem that <code>realloc()</code> throws a segmentation fault error, when used to extend an array in a <code>typedef struct</code>, or at least so it does in my case. </p>\n\n<p>I've tried to find the solution online, on this webpage and on other ones, but sadly I couldn't seem to find one. Which is why I really hope that one of you would be so kind to help me. </p>\n\n<p>Thank you so much in advance, \nMatthias</p>\n\n<p>Btw. here I appended the code that is providing me errors.</p>\n\n<pre><code>typedef struct dict_int {\n    int* size;\n    char** keys;\n    int* values;\n} dict_int;\n</code></pre>\n\n<p>This is my struct. And below is the function (<code>add_int()</code>), which is making problems... ;(</p>\n\n<pre><code>void add_int(dict_int* dictionary, int len, ...) {\n    va_list valist;\n    va_start(valist, len);\n\n    int di_size = dictionary-&gt;size[0];\n\n    for(int i = di_size-1; i &lt; di_size-1+len; i++) {\n        dictionary-&gt;keys[i] = va_arg(valist, char*);\n        dictionary-&gt;values[i] = va_arg(valist, int);\n\n        printf(\"Change [Size]: %d -&gt; \", dictionary-&gt;size[0]);\n        dictionary-&gt;size[0]++;\n        printf(\"%d\\n\", dictionary-&gt;size[0]);\n        if((dictionary-&gt;keys =  (char**) realloc(dictionary-&gt;keys, dictionary-&gt;size[0] * 4 + 4))\n                != NULL) {\n            printf(\"Worked out!\");\n        } else\n            printf(\"Didn't work!\");\n        if((dictionary-&gt;values = (int*) realloc(dictionary-&gt;values, dictionary-&gt;size[0] * 4 + 4))\n                != NULL) {\n            printf(\"Worked out!\");\n        } else\n            printf(\"Didn't work!\");\n    }\n\n    va_end(valist);\n}\n</code></pre>\n\n<p>And here's how I used it in the <code>main()</code> function:</p>\n\n<pre><code>int main(int argc, char* argv[]) {\n    printf(\"\\n - !Program has started! - \\n\");\n\n    dict_int dictionary = Dict_int(2, \"first\", 0, \"second\", 1);\n    printf(\"\\nDictionary-Size: %d\\n\", dictionary.size[0]);\n\n    printf(\"Dictionary: %s: %d\\n\", dictionary.keys[0], dictionary.values[0]);\n    printf(\"Dictionary: %s: %d\\n\", dictionary.keys[1], dictionary.values[1]);\n\n    printf(\"Dictionary: first: %d\\n\", get_int(&amp;dictionary, \"first\"));\n    add_int(&amp;dictionary, 1, \"third\", 2);\n    add_int(&amp;dictionary, 1, \"uno\", 1);\n\n    /* printf(\"uno: %d\\n\", get_int(&amp;dictionary, \"uno\"));\n    printf(\"third: %d\\n\", get_int(&amp;dictionary, \"third\"));\n\n    printf(\"\\n - !Program has finished! - \\n\");*/\n    return 0;\n}\n</code></pre>\n\n<p>Also, the code works out alright, if I only call <code>add_int()</code> once, so if I only were to add one element to my <code>dict_int</code> it wouldn't throw an error, which is why I'm guessing that it has something to do with the memory...</p>\n\n<p>Also, I tried to remove all the pieces of <code>add_int()</code> that included a <code>realloc()</code>, in order to prove my theory, and without <code>realloc()</code> it seems to work just fine...</p>\n\n<p>So, just know that I'm very grateful to you, for just reading trough this question, and I'd be even more grateful, if you were so kind, and tried to tell me what I'm doing wrong, since sadly, I can't figure out. - Matthias</p>\n"}, {"tags": ["c", "function", "variables", "global"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 7, "creation_date": 1528824147, "post_id": 50822563, "comment_id": 88650092, "body": "This isn&#39;t c or c++. And it doesn&#39;t sound like you want to use a global for this purpose."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 3, "creation_date": 1528824180, "post_id": 50822563, "comment_id": 88650112, "body": "Is <code>global</code> really part of your code?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528824188, "post_id": 50822563, "comment_id": 88650121, "body": "A widely used practive (and one that several static code analysing tools enforce) is to have only one return from any function. If you refactor accordingly, your problem is solved, as far as I understand."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1528824276, "post_id": 50822563, "comment_id": 88650174, "body": "What language are you using?  C is not C++."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1528824339, "post_id": 50822563, "comment_id": 88650206, "body": "@Drew That is a valid point. I probably am so used to &quot;do not multi-return&quot; that I lost sight of that."}, {"owner": {"reputation": 623, "user_id": 403030, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/131716cdd5cc2918e90a6287280c801f?s=128&d=identicon&r=PG", "display_name": "SaurabhS", "link": "https://stackoverflow.com/users/403030/saurabhs"}, "edited": false, "score": 0, "creation_date": 1528824486, "post_id": 50822563, "comment_id": 88650289, "body": "This is a old piece of code written in C in my application. I am trying to fix some problem in it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1528824906, "post_id": 50822563, "comment_id": 88650540, "body": "I have seen coding styles that have macros like <code>#define LOCAL</code> so that <code>LOCAL</code> can be used as a tag for code generation and analysis tools. <code>global</code> wouldn&#39;t be too out of line with that, but I&#39;d expect it to be <code>GLOBAL</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1528825565, "post_id": 50822563, "comment_id": 88650897, "body": "Just don&#39;t write code like this, it is very bad design."}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1528824260, "post_id": 50822599, "comment_id": 88650165, "body": "So you assume that OP was not serious when tagging &quot;C&quot;, don&#39;t you?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1528825084, "last_edit_date": 1528825084, "creation_date": 1528824220, "answer_id": 50822599, "question_id": 50822563, "link": "https://stackoverflow.com/questions/50822563/can-i-reset-value-of-global-variable-every-time-i-return-from-a-function/50822599#50822599", "title": "Can i reset value of global variable every time i return from a function", "body": "<p>Create a class whose destructor sets <code>gVar</code> to 0, then declare an instance of it at the start of the function.  When the function returns, the variable goes out of scope and the destructor is called.</p>\n\n<pre><code>class ClearGVar {\npublic:\n    ClearGVar() {}\n    ~ClearGVar() { gVar = 0; }\n}\n\nvoid fun()\n{\n    ClearGVar x;\n    ...\n} \n</code></pre>\n\n<p>EDIT:</p>\n\n<p>The C++ tag was removed after this was posted.  There's no good way to do this in C.</p>\n"}], "owner": {"reputation": 623, "user_id": 403030, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/131716cdd5cc2918e90a6287280c801f?s=128&d=identicon&r=PG", "display_name": "SaurabhS", "link": "https://stackoverflow.com/users/403030/saurabhs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 50822599, "answer_count": 1, "score": -2, "last_activity_date": 1528825084, "creation_date": 1528824093, "last_edit_date": 1528824774, "question_id": 50822563, "link": "https://stackoverflow.com/questions/50822563/can-i-reset-value-of-global-variable-every-time-i-return-from-a-function", "title": "Can i reset value of global variable every time i return from a function", "body": "<p>I want a function should reset global variable value to 0 every time its return.</p>\n\n<p>I know I can add <code>gVar=0;</code> before every return statement, but this is not the way I want because new developer may not have this information and might not reset <code>gVar</code> value. </p>\n\n<p>Requirement is</p>\n\n<pre><code>global int gVar = 10;\nvoid fun() \n{\n // Need to modify gVar Here \n  gVar = 15;\n  .\n  .\n  .\n  gVar = 20;\n  if (some condition)\n         return;\n  else \n         return; \n..\n// more return possible from this function \n// also new developer can add more return statement \n// i want every time function return it should set gVar=0\n} \n</code></pre>\n"}, {"tags": ["python", "c++", "c", "numpy", "ctypes"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 6347817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e9e9b2c90a7d49b13d8ce0262675be9?s=128&d=identicon&r=PG&f=1", "display_name": "viiv", "link": "https://stackoverflow.com/users/6347817/viiv"}, "edited": false, "score": 0, "creation_date": 1536308582, "post_id": 52215208, "comment_id": 91385181, "body": "It works indeed, thanks! I actually had rewritten my C code to work with an array of Double instead, and forget about Struct, since, in my case it could very easily be done (I just had Double and Int in there). And I also realized I had to ouptut the array if I wanted to work easily with it. This is the best solution though!"}], "tags": [], "owner": {"reputation": 216, "user_id": 10003652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/328dcab740985463843f84b7590a6f63?s=128&d=identicon&r=PG&f=1", "display_name": "Junelle Rey", "link": "https://stackoverflow.com/users/10003652/junelle-rey"}, "is_accepted": true, "score": 1, "last_activity_date": 1536293717, "creation_date": 1536293717, "answer_id": 52215208, "question_id": 50822183, "link": "https://stackoverflow.com/questions/50822183/efficient-conversion-from-c-array-of-struct-to-numpy-array-with-ctypes/52215208#52215208", "title": "Efficient conversion from C array of struct to NumPy array with ctypes", "body": "<p>We have almost the same problem but in my case, I was using CUDA DLL so my compiler was <code>nvcc</code>. But I believe that this can also be done by the normal <code>g++</code> compiler. In any case, here are the steps I did in order to convert array of structs from my CPP file to useable Python list/array. I will not go through your code; instead, I will just give you example which can be be found here: <a href=\"https://github.com/jcbacong/python-cpp.git\" rel=\"nofollow noreferrer\">https://github.com/jcbacong/python-cpp.git</a></p>\n\n<p>But the important steps are summarized as follows:</p>\n\n<ol>\n<li><p>Create a .cpp file with the necessary header file containing the <code>extern \"C\"</code> declaration for the function. In my .cpp file, I returned an array of struct instead of returning a <code>void</code>. </p></li>\n<li><p>Create a .dll file using your compiler. Again, in my case, it was <code>nvcc</code>. The sample code I linked through my github account was compiled using <code>nvcc</code>. </p></li>\n<li><p>In your .py file:</p>\n\n<p>3.1 Create a Python class with <code>ctypes.Structure</code> in order to replicate the struct definition in your .cpp/.h file. </p>\n\n<p>3.2 Initialize your input/output using <code>argtype/restype</code>. Since my .cpp function is returning an array of struct, the <code>restype</code> is given by <code>ctypes.Pointer(&lt;your Python Class(ctypes.Structure)&gt;)</code>. </p>\n\n<p>3.3 I converted all inputs to readable ctypes. After calling the function in my .py file, the resulting array of structs (<code>_results</code> in the example) can be converted to Python list using (<code>results = _results[:ARRAY_SIZE]</code>).</p></li>\n</ol>\n\n<p>I hope this helps!!</p>\n"}], "owner": {"reputation": 115, "user_id": 6347817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e9e9b2c90a7d49b13d8ce0262675be9?s=128&d=identicon&r=PG&f=1", "display_name": "viiv", "link": "https://stackoverflow.com/users/6347817/viiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 52215208, "answer_count": 1, "score": 1, "last_activity_date": 1536307562, "creation_date": 1528822666, "last_edit_date": 1536307562, "question_id": 50822183, "link": "https://stackoverflow.com/questions/50822183/efficient-conversion-from-c-array-of-struct-to-numpy-array-with-ctypes", "title": "Efficient conversion from C array of struct to NumPy array with ctypes", "body": "<p>Following this <a href=\"https://stackoverflow.com/questions/50705208/cython-setup-py-compilation-error-in-dll-wrapping-tutorial-unresolved-external\">question</a> where I was trying to use a C++ DLL with <code>Cython</code>, with a tutorial fit to my case that never worked, I decided to use <code>ctypes</code>. I now successfully call the function that interests me in my DLL using ctypes thanks to heavy SO browsing. I am now faced with the problem of using the results that is an array of struct in Python.</p>\n\n<p>This C function is as follows:</p>\n\n<pre><code>void myfun(\n                 double         a,\n                 //...more double parameters\n                 int            max_iter,\n                 int *          nb_iter,\n                 myStruct *     res_arr,\n                 bool *         ok\n                );\n</code></pre>\n\n<p>with <code>myStruct</code> defined as follows:</p>\n\n<pre><code>typedef struct  {\n             double dat;\n\n             int    k;\n             int    m;\n            // ... more int\n\n             double b;\n             double v;\n             //...more double\n\n            } myStruct;\n</code></pre>\n\n<p>I call this function through the following Python code:</p>\n\n<pre><code>import ctypes\nlib = ctypes.CDLL('PATH_TO_DLL\\\\lib.dll')\n\nmyFunPy = getattr(lib,\"?myFun@@YANNNNN_BUNCH_OF_Ns_NNNHPEAHPEAUmyStruct@@PEA_N@Z\") # name found through dumpbin.exe (due to C++)\n\nclass myStruct(ctypes.Structure):\n    _fields_ = [(\"k\", ctypes.c_int),\n                (\"m\", ctypes.c_int),\n                #...more int parameters\n\n                (\"b\", ctypes.c_double),\n                (\"v\", ctypes.c_double)\n                #...more double parameters\n               ]\n\nmyFunPy.argtypes = [ctypes.c_double,\n                   // ... more double parameters\n\n                   ctypes.c_int,\n                   ctypes.POINTER(ctypes.c_int),\n                   ctypes.POINTER(myStruct),\n                   ctypes.POINTER(ctypes.c_bool)]\n\nmyFunPy.restype = ctypes.c_void_p\n\nmax_iter = 10000\na = ctypes.c_double(0.1)\n// ... more double parameters definitions\n\nnb_iter = ctypes.c_int(0) # value doesn't matter, it is initialized in myFun\nok = ctypes.c_bool(True)\n\nres_arr = (myStruct * max_iter)()\n\nmyFunPy(a, ..., max_iter, ctypes.byref(nb_iter), res_arr, ctypes.byref(ok))\n</code></pre>\n\n<p>Now <code>myFun</code> modifies <code>res_arr</code> which is an array of struct as can be seen from the above code.\nIt is exactly </p>\n\n<pre><code>&lt;__main__.myStruct_Array_10000 at 0x97966c8&gt;)\n</code></pre>\n\n<p>after the code shown above, but I cannot understand how to convert it to a NumPy array for future use <em>efficiently</em>.</p>\n\n<p>Sure, I could do for loops with stuff like <code>for field, _ in struct._fields_</code> as shown <a href=\"https://stackoverflow.com/questions/3789372/python-can-we-convert-a-ctypes-structure-to-a-dictionary/\">here</a>, but that is not the point since I use the DLL to make my computations faster (I really saw the difference in the execution time). <code>res_arr</code> ranges from 200 kb to 1 Mb and has tens of thousands of lines and some dozens of columns, so I'm sure that there is a way to not go through all of it with loops, but I can't figure out how to do so nicely.</p>\n\n<p>It seems that if it wasn't an array of struct, it would be easier. There are <a href=\"https://stackoverflow.com/questions/39924482/how-to-return-an-object-from-c-that-contains-a-numpy-array-using-ctypes-interfac\">a</a> <a href=\"https://stackoverflow.com/questions/23329663/access-np-array-in-ctypes-struct\">few</a> <a href=\"https://stackoverflow.com/questions/40063080/casting-an-array-of-c-structs-to-a-numpy-array\">SO</a> <a href=\"https://stackoverflow.com/questions/39328205/numpy-structured-regular-array-from-ctypes-pointer-to-array-of-structs\">questions</a> (also <a href=\"https://stackoverflow.com/questions/48913932/ctypes-fast-way-to-convert-a-return-pointer-to-an-array-or-python-list\">here</a>, <a href=\"https://stackoverflow.com/questions/46043582/numpy-retriving-an-array-from-an-array-of-pointers\">here</a>, <a href=\"https://stackoverflow.com/questions/47127575/copy-data-from-numpy-to-ctypes-quickly\">here</a>, and <a href=\"https://stackoverflow.com/questions/4355524/getting-data-from-ctypes-array-into-numpy\">here</a>) close to this subject but it's either about converting just a struct, just an array, or something close but never exactly like me, and I wasn't successful in adapting these solutions, so maybe there's a way to base an answer on that, but in any case I'm all ears.</p>\n"}, {"tags": ["c", "arrays", "struct", "printf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1528822656, "post_id": 50822142, "comment_id": 88649323, "body": "This is undefined behavior. No need to go farther."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 9682448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Javadee", "link": "https://stackoverflow.com/users/9682448/javadee"}, "edited": false, "score": 0, "creation_date": 1528824535, "post_id": 50822242, "comment_id": 88650323, "body": "It gives me -70 in value."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 117, "user_id": 9682448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Javadee", "link": "https://stackoverflow.com/users/9682448/javadee"}, "edited": false, "score": 0, "creation_date": 1528824826, "post_id": 50822242, "comment_id": 88650485, "body": "@Ali See my edit.  You need to cast each of the bytes to an unsigned value first."}, {"owner": {"reputation": 117, "user_id": 9682448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Javadee", "link": "https://stackoverflow.com/users/9682448/javadee"}, "edited": false, "score": 0, "creation_date": 1528825495, "post_id": 50822242, "comment_id": 88650855, "body": "can I use an unsigned long instead of an usigned int just to make sure I dont loose any part of the value?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 117, "user_id": 9682448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Javadee", "link": "https://stackoverflow.com/users/9682448/javadee"}, "edited": false, "score": 0, "creation_date": 1528825564, "post_id": 50822242, "comment_id": 88650896, "body": "@Ali An <code>unsigned long</code> is guaranteed to be at least 32-bit, so yes using that type should be fine."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1528824801, "last_edit_date": 1528824801, "creation_date": 1528822864, "answer_id": 50822242, "question_id": 50822142, "link": "https://stackoverflow.com/questions/50822142/how-is-printf-i-working-in-this-situation/50822242#50822242", "title": "how is printf %i working in this situation?", "body": "<p>The <code>%i</code> format specifier to <code>printf</code> expects an <code>int</code> as its argument.  However, you are passing a <code>duo_word</code>.  Using the wrong <code>printf</code> format specifier invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  In this case, you're \"lucky\" it happens to print what you want, but you can't depend on that behavior.</p>\n\n<p>Assuming the first 4 bytes in the struct represent a 32-bit integer in little endian format, you can pull out the individual bytes and set them in an integer as follows:</p>\n\n<pre><code>unsigned int value = 0;\nvalue |= (unsigned char)duo_word_inst.duo_word[0];\nvalue |= (unsigned char)duo_word_inst.duo_word[1] &lt;&lt; 8;\nvalue |= (unsigned char)duo_word_inst.duo_word[2] &lt;&lt; 16;\nvalue |= (unsigned char)duo_word_inst.duo_word[3] &lt;&lt; 24;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1528825156, "last_edit_date": 1528825156, "creation_date": 1528823166, "answer_id": 50822335, "question_id": 50822142, "link": "https://stackoverflow.com/questions/50822142/how-is-printf-i-working-in-this-situation/50822335#50822335", "title": "how is printf %i working in this situation?", "body": "<p>It's undefined behavior, so anything can happen.</p>\n\n<p>What is likely to happen is <code>duo_word_inst</code> will simply be pasted on the stack\nand <code>%i</code> will simply cause <code>printf</code> to slice <code>sizeof(int)</code> from that stack value.</p>\n\n<p>You can do all of that manually and in a <em>defined</em> way by simply using <code>memcpy</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\ntypedef   struct \n { \n    char duo_word[8]; \n } duo_word;\n\n\nint main()\n{\n    duo_word duo_word_inst = { .duo_word = { '\u00ba', '\\b', '\\x1', '\\0', '\u00c0', '\\xe', '2', 'a' } };\n    int x;\n    memcpy(&amp;x, &amp;duo_word_inst, sizeof(x));\n    printf(\"          %i \", x); //prints 67770 too\n\n#if UNDEFINED_BEHAVIOR\n    printf(\"          %i \", duo_word_inst); // gives 67770 but how?\n#endif\n    return 0;\n}\n</code></pre>\n\n<p>(An even better way would be to paste the value with bitops as in <a href=\"https://stackoverflow.com/users/1687119/dbush\">dbush</a>'s answer and thereby avoid implementation-defined behavior too.)</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1528826877, "creation_date": 1528826877, "answer_id": 50823255, "question_id": 50822142, "link": "https://stackoverflow.com/questions/50822142/how-is-printf-i-working-in-this-situation/50823255#50823255", "title": "how is printf %i working in this situation?", "body": "<p>Your code is likely the wrong solution to a different problem than the one you think you are solving.</p>\n\n<p>First of all, an array <code>char [8]</code> cannot be used to reliably store integer values. This is because the <code>char</code> type has implementation-defined signedness. Meaning the compiler can implement it either as signed or unsigned, at a whim. And inside this, you store characters beyond the basic character, so there is no telling what your code will do.</p>\n\n<p>If you wish to store raw data, you must use <code>uint8_t</code> from <code>stdint.h</code>.</p>\n\n<p>Then as others have pointed out, you can't use <code>%i</code> to print a struct, nor to print a character array. If you are lucky, you get some kind of seemingly deterministic behavior, but formally this is completely undefined behavior. In your case it probably treated the bytes as a 4 byte little endian number, <code>'\u00ba', '\\b', '\\x1', '\\0'</code> giving hex 00 01 08 BA, which in turn is dec 67770. The program might as well crash or print garbage though, since you rely on undefined behavior. It could work today and crash tomorrow.</p>\n\n<p>In order to deterministically, portably and reliably get the value 67770, you can do something like this:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\ntypedef union\n{\n    uint8_t  bytes [8];\n    uint32_t ints  [2];\n} duo_word;\n\nint main (void)\n{\n  duo_word dw = { .bytes = { 0xBA, 0x08, 0x01, 0x00 } };\n  printf(\"%\"PRIu32, dw.ints[0]);\n}\n</code></pre>\n\n<p>This uses \"type punning\" through a union, which is ok in C (but not in C++). This still makes the assumption that you are using a little endian CPU however. For truly portable code, you have to use bit shifts instead.</p>\n"}], "owner": {"reputation": 117, "user_id": 9682448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Javadee", "link": "https://stackoverflow.com/users/9682448/javadee"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "closed_date": 1528841617, "answer_count": 3, "score": 0, "last_activity_date": 1528826877, "creation_date": 1528822448, "question_id": 50822142, "link": "https://stackoverflow.com/questions/50822142/how-is-printf-i-working-in-this-situation", "closed_reason": "Not suitable for this site", "title": "how is printf %i working in this situation?", "body": "<p>Sorry trying to ask this <a href=\"https://stackoverflow.com/questions/50812755/c-char-to-jstring-printf-works-for-int-type-but-not-for-string\">question</a> in another manner.</p>\n\n<pre><code>typedef   struct \n { \n    char duo_word[8]; \n } duo_word;\n\n\n  duo_word duo_word_inst = { .duo_word = { '\u00ba', '\\b', '\\x1', '\\0', '\u00c0', '\\xe', '2', 'a' } };\n\n  printf(\"          %i \", duo_word_inst); // gives 67770 but how?\n</code></pre>\n\n<p>And how can I extract the 67770 value into e.g. an int variable?</p>\n"}]