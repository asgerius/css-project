[{"tags": ["c", "arrays", "pointers", "struct", "malloc"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1534374699, "post_id": 51867583, "comment_id": 90687063, "body": "There should be no space after the <code>%</code> in <code>scanf</code>. Note that <code>scanf</code> returns the number of successful conversions. You should check that. I expect that all of your <code>scanf</code> are returning 0."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534375582, "post_id": 51867583, "comment_id": 90687266, "body": "Post your sample input too.  It helps a lot and it gains better feedback."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534375990, "post_id": 51867583, "comment_id": 90687356, "body": "regarding: <code>struct data{     char *name;     char *surname;     char *city; }user;</code>  it is best to separate the definition of a struct from an instance of the struct."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534376196, "post_id": 51867583, "comment_id": 90687399, "body": "regarding: <code>printf(&quot;\\nname: %s&quot;,user.name);</code>  except for when a specific format is desired, it is best to write similar to: <code>printf(&quot;name: %s\\n&quot;,user.name);</code>  so the data will be immediately output (to the terminal) rather than sitting in the system output buffer until a &#39;\\n&#39; or &#39;flush( stdout );&#39; or the program exits"}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1534376385, "post_id": 51867583, "comment_id": 90687440, "body": "Your <code>malloc()</code> is wrong too. Should be <code>malloc(sizeof(char) * n1)</code> and the same for others. This is better suited for <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534376565, "post_id": 51867583, "comment_id": 90687475, "body": "regarding: <code>user.city=malloc(sizeof(int)*n3);</code>  1) In a 32 bit architecture, a <code>int</code> is 4 bytes, so this kind of statement is allocating some 4 times the amount of memory specified by the user.  suggest: <code>user.city=malloc(n3 +1);</code>  The <code>+1</code> to allow for the trailing NUL byte.  2) when calling any of the heap allocation functions: <code>malloc</code> <code>calloc</code> <code>realloc</code>, always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1534376653, "post_id": 51867583, "comment_id": 90687490, "body": "@UnmannedPlayer,  the expressiion <code>sizeof(char)</code> is defined in the C standard as 1.  Multiplying anything by 1 has no effect.  However, it does clutter the code, making it more difficult to understand, debug, etc"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534376802, "post_id": 51867583, "comment_id": 90687521, "body": "the function: <code>malloc()</code> and family expect a parameter of type <code>size_t</code>, not <code>int</code>  (correcting this problem will involve changing the type of the variables to <code>size_t</code> and changing the <code>scanf()</code> format string to <code>%zu</code> (or similar)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534376980, "post_id": 51867583, "comment_id": 90687564, "body": "I&#39;m on Linux.  There does not seem to be a function: <code>strupr()</code>"}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534377021, "post_id": 51867583, "comment_id": 90687570, "body": "@user3629249 - C99 6.5.3.4 forces <code>sizeof(char)</code> to be 1. Thanks."}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534377073, "post_id": 51867583, "comment_id": 90687581, "body": "@user3629249 I think OP is trying this on DOS or MSVC."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1534377308, "post_id": 51867583, "comment_id": 90687628, "body": "when compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  Other compilers will have their own options to accomplish the same thing"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 4, "creation_date": 1534379066, "post_id": 51867583, "comment_id": 90687976, "body": "The <code>&amp;</code> operators should not be present in the calls to <code>scanf</code>.  Since each of those <code>struct</code> members is a pointer, using <code>&amp;user.name</code> passes the address of the pointer itself to <code>scanf</code> rather than the &quot;payload&quot; of the pointer, i.e. address of the first byte of the  character array returned by <code>malloc</code>."}, {"owner": {"reputation": 11, "user_id": 10231555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Tmvc.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/10231555/jeronimo"}, "edited": false, "score": 1, "creation_date": 1534471126, "post_id": 51867583, "comment_id": 90726155, "body": "Thank you so much for your help, I&#39;ve corrected the mistakes, and changed the &quot;scanf()&quot; for a &quot;fgets()&quot;, it works perfectly!!!"}, {"owner": {"reputation": 11, "user_id": 10231555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Tmvc.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/10231555/jeronimo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534471228, "post_id": 51867583, "comment_id": 90726168, "body": "@chux I&#39;ll take in consideration for the next time! I&#39;m new un this community and I&#39;m learning a lot of C programming."}, {"owner": {"reputation": 11, "user_id": 10231555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Tmvc.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/10231555/jeronimo"}, "reply_to_user": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1534471267, "post_id": 51867583, "comment_id": 90726174, "body": "@dgnuff that&#39;s true, I&#39;ve forgotten that, hahaha. Thank you so much!"}, {"owner": {"reputation": 11, "user_id": 10231555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Tmvc.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/10231555/jeronimo"}, "reply_to_user": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1534471390, "post_id": 51867583, "comment_id": 90726199, "body": "@UnmannedPlayer yes, you&#39;re right, thank you!"}, {"owner": {"reputation": 11, "user_id": 10231555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Tmvc.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/10231555/jeronimo"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534471474, "post_id": 51867583, "comment_id": 90726217, "body": "@user3629249 oh, thank you, I didn&#39;t know that. Now I&#39;m gonna practice with that!"}, {"owner": {"reputation": 11, "user_id": 10231555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Tmvc.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/10231555/jeronimo"}, "reply_to_user": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1534471647, "post_id": 51867583, "comment_id": 90726250, "body": "@UnmannedPlayer well, I was trying this on Windows(yes, I&#39;m a little newbie un OS, haha). On the future I want to learn about Linux OS..."}], "owner": {"reputation": 11, "user_id": 10231555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Tmvc.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/10231555/jeronimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534374303, "creation_date": 1534374303, "question_id": 51867583, "link": "https://stackoverflow.com/questions/51867583/trouble-with-structs-in-c", "title": "Trouble with structs in C", "body": "<p>I'm having troubles with this code.<br>\nBasically I must create a structure with dynamic strings,then ask user to assingn memory for each string. After that, ask user his name,surname and city, convert all strings to mayus using strupr(), and finally, print it.</p>\n\n<pre><code>/*16.ask user his name,surname and city. Then,convert all to MAYUS(with strupr()), and print all data(use a structure and dynamic memory).*/\n\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nstruct data{\n    char *name;\n    char *surname;\n    char *city;\n}user;\n\nvoid flush_in();\n\nint main(){\n    int n1,n2,n3;\n\n    printf(\"type memory for name: \");\n    scanf(\"%i\",&amp;n1);\n    user.name=malloc(sizeof(int)*n1);\n\n    printf(\"type memory for surname: \");\n    scanf(\"%i\",&amp;n2);\n    user.surname=malloc(sizeof(int)*n2);\n\n    printf(\"type memory for city: \");\n    scanf(\"%i\",&amp;n3);\n    user.city=malloc(sizeof(int)*n3);\n    flush_in();\n    printf(\"type name: \");\n    scanf(\"% [^\\n]\",&amp;user.name);\n    flush_in();\n\n    printf(\"type surname: \");\n    scanf(\"% [^\\n]\",&amp;user.surname);\n    flush_in();\n\n    printf(\"type city: \");\n    scanf(\"% [^\\n]\",&amp;user.city);\n\n    strupr(user.name);\n    strupr(user.surname);\n    strupr(user.city);\n\n    printf(\"\\nname: %s\",user.name);\n    printf(\"\\nsurname: %s\",user.surname);\n    printf(\"\\ncity: %s\",user.city);\n\n    return 0;\n}\n\nvoid flush_in(){\n       int ch;\n       while((ch=fgetc(stdin))!=EOF &amp;&amp; ch!='\\n'){}\n} \n</code></pre>\n\n<p>Everything is fine until the output, it returns:<br></p>\n\n<p><code>name: : P\u00a1</code><br>\n<code>surname: P\u00a1</code><br>\n<code>city: P\u00a1</code><br></p>\n\n<p>why it this happen? It's suposed to return my name, surname and city, but I don't know what is the error.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1534373203, "post_id": 51867369, "comment_id": 90686753, "body": "<code>lastPtrRef = &amp;((*lastPtrRef)-&gt;next);</code> which is equivalent to <code>lastPtrRef = &amp;(*lastPtrRef)-&gt;next;</code> simply sets <code>lastPtrRef</code> to the <i>address of</i> <code>lastPtrRef-&gt;next</code>. Recall, <code>lastPtrRef</code> holds the <i>address of</i> <code>head</code> You can&#39;t just send <code>head</code> to <code>push()</code> or <code>push()</code> would receive <i>copy of</i> the pointer, so instead you pass the <i>address of</i> the pointer so that <code>push()</code> is operating on the same address as you have in <code>constructList</code>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1534373361, "post_id": 51867369, "comment_id": 90686798, "body": "The code is rather strange: the push() function inserts at the beginning, and the constructList() uses it to append at the end, by advancing the pointer to pointer after the push() call."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1534373386, "post_id": 51867369, "comment_id": 90686801, "body": "You may also want to read (especially WhozCraig&#39;s answer) to <a href=\"https://stackoverflow.com/questions/15244429/pointer-of-a-pointer-in-linked-list-append\">pointer of a pointer in linked list append</a>"}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": false, "score": 1, "last_activity_date": 1534376793, "creation_date": 1534376793, "answer_id": 51867861, "question_id": 51867369, "link": "https://stackoverflow.com/questions/51867369/understanding-code-for-creating-a-singly-linked-list-using-double-pointer-in-c/51867861#51867861", "title": "Understanding code for creating a singly linked list using double pointer in C", "body": "<p>This uses a technique called <em>forward-chaining</em>, and I believe you already understand that (using a pointer-to-pointer to forward-chain a linked list construction). </p>\n\n<p>This implementation is made confusing by the simple fact that the <code>push</code> function seems like it would be designed to stuff items on the <em>head</em> of a list, but in this example, it's stuffing them on the tail. So how does it do it?</p>\n\n<p>The part that is important to understand is this seemingly trivial little statement in <code>push</code>:</p>\n\n<pre><code>newNode-&gt;next = *headRef\n</code></pre>\n\n<p>That may not seem important, but I assure you it is. The function <code>push</code>, in this case, does grave injustice to what this function really does. In reality it is more of a generic <code>insert</code>. Some fact about that function</p>\n\n<ul>\n<li>It accepts a pointer-to-pointer <code>headRef</code> as an argument, as well as some data to put in to the linked list being managed.</li>\n<li>After allocating a new node and saving the data within, it sets the new node's <code>next</code> pointer to whatever value is currently stored in the <em>dereferenced</em> <code>headRef</code> pointer-to-pointer (so.. a pointer) That's what the line I mentioned above accomplishes.</li>\n<li>It then stores the new node's address at the same place it just pulled the prior address from; i.e. <code>*headRef</code></li>\n<li>Interestingly, it has no return value (it is <code>void</code>) further making this somewhat confusing. Turns out it doesn't need one.</li>\n</ul>\n\n<p>Upon returning to the caller, at first nothing may seem to have changed. <code>lastPtrRef</code> still points to some pointer (in fact the same pointer as before; it must, since it was passed by value to the function). But now <em>that</em> pointer points to the new node just allocated. Further, that new node's <code>next</code> pointer points to whatever <em>was</em> in <code>*lastPtrRef</code> before the function call (i.e. whatever value <em>was</em> in the pointer pointed to by <code>lastPtrRef</code> before the function call). </p>\n\n<p>That's important. That is what that line of code enforces,  That means if you invoke this with <code>lastPtrRef</code> addressing a pointer pointing to NULL (such as <code>head</code> on initial loop entry), that pointer will receive the new node, and the new node's <code>next</code> pointer will be <code>NULL</code>. If you then change the address in <code>lastPtrRef</code> to point to the <code>next</code> pointer of the last-inserted node (which points to NULL; we just covered that), and repeat the process, it will hang another node there, setting that node's <code>next</code> pointer to <code>NULL</code>, etc. With each iteration, <code>lastPtrRef</code> addresses the last-node's <code>next</code> pointer, which is always <code>NULL</code>.</p>\n\n<p>That's how <code>push</code> is being used to construct a forward linked list. One final thought. What would you get for a linked list if you had this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Node\n{\n    int data;\n    struct Node* next;\n};\n\nvoid push(struct Node** headRef, int data)\n{\n    struct Node* newNode = (struct Node*)malloc(sizeof(struct Node));\n    newNode-&gt;data = data;\n    newNode-&gt;next = *headRef;\n    *headRef = newNode;\n}\n\nint main()\n{\n    //points to the head node of the linked list\n    struct Node* head = NULL;\n    push(&amp;head, 1);\n    push(&amp;head-&gt;next, 2);\n    push(&amp;head-&gt;next, 3);\n\n    for (struct Node const *p = head; p; p = p-&gt;next)\n        printf(\"%p ==&gt; %d\\n\", p, p-&gt;data);\n}\n</code></pre>\n\n<p>This seemingly innocent example amplifies why I said <code>push</code> is more of a generic <code>insert</code> than anything else. This just populates the initial head node.</p>\n\n<pre><code>push(&amp;head, 1);\n</code></pre>\n\n<p>Then this appends to that node by using the address of the new node's <code>next</code> pointer as the first argument, similar to what your <code>constructList</code> is doing, but without the <code>lastPtrRef</code> variable (we don't need it here):</p>\n\n<pre><code>push(&amp;head-&gt;next, 2);\n</code></pre>\n\n<p>But then this:</p>\n\n<pre><code>push(&amp;head-&gt;next, 3);\n</code></pre>\n\n<p>Hmmm. Same pointer address as the prior call, so what will it do? Hint: remember what that <code>newNode-&gt;next = *headRef</code> line does (I droned on about it forever; I hope something stuck). </p>\n\n<p>The output of the program above is this (obviously the actual address values will be different, dependent to your instance and implementation):</p>\n\n<pre><code>0x100705950 ==&gt; 1\n0x10073da90 ==&gt; 3\n0x100740b90 ==&gt; 2\n</code></pre>\n\n<p>Hope that helps. </p>\n"}], "owner": {"reputation": 1905, "user_id": 8713450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed61e21ec072346277da9569f1c9f966?s=128&d=identicon&r=PG&f=1", "display_name": "ceno980", "link": "https://stackoverflow.com/users/8713450/ceno980"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534376793, "creation_date": 1534372542, "question_id": 51867369, "link": "https://stackoverflow.com/questions/51867369/understanding-code-for-creating-a-singly-linked-list-using-double-pointer-in-c", "title": "Understanding code for creating a singly linked list using double pointer in C", "body": "<p>I am trying to understand how the code below for creating a singly linked list works using a double pointer. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Node {\n    int data;\n    struct Node* next;\n};\n\nvoid push(struct Node** headRef, int data) {\n\n    struct Node* newNode = (struct Node*)malloc(sizeof(struct Node));\n    newNode-&gt;data = data;   \n    newNode-&gt;next = *headRef;\n    *headRef = newNode;\n}\n\n//Function to implement linked list from a given set of keys using local references\nstruct Node* constructList(int keys[], int n) {\n    struct Node *head = NULL; \n    struct Node **lastPtrRef = &amp;head; \n    int i, j;\n    for(i = 0; i &lt; n; i++) {\n        push(lastPtrRef, keys[i]);\n        lastPtrRef = &amp;((*lastPtrRef)-&gt;next); //this line\n        if((*lastPtrRef) == NULL) {\n            printf(\"YES\\n\");\n        }\n    }\n\n    return head;\n}\n\nint main() {\n    int keys[] = {1, 2, 3, 4};\n    int n = sizeof(keys)/sizeof(keys[0]);\n\n    //points to the head node of the linked list\n    struct Node* head = NULL;\n\n    head = constructList(keys, n); //construct the linked list\n\n    struct Node *temp = head;\n\n    while(temp != NULL) { //print the linked list\n        printf(\" %d -&gt; \", temp-&gt;data);\n        temp = temp-&gt;next;\n    }\n}\n</code></pre>\n\n<p>I understand the purpose of using the double pointer in the function push(), it allows you to change what the pointer headRef is pointing to inside the function. However in the function constructList(), I don't understand how the following line works:</p>\n\n<pre><code>lastPtrRef = &amp;((*lastPtrRef)-&gt;next);\n</code></pre>\n\n<p>Initially lastPtrRef would be pointing to head which points to NULL. In the first call to push(), within the for loop in constructList(), the value that head points to is changed (it points to the new node containing the value 1). So after the first call to push(), lastPtrRef will be pointing to head which points to a node with the value of 1. However, afterwards the following line is executed:</p>\n\n<p>lastPtrRef = &amp;((*lastPtrRef)->next);</p>\n\n<p>Whereby lastPtrRef is given the address of whatever is pointed to by the next member of the newly added node. In this case, head->next is NULL. </p>\n\n<p>I am not really sure what the purpose of changing lastPtrRef after the call to push(). If you want to build a linked list, don't you want lastPtrRef to have the address of the pointer which points to the node containing 1, since you want to push the next node (which will containing 2) onto the head of the list (which is 1)?</p>\n\n<p>In the second call to push() in the for loop in constructList, we're passing in lastPtrRef which points to head->next (NULL) and the value 2. In push() the new node is created, containing the value 2, and newNode->next points to head->next which is NULL. headRef in push gets changed so that it points to newNode (which contains 2). </p>\n\n<p>Maybe I'm understanding the code wrong, but it seems that by changing what lastPtrRef points to, the node containing 1 is getting disregarded. I don't see how the linked list is created if we change the address lastPtrRef holds.</p>\n\n<p>I would really appreciate any insights as to how this code works. Thank you.</p>\n"}, {"tags": ["c", "linux-kernel", "sysfs"], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 1479092, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be51588b1a81bba9dbc04d21fa980916?s=128&d=identicon&r=PG&f=1", "display_name": "Twifty", "link": "https://stackoverflow.com/users/1479092/twifty"}, "edited": false, "score": 0, "creation_date": 1534372022, "post_id": 51867277, "comment_id": 90686481, "body": "Perfect answer. I don&#39;t plan on writing more than about 10 bytes, but it&#39;s always safe to have a sanity check in place :)"}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 5, "last_activity_date": 1534371946, "creation_date": 1534371946, "answer_id": 51867277, "question_id": 51867251, "link": "https://stackoverflow.com/questions/51867251/max-number-of-bytes-available-for-sysfs-read/51867277#51867277", "title": "Max number of bytes available for sysfs read", "body": "<p>According to <a href=\"https://www.kernel.org/doc/Documentation/filesystems/sysfs.txt\" rel=\"noreferrer\">Documentation/filesystems/sysfs.txt</a> (search for \"Reading/Writing Attribute Data\") the buffer size is one page, or <code>PAGE_SIZE</code> bytes.</p>\n"}], "owner": {"reputation": 2923, "user_id": 1479092, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be51588b1a81bba9dbc04d21fa980916?s=128&d=identicon&r=PG&f=1", "display_name": "Twifty", "link": "https://stackoverflow.com/users/1479092/twifty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "accepted_answer_id": 51867277, "answer_count": 1, "score": 4, "last_activity_date": 1534371946, "creation_date": 1534371746, "question_id": 51867251, "link": "https://stackoverflow.com/questions/51867251/max-number-of-bytes-available-for-sysfs-read", "title": "Max number of bytes available for sysfs read", "body": "<p>To handle a <code>sysfs</code> read I need to create a <code>show</code> function which is added to a <code>kobj_attribute</code> structure. The prototype of <a href=\"https://elixir.bootlin.com/linux/v4.14.63/source/include/linux/kobject.h#L145\" rel=\"nofollow noreferrer\">the function is defined as</a>:</p>\n\n<pre><code>ssize_t (*show)(struct kobject *kobj, struct kobj_attribute *attr,\n            char *buf);\n</code></pre>\n\n<p>Obviously I need to write data to the <code>buf</code> parameter, but what is the upper limit of the number of bytes which can be written? Is it defined anywhere?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1534367817, "post_id": 51866536, "comment_id": 90685261, "body": "Calls to <code>system()</code> can be fantastically useful, even if they are also nonportable and theoretically unsafe."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1534368277, "post_id": 51866536, "comment_id": 90685413, "body": "example: <code>system(&quot;cls&quot;);</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1534368331, "post_id": 51866536, "comment_id": 90685434, "body": "<code>system()</code> ispart of the standard library. It is the <i>only</i> portable way to perform system-specific stuff. Of course, the string argument should make sense for the particular environment, but that cannot be not imposed by the C standard."}, {"owner": {"reputation": 10586, "user_id": 170383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d9f7a30948dca1bbd05eaf27f277ae6?s=128&d=identicon&r=PG", "display_name": "David R Tribble", "link": "https://stackoverflow.com/users/170383/david-r-tribble"}, "edited": false, "score": 2, "creation_date": 1534368489, "post_id": 51866536, "comment_id": 90685472, "body": "Keep in mind that the primary goal of ISO C was to <i>codify existing practice</i>, and at the time (1989), most if not all compilers provided a <code>system()</code> library function."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1534369251, "post_id": 51866536, "comment_id": 90685696, "body": "Also, in closed source days, it allowed some things to be configurable by the user, <i>without recompilation</i>. For Unix, External (shell)scripts could be used to configure terminal lines/modems, which could be <i>very</i> system-specific. Filters for LPD used to be shell scripts, too."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1534369952, "post_id": 51866536, "comment_id": 90685945, "body": "Goes back to the olden days, C, unix and shell were paper, rock and scissors.  The shell never had a blessed api, mostly because there always was more than one, system() was the backdoor.  It still is."}], "answers": [{"tags": [], "owner": {"reputation": 629, "user_id": 7793418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s7lrt.jpg?s=128&g=1", "display_name": "Jim M.", "link": "https://stackoverflow.com/users/7793418/jim-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1534368062, "creation_date": 1534368062, "answer_id": 51866606, "question_id": 51866536, "link": "https://stackoverflow.com/questions/51866536/why-does-system-exist/51866606#51866606", "title": "Why does system() exist?", "body": "<p><em>sarcastic answer</em> Because if it didn't exist people would ask why that functionality didn't exist...</p>\n\n<p><em>better answer</em><br>\nMany of the system functionality is not part of the 'C' standard but are part of say the Linux spec and Windows most likely has some equivalent. So if you're writing an app that will only be used on Linux environments then using these functions is not an issue, and as such is actually useful. If you're writing an application that can run on both Linux and Windows (or others) these calls become problematic because they may not be portable between system. The key (imo) is that you are simply aware of the issues/concerns and program accordingly (e.g. use appropriate #ifdef's to protect the code etc...)</p>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1534370334, "creation_date": 1534370334, "answer_id": 51867025, "question_id": 51866536, "link": "https://stackoverflow.com/questions/51866536/why-does-system-exist/51867025#51867025", "title": "Why does system() exist?", "body": "<p>Many interactive applications offer a way for users to execute shell commands. For instance, in <code>vi</code> you can do:</p>\n\n<pre><code>:!ls\n</code></pre>\n\n<p>and it will execute the <code>ls</code> command. <code>system()</code> is a function they can use to do this, rather than having to write their own <code>fork()</code> and <code>exec()</code> code. </p>\n\n<p>Also, <code>fork()</code> and <code>exec()</code> aren't portable between operating systems; using <code>system()</code> makes code that executes shell commands more portable.</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 2, "last_activity_date": 1585941097, "last_edit_date": 1592644375, "creation_date": 1534371483, "answer_id": 51867211, "question_id": 51866536, "link": "https://stackoverflow.com/questions/51866536/why-does-system-exist/51867211#51867211", "title": "Why does system() exist?", "body": "<p>The closest thing to an official &quot;why&quot; answer you're likely to find is the C89 Rationale. <em>4.10.4.5 The system function</em> reads:</p>\n<blockquote>\n<p>The system function allows a program to suspend its execution temporarily in order to run another program to completion.</p>\n<p>Information may be passed to the called program in three ways: through command-line argument strings, through the environment, and (most portably) through data files.  Before calling the system function, the calling program should close all such data files.</p>\n<p>Information may be returned from the called program in two ways: through the implementation-defined return value (in many implementations, the termination status code which is the argument to the exit function is returned by the implementation to the caller as the value returned by the system function), and (most portably) through data files.</p>\n<p>If the environment is interactive, information may also be exchanged with users of interactive devices.</p>\n<p>Some implementations offer built-in programs called <em>&quot;commands&quot;</em>  (for example, <code>date</code>)  which may provide useful information to an application program via the system function.  The Standard does not attempt to characterize such commands, and their use is not portable.</p>\n<p>On the other hand, the use of the system function is portable, provided the implementation supports the capability.  The Standard permits the application to ascertain this by calling the system function with a null pointer argument.  Whether more levels of nesting are supported can also be ascertained this way; assuming more than one such level is obviously dangerous.</p>\n</blockquote>\n<p>Aside from that, I would say mainly for historical reasons. In the early days of Unix and C, <code>system</code> was a convenient library function that fulfilled a need that several interactive programs needed: as mentioned above, &quot;suspend[ing] its execution temporarily in order to run another program&quot;. It's not well-designed or suitable for any serious tasks (the POSIX requirements for it make it fundamentally non-thread-safe, it doesn't admit asynchronous events to be handled by the calling program while the other program is running, etc.) and its use is error-prone (safe construction of command string is difficult) and non-portable (because the particular form of command strings is implementation-defined, though POSIX defines this for POSIX-conforming implementations).</p>\n<p>If C were being designed today, it almost certainly would not include <code>system</code>, and would either leave this type of functionality entirely to the implementation and its library extensions, or would specify something more akin to <code>posix_spawn</code> and related interfaces.</p>\n"}], "owner": {"reputation": 1082, "user_id": 7171141, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bae7d2c038134a93ef6e2bc5ec860754?s=128&d=identicon&r=PG&f=1", "display_name": "Orion", "link": "https://stackoverflow.com/users/7171141/orion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 51867211, "answer_count": 3, "score": 4, "last_activity_date": 1585941097, "creation_date": 1534367659, "last_edit_date": 1534368160, "question_id": 51866536, "link": "https://stackoverflow.com/questions/51866536/why-does-system-exist", "title": "Why does system() exist?", "body": "<p>Many papers and such mention that calls to 'system()' are unsafe and unportable. I do not dispute their arguments.</p>\n\n<p>I have noticed, though, that many Unix utilities have a C library equivalent. If not, the source is available for a wide variety of these tools.</p>\n\n<p>While many papers and such recommend against <code>goto</code>, there are those who can make an argument for its use, and there are simple reasons why it's in C at all.</p>\n\n<p>So, why do we need <code>system()</code>? How much existing code relies on it that can't easily be changed?</p>\n"}, {"tags": ["c", "compilation"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1534367443, "post_id": 51866433, "comment_id": 90685111, "body": "I could not find proper dupes, but <a href=\"https://www.geeksforgeeks.org/difference-header-file-library/\" rel=\"nofollow noreferrer\">here&#39;s an external link that explainds the difference between include files and libraries</a>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1534372095, "post_id": 51866433, "comment_id": 90686502, "body": "The nominated duplicate <a href=\"https://stackoverflow.com/questions/26562335/what-is-the-difference-between-include-and-link-when-linking-to-a-library\" title=\"what is the difference between include and link when linking to a library\">stackoverflow.com/questions/26562335/&hellip;</a> answers the rather poorly worded question in the title (now modified by me), but the body indicates that this is in fact a different question."}], "answers": [{"tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 1, "last_activity_date": 1534367400, "creation_date": 1534367400, "answer_id": 51866485, "question_id": 51866433, "link": "https://stackoverflow.com/questions/51866433/why-do-some-system-libraries-require-a-l-option-while-others-do-not/51866485#51866485", "title": "Why do some system libraries require a -l option while others do not?", "body": "<p>For this file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n  return 0;\n}\n</code></pre>\n\n<p>run</p>\n\n<pre><code>gcc -v -o simple simple.c\n</code></pre>\n\n<p>and you will see what, actually, gcc does. You will see that it links with libraries behind your back. This is why you don't specify system libraries explicitly.</p>\n"}, {"tags": [], "owner": {"reputation": 8071, "user_id": 5230735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97305d39e366bd0cf7e0e9bf5b19c179?s=128&d=identicon&r=PG&f=1", "display_name": "ralf htp", "link": "https://stackoverflow.com/users/5230735/ralf-htp"}, "is_accepted": false, "score": 0, "last_activity_date": 1534367937, "last_edit_date": 1534367937, "creation_date": 1534367494, "answer_id": 51866502, "question_id": 51866433, "link": "https://stackoverflow.com/questions/51866433/why-do-some-system-libraries-require-a-l-option-while-others-do-not/51866502#51866502", "title": "Why do some system libraries require a -l option while others do not?", "body": "<p>the <code>-l</code> option is for <em>linking against an external library</em> in this case <code>libpthread</code>, against system libraries is linked by default</p>\n\n<p><a href=\"http://www.network-theory.co.uk/docs/gccintro/gccintro_17.html\" rel=\"nofollow noreferrer\">http://www.network-theory.co.uk/docs/gccintro/gccintro_17.html</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/3078602/c-how-to-add-external-libraries\">C++: How to add external libraries</a></p>\n"}, {"tags": [], "owner": {"reputation": 629, "user_id": 7793418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s7lrt.jpg?s=128&g=1", "display_name": "Jim M.", "link": "https://stackoverflow.com/users/7793418/jim-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1534367661, "creation_date": 1534367661, "answer_id": 51866537, "question_id": 51866433, "link": "https://stackoverflow.com/questions/51866433/why-do-some-system-libraries-require-a-l-option-while-others-do-not/51866537#51866537", "title": "Why do some system libraries require a -l option while others do not?", "body": "<p><strong>Basic Answer</strong>: -lpthreads tells the compiler/linker to link to the pthreads library. </p>\n\n<p><strong>Longer answer</strong><br>\nHeaders tell the compiler that a certain function is going to be available (sometimes that function is defined in the header, perhaps inline) when the code is later linked. So the compiler marks the function essentially available but later during the linking phase the linker has to connect the function call to an actual function. A lot of function in the system headers are part of the \"C Runtime Library\" your linker automatically uses but others are provided by external libraries (such as pthreads). In the case where it is provided by an external library you have to use the '-lxxx' so the compiler/linker knows which external library to include in the process so it gets the address of the functions correctly.</p>\n\n<p>Hope that helps</p>\n"}, {"tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": false, "score": 1, "last_activity_date": 1534367746, "creation_date": 1534367746, "answer_id": 51866549, "question_id": 51866433, "link": "https://stackoverflow.com/questions/51866433/why-do-some-system-libraries-require-a-l-option-while-others-do-not/51866549#51866549", "title": "Why do some system libraries require a -l option while others do not?", "body": "<p>A C header file does not contain the implementations of the functions. It only contains function prototypes, so that the compiler could generate proper function calls. </p>\n\n<p>The actual implementation is stored in a library. The most commonly used functions (such as <code>printf</code> and <code>malloc</code>) are implemented in the Standard C Library (LibC), which is implicitly linked to any executable file unless you request not to link it. The threads support is implemented in a separate library that has to be linked explicitly by passing the <code>-pthread</code> option to the linker.</p>\n\n<p>NB: You can pass the option <code>-pthread</code> to the compiler <a href=\"https://stackoverflow.com/questions/23250863/difference-between-pthread-and-lpthread-while-compiling\">that will also link the appropriate library</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "is_accepted": false, "score": 0, "last_activity_date": 1534367854, "creation_date": 1534367854, "answer_id": 51866567, "question_id": 51866433, "link": "https://stackoverflow.com/questions/51866433/why-do-some-system-libraries-require-a-l-option-while-others-do-not/51866567#51866567", "title": "Why do some system libraries require a -l option while others do not?", "body": "<p>Some library files are are searched by default, simply for convenience, basically the C standard library. Linkers have options to disable this convenience and have no default libraries (for if you are doing something unusual and don't want them). Non-default libraries, you have to tell linker to use them.</p>\n\n<p>There <em>could</em> be a mechanism to tell what libraries are needed in the source code (include files are plain text which is just \"copy-pasted\" at #include line), there's no technical difficulty. But there just isn't (as far as I know, not even as non-standard compiler extension).</p>\n\n<p>There are some solutions to the problem though, such as <em>pkg-config</em> for unixy platforms, which tackle the problem of include and library files by providing the compiler and linker options for a library easily.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1534411576, "last_edit_date": 1534411576, "creation_date": 1534371997, "answer_id": 51867281, "question_id": 51866433, "link": "https://stackoverflow.com/questions/51866433/why-do-some-system-libraries-require-a-l-option-while-others-do-not/51867281#51867281", "title": "Why do some system libraries require a -l option while others do not?", "body": "<p>The compiler links the standard C library libc.a implicitly so a <code>-lc</code> argument is not necessary.  Pthreads is a <em>system library</em> but not a part of the C standard library, so must be explicitly linked.</p>\n\n<p>If you were to specify <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html\" rel=\"nofollow noreferrer\"><code>-nolibc</code></a> you would then need to explicitly link libc (or some alternative C library).</p>\n\n<p>If all system libraries were linked implicitly, gcc would have to be have a different implementation for each system (for example pthreads is not a system library on Windows), and if a system introduced a new library, gcc would have to change in lock step.  Moreover the link time would increase as each library were searched in some unknown sequence to resolve symbols.  The C standard library is the one library the compiler can rely on to be provided in any particular implementation, so implicit linking is generally safe and a simple convenience.</p>\n"}], "owner": {"reputation": 73, "user_id": 10231337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af52ed9da0b39919281aac44cb43e26?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10231337/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1534411576, "creation_date": 1534367147, "last_edit_date": 1534372051, "question_id": 51866433, "link": "https://stackoverflow.com/questions/51866433/why-do-some-system-libraries-require-a-l-option-while-others-do-not", "title": "Why do some system libraries require a -l option while others do not?", "body": "<p>I recently took a class where we used pthreads and when compiling we were told to add <code>-lpthread</code>. But how come when using other <code>#include &lt;&gt;</code> statements for system header files, it seems that the linking of the object implementation code happens automatically? For example, if I just want to get the header file <code>#include &lt;stdio.h&gt;</code>, I don't need a <code>-l</code> option in compilation, the linking of that <code>.o</code> implementation file file just happens.</p>\n"}, {"tags": ["c", "math", "equations"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1534364209, "post_id": 51865782, "comment_id": 90683790, "body": "Welcome to stackoverflow.com. Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1534364225, "post_id": 51865782, "comment_id": 90683803, "body": "Also please read <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>, and all of <a href=\"http://idownvotedbecau.se/\" rel=\"nofollow noreferrer\">idownvotedbecau.se</a> to learn some reasons your question might be down-voted. Finally, please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1534364285, "post_id": 51865782, "comment_id": 90683827, "body": "And lastly a possible hint about your problem: You&#39;re doing <i>integer arithmetic</i>. Integers don&#39;t have decimals, all operations will <i>truncate</i> the resulting values (i.e. cut of any decimals). You should probably read through your class-notes, tutorials or text books more thoroughly."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1534364367, "post_id": 51865782, "comment_id": 90683870, "body": "You are using integer arithmetic. If the denominator  is <code>&gt;</code> numerator the result will be <code>0</code>. <b>Please post the input values and expected output</b>."}, {"owner": {"reputation": 94, "user_id": 10055202, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P15uv.jpg?s=128&g=1", "display_name": "RogerVieiraa", "link": "https://stackoverflow.com/users/10055202/rogervieiraa"}, "edited": false, "score": 1, "creation_date": 1534364372, "post_id": 51865782, "comment_id": 90683875, "body": "Here is working normal, can u say an example that you get 0. When the division result is 0.54... or other decimal started at 0, the result show will be 0. You can try to use float/double to the x,y."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1534366229, "post_id": 51865782, "comment_id": 90684648, "body": "All of the variables should be <code>double</code>. It then follows that the scanfs and printfs need to use <code>%lf</code>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1534382252, "post_id": 51865782, "comment_id": 90688623, "body": "possible duplicate of <a href=\"https://stackoverflow.com/q/8906722/995714\">Why does division result in zero instead of a decimal?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1534364554, "post_id": 51865864, "comment_id": 90683955, "body": "Please expand the answer to explain what&#39;s wrong with using <code>int</code>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1534365516, "post_id": 51865864, "comment_id": 90684347, "body": "Operations on <code>int</code> are <i>not</i> &quot;rounded to the nearest whole number&quot;.  They are truncated toward zero - <code>9&#47;10 == 0</code> and <code>-19&#47;10 == -1</code> for example."}], "tags": [], "owner": {"reputation": 347, "user_id": 9939363, "user_type": "registered", "profile_image": "https://graph.facebook.com/429081247565798/picture?type=large", "display_name": "Joe Vanjik", "link": "https://stackoverflow.com/users/9939363/joe-vanjik"}, "is_accepted": false, "score": 3, "last_activity_date": 1534365762, "last_edit_date": 1534365762, "creation_date": 1534364425, "answer_id": 51865864, "question_id": 51865782, "link": "https://stackoverflow.com/questions/51865782/write-a-c-program-that-computes-the-solutions-for-x-and-y-in-the-linear-system-o/51865864#51865864", "title": "Write a C program that computes the solutions for x and y in the linear system of equations", "body": "<p>Maybe you need to change the type for x and y variables from int to float or double if you want accurate/precise results for x and y.</p>\n\n<p>Using int type will not show you same results like float/double type because it won't show you numbers after decimal point instead it's truncated towards zero, yielding largest whole number which is smaller that floating point number for numbers greater than zero, and smallest whole number which is larger than floating number for numbers below zero.</p>\n"}], "owner": {"reputation": 19, "user_id": 10231095, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iihu6DXrqdU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qpj-iaGXBq6-LXk4ELuV2uVCv4Zg/mo/photo.jpg?sz=128", "display_name": "wty", "link": "https://stackoverflow.com/users/10231095/wty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1534365762, "creation_date": 1534364068, "question_id": 51865782, "link": "https://stackoverflow.com/questions/51865782/write-a-c-program-that-computes-the-solutions-for-x-and-y-in-the-linear-system-o", "title": "Write a C program that computes the solutions for x and y in the linear system of equations", "body": "<p>what's wrong with my code that i can't get the values for x and y, assume that the denominator is not zero. \ni can't get constant values of x and y, most of the time its equal to zero.\na1x + b1y = c1\na2x + b2y = c2</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint main()\n{\n /* Write your program code here */\n int a1,b1,c1,a2,b2,c2,x,y;\n printf(\"Enter the value for a1: \\n\");\n scanf(\"%d\", &amp;a1);\n printf(\"Enter the value for b1: \\n\");\n scanf(\"%d\", &amp;b1);\n printf(\"Enter the value for c1: \\n\");\n scanf(\"%d\", &amp;c1);\n printf(\"Enter the value for a2: \\n\");\n scanf(\"%d\", &amp;a2);\n printf(\"Enter the value for b2: \\n\");\n scanf(\"%d\", &amp;b2);\n printf(\"Enter the value for c2: \\n\");\n scanf(\"%d\", &amp;c2);\n x=((b2*c1)-(b1*c2))/((a1*b2)-(a2*b1));\n printf(\"x is %d\\n\", x);\n y=((a1*c2)-(a2*c1))/((a1*b2)-(a2*b1));\n printf(\"y is %d\\n\", y);\n return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "select", "openssl"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 1, "creation_date": 1534365463, "post_id": 51865694, "comment_id": 90684321, "body": "If the SSL client properly closes the connection it should send a <code>close_notify</code> alert before closing the transport."}, {"owner": {"reputation": 5, "user_id": 6609378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1930b0ad62290ff08e0035bce98ead25?s=128&d=identicon&r=PG&f=1", "display_name": "cmlink", "link": "https://stackoverflow.com/users/6609378/cmlink"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1534366496, "post_id": 51865694, "comment_id": 90684749, "body": "Hmm, I call <code>SSL_shutdown()</code> prior to closing the connection, which is supposed to send the <code>close_notify</code> alert (<a href=\"https://www.openssl.org/docs/man1.1.0/ssl/SSL_shutdown.html\" rel=\"nofollow noreferrer\">openssl.org/docs/man1.1.0/ssl/SSL_shutdown.html</a>).  I guess the next step is for me to figure out why the client is failing to send the alert or why the server is not receiving the alert."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1534369077, "post_id": 51865694, "comment_id": 90685642, "body": "@cmlink did you verify with a packet sniffer, like Wireshark, that the alert is actually being sent out, and that OpenSSL is also sending a TCP <code>FIN</code> packet to the other party?"}, {"owner": {"reputation": 5, "user_id": 6609378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1930b0ad62290ff08e0035bce98ead25?s=128&d=identicon&r=PG&f=1", "display_name": "cmlink", "link": "https://stackoverflow.com/users/6609378/cmlink"}, "edited": false, "score": 0, "creation_date": 1534370089, "post_id": 51865694, "comment_id": 90685978, "body": "I haven&#39;t taken Wireshark to it yet, I was just checking out all of the SSL_shutdown return codes and error codes first.  It appears that the server is receiving the <code>close_notify</code> because the client&#39;s <code>SSL_shutdown()</code> returns 1, but the server&#39;s <code>SSL_shutdown</code> gives me an <code>SSL_ERROR_SYSCALL</code>.  As suggested in your answer, I need to dig a little deeper into OpenSSL&#39;s quirks, but I&#39;ll keep you posted."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6609378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1930b0ad62290ff08e0035bce98ead25?s=128&d=identicon&r=PG&f=1", "display_name": "cmlink", "link": "https://stackoverflow.com/users/6609378/cmlink"}, "edited": false, "score": 0, "creation_date": 1534373388, "post_id": 51866774, "comment_id": 90686804, "body": "This is a good answer, the only thing I might disagree with is the &quot;stop code&quot; being improperly designed.  Because TCP is stream-based, I think it could deliver pieces of a command in separate segments to the application - which if the segmentation occurred in the random data portion of the command and the random data delivered at the beginning of the next read began with the &quot;stop code&quot;, it could be misinterpreted by the server as a &quot;stop code&quot; instead of a continuation of the previous command.  I haven&#39;t actually encountered this problem, but it was just a thought I had."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 5, "user_id": 6609378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1930b0ad62290ff08e0035bce98ead25?s=128&d=identicon&r=PG&f=1", "display_name": "cmlink", "link": "https://stackoverflow.com/users/6609378/cmlink"}, "edited": false, "score": 0, "creation_date": 1534380253, "post_id": 51866774, "comment_id": 90688247, "body": "Only if the code is processing the individual segments by themselves instead of processing whole messages, like it should be. Network protocols, especially over streaming transports like TCP, require structured messaging, regardless of any segmentation performed underneath. If your protocol is designed correctly, and is being processed correctly, then the segmentation would be pieced back together and only whole messages processed. Random data would never be seen as a &quot;stop code&quot;, only a valid &quot;stop code&quot; message would be. Every TCP app/library has to deal with this issue the correct way"}, {"owner": {"reputation": 5, "user_id": 6609378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1930b0ad62290ff08e0035bce98ead25?s=128&d=identicon&r=PG&f=1", "display_name": "cmlink", "link": "https://stackoverflow.com/users/6609378/cmlink"}, "edited": false, "score": 0, "creation_date": 1534786111, "post_id": 51866774, "comment_id": 90821592, "body": "I&#39;m going to accept this answer because it answers my questions pretty directly.  For those curious, the problem actually ended up being that the quiet shutdown mode (SSL_CTX_set_quiet_shutdown) was being set, thus the client did not send the <code>close_notify</code> alert... so always remember to check your initialization if your shutdown isn&#39;t working properly :/"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1534368885, "creation_date": 1534368885, "answer_id": 51866774, "question_id": 51865694, "link": "https://stackoverflow.com/questions/51865694/how-to-notify-server-that-client-is-closing-connection/51866774#51866774", "title": "How to notify server that client is closing connection", "body": "<blockquote>\n  <p>The way I planned on handling the client closing the connection was to have the <code>select()</code> break due to activity on the socket (closing it from the client-side), see that the <code>fd</code> was set for that socket, and then try to read from it - and if the read returned 0, then close the connection. However, because the <code>select()</code> doesn't always return when the client side closes the connection, there is no attempt to check the <code>fd_set</code> and subsequently try to read from the socket.</p>\n</blockquote>\n\n<p>Regardless of whether you are using SSL or not, <code>select()</code> can tell you when the socket is readable (has data available to read), and a <strong>graceful</strong> closure is a readable condition (a subsequent read operation reports 0 bytes read).  It is only <strong>abnormal</strong> disconnects that <code>select()</code> can't report (unless you use the <code>exceptfds</code> parameter, but even that is not always guaranteed).  The best way to handle abnormal disconnects is to simply use timeouts in your own code.  If you don't receive data from the client for awhile, just close the connection.  The client will have to send data periodically, such as a small heartbeat command, if it wants to stay connected.</p>\n\n<p>Also, when using OpenSSL, if you are using the older <code>ssl_...</code> API functions (<code>ssl_new()</code>, <code>ssl_set_fd()</code>, <code>ssl_read()</code>, <code>ssl_write()</code>, etc), make sure you are NOT just blindly calling <code>select()</code> whenever you want, that you call it ONLY when OpenSSL tells you to (when an SSL read/write operation reports an <code>SSL_ERROR_WANT_(READ|WRITE)</code> error).  This is an area where alot of OpenSSL newbies tend to make the same mistake.  They try to use OpenSSL on top of pre-existing socket logic that waits for a readable notification before then reading data.  This is the wrong way to use the <code>ssl_...</code> API.  You are expected to ask OpenSSL to perform a read/write operation unconditionally, and then if it needs to wait for new data to arrive, or pending data to send out, it will tell you and you can then call <code>select()</code> accordingly before retrying the SSL read/write operation again.</p>\n\n<p>On the other hand, if you are using the newer <code>bio_...</code> API functions (<code>bio_new()</code>, <code>bio_read()</code>, <code>bio_write()</code>, etc), you can take control of the underlying socket I/O and not let OpenSSL manage it for you, thus you can do whatever you want with <code>select()</code> (or any other socket API you want).</p>\n\n<blockquote>\n  <p>As a workaround, I implemented a \"stop code\" that the client writes to the server just before closing the connection, and this write causes the <code>select()</code> to break and the server reads the \"stop code\" and knows to close the socket.</p>\n</blockquote>\n\n<p>That is a very common approach in many Internet protocols, regardless of whether SSL is used or not.  It is a very distinct and explicit way for the client to say \"I'm done\" and both parties can then close their respective sockets.</p>\n\n<blockquote>\n  <p>The only problem with this solution is the \"stop code\" is an arbitrary string of bytes that could potentially appear in regular traffic, as the normal data being written can contain random strings that could potentially contain the \"stop code\".</p>\n</blockquote>\n\n<p>Then either your communication protocol is not designed properly, or your code is not processing the protocol correctly.  In a properly-designed and correctly-processed protocol, there will not be any such ambiguity.  There needs to be a clear distinction between the various commands that your protocol defines.  Your \"stop code\" would be one such command amongst other commands.  Random data in one command should not be mistakenly treated as a different command.  If you are experiencing that problem, you need to fix it.</p>\n"}], "owner": {"reputation": 5, "user_id": 6609378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1930b0ad62290ff08e0035bce98ead25?s=128&d=identicon&r=PG&f=1", "display_name": "cmlink", "link": "https://stackoverflow.com/users/6609378/cmlink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 51866774, "answer_count": 1, "score": 0, "last_activity_date": 1534368885, "creation_date": 1534363610, "question_id": 51865694, "link": "https://stackoverflow.com/questions/51865694/how-to-notify-server-that-client-is-closing-connection", "title": "How to notify server that client is closing connection", "body": "<p>I have a server that is running a <code>select()</code> loop that sometimes continues blocking when the client closes the connection from its side.  The <code>select()</code> loop handles all other read/write operations correctly and sets the correct file descriptor in the <code>fd_set</code>, leading me to believe that it is not an issue with the file descriptor setup on the server-side.  </p>\n\n<p>The way I planned on handling the client closing the connection was to have the <code>select()</code> break due to activity on the socket (closing it from the client-side), see that the fd was set for that socket, and then try to read from it - and if the read returned 0, then close the connection.  However, because the <code>select()</code> doesn't always return when the client side closes the connection, there is no attempt to check the <code>fd_set</code> and subsequently try to read from the socket.  </p>\n\n<p>As a workaround, I implemented a \"stop code\" that the client writes to the server just before closing the connection, and this write causes the <code>select()</code> to break and the server reads the \"stop code\" and knows to close the socket.  The only problem with this solution is the \"stop code\" is an arbitrary string of bytes that could potentially appear in regular traffic, as the normal data being written can contain random strings that could potentially contain the \"stop code\".  Is there a better way to handle the client closing the connection from its end?  Or is the method I described the general \"best practice\"?</p>\n\n<p>I think my issue has something to do with OpenSSL, as the connection in question is an OpenSSL tunnel, and it is the only file descriptor in the set giving me issues.</p>\n"}, {"tags": ["c", "interrupt", "stm32", "uart", "stm32-hal"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534403656, "post_id": 51866472, "comment_id": 90694329, "body": "I didn&#39;t actually get you. I am using interrupt for transmitting, what is callback how do i implement it? What is blocking functions? If i am using interrupts then isn&#39;t my communication is happening in the background?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534404608, "post_id": 51866472, "comment_id": 90694896, "body": "@EhsanHabib the general rule is: do not use something if you do not understand it. Give me a clue why interrupt? What did you want to archive?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534404661, "post_id": 51866472, "comment_id": 90694933, "body": "@EhsanHabib use normal blocking function. Not IT or DMA ones and you will get what you want"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534405865, "post_id": 51866472, "comment_id": 90695630, "body": "@EhsanHabib Imagine that you are company drier. Your boss (main program) tells you to go to the airport to pick up someone. When you start the engine the same boss calls you and tells to go to the warehouse and deliver something. After another minuted he says you to pick up his children from the school and after another minuet to go to the shop and him some cigarettes. When you bring the cigarettes you get fired bacause you did not go to the airport, you did not deliver, and you did not pick-up his children. And only because he did not wait until you completed the particular tasks"}, {"owner": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534406458, "post_id": 51866472, "comment_id": 90695927, "body": "okay i get it. So before sending another string i need to wait till the last string is completely sent. Should i wait like this <code>while (HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)buff,6) == HAL_BUSY)\twait++;</code> or is there any flag i should be waiting for?"}, {"owner": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534406536, "post_id": 51866472, "comment_id": 90695969, "body": "Ok i didn&#39;t see the edit. Let me try this. I will let you know the results"}, {"owner": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534408889, "post_id": 51866472, "comment_id": 90697290, "body": "I got confused while implementing <code>HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)</code> instead i just waited till <code>HAL_UART_Transmit_IT()</code> is busy. But i guess it&#39;s similar to the blocking function. Though things are working, if possible i would like to know how to implement  <code>HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)</code>."}, {"owner": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534409039, "post_id": 51866472, "comment_id": 90697388, "body": "I know that after going to uart irq the call will go to this <code>HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)</code> function. So should i just write <code>HAL_UART_Transmit_IT()</code> inside callback method? I don&#39;t know what should i do."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "edited": false, "score": 0, "creation_date": 1534409115, "post_id": 51866472, "comment_id": 90697425, "body": "No! forget the IT functions in this case in the callback you need to set the flag and poll for this flag your code. It is nonsense in this case"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 3, "last_activity_date": 1534409558, "last_edit_date": 1592644375, "creation_date": 1534367324, "answer_id": 51866472, "question_id": 51865604, "link": "https://stackoverflow.com/questions/51865604/multiple-string-transmit-over-usart-using-cubemx/51866472#51866472", "title": "multiple string transmit over USART using CubeMx", "body": "<p>You need to wait for the callback, which indicates the end of transmission . It is the interrupt function which is executed asynchronously. It does not have a chance to send even a single byte.</p>\n<p>You just override the buffer and start the transmission over.</p>\n<p>For this kind of messages, use blocking functions. Use DMA or interrupt ones when your main program is doing something during the communication, and you want the communication to be done in the background.</p>\n<h1>Edit</h1>\n<p>Some explanation.\nHAL interrupt functions do not wait until the transmission is completed. They return <strong>immediately</strong> to the caller and the communication is completed in the background. The main program can execute in parallel doing another tasks.\nWhen all bytes are sent (or on error) HAL library invokes the appropriate callback. For end of transmission it is: <code>void HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)</code></p>\n<p>Because of the asynchronous execution if you want to start another transmission you need to know if the previous one has already completed.</p>\n<h1>Edit 2</h1>\n<p>In this case it does not make any sense to send asynchronously. You need to wait for the end of the previous transmissions:</p>\n<pre><code>volatile int USART3TransferCompleted;\n\nvoid HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)\n{\n    USART3TransferCompleted = 1; // this functions should check the instance as well\n}\n</code></pre>\n<p>and in main function:</p>\n<pre><code>        USART3TransferCompleted = 0;\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)&quot;OK\\r\\n &quot;,5);\n        while(!USART3TransferCompleted);\n        USART3TransferCompleted = 0;\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)buff,5);\n        while(!USART3TransferCompleted);\n        ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12302178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3af39df348151a9af135627078d88350?s=128&d=identicon&r=PG", "display_name": "ufo", "link": "https://stackoverflow.com/users/12302178/ufo"}, "is_accepted": false, "score": 0, "last_activity_date": 1572512880, "creation_date": 1572512880, "answer_id": 58639930, "question_id": 51865604, "link": "https://stackoverflow.com/questions/51865604/multiple-string-transmit-over-usart-using-cubemx/58639930#58639930", "title": "multiple string transmit over USART using CubeMx", "body": "<pre><code>if(HAL_UART_Transmit(&amp;huart2, (uint8_t*)aTxBuffer, TXBUFFERSIZE, 5000)!= HAL_OK)\n    {\n      Error_Handler();\n    }\n</code></pre>\n\n<p>use this HAL function without callback interrupt.</p>\n"}, {"comments": [{"owner": {"reputation": 1050, "user_id": 4720292, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ab9634db96cbb4bc54c10cbe276ae411?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/4720292/pierre"}, "edited": false, "score": 1, "creation_date": 1602857639, "post_id": 64390835, "comment_id": 113861101, "body": "Please use comments to thank others or ask more details :)"}, {"owner": {"reputation": 1, "user_id": 14462928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c31bc87753f87046aeda7615380ba7?s=128&d=identicon&r=PG&f=1", "display_name": "RTOS", "link": "https://stackoverflow.com/users/14462928/rtos"}, "reply_to_user": {"reputation": 1050, "user_id": 4720292, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ab9634db96cbb4bc54c10cbe276ae411?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/4720292/pierre"}, "edited": false, "score": 0, "creation_date": 1618318008, "post_id": 64390835, "comment_id": 118560792, "body": "I also created an account to thanks 0___________ ,  solution above by using HAL_UART_TxCpltCallback as mention on &quot;Edit 2&quot; to wait for the end of the previous transmissions WORKS perfectly."}], "tags": [], "owner": {"reputation": 1, "user_id": 14462928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c31bc87753f87046aeda7615380ba7?s=128&d=identicon&r=PG&f=1", "display_name": "RTOS", "link": "https://stackoverflow.com/users/14462928/rtos"}, "is_accepted": false, "score": 0, "last_activity_date": 1602857425, "creation_date": 1602857425, "answer_id": 64390835, "question_id": 51865604, "link": "https://stackoverflow.com/questions/51865604/multiple-string-transmit-over-usart-using-cubemx/64390835#64390835", "title": "multiple string transmit over USART using CubeMx", "body": "<p>I created my account just to say thanks to P__J__.</p>\n<p>I struggled to send multiple HAL_UART_Transmit_IT in a row as below.</p>\n<p>HAL_UART_Transmit_IT(&amp;huart1,(uint8_t*) Test_Buffer1, length1);\nHAL_Delay (1000);\nHAL_UART_Transmit_IT(&amp;huart1,(uint8_t*) Test_Buffer2, length2);</p>\n<p>P__J__ solution above by using HAL_UART_TxCpltCallback to wait for the end of the previous transmissions WORKS perfectly.</p>\n"}], "owner": {"reputation": 105, "user_id": 10231078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Gx6TcQWl7w/AAAAAAAAAAI/AAAAAAAAMOM/fM0mkALJ_Xg/photo.jpg?sz=128", "display_name": "Ehsan Habib", "link": "https://stackoverflow.com/users/10231078/ehsan-habib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5458, "favorite_count": 0, "accepted_answer_id": 51866472, "answer_count": 3, "score": 2, "last_activity_date": 1602857425, "creation_date": 1534363141, "last_edit_date": 1534406085, "question_id": 51865604, "link": "https://stackoverflow.com/questions/51865604/multiple-string-transmit-over-usart-using-cubemx", "title": "multiple string transmit over USART using CubeMx", "body": "<p>I was trying <code>USART</code> using a <a href=\"https://www.st.com/en/microcontrollers/stm32f407vg.html\" rel=\"nofollow noreferrer\"><code>STM32F407VGT6</code></a>  and <code>CubeMX</code>.</p>\n\n<p>I am able to send and receive data using Interrupts. But I am getting a problem which I am not able to understand:</p>\n\n<p>I am using <code>HAL_UART_Transmit_IT</code> to send the data.<br>\nI have enabled <code>__HAL_UART_ENABLE_IT(&amp;huart3,UART_IT_TC);</code>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>int main(void)\n{\n  HAL_Init();\n  MX_GPIO_Init();\n  MX_USART3_UART_Init();\n  Green_Blink(100);\n  Orange_Blink(100);\n  Blue_Blink(100);\n  Red_Blink(100);\n  HAL_Delay(100);\n\n  __HAL_UART_ENABLE_IT(&amp;huart3,UART_IT_TC);\n  char buff[] = {'2','4','.','0','0'};\n  while (1)\n  {\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)\"OK\\r\\n \",5);\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)buff,5);\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)\"OK\\r\\n \",5);\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)buff,5);\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)\"OK\\r\\n \",5);\n        HAL_UART_Transmit_IT(&amp;huart3,(uint8_t*)buff,5);\n        HAL_Delay(1000);\n        Blue_Blink(100);\n\n  }\n}\n</code></pre>\n\n<p>So I am sending this kind of data. First, I am sending <code>OK</code> and then I am sending the buffer data as you can see.</p>\n\n<p>But in terminal(<em>tera term</em> in my case) I can't see the buffer data.<br>\nI can see <code>OK</code>.</p>\n\n<p>I don't know why this is happening. And how to resolve it?<br>\nAny suggestions?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 12, "creation_date": 1534362535, "post_id": 51865447, "comment_id": 90683089, "body": "<code>a = 0</code> is an assignment, not a comparison"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 2, "creation_date": 1534363170, "post_id": 51865447, "comment_id": 90683344, "body": "You&#39;re saying you don&#39;t understand why a=0 changes the value of a to 0?"}, {"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 1, "creation_date": 1534364023, "post_id": 51865447, "comment_id": 90683716, "body": "You typoed the first if.  ANd it looks like it works because the result of an assignment is the valued assigned.  Which here is 0.  So it returns false.  You should write comparissons with constants as 0==a instead so this becomes a compile time error."}, {"owner": {"reputation": 188, "user_id": 10140802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88d8d18e5e1abc6ccf68bbb17f8cc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Luke19", "link": "https://stackoverflow.com/users/10140802/luke19"}, "edited": false, "score": 0, "creation_date": 1534522413, "post_id": 51865447, "comment_id": 90749598, "body": "Doesn\u2019t look like a typo to me, since he specifically repeated the assignment operation in the following two printf calls. Seems to me he\u2019s trying to understand how exactly an assignment inside an if statement works in C. See my answer below."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1534784855, "post_id": 51865447, "comment_id": 90821064, "body": "Please mark the best answer as accepted. <a href=\"https://stackoverflow.com/help/someone-answers\">Read more here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2961, "user_id": 270142, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sS6R2.jpg?s=128&g=1", "display_name": "RasmusW", "link": "https://stackoverflow.com/users/270142/rasmusw"}, "is_accepted": false, "score": 1, "last_activity_date": 1534362632, "creation_date": 1534362632, "answer_id": 51865489, "question_id": 51865447, "link": "https://stackoverflow.com/questions/51865447/why-does-ints-value-change/51865489#51865489", "title": "Why does int&#39;s value change?", "body": "<p>0 is false, ie. not true.</p>\n\n<p>That is why the first if-statement behaves like it does.</p>\n\n<p>And a=0 assigns 0 to a, which is the reason for its value afterwards. </p>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 10055202, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P15uv.jpg?s=128&g=1", "display_name": "RogerVieiraa", "link": "https://stackoverflow.com/users/10055202/rogervieiraa"}, "is_accepted": false, "score": 5, "last_activity_date": 1534362661, "creation_date": 1534362661, "answer_id": 51865496, "question_id": 51865447, "link": "https://stackoverflow.com/questions/51865447/why-does-ints-value-change/51865496#51865496", "title": "Why does int&#39;s value change?", "body": "<p>in the first if you need to use \"==\".</p>\n\n<pre><code>if(a == 0) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 735, "user_id": 8454536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L3j8F.jpg?s=128&g=1", "display_name": "Alessandro Mautone", "link": "https://stackoverflow.com/users/8454536/alessandro-mautone"}, "is_accepted": false, "score": 2, "last_activity_date": 1534362753, "creation_date": 1534362753, "answer_id": 51865522, "question_id": 51865447, "link": "https://stackoverflow.com/questions/51865447/why-does-ints-value-change/51865522#51865522", "title": "Why does int&#39;s value change?", "body": "<p>in <code>if (a = 0)</code> your assigning value <code>0</code> to <code>a</code>.</p>\n\n<p>To do a comparison you should do in <code>if (a == 0)</code> (so with double <code>==</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 188, "user_id": 10140802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88d8d18e5e1abc6ccf68bbb17f8cc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Luke19", "link": "https://stackoverflow.com/users/10140802/luke19"}, "is_accepted": false, "score": 12, "last_activity_date": 1534363302, "last_edit_date": 1534363302, "creation_date": 1534362885, "answer_id": 51865550, "question_id": 51865447, "link": "https://stackoverflow.com/questions/51865447/why-does-ints-value-change/51865550#51865550", "title": "Why does int&#39;s value change?", "body": "<p>When you do <code>if (a = 0)</code> you are setting the variable <code>a</code> to <code>0</code>. \nIn C, this will also evaluate the expression to <code>0</code>.</p>\n\n<p>So actually that if-statement works in two steps. It's as if you did:</p>\n\n<pre><code>a = 0; //assign 0 to a\n\nif (a) {  ... } //evaluate a to check for the condition\n</code></pre>\n\n<p>In which case, since <code>a</code> is <code>0</code>, it evaluates to <code>false</code>. That's why you end up in the <code>else</code> of the first part, and in the second part <code>(a == 0)</code> evaluates to <code>true</code>!</p>\n"}, {"tags": [], "owner": {"reputation": 5947, "user_id": 2924577, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c499286ca761a5b21f3744ca229dffb0?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil", "link": "https://stackoverflow.com/users/2924577/nikhil"}, "is_accepted": false, "score": 2, "last_activity_date": 1534363638, "last_edit_date": 1534363638, "creation_date": 1534363277, "answer_id": 51865633, "question_id": 51865447, "link": "https://stackoverflow.com/questions/51865447/why-does-ints-value-change/51865633#51865633", "title": "Why does int&#39;s value change?", "body": "<pre><code>if (a = 0) \n</code></pre>\n\n<p>In the above <code>if</code> statement, first <code>0</code> is assigned to the variable <code>a</code>. Then the condition is evaluated.</p>\n\n<p>Because <code>a</code> now holds the value <code>0</code>, it is evaluated as <code>false</code> and the corresponding <code>else</code> block is executed. </p>\n\n<p><strong>In C language, <code>true</code> is represented by any numeric value not equal to <code>0</code> and <code>false</code> is represented by <code>0</code>.</strong></p>\n\n<blockquote>\n  <p>I do not understand why the int value is still recognized as 5 in the\n  first statement, but changes to 0 before the 2nd if, or why it changes\n  at all?</p>\n</blockquote>\n\n<p>Because, after execution of the first if statement, value of <code>a</code> is <code>0</code>. So, when second <code>if</code> statement is evaluated, <code>a</code> has the value <code>0</code>, and thus the condition <code>if (a == 0)</code> evaluates to <code>true</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 10231101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e300a19941107111bd818ef676c8595d?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Scuderi", "link": "https://stackoverflow.com/users/10231101/mike-scuderi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1534363638, "creation_date": 1534362445, "last_edit_date": 1534362535, "question_id": 51865447, "link": "https://stackoverflow.com/questions/51865447/why-does-ints-value-change", "title": "Why does int&#39;s value change?", "body": "<p>I have this C code:</p>\n\n<pre><code>int a = 5;\nprintf(\"a is of value %d before first if statement. \\n\", a);\nif (a = 0) {\n    printf(\"a=0 is true. \\n\");\n}\nelse{\n    printf(\"a=0 is not true. \\n\");\n}\nprintf(\"a is of value %d after first if statement. \\n\", a);\nif (a == 0){\n    printf(\"a==0 is true. \\n\");\n}\nelse{\n    printf(\"a==0 is not true. \\n\");\n}\nreturn 0;\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>a is of value 5 before first if statement.\na=0 is not true. \na is of value 0 after first if statement. \na==0 is true. \nProgram ended with exit code: 0\n</code></pre>\n\n<p>I do not understand why the int value is still recognized as 5 in the first statement, but changes to 0 before the 2nd if, or why it changes at all?</p>\n"}, {"tags": ["c", "size-t"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1534360420, "post_id": 51864819, "comment_id": 90682194, "body": "It&#39;s just a type with a standard name.  It was added to standard C (C89/C90) in large part to give a name to the type returned by the <code>sizeof</code> operator, which couldn&#39;t be mandated to be <code>unsigned int</code> or <code>unsigned long</code> because different implementations needed to use different types."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1534360535, "post_id": 51864819, "comment_id": 90682247, "body": "It is simply an unsigned integer type. You could use <code>unsigned int</code> or <code>unsigned long</code>, except which you should use varies from one C implementation to another. In some C implementations, you might even need something wider than <code>unsigned long</code> for sizes. Instead of making you guess or modify the code for each implementation, the C standard says you can use <code>size_t</code>, and it will automatically be an unsigned integer type suitable for sizes, because the C implementation is responsible for defining it appropriately."}], "owner": {"reputation": 157, "user_id": 6750582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7094192b455316bf047781164bb4724?s=128&d=identicon&r=PG&f=1", "display_name": "Tom_the_cat", "link": "https://stackoverflow.com/users/6750582/tom-the-cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "closed_date": 1534360438, "answer_count": 0, "score": 0, "last_activity_date": 1534359568, "creation_date": 1534359568, "question_id": 51864819, "link": "https://stackoverflow.com/questions/51864819/the-purpose-of-size-t-and-its-relationship-with-implementation", "closed_reason": "Duplicate", "title": "The purpose of size_t and its relationship with implementation", "body": "<p>I cannot understand the purpose of size_t and how it works. I read many articles about it, but I could not find a clear explanation, yet. For now, what I know about this data type is: </p>\n\n<ul>\n<li>It is for objects in memory.</li>\n<li>Library functions that take or return sizes expect them to be of type or have the return type of size_t. </li>\n<li>It is the result of the sizeof operator.</li>\n<li>It is defined in stddef.h, and is unsigned int type which has at least 16 bits.</li>\n</ul>\n\n<p>Please give me more information about what it does and why we need this. In addition, I saw some people mentioning that the size_t's capacity changes depends on its implementation(ex: 64bit / 32 bit system?). Please give me some information about its relationship to its implementation, too.</p>\n\n<p>Thank you for your support.</p>\n"}, {"tags": ["c++", "c", "visual-studio"], "comments": [{"owner": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 1, "creation_date": 1534357669, "post_id": 51864328, "comment_id": 90680915, "body": "You cannot run dlls directly, normally they get dynamically loaded into an exe."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1534357694, "post_id": 51864328, "comment_id": 90680926, "body": "Windows is correct. You can&#39;t run a dll directly. You probably meant to set the application (you call driver code) as the startup project instead of the dll."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1534357790, "post_id": 51864328, "comment_id": 90680963, "body": "Thank you.  I&#39;m not running the .dll directly.  I use the driver code, which is an .exe to call the .dll."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1534357833, "post_id": 51864328, "comment_id": 90680977, "body": "Your error message seems to conflict with that. Which one of these projects is the startup project?"}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1534357934, "post_id": 51864328, "comment_id": 90681029, "body": "I&#39;m exceeding stupid today.  The startup program was the .dll, not the .exe.  Thanks so much, as that took care of the problem."}], "answers": [{"comments": [{"owner": {"reputation": 578, "user_id": 6693304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/YarwI.png?s=128&g=1", "display_name": "KulaGGin", "link": "https://stackoverflow.com/users/6693304/kulaggin"}, "edited": false, "score": 0, "creation_date": 1594881792, "post_id": 51865587, "comment_id": 111282943, "body": "You can debug dlls in Visual Studio, though. Open properties of your dll project <code>Project &gt; Properties</code>, go to <code>Configuration Properties &gt; Debugging</code> tab, set <code>Attach</code> field to <code>Yes</code>. In the <code>Command</code> field set executable to which you will attach your .dll. Press <code>Apply</code> and <code>Ok</code> buttons. Open <code>Build &gt; Configuration Manager</code> menu. Set <code>Active Solution Configuration</code> to <code>Debug</code>. Now you can start your target executable and start debugging your .dll. When you will press <code>Debug &gt; Start Debugging</code>, Visual Studio will attach itself to the target process and look for your dll."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 578, "user_id": 6693304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/YarwI.png?s=128&g=1", "display_name": "KulaGGin", "link": "https://stackoverflow.com/users/6693304/kulaggin"}, "edited": false, "score": 0, "creation_date": 1594919164, "post_id": 51865587, "comment_id": 111302716, "body": "@KulaGGin Do you think the OP did all of that, ran into the error he described, then came here and asked the question he asked? I don&#39;t. However, if you are asking for an edit for better clarity, let me know what you are suggesting. If your comment is just a FYI, that&#39;s cool too."}, {"owner": {"reputation": 578, "user_id": 6693304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/YarwI.png?s=128&g=1", "display_name": "KulaGGin", "link": "https://stackoverflow.com/users/6693304/kulaggin"}, "edited": false, "score": 0, "creation_date": 1594933012, "post_id": 51865587, "comment_id": 111308728, "body": "Yep, it&#39;s just a FYI for people who will get this error trying to debug a dll. I was trying to debug a dll today and started getting this error. In my case it was because I switched to Release build configuration, and I fixed it by switching back to Debug build configuration."}], "tags": [], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "is_accepted": false, "score": 9, "last_activity_date": 1534363068, "creation_date": 1534363068, "answer_id": 51865587, "question_id": 51864328, "link": "https://stackoverflow.com/questions/51864328/unable-to-create-dlls-getting-dll-is-not-a-valid-win32-application/51865587#51865587", "title": "Unable to create DLLs: Getting DLL &quot;is not a valid Win32 application&quot;", "body": "<p>Right click the project in your solution explorer that is the project for the executable and click \"Set as startup project.\" </p>\n\n<p>Note that \"is not a valid Win32 application\" is not a compile error or a link error, it is the message you get when you tried to debug something that is not executable.</p>\n\n<p>You can only start executables. Executables consume dlls. These should be two seperate projects with two sets of corresponding project settings.</p>\n"}], "owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14272, "favorite_count": 2, "answer_count": 1, "score": 9, "last_activity_date": 1534363068, "creation_date": 1534357394, "last_edit_date": 1534357856, "question_id": 51864328, "link": "https://stackoverflow.com/questions/51864328/unable-to-create-dlls-getting-dll-is-not-a-valid-win32-application", "title": "Unable to create DLLs: Getting DLL &quot;is not a valid Win32 application&quot;", "body": "<p>As the title says, I can't create a simple DLL.  I'm using VS 2017 Community Edition Version 15.8.0.  Here is the .dll code:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"InvWin32App.h\"\n\n#include \"$StdHdr.h\"\n\nvoid Prc1()\n{\n    printf(\"ran procedure 1\\n\");\n}\n</code></pre>\n\n<p>Here is the code for the header, per the MS way to do things:</p>\n\n<pre><code>#ifdef INVWIN32APP_EXPORTS\n#define INVWIN32APP_API __declspec(dllexport)\n#else\n#define INVWIN32APP_API __declspec(dllimport)\n#endif\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n        INVWIN32APP_API  void Prc1();\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>Here is the driver code:  (Update:  The driver program is an .exe program.)</p>\n\n<pre><code>#include \"pch.h\"\n#include \"InvWin32App.h\"\n\nint main()\n{\n    Prc1();\n}\n</code></pre>\n\n<p>It can't get any simpler than this.  I get the following error message box when I try to run the code:</p>\n\n<pre><code>Unable to start program\nprogram name.dll\nprogram name.dll is not\na valid Win32 application\n</code></pre>\n\n<p>I can create .exe programs okay.  I also got the error earlier this morning when I was running VS 2017 Version 15.7.5.  Upgrading VS didn't do any good.  I also tried to compile these as .c programs, but it didn't make any difference.</p>\n\n<p>I had this problem on a couple occasions creating .exe programs using VS 2015.  I don't recall what I did, but the problem disappeared.  Any help would be appreciated.</p>\n\n<p>TIA.</p>\n"}, {"tags": ["c", "qsort"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1534357463, "post_id": 51864308, "comment_id": 90680821, "body": "<code>qsort</code> implementations are mostly open-source."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1534357845, "post_id": 51864308, "comment_id": 90680984, "body": "@EugeneSh. Given that, I am voting to close as a request for offsite resources"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1534357927, "post_id": 51864308, "comment_id": 90681028, "body": "Here is the first result from Googling &quot;glibc qsort&quot;: <a href=\"https://github.com/lattera/glibc/blob/master/stdlib/qsort.c\" rel=\"nofollow noreferrer\">github.com/lattera/glibc/blob/master/stdlib/qsort.c</a>"}, {"owner": {"reputation": 14752, "user_id": 1787973, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2853d3d7c18c97459c34b86ced8c18e2?s=128&d=identicon&r=PG", "display_name": "Maxime Ch&#233;ramy", "link": "https://stackoverflow.com/users/1787973/maxime-ch%c3%a9ramy"}, "edited": false, "score": 1, "creation_date": 1534358261, "post_id": 51864308, "comment_id": 90681176, "body": "The answer is yes."}], "answers": [{"tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 2, "last_activity_date": 1534358029, "creation_date": 1534358029, "answer_id": 51864488, "question_id": 51864308, "link": "https://stackoverflow.com/questions/51864308/how-qsort-function-works/51864488#51864488", "title": "How qsort() function works?", "body": "<blockquote>\n  <p>How does the qsort function access \"size\" bytes after the base address to get the next element? By typecasting <code>void*</code> to <code>char*</code>?</p>\n</blockquote>\n\n<p>The assumption inherent in the question is that <code>qsort</code> is itself written in C; it need not be. Let's assume that it is.</p>\n\n<p>A conversion to <code>char*</code> would be a typical way of doing it, yes, either by explicitly using a cast operator, or by assigning <code>base</code> to a local variable of type <code>char*</code>.  </p>\n\n<p>GNU C allows you to add an integer to a void pointer directly, but that is a non-portable extension to the C language.</p>\n\n<p>If you have a question about a <em>specific</em> implementation, say what implementation.</p>\n"}], "owner": {"reputation": 5, "user_id": 9153383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d27e1ca8a6df4e5efa531d4981b9a?s=128&d=identicon&r=PG&f=1", "display_name": "barzo", "link": "https://stackoverflow.com/users/9153383/barzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 1, "answer_count": 1, "score": -4, "last_activity_date": 1534358475, "creation_date": 1534357300, "last_edit_date": 1534358475, "question_id": 51864308, "link": "https://stackoverflow.com/questions/51864308/how-qsort-function-works", "title": "How qsort() function works?", "body": "<pre><code>void qsort (\n    void* base,\n    size_t num,\n    size_t size,\n    int (*compar)(const void*,const void*)\n);\n</code></pre>\n\n<p>How qsort function access \"size\" byte after adress to get next element?<br>\nBy typecasting <code>void*</code> to <code>char*</code>?</p>\n"}, {"tags": ["c", "xv6"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1534356268, "post_id": 51863984, "comment_id": 90680305, "body": "Looks weird, if you ask me. Unless this <code>readsect</code> is doing something even weirder."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1534359542, "post_id": 51863984, "comment_id": 90681784, "body": "The <i>implication</i> is that <code>readsect(a,s)</code> reads exactly <code>SECTSIZE</code> bytes from sector s to address a. I don&#39;t see how it could work doing anything else"}, {"owner": {"reputation": 3, "user_id": 10230442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YlhtO0Dmko0/AAAAAAAAAAI/AAAAAAAAAAc/C4Y9XWXaAg0/photo.jpg?sz=128", "display_name": "Debasish Das", "link": "https://stackoverflow.com/users/10230442/debasish-das"}, "reply_to_user": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1534361372, "post_id": 51863984, "comment_id": 90682592, "body": "@TimRandall Yes but the question is why does it start reading from address (pa - offset % SECTSIZE). If you look at the source code of xv6, it tries to load program segments specified in elf header (i.e start of kernel) previously read, at offset from kernel. I understand till that point but why are we subtracting the physical address and writing more than necessary ?"}, {"owner": {"reputation": 1902, "user_id": 905318, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d49e6de5a9ff5f14fda69ffc89ddc2c2?s=128&d=identicon&r=PG", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/905318/ivan-ivanov"}, "edited": false, "score": 0, "creation_date": 1586009063, "post_id": 51863984, "comment_id": 107969434, "body": "I think the comment &quot;Round down to sector boundary&quot; is misleading. As a result of this operation <code>pa</code> doesn&#39;t end up at a sector boundary at all."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10230442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YlhtO0Dmko0/AAAAAAAAAAI/AAAAAAAAAAc/C4Y9XWXaAg0/photo.jpg?sz=128", "display_name": "Debasish Das", "link": "https://stackoverflow.com/users/10230442/debasish-das"}, "edited": false, "score": 0, "creation_date": 1534361871, "post_id": 51865095, "comment_id": 90682806, "body": "I&#39;m sorry but i didn&#39;t get what you meant by &quot;it reads more than needed (as warned by the comment), to an address lower than that specified by the caller&quot;"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "reply_to_user": {"reputation": 3, "user_id": 10230442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YlhtO0Dmko0/AAAAAAAAAAI/AAAAAAAAAAc/C4Y9XWXaAg0/photo.jpg?sz=128", "display_name": "Debasish Das", "link": "https://stackoverflow.com/users/10230442/debasish-das"}, "edited": false, "score": 0, "creation_date": 1534362875, "post_id": 51865095, "comment_id": 90683230, "body": "Well, <code>readsect</code> reads complete sectors, so unless you ask for an exact multiple of <code>SECTSIZE</code>, it is going to read more than you asked for. The comment on the second line of your code warns of that. And the reason it reads to a lower address is related. If you ask for the second byte in a sector to be at address <code>a</code>, then the first byte of that sector is going to get written to address <code>a-1</code>."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1534428999, "post_id": 51865095, "comment_id": 90709801, "body": "Edited to add an example and to take on board @Eugene&#39;s correction."}], "tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": true, "score": 0, "last_activity_date": 1534428948, "last_edit_date": 1534428948, "creation_date": 1534360901, "answer_id": 51865095, "question_id": 51863984, "link": "https://stackoverflow.com/questions/51863984/xv6-bootmain-c-readseg-round-down-to-sector-boundary/51865095#51865095", "title": "xv6: bootmain.c readseg() &quot;round down to sector boundary&quot;", "body": "<p>Memory is broken down into sectors of <code>SECTSIZE</code> bytes each.\nThe code is reducing the destination address because it delegates its work to <code>readsect</code> which only reads whole sectors.\nIf it's passed an address that's not on a sector boundary, it reads more than needed (as warned by the comment), to an address lower than that specified by the caller (something <strong>not</strong> covered by the warning). This is perhaps inefficient, and potentially disastrous, but this implementation does at least put the byte that the caller asked for at the address that they specified.</p>\n\n<p>Consider the following example, with a sector size of 4 bytes. The user calls <code>readseg(pa, 2, 14);</code> and let's assume for the sake of argument that each byte in kernel memory is set to a value equal to its offset, and that pa is pointing at the second word in \"Hello world\".</p>\n\n<p><code>readsect</code> is going to be called once, and it's going to read in a 4 byte sector. The line that's causing confusion, <code>pa -= offset % SECTSIZE;</code> is how the code ensures that byte 14 ends up at the address specified by the caller (the initial value of <code>pa</code>).</p>\n\n<pre><code>    Before      After\n    'H'         'H'\n    'e'         'e'\n    'l'         'l\n    'l'         'l'\n    'o'      pa 12\n    ' '         13\n pa 'w'         14\n    'o'         15\nepa 'r'     epa 'r'\n    'l'         'l'\n    'd'         'd'\n    0           0\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10230442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YlhtO0Dmko0/AAAAAAAAAAI/AAAAAAAAAAc/C4Y9XWXaAg0/photo.jpg?sz=128", "display_name": "Debasish Das", "link": "https://stackoverflow.com/users/10230442/debasish-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 51865095, "answer_count": 1, "score": 0, "last_activity_date": 1534428948, "creation_date": 1534355771, "question_id": 51863984, "link": "https://stackoverflow.com/questions/51863984/xv6-bootmain-c-readseg-round-down-to-sector-boundary", "title": "xv6: bootmain.c readseg() &quot;round down to sector boundary&quot;", "body": "<p>Code from xv6's bootmain.c:    </p>\n\n<pre><code>// Read 'count' bytes at 'offset' from kernel into physical address 'pa'.\n// Might copy more than asked.\n\nvoid\nreadseg(uchar* pa, uint count, uint offset)\n{\n  uchar* epa;\n\n  epa = pa + count;\n\n  // Round down to sector boundary.\n  pa -= offset % SECTSIZE;\n\n  // Translate from bytes to sectors; kernel starts at sector 1.\n  offset = (offset / SECTSIZE) + 1;\n\n  // If this is too slow, we could read lots of sectors at a time.\n  // We'd write more to memory than asked, but it doesn't matter --\n  // we load in increasing order.\n  for(; pa &lt; epa; pa += SECTSIZE, offset++)\n    readsect(pa, offset);\n}\n</code></pre>\n\n<p>I dont understand the following statement:</p>\n\n<pre><code>pa -= offset % SECTSIZE;\n</code></pre>\n\n<p>What exactly does \"Round down to sector boundary\" mean ?\nI don't understand why we are subtracting the physical address (when offset is not zero).</p>\n\n<p>For simplicity, let's say pa = 100 (decimal), count = 50, offset = 5, SECTSIZE = 100.</p>\n\n<p>Then epa becomes 100 + (50*1) = 150. </p>\n\n<p>new pa = 100 - (5%100) = 95. (What's the point ?)</p>\n\n<p>The loop runs 3 times (1 sector more than necessary, why it doesn't matter ?)</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "threadpool", "pthread-join"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1534354983, "post_id": 51863739, "comment_id": 90679620, "body": "A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is needed. The symptoms you describe indicate some sort of undefined behavior. We won&#39;t be able to see that without a complete set of code (by which I mean a set of code that can be compiled and run, but as short as possible)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1534355023, "post_id": 51863739, "comment_id": 90679643, "body": "First thing is to understand what <code>3</code> means. This is where the <code>man</code> pages are helping."}, {"owner": {"reputation": 409, "user_id": 10181236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5bQoI5Vh3P0/AAAAAAAAAAI/AAAAAAAAB_c/z8TUCALIFNk/photo.jpg?sz=128", "display_name": "JayJona", "link": "https://stackoverflow.com/users/10181236/jayjona"}, "edited": false, "score": 0, "creation_date": 1534356082, "post_id": 51863739, "comment_id": 90680200, "body": "Code edited, this simple code causes seg fault"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1534356102, "post_id": 51863739, "comment_id": 90680211, "body": "Your <code>printf()</code> format is expecting two values but you&#39;re only passing 1, which causes undefined behavior and all bets are off... if your compiler isn&#39;t warning you about this, remember to always compile with <code>-Wall -Wextra</code> at a minimum on gcc and clang."}, {"owner": {"reputation": 409, "user_id": 10181236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5bQoI5Vh3P0/AAAAAAAAAAI/AAAAAAAAB_c/z8TUCALIFNk/photo.jpg?sz=128", "display_name": "JayJona", "link": "https://stackoverflow.com/users/10181236/jayjona"}, "edited": false, "score": 0, "creation_date": 1534356317, "post_id": 51863739, "comment_id": 90680322, "body": "I pass 2 values to the printf, maybe you had seen the old code"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1534356770, "post_id": 51863739, "comment_id": 90680523, "body": "<code>pthread_join</code> is taking <code>void **</code> and not <code>void *</code>. And apparently <code>int s</code> might not have space to hold <code>void*</code>."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1534358479, "post_id": 51863739, "comment_id": 90681282, "body": "Your thread function has the wrong interface, your compiler could have warned you. If you use such a wrong function, all sort of things can go wrong, including returning you bogus values. Read the manual and use the interface as it is decribed there, even if you don&#39;t need the function parameter for your small example. You should probably not use <code>thread_exit</code> there, either. The normal return from a thread function is ... <code>return</code>. Also <code>0</code> is compatible with all object pointers, no need for a cast."}], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 10181236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5bQoI5Vh3P0/AAAAAAAAAAI/AAAAAAAAB_c/z8TUCALIFNk/photo.jpg?sz=128", "display_name": "JayJona", "link": "https://stackoverflow.com/users/10181236/jayjona"}, "edited": false, "score": 0, "creation_date": 1534435486, "post_id": 51864373, "comment_id": 90713845, "body": "this code works if you don&#39;t use the printf to print value &gt;cast from pointer to integer of different size [-Werror=pointer-to-int-cast] printf(&quot;thread %d returned %d\\n&quot;, i, (int)value);"}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 0, "last_activity_date": 1534440425, "last_edit_date": 1534440425, "creation_date": 1534357578, "answer_id": 51864373, "question_id": 51863739, "link": "https://stackoverflow.com/questions/51863739/c-cant-understand-pthread-join/51864373#51864373", "title": "c - can&#39;t understand pthread_join()", "body": "<p>The problem is that you are passing the address of an <code>int</code> to a function that expects the address of a <code>void *</code>. On a 64-bit system, there's a good chance that an <code>int</code> is only 32-bits whereas a <code>void *</code> is 64-bits. So <code>pthread_join</code> ends up writing 64-bits into a location that is only big enough for 32-bits. The result is that you overwrite memory that shouldn't being changed, and all sorts of undefined behavior follows.</p>\n\n<p>Here's a way to write the code so that the second argument to <code>pthread_join</code> is actually a pointer to a <code>void *</code></p>\n\n<pre><code>for (i = 0; i &lt; THREADSINPOOL; i++)\n{\n    void *value;\n    if (pthread_join(array[i], &amp;value) == 0)\n        printf(\"thread %d returned %\" PRIiPTR \"\\n\", i, (intptr_t)value);\n    else\n        printf(\"thread %d failed\\n\", i);\n}\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 10181236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5bQoI5Vh3P0/AAAAAAAAAAI/AAAAAAAAB_c/z8TUCALIFNk/photo.jpg?sz=128", "display_name": "JayJona", "link": "https://stackoverflow.com/users/10181236/jayjona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 51864373, "answer_count": 1, "score": 1, "last_activity_date": 1534440425, "creation_date": 1534354762, "last_edit_date": 1534356034, "question_id": 51863739, "link": "https://stackoverflow.com/questions/51863739/c-cant-understand-pthread-join", "title": "c - can&#39;t understand pthread_join()", "body": "<p>I can not figure out where I'm wrong, after running the code arrived in the for where it runs the <code>pthread_join()</code> , many <code>pthread_join()</code> return with value 3 instead of 0. Furthermore, printing the value of <code>i</code> is not always consistent and this causes segmentation fault and printing several times of the same position.\nCode modified as required in the comments\nall the includes are for other parts of the program. Testing only this piece of code creates segmentation fault at error 3 on <code>pthread_join()</code></p>\n\n<pre><code>#define _POSIX_C_SOURCE 200809L\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;pthread.h&gt;\n\n#include &lt;errno.h&gt;\n#include &lt;config.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/socket.h&gt;\n#include &lt;sys/un.h&gt;\n\nvoid *threadF(){\n    printf(\"hello\\n\");\n    pthread_exit((void*)0);     \n}\n\n\n\n\nint main(int argc, char *argv[]) {\n\n    FILE *fileconf=fopen(argv[2],\"r\"); \n    if(fileconf==NULL){\n        fprintf(stderr, \"Fopen\\n\",argv[2]);\n        return -1;\n    }\n    set_conf(fileconf); //parse fileconf and set THREADSINPOOL correctly\n\n    pthread_t array[THREADSINPOOL];\n    int i,err,s=0;\n    for(i=0;i&lt;THREADSINPOOL;i++){\n        if((err=pthread_create(&amp;array[i],NULL,&amp;threadF,NULL))!=0){\n            fprintf(stderr,\"thread\\n\");\n            exit(errno);\n        }\n    }\n\n    int tmp;\n\n    for(i=0;i&lt;THREADSINPOOL;i++){\n        tmp=pthread_join(array[i],(void *)&amp;s);\n        printf(\"thread: %lu terminated\\n tmp: %d\\n\",array[i],tmp);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1534350304, "last_edit_date": 1534350304, "creation_date": 1534348638, "answer_id": 51862201, "question_id": 51862147, "link": "https://stackoverflow.com/questions/51862147/calculating-arithmetic-and-geometric-mean-by-introducing-numbers-until-0-is-pres/51862201#51862201", "title": "Calculating Arithmetic and Geometric mean by introducing numbers until 0 is pressed", "body": "<p>Your code is asking for the number of values in advance and subsequently reading that many values.  That's not what you were asked to do.</p>\n\n<p>You need to ask for numbers in a loop and exit the loop when the number that you read is 0.  You don't even need an array:</p>\n\n<pre><code>int n = 0, i, m, j, sum=0, prod=1;\n\nwhile (1) {\n    int value;\n    scanf(\"%d\",&amp;value);\n    if (value == 0) {\n        break;\n    }\n\n    sum=sum+value;\n    prod=prod*value;\n    n++;\n}\n\nint armean=sum/n;\nfloat geomean=pow(prod,(float) 1/n);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3573167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b3a4510d3511d520d646806081e62e?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Karthik K", "link": "https://stackoverflow.com/users/3573167/sai-karthik-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1534350177, "creation_date": 1534350177, "answer_id": 51862599, "question_id": 51862147, "link": "https://stackoverflow.com/questions/51862147/calculating-arithmetic-and-geometric-mean-by-introducing-numbers-until-0-is-pres/51862599#51862599", "title": "Calculating Arithmetic and Geometric mean by introducing numbers until 0 is pressed", "body": "<ol>\n<li>You have to break the for loop when value 0 entered; so you should check for arr[i].</li>\n<li>While loop is not required.</li>\n</ol>\n\n<p>Please go through below code; this could be help full:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n\n    int n, i, m, j, arr[50], sum=0, prod=1;\n    printf(\"Enter numbers until you press number 0:\");\n    for(i=0; i&lt;50; i++)\n    {\n        scanf(\"%d\",&amp;arr[i]);\n        if (arr[i] == 0)\n        {\n            break;\n        }\n        sum=sum+arr[i];\n        prod=prod*arr[i];\n    }\n    printf (\"%d %d\\n\",sum, prod);\n    n = i+1;\n    int armean=sum/n;\n    float geomean=pow(prod,(float) 1/n);\n\n    printf(\"Arithmetic Mean = %d\\n\",armean);\n    printf(\"Geometric Mean = %f\\n\",geomean);\n    getch();\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 8950881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469013a2992468ac273582348acd78dd?s=128&d=identicon&r=PG&f=1", "display_name": "sora_s", "link": "https://stackoverflow.com/users/8950881/sora-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1534350251, "creation_date": 1534350251, "answer_id": 51862619, "question_id": 51862147, "link": "https://stackoverflow.com/questions/51862147/calculating-arithmetic-and-geometric-mean-by-introducing-numbers-until-0-is-pres/51862619#51862619", "title": "Calculating Arithmetic and Geometric mean by introducing numbers until 0 is pressed", "body": "<p>what dbush said is right, you don't need array and are not asking the number in advance but what he did not tell is how can you find the number of values</p>\n\n<pre><code>int main()\n{\nint n, sum=0, prod=1, num;\nprintf(\"Enter numbers until you press number 0:\\n\");\nfor(n=0; ; n++)\n{\n    scanf(\"%d\",&amp;num);\n    if(num==0)\n        break;\n\n    sum=sum+num;\n    prod=prod*num;\n}\nprintf(\"sum is %d \\n\",sum);\nprintf(\"prod is %d \\n\",prod);\nprintf(\"n is %d \\n\",n);\nfloat armean=sum/n; //why int?\nfloat geomean=pow(prod,(float) 1/n);\n\nprintf(\"Arithmetic Mean = %d\\n\",armean);\nprintf(\"Geometric Mean = %f\\n\",geomean);\n//getch();  why getch(), you are not using turboc are you?\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1534371694, "creation_date": 1534371694, "answer_id": 51867238, "question_id": 51862147, "link": "https://stackoverflow.com/questions/51862147/calculating-arithmetic-and-geometric-mean-by-introducing-numbers-until-0-is-pres/51867238#51867238", "title": "Calculating Arithmetic and Geometric mean by introducing numbers until 0 is pressed", "body": "<p>There is no need for an array, but you should test if the number entered in <code>0</code> after reading it from the user. It would be better also to use floating point arithmetic to avoid arithmetic overflow, which would occur quickly on the product of values.</p>\n\n<p>In any case, you must include <code>&lt;math.h&gt;</code> for <code>pow</code> to be correctly defined, you should test the return value of <code>scanf()</code> and avoid dividing by <code>0</code> if no numbers were entered before <code>0</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\n    int n = 0;\n    double value, sum = 0, product = 1;\n    printf(\"Enter numbers, end with 0: \");\n    while (scanf(\"%lf\", &amp;value) == 1 &amp;&amp; value != 0) {\n        sum += value;\n        product *= value;\n        n++;\n    }\n    if (n &gt; 0) {\n        printf(\"Arithmetic mean = %g\\n\", sum / n);\n        printf(\"Geometric mean = %g\\n\", pow(product, 1.0 / n));\n        getch();\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10230068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-acVvZU-tRrk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ocvE9sTKwVY2NRM0UCvKV0cA0NtQ/mo/photo.jpg?sz=128", "display_name": "Oszkar Szilagyi", "link": "https://stackoverflow.com/users/10230068/oszkar-szilagyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1534371694, "creation_date": 1534348389, "last_edit_date": 1534356994, "question_id": 51862147, "link": "https://stackoverflow.com/questions/51862147/calculating-arithmetic-and-geometric-mean-by-introducing-numbers-until-0-is-pres", "title": "Calculating Arithmetic and Geometric mean by introducing numbers until 0 is pressed", "body": "<p>I have to calculate the arithmetic and geometrical mean of numbers entered by the user in C language. The algorithm works fine, but I don't know how to do the <em>enter numbers until 0 is pressed</em> part. I have tried many things but nothing works. Here is what I have tried to do until now. Thanks for the help.</p>\n\n<pre><code>int main() {\n    int n, i, m, j, arr[50], sum = 0, prod = 1;\n\n    printf(\"Enter numbers until you press number 0:\");\n    scanf(\"%d\",&amp;n);\n    while (n != 0) {\n        for (i = 0; i &lt; n; i++) {\n            scanf(\"%d\", &amp;arr[i]);\n            sum = sum + arr[i];\n            prod = prod * arr[i];\n        }\n    }\n    int armean = sum / n;\n    float geomean = pow(prod, (float)1 / n);\n\n    printf(\"Arithmetic Mean = %d\\n\", armean);\n    printf(\"Geometric Mean = %f\\n\", geomean);\n    getch();\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534346328, "post_id": 51861511, "comment_id": 90675354, "body": "Don&#39;t kill threads violently through some forced API call. Instead signal them through application logic and have them clean up their own mess before returning."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1534346427, "post_id": 51861511, "comment_id": 90675400, "body": "Using <code>pthread_detach()</code> does not terminate a thread."}, {"owner": {"reputation": 21, "user_id": 9828488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849fba9ad2a775d2059749f06a7b1d36?s=128&d=identicon&r=PG", "display_name": "rcetin", "link": "https://stackoverflow.com/users/9828488/rcetin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1534346608, "post_id": 51861511, "comment_id": 90675514, "body": "@JonathanLeffler Yes, you re right, i am misunderstood. I mean that thread is terminated but pthread_detach(pthread_self()); is also called in terminated thread."}, {"owner": {"reputation": 21, "user_id": 9828488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849fba9ad2a775d2059749f06a7b1d36?s=128&d=identicon&r=PG", "display_name": "rcetin", "link": "https://stackoverflow.com/users/9828488/rcetin"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534346943, "post_id": 51861511, "comment_id": 90675712, "body": "@Lundin actually, i used pthread_cleanup_push() function to clean dynamic allocations, when thread is cancelled by other threads or thread is terminated by itself using pthread_exit(). Is this an another way to clean messes ?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1534347844, "post_id": 51861511, "comment_id": 90676215, "body": "I know that some SO users don&#39;t worry about manually cleaning up memory, since the OS will do it for you when the process terminates. .. up to you and your application. Personally I think ti&#39;s good practice and always try to clean up after myself."}], "answers": [{"tags": [], "owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "is_accepted": false, "score": 2, "last_activity_date": 1534346178, "creation_date": 1534346178, "answer_id": 51861564, "question_id": 51861511, "link": "https://stackoverflow.com/questions/51861511/dynamic-allocation-and-release-in-thread/51861564#51861564", "title": "Dynamic Allocation and Release in thread", "body": "<p><em>You'll</em> have to free all the memory <em>you</em> allocate in a <code>pthread</code> to avoid memory leak.  Since <code>pthread</code>s have a shared memory space, and it's perfectly acceptable for them to allocate memory and then exit, returning a pointer to it, there's no way for the C compiler or the system to know that the memory is no longer in use.  </p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 5, "last_activity_date": 1534346248, "creation_date": 1534346248, "answer_id": 51861584, "question_id": 51861511, "link": "https://stackoverflow.com/questions/51861511/dynamic-allocation-and-release-in-thread/51861584#51861584", "title": "Dynamic Allocation and Release in thread", "body": "<p>The only thing that <code>pthread_detach</code> does for you is that you don't need to call <code>pthread_join</code> to clean up the internal thread data structures.  </p>\n\n<p>Any memory allocated via <code>malloc</code> still needs to be free'ed manually.  Either the thread needs to do that before it exits, or a pointer to the malloc'ed memory needs to be made available to another thread to clean up.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1534346678, "creation_date": 1534346678, "answer_id": 51861701, "question_id": 51861511, "link": "https://stackoverflow.com/questions/51861511/dynamic-allocation-and-release-in-thread/51861701#51861701", "title": "Dynamic Allocation and Release in thread", "body": "<p>Another way to view this is:  Managing memory you get via <code>malloc()</code> and similar functions such as <code>calloc()</code> is really simple.  You have to <code>free()</code> the exact value you received from <code>malloc()</code> (or <code>calloc()</code> or <code>valloc()</code> or ...).  Which thread does each operation within a process doesn't matter.</p>\n\n<p>More succinctly:</p>\n\n<p>You allocated it, you <code>free()</code> it.  Once.</p>\n"}], "owner": {"reputation": 21, "user_id": 9828488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849fba9ad2a775d2059749f06a7b1d36?s=128&d=identicon&r=PG", "display_name": "rcetin", "link": "https://stackoverflow.com/users/9828488/rcetin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1534346678, "creation_date": 1534346043, "last_edit_date": 1534346674, "question_id": 51861511, "link": "https://stackoverflow.com/questions/51861511/dynamic-allocation-and-release-in-thread", "title": "Dynamic Allocation and Release in thread", "body": "<p>I am allocating some memory in a thread. When I call <code>pthread_detach(pthread_self());</code> the memory which is allocated for this thread by Linux should be released after thread is terminated by <code>pthread_exit();</code> or <code>pthread_cancel()</code>. </p>\n\n<p>My question is that, should I also free the memory which I allocate with malloc? Also, if other functions in thread allocate some space, should I also free this space, even if thread is terminated and  <code>pthread_detach(pthread_self());</code> is called in thread?</p>\n\n<pre><code>void *test_thread(void * arg)\n{\n    pthread_detach(pthread_self());\n\n    int *c = malloc(2048);\n    pthread_exit(NULL);\n}\n</code></pre>\n"}, {"tags": ["c", "connection", "checksum", "multiplayer", "freertos"], "comments": [{"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 1, "creation_date": 1534347088, "post_id": 51861490, "comment_id": 90675806, "body": "I don&#39;t think you need that for USB connections, since they are pretty stable. But I&#39;ll leave the answer to experts, since I never had to handle this kind of problem (corrupt data) before."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1534347196, "post_id": 51861490, "comment_id": 90675869, "body": "I would expect that USB chipsets or at least USB drivers should provide some checks for correct data and incorrect data should never reach your application."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5795021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZECRjQTAaM4/AAAAAAAAAAI/AAAAAAAAAFY/TPWw3po-5JA/photo.jpg?sz=128", "display_name": "Stefan Horvath", "link": "https://stackoverflow.com/users/5795021/stefan-horvath"}, "edited": false, "score": 0, "creation_date": 1534434994, "post_id": 51865859, "comment_id": 90713565, "body": "Thank you, I&#39;m sure the answer I need is in there somewhere."}], "tags": [], "owner": {"reputation": 761, "user_id": 10150977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hs5Iq.jpg?s=128&g=1", "display_name": "Mikhail Iakhiaev", "link": "https://stackoverflow.com/users/10150977/mikhail-iakhiaev"}, "is_accepted": true, "score": 1, "last_activity_date": 1534364403, "creation_date": 1534364403, "answer_id": 51865859, "question_id": 51861490, "link": "https://stackoverflow.com/questions/51861490/checking-for-bit-errors-in-a-usb-connection-between-two-systems-for-a-game/51865859#51865859", "title": "Checking for bit errors in a (USB) connection between two systems (for a game)", "body": "<p>If you have actual USB interfaces on both ends, then no need for error checking: the USB frames already include CRCs and USB controllers should ensure the data integrity (unless you're doing isochronous transfers, which are a bad choice for your case). Here is an article with nice pics of USB frames, along with other information:</p>\n\n<p><a href=\"https://www.totalphase.com/support/articles/200349256-USB-Background\" rel=\"nofollow noreferrer\">https://www.totalphase.com/support/articles/200349256-USB-Background</a></p>\n\n<p>If there is a USB-to-Serial on either end, then it's a different story, but most likely you won't need to worry about errors even then.</p>\n"}], "owner": {"reputation": 27, "user_id": 5795021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZECRjQTAaM4/AAAAAAAAAAI/AAAAAAAAAFY/TPWw3po-5JA/photo.jpg?sz=128", "display_name": "Stefan Horvath", "link": "https://stackoverflow.com/users/5795021/stefan-horvath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51865859, "answer_count": 1, "score": 0, "last_activity_date": 1534364403, "creation_date": 1534345964, "last_edit_date": 1534346467, "question_id": 51861490, "link": "https://stackoverflow.com/questions/51861490/checking-for-bit-errors-in-a-usb-connection-between-two-systems-for-a-game", "title": "Checking for bit errors in a (USB) connection between two systems (for a game)", "body": "<p>I'm doing a small project where I have two system communicating with each other. Here's a bit of information that might be useful for this question:</p>\n\n<ul>\n<li><p>The language I am using is C, and the game is PONG;</p></li>\n<li><p>I'm using freeRTOS on both systems. (sys1 and sys2, sys 1 has game logic,display, and controller for player1) and the systems are connected trough USB.</p></li>\n<li><p>One system has all game logic, the other one is just a controller for player 2 and also displays some game data (like which player scored or won). </p></li>\n</ul>\n\n<p><em><strong>My question</strong></em> is if it's a good idea to do bit checking (for example checksum) when I'm sending data from sys2 to sys1.This data is what moves player2. </p>\n\n<p>Currently it's only checking if the data received is 'a' , and if it is, the player moves. I'm thinking it might be good to implement something, but I couldn't find what would have the least impact on performance. As it is now, Player 2's movements lag when System2 is listening for data from system1.</p>\n"}, {"tags": ["c", "multithreading", "producer-consumer"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1534345866, "post_id": 51861200, "comment_id": 90675092, "body": "What do you think the output should be?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534347981, "post_id": 51861901, "comment_id": 90676289, "body": "I removed the two sleep calls and made buf 100 and did 200 loops.. Still the same output. It&#39;s very peculiar"}, {"owner": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534348106, "post_id": 51861901, "comment_id": 90676370, "body": "Is my execution or compilation comman wrong? cc -pthread pcb.c ./a.out"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534350515, "post_id": 51861901, "comment_id": 90677619, "body": "@AjinkyaPawar No. The output you get is valid. I guess you expected some random pattern. If you don&#39;t get that it&#39;s simply because you have no code after posting the sems"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 0, "last_activity_date": 1534348467, "last_edit_date": 1534348467, "creation_date": 1534347446, "answer_id": 51861901, "question_id": 51861200, "link": "https://stackoverflow.com/questions/51861200/producer-consumer-sync-using-two-threads-giving-unsual-serial-output/51861901#51861901", "title": "Producer consumer sync using two threads giving unsual serial output", "body": "<p>Just because one thread posts a semaphore another thread is waiting for there is no guarantee that the other thread gets to run immediately. If the first thread is very fast it may regain the semaphore before the other thread gets to run. This could be the reason you see alternating series of 5 produced and 5 consumed.</p>\n\n<p>Try making <code>buf</code> larger (e.g. 1000) and do 1500 loops in both producer and consumer (also change the <code>sem_init</code>). Then you may see another pattern. </p>\n\n<p>BTW: Remove the two sleep calls. They are done while you are holding <code>mutex</code> so the other thread can't run anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534348055, "post_id": 51861915, "comment_id": 90676338, "body": "Tried it for large values of buffer and removed the sleep calls.. still the same output.."}, {"owner": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534348096, "post_id": 51861915, "comment_id": 90676364, "body": "Is my execution or compilation comman wrong? cc -pthread pcb.c ./a.out"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534348306, "post_id": 51861915, "comment_id": 90676484, "body": "@AjinkyaPawar, it is not surprising that you get the same output if you remove the <code>sleep</code> calls altogether.  I suggested instead moving them outside the critical regions.  That is, inside the loop, but after the <code>sem_post</code>s.  This will give the other thread has a <i>much</i> better opportunity to acquire the semaphore first, and it is moreover a better model of what a real-world application would generally want to do."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534348470, "post_id": 51861915, "comment_id": 90676574, "body": "The behavior does not arise from an incorrect compilation command.  The output you describe is among those that your code naturally affords."}, {"owner": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534348642, "post_id": 51861915, "comment_id": 90676670, "body": "Thanx for the suggestion.. i removed the sleep from producer and added it to just consumer outside the critical section.. works great now"}, {"owner": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "edited": false, "score": 0, "creation_date": 1534348792, "post_id": 51861915, "comment_id": 90676742, "body": "Do u have any idea how to implement this for unbounded buffer ?"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1534347498, "creation_date": 1534347498, "answer_id": 51861915, "question_id": 51861200, "link": "https://stackoverflow.com/questions/51861200/producer-consumer-sync-using-two-threads-giving-unsual-serial-output/51861915#51861915", "title": "Producer consumer sync using two threads giving unsual serial output", "body": "<p>The fact that some thread is waiting on a semaphore does not mean that it will necessarily unblock as soon as the semaphore's value becomes nonzero, even if it's the only one waiting at that time.  Among the things that can happen is that some other thread that was not already waiting swoops in and acquires it first.</p>\n\n<p>In your code, for example, both producer and consumer post to the <code>mutex</code> semaphore and then loop around and try to acquire it again.  Unless blocked by the <em>other</em> semaphore, it is entirely possible for one thread to release <code>mutex</code> and then reacquire it without the other acquiring it in between.  The fact that your consumer and producer each seem to operate in groups of five items -- corresponding to the counts taken by the <code>empty</code> and <code>full</code> semaphores -- suggests that this is in fact what is happening.</p>\n\n<p>I would expect you to get perfect alternation if you moved the <code>sleep</code> calls outside the critical regions of your thread functions.  And you should do, because otherwise each thread has only a tiny window in which it can take over from the other.</p>\n\n<p>Additionally, although you might find perfect alternation less surprising, it, too, is somewhat odd when you've implemented a production queue longer than one item.  I mean, why would one bother with a queue if there is never more than one item in it?</p>\n\n<p>In order to see more variation in the queue capacity used, you should vary the timing of producer and consumer.  You'll likely want to implement that with a timer having finer resolution than <code>sleep()</code> provides, else your runs will take needlessly long.</p>\n"}], "owner": {"reputation": 11, "user_id": 10229894, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49NYsLLF1iI/AAAAAAAAAAI/AAAAAAAAAFI/xDqTP5EL0XQ/photo.jpg?sz=128", "display_name": "Ajinkya Pawar", "link": "https://stackoverflow.com/users/10229894/ajinkya-pawar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 51861901, "answer_count": 2, "score": 1, "last_activity_date": 1534348467, "creation_date": 1534345041, "last_edit_date": 1534345696, "question_id": 51861200, "link": "https://stackoverflow.com/questions/51861200/producer-consumer-sync-using-two-threads-giving-unsual-serial-output", "title": "Producer consumer sync using two threads giving unsual serial output", "body": "<p>I'm solving a producer / consumer problem using two threads.  I think I've done something wrong because it seems to give the same serial output every time.  What's the problem?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdbool.h&gt;\n\nsem_t empty, full, mutex;\n\nint bound[5];\nint a,b;\n\nvoid *producer(void *arg) {\n    for (int i = 0; i &lt; 15; i++) {\n        sem_wait(&amp;empty);\n        sem_wait(&amp;mutex);\n\n        printf(\"%d is produced\\n\", i);\n        sleep(1);\n\n        bound[(++a) % 5] = i;\n\n        sem_post(&amp;mutex);\n        sem_post(&amp;full);\n    }\n}\n\nvoid *consumer(void *arg) {\n    int consumed;\n\n    for (int i = 0; i &lt; 15; i++) {\n        sem_wait(&amp;full);\n        sem_wait(&amp;mutex);\n\n        consumed = bound[(++b) % 5];\n\n        printf(\"%d is consumed\\n\",consumed);\n        sleep(1);\n\n        sem_post(&amp;mutex);\n        sem_post(&amp;empty);\n    }\n}\n\nvoid main() {\n    pthread_t prod, con;\n\n    sem_init(&amp;mutex, 0, 1); \n    sem_init(&amp;full, 0, 0);  \n    sem_init(&amp;empty, 0, 5);\n\n    pthread_create(&amp;prod,NULL,producer,NULL);\n    pthread_create(&amp;con,NULL,consumer,NULL);\n\n    pthread_join(prod,NULL);\n    pthread_join(con,NULL);\n}\n</code></pre>\n\n<p>Output is like producer first consumes 5 times, then the consumer consumes them all, then producer produces again and repeat:</p>\n\n<blockquote>\n<pre><code>0 is produced\n1 is produced\n2 is produced\n3 is produced\n4 is produced\n0 is consumed\n1 is consumed\n2 is consumed\n3 is consumed\n4 is consumed\n5 is produced\n</code></pre>\n</blockquote>\n\n<p>and so on.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1534344542, "post_id": 51861023, "comment_id": 90674296, "body": "because <code>%f</code> is the format specifier to print <code>float</code>s"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1534344724, "post_id": 51861023, "comment_id": 90674407, "body": "Please note that your school is teaching you a non-standard flavour of C that has been obsolete for ~25 years, since it assumes that the completely obsolete Turbo C compiler for the completely obsolete MS DOS is used. Consider a lawsuit."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1534344730, "post_id": 51861023, "comment_id": 90674417, "body": "The <code>%d</code> format specifier does not match the type of <code>f</code>, therefore the behaviour of your program is undefined."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1535568766, "post_id": 51861023, "comment_id": 91118922, "body": "Possible dup of <a href=\"https://stackoverflow.com/q/7480097/1275169\">What happens to a float variable when %d is used in a printf?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 7, "last_activity_date": 1534344740, "creation_date": 1534344740, "answer_id": 51861106, "question_id": 51861023, "link": "https://stackoverflow.com/questions/51861023/why-is-this-code-printing-0/51861106#51861106", "title": "Why is this code printing 0?", "body": "<p>In effect, <code>%d</code> tells <code>printf</code> to look in a certain place for an integer argument. But you passed a <code>float</code> argument, which is put in a different place. The C standard does not specify what happens when you do this. In this case, it may be there was a zero in the place <code>printf</code> looked for an integer argument, so it printed \u201c0\u201d. In other circumstances, something different may happen.</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 10198372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4b9bc5a7c9a79c313cdc5e64201bea?s=128&d=identicon&r=PG&f=1", "display_name": "Caramel Bailey&#39;s", "link": "https://stackoverflow.com/users/10198372/caramel-baileys"}, "is_accepted": false, "score": -4, "last_activity_date": 1534345377, "last_edit_date": 1534345377, "creation_date": 1534344754, "answer_id": 51861109, "question_id": 51861023, "link": "https://stackoverflow.com/questions/51861023/why-is-this-code-printing-0/51861109#51861109", "title": "Why is this code printing 0?", "body": "<p>Try </p>\n\n<pre><code>printf(\"... %f\",f); \n</code></pre>\n\n<p>That's how you print <strong>float</strong> numbers.\nMaybe you only want to print x digits of <em>f</em>, eg.:</p>\n\n<pre><code>printf(\"... %.3f\" f);\n</code></pre>\n\n<p>That will print your float number with 3 digits after the dot.\nPlease read through this list:</p>\n\n<p>%c - Character</p>\n\n<p>%d or %i - Signed decimal integer</p>\n\n<p>%e - Scientific notation (mantissa/exponent) using e character</p>\n\n<p>%E - Scientific notation (mantissa/exponent) using E character</p>\n\n<p>%f - Decimal floating point</p>\n\n<p>%g - Uses the shorter of %e or %f</p>\n\n<p>%G - Uses the shorter of %E or %f</p>\n\n<p>%o - Signed octal</p>\n\n<p>%s - String of characters</p>\n\n<p>%u - Unsigned decimal integer</p>\n\n<p>%x - Unsigned hexadecimal integer</p>\n\n<p>%X - Unsigned hexadecimal integer (capital letters)</p>\n\n<p>%p - Pointer address    </p>\n\n<p>%n - Nothing printed</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3637252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b65c4cbc063b6f03012c54861e25d6?s=128&d=identicon&r=PG&f=1", "display_name": "david_fdez", "link": "https://stackoverflow.com/users/3637252/david-fdez"}, "is_accepted": false, "score": -4, "last_activity_date": 1534346141, "last_edit_date": 1534346141, "creation_date": 1534344919, "answer_id": 51861159, "question_id": 51861023, "link": "https://stackoverflow.com/questions/51861023/why-is-this-code-printing-0/51861159#51861159", "title": "Why is this code printing 0?", "body": "<p>The code is printing a 0, because you are using the format tag %d, which represents Signed decimal integer (<a href=\"http://devdocs.io/c/io/fprintf\" rel=\"nofollow noreferrer\" title=\"http://devdocs.io\">http://devdocs.io</a>).</p>\n\n<p>Could you please try</p>\n\n<pre><code>void main() {\n\n   clrscr();\n   float f=3.3;\n\n   /* In printf() I intentionaly put %d format specifier to see what type of output I may get */\n\n   printf(\"value of variable a is: %f\",f); \n   getch();\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 15, "user_id": 10229804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1913197438736491/picture?type=large", "display_name": "Neelam ", "link": "https://stackoverflow.com/users/10229804/neelam"}, "edited": false, "score": 0, "creation_date": 1534779438, "post_id": 51861194, "comment_id": 90818338, "body": "@Neelam Glad I could help.  Feel free to <a href=\"https://stackoverflow.com/help/accepted-answer\">accept this answer</a> if you found it useful."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1534345362, "last_edit_date": 1534345362, "creation_date": 1534345028, "answer_id": 51861194, "question_id": 51861023, "link": "https://stackoverflow.com/questions/51861023/why-is-this-code-printing-0/51861194#51861194", "title": "Why is this code printing 0?", "body": "<p>Using an invalid format specifier to <code>printf</code> invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  This is specified in section 7.21.6.1p9 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p>If a conversion specification is invalid, the behavior is\n  undefined.282) If any argument is not the correct type for the\n  corresponding conversion specification, the behavior is undefined.</p>\n</blockquote>\n\n<p>What this means is that you can't reliably predict what the output of the program will be.  For example, the same code on my system prints -1554224520 as the value.</p>\n\n<p>As to what's most likely happening, the <code>%d</code> format specifier is looking for an <code>int</code> as a parameter.  Assuming that an <code>int</code> is passed on the stack and that an <code>int</code> is 4 bytes long, the <code>printf</code> function looks at the next 4 bytes on the stack for the value given.  Many implementations don't pass floating point values on the stack but in registers instead, so it instead sees whatever garbage values happen to be there.  Even if a <code>float</code> is passed on the stack, a <code>float</code> and an <code>int</code> have very different representations, so printing the bytes of a <code>float</code> as an <code>int</code> will most likely not give you the same value.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534351933, "post_id": 51861623, "comment_id": 90678293, "body": "As an aside, compilers are allowed to perform automatic conversions to the correct types for <code>printf</code>. Per C 2018 7.1.4, the C standard does not define the behavior in this case, so an implementation may do whatever it likes."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 0, "last_activity_date": 1534347007, "last_edit_date": 1534347007, "creation_date": 1534346376, "answer_id": 51861623, "question_id": 51861023, "link": "https://stackoverflow.com/questions/51861023/why-is-this-code-printing-0/51861623#51861623", "title": "Why is this code printing 0?", "body": "<p>Let's look at a different example for a moment.  Suppose I write</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nchar buf[10];\nfloat f = 3.3;\nmemset(buf, 'x', f);\n</code></pre>\n\n<p>The third argument to <code>memset</code> is supposed to be an integer (actually a value of type <code>size_t</code>) telling <code>memset</code> how many characters of <code>but</code> to set to <code>'x'</code>.  But I passed a <code>float</code> value instead.  What happens?  Well, the compiler knows that the third argument is supposed to be an integer, so it automatically performs the appropriate conversion, and the code ends up setting the first three (three point <em>zero</em>) characters of <code>buf</code> to <code>'x'</code>.</p>\n\n<p>(Significantly, the way the compiler knew that the third argument of <code>memset</code> was supposed to be an integer was based on the <em>prototype function declaration</em> for <code>memset</code> which is part of the header <code>&lt;string.h&gt;</code>.)</p>\n\n<p>Now, when you called</p>\n\n<pre><code>printf(\"value of variable f is: %d\", f);\n</code></pre>\n\n<p>you might think the same thing happens.  You passed a <code>float</code>, but <code>%d</code> expects an <code>int</code>, so an automatic conversion will happen, right?</p>\n\n<p><em>Wrong.</em>  Let me say that again: <strong>Wrong</strong>.</p>\n\n<p>The perhaps surprising fact is, <code>printf</code> is different.  <code>printf</code> is special.  The compiler can't necessarily know what the right types of the arguments passed to <code>printf</code> are supposed to be, because it depends on the details of the <code>%</code>-specifiers buried in the format string.  So there are no automatic conversions to just the right type.  It's <em>your</em> job to make sure that the types of the arguments you actually pass are exactly right for the format specifiers.  If they don't match, the compiler does <em>not</em> automatically perform corresponding conversions.  If they don't match, what happens is that you get crazy, wrong results.</p>\n\n<p>(What does the prototype function declaration for <code>printf</code> look like?  It literally looks like this: <code>extern int printf(const char *, ...);</code>.  Those three dots <code>...</code> indicate a <em>variable-length argument list</em> or \"varargs\", they tell the compiler it can't know how many more arguments there are, or what their types are supposed to be.  So the compiler performs a few basic conversions -- such as upconverting types <code>char</code> and <code>short int</code> to <code>int</code>, and <code>float</code> to <code>double</code> -- and leaves it at that.)</p>\n\n<p>I said \"The compiler can't necessarily know what the right types of the arguments passed to <code>printf</code> are supposed to be\", but these days, good compilers go the extra mile and try to figure it out anyway, if they can.  They still won't perform automatic conversions (they're not really allowed to, by the rules of the language), but they can at least warn you.  For example, I tried your code under two different compilers.  Both said something along the lines of <code>warning: format specifies type 'int' but the argument has type 'float'</code>.  If your compiler isn't giving you warnings like these, I encourage you to find out if those warnings can be enabled, or consider switching to a better compiler.</p>\n"}], "owner": {"reputation": 15, "user_id": 10229804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1913197438736491/picture?type=large", "display_name": "Neelam ", "link": "https://stackoverflow.com/users/10229804/neelam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 5, "score": -8, "last_activity_date": 1534347007, "creation_date": 1534344466, "last_edit_date": 1534344570, "question_id": 51861023, "link": "https://stackoverflow.com/questions/51861023/why-is-this-code-printing-0", "title": "Why is this code printing 0?", "body": "<pre><code>void main()\n{\n    clrscr();\n    float f = 3.3;\n\n    /* In printf() I intentionaly put %d format specifier to see\n       what type of output I may get */\n    printf(\"value of variable a is: %d\", f);\n    getch();\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "filesystems", "posix", "embedded-linux"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1534345009, "post_id": 51861002, "comment_id": 90674571, "body": "my first thought is, that whatever this problem is, it has nothing to do with the underlying filesystem... userspace shouldn&#39;t/doesn&#39;t care about that (except perhaps for corner cases, I think FAT16 only supports file sizes up to 4Gb). Have you tried creating a bare bones MCVE that replicates this problem?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534345144, "post_id": 51861002, "comment_id": 90674651, "body": "I would guess this is because of some quirk in a API function rather than anything else. If you can&#39;t create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example (MCVE)</a> then perhaps you could at least list all relevant functions used by the program(s)? Then with some luck, maybe some Linux guru will be able to pin-point the problem."}, {"owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1534345742, "post_id": 51861002, "comment_id": 90675018, "body": "@yano I would think the same but it is the only difference between the two systems. I thought about that but it is difficult because the whole program (10k LOC) is a real time application where the other process controls some hardware, reads from it and passes data through the FIFOs to the process containing file deletion, where the file deletion thread is launched asynchronously after some (quite complex) criterion are met."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1534346261, "post_id": 51861002, "comment_id": 90675319, "body": "any chance file handles are still open elsewhere? You say file deletion is launched asynchronously, maybe the timing is just so that you&#39;ve only seen it on the FAT32 system, but the underlying problem exists on both systems. Is it the exact same binary running on both systems? Different compilers and compiler flags can cause UB to manifest itself in different ways."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1534346519, "post_id": 51861002, "comment_id": 90675461, "body": "Do you have to run as root?  Doing so is dangerous and should be avoided whenever possible.  However, it is unlikely to be a factor in your problem."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1534353664, "post_id": 51861002, "comment_id": 90679074, "body": "Ownership and permissions are determined by the uid,gid options in the mount command since they aren&#39;t supported by FAT.  If root mounts the drive then a regular user may not be able to make changes."}, {"owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1534402840, "post_id": 51861002, "comment_id": 90693924, "body": "@yano The executable, kernel and rootfs are all the same (created by the same yocto run), only the filesystem changes. I thought about having timing problems, but as it works for months like a charm on the one sort of system and crashes on the first file deletion on the other sort of system makes me thinks timing and also still open file handles shouldn&#39;t be the issue. I implemented an algorithm similar to <a href=\"https://stackoverflow.com/questions/11666610/how-to-give-priority-to-privileged-thread-in-mutex-locking\" title=\"how to give priority to privileged thread in mutex locking\">stackoverflow.com/questions/11666610/&hellip;</a> to assure correct access to the files (the algorithm has been reviewed by collegues)"}, {"owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1534403341, "post_id": 51861002, "comment_id": 90694166, "body": "@JonathanLeffler I do agree on having processes run as root is bad, but 1. the system is still under development (mostly finished though as we only check for stability now) and 2. I have to access UIO devices (which I also could do by changing the access permissions for the corresponding device)."}, {"owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1534403483, "post_id": 51861002, "comment_id": 90694252, "body": "@stark I thought about the same, but as root mounts the partition and runs the executable, there should be no issues. Plus if it was a read only filesystem (for example), already the writes of the files should fail and not only when I try to delete them again."}, {"owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534404248, "post_id": 51861002, "comment_id": 90694661, "body": "@Lundin Which functions would you consider relevant? I use functions for creation, deletion, locking and release of mutexes and semaphorese (to control the access to the actual data between threads); fopen, fclose, fwrite, fflush to create files, remove to delete them and mmap to read them when used."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534409811, "post_id": 51861002, "comment_id": 90697875, "body": "@njg Probably all file handling functions, C standard and *nix-specific ones both. As it turns out, these functions don&#39;t always work great together with multi-threading, don&#39;t count on them being thread-safe. It could possibly be some issue where you call such a function from multiple threads, without mutex protection. Maybe post the code to the thread callback functions."}, {"owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534428721, "post_id": 51861002, "comment_id": 90709610, "body": "@Lundin I appended the code running in the file deletion thread to the original question. The used functions are: - fopen - fwrite - fflush - fclose - open - close - mmap - munmap - stat - remove"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534429178, "post_id": 51861002, "comment_id": 90709945, "body": "What is <code>logging</code>? If it isn&#39;t thread-safe, then that could be a problem."}, {"owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534430240, "post_id": 51861002, "comment_id": 90710717, "body": "@Lundin logging is a wrapper for fprintf, which goes to stdout and stderr in this case. C11 does not require it to be thread save, but POSIX does. It is a very good question, but during normal runtime logging is used extensively and never gives problems (even in the presence of multiple threads). Or are there any known glibc bugs in fprintf?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534430899, "post_id": 51861002, "comment_id": 90711143, "body": "I&#39;m hardly an expert on these things, so I&#39;m not the right person to answer. It might be something worth investigating though."}], "owner": {"reputation": 45, "user_id": 9099628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eccbc133608334565577761b60223b2?s=128&d=identicon&r=PG&f=1", "display_name": "njg", "link": "https://stackoverflow.com/users/9099628/njg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534429762, "creation_date": 1534344400, "last_edit_date": 1534429762, "question_id": 51861002, "link": "https://stackoverflow.com/questions/51861002/cannot-delete-files-after-creating-them-myself-on-fat32", "title": "Cannot delete files after creating them myself on FAT32", "body": "<p>I have a program (written in C11, POSIX.1-2008 conform and running on an embedded Linux) which periodically creates files and after some time deletes them again.</p>\n\n<p>When the files are created and removed (both by my program) on an EXT4 filesystem, everything works like a charm.</p>\n\n<p>The interesting thing now happens when a FAT32 filesystem is used: while the program is able to write the files, when it tries to remove them again it kind of freezes. The kind of freezes is that the corresponding process halts, but does not exit and when using a program like top to see the utilisation like VIRT, RES, SHR, %CPU, %MEM all at zero. The same thing happens to a sibling process which communicates with the process which tries to delete the files through FIFOs. The parent process remains active. Also, the file deletion happens in a separate thread of the process, so it should not stop the whole process. The parent process is launched as a deamon, this might be why the two children stay visible in top.</p>\n\n<pre><code>                                           |--------------|\n                                           |Parent process|\n                                           |--------------|\n                                                  |\n                       ---------------------------|---------------\n                      ||                                         ||\n                      \\/                                         ||\n|--------------------------------------------|                   ||\n|     Process containing file deletion       |                   \\/\n||--------------------| |-------------------||             |-------------|\n||File deletion thread| |Main process thread|| &lt;- FIFOs -&gt; |Other process|\n||--------------------| |-------------------||             |-------------|\n|--------------------------------------------|\n</code></pre>\n\n<p>The behaviour does not change if the directory on FAT32 is created beforehand (in the console, on a different PC or however) or by the program itself using</p>\n\n<pre><code>mkdir(path, S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH)\n</code></pre>\n\n<p>I do check for the return values of all functions but do not detect any anomaly. The remove call operates on the absolute file name.</p>\n\n<p>I can delete the files without any problems in the console (but the program remains halted).</p>\n\n<p>The program runs as root.</p>\n\n<p>Has anyone an idea why I have this behaviour?</p>\n\n<p>Here is the code that runs in the file deletion thread:</p>\n\n<pre><code>void* _histDeleteFilesThread(void* context)\n{\nHistCollection* collection = ((HistThreadContext*)context)-&gt;collection;\nint* retVal = ((HistThreadContext*)context)-&gt;retVal;\nfree(context);\n*retVal = -1;\nbool finished = false;\n\nif(collection == NULL){\n    logging(stderr, \"Bad input to runner thread\\n\");\n    pthread_exit(retVal);\n}\nelse{\n    if(pthread_mutex_lock(collection-&gt;startNewSearch) != 0){\n        logging(stderr, \"Failed to lock mutex to start a new search\\n\");\n        pthread_exit(retVal);\n    }\n    else if(sem_wait(collection-&gt;canDeleteFiles) != 0){\n        pthread_mutex_unlock(collection-&gt;startNewSearch);\n        logging(stderr, \"Failed to acquire semaphore to delete files\\n\");\n        pthread_exit(retVal);\n    }\n\n    while(!finished){\n        if(pthread_mutex_lock(collection-&gt;fileDeletionDataAccess) != 0){\n            sem_post(collection-&gt;canDeleteFiles);\n            pthread_mutex_unlock(collection-&gt;startNewSearch);\n            logging(stderr, \"Failed to acquire file deletion data access mutex\\n\");\n            pthread_exit(retVal);\n        }\n\n        char* file_to_delete;\n\n        if((file_to_delete = _histFIFOPop(&amp;collection-&gt;fileToRemove)) == NULL){\n            finished = true;\n            *collection-&gt;fileDeletionThreadRunning = false;\n        }\n        else{\n            char* full_file_name = _histFileCreateAbsolutePath(collection, file_to_delete);\n            if(remove(full_file_name) != 0){\n                logging(stderr, \"Failed to delete file %s\\n\", full_file_name);\n                finished = true;\n                *collection-&gt;fileDeletionThreadRunning = false;\n            }\n            else{\n                logging(stdout, \"Removed %s\\n\", full_file_name);\n            }\n            free(full_file_name);\n            free(file_to_delete);\n        }\n\n        if(pthread_mutex_unlock(collection-&gt;fileDeletionDataAccess) != 0){\n            sem_post(collection-&gt;canDeleteFiles);\n            pthread_mutex_unlock(collection-&gt;startNewSearch);\n            logging(stderr, \"Failed to lock mutex to start a new search\\n\");\n            pthread_exit(retVal);\n        }\n    }\n\n    if(sem_post(collection-&gt;canDeleteFiles) != 0){\n        pthread_mutex_unlock(collection-&gt;startNewSearch);\n        logging(stderr, \"Failed to lock mutex to start a new search\\n\");\n        pthread_exit(retVal);\n    }\n    else if(pthread_mutex_unlock(collection-&gt;startNewSearch) != 0){\n        logging(stderr, \"Failed to lock mutex to start a new search\\n\");\n        pthread_exit(retVal);\n    }\n\n    *retVal = 0;\n    pthread_exit(retVal);\n}\n</code></pre>\n\n<p>}</p>\n\n<p>To give a bit of context how the system works: the other process generates data, which is passed to the process containing file deletion through POSIX FIFOs. Inside that process, the data are first buffered in RAM, then written to a file and the file name of this file is then stored in a first SW FIFO. During the time the file is in that first SW FIFO, the data in all files in that SW FIFO plus all the data in the buffer can be searched and used (all searches are in separate threads as they are quite compute intensive and we have to maintain real-time responsiveness). When a file becomes to old, it is moved to a second SW FIFO and the file deletion thread is launched. The thread has to wait until all other searches have terminated before removing the file as otherwise it might still be used by another thread, and no new search can start until the file deletion thread has removed the files in the second SW FIFO (the file deletion thread has a higher run priority (implemented with mutexes and semaphores) to avoid FIFO overflow).</p>\n"}, {"tags": ["c#", "c", "mono", "interop"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1534344464, "post_id": 51860830, "comment_id": 90674253, "body": "Decide on what you&#39;re asking, C or C++."}, {"owner": {"reputation": 1, "user_id": 10229635, "user_type": "registered", "profile_image": "https://graph.facebook.com/952898248251711/picture?type=large", "display_name": "Julio Gonzales", "link": "https://stackoverflow.com/users/10229635/julio-gonzales"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1534345032, "post_id": 51860830, "comment_id": 90674583, "body": "Fair enough. I change everything to C as mono api is in C."}], "owner": {"reputation": 1, "user_id": 10229635, "user_type": "registered", "profile_image": "https://graph.facebook.com/952898248251711/picture?type=large", "display_name": "Julio Gonzales", "link": "https://stackoverflow.com/users/10229635/julio-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534344800, "creation_date": 1534343854, "last_edit_date": 1534344800, "question_id": 51860830, "link": "https://stackoverflow.com/questions/51860830/how-to-create-delegate-of-interface-implementation-in-c-for-mono-runtime", "title": "how to create delegate of interface implementation in C for mono runtime?", "body": "<p>I am trying to extend library written in c for linux by some c# (or f#) code  using mono.</p>\n\n<p>Simple example of calling c# from c looks quite simple:</p>\n\n<pre><code>//c# code, compiled with mcs -t:library Ex1.cs\npublic static class Ex1 {\n  public class Inner {\n    public static void someAction(int i) {\n      System.Console.WriteLine(\"some action with \" + i);\n    }\n  }\n}\n\n//c code, compiled with gcc ex1.c $(pkg-config --cflags --libs mono-2)\n#include &lt;mono/jit/jit.h&gt;\n#include &lt;mono/metadata/assembly.h&gt;\n\nint main()\n{\n  MonoDomain *domain = mono_jit_init(\"Ex1.dll\");\n  MonoAssembly *assembly = mono_domain_assembly_open(domain, \"Ex1.dll\");\n  MonoImage *image = mono_assembly_get_image(assembly);\n\n  MonoClass *class_ptr = mono_class_from_name(image, \"\", \"Ex1/Inner\");\n  MonoMethod *class_method = mono_class_get_method_from_name_flags(\n      class_ptr, \"someAction\", 1, 0);\n\n  void *args[1];\n  int value = 42;\n  args[0] = &amp;value;\n  mono_runtime_invoke(class_method, NULL, args, NULL);\n\n  mono_jit_cleanup(domain);\n  return 0;\n}\n</code></pre>\n\n<p>Running ./a.out we see output from c# library.</p>\n\n<p>But is it possible to implemented interface or at least delegate defined in c# on c side?</p>\n\n<p>For example:</p>\n\n<pre><code>//c# compiled mcs -t:library Ex2.cs\npublic static class Ex2 {\n  public interface MyInterface {\n    void someAction(int i);\n  }\n\n  public delegate void MyDelegate(int i);\n\n  public static class Inner {\n    static public void someAction1(MyInterface iface, int value) {\n      iface.someAction(value);\n    }\n    static public void someAction2(MyDelegate d, int value) {\n      d(value);\n    }\n  }\n}\n\n\n//c compiled with gcc ex2.c $(pkg-config --cflags --libs mono-2)\n#include &lt;mono/jit/jit.h&gt;\n#include &lt;mono/metadata/assembly.h&gt;\n\nint main()\n{\n  MonoDomain *domain = mono_jit_init(\"Ex2.dll\");\n  MonoAssembly *assembly = mono_domain_assembly_open(domain, \"Ex2.dll\");\n  MonoImage *image = mono_assembly_get_image(assembly);\n\n  MonoClass *class_ptr = mono_class_from_name(image, \"\", \"Ex2/Inner\");\n  MonoMethod *class_method1 = mono_class_get_method_from_name_flags(\n      class_ptr, \"someAction1\", 2, 0);\n  MonoMethod *class_method2 = mono_class_get_method_from_name_flags(\n      class_ptr, \"someAction2\", 2, 0);\n\n  void *args1[2];\n  int value1 = 42;\n  args1[0] = NULL;//how to correctly initialize this?\n  args1[1] = &amp;value1;\n  mono_runtime_invoke(class_method1, NULL, args1, NULL);\n\n  void *args2[2];\n  int value2 = 42;\n  args2[0] = NULL; //or this?\n  args2[1] = &amp;value2;\n  mono_runtime_invoke(class_method2, NULL, args2, NULL);\n\n  mono_jit_cleanup(domain);\n  return 0;\n}\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "string", "strcat"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 14, "creation_date": 1534342966, "post_id": 51860543, "comment_id": 90673342, "body": "Undefined behavior includes &quot;appears to work&quot;."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1534343189, "post_id": 51860543, "comment_id": 90673484, "body": "You probably expected some kind of error popping up. While there was no error reported, your code is still wrong in the sense that: It is not defined what your code will do when executed. This might be a subtle point but an important point. See for example: <a href=\"https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior\" title=\"undefined unspecified and implementation defined behavior\">stackoverflow.com/questions/2397984/&hellip;</a> or <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Undefined_behavior</a>"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1534343240, "post_id": 51860543, "comment_id": 90673518, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/51860543/edit\">edit your question</a> to include more information if commenters request it.  Thanks for including the code you tried --- what output did you get from both programs?"}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1534343378, "post_id": 51860543, "comment_id": 90673608, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior\">Undefined, unspecified and implementation-defined behavior</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1534343508, "post_id": 51860543, "comment_id": 90673670, "body": "Your first program is even worse then your second one.  Where do the pointers <code>src</code> and <code>dest</code> point??"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534343514, "post_id": 51860543, "comment_id": 90673675, "body": "It is your job to determine if the destination is large enough."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1534343647, "post_id": 51860543, "comment_id": 90673760, "body": "Where do you think the input is written by <code>fgets(src, 10, stdin);</code>; especially in case of the first code example? That is an important foundation for the discussion where strcat operates."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534344401, "post_id": 51860543, "comment_id": 90674220, "body": "Err... this is because the &quot;strcat function in C assumes the destination string is large enough to hold contents of source string and its own\u201d. As in, this is the caller&#39;s responsibility. Not the function, not the compiler."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534344493, "post_id": 51860543, "comment_id": 90674271, "body": "Also please study <a href=\"https://stackoverflow.com/questions/37549594/crash-or-segmentation-fault-when-data-is-copied-scanned-read-to-an-uninitializ\">Crash or \u201csegmentation fault\u201d when data is copied/scanned/read to an uninitialized pointer</a>."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1534343790, "post_id": 51860712, "comment_id": 90673855, "body": "The primary advantage of <code>strncat</code> is that it motivates you to think about the issue of buffer size.  Using that function instead of <code>strcat</code> is in no way a silver bullet, however.  You still need to perform exactly the same analysis, and you can still produce undefined behavior if you get that wrong."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1534343795, "post_id": 51860712, "comment_id": 90673861, "body": "&quot;<i>Never</i>&quot; might be an exaggeration - but then again, perhaps not: if you&#39;re in a position to make guarantees, you almost certainly know the length of the initial string, so could more efficiently use <code>strcpy()</code> or <code>memcpy()</code> instead."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1534344003, "post_id": 51860712, "comment_id": 90673990, "body": "@TobySpeight edited.  I personally think &quot;never use <code>strcat</code>&quot; is valid advice for a <i>beginning</i> C programmer, and as far as I can tell from the question the OP is just starting out."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1534344151, "post_id": 51860712, "comment_id": 90674080, "body": "I think I agree with you - it&#39;s very rare that you don&#39;t know the sizes of both strings but do have an upper bound on the total length.  The only case I can think of is where you&#39;ve formatted numbers with a known range (but even that can catch you out when the surrounding code changes)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1534347086, "post_id": 51860712, "comment_id": 90675805, "body": "@JohnBollinger: I think it is even more valid to advise &quot;never use <code>strncat()</code>&quot;.  Do you know what&#39;s wrong with the code: <code>char data[16] = &quot;&quot;; strncat(data, &quot;ABCDEFGHIJKLMNOP&quot;, sizeof(data));</code>?  Most people don&#39;t realize that&#39;s a buffer overflow \u2014 which is why I regard <code>strncat()</code> as lethal.  If you know enough about the lengths of the strings to be able to use <code>strncat()</code> safely, you know enough to use <code>memmove()</code> (or <code>memcpy()</code> \u2014 but that&#39;s a separate discussion) instead."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 4, "last_activity_date": 1534343965, "last_edit_date": 1592644375, "creation_date": 1534343451, "answer_id": 51860712, "question_id": 51860543, "link": "https://stackoverflow.com/questions/51860543/confusion-in-strcat-function-in-c-assumes-the-destination-string-is-large-enoug/51860712#51860712", "title": "Confusion in &quot;strcat function in C assumes the destination string is large enough to hold contents of source string and its own.&quot;", "body": "<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strcat.html\" rel=\"nofollow noreferrer\"><code>strcat()</code> function</a> is indeed to be used carefully because it doesn't protect you from anything.  If the source string isn't NULL-terminated, the destination string isn't NULL-terminated, or the destination string doesn't have enough space, <code>strcat</code> will still copy data.  Therefore, it is easy to overwrite data you didn't mean to overwrite.  It is your responsibility to make sure you have enough space.  Using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strncat.html\" rel=\"nofollow noreferrer\"><code>strncat()</code></a> instead of <code>strcat</code> will also give you some extra safety.</p>\n<p><strong>Edit</strong> Here's an example:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char s1[16] = {0};\n    char s2[16] = {0};\n    strcpy(s2, &quot;0123456789abcdefOOPS WAY TOO LONG&quot;);\n      /* ^^^ purposefully copy too much data into s2 */\n    printf(&quot;-%s-\\n&quot;,s1);\n    return 0;\n}\n</code></pre>\n<p>I never assigned to <code>s1</code>, so the output should ideally be <code>--</code>.  However, because of how the compiler happened to arrange <code>s1</code> and <code>s2</code> in memory, the output I actually got was <code>-OOPS WAY TOO LONG-</code>.  The <code>strcpy(s2,...)</code> overwrote the contents of <code>s1</code> as well.</p>\n<p>On gcc, <code>-Wall</code> or <code>-Wstringop-overflow</code> will help you detect situations like this one, where the compiler knows the size of the source string.  However, in general, the compiler can't know how big your data will be.  Therefore, you have to write code that makes sure you don't copy more than you have room for.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 10, "last_activity_date": 1534362153, "last_edit_date": 1534362153, "creation_date": 1534343513, "answer_id": 51860733, "question_id": 51860543, "link": "https://stackoverflow.com/questions/51860543/confusion-in-strcat-function-in-c-assumes-the-destination-string-is-large-enoug/51860733#51860733", "title": "Confusion in &quot;strcat function in C assumes the destination string is large enough to hold contents of source string and its own.&quot;", "body": "<p>The <code>strcat</code> function has no way of knowing exactly how long the destination buffer is, so it assumes that the buffer passed to it is large enough.  If it's not, you invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> by writing past the end of the buffer.  That's what's happening in the second piece of code.</p>\n\n<p>The first piece of code is also invalid because both <code>src</code> and <code>dest</code> are uninitialized pointers.  When you pass them to <code>fgets</code>, it reads whatever garbage value they contain, treats it as a valid address, then tries to write values to that invalid address.  This is also undefined behavior.</p>\n\n<p>One of the things that makes C fast is that it doesn't check to make sure you follow the rules.  It just tells you the rules and assumes that you follow them, and if you don't bad things may or may not happen.  In your particular case it appeared to work but there's no guarantee of that.</p>\n\n<p>For example, when I ran your second piece of code it also appeared to work.  But if I changed it to this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    char dest[15] = \"Hello DEFGIJK\";\n    strcat(dest, \"Hello ABC XXXXXXXXXX\");\n    printf(\"concatenated string %s\", dest);\n    return 0;\n}\n</code></pre>\n\n<p>The program crashes.</p>\n"}, {"comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 2, "creation_date": 1534343982, "post_id": 51860813, "comment_id": 90673977, "body": "very nice analogy"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 8, "last_activity_date": 1534344223, "last_edit_date": 1534344223, "creation_date": 1534343790, "answer_id": 51860813, "question_id": 51860543, "link": "https://stackoverflow.com/questions/51860543/confusion-in-strcat-function-in-c-assumes-the-destination-string-is-large-enoug/51860813#51860813", "title": "Confusion in &quot;strcat function in C assumes the destination string is large enough to hold contents of source string and its own.&quot;", "body": "<p>I think your confusion is not actually about the definition of <code>strcat</code>.  Your real confusion is that you assumed that the C compiler would enforce all the \"rules\".  That assumption is quite false.</p>\n\n<p>Yes, the first argument to <code>strcat</code> must be a pointer to memory sufficient to store the concatenated result.  In both of your programs, that requirement is violated.  You may be getting the impression, from the lack of error messages in either program, that perhaps the rule isn't what you thought it was, that somehow it's valid to call <code>strcat</code> even when the first argument is not a pointer to enough memory.  But no, that's not the case: calling <code>strcat</code> when there's not enough memory is definitely wrong.  The fact that there were no error messages, or that one or both programs appeared to \"work\", proves nothing.</p>\n\n<p>Here's an analogy.  (You may even have had this experience when you were a child.)  Suppose your mother tells you not to run across the street, because you might get hit by a car.  Suppose you run across the street anyway, and do not get hit by a car.  Do you conclude that your mother's advice was incorrect?  Is this a valid conclusion?</p>\n\n<p>In summary, what you read was correct: <code>strcat</code> must be used carefully.  But let's rephrase that: <em>you</em> must be careful when calling <code>strcat</code>.  If you're not careful, all sorts of things can go wrong, without any warning.  In fact, many style guides recommend not using functions such as <code>strcat</code> at all, because they're so easy to misuse if you're careless.  (Functions such as <code>strcat</code> can be used perfectly safely as long as you're careful -- but of course not all programmers are sufficiently careful.)</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1534344228, "creation_date": 1534344228, "answer_id": 51860958, "question_id": 51860543, "link": "https://stackoverflow.com/questions/51860543/confusion-in-strcat-function-in-c-assumes-the-destination-string-is-large-enoug/51860958#51860958", "title": "Confusion in &quot;strcat function in C assumes the destination string is large enough to hold contents of source string and its own.&quot;", "body": "<p>Both snippets invoke <em>undefined behavior</em> - the first because <code>src</code> and <code>dest</code> are not initialized to point anywhere meaningful, and the second because you are writing past the end of the array.</p>\n\n<p>C does not enforce any kind of bounds checking on array accesses - you won't get an \"Index out of range\" exception if you try to write past the end of an array.  You <em>may</em> get a runtime error if you try to access past a page boundary or clobber something important like the frame pointer, but otherwise you just risk corrupting data in your program.  </p>\n\n<p>Yes, you are responsible for making sure the target buffer is large enough for the final string.  Otherwise the results are unpredictable.  </p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 10206263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdef6e03e5a17abf6e4bfea929565f57?s=128&d=identicon&r=PG&f=1", "display_name": "GriffithLea", "link": "https://stackoverflow.com/users/10206263/griffithlea"}, "is_accepted": false, "score": 1, "last_activity_date": 1534345420, "last_edit_date": 1534345420, "creation_date": 1534344912, "answer_id": 51861157, "question_id": 51860543, "link": "https://stackoverflow.com/questions/51860543/confusion-in-strcat-function-in-c-assumes-the-destination-string-is-large-enoug/51861157#51861157", "title": "Confusion in &quot;strcat function in C assumes the destination string is large enough to hold contents of source string and its own.&quot;", "body": "<p>I'd like to point out what is actually happening in the 2nd program in order to illustrate the problem.</p>\n\n<p>It allocates 15 bytes at the memory location starting at dest and copies 14 bytes into it (including the null terminator):</p>\n\n<pre><code>    char dest[15] = \"Hello DEFGIJK\";\n</code></pre>\n\n<p>...and 11 bytes at src with 10 bytes copied into it:</p>\n\n<pre><code>    char src[11] = \"Hello ABC\";\n</code></pre>\n\n<p>The strcat() call then copies 10 bytes (9 chars plus the null terminator) from src into dest, starting right after the 'K' in dest. The resulting string at dest will be 23 bytes long including the null terminator. The problem is, you allocated only 15 bytes at dest, and the memory adjacent to that memory will be overwritten, i.e. corrupted, leading to program instability, wrong results, data corruption, etc.</p>\n\n<p>Note that the strcat() function knows nothing about the amount of memory you've allocated at dest (or src, for that matter). It is up to you to make sure you've allocated enough memory at dest to prevent memory corruption.</p>\n\n<p>By the way, the first program doesn't allocate memory at dest or src at all, so your calls to fgets() are corrupting memory starting at those locations.</p>\n"}], "owner": {"reputation": 37, "user_id": 5556323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fcd4c78e3824705e5e0650c8062a76?s=128&d=identicon&r=PG&f=1", "display_name": "Kartik Khullar", "link": "https://stackoverflow.com/users/5556323/kartik-khullar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 0, "accepted_answer_id": 51860712, "answer_count": 5, "score": 2, "last_activity_date": 1534362153, "creation_date": 1534342897, "last_edit_date": 1534342965, "question_id": 51860543, "link": "https://stackoverflow.com/questions/51860543/confusion-in-strcat-function-in-c-assumes-the-destination-string-is-large-enoug", "title": "Confusion in &quot;strcat function in C assumes the destination string is large enough to hold contents of source string and its own.&quot;", "body": "<p>So I read that <code>strcat</code> function is to be used carefully as the destination string should be large enough to hold contents of its own and source string. And it was true for the following program that I wrote:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    char *src, *dest;\n    printf(\"Enter Source String : \");\n    fgets(src, 10, stdin);\n    printf(\"Enter destination String : \");\n    fgets(dest, 20, stdin);\n    strcat(dest, src);\n    printf(\"Concatenated string is %s\", dest);\n    return 0;\n}\n</code></pre>\n\n<p>But not true for the one that I wrote here:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    char src[11] = \"Hello ABC\";\n    char dest[15] = \"Hello DEFGIJK\";\n    strcat(dest, src);\n    printf(\"concatenated string %s\", dest);\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>This program ends up adding both without considering that destination string is not large enough. Why is it so?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1534342885, "post_id": 51860520, "comment_id": 90673293, "body": "The requirement is unclear."}, {"owner": {"reputation": 1215, "user_id": 4481541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe7030cf38c1eacc3ce817ef07242e77?s=128&d=identicon&r=PG&f=1", "display_name": "LenglBoy", "link": "https://stackoverflow.com/users/4481541/lenglboy"}, "edited": false, "score": 0, "creation_date": 1534342953, "post_id": 51860520, "comment_id": 90673333, "body": "Why should it be <code>ge</code>? Last of <code>s1</code> and first of <code>s2</code>? Easy - give more informations"}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "edited": false, "score": 0, "creation_date": 1534343126, "post_id": 51860520, "comment_id": 90673446, "body": "This is some weird code, can you explain what you are trying to do?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1534343218, "post_id": 51860520, "comment_id": 90673505, "body": "The code is supposed to look for the longest sequence of characters at the end of <code>string1</code> that is the starting sequence of <code>string2</code>, I think.  But the title of the question needs to be rewritten and shortened while the content needs to explain what\u2019s wanted more clearly, possibly with a second example (\u201cbanana\u201d and \u201canabolic\u201d has \u201cAna\u201d as the longest common subsequence, perhaps)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1534345015, "post_id": 51860520, "comment_id": 90674574, "body": "The indentation of the code doesn&#39;t reflect the structure of the code.  The second level <code>for</code> loop only controls the <code>if (a[i] == a[j]) break;</code> statement, though the indentation suggests you think it controls the <code>if (j == -1)</code> statement, which itself controls the next <code>for</code> loop, and that in turn controls the <code>if (a[i] = b[t])</code> statement.  Whether that&#39;s what you intended or not, I&#39;m not sure; it doesn&#39;t look like a pattern I&#39;d expect.  But the indentation does not reflect that control structure, which makes it hard for you and us to understand what your code is supposed to do."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1534345453, "post_id": 51860857, "comment_id": 90674821, "body": "You could use <code>if (memo != 0) printf(&quot;%s\\n&quot;, &amp;a[memo]);</code> to print the common string, instead of using a loop to do so.  It&#39;s a good idea to end outputs with a newline, too, as shown.  Using <code>strlen()</code> in the condition of a loop is something to avoid.  The compiler might be obliged to call the function on each iteration, which can lead to quadratic behaviour in your algorithms.  It won&#39;t matter much here, but in bigger problems, it could.  Were I coding this, I think I&#39;d start by finding the lengths of <code>a</code> and <code>b</code>, and I&#39;d probably work backwards along <code>a</code>, rather than starting at the front."}], "tags": [], "owner": {"reputation": 94, "user_id": 10055202, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P15uv.jpg?s=128&g=1", "display_name": "RogerVieiraa", "link": "https://stackoverflow.com/users/10055202/rogervieiraa"}, "is_accepted": true, "score": 0, "last_activity_date": 1534346859, "last_edit_date": 1534346859, "creation_date": 1534343934, "answer_id": 51860857, "question_id": 51860520, "link": "https://stackoverflow.com/questions/51860520/find-longest-substring-that-matches-the-end-of-one-string-and-the-start-of-the-n/51860857#51860857", "title": "Find longest substring that matches the end of one string and the start of the next", "body": "<p>I think I get it.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nvoid main() {\n    char a[80],b[80];\n    int i,j,t;\n    scanf(\"%s\",a);//input s1 example bridge\n    scanf(\"%s\",b);//input s2 example gear\n\n    int k=0; //start with the first caracther\n    int memo=0;\n    for(int i=0;i&lt;strlen(a);i++) {\n        if(a[i] == b[k]) {\n            k++; //increase\n            if(memo == 0) {\n                memo = i; //save the start\n            }\n        }\n        // reset the compar\n        else {\n            k = 0;\n            i = memo + 1;\n            memo = 0; \n        }\n    }\n    //if end with memo\n    if(memo != 0) {\n        for(int i=memo;i&lt;strlen(a);i++) {\n            printf(\"%c\",a[i]);\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5314, "user_id": 5270581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leDO2.jpg?s=128&g=1", "display_name": "Laurent H.", "link": "https://stackoverflow.com/users/5270581/laurent-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1534346215, "last_edit_date": 1534346215, "creation_date": 1534345315, "answer_id": 51861281, "question_id": 51860520, "link": "https://stackoverflow.com/questions/51860520/find-longest-substring-that-matches-the-end-of-one-string-and-the-start-of-the-n/51861281#51861281", "title": "Find longest substring that matches the end of one string and the start of the next", "body": "<p>I suggest you to use <code>strncmp()</code> function to compare strings. It really facilitates the task. Here is the code, which is short, readable and easily understandable:  </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nvoid main()\n{\n    char a[80],b[80];\n    char* pa;\n\n    scanf(\"%s\",a); //input s1 example bridge\n    scanf(\"%s\",b); //input s2 example gear\n\n    // Iterate over \"end substrings\" of s1 (from the longest to the shortest)\n    for (pa = a; *pa != '\\0'; pa++)\n    {\n        // Compare with \"start substring\" of s2\n        if (strncmp(pa, b, strlen(pa)) == 0)\n            // Here it matches: exit from loop !\n            break;\n    }\n\n    // Display the result\n    if (strlen(pa) == 0)\n    {\n        printf(\"Nothing found\\n\");\n    }\n    else\n    {\n        printf(\"Found: %s\\n\", pa);\n    }\n}\n</code></pre>\n\n<p>I may also suggest you the following very short way to go:  </p>\n\n<pre><code>void main()\n{\n    char a[80],b[80];\n    char* pa = a;\n\n    scanf(\"%s\",a); //input s1 example bridge\n    scanf(\"%s\",b); //input s2 example gear\n\n    while (strncmp(pa, b, strlen(pa)) &amp;&amp; (*(++pa) != '\\0'));\n\n    printf(\"%s\", strlen(pa) == 0 ? \"Nothing found\" : pa);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10113817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dyCCOZRXjvc/AAAAAAAAAAI/AAAAAAAAAII/_AmSM0LmSLc/photo.jpg?sz=128", "display_name": "lakshmi chandhana", "link": "https://stackoverflow.com/users/10113817/lakshmi-chandhana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 51860857, "answer_count": 2, "score": -5, "last_activity_date": 1534346859, "creation_date": 1534342807, "last_edit_date": 1534344832, "question_id": 51860520, "link": "https://stackoverflow.com/questions/51860520/find-longest-substring-that-matches-the-end-of-one-string-and-the-start-of-the-n", "title": "Find longest substring that matches the end of one string and the start of the next", "body": "<p>The task is to find the longest substring at the end of <code>string1</code> that is the start of <code>string2</code>.</p>\n\n<p>For example, if <code>string1</code> is \"monitor\" and <code>string2</code> is \"orange\", the output must be \"or\".</p>\n\n<p>For example, if <code>string1</code> is \"bridge\" and <code>string2</code> is \"gear\", the output must be \"ge\".</p>\n\n<p>Unfortunately, my code gives the answer for the \"bridge\"/\"gear\" example as \"rge\". Please help me to find the fault in this code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid main()\n{\n    char a[80],b[80];\n    int i,j,t;\n    scanf(\"%s\",a);//input s1 example bridge\n    scanf(\"%s\",b);//input s2 example gear\n    for(i=0;a[i]!='\\0';i++)//traversing through first string\n    {\n      for(j=i-1;j&gt;=0;j--)\n\n       if(a[i]==a[j])\n       break;\n       if(j==-1)\n       for(t=0;b[t]!='\\0';t++)\n\n         if(a[i]==b[t])\n         { \n          printf(\"%c\",a[i]);  //output must be ge but this code gives me the output as rge\n          break;\n         }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "kernel", "hook", "system-calls"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1534341975, "post_id": 51860093, "comment_id": 90672762, "body": "I can only suggest you look at the original implementation and see how it behaves. Yours would be the same."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1534342883, "post_id": 51860093, "comment_id": 90673291, "body": "Post your code.  All your invalid addresses appear to be 32-bit values."}], "owner": {"reputation": 1, "user_id": 10227646, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v3W5XidBYu0/AAAAAAAAAAI/AAAAAAAAACQ/uM3-VmDBzaw/photo.jpg?sz=128", "display_name": "Ulysses Mckibbens", "link": "https://stackoverflow.com/users/10227646/ulysses-mckibbens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534341230, "creation_date": 1534341230, "question_id": 51860093, "link": "https://stackoverflow.com/questions/51860093/linux-kernel-module-hooking-certain-system-calls-cannot-see-string-parameters-in", "title": "linux kernel module hooking certain system calls cannot see string parameters in user space", "body": "<p>I am doing an exercise for a class to hook some system calls on a running kernel using a linux kernel module and using my new_sys_call() in place of the old one. I am developing on CentOS 7 and using a stock kernel-3.10.0-862.3.2. I was able to successfully hook execve and I can access parameter values but I cannot seem to access the rename syscall parameter values. I realize this is probably not a practical real world approach but I am trying to learn more about kernel development and how system calls work.</p>\n\n<p>Here's an example of the hooking method definitions:</p>\n\n<pre><code>/*\n   Original Syscall Prototype\n*/\nasmlinkage long (*orig_sys_chdir_fn)(const char __user *filename);\n\n/*\nnew syscall\n*/\nasmlinkage long new_sys_chdir(const char __user *filename) {\n\n   // do stuff\n   return orig_sys_chdir_fn(filename);\n}\n</code></pre>\n\n<p>We obtain the stub chdir address with this code:</p>\n\n<pre><code>orig_stub_chdir_addr = ((unsigned long *)(sys_call_table_addr))[__NR_chdir];\n\n\n\n  Thread 357 hit Breakpoint 3, new_sys_rename (oldname=0xffffff9c &lt;error: Cannot access memory at address 0xffffff9c&gt;,\n    newname=0xffffff9c &lt;error: Cannot access memory at address 0xffffff9c&gt;) at /home/ulys/syshooks/kmod/sysrename.c:19\n19      asmlinkage long new_sys_rename(const char __user *oldname,  const char __user *newname) {\n(gdb) info registers\nrax            0xffffffff8122dbd0       -2128421936\nrbx            0x0      0\nrcx            0x7ffd0faf9480   140724866618496\nrdx            0xffffff9c       4294967196\nrsi            0xffffff9c       4294967196\nrdi            0xffffff9c       4294967196\nrbp            0xffff88004183bf48       0xffff88004183bf48\nrsp            0xffff88004183bf40       0xffff88004183bf40\nr8             0x0      0\nr9             0x1      1\nr10            0x7ffd0faf7320   140724866609952\nr11            0x202    514\nr12            0x0      0\nr13            0x0      0\nr14            0x0      0\nr15            0x0      0\nrip            0xffffffffc0540b20       0xffffffffc0540b20 &lt;new_sys_rename&gt;\neflags         0x10246  [ PF ZF IF RF ]\ncs             0x10     16\nss             0x18     24\nds             0x0      0\nes             0x0      0\nfs             0x0      0\ngs             0xb      11\n(gdb) info stack\n#0  new_sys_rename (oldname=0xffffff9c &lt;error: Cannot access memory at address 0xffffff9c&gt;,\n    newname=0xffffff9c &lt;error: Cannot access memory at address 0xffffff9c&gt;) at /home/ulys/syshooks/kmod/sysrename.c:19\n#1  0xffffffff8122dbee in gather_surplus_pages (delta=-2123237509, h=0x0 &lt;irq_stack_union&gt;) at mm/hugetlb.c:1764\n#2  hugetlb_acct_memory (h=0x0 &lt;irq_stack_union&gt;, delta=-2123237521) at mm/hugetlb.c:3149\n#3  0xffffffff8171f82f in inet_netconf_fill_devconf (skb=0xffffffff8171f77b &lt;inet_netconf_fill_devconf+123&gt;,\n    ifindex=&lt;optimized out&gt;, devconf=&lt;optimized out&gt;, portid=&lt;optimized out&gt;, seq=&lt;optimized out&gt;, flags=&lt;optimized out&gt;,\n    type=&lt;error reading variable: Cannot access memory at address 0x10&gt;, event=80) at net/ipv4/devinet.c:1786\nBacktrace stopped: previous frame inner to this frame (corrupt stack?)\n(gdb) x/s 0x7ffd0faf9480\n0x7ffd0faf9480: \"/tmp/test2\"\n</code></pre>\n\n<p>You can see the bogus addresses at 0xffffff9c which cannot be read by copy_from_user or used by anything in the new_sys_rename function. You can see that the newname is in the register rcx but I can't locate oldname. I have noticed this on several different filename based syscalls such as chmod and chdir as well.</p>\n\n<p>On chdir, I receive similar results except I can't find filename in any register.</p>\n\n<pre><code>Thread 304 hit Breakpoint 1, new_sys_chdir (\n    filename=0xffffff9c &lt;error: Cannot access memory at address 0xffffff9c&gt;)\n    at /home/ulys/syshooks/kmod/syschdir.c:17\n17      asmlinkage long new_sys_chdir(const char __user *filename) {\n(gdb) info registers\nrax            0x0      0\nrbx            0x0      0\nrcx            0xffff880055d47f18       -131939955343592\nrdx            0x3      3\nrsi            0x3      3\nrdi            0xffffff9c       4294967196\nrbp            0xffff880055d47f48       0xffff880055d47f48\nrsp            0xffff880055d47f10       0xffff880055d47f10\nr8             0xc919d0 13179344\nr9             0xcba2d0 13345488\nr10            0x7f7147cfd030   140124512833584\nr11            0x246    582\nr12            0x3      3\nr13            0xc8f320 13169440\nr14            0x0      0\nr15            0x0      0\nrip            0xffffffffc0561000       0xffffffffc0561000 &lt;new_sys_chdir&gt;\neflags         0x10246  [ PF ZF IF RF ]\ncs             0x10     16\nss             0x18     24\nds             0x0      0\nes             0x0      0\nfs             0x0      0\ngs             0xb      11\n(gdb) x/s 0xffff880055d47f18\n0xffff880055d47f18:     \"o\\367q\\201\\377\\377\\377\\377{\\367q\\201\\377\\377\\377\\377\\225\\\"\", &lt;incomplete sequence \\356&gt;\n(gdb) x/s 0xc919d0\n0xc919d0:       \" \"\n(gdb) x/s 0xc919d0\n0xc919d0:       \" \"\n(gdb) x/s 0x7f7147cfd030\n0x7f7147cfd030: \"f\\017s\\372\\005f\\017t\\321f\\017\\370\\320fD\\017\\327\\312\\323\\352A\\323\\351D)\\312\\017\\205\\v\\004\"\n(gdb) info stack\n#0  new_sys_chdir (filename=0xffffff9c &lt;error: Cannot access memory at address 0xffffff9c&gt;)\n    at /home/ulys/syshooks/kmod/syschdir.c:17\n#1  0xffffffff81218b3e in move_page_tables (vma=&lt;optimized out&gt;, old_addr=3, new_vma=&lt;optimized out&gt;,\n    new_addr=18446744071586314095, len=&lt;optimized out&gt;, need_rmap_locks=&lt;optimized out&gt;) at mm/mremap.c:187\n#2  0xffffffff8171f82f in inet_netconf_fill_devconf (skb=0xffffffff8171f77b &lt;inet_netconf_fill_devconf+123&gt;,\n    ifindex=&lt;optimized out&gt;, devconf=&lt;optimized out&gt;, portid=&lt;optimized out&gt;, seq=&lt;optimized out&gt;, flags=&lt;optimized out&gt;,\n    type=&lt;error reading variable: Cannot access memory at address 0x10&gt;, event=80) at net/ipv4/devinet.c:1786\nBacktrace stopped: previous frame inner to this frame (corrupt stack?)\n</code></pre>\n\n<p>It appears to work just fine on execve. Here you can see similar output but I have no problems accessing any of execve's filename or argv strings.</p>\n\n<pre><code>Thread 335 hit Breakpoint 2, new_sys_execve (filename=0x55c85e0d7af0 \"/usr/libexec/postfix/pickup\", argv=0x55c85e0d3d00,\n    envp=0x55c85e0d3d00) at /home/ulys/syshooks/kmod/sysexecve.c:21\n21              const char __user * const __user * envp) {\n(gdb) info registers\nrax            0xffffffff8171fd80       -2123235968\nrbx            0x0      0\nrcx            0xffffffff       4294967295\nrdx            0x55c85e0d3d00   94319059746048\nrsi            0x55c85e0d3d00   94319059746048\nrdi            0x55c85e0d7af0   94319059761904\nrbp            0x0      0x0 &lt;irq_stack_union&gt;\nrsp            0xffff88005323ff50       0xffff88005323ff50\nr8             0x30     48\nr9             0x0      0\nr10            0xffffffff       4294967295\nr11            0x206    518\nr12            0x0      0\nr13            0x0      0\nr14            0x0      0\nr15            0x0      0\nrip            0xffffffffc053f880       0xffffffffc053f880 &lt;new_sys_execve&gt;\neflags         0x10282  [ SF IF RF ]\ncs             0x10     16\nss             0x18     24\nds             0x0      0\nes             0x0      0\nfs             0x0      0\ngs             0xb      11\n(gdb) info stack\n#0  new_sys_execve (filename=0x55c85e0d7af0 \"/usr/libexec/postfix/pickup\", argv=0x55c85e0d3d00, envp=0x55c85e0d3d00)\n    at /home/ulys/syshooks/kmod/sysexecve.c:21\n#1  0xffffffff8171fdc8 in rtm_to_ifaddr (pprefered_lft=&lt;synthetic pointer&gt;, pvalid_lft=&lt;synthetic pointer&gt;,\n    nlh=0x0 &lt;irq_stack_union&gt;, net=0x0 &lt;irq_stack_union&gt;) at net/ipv4/devinet.c:801\n#2  inet_rtm_newaddr (skb=0x0 &lt;irq_stack_union&gt;, nlh=0x0 &lt;irq_stack_union&gt;) at net/ipv4/devinet.c:854\nBacktrace stopped: Cannot access memory at address 0x8\n</code></pre>\n\n<p>So why are some of these variables protected from kernel space? Where can they be found and is there another kernel function that can be called to get the values?</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1534338678, "post_id": 51859376, "comment_id": 90670870, "body": "If you program in C then please use only that language-tag."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1534338758, "post_id": 51859376, "comment_id": 90670912, "body": "Do you know how to use debugger?"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1534338896, "creation_date": 1534338896, "answer_id": 51859460, "question_id": 51859376, "link": "https://stackoverflow.com/questions/51859376/queue-array-based-implementation/51859460#51859460", "title": "queue array based implementation", "body": "<p>Lets take a look at these lines from your <code>dequeue</code> function:</p>\n\n<pre><code>else if(amp-&gt;front==amp-&gt;rear)\n{\n  amp-&gt;front=-1;\n  amp-&gt;rear=-1;\n  return(amp-&gt;array[amp-&gt;front]);\n}\n</code></pre>\n\n<p>If the condition is true, then you first assign the value <code>-1</code> to <code>amp-&gt;front</code>. Then a couple of lines later you use <code>amp-&gt;front</code> (which is <code>-1</code> remember?) as index into your array.</p>\n\n<p>While using negative indexes is okay, because all array indexing really is simple pointer arithmetic, in this case it leads to the index being <em>out of bounds</em> which in turn leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n\n<p>This could easily have been found with a very little amount of <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">debugging your own code</a>, so please attempt that first next time.</p>\n\n<p>As for how to solve this, you should probably get and save the value of <code>amp-&gt;array[amp-&gt;front]</code> <em>before</em> you \"reset\" the <code>front</code> and <code>rear</code> members. Then return the saved value.</p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 3, "last_activity_date": 1534339573, "creation_date": 1534339573, "answer_id": 51859624, "question_id": 51859376, "link": "https://stackoverflow.com/questions/51859376/queue-array-based-implementation/51859624#51859624", "title": "queue array based implementation", "body": "<p>Your <code>dequeue</code> contains bugs.</p>\n\n<p>This is a corrected version:</p>\n\n<pre><code>int dequeue(struct queue* amp)\n{\n  if (isempty(amp))\n    return -1;\n  else if (amp-&gt;front == amp-&gt;rear)\n  {\n    int value = amp-&gt;array[amp-&gt;front];  // get value before modifying front\n    amp-&gt;front = -1;\n    amp-&gt;rear = -1;\n    return value;\n  }\n  else\n  {\n    int value = amp-&gt;array[amp-&gt;front];  // get value before modifying front\n    amp-&gt;front = ((amp-&gt;front) + 1) % (amp-&gt;capacity);\n    return value;\n  }\n}\n</code></pre>\n\n<p>or more elegant:</p>\n\n<pre><code>int dequeue(struct queue* amp)\n{\n  int value;\n\n  if (isempty(amp))\n    return -1;\n  else \n  {\n    value = amp-&gt;array[amp-&gt;front];\n\n    if (amp-&gt;front == amp-&gt;rear)\n    {\n      amp-&gt;front = -1;\n      amp-&gt;rear = -1;\n    }\n    else\n    {\n      amp-&gt;front = ((amp-&gt;front) + 1) % (amp-&gt;capacity);\n    }\n  }\n\n  return value;\n}\n</code></pre>\n\n<p>or even more elegant:</p>\n\n<pre><code>int dequeue(struct queue* amp)\n{\n  int value = -1;\n\n  if (!isempty(amp))\n  {\n    value = amp-&gt;array[amp-&gt;front];\n\n    if (amp-&gt;front == amp-&gt;rear)\n    {\n      amp-&gt;front = -1;\n      amp-&gt;rear = -1;\n    }\n    else\n    {\n      amp-&gt;front = ((amp-&gt;front) + 1) % (amp-&gt;capacity);\n    }\n  }\n\n  return value;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10229375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b223bc51a1698217e1f7db08dbff6fa?s=128&d=identicon&r=PG&f=1", "display_name": "meerutiya", "link": "https://stackoverflow.com/users/10229375/meerutiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1534339791, "creation_date": 1534338589, "last_edit_date": 1534339791, "question_id": 51859376, "link": "https://stackoverflow.com/questions/51859376/queue-array-based-implementation", "title": "queue array based implementation", "body": "<p>This is my program to implement queue using array. I am not getting the correct output when I am calling <code>dequeue</code> for the first time, but it is showing the correct output for the rest of the dequeue operations (again after showing some weird value).</p>\n\n<p>The output for this program is as follows:</p>\n\n<pre><code>136\n14\n13\n1342222119\n-1\n-1\n</code></pre>\n\n<p>This is what I have tried:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct queue {\n  int capacity;\n  int rear;\n  int front;\n  int *array;\n};\n\nstruct queue* createqueue(int capacity)\n{\n  struct queue* nque = (struct queue*)malloc(sizeof(struct queue));\n  nque-&gt;capacity = capacity;\n  nque-&gt;front = -1;\n  nque-&gt;rear = -1;\n  nque-&gt;array = (int*)malloc(sizeof(int)*capacity);\n  return nque;\n\n}\n\nint isempty(struct queue* amp)\n{\n  return(amp-&gt;front == -1 &amp;&amp; amp-&gt;rear == -1);\n}\n\nint  isfull(struct queue* amp)\n{\n  return (((amp-&gt;rear) + 1) % (amp-&gt;capacity) == amp-&gt;front);\n\n}\n\nvoid enqueue(struct queue* amp, int x)\n{\n  if (isfull(amp))\n    return;\n  else if (isempty(amp))\n  {\n    amp-&gt;rear = 0;\n    amp-&gt;front = 0;\n  }\n  else\n  {\n    amp-&gt;rear = (amp-&gt;rear + 1) % (amp-&gt;capacity);\n\n  }\n  amp-&gt;array[amp-&gt;rear] = x;\n}\n\nint dequeue(struct queue* amp)\n{\n  if (isempty(amp))\n    return -1;\n  else if (amp-&gt;front == amp-&gt;rear)\n  {\n    amp-&gt;front = -1;\n    amp-&gt;rear = -1;\n    return(amp-&gt;array[amp-&gt;front]);\n  }\n  else\n  {\n    amp-&gt;front = ((amp-&gt;front) + 1) % (amp-&gt;capacity);\n    return(amp-&gt;array[amp-&gt;front]);\n  }\n}\n\nint main() {\n  struct queue* queue = createqueue(10);\n  enqueue(queue, 12);\n  enqueue(queue, 136);\n  enqueue(queue, 14);\n  enqueue(queue, 13);\n  enqueue(queue, 16);\n\n  printf(\"\\n%d\", dequeue(queue));\n  printf(\"\\n%d\", dequeue(queue));\n  printf(\"\\n%d\", dequeue(queue));\n\n  printf(\"\\n%d\", dequeue(queue));\n  printf(\"\\n%d\", dequeue(queue));\n  printf(\"\\n%d\", dequeue(queue));\n  printf(\"\\n%d\", dequeue(queue));\n}\n</code></pre>\n\n<p>How to fix this issue?</p>\n"}, {"tags": ["c", "text-files", "scanf", "fgets", "leading-zero"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1534338522, "post_id": 51859219, "comment_id": 90670773, "body": "This code seems to do as you would expect.  Please post the contents of &quot;valuelist.txt&quot; along with the expected and actual output.  Also, this code will not compile as is because <code>countlines</code>, <code>num</code>, and <code>numtwo</code> are not defined."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1534338699, "post_id": 51859219, "comment_id": 90670881, "body": "Why count <i>lines</i>???"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 6, "creation_date": 1534338743, "post_id": 51859219, "comment_id": 90670904, "body": "...and then read <code>lines*2</code> bytes but there are only <code>lines+1</code> bytes?"}, {"owner": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534339292, "post_id": 51859219, "comment_id": 90671206, "body": "@dbush updated the file + the current output, think you see whats wrong.. \u2013 David Dabrue just now   edit"}, {"owner": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1534339451, "post_id": 51859219, "comment_id": 90671292, "body": "@PaulOgilvie counting lines, because line length may differ later"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1534339462, "post_id": 51859219, "comment_id": 90671301, "body": "Also: <code>sscanf()</code> returns a value. You could use that."}, {"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 0, "creation_date": 1534339606, "post_id": 51859219, "comment_id": 90671389, "body": "set  <code>lines</code> to a reasonable (constant!) value, like <code>255</code>. It looks like you are reading few characters only"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534340659, "post_id": 51859219, "comment_id": 90672013, "body": "If you want to know the length of a line, <code>lines</code> is a bad name. It indicates that you count lines, which is what you don&#39;t do."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1534340776, "post_id": 51859219, "comment_id": 90672070, "body": "Please don&#39;t make your question a moving target by changing relevant parts of the code invalidating most commands and answers!"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534340803, "post_id": 51859219, "comment_id": 90672083, "body": "With <code>lines = 3</code> you cannot read a line holding <code>55 009</code>"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1534340479, "post_id": 51859711, "comment_id": 90671905, "body": "Nitpick: <code>fgets(tempp, 4, ff)</code> reads at most <i>3</i> bytes from the file, not 4 (and appends a null terminator after the last byte read)."}, {"owner": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "edited": false, "score": 0, "creation_date": 1534340579, "post_id": 51859711, "comment_id": 90671969, "body": "first of all, thanks for the explanation. what if there are like twenty leading zeros? my problem is, that due to the program that creates the valuelist.txt i don&#39;t know how much leading zeros there will be.."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1534340581, "post_id": 51859711, "comment_id": 90671970, "body": "@JohnBollinger Good catch.  Fixed."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "edited": false, "score": 1, "creation_date": 1534340744, "post_id": 51859711, "comment_id": 90672051, "body": "@DavidDabrue  If you can&#39;t predict how log a line will be but you know there are two values per line, you may be better off using <code>fscanf</code> directly as suggested by John Bollinger."}, {"owner": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "edited": false, "score": 0, "creation_date": 1534341049, "post_id": 51859711, "comment_id": 90672226, "body": "with every leading zero the line gets longer or am i wrong?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "edited": false, "score": 0, "creation_date": 1534341115, "post_id": 51859711, "comment_id": 90672261, "body": "@DavidDabrue Yes, every additional character means more characters in the line, i.e. the line is longer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "edited": false, "score": 0, "creation_date": 1534342856, "post_id": 51859711, "comment_id": 90673270, "body": "@DavidDabrue, if you do not have a firm upper bound on line width in advance, and if you furthermore refuse to use <code>fscanf</code>, then you could consider reading your file one byte at a time via <code>fgetc()</code>, and doing your own numeric parsing.  It wouldn&#39;t be that hard.  It is certainly possible to adapt dynamically to input line length without pre-scanning the whole file, but that&#39;s a bit messy, and a lot more complicated than just parsing unsigned decimal numbers."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1534340570, "last_edit_date": 1534340570, "creation_date": 1534339878, "answer_id": 51859711, "question_id": 51859219, "link": "https://stackoverflow.com/questions/51859219/reading-a-file-in-c-leading-zeros/51859711#51859711", "title": "reading a file in C: leading zeros", "body": "<p>You haven't allocated enough space to read in each line.  You're using the <em>number of lines</em> as the <em>length of a line</em>, but these are not the same.</p>\n\n<p>You allocate 4 bytes (<code>lines + 1</code>) for <code>ttemp</code>, which you use to read in a line.  However the first line of text has 6 characters in it.  So the first call to <code>fgets</code> only reads the first 3 bytes, namely <code>\"55 \"</code>.  That's what then gets parsed by <code>sscanf</code>.  The next call gets the next 3 bytes, namely <code>\"09\\n\"</code> and stops reading at the newline, so just the first number gets parsed out.</p>\n\n<p>Since you use <code>fgets</code> in a loop to read lines and print the contents, you actually don't need to know how many lines there are.  You do however need to know the maximum length of a line.  Since you're reading two decimal integers, 30 bytes should be enough to read a full line.  So make a fixed buffer of that size:</p>\n\n<pre><code>    char tempp[30];\n    while(fgets(tempp,sizeof(tempp),ff) != NULL){\n        ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 4, "last_activity_date": 1534339923, "creation_date": 1534339923, "answer_id": 51859727, "question_id": 51859219, "link": "https://stackoverflow.com/questions/51859219/reading-a-file-in-c-leading-zeros/51859727#51859727", "title": "reading a file in C: leading zeros", "body": "<p>In your updated code and data, the problem is certainly that the value of <code>lines</code> is too small for your usage.  You are using it to measure how much space you need for your <code>tempp</code> buffer, but that requires a maximum line <em>width</em> (plus one for the newline and another for the terminator).  You are instead giving it a line <em>count</em>, and that of a file having only a few lines.  Therefore <code>fgets()</code> is breaking up your lines across multiple calls.</p>\n\n<p>You indeed could pre-scan the file to find an appropriate width, then allocate that much, but you're going to a lot of trouble here to use <code>fgets</code> instead of <code>fscanf</code>.  There are indeed reasons to prefer that for many problems, but yours does not look like one of them.  You would save yourself considerable trouble and code by doing this instead:</p>\n\n<pre><code>unsigned num, numtwo;\nwhile (fscanf(ff, \"%u%u\", &amp;num, &amp;numtwo) == 2) {\n    // update counter, print results, etc...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 0, "last_activity_date": 1534343268, "creation_date": 1534343268, "answer_id": 51860655, "question_id": 51859219, "link": "https://stackoverflow.com/questions/51859219/reading-a-file-in-c-leading-zeros/51860655#51860655", "title": "reading a file in C: leading zeros", "body": "<p>Your fundamental problem is your <code>lines</code> variable.  It is way too small.  (Was it supposed to be \"line size\"?)</p>\n\n<p>I would recommend that you get rid of the <code>lines</code> variable, the <code>tempp</code> variable, and the <code>malloc</code> call.  Declare a single array</p>\n\n<pre><code>char line[1000];\n</code></pre>\n\n<p>1000 characters should be plenty long for any imaginable input.  Then your loop can be</p>\n\n<pre><code>while(fgets(line, sizeof(line), ff) != NULL) { ...\n</code></pre>\n\n<p>The rest of your code looks okay.  With this change, you should stop having problems with your numbers getting weirdly broken up.</p>\n"}], "owner": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 51859727, "answer_count": 3, "score": 1, "last_activity_date": 1534345756, "creation_date": 1534337989, "last_edit_date": 1534339205, "question_id": 51859219, "link": "https://stackoverflow.com/questions/51859219/reading-a-file-in-c-leading-zeros", "title": "reading a file in C: leading zeros", "body": "<p>In my program I'm trying to read two values per line from a textfile.\nIt works well with my code below, but when I face numbers with leading zeros, it stores every zero as one value. </p>\n\n<p>I want to be able to read in e.g. <strong>\"007\"</strong> as plain <strong>\"7\"</strong>, but I still want to be able to read a <strong>\"0\"</strong> as a value. </p>\n\n<p>Anyone could help me improving my code or point out what/where it could be improved?</p>\n\n<p>thanks in advance</p>\n\n<p><strong>valuelist.txt</strong>    </p>\n\n<pre><code>55 009\n63 10\n12 0\n</code></pre>\n\n<p><strong>output</strong></p>\n\n<pre><code>counter: 0 | Value A: 55 Value B: 0 \ncounter: 1 | Value A: 9 Value B: 0 \ncounter: 2 | Value A: 9 Value B: 0 \ncounter: 3 | Value A: 63 Value B: 0 \ncounter: 4 | Value A: 10 Value B: 0 \ncounter: 5 | Value A: 12 Value B: 0 \ncounter: 6 | Value A: 0 Value B: 0 \n</code></pre>\n\n<p><strong>main</strong></p>\n\n<pre><code>int main(void) {\n\n        char name[] = \"valuelist.txt\";\n        unsigned int counter = 0;\n        unsigned int lines = 3;\n        unsigned int num;\n        unsigned int numtwo;\n\n\n        FILE* ff = fopen(name,\"r\");\n        if(ff == NULL) {\n             fprintf(stderr, \"Error \\n\");\n            return -1;\n        }\n\n        char *tempp = (char*) malloc(lines + 1 );\n\n        while(fgets(tempp,lines+1,ff) != NULL){\n\n              sscanf(tempp,\"%u %u\",&amp;num, &amp;numtwo);\n\n              printf(\"counter: %u | \",counter);\n              printf(\"Value A: %u \",num);\n              printf(\"Value B: %u \\n\",numtwo);\n\n              counter++;\n        }\n        free(tempp);\n        tempp = NULL;\n\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "break"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1534336870, "post_id": 51858871, "comment_id": 90669821, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9695902/how-to-break-out-of-nested-loops\">How to break out of nested loops?</a>"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 5, "creation_date": 1534336887, "post_id": 51858871, "comment_id": 90669835, "body": "<code>break</code> doesn&#39;t break out of <code>if</code>, it&#39;s for loops. It will break out of the <code>for</code> loop."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1534336920, "post_id": 51858871, "comment_id": 90669854, "body": "See also e.g. <a href=\"https://stackoverflow.com/q/24714287/3001761\">stackoverflow.com/q/24714287/3001761</a>"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1534336925, "post_id": 51858871, "comment_id": 90669858, "body": "@jonrsharpe That (first) question deals with nested loops. In this one, there&#39;s only one loop."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1534336963, "post_id": 51858871, "comment_id": 90669878, "body": "@ThomasJager as you point out <code>break</code> doesn&#39;t act on <code>if</code>s though, so the question doesn&#39;t make sense at face value."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1534337172, "post_id": 51858871, "comment_id": 90670011, "body": "Why don&#39;t you try it?"}, {"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1534337396, "post_id": 51858871, "comment_id": 90670120, "body": "<a href=\"https://www.tutorialspoint.com/cprogramming/c_break_statement.htm\" rel=\"nofollow noreferrer\">break statement</a>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534337970, "post_id": 51858871, "comment_id": 90670438, "body": "you do need to &quot;break&quot; if statements"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "is_accepted": true, "score": 14, "last_activity_date": 1534342168, "last_edit_date": 1534342168, "creation_date": 1534336984, "answer_id": 51858933, "question_id": 51858871, "link": "https://stackoverflow.com/questions/51858871/will-a-break-statement-break-out-multiple-if-statements/51858933#51858933", "title": "Will a &#39;break&#39; statement break out multiple if statements?", "body": "<p>It will break the loop (the inner most loop that the if contains in) no matter how many if statments are nested inside. A <code>break</code> breaks from a loop and not from if statement.</p>\n"}, {"comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1534337331, "post_id": 51858976, "comment_id": 90670090, "body": "Only for loops? , <code>break;</code> can also occur inside a <code>switch(){}</code>"}, {"owner": {"reputation": 11359, "user_id": 1323940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/def1b1fd4342d9e332b7a3bf41f57a00?s=128&d=identicon&r=PG", "display_name": "SzG", "link": "https://stackoverflow.com/users/1323940/szg"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1534337416, "post_id": 51858976, "comment_id": 90670137, "body": "True. Edited .aS&lt;DkjdcghaslkjhdgasdjklhaSGDLAJSKHGD"}], "tags": [], "owner": {"reputation": 11359, "user_id": 1323940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/def1b1fd4342d9e332b7a3bf41f57a00?s=128&d=identicon&r=PG", "display_name": "SzG", "link": "https://stackoverflow.com/users/1323940/szg"}, "is_accepted": false, "score": 4, "last_activity_date": 1534337393, "last_edit_date": 1534337393, "creation_date": 1534337123, "answer_id": 51858976, "question_id": 51858871, "link": "https://stackoverflow.com/questions/51858871/will-a-break-statement-break-out-multiple-if-statements/51858976#51858976", "title": "Will a &#39;break&#39; statement break out multiple if statements?", "body": "<p><code>break</code> is only for loops and <code>switch</code> statements. It ignores the <code>if</code>s and it will leave the loop, as required.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534345300, "post_id": 51859409, "comment_id": 90674739, "body": "What is your source for the claim that <code>if</code> is not a loop in any programming language? Did somebody survey every programming language every created, even by a student in a class exercise? Is there no foreign language in which <code>if</code> has some other meaning and was used as a loop keyword? Has no assembly language happened to use <code>if</code> as a mnemonic for a branch instruction?"}], "tags": [], "owner": {"reputation": 118, "user_id": 10150468, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JwGALU4S0AY/AAAAAAAAAAI/AAAAAAAAAk4/ob3FaSY97P0/photo.jpg?sz=128", "display_name": "Kishan", "link": "https://stackoverflow.com/users/10150468/kishan"}, "is_accepted": false, "score": 2, "last_activity_date": 1534338690, "creation_date": 1534338690, "answer_id": 51859409, "question_id": 51858871, "link": "https://stackoverflow.com/questions/51858871/will-a-break-statement-break-out-multiple-if-statements/51859409#51859409", "title": "Will a &#39;break&#39; statement break out multiple if statements?", "body": "<p>A <strong>break statement</strong> only has an effect on <strong>loops</strong> ( do , for , while ) and switch statements (for breaking out of a case ).</p>\n\n<p><strong>if</strong> is not a loop in any programming language(not in C++ either). If-else statements are conditional statements where you take some actions if a predefined condition is true or false. There is no loop in if statements. So you can't break <strong>if</strong> statement since it is not a loop or switch statement.</p>\n\n<p>Hope you understand!</p>\n"}], "owner": {"reputation": 123, "user_id": 8838759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6669813ef546c0054e5cadc481f8066b?s=128&d=identicon&r=PG&f=1", "display_name": "Sphero", "link": "https://stackoverflow.com/users/8838759/sphero"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9594, "favorite_count": 1, "closed_date": 1534352747, "accepted_answer_id": 51858933, "answer_count": 3, "score": 1, "last_activity_date": 1534342168, "creation_date": 1534336742, "last_edit_date": 1534336882, "question_id": 51858871, "link": "https://stackoverflow.com/questions/51858871/will-a-break-statement-break-out-multiple-if-statements", "closed_reason": "Not suitable for this site", "title": "Will a &#39;break&#39; statement break out multiple if statements?", "body": "<p>If I have multiple if-statements nested inside each other which are all in a for-loop, will a break statement on the inner-most if-statement break out of the for-loop or just into the next if statement?</p>\n"}, {"tags": ["c", "function", "char", "printf", "return-value"], "comments": [{"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1534337894, "post_id": 51856963, "comment_id": 90670394, "body": "You should realize that when you call printf, it is passed four parameters, and three of them are identical. The first is the format string <code>&quot;%s , %s , %s \\n&quot;</code> and the other three are each set to the address of the static character array <code>oS</code> -- because that&#39;s what <code>toStr()</code> returns every time you call it."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1534328825, "creation_date": 1534328825, "answer_id": 51857032, "question_id": 51856963, "link": "https://stackoverflow.com/questions/51856963/multiple-call-of-char-returning-function-for-immediately-fprint/51857032#51857032", "title": "Multiple call of char[] returning function for immediately fprint", "body": "<p>Local <code>static</code> variables are <em>shared</em> between all invocations of the function. That means all calls will use the same buffer and return the same pointer to the same string.</p>\n\n<p>And since the evaluation order of arguments is not specified (I don't remember if it's implementation defined, undefined, or just simply not specified), then you don't know which will be the last call (which will be the call the decides which the contents of the array will have).</p>\n\n<p>The only thing you <em>do</em> know is that <em>all</em> arguments must be evaluated <em>before</em> the actual call to the function is made. Arguments and expressions are not evaluated lazily.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1534330242, "creation_date": 1534330242, "answer_id": 51857338, "question_id": 51856963, "link": "https://stackoverflow.com/questions/51856963/multiple-call-of-char-returning-function-for-immediately-fprint/51857338#51857338", "title": "Multiple call of char[] returning function for immediately fprint", "body": "<p>The order of evaluation of function arguments is <a href=\"https://en.wikipedia.org/wiki/Unspecified_behavior\" rel=\"nofollow noreferrer\"><em>unspecified</em></a>. So <code>printf</code> doesn't necessarily evaluate it in any order you desire/expect.</p>\n\n<p>As you debug prints show, <code>toStr</code> does write multiple value to <code>oS</code>. But <em>all</em> arguments of <code>printf</code> will be evaluated before the function call is made.\nSo the whatever the value written as will be value written by printf for all 3 arguments since the function <code>toStr</code> returns the pointer to the <em>same</em> object (<code>oS</code> in <code>toStr</code>).</p>\n\n<p>Note that function-local <code>static</code> variables are error prone as it's not thread-safe.</p>\n\n<blockquote>\n  <p>But i need the static (as one possible way) to make the content of oS available outside of toStr.</p>\n</blockquote>\n\n<p>It's not possible to achieve what you want in your current way. You can either ask <code>toStr</code> to allocate memory each time (save it in the caller and free it after use).\nOr pass the buffer you to write to each time:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *toStr(char *, size_t, int);\n\nint main (void)\n{\n    char s1[256];\n    char s2[256];\n    char s3[256];\n    /* could also use s[3][256]; instead 3 separate vars */\n\n    printf(\"%s , %s , %s\\n\", toStr(s1, sizeof s1, 1), toStr(s2, sizeof s2, 2), toStr(s3, sizeof s3, 3));\n}\n\nchar *toStr(char *oS, size_t len, int z)\n{\n    snprintf(oS, len, \"%d\", z);\n    printf(\"Will return: %s\\n\", oS);\n    return oS;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1534330786, "creation_date": 1534330786, "answer_id": 51857452, "question_id": 51856963, "link": "https://stackoverflow.com/questions/51856963/multiple-call-of-char-returning-function-for-immediately-fprint/51857452#51857452", "title": "Multiple call of char[] returning function for immediately fprint", "body": "<p>After 3 calls to the function printf prarameters point to the same <code>static</code> buffer - and this buffer contains (which obvious only the one information. </p>\n\n<p>You can check the evaluation order of your implementation without <code>printf</code>s inside the function</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *foo(const int i)\n{\n    static char c[200] = {0,};\n\n    sprintf(&amp;c[strlen(c)], \"i = %d \", i);\n    return c;\n}\n\nint main(void) {\n    printf(\"%s %s %s\\n\", foo(1), foo(2), foo(3));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10228659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c71c432797078e4e45ca281647f720f?s=128&d=identicon&r=PG&f=1", "display_name": "komPLEX", "link": "https://stackoverflow.com/users/10228659/komplex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1534330786, "creation_date": 1534328520, "question_id": 51856963, "link": "https://stackoverflow.com/questions/51856963/multiple-call-of-char-returning-function-for-immediately-fprint", "title": "Multiple call of char[] returning function for immediately fprint", "body": "<p>I look for a comfortable way of converting a custom type variable to char[] (string) for the purpose of immediate fprinting. Here is what I intend to do, yet still flawed.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar * toStr (int);\n\nvoid main (void) {\n   printf(\"%s , %s , %s \\n\", toStr(1), toStr(2), toStr(3));\n}\n\nchar * toStr (int z) {\n\n    static char oS[100];\n    sprintf(oS, \"%d\", z);\n    printf(\"Will return: %s\\n\", oS);\n    return oS;\n}\n</code></pre>\n\n<p>This will display</p>\n\n<pre><code>Will return: 3\nWill return: 2\nWill return: 1\n1 , 1 , 1\n</code></pre>\n\n<p>I see what the problem is here, printf seems to print the content of static char oS once for all three calls in its parameterlist. It does not evaluate each call exactely when it is needed in the format string. But i need the static (as one possible way) to make the content of oS available outside of toStr.\nI feel like I am almost there, of corse I want the output</p>\n\n<pre><code>1 , 2 , 3\n</code></pre>\n\n<p>on screen. Is there a possiblility to get what I want, without having to mallocate and free every part or storing each return of toStr in a sepearate variable just to fprint them aftwerwards? Isn't it possible to fprint the return values of the same function multiple times in one call?</p>\n"}, {"tags": ["c", "gcc", "char", "memory-alignment"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1534329859, "post_id": 51856915, "comment_id": 90666624, "body": "It is a bit strange indeed. My guess is that they want it allocated in a certain memory segment of 4kib."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 4, "creation_date": 1534330936, "post_id": 51856915, "comment_id": 90667055, "body": "Unfortunately variable definition alone won&#39;t tell us much. You&#39;ll need to investigate usages of <code>buffer</code> to try and get more information."}, {"owner": {"reputation": 9716, "user_id": 1116739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7dd5d55de3e76fd4ca0916028e2d46?s=128&d=identicon&r=PG", "display_name": "cha0site", "link": "https://stackoverflow.com/users/1116739/cha0site"}, "edited": false, "score": 1, "creation_date": 1534331384, "post_id": 51856915, "comment_id": 90667234, "body": "Maybe it&#39;s alignment to page size?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1534334759, "post_id": 51856915, "comment_id": 90668779, "body": "Keep in mind that something being allocated as <code>char *</code> has nothing to do with how it will be used. Until you know that, the alignment could be for just about anything. E.g., numpy uses a <code>char *</code> to hold array data, whether primitive or pointer."}], "answers": [{"tags": [], "owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "is_accepted": true, "score": 0, "last_activity_date": 1534334916, "last_edit_date": 1534334916, "creation_date": 1534331409, "answer_id": 51857579, "question_id": 51856915, "link": "https://stackoverflow.com/questions/51856915/char-array-attribute-aligned/51857579#51857579", "title": "char array __attribute__ aligned", "body": "<p>Perhaps the use of a constant is not the best idea, at least, without a good explanation about the target (it looks like the page size of the example is 4096). Some architectures have specific instructions for copying big chunks of memory (such as the whole page), which may do the process faster:</p>\n\n<blockquote>\n  <p>GCC also provides a target specific macro <strong>BIGGEST_ALIGNMENT</strong>, which is the largest \n    alignment ever used for any data type on the target machine you are compiling for. For \n    example, you could write:\n    short array[3] <strong>attribute</strong> ((aligned (<strong>BIGGEST_ALIGNMENT</strong>)));</p>\n  \n  <p>The compiler automatically sets the alignment for the declared variable or field to \n    <strong>BIGGEST_ALIGNMENT</strong>. Doing this can often make copy operations more efficient, \n    because the compiler can use whatever instructions copy the biggest chunks of memory when performing copies to or from the variables or fields that you have aligned this way. Note that the value of <strong>BIGGEST_ALIGNMENT</strong> may change depending on command-line options.</p>\n</blockquote>\n\n<p>[...]</p>\n\n<blockquote>\n  <p>Note that the effectiveness of aligned attributes may be limited by inherent limitations in your linker. On many systems, the linker is only able to arrange for variables to be aligned up to a certain maximum alignment. (For some linkers, the maximum supported alignment may be very very small.) If your linker is only able to align variables up to a maximum of 8-byte alignment, then specifying aligned(16) in an <strong>attribute</strong> still only provides you with 8-byte alignment. See your linker documentation for further information.</p>\n</blockquote>\n\n<p>For the completeness sake, it wants to ensure that the array will be set in one page, in order to increase performance.</p>\n\n<p>This link explains how to the aligned-page data (in that case, with <code>aligned_malloc</code>) improves the code: <a href=\"https://software.intel.com/en-us/articles/getting-the-most-from-opencl-12-how-to-increase-performance-by-minimizing-buffer-copies-on-intel-processor-graphics\" rel=\"nofollow noreferrer\">https://software.intel.com/en-us/articles/getting-the-most-from-opencl-12-how-to-increase-performance-by-minimizing-buffer-copies-on-intel-processor-graphics</a></p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 1537765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d4c685ceb73326eeda2563c2103c598?s=128&d=identicon&r=PG", "display_name": "user1537765", "link": "https://stackoverflow.com/users/1537765/user1537765"}, "is_accepted": false, "score": 0, "last_activity_date": 1567425804, "creation_date": 1567425804, "answer_id": 57756642, "question_id": 51856915, "link": "https://stackoverflow.com/questions/51856915/char-array-attribute-aligned/57756642#57756642", "title": "char array __attribute__ aligned", "body": "<p>I will guess that a specific HW wants it to be aligned that way. (mass storage reader, DMA etc).\nI must say it is rare to see alignment that big.</p>\n"}], "owner": {"reputation": 45, "user_id": 9611276, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "lospollos", "link": "https://stackoverflow.com/users/9611276/lospollos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 1, "accepted_answer_id": 51857579, "answer_count": 2, "score": 2, "last_activity_date": 1567425804, "creation_date": 1534328324, "last_edit_date": 1534334570, "question_id": 51856915, "link": "https://stackoverflow.com/questions/51856915/char-array-attribute-aligned", "title": "char array __attribute__ aligned", "body": "<p>I have a question about the following line of code:</p>\n\n<pre><code>char buffer[256] __attribute__((aligned(4096)));\n</code></pre>\n\n<p>The content of the global array \"buffer\" are strings, which i get from stdin.\nI have read <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.4.1/gcc/Type-Attributes.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-4.4.1/gcc/Type-Attributes.html</a> (gcc/gnu online documentation). I get that this attribute specifies a minimum alignment for variables in bytes. </p>\n\n<p>My question regards the reason WHY i would need such an alignment for an char array?</p>\n\n<p>Just because of perfomance reasons? </p>\n"}, {"tags": ["c", "inline-assembly"], "comments": [{"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 1, "creation_date": 1534327185, "post_id": 51856619, "comment_id": 90665469, "body": "If you are using <code>gcc</code>, your inline assembly code should be in <code>GAS</code> format, not the <code>Intel</code> format."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534327315, "post_id": 51856619, "comment_id": 90665533, "body": "@SusmitAgrawal: <code>__asm { block }</code> is not gcc syntax; it&#39;s MSVC, or maybe <code>clang -fasm-blocks</code>."}, {"owner": {"reputation": 152, "user_id": 8747784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTGCOdqoRCg/AAAAAAAAAAI/AAAAAAAAAkw/WZ_0FoMhnEo/photo.jpg?sz=128", "display_name": "The dark side of Gaming", "link": "https://stackoverflow.com/users/8747784/the-dark-side-of-gaming"}, "edited": false, "score": 1, "creation_date": 1534327506, "post_id": 51856619, "comment_id": 90665639, "body": "It compiles with wcl, I think that&#39;s WATCOM. Which I must also install according to the tutorial I followed, not gcc. <code>wcl -lr -l=COM -0 -fe=KERNEL.COM kernel.c</code>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1534327567, "post_id": 51856619, "comment_id": 90665669, "body": "This isn&#39;t a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  You didn&#39;t include the definition for you <code>scanf</code>; if you&#39;re statically linking the 32-bit or 64-bit <code>libc</code> definition then of course it doesn&#39;t work in a freestanding kernel.  And if <code>scanf</code> is defined normally, you&#39;re overwriting one byte of the pointer value with a character.  (Not the pointed-to string literal, which you can probably modify in real mode with no memory protection, even though you told the compiler it&#39;s <code>const</code>.  <code>scanf(&quot;%c&quot;, inpt)</code> to do that.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534327904, "post_id": 51856619, "comment_id": 90665845, "body": "Does Watcom <code>scanf</code> use DOS system calls?  Or pure BIOS?  Because DOS won&#39;t be available if you boot your kernel.  Anyway, <code>char input(){ return getchar(); }</code> should probably work much better than scanf.  But if you want to <code>scanf &quot;%c&quot;</code>, make sure the 2nd arg is a <code>char*</code>, not a <code>char**</code> like you&#39;re using.  <b>Turn on compiler warnings</b>."}, {"owner": {"reputation": 152, "user_id": 8747784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTGCOdqoRCg/AAAAAAAAAAI/AAAAAAAAAkw/WZ_0FoMhnEo/photo.jpg?sz=128", "display_name": "The dark side of Gaming", "link": "https://stackoverflow.com/users/8747784/the-dark-side-of-gaming"}, "edited": false, "score": 0, "creation_date": 1534328366, "post_id": 51856619, "comment_id": 90666041, "body": "Warnings are enabled"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1534340447, "post_id": 51856619, "comment_id": 90671881, "body": "How do youload this KERNEL.COM file at boot time. Do you have some specialized bootloader? Maybe one of Alexey Frunze&#39;s bootloaders? Are you just intending it to be run from a DOS emulator (like DOSBox) or VM"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1534341497, "post_id": 51856619, "comment_id": 90672493, "body": "If you are running this from DOS as a regular program then the primary issues are that you are reading a string as a character and returning the address of a local non static variable. Try changing <code>const char* inpt = &quot;Hi&quot;;</code> to <code>static char inpt[80];</code> (where 80 is maximum length) and then read the string this way <code>scanf(&quot;%79s&quot;,&amp;inpt);</code>(79 is 1 less than 80 to hold NUL character)"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1534345200, "post_id": 51856619, "comment_id": 90674687, "body": "@PeterCordes : The default DOS Watcom C library relies on DOS Interrupts (int 0x21), although there are BIOS variants of some C library functions. For example <code>_bprintf</code>, unfortunately there is no <code>_bscanf</code>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534374098, "post_id": 51856619, "comment_id": 90686960, "body": "@ThedarksideofGaming: then your compiler doesn&#39;t support checking the format string against the arg types like gcc does.  Use a modern compiler like gcc or clang with <code>-Wall -O2</code> to check for warnings in the parts of your code that are portable enough to compile."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534327723, "post_id": 51856748, "comment_id": 90665748, "body": "Part of <code>putchar</code>&#39;s operation is to increment the output position.  You forgot to do that.  Use a <code>static</code> variable or something.  Or define it as <code>putchar_col(char c, int col)</code>, but don&#39;t use a global <code>COL_NUMBER</code>, that&#39;s terrible style."}, {"owner": {"reputation": 152, "user_id": 8747784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTGCOdqoRCg/AAAAAAAAAAI/AAAAAAAAAkw/WZ_0FoMhnEo/photo.jpg?sz=128", "display_name": "The dark side of Gaming", "link": "https://stackoverflow.com/users/8747784/the-dark-side-of-gaming"}, "edited": false, "score": 0, "creation_date": 1534327876, "post_id": 51856748, "comment_id": 90665831, "body": "My old _putchar function works better than this one, this only gives me errors"}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534327963, "post_id": 51856748, "comment_id": 90665874, "body": "What errors do you get? You may need to modify your compiler flags to remove them."}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534328278, "post_id": 51856748, "comment_id": 90666001, "body": "Based on the errors, it looks like you have already used the variable namesz I&#39;ve given here (maybe in <code>stdio.h</code>?). You will need to change the variable names, and pass proper parameters to the function"}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534328399, "post_id": 51856748, "comment_id": 90666059, "body": "You could have a look at my <code>display.c</code> and <code>display.h</code> from this project: <a href=\"https://github.com/Susmit-A/MyOS/tree/master/OS/include\" rel=\"nofollow noreferrer\">github.com/Susmit-A/MyOS/tree/master/OS/include</a>"}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1534393981, "post_id": 51856748, "comment_id": 90690792, "body": "@MichaelPetch yes, my mistake."}, {"owner": {"reputation": 152, "user_id": 8747784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTGCOdqoRCg/AAAAAAAAAAI/AAAAAAAAAkw/WZ_0FoMhnEo/photo.jpg?sz=128", "display_name": "The dark side of Gaming", "link": "https://stackoverflow.com/users/8747784/the-dark-side-of-gaming"}, "edited": false, "score": 0, "creation_date": 1534490288, "post_id": 51856748, "comment_id": 90731313, "body": "still not working, I only use watcom&#39;s stdio.h library (or gcc&#39;s) and kernel.c."}], "tags": [], "owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "is_accepted": false, "score": -1, "last_activity_date": 1534393937, "last_edit_date": 1534393937, "creation_date": 1534327574, "answer_id": 51856748, "question_id": 51856619, "link": "https://stackoverflow.com/questions/51856619/how-to-make-an-input-function-in-c-with-assembly/51856748#51856748", "title": "How to make an input function in C with Assembly", "body": "<p>EDIT: \nBased on comment,</p>\n\n<p>Your <code>putchar</code> function, in C, would be:</p>\n\n<pre><code>void _putchar(char c, int *column) {\n    char *start;\n    start = (char *)0xb8000;\n    char *loc;\n    loc = start + ((*column) * 2); //Two bytes per cell: one for the char, other for color\n    *loc = c;\n    *column += 1;\n}\n</code></pre>\n\n<p>This is assuming you are using the 80*25 text mode.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534373997, "post_id": 51859613, "comment_id": 90686941, "body": "<code>char inpt[2]</code> is a local variable: you can&#39;t safely return it.  <code>static char inpt[80]</code> would make sense, but not automatic storage."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534374290, "post_id": 51859613, "comment_id": 90686997, "body": "The OP is using the very old Watcom compiler to make 16-bit binaries.  Apparently it doesn&#39;t have warnings for format-string mismatches with the types.  It&#39;s not a compile-time error to pass wrong types to variadic functions, that&#39;s one reason C++ generally avoids printf and scanf."}], "tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": false, "score": 0, "last_activity_date": 1534339533, "creation_date": 1534339533, "answer_id": 51859613, "question_id": 51856619, "link": "https://stackoverflow.com/questions/51856619/how-to-make-an-input-function-in-c-with-assembly/51859613#51859613", "title": "How to make an input function in C with Assembly", "body": "<p>As you note in your comment, your input routine doesn't work. There are a couple of issues with it.</p>\n\n<pre><code>const char* inpt = \"Hi\";\nscanf(\"%c\",&amp;inpt);\n</code></pre>\n\n<p>This code looks like the intent is to create a buffer that could accept a string - but if so, the buffer is only long enough for a two character string. (There are actually 3 characters, 'H', 'i', and 0.)</p>\n\n<p>A quick look at the documentation for <code>scanf</code> tells us that the parameter(s) you pass after the format specifier need to match the types specified. In your case, that's a single character. So, you should be passing the address of a character, in other words a <code>char*</code>. But you're actually passing the address of a <code>char*</code> and I don't know why your compiler didn't warn you about that (or even produce an error). Mine won't let me make mistakes like that.</p>\n\n<p>So this should work</p>\n\n<pre><code>char inpt[2] = {0,0};\nscanf(\"%c\",inpt);\n</code></pre>\n\n<p>... assuming that you only ever want to be able to enter one character at a time, and want to treat it as a string. <strong>But</strong> it isn't safe to return the address of a local variable from your <code>input</code> function. You can return a single character, or you can pass the address of a buffer into your function, and it can write to the buffer.</p>\n\n<p>If your intent was to enter whole strings and act on them, you probably wanted something like this:</p>\n\n<pre><code>char str [80];\nscanf (\"%79s\",str);\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 8747784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTGCOdqoRCg/AAAAAAAAAAI/AAAAAAAAAkw/WZ_0FoMhnEo/photo.jpg?sz=128", "display_name": "The dark side of Gaming", "link": "https://stackoverflow.com/users/8747784/the-dark-side-of-gaming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1534393937, "creation_date": 1534327042, "last_edit_date": 1534327694, "question_id": 51856619, "link": "https://stackoverflow.com/questions/51856619/how-to-make-an-input-function-in-c-with-assembly", "title": "How to make an input function in C with Assembly", "body": "<p>I am making an operating system with <code>OSDEV</code> and I want to make an console, but I when using <code>scanf</code> it doesn't work. Using this code ends with a result of not being able to input text. The output is:</p>\n\n<p><code>KironOS Console - v0.0.1 PRE-ALPHA</code>\nType <code>help</code> for a list of commands.</p>\n\n<pre><code>&gt; Some weird characters\n\n&gt; Some weird characters\n\n&gt; Some weird characters\n</code></pre>\n\n<p>And this keeps going</p>\n\n<p><strong>kernel.c</strong></p>\n\n<pre><code>typedef int bool;\n#define true 1\n#define false 0\n\n#include &lt;stdio.h&gt;\n\nconst char* input();\nvoid execute(const char* cmd);\nvoid output(const char* s, bool ln);\nvoid _puts(const char* s);\nvoid _putchar(char c);\n\nchar* newline = \"\\n\\r\";\nchar* version = \"0.0.1 PRE-ALPHA\";\n\nvoid main(void) {\n    output(\"KironOS Console - v\",0); output(version,1);\n    output(\"Type 'help' for a list of commands.\",1);\n    output(\"\",1);\n    while(1==1) {\n        output(\"&gt; \",0);\n        execute(input());\n        output(\"\",1);\n    }\n}\n\nvoid execute(const char* cmd) {\n    output(cmd,1);\n}\n\nconst char* input() {\n    // This doesn't work\n    const char* inpt = \"Hi\";\n    scanf(\"%c\",&amp;inpt);\n    return inpt;\n}\n\nvoid output(const char* s, bool ln) {\n    _puts(s);\n    if (ln==1) {\n        _puts(newline);\n    }\n}\n\nvoid _puts(const char* s) {\n    while(*s != 0) {\n        _putchar(*s);\n        s++;\n    }\n}\n\nvoid _putchar(char c) {\n    __asm {\n        mov ah, 0Eh\n        mov al, [c]\n        mov bh, 0\n        mov bl, 0Fh\n        int 10h\n    }\n}\n</code></pre>\n"}, {"tags": ["android", "c", "java-native-interface", "native", "android-source"], "comments": [{"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1534331909, "post_id": 51856601, "comment_id": 90667477, "body": "Looks like duplicate of <i><a href=\"https://stackoverflow.com/questions/4905743/android-how-to-gain-root-access-in-an-android-application\">ANDROID: How to gain root access in an Android application?</a></i> to me. A <i>method</i> cannot have permissions. Root permissions are granted per process."}, {"owner": {"reputation": 23, "user_id": 8231749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39af96863945855e1a55ff3ce4d12b?s=128&d=identicon&r=PG&f=1", "display_name": "NVDQ", "link": "https://stackoverflow.com/users/8231749/nvdq"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1534343807, "post_id": 51856601, "comment_id": 90673866, "body": "This answer is for executing a shell command in Java with root permission. I want my native code in shared library which called by jni run with root permission, so that it can call kernel function."}, {"owner": {"reputation": 23, "user_id": 8231749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39af96863945855e1a55ff3ce4d12b?s=128&d=identicon&r=PG&f=1", "display_name": "NVDQ", "link": "https://stackoverflow.com/users/8231749/nvdq"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1534343900, "post_id": 51856601, "comment_id": 90673931, "body": "I also asked others question relating to that issue here: <a href=\"https://stackoverflow.com/questions/51844210/different-between-native-c-code-run-in-jni-and-run-in-the-shell-in-android/51851949#51851949\" title=\"different between native c code run in jni and run in the shell in android\">stackoverflow.com/questions/51844210/&hellip;</a>, but now I can&#39;t find how to grant root access for that."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1534348999, "post_id": 51856601, "comment_id": 90676844, "body": "I an afraid the <a href=\"https://stackoverflow.com/a/7102780/192373\">answer</a> is clear: you cannot have <b>root</b> permission in a Java app, even if that&#39;s a system app. For your specific request, you need some mediator process (running as <b>su</b>) which can receive a request from your Java or native code, and call the kernel function for you."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1534362503, "post_id": 51856601, "comment_id": 90683075, "body": "If you want a more authoritative answer, <a href=\"https://groups.google.com/forum/m/#!topic/android-security-discuss/StFrddXeSxI\" rel=\"nofollow noreferrer\">here</a> it is, by no other but Dianne Hackborn."}], "answers": [{"tags": [], "owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "is_accepted": false, "score": 2, "last_activity_date": 1534363630, "creation_date": 1534363630, "answer_id": 51865697, "question_id": 51856601, "link": "https://stackoverflow.com/questions/51856601/android-native-how-does-native-code-written-in-jni-run-with-root-permission/51865697#51865697", "title": "Android native - How does native code written in jni run with root permission?", "body": "<p>You can set your app to run as System,</p>\n\n<pre><code>android:sharedUserId=\"android.uid.system\"\n</code></pre>\n\n<p>This requires some extra steps, but it won't give your JNI code access to kernel module. </p>\n\n<p>For that, you need some mediator process (running as <strong>root</strong>) which can receive a request from your Java or native code, and call the kernel function for you. You can use</p>\n\n<pre><code>Runtime.getRuntime().exec(\"su \u2026\")\n</code></pre>\n\n<p>But it may be easier to start this mediator process as a service from <strong>init.rc</strong>. A specialized library like <a href=\"https://github.com/SpazeDog/rootfw\" rel=\"nofollow noreferrer\">https://github.com/SpazeDog/rootfw</a> may help, too.</p>\n\n<p>You can find more explanations at <a href=\"https://boundarydevices.com/android-security-part-1-application-signatures-permissions/\" rel=\"nofollow noreferrer\">https://boundarydevices.com/android-security-part-1-application-signatures-permissions/</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 8231749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39af96863945855e1a55ff3ce4d12b?s=128&d=identicon&r=PG&f=1", "display_name": "NVDQ", "link": "https://stackoverflow.com/users/8231749/nvdq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1534363630, "creation_date": 1534326950, "last_edit_date": 1534344118, "question_id": 51856601, "link": "https://stackoverflow.com/questions/51856601/android-native-how-does-native-code-written-in-jni-run-with-root-permission", "title": "Android native - How does native code written in jni run with root permission?", "body": "<p>I have an Android application that call a native shared library by jni. This shared library invokes some loadable kernel modules .ko</p>\n\n<p>My app run fail when jni calls the function in shared library that invokes kernel module. But when I write an executable using this shared library, it works fine when call above function.</p>\n\n<p>I found that my app run with user name is \"u0_axx\" and my executable run by command line with root. So maybe it doesn't have permission to invokes kernel module.</p>\n\n<p>My question is how does this native code run with root permission? Or some solution to solve such kind of issue?</p>\n\n<p>Ps: I also tried to use <code>Runtime.getRuntime().exec(\"su\")</code> and added <code>&lt;uses-permission android:name=\"android.permission.ACCESS_SUPERUSER\"/&gt;</code> into manifest but it doesn't help and get an exception that permission denied. My device is rooted and my app is built as system app.</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1534326934, "post_id": 51856544, "comment_id": 90665327, "body": "What output do you expect?"}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1534327472, "post_id": 51856644, "comment_id": 90665626, "body": "@P.P. I don&#39;t know if the lifetime of <code>i</code> in the <code>main</code> function have ended or not. Because <code>pthread_exit</code> doesn&#39;t return, does it mean that the lifetime of all variables in <code>main</code> will have the same lifetime as the process? Or does <code>pthread_exit</code> end the life-time of all variables in the current thread?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1534327711, "post_id": 51856644, "comment_id": 90665739, "body": "&quot;does it mean that the lifetime of all variables in main will have the same lifetime as the process?&quot; - no, their lifetime is over after <code>pthread_exit</code> call. The lifetime of <code>i</code> ends when the main thread exits i.e., when <code>pthread_exit</code> is called (or when the process exits). As soon as the <code>pthread_exit</code> call is made, it should be considered that all its resources are no longer accessible by other threads."}, {"owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 0, "creation_date": 1534327754, "post_id": 51856644, "comment_id": 90665761, "body": "@ Some programmer dude, according to your answer,if the myid pointer keeps value 3 then ,it can&#39;t be  shifted to 1 or 2,means                                            Thread ID: 2, Static: 4, Global: 4 Thread ID: 3, Static: 6, Global: 6 Thread ID: 1, Static: 2, Global: 2 This is never possible."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 1, "creation_date": 1534328147, "post_id": 51856644, "comment_id": 90665945, "body": "@Shivanshu there&#39;s not much difference between <code>s</code> and <code>g</code> in your program. Both are &quot;global&quot; (their lifetime is valid until process exit) and their accesses cause <i>data race</i>.  <code>myid</code> has the same problem (but it&#39;s not &quot;global&quot; - its lifetime is restricted to the main thread) but it also has another problem."}, {"owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1534328291, "post_id": 51856644, "comment_id": 90666007, "body": "where are you pointing by &quot;also has another problem&quot;.Can you please elaborate @P.P."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 0, "creation_date": 1534328454, "post_id": 51856644, "comment_id": 90666085, "body": "@Shivanshu As noted, <code>myid</code> is pointing to <code>i</code> in <code>main</code> and when you call <code>pthread_exit</code>, the lifetime of <code>i</code> ends. So you can&#39;t continue to dereference <code>myid</code> (because what it&#39;s point to is no longer there)."}, {"owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 0, "creation_date": 1534328515, "post_id": 51856644, "comment_id": 90666112, "body": "Thread ID: 2, Static: 4, Global: 4 Thread ID: 1, Static: 2, Global: 2 Thread ID: 3, Static: 6, Global: 6 I am also getting the above result ,so according to your answer,once the thread id sets to 2 ,it can&#39;t go below 2 ,because the pointer is same for all threads,but i am getting the above answer."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 2, "creation_date": 1534328974, "post_id": 51856644, "comment_id": 90666300, "body": "@Shivanshu You have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a> which makes you program unreliable and just simply wrong. There&#39;s no point in arguing about behavior if it&#39;s undefined (since it could be <i>anything</i>, including calling on <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">nasal demons</a>)."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1534327755, "last_edit_date": 1534327755, "creation_date": 1534327142, "answer_id": 51856644, "question_id": 51856544, "link": "https://stackoverflow.com/questions/51856544/scope-of-4th-argument-for-pthread-create-function-in-c-threading/51856644#51856644", "title": "Scope of 4th argument for pthread_create function in C threading", "body": "<p>You pass the <em>very same pointer</em> to all three threads. All threads will dereference the same pointer, getting the same value.</p>\n\n<p><em>And</em> because you call <a href=\"http://man7.org/linux/man-pages/man3/pthread_exit.3.html\" rel=\"nofollow noreferrer\"><code>pthread_exit</code></a>, the data the pointer is pointing to will not be alive anymore. And that means the dereference will lead to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n\n<p><em>Furthermore</em> since you access and modify shared data without synchronization you have data-races leading yet again to <em>undefined behavior</em>.</p>\n\n<p>The first two problems can be easily solved by passing the <em>value</em> of <code>i</code> instead of a pointer to it. This is one of the very few cases where most people think it's okay to pretend that an integer is a pointer. You have to do some casting to make it work though:</p>\n\n<pre><code>pthread_create(&amp;tid, NULL, myThreadFun, (void *) (intptr_t) i);\n</code></pre>\n\n<p>Then you have to do the opposite casting when getting the value:</p>\n\n<pre><code>int myid = (int) (intptr_t) vargp;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1534328367, "last_edit_date": 1534328367, "creation_date": 1534327203, "answer_id": 51856658, "question_id": 51856544, "link": "https://stackoverflow.com/questions/51856544/scope-of-4th-argument-for-pthread-create-function-in-c-threading/51856658#51856658", "title": "Scope of 4th argument for pthread_create function in C threading", "body": "<blockquote>\n  <p>I got the same thread id for 2 threads and it shouldn't be because myid is a local pointer and should print different with each one.</p>\n</blockquote>\n\n<p><code>myid</code> is a local pointer, but it's actually pointing at an address from another thread. <code>myid</code> in all 3 threads you created pointed to the same address of <code>i</code> in main. So when you dereference <code>myid</code>, all threads read from the <em>same</em> location.</p>\n\n<p>There are few issues.</p>\n\n<ol>\n<li><p>Since <code>main</code> calls, <code>pthread_exit</code>, once the main thread exits and you can no longer access <code>i</code> from other threads. This is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour.</a></p></li>\n<li><p>All the threads actually read <code>i</code> (through <code>myid</code>). This is a <a href=\"https://docs.oracle.com/cd/E19205-01/820-0619/geojs/index.html\" rel=\"nofollow noreferrer\"><em>data race</em></a> - more than one thread accessing <code>i</code> without any\nsynchronisation.</p></li>\n</ol>\n\n<p>Note that <em>scope</em> of an object doesn't determine the <em>lifetime</em> of an object. They are related but not the same.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1534374539, "creation_date": 1534374539, "answer_id": 51867615, "question_id": 51856544, "link": "https://stackoverflow.com/questions/51856544/scope-of-4th-argument-for-pthread-create-function-in-c-threading/51867615#51867615", "title": "Scope of 4th argument for pthread_create function in C threading", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>corrects the problems found in the OPs posted code</li>\n<li>checks for (most) error conditions</li>\n<li>uses a proper signature for the <code>main()</code> function</li>\n</ol>\n\n<p>And now the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\n#define NUM_THREADS 3\n\n// Let us create a global variable to change it in threads\nint g = 0;\n\npthread_mutex_t myMutex;\n\n\n// The function to be executed by all threads\nvoid *myThreadFun( void *vargp )\n{\n    // Store the value argument passed to this thread\n    int myid = (int) (intptr_t) vargp;\n\n    // Let us create a static variable to observe its changes\n    static int s = 0;\n\n    pthread_mutex_lock( &amp;myMutex );\n\n    // Change static and global variables\n    ++s; \n    ++g;\n\n    // Print the argument, static and global variables\n    printf(\"Thread ID: %d, Static: %d, Global: %d\\n\", myid, s, g);\n\n    pthread_mutex_unlock( &amp;myMutex );\n\n    pthread_exit( NULL );\n}\n\n\nint main( void )\n{\n    pthread_t tid[ NUM_THREADS ] = {0};\n\n    if (pthread_mutex_init(&amp;myMutex, NULL) != 0)\n    {\n        perror( \"pthread_mutex_init failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, init successful\n\n    // Let us create three threads\n    for ( int i = 0; i &lt; NUM_THREADS; i++)\n    {\n        if(pthread_create(&amp;tid[i], NULL, myThreadFun, (void *) (intptr_t) i) != 0 )\n        {\n            perror( \"pthread_create failed\" );\n            exit( EXIT_FAILURE );\n        }\n    }\n\n    //  collect the threads\n    for( int i=0; i&lt; NUM_THREADS; i++ )\n    {\n        if( pthread_join( tid[i], NULL ) != 0 )\n        {\n            perror( \"pthread_join failed\" );\n        }\n    }\n\n    pthread_mutex_destroy( &amp;myMutex );\n    return 0;\n}\n</code></pre>\n\n<p>A typical run of the program results in the following output:</p>\n\n<pre><code>Thread ID: 0, Static: 1, Global: 1\nThread ID: 2, Static: 2, Global: 2\nThread ID: 1, Static: 3, Global: 3\n</code></pre>\n\n<p>Note: the field claiming to be the thread ID is only the order that the threads were created, not the actual thread id.</p>\n"}], "owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 51856644, "answer_count": 3, "score": 1, "last_activity_date": 1534374539, "creation_date": 1534326727, "last_edit_date": 1534327056, "question_id": 51856544, "link": "https://stackoverflow.com/questions/51856544/scope-of-4th-argument-for-pthread-create-function-in-c-threading", "title": "Scope of 4th argument for pthread_create function in C threading", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\n// Let us create a global variable to change it in threads\nint g = 0;\n\n// The function to be executed by all threads\nvoid *myThreadFun(void *vargp)\n{\n  // Store the value argument passed to this thread\n  int *myid = (int *)vargp;\n\n  // Let us create a static variable to observe its changes\n  static int s = 0;\n\n  // Change static and global variables\n  ++s; ++g;\n\n  // Print the argument, static and global variables\n  printf(\"Thread ID: %d, Static: %d, Global: %d\\n\", *myid, ++s, ++g);\n}\n\nint main()\n{\n    int i;\n    pthread_t tid;\n\n    // Let us create three threads\n    for (i = 0; i &lt; 3; i++)\n        pthread_create(&amp;tid, NULL, myThreadFun, (void *)&amp;i);\n\n    pthread_exit(NULL);\n    return 0;\n}\n</code></pre>\n\n<p>I was just playing with aforementioned example in multithreading in C, and I got the same thread id for 2 threads and it shouldn't be because <code>myid</code> is a local pointer and should print different with each one.</p>\n\n<p>I got the output as following:</p>\n\n<pre><code>Thread ID: 3, Static: 2, Global: 2\nThread ID: 3, Static: 4, Global: 4\nThread ID: 3, Static: 6, Global: 6\n</code></pre>\n\n<p>Can someone please explain me in brief?</p>\n"}, {"tags": ["c", "pointers", "double"], "comments": [{"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 1, "creation_date": 1534326538, "post_id": 51856431, "comment_id": 90665115, "body": "On the first section, you shouldn&#39;t have a double pointer, just a simple pointer"}, {"owner": {"reputation": 21, "user_id": 10207595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f189717cfd4911801684d6818e66c57?s=128&d=identicon&r=PG&f=1", "display_name": "programmergirl", "link": "https://stackoverflow.com/users/10207595/programmergirl"}, "reply_to_user": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 0, "creation_date": 1534326704, "post_id": 51856431, "comment_id": 90665209, "body": "oh yeah the double pointer im very new to that, thank you :) how do i fix the second one"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1534326956, "post_id": 51856431, "comment_id": 90665338, "body": "<code>void (*pointer)(int);</code> should be <code>int (*pointer)(void);</code>"}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534327025, "post_id": 51856431, "comment_id": 90665375, "body": "The second one should be <code>int(*pointer)(void)</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1534327774, "post_id": 51856431, "comment_id": 90665770, "body": "Please take a bit time to follow simple rules when asking questions. If there are errors or warnigns, then show us. Show the exact message and the exact code."}, {"owner": {"reputation": 21, "user_id": 10207595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f189717cfd4911801684d6818e66c57?s=128&d=identicon&r=PG&f=1", "display_name": "programmergirl", "link": "https://stackoverflow.com/users/10207595/programmergirl"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534327932, "post_id": 51856431, "comment_id": 90665858, "body": "sorry @Gerhardh im new to stack overflow :) just getting the hang of it. will do that next time of course :)"}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1534326959, "creation_date": 1534326959, "answer_id": 51856604, "question_id": 51856431, "link": "https://stackoverflow.com/questions/51856431/double-pointers-error-in-c-when-compiling-error-when-using-void-as-well/51856604#51856604", "title": "double pointers error in C when compiling error when using void as well", "body": "<p><code>*</code> is a single pointer and <code>**</code> is a pointer to pointer.\nSo instead of </p>\n\n<pre><code>char** pointer;\n</code></pre>\n\n<p>It should be: </p>\n\n<pre><code>char* pointer;\n</code></pre>\n\n<p>In the second case, the function pointer prototype is not matching the prototype of the function it is pointing to. </p>\n\n<p>So instead of </p>\n\n<pre><code>void (*pointer)(int);\n</code></pre>\n\n<p>it should be:  </p>\n\n<pre><code>int (*pointer)(void);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1534326988, "creation_date": 1534326988, "answer_id": 51856609, "question_id": 51856431, "link": "https://stackoverflow.com/questions/51856431/double-pointers-error-in-c-when-compiling-error-when-using-void-as-well/51856609#51856609", "title": "double pointers error in C when compiling error when using void as well", "body": "<p>you second section have some mistakes</p>\n\n<p>you <code>function1()</code> return <code>int</code> and not take args</p>\n\n<p>but your fucntion ptr return <code>void</code> and take <code>int</code> </p>\n\n<p>so change it to:</p>\n\n<pre><code>int (*pointer)(void);\n\npointer = &amp;function1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "is_accepted": false, "score": 1, "last_activity_date": 1534332709, "creation_date": 1534332709, "answer_id": 51857876, "question_id": 51856431, "link": "https://stackoverflow.com/questions/51856431/double-pointers-error-in-c-when-compiling-error-when-using-void-as-well/51857876#51857876", "title": "double pointers error in C when compiling error when using void as well", "body": "<p>The very first problem is that you are using a double pointer in <code>char** pointer</code> ,as you are not storing the address of some other pointer so you should use <code>char *pointer</code> instead.\nThen your function1 has return type as <code>int</code> but you are returning a <code>float</code> value ,although it won't give you any error but it can create some logical issues in your program,so better to properly write the return type in function definition and its prototype.\nThen the next problem is in the <code>function2</code>,your <code>function1</code> returns <code>int</code> but does not take any arguments but your function pointer return void and take int ,so you should better modify this to</p>\n\n<pre><code>int (*pointer)(void);\n</code></pre>\n\n<p>and then store the address of <code>function1</code> in <code>pointer</code> ,it will work fine.</p>\n"}], "owner": {"reputation": 21, "user_id": 10207595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f189717cfd4911801684d6818e66c57?s=128&d=identicon&r=PG&f=1", "display_name": "programmergirl", "link": "https://stackoverflow.com/users/10207595/programmergirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1534332709, "creation_date": 1534326338, "last_edit_date": 1534327536, "question_id": 51856431, "link": "https://stackoverflow.com/questions/51856431/double-pointers-error-in-c-when-compiling-error-when-using-void-as-well", "title": "double pointers error in C when compiling error when using void as well", "body": "<p>I'm new to C and im currently learning about pointers.</p>\n\n<p>I'm  not sure why I am getting an error with the following sections of code in regards to pointers :</p>\n\n<pre><code>char ch;     \nchar** pointer;    \npointer = &amp;ch;\n</code></pre>\n\n<p>and </p>\n\n<pre><code>int function1(void) \n{\n  return 42.0;\n}\n\nvoid function2(void) \n{\n  void (*pointer)(int);\n  pointer = &amp;function1;\n  ...\n}\n</code></pre>\n\n<p>Any help will be appreciated :)</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 9606, "user_id": 5012099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a24d87840141459cef20b2877bcd9bc?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingTeller", "link": "https://stackoverflow.com/users/5012099/flyingteller"}, "edited": false, "score": 0, "creation_date": 1534325313, "post_id": 51856138, "comment_id": 90664521, "body": "Do you want to call single functions from your c file or do you want to call a compiled program?"}, {"owner": {"reputation": 198, "user_id": 7340663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEh9p.png?s=128&g=1", "display_name": "Neamus", "link": "https://stackoverflow.com/users/7340663/neamus"}, "edited": false, "score": 0, "creation_date": 1534325390, "post_id": 51856138, "comment_id": 90664560, "body": "single functions. I would like every button to be unique."}, {"owner": {"reputation": 4837, "user_id": 9769953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14a586643a20c8d68010f7a329f5a04?s=128&d=identicon&r=PG", "display_name": "0 0", "link": "https://stackoverflow.com/users/9769953/0-0"}, "edited": false, "score": 0, "creation_date": 1534325488, "post_id": 51856138, "comment_id": 90664591, "body": "&quot;every time a button is clicked on my GUI, the C program will be executed&quot;: that sounds like you want to run the program as a separate executable (possibly passing additional input and capturing the output). Certainly if the GUI is just a layer on top of/wrapper around the C program. Perhaps the <a href=\"https://docs.python.org/3/library/subprocess.html\" rel=\"nofollow noreferrer\"><code>subprocess</code></a> module can help."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1534325507, "post_id": 51856138, "comment_id": 90664602, "body": "In addition to the question linked in the previous comment (which is about calling C functions from Python), check out <a href=\"https://stackoverflow.com/q/89228/1782792\">Calling an external command in Python</a>. You may be able to compile our C code normally into a program and call that program from Python. What you definitely cannot do is executing uncompiled C code from Python (see <a href=\"https://stackoverflow.com/q/9420673\">Is it possible to compile c code using python?</a> on that topic)."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 5007792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QssX8.jpg?s=128&g=1", "display_name": "Umair Khalid", "link": "https://stackoverflow.com/users/5007792/umair-khalid"}, "is_accepted": true, "score": 4, "last_activity_date": 1534325578, "creation_date": 1534325578, "answer_id": 51856257, "question_id": 51856138, "link": "https://stackoverflow.com/questions/51856138/how-to-import-a-c-file-into-python/51856257#51856257", "title": "How to import a C file into python", "body": "<p>To use c file according to docs you need to first compile C code and then use the compiled file in your code</p>\n\n<p>here is the link.\nVisit <a href=\"http://book.pythontips.com/en/latest/python_c_extension.html\" rel=\"nofollow noreferrer\">http://book.pythontips.com/en/latest/python_c_extension.html</a></p>\n"}], "owner": {"reputation": 198, "user_id": 7340663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEh9p.png?s=128&g=1", "display_name": "Neamus", "link": "https://stackoverflow.com/users/7340663/neamus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6176, "favorite_count": 0, "closed_date": 1534325716, "accepted_answer_id": 51856257, "answer_count": 1, "score": 0, "last_activity_date": 1534325585, "creation_date": 1534325159, "last_edit_date": 1534325585, "question_id": 51856138, "link": "https://stackoverflow.com/questions/51856138/how-to-import-a-c-file-into-python", "closed_reason": "Duplicate", "title": "How to import a C file into python", "body": "<p>I made a GUI in Python and i just wanted to know how can i import a C file into python so every time a button is clicked on my GUI, different methods in the C program will be executed. I tried the 'Python' method of importing:</p>\n\n<pre><code>sys.path.insert(0, '/home/pi/Desktop/FTPclass.py')\nimport FTPclass\n</code></pre>\n\n<p>That worked for the python file i imported, but when I do the same for my c file, it complains saying my \"testinc\" module doesn't exist.</p>\n\n<p>Thanks for everyone help in advance.\n~Neamus</p>\n"}, {"tags": ["c", "loops", "for-loop"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1534325267, "post_id": 51856108, "comment_id": 90664501, "body": "The chapter about loops in your C programming book should answer how for loops work. If you know how a sane for loop like <code>for(int i=0; i&lt;n; i++) printf(&quot;%d &quot;, array[i]);</code> works, then you can figure out how an insane one like in your example works from there."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534327625, "post_id": 51856108, "comment_id": 90665693, "body": "Please only ask one question per post. &quot;How does a <code>for</code> loop work&quot; and &quot;How does this assignment work&quot; are rather independent."}, {"owner": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534330772, "post_id": 51856108, "comment_id": 90667002, "body": "@Lundin, Sorry for the thing. I wanted to ask how those 2 statements were being evaluated.  i was not intended to ask for loop woking."}], "answers": [{"tags": [], "owner": {"reputation": 199, "user_id": 8572843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jf3W8.png?s=128&g=1", "display_name": "gotocoffee", "link": "https://stackoverflow.com/users/8572843/gotocoffee"}, "is_accepted": false, "score": 0, "last_activity_date": 1534325436, "creation_date": 1534325436, "answer_id": 51856209, "question_id": 51856108, "link": "https://stackoverflow.com/questions/51856108/how-for-loop-is-getting-evaluated-when-printf-is-used-inside-the-loop-in-c/51856209#51856209", "title": "how for loop is getting evaluated when printf is used inside the loop in C?", "body": "<p>The loop gets called until <code>y == 0</code>. Then <code>x</code> gets incremented but <code>x++</code> returns the old value of <code>x</code>. After that the comparison runs and assigns its value to <code>y</code> (1 or 0). The <code>printf</code> function is exexuted after the assignment.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "edited": false, "score": 0, "creation_date": 1534330625, "post_id": 51856361, "comment_id": 90666940, "body": "@Moith,  Thank you very much. I got your point."}, {"owner": {"reputation": 14, "user_id": 10228543, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qFIyzGG541M/AAAAAAAAAAI/AAAAAAAAAs8/ItK46fP3vR8/photo.jpg?sz=128", "display_name": "Mohit Kumar Raj Badi", "link": "https://stackoverflow.com/users/10228543/mohit-kumar-raj-badi"}, "reply_to_user": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "edited": false, "score": 0, "creation_date": 1547662234, "post_id": 51856361, "comment_id": 95271722, "body": "Your welcome buddy!!"}], "tags": [], "owner": {"reputation": 14, "user_id": 10228543, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qFIyzGG541M/AAAAAAAAAAI/AAAAAAAAAs8/ItK46fP3vR8/photo.jpg?sz=128", "display_name": "Mohit Kumar Raj Badi", "link": "https://stackoverflow.com/users/10228543/mohit-kumar-raj-badi"}, "is_accepted": true, "score": -1, "last_activity_date": 1534327119, "last_edit_date": 1534327119, "creation_date": 1534326008, "answer_id": 51856361, "question_id": 51856108, "link": "https://stackoverflow.com/questions/51856108/how-for-loop-is-getting-evaluated-when-printf-is-used-inside-the-loop-in-c/51856361#51856361", "title": "how for loop is getting evaluated when printf is used inside the loop in C?", "body": "<p>Before going to the actual problem you should know how the for loop works in steps:\nFor loop has 4 steps that is :</p>\n\n<p>For example:</p>\n\n<p>for(i=0;i&lt;10;i++){</p>\n\n<p>statement;</p>\n\n<p>}</p>\n\n<p>Step 1: first it will initialize i as 0;\nStep 2: It will check the condition is satisfying or not;\nStep 3: The it will go to the statement block and then it will perform the statement\nstep 4: It will increment the value .</p>\n\n<p>But Here in your Question:</p>\n\n<pre><code> #include&lt;stdio.h&gt;  \n    int main(){  \n    int x=1,y=1;  \n    for(;y;printf(\"%d %d\\n\",x,y))\n    y=x++&lt;=5;\n    }\n</code></pre>\n\n<p>Step 1 : It enter into the loop(i.e. 1 because it is blank)</p>\n\n<p>Step 2 : Check the condition block which is one(i.e the y value is one)</p>\n\n<p>Step 3 : Here first the post increment Logic is implemented.</p>\n\n<p>First the x value is initialized that is one and the incremented.\nThe the condition x++&lt;=5 is checked.</p>\n\n<p>If x++&lt;=5 it will initialize y to the value of 1 because the condition satisfy\nelse it will  initialize y to the value of 0 because the condition not satisfy.</p>\n\n<p>****In First step of loop \nit will check 1 &lt;= 5 true\nso y = 1 and so on till the condition satisfy otherwise y = 0****</p>\n\n<p>Step 4:It will print the value of x and y</p>\n\n<p>Next : Again the pointer will go to condition block and then goes to second because y = 1\nwhen y = 0  the loop will stop;\n**It will not go to the initialization step from the second loop.... </p>\n\n<h2>As you can notice in the output.</h2>\n"}, {"tags": [], "owner": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "is_accepted": false, "score": 0, "last_activity_date": 1534330342, "last_edit_date": 1534330342, "creation_date": 1534326074, "answer_id": 51856370, "question_id": 51856108, "link": "https://stackoverflow.com/questions/51856108/how-for-loop-is-getting-evaluated-when-printf-is-used-inside-the-loop-in-c/51856370#51856370", "title": "how for loop is getting evaluated when printf is used inside the loop in C?", "body": "<p>I suppose this is some kind of puzzle, because nobody of decent sanity should write a loop like that.</p>\n\n<p>Anyway, a statement block containing a for loop consists of 6 statement blocks (labelled <code>a</code> to <code>f</code>):</p>\n\n<pre><code>a\nfor (b ; c ; d) {\n  e\n}\nf\n</code></pre>\n\n<p>The code is executed in the same order as if it was this <code>while</code> loop:</p>\n\n<pre><code>a\nb\nwhile (c) {\n  e\n  d\n}\nf\n</code></pre>\n\n<p>So basically your code is:</p>\n\n<pre><code>int x=1, y=1;\nwhile (y) {\n  y=x++&lt;=5;\n  printf(\"%d %d\\n\",x,y);\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6882692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a49bbb5657e54a25273ba7685e649?s=128&d=identicon&r=PG&f=1", "display_name": "yashu", "link": "https://stackoverflow.com/users/6882692/yashu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1534345659, "accepted_answer_id": 51856361, "answer_count": 3, "score": -3, "last_activity_date": 1534330342, "creation_date": 1534325022, "last_edit_date": 1534327334, "question_id": 51856108, "link": "https://stackoverflow.com/questions/51856108/how-for-loop-is-getting-evaluated-when-printf-is-used-inside-the-loop-in-c", "closed_reason": "Not suitable for this site", "title": "how for loop is getting evaluated when printf is used inside the loop in C?", "body": "<pre><code>#include&lt;stdio.h&gt;  \nint main()\n{  \n  int x=1,y=1;  \n  for( ; y; printf(\"%d %d\\n\",x,y))\n    y=x++&lt;=5;\n}\n</code></pre>\n\n<p>Is the expression <code>y=x++&lt;=5</code> is executed before the <code>for</code> loop? Is that <code>x</code> \ncompared first and assign a value to <code>y</code> and then <code>x</code> is being incremented? The above snippet is giving below output.</p>\n\n<pre><code>2 1\n3 1\n4 1\n5 1\n6 1\n7 0\n</code></pre>\n\n<p>Can anyone tell how the for loop is being evaluated?</p>\n"}, {"tags": ["c", "embedded", "stm32", "uart"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534325117, "post_id": 51856034, "comment_id": 90664431, "body": "Possibly baudrate inaccuracy. If you are deriving your system clock from a built-in RC oscillator, it might not be accurate enough for RS-232. Also, perhaps needless to say, ensure there is a signal ground."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534325191, "post_id": 51856034, "comment_id": 90664472, "body": "@Lundin STM ones are accurate enough. It is known problem with the AVR uCs. I would suspect wrong clock initialization."}, {"owner": {"reputation": 7, "user_id": 8963255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5kbOj.jpg?s=128&g=1", "display_name": "velizarw", "link": "https://stackoverflow.com/users/8963255/velizarw"}, "edited": false, "score": 0, "creation_date": 1534325391, "post_id": 51856034, "comment_id": 90664562, "body": "Signal ground is ok. Oscilloscope shows 110us per bit which is ok imo."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534325501, "post_id": 51856034, "comment_id": 90664599, "body": "@velizarw 110us means baudrate 9090 bps. That is not ok at all and will not work. You need 104us for baudrate 9600."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534325584, "post_id": 51856034, "comment_id": 90664642, "body": "@P__J__ Still it is good design practice to always use external crystal/resonator whenever the application contains a serial bus."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1534326161, "post_id": 51856034, "comment_id": 90664924, "body": "To ma it sounds like baudrate mismatch due to clock problems."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 8963255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5kbOj.jpg?s=128&g=1", "display_name": "velizarw", "link": "https://stackoverflow.com/users/8963255/velizarw"}, "is_accepted": false, "score": 0, "last_activity_date": 1534335518, "creation_date": 1534335518, "answer_id": 51858571, "question_id": 51856034, "link": "https://stackoverflow.com/questions/51856034/hal-uart-transmit-sends-wrong-data/51858571#51858571", "title": "HAL_UART_Transmit sends wrong data", "body": "<p>Looks like it was a clock issue after all. I was using internal 16 MHz oscillator (HSI) multiplied up to 32 MHz with PLL. Single baud width on 9600 baudrate was 110us. Now I switched to 4 MHz (internal MSI) and I am getting 104us per baud. Communication is flawless now.</p>\n\n<pre><code>RCC_ClkInitTypeDef RCC_ClkInitStruct ={0};\nRCC_OscInitTypeDef RCC_OscInitStruct = {0};\nRCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_MSI;\nRCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;\nRCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;\nRCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;\nif (HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_0)!= HAL_OK)\n{\n  while(1);\n}\n\n__HAL_RCC_PWR_CLK_ENABLE();\n__HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE3);\n__HAL_RCC_PWR_CLK_DISABLE();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1590870566, "post_id": 62108086, "comment_id": 109847235, "body": "No, <code>UartHandle.Init.Parity = UART_PARITY_NONE;</code> it means - no parity Even if he set the parity bit the HAL recalculates the &quot;register level&quot; word length accordingly.  Answer is wrong"}], "tags": [], "owner": {"reputation": 1, "user_id": 13649683, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3f4ab2d1e3f191e5e6922860d1d7b17a?s=128&d=identicon&r=PG", "display_name": "Jorge", "link": "https://stackoverflow.com/users/13649683/jorge"}, "is_accepted": false, "score": -1, "last_activity_date": 1590879585, "last_edit_date": 1590879585, "creation_date": 1590869329, "answer_id": 62108086, "question_id": 51856034, "link": "https://stackoverflow.com/questions/51856034/hal-uart-transmit-sends-wrong-data/62108086#62108086", "title": "HAL_UART_Transmit sends wrong data", "body": "<p>Acording your sent source file, you programmed the usart as \"8 bits\", but this STM HAL routine compute data_bits+parity_bit=8bits(your selection). For standard text transmission, for this STM HAL should be: 9 bits (8_data_bits+one_parity_bit). </p>\n"}], "owner": {"reputation": 7, "user_id": 8963255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5kbOj.jpg?s=128&g=1", "display_name": "velizarw", "link": "https://stackoverflow.com/users/8963255/velizarw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1688, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1590879585, "creation_date": 1534324727, "last_edit_date": 1534325005, "question_id": 51856034, "link": "https://stackoverflow.com/questions/51856034/hal-uart-transmit-sends-wrong-data", "title": "HAL_UART_Transmit sends wrong data", "body": "<p>When ch = 0x80, on PC I receive 0x00,<br>\nWhen ch = 0x40, on PC I receive 0x80,<br>\nWhen ch = 0x20, on PC I receive 0x60,<br>\nWhen ch = 0x10, on PC I receive 0x10,<br>\nWhen ch = 0x08, on PC I receive 0x08,<br>\nWhen ch = 0x04, on PC I receive 0x04,<br>\nWhen ch = 0x02, on PC I receive 0x02,<br>\nWhen ch = 0x01, on PC I receive 0x01,  </p>\n\n<p>Can't figure what is going on here... I am attaching USART Initialization, Transmit Function and Main. I should be software issue, already tested the hardware and it's ok. MCU = STM32L011 <br/></p>\n\n<pre><code>void InitUSART(void)\n{\n    GPIO_InitTypeDef GPIO_InitStruct;\n\n    USARTx_CLK_ENABLE();\n\n    UartHandle.Instance = USARTx;\n    UartHandle.Init.BaudRate = 9600;\n    UartHandle.Init.WordLength = UART_WORDLENGTH_8B;\n    UartHandle.Init.StopBits = UART_STOPBITS_1;\n    UartHandle.Init.Parity = UART_PARITY_NONE;\n    UartHandle.Init.HwFlowCtl = UART_HWCONTROL_NONE;\n    UartHandle.Init.Mode = UART_MODE_TX_RX;\n    //UartHandle.Init.OneBitSampling = UART_ONE_BIT_SAMPLE_ENABLE;\n    HAL_UART_Init(&amp;UartHandle);\n\n    /* Transmit Configuration */\n    USARTx_TX_GPIO_CLK_ENABLE();\n    GPIO_InitStruct.Pin = USARTx_TX_PIN;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n    GPIO_InitStruct.Alternate = USARTx_TX_AF;\n    HAL_GPIO_Init(USARTx_TX_GPIO_PORT, &amp;GPIO_InitStruct);\n\n    /* Receive Configuration */\n    USARTx_RX_GPIO_CLK_ENABLE();\n    GPIO_InitStruct.Pin = USARTx_RX_PIN;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n    GPIO_InitStruct.Alternate = USARTx_TX_AF;\n    HAL_GPIO_Init(USARTx_RX_GPIO_PORT, &amp;GPIO_InitStruct);\n\n    HAL_NVIC_SetPriority(USARTx_IRQn, 0, 1);\n    HAL_NVIC_EnableIRQ(USARTx_IRQn);\n}\n\nHAL_StatusTypeDef HAL_UART_Transmit(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size, uint32_t Timeout)\n{\n  uint16_t* tmp;\n  uint32_t tickstart = 0;\n\n  /* Check that a Tx process is not already ongoing */\n  if(huart-&gt;gState == HAL_UART_STATE_READY)\n  {\n    if((pData == NULL ) || (Size == 0U))\n    {\n      return  HAL_ERROR;\n    }\n\n    /* In case of 9bits/No Parity transfer, pData buffer provided as input paramter \n       should be aligned on a u16 frontier, as data to be filled into TDR will be \n       handled through a u16 cast. */\n    if ((huart-&gt;Init.WordLength == UART_WORDLENGTH_9B) &amp;&amp; (huart-&gt;Init.Parity == UART_PARITY_NONE))\n    {\n      if((((uint32_t)pData)&amp;1) != 0)\n      {\n        return  HAL_ERROR;\n      }\n    }\n\n    /* Process Locked */\n    __HAL_LOCK(huart);\n\n    huart-&gt;ErrorCode = HAL_UART_ERROR_NONE;\n    huart-&gt;gState = HAL_UART_STATE_BUSY_TX;\n\n    /* Init tickstart for timeout managment*/\n    tickstart = HAL_GetTick();\n\n    huart-&gt;TxXferSize = Size;\n    huart-&gt;TxXferCount = Size;\n    while(huart-&gt;TxXferCount &gt; 0U)\n    {\n      huart-&gt;TxXferCount--;\n      if(UART_WaitOnFlagUntilTimeout(huart, UART_FLAG_TXE, RESET, tickstart, Timeout) != HAL_OK)\n      {\n        return HAL_TIMEOUT;\n      }\n      if ((huart-&gt;Init.WordLength == UART_WORDLENGTH_9B) &amp;&amp; (huart-&gt;Init.Parity == UART_PARITY_NONE))\n      {\n        tmp = (uint16_t*) pData;\n        huart-&gt;Instance-&gt;TDR = (*tmp &amp; (uint16_t)0x01FFU);\n        pData += 2U;\n      }\n      else\n      {\n        huart-&gt;Instance-&gt;TDR = (*pData++ &amp; (uint8_t)0xFFU);\n      }\n    }\n    if(UART_WaitOnFlagUntilTimeout(huart, UART_FLAG_TC, RESET, tickstart, Timeout) != HAL_OK)\n    {\n      return HAL_TIMEOUT;\n    }\n\n    /* At end of Tx process, restore huart-&gt;gState to Ready */\n    huart-&gt;gState = HAL_UART_STATE_READY;\n\n    /* Process Unlocked */\n    __HAL_UNLOCK(huart);\n\n    return HAL_OK;\n  }\n  else\n  {\n    return HAL_BUSY;\n  }\n}\n\nint main(void)\n{\n  /* STM32L0xx HAL library initialization:\n       - Configure the Flash prefetch, Flash preread and Buffer caches\n       - Systick timer is configured by default as source of time base, but user\n             can eventually implement his proper time base source (a general purpose\n             timer for example or other time source), keeping in mind that Time base\n             duration should be kept 1ms since PPP_TIMEOUT_VALUEs are defined and\n             handled in milliseconds basis.\n       - Low Level Initialization\n     */\n    HAL_Init();\n\n    /* Configure the system clock to 32 MHz */\n    SystemClock_Config();\n\n    InitUSART();\n    //Transmit(txBuffer, 2);\n\n    extern UART_HandleTypeDef UartHandle;\n    uint16_t ch = 0x80;\n    TransmitEnable();\n    while(1){\n        HAL_UART_Transmit(&amp;UartHandle, &amp;ch, 1, 0xFF);\n        HAL_Delay(5);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "binary-tree", "breadth-first-search"], "comments": [{"owner": {"reputation": 335, "user_id": 4357841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMoQ7.jpg?s=128&g=1", "display_name": "Bilal Siddiqui", "link": "https://stackoverflow.com/users/4357841/bilal-siddiqui"}, "edited": false, "score": 0, "creation_date": 1534346041, "post_id": 51855924, "comment_id": 90675200, "body": "I do not understand the purpose/meaning of the last sentence. Why an array and why an arbitrary limit? You simply need to do a traversal and do some additional calculations if the node if the &quot;first&quot; one in the level, right? Also, what does &quot;first&quot; mean here?"}, {"owner": {"reputation": 19, "user_id": 7710077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca15079f4664d7f0a27760f3d1e32f3?s=128&d=identicon&r=PG", "display_name": "Abilbel", "link": "https://stackoverflow.com/users/7710077/abilbel"}, "reply_to_user": {"reputation": 335, "user_id": 4357841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMoQ7.jpg?s=128&g=1", "display_name": "Bilal Siddiqui", "link": "https://stackoverflow.com/users/4357841/bilal-siddiqui"}, "edited": false, "score": 0, "creation_date": 1534350968, "post_id": 51855924, "comment_id": 90677857, "body": "First means the one which is the most on the left. The limit is imposed by the assignement (as other limits such as 25 lines per function and 5 functions per file)"}], "owner": {"reputation": 19, "user_id": 7710077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca15079f4664d7f0a27760f3d1e32f3?s=128&d=identicon&r=PG", "display_name": "Abilbel", "link": "https://stackoverflow.com/users/7710077/abilbel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534355511, "creation_date": 1534324202, "last_edit_date": 1534355511, "question_id": 51855924, "link": "https://stackoverflow.com/questions/51855924/apply-level-by-level-function-in-binary-tree-with-parameter-for-first-element-of", "title": "Apply level by level function in binary tree with parameter for first element of the level", "body": "<p>How do I call a function on every node in a binary tree when using breadth-first tree traversal? Furthermore, the function needs a parameter that tells it if the current node is the <em>first</em> node of the current level.</p>\n\n<p>I've tested my code and it doesn't seem to do it right, one node out of two is considered as the first one on every level. Here is the code:</p>\n\n<pre><code>int btree_level_count(t_btree *root)\n{\n  int lvl_left;\n  int lvl_right;\n\n  if (!root)\n    return (0);\n  lvl_left = btree_level_count(root-&gt;left);\n  lvl_right = btree_level_count(root-&gt;right);\n  return (1 + lvl_left &gt; lvl_right ? lvl_left : lvl_right);\n}\n\nvoid    btree_applyf(t_btree *root, int lvl[2], int f_elt, void (*applyf)(void *item, int lvl, int is_first_elem))\n{\n  if (!root)\n    return ;\n  if (lvl[0] == lvl[1])\n    applyf(root-&gt;item, lvl[0], f_elt);\n  else\n  {\n    lvl[1]++;\n    btree_applyf(root-&gt;left, lvl, 1, applyf);\n    btree_applyf(root-&gt;right, lvl, 0, applyf);\n  }\n}\n\nvoid    btree_apply_by_level(t_btree *root, void (*applyf)(void *item, int current_level, int is_first_elem))\n{\n  int height;\n  int lvl[2];\n\n  if (!root)\n    return ;\n  height = btree_level_count(root);\n  lvl[0] = 0;\n  lvl[1] = 0;\n  while (lvl[0] &lt; height)\n  {\n    btree_applyf(root, lvl, 1, applyf);\n    lvl[0]++;\n  }\n}\n</code></pre>\n\n<p>I use an arbitrary limit on the number of parameters per function hence the array to represent both the level and the current level.</p>\n"}, {"tags": ["c", "visual-studio", "malloc", "heap-memory"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1534323696, "post_id": 51855691, "comment_id": 90663825, "body": "avoid using global variables (i.e <code>machine_code</code>)"}, {"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1534323795, "post_id": 51855691, "comment_id": 90663867, "body": "Will do, but just to learn from this - why not to use a global variable?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1534324065, "post_id": 51855691, "comment_id": 90663965, "body": "see here: <a href=\"https://stackoverflow.com/questions/484635/are-global-variables-bad\" title=\"are global variables bad\">stackoverflow.com/questions/484635/are-global-variables-bad</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534324427, "post_id": 51855691, "comment_id": 90664123, "body": "Plainly, global variables are bad because private encapsulation is good. Study <i>private encapsulation</i>."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1534324916, "post_id": 51855691, "comment_id": 90664314, "body": "Problem not reproduced. But anyway, you are leaking a lot of memory with each <code>malloc</code> inside your function. You don&#39;t have to keep the pointer to <code>word</code> inside your machine."}, {"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534325184, "post_id": 51855691, "comment_id": 90664469, "body": "@Lundin I would read about this, thank you And @pmg - I tried passing <code>machine_code</code> as an parameter, and changing <code>machine_code</code> to a local variable of &quot;main&quot; - and now it won&#39;t even run once, it crashes with the same error when it&#39;s trying to create <code>machine_code</code> for the first time"}, {"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1534325496, "post_id": 51855691, "comment_id": 90664596, "body": "@Ptaq666 I have to keep it as a pointer since in other parts of the code I need to use its pointer"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534339237, "post_id": 51855691, "comment_id": 90671170, "body": "I doubt that the problem is in this code. You probably cause some trouble between those two function calls. It might be important to see how you provide <code>wrd</code> and <code>sign_name</code> to the function."}, {"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "edited": false, "score": 0, "creation_date": 1534339451, "post_id": 51855691, "comment_id": 90671293, "body": "wrd is created by a couple of different ways: - by value, or creating taking another structure with 14 bits (such as: <code>typedef struct { unsigned int ERA : 2; unsigned int destination_ooperand : 2; unsigned int source_operand : 2; unsigned int opcode : 4; unsigned int param2 : 2; unsigned int param1 : 2; }start_word;</code>) and then using memcpy for 14 bits to copy them."}, {"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "edited": false, "score": 0, "creation_date": 1534339487, "post_id": 51855691, "comment_id": 90671318, "body": "<code>sign_name</code> is created mostly NULL - there is only one or two times out of 20 that it&#39;s not NULL."}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 0, "last_activity_date": 1534324252, "creation_date": 1534324252, "answer_id": 51855940, "question_id": 51855691, "link": "https://stackoverflow.com/questions/51855691/a-heap-has-been-corrupted-after-using-malloc-twice/51855940#51855940", "title": "&quot;A heap has been corrupted&quot; after using malloc twice", "body": "<p>Here</p>\n\n<pre><code>        while (temp-&gt;next_line != NULL)\n        {\n            temp = temp-&gt;next_line;\n            temp-&gt;next_line = next; // move out of the loop\n        }\n</code></pre>\n\n<p>you may want to move the last assignment outside of the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "edited": false, "score": 0, "creation_date": 1534329492, "post_id": 51856574, "comment_id": 90666495, "body": "I accidentally placed <code>temp-&gt;next_line = next</code> inside of the loop, now when it&#39;s out again it&#39;s still not working, and I recive the same problem."}, {"owner": {"reputation": 1033, "user_id": 5778803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b5CcU.jpg?s=128&g=1", "display_name": "Eliyahu Machluf", "link": "https://stackoverflow.com/users/5778803/eliyahu-machluf"}, "reply_to_user": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "edited": false, "score": 0, "creation_date": 1534330258, "post_id": 51856574, "comment_id": 90666784, "body": "Can you add the calling code, so we get an entire program, we can examine."}, {"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "edited": false, "score": 0, "creation_date": 1534338099, "post_id": 51856574, "comment_id": 90670520, "body": "The entire program is over 900 lines, I can upload it to github if you like, but I don&#39;t think it has anything to do with the function&#39;s behavior"}, {"owner": {"reputation": 1033, "user_id": 5778803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b5CcU.jpg?s=128&g=1", "display_name": "Eliyahu Machluf", "link": "https://stackoverflow.com/users/5778803/eliyahu-machluf"}, "reply_to_user": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "edited": false, "score": 0, "creation_date": 1534339127, "post_id": 51856574, "comment_id": 90671109, "body": "I think the problem of heap corruption is not at code you&#39;ve posted here, but at other code of your program. I suggest you try to isolate the problem, by writing as small as possible program which cause the problem you&#39;v encountered. BTW, there are tools for heap corruption detection. see <a href=\"https://stackoverflow.com/questions/2470131/visual-studio-how-to-find-source-of-heap-corruption-errors\" title=\"visual studio how to find source of heap corruption errors\">stackoverflow.com/questions/2470131/&hellip;</a>"}, {"owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "edited": false, "score": 0, "creation_date": 1534339672, "post_id": 51856574, "comment_id": 90671427, "body": "Allright, when I think about it more and more, the problem could be caused from an eternal source, such as its input, is copying a 14 bits struct to a <code>word</code> type is a good idea, and could it be what caused it? I&#39;m going to try to debug it right now"}], "tags": [], "owner": {"reputation": 1033, "user_id": 5778803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b5CcU.jpg?s=128&g=1", "display_name": "Eliyahu Machluf", "link": "https://stackoverflow.com/users/5778803/eliyahu-machluf"}, "is_accepted": true, "score": 0, "last_activity_date": 1534326852, "creation_date": 1534326852, "answer_id": 51856574, "question_id": 51855691, "link": "https://stackoverflow.com/questions/51855691/a-heap-has-been-corrupted-after-using-malloc-twice/51856574#51856574", "title": "&quot;A heap has been corrupted&quot; after using malloc twice", "body": "<p>As far as I understand the code, it does not create a linked list. it creates nodes, but does not link them together.</p>\n\n<p>at first call, the machine_code (head of list) is created.\nat next call, the node 'next' is created, however, the loop:</p>\n\n<pre><code>while (temp-&gt;next_line != NULL)\n    {\n        temp = temp-&gt;next_line;\n        temp-&gt;next_line = next;\n    }\n</code></pre>\n\n<p>does nothing as the 'machine_code->next' value is null. so code inside the loop is not executed. and we do not get here a <strong>linked</strong> list, but sporadic nodes not connected each to other.\nyou may wanted (as pointed at the other post here) to have something like:</p>\n\n<pre><code>while (temp-&gt;next_line != NULL)\n    {\n        temp = temp-&gt;next_line;\n    }\ntemp-&gt;next_line = next;\n</code></pre>\n"}], "owner": {"reputation": 156, "user_id": 10228316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef01d3f6da54e0a25fb0189972155ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ido H Levi", "link": "https://stackoverflow.com/users/10228316/ido-h-levi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 51856574, "answer_count": 2, "score": 0, "last_activity_date": 1534326852, "creation_date": 1534323180, "question_id": 51855691, "link": "https://stackoverflow.com/questions/51855691/a-heap-has-been-corrupted-after-using-malloc-twice", "title": "&quot;A heap has been corrupted&quot; after using malloc twice", "body": "<p>I have a linked list of \"words\" that I'm trying to build, I made a function called \"add_to_mem\" which adds to the linked list the next word.\nI've made a couple of checks on the code, and found out that he works twice - once when the linked list is a NULL, and once when it's not - and it is does working, but in the third time I'm calling to the method - I'm getting an \"A heap has been corrupted\" error.\nThe code:</p>\n\n<pre><code>    typedef struct { unsigned int val : 14; } word;\n\n    typedef struct machine_m\n\n    {\n\n    word * current;\n    int line_in_memo;\n    char * sign_name;\n\n    struct machine_m * next_line;\n}Machine_Memo;\n</code></pre>\n\n<p>The function:</p>\n\n<pre><code>    /*Adding a word to the memory.*/\nvoid add_to_mem(word * wrd, int line, char * sign_name)\n{\n    Machine_Memo * temp = NULL, *next = NULL;\n    if (machine_code == NULL)\n    {\n\n        machine_code = (Machine_Memo *)malloc(sizeof(Machine_Memo));\n        if (machine_code == NULL)\n        {\n            printf(\"Memory allocation has failed.\");\n            exit(1);\n        }\n        machine_code-&gt;current = wrd;\n        machine_code-&gt;line_in_memo = line;\n        machine_code-&gt;sign_name = sign_name;\n        machine_code-&gt;next_line = NULL;\n\n    }\n    else\n    {\n        printf(\"token has been reached\");\n        temp = machine_code;\n        next = (Machine_Memo *)malloc(sizeof(Machine_Memo)); //Line of error\n        if (next == NULL)\n        {\n            printf(\"MEMORY ALLOCATION HAS FAILED. EXITING PROGRAM.\\nThe problem has occured on code line %d\", 775);\n            exit(0);\n        }\n        next-&gt;current = wrd;\n        next-&gt;line_in_memo = line;\n        next-&gt;sign_name = sign_name;\n        next-&gt;next_line = NULL;\n\n        while (temp-&gt;next_line != NULL)\n        {\n            temp = temp-&gt;next_line;\n            temp-&gt;next_line = next;\n\n        }\n\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "select", "server", "threadpool"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534321270, "post_id": 51855096, "comment_id": 90662822, "body": "@Lundin it&#39;s usually a struct."}, {"owner": {"reputation": 409, "user_id": 10181236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5bQoI5Vh3P0/AAAAAAAAAAI/AAAAAAAAB_c/z8TUCALIFNk/photo.jpg?sz=128", "display_name": "JayJona", "link": "https://stackoverflow.com/users/10181236/jayjona"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1534321565, "post_id": 51855096, "comment_id": 90662927, "body": "this is the select <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/select.2.html</a> I have not declared any fd_set struct but used the already predefined one"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534321941, "post_id": 51855096, "comment_id": 90663066, "body": "You&#39;d have to declare <code>set</code> somewhere though. Anyway, I&#39;m pretty sure the reason is as described in the posted answer."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534323740, "post_id": 51855096, "comment_id": 90663843, "body": "show the type declarations."}, {"owner": {"reputation": 409, "user_id": 10181236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5bQoI5Vh3P0/AAAAAAAAAAI/AAAAAAAAB_c/z8TUCALIFNk/photo.jpg?sz=128", "display_name": "JayJona", "link": "https://stackoverflow.com/users/10181236/jayjona"}, "edited": false, "score": 0, "creation_date": 1534327038, "post_id": 51855096, "comment_id": 90665382, "body": "simply <code>fd_set set, rdset;</code> declared as a global variable"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534346194, "post_id": 51855096, "comment_id": 90675284, "body": "@james No, that&#39;s a bad idea. Especially if this structure is part of a larger array that should be parallelized by a thread pool. Passing it as parameter to pthread_create like you do is much better design."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 5, "last_activity_date": 1534321385, "creation_date": 1534321385, "answer_id": 51855271, "question_id": 51855096, "link": "https://stackoverflow.com/questions/51855096/error-conversion-to-non-scalar-type-requested/51855271#51855271", "title": "Error &quot;Conversion to non-scalar type requested&quot;", "body": "<p><em>Scalar types</em> is the formal name for arithmetic types (regular variables) and pointers. The opposite is <em>aggregate types</em>, which is arrays and structs. The compiler thinks you are making a conversion from scalar <code>s</code> to something else. In plain English: don't convert from a pointer to a struct instance.</p>\n\n<p>The scalar <code>s</code> is a pointer, but you cast this to a struct type, rather than to a pointer to a struct (which is what you pass to pthread_create). Try:</p>\n\n<pre><code>fd_set* set1 = (fd_set*)s;\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 10181236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5bQoI5Vh3P0/AAAAAAAAAAI/AAAAAAAAB_c/z8TUCALIFNk/photo.jpg?sz=128", "display_name": "JayJona", "link": "https://stackoverflow.com/users/10181236/jayjona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4370, "favorite_count": 1, "accepted_answer_id": 51855271, "answer_count": 1, "score": 0, "last_activity_date": 1534321385, "creation_date": 1534320628, "last_edit_date": 1534320813, "question_id": 51855096, "link": "https://stackoverflow.com/questions/51855096/error-conversion-to-non-scalar-type-requested", "title": "Error &quot;Conversion to non-scalar type requested&quot;", "body": "<p>I'm trying to implement a multithread server with a thread pool and using the select, so I have <code>fd_set set</code> declared globally that I pass to the function that the thread pool runs.I get this error</p>\n\n<blockquote>\n  <p>In function \u2018threadF\u2019 conversion to non-scalar type requested\n        fd_set set1=(fd_set) s;</p>\n</blockquote>\n\n<p>and the code is this</p>\n\n<pre><code>pool *createPool(int size){\n    /*...*/\n    if((err=pthread_create(&amp;id,NULL,&amp;threadF,(void *)&amp;set))!=0){\n        fprintf(stderr,\"thread\\n\");\n        exit(errno);\n    }\n    /*...*/\n}\n\nvoid *threadF(void* s){\n    fd_set set1=(fd_set) s;\n    /*...*/\n}\n</code></pre>\n\n<p>Maybe I'm forgetting something?</p>\n"}, {"tags": ["c", "sorting"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 6, "creation_date": 1534314908, "post_id": 51853967, "comment_id": 90660328, "body": "Pick a language. It&#39;s almost C, except for the <code>&lt;cstdio&gt;</code>, and certainly not C++ because you redefine C++ keywords."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1534314967, "post_id": 51853967, "comment_id": 90660344, "body": "Triple-check your indexing."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1534315146, "post_id": 51853967, "comment_id": 90660403, "body": "This is an excellent time to learn how to use your debugger if you haven&#39;t."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1534316401, "post_id": 51853967, "comment_id": 90660880, "body": "You risk annoying quite a lot of people by tagging C and C++. The person suffering most from the kind of code you show and the apparent confusion about which compiler to use is yourself. I recommend to clean up your understanding and get rid of the confusion. That is not easy. But maybe a viable path is to pick one of the two languages and study some HelloWorlds and tutorials on the topics you are interested in."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1534316963, "post_id": 51853967, "comment_id": 90661075, "body": "<code>&lt;cstdio&gt;</code> is not a C header, so I removed the <code>c</code> tag. (Also, <code>bool</code> is not a built-in type in C.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "edited": false, "score": 0, "creation_date": 1534318662, "post_id": 51853967, "comment_id": 90661677, "body": "Isn&#39;t it illegal to <code>#define</code> a reserved keyword such as <code>true</code> and <code>false</code> in C++? Or the rule is different in &quot;c/c++&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 292, "user_id": 10057264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/befe33a1c6b57a50503eaa4258d230ff?s=128&d=identicon&r=PG&f=1", "display_name": "Saboor", "link": "https://stackoverflow.com/users/10057264/saboor"}, "is_accepted": false, "score": 1, "last_activity_date": 1534315169, "creation_date": 1534315169, "answer_id": 51854035, "question_id": 51853967, "link": "https://stackoverflow.com/questions/51853967/bubble-sort-using-c/51854035#51854035", "title": "Bubble sort using c", "body": "<p>The problem is your loop is not traversing the complete array. To do this:</p>\n\n<blockquote>\n  <p>Replace \"unsorted_index= n-1\" to \"unsorted_index= n\".</p>\n</blockquote>\n\n<p>output:</p>\n\n<blockquote>\n  <p>2 4 19 26 27 38 44</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10227843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yLMZP.jpg?s=128&g=1", "display_name": "Anwar", "link": "https://stackoverflow.com/users/10227843/anwar"}, "is_accepted": false, "score": -1, "last_activity_date": 1534350151, "creation_date": 1534350151, "answer_id": 51862591, "question_id": 51853967, "link": "https://stackoverflow.com/questions/51853967/bubble-sort-using-c/51862591#51862591", "title": "Bubble sort using c", "body": "<p>Corrected use: for(int i=0; i&lt;= unsorted_index-1; i++)</p>\n\n<p>Instead of: for(int i=0; i&lt; unsorted_index-1; i++)</p>\n"}], "owner": {"reputation": 1, "user_id": 10227843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yLMZP.jpg?s=128&g=1", "display_name": "Anwar", "link": "https://stackoverflow.com/users/10227843/anwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1534350966, "creation_date": 1534314710, "last_edit_date": 1534350966, "question_id": 51853967, "link": "https://stackoverflow.com/questions/51853967/bubble-sort-using-c", "title": "Bubble sort using c", "body": "<p>I tried to do bubble sort using c/c++. It shows the wrong output. I couldn't figure out where the bug is.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define true 1\n#define false 0\n\nint main()\n{\n    int arr[]={26,27,2,38,44,4,19};\n    int n= sizeof arr/sizeof(int);\n    int swapped;\n    int unsorted_index= n-1, temp;\n    do{\n        swapped=false;\n        for(int i=0; i&lt; unsorted_index-1; i++)\n            if(arr[i]&gt;arr[i+1])\n            {\n              temp=arr[i];\n              arr[i]=arr[i+1];\n              arr[i+1]=temp;\n              swapped=true;\n            }\n        unsorted_index--;\n      } while(swapped || unsorted_index);\n    for(int i=0; i&lt;n; i++)\n       printf(\"%d \",arr[i]);\n    return 0;\n}\n</code></pre>\n\n<p>it shows the output:\n2 4 26 27 38 44 19</p>\n\n<p>instead of:\n2 4 19 26 27 38 44</p>\n"}, {"tags": ["c", "pointers", "char"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534316418, "post_id": 51853950, "comment_id": 90660887, "body": "What char* assignment? What char**? This code contains neither. And no, you can&#39;t assign a char*  to a char** or vice versa because they are different, non-compatible types, pointing at different things."}, {"owner": {"reputation": 65, "user_id": 7969933, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Nnr7q.jpg?s=128&g=1", "display_name": "okeyla", "link": "https://stackoverflow.com/users/7969933/okeyla"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534317047, "post_id": 51853950, "comment_id": 90661105, "body": "My purpose is to put 1D char array to 2D one. (as you can see group0~9 to name)  It seems the type is different, but I take my assignment should be OK..."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534319960, "post_id": 51853950, "comment_id": 90662252, "body": "<code>char* name[10][14]</code> is not the same as <code>char** name[10]</code>. In your initializer list <code>{group0}</code> is same as <code>{group0, 0, 0, 0...}</code>as you are initializing arrays."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534319507, "post_id": 51854485, "comment_id": 90662036, "body": "More correct would be to use array pointers <code>char* (*name)[10] = { &amp;group0, group1, ... };</code>."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534320296, "post_id": 51854485, "comment_id": 90662393, "body": "@Lundin Did you mean <code>char* (*name[10])[14] = { &amp;group0, ...</code>? I considered that, but I don&#39;t think that gives much practical benefit given the complex syntax it brings with it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534320356, "post_id": 51854485, "comment_id": 90662417, "body": "Actually I mean <code>char* (*name)[14]</code>. No complicated syntax, <code>name[i]</code> gives array pointer number <code>i</code>, <code>name[i][j]</code> gives char* number <code>j</code>."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534321092, "post_id": 51854485, "comment_id": 90662747, "body": "@Lundin I don&#39;t think that&#39;s enough. <code>name</code> needs to be array of 10 elements, if groups 1-9 should fit in."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534321578, "post_id": 51854485, "comment_id": 90662934, "body": "Ah you are right. So it should indeed be <code>char* (*name[10])[14] </code>."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 2, "last_activity_date": 1534318069, "last_edit_date": 1534318069, "creation_date": 1534317724, "answer_id": 51854485, "question_id": 51853950, "link": "https://stackoverflow.com/questions/51853950/error-cannot-convert-char-to-char-in-initialization-for-strings/51854485#51854485", "title": "error: cannot convert &#39;char**&#39; to &#39;char*&#39; in initialization for strings", "body": "<p>When you use <code>group0</code> in the initializer list of <code>name</code>, it will <a href=\"https://stackoverflow.com/q/1461432/694733\">decay to pointer to first element</a>. This means that for expression <code>group0</code>, the type will be of <code>&amp;group0[0]</code>, which is <code>char**</code>.</p>\n\n<p>Assuming that <code>name</code> supposed to be array of pointers to groups, you need to change it's type accordingly:</p>\n\n<pre><code>char** name[10] = {\n    group0,\n    group1,\n     ...\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7969933, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Nnr7q.jpg?s=128&g=1", "display_name": "okeyla", "link": "https://stackoverflow.com/users/7969933/okeyla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534318069, "creation_date": 1534314590, "question_id": 51853950, "link": "https://stackoverflow.com/questions/51853950/error-cannot-convert-char-to-char-in-initialization-for-strings", "title": "error: cannot convert &#39;char**&#39; to &#39;char*&#39; in initialization for strings", "body": "<p>I am making C console menu program.\nAnd I am stuck with the char* assignment.\nIs there any good method to assign char* to char**?\nThe code is as below:</p>\n\n<pre><code>       char* group0[14]=\n{\n//group0:5\n\"Funciton0-1\",\n\"Function0-2\",\n\"Funciton0-3\",\n\"Function0-4\",\n\"Funciton0-5\",\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\n};\n\n//... group0~group9 are similiar.\n\n   char* group9[14]=\n{\n//group9:2\n\"Funciton9-1\",\n\"Function9-2\",\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\nNULL,\n};\n\n    char* name[10][14]=\n{\n{group0},\n{group1},\n{group2},\n{group3},\n{group4},\n{group5},\n{group6},\n{group7},\n{group8},\n{group9},\n};\n</code></pre>\n\n<p>Why can't I assign those group into this \"name\" array?\nThe compiler replies me error...</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "typedef", "fread", "cs50"], "comments": [{"owner": {"reputation": 1896, "user_id": 4226702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-siukF5ObSUs/AAAAAAAAAAI/AAAAAAAAAEc/Qww5nEqBNDw/photo.jpg?sz=128", "display_name": "Alexander Dmitriev", "link": "https://stackoverflow.com/users/4226702/alexander-dmitriev"}, "edited": false, "score": 2, "creation_date": 1534314181, "post_id": 51853714, "comment_id": 90660072, "body": "<code>256*216+255 = 55551</code>. Same thing in last case, but you also print <b>unsigned integer</b> as <b>signed</b>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534316653, "post_id": 51853714, "comment_id": 90660956, "body": "If you don&#39;t use some dog poop &quot;uint_8&quot; but C standard <code>uint8_t</code>, then you can <code>#include &lt;inttypes.h&gt; printf(&quot;%&quot;PRIu8&quot;, arr[0]);</code> to get the correct format specifier."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534318562, "post_id": 51853714, "comment_id": 90661626, "body": "You forgot to mention why you are confused. What did you expect to see instead?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 3, "creation_date": 1534318714, "post_id": 51853714, "comment_id": 90661709, "body": "Such a typedef <code>typedef uint_32 BYTE;</code> is a good way to annoy any colleague. You should <b>never ever</b> create such a confusing definition."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1534319555, "post_id": 51853714, "comment_id": 90662052, "body": "In addition to Gerhardh: If something is called <code>BYTE</code>, probably anybody would expect a byte. In your case, you should use a better suitable name. Why not <code>Value</code> or <code>Item</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 5314, "user_id": 5270581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leDO2.jpg?s=128&g=1", "display_name": "Laurent H.", "link": "https://stackoverflow.com/users/5270581/laurent-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1534319546, "creation_date": 1534319546, "answer_id": 51854866, "question_id": 51853714, "link": "https://stackoverflow.com/questions/51853714/usage-of-uint-8-uint-16-and-uint-32/51854866#51854866", "title": "Usage of uint_8, uint_16 and uint_32", "body": "<p>In your 3 cases, before the printf statement, the 4 first bytes of the <code>arr</code> array (in hexadecimal format) are: FF D8 FF E0, which corresponds to 255 216 255 224.</p>\n\n<p>Here are explanations of each case:  </p>\n\n<ol>\n<li><p><code>arr[0]</code> has uint8_t type, so its 1-byte value is 0xFF, so <code>printf(\"%i\", arr[0]);</code> prints 255, which corresponds to 0xFF in signed decimal integer format required by <code>%i</code>, integer size being 4 bytes.</p></li>\n<li><p><code>arr[0]</code> has uint16_t type, so its 2-bytes value is 0xFFD8, so <code>printf(\"%i\", arr[0]);</code> prints 55551, which corresponds to 0xFFD8 in signed decimal integer format required by <code>%i</code>, integer size being 4 bytes. Note that 0xFFD8 is interpreted with little-endianness (the byte 0xD8 is the MSB).</p></li>\n<li><p><code>arr[0]</code> has uint32_t type, so its 4-bytes value is 0xFFD8FFE0, so <code>printf(\"%i\", arr[0]);</code> prints -520103681, which corresponds to 0xFFD8FFE0 in <strong>signed</strong> decimal integer format required by <code>%i</code>, integer size being 4 bytes. Note that 0xFFD8FFE0 is interpreted with little-endianness (the byte 0xE0 is the MSB).</p></li>\n</ol>\n\n<p><em>Note: I voluntarily changed \"255 216 255 244\" from your post into \"255 216 255 224\". I think you made a typo.</em></p>\n"}, {"tags": [], "owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1534319960, "last_edit_date": 1534319960, "creation_date": 1534319628, "answer_id": 51854893, "question_id": 51853714, "link": "https://stackoverflow.com/questions/51853714/usage-of-uint-8-uint-16-and-uint-32/51854893#51854893", "title": "Usage of uint_8, uint_16 and uint_32", "body": "<p>You seem to mixup a lot of misunderstandings. Three out of four lines in your examples are questionable. So let's disect them.</p>\n\n<p><code>typedef uint_8 BYTE;</code> why do you have this typedef and where is <code>uint_8</code> coming from I suggest you just use <code>uint8_t</code> from <code>stdint.h</code> and for a minimal example you could skip your typedef to byte completly.</p>\n\n<p>The <a href=\"http://www.cplusplus.com/reference/cstdio/fread/\" rel=\"nofollow noreferrer\">documentation of fread</a> tells us that:</p>\n\n<ul>\n<li>the second parameter is the size of each element to be read</li>\n<li>the third parameter is the number of elements to be read</li>\n</ul>\n\n<p>There are other ways to get the values into memory and to make the program reproducable by copy and paste we can just enter the corresponding values to memory. If you have problems with fread that would be a different question.</p>\n\n<p>So it would be one of those lines (your last value has to be 224 not 244 to get -520103681)</p>\n\n<pre><code>uint8_t arr[512] ={0xFF, 0xD8, 0xFF, 0xE0}; //{255, 216, 255, 224}\nuint16_t arr[512] = {0xD8FF, 0xF4FF };//{255&lt;&lt;8 + 216, 255&lt;&lt;8 + 224} reversed because of the endianess\nuint32_t arr[512] = {0xE0FFD8FF}; //{255&lt;&lt;24 + 216&lt;&lt;16 + 255&lt;&lt;8 + 224}\n</code></pre>\n\n<p>Now you can see that the arrays are of different size and 16/32 bit hardly qualify as a <code>BYTE</code></p>\n\n<p>In the last line you use <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\"><code>printf()</code></a> wrong. If you look up the output and length specifiers for <code>printf()</code> you can see that <code>i</code> is used for <code>int</code> (which probably is 32bit).</p>\n\n<p>Basically you tell it read <code>arr[0]</code> (of whatever type) as signed int.\nThis results in the values you see above. The (nearly) correct specifiers would be <code>%hhu</code> for <code>unsigned char</code>, <code>%hu</code> for <code>unsigned short</code> and <code>%u</code> for <code>unsigned int</code>.</p>\n\n<p>But as you use size defined variables it would be better to use <a href=\"http://www.cplusplus.com/reference/cinttypes/\" rel=\"nofollow noreferrer\"><code>inttypes.h</code></a> and the specifiers :</p>\n\n<p><code>PRIu8, PRIu16 and PRIu32</code> accordingly like this</p>\n\n<pre><code>printf(\"%\"PRIu8,arr[0]);\n</code></pre>\n\n<p>putting them all together yields:</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\nint main(void)\n{\n  uint32_t arr[512] = {0xE0FFD8FF};\n  printf(\"%\"PRIu32,arr[0]);\n  return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>If you make eleminate all the problems in the code we get closer to the problem.\nProblem 1 might have been that you forgot about endianess so you might expect the bytes in a different order.</p>\n\n<p>Also if you use the signed specifier for <code>printf</code> and the MSB is 1 you get a negative value, that won't happen if you use the correct specifier for unsigned values.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4857611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 51854866, "answer_count": 2, "score": -6, "last_activity_date": 1534326765, "creation_date": 1534313281, "last_edit_date": 1534326765, "question_id": 51853714, "link": "https://stackoverflow.com/questions/51853714/usage-of-uint-8-uint-16-and-uint-32", "title": "Usage of uint_8, uint_16 and uint_32", "body": "<p>Please explain each case in detail, what is happening under the hood and why I am getting 55551 and -520103681 specifically.</p>\n\n<pre><code>typedef uint_8 BYTE;        \n\nBYTE arr[512];\nfread(arr, 512, 1, infile);\nprintf(\"%i\", arr[0]);\n</code></pre>\n\n<p><strong>OUTPUT :255</strong></p>\n\n<pre><code>typedef uint_16 BYTE;        \n\nBYTE arr[512];\nfread(arr, 512, 1, infile);\nprintf(\"%i\", arr[0]);\n</code></pre>\n\n<p><strong>OUTPUT :55551</strong></p>\n\n<pre><code>typedef uint_32 BYTE;        \n\nBYTE arr[512];\nfread(arr, 512, 1, infile);\nprintf(\"%i\", arr[0]);\n</code></pre>\n\n<p><strong>OUTPUT :-520103681</strong></p>\n\n<p>I am reading from a file having first four bytes as 255 216 255 244.</p>\n"}, {"tags": ["python", "c", "geometry", "linear-algebra", "raycasting"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1534313303, "post_id": 51853680, "comment_id": 90659798, "body": "the <i>&quot;Python or C&quot;</i> part of this question is somewhat questionable in a Stack Overflow question, when you&#39;re looking for an algorithm, and present no code"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1534314031, "post_id": 51853680, "comment_id": 90660023, "body": "You&#39;ll want to head over to math.stackexchange.com to ask this question. However, you should try to explain <i>the problem you are trying to solve</i>. Right now, you are asking for help with your chosen solution without reference to the actual problem, which means all who read your question just go <i>&quot;Huh?&quot;</i>, then ask you to clarify exactly what you are doing (<i>&quot;smooth direction&quot;</i> is as clear a term as <i>&quot;yellow scent&quot;</i> is), or <i>&quot;What are you trying to achieve by doing that?&quot;</i>. Asking a good question -- something that can be answered positively -- takes quite a bit of effort!"}], "owner": {"reputation": 9, "user_id": 10227797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fa4c6ba8e4fb2bf3284f91c2f90112?s=128&d=identicon&r=PG&f=1", "display_name": "pb_stack", "link": "https://stackoverflow.com/users/10227797/pb-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534313488, "creation_date": 1534313086, "last_edit_date": 1534313488, "question_id": 51853680, "link": "https://stackoverflow.com/questions/51853680/relative-smoth-direction-from-a-point-to-a-polygon-not-shortest-in-python-or", "title": "relative smoth direction from a point to a polygon (not shortest). In Python or C", "body": "<p>I'm trying to have the smooth direction from a point to a polygon mesh.\nIt's not the shortest path direction but one that is interpolated from the mesh normals.</p>\n\n<p>The way I'm going about it is to \"extrude\" the points of polygons along their normals with linePlane intersection between each prim point and normal and a plande defined by P and the plane normal.</p>\n\n<p>I guess the first issue is assess to which polygon the point will belong to. I using a clumbsy way but sort of works. What's bothering me the most is actually after \"extruding\" the points and making the polygon co-planar with the point, I need to find on the orginal polygon the same relative position it has in the extruded one.</p>\n\n<p>I can raycast, so I was wondering if I could just infer somehow the direction back to the orginal poly and get the corresponding position with its hit.</p>\n\n<p>Is is this a common problem with a name, any references I should check?</p>\n\n<p>Rationale: </p>\n\n<p><img src=\"https://i.stack.imgur.com/KNf4r.png\" alt=\"image\"></p>\n"}, {"tags": ["c", "sse", "avx", "mmx"], "answers": [{"comments": [{"owner": {"reputation": 1225, "user_id": 825318, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fa79f3114a3273c0489fe090adbbf350?s=128&d=identicon&r=PG", "display_name": "Isso", "link": "https://stackoverflow.com/users/825318/isso"}, "edited": false, "score": 0, "creation_date": 1534314033, "post_id": 51853721, "comment_id": 90660025, "body": "Thanks a lot for fast response! Wondering how I missed that instruction.."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1225, "user_id": 825318, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fa79f3114a3273c0489fe090adbbf350?s=128&d=identicon&r=PG", "display_name": "Isso", "link": "https://stackoverflow.com/users/825318/isso"}, "edited": false, "score": 0, "creation_date": 1534314470, "post_id": 51853721, "comment_id": 90660167, "body": "@Isso: me too :P. But someone else upvoted your question so I figured maybe the answer wasn&#39;t as obvious or easy to search for as I though.  (Even if you know the right terminology, searching for &quot;arithmetic&quot; in the intrinsics guide doesn&#39;t find it, only in the asm guide.)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 5, "last_activity_date": 1534313323, "creation_date": 1534313323, "answer_id": 51853721, "question_id": 51853561, "link": "https://stackoverflow.com/questions/51853561/using-simd-to-right-shift-32-bit-packed-negative-number/51853721#51853721", "title": "Using SIMD to right shift 32 bit packed negative number", "body": "<p>SSE2/AVX2 has a choice of arithmetic<sup>1</sup> vs. logical right shifts for 16 and 32-bit element sizes.  (For 64-bit elements, only logical is available until AVX512).</p>\n\n<p><strong>Use <code>_mm_srai_epi32</code> (<a href=\"http://felixcloutier.com/x86/PSRAW:PSRAD:PSRAQ.html\" rel=\"noreferrer\"><code>psrad</code></a>)</strong> instead of <code>_mm_srli_epi32</code> (<a href=\"http://felixcloutier.com/x86/PSRLW:PSRLD:PSRLQ.html\" rel=\"noreferrer\"><code>psrld</code></a>).</p>\n\n<p>See <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=4067,602&amp;text=srai\" rel=\"noreferrer\">Intel's intrinsics guide</a>, and other links in the SSE tag wiki <a href=\"https://stackoverflow.com/tags/sse/info\">https://stackoverflow.com/tags/sse/info</a>.  (Filter it to exclude AVX512 if you want, because it's pretty cluttered these days with all the masked versions for all 3 sizes...)</p>\n\n<p>Or just look at the asm instruction-set reference, which includes intrinsics for instructions that have them.  Searching for \"arithmetic\" in <a href=\"http://felixcloutier.com/x86/index.html\" rel=\"noreferrer\">http://felixcloutier.com/x86/index.html</a> finds the shifts you want.</p>\n\n<p>Note the <code>a</code>=arithmetic vs. <code>l</code>=logical, instead of the usual intrinsics naming scheme of <code>epu32</code> for unsigned.  The asm mnemonics are simple and consistent (e.g. Packed Shift Right Arithmetic Dword = <code>psrad</code>).</p>\n\n<hr>\n\n<p>Arithmetic right shifts are also available for AVX2 variable-shifts (<code>vpsravd</code>, and for the one-variable-for-all-elements version of the immediate shifts.</p>\n\n<hr>\n\n<p>Footnote 1:</p>\n\n<p><strong>Arithmetic right shifts shift in copies of the sign bit, instead of zero</strong>.</p>\n\n<p>This correctly implement 2's complement signed division by powers of 2 with rounding towards negative infinity, unlike the truncation toward zero you get from C signed division.  Look at the asm output for <code>int foo(int a){return a/4;}</code> to see how compilers implement signed division semantics in terms of shifts.</p>\n"}], "owner": {"reputation": 1225, "user_id": 825318, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fa79f3114a3273c0489fe090adbbf350?s=128&d=identicon&r=PG", "display_name": "Isso", "link": "https://stackoverflow.com/users/825318/isso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 51853721, "answer_count": 1, "score": 2, "last_activity_date": 1534313323, "creation_date": 1534312226, "question_id": 51853561, "link": "https://stackoverflow.com/questions/51853561/using-simd-to-right-shift-32-bit-packed-negative-number", "title": "Using SIMD to right shift 32 bit packed negative number", "body": "<p>I'm writing some SSE/AVX code and there's a task to divide a packed signed 32 bit integers by 2's complement. When the values are positive this shift works fine, however it produces wrong results for negative values, because of shifting the sign bit.<br>\nIs there any SIMD operation that lets me shift preserving the position of the sign bit? Thanks</p>\n"}, {"tags": ["c", "data-structures", "segmentation-fault"], "comments": [{"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 2, "creation_date": 1534312073, "post_id": 51853518, "comment_id": 90659506, "body": "Try stepping through the code, looking at the values using the debugger until they&#39;re not what they should be. Hint: what happens if a value is <code>NULL</code>?"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1534314154, "post_id": 51853518, "comment_id": 90660064, "body": "wizzwizz4 gave very good advice: please familiarize yourself with the debugger, and get in the habit of using it: <a href=\"http://wiki.codeblocks.org/index.php/Debugging_with_Code::Blocks\" rel=\"nofollow noreferrer\">wiki.codeblocks.org/index.php/Debugging_with_Code::Blocks</a>.  Please, too, be sure to &quot;upvote&quot; replies that were helpful, and &quot;accept&quot; the answer the resolves the problem."}, {"owner": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1534314964, "post_id": 51853518, "comment_id": 90660343, "body": "Thanks for your input @paulsm ! I&#39;m beginner in C. I&#39;ll refer that link for sure."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534319835, "post_id": 51853518, "comment_id": 90662184, "body": "You should rewrite this to pass the pointers through parameters instead of using ugly global variables."}], "answers": [{"tags": [], "owner": {"reputation": 2404, "user_id": 2770172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d89a9f2bc229e57d69bed4280d04617?s=128&d=identicon&r=PG&f=1", "display_name": "evolvedmicrobe", "link": "https://stackoverflow.com/users/2770172/evolvedmicrobe"}, "is_accepted": false, "score": 2, "last_activity_date": 1534313698, "last_edit_date": 1534313698, "creation_date": 1534312891, "answer_id": 51853653, "question_id": 51853518, "link": "https://stackoverflow.com/questions/51853518/how-to-solve-segmentation-faultcore-dumped-error-in-c-using-codeblocks-in-ub/51853653#51853653", "title": "How to solve Segmentation fault(core dumped) error in C using Code::Blocks in Ubuntu?", "body": "<p>In your function <code>QDisplay</code>, you check if a pointer is null, but don't exit if that condition is true, but instead go on to dereference the pointer, which will cause a segfault.  You need to modify the method to return if queue is empty.  E.g.</p>\n\n<pre><code>void QDisplay( Q *front )\n{\n    if( QEmpty( front ) )\n    {\n        printf(\"\\nThe Queue is empty\");\n        // Two lines below added by me\n        printf(\"\\nReturning to main menu . . \");\n        return;\n    }\n ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "edited": false, "score": 0, "creation_date": 1534314478, "post_id": 51853811, "comment_id": 90660172, "body": "Thanks @4386427 ! It worked perfectly. I have some doubts."}, {"owner": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "edited": false, "score": 0, "creation_date": 1534314571, "post_id": 51853811, "comment_id": 90660218, "body": "1) Since i used a do while construct to traverse the queue, it means i can still display 1 element ,right? like the condition while( front-&gt;next != NULL) occurs only after displaying first node?"}, {"owner": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "edited": false, "score": 0, "creation_date": 1534314662, "post_id": 51853811, "comment_id": 90660251, "body": "2) Since i used the front node to traverse, does this alter the position of the original front node? Is it better to assign front node to temp, (such as Q *temp; temp = front) and continue to traverse?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "edited": false, "score": 1, "creation_date": 1534314936, "post_id": 51853811, "comment_id": 90660338, "body": "@AndrewJoel Regarding 2) No, it will <b>not</b> change the global <code>front</code> variable. You are confused about global versus local variables. Inside <code>QDisplay</code> it is a <b>local</b> variable because of you pass it into front. Try this to better understand: 1) use <code>void QDisplay( Q *tmp )</code> 2) change all <code>front</code> inside <code>QDisplay</code> to <code>tmp</code>. See the difference? That said - I&#39;ll recommend that you <b>do not</b> use global variables. And if you must use globals then avoid using the same name for local variables including function arguments."}, {"owner": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "edited": false, "score": 0, "creation_date": 1534315209, "post_id": 51853811, "comment_id": 90660422, "body": "your optional approach works just fine. So, you recommend me to use temp instead of global variable front?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "edited": false, "score": 1, "creation_date": 1534315252, "post_id": 51853811, "comment_id": 90660445, "body": "@AndrewJoel yes.  if you must use globals then avoid using the same name for local variables including function arguments"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1534318037, "last_edit_date": 1534318037, "creation_date": 1534313837, "answer_id": 51853811, "question_id": 51853518, "link": "https://stackoverflow.com/questions/51853518/how-to-solve-segmentation-faultcore-dumped-error-in-c-using-codeblocks-in-ub/51853811#51853811", "title": "How to solve Segmentation fault(core dumped) error in C using Code::Blocks in Ubuntu?", "body": "<p>The answer from @evolvedmicrobe shows a bug in <code>QDisplay</code> in case your list is empty (i.e. when <code>front</code> is NULL).</p>\n\n<p>This answer will focus on another bug in <code>QDisplay</code>.</p>\n\n<p>Consider what will happen when <strong>the list contains exactly 1 element</strong>. In that case <code>front</code> and <code>rear</code> are identical. Further <code>front-&gt;next</code> is NULL.</p>\n\n<p>So look at my comment in the order 1), 2), 3) and 4):</p>\n\n<pre><code>void QDisplay( Q *front )\n{\n    if( QEmpty( front ) )\n    {\n        printf(\"\\nThe Queue is empty\");\n    }\n    printf(\"\\nThe display of Queue is:\\n\");\n    printf(\"!!!-&gt;\");\n    do\n    {\n        printf(\"%d\", front-&gt;data);  // 1) In first loop this will print the data from the first element (fine)\n                                    // 4) In the second loop you deference front which is NULL =&gt; seg fault\n\n        front = front-&gt;next;        // 2) Now front gets the value NULL\n\n    }while( front != rear );        // 3) Front and rear differs so the loop continuees\n}\n</code></pre>\n\n<p>(note: besides causing a bug when there is exactly 1 element, your approach is also bad for \"more than 1 element\" as you will never print the last element)</p>\n\n<p>A better approach is:</p>\n\n<pre><code>void QDisplay( Q *front )\n{\n    if( QEmpty( front ) )\n    {\n        printf(\"\\nThe Queue is empty\");\n        return;\n    }\n    printf(\"\\nThe display of Queue is:\\n\");\n    printf(\"!!!-&gt;\");\n    do\n    {\n        printf(\"%d\", front-&gt;data);\n        front = front-&gt;next;\n    }while( front != NULL );   // or just } while(front);\n}\n</code></pre>\n\n<p>Additional consideration:</p>\n\n<p>Your code uses the global variable <code>front</code> and <code>rear</code>. In general I'll recommend that you <strong>do not</strong> use global variables. It's confusing and error prone. Instead you can define them in <code>main</code> and pass pointers to them to functions that need to change them. Or - perhaps better - place them in a struct so you can pass a pointer to a variable of that struct (define in <code>main</code>).</p>\n\n<p>If you really, really, really think you need global variables, I'll strongly recommend that you <strong>never</strong> use the same name for local variables and function arguments. In other words: You <code>QDisplay</code> currently has an argument with the name <code>front</code> - just like the global variable <code>front</code>. That's kind of confusing... what will happen when you assign something to <code>front</code> inside <code>QDisplay</code>? Will the global <code>front</code> change? The answer is no but to avoid confusion it's better to use another name for the function argument. Like:</p>\n\n<pre><code>void QDisplay( Q *p )\n{\n    if( QEmpty( p ) )\n    {\n        printf(\"\\nThe Queue is empty\");\n        return;\n    }\n    printf(\"\\nThe display of Queue is:\\n\");\n    printf(\"!!!-&gt;\");\n    do\n    {\n        printf(\"%d\", p-&gt;data);\n        p = p-&gt;next;\n    }while( p != NULL );   // or just } while(p);\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10176707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SxM2Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10176707/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 51853811, "answer_count": 2, "score": 1, "last_activity_date": 1534318037, "creation_date": 1534311845, "question_id": 51853518, "link": "https://stackoverflow.com/questions/51853518/how-to-solve-segmentation-faultcore-dumped-error-in-c-using-codeblocks-in-ub", "title": "How to solve Segmentation fault(core dumped) error in C using Code::Blocks in Ubuntu?", "body": "<p>I was running a linked queue data structure in C using Code::Blocks IDE.\nBelow is my code:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct LinkedQueue\n{\n    int data;\n    struct LinkedQueue *next;\n}Q;\nQ *front , *rear;\n\nint QEmpty( Q * );\nvoid QInsert();\nQ *QDelete();\nvoid QDisplay( Q* );\n\n\nint main()\n{\n    int ans, choice;\n    front = NULL;\n    rear = NULL;\n    do\n    {\n        printf(\"\\n::Linked Queue Menu::\");\n        printf(\"\\n  1. Insert \");\n        printf(\"\\n  2. Delete \");\n        printf(\"\\n  3. Display \");\n        printf(\"\\n  4. Exit \");\n        printf(\"\\n Enter your choice:\");\n        scanf(\"%d\", &amp;choice);\n        switch( choice )\n        {\n            case 1: QInsert();\n                    break;\n\n            case 2: front = QDelete();\n                    break;\n\n            case 3: QDisplay(front);\n                    break;\n\n            case 4: exit(0);\n\n        }\n        printf(\"\\nDo you want to go to main menu? (1/0) :\");\n        scanf(\"%d\", &amp;ans);\n    }while ( ans == 1 );\n    return 0;\n}\n\n\n\nvoid QInsert()\n{\n    Q *temp;\n    temp = (Q*)malloc(sizeof(Q));\n    temp-&gt;next = NULL;\n    if( temp == NULL)\n    {\n        printf(\"\\nMemory cannot be allocated\");\n        return;\n    }\n    printf(\"\\nEnter the data:\");\n    scanf(\"%d\", &amp;temp-&gt;data);\n    if( QEmpty( front ) )\n    {\n        front = temp;\n        rear = temp;\n    }\n    else\n    {\n        rear-&gt;next = temp;\n        rear = rear-&gt;next;\n    }\n    printf(\"\\nInsertion Successful\");\n\n}\n\nint QEmpty( Q *front )\n{\n    if( front == NULL )\n        return 1;\n    else\n        return 0;\n}\n\nQ *QDelete()\n{\n    Q *temp;\n    temp = front;\n    if( QEmpty( front ) )\n    {\n        printf(\"\\nQueue Underflow!!\");\n        printf(\"\\nReturning to main menu . . \");\n        return NULL;\n    }\n    else\n    {\n        printf(\"\\nThe deleted element is %d.\", temp-&gt;data);\n        front = front-&gt;next;\n        temp-&gt;next = NULL;\n        free( temp );\n    }\n    return front;\n}\n\nvoid QDisplay( Q *front )\n{\n    if( QEmpty( front ) )\n    {\n        printf(\"\\nThe Queue is empty\");\n    }\n    printf(\"\\nThe display of Queue is:\\n\");\n    printf(\"!!!-&gt;\");\n    do\n    {\n        printf(\"%d\", front-&gt;data);\n        front = front-&gt;next;\n    }while( front != rear );\n}\n</code></pre>\n\n<p>When I ran this program, the insertion and deletion functions works fine. But when I called the display function, it resulted into a segmentation fault (core dumped).</p>\n\n<p>Please help me how to solve this error.\nThanks in advance.</p>\n"}, {"tags": ["c", "sqlite"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1534309684, "post_id": 51853221, "comment_id": 90658965, "body": "Could you make a smaller <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? Demonstrating creation and the (failing) filling with sample data should take fewer lines. It would improve your chances for helpful answers."}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1534310511, "post_id": 51853221, "comment_id": 90659173, "body": "Yes, you&#39;re right. I&#39;ll leave the entire code for now while I work on it. There are indeed a lot of repetitive lines that could be taken out. Thank you for the suggestion!"}, {"owner": {"reputation": 21188, "user_id": 105539, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c85c46cd17b738fbee94fcba1ade96a9?s=128&d=identicon&r=PG", "display_name": "Volomike", "link": "https://stackoverflow.com/users/105539/volomike"}, "edited": false, "score": 1, "creation_date": 1534312314, "post_id": 51853221, "comment_id": 90659569, "body": "The problem at heart appears to be writing to SQLite. Minimize the problem down without the stack code and see if you can prove you can write data of any sort into SQLite."}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1534312433, "post_id": 51853221, "comment_id": 90659602, "body": "Got it. I&#39;ll do that now. Thanks!"}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1534320935, "post_id": 51853221, "comment_id": 90662668, "body": "Volomike, I followed your suggestion and added only the SQLite code to my question hoping to clarify my thought process.  I hope you or somebody else can help me out with this.  I really want it to work."}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1534324904, "post_id": 51853221, "comment_id": 90664311, "body": "Print out the value of <code>sql</code> before executing it. And don&#39;t ignore what <code>error</code> tells you!"}, {"owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "edited": false, "score": 0, "creation_date": 1534330563, "post_id": 51853221, "comment_id": 90666907, "body": "I used <code>fprintf(stderr,&quot;%s\\n&quot;,sql);</code> in the <code>addData()</code> function, but nothing happened. That means my node is getting to <code>addData()</code> as NULL, right? How can I fix this? Also, <code>error</code> doesn&#39;t print anything out."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1534408536, "creation_date": 1534408536, "answer_id": 51872878, "question_id": 51853221, "link": "https://stackoverflow.com/questions/51853221/wallet-application-using-c-and-sqlite/51872878#51872878", "title": "Wallet application using C and SQLite", "body": "<p>I found this on the <a href=\"https://sqlite.org/cintro.html\" rel=\"nofollow noreferrer\">SQLite website</a>. I wasn't setting up my statements correctly. Although it's not absolutely necessary in order to store data in the DB, it is if you wanna store variables.\n<br></p>\n\n<blockquote>\n  <p>The principal task of an SQL database engine is to evaluate SQL\n  statements of SQL. To accomplish this, the developer needs two\n  objects: <br>\n  * The database connection object: sqlite3 <br> * The prepared statement object: sqlite3_stmt</p>\n</blockquote>\n\n<p>The function below does exactly that: </p>\n\n<pre><code>void putData(sqlite3 * db, stack * s,stack_node * node)\n{\n    node = s-&gt;top;\n    s-&gt;top=s-&gt;top-&gt;next;\n    sqlite3_stmt * stmt;\n    int rc;\n    sqlite3_prepare_v2(db, \"insert into wallet (value, date, info) values (?1, ?2, ?3);\", -1, &amp;stmt, NULL);\n\n    sqlite3_bind_int(stmt, 1, node-&gt;value);\n    sqlite3_bind_text(stmt, 2, node-&gt;date, -1, SQLITE_STATIC);\n    sqlite3_bind_text(stmt, 3, node-&gt;info, -1, SQLITE_STATIC);\n\n    rc = sqlite3_step(stmt);\n    if (rc != SQLITE_DONE) {\n    error(db);\n    }\n\n    sqlite3_finalize(stmt);\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10193932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nwT3uElPcVo/AAAAAAAAAAI/AAAAAAAAACc/Ps6Ujx-xRFs/photo.jpg?sz=128", "display_name": "Richie P.", "link": "https://stackoverflow.com/users/10193932/richie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 51872878, "answer_count": 1, "score": 1, "last_activity_date": 1534408536, "creation_date": 1534309504, "last_edit_date": 1534329739, "question_id": 51853221, "link": "https://stackoverflow.com/questions/51853221/wallet-application-using-c-and-sqlite", "title": "Wallet application using C and SQLite", "body": "<p>I built a straightforward program in C. It's just a STACK structure (first in, last out) that takes input from the user and stores it into the stack. After I close the program, all the data vanishes since I don't have a database implemented into the program. Even so, the program runs fine. It allocates memory according to the user's input, and I always validate every allocation. </p>\n\n<p>In fact, my issue isn't concerning C code itself. It's the implementation of SQLite into the C code. Every <code>stack_node</code> has a <strong>value (integer)</strong>, <strong>date (char)</strong>, and <strong>info (char)</strong>. The wallet structure is the \"middle-man\" between the <code>stack_node</code> and the DB, and it has the same attributes plus an ID (integer autoincremented). What I'm trying to do is to as soon as the user inputs data (while the program is running) this data gets stored not only in the stack but also in the DB. After the user is done inputting data, I usually use <code>pop_stack()</code> to retrieve the data from the stack onto the screen, but since the data is stored in the DB, it makes more sense just to extract all data from the DB. </p>\n\n<p>I don't get any compilation errors and the SQLite source files/header files are implemented correctly into the code. I know this because I'm using SQLite Studio ( SQLite GUI) and I see all the attributes from the wallet DB, but they are all empty. </p>\n\n<p>So, that's my issue. I'm doing something wrong that causes the program to not store the data correctly into the DB.<br><br>\n--- Is it a waste of memory and running time for the program to create a stack, stack_node etc...to only after all that store the information in the DB? Should I just skip all that and program just for the DB? If so, how would I do that since I would eventually run into the same problem. I'm using the stack because I might have more control over what I can do with the data like adding the values, calculate average expenditure and so on.   </p>\n\n<p><strong>Mini Project Version</strong> - <em>same functionality</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sqlite3.h&gt;\n#define MAXB 1024\n\n#define CREATE_TABLE_WALLET \\\n    \"CREATE TABLE IF NOT EXISTS wallet\" \\\n    \"(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL\" \\\n    \",value INTEGER NOT NULL)\"\n\ntypedef struct Wallet Wallet;\n\nstruct Wallet{\n    int id;\n    int value;\n    Wallet * next;\n};\n\ntypedef struct stack_node{\n    int value;\n    struct stack_node * next;\n}stack_node;\n\ntypedef struct stack{\n    int size;\n    stack_node * top;\n}stack;\n\nstack * create_stack(){\n    stack * s = malloc(sizeof * s);\n    if(!s){\n        perror(\"malloc-s\");\n        return NULL;\n    }\n    s-&gt;size=0;\n    s-&gt;top=NULL;\n    return s;\n}\n\nstack_node * push_stack(stack * s,int value){\n    stack_node * n = malloc(sizeof * n);\n    if(!n){\n        perror(\"malloc-n\");\n        return NULL;\n    }\n    n-&gt;value=value;\n    n-&gt;next=s-&gt;top;\n    s-&gt;top=n;\n    s-&gt;size++;\n    return n;\n}\n\nstack_node * pop_stack(stack * s){\n    if(s-&gt;size &gt; 0){\n        stack_node * node = s-&gt;top;\n        s-&gt;top=s-&gt;top-&gt;next;\n        return node;\n        s-&gt;size--;\n    }\n    return NULL;\n}\n\nWallet * newWallet(const Wallet * wallet){\n    Wallet * w = (Wallet *)malloc(sizeof(Wallet));\n    w-&gt;value = wallet-&gt;value;\n    w-&gt;id=wallet-&gt;id;\n    w-&gt;next = NULL;\n    w-&gt;id=-1;\n    return w;\n}\n\nint error(sqlite3 * db){\n    fprintf(stderr, \"Error: %s \\n\",sqlite3_errmsg(db));\n    return sqlite3_errcode(db);\n}\n\nvoid addData( sqlite3 * db, stack_node * node){\n    if(node == NULL){\n        return;\n        }\n\n    char sql[100];\n    while(node != NULL){\n        sprintf(sql, \"INSERT INTO wallet(value,date, info) VALUES (%d)\",\n                node-&gt;value);\n        if(sqlite3_exec(db, sql, NULL, NULL, NULL) != SQLITE_OK){\n            error(db);\n            return;\n        }\n        node=node-&gt;next;\n    }\n}\n\nint callback(void *ptr,int numbCol,char **valCell, char **nameCol){\n    (void)ptr;\n    int ix;\n    for(ix=0; ix &lt; numbCol ; ++ix){\n        printf(\"%s: %s \\n\",nameCol[ix],valCell[ix]);\n    }\n    printf(\"\\n\");\n    return 0;\n}\n\nvoid readDB(sqlite3 * db){\n    sqlite3_exec(db, \"SELECT * FROM wallet\", callback, NULL,NULL);\n}\n\nint main(void)\n{\n    stack * s =  create_stack();\n    stack_node * node = NULL;\n\n    Wallet wallet;\n\n    sqlite3 * db = NULL;\n    const char * filenameDatabase = \"C:/Users/ricar/Downloads/docs/C/trialszz/wall.db\";\n\n    ///open date base\n    if(sqlite3_open(filenameDatabase,&amp;db) != SQLITE_OK){\n        error(db);\n    }\n\n    ///config DB\n    if(sqlite3_exec(db, CREATE_TABLE_WALLET, NULL, NULL,NULL) != SQLITE_OK){\n        return error(db);\n    }\n\n    for(;;){\n        char buf[MAXB] = \"\";\n        int value = 0;\n\n        for(;;){\n            fputs(\"\\nenter value: \",stdout);\n            if(fgets(buf,MAXB,stdin)){\n                if(*buf == '\\n'){\n                    fputs(\"**input done**\",stderr);\n                    goto inputdone;\n                }\n                else if(sscanf(buf,\"%d\",&amp;value) == 1)\n                    break;\n                else{\n                    fputs(\"**invalid integer input**\\n\",stderr);\n                }\n            }\n            else{\n                fputs(\"**user canceled input** \\n\",stderr);\n                goto inputdone;\n            }\n        }\n\n        if(push_stack(s,value)){\n                addData(db, node);\n            }\n    }\n    inputdone:;\n\n\n    puts(\"\\n\\n|-|-|STACK DATA|-|-|\\n\\n\");\n    readDB(db);\n\n    /* while((node = pop_stack(s)) != NULL){\n        printf(\"value: %2d \\n\",node-&gt;value);\n        free(node);\n    }\n    free(s); */\n\n    sqlite3_close(db);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Complete Project</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sqlite3.h&gt;\n#define MAXB 1024\n#define MAXDT 64\n#define MAXIF 128\n\n#define CREATE_TABLE_WALLET \\\n    \"CREATE TABLE IF NOT EXISTS wallet\" \\\n    \"(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL\" \\\n    \",value INTEGER NOT NULL\"\\\n    \", date TEXT NOT NULL\" \\\n    \", info TEXT NOT NULL)\"\n\ntypedef struct Wallet Wallet;\n\nstruct Wallet{\n    int id;\n    int value;\n    char date[64];\n    char info[128];\n    Wallet * next;\n};\n\ntypedef struct stack_node{\n    int value;\n    char * date;\n    char * info; \n    struct stack_node * next;\n}stack_node;\n\ntypedef struct stack{\n    int size;\n    stack_node * top;\n}stack;\n\nstack * create_stack(){\n    stack * s = malloc(sizeof * s);\n    if(!s){\n        perror(\"malloc-s\");\n        return NULL;\n    }\n    s-&gt;size=0;\n    s-&gt;top=NULL;\n    return s;\n}\n\nstack_node * push_stack(stack * s,int value,char * date,char * info){\n    stack_node * n = malloc(sizeof * n);\n    if(!n){\n        perror(\"malloc-n\");\n        return NULL;\n    }\n    n-&gt;value=value;\n    ///-------------\n    n-&gt;date = malloc(strlen(date) + 1);\n    if(!n-&gt;date){\n        perror(\"malloc-date\");\n        return NULL;\n    }\n    strcpy(n-&gt;date,date);\n    ///-------------\n\n    ///-------------\n    n-&gt;info = malloc(strlen(info) + 1);\n    if(!n-&gt;info){\n        perror(\"malloc-info\");\n        return NULL;\n    }\n    strcpy(n-&gt;info,info);\n    ///-------------\n    n-&gt;next=s-&gt;top;\n    s-&gt;top=n;\n    s-&gt;size++;\n    return n;\n}\n\nstack_node * pop_stack(stack * s){\n    if(s-&gt;size &gt; 0){\n        stack_node * node = s-&gt;top;\n        s-&gt;top=s-&gt;top-&gt;next;\n        return node;\n        s-&gt;size--;\n    }\n    return NULL;\n}\n\nvoid free_node(stack_node * n){\n    if(n-&gt;date &amp;&amp; n-&gt;info)\n        free(n-&gt;date);\n        free(n-&gt;info);\n\n    free(n);\n}\n\nvoid free_stack(stack * s){\n    while(s-&gt;size &gt; 0){\n        stack_node * victim = s-&gt;top;\n        s-&gt;top=s-&gt;top-&gt;next;\n        free_node(victim);\n        s-&gt;size--;\n    }\n    free(s);\n}\n\nWallet * newWallet(const Wallet * wallet){\n    Wallet * w = (Wallet *)malloc(sizeof(Wallet));\n    strcpy(w-&gt;date,wallet-&gt;date);\n    strcpy(w-&gt;info,wallet-&gt;info);\n    w-&gt;value = wallet-&gt;value;\n    w-&gt;id=wallet-&gt;id;\n    w-&gt;next = NULL;\n    w-&gt;id=-1;\n    return w;\n}\n\nint error(sqlite3 * db){\n    fprintf(stderr, \"Error: %s \\n\",sqlite3_errmsg(db));\n    return sqlite3_errcode(db);\n}\n\nvoid addData( sqlite3 * db, stack_node * node){\n    if(node == NULL){\n        return;\n        }\n\n    char sql[100];\n    while(node != NULL){\n        sprintf(sql, \"INSERT INTO wallet(value,date, info) VALUES (%d,'%s','%s')\",\n                node-&gt;value,node-&gt;date,node-&gt;info);\n        if(sqlite3_exec(db, sql, NULL, NULL, NULL) != SQLITE_OK){\n            error(db);\n            return;\n        }\n        node=node-&gt;next;\n    }\n}\n\nint callback(void *ptr,int numbCol,char **valCell, char **nameCol){\n    (void)ptr;\n    int ix;\n    for(ix=0; ix &lt; numbCol ; ++ix){\n        printf(\"%s: %s \\n\",nameCol[ix],valCell[ix]);\n    }\n    printf(\"\\n\");\n    return 0;\n}\n\nvoid readDB(sqlite3 * db){\n    sqlite3_exec(db, \"SELECT * FROM wallet\", callback, NULL,NULL);\n}\n\nint main(void)\n{\n    stack * s =  create_stack();\n    stack_node * node = NULL;\n\n    Wallet wallet;\n\n    sqlite3 * db = NULL;\n    const char * filenameDatabase = \"C:/Users/ricar/Downloads/docs/C/trialszz/wall.db\";\n\n    ///open date base\n    if(sqlite3_open(filenameDatabase,&amp;db) != SQLITE_OK){\n        error(db);\n    }\n\n    ///config DB\n    if(sqlite3_exec(db, CREATE_TABLE_WALLET, NULL, NULL,NULL) != SQLITE_OK){\n        return error(db);\n    }\n\n\n    for(;;){\n        char buf[MAXB] = \"\";\n        char date[MAXDT] = \"\";\n        char info[MAXIF] = \"\";\n        int value = 0;\n\n        for(;;){\n            fputs(\"\\nenter value: \",stdout);\n            if(fgets(buf,MAXB,stdin)){\n                if(*buf == '\\n'){\n                    fputs(\"**input done**\",stderr);\n                    goto inputdone;\n                }\n                else if(sscanf(buf,\"%d\",&amp;value) == 1)\n                    break;\n                else{\n                    fputs(\"**invalid integer input**\\n\",stderr);\n                }\n            }\n            else{\n                fputs(\"**user canceled input** \\n\",stderr);\n                goto inputdone;\n            }\n        }\n\n        for(;;){\n            fputs(\"enter date: \",stdout);\n            if(fgets(date,MAXDT,stdin)){\n                size_t lenDT = strlen(date);\n                if(lenDT &amp;&amp; date[lenDT - 1] == '\\n'){\n                    date[--lenDT] = 0;\n                    if(lenDT)\n                        break;\n                    else\n                        fputs(\"**empty-line**\\n\",stderr);\n                    }\n                    else if(lenDT == MAXDT -1){\n                        fputs(\"**warning: string too long** \\n\",stderr);\n                    }\n            }\n            else{\n                fputs(\"**user canceled input**\\n\",stderr);\n                goto inputdone;\n            }\n        }\n\n        for(;;){\n            fputs(\"enter INFO about value: \",stdout);\n            if(fgets(info,MAXIF,stdin)){\n                size_t lenIF = strlen(info);\n                if(lenIF &amp;&amp; info[lenIF - 1] == '\\n'){\n                    info[--lenIF] = 0;\n                        if(lenIF)\n                            break;\n                        else\n                            fputs(\"**empty-line**\\n\",stderr);\n                }\n                else if(lenIF == MAXIF - 1){\n                    fputs(\"**warning: string too long**\",stderr);\n                }\n            }\n            else{\n                fputs(\"**user canceled input**\",stderr);\n                goto inputdone;\n            }\n        }\n        if(push_stack(s,value,date,info)){\n                addData(db, node);\n            }\n    }\n    inputdone:;\n\n\n    puts(\"\\n\\n|-|-|STACK DATA|-|-|\\n\\n\");\n    readDB(db);\n\n    /* while((node = pop_stack(s)) != NULL){\n        printf(\"value: %2d  date: %s  info: %s  \\n\",node-&gt;value,node-&gt;date,node-&gt;info);\n        free_node(node);\n    }\n    free_stack(s);   */\n\n    sqlite3_close(db);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Only SQLite code</strong><br>\nA few things to consider:<br>\n- This code works fine, but it takes pre-existing data from a .txt file and stores it in the SQLite DB -- if you delete the .txt file afterwards it won't affect the DB.<br>\n- If I want to display the data from the DB all I have to do is copy/paste the <code>callback()</code> and <code>readDB()</code> functions from the project's code.<br>\n- I don't like using a .txt file. I chose to use SQLite precisely because it's a serverless DB, and so you won't need to do a lot. You just put the source files into your project and that's that. Having said that, I tried to use the same concepts from this code to the project's code, but always getting the data from the user while the program is running, and not from a .txt file. <br></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sqlite3.h&gt;\n\n#define CREATE_TABLE_WALLET \\\n    \"CREATE TABLE IF NOT EXISTS wallet\" \\\n    \"(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL\" \\\n    \", info TEXT NOT NULL \" \\\n    \", value INTEGER NOT NULL)\"\n\ntypedef struct Wallet Wallet;\n\nstruct Wallet{\n    char info[100];\n    int value;\n    int id;\n    Wallet * next;\n};\n\nvoid showList(const Wallet * list)\n{\n    if(list == NULL){\n        printf(\"[empty-list]\\n\");\n        return;\n    }\n    Wallet * ix = list;\n    while(ix != NULL){\n        printf(\"ID: %d; info: %s; value: %d \\n\",ix-&gt;id,ix-&gt;info,ix-&gt;value);\n        ix=ix-&gt;next;\n    }\n}\n\nWallet * newWallet(const Wallet *wallet)\n{\n    Wallet * w = (Wallet *)malloc(sizeof(Wallet));\n    strcpy(w-&gt;info,wallet-&gt;info);\n    w-&gt;value=wallet-&gt;value;\n    w-&gt;id=wallet-&gt;id;\n    w-&gt;next = NULL;\n    w-&gt;id = -1;\n    return w;\n}\n\nvoid addWallet(Wallet ** list, const Wallet * wallet)\n{\n    if(list == NULL){\n        return;\n    }\n    if(*list == NULL){\n        *list = newWallet(wallet);\n        return;\n    }\n    Wallet * ix = *list;\n    while(ix-&gt;next != NULL){\n        ix=ix-&gt;next;\n    }\n    ix-&gt;next=newWallet(wallet);\n}\n\nint error(sqlite3 * db)\n{\n    fprintf(stderr,\"Error: %s \\n\", sqlite3_errmsg(db));\n    return sqlite3_errcode(db);\n}\n\nvoid addData(const Wallet * list, sqlite3 * db)\n{\n    if(list == NULL){\n        return;\n    }\n    Wallet * ix = list;\n    char sql[100];\n    while(ix != NULL){\n        sprintf(sql, \"INSERT INTO wallet (info, value) VALUES ('%s', %d)\", ix-&gt;info, ix-&gt;value);\n        if(sqlite3_exec(db, sql, NULL, NULL, NULL) != SQLITE_OK){\n            error(db);\n            return;\n        }\n        ix=ix-&gt;next;\n    }\n}\n\nint main(void)\n{\n    FILE * file = NULL;\n    Wallet wallet;\n    Wallet * list = NULL;\n    sqlite3 * db = NULL;\n    const char * filenameDatabase = \"C:/Users/ricar/Downloads/docs/C/123_sqlite3/wall.db\";\n    const char * filenameList = \"C:/Users/ricar/Downloads/docs/C/123_sqlite3/data.txt\";\n    ///open DB\n    if(sqlite3_open(filenameDatabase, &amp;db) != SQLITE_OK){\n        return error(db);\n    }\n\n    ///config DB\n    if(sqlite3_exec(db, CREATE_TABLE_WALLET, NULL,NULL,NULL) != SQLITE_OK){\n        return error(db);\n    }\n\n    ///read DB\n    file = fopen(filenameList, \"r\");\n    if(file ==  NULL){\n        fprintf(stderr,\"Error opening file. \\n\");\n        return ferror(file);\n    }\n\n    while(!feof(file)){\n        fscanf(file, \"%s%d\",wallet.info,&amp;wallet.value);\n        addWallet(&amp;list, &amp;wallet);\n    }\n    fclose(file);\n\n    ///showList(list);\n\n    addData(list,db);///move data from .txt to .db\n\n    sqlite3_close(db);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "kernighan-and-ritchie"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1534308065, "post_id": 51852988, "comment_id": 90658607, "body": "With ease. What&#39;s the actual problem here?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1534308118, "post_id": 51852988, "comment_id": 90658619, "body": "You are obviously already clear that it will declare a functiona and a variable. So what is your question? What gives you doubts about this? Is there another outcome you are considering?"}, {"owner": {"reputation": 71, "user_id": 6430796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604af860253807767cc17fa50cb25115?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/6430796/akash"}, "edited": false, "score": 0, "creation_date": 1534308364, "post_id": 51852988, "comment_id": 90658683, "body": "i&#39;m clear with atof, but how is *dp evaluated to, because if double specifies the return type of atof, doesn&#39;t it end the statement there?? and we need to declare *dp on a new line??"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1534309991, "post_id": 51852988, "comment_id": 90659042, "body": "The comma separates the things being declared. If the compiler sees a comma ending the thing being declared, it looks for another. If it sees a semicolon, it knows the statement has ended."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534322315, "post_id": 51852988, "comment_id": 90663214, "body": "Just don&#39;t read K&amp;R, it is extremely outdated and teaching you bad practice. There is never a reason why you would write some crap code like that. And the correct type for atof would be <code>double atof (const char* str);</code>, declared as a prototype at file scope."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1534324456, "post_id": 51852988, "comment_id": 90664139, "body": "Are you actually just wondering what type <code>dp</code> is in this case ? (it would be the same as if you just wrote <code>double *dp;</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1534313670, "creation_date": 1534313670, "answer_id": 51853782, "question_id": 51852988, "link": "https://stackoverflow.com/questions/51852988/how-does-c-compiler-interpret-declaring-function-and-variable-in-the-same-statem/51853782#51853782", "title": "How does c compiler interpret declaring function and variable in the same statement?", "body": "<p>In C, comma can function as an operator or a separator. In your case, it functions as a separator.</p>\n\n<p>If you go through the C grammar available online <a href=\"https://www.lysator.liu.se/c/ANSI-C-grammar-y.html\" rel=\"nofollow noreferrer\">here</a>, you will find many uses of comma as separator.\nOne of the uses is below:  </p>\n\n<pre><code>init_declarator_list\n    : init_declarator\n    | init_declarator_list ',' init_declarator\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1534324117, "last_edit_date": 1534324117, "creation_date": 1534323461, "answer_id": 51855745, "question_id": 51852988, "link": "https://stackoverflow.com/questions/51852988/how-does-c-compiler-interpret-declaring-function-and-variable-in-the-same-statem/51855745#51855745", "title": "How does c compiler interpret declaring function and variable in the same statement?", "body": "<p>The syntax for declarations (C17 6.7) is:</p>\n\n<pre><code>declaration:\n  declaration-specifiers init-declarator-list(opt) ;\n</code></pre>\n\n<p>where one case of <em>declaration-specifiers</em> is <em>type-specifier</em>, in this case <code>double</code>.</p>\n\n<p>Digging further into the <em>init-declarator-list</em> gives <em>init-declarator</em>, optionally several separated by comma:</p>\n\n<pre><code>init-declarator-list:\n  init-declarator\n  init-declarator-list , init-declarator\n</code></pre>\n\n<p><em>init_declarator</em> in turn gives <em>declarator</em>, which has the syntax (C17 6.7.6):</p>\n\n<pre><code>declarator:\n  pointer(opt) direct-declarator\n</code></pre>\n\n<p>In the example, <code>atof()</code> and <code>dp</code> are <em>direct-declarator</em>, where <code>dp</code> has the optional pointer syntax.</p>\n\n<p>This means that <code>atof()</code> ends up a function returning <code>double</code> and <code>*dp</code> a pointer to <code>double</code>.</p>\n\n<p>(If you want to dig through the raw syntax like above, Annex A of the standard is helpful. No sane person remembers things like this without looking them up.)</p>\n\n<hr>\n\n<p>But there is really no reason to ponder awfully written code like this. The following is widely recognized as bad practice:</p>\n\n<ul>\n<li>Writing function declarations anywhere else but as a line of its own, at file scope.</li>\n<li>Writing function declarations that do not have prototype format. The correct prototype for <code>atof</code> in standard C 7.22.1.1 is <code>double atof(const char *nptr);</code>. Whereas <code>double atof()</code> means a function taking any parameter. This is obsolete style as per C17 6.11.6.</li>\n<li>Writing multiple declarations at a single line. Don't write things like <code>double d, *dp;</code>, write <code>double d; double* dp;</code>. The former is known to cause bugs because of accidentally declaring the wrong type. As a bonus, if you always split the declarations, you don't have to ponder if it is more correct to write <code>double* dp</code> style or <code>double *dp</code> style.</li>\n</ul>\n\n<p>Summary: don't read obsolete programming books from the 1970s. The attempted K&amp;R update to C90 was sloppily made and a lot of the 2nd edition of the book is not up to date with 1989 years changes. For example the obsolete style was already there in C90 6.9.4. So the book contains practice that was already flagged obsolete by the C standard in the year 1989! Plain horrible.</p>\n"}], "owner": {"reputation": 71, "user_id": 6430796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604af860253807767cc17fa50cb25115?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/6430796/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 51855745, "answer_count": 2, "score": 1, "last_activity_date": 1534324232, "creation_date": 1534307521, "last_edit_date": 1534324232, "question_id": 51852988, "link": "https://stackoverflow.com/questions/51852988/how-does-c-compiler-interpret-declaring-function-and-variable-in-the-same-statem", "title": "How does c compiler interpret declaring function and variable in the same statement?", "body": "<p>I came across one of the declaration in K&amp;R, where a function and a variable are declared together in the 'Pointers' chapter:</p>\n\n<pre><code>double atof(), *dp;\n</code></pre>\n\n<p>How does a C compiler handle above declaration?</p>\n"}, {"tags": ["ios", "c", "unix", "broadcast", "unix-socket"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534369373, "post_id": 51852843, "comment_id": 90685743, "body": "when C library functions return an error indication, they also set <code>errno</code>.  The posted code tells the user NOTHING when the operation fails.  Strongly suggest using <code>perror()</code> when an error is indicated, That way your error message AND the text error message of why the system thinks the error occurred are output to <code>stderr</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534369562, "post_id": 51852843, "comment_id": 90685816, "body": "the posted code snippet is (probably) not the root of the problem.  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534369732, "post_id": 51852843, "comment_id": 90685875, "body": "suggest using the <code>keepalive</code> option so the socket does not &#39;close&#39; when the recv timeout has expired"}, {"owner": {"reputation": 21, "user_id": 8959319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb97c0b3b3039fb27d39f38256a3f415?s=128&d=identicon&r=PG&f=1", "display_name": "nobody47", "link": "https://stackoverflow.com/users/8959319/nobody47"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1536166965, "post_id": 51852843, "comment_id": 91330156, "body": "I simplified code and remove errors handling, just replaced it with -1 (no errors there anyway). It will be pretty hard to post complete example because there are three layers (("}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1536167662, "post_id": 51852843, "comment_id": 91330478, "body": "the &#39;simplification&#39; makes the code even more difficult to debug as the essential information is not available."}], "owner": {"reputation": 21, "user_id": 8959319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb97c0b3b3039fb27d39f38256a3f415?s=128&d=identicon&r=PG&f=1", "display_name": "nobody47", "link": "https://stackoverflow.com/users/8959319/nobody47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534308920, "creation_date": 1534306296, "last_edit_date": 1534308920, "question_id": 51852843, "link": "https://stackoverflow.com/questions/51852843/udp-socket-dont-recv-responses-on-broadcast-requests", "title": "UDP socket don&#39;t recv responses on broadcast requests", "body": "<p>I need to find out ip of some devices in local network in order to do that i send broadcast messages and wait for responses so, common way. All this happens on mobile devices: iOS or Android. This module is written in C.\nPseudocode:</p>\n\n<ol>\n<li>Open socket, configure</li>\n<li>Send broadcast request</li>\n<li>Receive responses</li>\n<li><p>Close socket.</p>\n\n<p>Problem is - when iOS device sleeps for some time and after that i run search, i see no responses. Broadcast messages are still goes to network (checked with Wireshark). Also, i suppose that searched devices are functional (because they can be found from other smartphones).\nProblem solves when i disconnect from current wi-fi and connect to it again.</p></li>\n</ol>\n\n<p>Here is socket options:</p>\n\n<pre><code>int setup_socket( void ) {\n    int sck = socket( AF_INET, SOCK_DGRAM, 0 );\n    if (sck &lt; 0)\n        return -1;\n\n    int bcast = 1;\n    if ( 0 &gt; setsockopt( sck, SOL_SOCKET, SO_BROADCAST, &amp;bcast, sizeof( bcast ) ) ) {\n        return -1;\n    }\n\n    struct timeval tv = {\n        .tv_sec = 0,\n        .tv_usec = 100 * 1000,\n    };\n\n    if ( 0 &gt; setsockopt( sck, SOL_SOCKET, SO_RCVTIMEO, &amp;tv, sizeof( tv ) ) ) {\n        return -1;\n    }\n\n    return sck;\n}\n</code></pre>\n\n<p>will be grateful for any ideas</p>\n"}, {"tags": ["c++", "c", "opengl", "glut"], "comments": [{"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1534314933, "post_id": 51852500, "comment_id": 90660337, "body": "see <a href=\"https://stackoverflow.com/a/38068390/2521214\">Procedural generation of stars with skybox</a> or use the real thing: <a href=\"https://stackoverflow.com/a/40171880/2521214\">swift sphere combine star data</a> you can use <b>BSC</b> (Bright star catalog), <b>Hipparcos</b> or what ever all the star catalogs are usually downloadable for free in ASCII formats. Also see <a href=\"https://stackoverflow.com/a/28020934/2521214\">Is it possible to make realistic n-body solar system simulation in matter of size and mass?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": false, "score": 7, "last_activity_date": 1534347196, "last_edit_date": 1534347196, "creation_date": 1534305262, "answer_id": 51852718, "question_id": 51852500, "link": "https://stackoverflow.com/questions/51852500/drawing-random-points-stars-using-opengl/51852718#51852718", "title": "Drawing random points/stars using OpenGL?", "body": "<p>Lots of wonkiness:</p>\n\n<ul>\n<li>Couple instances of unmatched glPushMatrix()/glPopMatrix() calls; avoid over-/under-flowing the matrix stack; I like to use extra scopes to visually indicate matrix stack nesting.</li>\n<li>Your point drawing was assuming an ortho projection while you only set a perspective one.</li>\n<li>You left lighting enabled while trying to draw your points, resulting in very dark points everywhere except the bottom-left.</li>\n<li>Your point drawing loop was duplicated for some reason; if you want double the stars adjust the for-loop end value instead of copy-pasting the loop.</li>\n<li>You should use <code>glutPostRedisplay()</code> in your idle callback instead of calling <code>display()</code> directly.</li>\n<li>Set your projection/modelview matrices each time through <code>display()</code> instead of setting them in a resize callback; helps reduce a source of mysterious matrix errors.  The default resize callback calls <code>glViewport()</code> for you so you don't have to worry about doing that.</li>\n<li>You're drawing the points (\"stars\"?) <em>after</em> the 3D spheres; I think the intent was to draw them before so they're \"underneath\".</li>\n<li>Unholy mishmash of code formatting; recommend something like <a href=\"https://clang.llvm.org/docs/ClangFormat.html\" rel=\"noreferrer\"><code>clang-format</code></a> to keep that in check.</li>\n<li>If you're using FreeGLUT on Windows (which you ought to be; it's really the only maintained GLUT implementation left) you don't need the <code>#include &lt;Windows.h&gt;</code>.</li>\n<li>Recommend using a timer callback instead of an idle callback to update your simulation/animation.  Without vsync that idle callback will be called <em>incredibly</em> often.  With a timer callback you can simulate the even ~16 millisecond frames a vsync'd system will give you.</li>\n</ul>\n\n<p>All together:</p>\n\n<p><a href=\"https://i.stack.imgur.com/N3ZCT.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/N3ZCT.gif\" alt=\"screen capture\"></a>\n<br></p>\n\n<pre><code>#include &lt;GL/glut.h&gt;\n#include &lt;cmath&gt;\n\nGLfloat xRotated, yRotated, zRotated;\nGLdouble radius = 3;\n\nvoid timer( int value )\n{\n    if( zRotated &gt; 360.0 )\n    {\n        zRotated -= 360.0 * floor( zRotated / 360.0 ); // Don't allow overflow\n    }\n\n    if( yRotated &gt; 360.0 )\n    {\n        yRotated -= 360.0 * floor( yRotated / 360.0 ); // Don't allow overflow\n    }\n\n    zRotated += 5.0;\n    yRotated += 1.0;\n\n    glutTimerFunc( 16, timer, 0 );\n    glutPostRedisplay();\n}\n\nvoid display()\n{\n    glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );\n\n    glDepthMask( GL_FALSE );\n    glDisable( GL_DEPTH_TEST );\n    glDisable( GL_LIGHTING );\n\n    // 2D rendering\n    glMatrixMode( GL_PROJECTION );\n    glLoadIdentity();\n    glOrtho( 0, 640, 0, 480, -1, 1 );\n    glMatrixMode( GL_MODELVIEW );\n    glLoadIdentity();\n\n    glPushMatrix();\n    {\n        glColor3f( 1.0, 1.0, 1.0 );\n        glPointSize( 3 );\n        glBegin( GL_POINTS );\n        for( int i = 1; i &lt; 100; i++ )\n        {\n            int x = rand() % 640;\n            int y = rand() % 480;\n            glVertex2i( x, y );\n        }\n        glEnd();\n    }\n    glPopMatrix();\n\n\n    glDepthMask( GL_TRUE );\n    glEnable( GL_DEPTH_TEST );\n\n    // Enable lighting\n    glEnable( GL_LIGHTING );\n    glEnable( GL_LIGHT0 );\n    GLfloat qaSpecularLight[] = {1.0, 1.0, 1.0, 1.0};\n    glLightfv( GL_LIGHT0, GL_SPECULAR, qaSpecularLight );\n\n    // 3D rendering\n    glMatrixMode( GL_PROJECTION );\n    glLoadIdentity();\n    double w = glutGet( GLUT_WINDOW_WIDTH );\n    double h = glutGet( GLUT_WINDOW_HEIGHT );\n    gluPerspective( 20.0, w / h, 0.1, 80.0 );\n    glMatrixMode( GL_MODELVIEW );\n    glLoadIdentity();\n    glTranslatef( 0.0, 0.0, -40.0 );\n\n    glPushMatrix();\n    {\n        glutSolidSphere( radius, 25, 25 );\n    }\n    glPopMatrix();\n\n    glPushMatrix();\n    {\n        glRotatef( yRotated, 0.0, 2.0, 0.0 );\n        glTranslatef( 5.0, 0.0, 0.0 );\n        GLfloat qaLightPosition[] = {1, 1, 1, 1};\n        glLightfv( GL_LIGHT0, GL_POSITION, qaLightPosition );\n        GLfloat emitLight[] = {0.9, 0.9, 0.9, 0.9};\n        glMaterialfv( GL_FRONT_AND_BACK, GL_EMISSION, emitLight ); // Make sphere glow (emissive)\n        glutSolidSphere( radius / 6, 25, 25 );\n        GLfloat Noemit[] = {0.0, 0.0, 0.0, 1.0};\n        glMaterialfv( GL_FRONT_AND_BACK, GL_EMISSION, Noemit );\n    }\n    glPopMatrix();\n\n    glutSwapBuffers();\n}\n\nint main( int argc, char** argv )\n{\n    glutInit( &amp;argc, argv );\n    glutInitDisplayMode( GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH );\n    glutInitWindowSize( 1000, 600 );\n    glutCreateWindow( \"Project_KD\" );\n\n    xRotated = yRotated = zRotated = 0.0;\n\n    glutDisplayFunc( display );\n    glutTimerFunc( 0, timer, 0 );\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9985177, "user_type": "registered", "profile_image": "https://graph.facebook.com/2459600750732739/picture?type=large", "display_name": "Didarul Amin", "link": "https://stackoverflow.com/users/9985177/didarul-amin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1755, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1534350602, "creation_date": 1534303185, "last_edit_date": 1534350602, "question_id": 51852500, "link": "https://stackoverflow.com/questions/51852500/drawing-random-points-stars-using-opengl", "title": "Drawing random points/stars using OpenGL?", "body": "<p>I am trying to draw some random points as the star in the window, \nbut points are not showing. But others objects are showing correctly.</p>\n\n<p>My source code:</p>\n\n<pre><code>#include&lt;windows.h&gt;\n#include &lt;GL\\glut.h&gt;\n#include &lt;math.h&gt;      // For math routines (such as sqrt &amp; trig).\nGLfloat xRotated, yRotated, zRotated;\nGLdouble  radius=3;\n\nGLfloat qaBlack[] = {0.0, 0.0, 0.0, 1.0}; //Black Color\nGLfloat qaGreen[] = {0.0, 1.0, 0.0, 1.0}; //Green Color\nGLfloat qaWhite[] = {1.0, 1.0, 1.0, 1.0}; //White Color\nGLfloat qaRed[] = {1.0, 0.0, 0.0, 1.0}; //Red Color\n\n// Set lighting intensity and color\n\nGLfloat qaSpecularLight[]    = {1.0, 1.0, 1.0, 1.0};\nGLfloat emitLight[] = {0.9, 0.9, 0.9, 0.9};\nGLfloat Noemit[] = {0.0, 0.0, 0.0, 1.0};\n\n// Light source position\n\nGLfloat qaLightPosition[] = {1, 1, 1, 1};\n\nvoid display(void);\nvoid reshape(int x, int y);\n\nvoid idleFunc(void)\n{\n    if ( zRotated &gt; 360.0 ) {\n        zRotated -= 360.0*floor(zRotated/360.0);   // Don't allow overflow\n      }\n\n    if ( yRotated &gt; 360.0 ) {\n        yRotated -= 360.0*floor(yRotated/360.0);   // Don't allow overflow\n      }\n    zRotated += 0.05;\n    yRotated +=0.01;\n\n    display();\n}\n\nvoid initLighting()\n{\n\n    // Enable lighting\n    glEnable(GL_LIGHTING);\n    glEnable(GL_LIGHT0);\n\n    glLightfv(GL_LIGHT0, GL_SPECULAR, qaSpecularLight);\n\n}\n\n\n\n\nvoid display(void){\n\n\n\n\n\n\n    glMatrixMode(GL_MODELVIEW);\n    // clear the drawing buffer.\n     glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);\n    // clear the identity matrix.\n    glLoadIdentity();\n\n\n\n    glTranslatef(0.0,0.0,-40.0);\n\n    glPushMatrix();\n\n    glutSolidSphere(radius,25,25);\n\n    glPopMatrix();\n\n\n\n    glPopMatrix();\n\n\n    glPushMatrix();\n\n    glRotatef(yRotated,0.0,2.0,0.0);\n    glTranslatef(5.0,0.0,0.0);\n\n    // Set the light position\n    glLightfv(GL_LIGHT0, GL_POSITION, qaLightPosition);\n    glMaterialfv(GL_FRONT_AND_BACK, GL_EMISSION, emitLight);   // Make sphere glow (emissive)\n    glutSolidSphere(radius/6,25,25);\n    glMaterialfv(GL_FRONT_AND_BACK, GL_EMISSION, Noemit);\n\n    glPopMatrix();\n\n    glTranslatef(0.0,0.0,0.0);\n\n\n    glPushMatrix();\n\n    glColor3f(1.0, 1.0, 1.0);\n    glPointSize(3);\n    for(int i=1;i&lt;100;i++){\n         int x = rand()%640 ;\n       int  y = rand()%480;\n        glBegin(GL_POINTS);\n        glVertex2i (x,y);\n    glEnd();\n    }\n\n    glPopMatrix();\n\n    glLoadIdentity();\n\n    glColor3f(1.0, 1.0, 1.0);\n    glPointSize(3);\n    for(int i=1;i&lt;100;i++){\nint          x = rand()%640 ;\n    int     y = rand()%480;\n        glBegin(GL_POINTS);\n        glVertex2i (x,y);\n    glEnd();\n    }\n\n\n    glFlush(); //FOR RENDERING\n    glutSwapBuffers();\n}\n\nvoid reshape(int x, int y){\n    if(y == 0 || x == 0) return;\n    glMatrixMode(GL_PROJECTION);\n\n    gluPerspective(20.0,(GLdouble)x/(GLdouble)y,0.6,40.0);\n    glMatrixMode(GL_MODELVIEW);\n    glViewport(0,0,x,y);  //Use the whole window for rendering\n}\n\n\nint main (int argc, char **argv)\n{\n    glutInit(&amp;argc, argv);\n    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH );\n    glutInitWindowSize(1000,600);\n    glutCreateWindow(\"Project_KD\");\n    initLighting();\n\n    xRotated = yRotated = zRotated = 0.0;\n\n    glutIdleFunc(idleFunc);\n    glutDisplayFunc(display);\n    glutReshapeFunc(reshape);\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c", "gcc", "clang", "pycparser"], "answers": [{"tags": [], "owner": {"reputation": 4957, "user_id": 2230844, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1b0e722a4823f29c56d7a97bc6500ccc?s=128&d=identicon&r=PG", "display_name": "denfromufa", "link": "https://stackoverflow.com/users/2230844/denfromufa"}, "is_accepted": true, "score": 0, "last_activity_date": 1534366818, "creation_date": 1534366818, "answer_id": 51866365, "question_id": 51852304, "link": "https://stackoverflow.com/questions/51852304/clang-pycparser-fail-to-parse-pythread-h-header-from-cpython-3-7/51866365#51866365", "title": "Clang + pycparser fail to parse pythread.h header from CPython 3.7", "body": "<p>This is now fixed, like Eli B. suggested it was a missing <code>#define</code> to the compiler:</p>\n\n<p><a href=\"https://github.com/pythonnet/pythonnet/blob/py37/tools/geninterop/geninterop.py#L177\" rel=\"nofollow noreferrer\">https://github.com/pythonnet/pythonnet/blob/py37/tools/geninterop/geninterop.py#L177</a></p>\n\n<p><code>\"-D _POSIX_THREADS\"</code></p>\n"}], "owner": {"reputation": 4957, "user_id": 2230844, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1b0e722a4823f29c56d7a97bc6500ccc?s=128&d=identicon&r=PG", "display_name": "denfromufa", "link": "https://stackoverflow.com/users/2230844/denfromufa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 51866365, "answer_count": 1, "score": 1, "last_activity_date": 1534366818, "creation_date": 1534301433, "last_edit_date": 1534354602, "question_id": 51852304, "link": "https://stackoverflow.com/questions/51852304/clang-pycparser-fail-to-parse-pythread-h-header-from-cpython-3-7", "title": "Clang + pycparser fail to parse pythread.h header from CPython 3.7", "body": "<p><code>Clang</code> + <code>pycparser</code> fail to parse <code>pythread.h</code> header from CPython 3.7, but this was working in CPython 3.7-dev in Travis CI.</p>\n\n<pre><code>opt/python/3.7.0/include/python3.7m/pythread.h:122:5: error: \"Require native\n      threads. See https://bugs.python.org/issue31370\"\n#   error \"Require native threads. See https://bugs.python.org/issue31370\"\n</code></pre>\n\n<p>It is not obvious whether I should try <code>gcc</code> instead of <code>clang</code>, pass specific threading flags to compiler or extend pycparser with additional \"faked\" libc headers due to code not compliant with C99?</p>\n\n<p>More details in this issue:</p>\n\n<p><a href=\"https://github.com/pythonnet/pythonnet/issues/609#issuecomment-412959577\" rel=\"nofollow noreferrer\">https://github.com/pythonnet/pythonnet/issues/609#issuecomment-412959577</a></p>\n"}, {"tags": ["c", "gcc", "inline"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1534300423, "post_id": 51852105, "comment_id": 90657061, "body": "The compiler decided to use the external definition (since it is free to do so). But you did not provide one. And it&#39;s <code>int main(void)</code>, not <code>void main(void)</code>."}, {"owner": {"reputation": 1467, "user_id": 6353012, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1048600055206169/picture?type=large", "display_name": "Brij Raj Kishore", "link": "https://stackoverflow.com/users/6353012/brij-raj-kishore"}, "edited": false, "score": 0, "creation_date": 1534300659, "post_id": 51852105, "comment_id": 90657097, "body": "gcc -std=gnu89 inline.c Compiles fine with this"}], "owner": {"reputation": 3, "user_id": 9404680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0eb8f0d1ab5b8ab8dc9fcf50ac397d?s=128&d=identicon&r=PG&f=1", "display_name": "standin000", "link": "https://stackoverflow.com/users/9404680/standin000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "closed_date": 1534300592, "answer_count": 0, "score": 0, "last_activity_date": 1534300035, "creation_date": 1534299772, "last_edit_date": 1534300035, "question_id": 51852105, "link": "https://stackoverflow.com/questions/51852105/inline-declaration-and-definition-confuse-gcc", "closed_reason": "Duplicate", "title": "inline declaration and definition confuse gcc?", "body": "<p>normally one function should have declaration and definition, but i have code like this</p>\n\n<pre><code>inline int test(void);\nvoid main(void)\n{\n    test();\n}\ninline int test(void)\n{\n    return 1;\n}\n\ngcc test.c\n/tmp/ccQffhMo.o: In function `main':\ntest.c:(.text+0x5): undefined reference to `test'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>when I remove declaration line or inline keyword, no error.</p>\n\n<p>why is it, and how to ignore it by give some option to gcc?</p>\n"}, {"tags": ["c", "gcc", "clang"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1534299902, "post_id": 51851848, "comment_id": 90656965, "body": "@M.M then where would the declarations be?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1534303109, "post_id": 51851848, "comment_id": 90657569, "body": "@M.M: A test at godbolt.com gives different messages depending on whether <code>b</code> is declared in <code>foo</code> or not. I suspect the particular cause of the message OP sees is that a function identifier always refers to the same function in a module, so the <code>b</code> in <code>bar</code> <b>must</b> refer to the same <code>b</code> as in <code>foo</code>, but its declaration is out of scope, whereas <code>a</code> could refer to a different object."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1534306394, "post_id": 51851848, "comment_id": 90658227, "body": "@EricPostpischil you&#39;re right - I thought the declaration of <code>b</code> in <code>foo</code> didn&#39;t matter if it wasn&#39;t actually called, since the declaration went out of scope,  but in fact it does matter"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 4493404, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e3b857bb8128b2df58f74983e46fc5cc?s=128&d=identicon&r=PG&f=1", "display_name": "noinput", "link": "https://stackoverflow.com/users/4493404/noinput"}, "edited": false, "score": 0, "creation_date": 1534302643, "post_id": 51852074, "comment_id": 90657491, "body": "Thank you, gcc&#39;s diagnostic messages seem more clear to me."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534303199, "post_id": 51852074, "comment_id": 90657583, "body": "A test at godbolt.com gives different messages depending on whether <code>b</code> is declared in <code>foo</code> or not. I suspect the particular cause of the message OP sees is that a function identifier always refers to the same function in a module, so the <code>b</code> in <code>bar</code> <b>must</b> refer to the same <code>b</code> as in <code>foo</code>, but its declaration is out of scope, whereas <code>a</code> could refer to a different object."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 5, "last_activity_date": 1534300072, "last_edit_date": 1534300072, "creation_date": 1534299518, "answer_id": 51852074, "question_id": 51851848, "link": "https://stackoverflow.com/questions/51851848/use-of-out-of-scope-declaration/51852074#51852074", "title": "use of out-of-scope declaration", "body": "<p>This is because of the vestigial feature of <em>implicit declaration</em> of functions.  If you had just</p>\n\n<pre><code>void bar()\n{\n    b(9);    \n}\n</code></pre>\n\n<p>that would actually be 100% valid <em>pre-standard</em> C (well, except that <code>void</code> didn't exist back then, but that's not important right now) equivalent to writing</p>\n\n<pre><code>void bar()\n{\n    extern int b();\n    b(9);    \n}\n</code></pre>\n\n<p>(Remember that an empty parameter list in a function declaration does <em>not</em> mean that the function takes zero arguments.  It means the function takes an <em>unspecified number</em> of arguments.)</p>\n\n<p>Now, when you have</p>\n\n<pre><code>void foo()\n{\n    extern void b(int);\n}\n\nvoid bar()\n{\n    b(9);\n}\n</code></pre>\n\n<p>the implicit declaration means it's like you wrote</p>\n\n<pre><code>void foo()\n{\n    extern void b(int);\n}\n\nvoid bar()\n{\n    extern int b();\n    b(9);\n}\n</code></pre>\n\n<p>The two declarations of the external symbol <code>b</code> are not compatible.  If they were both visible in the scope of <code>bar</code>, this would be a constraint violation (\"X is a constraint violation\" is the closest the C standard ever comes to saying \"a program that does X is invalid and the compiler must reject it\").  But they're not, so instead, the program's meaning is undefined.  clang seems to have decided to apply the declaration from the <code>foo</code> scope but also warn you about it, which seems fair to me.  gcc does treat it as an error:</p>\n\n<pre><code>test.c:6:5: error: incompatible implicit declaration of function \u2018b\u2019\n     b(9);\n     ^\ntest.c:2:17: note: previous implicit declaration of \u2018b\u2019 was here\n     extern void b(int);\n                 ^\n</code></pre>\n\n<p>(\"previous implicit declaration\" is not quite right, but that is also not important right now.)</p>\n\n<p>You can probably see how this sort of thing could lead to hard-to-find bugs, which is why modern best practice is to declare stuff with external linkage <em>only</em> at file scope, and to declare all functions with full prototypes.</p>\n\n<p>Only functions are ever implicitly declared, which is why <code>a</code> gave a hard error; in your original example, <code>a</code> is completely invisible to <code>bar</code>.  (Note that if you had redeclared it with a different type, that would also make the program's meaning undefined.)</p>\n"}], "owner": {"reputation": 391, "user_id": 4493404, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e3b857bb8128b2df58f74983e46fc5cc?s=128&d=identicon&r=PG&f=1", "display_name": "noinput", "link": "https://stackoverflow.com/users/4493404/noinput"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1534305284, "creation_date": 1534297415, "last_edit_date": 1534305284, "question_id": 51851848, "link": "https://stackoverflow.com/questions/51851848/use-of-out-of-scope-declaration", "title": "use of out-of-scope declaration", "body": "<p>Code:</p>\n\n<pre><code>void foo() {\n    extern int a;\n    extern void b(int);\n}\n\nvoid bar() {\n    b(9); // ok, warning: use of out-of-scope declaration of 'b'\n    a=9; // error: use of undeclared identifier 'a'\n}\n</code></pre>\n\n<p>Why the compiler doesn't just give a warning like <code>use of out-of-scope declaration of 'a'</code>?</p>\n"}, {"tags": ["c", "parameters", "reference", "prototype"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534292264, "post_id": 51851168, "comment_id": 90655675, "body": "As a reference, the C11 spec for <code>qsort()</code> uses <code>void qsort(void *base, size_t nmemb, size_t size, int (*compar)(const void *, const void *));</code>.  Closer  to the <code>int (*f)(int,int)</code>.  Interestingly <code>qsort_s()</code> uses <i>named</i> parameters <code>..., int (*compar)(const void *x, const void *y, void *context), ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1534294451, "post_id": 51851282, "comment_id": 90656004, "body": "This is not exactly true.  The identifier of a function has type &quot;function returning void&quot; or &quot;function returning &lt;some type&gt;&quot;, not <i>pointer to</i> one of those.  But such an identifier is <i>converted to</i> a function pointer in moist contexts.  This is in many ways analogous to arrays, including that one of the places where you can see a difference is the <code>sizeof</code> operator.  It is a constraint violation to apply <code>sizeof</code> to an expression of function type, but you can apply it freely to function pointers."}], "tags": [], "owner": {"reputation": 2107, "user_id": 7451787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lNcOE.jpg?s=128&g=1", "display_name": "bcperth", "link": "https://stackoverflow.com/users/7451787/bcperth"}, "is_accepted": false, "score": 0, "last_activity_date": 1534456148, "last_edit_date": 1534456148, "creation_date": 1534291887, "answer_id": 51851282, "question_id": 51851168, "link": "https://stackoverflow.com/questions/51851168/function-reference-parameter-pointer-vs-prototype-merely-style/51851282#51851282", "title": "Function-reference parameter: pointer vs prototype merely style?", "body": "<p>The name of a function <code>f</code> IS a pointer to function <code>f</code>. ie the compiler treats them identically.  You can use the 2 forms interchangeably, in the context of your questions.</p>\n\n<p>However, in the interest of completeness, see the exceptions in cases of <code>sizeof</code> operator, the _<code>Alignof</code> operator,65) and the <code>unary &amp;</code> as correctly pointed out in Jonathan Leffler's most complete answer.</p>\n\n<p>Both of your statements say:\ng is a function returning int, whose parameter is a pointer to a function f returning int whose parameters and int, int.</p>\n"}, {"comments": [{"owner": {"reputation": 2107, "user_id": 7451787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lNcOE.jpg?s=128&g=1", "display_name": "bcperth", "link": "https://stackoverflow.com/users/7451787/bcperth"}, "edited": false, "score": 0, "creation_date": 1534294313, "post_id": 51851306, "comment_id": 90655986, "body": "..and if we are talking &quot;ancient practice&quot; my K&amp;R Ref Manual (1978) para 14.2 states &quot;If the name of a function appears in an expression ... a pointer to the function is generated&quot; :-)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534303623, "post_id": 51851306, "comment_id": 90657672, "body": "\u201cThe standard\u201d is now C 2018, not C11, and I suspect the text you cite is altered, as <code>_Alignof</code> cannot grammatically be applied to a function identifier."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534307219, "post_id": 51851306, "comment_id": 90658417, "body": "@EricPostpischil:Yes, but the link is to the C11 standard.  I can&#39;t justify the spending preposterous price of the C18 standard \u2014 maybe I should start a GoFundMe campaign?  I&#39;m quoting the standard I identify.  When there&#39;s an online version of C18, I&#39;ll link to that instead."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534308680, "post_id": 51851306, "comment_id": 90658748, "body": "@JonathanLeffler: <a href=\"https://stackoverflow.com/a/83763/298225\">This answer</a> is updated with the current standards and drafts, including a link to a draft for C 2018 which shows that, indeed, this text is changed. I am sympathetic to the cost issues for students and amateurs. I also support using appropriate versions of the standard or using non-standard behavior for questions for which that is suitable, going agains the prevailing current in Stack Overflow. However, the description for the C tag favors using the latest standard, and so does the community generally\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534308760, "post_id": 51851306, "comment_id": 90658767, "body": "\u2026 and moving along with the standard as versions are published helps to support the purposes of standardization. The more people are using the latest version, the more compiler developers will be inclined to conform to it, so improvements in portability, new features, quality of conformance will tend to come sooner."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534309871, "post_id": 51851306, "comment_id": 90659012, "body": "Why is the PDF draft not acceptable? Hyperlinks are nice for direct references but are not crittical, and I do not find documents segmented for the web conducive to reading and learning."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1534310188, "post_id": 51851306, "comment_id": 90659097, "body": "C18 seems to be counterproductive for those working with the huge existing C99 + POSIX.1 codebase. It seems the C standard is being pushed in an odd direction, as if some of those working on the standard wish for C to include some, but not all necessary parts of POSIX.1 to be practically functional. None of the non-Windows C programmers I&#39;ve talked to seem to be keen on jumping on C18; most seem to be, like myself, using C99 plus POSIX.1 plus a small subset of C11. It is a pity you std devs don&#39;t listen to the developer community."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1534311645, "post_id": 51851306, "comment_id": 90659425, "body": "@NominalAnimal: I do not know who the \u201cyou\u201d you are addressing is; I did not participate in the C standard process. C is largely mature, but, generally, standards meetings are accessible to the public, and individuals can participate iin variouus ways. If you have issues that matter to you, you should be participating."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534313541, "post_id": 51851306, "comment_id": 90659869, "body": "@EricPostpischil: From your comments I assumed you were one of those paid to work on the C standard; I apologise.  No, the committee is stuffed with company representatives, and non-big-money affiliated individuals have approximately 0.0% chance of affecting any decision.  (It&#39;s not just companies, though; it seems that committees just don&#39;t work. Even Linux kernel devs have issues with GCC developers when GCC generates stupid code because the standard says they&#39;re allowed to, even when there is a clear practical reason to provide sane behaviour.)"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 4, "last_activity_date": 1534461811, "last_edit_date": 1592644375, "creation_date": 1534292138, "answer_id": 51851306, "question_id": 51851168, "link": "https://stackoverflow.com/questions/51851168/function-reference-parameter-pointer-vs-prototype-merely-style/51851306#51851306", "title": "Function-reference parameter: pointer vs prototype merely style?", "body": "<p>I suppose it is style, but the explicit pointer to function notation aligns with ancient practice and with the way the compiler interprets the code.</p>\n<p>The C11<sup><strong><code>*</code></strong></sup> standard says in <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.7.6.3p8\" rel=\"nofollow noreferrer\">\u00a76.7.6.3 Function declarators (including prototypes) \u00b68</a>:</p>\n<blockquote>\n<p>\u00b68 A declaration of a parameter as &quot;function returning type&quot; shall be adjusted to &quot;pointer to function returning type&quot;, as in 6.3.2.1.</p>\n</blockquote>\n<p>And <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.3.2.1\" rel=\"nofollow noreferrer\">\u00a76.3.2.1 Lvalues, arrays and function designators \u00b64</a> says:</p>\n<blockquote>\n<p>\u00b64 A function designator is an expression that has function type. Except when it is the operand of the <code>sizeof</code> operator, the <code>_Alignof</code> operator,<sup>65)</sup> or the unary <code>&amp;</code> operator, a function designator with type &quot;function returning type&quot; is converted to an expression that has type &quot;pointer to function returning type&quot;.</p>\n<p><sup>65)</sup> Because this conversion does not occur, the operand of the <code>sizeof</code> or <code>_Alignof</code> operator remains a function designator and violates the constraints in 6.5.3.4.</p>\n</blockquote>\n<p>Using the pointer notation, therefore, shows explicitly what the compiler will do anyway.  (I still usually invoke explicit pointers to functions using the <code>(*function_ptr)(arg1, \u2026, argN)</code> notation, even though <code>function_ptr(arg1, \u2026, argN)</code> also works.)</p>\n<hr>\n<p><sup><strong><code>*</code></strong> The C18 standard is current, but there isn't a convenient online HTML version of it available as yet.  Mostly, the two are very similar. As it happens, \u00a76.3.2.1 \u00b64 is one paragraph with a difference \u2014 the C18 version doesn't mention <code>_Alignof</code>.</sup></p>\n"}], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 51851306, "answer_count": 2, "score": 2, "last_activity_date": 1534461811, "creation_date": 1534290723, "last_edit_date": 1534293920, "question_id": 51851168, "link": "https://stackoverflow.com/questions/51851168/function-reference-parameter-pointer-vs-prototype-merely-style", "title": "Function-reference parameter: pointer vs prototype merely style?", "body": "<p>Is it purely style that you can declare a function-reference parameter like,</p>\n\n<pre><code>int g ( int (*f)(int,int) ) {\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>int g ( int f(int,int) ) {\n</code></pre>\n\n<p>In my limited experience with C, I've never seen the prototype-method.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1534289796, "post_id": 51851023, "comment_id": 90655242, "body": "It doesn&#39;t make sense to ask for the size of the array when you already know it.  It has 5 elements, be sure to type &quot;5&quot; instead of &quot;10&quot;.  Don&#39;t ask, or realloc()."}, {"owner": {"reputation": 47, "user_id": 9172640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e4c7ab4762d7d1d82eae80d5e3e02d?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewM", "link": "https://stackoverflow.com/users/9172640/andrewm"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1534289946, "post_id": 51851023, "comment_id": 90655271, "body": "You are right. it is a preparation for dynamic array. (IF it makes sense). and I did press 5..."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1534290210, "post_id": 51851023, "comment_id": 90655326, "body": "<code>arr[i+1]</code> goes out of bounds on the last iteration of the loop, and in the return statement."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9172640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e4c7ab4762d7d1d82eae80d5e3e02d?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewM", "link": "https://stackoverflow.com/users/9172640/andrewm"}, "edited": false, "score": 0, "creation_date": 1534291337, "post_id": 51851096, "comment_id": 90655514, "body": "I really appreciate your help! but why return arr[size-1]?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 47, "user_id": 9172640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e4c7ab4762d7d1d82eae80d5e3e02d?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewM", "link": "https://stackoverflow.com/users/9172640/andrewm"}, "edited": false, "score": 0, "creation_date": 1534292637, "post_id": 51851096, "comment_id": 90655737, "body": "@AndrewM To avoid &quot;bleeding&quot; the value of <code>i</code> to outside the scope of the loop."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1534290154, "creation_date": 1534290154, "answer_id": 51851096, "question_id": 51851023, "link": "https://stackoverflow.com/questions/51851023/how-can-i-manipulate-an-array/51851096#51851096", "title": "How can I manipulate an Array?", "body": "<p>You have several mistakes in your code:</p>\n\n<ul>\n<li>You need to stop the summing loop once <code>i+1</code> reaches the end of the array</li>\n<li>Your code knows the size; there is no need to read it from end-user</li>\n<li>You need to print the value of <code>res</code> once, rather than printing it in a loop</li>\n<li>You should consider moving the printing portion of the program into <code>main</code> from <code>sumArray</code>.</li>\n</ul>\n\n<p>The modifications are very straightforward:</p>\n\n<pre><code>int sumArr(int *arr, int size) {\n    // Stop when i+1 reaches size; no printing\n    for (int i = 0; i+1 &lt; size; i++) {\n        arr[i+1]+= arr[i];\n    }\n    return arr[size-1];\n}\n</code></pre>\n\n<p>Printing in the <code>main</code>:</p>\n\n<pre><code>printf(\"sum=%d\\n\", res);\nfor (int i = 0; i &lt; size; i++) {\n    printf(\"arr[%d] = %d\\n\", i, arr[i]);\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/5Do9bT\" rel=\"nofollow noreferrer\">Demo.</a></p>\n"}], "owner": {"reputation": 47, "user_id": 9172640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e4c7ab4762d7d1d82eae80d5e3e02d?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewM", "link": "https://stackoverflow.com/users/9172640/andrewm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 51851096, "answer_count": 1, "score": 1, "last_activity_date": 1534290154, "creation_date": 1534289451, "last_edit_date": 1534289730, "question_id": 51851023, "link": "https://stackoverflow.com/questions/51851023/how-can-i-manipulate-an-array", "title": "How can I manipulate an Array?", "body": "<p>I have an array </p>\n\n<pre><code>arr[]={7,5,-8,3,4};\n</code></pre>\n\n<p>And I have to update the same array to </p>\n\n<pre><code>arr[]={7,12,4,7,11};\n</code></pre>\n\n<p>my code:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint sumArr(int *arr, int size);\n\nvoid main()\n{\n\n    int arr[] = { 7,5,-8,3,4 };\n    int i, size, res = 0;\n\n    printf(\"Enter Size Of The Array:\");\n    scanf(\"%d\", &amp;size);\n\n    res = sumArr(arr, size);\n\n    for (i = 0; i &lt; size; i++)\n    {\n        printf(\"%d\\n\", res);\n    }\n\n  }\n\n\nint sumArr(int *arr, int size)\n{\n\n        int i;\n\n    for (i = 0; i &lt; size; i++)\n    {\n      arr[i+1]+= arr[i];\n\n        printf(\"  %d  \\n\", arr[i + 1]);\n    }\n\n    return arr[i+1];\n}\n</code></pre>\n\n<p>The output should be:  <code>7,12,4,7,11</code>\nBut in my code, the output is:   <code>12,4,7,11,-858993449,58196502,58196502,58196502,58196502,58196502</code></p>\n\n<p>Any hints?\nI can use auxiliary functions for input and output arrays, will it help?</p>\n"}, {"tags": ["c", "matlab", "gpu", "mex", "magma"], "comments": [{"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1534319614, "post_id": 51850955, "comment_id": 90662084, "body": "where does it segfault?"}, {"owner": {"reputation": 917, "user_id": 3211420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c3256dce4a0895b12db4105b90ea556?s=128&d=identicon&r=PG&f=1", "display_name": "avgn", "link": "https://stackoverflow.com/users/3211420/avgn"}, "reply_to_user": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1534343555, "post_id": 51850955, "comment_id": 90673699, "body": "The seg-fault happens on calling magma_zgetrf_gpu. If both magma_zgetrf_gpu and magma_zgetri_gpu calls are commented, the MEXed code runs fine, and simply returning the unchanged input matrix to LHS."}, {"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1534343677, "post_id": 51850955, "comment_id": 90673776, "body": "Try to print some of the values using <code>mexPrintf</code> before those calls. The most likely scenario is some wrong type has been passed to one of those input variables. Print 1 element of them, and  see which print gives the segfault (or prints garbage)."}, {"owner": {"reputation": 917, "user_id": 3211420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c3256dce4a0895b12db4105b90ea556?s=128&d=identicon&r=PG&f=1", "display_name": "avgn", "link": "https://stackoverflow.com/users/3211420/avgn"}, "reply_to_user": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1534380127, "post_id": 51850955, "comment_id": 90688221, "body": "I&#39;ve tried that actually at each stage. Every single argument is correct. In fact, if I don&#39;t call those 2 functions, the matrix goes from prhs -&gt; host memory convert from matlab to interleaved-&gt; gpu memory -&gt; host memory convert from interleaved to matlab -&gt; plhs. successfully. I&#39;m really stumped! and I need this code!"}, {"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1534409046, "post_id": 51850955, "comment_id": 90697391, "body": "There must be a difference, otherwise the function would do the same thing in the C and mex versions. Once bruteforce debugging method is to create a function that would save all variables to a text file just before the <code>magma_zgetrf_gpu</code> call. Use the exact same function for both versions, and save all the input variables. Then try to see what is wrong. But if all is the same, the same behavior is expected, ultimately, computers are deterministic.,"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1534458170, "post_id": 51850955, "comment_id": 90723635, "body": "There might be a conflict between CUDA version used by MATLAB and your MEX-file."}], "answers": [{"tags": [], "owner": {"reputation": 917, "user_id": 3211420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c3256dce4a0895b12db4105b90ea556?s=128&d=identicon&r=PG&f=1", "display_name": "avgn", "link": "https://stackoverflow.com/users/3211420/avgn"}, "is_accepted": true, "score": 1, "last_activity_date": 1536464063, "last_edit_date": 1536464063, "creation_date": 1536458969, "answer_id": 52240778, "question_id": 51850955, "link": "https://stackoverflow.com/questions/51850955/why-does-this-mexed-c-magma-code-seg-fault-while-the-stand-alone-c-code-works/52240778#52240778", "title": "Why does this MEXed C/magma code seg-fault while the stand alone C code works?", "body": "<p>My sys admin has figured out why the standalone C code works while the mexed C code does not. I'll post the reason here incase it is helpful to anyone facing the same issues when using Magma from within Matlab. </p>\n\n<ol>\n<li><p>The version of Matlab I was using was 2014a. The <a href=\"https://www.mathworks.com/content/dam/mathworks/mathworks-dot-com/support/sysreq/files/SystemRequirements-Release2014a_SupportedCompilers.pdf\" rel=\"nofollow noreferrer\">supported compiler</a> for this version is 4.7.x. I was using a higher version of gcc to compile the code. I've never had a problem with using different versions of GCC with matlab, despite the warning it gives, but for the above code it does matter. </p></li>\n<li><p><a href=\"http://icl.cs.utk.edu/magma/forum/viewtopic.php?f=2&amp;t=1795&amp;sid=5064af995de123e00989fdcf215e8bc7\" rel=\"nofollow noreferrer\">Compile with the <code>MKL_ilp64</code> flag when using Magma with Matlab</a> to ensure that magma_int_t is int64. </p></li>\n</ol>\n\n<p>With these two suggestions, Magma can be mexed into matlab with no problems. </p>\n"}], "owner": {"reputation": 917, "user_id": 3211420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c3256dce4a0895b12db4105b90ea556?s=128&d=identicon&r=PG&f=1", "display_name": "avgn", "link": "https://stackoverflow.com/users/3211420/avgn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 52240778, "answer_count": 1, "score": 1, "last_activity_date": 1536464063, "creation_date": 1534288887, "last_edit_date": 1534300945, "question_id": 51850955, "link": "https://stackoverflow.com/questions/51850955/why-does-this-mexed-c-magma-code-seg-fault-while-the-stand-alone-c-code-works", "title": "Why does this MEXed C/magma code seg-fault while the stand alone C code works?", "body": "<p>The following MEXed C code simply makes calls to magma to invert a matrix. The stand alone C code (which is also posted) works, but the mex code crashes.</p>\n\n<p>I've triple checked the documentation, verified that other magma functions work as expected, and <a href=\"http://icl.cs.utk.edu/magma/forum/viewtopic.php?f=2&amp;t=1795&amp;sid=5064af995de123e00989fdcf215e8bc7\" rel=\"nofollow noreferrer\">posted on the Magma forum and was told my code is fine</a> (this post is a cross post from Magma forum). This means that the problem is with mex. I would like to know what is causing the mex code to seg-fault and how to get it to run as expected. </p>\n\n<p>Mexed code: </p>\n\n<pre><code>#include &lt;mex.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;magma_v2.h&gt;\n#include &lt;cuda_runtime.h&gt;\n\nvoid mat2magma(magmaDoubleComplex* p, double* pr, double* pi,int numElements)\n{\n    int j=0;\n    for(j=0;j&lt;numElements;j++){\n        p[j].x=pr[j];\n        p[j].y=pi[j];\n    }\n}\n\nvoid magma2mat(magmaDoubleComplex* p, double* pr, double* pi,int numElements)\n{\n    int j=0;\n    for(j=0;j&lt;numElements;j++){\n        pr[j]= p[j].x;\n        pi[j]= p[j].y;\n    }\n}\n\n/*gateway function*/\nvoid mexFunction( int nlhs, mxArray *plhs[],\n        int nrhs, const mxArray *prhs[]) {\n\n    /*initialize magma*/\n    magma_init();\n    magma_queue_t queue = NULL;\n    magma_device_t dev;\n    magma_getdevice(&amp;dev);\n    magma_queue_create(dev,&amp;queue );\n\n    magma_int_t m,ldwork,info;\n    magma_int_t *piv;\n    magmaDoubleComplex *a,*da,*dwork;\n\n    /* Matlab -&gt; Host */\n    m=mxGetM(prhs[0]);\n    piv=(magma_int_t*) malloc(m*sizeof(magma_int_t));\n    magma_zmalloc_cpu(&amp;a,m*m);\n    mat2magma(a,mxGetPr(prhs[0]),mxGetPi(prhs[0]),m*m);\n    ldwork = m*magma_get_zgetri_nb(m);\n\n    /* Host -&gt; GPU */\n    magma_zmalloc(&amp;dwork,ldwork);\n    magma_zmalloc(&amp;da,m*m);\n    magma_zsetmatrix(m,m,a,m,da,m,queue);\n\n    /*LU and Inverse */\n    magma_zgetrf_gpu(m,m,da,m,piv,&amp;info);\n    magma_zgetri_gpu(m,da,m,piv,dwork,ldwork,&amp;info);\n\n    /*GPU -&gt; Host */\n    magma_zgetmatrix(m,m,da,m,a,m,queue);\n\n    /*Host -&gt; Matlab*/\n    plhs[0] = mxCreateDoubleMatrix(m,m,mxCOMPLEX);\n    magma2mat(a,mxGetPr(plhs[0]),mxGetPi(plhs[0]),m*m);\n    free(a);\n    free(piv);\n    magma_free(dwork);\n    magma_free(da);\n    magma_queue_destroy(queue);\n    magma_finalize();\n}\n</code></pre>\n\n<p>I compliled it with  <code>mex CC=gcc LDFLAGS=\"-lmagma -lcudart -lcublas\" magmaZinv.c</code> then from matlab, I ran: </p>\n\n<pre><code>a=magic(3)+magic(3)*1i;\nmagmaZinv(a)\n</code></pre>\n\n<p>Standalone C code: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;magma_v2.h&gt;\n#include &lt;cuda_runtime.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;time.h&gt;\n\n/*gateway function*/\nint main() {\n\n    /*initialize magma*/\n    magma_init();\n    magma_queue_t queue = NULL;\n    magma_device_t dev;\n    magma_getdevice(&amp;dev);\n    magma_queue_create(dev,&amp;queue );\n\n    int m,ldwork,info;\n    int *piv;\n    magmaDoubleComplex *a,*da,*dwork;\n\n    /* allocate and initialize a = magic(3)+magic(3)*1i; */\n    m=3;\n    piv=(int*) malloc(m*sizeof(int));\n    ldwork = m*magma_get_zgetri_nb(m);\n    magma_zmalloc_cpu(&amp;a,m*m);\n    a[0].x=8;a[0].y=8;\n    a[1].x=3;a[1].y=3;\n    a[2].x=4;a[2].y=4;\n    a[3].x=1;a[3].y=1;\n    a[4].x=5;a[4].y=5;\n    a[5].x=9;a[5].y=9;\n    a[6].x=6;a[6].y=6;\n    a[7].x=7;a[7].y=7;\n    a[8].x=2;a[8].y=2;\n\n    /* Host -&gt; GPU */\n    magma_zmalloc(&amp;dwork,ldwork);\n    magma_zmalloc(&amp;da,m*m);\n    magma_zsetmatrix(m,m,a,m,da,m,queue);\n\n    /*LU and Inverse */\n    magma_zgetrf_gpu(m,m,da,m,piv,&amp;info);\n    magma_zgetri_gpu(m,da,m,piv,dwork,ldwork,&amp;info);\n\n    /*GPU -&gt; Host */\n    magma_zgetmatrix(m,m,da,m,a,m,queue);\n\n    /* display inv(a) */\n    for (int i=0;i&lt;(m*m);i++){\n        printf(\"%f +%fi\\n\",a[i].x,a[i].y);\n    }\n\n    /* free memory */\n    free(a);\n    free(piv);\n    magma_free(dwork);\n    magma_free(da);\n    magma_queue_destroy(queue);\n    magma_finalize();\n\n    return 0;\n}\n</code></pre>\n\n<p>I compiled with: gcc -lmagma -lcudart Ccode.c -o Ccode.o</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 23, "user_id": 9926325, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugSb66QjC50/AAAAAAAAAAI/AAAAAAAADVk/BWkuo6pa06c/photo.jpg?sz=128", "display_name": "ANIRBIT ADAK", "link": "https://stackoverflow.com/users/9926325/anirbit-adak"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1534283965, "post_id": 51850297, "comment_id": 90653841, "body": "Yeah I tried out that I displayed as error message given above."}, {"owner": {"reputation": 1721, "user_id": 9070959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fc72be4dddc4ff4156a7d875912d67?s=128&d=identicon&r=PG&f=1", "display_name": "emsimpson92", "link": "https://stackoverflow.com/users/9070959/emsimpson92"}, "edited": false, "score": 0, "creation_date": 1534284175, "post_id": 51850297, "comment_id": 90653899, "body": "The problem is that the array is <code>n</code> length, but you&#39;re trying to initialize a length of 1 by only setting the value of one index. The compiler doesn&#39;t appreciate that. You could always initialize it to <code>null</code> if that won&#39;t harm your functionality."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1534285025, "post_id": 51850297, "comment_id": 90654165, "body": "The language doesn&#39;t allow an initializer for a variable-length array. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.7.9 paragraph 3: &quot;The type of the entity to be initialized shall be an array of unknown size or a complete object type that is not a variable length array type.&quot;"}, {"owner": {"reputation": 23, "user_id": 9926325, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugSb66QjC50/AAAAAAAAAAI/AAAAAAAADVk/BWkuo6pa06c/photo.jpg?sz=128", "display_name": "ANIRBIT ADAK", "link": "https://stackoverflow.com/users/9926325/anirbit-adak"}, "edited": false, "score": 0, "creation_date": 1534285339, "post_id": 51850297, "comment_id": 90654273, "body": "@tilz0R understood my problem and provided me the solution already."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9926325, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugSb66QjC50/AAAAAAAAAAI/AAAAAAAADVk/BWkuo6pa06c/photo.jpg?sz=128", "display_name": "ANIRBIT ADAK", "link": "https://stackoverflow.com/users/9926325/anirbit-adak"}, "edited": false, "score": 0, "creation_date": 1534284189, "post_id": 51850333, "comment_id": 90653906, "body": "That I can&#39;t because I am displaying the array elements after insertion of elements of user so clearing of array would lead to data loss."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 23, "user_id": 9926325, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugSb66QjC50/AAAAAAAAAAI/AAAAAAAADVk/BWkuo6pa06c/photo.jpg?sz=128", "display_name": "ANIRBIT ADAK", "link": "https://stackoverflow.com/users/9926325/anirbit-adak"}, "edited": false, "score": 0, "creation_date": 1534284218, "post_id": 51850333, "comment_id": 90653915, "body": "But you want to clear array? You need to initialize array to <code>0</code> = <i>clear array</i>. So what are you thinking?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1534284348, "post_id": 51850333, "comment_id": 90653957, "body": "You call <code>memset</code> after declaring the array and before using it in the rest of the program."}, {"owner": {"reputation": 23, "user_id": 9926325, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugSb66QjC50/AAAAAAAAAAI/AAAAAAAADVk/BWkuo6pa06c/photo.jpg?sz=128", "display_name": "ANIRBIT ADAK", "link": "https://stackoverflow.com/users/9926325/anirbit-adak"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534285202, "post_id": 51850333, "comment_id": 90654229, "body": "Thanks @Christian Gibbons for making me understand what tilz0R actually wanted to say. Actually being a beginner I couldn&#39;t get what was said."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534288891, "post_id": 51850333, "comment_id": 90655086, "body": "tilz0R, or simply: <code>memset(arr, 0, sizeof arr);</code> for an <i>array</i>."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 1, "creation_date": 1534289068, "post_id": 51850333, "comment_id": 90655118, "body": "I agree with both."}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": true, "score": 7, "last_activity_date": 1577037856, "last_edit_date": 1577037856, "creation_date": 1534284074, "answer_id": 51850333, "question_id": 51850297, "link": "https://stackoverflow.com/questions/51850297/how-to-initialise-an-variable-sized-int-array-to-0-in-c/51850333#51850333", "title": "How to initialise an variable sized int array to 0 in C?", "body": "<p>Use <code>memset</code> to clear your array:</p>\n\n<p><code>memset(arr, 0x00, sizeof(arr));</code></p>\n\n<p>When using sizeof with VLA, result of sizeof is not evaluated in compile time, so it is perfectly to use.</p>\n\n<p>Edit: While your current approach works, I would strongly advice you to <em>move away</em> from VLA and in case you need VLA, use <code>malloc</code> and <code>free</code> functions. This will significantly decrease chances for stack overflow, in case of <code>n</code> being big number`.</p>\n\n<pre><code>#include \"stdlib.h\"\n\nint main() {\n    int* arr;\n    int n;\n\n    //Get n value by input\n\n    arr = malloc(sizeof(*arr) * n);\n    if (arr == NULL) {\n        //No memory available, stop program\n    }\n    memset(arr, 0x00, sizeof(*arr) * n);\n\n    //Do you job here just like before using VLA\n\n    //At the end, before returning, call free function\n    free(arr);\n}\n</code></pre>\n\n<p>FYI, <em>VLA</em> stands for <em>Variable Length Array</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 9926325, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugSb66QjC50/AAAAAAAAAAI/AAAAAAAADVk/BWkuo6pa06c/photo.jpg?sz=128", "display_name": "ANIRBIT ADAK", "link": "https://stackoverflow.com/users/9926325/anirbit-adak"}, "is_accepted": false, "score": 0, "last_activity_date": 1534285467, "creation_date": 1534285467, "answer_id": 51850543, "question_id": 51850297, "link": "https://stackoverflow.com/questions/51850297/how-to-initialise-an-variable-sized-int-array-to-0-in-c/51850543#51850543", "title": "How to initialise an variable sized int array to 0 in C?", "body": "<p>So, I finally the code snippet is as follows</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid insert(int arr[],int k,int pos,int n)\n{   display(arr,n);\n    int i=n-1;\n    if(pos&lt;n)\n{\n    while(i&gt;=pos)\n    {\n       arr[i]=arr[i-1];\n       i--;\n    }\n    arr[pos]=k;\n    display(arr,n);\n}\nelse\n    {\n        printf(\"\\n !!Array full!!\");\n        return 0;\n    }\n}\n\n\nvoid display(int arr[],int n)\n{   int i;\n    printf(\"\\n Displaying array elements: \");\n    for(i=0;i&lt;n;i++)\n        if(arr[i]!=0)\n        printf(\"%d \",arr[i]);\n}\n\n\nint main()\n{   int n,pos,i=0,k;\nchar c='y';\nprintf(\"\\n Enter the no. of elements: \");\nscanf(\"%d\",&amp;n);\nint arr[n];\nmemset(arr, 0x00, sizeof(arr[0]) * n);\nprintf(\"\\n Enter the array elements: \");\nwhile(c=='y'||c=='Y')\n{   \n    scanf(\"%d\",&amp;arr[i]);\n    i++;\n    printf(\"\\n Continue (y/n): \");\n    scanf(\" %c\",&amp;c);\n\n}\nc='y';\nwhile(c=='y'||c=='Y')\n{\n    printf(\"\\n Enter the element to be inserted: \");\n    scanf(\"%d\",&amp;k);\n    printf(\"\\n Enter the position: \");\n    scanf(\"%d\",&amp;pos);\n    pos--;\n    insert(arr,k,pos,n);\n\n    printf(\"\\n Continue (y/n): \");\n    scanf(\" %c\",&amp;c);\n    if(c=='n'||c=='N')\n        printf(\"\\n !!Thank You!!\");\n\n}\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9926325, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugSb66QjC50/AAAAAAAAAAI/AAAAAAAADVk/BWkuo6pa06c/photo.jpg?sz=128", "display_name": "ANIRBIT ADAK", "link": "https://stackoverflow.com/users/9926325/anirbit-adak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 51850333, "answer_count": 2, "score": -1, "last_activity_date": 1577037856, "creation_date": 1534283853, "last_edit_date": 1534309995, "question_id": 51850297, "link": "https://stackoverflow.com/questions/51850297/how-to-initialise-an-variable-sized-int-array-to-0-in-c", "title": "How to initialise an variable sized int array to 0 in C?", "body": "<p>I was trying out the insertion of elements program in C. There I need to initialise a VARIABLE SIZED ARRAY TO 0 but the compiler is not allowing me to do so. Any way out?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid insert(int arr[],int k,int pos,int n)\n{\n    display(arr,n);\n    int i=n-1;\n    if(pos&lt;n) {\n        while(i&gt;=pos) {\n            arr[i]=arr[i-1];\n            i--;\n        }\n        arr[pos]=k;\n        display(arr,n);\n    } else {\n        printf(\"\\n !!Array full!!\");\n        return 0;\n    }\n}\n\n\nvoid display(int arr[],int n)\n{   \n    int i;\n    printf(\"\\n Displaying array elements: \");\n    for(i=0;i&lt;n;i++)\n        if(arr[i]!=0)\n            printf(\"%d \",arr[i]);\n}\n\n\nint main()\n{   \n    int n,pos,i=0,k;\n    char c='y';\n    printf(\"\\n Enter the no. of elements: \");\n    scanf(\"%d\",&amp;n);\n    int arr[n];\n    printf(\"\\n Enter the array elements: \");\n    while(c=='y'||c=='Y') {   \n        scanf(\"%d\",&amp;arr[i]);\n        i++;\n        printf(\"\\n Continue (y/n): \");\n        scanf(\" %c\",&amp;c);\n    }\n    c='y';\n    while(c=='y'||c=='Y') {\n        printf(\"\\n Enter the element to be inserted: \");\n        scanf(\"%d\",&amp;k);\n        printf(\"\\n Enter the position: \");\n        scanf(\"%d\",&amp;pos);\n        pos--;\n        insert(arr,k,pos,n);\n\n        printf(\"\\n Continue (y/n): \");\n        scanf(\" %c\",&amp;c);\n        if(c=='n'||c=='N')\n            printf(\"\\n !!Thank You!!\");\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>when I tried out </p>\n\n<pre><code>int arr[n]={0};\n</code></pre>\n\n<p>it displayed an error that could not initialise a variable sized array to 0.</p>\n\n<p>output of prog</p>\n\n<p>Enter the position: 2                                                                                                                  </p>\n\n<p>Displaying array elements: 2 5 3 <strong>-344174192</strong><br>\n Displaying array elements: 2 4 5 3<br>\n Continue (y/n):                                                                                                                        </p>\n\n<p>...Program finished with exit code 0<br>\nPress ENTER to exit console.        </p>\n\n<p>garbage value is shown in bold.</p>\n"}, {"tags": ["c", "r", "lapack"], "comments": [{"owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1534458333, "post_id": 51850295, "comment_id": 90723672, "body": "does it work if you instead <code>R CMD INSTALL QUIC</code>, then within R <code>library(QUIC); &lt;whatever&gt;</code> using the directory unpacked from the downloaded tarball?"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 1, "creation_date": 1534458391, "post_id": 51850295, "comment_id": 90723688, "body": "I honestly do not understand your question. <i>Either</i> you just &quot;clone&quot; the existing package, keeping its structure and making a new one <i>or</i> you want to access the C code of the existing package.  The former is easy and has been done millions of time, the latter is possible and I answered it on this site a few times too."}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1534458665, "post_id": 51850295, "comment_id": 90723752, "body": "In either case you already quote the full link instructions with LAPACK, BLAS and Fortran.  You need that too -- you cannot just <code>dyn.load()</code> an incompletely linked routine and hope for unicorns and rainbows.  <i>There is a reason we all insist on building packages</i> and you are experiencing one of the reasons why. Packages work, and have a build framework."}, {"owner": {"reputation": 81, "user_id": 10226674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deec4f0db1a2e59a685e293f40d3f7a9?s=128&d=identicon&r=PG&f=1", "display_name": "user365239", "link": "https://stackoverflow.com/users/10226674/user365239"}, "reply_to_user": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1534459210, "post_id": 51850295, "comment_id": 90723876, "body": "@BenBolker Yes I can download the tarball from CRAN and run &quot;R CMD INSTALL QUIC_1.1.tar.gz&quot; and everything is fine. I will note that if I delete the MD5 from the tarball and try to install it fails. @Dirk Eddelbuettel The package consists of a function QUIC (code in <code>QUIC.cpp</code>) which uses this C code via <code>.C</code> command in R. When I try the exact same thing but create the QUIC function from a properly loaded <code>.so</code> it throws LAPACK error. I thought the LAPACK links are within the QUIC.cpp header and the Makevars file but I am quite clueless overall. I don&#39;t care about making a package."}, {"owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 1, "creation_date": 1534459394, "post_id": 51850295, "comment_id": 90723925, "body": "I know a lot less than @DirkEddelbuettel , but it seems that the path of least resistance would be to develop your extensions by modifying the code and building it <i>within</i> the existing package structure (you can edit the <code>DESCRIPTION</code> file to change the name, use <code>devtools::load_all()</code> to recompile/reload on the fly, etc..."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 4, "last_activity_date": 1534461262, "creation_date": 1534461262, "answer_id": 51886475, "question_id": 51850295, "link": "https://stackoverflow.com/questions/51850295/mimic-c-usage-in-preexisting-r-package/51886475#51886475", "title": "Mimic C usage in preexisting R package", "body": "<p>The problem is that, in the original <code>QUIC.r</code> function, the line:</p>\n\n<pre><code>n &lt;- nrow(S)\n</code></pre>\n\n<p>gives <code>n</code> a <code>storage.mode</code> of <code>integer</code>.  However, in your code, you assign:</p>\n\n<pre><code>n &lt;- 15\n</code></pre>\n\n<p>which gives <code>n</code> a <code>storage.mode</code> of <code>double</code>.</p>\n\n<p>If you add:</p>\n\n<pre><code>storage.mode(n) &lt;- \"integer\"\n</code></pre>\n\n<p>to the big list of storage mode settings, your program should work fine.</p>\n"}], "owner": {"reputation": 81, "user_id": 10226674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deec4f0db1a2e59a685e293f40d3f7a9?s=128&d=identicon&r=PG&f=1", "display_name": "user365239", "link": "https://stackoverflow.com/users/10226674/user365239"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1534469151, "creation_date": 1534283843, "last_edit_date": 1534459493, "question_id": 51850295, "link": "https://stackoverflow.com/questions/51850295/mimic-c-usage-in-preexisting-r-package", "title": "Mimic C usage in preexisting R package", "body": "<p>I am trying to use C code within R based on the package <code>QUIC</code>. Unfortunately I can't get my own local version of the package to work. I downloaded the package source from <a href=\"https://cran.r-project.org/web/packages/QUIC/index.html\" rel=\"nofollow noreferrer\">CRAN</a> for examination. In the <code>src</code> folder I find the desired QUIC.cpp code (<a href=\"https://github.com/tjhunter/navigate-sf/blob/master/python/mm/arterial_hkt/gmrf_learning/quic_cpp/QUIC.C\" rel=\"nofollow noreferrer\">A github page contains it here for reference</a>) and a Makevars file with no extension that contains the following two lines:</p>\n\n<pre><code>PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)\nPKG_CXXFLAGS = -DLANG_R\n</code></pre>\n\n<p>Next, I run <code>R CMD SHLIB QUIC.cpp</code> in Terminal (there are no warnings or errors produced), and then I load into R with <code>dyn.load(QUIC.so)</code>. When I try to run the corresponding <code>QUIC</code> function in R using my created <code>.so</code> file I get an error message:</p>\n\n<blockquote>\n  <p>Error: BLAS/LAPACK routine 'DPOTRF' gave error code -4</p>\n</blockquote>\n\n<p>The <code>dpotrf</code> call performs a choleksy decomposition and the error is not because of lack of positive definiteness or anything \"theoretical\" . . . I'm not sure how to fix this and can't find anything helpful online.</p>\n\n<p>EDIT: to be clear, all of this is done in the downloaded <code>QUIC</code> package and I have not changed any code. The desired function works perfectly when I perform <code>library(QUIC)</code> and use it from there. I want to eventually change their C code since I think the <code>QUIC</code> method can be extended, but first I need to get <code>QUIC</code> working in this manner!</p>\n\n<p>EDIT2: Here are some system details.</p>\n\n<pre><code>&gt; Sys.info()\n                                     sysname \n                                     \"Darwin\" \n                                     release \n                                     \"16.7.0\" \n                                     version \n\"Darwin Kernel Version 16.7.0; root:xnu-3789.73.8~1/RELEASE_X86_64\" \n                                    nodename \n                                     \"MacBook-Pro.local\" \n                                     machine \n                                    \"x86_64\" \n\n&gt; R.Version()\n$platform\n[1] \"x86_64-apple-darwin15.6.0\"\n\n$arch\n[1] \"x86_64\"\n\n$os\n[1] \"darwin15.6.0\"\n\n$system\n[1] \"x86_64, darwin15.6.0\"\n\n\n$`svn rev`\n[1] \"74626\"\n\n$version.string\n[1] \"R version 3.5.0 (2018-04-23)\"\n\n$nickname\n[1] \"Joy in Playing\"\n</code></pre>\n\n<p>EDIT3:  Here is the code I use to test.</p>\n\n<pre><code>n &lt;- 15\nrho &lt;- 0.2\nS &lt;- diag(n)\n# library(QUIC); QUIC(S,rho) works fine. Now copying the setup for QUIC and trying with .so file:\n\n\npath = NULL; tol = 1e-04; msg = 1; maxIter = 1000; X.init = NULL; W.init = NULL\n\nif (is.null(path)) {\n        npath &lt;- 1\n    } else {npath &lt;- length(path)}\n    if (!is.matrix(rho) &amp;&amp; length(rho) != 1 &amp;&amp; length(rho) != \n        n) {\n        stop(\"Wrong number of elements in rho\")\n    }\n    if (is.vector(rho)) {\n        rho &lt;- matrix(sqrt(rho)) %*% sqrt(rho)\n    }\n    if (length(rho) == 1) {\n        rho &lt;- matrix(rho, ncol = n, nrow = n)\n    }\n    if (is.null(path)) {\n        if (is.null(X.init)) {\n            X &lt;- diag(n)\n            W &lt;- diag(n)\n        } else {\n            X &lt;- X.init\n            W &lt;- W.init }\n    } else {\n        if (is.null(X.init)) {\n            X &lt;- array(diag(n), c(n, n, npath))\n            W &lt;- array(diag(n), c(n, n, npath))\n        } else {\n            X &lt;- array(0, c(n, n, npath))\n            W &lt;- array(0, c(n, n, npath))\n            X[, , 1] &lt;- X.init\n            W[, , 1] &lt;- W.init\n        }\n    }\n    opt &lt;- matrix(0, ncol = npath, nrow = 1)\n    cputime &lt;- matrix(0, ncol = npath, nrow = 1)\n    iter &lt;- matrix(0, ncol = npath, nrow = 1)\n    dGap &lt;- matrix(0, ncol = npath, nrow = 1)\n    if (is.null(path)) {\n        job &lt;- \"d\"\n    } else {job &lt;- \"p\"}\n    storage.mode(job) &lt;- \"character\"\n    storage.mode(S) &lt;- \"double\"\n    storage.mode(rho) &lt;- \"double\"\n    storage.mode(npath) &lt;- \"integer\"\n    storage.mode(path) &lt;- \"double\"\n    storage.mode(tol) &lt;- \"double\"\n    storage.mode(msg) &lt;- \"integer\"\n    storage.mode(maxIter) &lt;- \"integer\"\n    storage.mode(X) &lt;- \"double\"\n    storage.mode(W) &lt;- \"double\"\n    storage.mode(opt) &lt;- \"double\"\n    storage.mode(cputime) &lt;- \"double\"\n    storage.mode(iter) &lt;- \"integer\"\n    storage.mode(dGap) &lt;- \"double\"\n\n dyn.load(\".../QUIC.so\")    \n\ntmp &lt;- .C(\"QUICR\", job, n, S, rho, npath, path, tol, msg, \n        maxIter, X = X, W = W, opt = opt, cputime = cputime, \n        iter = iter, dGap = dGap)\n\n#Error: BLAS/LAPACK routine 'DPOTRF' gave error code -4\n</code></pre>\n"}, {"tags": ["variables", "gcc", "c", "buffer", "stack"], "answers": [{"tags": [], "owner": {"reputation": 1036, "user_id": 10095817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd397fc62377f0e1f1e53c5b22f9b72a?s=128&d=identicon&r=PG&f=1", "display_name": "RalfFriedl", "link": "https://stackoverflow.com/users/10095817/ralffriedl"}, "is_accepted": false, "score": 2, "last_activity_date": 1534282326, "creation_date": 1534282326, "answer_id": 51867758, "question_id": 51867757, "link": "https://stackoverflow.com/questions/51867757/what-is-the-order-of-local-variables-on-the-stack/51867758#51867758", "title": "What is the order of local variables on the stack?", "body": "<p>The order of local variable on the stack is undefined.</p>\n\n<p>It may change between different compilers, different versions or different optimization options. It may even depend on the names of the variables or other seemingly unrelated things.</p>\n"}, {"comments": [{"owner": {"reputation": 677, "user_id": 5182710, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85579515ac37819c24e7e42269da8a85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed202", "link": "https://stackoverflow.com/users/5182710/ahmed202"}, "edited": false, "score": 0, "creation_date": 1534408160, "post_id": 51867759, "comment_id": 90696871, "body": "Hi @Seamus, the ASLR is used to change the addresses of functions in libc in a random way each time you run the program, more precisely, ASRL is used to shift by a random value all the components of the memory like the stack, heap, text... As a defense mechanism it prevents the return-into-libc and ROP attacks. It does not prevent the stack smashing (this is the role of stack canaries).  Preventing an overflown buffer from changing the value of another local variable on the stack is not possible in my opinion."}, {"owner": {"reputation": 233, "user_id": 5395338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mGIwmZDcWfY/AAAAAAAAAAI/AAAAAAAAASA/aT_YdR4K_4s/photo.jpg?sz=128", "display_name": "Seamus", "link": "https://stackoverflow.com/users/5395338/seamus"}, "reply_to_user": {"reputation": 677, "user_id": 5182710, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85579515ac37819c24e7e42269da8a85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed202", "link": "https://stackoverflow.com/users/5182710/ahmed202"}, "edited": false, "score": 0, "creation_date": 1534423077, "post_id": 51867759, "comment_id": 90705707, "body": "@Ahmed202: Thank you for the clarification. I&#39;m really out of my depth here, but you you seem to be quite knowledgeable - perhaps you should answer? I&#39;d be very interested to learn more about how this works. I&#39;m only here as this question was asked in another forum, then got moved... so I feel a bit like <a href=\"https://www.youtube.com/watch?v=cMhrpapLTZM\" rel=\"nofollow noreferrer\">Dorothy in the Wizard of Oz</a> :)"}, {"owner": {"reputation": 677, "user_id": 5182710, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85579515ac37819c24e7e42269da8a85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed202", "link": "https://stackoverflow.com/users/5182710/ahmed202"}, "edited": false, "score": 0, "creation_date": 1534517299, "post_id": 51867759, "comment_id": 90746736, "body": "I guess that the compiler is performing a kind of optimization by reordering local variables on the stack. If my hypothesis is true, forcing the &quot;non-optimization&quot; mode by adding -O0 flag to the gcc will keep the order as intended in the program i.e fp above the buffer..."}], "tags": [], "owner": {"reputation": 233, "user_id": 5395338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mGIwmZDcWfY/AAAAAAAAAAI/AAAAAAAAASA/aT_YdR4K_4s/photo.jpg?sz=128", "display_name": "Seamus", "link": "https://stackoverflow.com/users/5395338/seamus"}, "is_accepted": false, "score": 0, "last_activity_date": 1534296626, "creation_date": 1534296626, "answer_id": 51867759, "question_id": 51867757, "link": "https://stackoverflow.com/questions/51867757/what-is-the-order-of-local-variables-on-the-stack/51867759#51867759", "title": "What is the order of local variables on the stack?", "body": "<p>The order of local variables on the stack is not defined until compile/link (build) time. I'm no expert certainly, but I think you'd have to do some sort of a \"hex dump\", or perhaps run the code in a debugger environment to find out where it's allocated. And I'd also guess that this would be a relative address, not an absolute one. </p>\n\n<p>And as @RalfFriedl has indicated in his answer, the location could change under any number of compiler options invoked for different platforms, etc. </p>\n\n<p>But we do know it's possible to do buffer overflows. Although you do hear less about them now due to defensive measures such as address space layout randomization (ASLR), they're still around and paying the bills for someone I'd guess. There are of course many many online articles on the subject; here's one that seems fairly current(<a href=\"https://www.synopsys.com/blogs/software-security/detect-prevent-and-mitigate-buffer-overflow-attacks/\" rel=\"nofollow noreferrer\">https://www.synopsys.com/blogs/software-security/detect-prevent-and-mitigate-buffer-overflow-attacks/</a>). </p>\n\n<p>Good luck (should you even say that to someone practicing buffer overflow attacks?). At any rate, I hope you learn some things, and use it for good :) </p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1534375798, "question_id": 462610}, "owner": {"reputation": 677, "user_id": 5182710, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85579515ac37819c24e7e42269da8a85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed202", "link": "https://stackoverflow.com/users/5182710/ahmed202"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534375798, "creation_date": 1534282095, "question_id": 51867757, "link": "https://stackoverflow.com/questions/51867757/what-is-the-order-of-local-variables-on-the-stack", "title": "What is the order of local variables on the stack?", "body": "<p>I'm currently trying to do some tests with the buffer overflow vulnerability.\nHere is the vulnerable code</p>\n\n<pre><code>void win()\n  {\n      printf(\"code flow successfully changed\\n\");\n  }\n\nint main(int argc, char **argv)\n  {\n      volatile int (*fp)();\n      char buffer[64];\n\n      fp = 0;\n\n      gets(buffer);\n\n      if(fp) {\n           printf(\"calling function pointer, jumping to 0x%08x\\n\", fp);\n           fp();\n             }\n   }\n</code></pre>\n\n<p>The exploit is quite sample and very basic: all what I need here is to overflow the buffer and override the fp value to make it hold the address of win() function.\nWhile trying to debug the program, I figured out that fb is placed below the buffer (i.e with a lower address in memory), and thus I am not able to modify its value.\nI thought that once we declare a local variable <strong>x</strong> before <strong>y</strong>, <strong>x</strong> will be higher in memory (i.e at the bottom of the stack) so <strong>x</strong> can override <strong>y</strong> if it exceeds its boundaries which is not the case here.\nI'm compiling the program with gcc gcc version 5.2.1, no special flags (only tested -O0)</p>\n\n<p>Any clue?   </p>\n"}, {"tags": ["c", "csv", "embedded", "msp430", "code-composer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1534280073, "post_id": 51849570, "comment_id": 90652482, "body": "Where this file is supposed to be located?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1534280308, "post_id": 51849570, "comment_id": 90652577, "body": "You should check the return value from fopen."}, {"owner": {"reputation": 9, "user_id": 10226550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d552278ef9f4b6146a593549f0beb61?s=128&d=identicon&r=PG&f=1", "display_name": "KD0704", "link": "https://stackoverflow.com/users/10226550/kd0704"}, "edited": false, "score": 0, "creation_date": 1534283887, "post_id": 51849570, "comment_id": 90653808, "body": "the file is located in the Debug folder of the code directory."}, {"owner": {"reputation": 9, "user_id": 10226550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d552278ef9f4b6146a593549f0beb61?s=128&d=identicon&r=PG&f=1", "display_name": "KD0704", "link": "https://stackoverflow.com/users/10226550/kd0704"}, "edited": false, "score": 0, "creation_date": 1534283956, "post_id": 51849570, "comment_id": 90653835, "body": "How do I check the return value from fopen?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1534284067, "post_id": 51849570, "comment_id": 90653871, "body": "Is your <code>fopen</code> semihosted? If not, how do you expect msp430 to write your computer?"}, {"owner": {"reputation": 9, "user_id": 10226550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d552278ef9f4b6146a593549f0beb61?s=128&d=identicon&r=PG&f=1", "display_name": "KD0704", "link": "https://stackoverflow.com/users/10226550/kd0704"}, "edited": false, "score": 0, "creation_date": 1534284494, "post_id": 51849570, "comment_id": 90653994, "body": "I have connected the microcontroller to the computer using a Flash Emulation tool that has a JTAG interface and is connected to the computer through a USB. Will this help in writing the data to the computer?"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 1, "creation_date": 1534311429, "post_id": 51849570, "comment_id": 90659385, "body": "fopen() could not write to a file located on your computer, you&#39;re working on an embedded machine. fopen() will write to the heap memory on your controller."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534371219, "post_id": 51849570, "comment_id": 90686291, "body": "strongly suggest only call <code>fopen()</code> once, then call <code>fclose()</code> when ready to exit the program.  Suggest using <code>fflush()</code> to assure each data gets written, just in case the chip is reset or the power is disconnected.   Suggest stepping through the &#39;main()&#39; loop of your program to assure the interrupts are actually occurring and the watchdog is not firing"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534371350, "post_id": 51849570, "comment_id": 90686319, "body": "&quot;how to check the returned value from <code>fopen()</code>&quot;?    <code>fp = fopen (&quot;file.txt&quot;, &quot;w+&quot;);  if( !fp ) { perror( &quot;fopen failed&quot; ); </code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1534411746, "post_id": 51849570, "comment_id": 90699035, "body": "@Mike: It&#39;s more likely <code>fopen</code> is just a dummy and returns an error unconditionally. I&#39;m actually surprised it even existx. Using a heap on such small MCUs (or most MCUs) is already a bad idea and <code>malloc</code>, etc. should not exist at all (together with all other parts of the standard library except the mandatory for a freestanding implementation/environment."}, {"owner": {"reputation": 9, "user_id": 10226550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d552278ef9f4b6146a593549f0beb61?s=128&d=identicon&r=PG&f=1", "display_name": "KD0704", "link": "https://stackoverflow.com/users/10226550/kd0704"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534440606, "post_id": 51849570, "comment_id": 90716522, "body": "@user3629249 I altered the code and called fopen() and fclose() just once. But I am unable to write float and string values into the file. I am able to write integer values only. I am unable to write float and string values(%f and %s)."}, {"owner": {"reputation": 9, "user_id": 10226550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d552278ef9f4b6146a593549f0beb61?s=128&d=identicon&r=PG&f=1", "display_name": "KD0704", "link": "https://stackoverflow.com/users/10226550/kd0704"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1534440719, "post_id": 51849570, "comment_id": 90716579, "body": "@Mike the fopen() command opens a file in the debug folder of the workspace that I work on currently. However, when I just write integer data to the file, it writes the data into the file, but same is not the case for float and string values."}], "owner": {"reputation": 9, "user_id": 10226550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d552278ef9f4b6146a593549f0beb61?s=128&d=identicon&r=PG&f=1", "display_name": "KD0704", "link": "https://stackoverflow.com/users/10226550/kd0704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534279731, "creation_date": 1534279731, "question_id": 51849570, "link": "https://stackoverflow.com/questions/51849570/unable-to-write-data-into-the-file-using-fopen-in-ccs", "title": "unable to write data into the file using fopen in CCS", "body": "<pre><code>#include &lt;msp430.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* Array to store SD24_B conversion results */\nunsigned int results[3];                          //SD24 converter result array\nunsigned int ADC_Result[6];                      // 8-bit ADC conversion result array\nfloat A0,A1,A2,A3,A4,A5,A6,A7,A8;                //analog voltage result registers\nfloat I0,I1,I2,I3,I4,I5,I6,I7,I8;                //current result registers\nunsigned int sig=0x0;\ntime_t current_time;\nchar *c_time_string;\n\nint main(void)\n{\n\n    WDTCTL = WDTPW | WDTHOLD;               // Stop WDT\n\n\n    FILE * fp;\n\n    // Setup P1.2 A0, 1.1 A1, 1.0 A2\n       P1SEL |= BIT0 | BIT1 | BIT2;                  // Set P1.0,.1,.2 to non-IO\n       P9SEL |= BIT1 | BIT2 | BIT3;                  //set P9.1,.2,.3 to non-IO\n\n       P5DIR |= BIT0 | BIT1 | BIT2 | BIT3;\n\n\n       __disable_interrupt();                        // Disable interrupts; Port Map cnfg\n       PMAPKEYID = PMAPKEY;                          // Enable access Port Mapping regs`enter code here`\n       P1MAP2 = PM_ANALOG;                           // Enable A0\n       P1MAP1 = PM_ANALOG;                           // Enable A1\n       P1MAP0 = PM_ANALOG;                           // Enable A2\n       PMAPKEYID = 0;                                // Disable access Port Mapping regs\n       __enable_interrupt();                         // Re-enable all interrupts\n\n\n       // Setup ADC10\n       ADC10CTL0 = ADC10SHT_3 | ADC10MSC | ADC10ON;  // 16 ADCclks, MSC, ADC ON\n       ADC10CTL1 = ADC10SHP | ADC10CONSEQ_1;         // pulse sample mode, single sequence\n       ADC10CTL2 |= ADC10RES;                       // 8-bit resolution\n       ADC10MCTL0 = ADC10INCH_5;                     // A0,A1,A2(EoS), AVCC reference\n\n       // Setup DMA0 (ADC10IFG trigger)\n       DMACTL0 = DMA0TSEL_24;                        // ADC10IFG trigger\n       DMA0SZ = 0x06;                                // 3 conversions\n       __data16_write_addr((unsigned short) &amp;DMA0SA, (unsigned long) &amp; ADC10MEM0);\n       // Source single address\n       __data16_write_addr((unsigned short) &amp;DMA0DA, (unsigned long) &amp; ADC_Result[0]);\n       // Destination array address\n       DMA0CTL = DMADT_4 | DMADSTINCR_3 | DMAEN | DMAIE;\n       DMA0CTL &amp;= ~DMASRCBYTE;\n       DMA0CTL &amp;= ~DMADSTBYTE;\n       // Repeated single transfer\n       // Increment destination\n       // Byte access\n       // Enable int after seq of convs\n\n\n\n\n\n\n    SD24BCTL0 |= SD24SSEL_1;      // Select internal REF\n    SD24BCTL0 &amp;= ~SD24REFS;       // Select SMCLK as SD24_B clock source\n\n    SD24BCCTL0 &amp;= ~SD24SNGL;\n    //SD24BCCTL0 |= SD24ALGN;\n    SD24BCCTL0 |= SD24DF0;\n    SD24BCCTL0 |= SD24SCS_5;      // Single conversion, group 1\n\n    SD24BCCTL1 &amp;= ~SD24SNGL;\n    //SD24BCCTL1 |= SD24ALGN;\n    SD24BCCTL1 |= SD24DF0;\n    SD24BCCTL1 |= SD24SCS_5;      // Single conversion, group 1\n\n    SD24BCCTL2 &amp;= ~SD24SNGL;\n    //SD24BCCTL2 |= SD24ALGN;\n    SD24BCCTL2 |= SD24DF0;\n    SD24BCCTL2 |= SD24SCS_5;      // Single conversion, group 1\n\n    SD24BIE |= SD24IE2; //| SD24IE1 | SD24IE0;                     // Enable channel 2 interrupt\n\n    fp = fopen (\"file.txt\", \"w+\");\n\n    fprintf(fp,\"\\\" \\\",\\\"V1\\\",\\\"Supply\\\",\\\"V2\\\",\\\"Supply\\\",\\\"Time\\\"\\n\");\n    fprintf(fp,\"\\\" \\\",\\\"voltage(in V)\\\",\\\"current(in A)\\\",\\\"voltage(in V)\\\",\\\"current(in A)\\\"\\n\");\n\n    fclose(fp);\n\n\n\n    __delay_cycles(0x10000);                 // Delay for 1.5V REF startup\n\n\n\n\n    while (sig &lt; 16)\n    {\n\n        //time setup\n        time_t t = time(NULL);\n        struct tm *tm = localtime(&amp;t);\n        char s[64];\n        strftime(s, sizeof(s), \"%c\", tm);\n\n\n        while (ADC10CTL1 &amp; ADC10BUSY) ;           // Wait if ADC10 core is active\n        ADC10CTL0 |= ADC10ENC | ADC10SC;          // Sampling and conversion start\n\n        __bis_SR_register(LPM0_bits | GIE); // Enter LPM0 w/ interrupts\n        __delay_cycles(1000);                     // Delay between sequence convs\n        __no_operation();                         // BREAKPOINT; View ADC_Result\n\n\n\n\n        //ADC_10 voltage and current display\n        A0=(ADC_Result[5]*3.3)/(1024*5);\n        I0=(A0)/2.43;\n\n        A1=(ADC_Result[4]*3.3)/(1024*5);\n        I1=(A1)/2.43;\n\n        A2=(ADC_Result[3]*3.3)/(1024*5);\n        I2=(A2)/2.43;\n\n        A3=(ADC_Result[2]*3.3)/(1024*5);\n        I3=(A3)/2.43;\n\n        A4=(ADC_Result[1]*3.3)/(1024*5);\n        I4=(A4)/2.43;\n\n        A5=(ADC_Result[0]*3.3)/(1024*5);\n        I5=(A5)/2.43;\n\n\n        fp = fopen (\"file.txt\", \"w+\");\n        fprintf(fp,\"\\\"A5\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A5,I5,s);\n        //printf(\" %s current I5= %f \\n\",s,I5);\n\n        fprintf(fp,\"\\\"A4\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A4,I4,s);\n        //printf(\"\\n %s analog voltage A4= %f \\n\",s,A4);\n        //printf(\" %s current I4= %f \\n\",s,I4);\n\n        fprintf(fp,\"\\\"A3\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A3,I3,s);\n        //printf(\"\\n %s analog voltage A3= %f \\n\",s,A3);\n        //printf(\" %s current I3= %f \\n\",s,I3);\n\n        fprintf(fp,\"\\\"A2\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A2,I2,s);\n        //printf(\"\\n %s analog voltage A2= %f \\n\",s,A2);\n        //printf(\" %s current I2= %f \\n\",s,I2);\n\n        fprintf(fp,\"\\\"A1\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A1,I1,s);\n        //printf(\"\\n %s analog voltage A1= %f \\n\",s,A1);\n        //printf(\" %s current I1= %f \\n\",s,I1);\n\n        fprintf(fp,\"\\\"A0\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A0,I0,s);\n        //printf(\"\\n %s analog voltage A0= %f \\n\",s,A0);\n        //printf(\" %s current I0= %f \\n\",s,I0);\n\n        fclose(fp);\n\n\n\n        SD24BCTL1 |= SD24GRP1SC;            // Set bit to start conversion\n        __bis_SR_register(LPM0_bits | GIE); // Enter LPM0 w/ interrupts\n\n        SD24BCTL1 &amp;= ~SD24GRP1SC;           // Clear bit for next conversion\n        __no_operation();                   // SET BREAKPOINT HERE\n\n\n        //SD24 converter voltage and current display\n        A6=(results[0]*3.3)/(256*5);\n        I6=(A6)/2.43;\n\n        A7=(results[1]*3.3)/(5*256);\n        I7=(A7)/2.43;\n\n        A8=(results[2]*3.3)/(256*5);\n        I8=(A8)/2.43;\n\n\n        fp = fopen (\"file.txt\", \"w+\");\n\n        fprintf(fp,\"\\\"A6\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A6,I6,s);\n        //printf(\"\\n %s analog voltage A6= %f \\n\",s,A6);\n        //printf(\" %s current I6= %f \\n\",s,I6);\n\n        fprintf(fp,\"\\\"A7\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A7,I7,s);\n        //printf(\"\\n %s analog voltage A7= %f \\n\",s,A7);\n        //printf(\" %s current I7= %f \\n\",s,I7);\n\n        fprintf(fp,\"\\\"A8\\\",\\\"%f\\\",\\\"%f\\\",\\\" \\\",\\\" \\\",\\\"%s\\\"\\n\",A8,I8,s);\n        //printf(\"\\n %s analog voltage A8= %f \\n\",s,A8);\n        //printf(\" %s current I8= %f \\n\",s,I8);\n\n        fclose(fp);\n\n        //__delay_cycles(2000);\n\n        /*if (sig==0x10)\n        {\n            sig = 0x00;\n            fclose(fp);\n        }*/\n\n        //else\n        //{\n            printf(\"select line chosen= %d \\n\",sig);\n            P5OUT = sig;\n            sig++;\n        //}\n\n\n    }\n\n    sig = 0x00;\n\n}\n\n#if defined(__TI_COMPILER_VERSION__) || defined(__IAR_SYSTEMS_ICC__)\n#pragma vector=SD24B_VECTOR\n__interrupt void SD24BISR(void)\n#elif defined(__GNUC__)\nvoid __attribute__ ((interrupt(SD24B_VECTOR))) SD24BISR (void)\n#else\n#error Compiler not supported!\n#endif\n{\n    switch (SD24BIV)\n    {\n        case SD24BIV_SD24OVIFG:             // SD24MEM Overflow\n            break;\n        case SD24BIV_SD24TRGIFG:            // SD24 Trigger IFG\n            break;\n        case SD24BIV_SD24IFG0:              // SD24MEM0 IFG\n            break;\n        case SD24BIV_SD24IFG1:              // SD24MEM1 IFG\n            break;\n        case SD24BIV_SD24IFG2:              // SD24MEM2 IFG\n            results[0] = SD24BMEMH0;        // Save CH0 results (clears IFG)\n            results[1] = SD24BMEMH1;        // Save CH1 results (clears IFG)\n            results[2] = SD24BMEMH2;        // Save CH2 results (clears IFG)\n            break;\n    }\n\n    __bic_SR_register_on_exit(LPM0_bits);   // Exit LPM0\n}\n\n\n\n#if defined(__TI_COMPILER_VERSION__) || defined(__IAR_SYSTEMS_ICC__)\n#pragma vector=DMA_VECTOR\n__interrupt void DMA0_ISR(void)\n#elif defined(__GNUC__)\nvoid __attribute__ ((interrupt(DMA_VECTOR))) DMA0_ISR (void)\n#else\n#error Compiler not supported!\n#endif\n{\n    switch (__even_in_range(DMAIV, 16))\n    {\n        case DMAIV_NONE: break;                   // No interrupts\n        case DMAIV_DMA0IFG:                       // DMA0IFG = DMA Channel 0\n            // sequence of conversions complete\n            __bic_SR_register_on_exit(LPM0_bits); // exit LPM0 on return\n            break;\n        case DMAIV_DMA1IFG: break;                // DMA1IFG = DMA Channel 1\n        case DMAIV_DMA2IFG: break;                // DMA2IFG = DMA Channel 2\n        case  8: break;                           // Reserved\n        case 10: break;                           // Reserved\n        case 12: break;                           // Reserved\n        case 14: break;                           // Reserved\n        case 16: break;                           // Reserved\n        default: break;\n    }\n}\n</code></pre>\n\n<p>I am using MSP430f6736 micro-controller and Code Composer Studio to program the micro-controller. I am using the internal ADCs and SD converters to read analog inputs and display them on the screen. I want to write the values into a .CSV file or a txt file. I have written the code above using the fopen statement.</p>\n\n<p>I am unable to write the data that I am getting from the ADCs and SD24 converters into the txt file. I want to generate a .CSV file.\nThe values that I am getting after the conversion, I am storing them in CSV format. </p>\n\n<p>Is there an error in the code? If yes, what shall I do in order to achieve the result? I want to generate a .CSV file using the data that I get from the micro-controller.</p>\n\n<p>could you help me out in solving this issue?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "serial-port", "raspberry-pi3", "uart"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1534286970, "post_id": 51849401, "comment_id": 90654652, "body": "It doesn&#39;t stop when there is a connection but there&#39;s no data to read, either."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1534291907, "post_id": 51849401, "comment_id": 90655611, "body": "Actually since you opened it with O_NONBLOCK, it&#39;s supposed to return -1 and set errno to EAGAIN if there&#39;s nothing to read..."}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1534279813, "creation_date": 1534279813, "answer_id": 51849584, "question_id": 51849401, "link": "https://stackoverflow.com/questions/51849401/read-is-blocked-forever-on-raspberry-pi-3-uart/51849584#51849584", "title": "read() is blocked forever on raspberry pi 3 UART", "body": "<p>For a UART port with nothing but tx/rx pins, there is no distinct \"nothing connected\" status. For the functionality you want, the port would need DCE/DTR pins and the <code>CLOCAL</code> flag (ignore modem control lines) would have to be removed from the termios settings.</p>\n"}, {"tags": [], "owner": {"reputation": 998, "user_id": 6810069, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NrcWm.jpg?s=128&g=1", "display_name": "Jeff Pal", "link": "https://stackoverflow.com/users/6810069/jeff-pal"}, "is_accepted": false, "score": 0, "last_activity_date": 1534335760, "creation_date": 1534335760, "answer_id": 51858623, "question_id": 51849401, "link": "https://stackoverflow.com/questions/51849401/read-is-blocked-forever-on-raspberry-pi-3-uart/51858623#51858623", "title": "read() is blocked forever on raspberry pi 3 UART", "body": "<p>I just add the code below, after open() and it's not blocked anymore when tx/rx pins are not connected. Probably the port was going blocked after open().</p>\n\n<pre><code>  if (fd == -1)\n    {\n      /*\n       * Could not open the port.\n       */\n\n      perror(\"open_port: Unable to open /dev/serial0 - \");\n    }\n  else fcntl(fd, F_SETFL, O_NONBLOCK);\n</code></pre>\n"}], "owner": {"reputation": 998, "user_id": 6810069, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NrcWm.jpg?s=128&g=1", "display_name": "Jeff Pal", "link": "https://stackoverflow.com/users/6810069/jeff-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534335760, "creation_date": 1534278934, "question_id": 51849401, "link": "https://stackoverflow.com/questions/51849401/read-is-blocked-forever-on-raspberry-pi-3-uart", "title": "read() is blocked forever on raspberry pi 3 UART", "body": "<p>The C read() function frequently get blocked, especially if there is nothing connected on the Gpio pins (tx / rx), but I just hoped it would stop for itself when there is no conection, the same when there is wire conection but no data to read, but it just get blocked  until I force it to finish. </p>\n\n<p><strong>Open</strong></p>\n\n<pre><code>fd = open(\"/dev/serial0\", O_RDWR | O_NDELAY | O_NOCTTY | O_NONBLOCK);\n</code></pre>\n\n<p><strong>Read</strong></p>\n\n<pre><code>n = read( fd, value, 1 );\nif (n &lt; 0) {\nprintf ( \"Error = %s\\n\", strerror( errno ) );\n}\nelse if (n == 0) {\n  printf ( \"Read Nothing...\\n\");\n}\n</code></pre>\n\n<p><strong>Set attribs</strong></p>\n\n<pre><code>int setAttr(int fd)\n{\n    //Read the configureation of the port \n    struct termios options;\n    tcgetattr( fd, &amp;options );\n\n    //Set Baud Rate \n    cfsetispeed( &amp;options, B9600 );\n    cfsetospeed( &amp;options, B9600 );\n\n    //Setting other Port Stuff \n    options.c_cflag &amp;= ~PARENB; /*Make 8n1 */\n    options.c_cflag &amp;= ~CSTOPB;\n    options.c_cflag &amp;= ~CSIZE; /* Mask the character size bits */\n    options.c_cflag |= CS8;    /* Select 8 data bits */\n    options.c_cflag &amp;= ~CRTSCTS;  /* No flow control */\n    options.c_cc[VMIN] = 0; /*READ doesn't block */\n    options.c_cc[VTIME] = 1; /* 0.1 seconds read timout */\n    options.c_cflag |= CREAD | CLOCAL; /* Turn on READ &amp; ignore crtl lines */\n\n    //Make raw\n    cfmakeraw(&amp;options);\n\n    //Flush port, then applies attributes\n    tcflush(fd, TCIOFLUSH);\n\n    return tcsetattr( fd, TCSANOW, &amp;options );\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "language-lawyer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1534276902, "post_id": 51848935, "comment_id": 90651156, "body": "C standard specifies that pointer arithmetic which is resulting in a pointer pointing outside a valid object (or one object past it) has an undefined behavior. Pretty much covering your question."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1534276920, "post_id": 51848935, "comment_id": 90651164, "body": "In a nutshell: Pointer arithmetic only has defined behaviour when applied to values that are the addresses of objects. No such addresses exist where the situation of the question could apply. (E.g. on x86, the compiler would not be allowed to allocate a <code>char</code> at the maximal address, since you wouldn&#39;t be able to form the one-past-the-end pointer.)"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1534278741, "post_id": 51848935, "comment_id": 90651888, "body": "In a similar vein, I have a vague memory that a large pointer from the 8086 real mode days would not increment correctly at: XXXX:FFFF.  The reason my memory is a little vague at this point is that I haven&#39;t touched such a beast in over twenty years. :/"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1534278806, "last_edit_date": 1534278806, "creation_date": 1534277246, "answer_id": 51849037, "question_id": 51848935, "link": "https://stackoverflow.com/questions/51848935/do-c-standards-specify-how-far-the-carry-propagates-when-incrementing-a-pointer/51849037#51849037", "title": "Do C standards specify how far the carry propagates when incrementing a pointer?", "body": "<p>C standard does not know anything about the implementation, and the standard does not care about the implementation. It only says what the effect of the pointer arithmetics is. </p>\n\n<p>C allows something which is called Undefined Behavior. C does not care if the result of the pointer arithmetic has any sense (ie it is not out of bounds or the actual implementation defined storage did not wrap around). If it happens it is the UB. It is up to programmer to prevent UB, and C does not have any standard mechanisms for detecting or preventing UB.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1534284107, "post_id": 51849073, "comment_id": 90653882, "body": "The pointer is valid when pointing just past the valid range (so pointer arithmetic is valid), but dereferencing it is not."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1534290243, "post_id": 51849073, "comment_id": 90655332, "body": "It is probably not possible to provide correct behaviour on pointer arithmetic overflow. I believe most implementations just avoid allocating the last byte in the address space if the end of the address space is usable."}, {"owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "edited": false, "score": 0, "creation_date": 1534296185, "post_id": 51849073, "comment_id": 90656304, "body": "So if a pointer cannot increment past some address which is <i>not</i> the end of the address space, as on the SC/MP, then the implementation needs to avoid letting arrays and such straddle that address in order to be standards compliant right? That means <code>malloc</code> and <code>strcpy</code> and so on need to be written particularly for that target?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "edited": false, "score": 0, "creation_date": 1534301387, "post_id": 51849073, "comment_id": 90657245, "body": "@wilson: it doesn&#39;t matter to strcpy, since malloc will ensure that no object straddles segments. And, yes, malloc needs to know a lot about the target; you cannot write  a non-trivial malloc portably. The compiler/linker also need to ensure static and automatic objects don&#39;t straddle."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1534301947, "post_id": 51849073, "comment_id": 90657350, "body": "@rici: Of course it is possible. Another solution is not to support any object (even aggregates) whose size exceeds 0x7ff bytes. Then any two pointers may be compared by subtracting the latter from the former. If the 0x800 bit is on in the result, the latter is later in the object than the former, regardless of whether the object straddles the wrap. I would not necessarily recommend such an implementation, but many things are possible."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1534348799, "post_id": 51849073, "comment_id": 90676745, "body": "@rici: It&#39;s possible to write a malloc() which is portable to high-quality implementations that&#39;s designed to support low-level programming constructs on linear-addressing platforms.  Simply create a union with a <code>char[REQUIRED_HEAP_SIZE]</code> and a <code>struct</code> containing a <code>char</code> and a union of every primitive type; have <code>malloc</code> carve space out of the <code>char[]</code>, and use the union&#39;s offset to determine alignment.  Platforms with non-linear addressing will require special treatment, but that doesn&#39;t mean most platforms would require individually-targeted <code>malloc</code> implementations."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534349596, "post_id": 51849073, "comment_id": 90677149, "body": "@supercat: I was thinking of mentioning that possibility, but it seemed sufficiently limited that I didn&#39;t bother. I don&#39;t think it fits into the category of &quot;non-trivial&quot; because it isn&#39;t really dynamic: it requires you to know in advance how much heap you will require. That&#39;s inevitable with a portable solution since the C standard provides no way of accessing, modifying or querying the heap other than malloc itself (and friends). Even Posix removed sbrk. But, sure, your strategy will work fine. I won&#39;t argue it."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1534350757, "post_id": 51849073, "comment_id": 90677761, "body": "@rici: Being able to have <code>malloc</code> automatically size itself to available storage is sometimes a useful feature, but the reverse can always be true.  Acquiring storage for <code>malloc</code> at load time may ensure that trying to run a program with insufficient memory will result in immediate rather than delayed failure.  It may also be helpful in cases where it would be better for a program&#39;s <code>malloc()</code> attempts to fail than to have it take acquire so much system memory that other tasks get starved.  My main point, though, is that &quot;malloc&quot; isn&#39;t as &quot;magical&quot; as some people think."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 14, "last_activity_date": 1534277459, "creation_date": 1534277459, "answer_id": 51849073, "question_id": 51848935, "link": "https://stackoverflow.com/questions/51848935/do-c-standards-specify-how-far-the-carry-propagates-when-incrementing-a-pointer/51849073#51849073", "title": "Do C standards specify how far the carry propagates when incrementing a pointer?", "body": "<p>Behavior of pointer arithmetic is specified by the C standard only as long as the result points to a valid object or just past a valid object. More than that, the standard does not say what the bits of a pointer look like; an implementation may arrange them to suit its own purposes.</p>\n\n<p>So, no, the standard does not say what happens when a pointer is incremented so far that the address rolls over.</p>\n\n<p>If the <code>while</code> loop you refer to only proceeds one element past the end of the array, it is safe in C. (Per the standard, if <code>ptr</code> has been incremented to one element beyond the end of the array, and <code>x</code> points to any element in the array, including the first, then <code>x &lt; ptr</code> must be true. So, if <code>ptr</code> has rolled over internally, the C implementation is responsible for ensuring the comparison still works.)</p>\n\n<p>If your <code>while</code> loop may increment <code>ptr</code> more than one element beyond the end of the array, the C standard does not define the behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "edited": false, "score": 1, "creation_date": 1534330642, "post_id": 51852792, "comment_id": 90666948, "body": "@Wilson I mean whatever it takes -- but yes, it might very well involve <code>ld</code>.  Certainly <code>ld</code> and libc are part of the C implementation.  Another example is that <code>ld</code> must take care not to put any object at address 0, if that would cause its address to look like a null pointer."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "edited": false, "score": 0, "creation_date": 1534348392, "post_id": 51852792, "comment_id": 90676539, "body": "@Wilson: The C library would be part of a hosted C implementation.  Freestanding implementations aren&#39;t required to supply any library functions other than those that the compiler itself might use for complicated operations like floating-point arithmetic."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 7, "last_activity_date": 1534305939, "creation_date": 1534305939, "answer_id": 51852792, "question_id": 51848935, "link": "https://stackoverflow.com/questions/51848935/do-c-standards-specify-how-far-the-carry-propagates-when-incrementing-a-pointer/51852792#51852792", "title": "Do C standards specify how far the carry propagates when incrementing a pointer?", "body": "<p>People often ask, \"Why does C have undefined behavior, anyway?\".  And this is a great example of one of the big reasons why.</p>\n\n<p>Let's stick with the NS SC/MP example.  If the hardware dictates that incrementing the pointer value <code>0x0FFF</code> doesn't work quite right, we have two choices:</p>\n\n<ol>\n<li><p>Translate the code <code>p++</code> to the equivalent of <code>if(p == 0x0FFF) p = 0x1000; else p++;</code>.</p></li>\n<li><p>Translate <code>p++</code> to a straight increment, but rig things up so that no properly-allocated object ever overlaps an address involving <code>0x0FFF</code>, such that if anyone ever writes code that ends up manipulating the pointer value <code>0x0FFF</code> and adding one to it and getting a bizarre answer, you can say \"that's undefined, so anything can happen\".</p></li>\n</ol>\n\n<p>If you take approach #1, the generated code is bigger and slower.  If you take approach #2, the generated code is maximally efficient.  And if someone complains about the bizarre behavior, asks why the compiler couldn't have emitted code that did something \"more reasonable\", you can simply say, \"our mandate was to be as efficient as possible.\"</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1534359222, "last_edit_date": 1534359222, "creation_date": 1534348257, "answer_id": 51862114, "question_id": 51848935, "link": "https://stackoverflow.com/questions/51848935/do-c-standards-specify-how-far-the-carry-propagates-when-incrementing-a-pointer/51862114#51862114", "title": "Do C standards specify how far the carry propagates when incrementing a pointer?", "body": "<p>A significant number of platforms have addressing methods which cannot index \"easily\" across certain boundaries.  The C Standard allows implementations two general approaches for handling this (which may be, but typically aren't, used together):</p>\n\n<ol>\n<li><p>Refrain from having the compiler, linker, or <code>malloc</code>-style functions place any objects in a way that would straddle any problematic boundaries.</p></li>\n<li><p>Perform address computations in a way that can index across arbitrary boundaries, even when it would be less efficient than address-computation code that can't.</p></li>\n</ol>\n\n<p>In most cases, approach #1 will lead to code which is faster and more compact, but code may be limited in its ability to use memory effectively.  For example, if code needs many objects of 33,000 bytes each, a machine with 4MiB of heap space subdivided into \"rigid\" 64K chunks, would be limited to creating 64 of them (one for each chunk), even though there should be space for 127 of them.  Approach #2 will often yield much slower code, but such code may be able to make more effective use of heap space.</p>\n\n<p>Interestingly, imposing 16-bit or 32-bit alignment requirements would allow many 8-bit processors to generate more efficient code than allowing arbitrary alignment (since they could omit page-crossing logic when indexing between the bytes of a word) but I've never seen any 8-bit compilers provide an option to impose and exploit such alignments even on platforms where it could offer considerable advantages.</p>\n"}], "owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 51852792, "answer_count": 4, "score": 10, "last_activity_date": 1534359222, "creation_date": 1534276738, "last_edit_date": 1534333164, "question_id": 51848935, "link": "https://stackoverflow.com/questions/51848935/do-c-standards-specify-how-far-the-carry-propagates-when-incrementing-a-pointer", "title": "Do C standards specify how far the carry propagates when incrementing a pointer?", "body": "<p>Consider the following situations:</p>\n\n<ul>\n<li><p>The <a href=\"https://retrocomputing.stackexchange.com/questions/5224/why-were-the-sc-mp-pointers-12-bit-kinda\">National Semiconductor SC/MP</a> has pointers which, when you keep incrementing them, will roll from 0x0FFF to 0x0000 because the increment circuit does not propagate the carry past the lower nybble of the higher byte. So if, for example, I want to do <code>while(*ptr++)</code> to traverse a null-terminated string, then I might wind up with <code>ptr</code> pointing outside of the array.</p></li>\n<li><p>On the <a href=\"https://en.wikipedia.org/wiki/PDP-10\" rel=\"nofollow noreferrer\">PDP-10</a>, because a machine word is longer than an address<sup>1</sup>, a pointer may have tags and other data in the upper half of the word containing the address. In this situation, if incrementing a pointer causes an overflow, that other data might get altered. The same goes for very early Macintoshes, before the ROMs were 32-bit clean.</p></li>\n</ul>\n\n<p>So my question is about whether the C standard says what incrementing a pointer really means. As far as I can tell, the C standard assumes that it should work in bit-wise the same manner as incrementing an integer. But that doesn't always hold, as we have seen. </p>\n\n<p><strong>Can a standards-conforming C compiler emit a simple <code>adda a0, 1</code><sup>2</sup> to increment a pointer, without checking that the presence or lack of carry propagation will not lead to weirdness?</strong></p>\n\n<hr>\n\n<p>1: On the PDP-10, an address is 18 bits wide, but a machine word is 36 bits wide. A machine word may hold either two pointers (handy for Lisp) or one pointer, plus bitfields which mean things like \"add another level of indirection\", segments, offsets etc. Or a machine word may of course contain no pointers, but that's not relevant to this question.</p>\n\n<p>2: Add one to an address. That's 68000 assembler.</p>\n"}, {"tags": ["c", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1534276494, "post_id": 51848820, "comment_id": 90650961, "body": "Is {1,5,11,5} valid data for disjoint sets as the digit 5 is more than once?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1534276593, "post_id": 51848820, "comment_id": 90651008, "body": "<code>temp=(int*)realloc(temp,sizeof(int));</code> only allocates for 1 <code>int</code>.  I&#39;d expect <code>temp=realloc(temp,sizeof *temp * (in+1));</code> or something like that."}, {"owner": {"reputation": 55, "user_id": 10155583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f61ce0f89927868c783a6c0686c1e636?s=128&d=identicon&r=PG&f=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/10155583/legendary"}, "edited": false, "score": 0, "creation_date": 1534276836, "post_id": 51848820, "comment_id": 90651126, "body": "The data is valid since the problem states that the subsets should be disjoint and in this case {1,5,5} and {11} are disjoint."}, {"owner": {"reputation": 6812, "user_id": 1410303, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UVBNS.png?s=128&g=1", "display_name": "SomeDude", "link": "https://stackoverflow.com/users/1410303/somedude"}, "edited": false, "score": 1, "creation_date": 1534277030, "post_id": 51848820, "comment_id": 90651219, "body": "Your question has some problems to address: a) It states &quot;given a set...&quot; and then one of your examples is {1, 5, 11, 5} which is not a set. b) And then it says &quot;can be partitioned into two disjoint sets...&quot; which means to me that you cannot leave out certain items from the given set. The disjoint sets when combined should give back the original set. But one of your examples {1, 2,3, 4} and sum = 4 , the solution is {1,3}, {4} and you left 2 out. So make the problem statement clear."}, {"owner": {"reputation": 55, "user_id": 10155583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f61ce0f89927868c783a6c0686c1e636?s=128&d=identicon&r=PG&f=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/10155583/legendary"}, "edited": false, "score": 1, "creation_date": 1534277525, "post_id": 51848820, "comment_id": 90651429, "body": "The program is supposed to take a set as an input, I have used a brute force algorithm to generate the power set of the given set. Now, I have to find two subsets such that their sum is equal and these two subsets should be disjoint."}, {"owner": {"reputation": 55, "user_id": 10155583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f61ce0f89927868c783a6c0686c1e636?s=128&d=identicon&r=PG&f=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/10155583/legendary"}, "edited": false, "score": 0, "creation_date": 1534277585, "post_id": 51848820, "comment_id": 90651446, "body": "I was using an arbitrary input which technically is not a set but the program should still give me the correct output based on the logic I&#39;m using."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1534278998, "post_id": 51848820, "comment_id": 90651995, "body": "Technically not a set mean not a set, no &quot;technically&quot; about it. Perhaps a case of Garbage In Garbage Out? You do seem to have a dependency on only unique data in the <code>te</code> loop that has the test <code>if(temp[te]==arr[j])</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 1, "last_activity_date": 1534369107, "creation_date": 1534369107, "answer_id": 51866821, "question_id": 51848820, "link": "https://stackoverflow.com/questions/51848820/algorithms-to-determine-whether-a-given-set-has-two-subsets-which-are-disjoint/51866821#51866821", "title": "Algorithms: To determine whether a given set has two subsets which are disjoint such that sum of elements in both subsets is same?", "body": "<p>You may find the following to be a place to start. What this sample program does is to take a set of values and then generate as possible disjoint subsets where the sum of the elements of each subset are equal between the two subsets.</p>\n\n<p>I am not sure if this actually answers your question. The requirements specified are quite loose. The source you provide does not compile with Visual Studio and when a few basic compile errors were corrected the resulting program crashed. I also find your example output confusing.</p>\n\n<p>The criteria for disjoint subsets as created by this program are:</p>\n\n<ul>\n<li>values in one subset can not appear in the other</li>\n<li>membership is ordered and tracked via an index assigned to each element of the superset</li>\n<li>a subset may have duplicate values but not duplicate indexed elements</li>\n<li>the empty set is not considered to be a valid disjoint subset since it has no elements</li>\n<li>there must be at least two subsets that can be formed from the set</li>\n<li>only two subsets are considered and there may be more (e.g. {1, 2, 3, 4, 5} could have {2,3}, {1,4}, {5}).</li>\n</ul>\n\n<p>The source code follows. This is from a single C source code file that is part of a Visual Studio C++ solution with the C++ <code>main()</code> calling the C source code entry point of <code>mymain2()</code>. I did it that way because it was easier for me.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\ntypedef struct {\n    int *pSet;        // array of values. array is malloced when max number is known.\n    int  nSetMax;     // max number of array elements, amount malloced.\n    int  nSetCur;     // current number of in use array elements.\n} SetType;\n\nstatic void generateSet (int i, int arr[], int n, SetType *temp)\n{\n    int j;\n\n    temp-&gt;nSetCur = 0;\n    for (j = 0; j &lt; n; j++)\n    {\n        if ( i &amp; (1 &lt;&lt; j))\n        {\n            int te;\n            int flag = 0;\n\n            for (te = 0; te &lt; temp-&gt;nSetCur; te++)\n            {\n                // we compute disjoint property by the order of the elements in\n                // the set using element index in order to allow duplicate values per\n                // request of the question. Exampe 1, 5, 11, 5 as list of values.\n                if (temp-&gt;pSet[te] == j)\n                    flag = 1;\n            }\n            if (flag == 1)\n                continue;\n            temp-&gt;pSet[temp-&gt;nSetCur] = j;\n            temp-&gt;nSetCur++;\n        }\n    }\n}\n\nstatic void printItems (int arr[], const SetType temp)\n{\n    if (temp.nSetCur &gt; 0) {\n        int j;\n        int sum = 0;\n\n        printf(\"    {\");\n        for (j = 0; j &lt; temp.nSetCur; j++) {\n            printf(\"%2d \", arr[temp.pSet[j]]);\n            sum += arr[temp.pSet[j]];\n        }\n        printf(\"} = %3d\\n\", sum);\n    } else\n        printf (\"    {}\\n\");\n}\n\n// determine if the two sets are disjoint by comparing the element indexes\n// of the elements in each subset. the element index is the position of the\n// subset element in the set from which the subset was drawn.\nstatic int checkSetsByIndex (const SetType tempI, const SetType tempR)\n{\n    int i;\n\n    for (i = 0; i &lt; tempI.nSetCur; i++) {\n        int j;\n        for (j = 0; j &lt; tempR.nSetCur; j++) {\n            if (tempI.pSet[i] == tempR.pSet[j])\n                return 0;\n        }\n    }\n\n    return 1;\n}\n\n// determine if the two sets are disjoint by comparing the element values\n// of the elements in each subset. the element value is the value of the\n// subset element in the set from which the subset was drawn.\n// we may have duplicate values but as long as they are not in two different\n// subsets then we allow it.\nstatic int checkSetsByValue (int arr[], const SetType tempI, const SetType tempR)\n{\n    int i;\n\n#if 1\n    // following code does a check that the two sets are disjoint by value\n    // meaning they do not share any values. however a set may have multiple\n    // elements with the same value.\n    // if not needed then you can turn it off with Preprocessor check.\n    for (i = 0; i &lt; tempI.nSetCur; i++) {\n        int j;\n        for (j = 0; j &lt; tempR.nSetCur; j++) {\n            if (arr[tempI.pSet[i]] == arr[tempR.pSet[j]])\n                return 0;\n        }\n    }\n#endif\n\n    return 1;\n}\n\nstatic void partition(int arr[], int n)\n{\n    int i;\n    int iPow2n = pow(2, n);\n    int *sum = calloc(iPow2n, sizeof(int));\n\n    printf (\"Generate and list sums\\n\");\n    for(i = 0; i &lt; iPow2n; i++)\n    {\n        int j;\n        printf(\"  {\");\n        for (j = 0; j &lt; n; j++)\n        {\n            if (i &amp; (1 &lt;&lt; j))\n            {\n                printf(\"%2d \", arr[j]);\n                sum[i] = sum[i] + arr[j];\n            }\n        }\n        printf(\"} = %3d\\n\", sum[i]);\n    }\n\n    printf(\"\\n\\nGenerate list of disjoint sets for each sum.\\n\");\n\n    for (i = 0; i &lt; iPow2n - 1; i++)\n    {\n        int r;\n        SetType tempI = {calloc(iPow2n, sizeof(SetType)), iPow2n, 0};\n        SetType tempR = {calloc(iPow2n, sizeof(SetType)), iPow2n, 0};\n\n        for(r = i + 1; r &lt; iPow2n; r++)\n        {\n            if(sum[i] == sum[r])\n            {\n                generateSet (i, arr, n, &amp;tempI);\n                generateSet (r, arr, n, &amp;tempR);\n                // check disjoint subsets by looking at the index of the\n                // subset elements where the index is the index of the original\n                // set from which the subset is drawn.\n                if (checkSetsByIndex (tempI, tempR)) {\n                    // check that the two subsets are disjoint by element values\n                    // as well. this means that while a subset may have duplicate\n                    // values, the elements of each subset must be disjoint can not\n                    // have elements whose values are the same.\n                    // so if we have a set {1, 5, 11, 5} then subsets of\n                    // {5}, {5} is invalid but {1, 5, 5}, {11} is valid.\n                    if (checkSetsByValue (arr, tempI, tempR)) {\n                        printf(\"\\n Printing solution for sum %d\\n\", sum[i]);\n                        printItems (arr, tempI);\n                        printItems (arr, tempR);\n                        break;\n                    }\n                }\n            }\n        }\n        free(tempI.pSet);\n        free(tempR.pSet);\n    }\n}\n\nint mymain2(void)\n{\n    int n;\n    printf(\"\\n Enter the number of elements in the set \\n\");\n    scanf(\"%d\",&amp;n);\n\n    if (n &gt; 0) {\n        int i;\n        int *arr = malloc(sizeof(int) * n);\n        printf(\"\\n Enter the set elements \\n\");\n        for (i = 0; i &lt; n; i++)\n        {\n            scanf(\"%d\",&amp;arr[i]);\n        }\n        partition(arr,n);\n\n        free (arr);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>For a set of 4 values whose elements are {1, 2, 3, 4} it generates the following output:</p>\n\n<pre><code> Enter the number of elements in the set\n4\n\n Enter the set elements\n1 2 3 4\nGenerate and list sums\n  {} =   0\n  { 1 } =   1\n  { 2 } =   2\n  { 1  2 } =   3\n  { 3 } =   3\n  { 1  3 } =   4\n  { 2  3 } =   5\n  { 1  2  3 } =   6\n  { 4 } =   4\n  { 1  4 } =   5\n  { 2  4 } =   6\n  { 1  2  4 } =   7\n  { 3  4 } =   7\n  { 1  3  4 } =   8\n  { 2  3  4 } =   9\n  { 1  2  3  4 } =  10\n\n\nGenerate list of disjoint sets for each sum.\n\n Printing solution for sum 3\n    { 1  2 } =   3\n    { 3 } =   3\n\n Printing solution for sum 4\n    { 1  3 } =   4\n    { 4 } =   4\n\n Printing solution for sum 5\n    { 2  3 } =   5\n    { 1  4 } =   5\n</code></pre>\n\n<p>For a set of 4 values {1, 5, 11, 5} it generates the following output:</p>\n\n<pre><code> Enter the number of elements in the set\n4\n\n Enter the set elements\n1 5 11 5\nGenerate and list sums\n  {} =   0\n  { 1 } =   1\n  { 5 } =   5\n  { 1  5 } =   6\n  {11 } =  11\n  { 1 11 } =  12\n  { 5 11 } =  16\n  { 1  5 11 } =  17\n  { 5 } =   5\n  { 1  5 } =   6\n  { 5  5 } =  10\n  { 1  5  5 } =  11\n  {11  5 } =  16\n  { 1 11  5 } =  17\n  { 5 11  5 } =  21\n  { 1  5 11  5 } =  22\n\n\nGenerate list of disjoint sets for each sum.\n\n Printing solution for sum 11\n    {11 } =  11\n    { 1  5  5 } =  11\n</code></pre>\n\n<p>For a set of 5 values {1, 2, 3, 4, 5} it generates the following output:</p>\n\n<pre><code> Enter the number of elements in the set\n5\n\n Enter the set elements\n1 2 3 4 5\nGenerate and list sums\n  {} =   0\n  { 1 } =   1\n  { 2 } =   2\n  { 1  2 } =   3\n  { 3 } =   3\n  { 1  3 } =   4\n  { 2  3 } =   5\n  { 1  2  3 } =   6\n  { 4 } =   4\n  { 1  4 } =   5\n  { 2  4 } =   6\n  { 1  2  4 } =   7\n  { 3  4 } =   7\n  { 1  3  4 } =   8\n  { 2  3  4 } =   9\n  { 1  2  3  4 } =  10\n  { 5 } =   5\n  { 1  5 } =   6\n  { 2  5 } =   7\n  { 1  2  5 } =   8\n  { 3  5 } =   8\n  { 1  3  5 } =   9\n  { 2  3  5 } =  10\n  { 1  2  3  5 } =  11\n  { 4  5 } =   9\n  { 1  4  5 } =  10\n  { 2  4  5 } =  11\n  { 1  2  4  5 } =  12\n  { 3  4  5 } =  12\n  { 1  3  4  5 } =  13\n  { 2  3  4  5 } =  14\n  { 1  2  3  4  5 } =  15\n\n\nGenerate list of disjoint sets for each sum.\n\n Printing solution for sum 3\n    { 1  2 } =   3\n    { 3 } =   3\n\n Printing solution for sum 4\n    { 1  3 } =   4\n    { 4 } =   4\n\n Printing solution for sum 5\n    { 2  3 } =   5\n    { 1  4 } =   5\n\n Printing solution for sum 5\n    { 1  4 } =   5\n    { 5 } =   5\n\n Printing solution for sum 6\n    { 2  4 } =   6\n    { 1  5 } =   6\n\n Printing solution for sum 7\n    { 3  4 } =   7\n    { 2  5 } =   7\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1534374503, "last_edit_date": 1534374503, "creation_date": 1534373023, "answer_id": 51867436, "question_id": 51848820, "link": "https://stackoverflow.com/questions/51848820/algorithms-to-determine-whether-a-given-set-has-two-subsets-which-are-disjoint/51867436#51867436", "title": "Algorithms: To determine whether a given set has two subsets which are disjoint such that sum of elements in both subsets is same?", "body": "<p>Your algorithm is too complicated. You start on the correct path, computing the sum of all subsets of the set, but you do not correctly compute all possible disjoint subsets to try and find one with the same sum.</p>\n\n<p>Here is a simpler approach:</p>\n\n<ul>\n<li>enumerate all subsets</li>\n<li>for each subset, compute the sum and store a structure with the subset signature and its sum into an array.</li>\n<li>sort the array by the value of the sum</li>\n<li>iterate over the sorted array:</li>\n<li>for each element, iterate over the subsequent elements with the same sum, if one of them has a disjoint subset signature, you have a match, print it.</li>\n<li>the space complexity is <strong>O(2<sup>N</sup>)</strong> and the time complexity is even worse at <strong>O(2<sup>N+1</sup>)</strong>, which is very bad, but manageable for small sets.</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct s { int sig, sum; };\n\nint compare(const void *p1, const void *p2) {\n    int sum1 = ((const struct s*)p1)-&gt;sum;\n    int sum2 = ((const struct s*)p2)-&gt;sum;\n    return (sum1 &gt; sum2) - (sum1 &lt; sum2);\n}\n\nvoid print_set(int arr[], size_t sig) {\n    printf(\"{\");\n    while (sig) {\n        if (sig &amp; 1)\n            printf(\" %d\", *arr);\n        arr++;\n        sig &gt;&gt;= 1;\n    }\n    printf(\" } \");\n}\n\nvoid partition(int arr[], int n) {\n    size_t i, j, count = 1ULL &lt;&lt; n;\n    struct s *array = calloc(sizeof(*array), count);\n    int b, sum;\n\n    if (array != NULL) {\n        for (i = 1; i &lt; count; i++) {\n            sum = 0;\n            for (b = 0; b &lt; n; b++) {\n                if (i &amp; (1ULL &lt;&lt; b))\n                    sum += arr[b];\n            }\n            array[i].sig = i;\n            array[i].sum = sum;\n        }\n        qsort(array, count, sizeof(*array), compare);\n        for (i = 0; i &lt; count; i++) {\n            for (j = i + 1; j &lt; count &amp;&amp; array[i].sum == array[j].sum; j++) {\n                if ((array[i].sig &amp; array[j].sig) == 0) {\n                    printf(\"solution with sum=%d: \", array[i].sum);\n                    print_set(arr, array[i].sig);\n                    print_set(arr, array[j].sig);\n                    printf(\"\\n\");\n                }\n            }\n        }\n        free(array);\n    }\n}\n\nint main() {\n    int *arr, n, i;\n    printf(\"Enter the number of elements in the set: \");\n    if (scanf(\"%d\", &amp;n) == 1) {\n        arr = (int*)malloc(sizeof(int) * n);\n        if (arr != NULL) {\n            printf(\"Enter the set elements: \");\n            for (i = 0; i &lt; n; i++) {\n                if (scanf(\"%d\", &amp;arr[i]) != 1)\n                    return 1;\n            }\n            partition(arr, n);\n            free(arr);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Enter the number of elements in the set: 3\nEnter the set elements:  1 2 3\nsolution with sum=3: { 3 } { 1 2 } \n\nEnter the number of elements in the set: 4\nEnter the set elements: 1 2 3 4\nsolution with sum=3: { 1 2 } { 3 }\nsolution with sum=4: { 4 } { 1 3 }\nsolution with sum=5: { 2 3 } { 1 4 }\n\nEnter the number of elements in the set: 4\nEnter the set elements: 1 5 11 5\nsolution with sum=5: { 5 } { 5 }\nsolution with sum=11: { 11 } { 1 5 5 }\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10155583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f61ce0f89927868c783a6c0686c1e636?s=128&d=identicon&r=PG&f=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/10155583/legendary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 51867436, "answer_count": 2, "score": 4, "last_activity_date": 1534374503, "creation_date": 1534276201, "last_edit_date": 1534372389, "question_id": 51848820, "link": "https://stackoverflow.com/questions/51848820/algorithms-to-determine-whether-a-given-set-has-two-subsets-which-are-disjoint", "title": "Algorithms: To determine whether a given set has two subsets which are disjoint such that sum of elements in both subsets is same?", "body": "<p>Here is the code that I have written:-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint ctr = 0;\n\nvoid partition(int arr[], int n) {\n    int i, j, k = 0, r, in = 0, te, flag = 0;\n    int *sum;\n    sum = (int*)malloc(sizeof(int) * pow(2, n));\n    for (i = 0; i &lt; pow(2, n); i++) {\n        printf(\"{\");\n        for (j = 0; j &lt; n; j++) {\n            if (i &amp; (1 &lt;&lt; j)) {\n                printf(\"%d \", arr[j]);\n                sum[k] = sum[k] + arr[j];\n            }\n        }\n        k++;\n        printf(\"}\");\n        printf(\"\\n\");\n    }\n    printf(\"\\n \\n\");\n\n    int *temp;\n    for (k = 0; k &lt; pow(2, n) - 1; k++) {\n        in = 0;\n        temp = (int*)malloc(sizeof(int));\n        for (r = k + 1; r &lt; pow(2, n); r++) {\n            if (sum[k] == sum[r]) {\n                printf(\"\\n Printing solution for sum %d\", sum[k]);\n                for (i = 0; i &lt; pow(2, n); i++) {\n                    if (i == k || i == r) {\n                        printf(\"{\");\n                        for (j = 0; j &lt; n; j++) {\n                            if (i &amp; 1 &lt;&lt; j) {\n                                for (te = 0; te &lt; in; te++) { //Disjointness\n                                    if (temp[te] == arr[j])\n                                        flag = 1;\n                                }\n                                if (flag == 1)\n                                    break;\n                                temp[in++] = arr[j];\n                                temp = (int*)realloc(temp, sizeof(int));\n                                printf(\"%d \", arr[j]);\n                            }\n                        }\n                        printf(\"}\");\n                        printf(\"\\n\");\n                    }\n                }\n                break;          \n            }\n        }\n        free(temp);\n    }\n}\n\nvoid main() {\n    int *arr, n, i;\n    printf(\"\\n Enter the number of elements in the set \\n\");\n    scanf(\"%d\", &amp;n);\n    arr = (int*)malloc(sizeof(int) * n);\n    printf(\"\\n Enter the set elements \\n\");\n    for (i = 0; i &lt; n; i++) {\n        scanf(\"%d\", &amp;arr[i]);\n    }\n    partition(arr, n);\n}\n</code></pre>\n\n<p>It works perfectly for the input <code>{1,2,3}</code>. For <code>{1,2,3,4}</code>, it gives the correct output as well.</p>\n\n<p>For <code>{1,2,3,4}</code>, the output is:</p>\n\n<pre><code>Printing solution for sum 3{1 2 }\n{3 }\n\n Printing solution for sum 4{1 3 }\n{4 }\n\n Printing solution for sum 5{2 3 }\n{1 4 }\n\n Printing solution for sum 6{1 2 3 }\n{}\n\n Printing solution for sum 7{}\n{}\n</code></pre>\n\n<p>But if the input is {1,5,11,5}, the output is:</p>\n\n<pre><code> Printing solution for sum 5{5 }\n{}\n\n Printing solution for sum 6{}\n{}\n\n Printing solution for sum 11{}\n{}\n\n Printing solution for sum 16{}\n{}\n\n Printing solution for sum 17{}\n{}\n</code></pre>\n\n<p>Since <code>{1,5,5}</code> and <code>{11}</code> is a solution, in this case, the expected output should be <code>Printing Solution for sum 11 {1,5,5} and {11}</code> but it's not displaying that.</p>\n\n<p>What is the problem and how can I fix it?</p>\n"}, {"tags": ["c", "strcmp"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 7, "creation_date": 1534274567, "post_id": 51848446, "comment_id": 90650175, "body": "<code>scanf(&quot;%s&quot;,&amp;string1);</code>  -&gt; <code>scanf(&quot;%s&quot;,string1);</code>, same for <code>string2</code>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1534274795, "post_id": 51848446, "comment_id": 90650274, "body": "Can we make a rule that a MCVE does not use <code>scanf</code> unless the question is specifically about <code>scanf</code>?  Or just user-input in general.  If you want to experiment with <code>strcmp</code>, try using hard-coded strings that you know are good rather than adding another thing that can go wrong."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534274857, "post_id": 51848446, "comment_id": 90650302, "body": "@ChristianGibbons in this particular case the problem IS in usage of <code>scanf</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1534274978, "post_id": 51848446, "comment_id": 90650347, "body": "<code>scanf(&quot;%s&quot;,&amp;string1);</code> isn&#39;t that the same thing as <code>scanf(&quot;%s&quot;,string1);</code> for arrays? (although the second is the proper way)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534275008, "post_id": 51848446, "comment_id": 90650356, "body": "@SergeyA That&#39;s my point.  The question is asking about the behavior of <code>strcmp</code>, but the error was in <code>scanf</code> instead.  Seems to be a lot of questions asking about the behavior of one thing, only for the problem to be in taking user input."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1534275031, "post_id": 51848446, "comment_id": 90650361, "body": "@Jean-Fran&#231;oisFabre The values will probably be the same but not the types, so the compiler is free to do strange things."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534275080, "post_id": 51848446, "comment_id": 90650375, "body": "@ChristianGibbons I have tried this on meta that didn&#39;t went well: <a href=\"https://meta.stackoverflow.com/questions/364431/add-a-no-interactive-code-warning-on-the-mcve-help-page\" title=\"add a no interactive code warning on the mcve help page\">meta.stackoverflow.com/questions/364431/&hellip;</a>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1534275118, "post_id": 51848446, "comment_id": 90650385, "body": "anyway: OP is stating that <code>strcmp</code> doesn&#39;t work..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1534275236, "post_id": 51848446, "comment_id": 90650434, "body": "Using <code>&amp;</code> certainly won&#39;t be the same if the array is a function argument."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1534275490, "post_id": 51848446, "comment_id": 90650544, "body": "Start by assigning known values to <code>string1</code> and <code>string2</code> directly and not using <code>scanf</code> at all.  IOW, do something like <code>char string1[20] = &quot;foo&quot;; char string2[20] = &quot;bar&quot;; int test = strcmp( string1, string2 );...</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1534275563, "post_id": 51848446, "comment_id": 90650584, "body": "@Jean-Fran&#231;oisFabre That&#39;s a shame.  Well now it&#39;s only voted down to -7."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1534275691, "post_id": 51848446, "comment_id": 90650627, "body": "What is the <b>exact</b> input you&#39;re giving to the program?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1534275787, "post_id": 51848446, "comment_id": 90650668, "body": "@ChristianGibbons call to scanf do invoke UB here but there&#39;s a pretty good chance the compiler actually did what OP expected it to do. I haven&#39;t seen a compiler that would do something nasty/unexpected here. We don&#39;t know what inputs OP has tested though. Perhaps the problem is in the input data itself. If so, fixing scanf woildn&#39;t help."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1534275875, "post_id": 51848446, "comment_id": 90650712, "body": "@dbush: That is unlikely to be the cause of the problem. Likely in whatever C implementation OP is using, the address of the array is the same as the address of its first character."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1534275906, "post_id": 51848446, "comment_id": 90650721, "body": "@n.m. But having hard-coded values instead of <code>scanf</code> would further help as it would give us the test data."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534275966, "post_id": 51848446, "comment_id": 90650748, "body": "OP\u2019s program works as expected for me. I suspect their input is not being interpreted by <code>scanf</code> in the way they expect. An MCVE including input is required."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534276138, "post_id": 51848446, "comment_id": 90650811, "body": "Please provide the exact inputs as requested by @dbush."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1534278242, "post_id": 51848446, "comment_id": 90651702, "body": "And please have the program print what it reads so that you can see that it is working on the data you think it is working on."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1534275628, "last_edit_date": 1534275628, "creation_date": 1534275345, "answer_id": 51848641, "question_id": 51848446, "link": "https://stackoverflow.com/questions/51848446/strcmp-function-in-c/51848641#51848641", "title": "strcmp() function in C", "body": "<p><code>strcmp</code> is unlikely the problem. Here are a few things you can do to troubleshoot the problem.</p>\n\n<ol>\n<li>Make sure to prevent overflow when using <code>scanf</code>.</li>\n<li>Make sure that the calls to <code>scanf</code> are successful.</li>\n<li>Add a line of code to print what was read so you know the values being passed to <code>strcmp</code>.</li>\n<li>You don't need to use <code>&amp;string1</code> to read a string. Use just <code>string1</code>. Same with <code>string2</code>.</li>\n</ol>\n\n<hr>\n\n<pre><code>printf(\"Enter 'string1'\\n\");\n\n// Read at most 19 characters from the stream, leaving space\n// for the null terminator.\n\nif ( scanf(\"%19s\", string1) != 1 )\n{\n   // Problem reading into string1.\n   printf(\"Unable to read string1\\n\");\n}\n\nprintf(\"Enter 'string2'\\n\");\nif ( scanf(\"%19s\", string2) != 1 )\n{\n   // Problem reading into string2.\n   printf(\"Unable to read string2\\n\");\n}\n\nprintf(\"Input strings...\\nstring1: \\\"%s\\\", string2: \\\"%s\\\"\\n\", string1, string2);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1534275498, "post_id": 51848662, "comment_id": 90650549, "body": "Not my DV, but the space before <code>%s</code> is not necessary, since the <code>%s</code> format filters whitespace anyway (as does <code>%d</code> format). It might need to be before <code>%c</code> format or <code>%[]</code> format specs. It doesn&#39;t answer the question."}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1534275535, "post_id": 51848662, "comment_id": 90650567, "body": "Yeah, but I like always clean the buffer"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534275583, "post_id": 51848662, "comment_id": 90650594, "body": "While it is not proper to pass a pointer to an array of <code>char</code> to <code>scanf</code> when scanning a string, it is unlikely to be the cause of OP\u2019s problem."}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1534275687, "post_id": 51848662, "comment_id": 90650625, "body": "@WeatherVane I did not answer the question?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1534276009, "post_id": 51848662, "comment_id": 90650766, "body": "The above comment from @EricPostpischil says it is unlikely to be the cause of the problem. My compilation of the code works as expected, although my inputs are &lt; 20 length and contain no spaces."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1534276197, "post_id": 51848662, "comment_id": 90650833, "body": "You can also avoid buffer overrun with <code>scanf(&quot;%19s&quot;, str);</code>."}, {"owner": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534280503, "post_id": 51848662, "comment_id": 90652671, "body": "I already do this but I&#39;m geting the same problem.Maybe i can try with fread(string1, 20, stdin) but thats not the point."}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "reply_to_user": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534280708, "post_id": 51848662, "comment_id": 90652767, "body": "@tarik Put the printscreen please, it&#39;s impossible, look that <a href=\"https://ideone.com/45toWA\" rel=\"nofollow noreferrer\">ideone.com/45toWA</a>"}, {"owner": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534280952, "post_id": 51848662, "comment_id": 90652856, "body": "here it is the link :<a href=\"https://ibb.co/mHaJO9\" rel=\"nofollow noreferrer\">ibb.co/mHaJO9</a>"}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "reply_to_user": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534281563, "post_id": 51848662, "comment_id": 90653063, "body": "@tarik the code is right, the problem is that you dont know how the function strcmp() works, look at this <a href=\"https://www.programiz.com/c-programming/library-function/string.h/strcmp\" rel=\"nofollow noreferrer\">programiz.com/c-programming/library-function/string.h/strcmp</a>  The strcmp() goes from character to character and compares which is greater (ascii table)"}, {"owner": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534283017, "post_id": 51848662, "comment_id": 90653549, "body": "@F&#225;bioMorais Thank you very much for this article,now I know how the comparison work but i don&#39;t know how I always get &#39;1&#39; or &#39;-1&#39; ,for example if i compare &#39;a&#39; with &#39;A&#39; i must to get the value 32 not -1 or 1"}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "edited": false, "score": 0, "creation_date": 1534283404, "post_id": 51848662, "comment_id": 90653673, "body": "that&#39;s really weird, look that <a href=\"https://ideone.com/XQXuTr\" rel=\"nofollow noreferrer\">ideone.com/XQXuTr</a> and that <a href=\"https://ideone.com/NgZcJx\" rel=\"nofollow noreferrer\">ideone.com/NgZcJx</a>"}, {"owner": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534283925, "post_id": 51848662, "comment_id": 90653826, "body": "yes that&#39;s weird :<a href=\"https://ibb.co/bBe1t9\" rel=\"nofollow noreferrer\">ibb.co/bBe1t9</a>"}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "edited": false, "score": 0, "creation_date": 1534284127, "post_id": 51848662, "comment_id": 90653891, "body": "Damn,  put the space before %s like this <code>scanf(&quot; %s&quot;, string1);</code> and try again"}, {"owner": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534284607, "post_id": 51848662, "comment_id": 90654025, "body": "@F&#225;bioMorais nothing,the same thing"}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "edited": false, "score": 0, "creation_date": 1534284994, "post_id": 51848662, "comment_id": 90654158, "body": "Put this <code>char string1[20]=&quot;abCd&quot; </code> and <code>char string2[20]=&quot;abcd &quot;</code> and see if this works"}, {"owner": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "edited": false, "score": 0, "creation_date": 1534350661, "post_id": 51848662, "comment_id": 90677702, "body": "i have tried but  the problem is stil there. is that the problem with compiler or something else?"}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "edited": false, "score": 0, "creation_date": 1534351981, "post_id": 51848662, "comment_id": 90678311, "body": "yeah, maybe, go to <code>project-&gt; build options</code> and select the <code>GNU GCC COMPILER</code>"}, {"owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "edited": false, "score": 0, "creation_date": 1534352390, "post_id": 51848662, "comment_id": 90678496, "body": "go to <code>Edit-&gt;File encoding-&gt;system default</code>"}], "tags": [], "owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "is_accepted": false, "score": 1, "last_activity_date": 1534280808, "last_edit_date": 1534280808, "creation_date": 1534275431, "answer_id": 51848662, "question_id": 51848446, "link": "https://stackoverflow.com/questions/51848446/strcmp-function-in-c/51848662#51848662", "title": "strcmp() function in C", "body": "<p>You should write like this, because the problem is in the <code>scanf</code>:</p>\n\n<pre><code>printf(\"Enter 'string1'\\n\");\nscanf(\"%s\",string1);\nprintf(\"Enter 'string2'\\n\");\nscanf(\"%s\",string2);\n</code></pre>\n\n<p>Don't use the  <code>&amp;</code> when you try read a string/pointer.</p>\n\n<p>E.g:</p>\n\n<pre><code>char *str;\nscanf(\"%s\", str);\n</code></pre>\n\n<p>You can use the <code>fread(string1, 20, stdin)</code> to previne the string overflow</p>\n\n<p>You can try the code <a href=\"https://ideone.com/45toWA\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "is_accepted": false, "score": 0, "last_activity_date": 1534288755, "creation_date": 1534288755, "answer_id": 51850944, "question_id": 51848446, "link": "https://stackoverflow.com/questions/51848446/strcmp-function-in-c/51850944#51850944", "title": "strcmp() function in C", "body": "<p>The problem in your code is that while receiving string from the user , you are storing the string using <code>scanf(\"%s\",&amp;string1)</code> , You need to understand that <code>&amp;string1</code> and <code>string1</code> both gives the same address,but they both are very much different.When you increment <code>&amp;string1</code> ,it points to 80 bytes further from the base address because on incrementing a pointer it points to the same location of its type ,<code>&amp;string1</code> means base address of whole array while <code>string1</code> means address of the first element,so when you increment it ,it points to 4 bytes further from the base address.So when you give an address to scanf to store a string ,be careful what type of address you are giving otherwise it may give you some undefined behaviour.In your program just in place of <code>&amp;string1</code> use <code>string1</code> in scanf to receive string, the remaining program is correct.</p>\n"}], "owner": {"reputation": 21, "user_id": 10069993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada7ff319f56d6447a842de7fc2c1498?s=128&d=identicon&r=PG&f=1", "display_name": "tarik", "link": "https://stackoverflow.com/users/10069993/tarik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "closed_date": 1534319181, "answer_count": 3, "score": -1, "last_activity_date": 1534288755, "creation_date": 1534274444, "question_id": 51848446, "link": "https://stackoverflow.com/questions/51848446/strcmp-function-in-c", "closed_reason": "Not suitable for this site", "title": "strcmp() function in C", "body": "<p>I'm using the strcmp() fucntions to test how it works.</p>\n\n<p>Ok,there is strcmp(string1,string2) that says us is ti string1 greater or smaller than string2 .</p>\n\n<p>Here is my code to test this function:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n char string1[20];\n char string2[20];\nint main()\n{\n    int test;\n\n    printf(\"Enter 'string1'\\n\");\n    scanf(\"%s\",&amp;string1);\n    printf(\"Enter 'string2'\\n\");\n    scanf(\"%s\",&amp;string2);\n\n    test=strcmp(string1,string2);\n\n    if(test&gt;0)\n        printf(\"String 'string1' is greater than 'string2'\\n\");\n    else if(test&lt;0)\n        printf(\"String 'string1' is less than 'string2'\\n\");\n    else if(test==0)\n        printf(\"\\n String 'string1'is equal to 'string2'\");\n\n        printf(\"\\n The value of 'test' is :%d\",test);\n\n        return 0;\n}\n</code></pre>\n\n<p>the test variable is always 1 and 'string1' is always greater than 'string2' .\npls help</p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1534273983, "post_id": 51848243, "comment_id": 90649953, "body": "I don&#39;t know, but I&#39;d guess top is nothing more than a pretty ncurses wrapper on top of all the system calls that retrieve this information. Your answer is probably in the kernel memory management implementation details, not in top."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534274459, "post_id": 51848243, "comment_id": 90650136, "body": "This seems to be more of a question about the <code>top</code> utility than programming.  Might be more suited for the Unix/Linux stack exchangel."}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 3, "last_activity_date": 1534275940, "creation_date": 1534275940, "answer_id": 51848769, "question_id": 51848243, "link": "https://stackoverflow.com/questions/51848243/how-does-top-activity-monitor-update-memory-usage-as-the-heap-is-written-to/51848769#51848769", "title": "How does top (Activity Monitor) update memory usage as the heap is written to? (C)", "body": "<p>Most modern operating systems allocate real memory lazily, only providing the memory when an attempt is made to use it. You can increase the heap as much as you want without using any memory at all; the only effect is to allocate virtual memory addresses.</p>\n\n<p>Only when you actually touch a page, for example by writing to it, is the memory actually given to the process.</p>\n\n<p>One of the consequences is that <code>malloc()</code> can succeed even if no physical memory is available.</p>\n\n<p>If you actually use <code>top</code> you will see both the virtual memory allocation (which is only an allocation of virtual addresses) and the memory actually in use (the \"resident set\").</p>\n"}], "owner": {"reputation": 25756, "user_id": 925913, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69de717f8f47bc852b7e452d890ef166?s=128&d=identicon&r=PG&f=1", "display_name": "slackwing", "link": "https://stackoverflow.com/users/925913/slackwing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 51848769, "answer_count": 1, "score": 1, "last_activity_date": 1534275940, "creation_date": 1534273498, "question_id": 51848243, "link": "https://stackoverflow.com/questions/51848243/how-does-top-activity-monitor-update-memory-usage-as-the-heap-is-written-to", "title": "How does top (Activity Monitor) update memory usage as the heap is written to? (C)", "body": "<p>My friend implemented a dynamic array to learn C. When out of allocated memory, he doubles the allocated space.</p>\n\n<p>We watched his test program write 4 GB of random characters (to avoid memory compression), char by char. But the Activity Monitor (on Mac, based on <code>top</code>) showed memory usage increasing gradually, not doubling on each extend.</p>\n\n<p>Yet on deletion/compaction, memory usage would drop immediately and exactly as the code would free memory.</p>\n\n<p>How does top track \"actual\" memory used within an allocated range? And why would it do this, if the rest of the allocated space isn't available for use by other processes anyway?</p>\n"}, {"tags": ["c", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 6, "creation_date": 1534272489, "post_id": 51847970, "comment_id": 90649272, "body": "I\u2019m confused. Since you\u2019re not using the a and b for anything, why are they there? And doesn\u2019t this return zero in all cases anyway?"}, {"owner": {"reputation": 1229, "user_id": 7151380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CGs59.png?s=128&g=1", "display_name": "Alerra", "link": "https://stackoverflow.com/users/7151380/alerra"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1534272929, "post_id": 51847970, "comment_id": 90649460, "body": "Indeed, as @SamiKuhmonen said, this code will always return 0. Perhaps your professor was wanting you to fix this problem instead of the &#39;abstraction&#39; problem? In my eyes, the &#39;abstraction&#39; problem really isn&#39;t a problem, but more of a feature as you can specify starting values for the fibonacci calculator."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1534274314, "post_id": 51847970, "comment_id": 90650074, "body": "Have you tested your idea? Does it work? <a href=\"https://ideone.com/eTnMAb\" rel=\"nofollow noreferrer\">I don&#39;t think the 5th Fibonacci number is zero</a> but perhaps I miss something?"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1534278762, "post_id": 51847970, "comment_id": 90651894, "body": "The 5th fibonacci number is the 4th plus the 3rd. So try to calculate the 4th number. That&#39;s the 3rd plus the 2nd. So calculate the 3rd.... it&#39;s the 2nd plus the 1st. I think you&#39;re on the right track, holding on to more than one number, but the extra numbers you&#39;re passing around when you call <code>fibo(5,0,1)</code> are the first and second, and those aren&#39;t useful when calculating the 5th."}, {"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534382759, "post_id": 51847970, "comment_id": 90688716, "body": "Oh, my bad. There was a typo in my code. It should return a instead of 0. And more or less, it works. Please recheck the code."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1534273121, "post_id": 51848059, "comment_id": 90649546, "body": "That&#39;s incredibly inefficient."}, {"owner": {"reputation": 353, "user_id": 10192549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a99f5ad8b474757c14670541b556ece?s=128&d=identicon&r=PG&f=1", "display_name": "Simion", "link": "https://stackoverflow.com/users/10192549/simion"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1534273163, "post_id": 51848059, "comment_id": 90649569, "body": "I agree, but is recursion."}, {"owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "edited": false, "score": 0, "creation_date": 1534273973, "post_id": 51848059, "comment_id": 90649946, "body": "Nice answer. I think it would be helpful if you could include the memoization technique in your example so that you would also have given a more efficient program in your answer."}, {"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534382969, "post_id": 51848059, "comment_id": 90688761, "body": "I know about this approach, my professor taught us exactly this method to solve the problem. Please look at the modified code, there was one typo."}, {"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534383500, "post_id": 51848059, "comment_id": 90688847, "body": "The problem with the above mentioned approach is, it builds up two parallel stacks in memory for solving each new term of series. This way, to calculate 1000th term, it will take minutes (may be faster) to come up with the solution. But in my suggested method, it remembers the last two terms of fibonacci and gives nth term without needing to start from scratch every time, as in traditional method."}, {"owner": {"reputation": 101145, "user_id": 1059372, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/W6OMC.png?s=128&g=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/1059372/eugene"}, "edited": false, "score": 0, "creation_date": 1534452668, "post_id": 51848059, "comment_id": 90721841, "body": "@Simion there is an approach to solve this without recursion... <a href=\"https://stackoverflow.com/a/51885162/1059372\">stackoverflow.com/a/51885162/1059372</a>"}, {"owner": {"reputation": 353, "user_id": 10192549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a99f5ad8b474757c14670541b556ece?s=128&d=identicon&r=PG&f=1", "display_name": "Simion", "link": "https://stackoverflow.com/users/10192549/simion"}, "reply_to_user": {"reputation": 101145, "user_id": 1059372, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/W6OMC.png?s=128&g=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/1059372/eugene"}, "edited": false, "score": 0, "creation_date": 1534488855, "post_id": 51848059, "comment_id": 90730610, "body": "@Eugene, i agree, the problem was &quot;Fibonacci using Recursion&quot;."}], "tags": [], "owner": {"reputation": 353, "user_id": 10192549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a99f5ad8b474757c14670541b556ece?s=128&d=identicon&r=PG&f=1", "display_name": "Simion", "link": "https://stackoverflow.com/users/10192549/simion"}, "is_accepted": false, "score": 2, "last_activity_date": 1534275013, "last_edit_date": 1534275013, "creation_date": 1534272716, "answer_id": 51848059, "question_id": 51847970, "link": "https://stackoverflow.com/questions/51847970/fibonacci-using-recursion/51848059#51848059", "title": "Fibonacci using Recursion", "body": "<p>Your result will be <strong><em>0</em></strong>, with your approaches. You just go in recursion, until <strong><em>n=0</em></strong> and at that point return <strong><em>0</em></strong>. But you have also to check when <strong><em>n==1</em></strong> and you should return <strong><em>1</em></strong>; Also you have values <strong><em>a</em></strong> and <strong><em>b</em></strong> and you do nothing with them. </p>\n\n<p>i would suggest to look at the following recursive function, maybe it will help to fix yours:</p>\n\n<pre><code>int fibo(int n){\n    if(n &lt; 2){\n        return n;\n    }\n    else \n    {\n       return (fibo(n-1) + fibo(n-2));    \n    }\n}\n</code></pre>\n\n<p>It's a classical problem in studying recursion. </p>\n\n<p>EDIT1: According to @Ely suggest, bellow is an optimized recursion, with memorization technique. When one value from the list is calculated, it will not be recalculated again as in first example, but it will be stored in the array and taken from that array whenever is required:</p>\n\n<pre><code>const int MAX_FIB_NUMBER = 10;\n\nint storeCalculatedValues[MAX_FIB_NUMBER] = {0};\n\nint fibo(int n){\n\n    if(storeCalculatedValues[n] &gt; 0)\n    {\n        return storeCalculatedValues[n];\n    }\n\n    if(n &lt; 2){\n        storeCalculatedValues[n] = n;\n    }\n    else \n    {\n       storeCalculatedValues[n] = (fibo(n-1) + fibo(n-2));\n    }\n    return storeCalculatedValues[n];\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534383680, "post_id": 51848303, "comment_id": 90688878, "body": "Yes, her answer wasn&#39;t satisfactory to me. The abstraction thing was added by me while posting the question, she didn&#39;t mention it at all. Please recheck the original code again, I&#39;ve corrected the typo."}, {"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534421890, "post_id": 51848303, "comment_id": 90704925, "body": "&quot;if you calculated the nth Fibonacci number once, just reuse the result; no need to redo a calculation&quot; this is exactly my concern for those other solutions. If I wish to print 100 terms of Fibonacci series, there&#39;ll be a need to call the fibo() 100 times + internally whatever calls it makes as in &quot; return fibo(n-1) + fibo(n-2)&quot;. For the memorization thing, if I follow one of the techniques as one mentioned in @simion &#39;s answer, do you think creating one global array is a good idea?"}], "tags": [], "owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "is_accepted": false, "score": 0, "last_activity_date": 1534273762, "creation_date": 1534273762, "answer_id": 51848303, "question_id": 51847970, "link": "https://stackoverflow.com/questions/51847970/fibonacci-using-recursion/51848303#51848303", "title": "Fibonacci using Recursion", "body": "<blockquote>\n  <p>solving 'nth term of fibonacci series with least processing power'</p>\n</blockquote>\n\n<p>I probably do not need to explain to you the recurrence relation of a Fibonacci number. Though your professor have given you a good hint.</p>\n\n<p>Abstract away details. She is right. If you want the nth Fibonacci number it suffices to merely tell the program just that: <code>Fibonacci(n)</code></p>\n\n<p>Since you aim for <em>least processing power</em> your professor's hint is also suitable for a technique called <a href=\"https://en.wikipedia.org/wiki/Memoization\" rel=\"nofollow noreferrer\">memoization</a>, which basically means <em>if you calculated the nth Fibonacci number once, just reuse the result; no need to redo a calculation</em>. In the article you find an example for the factorial number.</p>\n\n<p>For this you may want to consider a data structure in which you store the nth Fibonacci number; if that memory has already a Fibonacci number just retrieve it, otherwise store the calculated Fibonacci number in it.</p>\n\n<p>By the way, didactically not helpful, but interesting: There exists also a <a href=\"https://en.wikipedia.org/wiki/Fibonacci_number#Closed-form_expression\" rel=\"nofollow noreferrer\">closed form expression</a> for the nth Fibonacci number.</p>\n\n<blockquote>\n  <p>This wasn't a satisfactory answer to me, so I thought of asking\n  experts on SOF.</p>\n</blockquote>\n\n<p>\"Uh, you do not consider your professor an expert?\" was my first thought.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1534275540, "creation_date": 1534275540, "answer_id": 51848684, "question_id": 51847970, "link": "https://stackoverflow.com/questions/51847970/fibonacci-using-recursion/51848684#51848684", "title": "Fibonacci using Recursion", "body": "<p>Using recursion and with a goal of <em>least processing power</em>, an approach to solve <code>fibonacci()</code> is to have each call return 2 values.  Maybe one via a return value and another via a <code>int *</code> parameter.</p>\n\n<p>The usual idea with recursion is to have a a top level function perform a one-time preparation and check of parameters followed by a local helper function written in a lean fashion.</p>\n\n<hr>\n\n<p>The below follows OP's idea of a <code>int fibo(int n)</code> and a helper one <code>int fiboN(int n, additional parameters)</code></p>\n\n<p>The recursion depth is O(n) and the memory usage is also O(n).</p>\n\n<pre><code>static int fib1h(int n, int *previous) {\n  if (n &lt; 2) {\n    *previous = n-1;\n    return n;\n  }\n  int t;\n  int sum = fib1h(n-1, &amp;t);\n  *previous = sum;\n  return sum + t;\n}\n\nint fibo1(int n) {\n  assert(n &gt;= 0); // Handle negatives in some fashion\n  int t;\n  return fib1h(n, &amp;t);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534383989, "post_id": 51849527, "comment_id": 90688935, "body": "Thank you very much for the correction. That was exactly what I had coded originally but I made a typo while posting the question. But how is number of steps calculated for a particular solution? IDK this but probably from my general understanding, my solution will take exactly (n -1) steps. Please correct me, if I&#39;m wrong."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534384844, "post_id": 51849527, "comment_id": 90689099, "body": "@vivek: fibo gets called n+1 times since the last call has n=0"}, {"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534421406, "post_id": 51849527, "comment_id": 90704616, "body": "but since I&#39;m calling it with initial value of n as n-1, will it not run for n-1 times plus the original call ((n-1) + 1 = n)?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534422894, "post_id": 51849527, "comment_id": 90705593, "body": "@vivek: i don&#39;t think that is correct; F(1) is 1, not 0. F(0) is 0. Anyway, it&#39;s really not important; as n gets bigger, the difference between n+1 and n gets successively less significant."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 4, "last_activity_date": 1534280318, "last_edit_date": 1534280318, "creation_date": 1534279531, "answer_id": 51849527, "question_id": 51847970, "link": "https://stackoverflow.com/questions/51847970/fibonacci-using-recursion/51849527#51849527", "title": "Fibonacci using Recursion", "body": "<p>With the understanding that the base case in your recursion should be <code>a</code> rather than <code>0</code>, this seems to me to be an excellent (although not optimal) solution. The recursion in that function is tail-recursion, so a good compiler will be able to avoid stack growth making the function O(1) soace and O(n) time (ignoring the rapid growth in the size of the numbers).</p>\n\n<p>Your professor is correct that the caller should not have to deal with the correct initialisation. So you should provide an external wrapper which avoids the need to fill in the values.</p>\n\n<pre><code>int fibo(int n, int a, int b) {\n    return n &gt; 0 ? fibo(b, a + b) : a;\n}\nint fib(int n) { return fibo(n, 0, 1); }\n</code></pre>\n\n<p>However, it could also be useful to provide and document the more general interface, in case the caller actually wants to vary the initial values.</p>\n\n<p>By the way, there is a faster computation technique, based on the recurrence</p>\n\n<pre><code>fib(a + b - 1) = f(a)f(b) + f(a - 1)f(b - 1)\n</code></pre>\n\n<p>Replacing <code>b</code> with <code>b + 1</code> yields:</p>\n\n<pre><code>fib(a + b) = f(a)f(b + 1) + f(a - 1)f(b)\n</code></pre>\n\n<p>Together, those formulas let us compute:</p>\n\n<pre><code>fib(2n - 1) = fib(n + n - 1)\n            = fib(n)\u00b2 + fib(n - 1)\u00b2\n\nfib(2n)     = fib(n + n)\n            = fib(n)fib(n + 1) + fib(n - 1)fib(n)\n            = fib(n)\u00b2 + 2fib(n)fib(n - 1)\n</code></pre>\n\n<p>This allows the computation to be performed in O(log n) steps, with each step producing two consecutive values.</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534480167, "post_id": 51885162, "comment_id": 90727831, "body": "Yeah, I&#39;m very well aware of this approach. Since the actual module that we were taught was Recursion, we had to implement everything using this concept only. Thank you for your suggestions btw."}, {"owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "edited": false, "score": 0, "creation_date": 1534480445, "post_id": 51885162, "comment_id": 90727898, "body": "Even the factorial thing, when implemented through simple looping constructs is pretty fast, consumes less/almost no stack memory and simple to understand but again University needs us to implement all those things with those cumbersome recursive methods even if they are hundred times less efficient."}], "tags": [], "owner": {"reputation": 101145, "user_id": 1059372, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/W6OMC.png?s=128&g=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/1059372/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1534452639, "creation_date": 1534452639, "answer_id": 51885162, "question_id": 51847970, "link": "https://stackoverflow.com/questions/51847970/fibonacci-using-recursion/51885162#51885162", "title": "Fibonacci using Recursion", "body": "<p>As a side note, you can do the <code>fibonacci problem</code> pretty much without recursion, making it the fastest I know approach. The code is in java though:</p>\n\n<pre><code>public int fibFor() {\n    int sum = 0;\n    int left = 0;\n    int right = 1;\n    for (int i = 2; i &lt;= n; i++) {\n        sum = left + right;\n        left = right;\n        right = sum;\n    }\n    return sum;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "is_accepted": true, "score": 0, "last_activity_date": 1544952635, "last_edit_date": 1544952635, "creation_date": 1544940357, "answer_id": 53799832, "question_id": 51847970, "link": "https://stackoverflow.com/questions/51847970/fibonacci-using-recursion/53799832#53799832", "title": "Fibonacci using Recursion", "body": "<p>Although @rici 's answer is mostly satisfactory but I just wanted to share what I learnt solving this problem. So here's my understanding on finding fibonacci using recursion-</p>\n\n<ul>\n<li>The traditional implementation <code>fibo(n) { return (n &lt; 2) n : fibo(n-1) + fibo(n-2);}</code> is a lot inefficient in terms of time and space requirements both. This unnecessarily builds stack. It requires O(n) Stack space and O(r<sup>n</sup>) time, where r = (&radic;5 + 1)/2.</li>\n<li>With memoization technique as suggested in @Simion 's answer, we just create a permanent stack instead of dynamic stack created by compiler at run time. So memory requirement remains same but time complexity reduces in amortized way. But is not helpful if we require to use it only the once.</li>\n<li>The Approach I suggested in my question requires O(1) space and O(n) time. Time requirement can also be reduced here using same memoization technique in amortized way.</li>\n<li>From @rici 's post, <code>fib(2n) = fib(n)\u00b2 + 2fib(n)fib(n - 1)</code>, as he suggests the time complexity reduces to O(log n) and I suppose, the stack growth is still O(n).</li>\n</ul>\n\n<p>So my conclusion is, if I did proper research, time complexity and space requirement both cannot be reduced simultaneously using recursion computation. To achieve both, the alternatives could be using iteration, <a href=\"https://www.nayuki.io/page/fast-fibonacci-algorithms\" rel=\"nofollow noreferrer\">Matrix exponentiation or fast doubling</a>. </p>\n"}], "owner": {"reputation": 115, "user_id": 6138483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-lqkncFQVOto/AAAAAAAAAAI/AAAAAAAAABQ/zfaciDwrNNY/photo.jpg?sz=128", "display_name": "killerthawne", "link": "https://stackoverflow.com/users/6138483/killerthawne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 53799832, "answer_count": 6, "score": 3, "last_activity_date": 1544952635, "creation_date": 1534272324, "last_edit_date": 1534383229, "question_id": 51847970, "link": "https://stackoverflow.com/questions/51847970/fibonacci-using-recursion", "title": "Fibonacci using Recursion", "body": "<p>This is my idea of solving 'nth term of fibonacci series with least processing power'-</p>\n\n<pre><code>int fibo(int n, int a, int b){\n    return (n&gt;0) ? fibo(n-1, b, a+b) : a;\n}\n\nmain(){\n    printf(\"5th term of fibo is %d\", fibo(5 - 1, 0, 1));\n}\n</code></pre>\n\n<p>To print all the terms, till nth term,</p>\n\n<pre><code>int fibo(int n, int a, int b){\n    printf(\"%d \", a);\n    return (n&gt;0)? fibo(n-1, b, a+b): a;\n}\n</code></pre>\n\n<p>I showed this code to my university professor and as per her, this is a wrong approach to solve Fibonacci problem as this does not abstract the method. I should have the function to be called as fibo(n) and not fibo(n, 0, 1). This wasn't a satisfactory answer to me, so I thought of asking experts on SOF.</p>\n\n<p>It has its own advantage over traditional methods of solving Fibonacci problems. The technique where we employ two parallel recursions to get nth term of Fibonacci (fibo(n-1) + fibo(n-2)) might be slow to give 100th term of the series whereas my technique will be lot faster even in the worst scenario.</p>\n\n<p>To abstract it, I can use default parameters but it isn't the case with C. Although I can use something like -</p>\n\n<pre><code>int fibo(int n){return fiboN(n - 1, 0, 1);}\nint fiboN(int n, int a, int b){return (n&gt;0)? fiboN(n-1, b, a+b) : a;}\n</code></pre>\n\n<p>But will it be enough to abstract the whole idea? How should I convince others that the approach isn't wrong (although bit vague)? </p>\n\n<p>(I know, this isn't sort of question that I should I ask on SOF but I just wanted to get advice from experts here.)</p>\n"}, {"tags": ["c", "i2c", "eeprom", "esp32"], "answers": [{"tags": [], "owner": {"reputation": 395, "user_id": 5182842, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-z1wwP_rJc68/AAAAAAAAAAI/AAAAAAAAABs/WVvy5RtO-M8/photo.jpg?sz=128", "display_name": "Zachary Vincze", "link": "https://stackoverflow.com/users/5182842/zachary-vincze"}, "is_accepted": false, "score": 1, "last_activity_date": 1534360411, "creation_date": 1534360411, "answer_id": 51865001, "question_id": 51847065, "link": "https://stackoverflow.com/questions/51847065/issue-with-i2c-eeprom-page-writes-using-esp32/51865001#51865001", "title": "Issue with I2C EEPROM page writes using ESP32", "body": "<p>Apparently all that was needed between the two calls was a short delay.  The EEPROM needed some time to write the page buffer to the memory cells before another call was made from the ESP32.</p>\n\n<pre><code>eeprom_write(0x50, 0x0000, data_wr, 64);   // ESP_OK\nvTaskDelay(20/portTICK_PERIOD_MS);\neeprom_read(0x50, 0x0000, data_rd, 64);    // ESP_OK\n</code></pre>\n\n<p>Everything is working just fine now.</p>\n"}], "owner": {"reputation": 395, "user_id": 5182842, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-z1wwP_rJc68/AAAAAAAAAAI/AAAAAAAAABs/WVvy5RtO-M8/photo.jpg?sz=128", "display_name": "Zachary Vincze", "link": "https://stackoverflow.com/users/5182842/zachary-vincze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534360411, "creation_date": 1534268574, "question_id": 51847065, "link": "https://stackoverflow.com/questions/51847065/issue-with-i2c-eeprom-page-writes-using-esp32", "title": "Issue with I2C EEPROM page writes using ESP32", "body": "<p>I'm having trouble writing multiple bytes to a 24LC256 EEPROM using an ESP32.</p>\n\n<p>The following functions are what is responsible for reading and writing to the EEPROM.  (I understand that page writing is limited to increments of 64 bytes using this EEPROM, this code is just for testing)</p>\n\n<p><strong>EEPROM write function</strong></p>\n\n<pre><code>esp_err_t eeprom_write(uint8_t deviceaddress, uint16_t eeaddress, uint8_t* data, size_t size) {\n    i2c_cmd_handle_t cmd = i2c_cmd_link_create();\n    i2c_master_start(cmd);\n    i2c_master_write_byte(cmd, (deviceaddress &lt;&lt; 1) | EEPROM_WRITE_ADDR, 1);\n    i2c_master_write_byte(cmd, eeaddress&gt;&gt;8, 1);\n    i2c_master_write_byte(cmd, eeaddress&amp;0xFF, 1);\n\n    i2c_master_write(cmd, data, size, 1);   // Start page write\n\n    i2c_master_stop(cmd);    // Call stop command\n    esp_err_t ret = i2c_master_cmd_begin(I2C_NUM_1, cmd, 1000/portTICK_PERIOD_MS);\n    i2c_cmd_link_delete(cmd);\n    return ret;\n}\n</code></pre>\n\n<p><strong>EEPROM read function</strong></p>\n\n<pre><code>esp_err_t eeprom_read(uint8_t deviceaddress, uint16_t eeaddress, uint8_t* data, size_t size) {\n    i2c_cmd_handle_t cmd = i2c_cmd_link_create();\n    i2c_master_start(cmd);\n    i2c_master_write_byte(cmd, (deviceaddress&lt;&lt;1)|EEPROM_WRITE_ADDR, 1);\n    i2c_master_write_byte(cmd, eeaddress&lt;&lt;8, 1);\n    i2c_master_write_byte(cmd, eeaddress&amp;0xFF, 1);\n    i2c_master_start(cmd);\n    i2c_master_write_byte(cmd, (deviceaddress&lt;&lt;1)|EEPROM_READ_ADDR, 1);\n\n    // Sequential read support\n    if (size &gt; 1) {\n        i2c_master_read(cmd, data, size-1, 0);  // Send ack for these bytes\n                                            // as part of a sequential read\n    }\n    i2c_master_read_byte(cmd, data+size-1, 1);  // Do not ack the last byte\n    i2c_master_stop(cmd);\n    esp_err_t ret = i2c_master_cmd_begin(I2C_NUM_1, cmd, 1000/portTICK_PERIOD_MS);\n    i2c_cmd_link_delete(cmd);\n    return ret;\n}\n</code></pre>\n\n<p>The odd thing is that I am able to write 13 bytes to the EEPROM and everything seems to be fine.</p>\n\n<pre><code>eeprom_write(0x50, 0x0000, data_wr, 13);   // Returns ESP_OK\neeprom_read(0x50, 0x0000, data_rd, 64);    // Returns ESP_OK\n</code></pre>\n\n<p>However, when writing more than 13 bytes to the EEPROM, the sequential read function screws up.</p>\n\n<pre><code>eeprom_write(0x50, 0x0000, data_wr, 14);   // Returns ESP_OK\neeprom_read(0x50, 0x0000, data_rd, 64);    // Return ESP_FAIL\n</code></pre>\n\n<p>I'm sure that everything I'm doing follows the rules of read and writes according to the 24LC256 datasheet.  Is there something that I'm missing?</p>\n"}, {"tags": ["c", "language-lawyer", "strict-aliasing"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1534264699, "post_id": 51846048, "comment_id": 90645457, "body": "Hm. I don&#39;t see any aliasing here..."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1534264811, "post_id": 51846048, "comment_id": 90645513, "body": "@EugeneSh. The aliasing is implied.  Writing headers through foo, reading them through bar, not seeing updates."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534264836, "post_id": 51846048, "comment_id": 90645528, "body": "Pointing to members of structs is not breaking any rules; you are still accessing a <code>My_Header</code> through a pointer to a <code>My_Header</code>, so you haven&#39;t really aliased anything."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1534264919, "post_id": 51846048, "comment_id": 90645581, "body": "@HostileFork Are you asking what will happen if a single object is accessed via two different pointers? You could ask it in a simpler way..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534264981, "post_id": 51846048, "comment_id": 90645620, "body": "@HostileFork Can you give a more specific example of this reading/writing?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1534265124, "post_id": 51846048, "comment_id": 90645689, "body": "In any case, any compliant compiler will generate the very same results for both unless  some <code>restrict</code> or <code>volatile</code> is coming into a play."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1534266868, "post_id": 51846048, "comment_id": 90646553, "body": "As I understand it from <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.2.3p6\" rel=\"nofollow noreferrer\">C11 6.5.2.3p6</a>, if a <code>Bar_Type</code> and <code>Foo_Type</code> are not accessed via union member access, the compiler can behave as though the <code>Bar_Type</code> and <code>Foo_Type</code> do not overlap in memory even if they do in fact overlap."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534267948, "post_id": 51846048, "comment_id": 90647109, "body": "@dbush I&#39;ve fleshed out the example (...though honestly I feel it&#39;s just a distraction over the core yes-or-no question, which remains at the end, and it&#39;s sounding like people are saying &quot;no&quot; but I&#39;m wondering how it is that passing a pointer to a datatype that can appear in multiple structures would ever work otherwise.)  :-/"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534268146, "post_id": 51846048, "comment_id": 90647228, "body": "@HostileFork Passing a pointer to a type is not a problem, regardless of whether that type is contained in others.  The problem is when you pass a pointer to one type where a pointer to another type is expected."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534269143, "post_id": 51846048, "comment_id": 90647763, "body": "@dbush Okay, but the question is...can you beat the &quot;passing a pointer to one type where a pointer to another type is expected&quot; by extracting a pointer to a contained common type...and does whether that common type is written (or read) through a pointer matter.  I found a case where it made a difference (e.g. optimized build, wrote to a <code>bar-&gt;header.bits = ...</code>, registers didn&#39;t sync on reading a <code>foo-&gt;header.bits</code> at the same address).  Used alternative assignment method above and it did sync in that optimized build.  Quirk/glitch or emergent guarantee of pointer-based access?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534269949, "post_id": 51846048, "comment_id": 90648172, "body": "@HostileFork Now that&#39;s very relevant.  If you can come up with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for both cases (along with compiler/version), that can go a long way to getting a definitive answer."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1534281242, "post_id": 51846048, "comment_id": 90652957, "body": "@dbush Perhaps <a href=\"https://stackoverflow.com/a/51849327/211160\">supercat&#39;s answer</a> is sufficient explanation?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1534307088, "post_id": 51846048, "comment_id": 90658389, "body": "@HostileFork: A compiler&#39;s ability to recognize cases where a pointer which is visibly derived from an lvalue of another type might be used to access objects of the latter type is a Quality-of-Implementation issue. Nothing in the rationale would suggest that they thought compiler writers would use the rules as an excuse to willfully ignore cases where such derivation is visible.  From the point of view of the Standard, code which uses the structure pointer and code which accesses the member directly have equivalent (undefined) behavior, but quality compilers should handle both."}], "answers": [{"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534265768, "post_id": 51846292, "comment_id": 90646026, "body": "Well, the issue is not that I am passing around pointers to My_Header, I&#39;m passing pointers to Foo_Type (extracted from malloc&#39;d regions) which may actually be to something that was initialized through a header pointer in a Bar_Type.  I&#39;d like the write of the bits to be guaranteed seen when reading through a foo header.  My intuition was that the optimizer would not honor the access through pointer as being different in a reduced example, and you&#39;re saying the lack of honoring is due to an analysis of what it knows and doesn&#39;t know...pointer rules aside."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534265935, "post_id": 51846292, "comment_id": 90646116, "body": "@HostileFork I... don&#39;t really follow you. You could post a question with your real use case. It&#39;s difficult to understand what your code is exactly and what problem are you trying to avoid."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1534266078, "post_id": 51846292, "comment_id": 90646202, "body": "The requirement from a dereferenced pointer in C is to point to a valid object, otherwise it is UB. That is exactly to avoid issues with optimizing these accesses (well, one of the reasons)."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534266509, "post_id": 51846292, "comment_id": 90646390, "body": "@bolov I&#39;ve tried to update it with what I thought was obvious, but apparently was not.  Hopefully clearer."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534281256, "post_id": 51846292, "comment_id": 90652960, "body": "I think that pattern is one where the authors of the Standard would have expected that some compilers might optimize, and didn&#39;t intend to forbid it (note that <i>there is no <b>blanket</b> permission to use arbitrary lvalues of an aggregate&#39;s member type to access the aggregate</i>.  An lvalue which is derived from another is generally not regarded as &quot;aliasing&quot; the latter unless the latter is used within the former&#39;s active lifetime, and the footnote to N1570 6.5p7 indicates the rules are intended to indicate when compilers must allow for aliasing.  In your last example..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534281515, "post_id": 51846292, "comment_id": 90653046, "body": "...there are four ways <code>global_p</code> could refer to the same storage as <code>foo</code>: <code>global_p</code> could be derived from <code>foo</code> and used after <code>foo-&gt;header.bits</code> is accessed [aliasing], <code>foo</code> could be derived from <code>global_p</code> and used after <code>global_p.bits</code> is written [aliasing], <code>foo</code> might be derived from something else after <code>global_p</code> had been derived from it [aliasing], or <code>global_p</code> might have been derived after <code>foo</code> [aliasing].  If <code>global_p</code> had been derived from something of type <code>struct Foo_Type</code> after the read of <code>header.bits</code>, however, that would have been another story."}], "tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 2, "last_activity_date": 1534266175, "last_edit_date": 1534266175, "creation_date": 1534265412, "answer_id": 51846292, "question_id": 51846048, "link": "https://stackoverflow.com/questions/51846048/does-access-through-pointer-change-strict-aliasing-semantics/51846292#51846292", "title": "Does access through pointer change strict aliasing semantics?", "body": "<p>The fact that you have two structures which contain <code>My_Header</code> is a red herring and complicates your thinking without bringing anything new to the table. Your problem can be stated and clarified without any struct (other than <code>My_Header</code> ofcourse).</p>\n\n<pre><code>foo-&gt;header.bits = 1020;\n</code></pre>\n\n<p>The compiler clearly knows which object to modify.</p>\n\n<pre><code>struct My_Header *alias = &amp;foo-&gt;header;\nalias-&gt;bits = 1020;\n</code></pre>\n\n<p>Again the same is true here: with a very rudimentary analysis the compiler knows exactly which object the <code>alias-&gt;bits = 1020;</code> modifies.</p>\n\n<p>The interesting part comes here:</p>\n\n<pre><code>void foo(struct My_Header* p)\n{\n   p-&gt;bits = 1020;\n}\n</code></pre>\n\n<p>In this function the pointer <code>p</code> can alias any object (or sub-object) of type <code>My_header</code>. It really doesn't matter if you have N structures who contain <code>My_header</code> members or if you have none. Any object of type <code>My_Header</code> could be potentially modified in this function.</p>\n\n<p>E.g.</p>\n\n<pre><code>// global:\nstruct My_header* global_p;\n\nvoid foo(struct My_Header* p)\n{\n   p-&gt;bits = 1020;\n   global_p-&gt;bits = 15;\n\n   return p-&gt;bits;\n   // the compiler can't just return 1020 here because it doesn't know\n   // if `p` and `global_p` both alias the same object or not.\n}\n</code></pre>\n\n<p>To convince you that the <code>Foo_Type</code> and <code>Bar_Type</code> are red herrings and don't matter look at this example for which the analysis is identical to the previous case who doesn't involve neither <code>Foo_Type</code> nor <code>Bar_type</code>:</p>\n\n<pre><code>// global:\nstruct My_header* gloabl_p;\n\nvoid foo(struct Foo_Type* foo)\n{\n   foo-&gt;header.bits = 1020;\n   global_p-&gt;bits = 15;\n\n   return foo-&gt;header.bits;\n   // the compiler can't just return 1020 here because it doesn't know\n   // if `foo.header` and `global_p` both alias the same object or not.\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534279809, "post_id": 51849327, "comment_id": 90652361, "body": "I take it you&#39;re offering an example you&#39;re sure about (and have checked with gcc and clang), that seems less controversial--but still does not work.  Hence what I&#39;m describing, which is similar, probably can&#39;t be taken for granted in gcc or clang, either...?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534280466, "post_id": 51849327, "comment_id": 90652652, "body": "@HostileFork: The indicated <code>test2</code> function will work correctly in <i>most</i> contexts, but it is not reliable.  If it is called twice, both gcc and clang will optimize out the re-derivation of <code>p</code> from <code>unionArr[i]</code>, and thus not recognize that it may interact with code that takes the address of already-active member <code>v2</code> of <code>unionArr[j]</code> and writes to it."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 1, "creation_date": 1534282772, "post_id": 51849327, "comment_id": 90653481, "body": "@HostileFork: Added test1b() and test2b() which should work analogous to <code>test1a</code> and <code>test2a</code>.  Both gcc and clang will get tripped up with the sequence <code>test2a(i); test2b(j); test2a(i);</code> in cases where <code>i==j</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1534296925, "post_id": 51849327, "comment_id": 90656438, "body": "Unions bypass strict aliasing so this has nothing to do with the question"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1534302205, "post_id": 51849327, "comment_id": 90657401, "body": "@M.M: The Standard does not recognize a difference between using an aggregate member directly, versus taking its address and using that, nor do its aliasing rules distinguish between structs and unions.  Instead, support for almost any kind of member access is a Quality of Implementation issue.  As it happens, present versions of gcc and clang support more flexible semantics with pointers to struct members than with struct-member-access lvalues, but less flexible semantics with pointers to union members than union-member-access lvalues."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534303073, "post_id": 51849327, "comment_id": 90657560, "body": "@MM: As written, the Standard (deliberately, IMHO) would allow a compiler to assume that a struct will not be accessed using a seemingly-unrelated lvalue of member type.  Taking the address of the member and using the resulting pointer might cause today&#39;s version of clang/gcc to miss the &quot;optimization&quot;, but quality implementations should be able to access Common Initial Sequence members using a freshly-cast structure pointers, and I wouldn&#39;t trust low-quality implementations that can&#39;t handle that to refrain from &quot;optimizing&quot; code that takes the address of struct members and assuming..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534303128, "post_id": 51849327, "comment_id": 90657571, "body": "...it won&#39;t be used to inspect Common Initial Sequence members of the &quot;wrong&quot; structure type."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1534352012, "last_edit_date": 1592644375, "creation_date": 1534278593, "answer_id": 51849327, "question_id": 51846048, "link": "https://stackoverflow.com/questions/51846048/does-access-through-pointer-change-strict-aliasing-semantics/51849327#51849327", "title": "Does access through pointer change strict aliasing semantics?", "body": "<p>The way N1570 p5.6p7 is written, the behavior of code that accesses individual members of structures or unions will only be defined if the accesses are performed using lvalues of character types, or by calling library functions like <code>memcpy</code>.  Even if a struct or union has a member of type <code>T</code>, the Standard (deliberately IMHO) refrains from giving blanket permission to access that part of the aggregate's storage using seemingly-unrelated lvalues of type <code>T</code>.  Presently, gcc and clang seem to grant blanket permission for accessing structs, but not unions, using lvalues of member type, but N1570 p5.6p7 doesn't require that.  It applies the same rules to both kinds of aggregates and their members.  Because the Standard doesn't grant blanket permission to access structures using unrelated lvalues of member type, and granting such permission impairs useful optimizations, there's no guarantee gcc and clang will continue this behavior with with unrelated lvalues of member types.</p>\n<p>Unfortunately, as can be demonstrated using unions, gcc and clang are very poor at recognizing relationships among lvalues of different types, even when one lvalue is quite visibly derived from the other.  Given something like:</p>\n<pre><code>struct s1 {short x; short y[3]; long z; };\nstruct s2 {short x; char y[6]; };\nunion U { struct s1 v1; struct s2 v2; } unionArr[100];\nint i;\n</code></pre>\n<p>Nothing in the Standard would distinguish between the &quot;aliasing&quot; behaviors of the following pairs of functions:</p>\n<pre><code>int test1(int i)\n{\n  return unionArr[i].v1.x;\n}\nint test2a(int j)\n{\n  unionArr[j].v2.x = 1;\n}\n\nint test2a(int i)\n{\n  struct s1 *p = &amp;unionArr[i].v1;\n  return p-&gt;x;\n}\nint test2b(int j)\n{\n  struct s2 *p = &amp;unionArr[j].v2;\n  p-&gt;x = 1;\n}\n</code></pre>\n<p>Both of them use an lvalue of type <code>int</code> to access the storage associated with objects of type <code>struct s1</code>, <code>struct s2</code>, <code>union U</code>, and <code>union U[100]</code>, even though <code>int</code> is not listed as an allowable type for accessing any of those.</p>\n<p>While it may seem absurd that even the first form would invoke UB, that shouldn't be a problem if one recognizes support for access patterns beyond those explicitly listed in the Standard as a Quality of Implementation issue.  According to the published rationale, the authors of the Standard thought compiler writers would to try to produce high-quality implementations, and it was thus not necessary to forbid &quot;conforming&quot; implementations from being of such low quality as to be useless.  An implementation could be &quot;conforming&quot; without being able to handle <code>test1a()</code> or <code>test2b()</code> in cases where they would access member <code>v2.x</code> of a <code>union U</code>, but only in the sense that an implementation could be &quot;conforming&quot; while being incapable of correctly processing anything other than some particular contrived and useless program.</p>\n<p>Unfortunately, although I think the authors of the Standard would likely have expected that quality implementations would be able to handle code like <code>test2a()</code>/<code>test2b()</code> as well as <code>test1a()</code>/<code>test1b()</code>, neither gcc nor clang supports them pattern reliably(*).  The stated purpose of the aliasing rules is to avoid forcing compilers to allow for aliasing in cases where there's no evidence of it, and where the possibility of aliasing would be &quot;dubious&quot; [doubtful].  I've seen no evidence that they intended that quality compilers wouldn't recognize that code which takes the address of <code>unionArr[i].v1</code> and uses it is likely to access the same storage as other code that uses <code>unionArr[i]</code> (which is, of course, visibly associated with <code>unionArr[i].v2</code>).  The authors of gcc and clang, however, seem to think it's possible for something to be a quality implementation without having to consider such things.</p>\n<blockquote>\n<p>(*) Given e.g.</p>\n<pre><code>int test(int i, int j)\n{\n  if (test2a(i))\n    test2b(j);\n  return test2a(i);\n}\n</code></pre>\n<p>neither gcc nor clang will recognize that if i==j, test2b(j) would access the same storage as test2a(i), even when though both would access the same element of the same array.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534298710, "post_id": 51851962, "comment_id": 90656757, "body": "&quot;you would think&quot;, but I had a real-world case in 2016 where changing the code from case one to case two caused a synchronization where there wasn&#39;t one previously.  The origin of this question is that I&#39;d tweaked things to use a byte access through char* and thus (I think) made the question irrelevant...but...at the time I justified the modification by saying the reason it worked was that I thought the by-pointer access made it work...because I couldn&#39;t figure out why otherwise you could ever guarantee mutations via pointer would work.  It was reducing it to this question that gave me pause."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534298780, "post_id": 51851962, "comment_id": 90656766, "body": "@HostileFork It seems that some compiler vendors also take the view that Q.80 has the answer &quot;No&quot; (and that both of your code forms are UB)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 1, "creation_date": 1534306666, "post_id": 51851962, "comment_id": 90658288, "body": "@HostileFork: Many tricks cause obtuse compilers to miss &quot;optimizations&quot; for a little while, until the authors &quot;fix&quot; them, but the only reliable way to use a higher-quality compiler like icc which supports low-level constructs."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534307460, "post_id": 51851962, "comment_id": 90658474, "body": "@M.M: So far as I can tell, the &quot;Effective Type&quot; rules have never accurately described real compiler behaviors in all corner cases.  What&#39;s important are places where a compiler would want to reorder an access to either consolidate with another access, or hoist it out of a loop or function, and needs to know if it will conflict with anything else, which in turn depends upon whether a compiler looking at the two points of interest would see any evidence of a conflict."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534308046, "post_id": 51851962, "comment_id": 90658602, "body": "@M.M: Given <code>struct foo { int x; } *p;</code>, if a byte is accessed twice using <code>p-&gt;x</code>and no intervening operation has used an lvalue that could identifies the same structure or an element of the same array, that would suggest that consolidating the accesses is unlikely to pose a problem--even if intervening accesses dereference an <code>int*</code>.  If, however, code between the two accesses derives a pointer from a <code>struct foo*</code>, consolidating the accesses to <code>p-&gt;x</code> is likely to pose a problem.  Looking for evidence of conflict is simpler than worrying about effective type, but can actually allow more..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534308159, "post_id": 51851962, "comment_id": 90658628, "body": "...useful optimizations.  Note, for example, that very few programs would need blanket permission to use a <code>char*</code> to access things of every type if compilers treat a cast from <code>struct foo*</code> to <code>char*</code> that occurs between two accesses to a <code>struct foo</code> as evidence that the storage would be accessed via &quot;unusual&quot; means."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534308336, "post_id": 51851962, "comment_id": 90658677, "body": "@supercat I agree that it would be desirable for optimization purposes that Q.80 answer is &quot;No&quot;, however the current text of the standard doesn&#39;t actually specify that (IMO)."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534310417, "post_id": 51851962, "comment_id": 90659151, "body": "@M.M: Given e.g. <code>void test(struct foo *p, struct bar *q, int mode) { p-&gt;x=1; q-&gt;y=2; if (mode) p-&gt;x=1;}</code>, a compiler should be allowed to unconditionally write <code>p</code>-&gt;x` and <code>q-&gt;y</code> in either order (and such action would be reasonable even for a quality compiler in a non-conforming mode).  That does not, however, mean that such behavior would be reasonable for a quality compiler given <code>void test(struct foo *p, struct foo *q, int mode) { p-&gt;x=1; ((struct bar*)q)-&gt;x=2; if (mode) p-&gt;x=1;}</code>, with a conversion from <code>struct foo*</code> to <code>struct bar*</code> occurring between the two operations on <code>p-&gt;x</code>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534311502, "post_id": 51851962, "comment_id": 90659394, "body": "@M.M: Actually, the C89 rules would be pretty reasonable if the footnote were amplified to say that quality compilers should only apply the rule in cases that <i>would actually involve aliasing as written</i>, noting that the following acts don&#39;t involve aliasing: (1) if a pointer or lvalue is derived from another, any use of the former which occurs in the context where it is derived and precedes the next operation using the original, is an operation on the original; (2) if a derived pointer is passed to a function, and the function accesses its storage exclusively using the derived type..."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534311865, "post_id": 51851962, "comment_id": 90659460, "body": "@supercat What about <code>void q(struct foo *p, struct foo *q) { test(p, (struct bar *)q, 1); }</code>  (using the first <code>test</code> from your last comment). You agree that <code>test</code> should be able to re-order the writes; how would a compiler building <code>q</code> cope with that possibility?   Or do you intend to declare that this <code>q</code> causes UB? If so , what rule exactly would you propose?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534311891, "post_id": 51851962, "comment_id": 90659466, "body": "...or pointers derived from others of that type, accesses made by the function are accesses to the original [a compiler that is in a position to <i>care</i> about how a function would interact with operations in calling code would be in a position to know about the pointer derivation; a compiler that isn&#39;t in a position to know about the derivation should have no reason to care].  The only tricky issue is how a compiler should treat a <code>void*</code> of unknown provenance.  It&#39;s too bad the Standard didn&#39;t distinguish &quot;pointer to any type&quot; and &quot;pointer to unknown type&quot;, since it would be clear how..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534312045, "post_id": 51851962, "comment_id": 90659498, "body": "...those should be handled.  Unfortunately, it&#39;s harder to tell when <code>void*</code> should be treated as a pointer to any type, versus a pointer to a type which is unknown to the code holding it, but will be next used as its original type."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534312315, "post_id": 51851962, "comment_id": 90659570, "body": "@M.M: The latter function would have defined behavior iff <code>p-&gt;x</code> and <code>((struct bar*)q)-&gt;y</code> occupy disjoint storage, because it would generally be impractical for the compiler processing <code>test</code> to know that the pointers might be related.  Under the present Standard, however, a compiler would be required to presume that they might be used to write the same storage because each write would change the Effective Type as needed, but IMHO that&#39;s more likely to result in needless pessimization than to actually be useful."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534312770, "post_id": 51851962, "comment_id": 90659668, "body": "In the absence of things like <code>volatile</code> accesses to force synchronization, a function which receives pointers of different types should be entitled to presume that they will be used to access distinct regions of storage.  Note, however, that such an assumption would merely say that <code>p-&gt;x</code> and <code>((struct bar*)q)-&gt;y</code> won&#39;t alias; it would say nothing about whether <code>q-&gt;y</code> might identify storage associated with any other part of any other <code>struct foo</code> that might exist in the universe."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534313109, "post_id": 51851962, "comment_id": 90659753, "body": "@M.M: Looking back at my comment and yours, I think I may have missed a phrase: &quot;...or pointers derived <i>within the execution of that called function</i> from pointers of that type.  If your <code>q</code> invokes the first <code>test</code> in such a way that <code>p-&gt;x</code> and <code>((struct bar*)q)-&gt;y</code> alias, that would cause the storage accessed via the derived pointer of type <code>bar</code> to be accessed in conflicting fashion using a pointer of type <code>bar</code>, which is not derived within <code>test</code> from anything of type <code>foo</code>."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1534351642, "post_id": 51851962, "comment_id": 90678176, "body": "@M.M I feel you&#39;ve answered my question, which I think <a href=\"https://stackoverflow.com/revisions/51846048/1\">was better in the original form</a> before a bunch of people in comments acted like I was crazy and made me change it.  Do you agree that reverting to what I asked originally and accepting your answer would be acceptable?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1534356596, "post_id": 51851962, "comment_id": 90680447, "body": "@M.M: BTW, I think the biggest mis-step in the history of the C Standard was probably the resolution to Defect Report 28; it correctly identified that the given code invokes UB if the pointers alias, but the only reason it gave for that conclusion was that the Standard did not specify any particular behavior of writing one union member and reading another.  That led to the conclusion which got incorporated in the Effective Type rules--that pointers of any type may be used to write an object, provided a pointer of the matching type is used to read it."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 1, "creation_date": 1534370359, "post_id": 51851962, "comment_id": 90686067, "body": "@HostileFork I did indeed answer the original form and it&#39;s preferable to not make major edits to a question after an answer was posted,  so I would agree with reverting"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1538093955, "last_edit_date": 1538093955, "creation_date": 1534298466, "answer_id": 51851962, "question_id": 51846048, "link": "https://stackoverflow.com/questions/51846048/does-access-through-pointer-change-strict-aliasing-semantics/51851962#51851962", "title": "Does access through pointer change strict aliasing semantics?", "body": "<p>The code <code>bar-&gt;header.bits = 1020;</code> is exactly identical to  <code>struct My_Header *alias = &amp;bar-&gt;header; alias-&gt;bits = 1020;</code>.</p>\n\n<p>The strict aliasing rule is defined in terms of <em>access to objects</em> through <em>lvalues</em>:</p>\n\n<blockquote>\n  <p>6.5p7 An object shall have its stored value accessed\n  only by an lvalue expression that has one of the following\n  types:</p>\n</blockquote>\n\n<p>The only things that matter are the type of the lvalue, and the effective type of the object designated by the lvalue. Not whether you stored some intermediate stages of the lvalue's derivation in a pointer variable.</p>\n\n<hr>\n\n<p><em>NOTE: The question was edited since the following text was posted. The following text applies to the original question where the space was allocated by <code>malloc</code>, not the current question as of August 23.</em></p>\n\n<p>Regarding whether the code is correct or not. Your code is equivalent to Q80 <code>effective_type_9.c</code> in <a href=\"https://www.cl.cam.ac.uk/~pes20/cerberus/notes30.pdf\" rel=\"nofollow noreferrer\">N2013 rev 1571</a>, which is a survey of existing C implementations with an eye to drafting improved strict aliasing rules.</p>\n\n<blockquote>\n  <p>Q80. After writing a structure to a malloc\u2019d region, can its members be accessed via a pointer to a different structure type that has the same leaf member type at the same offset?</p>\n</blockquote>\n\n<p>The stumbling block is whether the code <code>(*bar).header.bits = 1020;</code> sets the effective type of only the <code>int</code> bits; or of the entire <code>*bar</code>.  And accordingly, whether reading <code>(*foo).header.bits</code> reads an <code>int</code>, or does it read the entire <code>*foo</code>?  </p>\n\n<p>Reading only an <code>int</code> would not be a strict aliasing violation (it's OK to read <code>int</code> as <code>int</code>); but reading a <code>Bar_Struct</code> as <code>Foo_Struct</code> would be a violation.</p>\n\n<p>The authors of this paper consider the write to set the effective type for the entire <code>*bar</code>, although they don't give their justification for that, and I do not see any text in the C Standard to support that position.</p>\n\n<p>It seems to me there's no definitive answer currently for whether or not your code is correct.</p>\n"}], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 3, "accepted_answer_id": 51851962, "answer_count": 3, "score": 5, "last_activity_date": 1538093955, "creation_date": 1534264487, "last_edit_date": 1534982917, "question_id": 51846048, "link": "https://stackoverflow.com/questions/51846048/does-access-through-pointer-change-strict-aliasing-semantics", "title": "Does access through pointer change strict aliasing semantics?", "body": "<p>With these definitions:</p>\n\n<pre><code>struct My_Header { uintptr_t bits; }\n\nstruct Foo_Type { struct My_Header header; int x; }\nstruct Foo_Type *foo = ...;\n\nstruct Bar_Type { struct My_Header header; float x; }\nstruct Bar_Type *bar = ...;\n</code></pre>\n\n<p>Is it correct to say that this C code (<strong>\"case one\"</strong>):</p>\n\n<pre><code>foo-&gt;header.bits = 1020;\n</code></pre>\n\n<p>...is actually different <em>semantically</em> from this code (<strong>\"case two\"</strong>):</p>\n\n<pre><code>struct My_Header *alias = &amp;foo-&gt;header;\nalias-&gt;bits = 1020;\n</code></pre>\n\n<p>My understanding is that they should be different:</p>\n\n<ul>\n<li><p>Case One considers the assignment unable to affect the header in a Bar_Type.  It only is seen as being able to influence the header in other Foo_Type instances.</p></li>\n<li><p>Case Two, by forcing access through a generic aliasing pointer, will cause the optimizer to realize all bets are off for any type which might contain a <code>struct My_Header</code>.  It would be synchronized with access through any pointer type.  <em>(e.g. if you had a <code>Foo_Type</code> which was pointing to what was actually a <code>Bar_Type</code>, it could access through the header and reliably find out which it had--assuming that's something the header bits could tell you.)</em></p></li>\n</ul>\n\n<p>This relies on the optimizer not getting \"smart\" and making case two back into case one.</p>\n"}, {"tags": ["c", "macos", "ubuntu-16.04", "bit"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1534262542, "post_id": 51845502, "comment_id": 90644357, "body": "Remember that <code>int</code> is <i>signed</i>. If you over or underflow a signed value, you will have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a>. Try using <code>unsigned</code> instead for the data-type. Or more explicitly <code>uint32_t</code> or even a larger type like <code>uint64_t</code>."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1534262608, "post_id": 51845502, "comment_id": 90644396, "body": "Please JUST include the line that gives an unexpected result"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1534262841, "post_id": 51845502, "comment_id": 90644507, "body": "I also suggest you <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. Especially how to use a debugger to step through your code line by line while monitoring variables and their values. For this it also helps to break up complex opration into simples ones, using temporary variables. For example <code>int p1 = (x &amp; m2) + ((x &gt;&gt; 1) &amp; m2);</code> could be <code>unsigned p1_1 = x &amp; m2; unsigned p1_2 = x &gt;&gt; 1; unsigned p1_3 = p1_2 &amp; m2; unsigned p1 = p1_1 + p1_3;</code>. Makes it easier to see when and where there is a wrong result."}, {"owner": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1534262870, "post_id": 51845502, "comment_id": 90644517, "body": "@Someprogrammerdude I don\u2019t think it\u2019s overflow, it\u2019s just right shifting"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534262949, "post_id": 51845502, "comment_id": 90644556, "body": "a) Never use bit operations on signed values. b) Never use code you do not understand and just copied from somewhere."}, {"owner": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1534262978, "post_id": 51845502, "comment_id": 90644577, "body": "@Someprogrammerdude I can\u2019t change the data types because it\u2019s school homework interface with limit"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1534262984, "post_id": 51845502, "comment_id": 90644584, "body": "I believe right-shifting signed values is implementation-defined.  It may sign-extend or zero-extend."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1534262987, "post_id": 51845502, "comment_id": 90644586, "body": "What is the point of the images?  They&#39;re downright obnoxious."}, {"owner": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534263114, "post_id": 51845502, "comment_id": 90644649, "body": "@SergeyA I have to because this is school homework"}, {"owner": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534263215, "post_id": 51845502, "comment_id": 90644702, "body": "@ChristianGibbons it\u2019s not just the sign-extend, but also losing the left most 4 bit"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534263243, "post_id": 51845502, "comment_id": 90644712, "body": "Than you should explain to your teacher why you can&#39;t use bitwise right-shift on signed values, and also complain to the faculty on the subpar teacher performance."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1534264362, "post_id": 51845502, "comment_id": 90645279, "body": "Since the input is negative, the result of right shifting is implementation-defined.  The <code>clang</code> compiler on macOS (even if disguised as <code>gcc</code>) may be doing things differently from <code>gcc</code> on Ubuntu \u2014 that&#39;s the compiler&#39;s prerogative.  If you write non-portable code, you don&#39;t get portable results."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1534268582, "post_id": 51845502, "comment_id": 90647452, "body": "If you just want to count bits efficiently (rather than trying to fix this buggy code), see <a href=\"https://stackoverflow.com/questions/109023/how-to-count-the-number-of-set-bits-in-a-32-bit-integer\" title=\"how to count the number of set bits in a 32 bit integer\">stackoverflow.com/questions/109023/&hellip;</a> ."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534273931, "post_id": 51845502, "comment_id": 90649930, "body": "&quot;The input x is 0xffffffff (-1).&quot; <i>discusses</i> input.  Better to post an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to insure that is true.  Much about this post lacks clarity due to  incomplete code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534274272, "post_id": 51845502, "comment_id": 90650056, "body": "&quot;p1 prints &#39;0x2aaaaaaa&#39; ...&quot;  Code does <i>not</i> print anything.  AFAIK, the code used to print output is fouled.  Posting  compilable/run-able code is useful."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "edited": false, "score": 0, "creation_date": 1534263634, "post_id": 51845721, "comment_id": 90644905, "body": "Do you mean the variable m4 is doing a undefined behavior?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "edited": false, "score": 1, "creation_date": 1534264257, "post_id": 51845721, "comment_id": 90645222, "body": "@wuxue After quick look at the code you posted, I don&#39;t think offhand that the <code>m2</code>, <code>m4</code>, <code>m8</code>, or <code>m16</code> values a undefined or implementation-defined behavior because none of the inputs there have an actual negative value and I don&#39;t think you overflow.  But the right-shift operations, such as <code>(x &gt;&gt; 1)</code>, are definitely going to be implementation-defined if you pass in an <code>int</code> value that&#39;s negative.  And I suspect some of your intermediate <code>p1</code>, <code>p2</code>, etc results may wind up as negative values, which also leads to implementation-defined behavior.  A simple test would be to use <code>unsigned</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1534264412, "post_id": 51845721, "comment_id": 90645318, "body": "Given that the input value to the function ix 0xFFFFFFFF or -1, there is implementation-defined behaviour at work."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1534264529, "post_id": 51845721, "comment_id": 90645378, "body": "@JonathanLeffler <i>there is implementation-defined behaviour at work.</i>  Agreed.  I haven&#39;t done a thorough enough analysis of the posted code to rule out UB, though.  If you have, feel free to edit or post your own analysis."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1534265235, "post_id": 51845721, "comment_id": 90645741, "body": "My analysis stopped at: &#39;<code>x</code> is negative \u2014 therefore, there are portability problems&#39;.  I also note that when I run <code>&#47;usr&#47;bin&#47;gcc --version</code> on a Mac, I get output like <code>Apple LLVM version 9.1.0 (clang-902.0.39.2)</code> \u2014 <code>Target: x86_64-apple-darwin17.7.0</code> indicating that it is Clang in disguise. I personally use a &#39;real&#39; GCC that I&#39;ve compiled (currently, GCC 8.2.0) most of the time. The values in <code>m2</code>, <code>m4</code>, <code>m8</code>, <code>m16</code> are do not self-evidently overflow (though why they aren&#39;t simply written as 0x55555555 etc eludes me). The <code>(x &gt;&gt; 1)</code> term invokes implementation-defined behaviour \u2014 else OK."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1534268432, "post_id": 51845721, "comment_id": 90647367, "body": "And of course it&#39;s all a tremendous waste of time, because bit counting is (or ought to be) a solved problem."}, {"owner": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "edited": false, "score": 0, "creation_date": 1534296314, "post_id": 51845721, "comment_id": 90656329, "body": "Thanks. I just cut the function to my new C source file and print everything in macOS, the result is all as same as in Ubuntu. I will update it in the question. @J"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 3, "last_activity_date": 1534263260, "last_edit_date": 1592644375, "creation_date": 1534263260, "answer_id": 51845721, "question_id": 51845502, "link": "https://stackoverflow.com/questions/51845502/bit-right-shifting-of-c-language-in-macos-10-12-is-different-from-ubuntu-16-04/51845721#51845721", "title": "Bit right shifting of C language in macOS 10.12 is different from Ubuntu 16.04", "body": "<p>Per <a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#6.5.7\" rel=\"nofollow noreferrer\"><strong>6.5.7 Bitwise shift operators</strong></a>, of the C standard (note the highlighted parts):</p>\n<blockquote>\n<p><strong>Constraints</strong></p>\n<p>2 Each of the operands shall have integer type.</p>\n<p><strong>Semantics</strong></p>\n<p>3 The integer promotions are performed on each of the operands. The\ntype of the result is that of the promoted left operand. If the value\nof the right operand is negative or is greater than or equal to the\nwidth of the promoted left operand, the behavior is undefined.</p>\n<p>4 The result of E1 &lt;&lt; E2 is E1 left-shifted E2 bit positions; vacated\nbits are filled with zeros. If E1 has an unsigned type, the value of\nthe result is E1 x 2E2 , reduced modulo one more than the maximum\nvalue representable in the result type. If E1 has a signed type and\nnonnegative value, and E1 x 2E2 is representable in the result type,\nthen that is the resulting value; otherwise, <strong>the behavior is\nundefined</strong>.</p>\n<p>5 The result of E1 &gt;&gt; E2 is E1 right-shifted E2 bit positions. If E1\nhas an unsigned type or if E1 has a signed type and a nonnegative\nvalue, the value of the result is the integral part of the quotient of\nE1 / 2E2 . <strong>If E1 has a signed type and a negative value, the\nresulting value is implementation-defined</strong>.</p>\n</blockquote>\n<p>You are bit-shifting <em>signed</em> integer values.  Depending on your inputs, you are depending on both undefined and implementation-defined behavior.</p>\n<p>Different results on different platforms are to be expected.</p>\n"}], "owner": {"reputation": 113, "user_id": 5221933, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-2c8EvpVDehs/AAAAAAAAAAI/AAAAAAAAACs/E-Lvqj7RUAY/photo.jpg?sz=128", "display_name": "wuxue", "link": "https://stackoverflow.com/users/5221933/wuxue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 51845721, "answer_count": 1, "score": -2, "last_activity_date": 1534296649, "creation_date": 1534262390, "last_edit_date": 1534296649, "question_id": 51845502, "link": "https://stackoverflow.com/questions/51845502/bit-right-shifting-of-c-language-in-macos-10-12-is-different-from-ubuntu-16-04", "title": "Bit right shifting of C language in macOS 10.12 is different from Ubuntu 16.04", "body": "<p>Update : \nI just rewrote the function in a new C source file  on macOS:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\nint x = 0xffffffff;\n\nint m2 = (((((0x55 &lt;&lt; 8) + 0x55 )&lt;&lt; 8) + 0x55)&lt;&lt; 8) + 0x55;\nprintf(\"m2 : 0x%x\\n\",m2);\n\nint m4 = (((((0x33 &lt;&lt; 8) + 0x33 )&lt;&lt; 8) + 0x33)&lt;&lt; 8) + 0x33;\nprintf(\"m4 : 0x%x\\n\",m4);\n\nint m8 = (((((0x0f &lt;&lt; 8) + 0x0f )&lt;&lt; 8) + 0x0f)&lt;&lt; 8) + 0x0f;\nprintf(\"m8 : 0x%x\\n\",m8);\n\nint m16 = (0xff &lt;&lt; 16) + 0xff ;\nprintf(\"m16 : 0x%x\\n\",m16);\n\nint p1 = (x &amp; m2) + ((x &gt;&gt; 1) &amp; m2);\nprintf(\"p1: 0x%x\\n\",p1);\n\nprintf(\"p1 &amp; m4 : 0x%x\\n\",p1 &amp; m4);\n\nprintf(\"p1 &gt;&gt; 2 : 0x%x\\n\",p1 &gt;&gt; 2);\n\nprintf(\"(p1 &gt;&gt; 2) &amp; m4 : 0x%x\\n\",(p1 &gt;&gt; 2) &amp; m4);\n\nint p2 = (p1 &amp; m4) + ((p1 &gt;&gt; 2) &amp; m4);\nprintf(\"p2 : 0x%x\\n\",p2);\n\nint p3 = (p2 &amp; m8) + ((p2 &gt;&gt; 4) &amp; m8) ;\nprintf(\"p3 : 0x%x\\n\",p3);\n\nint p4 = (p3 &amp; m16)  + ((p3 &gt;&gt; 8) &amp; m16) ;\nprintf(\"p4 : 0x%x\\n\",p4);\n//int p4 = p3   + (p3 &gt;&gt; 8)  ;\nint p5 = p4 + (p4 &gt;&gt; 16) ;\n\nprintf(\"BigCount result is : 0x%x\\n\",p5 &amp; 0xFF);\n}\n</code></pre>\n\n<p>And the printed result is :\n<a href=\"https://i.stack.imgur.com/n2KaZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n2KaZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>everything is as same as the one in Ubuntu. This makes me more confused.</p>\n\n<hr>\n\n<p>When I run this function in macOS 10.12, it gave an unexpected answer.  The input <code>x</code> is <code>0xffffffff</code> (<code>-1</code>).\nThe function is written in C language:</p>\n\n<pre><code>int bitCount(int x) {\n\n  int m2 = (((((0x55 &lt;&lt; 8) + 0x55 )&lt;&lt; 8) + 0x55)&lt;&lt; 8) + 0x55;\n  int m4 = (((((0x33 &lt;&lt; 8) + 0x33 )&lt;&lt; 8) + 0x33)&lt;&lt; 8) + 0x33;\n  int m8 = (((((0x0f &lt;&lt; 8) + 0x0f )&lt;&lt; 8) + 0x0f)&lt;&lt; 8) + 0x0f;\n  int m16 = (0xff &lt;&lt; 16) + 0xff ;\n\n  int p1 = (x &amp; m2) + ((x &gt;&gt; 1) &amp; m2);\n  int p2 = (p1 &amp; m4) + ((p1 &gt;&gt; 2) &amp; m4); //line 7\n  int p3 = (p2 &amp; m8) + ((p2 &gt;&gt; 4) &amp; m8) ;\n  int p4 = (p3 &amp; m16)  + ((p3 &gt;&gt; 8) &amp; m16) ;\n  //int p4 = p3   + (p3 &gt;&gt; 8)  ;\n  int p5 = p4 + (p4 &gt;&gt; 16) ;\n\n  return p5 &amp; 0xFF;\n}\n</code></pre>\n\n<p>When I track all the local variable by print it, I just found that the:</p>\n\n<pre><code>((p1 &gt;&gt; 2) &amp; m4) //line7\n</code></pre>\n\n<p>printed the value of '0x2222222'(seven '2' instead of eight '2').\n<a href=\"https://i.stack.imgur.com/8UA8e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8UA8e.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is so unexpected, the p1 prints '0x2aaaaaaa' and the m4 is '0x33333333', so it should be 0x22222222(eight '2;). \nHowever, when I run this in ubuntu 16.04, everything is just as expected, for the ((p1 >> 2) &amp; m4) prints '0x22222222':\n<a href=\"https://i.stack.imgur.com/Y3KUl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y3KUl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Do you run this on your Mac having the same problem? Does anything different in macOS lead to this problem? </p>\n"}, {"tags": ["c", "mips"], "comments": [{"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534260765, "post_id": 51844985, "comment_id": 90643344, "body": "I <i>highly</i> doubt the standard C libraries (here, <code>stdio.h</code>) can be used in this case."}, {"owner": {"reputation": 31, "user_id": 10225157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ecf5994a0b94e15009352661a9bb17?s=128&d=identicon&r=PG&f=1", "display_name": "Boris Goldshield", "link": "https://stackoverflow.com/users/10225157/boris-goldshield"}, "reply_to_user": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534261753, "post_id": 51844985, "comment_id": 90643945, "body": "I try to compile this program without any libs. Only <b>int main(void){}</b>. The result is exactly the same.@SusmitAgrawal"}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534261863, "post_id": 51844985, "comment_id": 90644008, "body": "Try using the <code>-ffreestanding</code> flag."}, {"owner": {"reputation": 31, "user_id": 10225157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ecf5994a0b94e15009352661a9bb17?s=128&d=identicon&r=PG&f=1", "display_name": "Boris Goldshield", "link": "https://stackoverflow.com/users/10225157/boris-goldshield"}, "reply_to_user": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534262539, "post_id": 51844985, "comment_id": 90644354, "body": "@SusmitAgrawal doesn&#39;t work"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 10225157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ecf5994a0b94e15009352661a9bb17?s=128&d=identicon&r=PG&f=1", "display_name": "Boris Goldshield", "link": "https://stackoverflow.com/users/10225157/boris-goldshield"}, "is_accepted": true, "score": 1, "last_activity_date": 1534271201, "last_edit_date": 1592644375, "creation_date": 1534271201, "answer_id": 51847684, "question_id": 51844985, "link": "https://stackoverflow.com/questions/51844985/error-illegal-instruction-mips-cross-compiler/51847684#51847684", "title": "Error: Illegal Instruction. Mips cross-compiler", "body": "<h1>Solved.</h1>\n<p>I use another toolchain. Link: <a href=\"https://www.mips.com/develop/tools/codescape-mips-sdk/download-codescape-mips-sdk-essentials/\" rel=\"nofollow noreferrer\">https://www.mips.com/develop/tools/codescape-mips-sdk/download-codescape-mips-sdk-essentials/</a>.</p>\n<p>For <strong>MIPS Classic Legacy CPU IP Cores: 4k, M4k, M14k, 24k, 34k, 74k, 1004k, 1074k</strong> with the same compile command.</p>\n"}], "owner": {"reputation": 31, "user_id": 10225157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ecf5994a0b94e15009352661a9bb17?s=128&d=identicon&r=PG&f=1", "display_name": "Boris Goldshield", "link": "https://stackoverflow.com/users/10225157/boris-goldshield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 51847684, "answer_count": 1, "score": 2, "last_activity_date": 1534271201, "creation_date": 1534260670, "question_id": 51844985, "link": "https://stackoverflow.com/questions/51844985/error-illegal-instruction-mips-cross-compiler", "title": "Error: Illegal Instruction. Mips cross-compiler", "body": "<p>I compile simple program on Linux x64 with Mips cross-compiller and upload it on my router with <em>scp</em>. When i run this program, i have error: <em>Illegal instruction</em> .</p>\n\n<p><strong>My program:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n  printf(\"Hello, world!\");\n  return 0;\n}\n</code></pre>\n\n<p><strong>/proc/cpuinfo</strong> of my mips-box:</p>\n\n<pre><code>system type         : Atheros AR9330 rev 1\nmachine             : TP-LINK TL-WR741ND v4\nprocessor           : 0\ncpu model           : MIPS 24Kc V7.4\nisa                 : mips1 mips2 mips32r1 mips32r2\nASEs implemented    : mips16\n</code></pre>\n\n<p><strong>Compile:</strong></p>\n\n<pre><code>mips-linux-gnu-gcc -static -march=24kc -o hello hello.c\n</code></pre>\n\n<p><strong>Upload:</strong></p>\n\n<pre><code>scp hello root@192.168.1.1:/tmp\n</code></pre>\n\n<p><strong>Run:</strong></p>\n\n<pre><code>root@OpenWrt:/tmp# ./hello\nIllegal instruction\n</code></pre>\n"}, {"tags": ["c", "reverse-engineering", "portable-executable"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1534275525, "post_id": 51844868, "comment_id": 90650564, "body": "Why are you not sure about your solution, exactly?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1534285150, "post_id": 51844868, "comment_id": 90654205, "body": "your &quot;solution&quot; of course wrong"}], "answers": [{"comments": [{"owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "edited": false, "score": 0, "creation_date": 1534323001, "post_id": 51850659, "comment_id": 90663477, "body": "Your&#39;s soluution is better than main. But I have one more question. Why pointer to OptionalHeader need to be casted to ULONG_PTR?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "edited": false, "score": 0, "creation_date": 1534329823, "post_id": 51850659, "comment_id": 90666616, "body": "@bielu000 - it not need to be casted. but we need do some pointer arithmetic. we need add some offset ( <code>SizeOfOptionalHeader</code>) to this pointer. how do this ? for example by temporary cast to <code>ULONG_PTR</code> or to <code>BYTE*</code>."}, {"owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "edited": false, "score": 0, "creation_date": 1534366978, "post_id": 51850659, "comment_id": 90684933, "body": "Ok thanks. One more simple question :) In my case is better to cast to ULONG_PTR, BYTE * or it doesn&#39;t matter?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "edited": false, "score": 0, "creation_date": 1534367284, "post_id": 51850659, "comment_id": 90685049, "body": "@bielu000 - if you know <i>c</i> - you must know that this is absolute nothing change"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 0, "last_activity_date": 1534286355, "creation_date": 1534286355, "answer_id": 51850659, "question_id": 51844868, "link": "https://stackoverflow.com/questions/51844868/empty-data-after-optionalheader/51850659#51850659", "title": "Empty data after OptionalHeader", "body": "<p>first of all - never use <code>DWORD</code> in place pointer. this is error. <code>DWORD</code> is always 4 byte size, when pointer 4 or 8. code like</p>\n\n<p><code>DWORD calculated_ptr = (DWORD)inth + optional_headers_size;</code></p>\n\n<p>always wrong. you can use <code>DWORD_PTR</code>(which is exactly pointer size) instead <code>DWORD</code>.</p>\n\n<p>then <code>SizeOfOptionalHeader</code> how easy understand is size of <code>IMAGE_OPTIONAL_HEADER</code> which is <strong>part</strong> of <code>IMAGE_NT_HEADERS</code>. but code like this </p>\n\n<p><code>DWORD_PTR calculated_ptr = (DWORD_PTR)inth + inth-&gt;FileHeader.SizeOfOptionalHeader;</code> use <code>SizeOfOptionalHeader</code> as size of <code>IMAGE_NT_HEADERS</code>. you simply confuse size of <code>IMAGE_NT_HEADERS</code> with size of <code>IMAGE_OPTIONAL_HEADER</code></p>\n\n<p>so correct solution will be </p>\n\n<pre><code>    PIMAGE_SECTION_HEADER pish = (PIMAGE_SECTION_HEADER)(\n        (ULONG_PTR)&amp;inth-&gt;OptionalHeader + inth-&gt;FileHeader.SizeOfOptionalHeader);\n</code></pre>\n\n<p>need add <code>SizeOfOptionalHeader</code> not to <code>inth</code> (address of <code>PIMAGE_NT_HEADERS</code>) but to <code>&amp;inth-&gt;OptionalHeader</code></p>\n\n<p>or better use <code>PIMAGE_SECTION_HEADER pish = IMAGE_FIRST_SECTION(inth);</code></p>\n\n<p>the <code>IMAGE_FIRST_SECTION</code> - this is ready macro defined in <code>winnt.h</code> which have the same effect (produce same code) as <code>(PIMAGE_SECTION_HEADER)((ULONG_PTR)&amp;inth-&gt;OptionalHeader + inth-&gt;FileHeader.SizeOfOptionalHeader);</code></p>\n"}], "owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 51850659, "answer_count": 1, "score": 0, "last_activity_date": 1534626157, "creation_date": 1534260276, "last_edit_date": 1534261403, "question_id": 51844868, "link": "https://stackoverflow.com/questions/51844868/empty-data-after-optionalheader", "title": "Empty data after OptionalHeader", "body": "<p>I'm working on PE parser, just for learning purposes. \nAs the doc said, the first section header should be immediately after OptionalHeader, but in my case I have a lot of empty data before first header.\nHere is my code to calculate where should be firtst section:</p>\n\n<pre><code>IMAGE_NT_HEADERS* inth = get_nt_headers(buffer);\n\nDWORD optional_headers_size = inth-&gt;FileHeader.SizeOfOptionalHeader;\nDWORD calculated_ptr = (DWORD)inth + optional_headers_size;\n\nprintf(\"Pointer to IMAGE_NT_HEADERS: %p\\n\", inth);\n\nprintf(\"Size of optional headers: %x\\n\", optional_headers_size);\n\nprintf(\"Pointer to first section header: %p\\n\", calculated_ptr);\n\nBYTE* pointer = (BYTE*)calculated_ptr;\n</code></pre>\n\n<p>When I iterate over the 'pointer' I see a lot of nullable data, so it is not section I need. PEView or Hexplorer shows empty data too. Why is that?\nThis 'nullable' part of data takes about 24 bytes.</p>\n\n<p>App which I analze is a simple HelloWorld.exe.</p>\n\n<p>I'm confused with one more thing.</p>\n\n<p>In FileHeader I has set 13 number of sections, but if I take a look on PEView in IMAGE_OPTIONAL_HEADER I see 16 sections but the last 3 sections have any assigned values, which means that the RVA and Size are set to 0. \nThis sections are: DELAY_IMPORT_DESCRIPTORS, CLI_HEADER, but the last doesn't has any name. </p>\n\n<p>I calculated that these three last section's size is 24 bytes.\nThis the excatly the same as I mentioned before. </p>\n\n<p>So how I can calculate where excatly is the firts IMAGE_SECTION_HEADER?</p>\n\n<p>Problem solved, but I'm not sure about my solution.</p>\n\n<pre><code>DWORD padding = (IMAGE_NUMBEROF_DIRECTORY_ENTRIES - inth-&gt;FileHeader.NumberOfSections) * sizeof(IMAGE_DATA_DIRECTORY);\nDWORD calculated_ptr = (DWORD)inth + padding + optional_headers_size;\n</code></pre>\n"}, {"tags": ["c", "free"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1534260473, "post_id": 51844850, "comment_id": 90643208, "body": "Please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> to show us. Preferably as a single block of code. And that should include all variables and also all input data you feed to the program. If possible, make a simplified input handlinmg, using some static compile-time fixed input that leads to the problem (also <a href=\"https://ericlippert.com/2014/03/21/find-a-simpler-problem/\" rel=\"nofollow noreferrer\">read about finding a simpler problem</a>). And of course <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1534260530, "post_id": 51844850, "comment_id": 90643245, "body": "&quot;Visual Studio triggers a break point&quot;. I dont think you mean that. I think you mean that you get an error message.Cam you please include the message"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1534261491, "post_id": 51844850, "comment_id": 90643796, "body": "@pm100 Visual Studio does break (as in, interrupt execution) when it detects certain kinds of problems via assertions or fences, so I suspect this is what he&#39;s referring to. Knowing the message that appears in Visual Studio would still be helpful though."}, {"owner": {"reputation": 17, "user_id": 5827223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DsL4Y.jpg?s=128&g=1", "display_name": "mcalabresi", "link": "https://stackoverflow.com/users/5827223/mcalabresi"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1534261564, "post_id": 51844850, "comment_id": 90643843, "body": "@Some programmer dude,  ok working on it"}, {"owner": {"reputation": 17, "user_id": 5827223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DsL4Y.jpg?s=128&g=1", "display_name": "mcalabresi", "link": "https://stackoverflow.com/users/5827223/mcalabresi"}, "edited": false, "score": 0, "creation_date": 1534261683, "post_id": 51844850, "comment_id": 90643905, "body": "@pm 100, thanks for reply, this is all i get from VS, sorry the language is italian: <a href=\"https://ibb.co/jKfL39\" rel=\"nofollow noreferrer\">ibb.co/jKfL39</a>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1534261946, "post_id": 51844850, "comment_id": 90644052, "body": "@TypeIA &#39;break point&#39; in an IDE has a very specific meaning. This is not it"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1534262531, "post_id": 51844850, "comment_id": 90644351, "body": "What is <code>rheadone</code> (and the other three variables in <code>main</code>) ?"}, {"owner": {"reputation": 17, "user_id": 5827223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DsL4Y.jpg?s=128&g=1", "display_name": "mcalabresi", "link": "https://stackoverflow.com/users/5827223/mcalabresi"}, "edited": false, "score": 0, "creation_date": 1534263868, "post_id": 51844850, "comment_id": 90645023, "body": "edited my question, hope my code is clear enough"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1534263914, "post_id": 51844850, "comment_id": 90645047, "body": "In <code>duplicate()</code>, you allocated an array with a single <code>malloc</code> and you are trying to <code>free</code> the elements individually in <code>free_run_str_list()</code>. You should only <code>free</code> exactly what you <code>malloc</code>ed."}, {"owner": {"reputation": 17, "user_id": 5827223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DsL4Y.jpg?s=128&g=1", "display_name": "mcalabresi", "link": "https://stackoverflow.com/users/5827223/mcalabresi"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1534264528, "post_id": 51844850, "comment_id": 90645377, "body": "@IanAbbott, so I need to change the whole code of free_sun_str_list() with free(head) because I allocated all the memory at once? (my questions could soud stupid but I&#39;m a student and I&#39;m trying to understand how memory managment works...thanks.)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1534264876, "post_id": 51844850, "comment_id": 90645563, "body": "You cannot allocate a list element-by-element and then &quot;duplicate&quot; it by allocating an entire array of elements and then pretend you have a well defined data type. If you want to define a linked list or any other data type, decide on <i>one</i> way to allocate it and <i>one</i> way to free it."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1534265204, "post_id": 51844850, "comment_id": 90645726, "body": "Basically, you cannot <code>free</code> the middle of a block allocated by <code>malloc</code>. You can only <code>free</code> the start of the block, and it frees the whole block that was allocated by <code>malloc</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1534265284, "post_id": 51844850, "comment_id": 90645767, "body": "You are writing out of bounds in the <code>duplicate</code> function. That destroys the value of <code>newmarker</code>"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1534290614, "post_id": 51844850, "comment_id": 90655404, "body": "@pm100 I understood perfectly what the OP meant and I don&#39;t think anything is to be gained by terminological pedantry in this case."}], "answers": [{"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 2, "last_activity_date": 1534264976, "creation_date": 1534264976, "answer_id": 51846178, "question_id": 51844850, "link": "https://stackoverflow.com/questions/51844850/c-free-sub-list-element-by-element-causes-unexpected-behavior/51846178#51846178", "title": "C, free sub-list element by element causes unexpected behavior", "body": "<p>From your posted code, the problem is in function <code>duplicate</code>. It sets variable <code>len</code> to the length of the list to be duplicated, and calls <code>malloc</code> to allocate a block of <code>len</code> elements of <code>list_run_str</code>.  It then fills in those elements and joins them together into a linked list of <code>list_run_str</code>, does some other stuff and returns a pointer to the first element.</p>\n\n<p>Presumably, the return value of function <code>duplicate</code> ends up in the <code>runstr</code> member of a <code>list_ex</code>.</p>\n\n<p>Your <code>free_run_str_list</code> function called from <code>free_list_ex</code> calls <code>free</code> on each item of the linked list. If this linked list was constructed by function <code>duplicate</code> then the first call to <code>free</code> will free the entire block. However, you are freeing each item of the linked list individually even though they were all allocated from a single call to <code>malloc</code>.</p>\n\n<p>To fix it, you should change your <code>duplicate</code> function to <code>malloc</code> each item of the linked list individually, since that is what the <code>free_run_str_list</code> function expects.</p>\n"}], "owner": {"reputation": 17, "user_id": 5827223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DsL4Y.jpg?s=128&g=1", "display_name": "mcalabresi", "link": "https://stackoverflow.com/users/5827223/mcalabresi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 51846178, "answer_count": 1, "score": 0, "last_activity_date": 1534264976, "creation_date": 1534260206, "last_edit_date": 1534263797, "question_id": 51844850, "link": "https://stackoverflow.com/questions/51844850/c-free-sub-list-element-by-element-causes-unexpected-behavior", "title": "C, free sub-list element by element causes unexpected behavior", "body": "<p>I have a a linked list inside another linked list, typedefs are the following:</p>\n\n<pre><code>typedef struct struct_execution_queue {\n\n    list_run_str *runstr;\n    list_run_str *marker; //just a pointer to a specific element in runstr (it was not allocated with `malloc()`)\n\n    int excount;\n\n    struct struct_execution_queue *next;\n}list_ex;\n</code></pre>\n\n<p><code>list_run_str</code> is another linked list:</p>\n\n<pre><code>typedef struct struct_run_str { //run element\n    char car;\n    struct struct_run_str *next;\n    struct struct_run_str *prev;\n} list_run_str;\n</code></pre>\n\n<p>I implemented an <code>insert()</code> method that creates a new <code>list_ex</code> element and insert it in the head of the list. I tried to run a simple test code to see if memory management was ok:</p>\n\n<pre><code>int main(){\n/*read data from input file and insert into lists (this part is ok)\nI have all data I need: two rheads and two markers\n*/\nlist_ex *exhead = NULL;\n\nexhead = insert(exhead, rheadone, markerone, 10);\nexhead = insert(exhead, rheadtwo, markertwo, 20);\n\nfree_ex_list(exhead);\n\n}\n</code></pre>\n\n<p>To free all <code>exhead</code> elements I need to free the relative sublist first.\nSince <code>rhead</code> (sublist of <code>exhead</code>) is a linked list too (allocated with <code>malloc()</code>), I think it sould be freed element by element. This is the code I use:</p>\n\n<pre><code>void free_run_str_list(list_run_str *head) { //free a list_run_str list\n    list_run_str *tmp;\n\n    while (head != NULL) {\n        tmp = head;\n        head = head-&gt;next;\n        free(tmp);\n    } // &lt;--------------------- breackpoint triggered here\n}\n\nvoid free_ex_list(list_ex *head) { //free a list_ex list\n    list_ex *tmp;\n\n    while (head != NULL) {\n        tmp = head;\n        free_run_str_list(tmp-&gt;runstr);\n        head = head-&gt;next;\n        free(tmp);\n    }\n}\n</code></pre>\n\n<p><strong>The problem is</strong> when I compile this code, Visual Studio triggers a break point in the indicated line. When I debug step by step, the code runs until  <code>free_run_str_list(tmp-&gt;runstr);</code> enters the call and does the first <code>free(tmp)</code>. Now <code>tmp</code> has random values inside it (as it sould be) but also <code>head</code> has the same random values and, at the second iteration, the line <code>free(temp)</code> tries to free already freed memory causing (i guess) the error to occur.</p>\n\n<p><strong>So my questions are:</strong></p>\n\n<ol>\n<li>Why this happens?</li>\n<li>Does it means an error while allocating memory? (if this is the case i leave the insert code below)</li>\n<li>Is this the right way to free <code>exhead</code>?</li>\n</ol>\n\n<p>I searched for similar solutions but I think I have a different issue.</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/17363688/c-unable-to-free-memory-allocated-within-a-linked-list-structure\">Here</a> the issue was <code>malloc()</code> not allocating enough space for terminating character (not my case: i have a liked list of chars as sublist, not a string pointer).</li>\n<li>Not shure why but if I replace <code>free_run_str_list(tmp-&gt;runstr);</code> with <code>free(tmp-&gt;runstr)</code> in <code>free_ex_list()</code> no break points are triggered (but I am not shure this is the proper way: free only the head of the sub-linked list?).</li>\n</ul>\n\n<p>Insert code:</p>\n\n<pre><code>list_ex *insert(list_ex *exhead, list_run_str *rhead, list_run_str *marker, int count) {\n    list_ex *tmp;\n    list_run_str *tmphead, *tmpmarker;\n\n    if ((tmp = (list_ex *)malloc(sizeof(list_ex)))) {\n\n        tmphead = duplicate(rhead, marker, &amp;tmpmarker);\n        tmp-&gt;runstr = tmphead;\n        tmp-&gt;marker = tmpmarker;\n\n        tmp-&gt;excount = count;\n\n        tmp-&gt;next = exhead;\n        exhead = tmp;\n    }\n    else\n        printf(\"insert mem error\\n\");\n    return tmp;\n}\n\n\n\nlist_run_str *duplicate(list_run_str *head, list_run_str *marker, list_run_str **newmarker) { //duplicate a list_run_str_list and the relative marker\n    list_run_str *newhead, *newtmphead, *tmphead;\n    int markerpos, len, i;\n\n    //find list length\n    for (len = 0, tmphead = head; tmphead != NULL; len++, tmphead = tmphead-&gt;next);\n\n    //find marker position in head\n    markerpos = 0;\n    if (marker != NULL)\n        for (tmphead = marker; tmphead-&gt;prev != NULL; markerpos++, tmphead = tmphead-&gt;prev);\n\n    //create new list_run_str list\n    if ((newhead = (list_run_str *)malloc(sizeof(list_run_str) * len))) {\n        i = 0;\n        //load the new head\n        newtmphead = newhead;\n        tmphead = head;\n\n        (newtmphead + i)-&gt;prev = NULL;\n        (newtmphead + i)-&gt;next = (newtmphead + i + 1);\n        (newtmphead + i)-&gt;car = tmphead-&gt;car;\n\n        //load other elements\n        for (i++, tmphead = tmphead-&gt;next; tmphead != NULL; i++, tmphead = tmphead-&gt;next) {\n            (newtmphead + i)-&gt;car = tmphead-&gt;car;\n            (newtmphead + i)-&gt;next = (newtmphead + i + 1);\n            (newtmphead + i)-&gt;prev = (newtmphead + i - 1);\n        }\n        ((newtmphead)+len - 1)-&gt;next = NULL;\n\n        //update the new marker\n        for (i = 0, newtmphead = newhead; i &lt; markerpos; i++, newtmphead = newtmphead-&gt;next);\n        *newmarker = newtmphead;\n    }\n    else\n        printf(\"duplicate mem error\\n\");\n    return newhead;\n}\n</code></pre>\n\n<p>Thanks for help.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>here is the exact code that causes the issue, i tried to simplify it as much as i could.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct struct_run_str {\n    char car;\n    struct struct_run_str *next;\n    struct struct_run_str *prev;\n} list_run_str;\n\ntypedef struct struct_execution_queue {\n    list_run_str *runstr; //this will be allocated with malloc()\n    list_run_str *marker; //this is only a pointer to a certain element in runstr\n\n    int excount;\n\n    struct struct_execution_queue *next;\n}list_ex;\n\nvoid free_run_str_list(list_run_str *head) { //free a \"list_run_str\" list\n    list_run_str *tmp;\n\n    while (head != NULL) {\n        tmp = head;\n        head = head-&gt;next;\n        free(tmp);\n    }\n}\n\nvoid free_ex_list(list_ex *head) { //free a \"list_ex\" list\n    list_ex *tmp;\n\n    while (head != NULL) {\n        tmp = head;\n        free_run_str_list(tmp-&gt;runstr);\n        head = head-&gt;next;\n        free(tmp);\n    }\n}\n\nlist_run_str *loadrunstr(list_run_str *head, char c) { //add an item at the ed of a \"list_run_str\" list\n    list_run_str *tmp, *tmphead;\n\n    if ((tmp = (list_run_str *)malloc(sizeof(list_run_str)))) {\n        tmp-&gt;car = c;\n        tmp-&gt;next = NULL;\n\n        if (head == NULL) {\n            tmp-&gt;prev = NULL;\n            head = tmp;\n        }\n        else {\n            for (tmphead = head; tmphead-&gt;next != NULL; tmphead = tmphead-&gt;next);\n            tmphead-&gt;next = tmp;\n            tmp-&gt;prev = tmphead;\n        }\n    }\n    else\n        printf(\"loadrunstr mem error\\n\");\n    return head;\n}\n\nlist_run_str *duplicate(list_run_str *head, list_run_str *marker, list_run_str **newmarker) { //duplicte head to newhed and adjust newmarker\n    list_run_str *newhead, *newtmphead, *tmphead;\n    int markerpos, len, i;\n\n    //find list length\n    for (len = 0, tmphead = head; tmphead != NULL; len++, tmphead = tmphead-&gt;next);\n\n    //find marker position\n    markerpos = 0;\n    if (marker != NULL)\n        for (tmphead = marker; tmphead-&gt;prev != NULL; markerpos++, tmphead = tmphead-&gt;prev);\n\n    //create new \"list_run_str\" list\n    if ((newhead = (list_run_str *)malloc(sizeof(list_run_str) * len))) {\n        i = 0;\n        //load the head\n        newtmphead = newhead;\n        tmphead = head;\n\n        (newtmphead + i)-&gt;prev = NULL;\n        (newtmphead + i)-&gt;next = (newtmphead + i + 1);\n        (newtmphead + i)-&gt;car = tmphead-&gt;car;\n\n        //load the other elements\n        for (i++, tmphead = tmphead-&gt;next; tmphead != NULL; i++, tmphead = tmphead-&gt;next) {\n            (newtmphead + i)-&gt;car = tmphead-&gt;car;\n            (newtmphead + i)-&gt;next = (newtmphead + i + 1);\n            (newtmphead + i)-&gt;prev = (newtmphead + i - 1);\n        }\n        ((newtmphead)+len - 1)-&gt;next = NULL;\n\n        //update new marker position\n        for (i = 0, newtmphead = newhead; i &lt; markerpos; i++, newtmphead = newtmphead-&gt;next);\n        *newmarker = newtmphead;\n    }\n    else\n        printf(\"duplicate mem error\\n\");\n    return newhead;\n}\n\nlist_ex *insert(list_ex *exhead, list_run_str *rhead, list_run_str *marker, int count) { //insert new element in the head of a \"list_ex\" list\n    list_ex *tmp;\n    list_run_str *tmphead, *tmpmarker;\n\n    if ((tmp = (list_ex *)malloc(sizeof(list_ex)))) {\n\n        tmphead = duplicate(rhead, marker, &amp;tmpmarker);\n        tmp-&gt;runstr = tmphead;\n        tmp-&gt;marker = tmpmarker;\n\n        tmp-&gt;excount = count;\n\n        tmp-&gt;next = exhead;\n        exhead = tmp;\n    }\n    else\n        printf(\"insert mem error\\n\");\n    return tmp;\n}\n\nint main() {\n    list_ex *exhead;\n    list_run_str *rheadone, *markerone, *rheadtwo, *markertwo;\n\n    exhead = NULL;\n    rheadone = NULL;\n    rheadtwo = NULL;\n\n    //load some items in rheadone\n    rheadone = loadrunstr(rheadone, 'a');\n    rheadone = loadrunstr(rheadone, 'b');\n    rheadone = loadrunstr(rheadone, 'c');\n\n    //load some items in rheadtwo\n    rheadtwo = loadrunstr(rheadtwo, 'd');\n    rheadtwo = loadrunstr(rheadtwo, 'e');\n    rheadtwo = loadrunstr(rheadtwo, 'f');\n\n    //set markerone to point at some char in rheadone\n    markerone = rheadone-&gt;next; //points to 'b'\n\n    //set markertwho to point at some char in rheadtwo\n    markertwo = rheadtwo; //points to 'd'\n\n    //insert two new elements into exhead\n    exhead = insert(exhead, rheadone, markerone, 10);\n    exhead = insert(exhead, rheadone, markerone, 20);\n\n    //try to free them\n    free_ex_list(exhead);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 7, "creation_date": 1534259987, "post_id": 51844731, "comment_id": 90642914, "body": "This code is just wildly undefined behavior, anything can happen. There is no predictable outcome of this code to be had. Instead use structs, possible with a <i>flexible array member</i> at the end."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1534260281, "post_id": 51844731, "comment_id": 90643094, "body": "I would throw this code in the bin. 1. What does this mean ` a = (int *) malloc(sizeof(int) + sizeof(double *));` - Why the cast and what are you . trying to achieve. 2. Playing around with <code>a</code> and then ` free(((int *) a - 1))` as you state it will fail The code is a mess - bin it."}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1534260346, "post_id": 51844731, "comment_id": 90643133, "body": "Your a++ is being done with a double sized amount, so you&#39;re moving (probably) 8 bytes, instead of (probably) 4.  You possibly also have alignment problems.  x86 doesn&#39;t require doubles on 8-byte boundaries, but other architectures might."}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1534260539, "post_id": 51844731, "comment_id": 90643248, "body": "Doing this to not be undefined behaviour probably requires a struct that looks like struct { int size; char prefix[1] }, using the extendable structure paradigm.  Then return a pointer to prefix.  Getting your pointer back is probably still difficult.  Still potential alignment problems."}, {"owner": {"reputation": 9, "user_id": 10225284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4n-EbGD6LmY/AAAAAAAAAAI/AAAAAAAADpM/A83zulR8tdM/photo.jpg?sz=128", "display_name": "Istv&#225;n Bozs&#243;", "link": "https://stackoverflow.com/users/10225284/istv%c3%a1n-bozs%c3%b3"}, "edited": false, "score": 0, "creation_date": 1534260559, "post_id": 51844731, "comment_id": 90643262, "body": "I see. Thank you for the answer. The reason I wanted to use fat pointers because this way I can use any data type (int, float, ...) with the fat pointer (given that <code>sizeof(double *)</code> is exchanged to <code>sizeof(int *)</code> or <code>sizeof(float *)</code> and so on."}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 2, "creation_date": 1534260607, "post_id": 51844731, "comment_id": 90643269, "body": "Also your a=b just reassigns your pointer to b, and you&#39;ve lost it.  You need to memcpy()."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1534260980, "post_id": 51844731, "comment_id": 90643495, "body": "You want to implement a lightweight version of <code>C++ vector</code> in C? I would start with defining the interface, what do you expect from that thing? If you know what you want, it makes sense to think about the implementation. BTW: what is a fat pointer, when do you use thin pointer?"}, {"owner": {"reputation": 9, "user_id": 10225284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4n-EbGD6LmY/AAAAAAAAAAI/AAAAAAAADpM/A83zulR8tdM/photo.jpg?sz=128", "display_name": "Istv&#225;n Bozs&#243;", "link": "https://stackoverflow.com/users/10225284/istv%c3%a1n-bozs%c3%b3"}, "edited": false, "score": 0, "creation_date": 1534261654, "post_id": 51844731, "comment_id": 90643888, "body": "Thanks for the answers! I was trying to replicate the behaviour of the library mentioned in the description because I was interested in its inner workings. I am working on the program based on the answers, once I solved the problem I will post it as an answer. Again thanks for the help! (Fat pointer explained <a href=\"http://libcello.org/learn/a-fat-pointer-library\" rel=\"nofollow noreferrer\">here</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5415148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a739c7548401896ab352217f504f9d34?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Le", "link": "https://stackoverflow.com/users/5415148/abraham-le"}, "is_accepted": false, "score": 0, "last_activity_date": 1577717649, "creation_date": 1577717649, "answer_id": 59532739, "question_id": 51844731, "link": "https://stackoverflow.com/questions/51844731/c-fat-pointer-implementation-failure/59532739#59532739", "title": "C fat pointer implementation failure", "body": "<p>Packing the length at the beginning of the array is not a fat pointer, but an ill-formed PASCAL array.</p>\n\n<pre><code>int main(fat_pointer);\n\nint main(int argc, char* argv[argc]); // standard signature for main is a fat pointer\n</code></pre>\n\n<p>A fat pointer is a pointer and an index. The data type of the index is an integral type which guarantees that <code>sizeof index &lt;= sizeof(size_t)</code>. In other words, <code>sizeof(int) &lt;= sizeof(size_t)</code> is a mandate for all compliant hosted environment because <code>main</code> demands so. Note that <code>size_t</code> is not defined for freestanding environment.</p>\n\n<p>The problem with <code>_s</code> functions is that they use <code>sal.h</code> from Microsoft which allow the usage of variables before declaration.</p>\n\n<pre><code>char * strcpy_s(char * restrict dest, rsize_t destsz, char const * restrict src);\n\n// fat pointer form fails\nchar * strcpy_s(char dest[destsz], rsize_t destsz, char const * src);\n</code></pre>\n\n<p>The fat pointer form fails because destsz is declared afterwards, so it cannot be used. Annex K is horrible because it has usage before declaration in fat pointer form. Look at <code>main</code> where <code>argc</code> is declared before <code>argv</code>; that is the proper way to declare a fat pointer.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid print_vector_double(int len, double d[len])\n{\n    for (int i = 0; i &lt; len; i++)\n        printf(\"%lf \", d[i]);\n    printf(\"\\n\");\n    printf(\"%d\\n\", len);\n}\n\nint main(int argc, char* argv[argc])\n{\n    // C89 VLA - initialized VLA\n    double b[] = { 1, 2, 3, 5, };\n    int b_len = (int)(sizeof b / sizeof b[0]);\n    print_vector_double(b_len, b);\n\n    // C99 VLA - uninitialized VLA\n    int c_len = b_len;\n    double c[c_len];\n    c = b;\n    print_vector_double(c_len, c);\n\n    // Good Old Heap for Dynamic Arrays\n    int a_len = b_len;\n    double * a = malloc(a_len * sizeof * a);\n    double * temp = memcpy(a, b_len * sizeof * b, b);\n    if (temp != a) exit(EXIT_FAILURE);\n    print_vector_double(a_len, a);\n\n    free(a), a = NULL, a_len = 0;\n}\n</code></pre>\n\n<p>A fat pointer is what you pass to a function. If you are not passing anything to another function, there is no fat pointer.</p>\n\n<p>Cello failed to understand what a fat pointer really is.</p>\n"}], "owner": {"reputation": 9, "user_id": 10225284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4n-EbGD6LmY/AAAAAAAAAAI/AAAAAAAADpM/A83zulR8tdM/photo.jpg?sz=128", "display_name": "Istv&#225;n Bozs&#243;", "link": "https://stackoverflow.com/users/10225284/istv%c3%a1n-bozs%c3%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577717649, "creation_date": 1534259792, "last_edit_date": 1534260190, "question_id": 51844731, "link": "https://stackoverflow.com/questions/51844731/c-fat-pointer-implementation-failure", "title": "C fat pointer implementation failure", "body": "<p>I have discovered a <a href=\"https://github.com/nothings/stb/blob/master/stretchy_buffer.h\" rel=\"nofollow noreferrer\">library</a> recently which implements a C++ vector like functionality using fat pointers.</p>\n\n<p>I have tried to replicate a similar behaviour in a short program (see the code below). I can access the array elements fine but when I try to get the number of elements my program prints garbage.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    double * a = NULL;\n\n    // the data\n    double b[] = {1, 2, 3, 5};\n\n    a = (int *) malloc(sizeof(int) + sizeof(double *));\n    a[0] = 4;\n    a++;\n    a = b;\n\n    // will print 1.0 2.0 3.0 5.0\n    printf(\"%lf %lf %lf %lf\\n\", a[0], a[1], a[2], a[3]);\n\n    // prints garbage\n    printf(\"%d\\n\", *((int *) a - 1));\n\n    // this will fail\n    free(((int *) a - 1))\n    return 0;\n}\n</code></pre>\n\n<p>It is likely that the problem lies in the pointer arithmetic part of the code, i.e. <code>(int *) a - 1</code> points to the wrong address, but I could not figure out why is that the case.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["java", "android", "c", "java-native-interface", "native"], "comments": [{"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534258660, "post_id": 51844210, "comment_id": 90642062, "body": "In this case, the JNI builds a shared library, which is not an independent executable. It just contains classes and methods that will be used in the app. The executable you build is literally an &quot;executable&quot;. It has its own entry point and becomes a separate process when called from command line."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8231749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39af96863945855e1a55ff3ce4d12b?s=128&d=identicon&r=PG&f=1", "display_name": "NVDQ", "link": "https://stackoverflow.com/users/8231749/nvdq"}, "edited": false, "score": 0, "creation_date": 1534314798, "post_id": 51851949, "comment_id": 90660301, "body": "Thanks for your help. My situation is exactly the same as you think. I tried using Runtime.getRuntime().exec(&quot;su&quot;) and also added &lt;uses-permission android:name=&quot;android.permission.ACCESS_SUPERUSER&quot;/&gt; to manifest but I have an issue with permission denied. My device is rooted."}, {"owner": {"reputation": 23, "user_id": 8231749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39af96863945855e1a55ff3ce4d12b?s=128&d=identicon&r=PG&f=1", "display_name": "NVDQ", "link": "https://stackoverflow.com/users/8231749/nvdq"}, "edited": false, "score": 0, "creation_date": 1534315135, "post_id": 51851949, "comment_id": 90660397, "body": "I also checked that, my app run with user &quot;u0_a41&quot; instead &quot;root&quot; as I do with executable in command line. So your answer is right, seem it doesn&#39;t have permission to invokes kernel function."}, {"owner": {"reputation": 10161, "user_id": 8034839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N8r2x.jpg?s=128&g=1", "display_name": "shizhen", "link": "https://stackoverflow.com/users/8034839/shizhen"}, "reply_to_user": {"reputation": 23, "user_id": 8231749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39af96863945855e1a55ff3ce4d12b?s=128&d=identicon&r=PG&f=1", "display_name": "NVDQ", "link": "https://stackoverflow.com/users/8231749/nvdq"}, "edited": false, "score": 0, "creation_date": 1534315485, "post_id": 51851949, "comment_id": 90660522, "body": "@NVDQ, Could you please vote up my answer and accept it if it helped you? Thanks."}], "tags": [], "owner": {"reputation": 10161, "user_id": 8034839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N8r2x.jpg?s=128&g=1", "display_name": "shizhen", "link": "https://stackoverflow.com/users/8034839/shizhen"}, "is_accepted": true, "score": 1, "last_activity_date": 1534315446, "last_edit_date": 1534315446, "creation_date": 1534298351, "answer_id": 51851949, "question_id": 51844210, "link": "https://stackoverflow.com/questions/51844210/different-between-native-c-code-run-in-jni-and-run-in-the-shell-in-android/51851949#51851949", "title": "Different between native C code run in jni and run in the shell in Android", "body": "<p>I think your device is rooted. </p>\n\n<blockquote>\n  <p>I also build an executable that use this library and it run ok by command line. </p>\n</blockquote>\n\n<p>Maybe you run this command with <code>su</code> and can execute it without issue. </p>\n\n<p>But, if you execute your binary from App by JNI, then you are actually running the command with a normal user permission which may have issue if your C code invokes some kernel functions. </p>\n\n<p>Have you tried below code in your app?</p>\n\n<pre><code>Runtime.getRuntime().exec(\"su\").\n</code></pre>\n\n<p>Here is some reference for you <a href=\"http://muzikant-android.blogspot.com/2011/02/how-to-get-root-access-and-execute.html?_sm_au_=iqsHGF7FqZfPGrJb\" rel=\"nofollow noreferrer\">http://muzikant-android.blogspot.com/2011/02/how-to-get-root-access-and-execute.html?_sm_au_=iqsHGF7FqZfPGrJb</a> </p>\n"}], "owner": {"reputation": 23, "user_id": 8231749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39af96863945855e1a55ff3ce4d12b?s=128&d=identicon&r=PG&f=1", "display_name": "NVDQ", "link": "https://stackoverflow.com/users/8231749/nvdq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 51851949, "answer_count": 1, "score": 2, "last_activity_date": 1534315446, "creation_date": 1534258107, "question_id": 51844210, "link": "https://stackoverflow.com/questions/51844210/different-between-native-c-code-run-in-jni-and-run-in-the-shell-in-android", "title": "Different between native C code run in jni and run in the shell in Android", "body": "<p>I have a native C Android application. First I build native C code into shared library and jni will use this library. This library uses some kernel loadable module .ko, some already loaded, some must loaded by \"insmod\" command.</p>\n\n<p>I also build an executable that use this library and it run ok by command line. But the jni which do the same work as executable run fail when it calls function that need kernel module to be loaded.</p>\n\n<p>So what is the difference between them? Do I need grant some permission for my app?</p>\n"}, {"tags": ["c", "function", "pointers", "stack", "push"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534258263, "post_id": 51844161, "comment_id": 90641797, "body": "Simply put: never use pointer-to-pointer unless you intend to return a pointer through that parameter. And there&#39;s no real reason why you need to pass around <code>StackNode**</code>. It would be better if you put all allocation and hardcopies inside the stack ADT and not expose any internals at all to the caller."}], "answers": [{"comments": [{"owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "edited": false, "score": 1, "creation_date": 1534259278, "post_id": 51844452, "comment_id": 90642480, "body": "Sander is correct. A side.. I would also point out that your <code>peek</code> function is returning a negative to an <code>unsigned int</code>.. your compiler should be warning about this."}, {"owner": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "edited": false, "score": 0, "creation_date": 1534259976, "post_id": 51844452, "comment_id": 90642903, "body": "thanks a lot, got it working with your suggestions. anyways i might get rid of pointer-to-pointer at all as what Lundin wrote.. edit: oh and thanks dutchRooster, I&#39;m aware of that :)"}], "tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": true, "score": 2, "last_activity_date": 1534258844, "creation_date": 1534258844, "answer_id": 51844452, "question_id": 51844161, "link": "https://stackoverflow.com/questions/51844161/pushing-into-stack-from-function-in-c/51844452#51844452", "title": "pushing into stack from function in C", "body": "<p>Your <code>push</code> function modifies the root :</p>\n\n<pre><code>*root = stackNode;\n</code></pre>\n\n<p>In your <code>testfunc</code>, this change is done to the <code>root</code> variable which is local to the function. Ie. any change to it will not be visible in the calling function (<code>main</code>). So, from the point of view of <code>main</code>, it's as if nothing changed, since the <code>root</code> variable there hasn't changed.</p>\n\n<p>To make sure that a change to <code>root</code> in <code>testfunc</code> is also visible in <code>main</code>, you can eg. return it :</p>\n\n<pre><code>struct StackNode* testfunc(struct StackNode* root, unsigned int a, unsigned int b) \n{\n   push(&amp;root, a);\n   push(&amp;root, b);\n   return root;\n}\n\nroot = testfunc(root, 12, 15);\n</code></pre>\n\n<p>Or alternatively, you can :</p>\n\n<pre><code>void testfunc(struct StackNode** root, unsigned int a, unsigned int b) \n{\n   push(root, a);\n   push(root, b);\n}\n\ntestfunc(&amp;root, 12, 15);\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10201560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c2ae5027b310139000a3154e5678b6e?s=128&d=identicon&r=PG&f=1", "display_name": "David Dabrue", "link": "https://stackoverflow.com/users/10201560/david-dabrue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 51844452, "answer_count": 1, "score": 0, "last_activity_date": 1534258844, "creation_date": 1534257996, "question_id": 51844161, "link": "https://stackoverflow.com/questions/51844161/pushing-into-stack-from-function-in-c", "title": "pushing into stack from function in C", "body": "<p>In my testfunction, I'm trying to push two values into my stack. It works well from main(), but I think when using the testfunc() I messed up with the pointers? </p>\n\n<p>The values reach the push() function, but the values doesn't end up in my stack at all.</p>\n\n<p>Thanks in advance for help</p>\n\n<pre><code>struct StackNode\n    {\n        unsigned int data;\n        struct StackNode* next;\n    };\n\n    struct StackNode* newNode(unsigned int data)\n    {\n        struct StackNode* stackNode =\n                  (struct StackNode*) malloc(sizeof(struct StackNode));\n        stackNode-&gt;data = data;\n        stackNode-&gt;next = NULL;\n\n        return stackNode;\n    }\n\n    int isEmpty(struct StackNode *root)\n    {\n        return !root;\n    }\n\n    void push(struct StackNode** root, unsigned int data)\n    {\n        struct StackNode* stackNode = newNode(data);\n        stackNode-&gt;next = *root;\n        *root = stackNode;\n        printf(\"%u pushed to stack\\n\", data);\n    }\n\n    void pop(struct StackNode** root)\n    {\n        if (isEmpty(*root))\n            printf(\"ERROR\");\n        struct StackNode* temp = *root;\n        *root = (*root)-&gt;next;\n        free(temp);\n\n    }\n\n    unsigned int peek(struct StackNode* root)\n    {\n        if (isEmpty(root))\n            return -2;\n        return root-&gt;data;\n    }\nvoid testfunc(struct StackNode* root, unsigned int a, unsigned int b) \n{\n       struct StackNode *r=root;\n       push(&amp;r, a);\n       push(&amp;r, b); \n    }\n</code></pre>\n\n<p>Main</p>\n\n<pre><code>int main()\n    {\n        struct StackNode* root = NULL;\n        push(&amp;root,0); // Works well and pushes \"0\" to the stack.\n\n        testfunc(root,12,15); // &lt;-- doesn't push any value in the stack\n}\n</code></pre>\n"}, {"tags": ["c", "boolean"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 3, "creation_date": 1534255114, "post_id": 51843226, "comment_id": 90639505, "body": "<code>=</code> is for assignment.  <code>==</code> is for equality comparisons."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534255138, "post_id": 51843226, "comment_id": 90639522, "body": "<code>if (Ar[i] = (true))</code> --&gt; <code>if (Ar[i] == (true))</code> or better: <code>if (Ar[i])</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1534255171, "post_id": 51843226, "comment_id": 90639539, "body": "Also, <code>bool Ar[15] = {true}</code> only initializes the first member of the array."}, {"owner": {"reputation": 1, "user_id": 9788855, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fbEj_k7qNWA/AAAAAAAAAAI/AAAAAAAAAkg/YSJ8BXNlbAg/photo.jpg?sz=128", "display_name": "Emily Johnson", "link": "https://stackoverflow.com/users/9788855/emily-johnson"}, "edited": false, "score": 0, "creation_date": 1534255392, "post_id": 51843226, "comment_id": 90639679, "body": "oh wait really? thanks so much!"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1534255466, "post_id": 51843226, "comment_id": 90639732, "body": "In <code>main</code>, consider another loop to initialize the flags: <code>for(int i=0; i&lt;n; ++i)Ar[i]=true;</code> (and note that you don&#39;t need parentheses around <code>true</code>"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1534255944, "post_id": 51843226, "comment_id": 90640095, "body": "Do you have warnings turned on? <code>if (Ar[i] = (true)) ...</code> should give you a warning."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534256248, "post_id": 51843226, "comment_id": 90640327, "body": "Note: <code>i*i</code> and <code>i+j</code> in <code>for (int j = i*i; j&lt;=n; j = i+j)</code> can overflow <code>int</code> math with large <code>n</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534256343, "post_id": 51843226, "comment_id": 90640404, "body": "@chux I really have to start paying attention to tags. You&#39;d think I would, as long as I&#39;ve been here. Thanks."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534256571, "post_id": 51843226, "comment_id": 90640574, "body": "Algorithm improvement.  First loop <code>for (int i = 2; i &lt;= n; ++i)</code> needs to only iterate to about the square root of <code>n</code>.  Suggest <code>for (int i = 2; i &lt;= n&#47;i; ++i)</code>.  This will also reduce <code>int</code> overflow concerns."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1534256798, "post_id": 51843226, "comment_id": 90640764, "body": "Don&#39;t compare with boolean constants. Use self-explanatory names and use the directly. Also there is no need for the parentheses around the <code>true</code> etc, macros. They just obfuscate the code even more."}], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 3, "last_activity_date": 1534255154, "creation_date": 1534255154, "answer_id": 51843272, "question_id": 51843226, "link": "https://stackoverflow.com/questions/51843226/change-elements-of-a-boolean-array-to-false-in-c/51843272#51843272", "title": "Change elements of a boolean array to false in C", "body": "<p>You are assigning ( = ) the value, not comparing ( == ) it. Change it to </p>\n\n<pre><code>if (Ar[i] == (true))\n.\n.\n</code></pre>\n\n<p>Also, there is something called <a href=\"https://en.wikipedia.org/wiki/Yoda_conditions\" rel=\"nofollow noreferrer\">Yoda conditions</a> for exactly this kind of errors. Take a look</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1534255696, "creation_date": 1534255696, "answer_id": 51843451, "question_id": 51843226, "link": "https://stackoverflow.com/questions/51843226/change-elements-of-a-boolean-array-to-false-in-c/51843451#51843451", "title": "Change elements of a boolean array to false in C", "body": "<p>First issue:</p>\n\n<pre><code>bool Ar[15] = {true};\n</code></pre>\n\n<p>only initializes the first element in the array to <code>true</code>; the remaining elements will be initialized to <code>false</code>.  However, the reason you're printing every number is that</p>\n\n<pre><code>if (Ar[i] = (true))\n</code></pre>\n\n<p><em>assigns</em> <code>true</code> to <code>Ar[i]</code>, rather than performing a comparison.  You need to change that to either</p>\n\n<pre><code>if ( Ar[i] == true ) \n</code></pre>\n\n<p>or, even better:</p>\n\n<pre><code>if ( Ar[i] )\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534256825, "post_id": 51843467, "comment_id": 90640786, "body": "Well spotted array bounds problem.  Yet rather than re-code with <code>i &lt; n</code> and not prime-test <code>n</code>, code could use a 1-larger array like <code>bool Ar[15 + 1]</code>."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1534256385, "last_edit_date": 1534256385, "creation_date": 1534255742, "answer_id": 51843467, "question_id": 51843226, "link": "https://stackoverflow.com/questions/51843226/change-elements-of-a-boolean-array-to-false-in-c/51843467#51843467", "title": "Change elements of a boolean array to false in C", "body": "<p>Two main problems:</p>\n\n<ol>\n<li><p>As other stated the condition is wrong (actually it assigns the array elements with true and the condition is always true.</p></li>\n<li><p><code>for (int i = 2; i &lt;= n; ++i)</code> and <code>Ar[i]</code> - undefined behavior as arrays are indexed from <code>0</code> not <code>one</code> and you have an out of bounds access here . It has to be <code>for (int i = 1; i &lt; n; ++i)</code> </p></li>\n</ol>\n\n<p>Same couple of lines later <code>for (int j = i*i; **j&lt;=n**; j = i+j)</code></p>\n\n<p>and again <code>for (int i = 2; **i &lt;= n**; ++i)</code></p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534260096, "post_id": 51844165, "comment_id": 90642978, "body": "1) <code>bool Ar[15] = { [0 ... sizeof Ar] = true};</code> indexes out of <code>Ar[15]</code>.  Perhaps you meant <code>[0 ... COUNT_OF(Ar)-1]</code>?  2) <a href=\"https://stackoverflow.com/a/7803912/2410359\">Using Range in Designated Initializers</a> appears to be non-standard C."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535170964, "post_id": 51844165, "comment_id": 90978492, "body": "@chux: Ah, yes. Thanks for pointing that out :-)"}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1534266138, "last_edit_date": 1534266138, "creation_date": 1534258009, "answer_id": 51844165, "question_id": 51843226, "link": "https://stackoverflow.com/questions/51843226/change-elements-of-a-boolean-array-to-false-in-c/51844165#51844165", "title": "Change elements of a boolean array to false in C", "body": "<p>There are multiple issues:</p>\n\n<ol>\n<li><code>for (int i = 2; i &lt;= n; ++i)</code>: This will invoke undefined behaviour due to array out-of-bounds issue. It must be <code>for (int i = 1; i &lt; n; ++i)</code></li>\n<li><code>if (Ar[i] = (true))</code>, this will always evaluate as true, and will assign <code>Ar[i]</code> with <code>true</code>. Make a habit of using <code>if (true == Ar[i])</code> instead of <code>if (Ar[i] == (true))</code> so that compiler complains about an accidental usage of <code>=</code> in the <code>if</code> condition.</li>\n<li><code>bool Ar[15] = {true}</code> only initializes the first member of the array, there are multiple ways to initialize an array :-) Just browse over stackoverflow or scroll down.</li>\n</ol>\n\n<p>There is an improvement, use the following instead of your <code>main</code>:</p>\n\n<pre><code>#define COUNT_OF(_Array) (sizeof(_Array) / sizeof(_Array[0]))\n\nint main ()\n{\n    //int n = 15;\n    bool Ar[15] = { [0 ... COUNT_OF(Ar)-1] = true};\n    hope(COUNT_OF(Ar), Ar);\n\n    return 0;\n}\n</code></pre>\n\n<p>This will help you to change the array size as per your requirement, and get away without  needing the same change at a lot of place :-) Although, using it may not be exactly by the book. Note that they are not purely a gcc extension, but using ... is surely a gcc extension.</p>\n"}], "owner": {"reputation": 1, "user_id": 9788855, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fbEj_k7qNWA/AAAAAAAAAAI/AAAAAAAAAkg/YSJ8BXNlbAg/photo.jpg?sz=128", "display_name": "Emily Johnson", "link": "https://stackoverflow.com/users/9788855/emily-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1136, "favorite_count": 0, "closed_date": 1534263321, "answer_count": 4, "score": -3, "last_activity_date": 1534266138, "creation_date": 1534255025, "question_id": 51843226, "link": "https://stackoverflow.com/questions/51843226/change-elements-of-a-boolean-array-to-false-in-c", "closed_reason": "Not suitable for this site", "title": "Change elements of a boolean array to false in C", "body": "<p>I am working on a Project Euler challenge to find all the prime factors of a number. I am using a boolean array initialized as true, and then \"crossing off\" multiples by changing the bool value to false. (this is the Sieve of Eratosthenes) but I cannot figure out how to save an element as false. I can make it list the non-prime numbers (or \"false\" numbers), but then when I try to print out the primes or \"true\" numbers, it prints every number. If anyone could tell me what I'm doing wrong, I would appreciate it so much.</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;math.h&gt;\n\n\nvoid hope(int n, bool Ar[n])\n{\n    for (int i = 2; i &lt;= n; ++i)\n    {\n        if (Ar[i] = (true))\n        {\n            for (int j = i*i; j&lt;=n; j = i+j)\n            {\n                Ar[j] = false;\n            }\n        }\n    }\n    for (int i = 2; i &lt;= n; ++i)\n    {\n        if (Ar[i] = (true))\n        {\n            printf(\"\\ntrue value: %d\", i);\n        }\n    }\n\n}\nint main ()\n{\n    int n = 15;\n    bool Ar[15] = {true};\n    hope(n, Ar);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "strstr", "stm32f4", "sim800"], "comments": [{"owner": {"reputation": 4408, "user_id": 4916627, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ainvx.jpg?s=128&g=1", "display_name": "Andr&#233; Kool", "link": "https://stackoverflow.com/users/4916627/andr%c3%a9-kool"}, "edited": false, "score": 2, "creation_date": 1534257582, "post_id": 51842400, "comment_id": 90641329, "body": "Please don&#39;t repost <a href=\"https://stackoverflow.com/questions/51829039/uart-transmit-and-strstr-gives-wierd-outputs\">your question</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1534252670, "creation_date": 1534252670, "answer_id": 51842454, "question_id": 51842400, "link": "https://stackoverflow.com/questions/51842400/after-using-strstr-the-substring-also-transmitted-via-uart/51842454#51842454", "title": "After using strstr() the substring also transmitted via uart", "body": "<p>Your <code>\"hello\\r\\n\"</code> string was placed into some <em>read-only</em> area of your program. This is the same for your <code>hi</code> or <code>planets</code> strings. Compiler put these strings one after another in memory (or better to say, linker) and since you did not specify exact memory length of your string, you printed out if valid are. </p>\n\n<p>You were lucky that both strings were in memory one after another.</p>\n\n<p><code>h e l l o \\r \\n \\0 p l a n e t s</code>. </p>\n\n<p>Since you printed <code>10</code> characters, you printed <code>hello\\r\\n</code>, followed by <code>NULL termination</code> and then <code>pl</code>, together <code>10</code> characters.</p>\n\n<p>Lesson learned: Do not access to memory you are not allowed to. You were allowed to access only <code>strlen(\"hello\\r\\n\") + 1</code> bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": false, "score": 2, "last_activity_date": 1534252713, "creation_date": 1534252713, "answer_id": 51842471, "question_id": 51842400, "link": "https://stackoverflow.com/questions/51842400/after-using-strstr-the-substring-also-transmitted-via-uart/51842471#51842471", "title": "After using strstr() the substring also transmitted via uart", "body": "<p>On this line:</p>\n\n<pre><code>HAL_UART_Transmit_IT(&amp;huart2,(uint8_t*)\"hello\\r\\n\",10);\n</code></pre>\n\n<p>you are telling it to transmit 10 bytes. <code>\"hello\\r\\n\"</code> is only 7 bytes + NULL terminator, so it also sends the next thing in memory, in this case the first 2 bytes of that other string that you're using in <code>strstr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1534252723, "creation_date": 1534252723, "answer_id": 51842472, "question_id": 51842400, "link": "https://stackoverflow.com/questions/51842400/after-using-strstr-the-substring-also-transmitted-via-uart/51842472#51842472", "title": "After using strstr() the substring also transmitted via uart", "body": "<p>This has nothing to do with the <code>strstr</code> function. You are telling <code>HAL_UART_Transmit_IT</code> to go read beyond the end of the array (string literal) <code>\"hello\\r\\n\"</code>. What it will find there is anyone's guess, it's undefined behavior.</p>\n"}], "owner": {"reputation": 23, "user_id": 10170499, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B3YihJytLmk/AAAAAAAAAAI/AAAAAAAAA-A/Q2NUJl1DPGU/photo.jpg?sz=128", "display_name": "sourav maity", "link": "https://stackoverflow.com/users/10170499/sourav-maity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "closed_date": 1534257802, "answer_count": 3, "score": -4, "last_activity_date": 1534257397, "creation_date": 1534252515, "last_edit_date": 1534257397, "question_id": 51842400, "link": "https://stackoverflow.com/questions/51842400/after-using-strstr-the-substring-also-transmitted-via-uart", "closed_reason": "Needs details or clarity", "title": "After using strstr() the substring also transmitted via uart", "body": "<p>I was trying <code>UART</code> using <code>STM32F407V6T6</code> and <code>CubeMx</code>. </p>\n\n<p>As I have posted some problems with <code>strstr()</code> function. Here is some new problems.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>char rxBuff[10];\nint main(void)\n{\n  HAL_Init();\n  SystemClock_Config();\n  MX_GPIO_Init();\n  MX_USART2_UART_Init();\n  Green_Blink(100);\n  Orange_Blink(100);\n  Blue_Blink(100);\n  Red_Blink(100);\n  while (1)\n  {\n\n        HAL_UART_Transmit_IT(&amp;huart2,(uint8_t*)\"hello\\r\\n\",10);\n        HAL_Delay(1000);\n        Orange_Blink(100);\n        if (strstr(rxBuff,\"hi\"))\n        {\n\n        }\n   }\n}\n</code></pre>\n\n<p>Here what i am doing is I am transmitting <code>hello\\r\\n</code> using Transmit interrupt. After transmitting I am checking for certain values like <code>hi</code> in <code>rxBuff[10]</code>.</p>\n\n<p>In this particular code i am not receiving anything I just created the buffer and checking if it contains <code>hi</code> or not.</p>\n\n<p>Note that while transmitting I am just sending 7 bytes of data. But in <code>HAL_UART_Transmit_IT()</code> at place of size I am giving 10.</p>\n\n<p><code>HAL_UART_Transmit_IT(&amp;huart2,(uint8_t*)\"hello\\r\\n\",10);</code> </p>\n\n<p>After flashing this code to my stm32 I can see in terminal various output like</p>\n\n<blockquote>\n  <blockquote>\n    <p>hello\\r\\nhi</p>\n  </blockquote>\n</blockquote>\n\n<p>If I change the txt from <code>hi</code> to some other thing like planets, then the output will be like</p>\n\n<blockquote>\n  <blockquote>\n    <p>hello\\r\\npl</p>\n  </blockquote>\n</blockquote>\n\n<p>But when I give the perfect size like this </p>\n\n<p><code>HAL_UART_Transmit_IT(&amp;huart2,(uint8_t*)\"hello\\r\\n\",7);</code></p>\n\n<p>I get the actual output i should be getting</p>\n\n<blockquote>\n  <blockquote>\n    <p>hello\\r\\n</p>\n  </blockquote>\n</blockquote>\n\n<p>Transmitting the data via UART and finding if substring is present in some buffer is totally different tasks.</p>\n\n<p>Any suggestions why this is happening?</p>\n\n<p>P.S: Basically my project is with GSM MODULE SIM800c and STM32f407VGt6 \nI want to send various AT commands from the stm32 and check the response so that I can work accordingly.</p>\n\n<p>Previously I have tried this project with AVR series mcus where I could send sms,receive a particular sms,send data to server using post and get methods and everything worked completely fine. </p>\n\n<p>After moving to ARM I am not getting how STM32 is behaving.</p>\n"}, {"tags": ["c++", "c", "windows", "serial-port", "rs485"], "comments": [{"owner": {"reputation": 11, "user_id": 10221258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36be1495682fd876d29086d694f99100?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/10221258/joe"}, "reply_to_user": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1534252111, "post_id": 51841775, "comment_id": 90637468, "body": "Not the same question.. Reversed.. I am finding both signals are high when it says it isn&#39;t supposed to be"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1534252274, "post_id": 51841775, "comment_id": 90637575, "body": "@joe In the other question, you said that calling <code>SetCommBreak(handle)</code> does what you are saying that you&#39;re trying to do here."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1534259356, "post_id": 51841775, "comment_id": 90642520, "body": "RS232 doesn&#39;t even have TX+ and TX- pins. The problem here is that you&#39;re using RS422, but Windows offers an <i>abstraction</i> of a port. And in that abstraction, you send bits. You don&#39;t put ports in a high or a low state. For that sort of stuff you can use a Raspberry Pi with it&#39;s GPIO pins, those are literally General Purpose."}], "answers": [{"tags": [], "owner": {"reputation": 8071, "user_id": 5230735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97305d39e366bd0cf7e0e9bf5b19c179?s=128&d=identicon&r=PG&f=1", "display_name": "ralf htp", "link": "https://stackoverflow.com/users/5230735/ralf-htp"}, "is_accepted": false, "score": 1, "last_activity_date": 1534268317, "last_edit_date": 1534268317, "creation_date": 1534260692, "answer_id": 51844994, "question_id": 51841775, "link": "https://stackoverflow.com/questions/51841775/manipulating-rs-ports-with-the-windows-api/51844994#51844994", "title": "Manipulating RS ports with the Windows API", "body": "<p>You can not manipulate the RX and TX pins <em>arbitrarily and without limitations</em> *without writing your own RS485/RS422 protocol is <em>hardcoded</em> on the chip. The reason why you are limited in manipulating the pins when the windows serial driver is loaded ( automatically ) <em>is that the specification of a serial port ( what RS485 / RS 422 is ) requires a specific data structure, i.e. start bits, stop bits, signals like RTS ( ready-to-send ) , ...</em> this required data structure is implemented in the windows serial driver and you <strong>can not overwrite it</strong>. You can custom your data in a way that the required pin states are produced but your data will always be <em>enveloped</em> in the structure that is required by the serial protocol ( start / stop bits, ... ), cf this  graphic from <a href=\"https://en.wikipedia.org/wiki/RS-485\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/RS-485</a>  <a href=\"https://i.stack.imgur.com/JRgza.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JRgza.png\" alt=\"source : https://en.wikipedia.org/wiki/RS-485\"></a></p>\n\n<p>in windows you initialize a serial port in a DCB structure ( <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winbase/ns-winbase-_dcb\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/api/winbase/ns-winbase-_dcb</a> )</p>\n\n<p>within this serial port structures the several protocols that run on RS485 / RS422 are defined like MODBus, ...</p>\n\n<p>you can think of a RS-485/RS-422 serial port as a '<em>smart file</em>'. '<em>smart</em>' because of the multiple slaves / addresses that can be accessed. if you write a correct address to the file / serial bus you get an answer, i.e. if you write a 23 what means \"<em>Slave 23, send me your register values !</em>\"</p>\n\n<p>This overlying protocol is what has to be implemented in software. For this you do not need to manipulate single pins except possibly the control lines like RTS, ... and actually you can not do this without writing your own driver.</p>\n\n<p>An example how to implement MODBus protocol is in <a href=\"http://libmodbus.org/documentation/\" rel=\"nofollow noreferrer\">http://libmodbus.org/documentation/</a></p>\n\n<p>The following citation shows that the protocols that run over RS-485 are written over the serial port layer :</p>\n\n<blockquote>\n  <p>You cannot easily craft MODBUS messages \"by hand\", as you would have\n  done with ASCII protocols used on RS232: each MODBUS message ends with\n  a checksum code, computed from the full content of the message. To\n  exchange MODBUS messages, you must therefore use: </p>\n  \n  <p>either a specific program provided by the device vendor, with a compatible interface; </p>\n  \n  <p>or a simple RS485 interface with a programming library which encodes\n  and decodes MODBUS messages; </p>\n  \n  <p>or a smart RS485 interface able to\n  encode and decode by itself the MODBUS messages, such as the  Yocto-RS485. </p>\n</blockquote>\n\n<p>source : <a href=\"http://www.yoctopuce.com/EN/article/a-quick-tutorial-on-rs485-and-modbus\" rel=\"nofollow noreferrer\">http://www.yoctopuce.com/EN/article/a-quick-tutorial-on-rs485-and-modbus</a></p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/1751dafb-2fd5-48b8-8c16-08dd95d7db6d/writing-a-string-to-an-rs485-port-vs-2010-c?forum=vcgeneral\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/vstudio/en-US/1751dafb-2fd5-48b8-8c16-08dd95d7db6d/writing-a-string-to-an-rs485-port-vs-2010-c?forum=vcgeneral</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10221258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36be1495682fd876d29086d694f99100?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/10221258/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534268317, "creation_date": 1534250672, "question_id": 51841775, "link": "https://stackoverflow.com/questions/51841775/manipulating-rs-ports-with-the-windows-api", "title": "Manipulating RS ports with the Windows API", "body": "<p>I am trying to understand how to use the Windows API to communicate with RS232/RS422.\nI need to interface to some hardware where I don't really have control of the communication protocol, so I am forced to work with this.\nI need to set the TX + (pin 3) to high (~5 volts), and the TX - (pin 7) to low (~0 Volts).</p>\n\n<p>I know there is </p>\n\n<pre><code>SetCommBreak\n</code></pre>\n\n<p>But that puts both pins (3,7) to ~5 volts. I need only pin 3 to be 5 volts, and pin 7 to be ~ 0 volts. Is there a doable way to do this? I would love if I could just control these lines like wire, but is there a way to manipulate the baud rate and transmit data to achieve this? Or any sort of solution?</p>\n"}, {"tags": ["c", "timer", "sleep", "usleep"], "comments": [{"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 3, "creation_date": 1534249641, "post_id": 51841379, "comment_id": 90635821, "body": "Please post complete code example. It is not clear now how this code is supposed to behave."}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1534251608, "post_id": 51841379, "comment_id": 90637106, "body": "It is difficult to diagnose unless we see what <code>start_timer()</code> is doing. I suspect you are triggering a <code>SIGALRM</code> signal. Timers created with <code>setitimer(ITIMER_REAL, ...)</code> will generate such a signal on expiry. This would be sufficient to wake the thread / program from <code>sleep()</code>ing."}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 3713452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1102262592/picture?type=large", "display_name": "Furkan KESKIN", "link": "https://stackoverflow.com/users/3713452/furkan-keskin"}, "edited": false, "score": 0, "creation_date": 1534252521, "post_id": 51841851, "comment_id": 90637774, "body": "thank you for reply. I was trying some tests over my code and I realize something. If timer interval value is greater than the sleep value of superloop&#39;s, It is working. If the timer come in before, it supresses sleep or usleep comands. In other saying, it cancels sleep. I will update the code above."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 2, "last_activity_date": 1534250895, "creation_date": 1534250895, "answer_id": 51841851, "question_id": 51841379, "link": "https://stackoverflow.com/questions/51841379/c-after-timer-start-sleep-is-not-working/51841851#51841851", "title": "C after timer_start() sleep is not working", "body": "<p>You're not showing what standardized intefaces you're using to start the timer.</p>\n\n<p>Regardless, <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/usleep.html\" rel=\"nofollow noreferrer\">POSIX specifies</a> that the interaction of <code>usleep</code> with </p>\n\n<pre><code>nanosleep()\nsetitimer()\ntimer_create()\ntimer_delete()\ntimer_getoverrun()\ntimer_gettime()\ntimer_settime()\nualarm()\nsleep()\n</code></pre>\n\n<p>is unspecified.</p>\n\n<p><code>nanosleep</code> should not have that problem. </p>\n\n<p>From <a href=\"https://linux.die.net/man/2/nanosleep\" rel=\"nofollow noreferrer\">nanosleep's manpage</a>:</p>\n\n<blockquote>\n  <p>Compared to sleep(3) and usleep(3), nanosleep() has the following\n  advantages: it provides a higher resolution for specifying the sleep\n  interval; POSIX.1 explicitly specifies that it does not interact with\n  signals; and it makes the task of resuming a sleep that has been\n  interrupted by a signal handler easier.</p>\n</blockquote>\n\n<p>The above suggests that replacing your <code>usleep</code> with:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\nint my_usleep(useconds_t Usec);\n\n#include &lt;time.h&gt;\nint my_usleep(useconds_t Usec)\n{\n    return nanosleep(&amp;(const struct timespec){ \n      .tv_sec = Usec/100000, .tv_nsec=1000*Usec%1000000}, NULL);\n}\n</code></pre>\n\n<p>should fix the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "is_accepted": false, "score": 2, "last_activity_date": 1534255352, "creation_date": 1534255352, "answer_id": 51843334, "question_id": 51841379, "link": "https://stackoverflow.com/questions/51841379/c-after-timer-start-sleep-is-not-working/51843334#51843334", "title": "C after timer_start() sleep is not working", "body": "<p>It seems you are using a timer library similar to the one available at <a href=\"https://www.teuniz.net/Timer_code/\" rel=\"nofollow noreferrer\">https://www.teuniz.net/Timer_code/</a> . If you open <code>timer.c</code> in that library, you will see that it uses <code>setitimer(ITIMER_REAL, ...)</code>. A timer created in this way will generate a <code>SIGALRM</code> whenever the timer expires. This, in turn, will wake your program from <code>sleep()</code>ing.</p>\n\n<p>Why? Because, if you read the POSIX specification for <code>sleep()</code> (available at <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/009695399/</a> -> Alphabetical index -> <code>sleep()</code>), you will read.</p>\n\n<blockquote>\n  <p>The sleep() function shall cause the calling thread to be suspended from execution until either the number of realtime seconds specified by the argument seconds has elapsed <strong>or a signal is delivered to the calling thread</strong> and its action is to invoke a signal-catching function or to terminate the process.</p>\n</blockquote>\n\n<p>If, on the other hand, you are <em>not</em> using the afore-mentioned library, then you need to show exactly what your <code>start_timer()</code> function is doing. Otherwise, anyone who tries to help you is shooting in the dark.</p>\n\n<h3>Solution: threads</h3>\n\n<p>I think your only option is to use separate threads - one thread for the task that sleeps and another for the task that handles the timer.</p>\n"}], "owner": {"reputation": 178, "user_id": 3713452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1102262592/picture?type=large", "display_name": "Furkan KESKIN", "link": "https://stackoverflow.com/users/3713452/furkan-keskin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534255352, "creation_date": 1534249466, "last_edit_date": 1534252765, "question_id": 51841379, "link": "https://stackoverflow.com/questions/51841379/c-after-timer-start-sleep-is-not-working", "title": "C after timer_start() sleep is not working", "body": "<p>I am using eclipse IDE on ubuntu to compile my c project. I have a timer. After starting the timer, sleep or usleep functions are not working.\nHere is the code;</p>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>/*\n ============================================================================\n Name        : TimerTest.c\n Author      : FK\n Version     :\n Copyright   : Your copyright notice\n Description : Hello World in C, Ansi-style\n ============================================================================\n */\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;         /* , getenv() */\n#include &lt;getopt.h&gt;\n#include &lt;unistd.h&gt;         /* exec(), daemon() */\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;         /* memset(), strerror() */\n#include &lt;errno.h&gt;          /* errno */\n#include &lt;libgen.h&gt;         /* basename() */\n#include &lt;signal.h&gt;\n#include &lt;sys/timex.h&gt;      /* ntp_gettime() */\n#include &lt;time.h&gt;\n\n#include \"timer/timer.h\"\n\n#define CONFIG_TIMER_INTERVAL   100 /* in ms */\n/* global vars decalarations */\n\nstatic uint8_t _terminate = 0;\nstatic int _signo = 0;\n\nstatic int init_prg(int argc, char *argv[]);\nstatic void timer_callback(void);\n\n/* function implementations */\nstatic void sig_handler(int signo)\n{\n    /* http://www.yolinux.com/TUTORIALS/C++Signals.html */\n    _signo = signo;\n    switch (signo)\n    {\n        case SIGINT: /* Program interrupt. (ctrl-c) */\n\n            _terminate = 1;\n            break;\n        case SIGTERM:\n\n            _terminate = 1;\n            break;\n            /* SIGKILL, SIGSTOP yakalan\u0131m\u0131yor! */\n        default:\n\n            break;\n    }\n\n}\n\nint main(int argc, char *argv[])\n{\n    init_prg(argc, argv);\n    /* start super loop */\n    while (1)\n    {\n        printf(\"test!\\n\");\n        //usleep(1000000);\n        sleep(1);\n\n    }\n}\n\nstatic int init_prg(int argc, char *argv[])\n{\n    int res = -1;\n\n    if (signal(SIGINT, sig_handler) == SIG_ERR)\n    {\n        //exit(EXIT_FAILURE);\n    }\n\n    /* Termination, Generated by \"kill\" command. */\n    if (signal(SIGTERM, sig_handler) == SIG_ERR)\n    {\n        //exit(EXIT_FAILURE);\n    }\n\n\n\n    start_timer(2000, &amp;timer_callback);\n\n    if (res != 0)\n    {\n        //exit(EXIT_FAILURE);\n    }\n\n    return res;\n}\n\nstatic void timer_callback(void)\n{\n    printf(\"timer works!\\n\");\n}\n</code></pre>\n\n<p>after execute program, it echoes \"test!\" rapidly. Ignoring sleep or usleep commands. if I comment out start_timer line, it sleeps, after timer it is not.Any ideas?</p>\n"}, {"tags": ["c", "pointers", "type-conversion", "stm32"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1534248995, "post_id": 51841142, "comment_id": 90635432, "body": "<i>&quot;I am getting pe513 error.&quot;</i> That&#39;s too cryptic for anyone to remember what it means. Please <a href=\"https://stackoverflow.com/posts/51841142/edit\">edit</a> and add <b>complete</b> error message to your question."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 8, "creation_date": 1534249067, "post_id": 51841142, "comment_id": 90635480, "body": "<code>TestStruct_ptr = (float*)&amp;TestStruct;</code> That <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">violates strict aliasing</a> and is undefined behavior.  <code>TestStruct</code> is not a <code>float</code> and can&#39;t be addressed as one."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1534249715, "post_id": 51841142, "comment_id": 90635856, "body": "I&#39;m not clear.  Are you trying to convert 4 <code>int</code> to 4 <code>float</code>, 4 <code>int</code> to single <code>float</code>, or convert the entire <code>struct</code> contents to a single <code>float</code> value?"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1534249776, "post_id": 51841142, "comment_id": 90635886, "body": "why don&#39;t you use float type instead of changing the data type from int to float?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1534249904, "post_id": 51841142, "comment_id": 90635967, "body": "If your STM32 is operating in little-endian mode, you have the four bytes the wrong way round for a value of 23.10. Also, <code>&amp;TestStruct</code> might not be correctly aligned for a <code>float *</code>. Why do you declare <code>TestStruct_ptr</code> as a <code>uint8_t *</code> and then do <code>TestStruct_ptr = (float*)&amp;TestStruct;</code>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534250267, "post_id": 51841142, "comment_id": 90636203, "body": "If the EEPROM has no declared types - that is, the compiler doesn&#39;t know that there are any variables there, you can simply do <code>*(float*)address</code>. Otherwise, if you read the data into a temporary <code>uint8_t</code> buffer, you get the mentioned aliasing problems and you&#39;ll need to use a union or similar to dodge that problem."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534253461, "post_id": 51841142, "comment_id": 90638430, "body": "@Lundin Assuming <code>address</code> is correctly aligned of course!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1534253620, "post_id": 51841142, "comment_id": 90638542, "body": "@IanAbbott Why? There&#39;s plenty of CPUs without alignment requirments. Though of course those tend to be smaller 8 and 16 bitters without FPU."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534261400, "post_id": 51841142, "comment_id": 90643734, "body": "@Lundin I didn&#39;t mention <i>how</i> it should be aligned, only that it be <i>correctly</i> aligned. Here, &quot;correctly&quot; depends on the CPU/system as you say."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1534262400, "post_id": 51841142, "comment_id": 90644298, "body": "Further to what I wrote about little-endian mode a few posts up, it seems that the STM32 CPU always operates in little-endian mode as far as memory access by the CPU is concerned, so you do have the bytes the wrong way round. (Some of the peripheral components may have different or programmable endianness.)"}, {"owner": {"reputation": 67, "user_id": 5269130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4360a1c16c3e11b6ae25043eb03ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter1", "link": "https://stackoverflow.com/users/5269130/peter1"}, "edited": false, "score": 0, "creation_date": 1534271742, "post_id": 51841142, "comment_id": 90648950, "body": "Yes, address should be correct, I try to use the pointer to the 4 bytes. As I wrote Endianess is not important right now, but as it will be saved to mem in the same order I am not sure it will not be correct, but not crucial now."}], "answers": [{"comments": [{"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1534250266, "post_id": 51841369, "comment_id": 90636202, "body": "The 4 Bytes interpreted as a float value."}], "tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": true, "score": 5, "last_activity_date": 1534249432, "creation_date": 1534249432, "answer_id": 51841369, "question_id": 51841142, "link": "https://stackoverflow.com/questions/51841142/converting-a-struct-of-4-integers-to-a-float/51841369#51841369", "title": "Converting a struct of 4 integers to a float", "body": "<p>You could use a union:</p>\n\n<pre><code>typedef union\n{\n    struct\n    {\n        uint8_t Byte1;\n        uint8_t Byte2;\n        uint8_t Byte3;\n        uint8_t Byte4;\n     };\n     float      floatvalue;\n}TestT;\n\nTestT   Test;\n\nTest.floatvalue = ......    //complete float\nTest.Byte1 = .....          //single Byte to save in EEPROM\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534250052, "post_id": 51841490, "comment_id": 90636057, "body": "I suggest <code>memcpy(&amp;x, &amp;TestStruct, sizeof x);</code>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534250174, "post_id": 51841490, "comment_id": 90636127, "body": "@P__J__ Yeah <code>sizeof x</code> is better. I don&#39;t think <code>sizeof float</code> would have even compiled (should have been <code>sizeof(float)</code>)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1534255055, "post_id": 51841490, "comment_id": 90639478, "body": "@user694733 Both <code>sizeof float</code> and <code>sizeof(float)</code> are correct. See <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.3.4\" rel=\"nofollow noreferrer\"><b>6.5.3 Unary operators</b></a> and <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.3.4\" rel=\"nofollow noreferrer\"><b>6.5.3.4 The sizeof and _Alignof operators</b></a>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1534263178, "post_id": 51841490, "comment_id": 90644685, "body": "@AndrewHenle No, <code>sizeof type-name</code> does not satisfy the syntax for <code>unary-expression</code> in 6.5.3."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1534263596, "post_id": 51841490, "comment_id": 90644883, "body": "@IanAbbott I missed that context here.  And <b>that</b> is why I always use <code>()</code> with <code>sizeof</code>."}, {"owner": {"reputation": 67, "user_id": 5269130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4360a1c16c3e11b6ae25043eb03ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter1", "link": "https://stackoverflow.com/users/5269130/peter1"}, "edited": false, "score": 0, "creation_date": 1534271255, "post_id": 51841490, "comment_id": 90648735, "body": "I will try memcpy when I get to work in about 10 hours."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 4, "last_activity_date": 1534312703, "last_edit_date": 1534312703, "creation_date": 1534249846, "answer_id": 51841490, "question_id": 51841142, "link": "https://stackoverflow.com/questions/51841142/converting-a-struct-of-4-integers-to-a-float/51841490#51841490", "title": "Converting a struct of 4 integers to a float", "body": "<p>Since you don't care about the portability or endianness issues, you could simply copy the bytes with <code>memcpy</code>:</p>\n\n<pre><code>memcpy(&amp;x, &amp;TestStruct, sizeof x);\n</code></pre>\n\n<p>You may have seen this option or similar somewhere:</p>\n\n<pre><code>x = *(float*)&amp;TestStruct;  // BAD!!!!! dereferencing using wrong pointer type\n</code></pre>\n\n<p><strong>Don't do this!</strong> It breaks strict aliasing rules which is <em>undefined behaviour</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 5269130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4360a1c16c3e11b6ae25043eb03ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter1", "link": "https://stackoverflow.com/users/5269130/peter1"}, "edited": false, "score": 0, "creation_date": 1534271079, "post_id": 51841528, "comment_id": 90648667, "body": "I am not sure this would solve my issue, the &quot;Input&quot; format is 4 uint8 bytes stored in an array, like the struct I made."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 67, "user_id": 5269130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4360a1c16c3e11b6ae25043eb03ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter1", "link": "https://stackoverflow.com/users/5269130/peter1"}, "edited": false, "score": 1, "creation_date": 1534272254, "post_id": 51841528, "comment_id": 90649188, "body": "@Peter1 do you know the C at all ? Or you copy the code from somewhere - which is IMO after that comment more probable"}, {"owner": {"reputation": 67, "user_id": 5269130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4360a1c16c3e11b6ae25043eb03ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter1", "link": "https://stackoverflow.com/users/5269130/peter1"}, "edited": false, "score": 0, "creation_date": 1534308792, "post_id": 51841528, "comment_id": 90658776, "body": "It should not be such a big surprise as my question starts with &quot;I am new to programming and I am not strong in pointers&quot;. Yes I did a long search first and tried (with my missing skills as you kindly point out) the solutions I found as good as I could."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 7, "last_activity_date": 1534251501, "last_edit_date": 1534251501, "creation_date": 1534249984, "answer_id": 51841528, "question_id": 51841142, "link": "https://stackoverflow.com/questions/51841142/converting-a-struct-of-4-integers-to-a-float/51841528#51841528", "title": "Converting a struct of 4 integers to a float", "body": "<p>Union punning will do.</p>\n\n<pre><code>typedef union\n{\n    uint32_t u32;\n    uint16_t u16[2];\n    uint8_t  u8[4];\n    float    f;\n}b32data;\n</code></pre>\n\n<p>when you read from the NV memory just assign the correct member without any pointers.</p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534262229, "post_id": 51845239, "comment_id": 90644212, "body": "It violates the strict aliasing rules and should be avoided"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1534262808, "post_id": 51845239, "comment_id": 90644493, "body": "@P__J__ the <code>char</code> types are an exception to the aliasing rules.  See C11 standard section 6.5 paragraph 7.  <i>An object shall have its stored value accessed only by an lvalue expression that has one of the following types: [...]  --a character type</i>"}, {"owner": {"reputation": 67, "user_id": 5269130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4360a1c16c3e11b6ae25043eb03ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter1", "link": "https://stackoverflow.com/users/5269130/peter1"}, "edited": false, "score": 1, "creation_date": 1534271506, "post_id": 51845239, "comment_id": 90648837, "body": "Sorry, I do not understand how this solves the problem."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1534272322, "post_id": 51845239, "comment_id": 90649204, "body": "<code>pe513</code> seems to be an error IAR spits out related to breaking strict aliasing from the brief search I did on it.  Because character types <i>are</i> allowed to alias other types (but not the other way around), this should not cause a strict aliasing error if the IAR compiler conforms to the C standard.  The other answers regarding using <code>union</code>s should also get around this issue."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1534261509, "creation_date": 1534261509, "answer_id": 51845239, "question_id": 51841142, "link": "https://stackoverflow.com/questions/51841142/converting-a-struct-of-4-integers-to-a-float/51845239#51845239", "title": "Converting a struct of 4 integers to a float", "body": "<p>It is illegal to type pun in this manner.  As others have mentioned, unions can be used for doing type punning.  Alternatively, as the intention seems to be to have a float that is byte-accessible, it is legal to type-pun <em>to</em> the <code>char</code> types.  So instead of declaring the type of your variable as a struct of 4 <code>char</code>s, you could instead declare it as a <code>float</code> and then type-pun to <code>unsigned char</code> and access it as an array:</p>\n\n<pre><code>float x = 0.0;\n\nunsigned char *test_ptr = (unsigned char *)&amp;x;\n\nint main(void)\n{\n    /* USER CODE BEGIN 1 */\n    test_ptr[0] = 0x41; //float value = 23.10\n    test_ptr[1] = 0xB8;\n    test_ptr[2] = 0xCC;\n    test_ptr[3] = 0xCD;  \n\n    // some code\n\n    return 0;\n}\n</code></pre>\n\n<p>Of course the order of the bytes will be endian-dependent.  I kept your byte-ordering, which should be correct for a big-endian target.</p>\n"}], "owner": {"reputation": 67, "user_id": 5269130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4360a1c16c3e11b6ae25043eb03ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter1", "link": "https://stackoverflow.com/users/5269130/peter1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 51841369, "answer_count": 4, "score": 1, "last_activity_date": 1561446636, "creation_date": 1534248723, "last_edit_date": 1561446636, "question_id": 51841142, "link": "https://stackoverflow.com/questions/51841142/converting-a-struct-of-4-integers-to-a-float", "title": "Converting a struct of 4 integers to a float", "body": "<p>I am new to programming and I am not strong in pointers and typecasting, so I need some help.</p>\n\n<p>I am using IAR Workbench and STM32L475.\nI am trying to convert 4 bytes in a struct to a float, after loading them from an Eeprom.</p>\n\n<p>I know there can be challenges with Big/Little Endian and portability of code to other micro's but please do not clutter this thread with that as this is not important for me right now.</p>\n\n<p>What am I doing wrong, thanks for helping?</p>\n\n<p>Please keep it simple and explain \"for dummies\".</p>\n\n<p>I am getting pe513 error.</p>\n\n<p>My code:</p>\n\n<pre><code>struct Test {\n    uint8_t Byte1;\n    uint8_t Byte2;\n    uint8_t Byte3;\n    uint8_t Byte4;\n} TestStruct;\n\nfloat x = 0.0;\n\nuint8_t *TestStruct_ptr;\n\nint main(void)\n{\n    /* USER CODE BEGIN 1 */\n    TestStruct.Byte1 = 0x41; //float value = 23.10\n    TestStruct.Byte2 = 0xB8;\n    TestStruct.Byte3 = 0xCC;\n    TestStruct.Byte4 = 0xCD;  \n\n    TestStruct_ptr = (float*)&amp;TestStruct;\n\n    x = (float*) TestStruct_ptr;\n\n    // some code\n\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Edit:\nI am loading an array from an Eeprom and must \"collect\" an array of four uint8 bytes to a float, they were a part of a struct before they were saved to the Eeprom.\nI will update with the exact error message when I get to work tomorrow.</p>\n\n<p>I ended up using \"union\" as this seems to be the best solution.</p>\n\n<p>My sample code looks like this now:</p>\n\n<pre><code>union Eeprom {\n  struct {\n    uint8_t Byte1;\n    uint8_t Byte2;\n    uint8_t Byte3;\n    uint8_t Byte4;\n  };\n  float x;\n  uint8_t Array[4];\n};\n\n\nint main(void)\n{\n\n  union Eeprom Test;\n\n  //assign values to individual bytes\n  Test.Byte1=0xCD; \n  Test.Byte2=0xCC;\n  Test.Byte3=0xB8;\n  Test.Byte4=0x41;\n\n  //Assign values as an array (here individual bytes, overwrites above assigned values).\n  //Data will be formatted as an array when loaded from E2prom.\n  Test.Array[0]=0xCD;  \n  Test.Array[1]=0xCC;\n  Test.Array[2]=0xB8;\n  Test.Array[3]=0x41;\n\n  //Assign value as floating point value (overwrites the above assigned values)\n  Test.x = 23.1;  \n\n  printf(\"FPvalue %3.2f \\n Byte1 %x\\n Byte2 %x\\n Byte3 %x\\n Byte4 %x\\n \n    Array[0] %x\\n Array[1] %x\\n Array[2] %x\\n Array[3] %x\\n\",\n    Test.x, Test.Byte1, Test.Byte2, Test.Byte3, Test.Byte4, \n    Test.Array[0], Test.Array[1], Test.Array[2], Test.Array[3]);\n}\n</code></pre>\n\n<p>And the output looks like this:</p>\n\n<pre><code>floatvalue 23.10 \nByte1 cd\nByte2 cc\nByte3 b8\nByte4 41\nArray[0] cd\nArray[1] cc\nArray[2] b8\nArray[3] 41\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1534248978, "post_id": 51841051, "comment_id": 90635423, "body": "C language is giving the programmer almost the full freedom, even if something is against the rules of the language (like writing outside the array bounds). You can, but the language itself does not guarantee what will happen with the program. It is called Undefined Bahavior which may be a great but dangerous tool in some circumstances or the curse in other (actually 99.99% of the cases or 100% for beginner programmers)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1534256675, "post_id": 51841051, "comment_id": 90640665, "body": "Every night at 3am I walk from my house to the all-night diner across the street.  There&#39;s a Walk / Don&#39;t Walk sign at the intersection, but there&#39;s never any traffic, and I got tired of waiting, so I started crossing even though the sign says Don&#39;t Walk.  Nothing bad ever happens.  What&#39;s the point of having the Walk / Don&#39;t Walk sign if I can cross whenever I like?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534258691, "post_id": 51841051, "comment_id": 90642083, "body": "Please use the linked canonical duplicate for FAQ questions like this. I think this was the 3rd &quot;why can I access the array out of bounds&quot; question today alone."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1534248757, "creation_date": 1534248757, "answer_id": 51841153, "question_id": 51841051, "link": "https://stackoverflow.com/questions/51841051/why-can-we-insert-more-elements-in-an-array-than-what-it-can-hold/51841153#51841153", "title": "Why can we insert more elements in an array than what it can hold", "body": "<p>The C language has the concept of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  It means the language doesn't prevent you from doing things you aren't supposed to do, but if you do there's no guarantee what the program will do afterwards.  </p>\n\n<p>It may crash, it may output strange results, or it may appear to work normally.  How undefined behavior manifests itself can change if you make a seemingly unrelated code change, such as adding an unused local variable, adding a <code>printf</code> call for debugging purposes, or compiling with different optimizations settings.</p>\n\n<p>In this case, you got \"lucky\" that nothing bad seemed to happen.  Someone else running the same program may get different output from you because you wrote past the end of the array. </p>\n\n<p>When I ran this code I got the following output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter number  of elements which you want to append :6\n\nEnter the values :1\n2\n3\n4\n5\n6\n7\n*** stack smashing detected ***: ./x1 terminated\n1   2   3   4   5   6   7   Aborted (core dumped)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1534252283, "post_id": 51841221, "comment_id": 90637583, "body": "This is not OP is asking."}, {"owner": {"reputation": 59, "user_id": 8035876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377f144eac47be15bf90e420bade993d?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek Wo\u017aniak", "link": "https://stackoverflow.com/users/8035876/bartek-wo%c5%baniak"}, "reply_to_user": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1534253054, "post_id": 51841221, "comment_id": 90638123, "body": "So, in your opinion... What OP is exactly asking ? I have answered like the others - it is UB."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1534253306, "post_id": 51841221, "comment_id": 90638309, "body": "It clearly states, <i>&quot;If that&#39;s the case, then why even declare a size for the array?&quot;</i>, and now read your answer."}, {"owner": {"reputation": 59, "user_id": 8035876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377f144eac47be15bf90e420bade993d?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek Wo\u017aniak", "link": "https://stackoverflow.com/users/8035876/bartek-wo%c5%baniak"}, "reply_to_user": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1534253448, "post_id": 51841221, "comment_id": 90638415, "body": "Ok, main post have been edited - now with the proper question. I will not repeat more detailed answers that have been already posted."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1534256297, "post_id": 51841221, "comment_id": 90640365, "body": "To be fair with you, I have made a negligible edit in your answer so that I can retract down-vote. It isn&#39;t your fault anymore."}], "tags": [], "owner": {"reputation": 59, "user_id": 8035876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377f144eac47be15bf90e420bade993d?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek Wo\u017aniak", "link": "https://stackoverflow.com/users/8035876/bartek-wo%c5%baniak"}, "is_accepted": false, "score": 1, "last_activity_date": 1534256237, "last_edit_date": 1534256237, "creation_date": 1534248966, "answer_id": 51841221, "question_id": 51841051, "link": "https://stackoverflow.com/questions/51841051/why-can-we-insert-more-elements-in-an-array-than-what-it-can-hold/51841221#51841221", "title": "Why can we insert more elements in an array than what it can hold", "body": "<p>This code results in undefined behaviour because, there is an attempt to access elements outside of array. There are two options to overcome this issue: </p>\n\n<ol>\n<li><code>block[X]</code> - X should be defined with fixed size. Value provided by user should be compared with X - then You are sure, You are not jump outside of array size.</li>\n<li><code>block[X]</code> - array is created dynamically with X provided by user (check malloc() function)</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "is_accepted": false, "score": 0, "last_activity_date": 1534249086, "creation_date": 1534249086, "answer_id": 51841266, "question_id": 51841051, "link": "https://stackoverflow.com/questions/51841051/why-can-we-insert-more-elements-in-an-array-than-what-it-can-hold/51841266#51841266", "title": "Why can we insert more elements in an array than what it can hold", "body": "<p>In C arrays don't have boundary check. You have array of int it's width is 5. It doesn't stop at only five elements if you add more than five elements to the array that is undefined behaviour.</p>\n\n<p>It's user responsibility to make sure array boundaries doesn't exceed than allocated.</p>\n"}], "owner": {"reputation": 31, "user_id": 9045475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b292612cdaf0cad81b02b335f7bd679?s=128&d=identicon&r=PG&f=1", "display_name": "Maaz Shaikh", "link": "https://stackoverflow.com/users/9045475/maaz-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "closed_date": 1534258638, "answer_count": 3, "score": -3, "last_activity_date": 1534256237, "creation_date": 1534248453, "last_edit_date": 1534252964, "question_id": 51841051, "link": "https://stackoverflow.com/questions/51841051/why-can-we-insert-more-elements-in-an-array-than-what-it-can-hold", "closed_reason": "Duplicate", "title": "Why can we insert more elements in an array than what it can hold", "body": "<p>In the code below, I insert 6 elements in the array.  The array size however is 5 and the for loop runs 7 times.  The code then inserts and print the 7 elements.</p>\n\n<p>It seems it doesn't matter what the size of the array is since I can apparently insert and print more elements.  If that's the case, then why even declare a size for the array?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\n\nint main()\n {\n   int index, block[5], number;\n\n   printf(\"\\nEnter number  of elements which you want to append :\");\n   scanf(\"%d\", &amp;number);\n   printf(\"\\nEnter the values :\");\n   for (index = 0; index &lt;= number; index++)\n   {\n       scanf(\"%d\", &amp;block[index]);\n   }\n   for (index = 0; index &lt;= number; index++)\n   {\n       printf(\"%d\\t\", block[index]);\n   }\n   return (0);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Enter the values :1\n2\n3\n4\n5\n6\n7\n1   2   3   4   5   6   7\n</code></pre>\n"}, {"tags": ["c", "xilinx"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1534252508, "post_id": 51841028, "comment_id": 90637762, "body": "You can&#39;t simply use bare-metal code in a hosted environment. You need to rewrite anything that uses privileged features. Disabling interrupts will cause a lot of issues for Linux, so you&#39;re not allowed to do that from a user application."}, {"owner": {"reputation": 9, "user_id": 10224402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wLHx2dcalCI/AAAAAAAAAAI/AAAAAAAAEI8/g3bEo6OYvJQ/photo.jpg?sz=128", "display_name": "Akanksha Singh", "link": "https://stackoverflow.com/users/10224402/akanksha-singh"}, "edited": false, "score": 0, "creation_date": 1534253249, "post_id": 51841028, "comment_id": 90638267, "body": "Disabling interrupt does cause errors."}, {"owner": {"reputation": 9, "user_id": 10224402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wLHx2dcalCI/AAAAAAAAAAI/AAAAAAAAEI8/g3bEo6OYvJQ/photo.jpg?sz=128", "display_name": "Akanksha Singh", "link": "https://stackoverflow.com/users/10224402/akanksha-singh"}, "edited": false, "score": 0, "creation_date": 1534253286, "post_id": 51841028, "comment_id": 90638298, "body": "How do I chnage this below line in c, could you please help."}, {"owner": {"reputation": 9, "user_id": 10224402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wLHx2dcalCI/AAAAAAAAAAI/AAAAAAAAEI8/g3bEo6OYvJQ/photo.jpg?sz=128", "display_name": "Akanksha Singh", "link": "https://stackoverflow.com/users/10224402/akanksha-singh"}, "edited": false, "score": 0, "creation_date": 1534253376, "post_id": 51841028, "comment_id": 90638362, "body": "#define mtcpsr(v)\t<b>asm</b> __volatile__(\\ \t\t\t  &quot;msr\tcpsr,%0\\n&quot;\\ \t\t\t  : : &quot;r&quot; (v)\\ \t\t\t)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1534295304, "post_id": 51841028, "comment_id": 90656143, "body": "when asking a question about a run time problem.  As this question is doing, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can help you.  As it is, the posted string of macros isn&#39;t even a function."}], "owner": {"reputation": 9, "user_id": 10224402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wLHx2dcalCI/AAAAAAAAAAI/AAAAAAAAEI8/g3bEo6OYvJQ/photo.jpg?sz=128", "display_name": "Akanksha Singh", "link": "https://stackoverflow.com/users/10224402/akanksha-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534248362, "creation_date": 1534248362, "question_id": 51841028, "link": "https://stackoverflow.com/questions/51841028/changing-standalone-function-to-linux-application", "title": "changing standalone function to linux application", "body": "<p>I cannot run the below given code when I am not in standalone environment. How do I change the function to be used independent of standalnone environment.</p>\n\n<p>==================================================</p>\n\n<pre><code>Xil_ExceptionEnable();\n\n#define Xil_ExceptionEnable() \\\n        Xil_ExceptionEnableMask(XIL_EXCEPTION_IRQ)\n\n#define Xil_ExceptionEnableMask(Mask)   \\\n{                               \\\n    register u32 Reg __asm(\"cpsr\"); \\\n    mtcpsr((Reg) &amp; (~((Mask) &amp; XIL_EXCEPTION_ALL))); \\\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1534247903, "post_id": 51840835, "comment_id": 90634722, "body": "What do you think happens when the loop reaches the terminator of <code>s2</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 12703, "user_id": 584597, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d519ba6b69a89cc8ec99001eea2059b?s=128&d=identicon&r=PG", "display_name": "payne", "link": "https://stackoverflow.com/users/584597/payne"}, "is_accepted": false, "score": 1, "last_activity_date": 1534248021, "last_edit_date": 1534248021, "creation_date": 1534247874, "answer_id": 51840885, "question_id": 51840835, "link": "https://stackoverflow.com/questions/51840835/confusion-about-whiles1-s2-in-c/51840885#51840885", "title": "Confusion about &quot;while(*s1++ = *s2++);&quot; in C", "body": "<p>You have a semicolon after the while() statement, so it's equivalent to:</p>\n\n<pre><code>while(*s1++ = *s2++) {\n    /* Empty loop */\n}\nprintf(\"%s\\n\",str1);\n</code></pre>\n\n<p>So you're just copying s2 into s1, and then printing.  The copying operation <em>includes</em> the zero termination of the string, so you are copying:  'p', 'u', 'n', 'e', '\\0' on each iteration.</p>\n\n<p>Note that the assignment inside the <code>while</code> expression happens <em>before</em> while() statement is terminated.  If you're expecting \"puneay\", try this loop, which tests for zero termination before assignment:</p>\n\n<pre><code>while(*s1)\n   *s1++ = *s2++;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 398, "user_id": 6269159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3FIh8.png?s=128&g=1", "display_name": "Mat&#250;\u0161 Bako", "link": "https://stackoverflow.com/users/6269159/mat%c3%ba%c5%a1-bako"}, "is_accepted": true, "score": 12, "last_activity_date": 1534251957, "last_edit_date": 1534251957, "creation_date": 1534247980, "answer_id": 51840920, "question_id": 51840835, "link": "https://stackoverflow.com/questions/51840835/confusion-about-whiles1-s2-in-c/51840920#51840920", "title": "Confusion about &quot;while(*s1++ = *s2++);&quot; in C", "body": "<p>There is a null terminator at the end of the string which is also copied.</p>\n\n<p>When null terminator is copied, while stops executing, and result is printed.</p>\n\n<p>So memory at <code>str1</code> actually contains: <code>'p' 'u' 'n' 'e' '\\0' 'y' '\\0'</code></p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1534248575, "creation_date": 1534248575, "answer_id": 51841084, "question_id": 51840835, "link": "https://stackoverflow.com/questions/51840835/confusion-about-whiles1-s2-in-c/51841084#51841084", "title": "Confusion about &quot;while(*s1++ = *s2++);&quot; in C", "body": "<p><code>while(*s++ = *s1++)</code> copies also the string terminator `\\0' as the assign operation is executed before the actual logical check.</p>\n"}, {"tags": [], "owner": {"reputation": 247, "user_id": 10167999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767029060001569/picture?type=large", "display_name": "F&#225;bio Morais", "link": "https://stackoverflow.com/users/10167999/f%c3%a1bio-morais"}, "is_accepted": false, "score": 0, "last_activity_date": 1534249207, "creation_date": 1534249207, "answer_id": 51841305, "question_id": 51840835, "link": "https://stackoverflow.com/questions/51840835/confusion-about-whiles1-s2-in-c/51841305#51841305", "title": "Confusion about &quot;while(*s1++ = *s2++);&quot; in C", "body": "<p>You can fix that by using this code:</p>\n\n<pre><code>while(*s2)\n    *s1++ = *s2++ ;\n\nprintf(\"%s\\n\",str1);\n</code></pre>\n\n<p>Because (*s2) have the '\\0' in the end of the string</p>\n"}, {"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1534251429, "post_id": 51841829, "comment_id": 90636982, "body": "I wouldn&#39;t call it sloppy, obscure, or anything else but terse. Admittedly using semicolon alone as empty statement without indentation is inadvisable. Anyway, the verbose equivalent you gave is right."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1534252329, "post_id": 51841829, "comment_id": 90637623, "body": "@Deduplicator Using either <code>++</code> or <code>=</code> together with other operators in the same expression is always sloppy, as both of those operators come with side-effects. Here we get both at once. Assignment inside conditions is widely recognized as bad practice since the early 1980s (see &quot;Yoda conditions&quot;). If <code>s1</code> and <code>s2</code> points at the same memory location, we get all kinds of bugs. If someone modifies the expression into lets say <code>while(*s1++ = do_something(*s2) + *s2++);</code> we get all kinds of bugs. Plus of course, the code is hard to read for anyone who isn&#39;t a member of the Obfuscated C Club."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1534263692, "post_id": 51841829, "comment_id": 90644931, "body": "Yoda conditions are an abomination, and a higher warning-level takes care of them. Yes, that needs additional parentheses to inform the compiler that things are fine. Pushing all kinds of additional things in there to make a point is disingenious. And what kind of bugs are there if they point to the same location? The target starting somewhere in the source (but not at the start) would obviously be a problem, but that&#39;s nothing to do with the specific code used."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1534316120, "post_id": 51841829, "comment_id": 90660780, "body": "@Deduplicator Indeed Yoda conditions were an abomination, as you say the correct way to deal with them is compiler warnings. Which in turn means that you can no longer purposely write assignment inside conditions! Because then you can no longer rely on that warning. Conclusion: one of the reasons why the posted code is sloppy, is because it has assignment inside a condition. Adding an additional parenthesis is nonsense, that&#39;s a really dirty patch which only works on one particular compiler, with no support whatsoever by the standard."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1534325840, "post_id": 51841829, "comment_id": 90664757, "body": "Suppressing a QOI-warning is not an issue for the standard at all. And on which compilers giving the warning doesn&#39;t that hint work?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1534325924, "post_id": 51841829, "comment_id": 90664804, "body": "@Deduplicator As far as I know it only works on gcc. The standard does of course not mention any diagnostics at all, since assignment in conditions is allowed."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1534326310, "post_id": 51841829, "comment_id": 90665001, "body": "Coliru says clang does it too: <a href=\"http://coliru.stacked-crooked.com/a/eb982d54da89c9cb\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/eb982d54da89c9cb</a> Cannot test msvc or icc just now. Anyway, I would call the warning on any compiler not supporting that hint for suppression defective."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1534250849, "creation_date": 1534250849, "answer_id": 51841829, "question_id": 51840835, "link": "https://stackoverflow.com/questions/51840835/confusion-about-whiles1-s2-in-c/51841829#51841829", "title": "Confusion about &quot;while(*s1++ = *s2++);&quot; in C", "body": "<p>This kind of sloppy code is unfortunately fairly common, when someone wants to copy strings in C using pointer arithmetic. The code is 100% equivalent to this:</p>\n\n<pre><code>*s1 = *s2;\nwhile(*s1 != '\\0')\n{\n  s1++;\n  s2++;\n  *s1 = *s2;\n}\n</code></pre>\n\n<p>The purpose is to give a \"poor man's <code>strcpy</code>\". The null terminator is always copied into the destination buffer, which is why you get the output described.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 1, "accepted_answer_id": 51840920, "answer_count": 5, "score": 1, "last_activity_date": 1534251957, "creation_date": 1534247722, "last_edit_date": 1534248277, "question_id": 51840835, "link": "https://stackoverflow.com/questions/51840835/confusion-about-whiles1-s2-in-c", "title": "Confusion about &quot;while(*s1++ = *s2++);&quot; in C", "body": "<p><strong>Code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char str1[]=\"bombay\";\n    char str2[]=\"pune\";\n\n    char *s1 = str1;\n    char *s2 = str2;\n\n    while(*s1++ = *s2++);\n    printf(\"%s\\n\",str1);\n}\n</code></pre>\n\n<p><strong>Output:(GCC Compiler)</strong></p>\n\n<pre><code>pune\n</code></pre>\n\n<p>But according to me output should be <code>puneay</code>. <code>pune</code> should be copied in place of <code>bomb</code> and rest should be as it is. </p>\n\n<p>So, Why does compiler give an output of this code <strong>\"pune\"</strong> instead of <strong>\"puneay\"</strong>?</p>\n"}, {"tags": ["c++", "c", "linux", "garbage-collection"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1534258167, "post_id": 51840623, "comment_id": 90641733, "body": "If you vary the hardware and the problem disappears, your software is OK, your HW design sketchy, and the problematic devices are just faulty. A memory test tool can only find problems, but it cannot prove their absence."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1534258193, "post_id": 51840623, "comment_id": 90641752, "body": "I&#39;m voting to close this question as off-topic because it&#39;s not even software."}], "owner": {"reputation": 51, "user_id": 6803006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81a9ebd84a31ed4ba0de8cadbbec30b2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter_Amond", "link": "https://stackoverflow.com/users/6803006/peter-amond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534249721, "creation_date": 1534247034, "last_edit_date": 1534249721, "question_id": 51840623, "link": "https://stackoverflow.com/questions/51840623/unexpected-behavior-of-custom-hardware-design-based-on-i-mx6-mt41k256m16tw-107", "title": "Unexpected behavior of custom hardware design based on i.MX6 &amp; MT41K256M16TW-107 IT:P", "body": "<p>I'm new to custom hardware designs and I'm going to scale up my custom hardware which is functioning well with few boards. I need some help with making decision on prototypes and scaling up with the state of the prototypes.   </p>\n\n<p>This hardware is based on i.MX6Q processor &amp; MT41K256M16TW-107 IT:P memory. This is most similar to nitrogen6_max development board.</p>\n\n<p>I'm having trouble with my hardware which is really difficult to figure out as some boards are working really well and some are not (From 7 units of production 4 boards are functioning really well, one board getting segmentation faults and kernel panic while running linux application ). When I do memory calibration of bad boards those are really looks like same to good boards. </p>\n\n<p>Segmentation fault is directing to some memory issues, I back traced and core dumped using linux GDB. >></p>\n\n<pre><code>Program terminated with signal SIGSEGV, Segmentation fault.\n#0  gcoHARDWARE_QuerySamplerBase (Hardware=0x22193dc, Hardware@entry=0x0, \nVertexCount=0x7ef95370, VertexCount@entry=0x7ef95368, VertexBase=0x40000,\nFragmentCount=FragmentCount@entry=0x2217814, FragmentBase=0x0) at \ngc_hal_user_hardware_query.c:6020\n6020    gc_hal_user_hardware_query.c: No such file or directory.\n[Current thread is 1 (Thread 0x76feb010 (LWP 697))]\n(gdb) bt\n#0  gcoHARDWARE_QuerySamplerBase (Hardware=0x22193dc, Hardware@entry=0x0, \nVertexCount=0x7ef95370, VertexCount@entry=0x7ef95368, VertexBase=0x40000,\nFragmentCount=FragmentCount@entry=0x2217814, FragmentBase=0x0) at \ngc_hal_user_hardware_query.c:6020\n#1  0x765d20e8 in gcoHAL_QuerySamplerBase (Hal=&lt;optimized out&gt;, \nVertexCount=VertexCount@entry=0x7ef95368, VertexBase=&lt;optimized out&gt;, \nFragmentCount=FragmentCount@entry=0x2217814,\nFragmentBase=0x0) at gc_hal_user_query.c:692\n#2  0x681e31ec in gcChipRecompileEvaluateKeyStates (chipCtx=0x0, \ngc=0x7ef95380) at src/chip/gc_chip_state.c:2115\n#3  gcChipValidateRecompileState (gc=0x7ef95380, gc@entry=0x21bd96c, \nchipCtx=0x0, chipCtx@entry=0x2217814) at src/chip/gc_chip_state.c:2634\n#4  0x681c6da8 in __glChipDrawValidateState (gc=0x21bd96c) at \nsrc/chip/gc_chip_draw.c:5217\n#5  0x68195688 in __glDrawValidateState (gc=0x21bd96c) at \nsrc/glcore/gc_es_draw.c:585\n#6  __glDrawPrimitive (gc=0x21bd96c, mode=&lt;optimized out&gt;) at \nsrc/glcore/gc_es_draw.c:943\n#7  0x68171048 in glDrawArrays (mode=4, first=6, count=6) at \nsrc/glcore/gc_es_api.c:399\n#8  0x76c9ac72 in CEGUI::OpenGL3GeometryBuffer::draw() const () from \n/usr/lib/libCEGUIOpenGLRenderer-0.so.2\n#9  0x76dd1aee in CEGUI::RenderQueue::draw() const () from \n/usr/lib/libCEGUIBase-0.so.2\n#10 0x76e317d8 in CEGUI::RenderingSurface::draw(CEGUI::RenderQueue const&amp;, \nCEGUI::RenderQueueEventArgs&amp;) () from /usr/lib/libCEGUIBase-0.so.2\n#11 0x76e31838 in CEGUI::RenderingSurface::drawContent() () from \n/usr/lib/libCEGUIBase-0.so.2\n#12 0x76e36d30 in CEGUI::GUIContext::drawContent() () from \n/usr/lib/libCEGUIBase-0.so.2\n#13 0x76e31710 in CEGUI::RenderingSurface::draw() () from \n/usr/lib/libCEGUIBase-0.so.2\n#14 0x001bf79c in tengri::gui::cegui::System::Impl::draw (this=0x2374f08) at \ncodebase/src/gui/cegui/system.cpp:107\n#15 tengri::gui::cegui::System::draw (this=this@entry=0x2374e74) at \ncodebase/src/gui/cegui/system.cpp:212\n#16 0x000b151e in falcon::osd::view::MainWindowBase::Impl::preNativeUpdate \n(this=0x2374e10) at codebase/src/osd/view/MainWindow.cpp:51\n#17 falcon::osd::view::MainWindowBase::preNativeUpdate \n(this=this@entry=0x209fe30) at codebase/src/osd/view/MainWindow.cpp:91\n#18 0x000c4686 in falcon::osd::view::FBMainWindow::update (this=0x209fe00) \nat \ncodebase/include/falcon/osd/view/FBMainWindow.h:56\n#19 falcon::osd::view::App::Impl::execute (this=0x209fdb0) at \ncodebase/src/osd/view/app_view_osd_falcon.cpp:139\n#20 falcon::osd::view::App::execute (this=&lt;optimized out&gt;) at \ncodebase/src/osd/view/app_view_osd_falcon.cpp:176\n#21 0x000475f6 in falcon::osd::App::execute (this=this@entry=0x7ef95c84) at \ncodebase/src/osd/app_osd_falcon.cpp:75\n#22 0x00047598 in main () at codebase/src/main.cpp:5\n(gdb) Quit\n</code></pre>\n\n<p>Here I have attached NXP tool calibration results for 2 good boards and 1 bad(getting segmentation faults) board. Click on following links. </p>\n\n<p><a href=\"https://pastebin.com/iQPt00er\" rel=\"nofollow noreferrer\">Board 1</a><br>\n<a href=\"https://pastebin.com/DJr3HpdR\" rel=\"nofollow noreferrer\">Board 2</a><br>\n<a href=\"https://pastebin.com/a6J6yuzZ\" rel=\"nofollow noreferrer\">Board 3</a></p>\n\n<p>I did stress test using stressapptest and it was a over night test. But I didn't get any fault and test was passed.</p>\n\n<ol>\n<li><p>From above 3 boards Board 1 and Board 2 are working really well and Board 3 is getting kernel panics while running same application on 3 boards. Can you help me to figure out any clue from this results from above 3 boards ?</p></li>\n<li><p>I did 50 units of production 6 months ago and only 30 were worked properly. But that is with Alliance memory AS4C256M16D3A-12BCN. So will this be an issue of the design ? If this is an issue of the ddr layout or whole design why some boards are working really well ? </p></li>\n<li><p>Will this be an issue of the manufacturing side ? Then how this could be happen with the same production ? Because some are working and some are not.</p></li>\n<li><p>Will stressapptest stress power as well. Do you know any linux app which can stress power as well?</p></li>\n</ol>\n\n<p>I don't have much experience with mass production and but I like to move forward after learning and correcting this issues. I must be thankful to you if you will kindly reply me soon.</p>\n"}, {"tags": ["c++", "c", "linux"], "comments": [{"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1534251549, "post_id": 51840557, "comment_id": 90637060, "body": "Your code calls <code>seteuid</code> instead of <code>setuid</code>?"}, {"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "edited": false, "score": 0, "creation_date": 1534287754, "post_id": 51840557, "comment_id": 90654852, "body": "I vote for leave open, because this question looks pretty clear for me."}], "answers": [{"tags": [], "owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "is_accepted": true, "score": 2, "last_activity_date": 1534247152, "creation_date": 1534247152, "answer_id": 51840658, "question_id": 51840557, "link": "https://stackoverflow.com/questions/51840557/setuid-create-one-child-process/51840658#51840658", "title": "setuid create one child process", "body": "<p>No, there's only one copy of your process here.</p>\n\n<pre><code>root     20293 18135  0 15:36 pts/7    00:00:00 sudo ./a.out\n</code></pre>\n\n<p>This is sudo, not your process: the ./a.out is its command line args. It then spawns your process as a child process as you've noticed:</p>\n\n<pre><code>sagar    20294 20293 99 15:36 pts/7    00:00:17 ./a.out\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 3, "last_activity_date": 1534247182, "creation_date": 1534247182, "answer_id": 51840667, "question_id": 51840557, "link": "https://stackoverflow.com/questions/51840557/setuid-create-one-child-process/51840667#51840667", "title": "setuid create one child process", "body": "<p>You're mistaken. This is what <code>sudo x</code> does. It calls <code>x</code> as root <em>in a new process</em> and wait for it, hence the two processes.</p>\n"}], "owner": {"reputation": 25, "user_id": 3030156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJTfQ.jpg?s=128&g=1", "display_name": "GaintD", "link": "https://stackoverflow.com/users/3030156/gaintd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "accepted_answer_id": 51840658, "answer_count": 2, "score": 2, "last_activity_date": 1534247182, "creation_date": 1534246819, "last_edit_date": 1534247024, "question_id": 51840557, "link": "https://stackoverflow.com/questions/51840557/setuid-create-one-child-process", "title": "setuid create one child process", "body": "<p>When I try to <code>setuid</code> in my program it creates 2 processes.  One is a parent process and the other is a child process .</p>\n\n<pre><code>int isRoot()\n{\n        if (getuid() != 0)\n        {\n                return 0;\n        }\n        else\n        {\n                return 1;\n        }\n}\n\nint main()\n{\n    printf(\"%s \\n \\n\",getUserName());\n    printf(\"%d\\n\",getuid());\n\n    if(!isRoot())\n    {\n        printf(\"This program must be run as root/sudo user!!\");\n        exit(0);\n    }\n    seteuid(1000);\n    while (1) {}\n    printf(\"%s \\n \\n\",getUserName());\n}\n</code></pre>\n\n<p>When I check with <code>ps</code> command it show me two different processes:</p>\n\n<pre><code>sagar@sagar-desktop:~$ ps -aef | grep a.out\nroot     20293 18135  0 15:36 pts/7    00:00:00 sudo ./a.out\nsagar    20294 20293 99 15:36 pts/7    00:00:17 ./a.out\n</code></pre>\n\n<p>Can anyone tell me why it is creating two process instead of one ? </p>\n"}, {"tags": ["c", "crc", "modbus", "crc16"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1534245894, "post_id": 51839991, "comment_id": 90633478, "body": "<i>&quot;i dont know how can i send single byte and modify crc function for FC1&quot;</i> Please clarify what your problem is. Show your message construction code if necessary. The request CRC is calculated same way for FC1 as for FC3: just run crc function over the first 6 bytes of the message frame."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1534390468, "post_id": 51839991, "comment_id": 90690103, "body": "I still can&#39;t find a question. What is your question? (Note that questions end with a question mark.) Please read about what an <a href=\"https://stackoverflow.com/help/mcve\">MVCE</a> is. Provide an example that gives the wrong answer, what the right answer is supposed to be, and how you know that that is the right answer."}, {"owner": {"reputation": 43, "user_id": 10179324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d990b9e01f590dc8f1cdf621b80a61?s=128&d=identicon&r=PG&f=1", "display_name": "AMPS", "link": "https://stackoverflow.com/users/10179324/amps"}, "edited": false, "score": 0, "creation_date": 1534390596, "post_id": 51839991, "comment_id": 90690129, "body": "I have added msg construction for FC3. Now I would do modify for function code1. I don&#39;t know how CRC function run. The code I have taken from one of forum.  where 50byte can  used .  unsigned int crc = 0xffff,poly = 0xa001; this value must be changed for function code1 what should be polynomial value"}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1539630915, "post_id": 51839991, "comment_id": 92563840, "body": "There is still no question in this question."}], "answers": [{"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1534551925, "last_edit_date": 1534551925, "creation_date": 1534550169, "answer_id": 51904100, "question_id": 51839991, "link": "https://stackoverflow.com/questions/51839991/modbus-functional-code-1-crc-check-for-pic-microcontoller/51904100#51904100", "title": "Modbus functional code 1 &amp; crc check for PIC microcontoller", "body": "<p>CRC is normally appended to a message most significant byte first. You need to swap two lines of code, sending the high order byte of the 16 bit crc before the low order byte. Try this change:</p>\n\n<pre><code>                Serial_1_Send_byte((unsigned char)(crc1&gt;&gt;8));\n                Serial_1_Send_byte((unsigned char)crc1);\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10179324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d990b9e01f590dc8f1cdf621b80a61?s=128&d=identicon&r=PG&f=1", "display_name": "AMPS", "link": "https://stackoverflow.com/users/10179324/amps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539595223, "creation_date": 1534244826, "last_edit_date": 1539595223, "question_id": 51839991, "link": "https://stackoverflow.com/questions/51839991/modbus-functional-code-1-crc-check-for-pic-microcontoller", "title": "Modbus functional code 1 &amp; crc check for PIC microcontoller", "body": "<p>I need help in calculating modbus CRC check for function code 1. I.e read coil register. I have sample code for CRC check for function code 3 i.e holding register  for analog input.</p>\n\n<pre><code># Read Coil Status (FC=01)\n\n## Request\n</code></pre>\n\n<p>This command is requesting the ON/OFF status of discrete coils # 20 to 56\nfrom the slave device with address 17.</p>\n\n<p>11 01 0013 0025 0E84</p>\n\n<ul>\n<li>11: The Slave Address (17 = 11 hex)</li>\n<li>01: The Function Code (read Coil Status)</li>\n<li>0013: The Data Address of the first coil to read. (Coil 20 - 1 = 19 = 13 hex)</li>\n<li>0025: The total number of coils requested. (coils 20 to 56 = 37 = 25 hex)</li>\n<li>0E84: The CRC (cyclic redundancy check) for error checking.</li>\n</ul>\n\n<h2>Response</h2>\n\n<p>11 01 05 CD6BB20E1B 45E6</p>\n\n<ul>\n<li>11: The Slave Address (17 = 11 hex)</li>\n<li>01: The Function Code (read Coil Status)</li>\n<li>05: The number of data bytes to follow (37 Coils / 8 bits per byte = 5 bytes)</li>\n<li>CD: Coils 27 - 20 (1100 1101)</li>\n<li>6B: Coils 35 - 28 (0110 1011)</li>\n<li>B2: Coils 43 - 36 (1011 0010)</li>\n<li>0E: Coils 51 - 44 (0000 1110)</li>\n<li>1B: 3 space holders &amp; Coils 56 - 52 (0001 1011)</li>\n<li>45E6: The CRC (cyclic redundancy check).</li>\n</ul>\n\n<h1>Read Holding Registers (FC=03)</h1>\n\n<h2>Request</h2>\n\n<p>This command is requesting the content of analog output holding registers # 40108 to\n40110 from the slave device with address 17.</p>\n\n<p>11 03 006B 0003 7687</p>\n\n<ul>\n<li>11: The Slave Address (17 = 11 hex)</li>\n<li>03: The Function Code (read Analog Output Holding Registers)</li>\n<li>006B: The Data Address of the first register requested. (40108-40001 = 107 = 6B hex)</li>\n<li>0003: The total number of registers requested. (read 3 registers 40108 to 40110)</li>\n<li>7687: The CRC (cyclic redundancy check) for error checking.</li>\n</ul>\n\n<h2>Response</h2>\n\n<p>11 03 06 AE41 5652 4340 49AD</p>\n\n<ul>\n<li>11: The Slave Address (17 = 11 hex)</li>\n<li>03: The Function Code (read Analog Output Holding Registers)</li>\n<li>06: The number of data bytes to follow (3 registers x 2 bytes each = 6 bytes)</li>\n<li>AE41: The contents of register 40108</li>\n<li>5652: The contents of register 40109</li>\n<li>4340: The contents of register 40110</li>\n<li>49AD: The CRC (cyclic redundancy check).</li>\n</ul>\n\n<p><strong>I am no issue for getting response for FC3. because i am sending properly the 2 byte address , but i dont know how can i send single byte and modify crc function for FC1 ->read coil register</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/r163Y.png\" rel=\"nofollow noreferrer\">Discription of read coil register </a></p>\n\n<pre><code>unsigned int crc_fn(unsigned char *dpacket,unsigned int len) { // CRC Function(Error calcualtion)\n    unsigned int crc = 0xffff,poly = 0xa001;\n    unsigned int i=0;\n\n    for(i=0; i&lt;len; i++) {\n        crc^= dpacket[i];\n        for(j=0; j&lt;8; j++) {\n            if(crc &amp; 0x01) {\n                crc &gt;&gt;= 1;\n                crc ^= poly;\n            } else\n                crc &gt;&gt;= 1;\n        }\n    }\n    return (crc);\n}\n</code></pre>\n"}, {"tags": ["c", "function", "macros"], "comments": [{"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "edited": false, "score": 0, "creation_date": 1534244854, "post_id": 51839960, "comment_id": 90632893, "body": "What do you mean by convert? If you mean replace then that can be done in pre-compile step e.g. gcc -E my_source.c"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1534245090, "post_id": 51839960, "comment_id": 90633023, "body": "Add suitable types, braces, <code>return</code>, and a semicolon. (That particular macro is broken, by the way. <code>ELAPSED_TIME(3, 1+1);</code> should be 1, but is 3.)"}], "answers": [{"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": true, "score": 3, "last_activity_date": 1534245450, "creation_date": 1534245450, "answer_id": 51840171, "question_id": 51839960, "link": "https://stackoverflow.com/questions/51839960/c-programming-how-to-convert-macro-to-function/51840171#51840171", "title": "C Programming How to convert macro to function", "body": "<p>for example:</p>\n\n<pre><code>int elapsed_Time (int currentTime, int startTime)\n{\n    return (currentTime - startTime);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 8856382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/329536379b8048146ac6fee283625c55?s=128&d=identicon&r=PG&f=1", "display_name": "shailesh tripathi", "link": "https://stackoverflow.com/users/8856382/shailesh-tripathi"}, "is_accepted": false, "score": 0, "last_activity_date": 1534245674, "creation_date": 1534245674, "answer_id": 51840243, "question_id": 51839960, "link": "https://stackoverflow.com/questions/51839960/c-programming-how-to-convert-macro-to-function/51840243#51840243", "title": "C Programming How to convert macro to function", "body": "<p>Preprocessed macros are simply text replacement , so if you convert such macro in function then you must bind it with some type , here looking at macro definition I am not sure generic (void*) type will work here. In c++ you can templatise the same, but this is simply replacement so if you have genric usage like for float/char/int/uint/long so better to keep it or templatize it in c++ or use (void*) in c function and do the subtraction on lowest unit level (eg char by char ).</p>\n"}], "owner": {"reputation": 131, "user_id": 10224108, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eWXqI-k8He8/AAAAAAAAAAI/AAAAAAAAAGw/0it_vbcBxzA/photo.jpg?sz=128", "display_name": "Redsam121", "link": "https://stackoverflow.com/users/10224108/redsam121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 51840171, "answer_count": 2, "score": 2, "last_activity_date": 1534245674, "creation_date": 1534244703, "question_id": 51839960, "link": "https://stackoverflow.com/questions/51839960/c-programming-how-to-convert-macro-to-function", "title": "C Programming How to convert macro to function", "body": "<p>I need to know how to convert any #define for .c (source) and .h (header) files.</p>\n\n<pre><code>#define ELAPSED_TIME(currentTime, startTime) (currentTime - startTime)\n</code></pre>\n"}, {"tags": ["c", "winapi", "encryption", "aes", "wincrypt"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1534244877, "post_id": 51839466, "comment_id": 90632912, "body": "I think you need to copy the key for the decrypt step - encryption morphs the key."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1534245409, "post_id": 51839466, "comment_id": 90633182, "body": "@500-InternalServerError when i print the key before decrypting, it is correct with out any chenges"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1534245892, "post_id": 51839466, "comment_id": 90633476, "body": "Surely these functions work correctly. Surely the error is in your code."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1534246095, "post_id": 51839466, "comment_id": 90633612, "body": "@DavidHeffernan I checked every thing. Yes functions working correctly, but i don&#39;t know where am i wrong?"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1534246656, "post_id": 51839466, "comment_id": 90633926, "body": "I meant the key handle, hKey, not the actual key."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1534246882, "post_id": 51839466, "comment_id": 90634081, "body": "@500-InternalServerError i checked <code>hKey</code>. it has the same value. <code>if(!hKey) printf(&quot;ok&quot;);</code>"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1534250251, "post_id": 51839466, "comment_id": 90636183, "body": "<code>hKey</code> is just a handle to the operating system&#39;s internal data structure, which holds a copy of the key that you supplied. This is the key that gets morphed."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534251922, "post_id": 51839466, "comment_id": 90637314, "body": "It&#39;s not your full code. What&#39;s <code>StrCpyA</code>?"}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534252110, "post_id": 51839466, "comment_id": 90637467, "body": "@CristiFati this function copy the values to <code>key</code> , <code>iv</code> and <code>plaintext</code>"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534252179, "post_id": 51839466, "comment_id": 90637518, "body": "I read the 3 lines of code as well, and based on its name, i figured out what it&#39;s supposed to do, but where is its body, to see what it actually does?"}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534252784, "post_id": 51839466, "comment_id": 90637934, "body": "@CristiFati its in <code>int main()</code> body"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534252997, "post_id": 51839466, "comment_id": 90638072, "body": "As I stated in my previous comment, I noticed where <b>it&#39;s used</b> (and <i>BTW</i>, you <b>don&#39;t have</b> a <code>main</code>), I wanted to see its definition (whether it&#39;s a function, a macro, ...). Are you able to provide that? If yes, please include it in the question."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534253004, "post_id": 51839466, "comment_id": 90638079, "body": "@CristiFati i included <code>&lt;shlwapi.h&gt;</code>, &lt;wincrypt.h&gt;, &lt;stdio.h&gt;"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534253503, "post_id": 51839466, "comment_id": 90638456, "body": "Oh... <i>shlwapi</i> was the missing point. I <i>Google</i>d the function and didn&#39;t see any results (on the 1st page), that&#39;s why I thought it was yours. For testing purposes I ussed: <code>#define StrCpyA strcpy</code>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1534257298, "post_id": 51839466, "comment_id": 90641132, "body": "@500-InternalServerError - in general this is true, but here <code>Final = true</code> - as result key state reset to intial state"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1534257512, "post_id": 51839466, "comment_id": 90641273, "body": "you wrong called <code>CryptEncrypt</code> - last 2 arguments is invalid. <code>dwPlainSize</code> - is inout parameter. on input it must containing size of data - so <code>lstrlenA((LPCSTR)szPlainText) + 1)</code> - but you pass 0 here (say that you have 0 size data). and the last parameter - must be size of buffer, not size of data"}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1534304603, "post_id": 51839466, "comment_id": 90657841, "body": "@RbMm you are absolutely right... i didn&#39;t attention to that. but i solved my problem, but now i got it what you said to me. any way thank you so much"}], "answers": [{"comments": [{"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "edited": false, "score": 0, "creation_date": 1534273947, "post_id": 51844463, "comment_id": 90649934, "body": "Thank you so much."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "edited": false, "score": 0, "creation_date": 1534274050, "post_id": 51844463, "comment_id": 90649984, "body": "but I didn&#39;t know what is this : <code>CryptEncrypt(hKey, NULL, TRUE, 0, NULL, &amp;dwBufSize, 0)</code>"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "edited": false, "score": 0, "creation_date": 1534274351, "post_id": 51844463, "comment_id": 90650087, "body": "You&#39;re welcome! That&#39;s the 2nd bullet: getting the required encrypted buffer size."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "edited": false, "score": 0, "creation_date": 1534274468, "post_id": 51844463, "comment_id": 90650141, "body": "is it store encrypted buffer size in <code>dwBufSize</code>?"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "edited": false, "score": 0, "creation_date": 1534274666, "post_id": 51844463, "comment_id": 90650223, "body": "Sure (I thought it was obvious)."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "edited": false, "score": 0, "creation_date": 1534304688, "post_id": 51844463, "comment_id": 90657860, "body": "by the way, i posted an answer too."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1534410919, "post_id": 51844463, "comment_id": 90698511, "body": "Hmmm @cristifati, only a few things wrong with the original code then (!)r"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1534414456, "post_id": 51844463, "comment_id": 90700651, "body": "@PaulSanders: I don&#39;t understand your comment. I listed everything that I had to do in order to have a compilable and working example. Except for the <code>if</code> conditions change (to avoid multiple nesting levels) and convenience macros which are refactors (based on personal preferences), everythiong else was required."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1534429334, "post_id": 51844463, "comment_id": 90710064, "body": "@PaulSanders Oh... :)) Thanks you!"}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 4, "last_activity_date": 1559662071, "last_edit_date": 1559662071, "creation_date": 1534258867, "answer_id": 51844463, "question_id": 51839466, "link": "https://stackoverflow.com/questions/51839466/winapi-cryptdecrypt-not-working-properly-in-aes-256/51844463#51844463", "title": "WinAPI - CryptDecrypt() not working properly in AES 256", "body": "<p>Here's a variant, that I'm running from <em>VStudio 2015</em>.</p>\n\n<p><em>code.c</em>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;windows.h&gt;\n#include &lt;wincrypt.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;Shlwapi.h&gt;\n\n#define DEFAULT_AES_KEY_SIZE 32\n#define DEFAULT_IV_SIZE 16\n#define BUFFER_FOR_PLAINTEXT 32\n\n#define CLEANUP_CRYPT_STUFF(PROV, KEY) \\\n    CryptDestroyKey(KEY); \\\n    CryptReleaseContext(PROV, 0)\n\n#define PRINT_FUNC_ERR_AND_RETURN(FUNC) \\\n    printf(\"%s (line %d) failed: %d\\n\", ##FUNC, __LINE__, GetLastError()); \\\n    return -1\n\n\ntypedef struct AES256KEYBLOB_ {\n    BLOBHEADER bhHdr;\n    DWORD dwKeySize;\n    BYTE szBytes[DEFAULT_AES_KEY_SIZE + 1];\n} AES256KEYBLOB;\n\n\nint main() {\n    // handles for csp and key\n    HCRYPTPROV hProv = NULL;\n    HCRYPTKEY hKey = NULL;\n    BYTE szKey[DEFAULT_AES_KEY_SIZE + 1] = { 0 };\n    BYTE szIV[DEFAULT_IV_SIZE + 1] = { 0 };\n    // plain bytes\n    BYTE szPlainText[BUFFER_FOR_PLAINTEXT + 1] = { 0 }, *pBuf = NULL;\n    AES256KEYBLOB AESBlob;\n    memset(&amp;AESBlob, 0, sizeof(AESBlob));\n\n    // initalize key and plaintext\n    StrCpyA((LPSTR)szKey, \"00112233445566778899001122334455\");\n    StrCpyA((LPSTR)szIV, \"4455667788990011\");\n    StrCpyA((LPSTR)szPlainText, \"abcdefghijklmnopqrstuvwxyzabcdef\");\n    DWORD dwPlainSize = lstrlenA((LPCSTR)szPlainText), dwBufSize = dwPlainSize, dwBufSize2 = dwPlainSize;\n\n    // blob data for CryptImportKey() function (include key and version and so on...)\n    AESBlob.bhHdr.bType = PLAINTEXTKEYBLOB;\n    AESBlob.bhHdr.bVersion = CUR_BLOB_VERSION;\n    AESBlob.bhHdr.reserved = 0;\n    AESBlob.bhHdr.aiKeyAlg = CALG_AES_256;\n    AESBlob.dwKeySize = DEFAULT_AES_KEY_SIZE;\n    StrCpyA((LPSTR)AESBlob.szBytes, (LPCSTR)szKey);\n\n    // create a cryptographic service provider (CSP)\n    if (!CryptAcquireContextA(&amp;hProv, NULL, MS_ENH_RSA_AES_PROV_A, PROV_RSA_AES, CRYPT_VERIFYCONTEXT)) {\n        PRINT_FUNC_ERR_AND_RETURN(CryptAcquireContextA);\n    }\n    if (!CryptImportKey(hProv, (BYTE*)&amp;AESBlob, sizeof(AES256KEYBLOB), NULL, CRYPT_EXPORTABLE, &amp;hKey)) {\n        CryptReleaseContext(hProv, 0);\n        PRINT_FUNC_ERR_AND_RETURN(CryptImportKey);\n    }\n    if (!CryptSetKeyParam(hKey, KP_IV, szIV, 0)) {\n        CLEANUP_CRYPT_STUFF(hProv, hKey);\n        PRINT_FUNC_ERR_AND_RETURN(CryptSetKeyParam);\n    }\n    if (CryptEncrypt(hKey, NULL, TRUE, 0, NULL, &amp;dwBufSize, 0)) {\n        printf(\"%d bytes required to hold the encrypted buf\\n\", dwBufSize);\n        if ((pBuf = calloc(dwBufSize, sizeof(BYTE))) == NULL)\n        {\n            CLEANUP_CRYPT_STUFF(hProv, hKey);\n            PRINT_FUNC_ERR_AND_RETURN(calloc);\n        }\n        StrCpyA(pBuf, szPlainText);\n    } else {\n        CLEANUP_CRYPT_STUFF(hProv, hKey);\n        PRINT_FUNC_ERR_AND_RETURN(CryptEncrypt);\n    }\n    if (CryptEncrypt(hKey, NULL, TRUE, 0, pBuf, &amp;dwBufSize2, dwBufSize)) {\n        printf(\"\\nEncrypted data: [%s]\\nSize: %d\\n\", (LPCSTR)pBuf, dwBufSize2);\n        if (CryptDecrypt(hKey, NULL, TRUE, 0, pBuf, &amp;dwBufSize)) {\n            printf(\"\\nDecrypted data: [%s]\\nSize: %d\\n\", (LPCSTR)pBuf, dwBufSize);\n        } else {\n            free(pBuf);\n            CLEANUP_CRYPT_STUFF(hProv, hKey);\n            PRINT_FUNC_ERR_AND_RETURN(CryptDecrypt);\n        }\n    } else {\n        free(pBuf);\n        CLEANUP_CRYPT_STUFF(hProv, hKey);\n        PRINT_FUNC_ERR_AND_RETURN(CryptEncrypt);\n    }\n    free(pBuf);\n    CLEANUP_CRYPT_STUFF(hProv, hKey);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Notes</strong>:</p>\n\n<ul>\n<li>Removed <em>AES256KEYBLOB</em> constructor as I got <em>Access Violation</em> (which is normal when playing with memory \"that's not yours\"). Replaced the structure initialization with the <em>memset</em> call</li>\n<li><p>The <strong>main</strong> (logical) error was that the buffer was not large enough to store the encrypted text (combined with a wrong value (<strong><em>0</em></strong>) for <em>dwPlainSize</em> - making the function to misleadingly succeed). According to <a href=\"https://docs.microsoft.com/en-gb/windows/desktop/api/wincrypt/nf-wincrypt-cryptencrypt\" rel=\"nofollow noreferrer\">[MS.Docs]: CryptEncrypt function</a>:</p>\n\n<blockquote>\n  <p>If this parameter contains <strong>NULL</strong>, this function will calculate the required size for the ciphertext and place that in the value pointed to by the <em>pdwDataLen</em> parameter.</p>\n</blockquote>\n\n<p>To find out the required size, make an additional call to the function, with <em>pbData</em> set to <em>NULL</em> (this practice is also encountered in other <em>WinAPI</em>s). Then allocate a buffer, fill it with required data, and make the \"main\" call the function on that buffer...</p></li>\n<li><p>Added the missing <em>#include</em>s and <em>main</em></p></li>\n<li>Added code to release the used resources when no longer needed</li>\n<li>Refacorings:\n\n<ul>\n<li>Negated the <em>if</em> conditions, since I don't like so many nesting levels</li>\n<li>Added some convenience macros (<em>CLEANUP_CRYPT_STUFF</em>, <em>PRINT_FUNC_ERR_AND_RETURN</em>), to avoid code duplication</li>\n</ul></li>\n<li>Other minor fixes / improvements</li>\n<li>You might want to add a function that prints exactly <strong><em>N</em></strong> bytes from a buffer, as \"<strong><em>%s</em></strong>\" specifier only stops when \"<strong><em>\\0</em></strong>\" is encountered, and only (dumb) luck prevented the console to be filled with garbage (or even the program to crash) when <em>printf</em>ing the buffers</li>\n<li>There might be some other aspects related to this functions that I didn't handle (as I'm not an expert in this area), but the goal was just to have smth working</li>\n</ul>\n\n<p><strong>Output</strong>:</p>\n\n<blockquote>\n<pre><code>48 bytes required to hold the encrypted buf\n\nEncrypted data: [&lt;\u00c9\u2559\u00e5h\u2229\u03c6:bOPs  r2w~w\u256ac\u255fD\u2561\u00ef\u2565V\u255fne\u0393\u00dfv\u2229\u00b7J8c\u00c5\u2565\u00b2\u00b2\u00b2\u00b2s]\nSize: 48\n\nDecrypted data: [abcdefghijklmnopqrstuvwxyzabcdef\u0393\u00dfv\u2229\u00b7J8c\u00c5\u2565\u00b2\u00b2\u00b2\u00b2s]\nSize: 32\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534414888, "post_id": 51850146, "comment_id": 90700867, "body": "Note that you should also add the resource deallocation (<code>hProv</code>, <code>hKey</code>)."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1534420861, "post_id": 51850146, "comment_id": 90704298, "body": "@CristiFati sure i did that before in my code, but i forgot to add it in my question. I know this --&gt; <code>CryptReleaseContext(hProv, 0)</code>"}], "tags": [], "owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "is_accepted": false, "score": 3, "last_activity_date": 1534282855, "creation_date": 1534282855, "answer_id": 51850146, "question_id": 51839466, "link": "https://stackoverflow.com/questions/51839466/winapi-cryptdecrypt-not-working-properly-in-aes-256/51850146#51850146", "title": "WinAPI - CryptDecrypt() not working properly in AES 256", "body": "<p><a href=\"https://stackoverflow.com/a/51844463?noredirect=1\"><code>CristiFati</code></a> answer is great, And it make me offer use of bellow statement for calculate cipher length :</p>\n\n<pre><code>CryptEncrypt(hKey, NULL, TRUE, 0, NULL, &amp;dwBufSize, 0);\n</code></pre>\n\n<p><strong><em>According Microsoft Doc :</em></strong></p>\n\n<blockquote>\n  <p>If <em>pbData</em> is <em>NULL</em>, no error is returned, and the function stores the size of the encrypted data, in bytes, in the DWORD value pointed to by pdwDataLen) :</p>\n</blockquote>\n\n<pre><code>BOOL CryptEncrypt(\n  HCRYPTKEY  hKey,\n  HCRYPTHASH hHash,\n  BOOL       Final,\n  DWORD      dwFlags,\n  BYTE       *pbData,\n  DWORD      *pdwDataLen,\n  DWORD      dwBufLen\n);\n</code></pre>\n\n<hr>\n\n<p><strong><em>My Solution :</em></strong></p>\n\n<p>But in my code, I just forget to calculate <code>szPlainText</code> size when i give it to <code>CryptEncrypt()</code> :</p>\n\n<pre><code>DWORD dwPlainSize = 0;    // initialized with 0\n</code></pre>\n\n<p>So \"zero-length\" has not any mean for bellow function (<code>CryptEncrypt()</code> function always get a plain-text with <code>0</code> length) :</p>\n\n<pre><code>CryptEncrypt(hKey, NULL, TRUE, 0, szPlainText, &amp;dwPlainSize, lstrlenA((LPCSTR)szPlainText) + 1)\n</code></pre>\n\n<p>And I should set its size with bellow statement (My <code>code</code> will be worked just by adding this):</p>\n\n<pre><code>dwPlainSize = lstrlenA((LPCSTR)szPlainText);\n</code></pre>\n\n<p>Then pass it in right case :</p>\n\n<pre><code>CryptEncrypt(hKey, NULL, TRUE, 0, szPlainText, &amp;dwPlainSize, BUFFER_FOR_PLAINTEXT)\n</code></pre>\n\n<p>So, output is like bellow :</p>\n\n<pre><code>Encrypted data : &lt;\u00c9\u2559\u00e5h\u2229\u03c6:bOPs  r2w~w\u256ac\u255fD\u2561\u00ef\u2565V\u255fne\u0393\u00dfv\u2229\u00b7J8c\u00c5\u2565\nSize : 48\n\nDecrypted data : abcdefghijklmnopqrstuvwxyzabcdef\u0393\u00dfv\u2229\u00b7J8c\u00c5\u2565\nSize : 32\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2383, "favorite_count": 1, "accepted_answer_id": 51844463, "answer_count": 2, "score": 3, "last_activity_date": 1559662071, "creation_date": 1534243080, "question_id": 51839466, "link": "https://stackoverflow.com/questions/51839466/winapi-cryptdecrypt-not-working-properly-in-aes-256", "title": "WinAPI - CryptDecrypt() not working properly in AES 256", "body": "<p>I used to work with <code>crypto++</code> in <em>Visual Studio</em> before, but now I want to use of <code>wincrypt.h</code> API functions to encrypt a string with <strong>AES 256</strong> with an <strong>IV</strong> (cbc mode).</p>\n\n<p>I did bellow steps but I'm confused about <code>CryptEncrypt()</code> and <code>CryptDecrypt()</code> functions, because It seems they don't work properly :</p>\n\n<ul>\n<li><p><code>CryptAcquireContextA</code> defined to create a <code>CSP</code> :</p>\n\n<pre><code>// create a cryptographic service provider (CSP)\nCryptAcquireContextA(&amp;hProv, NULL, MS_ENH_RSA_AES_PROV_A, PROV_RSA_AES, CRYPT_VERIFYCONTEXT)\n</code></pre></li>\n<li><p>For set key, I'm using of this way (<em>import key</em>):</p>\n\n<pre><code>CryptImportKey(hProv, (BYTE*)&amp;AESBlob, sizeof(AES256KEYBLOB), NULL, CRYPT_EXPORTABLE, &amp;hKey)\n</code></pre></li>\n<li><p>IV, Key, Plaintext sizes are :</p>\n\n<pre><code>#define     DEFAULT_AES_KEY_SIZE    32\n#define     DEFAULT_IV_SIZE         16\n#define     BUFFER_FOR_PLAINTEXT    32\n</code></pre></li>\n</ul>\n\n<p>This is my whole <code>code</code> :</p>\n\n<pre><code>// handles for csp and key\nHCRYPTPROV hProv = NULL;\nHCRYPTPROV hKey = NULL;\nBYTE szKey[DEFAULT_AES_KEY_SIZE + 1] = {0};\nBYTE szIV[DEFAULT_IV_SIZE + 1] = {0};\n// plain bytes\nBYTE szPlainText[BUFFER_FOR_PLAINTEXT + 1] = {0};\nDWORD dwPlainSize = 0;\n\n// initalize key and plaintext\nStrCpyA((LPSTR)szKey, \"00112233445566778899001122334455\");\nStrCpyA((LPSTR)szIV, \"4455667788990011\");\nStrCpyA((LPSTR)szPlainText, \"abcdefghijklmnopqrstuvwxyzabcdef\");\n\n// blob data for CryptImportKey() function (include key and version and so on...)\nstruct AES256KEYBLOB\n{\n    AES256KEYBLOB() { StrCpyA((LPSTR)szBytes, 0); }\n    BLOBHEADER bhHdr;\n    DWORD dwKeySize;\n    BYTE szBytes[DEFAULT_AES_KEY_SIZE + 1];\n} AESBlob;\n\nAESBlob.bhHdr.bType = PLAINTEXTKEYBLOB;\nAESBlob.bhHdr.bVersion = CUR_BLOB_VERSION;\nAESBlob.bhHdr.reserved = 0;\nAESBlob.bhHdr.aiKeyAlg = CALG_AES_256;\nAESBlob.dwKeySize = DEFAULT_AES_KEY_SIZE;\nStrCpyA((LPSTR)AESBlob.szBytes, (LPCSTR)szKey);\n\n// create a cryptographic service provider (CSP)\nif(CryptAcquireContextA(&amp;hProv, NULL, MS_ENH_RSA_AES_PROV_A, PROV_RSA_AES, CRYPT_VERIFYCONTEXT))\n{\n    if(CryptImportKey(hProv, (BYTE*)&amp;AESBlob, sizeof(AES256KEYBLOB), NULL, CRYPT_EXPORTABLE, &amp;hKey))\n    {\n        if(CryptSetKeyParam(hKey, KP_IV, szIV, 0))\n        {\n            if(CryptEncrypt(hKey, NULL, TRUE, 0, szPlainText, &amp;dwPlainSize, lstrlenA((LPCSTR)szPlainText) + 1))\n            {\n                printf(\"\\nEncrypted data : %s\\nSize : %d\\n\", (LPCSTR)szPlainText, dwPlainSize);\n\n                if(CryptDecrypt(hKey, NULL, TRUE, 0, szPlainText, &amp;dwPlainSize)) {\n                    printf(\"\\nDecrypted data : %s\\nSize : %d\\n\", (LPCSTR)szPlainText, dwPlainSize);\n                }\n                else\n                    printf(\"failed to decrypt!\");\n            }\n            else\n                printf(\"failed to encrypt\");\n        }\n    }\n}\n</code></pre>\n\n<p>It just encrypt half section of plaintext And decrypting not done! even By changing just <code>szPlainText</code> value, it always give me bellow output (It means that <code>CryptEncrypt()</code> and <code>CryptDecrypt()</code> does not working as expected!) :</p>\n\n<pre><code>Encrypted data : U\u2561\u03c07\u00d1L|F\u03a9$}\u251crUqrstuvwxyzabcdef\nSize : 16\n\nDecrypted data : U\u2561\u03c07\u00d1L|F\u03a9$}\u251crUqrstuvwxyzabcdef\nSize : 0\n</code></pre>\n"}, {"tags": ["c", "bison", "symbol-table"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1534242863, "post_id": 51839226, "comment_id": 90631652, "body": "The short answer is that you need a symbol table (hash table) for each scope."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1534247256, "post_id": 51839226, "comment_id": 90634295, "body": "... provided that you need this at all.  It&#39;s not immediately clear to me why you need to track symbol definitions to support your particular task.  That&#39;s not saying I&#39;m confident you don&#39;t need it, but do be sure you know, in some detail, how and why you&#39;re going to use it."}, {"owner": {"reputation": 9, "user_id": 9810328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ea903bde54509fb2f63fbe202a9f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Micheal", "link": "https://stackoverflow.com/users/9810328/micheal"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1534410404, "post_id": 51839226, "comment_id": 90698242, "body": "@JohnBollinger  When do I need to manage the scopes? Because this is actually the problem, I do not know if they should be managed. What I have to do is translate a java code (formed by the restrictions mentioned in the post) in pyhton. So for example there must be at least one class, one method, some iteration and some logical arithmetic operation."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1534420673, "post_id": 51839226, "comment_id": 90704207, "body": "I don&#39;t have a very satisfactory answer to that, @Michele.  The best I can do is: you need to track symbol definitions if your program&#39;s output must differ when the definitions differ.  If you have not identified any such scenarios yet, then I suggest putting the whole question on the shelf until you do."}], "owner": {"reputation": 9, "user_id": 9810328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ea903bde54509fb2f63fbe202a9f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Micheal", "link": "https://stackoverflow.com/users/9810328/micheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 483, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534242285, "creation_date": 1534242285, "question_id": 51839226, "link": "https://stackoverflow.com/questions/51839226/how-to-manage-the-scope-in-the-symbol-table", "title": "How to manage the scope in the symbol table", "body": "<p>I have to build a compiler that translates the java language into pyhton. I'm using the Flex and Bison tools. I created the flex file and I defined the syntactic grammar in Bison for some restrictions that I have to implement (such as the management of cycles, management of a class, management of logical-arithmetic operators, etc.).\nAs for semantic analysis, I have a problem with the symbol table. I'm using the uthash.h library to handle hash tables. For the moment I have created a simple symbol table composed only by the key and the name of the symbol. What I would like to understand, is how to manage the scope (portion of the program in which the declaration of the identifier is applied) with the symbol table and then how to identify a scope to be able to insert it in the symbol table.\nI hope you can help me.\nThanks so much.</p>\n\n<p>This is the module containing the basic structure of the symbol table and some functions:</p>\n\n<pre><code>#include \"uthash.h\" //http://troydhanson.github.io/uthash/userguide.html\n\nstruct symtable         \n{\n  int id;               // Key \n  char name[20];    \n  UT_hash_handle hh;  /* makes this structure hashable */\n};\n\nstruct symtable *symbols = NULL;\n\nvoid add_symbol(int symbol_id, char *name) { \n\n  struct symtable *s;\n  HASH_FIND_INT(symbols, &amp;symbol_id, s); \n  if (s==NULL) {\n    s = (struct symtable *)malloc(sizeof *s);\n    s-&gt;id = symbol_id;\n    HASH_ADD_INT( symbols, id, s );         \n  }\n  strcpy(s-&gt;name, name);\n\n}\n\nstruct symtable *find_symbol(int symbol_id) {  \n\n  struct symtable *s;\n  HASH_FIND_INT( symbols, &amp;symbol_id, s );      \n  return s;\n\n}\n\nvoid delete_symbol(struct symtable *symbol) {   \n\n  HASH_DEL(symbols, symbol);                \n  free(symbol);\n\n}\n\nvoid delete_all() {                             \n\n  struct symtable *current_symbol, *tmp;\n  HASH_ITER(hh, symbols, current_symbol, tmp) { \n    HASH_DEL(symbols,current_symbol);           \n    free(current_symbol);                       \n  }\n\n}\n\nvoid print_symbol() {\n\n  struct symtable *s;\n  for(s=symbols; s != NULL; s=(struct symtable*)(s-&gt;hh.next)) {\n     printf(\" Symbol id %d: name %s\\n\", s-&gt;id, s-&gt;name);\n  }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 4, "creation_date": 1534242290, "post_id": 51839157, "comment_id": 90631322, "body": "Welcome to SO. The idea for a question like this is that you post the code you have so far and describe the problem you have with that code. Then someone might tell what&#39;s wrong and how to correct it or someone might suggest a better approach."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534255043, "post_id": 51839157, "comment_id": 90639467, "body": "&quot;so far it&#39;s not working&quot; --&gt; post that non-working code."}, {"owner": {"reputation": 5574, "user_id": 536874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/00yFk.jpg?s=128&g=1", "display_name": "Johannes", "link": "https://stackoverflow.com/users/536874/johannes"}, "edited": false, "score": 0, "creation_date": 1534260012, "post_id": 51839157, "comment_id": 90642928, "body": "If you do not need them later do not store them, iterate over the input immediately. What is your issue?"}], "answers": [{"tags": [], "owner": {"reputation": 335, "user_id": 4357841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMoQ7.jpg?s=128&g=1", "display_name": "Bilal Siddiqui", "link": "https://stackoverflow.com/users/4357841/bilal-siddiqui"}, "is_accepted": true, "score": 0, "last_activity_date": 1534260733, "creation_date": 1534260733, "answer_id": 51845012, "question_id": 51839157, "link": "https://stackoverflow.com/questions/51839157/how-to-separate-words-from-numbers-in-file-in-c/51845012#51845012", "title": "How to separate words from numbers in file in c", "body": "<p>You need to post code on where you are stuck; that is the best way to get help.\nAnyway, here is some rough code to help you identify where your issues may be. I have kept it simple to allow you to follow through with how vanilla C does I/O.</p>\n\n<pre><code>#include &lt;stdio.h&gt;                   /* snprinf, fprintf fgets, fopen, sscanf */\n\nint main(void)\n{\n  char line_buffer[64];\n  FILE* infile = fopen(\"yourfile.txt\", \"r\");         /* open file for reading */\n  while(fgets(line_buffer, 64, infile) != NULL)\n  {\n    char set_name[8];                 /* construct a string w/ the set number */\n    snprintf(set_name, 8, \"SET %c:\", *(line_buffer+4));    /* no. is 5th char */\n    fprintf(stdout, \"%s \", set_name);           /* fprintf w/ stdout = printf */\n\n    int set[8];\n    int ind = 0;\n    for(int i=7; line_buffer[i]!='\\0';)    /* start from first number and end */\n    {                       /* when string ends, denoted by the '\\0' sentinel */\n      int n;    /* using pointer arithmetric, read in and store num &amp; consume */\n      sscanf(line_buffer+i, \"%d %n\", set+ind, &amp;n);     /* adjacent whitespace */\n      i += n;               /* n from sscanf tells how many chars are read in */\n      fprintf(stdout, \"%d \", set[ind]);\n      ind +=1;\n    }\n\n    fprintf(stdout, \"\\n\");\n  }\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10223952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5a83580151acb52f8b6d191cdf93e4?s=128&d=identicon&r=PG&f=1", "display_name": "Simm", "link": "https://stackoverflow.com/users/10223952/simm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 51845012, "answer_count": 1, "score": 2, "last_activity_date": 1534260733, "creation_date": 1534242098, "last_edit_date": 1534260403, "question_id": 51839157, "link": "https://stackoverflow.com/questions/51839157/how-to-separate-words-from-numbers-in-file-in-c", "title": "How to separate words from numbers in file in c", "body": "<p>I need to find the degree of inversion for a set of numbers in a file.</p>\n\n<p>I read input from a <code>.txt</code> file in the form:</p>\n\n<pre><code>SET 1: -3 1 2 0 4\nSET 2: 0 1 2 3 4 5\nSET 4: 29 39 0 1 3\n</code></pre>\n\n<p>I do not know how to separate the input (the set and its numbers). I thought of putting them in a struct but so far it's not working. \nThe <em>degree of inversion</em> = number of numbers that are smaller than their index value. For example, in SET 2, the <em>degree of inversion</em> is 0.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1534240909, "post_id": 51838744, "comment_id": 90630559, "body": "This absurd behavior is caused by undefined behavior of your program."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1534241273, "post_id": 51838744, "comment_id": 90630800, "body": "There are many things a Java programmer needs to unlearn when learning C or C++. That function arguments are evaluated in a particular order is one of them."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1534241560, "post_id": 51838744, "comment_id": 90630965, "body": "@molbdnilo In C, the function arguments are not evaluated in a specified order."}, {"owner": {"reputation": 500, "user_id": 6831268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AXuIK.png?s=128&g=1", "display_name": "NoSuchUserException", "link": "https://stackoverflow.com/users/6831268/nosuchuserexception"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534241677, "post_id": 51838744, "comment_id": 90631025, "body": "@chux function arguments aren&#39;t evaluated in a particular order, but that is fundamental right? or not?"}, {"owner": {"reputation": 500, "user_id": 6831268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AXuIK.png?s=128&g=1", "display_name": "NoSuchUserException", "link": "https://stackoverflow.com/users/6831268/nosuchuserexception"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1534241797, "post_id": 51838744, "comment_id": 90631079, "body": "@haccks okay let me understand it the right way, here the absurd behaviour is caused by the arguments not evaluating in a specified order, right?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1534241896, "post_id": 51838744, "comment_id": 90631140, "body": "@mohitR0_0; Yes. you got it right."}, {"owner": {"reputation": 500, "user_id": 6831268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AXuIK.png?s=128&g=1", "display_name": "NoSuchUserException", "link": "https://stackoverflow.com/users/6831268/nosuchuserexception"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1534242163, "post_id": 51838744, "comment_id": 90631262, "body": "@haccks okay but the post you referred talks about the constructs related to only unary &#39;++&#39; and not function arguments undefined behaviour, won&#39;t it be fine to just not tag it as duplicate since it&#39;s not the same."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534242271, "post_id": 51838744, "comment_id": 90631312, "body": "it us because the <code>*a</code> is passed earlier than the <code>++a</code> and it is implementation defined."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534242479, "post_id": 51838744, "comment_id": 90631427, "body": "@chux Exactly. Hence, it is something that you need to unlearn."}, {"owner": {"reputation": 500, "user_id": 6831268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AXuIK.png?s=128&g=1", "display_name": "NoSuchUserException", "link": "https://stackoverflow.com/users/6831268/nosuchuserexception"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534242605, "post_id": 51838744, "comment_id": 90631502, "body": "@P__J__ is it correct to say that in this particular implementation the arguments to a function is always passed in a right to left order?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1534242753, "post_id": 51838744, "comment_id": 90631575, "body": "You cant relay on it. Just move operations outside the function call."}, {"owner": {"reputation": 500, "user_id": 6831268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AXuIK.png?s=128&g=1", "display_name": "NoSuchUserException", "link": "https://stackoverflow.com/users/6831268/nosuchuserexception"}, "edited": false, "score": 0, "creation_date": 1534242818, "post_id": 51838744, "comment_id": 90631621, "body": "yes that should be the correct practice I guess"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1534256302, "post_id": 51838744, "comment_id": 90640368, "body": "@mohitR0_0: The problem goes beyond evaluation order - attempting to modify the value of an object  (<code>++a</code>)  and then use that value of that object in a computation (<code>*a</code>) without an intervening sequence point is explicitly called out as <i>undefined behavior</i> by the language definition, and the result of undefined behavior can be quite literally anything.  It&#39;s a coding error, period, regardless of how the compiler orders the operations."}], "owner": {"reputation": 500, "user_id": 6831268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AXuIK.png?s=128&g=1", "display_name": "NoSuchUserException", "link": "https://stackoverflow.com/users/6831268/nosuchuserexception"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "closed_date": 1534240950, "answer_count": 0, "score": 0, "last_activity_date": 1534240906, "creation_date": 1534240649, "question_id": 51838744, "link": "https://stackoverflow.com/questions/51838744/pointers-in-c-and-c-used-with-prefix-operator", "closed_reason": "Duplicate", "title": "Pointers in C and C++ used with prefix operator &#39;++&#39;", "body": "<p>I was trying to understand pointers in C and was trying a code sample, which gave an absurd result.</p>\n\n<p>Following is the code sample :</p>\n\n<pre><code>void main()\n{\n    int *a;\n    int arr[5] = {1,3,4,5,2};\n    printf(\"%d\\n\", *(arr+1));\n    a = arr;\n    printf(\"Address: %p || Value: %d\\n\", ++a, *a);\n}\n</code></pre>\n\n<p>okay so I expected it to output the <code>address</code> and <code>value</code> of second index of the array but unfortunately the output <code>value</code> isn't not equal to 3 (the second index value of the array) as opposed to the address which comes out correct.</p>\n\n<p>The problem here is that the prefix <code>++a</code> expression doesn't update the pointer variable <code>a</code> and when later in the printf function <code>a</code> is <code>dereferenced</code> the updated value is not used and hence the output shows the first index value of the array.</p>\n\n<p>Please help me on this.</p>\n"}, {"tags": ["c", "go", "dll"], "answers": [{"tags": [], "owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "is_accepted": true, "score": 0, "last_activity_date": 1534242673, "creation_date": 1534242673, "answer_id": 51839354, "question_id": 51838685, "link": "https://stackoverflow.com/questions/51838685/how-to-use-c-dll/51839354#51839354", "title": "How to use C .dll", "body": "<blockquote>\n  <p>Is there any way to use custom C dll in golang?</p>\n</blockquote>\n\n<p>The answer to your question, yes</p>\n\n<p>You have to import the C that you commented in your code. In order to call the c function, you need to import \"C\".</p>\n\n<pre><code>import \"C\"\n</code></pre>\n\n<p>The cgo way allows you to call the function this way:</p>\n\n<pre><code>import (\"C\")\n...\nC.yourDllFunc(...)\n</code></pre>\n\n<hr>\n\n<p>Reference and more information about <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">cgo</a></p>\n\n<p>Very generic example <a href=\"https://github.com/golang/go/wiki/cgo\" rel=\"nofollow noreferrer\">cgo</a>.</p>\n\n<pre><code>package cgoexample\n/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid myprint(char* s) {\n    printf(\"%s\\n\", s);\n}\n*/\nimport \"C\"\n\nimport \"unsafe\"\n\nfunc Example() {\n    cs := C.CString(\"Hello from stdio\\n\")\n    C.myprint(cs)\n    C.free(unsafe.Pointer(cs))\n}\n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 10133070, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mNX6XKY4Cmk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rlq-bCi8oI1hyUPD_XqB1StwOBWA/mo/photo.jpg?sz=128", "display_name": "Frnk Wdl", "link": "https://stackoverflow.com/users/10133070/frnk-wdl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "closed_date": 1534498729, "accepted_answer_id": 51839354, "answer_count": 1, "score": 2, "last_activity_date": 1534242673, "creation_date": 1534240445, "last_edit_date": 1534242330, "question_id": 51838685, "link": "https://stackoverflow.com/questions/51838685/how-to-use-c-dll", "closed_reason": "Duplicate", "title": "How to use C .dll", "body": "<p>Is there any way to use custom C dll in golang?\nI have my dll written in C (goDLL.dll)\nand i want to use it inside go</p>\n\n<p>Here is little example what i want to get:</p>\n\n<pre><code>package main\n\n    //#import \"goDLL.dll\"\n    //extern void add(int * A, int * B, int * C)\n    //{\n    //      *C = *A + *B;\n    //}\n    //\n    // import \"C\"\n     import (\n     \"fmt\"\n     ) \n\nfunc main() {\n\n    var AA *C.int = new(C.int)\n    var BB *C.int = new(C.int)\n    var CC *C.int = new(C.int)\n\n    *AA = 5\n    *BB = 4\n\n    C.add(AA, BB, CC)\n    fmt.Println(*CC)\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 0, "last_activity_date": 1534344530, "last_edit_date": 1534344530, "creation_date": 1534240843, "answer_id": 51838795, "question_id": 51838637, "link": "https://stackoverflow.com/questions/51838637/how-to-get-a-disks-sector-number-of-the-inode-c-linux/51838795#51838795", "title": "How to get a disk&#39;s sector number of the INODE. C, Linux?", "body": "<p>No, standard C does not provide any support for this.</p>\n\n<p>The inode number designates an entry with information about the file in a file system. That entry has further information for the device driver, which would determine where it is on the storage device. This information is normally accessed only by device drivers, not standard user programs. Also, a file may have its parts stored in multiple places on disk, not a single sector or contiguous sequence of sectors.</p>\n\n<p>If you are writing a device driver, there are structures and kernel services you would need to know about in order to write the driver. You could learn about these from textbooks or reference materials.</p>\n\n<p>Largely the same knowledge would be required to write a user-level (but privileged) program to read the file system and device data and interpret it to determine where the parts of the file are stored.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5177344"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1534246996, "accepted_answer_id": 51838795, "answer_count": 1, "score": 0, "last_activity_date": 1534344530, "creation_date": 1534240298, "question_id": 51838637, "link": "https://stackoverflow.com/questions/51838637/how-to-get-a-disks-sector-number-of-the-inode-c-linux", "closed_reason": "Needs more focus", "title": "How to get a disk&#39;s sector number of the INODE. C, Linux?", "body": "<p>Is there a way to \"translate\" INODE number into the disk sector number by using C?</p>\n"}, {"tags": ["c", "kernel", "opencl"], "comments": [{"owner": {"reputation": 131, "user_id": 9905041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7707a3bdbec3a250744c709792f69b?s=128&d=identicon&r=PG&f=1", "display_name": "lil&#39; wing", "link": "https://stackoverflow.com/users/9905041/lil-wing"}, "edited": false, "score": 0, "creation_date": 1534538267, "post_id": 51838631, "comment_id": 90756276, "body": "You mind including your output? I think you need to change the <code>%lu</code> to <code>%f</code> in <code>printf(&quot;\\nAverage time in nanoseconds = %lu\\n&quot;, p);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3844, "user_id": 711654, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Eyh5u.jpg?s=128&g=1", "display_name": "Boris Ivanov", "link": "https://stackoverflow.com/users/711654/boris-ivanov"}, "is_accepted": false, "score": 0, "last_activity_date": 1535025575, "last_edit_date": 1535025575, "creation_date": 1535025164, "answer_id": 51985217, "question_id": 51838631, "link": "https://stackoverflow.com/questions/51838631/time-measurement-of-loop-in-opencl/51985217#51985217", "title": "Time measurement of loop in opencl", "body": "<p>U have wrong sample of OpenCL. Try to write normal program without loop. \nlook at this <a href=\"https://code.google.com/archive/p/simple-opencl/\" rel=\"nofollow noreferrer\">example</a></p>\n\n<p>I have done duration calculation this way: </p>\n\n<pre><code>double getDuration(cl_event event)                                                                                                                                                                                                                                                        \n{                                                                                                                                                                                                                                                                                         \n  cl_ulong start_time, end_time;                                                                                                                                                                                                                                                          \n  clGetEventProfilingInfo (event,CL_PROFILING_COMMAND_START,sizeof(cl_ulong),&amp;start_time,NULL);                                                                                                                                                                                           \n  clGetEventProfilingInfo (event,CL_PROFILING_COMMAND_END,sizeof(cl_ulong),&amp;end_time,NULL);                                                                                                                                                                                               \n  double total_time = (end_time - start_time) * 1e-6;                                                                                                                                                                                                                                     \n  return total_time;                                                                                                                                                                                                                                                                      \n}              \n\n\ncl_event timer;\n\nint ret = clEnqueueNDRangeKernel(cq, kernel, 1, p_global_work_offset, &amp;global_work_size, &amp;local_work_size, 0, NULL, &amp;timer);\n\nprintf(\"T:%fms\", getDuration(timer));\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9781390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de3a9006969d5286766a2cca9c93aa3?s=128&d=identicon&r=PG&f=1", "display_name": "ZSA", "link": "https://stackoverflow.com/users/9781390/zsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535025575, "creation_date": 1534240280, "question_id": 51838631, "link": "https://stackoverflow.com/questions/51838631/time-measurement-of-loop-in-opencl", "title": "Time measurement of loop in opencl", "body": "<p>I am trying to measure the time for kernel execution which is in loop. The thing is the time that i get its not just 1 value( but 5 specific time values appears). Following is the code and kindly let me know what i am doing wrong. Thanks</p>\n\n<pre><code>int b = 100;\nint a;\ncl_event prof_event;\nfor (a = 0; a &lt; b; a++)\n{\n    ret = clEnqueueNDRangeKernel(command_queue, kernel, 1, NULL, globalws, NULL, 0, NULL, &amp;prof_event);\n\n    if (ret != CL_SUCCESS) {\n        printf(\"Failed to enqueueNDRangeKernel.\\n\");\n        exit(1);\n    }\n\n    clEnqueueReadBuffer(command_queue, bufferC, CL_TRUE, 0, N * sizeof(float), (void *)C, 0, NULL, NULL);\n    clEnqueueWriteBuffer(command_queue, bufferY, CL_TRUE, 0, 1 * N * sizeof(float), (void *)C, 0, NULL, NULL);\n\n    clFinish(command_queue);\n    ret = clWaitForEvents(1, &amp;prof_event);\n    ret |= clGetEventProfilingInfo(prof_event, CL_PROFILING_COMMAND_START, sizeof(cl_ulong), &amp;ev_start_time, NULL);\n    ret |= clGetEventProfilingInfo(prof_event, CL_PROFILING_COMMAND_END, sizeof(cl_ulong), &amp;ev_end_time, NULL);\n    run_time_gpu += (ev_end_time - ev_start_time);\n\n    for (int i = 0; i &lt; N; i++) {\n        printf(\"%f, \", C[i]);\n    }\n}\nprintf(\"\\n\");\n\nfloat p = run_time_gpu / (float)b;\nprintf(\"\\nAverage time in nanoseconds = %lu\\n\", p);\n</code></pre>\n"}, {"tags": ["c", "file", "file-handling"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1534238770, "post_id": 51838026, "comment_id": 90629279, "body": "You need to read more than 1 character at a time to get the whole number and then convert the text represenattion into binary value. Look for <code>strtol</code> and friends."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534242718, "post_id": 51838026, "comment_id": 90631555, "body": "What text or who suggested using <code>feof(f)</code>?"}, {"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "edited": false, "score": 1, "creation_date": 1534243014, "post_id": 51838026, "comment_id": 90631737, "body": "side notes: <code>feof</code> tells you whether a previous error was due to eof, it doesn&#39;t promise that you can read from the file, and you&#39;re ignoring the first character you read."}], "answers": [{"tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": false, "score": 1, "last_activity_date": 1534245446, "last_edit_date": 1534245446, "creation_date": 1534239441, "answer_id": 51838334, "question_id": 51838026, "link": "https://stackoverflow.com/questions/51838026/find-and-save-an-integer-from-a-textfile-in-c/51838334#51838334", "title": "find and save an integer from a textfile in C", "body": "<p>One option could be using <code>getline</code> and <code>sscanf</code> functions. I assumed that text lines do not contain numbers:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int value, matched = 0;\n    char *line = NULL;\n    size_t size;\n    while(getline(&amp;line, &amp;size, stdin) != -1) {\n        if ((matched = sscanf(line, \"%d\", &amp;value)) != 0) \n            break;\n    }\n    if (matched) \n        printf(\"value: %d\\n\", value);\n    return 0;\n}\n</code></pre>\n\n<p>This part: </p>\n\n<pre><code> while(getline(&amp;line, &amp;size, stdin) != -1) { \n</code></pre>\n\n<p>will try to read the entire stream line by line. \nNext line uses <code>sscanf</code> return value, which is the number of input items successfully matched and assigned, to determine whether the integer value has been found. If so it stops reading the stream. </p>\n"}, {"comments": [{"owner": {"reputation": 2799, "user_id": 1485311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sNWZV.jpg?s=128&g=1", "display_name": "ChatterOne", "link": "https://stackoverflow.com/users/1485311/chatterone"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534242808, "post_id": 51839016, "comment_id": 90631610, "body": "@chux You&#39;re right about the <code>char</code> and <code>int</code>. The <code>pow</code> was just a bit of an exaggeration in being explicit as to how it would work, but I guess I&#39;ll change it anyway to what you just said."}], "tags": [], "owner": {"reputation": 2799, "user_id": 1485311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sNWZV.jpg?s=128&g=1", "display_name": "ChatterOne", "link": "https://stackoverflow.com/users/1485311/chatterone"}, "is_accepted": false, "score": 2, "last_activity_date": 1534242840, "last_edit_date": 1534242840, "creation_date": 1534241617, "answer_id": 51839016, "question_id": 51838026, "link": "https://stackoverflow.com/questions/51838026/find-and-save-an-integer-from-a-textfile-in-c/51839016#51839016", "title": "find and save an integer from a textfile in C", "body": "<p>As @pbn said you're better off using <code>sscanf</code>.</p>\n\n<p>But if you really, really want, you can do it your way, by reading one character at a time, but you'll need to \"build\" the integer yourself, converting the character to integer, keeping track of what you have, and multiplying by powers of 10 for every digit the number that you already have.</p>\n\n<p>Something like this (not complete code, it's just to get you started):</p>\n\n<pre><code>int c;\nint num = 0;\n\nwhile (c = fgetc(f)) {\n    if(!isdigit(c)) {\n        break;\n    }\n    num = (num * 10) + (c - '0');\n}\n</code></pre>\n\n<p>The <code>c- '0'</code> part is to convert the text representation of the integer to the integer itself. <code>0</code> is character 48, <code>1</code> is 49 and so on.</p>\n\n<p>This is assuming that on the line with numbers, you ONLY have numbers, not a mix of numerical and non-numerical characters.</p>\n\n<p>Also, do not use <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">!feof(file)</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 8856382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/329536379b8048146ac6fee283625c55?s=128&d=identicon&r=PG&f=1", "display_name": "shailesh tripathi", "link": "https://stackoverflow.com/users/8856382/shailesh-tripathi"}, "is_accepted": false, "score": 0, "last_activity_date": 1534242247, "creation_date": 1534242247, "answer_id": 51839202, "question_id": 51838026, "link": "https://stackoverflow.com/questions/51838026/find-and-save-an-integer-from-a-textfile-in-c/51839202#51839202", "title": "find and save an integer from a textfile in C", "body": "<p>One simple way in your program is once you find digit don't just stop continue untill you find next \" \" , \"\\n\" , \"\\0\" . Till then add Number = Number*10 +(*num);, define Number as global or something.</p>\n"}], "owner": {"reputation": 27, "user_id": 9309501, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5-R2VoRCZck/AAAAAAAAAAI/AAAAAAAAB7g/pp2zXSUOsQ4/photo.jpg?sz=128", "display_name": "Martin Wikar", "link": "https://stackoverflow.com/users/9309501/martin-wikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1534245446, "creation_date": 1534238533, "question_id": 51838026, "link": "https://stackoverflow.com/questions/51838026/find-and-save-an-integer-from-a-textfile-in-c", "title": "find and save an integer from a textfile in C", "body": "<p>I'm very new to programming and C. I have textfile with some random text and an integer that i want to find and save. The textfile looks something like this (I only want to save 23 in this case, not 56):</p>\n\n<pre><code># this is a comment\n23\nthis is some random text\n56\n</code></pre>\n\n<p>And this is the code I have:</p>\n\n<pre><code>    int *num = malloc(sizeof(int));\n    *num = fgetc(f);\n\n    while(!feof(f)){\n        *num = fgetc(f);\n        if(isdigit(*num)){\n            break;\n        }\n    }\n\n    if(!isdigit(*num)){\n        printf(\"Error: no number found.\\n\");\n        free(num);\n    }\n    else{\n        printf(\"%c\\n\", *num);\n    }\n</code></pre>\n\n<p>I'm kinda stuck right now and my program only prints out the number 2 :/\nVery thankful for help.</p>\n"}, {"tags": ["c++", "c", "linux", "eclipse", "handle"], "comments": [{"owner": {"reputation": 541, "user_id": 8750467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gN16.png?s=128&g=1", "display_name": "Germ&#225;n", "link": "https://stackoverflow.com/users/8750467/germ%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1534238340, "post_id": 51837797, "comment_id": 90629030, "body": "Relevant: <a href=\"https://stackoverflow.com/questions/1303123/what-is-a-handle-in-c\" title=\"what is a handle in c\">stackoverflow.com/questions/1303123/what-is-a-handle-in-c</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1534238445, "post_id": 51837797, "comment_id": 90629082, "body": "You are using c++, ask for standard C and added both C and C++ tags to your question. Please decide which language you want to use. They are very different languages."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1534238547, "post_id": 51837797, "comment_id": 90629157, "body": "HANDLE is a common type used by the Windows API. It is not standard C. The Windows API does not work in Linux and vice versa."}, {"owner": {"reputation": 3799, "user_id": 1876627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0jbhF.gif?s=128&g=1", "display_name": "Brans Ds", "link": "https://stackoverflow.com/users/1876627/brans-ds"}, "edited": false, "score": 0, "creation_date": 1534238870, "post_id": 51837797, "comment_id": 90629333, "body": "This code is compiled successfully on Linux using make. And see no typedef of HANDLE in the  repository  <a href=\"https://bitbucket.org/search?q=repo%3Aziplib%20HANDLE&amp;account=%7Be42a1629-26db-4e05-8836-249fb1321f42%7D\" rel=\"nofollow noreferrer\">bitbucket.org/&hellip;</a>. How if this is not standart C?"}, {"owner": {"reputation": 3799, "user_id": 1876627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0jbhF.gif?s=128&g=1", "display_name": "Brans Ds", "link": "https://stackoverflow.com/users/1876627/brans-ds"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1534238965, "post_id": 51837797, "comment_id": 90629389, "body": "@Gerhardh I am interested in C++ project  but the code that is not compiled is under extern &quot;C&quot; {} so both"}, {"owner": {"reputation": 2357, "user_id": 4074081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emDh4.png?s=128&g=1", "display_name": "dewaffled", "link": "https://stackoverflow.com/users/4074081/dewaffled"}, "edited": false, "score": 0, "creation_date": 1534239373, "post_id": 51837797, "comment_id": 90629659, "body": "This code is Windows specific and is located in <code>lzma&#47;Threads.c</code> and Makefile only includes <code>lzma&#47;unix&#47;*.c</code>. So, it is just not used in non-windows builds."}, {"owner": {"reputation": 3799, "user_id": 1876627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0jbhF.gif?s=128&g=1", "display_name": "Brans Ds", "link": "https://stackoverflow.com/users/1876627/brans-ds"}, "reply_to_user": {"reputation": 2357, "user_id": 4074081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emDh4.png?s=128&g=1", "display_name": "dewaffled", "link": "https://stackoverflow.com/users/4074081/dewaffled"}, "edited": false, "score": 0, "creation_date": 1534239622, "post_id": 51837797, "comment_id": 90629808, "body": "@dewaffled  thank you. Got it!"}], "owner": {"reputation": 3799, "user_id": 1876627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0jbhF.gif?s=128&g=1", "display_name": "Brans Ds", "link": "https://stackoverflow.com/users/1876627/brans-ds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2496, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534237949, "creation_date": 1534237949, "question_id": 51837797, "link": "https://stackoverflow.com/questions/51837797/identifier-handle-is-undefined", "title": "identifier &quot;HANDLE&quot; is undefined", "body": "<p>I want to create and compile C++ project from sources using Eclipse(on Linux) and got</p>\n\n<pre><code>identifier \"HANDLE\" is undefined\n</code></pre>\n\n<p>for the code:</p>\n\n<pre><code>#include \"Types.h\"\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nWRes HandlePtr_Close(HANDLE *h);\n...\n</code></pre>\n\n<p>How to fix this error? Is HANDLE something standard in C?</p>\n\n<p>Here the make the file with help of it everything is compiling well but I want to compile using eclipse project:</p>\n\n<pre><code># Final names of binaries\nEXECUTABLE = Bin/zipsample\nSO_LIBRARY = Bin/libzip.so\n\n# C &amp; C++ compiler\n#CC       = gcc\n#CXX      = g++-4.8\nCC        = clang\nCXX       = clang++\nCFLAGS    = -fPIC -Wno-enum-conversion -O3\nCXXFLAGS  = -fPIC -std=c++11 -O3\n\n# Linker flags\nLDFLAGS   = -pthread\n\n# Sources of external libraries\nSRC_ZLIB  = $(wildcard Source/ZipLib/extlibs/zlib/*.c)\nSRC_LZMA  = $(wildcard Source/ZipLib/extlibs/lzma/unix/*.c)\nSRC_BZIP2 = $(wildcard Source/ZipLib/extlibs/bzip2/*.c)\n\n# ZipLib sources\nSRC = \\\n        $(wildcard Source/ZipLib/*.cpp)        \\\n        $(wildcard Source/ZipLib/detail/*.cpp)\n\n# Object files          \nOBJS = \\\n        $(SRC:.cpp=.o)     \\\n        $(SRC_ZLIB:.c=.o)  \\\n        $(SRC_LZMA:.c=.o)  \\\n        $(SRC_BZIP2:.c=.o)\n\n# Rules\nall: $(EXECUTABLE) $(SO_LIBRARY)\n\n$(EXECUTABLE): $(OBJS)\n    $(CXX) $(CXXFLAGS) $(LDFLAGS) Source/Sample/Main.cpp -o $@ $^\n\n$(SO_LIBRARY): $(OBJS)\n    $(CXX) $(LDFLAGS) -shared -o $@ $^\n\n%.o: %.cpp\n    $(CXX) $(CXXFLAGS) -c $&lt; -o $@\n\n%.o: %.c\n    $(CC) $(CFLAGS) -c $&lt; -o $@\n\nclean:\n    rm -rf `find Source -name '*.o'` ziplib.tar.gz Bin/*.zip Bin/out* $(EXECUTABLE) $(SO_LIBRARY)\n\ntarball:\n    tar -zcvf ziplib.tar.gz *\n</code></pre>\n"}, {"tags": ["c", "linux", "network-programming", "ethernet"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1534357741, "post_id": 51837388, "comment_id": 90680947, "body": "Why would you read the arp before every packet?  Reading it once when you start up seems about right. Use <code>arping</code>"}, {"owner": {"reputation": 1310, "user_id": 4045754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DBrYm.png?s=128&g=1", "display_name": "yeniv", "link": "https://stackoverflow.com/users/4045754/yeniv"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1534423682, "post_id": 51837388, "comment_id": 90706132, "body": "@stark, I could read it once and keep using but what if some day the destination machine gets replaced. The admin would assign the same IP address to the new machine but the MAC address would be different."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1534425209, "post_id": 51837388, "comment_id": 90707133, "body": "Your program has no error recovery code?"}], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 4045754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DBrYm.png?s=128&g=1", "display_name": "yeniv", "link": "https://stackoverflow.com/users/4045754/yeniv"}, "edited": false, "score": 0, "creation_date": 1534249563, "post_id": 51837787, "comment_id": 90635782, "body": "Is that to change the MAC address of ethernet interface of my machine? That is not something that I want to do."}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": false, "score": 0, "last_activity_date": 1534237900, "creation_date": 1534237900, "answer_id": 51837787, "question_id": 51837388, "link": "https://stackoverflow.com/questions/51837388/find-the-next-hop-mac-address-for-ethernet-header/51837787#51837787", "title": "Find the next hop MAC address for ethernet header", "body": "<p>You can set the MAC address for the device with <code>SIOCSIFHWADDR</code> ioctl request. The manual for <a href=\"https://linux.die.net/man/7/netdevice\" rel=\"nofollow noreferrer\">netdevice</a> is a good starting point for this.</p>\n"}, {"comments": [{"owner": {"reputation": 1310, "user_id": 4045754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DBrYm.png?s=128&g=1", "display_name": "yeniv", "link": "https://stackoverflow.com/users/4045754/yeniv"}, "edited": false, "score": 0, "creation_date": 1534423772, "post_id": 51843731, "comment_id": 90706199, "body": "&quot;If your local router employs protocols like vrrp, hsrp or gblp, then the MAC address is always the same and doesn&#39;t change, even if your router is replaced.&quot; This sounds interesting. I will have to check if that is the case."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 1, "last_activity_date": 1534256605, "creation_date": 1534256605, "answer_id": 51843731, "question_id": 51837388, "link": "https://stackoverflow.com/questions/51837388/find-the-next-hop-mac-address-for-ethernet-header/51843731#51843731", "title": "Find the next hop MAC address for ethernet header", "body": "<p>What you are seeing here is the same problem that everyone faces, who tries to implement a network stack.\nYou have several options:</p>\n\n<ul>\n<li>If the packet is a <em>reply</em> packet, then just use the MAC address of the from address</li>\n<li>You can maintain an own arp-table and send a arp request if the entry in your table is missing or outdated. Parse arp replies and update your table accordingly. Packets to be sent without a valid arp table entry have to be queued. This is the most elegant, but also a very demanding option.</li>\n<li>You can simply send the packet to the MAC of your local router. It will forward the packet to the correct host specified in the IP header. If your local router employs protocols like vrrp, hsrp or gblp, then the MAC address is always the same and doesn't change, even if your router is replaced.</li>\n<li>You can read the MAC address from <code>/proc/net/arp</code> or with <code>ioctl(SIOCGARP, ...);</code>, but the entry for the IP you are looking for might not be present, if your host hasn't tried to communicate with it recently. You could, of course, send a dummy packet with <code>sendto();</code> to that host before reading the arp table.</li>\n</ul>\n\n<p>If you describe in more detail what you are planning to do, the suggestions might get better.</p>\n"}], "owner": {"reputation": 1310, "user_id": 4045754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DBrYm.png?s=128&g=1", "display_name": "yeniv", "link": "https://stackoverflow.com/users/4045754/yeniv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1534256605, "creation_date": 1534236602, "question_id": 51837388, "link": "https://stackoverflow.com/questions/51837388/find-the-next-hop-mac-address-for-ethernet-header", "title": "Find the next hop MAC address for ethernet header", "body": "<p>I want to send a packet to another machine but with a different MAC address in the ethernet header. For this I am using raw sockets in C and creating my own ethernet header so that I can set the source MAC as desired. The trouble is that I am not sure what destination MAC address to fill in the header. I know the IP of the destination machine but not the MAC. Even if I knew, I don't want to hardcode this MAC.</p>\n\n<p>One option I see is that my machine would know the MAC in its ARP table and I could read it and get the MAC address and fill it in. But doing this before sending each packet is overhead. I could read it once and keep using but what if some day the destination machine gets replaced. The admin would assign the same IP address to the new machine but the MAC address would be different. Probably when the new machine boots up, it would send a Gratuitous ARP and my machine would update its ARP table. But my program wouldn't know this. My program would keep sending packets with old MAC.</p>\n\n<p>I feel I am missing something very basic. Thoughts?</p>\n"}, {"tags": ["c", "eclipse", "gcc"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1534236495, "post_id": 51837327, "comment_id": 90627868, "body": "Is there a reason why you don&#39;t want the rest of the program in C11 though? If you have no requirement that the code must be in C90, then the proper solution is to convert it all to C11. Shouldn&#39;t be that much of an effort. Because if you get compiler errors for picking <code>-std=c11</code>, then that&#39;s a strong indicator of code smell, like for example accidentally using non-standard features or invoking poorly-defined behavior."}, {"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534236619, "post_id": 51837327, "comment_id": 90627950, "body": "yes, it is a huge project which has not been programmed by me..."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1534239341, "post_id": 51837327, "comment_id": 90629637, "body": "If it&#39;s a huge project and changing the compiler options isn&#39;t feasible, just code to C90 standards."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1534257298, "post_id": 51837327, "comment_id": 90641130, "body": "You should be able to add a specific make rule for your files, using whatever compiler flags you want. How you do that will depend on the Makefile."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1534258053, "post_id": 51837327, "comment_id": 90641643, "body": "If the project uses automake, see <a href=\"https://www.gnu.org/software/automake/manual/html_node/Program-and-Library-Variables.html#Program-and-Library-Variables\" rel=\"nofollow noreferrer\">gnu.org/software/automake/manual/html_node/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1534236862, "creation_date": 1534236862, "answer_id": 51837476, "question_id": 51837327, "link": "https://stackoverflow.com/questions/51837327/compile-part-of-code-using-std-c11-flag/51837476#51837476", "title": "compile part of code using -std=c11 flag", "body": "<p>As far as I'm aware, you can't set compiler options locally. You can however disable spurious warnings locally, by using <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html\" rel=\"nofollow noreferrer\">diagnostic pragmas</a>.</p>\n\n<p>However, the best way to do this is probably to isolate the C99/C11 code in separate .c files, which you compile separately from the rest of the project, before linking it all together.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1534238662, "creation_date": 1534238662, "answer_id": 51838074, "question_id": 51837327, "link": "https://stackoverflow.com/questions/51837327/compile-part-of-code-using-std-c11-flag/51838074#51838074", "title": "compile part of code using -std=c11 flag", "body": "<p>I don't think there's a pragma to locally force <code>-std=c99</code>/<code>-std=c11</code> (even though you can do the equivalent for some other options, e.g., for the <code>-On</code> options), but you can pretty much have a for-loop-local initializing declaration even in C90 without much of a syntactic disruption. Just enclose the for loop in braces and place the declaration there: <code>{ int i=0; for(;i&lt;5;i++){ something(); } }</code></p>\n"}], "owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 51837476, "answer_count": 2, "score": 1, "last_activity_date": 1534238662, "creation_date": 1534236403, "question_id": 51837327, "link": "https://stackoverflow.com/questions/51837327/compile-part-of-code-using-std-c11-flag", "title": "compile part of code using -std=c11 flag", "body": "<p>Is there a possibility to compile one part of a code with different flags - <strong>without</strong> changing the flags in the makefile?</p>\n\n<p>I've got an existing project which is not set up for -std=c11. Now I have added my own code and the compiler tells me things like </p>\n\n<p><code>'for' loop initial declarations are only allowed in C99 or C11 mode</code></p>\n\n<p>when I change the flag to std=c11 or c99, the rest of the program wont compile anymore. </p>\n\n<p>Is there something like <code>extern \"C\" {}</code> in C++ to tell the compiler to treat the following part as std=c11?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "fmi"], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 8516174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605ece3ccd2fff4e222cd83cc1a28c4c?s=128&d=identicon&r=PG&f=1", "display_name": "mklingn", "link": "https://stackoverflow.com/users/8516174/mklingn"}, "is_accepted": false, "score": 0, "last_activity_date": 1535481746, "last_edit_date": 1535481746, "creation_date": 1534318191, "answer_id": 51854566, "question_id": 51836935, "link": "https://stackoverflow.com/questions/51836935/fmu-export-of-c-code-with-structure-as-an-input-argument/51854566#51854566", "title": "FMU export of c code with structure as an input argument", "body": "<p>You can grab the <a href=\"http://www.qtronic.de/doc/fmusdk.zip\" rel=\"nofollow noreferrer\">FMU Software Development Kit for version 2.0</a>. It has several examples implemented in C, both for Co-Simulation (which I guess is what you want) and Model-Exchange.</p>\n\n<p>You can use one of the examples as a starting point (e.g. fmu20/src/models/bouncingBall from the zip file linked above). It is quite some manual work to adapt it, but you learn a lot about the interface. </p>\n\n<p>Two things to keep in mind:</p>\n\n<ol>\n<li>Be aware that only small subset of Matlab features can be exported to C code. See <a href=\"https://www.mathworks.com/help/coder/ug/matlab-language-features-supported-for-code-generation.html\" rel=\"nofollow noreferrer\">MATLAB Language Features Supported for C/C++ Code Generation</a> for a list.</li>\n<li>FMI does not yet handle array variables. This is <a href=\"https://fmi-standard.org/downloads/\" rel=\"nofollow noreferrer\">planned for version 3.0</a>. So you are limited to passing scalar variables only.</li>\n</ol>\n\n<p>The structure type you show above cannot be passed - as is - to an FMU. No calling program adhering to the standard can be aware how your internal structure is defined. They can only pass the primitive scalar data types specified by the FMI standard.</p>\n\n<p>The <em>information</em>, however, can be passed. You could define a double model variable called e.g. <em>x2</em> and either modify the <em>mult</em> function to use it directly or rebuild the structure inside the FMU.</p>\n"}], "owner": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535481746, "creation_date": 1534235084, "last_edit_date": 1534415088, "question_id": 51836935, "link": "https://stackoverflow.com/questions/51836935/fmu-export-of-c-code-with-structure-as-an-input-argument", "title": "FMU export of c code with structure as an input argument", "body": "<p>My research project group is trying to export matlab code as FMU.\nOne of the way we came up with is generating c code from matlab script  and export c code as FMU.\nI am curious if there is any tool for packaging c code as an FMU? If there is not, is there another way to achieve this? </p>\n\n<p><strong>Updating the question after the answer from @mklingn</strong>.<br>\nI have tried editing with <strong>bouncingball.c</strong> , but the problem I face is, in every example provided, variables are considered data type as either boolean or double. In my case one of the input is structure, for example my c file generated is</p>\n\n<pre><code>#include \"mult.h\"\n\n/* Function Definitions */\n\n/*\n * Arguments    : double u\n *                double v\n *                const struct0_T *m\n * Return Type  : double\n */\ndouble mult(double u, double v, const struct0_T *m)\n{\n  double y;\n  y = u * v * m-&gt;x[2];\n\n  /*  fcn(u,v ,'parameter1',m,'parameter2',n) */\n  return y;\n}\n</code></pre>\n\n<p>and .h file generated is </p>\n\n<pre><code>#ifndef MULT_H\n#define MULT_H\ntypedef struct {\n  char y[6];\n  double x[6];\n} struct0_T;\nextern double mult(double u, double v, const struct0_T *m);\n#endif\n</code></pre>\n\n<p>so according to your point 2: such kind of exporting is not possible with FMI version 2.0. Did I understand your point correct?</p>\n"}, {"tags": ["c", "buffer-overflow"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1534235088, "post_id": 51836921, "comment_id": 90627060, "body": "This means you are under the dark magic of undefined behavior! Reading about it will break the spell."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1534235618, "post_id": 51836921, "comment_id": 90627388, "body": "<i>&quot;Why does this code work?&quot;</i> - It doesn&#39;t. You were lulled into the false sense that it does simply because it appears to do so. You&#39;re confusing <i>defined</i> behavior with <i>observed</i> behavior. The latter doesn&#39;t necessarily equate to the former, but the former will reliably lead to the later."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1534236261, "post_id": 51836921, "comment_id": 90627742, "body": "Because what happens when you trigger Undefined Behavior is undefined. Your harddrive getting formatted is a valid result too."}], "answers": [{"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 0, "last_activity_date": 1534235277, "creation_date": 1534235277, "answer_id": 51836986, "question_id": 51836921, "link": "https://stackoverflow.com/questions/51836921/array-assigned-statically-does-not-overflow-when-assigning-values-out-of-range/51836986#51836986", "title": "Array assigned statically does not overflow when assigning values out of range", "body": "<p>There is no guarantee that it always works! <code>a[2]</code>, <code>a[3]</code> and <code>a[4]</code> are out of memory. Behaviour of the code is called as <em><a href=\"https://www.wikiwand.com/en/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behaviour</a></em></p>\n\n<p>For example, try below one. Does it still work?</p>\n\n<pre><code>for (int i = 0; i &lt; 100; ++i) {\n        a[i] = i + 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6696164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/spsFS.png?s=128&g=1", "display_name": "Hopeless Wanderer", "link": "https://stackoverflow.com/users/6696164/hopeless-wanderer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1534237167, "answer_count": 1, "score": 0, "last_activity_date": 1534235277, "creation_date": 1534235036, "question_id": 51836921, "link": "https://stackoverflow.com/questions/51836921/array-assigned-statically-does-not-overflow-when-assigning-values-out-of-range", "closed_reason": "Duplicate", "title": "Array assigned statically does not overflow when assigning values out of range", "body": "<p>Why does this code work?\nI  have an array of 2 elements and it should overflow, but it does not even give me an error on Linux using gcc. Instead, it works and outputs 5.</p>\n\n<pre><code>int doS(int a[2])\n{\n\nprintf(\"%d\", a[4]);\n\n}\n\nint main()\n\n{\n\n\nint rows =2;\n\nint a[rows];\n\na[0] = 1;\na[1] = 2;\na[2]= 3;\na[3] = 4;\na[4] = 5;\n\ndoS(a);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 1, "creation_date": 1534234836, "post_id": 51836832, "comment_id": 90626908, "body": "<code>#define MY_DEFAULT_VAR</code> is empty so the preprocessor replaces every occurence of <code>MY_DEFAULT_VAR</code> with nothing. That results in a syntax error <code>(-1*)</code>"}, {"owner": {"reputation": 563, "user_id": 7864336, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/8a2d64bf3ba8d5d7bc5d961075241343?s=128&d=identicon&r=PG&f=1", "display_name": "schanti schul", "link": "https://stackoverflow.com/users/7864336/schanti-schul"}, "reply_to_user": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1534234862, "post_id": 51836832, "comment_id": 90626926, "body": "please see fixed snippet"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 2, "creation_date": 1534234903, "post_id": 51836832, "comment_id": 90626955, "body": "<code>20u</code> mean unsigned, you are multiplying unsigned by <code>-1</code> which makes no sense"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1534235336, "post_id": 51836832, "comment_id": 90627206, "body": "What do you mean by &quot;failing&quot;? Does it not compile, or crash, or produce strange values, or send LinkedIn invitations to spammers, or what?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1534235406, "post_id": 51836832, "comment_id": 90627257, "body": "There is no casting in that code, so that can&#39;t possibly be a problem."}, {"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 0, "creation_date": 1534235883, "post_id": 51836832, "comment_id": 90627540, "body": "Btw you my_int_var not initialized, so what you expect to compare?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1534237215, "post_id": 51836832, "comment_id": 90628325, "body": "Make sure you understand the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.1p2\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.1.1 Boolean, characters, and integers(p2) (Integer Promotion Rules)</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1534237574, "post_id": 51836832, "comment_id": 90628546, "body": "SO post about the topic: <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">Implicit type promotion rules</a>"}], "answers": [{"comments": [{"owner": {"reputation": 563, "user_id": 7864336, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/8a2d64bf3ba8d5d7bc5d961075241343?s=128&d=identicon&r=PG&f=1", "display_name": "schanti schul", "link": "https://stackoverflow.com/users/7864336/schanti-schul"}, "edited": false, "score": 0, "creation_date": 1534238493, "post_id": 51837194, "comment_id": 90629123, "body": "thansk , can you please explain why This results in an unsigned number"}], "tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": false, "score": 4, "last_activity_date": 1534246969, "last_edit_date": 1534246969, "creation_date": 1534235971, "answer_id": 51837194, "question_id": 51836832, "link": "https://stackoverflow.com/questions/51836832/issue-with-multiplying-a-define-by-a-negative-number/51837194#51837194", "title": "issue with multiplying a define by a negative number", "body": "<p>Because of the '<em>u</em>' at the end of MY_DEFAULT_VAR value, there is an implicit conversion from signed to unsigned by the expression</p>\n\n<pre><code>-1 * MY_DEFAULT_VAR\n</code></pre>\n\n<p>This results in an unsigned number so </p>\n\n<p>the comparison is a large  unsigned number <code>0xffffffe0</code></p>\n\n<p>This now doesn't behave as expected e.g. if my_int_var was 20</p>\n\n<pre><code>if( 20 &lt; 0xffffffe0 ) { /* this would now be true */\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 7864336, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/8a2d64bf3ba8d5d7bc5d961075241343?s=128&d=identicon&r=PG&f=1", "display_name": "schanti schul", "link": "https://stackoverflow.com/users/7864336/schanti-schul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534246969, "creation_date": 1534234761, "last_edit_date": 1534235445, "question_id": 51836832, "link": "https://stackoverflow.com/questions/51836832/issue-with-multiplying-a-define-by-a-negative-number", "title": "issue with multiplying a define by a negative number", "body": "<p>I want to understand the basics of this issue.\nI suspect that something is wrong with the casting, it is occasionally entering the if statement when it is not supposed to. i read some posts but couldn't understand what is the issue exactly.\nrelevant code:</p>\n\n<pre><code>int32_t my_int_var;  // this should not be less than -20\n#define MY_DEFAULT_VAR 20u\nif(my_int_var &lt; (-1*MY_DEFAULT_VAR)){\nFailTest();\n}\n</code></pre>\n"}]