[{"tags": ["c", "bluetooth", "arm", "lpcxpresso"], "answers": [{"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1531355174, "post_id": 51295761, "comment_id": 89569042, "body": "Your code says that <code>UARTBuffer</code> is an <i>array</i> of <code>uint8_t</code>s. Do you understand how arrays work in C?"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1531374518, "post_id": 51295761, "comment_id": 89573307, "body": "You try to print an int value with %s in your printf. You need %d for an int."}], "tags": [], "owner": {"reputation": 9, "user_id": 10067551, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9fxSlt_v7j8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rcQTmh1atOv2XnYtfpe1vhgiHPkQ/mo/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/10067551/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1531354830, "creation_date": 1531354830, "answer_id": 51295761, "question_id": 51295575, "link": "https://stackoverflow.com/questions/51295575/probably-a-pointer-issue-but-not-sure-why/51295761#51295761", "title": "Probably a pointer issue but not sure why", "body": "<p>Nevermind, it was just a simple pointer issue. UARTBuffer is a external volatile uint8_t in the UART.c file, and even though it is not defined as a pointer, it is pointing to a buffer somehow.</p>\n\n<pre><code>int bVal = *UARTBuffer;\nif(bVal == '1') { \n</code></pre>\n\n<p>The above worked, but if anyone has any more in depth information that could explain why I would be interested in knowing. This is how I initialized the buffer:</p>\n\n<pre><code>extern volatile uint32_t UARTCount;\nextern volatile uint8_t UARTBuffer[BUFSIZE];\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10067551, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9fxSlt_v7j8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rcQTmh1atOv2XnYtfpe1vhgiHPkQ/mo/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/10067551/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531354830, "creation_date": 1531353063, "question_id": 51295575, "link": "https://stackoverflow.com/questions/51295575/probably-a-pointer-issue-but-not-sure-why", "title": "Probably a pointer issue but not sure why", "body": "<p>This is going to be a bit abstract due to the specific ARM (LPCXpresso 1115R/303) Cortex M0 and the H6 bluetooth module, and with NXP software there are a ton of driver files that are linked so hopefully the code snip below will be enough to identify the problem. </p>\n\n<p>I am creating a simple menu system through bluetooth. Everything works with communcation. I send the message from the board, it is visible on the phone, I respond and print the value in the console of the program. All are exactly what I want them to be. But this is what happens:</p>\n\n<p>1) start debug session and resume</p>\n\n<p>2) 1st menu sends to phone, correct. </p>\n\n<p>3) Type response to phone and send, correct.</p>\n\n<p>4) message appears in console exactly as entered from phone (Just the number 1 appears)</p>\n\n<p>5) Have if loop that checks to see if Buffer value == '1';</p>\n\n<p>6) must not == 1 because it never enters the loop. </p>\n\n<p>7) reprints the value of the buffer, and it still equals 1. </p>\n\n<p>The only hint I have is a warning that says \"makes integer from pointer without a cast [-Wint-conversion]\" on the assignment line as indicated below.</p>\n\n<pre><code>void ArmPeripheral() {\nUARTCount = 0;\nLPC_UART-&gt;IER = IER_THRE | IER_RLS; /* Disable RBR */\nUARTSend( (uint8_t *)menu1, sizeof(menu1));\nLPC_UART-&gt;IER = IER_THRE | IER_RLS | IER_RBR; /* Re-enable RBR */\n\nwhile(1) {\nif(UARTCount != 0){\n    printf(\"%s 1st print\\n\",UARTBuffer);\n    int bVal = UARTBuffer; // This is where the error occurs, tried uint8_t, did not work.\n    printf(\"%s This is bVal\\n\",bVal);\n    if(bVal == 1) {  //have tried 1, '1', and \"1\" none work\n        printf(\"inside loop %s...\\n\",UARTBuffer);\n        printf(\"%s This is bVal\\n\",bVal);\n        LEDControl();\n    }\n    printf(\"%s second print\\n\",UARTBuffer);\n    UARTCount = 0;\n}\n}\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KRhbA.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c", "unix-socket", "sendto"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1531355701, "post_id": 51295505, "comment_id": 89569140, "body": "Error code 22 is <code>EINVAL</code>. Per the <code>sendto()</code> documentation, <code>EINVAL</code> only occurs when: &quot;<i>The <code>dest_len</code> argument is not a valid length for the address family</i>&quot;, which is not the case here (since <code>getaddrinfo()</code> should always provide a valid address length).  So, short of a buffer overflow that corrupts the <code>ai_addrlen</code>, there is no other way that the <i>length</i> of <code>argv[2]</code> would cause an <code>EINVAL</code> error, especially at such low lengths that you are working with (if you were sending more data than could fit in a single UDP datagram, you would get an <code>EMSGSIZE</code> error code instead)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531363034, "post_id": 51295505, "comment_id": 89570484, "body": "suggest reading the MAN page for <code>sendto()</code>, especially this sentence: <i>If  the  message  is too long to pass atomically through the underlying        protocol, the error EMSGSIZE is returned, and the message is not transmitted.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1531363499, "post_id": 51295505, "comment_id": 89570566, "body": "have you done any debugging, like displaying the values in: <code>p-&gt;ai_family</code> <code>p-&gt;ai_socktype</code>, and                 <code>p-&gt;ai_protocol</code> to see what, exactly, what type of socket is being generated?"}, {"owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "edited": false, "score": 0, "creation_date": 1531363917, "post_id": 51295505, "comment_id": 89570651, "body": "I seem to be able to compile and run the code without any issues with both input! <code>uname -a Linux 94590e76f22f 4.13.0-1011-gcp #15-Ubuntu SMP Mon Feb 12 16:29:04 UTC 2018 x86_64 GNU&#47;Linux</code>"}, {"owner": {"reputation": 2729, "user_id": 817296, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02f2ef385624097d0fa61b64be24b17f?s=128&d=identicon&r=PG", "display_name": "Sean Bone", "link": "https://stackoverflow.com/users/817296/sean-bone"}, "edited": false, "score": 0, "creation_date": 1531388979, "post_id": 51295505, "comment_id": 89581577, "body": "Thanks for all your help! I eventually found my silly mistake. The code I was actually using was adapted from the one I sent above. It was integrated into a <code>C++</code> class and it seems <code>freeaddrinfo</code> was happening before <code>sendto</code>, invalidating <code>p</code>. But before posting the question, I reverted to the original version of the code (the one I posted), and was getting the same error. Turns out my brain wasn&#39;t on and I was using the wrong binary. <i>derp</i>"}], "answers": [{"tags": [], "owner": {"reputation": 2729, "user_id": 817296, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02f2ef385624097d0fa61b64be24b17f?s=128&d=identicon&r=PG", "display_name": "Sean Bone", "link": "https://stackoverflow.com/users/817296/sean-bone"}, "is_accepted": true, "score": 0, "last_activity_date": 1531389556, "last_edit_date": 1531389556, "creation_date": 1531388798, "answer_id": 51302373, "question_id": 51295505, "link": "https://stackoverflow.com/questions/51295505/input-dependent-error-sendto-error-code-22-invalid-argument-depending-on-in/51302373#51302373", "title": "Input-dependent error: sendto() error code 22 (Invalid argument) depending on input size", "body": "<p><code>freeaddrinfo(servinfo);</code> frees up the memory used by <code>servinfo</code>. This means that the pointer <code>p</code> is now pointing to empty memory, so when it gets passed to <code>sendto</code> it may have invalid content. My guess is that for some reason the extra byte in the input string was \"rolling over\" that memory location when the class' <code>send</code> method was being called. The fix was moving <code>freeaddrinfo(servinfo);</code> from the constructor to the destructor:</p>\n\n<pre><code>UDPTalker::UDPTalker(std::string h, std::string port) : host(h), port(port) {\n    memset(&amp;hints, 0, sizeof hints);\n    hints.ai_family = AF_UNSPEC;\n    hints.ai_socktype = SOCK_DGRAM;\n\n    if ((rv = getaddrinfo(host.c_str(), port.c_str(), &amp;hints, &amp;servinfo)) != 0) {\n        throw std::runtime_error(std::string(\"getaddrinfo: \").append(gai_strerror(rv)));\n    }\n\n    // loop through all the results and make a socket\n    for(p = servinfo; p != NULL; p = p-&gt;ai_next) {\n        if ((sockfd = socket(p-&gt;ai_family, p-&gt;ai_socktype,\n                p-&gt;ai_protocol)) == -1) {\n            perror(\"talker: socket\");\n            continue;\n        }\n\n        break;\n    }\n\n    if (p == NULL) {\n        throw std::runtime_error(\"talker: failed to create socket\\n\");\n    }\n}\n\nUDPTalker::~UDPTalker() {\n    freeaddrinfo(servinfo);\n    close(sockfd);\n}\n</code></pre>\n"}], "owner": {"reputation": 2729, "user_id": 817296, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02f2ef385624097d0fa61b64be24b17f?s=128&d=identicon&r=PG", "display_name": "Sean Bone", "link": "https://stackoverflow.com/users/817296/sean-bone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 51302373, "answer_count": 1, "score": 1, "last_activity_date": 1531389556, "creation_date": 1531352259, "last_edit_date": 1531389407, "question_id": 51295505, "link": "https://stackoverflow.com/questions/51295505/input-dependent-error-sendto-error-code-22-invalid-argument-depending-on-in", "title": "Input-dependent error: sendto() error code 22 (Invalid argument) depending on input size", "body": "<p>I'm having issues implementing a C UDP socket program. The code below works perfectly with any input shorter than 56 characters, but if I feed it 56 characters or more, <code>sendto</code> complains that I gave it invalid arguments (error code 22).\nFor instance, this will send correctly:</p>\n\n<pre><code> ./talkerDemo localhost qqqqqwwwwweeeeeqqqqqwwwwweeeeeqqqqqwwwwweeeeeqqqqqwwwww\n</code></pre>\n\n<p>But this won't:</p>\n\n<pre><code> ./talkerDemo localhost qqqqqwwwwweeeeeqqqqqwwwwweeeeeqqqqqwwwwweeeeeqqqqqwwwwwH\n</code></pre>\n\n<p>What gives?</p>\n\n<pre><code>/*\n** talker.c\n** Adapted from http://beej.us/guide/bgnet/html/single/bgnet.html#datagram\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n\n#define SERVERPORT \"4242\"    // the port users will be connecting to\n\nint main(int argc, char *argv[])\n{\n    int sockfd;\n    struct addrinfo hints, *servinfo, *p;\n    int rv;\n    int numbytes;\n\n    if (argc != 3) {\n        fprintf(stderr,\"usage: talker hostname message\\n\");\n        exit(1);\n    }\n\n    memset(&amp;hints, 0, sizeof hints);\n    hints.ai_family = AF_UNSPEC;\n    hints.ai_socktype = SOCK_DGRAM;\n\n    if ((rv = getaddrinfo(argv[1], SERVERPORT, &amp;hints, &amp;servinfo)) != 0) {\n        fprintf(stderr, \"getaddrinfo: %s\\n\", gai_strerror(rv));\n        return 1;\n    }\n\n    // loop through all the results and make a socket\n    for(p = servinfo; p != NULL; p = p-&gt;ai_next) {\n        if ((sockfd = socket(p-&gt;ai_family, p-&gt;ai_socktype,\n                p-&gt;ai_protocol)) == -1) {\n            perror(\"talker: socket\");\n            continue;\n        }\n\n        break;\n    }\n\n    if (p == NULL) {\n        fprintf(stderr, \"talker: failed to create socket\\n\");\n        return 2;\n    }\n\n\n\n//============================================================\n// !!!!!!! Eror occurs here:   \n    if ((numbytes = sendto(sockfd, argv[2], strlen(argv[2]), 0,\n             p-&gt;ai_addr, p-&gt;ai_addrlen)) == -1) {\n        perror(\"talker: sendto\");\n        exit(1);\n    }\n//============================================================\n\n    freeaddrinfo(servinfo);\n\n    printf(\"talker: sent %d bytes to %s\\n\", numbytes, argv[1]);\n    close(sockfd);\n\n    return 0;\n}\n</code></pre>\n\n<h2>EDIT</h2>\n\n<p>This was the version of the code I was <em>actually</em> running. Before posting the question, I had gone back to the original (above) to see if the problem occurred with that implementation too - and I seemed it was. But it turns out I was being thick and was using the wrong binary... <em>derp</em></p>\n\n<pre><code>/*\n** UDPTalker.hpp -- a datagram sockets \"server\"\n** Adapted from http://beej.us/guide/bgnet/html/single/bgnet.html#datagram\n*/\n\n#ifndef UDPTALKER_H\n#define UDPTALKER_H\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n\n#define UDPT_DEFAULT_PORT \"4243\"\n#define UDPT_DEFAULT_HOST \"localhost\"\n\n#define UDPT_MAXBUFLEN 2048\n\n\nclass UDPTalker {\n    int sockfd;\n    struct addrinfo hints, *servinfo, *p;\n    int rv;\n    int numbytes;\n\n    std::string host;\n    std::string port;\n\n    public:\n        //! Takes target hostname/ip and port as arguments. Defaults: (\"localhost\", \"4243\")\n        UDPTalker(std::string host = UDPT_DEFAULT_HOST, std::string port = UDPT_DEFAULT_PORT);\n\n        ~UDPTalker();\n\n        void send(std::string msg);\n};\n\n#endif // UDPTALKER_H\n</code></pre>\n\n<p>Here's the corresponding <code>.cpp</code>:</p>\n\n<pre><code>// File UDPTalker.cpp\n\n#include \"UDPTalker.hpp\"\n\nUDPTalker::UDPTalker(std::string h, std::string port) : host(h), port(port) {\n    memset(&amp;hints, 0, sizeof hints);\n    hints.ai_family = AF_UNSPEC;\n    hints.ai_socktype = SOCK_DGRAM;\n\n    if ((rv = getaddrinfo(host.c_str(), port.c_str(), &amp;hints, &amp;servinfo)) != 0) {\n        throw std::runtime_error(std::string(\"getaddrinfo: \").append(gai_strerror(rv)));\n    }\n\n    // loop through all the results and make a socket\n    for(p = servinfo; p != NULL; p = p-&gt;ai_next) {\n        if ((sockfd = socket(p-&gt;ai_family, p-&gt;ai_socktype,\n                p-&gt;ai_protocol)) == -1) {\n            perror(\"talker: socket\");\n            continue;\n        }\n\n        break;\n    }\n\n    freeaddrinfo(servinfo);\n\n    if (p == NULL) {\n        throw std::runtime_error(\"talker: failed to create socket\\n\");\n    }\n}\n\nUDPTalker::~UDPTalker() {\n    close(sockfd);\n}\n\nvoid UDPTalker::send(std::string msg) {\n\n    if ((numbytes = sendto(sockfd, msg.c_str(), msg.size(), 0,\n             p-&gt;ai_addr, p-&gt;ai_addrlen)) == -1) {\n        perror(\"talker: sendto! \");\n    }\n\n    // printf(\"talker: sent %d bytes to %s\\n\", numbytes, host.c_str());\n}\n</code></pre>\n"}, {"tags": ["c", "compilation", "arm", "elf", "shellcode"], "comments": [{"owner": {"reputation": 329, "user_id": 2288914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e8785d362a66ec4c5c8fd10c71812f0?s=128&d=identicon&r=PG", "display_name": "Yingyu YOU", "link": "https://stackoverflow.com/users/2288914/yingyu-you"}, "edited": false, "score": 0, "creation_date": 1531370194, "post_id": 51295204, "comment_id": 89571899, "body": "The <code>code</code> looks CPU instructions but why do you expect these instructions which worked on ARM CPU are still workable on an X86 CPU?"}, {"owner": {"reputation": 15, "user_id": 5993487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756e5de9094a874045ec98d78091c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "nemo bondt", "link": "https://stackoverflow.com/users/5993487/nemo-bondt"}, "reply_to_user": {"reputation": 329, "user_id": 2288914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e8785d362a66ec4c5c8fd10c71812f0?s=128&d=identicon&r=PG", "display_name": "Yingyu YOU", "link": "https://stackoverflow.com/users/2288914/yingyu-you"}, "edited": false, "score": 0, "creation_date": 1531398718, "post_id": 51295204, "comment_id": 89588069, "body": "It&#39;s actually the other way around, my code worked on an x86 cpu and I&#39;m trying to execute on an arm cpu. I realise now this couldn&#39;t work. Is there a way to convert these instructions to work on an ARM cpu?"}, {"owner": {"reputation": 329, "user_id": 2288914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e8785d362a66ec4c5c8fd10c71812f0?s=128&d=identicon&r=PG", "display_name": "Yingyu YOU", "link": "https://stackoverflow.com/users/2288914/yingyu-you"}, "edited": false, "score": 0, "creation_date": 1531412941, "post_id": 51295204, "comment_id": 89597702, "body": "I know [qemu] (<a href=\"https://www.qemu.org/\" rel=\"nofollow noreferrer\">qemu.org</a>) which is a &quot;<i>generic and open source machine emulator and virtualizer</i>&quot; but not sure if it is what you expect. Also I doubt if this is worth since the instruction code size is small, why not disassemble them and maybe (just maybe) reverse engineering to re-implement it for other CPU?"}, {"owner": {"reputation": 15, "user_id": 5993487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756e5de9094a874045ec98d78091c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "nemo bondt", "link": "https://stackoverflow.com/users/5993487/nemo-bondt"}, "reply_to_user": {"reputation": 329, "user_id": 2288914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e8785d362a66ec4c5c8fd10c71812f0?s=128&d=identicon&r=PG", "display_name": "Yingyu YOU", "link": "https://stackoverflow.com/users/2288914/yingyu-you"}, "edited": false, "score": 0, "creation_date": 1531485337, "post_id": 51295204, "comment_id": 89625432, "body": "I&#39;m not really experienced enough to reverse engineer it myself, but I eventually found some ARM shellcode for what I was trying to do. Thanks anyways!"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5993487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756e5de9094a874045ec98d78091c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "nemo bondt", "link": "https://stackoverflow.com/users/5993487/nemo-bondt"}, "edited": false, "score": 0, "creation_date": 1531924320, "post_id": 51392416, "comment_id": 89780193, "body": "Yeah thanks. When I made this post I thought x86 code could run on x64 processors so why not on ARM? I guess I&#39;m just a little stupid."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 0, "last_activity_date": 1531878555, "creation_date": 1531878555, "answer_id": 51392416, "question_id": 51295204, "link": "https://stackoverflow.com/questions/51295204/cross-compiling-shellcode-to-arm/51392416#51392416", "title": "cross compiling shellcode to arm", "body": "<blockquote>\n  <p><code>unsigned char code[] =</code>\n  <code>\"\\xbe\\xc6\\xfe\\xae\\xa9\\xd9\\xea\\xd9\\x74\\x24\\xf4\\x5b\\x31\\xc9\\xb1\"</code></p>\n</blockquote>\n\n<p>That code is <em>x86</em> machine instructions.</p>\n\n<p><em>Of course</em> they wouldn't run on an ARM processor, what <em>else</em> did you expect?</p>\n\n<p>You must find the source of that shell code (usually a tiny <code>.asm</code> file), translate that <code>.asm</code> from x86 to ARM assembly, and compile it to ARM <code>.o</code> file, and finally use <code>objdump -d</code> to get equivalent machine code for ARM.</p>\n\n<p>Now put that machine code into the <code>code</code> array, rebuild the ARM executable, and enjoy.</p>\n\n<p>P.S. You can likely find equivalent shell code for ARM, saving you some of the steps above.</p>\n"}], "owner": {"reputation": 15, "user_id": 5993487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756e5de9094a874045ec98d78091c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "nemo bondt", "link": "https://stackoverflow.com/users/5993487/nemo-bondt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 51392416, "answer_count": 1, "score": 1, "last_activity_date": 1531878555, "creation_date": 1531349553, "question_id": 51295204, "link": "https://stackoverflow.com/questions/51295204/cross-compiling-shellcode-to-arm", "title": "cross compiling shellcode to arm", "body": "<p>I am working on a project where I need to execute some shellcode on a drone running linux on a 32 bit arm processor. I can communicate with the drone via telnet with the standard busybox shell, so I can't execute many complex commands, so no compiling on the drone itself. I am able to transfer and execute a helloworld program I cross compiled with \"arm-linux-gnueabi-gcc\". Now here's the problem: when I try to do exactly the same thing with my x86 shellcode c program, I get the error <code>Illegal instruction</code> after running it on the drone.</p>\n\n<p>My c program looks as follows:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nunsigned char code[] = \n\"\\xbe\\xc6\\xfe\\xae\\xa9\\xd9\\xea\\xd9\\x74\\x24\\xf4\\x5b\\x31\\xc9\\xb1\"\n\"\\x1f\\x83\\xc3\\x04\\x31\\x73\\x11\\x03\\x73\\x11\\xe2\\x33\\x94\\xa4\\xf7\"\n\"\\x8a\\xb2\\x4e\\xe4\\xbf\\x07\\xe2\\x81\\x3d\\x38\\x62\\xdf\\xa0\\xf5\\xeb\"\n\"\\x48\\x79\\x6e\\x2c\\xde\\xbd\\x5d\\xc4\\x1d\\x3d\\xb3\\x48\\xab\\xdc\\xd9\"\n\"\\x16\\xf3\\x4e\\x4f\\x80\\x8a\\x8f\\x2c\\xe3\\x0d\\xca\\x73\\x82\\x14\\x9a\"\n\"\\x07\\x48\\x4f\\x80\\xe8\\xb2\\x8f\\x9c\\x82\\xb2\\xe5\\x19\\xda\\x50\\xc8\"\n\"\\xe8\\x11\\x16\\xae\\x2a\\xd0\\xaa\\x5a\\x8d\\x91\\xd2\\x25\\xd1\\xc5\\xdc\"\n\"\\x55\\x58\\x06\\x1d\\xbe\\x56\\x08\\x7d\\x4d\\xd6\\xf7\\x4f\\xce\\x93\\xc8\"\n\"\\x28\\xdf\\xc0\\x41\\x29\\x46\\x40\\x5d\\x1a\\x7a\\x61\\xde\\xdf\\xbd\\x01\"\n\"\\xdd\\x20\\xdc\\x49\\xe0\\xde\\x1f\\xa9\\x58\\xdf\\x1f\\xa9\\x9e\\x2d\\x9f\";\n\n\nint main(int argc, char **argv) {\n  int foo_value = 0;\n\n  int (*foo)() = (int(*)())code;\n  foo_value = foo();\n\n  printf(\"%d\\n\", foo_value);\n}\n</code></pre>\n\n<p>I have compiled this code with the command: <code>arm-linux-gnueabi-gcc -fno-stack-protector -z execstack cprogram.c -o output.elf</code>. And the \"file\" command outputs: </p>\n\n<pre><code>output.elf: ELF 32-bit LSB pie executable ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.3, for GNU/Linux 3.2.0, BuildID[sha1]=43757152cbcf40dcc6a75cf210c156332557b575, not stripped\n</code></pre>\n\n<p>Which looks normal to me. This exact same code runs fine on my 64 bit linux machine when compiled as a 32 bit executable. I have removed the x00 instructions from the shellcode, I am not sure if there are more bad characters which need to be removed. So my question is: what causes this error and what would be a way to be able to execute this code correctly on the arm processor. Thanks!</p>\n"}, {"tags": ["c", "linux", "popen", "alsa"], "comments": [{"owner": {"reputation": 761, "user_id": 7050476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c2df49356fac6994f4b447eb135c37?s=128&d=identicon&r=PG&f=1", "display_name": "afarah", "link": "https://stackoverflow.com/users/7050476/afarah"}, "edited": false, "score": 2, "creation_date": 1531349293, "post_id": 51295094, "comment_id": 89567845, "body": "Alternatively you could use a library such as SDL to play audio independently of the driver (alsa, pulse, etc)."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "edited": false, "score": 0, "creation_date": 1531773268, "post_id": 51295163, "comment_id": 89711658, "body": "I saw this in man page but the operation does not match. Even if use <code>-d 0</code> option, it terminates after wave file ends."}, {"owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "edited": false, "score": 0, "creation_date": 1531776545, "post_id": 51295163, "comment_id": 89712894, "body": "<code>The default is zero, so if this option is omitted then the arecord process will run until it is killed.</code> means recording will continue indefinitely. Not playback."}], "tags": [], "owner": {"reputation": 1718, "user_id": 2760375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25679f917da6b6f54efa1b30a0546d57?s=128&d=identicon&r=PG", "display_name": "user2760375", "link": "https://stackoverflow.com/users/2760375/user2760375"}, "is_accepted": false, "score": 0, "last_activity_date": 1531349237, "creation_date": 1531349237, "answer_id": 51295163, "question_id": 51295094, "link": "https://stackoverflow.com/questions/51295094/how-do-i-wait-for-sub-process-to-complete-in-linux/51295163#51295163", "title": "How do I wait for sub-process to complete in Linux", "body": "<p>You can look for various option of aplay from the man page <a href=\"https://linux.die.net/man/1/aplay\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>one of the option is -d which is</p>\n\n<pre><code>-d, --duration=#\nInterrupt after # seconds. A value of zero means infinity. The default is zero, so if this option is omitted then the arecord process will run until it is killed.\n</code></pre>\n\n<p>So if you know the wave file play duration you can give that number with -d.\nThere are many ways to calculate the wave file length like <a href=\"https://social.msdn.microsoft.com/Forums/windows/en-US/5a92be69-3b4e-4d92-b1d2-141ef0a50c91/how-to-calculate-duration-of-wave-file-from-its-size?forum=winforms\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 4998, "user_id": 7233423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810e59b837c9e8b352615784397db0ea?s=128&d=identicon&r=PG&f=1", "display_name": "xhienne", "link": "https://stackoverflow.com/users/7233423/xhienne"}, "is_accepted": true, "score": 2, "last_activity_date": 1531350049, "creation_date": 1531350049, "answer_id": 51295258, "question_id": 51295094, "link": "https://stackoverflow.com/questions/51295094/how-do-i-wait-for-sub-process-to-complete-in-linux/51295258#51295258", "title": "How do I wait for sub-process to complete in Linux", "body": "<p>From the <a href=\"https://linux.die.net/man/3/popen\" rel=\"nofollow noreferrer\"><code>popen</code></a> manpage:</p>\n\n<blockquote>\n  <p>The <code>pclose()</code> function waits for the associated process to terminate and returns the exit status of the command as returned by <code>wait4(2)</code>.</p>\n</blockquote>\n\n<p>If you don't want to be blocked on <code>pclose</code>, you may try <a href=\"https://stackoverflow.com/q/36673972/7233423\">non-blocking reads</a> on the pipe returned by <code>popen</code>, until you get an EOF which means the process has terminated.</p>\n"}], "owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1531370740, "accepted_answer_id": 51295258, "answer_count": 2, "score": 1, "last_activity_date": 1531350049, "creation_date": 1531348702, "question_id": 51295094, "link": "https://stackoverflow.com/questions/51295094/how-do-i-wait-for-sub-process-to-complete-in-linux", "closed_reason": "Not suitable for this site", "title": "How do I wait for sub-process to complete in Linux", "body": "<p>I need to play a wave file using <code>aplay</code>. However, my wave files are few seconds in length. So I plan to play them in loop for certain period of time. <code>aplay</code> does not seem to have loop options.  From my C file create a sub-process using <code>popen()</code>  The playback is working fine. But the difficulty is that I can't monitor when the wave file playback is completed so that I can start over. </p>\n\n<pre><code>popen(\"aplay WaveFile\",\"r\");\n</code></pre>\n\n<p>How do I know when this command has finished playback?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1531348921, "post_id": 51295030, "comment_id": 89567757, "body": "This <code>scanf(&quot;%s&quot;, &amp;item)</code> should be <code>scanf(&quot;%s&quot;, item)</code>, and delete should probably be comparing the value of a string, not the address of a char, since that will always be the same (because <code>item</code> is always at the same address)."}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "reply_to_user": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1531350803, "post_id": 51295030, "comment_id": 89568188, "body": "Got it, thanks @Tibrogargan"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1531352361, "post_id": 51295030, "comment_id": 89568537, "body": "The function <code>char delete(ListNodePtr *sPtr, char value)</code> is expecting a single character value, is this intentional? And then you are comparing its address against the structure&#39;s data which is a character pointer. This will always return false. In <code>while (currentPtr != NULL &amp;&amp; currentPtr-&gt;data != value)</code> you are comparing the value against a character pointer that may contain a single character (2 including null byte)."}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531388121, "post_id": 51295030, "comment_id": 89580995, "body": "No, it&#39;s not intentional, this list, before i upgraded it, was supposed to save a character, not a string, in each node"}], "answers": [{"comments": [{"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531350665, "post_id": 51295139, "comment_id": 89568137, "body": "Sorry, i know that my code sucks, but i&#39;m having some troubles with these arguments, also i worked on it for the whole day so i only made sure that it works now (insert function is working), i still did not clean it"}], "tags": [], "owner": {"reputation": 31, "user_id": 6745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--KOZB26Lyao/AAAAAAAAAAI/AAAAAAAAAE4/NJqyTt7OmHE/photo.jpg?sz=128", "display_name": "drew767", "link": "https://stackoverflow.com/users/6745199/drew767"}, "is_accepted": false, "score": 1, "last_activity_date": 1531349451, "last_edit_date": 1531349451, "creation_date": 1531349065, "answer_id": 51295139, "question_id": 51295030, "link": "https://stackoverflow.com/questions/51295030/deleting-a-node-from-my-dynamic-list/51295139#51295139", "title": "Deleting a node from my dynamic list", "body": "<p>You have problem using pointers\nif made special typedef for ListNodePtr which is ListNode* so use it. Why do you need ListNodePtr*? \nSo in some places you are using pointer to pointers to objects \nwhich makes your code more difficult for understanding.</p>\n\n<blockquote>\n  <p>(currentPtr != NULL &amp;&amp; currentPtr->data != value)</p>\n</blockquote>\n\n<p>and also here \"value\" is a single character and you are trying to compare it with \"data\" which is actually pointer\nyou should better use something like strcmp()</p>\n\n<p>so the problem starts higher in the declaration of function \nyou need to do no that </p>\n\n<blockquote>\n  <p>char delete(ListNodePtr* sPtr, char value)\n  but that\n  char delete(ListNodePtr* sPtr, char* value)</p>\n</blockquote>\n\n<p>and please don't use words which are used as key words in the language.\nin this case better use \"remove\" </p>\n"}, {"comments": [{"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531350581, "post_id": 51295244, "comment_id": 89568116, "body": "Right now the aim of the list is to save into a node my input word, and it does that at the moment, basically i input the string and it allocates the memory to save the world into a node, what i&#39;m trying to do now is to delete the word/string and free the memory it was using"}, {"owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "reply_to_user": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531350800, "post_id": 51295244, "comment_id": 89568187, "body": "then your <code>delete()</code> should look for strings. Start by fixing the declaration and use a <code>char *</code> as the second argument as opposed to <code>char</code>, something like this <code>void delete (ListNodePtr*, char*)</code>"}], "tags": [], "owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "is_accepted": false, "score": 1, "last_activity_date": 1531353131, "last_edit_date": 1531353131, "creation_date": 1531349929, "answer_id": 51295244, "question_id": 51295030, "link": "https://stackoverflow.com/questions/51295030/deleting-a-node-from-my-dynamic-list/51295244#51295244", "title": "Deleting a node from my dynamic list", "body": "<p>The ways you define your list, <code>insert()</code> and <code>remove()</code> are not consistent. Looking at your function declarations, <code>insert()</code> expects a <code>char *</code> as its second argument where as <code>delete()</code> is declared as <code>void delete (ListNodePtr*, char)</code>. Do you intend to store a <code>char</code> or a string as the key of your list node? </p>\n\n<p>Also, below is a very bad way of comparing (what?)</p>\n\n<pre><code>if (&amp;value == (*sPtr)-&gt;data)\n</code></pre>\n\n<p>To compare <code>char</code>, simply use <code>==</code> or <code>!=</code> operators, for string comparison, use <code>strncpy()</code>. Below is not correct</p>\n\n<pre><code> // loop to find the correct location in the list       \n      while (currentPtr != NULL &amp;&amp; value &gt; currentPtr-&gt;data) {\n</code></pre>\n\n<p>I think, you overused pointers. You <code>typedef</code> an alias for your pointer type, yet you pass your functions a <code>ListNodePtr *sPtr</code>, which is a pointer to pointer to struct listNode. And then within your functions you dereference <code>sPtr</code> to get a <code>struct *listNode</code>. Update your function declarations to accept a <code>ListNodePtr</code> as the first argument rather than a <code>ListNodePtr *</code> and remove dereferencing from the function definitions.</p>\n\n<p>I would use<code>struct *</code> instead of a <code>typedef</code>, which sometimes hides the details and makes the code a bit confusing.</p>\n"}], "owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1531353131, "creation_date": 1531348194, "question_id": 51295030, "link": "https://stackoverflow.com/questions/51295030/deleting-a-node-from-my-dynamic-list", "title": "Deleting a node from my dynamic list", "body": "<p>I created a dynamic list where each node contains a word, i created a function to delete a single node and free the memory that the node was using, my function, however, doesn't delete the node. When i type the world that it should delete, i only get \"not found\" as output, the error is in the delete function but i'm struggling to find it, could it be with the if statements that's supposed to loop through the nodes and find the one to remove?</p>\n\n<pre><code>    // Inserting and deleting nodes in a list\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// self-referential structure                       \nstruct listNode {                                      \n   char *data; // each listNode contains a character \n   struct listNode *nextPtr; // pointer to next node\n}; \ntypedef struct listNode ListNode; // synonym for struct listNode\ntypedef ListNode *ListNodePtr; // synonym for ListNode*\n\n// prototypes\nvoid insert(ListNodePtr *sPtr, char *value);\nchar delete(ListNodePtr *sPtr, char value);\nint isEmpty(ListNodePtr sPtr);\nvoid printList(ListNodePtr currentPtr);\nvoid instructions(void);\nint main(void)\n{ \n   ListNodePtr startPtr = NULL; // initially there are no nodes\n   char item[20]; // char entered by user\n   instructions(); // display the menu\n   printf(\"%s\", \"? \");\n   unsigned int choice; // user's choice\n   scanf(\"%u\", &amp;choice);\n   // loop while user does not choose 3\n   while (choice != 3) { \n      switch (choice) { \n         case 1:\n            printf(\"%s\", \"Enter a character: \");\n            scanf(\"%s\", item);\n            insert(&amp;startPtr, item); // insert item in list\n            printList(startPtr);\n            break;\n\n     case 2: // delete an element\n            // if list is not empty\n            if (!isEmpty(startPtr)) { \n               printf(\"%s\", \"Enter character to be deleted: \");\n               scanf(\"%s\", &amp;item);\n               // if character is found, remove it\n               if (delete(&amp;startPtr, *item)) { // remove item\n                  printf(\"%s deleted.\\n\", &amp;item);\n                  printList(startPtr);\n               } \n               else {\n                  printf(\"%s not found.\\n\\n\", &amp;item);\n               } \n            } \n            else {\n               puts(\"List is empty.\\n\");\n            } \n            break;\n\n         default:\n            puts(\"Invalid choice.\\n\");\n            instructions();\n            break;\n      } // end switch\n      printf(\"%s\", \"? \");\n      scanf(\"%u\", &amp;choice);\n   } \n   puts(\"End of run.\");\n} \n// display program instructions to user\nvoid instructions(void)\n{ \n   puts(\"Enter your choice:\\n\"\n      \"   1 to insert an element into the list.\\n\"\n      \"   2 to delete an element from the list.\\n\"\n      \"   3 to end.\");\n}\n\n// insert a new value into the list in sorted order\nvoid insert(ListNodePtr *sPtr, char *value)\n{ \n   ListNodePtr newPtr = malloc(sizeof(ListNode)); // create node\n\n   if (newPtr != NULL) { // is space available\n      newPtr-&gt;data= malloc(strlen(value)+1);\n      strcpy(newPtr-&gt;data, value);\n      newPtr-&gt;nextPtr = NULL; // node does not link to another node\n      ListNodePtr previousPtr = NULL;\n      ListNodePtr currentPtr = *sPtr;\n      // loop to find the correct location in the list       \n      while (currentPtr != NULL &amp;&amp; value &gt; currentPtr-&gt;data) {\n         previousPtr = currentPtr; // walk to ...               \n         currentPtr = currentPtr-&gt;nextPtr; // ... next node \n      }                                          \n      // insert new node at beginning of list\n      if (previousPtr == NULL) { \n         newPtr-&gt;nextPtr = *sPtr;\n         *sPtr = newPtr;\n      } \n      else { // insert new node between previousPtr and currentPtr\n         previousPtr-&gt;nextPtr = newPtr;\n         newPtr-&gt;nextPtr = currentPtr;\n      } \n   } \n   else {\n      printf(\"%s not inserted. No memory available.\\n\", value);\n   } \n} \n\n// delete a list element\nchar delete(ListNodePtr *sPtr, char value)\n{ \n   // delete first node if a match is found\n   if (&amp;value == (*sPtr)-&gt;data) { \n      ListNodePtr tempPtr = *sPtr; // hold onto node being removed\n      *sPtr = (*sPtr)-&gt;nextPtr; // de-thread the node\n      free(tempPtr); // free the de-threaded node\n      return value;\n   } \n   else { \n      ListNodePtr previousPtr = *sPtr;\n      ListNodePtr currentPtr = (*sPtr)-&gt;nextPtr;\n      // loop to find the correct location in the list\n      while (currentPtr != NULL &amp;&amp; currentPtr-&gt;data != value) { \n         previousPtr = currentPtr; // walk to ...  \n         currentPtr = currentPtr-&gt;nextPtr; // ... next node  \n      } \n      // delete node at currentPtr\n      if (currentPtr != NULL) { \n         ListNodePtr tempPtr = currentPtr;\n         previousPtr-&gt;nextPtr = currentPtr-&gt;nextPtr;\n         free(tempPtr);\n         return value;\n      } \n   } \n   return '\\0';\n} \n\n// return 1 if the list is empty, 0 otherwise\nint isEmpty(ListNodePtr sPtr)\n{ \n   return sPtr == NULL;\n} \n\n\n// print the list\nvoid printList(ListNodePtr currentPtr)\n{ \n   // if list is empty\n   if (isEmpty(currentPtr)) {\n      puts(\"List is empty.\\n\");\n   } \n   else { \n      puts(\"The list is:\");\n      // while not the end of the list\n      while (currentPtr != NULL) { \n         printf(\"%s --&gt; \", currentPtr-&gt;data);\n         currentPtr = currentPtr-&gt;nextPtr;   \n      } \n      puts(\"NULL\\n\");\n   } \n} \n</code></pre>\n"}, {"tags": ["c", "arm", "embedded"], "comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 3, "creation_date": 1531350534, "post_id": 51295028, "comment_id": 89568108, "body": "You should cite your source - so we might avoid it.  That code is awful, and demonstrates a lack of understanding of fundamental principles."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1531353367, "post_id": 51295028, "comment_id": 89568713, "body": "I agree this is pretty bad, I would avoid other code from this person.  It is a good idea esp with code like this to sample the function one time then use the sampled variable.  As the time can change as you are walking through this code.  Sometimes code like this is for timeouts and you want to know or show the timestamp and if you sample again you again can have a different time, so if nothing else  this should be more of a while(1)  { x=millis() then if greater or less than then break."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1531353561, "post_id": 51295028, "comment_id": 89568752, "body": "it is broken in other ways as well.  &quot;lack of understanding of fundamental principles&quot; about sums it up."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531377890, "post_id": 51295028, "comment_id": 89574675, "body": "@klutt : Not that I have published on the Internet as an example to others!  If this were Hago&#39;s own code, I&#39;d be less harsh; but this is &quot;found code&quot; that he appears to be attempting to learn from.  What is really funny/worrying is the careful comment on the arguably obvious function of millis(), but no comment on the parts that clearly need it."}, {"owner": {"reputation": 159, "user_id": 8406780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51a1f498fb7ca2426e37088e3b7d1fc?s=128&d=identicon&r=PG&f=1", "display_name": "hago", "link": "https://stackoverflow.com/users/8406780/hago"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531385740, "post_id": 51295028, "comment_id": 89579414, "body": "@Clifford, I apologize. By trying to understand the original code, I felt that something is unclear and wanted to know more about it. Thanks everyone for your valuable comments."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1531386710, "post_id": 51295028, "comment_id": 89580032, "body": "In the the code at the link you have now posted, the else block is commented out, not as you have it; the author does not explain that and passes it off as necessary complexity to deal with roll-over - he is wrong, and I am pretty sure the code is too - with or without the else."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531387256, "post_id": 51295028, "comment_id": 89580390, "body": "Note the article you linked accepts comments; you could have asked the author for an explanation."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531389546, "post_id": 51295028, "comment_id": 89581955, "body": "@Clifford Yes, I was kidding a bit. Removed that comment now. Sorry for the noise, and you&#39;re completely right."}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1531402671, "post_id": 51295028, "comment_id": 89590918, "body": "@old_timer &quot;lack of fundamental principles&quot;... which ones? While I myself am rather quick at condemning bad code, the above example is not in the only-touch-it-with-a-long-pole class IMHO. Ok, it has the flaw to hang forever for t==0 (which could be corrected cheaply) but the conditions themselves could be interpreted as a clever play with sequence points to simplify the inner loop."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1531409091, "post_id": 51295028, "comment_id": 89595306, "body": "Just agreeing with Clifford, this is basic understanding of binary math as implemented in processors.  if t ==  0, yeah thats a bug."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531486027, "post_id": 51295028, "comment_id": 89625875, "body": "I commented on the article that you have now cited, and he has since updated the article with my solution."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1531486648, "post_id": 51295028, "comment_id": 89626244, "body": "@Vroomfondel : &quot;simplify the inner loop&quot;!?  Nothing is simplified here, and there is no inner loop. The &quot;fundamental principles&quot; I referred to are modulo 2^n arithmetic, and comparison of <i>interval passed</i> not absolute time - as exemplified in my answer.  Besides, I asked the original author, and he agrees it was broken and has since fixed it."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531487310, "post_id": 51295028, "comment_id": 89626713, "body": "To be fair to the <a href=\"http://www.micromouseonline.com/2016/02/02/systick-configuration-made-easy-on-the-stm32\" rel=\"nofollow noreferrer\">original author</a>, he has fixed the code in his article, and in its context (how to use Cortex-M systick counter), I have no particular objections, and the article need not avoided it as I suggested previously."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8406780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51a1f498fb7ca2426e37088e3b7d1fc?s=128&d=identicon&r=PG&f=1", "display_name": "hago", "link": "https://stackoverflow.com/users/8406780/hago"}, "edited": false, "score": 0, "creation_date": 1531348753, "post_id": 51295085, "comment_id": 89567705, "body": "you mean outside the integer range? like above  2 ^ 32?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 159, "user_id": 8406780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51a1f498fb7ca2426e37088e3b7d1fc?s=128&d=identicon&r=PG&f=1", "display_name": "hago", "link": "https://stackoverflow.com/users/8406780/hago"}, "edited": false, "score": 0, "creation_date": 1531348807, "post_id": 51295085, "comment_id": 89567722, "body": "@hago Yes, that&#39;s what I mean."}, {"owner": {"reputation": 159, "user_id": 8406780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51a1f498fb7ca2426e37088e3b7d1fc?s=128&d=identicon&r=PG&f=1", "display_name": "hago", "link": "https://stackoverflow.com/users/8406780/hago"}, "edited": false, "score": 0, "creation_date": 1531348889, "post_id": 51295085, "comment_id": 89567748, "body": "but it looks the if condition could fail, that is start can be greater than end? how can that be possible?  The variable start is going to store always the current time and end will be the current time added to the required delay. So start can&#39;t be always greater than end is my understanding."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 3, "last_activity_date": 1531352903, "last_edit_date": 1531352903, "creation_date": 1531348624, "answer_id": 51295085, "question_id": 51295028, "link": "https://stackoverflow.com/questions/51295028/what-is-the-else-part-in-this-code-mean/51295085#51295085", "title": "What is the else part in this code mean?", "body": "<p>Note that the second while loop has <code>||</code> instead of <code>&amp;&amp;</code>. This is to handle overflow. What happens if <code>start + t</code> is a bigger number than <code>end</code> can hold? The answer is that you will get an <em>overflow</em>. When you add 1 to an unsigned integer that holds its maximum value, it overflows to 0.</p>\n\n<p>Here is a short snippet to show the effects of overflow: </p>\n\n<pre><code>uint8_t c = 255;\nuint8_t d = c+1;\nprintf(\"%d %d\", c, d);\n</code></pre>\n\n<p>This will print <code>255 0</code></p>\n\n<p>This overflow is not even an unlikely scenario in this case. The maximum value an <code>uint32_t</code> can hold is approx 4*10\u2079. That is the amount of milliseconds that passes in 46 days.</p>\n\n<p>Here is a code snippet to test it yourself:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\nint main()\n{\nuint32_t s = -2; // Initialize s to it's maximum number\n                 // minus one via overflow\nuint32_t e, t;\n    scanf(\"%d\", &amp;t);\n    e = s+t;\n    if(s&lt;e) \n        printf(\"foo\\n\");\n    else\n        printf(\"bar\\n\");\n}\n</code></pre>\n\n<p>And when I run it with different inputs:</p>\n\n<pre><code>$ ./a.out \n0\nbar\n\n$ ./a.out \n1\nfoo\n</code></pre>\n\n<p>However, the code is awful. See <a href=\"https://stackoverflow.com/a/51295210/6699433\">Cliffords answer</a> for an explanation why.</p>\n"}, {"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531350728, "post_id": 51295210, "comment_id": 89568162, "body": "As far as I can see, <code>millis</code> returns an <code>unsigned long</code> so it might be a good idea to cast it just to be on the safe side. This, on the other hand, also would be a good idea in the original code."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531351044, "post_id": 51295210, "comment_id": 89568248, "body": "@klutt : yes I originally included advice on casting (see edit history), but there is the possibility that it could return a <code>short</code> - unlikely but the permutations seemed somewhat off topic.  It is not a standard function and we have only the comment to indicate its semantics on the specific platform in question.  As it happens on ARM <code>unsigned long</code> is 32 bit in any case."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531351245, "post_id": 51295210, "comment_id": 89568300, "body": "I just thought that in the future, MAYBE an ARM unsigned long would be 64 bits, and then this (and the original code) would fail."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531351711, "post_id": 51295210, "comment_id": 89568413, "body": "@klutt - it is a fair point, on ARM64 it could be either. I had deciced to assume that <code>uint32_t</code> was chosen for type agreement with <code>millis()</code>, but given the poor quality of the original solution, that is not a given. Fixed."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531351869, "post_id": 51295210, "comment_id": 89568444, "body": "Haha, a bit overkill maybe, but better safe than sorry. However, I must point out that if millis returned a short, casting it to uint32_t would not help. Imagine a t higher than the max value of short."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531352036, "post_id": 51295210, "comment_id": 89568479, "body": "@klutt I agree which is why I originally chose to ignore the issue - until you mentioned it, but it is perhaps fair to assume that <code>uint32_t</code> was chosen for good reason.  Basically the type of <code>millis()</code> must be at least as wide as the type of <code>start</code> - not an unreasonable constraint."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1531358228, "post_id": 51295210, "comment_id": 89569590, "body": "@Clifford, removed my comments and instead posted an as usual long winded answer..."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 5, "last_activity_date": 1531351694, "last_edit_date": 1531351694, "creation_date": 1531349590, "answer_id": 51295210, "question_id": 51295028, "link": "https://stackoverflow.com/questions/51295028/what-is-the-else-part-in-this-code-mean/51295210#51295210", "title": "What is the else part in this code mean?", "body": "<p>If <code>start + t</code> caused an overflow, <code>end</code> will be less than <code>start</code>, so the <code>if</code> part deals with that, and the <code>else</code> with the \"normal\" case.</p>\n\n<p>To be honest, it would take some thinking about to determine whether it is actually correct, but it is hardly worth it since it is a somewhat over-complicated means of solving a simple problem.  All that is needed is the following:</p>\n\n<pre><code>void delay_ms( uint32_t t )\n{\n    uint32_t start = millis() ;\n\n    while( (uint32_t)millis() - start &lt; t )\n    { \n        // do nothing \n    } \n}\n</code></pre>\n\n<p>To understand how this works imagine <code>start</code> is <code>0xFFFFFFFF</code>, and <code>t</code> is <code>0x00000002</code>, after two milliseconds, <code>millis()</code> will be <code>0x00000001</code>, and <code>millis() - start</code> will be <code>2</code>.  </p>\n\n<p>The loop will terminate when <code>millis() - start == 3</code>. Arguably you might prefer <code>millis() - start &lt;= t</code>, but then the delay will be between <code>t-1</code> to <code>t</code> milliseconds rather than <em>at least</em> <code>t</code> milliseconds (<code>t</code> to <code>t+1</code>).  Your choice, but the point is that you should compare calculate and compare <em>time periods</em> rather then trying to compare the absolute timestamp values - much simpler.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1531403620, "post_id": 51296082, "comment_id": 89591621, "body": "What are you on about two&#39;s complement for? The code uses uint32_t and there&#39;s no implicit promotions to signed type. Two&#39;s complement is therefore completely irrelevant here, as no signed numbers exist in the code. Also, every raw timer/rtc counter I have ever seen in a microcontroller rolls over from 2^16 to 0 or 2^32 to 0, without caring the slightest about signed number representations."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1531408993, "post_id": 51296082, "comment_id": 89595250, "body": "twos complement is what makes the math work when wrapping around all ones to all zeros and vice versa.  the subtraction works if you clip the numbers, all part of the magic of twos complement."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1531409032, "post_id": 51296082, "comment_id": 89595269, "body": "logic in the processor for addition and subtraction is based on twos complement math, a subtraction is implemented using an adder, based on twos complement math."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1531414474, "post_id": 51296082, "comment_id": 89598471, "body": "if you dont want it called twos complement and just simple base two math thats fine..."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1531604602, "post_id": 51296082, "comment_id": 89660505, "body": "@Lundin a high percentage of the cortex-ms have a 24 bit systick timer (if they have one compiled in basically).  Have you not tried a cortex-m based mcu?"}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 2, "last_activity_date": 1531358104, "creation_date": 1531358104, "answer_id": 51296082, "question_id": 51295028, "link": "https://stackoverflow.com/questions/51295028/what-is-the-else-part-in-this-code-mean/51296082#51296082", "title": "What is the else part in this code mean?", "body": "<p>This code is trying to deal with the rollover.  Take an 8 bit counter/timer counts up lets say from 0x00 to 0xFF then rolls over to 0x00 again.  If I want to use this timer to wait 16 timer ticks (0x10) (using polling) and when I start that delay the timer is at 0x1B, then I want to wait for 0x1B+0x10 = 0x2B.<br>\nStart = 0x1B, end = 0x2B, for the values 0x1B, 0x1C 0x1D...0x29, 0x2A we want to delay, start is less than end so there is no counter rollover in this code so long as t is not larger than the timer which it cant be we assume based on this code, so:</p>\n\n<pre><code>while((now&gt;=start)&amp;&amp;(now&lt;end)) continue;\n</code></pre>\n\n<p>Where now is sampled in that loop (while((millis()>=start).</p>\n\n<p>As you pointed out, lets say</p>\n\n<p>start = 0xF5, all the variables are the same size, 32 bits, mine they\nare all 8 for this demonstration so 0xF5 + 0x10 = 0x05, end = 0x05  so we want to delay while now is 0xF5, 0xF6, 0xF7, 0xF8...0xFF 0x00 0x01 0x02 0x03 0x04.  So we we have to split cases we have to cover, now >= start to cover the 0xF5 to 0xFF and now\n\n<p>while((now>=start)||(now\n\n<p>But as Clifford has pointed out, fundamental programming knowledge, some of the magic of twos complement the now being the first number (0xFD to 0x05):</p>\n\n<pre><code>(0xFD - 0xF5) &amp; 0xFF = 0x08\n(0xFE - 0xF5) &amp; 0xFF = 0x09\n(0xFF - 0xF5) &amp; 0xFF = 0x0A\n(0x00 - 0xF5) &amp; 0xFF = 0x0B\n(0x01 - 0xF5) &amp; 0xFF = 0x0C\n(0x02 - 0xF5) &amp; 0xFF = 0x0D\n(0x03 - 0xF5) &amp; 0xFF = 0x0E\n(0x04 - 0xF5) &amp; 0xFF = 0x0F\n(0x05 - 0xF5) &amp; 0xFF = 0x10\n</code></pre>\n\n<p>Works perfect, we just need to subtract now - start for an up counter and mask the math to the size of the counter and/or variables whichever is smaller</p>\n\n<p>while(((now-start)&amp;0xFF)\n\n<p>For a downcounter use start - now.</p>\n\n<p>The author of that code was trying to deal with the rollover without understanding twos complement.  Back in the day before I learned this my code was even worse I was probably computing the math for the number of counts before the rollover then the number of counts after, whatever didnt last long I convinced myself that the rollover math works so long as you mask it right.</p>\n\n<p>NOW SAYING THAT</p>\n\n<p>If your timer does NOT rollover between all ones to all zeros or all zeros to all ones, which many microcontroller timers can be programmed to do and you are not using the timers features completely then the above wont work.  If you have an 8 bit timer and it counts from 0x00 to 0x53 then rolls over to 0x00, because that is how you set it for some reason, or you are re-using a timer that you have set for a periodic interrupt as a polled timer,  then you have to do in a better way, what the author of that code did:</p>\n\n<p>while(now&lt;0x53) continue;\nwhile(now>end) continue;</p>\n\n<p>sampling now each loop.</p>\n\n<p>But the math for end does not roll over naturally you have to compute end as</p>\n\n<pre><code>end = start + t; \nif(end&gt;0x53) end = end - 0x54;\n</code></pre>\n\n<p>In that case though one would have to wonder why you are using a timer like that for polled timeouts, use a timer that counts all the bits and rolls over for polled timeouts use a timer that counts to N or counts to zero from N for regular periodic interrupts or can poll those as well, but in that case you are not doing generic delays necessarily....well...you could...set the timer to one millisecond, then count the rollover flags until you get to t.  Easier than the now - start math. and can count as high as you want.    </p>\n\n<p>Millis() puts an abstraction layer between you and the timer though and we assume that millis rolls over from all ones to all zeros.</p>\n\n<p>if you have a timer that counts from 0x00000000 to 0x55555555 for example and rolls over you also cannot clip it to try to get this math to work</p>\n\n<pre><code>while(((start-now)&amp;0xFFFF)&lt;t) continue;\n</code></pre>\n\n<p>that wont work because there is a point where 0xXXXX5555 rolls to 0xXXXX0000 giving you a short count that one time.</p>\n\n<p>This shortcut of while(((start-now)&amp;mask)\n\n<p>Otherwise you have to do something like the code you found with some modifications.</p>\n\n<p>I also recommend as a habit not to sample the timer multiple times.  I have seen this bug all to often:</p>\n\n<pre><code>while((timer()-start)&lt;timeout)\n{\n    if(read_register(n)&amp;0x10) break;\n}\nif((timer()-start)&gt;=timeout)\n{\n   printf(\"Timed out\\n\");\n   return 1;\n} \nreturn 0;\n</code></pre>\n\n<p>Perhaps because the same coworker would implement it over and over again...</p>\n\n<p>You want to sample the timer once for both use cases, if you re-sample it later\nit may result in a different time.  The condition may have passed within the timeout but then re-sampling the timer now times out.</p>\n\n<p>instead something like</p>\n\n<pre><code>while(1)\n{\n   delta=timer()-start;\n   if(delta&gt;t) break;\n   if(register_read(n)&amp;0x10) break;\n}\nif(delta&gt;t) \n{\n   printf(...\n   return 1;\n}\nreturn 0;\n</code></pre>\n\n<p>For the same reason you cant necessarily go back and read the register again to see if it was the reason why the loop was broken.  Depends on that register.</p>\n\n<p>And yes some folks may hate the coding style here, and consider that a bug too, point was minimize the number of times you sample the timer if you are re-using that timestamp more than once, in the case of the code you posted as written it is okay as C is supposed to evaluate left to right</p>\n\n<pre><code>millis() &gt;= start\nthen\nmillis() &lt; end\n</code></pre>\n\n<p>had it been written</p>\n\n<pre><code> while ((millis() &lt; end) &amp;&amp; (millis() &gt;= start))\n while ((millis() &lt; end) || (millis() &gt;= start)) \n</code></pre>\n\n<p>for start\n\n<p>for the start>end case if the first read is less than end and it increments so it\nis equal to or larger than end for the second read to compare to start, then same\ndeal you have to loop again to catch millis() not less than end.</p>\n\n<p>So it is an extra sample but works fine.  The code could have been simplified to </p>\n\n<pre><code>if(start&lt;end)\n{\n   while(millis()&lt;end) continue;\n}\nelse\n{\n   while(millis()&gt;=start) continue;\n   while(millis()&lt;end) continue;\n}\n</code></pre>\n\n<p>sampling once per loop.</p>\n\n<p>And also note this kind of polled timer only works if you are for the most part outrunning the timer with your polling loop, you dont have interrupts that take a long time to bump you another rollover of the timer.  If you are not sampling that fast, then you might want to put a limit on the size of t, make it so it cant be more than half the number of bits in the timer.  How much you should limit it depends on how fast you can sample this thing.</p>\n\n<p>Polled time loops should only be used for at that time or greater, if you want to time a specific amount of time the delay may run long unless you are careful, if you have interrupts or other things you may run long, maybe very long.  So if you want to time say at least 10ms but 100ms now and again is okay, like bit banging i2c or spi, thats fine.  But if you are trying to bit bang a uart a polled timer might not be the best way to go, depends on your system design.</p>\n"}], "owner": {"reputation": 159, "user_id": 8406780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51a1f498fb7ca2426e37088e3b7d1fc?s=128&d=identicon&r=PG&f=1", "display_name": "hago", "link": "https://stackoverflow.com/users/8406780/hago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1531486528, "creation_date": 1531348180, "last_edit_date": 1531486528, "question_id": 51295028, "link": "https://stackoverflow.com/questions/51295028/what-is-the-else-part-in-this-code-mean", "title": "What is the else part in this code mean?", "body": "<p>I was browsing some embedded programming link \n<a href=\"http://www.micromouseonline.com/2016/02/02/systick-configuration-made-easy-on-the-stm32/\" rel=\"nofollow noreferrer\" title=\"here\">http://www.micromouseonline.com/2016/02/02/systick-configuration-made-easy-on-the-stm32/</a> </p>\n\n<p><em><sub>[Note that the author of the code at the above link has since updated the code, and the <code>delay_ms()</code> implementation in the article no longer uses the solution shown below.]</sub></em></p>\n\n<p>and ended up with this following code. This is for ARM architecture but basically this is a function which will cause a delay of certain milliseconds passed as a parameter. So I could understand the if condition but why is the else condition necessary here? can someone please explain it to me?</p>\n\n<pre><code>void delay_ms (uint32_t t)\n{\n  uint32_t start, end;\n  start = millis();//This millis function will return the system clock in \n                   //milliseconds\n  end = start + t;\n  if (start &lt; end) {\n     while ((millis() &gt;= start) &amp;&amp; (millis() &lt; end))\n     { // do nothing } \n  }\n else{\n     while ((millis() &gt;= start) || (millis() &lt; end)) \n     {\n      // do nothing\n    };\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "function-pointers"], "comments": [{"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 1, "creation_date": 1531347762, "post_id": 51294855, "comment_id": 89567472, "body": "using function pointer inside a struct  its a common practice in C, you can look here <a href=\"https://elixir.bootlin.com/linux/v4.8/source/include/linux/input.h#L121\" rel=\"nofollow noreferrer\">elixir.bootlin.com/linux/v4.8/source/include/linux/input.h#L&zwnj;&#8203;121</a> at struct input_dev for example"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1531348751, "post_id": 51294855, "comment_id": 89567701, "body": "This is essentially the way to do in C what OO languages do automatically with the <code>this</code> parameter."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1531349199, "last_edit_date": 1531349199, "creation_date": 1531347626, "answer_id": 51294944, "question_id": 51294855, "link": "https://stackoverflow.com/questions/51294855/function-pointer-containing-the-struct-itself-as-parameter-being-inside-the-same/51294944#51294944", "title": "function pointer containing the struct itself as parameter being inside the same struct", "body": "<p>It doesn't compile on gcc, clang or tinycc, and it shouldn't.\nBefore the typedef ends, SpriteGrid is not a thing so you can't use it. Forward declaring the struct (with a tag) and the typedef should fix it.</p>\n\n<pre><code>typedef struct SpriteGrid SpriteGrid; \ntypedef struct SpriteGrid /*this typedef is redundant now*/\n{\n    int x1,y1,x2,y2;\n    int (*division_mode_x)(int i,int x1,int x2,SpriteGrid grid);\n    int (*division_mode_y)(int i,int y1,int y2);\n}SpriteGrid;\n</code></pre>\n\n<p>Alternatively, you can do</p>\n\n<pre><code>typedef struct SpriteGrid\n{\n    int x1,y1,x2,y2;\n    //without the forward typedef `SpriteGrid` isn't usable\n    //here yet, but `struct SpriteGrid` is \n    int (*division_mode_x)(int i,int x1,int x2,struct SpriteGrid grid);\n    int (*division_mode_y)(int i,int y1,int y2);\n}SpriteGrid;\n</code></pre>\n\n<p>relying on the fact that a tag becomes usable immediately after <code>struct tag</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 3914044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a386d5ebf09ded319beaee0ccfed15?s=128&d=identicon&r=PG&f=1", "display_name": "newbie_developer93", "link": "https://stackoverflow.com/users/3914044/newbie-developer93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 51294944, "answer_count": 1, "score": 0, "last_activity_date": 1531622806, "creation_date": 1531346998, "last_edit_date": 1531622806, "question_id": 51294855, "link": "https://stackoverflow.com/questions/51294855/function-pointer-containing-the-struct-itself-as-parameter-being-inside-the-same", "title": "function pointer containing the struct itself as parameter being inside the same struct", "body": "<pre><code>typedef struct\n{\n    int x1,y1,x2,y2;\n    int (*division_mode_x)(int i,int x1,int x2,SpriteGrid grid);\n    int (*division_mode_y)(int i,int y1,int y2);\n}SpriteGrid;\n</code></pre>\n\n<p>Do you think this is a valid way to use function pointers inside struct?\n<br><strong>Note :</strong> Please don't say try and see it for yourself. There is no problem with compilation. I just wanna know if this is a standard property of the C language. Will it also compile in other compilers?</p>\n"}, {"tags": ["c", "arrays", "file", "loops"], "comments": [{"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 1, "creation_date": 1531347537, "post_id": 51294693, "comment_id": 89567395, "body": "Calling realloc at every single iteration of your loop is catastrophic, performance-wise."}, {"owner": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1531348383, "post_id": 51294693, "comment_id": 89567612, "body": "@spectras Would you recommend to count the lines I&#39;m going to insert into the array, and do a <code>calloc</code> just once, instead of doing <code>realloc</code> multiple times?"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1531349101, "post_id": 51294693, "comment_id": 89567792, "body": "(1) <code>sizeof char</code> is always 1 by definition. (2) In the statement <code>strcpy (temp, strarray [i])</code> the pointer <code>strarray [0]</code> points to an uninitialized string; this is undefined behavior. You want to add a <code>fgets()</code> before this statement. (3) The normal pattern is to start with an array of some initial capacity, and when it fills up allocate some more capacity in chunks, not one by one. (4) The code believes that text lines never have more than <code>STRLEN</code> characters; good text editor don&#39;t make such assumptions. (5) You want to move the <code>fgets()</code> from the beginning to the end of the <code>while</code> loop."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1531349730, "post_id": 51294693, "comment_id": 89567940, "body": "@riciloma or change your reallocation to grow the array geometrically."}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "edited": false, "score": 0, "creation_date": 1531358696, "post_id": 51295414, "comment_id": 89569659, "body": "It may be not elegant to read a file twice. Just increase the size of array as needed will be better? <code>new_size = old_size * 2</code> or <code>new_size = old_size * 3 &#47; 2</code> ."}], "tags": [], "owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1531351451, "creation_date": 1531351451, "answer_id": 51295414, "question_id": 51294693, "link": "https://stackoverflow.com/questions/51294693/elegant-way-to-store-text-file-data-in-a-dynamic-array-of-strings/51295414#51295414", "title": "Elegant way to store text file data in a dynamic array of strings", "body": "<p>As you read from file you can count size for your array and later don't use realloc at all. It can be done in such way:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\n#define BUFFSIZE 1024\n\nint get_size(void)\n{\n        int  nlines  = 0;\n        char line[BUFFSIZE];\n        FILE *fptr = fopen(\"t1.txt\",\"r\");\n\n        while(fgets(line, BUFFSIZE, fptr) != NULL) {\n            nlines++;\n        }\n\n        fclose(fptr);\n        return nlines;\n}\n\nchar **init(int size)\n{\n        int i;\n        char **tmp;\n\n        tmp = malloc(sizeof(char*) * (size + 1)); //array of strings\n\n        for(i = 0; i &lt; size; ++i)\n            tmp[i] = malloc(sizeof(char) * (BUFFSIZE + 1));\n        tmp[i] = NULL;\n\n        return tmp;\n}\n\nint main(void)\n{\n        char *temp;\n        char **strArray;\n        int pos = 0;\n        int size = 0;\n        ssize_t tmp_size;\n        FILE *fptr;\n\n        strArray = init(get_size());\n\n        fptr = fopen(\"t1.txt\", \"r\");\n        do {\n            if (getline(&amp;temp, &amp;tmp_size, fptr) == -1) {\n                free(temp);\n                break;\n            }\n\n            temp[strcspn(temp, \"\\n\")] = 0;\n            strcpy(strArray[pos++], temp);\n        } while (strcmp(temp, \"stop\"));\n\n        fclose(fptr);\n        printf(\"%s\\n\", strArray[0]);\n        printf(\"%s\\n\", strArray[1]);\n\n        return 0;\n}\n</code></pre>\n\n<p>my text file content is: </p>\n\n<pre><code>hello\nworld\nstop\nearth\nbye\n</code></pre>\n\n<p>And output is:</p>\n\n<pre><code>hello\nworld\n</code></pre>\n\n<p>Of course is an example and it should optimized to your need (error checking, free memory etc) I leave it up to you. </p>\n"}], "owner": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531351451, "creation_date": 1531346087, "question_id": 51294693, "link": "https://stackoverflow.com/questions/51294693/elegant-way-to-store-text-file-data-in-a-dynamic-array-of-strings", "title": "Elegant way to store text file data in a dynamic array of strings", "body": "<p>I'm building a file text parser, with strings formatted in a certain way. They all end with a <code>\\n</code> char.</p>\n\n<p>I need to build an array of strings that contains every line. I want to make the most dynamic possible, with the least use of variables, so there won't be an initial size for the dynamic array, but it's going to be expanded with a <code>realloc</code>.</p>\n\n<p>My problem is that I need to <em>stop whenever I read a certain 'stop' string from the file</em>, and I don't know exactly where to place this check, or how to do it in the most elegant way.\nThis is what I thought about:</p>\n\n<pre><code>char * temp = malloc(STRLEN * sizeof(char)); //temporary string\nint i = 0, size = 1; //i=strArray pointer, size=strArray size\nchar ** strArray = malloc(size * sizeof(char*)); //array of strings\nstrArray[i] = (char *)malloc(STRLEN+1);\nstrcpy(temp ,strArray[i]);\nwhile(strcmp(temp,\"stop\\n\")!=0)\n{\n    fgets(temp,STRLEN,fp);\n    strcpy(trArray[i],temp);\n    i++;\n    size++;\n    trArray = realloc(trArray, size * sizeof(char*));\n    trArray[i] = (char *)malloc(STRLEN+1);\n}\n</code></pre>\n\n<p>My concerns with this algorithm are two:</p>\n\n<ol>\n<li>I need to use a temporary <code>temp</code> string and then copying the content with <code>strcpy</code></li>\n<li>At the end of the while, I still have saved 'stop', which I don't want to, and allocated one more space.</li>\n</ol>\n\n<p>Basically <strong>my problem is that I don't know how to proper iterate this array.\nWhat am I doing wrong, and what can I improve?</strong></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531343630, "post_id": 51294223, "comment_id": 89565989, "body": "The debugger has the answer."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 6, "creation_date": 1531343803, "post_id": 51294223, "comment_id": 89566070, "body": "doesn&#39;t look like <code>t</code> is ever initialized."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1531343983, "post_id": 51294223, "comment_id": 89566145, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show the input, the expected output, and the actual output as text <i>in the question</i>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531344276, "post_id": 51294223, "comment_id": 89566250, "body": "<code>char temp[MAXLINE];</code> was not nul-terminated before passing to your home-brew <code>copy</code> which relies on that."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531345007, "post_id": 51294223, "comment_id": 89566535, "body": "@WeatherVane <code>copy()</code> doesn&#39;t require the destination string to be null-terminated, only the source string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345211, "post_id": 51294223, "comment_id": 89566606, "body": "<code>mush</code> never removes anything from the string. When it sees a duplicate it prints a message, but it still copies it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345282, "post_id": 51294223, "comment_id": 89566636, "body": "Not initializing <code>t = 0;</code> is almost certainly the problem. You&#39;re writing outside the array boundary and causing undefined behavior."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345341, "post_id": 51294223, "comment_id": 89566662, "body": "@Barmar i was talking about the <code>copy(s1, temp);</code>, not the earlier <code>copy(temp, s1);</code> and the unterminated <code>temp</code> is the source not the destination."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531345466, "post_id": 51294223, "comment_id": 89566698, "body": "@WeatherVane Didn&#39;t notice that, but the program never gets there."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345524, "post_id": 51294223, "comment_id": 89566721, "body": "<code>temp</code> is terminated by the first <code>copy()</code>. The <code>for</code> loop will not write past the null terminator (if <code>t</code> is properly initialized) so it will still be null-terminated."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345658, "post_id": 51294223, "comment_id": 89566767, "body": "What&#39;s the point of calling <code>copy(temp, s1)</code> before the <code>for</code> loop? The loop also copies from <code>s1</code> to <code>temp</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345820, "post_id": 51294223, "comment_id": 89566836, "body": "@Barmar I see little point to most of this code. Not sure what it is supposed to be doing. It <i>looks</i> like an attempted unit test for <code>copy</code>, a homegrown <code>strcpy</code>, but hard to say. I suspect three is more on the way. The name suggests some element stripping will be in play sometime in the future (&quot;strip all spaces, blah blah...&quot;)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345951, "post_id": 51294223, "comment_id": 89566883, "body": "Yeah, it clearly doesn&#39;t meet <b>The purpose of mush is to delete characters in string 1 that match string 2.</b>"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345614, "post_id": 51294598, "comment_id": 89566754, "body": "With your fix, there isn&#39;t even any reason to have separate <code>i</code> and <code>t</code> variables, since they&#39;re always the same."}, {"owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531345751, "post_id": 51294598, "comment_id": 89566799, "body": "Just wanted to keep the code as similar as the OP. Lots of changes (such as using a for loop for copy()) can be done."}], "tags": [], "owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "is_accepted": true, "score": 2, "last_activity_date": 1531345437, "creation_date": 1531345437, "answer_id": 51294598, "question_id": 51294223, "link": "https://stackoverflow.com/questions/51294223/why-do-programs-close-before-completion-during-for-loops-why-did-mine/51294598#51294598", "title": "Why do programs close before completion during for loops? Why did mine?", "body": "<p>There a few points that need to be looked at</p>\n\n<p>1 ) you did not initialize the variable <code>t</code> used in the for loop. It has a garbage value.</p>\n\n<p>2 ) the increment of <code>t</code> does not depend on any condition, so better to move it in to the for loop's increment part</p>\n\n<p>Below is a working copy of your code with some modifications for styling</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXLINE 1000\n\nvoid copy(char to[], char from[])\n    {\n        int i;\n        i = 0;\n        while ((to[i] = from[i]) != '\\0')\n            ++i;\n    }\n\nvoid mush(char s1[],char s2[]) {\n    char temp[MAXLINE]; \n    int i, t; \n\n    copy(temp, s1);\n    printf(\"String One: %s\\nString Temp: %s\\n\" , s1, temp);\n    printf(\"Temp Before: %s\\n\", temp);\n\n\n    for (i = 0, t = 0; (s1[i] != '\\0') &amp;&amp; (s1[i] != '\\n'); i++, t++) {\n        if (s1[i] == s2[i]) {printf(\"s1 = s2 (%c %c)\\n\", s1[i], s2[i]);}\n\n        temp[t] = s1[i];\n        printf(\"loop:\\n\");\n\n    }\n    printf(\"Still running\\n\");\n    copy(s1, temp);\n}\n\nint main(void) {\n  char s1[]=\"this is a test\";\n  char s2[60];\n\n  mush(s1,s2);\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6373297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85f21da512b5a5443f293612c3853c4?s=128&d=identicon&r=PG&f=1", "display_name": "George Allen", "link": "https://stackoverflow.com/users/6373297/george-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 51294598, "answer_count": 1, "score": -2, "last_activity_date": 1531345437, "creation_date": 1531343525, "question_id": 51294223, "link": "https://stackoverflow.com/questions/51294223/why-do-programs-close-before-completion-during-for-loops-why-did-mine", "title": "Why do programs close before completion during for loops? Why did mine?", "body": "<p>The Program stops after the for loop in the function mush is ran. The code compiles in minGW without errors. When ran the program never prints \"still running\". How is this possible? The purpose of mush is to delete characters in string 1 that match string 2. </p>\n\n<pre><code>void copy(char to[], char from[])\n    {\n        int i;\n        i = 0;\n        while ((to[i] = from[i]) != '\\0')\n            ++i;\n    }\n\nvoid mush(char s1[],char s2[]) {\n    char temp[MAXLINE]; \n    int i, t; \n\n    copy(temp, s1);\n    printf(\"String One: %sString Temp: %s\" , s1, temp);\n    printf(\"Temp Before: %s\", temp);\n\n\n    for (i = 0; (s1[i] != '\\0') &amp;&amp; (s1[i] != '\\n'); i++) {\n        if (s1[i] == s2[i]) {printf(\"s1 = s2\");}\n\n        temp[t++] = s1[i];\n        printf(\"loop:\");\n\n    }\n    printf(\"Still running\");\n    copy(s1, temp);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "openmp", "crosstool-ng"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1531384280, "post_id": 51294152, "comment_id": 89578430, "body": "Did you try to add <code>-fopenmp</code> option to <code>gcc</code>?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1531384654, "post_id": 51294152, "comment_id": 89578678, "body": "When building crosstool-ng, did you enable openmp? (<code>.&#47;configure --enable-libgomp</code>) see: <a href=\"https://stackoverflow.com/a/49023600/1212012\">stackoverflow.com/a/49023600/1212012</a>"}, {"owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1531415824, "post_id": 51294152, "comment_id": 89599072, "body": "@purplepsycho I tried compiling my program with -fopenmp, yes. It seems the issue is the configure for crosstool-ng, I didn&#39;t enable openmp... Do I need to re-compile everything from scratch?"}, {"owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1531416169, "post_id": 51294152, "comment_id": 89599245, "body": "<code>--enable-libgomp</code> doesn&#39;t work for me: <code>configure: WARNING: unrecognized options: --enable-libgomp</code>"}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "is_accepted": true, "score": 2, "last_activity_date": 1531423198, "creation_date": 1531423198, "answer_id": 51313006, "question_id": 51294152, "link": "https://stackoverflow.com/questions/51294152/fatal-error-omp-h-no-such-file-or-directory-using-arm-unknown-linux-uclibcgnue/51313006#51313006", "title": "fatal error: omp.h: No such file or directory using arm-unknown-linux-uclibcgnueabi (crosstool-ng)", "body": "<p>Solution:</p>\n\n<p><code>./ct-ng arm-unknown-linux-uclibcgnueabi</code></p>\n\n<p><code>./ct-ng menuconfig -&gt; C compiler -&gt; Compile libgomp</code> (enable pressing &lt; y >). Save changes.</p>\n\n<p><code>./ct-ng build</code></p>\n\n<p>This will enable the <code>LIBGOMP</code> option in the <code>.config</code> file:</p>\n\n<pre><code>tomas@ubuntu:~/crosstool-ng$ grep LIBGOMP .config*\n.config:CT_CC_GCC_LIBGOMP=y\n.config.old:# CT_CC_GCC_LIBGOMP is not set\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 51313006, "answer_count": 1, "score": 0, "last_activity_date": 1531423198, "creation_date": 1531343144, "question_id": 51294152, "link": "https://stackoverflow.com/questions/51294152/fatal-error-omp-h-no-such-file-or-directory-using-arm-unknown-linux-uclibcgnue", "title": "fatal error: omp.h: No such file or directory using arm-unknown-linux-uclibcgnueabi (crosstool-ng)", "body": "<p>It seems that any gcc created with crosstool-ng is missing omp.h, is there a way to solve this issue?</p>\n\n<pre><code>tomas@ubuntu:~/eHHAlgorithm/infoli_static$ /home/tomas/x-tools/arm-unknown-linux-uclibcgnueabi/bin/arm-unknown-linux-uclibcgnueabi-gcc infoli.c main.c -o infoli_arm_ns100_ss10_noout_nobench -lm -O3 -DNETWORK_SIZE=100 -DSIMULATION_STEPS=10 -DNO_OUTPUT -DNO_BENCH -static\ninfoli.c:3:10: fatal error: omp.h: No such file or directory\n #include &lt;omp.h&gt;\n          ^~~~~~~\ncompilation terminated.\n</code></pre>\n\n<p>If I use <code>arm-linux-gnueabi-gcc</code>, which I installed with apt-get directly in Ubuntu I don't get this error.</p>\n"}, {"tags": ["java", "c++", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 4665, "user_id": 6383857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPDaW.jpg?s=128&g=1", "display_name": "StaticBeagle", "link": "https://stackoverflow.com/users/6383857/staticbeagle"}, "edited": false, "score": 0, "creation_date": 1531344692, "post_id": 51293928, "comment_id": 89566409, "body": "<i>Hint</i> Does <code>void GetName(char[] s) { s[0] = &#39;T&#39;; s[1] = &#39;e&#39;; s[2] = &#39;s&#39;; s[3] = &#39;t&#39;;}</code> work ?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1531344957, "post_id": 51293928, "comment_id": 89566518, "body": "I got a problem with this.  You can&#39;t pass by reference in the C language.  The C language passes by value or you can pass a pointer.  In C++, you can pass by value, reference or pointer.  Please update language tags accordingly.  Also, edit your post because there is no language &quot;C/C++&quot;."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1531566588, "post_id": 51293928, "comment_id": 89650223, "body": "This is what GetName does: takes a value for s, discards it by assigning s a new value and then discards that by returning. It has no effect. A really good compiler/static analysis tool might tell you these things. (General practice: don&#39;t replace values in parameter variables [except for minor tweaks to prep for algorithms].) See the answer for ways to do what you need."}], "answers": [{"tags": [], "owner": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "is_accepted": false, "score": 6, "last_activity_date": 1531342191, "creation_date": 1531342191, "answer_id": 51293972, "question_id": 51293928, "link": "https://stackoverflow.com/questions/51293928/pass-parameter-from-c-c-jni-to-java-and-get-modified-value/51293972#51293972", "title": "Pass parameter from C/C++ JNI to Java and get modified value", "body": "<p>Java only supports pass by value. If you want to return a reference you need to either</p>\n\n<p>a) return it</p>\n\n<pre><code>char[] getName();\n</code></pre>\n\n<p>b) Pass a mutable object to reference it</p>\n\n<pre><code>void getName(char[][] nameArray) {\n    nameArray[0] = t.toCharArray();\n}\n</code></pre>\n\n<p>c) Pass a call back</p>\n\n<pre><code>void getName(Consumer&lt;char[]&gt; listener) {\n    listener.accept(t.toCharArray());\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 98, "user_id": 312490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0329473f3b736a0bfbc06fe53594d3e?s=128&d=identicon&r=PG", "display_name": "Prashant", "link": "https://stackoverflow.com/users/312490/prashant"}, "is_accepted": false, "score": 0, "last_activity_date": 1531765614, "creation_date": 1531765614, "answer_id": 51368033, "question_id": 51293928, "link": "https://stackoverflow.com/questions/51293928/pass-parameter-from-c-c-jni-to-java-and-get-modified-value/51368033#51368033", "title": "Pass parameter from C/C++ JNI to Java and get modified value", "body": "<p>So for my scenario, I modified the declaration like below</p>\n\n<pre><code>void GetName(char[] s) to void GetName(PersonName obj)\n</code></pre>\n\n<p>So now, I am creating an object of PersonName in JNI and passing that as a parameter to the java function. Later I am using the same object to call getter methods of the PersonName class to get the values char[] RetriveName();</p>\n\n<p>I also found that using jfield also you can get the values of the class data members but then those members should be public</p>\n"}], "owner": {"reputation": 98, "user_id": 312490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0329473f3b736a0bfbc06fe53594d3e?s=128&d=identicon&r=PG", "display_name": "Prashant", "link": "https://stackoverflow.com/users/312490/prashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1531765614, "creation_date": 1531341958, "last_edit_date": 1531344079, "question_id": 51293928, "link": "https://stackoverflow.com/questions/51293928/pass-parameter-from-c-c-jni-to-java-and-get-modified-value", "title": "Pass parameter from C/C++ JNI to Java and get modified value", "body": "<p><strong>Short Question:</strong></p>\n\n<p>Passing a parameter from C++/C JNI to Java method who supposed to modify. Will the modified result available back in C/C++ JNI? Is there any way to do it? Other than return and a callback from java?</p>\n\n<p><strong>Continue if above is not clear:</strong></p>\n\n<p>Calling below function from C/C++ JNI with jcharArray. Below Java function is supposed to work on passed char array and store the final result in same. So that modified result will be available back in C/C++ JNI.</p>\n\n<p>I have java function accepting a char[] like below</p>\n\n<pre><code>void GetName(char[] s)\n{\n    String t = \"Test\";\n    // Work on t and store the result in s\n    s = t.toCharArray();\n}\n</code></pre>\n\n<p>How I can achieve this ... I am getting all the examples that are another way around like Java calling C/C++.</p>\n"}, {"tags": ["c", "glove"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 6, "creation_date": 1531342184, "post_id": 51293849, "comment_id": 89565426, "body": "You&#39;ve given no code here, so it&#39;s anyone&#39;s guess as to why it blew up."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531343700, "post_id": 51293849, "comment_id": 89566021, "body": "The code was hyperlinked but here it is again: <a href=\"https://github.com/stanfordnlp/GloVe/blob/master/src/glove.c\" rel=\"nofollow noreferrer\">github.com/stanfordnlp/GloVe/blob/master/src/glove.c</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1531344823, "post_id": 51293849, "comment_id": 89566459, "body": "Try and keep your question self-contained. If the code is important, please include it in the question itself."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1531345365, "post_id": 51293849, "comment_id": 89566669, "body": "Obviously there is a limit to what <code>glove.c</code> can handle. As it is on github, you may want to raise an issue there. It sounds kind of too broad for SO \u2013 you do <i>not</i> want to copy the entire source over here, nor \u2013 probably \u2013 share your giga data set."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531363957, "post_id": 51293849, "comment_id": 89570662, "body": "The file <code>glove.c</code> when compiled, outputs MANY warnings about implicit conversions (I.E. the code does not cleanly compile)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531364110, "post_id": 51293849, "comment_id": 89570695, "body": "OT: for ease of readability and understanding: 1) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  2)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1531364168, "post_id": 51293849, "comment_id": 89570705, "body": "OT: when calling any of the heap allocation functions: <code>malloc</code> <code>calloc</code> <code>realloc</code> always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1531365272, "post_id": 51293849, "comment_id": 89570926, "body": "regarding: ` int num_rare_words = vocab_size &lt; 100 ? vocab_size : 100;              for (a = vocab_size - num_rare_words; a &lt; vocab_size; a++)`   the index <code>a</code> (terrible name for an index) is allowed to go all the way to <code>vocab_size</code>, but the code is only handling (properly) the (upto) the first 100 names"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1531366039, "post_id": 51293849, "comment_id": 89571067, "body": "regarding: <code>char *word = malloc(sizeof(char) * MAX_STRING_LENGTH + 1);</code>  the expressiion: <code>sizeof(char)</code> is defined in the C standard as 1.  Multiplying anything by 1 has absolutely no effect, clutters the code, etc.  Also, this is missing a check (!=NULL) of the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531366120, "post_id": 51293849, "comment_id": 89571079, "body": "What have you done to debug this code?  Please show that effort.  Suggest using a debugger, like <code>gdb</code> to find out what the code actually does (and this should have been performed before posting the question.  We don&#39;t have your data files, so it is unlikely that we can reproduce your problem"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531366599, "post_id": 51293849, "comment_id": 89571165, "body": "OT:  when a error indication is returned from a C library function, use <code>perror()</code> so both your error message AND the text reason the OS thinks the error occurred to <code>stderr</code>"}], "owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531439719, "creation_date": 1531341542, "last_edit_date": 1592644375, "question_id": 51293849, "link": "https://stackoverflow.com/questions/51293849/segmentation-fault-core-dumped-in-glove-c", "title": "Segmentation fault (core dumped) in Glove.c", "body": "<p>I'm trying to train <a href=\"https://github.com/stanfordnlp/GloVe/blob/master/src/glove.c\" rel=\"nofollow noreferrer\">Glove</a> <a href=\"https://github.com/stanfordnlp/GloVe/blob/master/src/glove.c\" rel=\"nofollow noreferrer\">https://github.com/stanfordnlp/GloVe/blob/master/src/glove.c</a> on a pretty big dataset, the newest wikidump (22G txt file). The total # of vocab that I'm training is 1.7 mil.\nEvery file (shuffle, cooccur, vocab_count) until glove runs smoothly without any memory error. (My RAM = 64G)</p>\n<p>However, when I ran glove, I'm getting &quot;Segmentation fault (core dumped)&quot;.</p>\n<pre><code>aerin@capa:~/Desktop/GloVe/build$ ./glove -input-file cooccurrence.shuf.bin -vocab-file vocab.txt -save-file glove300 -t-iter 25  -gradsq-file gradsq -verbose 2 -vector-size 300 -threads 1 -alpha 0.75 -x-max 100.0 -eta 0.05 -binary 2 -model 2\nTRAINING MODEL\nRead 1939406304 lines.\nInitializing parameters...done.\nvector size: 300\nvocab size: 1737888\nx_max: 100.000000\nalpha: 0.750000\nSegmentation fault (core dumped)\n</code></pre>\n<p>I tried with different # of threads as well: 1,2,4,8,16,32, etc. Nothing runs. Can someone please point me where to look?</p>\n<h1>Update</h1>\n<p>I cut the number of vocabulary from 1.7 million to 1 million and glove.c runs without &quot;segmentation fault&quot; error. So it is a memory error. But I would love to learn how to resolve this error and be able to train a model on the larger dataset! Any comment will be highly valued. Thanks.</p>\n"}, {"tags": ["c", "openssl", "aes", "cryptoapi"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531339565, "post_id": 51293419, "comment_id": 89564411, "body": "Does it crash during compilation?"}, {"owner": {"reputation": 25, "user_id": 10039950, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DH2ZpWnWWAs/AAAAAAAAAAI/AAAAAAAAABM/rT3pgaqKlQ4/photo.jpg?sz=128", "display_name": "TheUser", "link": "https://stackoverflow.com/users/10039950/theuser"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531339628, "post_id": 51293419, "comment_id": 89564438, "body": "No, it crashes when I run the program using the debugger."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1531339629, "post_id": 51293419, "comment_id": 89564439, "body": "If Portuguese is more convenient for you don&#39;t forget there&#39;s <a href=\"https://pt.stackoverflow.com\">Stack Overflow em Portugu&#234;s</a>."}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1531341333, "post_id": 51293419, "comment_id": 89565103, "body": "What is the crash? What line, what signal, and what stack trace?"}], "answers": [{"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": false, "score": 1, "last_activity_date": 1531342345, "creation_date": 1531342345, "answer_id": 51294005, "question_id": 51293419, "link": "https://stackoverflow.com/questions/51293419/aes128-with-cryptoapi/51294005#51294005", "title": "AES128 with CryptoAPI", "body": "<p>I suspect your crash is coming here:</p>\n\n<pre><code>return std::string(reinterpret_cast&lt;char*&gt;(chunk));\n</code></pre>\n\n<p><code>chunk</code> is a completely random sequence of bytes. It may have embedded nulls. It almost certainly does not end in null. This constructor requires a null-terminated sequence of characters. I suspect it's continuing to read bytes looking for a null until it hits an invalid address and crashes.</p>\n\n<p>AES-encrypted data is not a string of characters. It is a just bytes. You need to treat it as such. You can return it as a <code>vector&lt;BYTE&gt;</code> or you could use a Base64- or hex-encoding function to convert it into a human-readable string if that's what you need. Be sure to decode this string before trying to decrypt it.</p>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1531342880, "last_edit_date": 1531342880, "creation_date": 1531342569, "answer_id": 51294043, "question_id": 51293419, "link": "https://stackoverflow.com/questions/51293419/aes128-with-cryptoapi/51294043#51294043", "title": "AES128 with CryptoAPI", "body": "<p>Your calculations are off: <code>ceil((float)data.length() / BLOCK_LEN) + 1</code> is <code>2</code> for a <code>12</code>-byte input.</p>\n\n<p>But you don't need to encrypt in chunks, the crypt API can handle chunking for you. Just call it once for the entire input.</p>\n\n<p>Here's a modified version that works:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;wincrypt.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n\n#pragma comment(lib, \"crypt32.lib\")\n\n#define BLOCK_LEN 16\n\nstd::string AES128(const std::string&amp; key, const std::string&amp; data, bool enc)\n{\n    std::string result = data;\n    bool Result = false;\n    HCRYPTPROV hProv = NULL;\n    HCRYPTHASH hHash = NULL;\n    HCRYPTKEY hKey = NULL;\n    result.resize((data.length() + BLOCK_LEN - 1) &amp; ~(BLOCK_LEN - 1));\n    DWORD out_len = data.length();\n\n    do {\n        if (!CryptAcquireContextA(&amp;hProv, NULL, NULL, PROV_RSA_AES, CRYPT_VERIFYCONTEXT))\n            break;\n\n        if (!CryptCreateHash(hProv, CALG_SHA_256, 0, 0, &amp;hHash))\n            break;\n\n        if (!CryptHashData(hHash, (const BYTE*)key.c_str(), key.length(), 0))\n            break;\n\n        if (!CryptDeriveKey(hProv, CALG_AES_128, hHash, 0, &amp;hKey))\n            break;\n\n        if (enc)\n        {\n            if (!CryptEncrypt(hKey, NULL, TRUE, 0, (BYTE*)result.data(), &amp;out_len, result.length()))\n                break;\n        }\n        else\n        {\n            if (!CryptDecrypt(hKey, NULL, TRUE, 0, (BYTE*)result.data(), &amp;out_len))\n                break;\n        }\n\n        result.resize(out_len);\n        Result = true;\n    } while (false);\n\n    if (hKey)\n        CryptDestroyKey(hKey);\n    if (hHash)\n        CryptDestroyHash(hHash);\n    if (hProv)\n        CryptReleaseContext(hProv, 0);\n\n    if (!Result)\n        result = \"\";\n    return result;\n}\n\nint main()\n{\n    std::string key = \"12345\";\n    std::string data = \"aaaaaabbbbbb\";\n    std::string encdata = AES128(key, data, true);\n    std::string decdata = AES128(key, encdata, false);\n\n    printf(\"%s =&gt; %s =&gt; %s\\n\", data.c_str(), encdata.c_str(), decdata.c_str());\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10039950, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DH2ZpWnWWAs/AAAAAAAAAAI/AAAAAAAAABM/rT3pgaqKlQ4/photo.jpg?sz=128", "display_name": "TheUser", "link": "https://stackoverflow.com/users/10039950/theuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 51294043, "answer_count": 2, "score": 2, "last_activity_date": 1531343120, "creation_date": 1531339395, "last_edit_date": 1531343120, "question_id": 51293419, "link": "https://stackoverflow.com/questions/51293419/aes128-with-cryptoapi", "title": "AES128 with CryptoAPI", "body": "<p>I'm trying to encrypt strings in AES128 using CryptoAPI, but I'm not getting it for some reason. When I compile, it simply crashes the application. I believe the problem is in the calls of the <code>CryptDecrypt</code> and <code>CryptEncrypt</code> functions, as I wrote this function based on another that I found on the internet. I know nothing concrete about it, nor the way to use it.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;wincrypt.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n\n#pragma comment(lib, \"crypt32.lib\")\n\n#define BLOCK_LEN 16\n\nstd::string AES128(std::string key, std::string data, bool enc)\n{\n    bool Result = false;\n    size_t blocks = ceil((float)data.length() / BLOCK_LEN) + 1;\n    BYTE* chunk = new BYTE[blocks * BLOCK_LEN];\n    memset(chunk, 0, blocks * BLOCK_LEN);\n    memcpy(chunk, data.c_str(), data.length());\n\n    HCRYPTPROV hProv;\n    if (!CryptAcquireContextA(&amp;hProv, NULL, NULL, PROV_RSA_AES, CRYPT_VERIFYCONTEXT))\n        goto finally;\n\n    HCRYPTHASH hHash;\n    if (!CryptCreateHash(hProv, CALG_SHA_256, 0, 0, &amp;hHash))\n        goto finally;\n\n    if (!CryptHashData(hHash, (BYTE*)key.c_str(), key.length(), 0))\n        goto finally;\n\n    HCRYPTKEY hKey;\n    if (!CryptDeriveKey(hProv, CALG_AES_128, hHash, 0, &amp;hKey))\n        goto finally;\n\n    for (int i = 0; i &lt; blocks; i++)\n        switch (enc)\n        {\n        case true:\n        {\n            DWORD out_len = BLOCK_LEN;\n            if (!CryptEncrypt(hKey, NULL, i + 1 == blocks, NULL, &amp;chunk[i * BLOCK_LEN], &amp;out_len, blocks * BLOCK_LEN))\n                goto finally;\n            break;\n        }\n\n        case false:\n        {\n            DWORD out_len = BLOCK_LEN;\n            if (!CryptDecrypt(hKey, NULL, i + 1 == blocks, NULL, &amp;chunk[i * BLOCK_LEN], &amp;out_len))\n                goto finally;\n            break;\n        }\n        }\n\n    Result = true;\n    goto finally;\n\n    finally:\n    {\n        if (hProv)\n            CryptReleaseContext(hProv, 0);\n        if (hHash)\n            CryptDestroyHash(hHash);\n        if (hKey)\n            CryptDestroyKey(hKey);\n\n        if (Result)\n            return std::string(reinterpret_cast&lt;char*&gt;(chunk));\n        else\n            return \"\";\n    }\n}\n\nint main()\n{\n    std::string key = \"12345\";\n    std::string data = \"aaaaaabbbbbb\";\n    std::string encdata = AES128(key, data, true);\n    std::string decdata = AES128(key, encdata, false);\n\n    printf(\"%s =&gt; %s =&gt; %s\", data.c_str(), encdata.c_str(), decdata.c_str());\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Sorry bad English, I'm Brazilian.</p>\n"}, {"tags": ["c", "arrays", "multithreading", "primes"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1531338297, "post_id": 51293044, "comment_id": 89563863, "body": "You might consider using message queues."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531338484, "post_id": 51293044, "comment_id": 89563956, "body": "&quot;find all of its prime numbers&quot; =&gt; &quot;find all of its prime <i>factors</i>&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531338429, "post_id": 51293189, "comment_id": 89563927, "body": "I guess I should make a feature request for &quot;this other guy is writing an answer too&quot;"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1531338325, "creation_date": 1531338325, "answer_id": 51293189, "question_id": 51293044, "link": "https://stackoverflow.com/questions/51293044/passing-an-array-from-a-thread/51293189#51293189", "title": "Passing an array from a thread", "body": "<p>The array <code>test</code> in your thread function is a local variable that goes out of scope when the function returns (and the thread exits).  Returning the address of a local variable and subsequently dereferencing that address invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You need to dynamically allocate memory for the array and return that pointer:</p>\n\n<pre><code>void *prime_nums(void*m) {\n    ...\n    int *test = malloc(sizeof(int) * 3);\n    test[0] = 0;\n    test[1] = 1;\n    test[2] = 2;\n    pthread_exit(test);\n}\n</code></pre>\n\n<p>Also, the second parameter to <code>pthread_exit</code> should be the address of a <code>void *</code>:</p>\n\n<pre><code>void *rval;\nint *number\npthread_join(thread[i], &amp;rval);\nnumber = rval;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9650791, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9HG0szHVQPs/AAAAAAAAAAI/AAAAAAAACNI/qeDUKXxHXk0/photo.jpg?sz=128", "display_name": "Taylor Adams", "link": "https://stackoverflow.com/users/9650791/taylor-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 51293189, "answer_count": 1, "score": 5, "last_activity_date": 1531343341, "creation_date": 1531337761, "last_edit_date": 1531343341, "question_id": 51293044, "link": "https://stackoverflow.com/questions/51293044/passing-an-array-from-a-thread", "title": "Passing an array from a thread", "body": "<p>For school I have a multi-threaded assignment. Each thread is supposed to take a number from the console input, find all of its prime numbers, and return all those prime numbers as an array. I'm struggling with returning the array in such a way that I can display it. Here is some of my code:</p>\n\n<pre><code>    int *number;\n\n    for (int i =1; i &lt; argc; i++) {\n        pthread_create(&amp;thread[i], NULL, prime_nums, (void*)argv[i]);\n    }\n    for (int i =1; i &lt; argc; i++) {\n        pthread_join(thread[i],(void**) &amp;number);\n        printf(\"%d\\n\", *(number + 0)); //This is just to test if the variable is correct\n    }\n</code></pre>\n\n<p>...</p>\n\n<pre><code>void *prime_nums(void*m) {\n    int n = atoi(m);\n    int count = 0;\n    int f = 2;\n    int primeNumbers[MAX_PRIME];\n    /*printf(\"%d: \", n);*/\n    while (n &gt; 1 &amp;&amp; count &lt; MAX_PRIME) {\n        if (n % f == 0) {\n            primeNumbers[count++] = f;\n            n /= f;\n        }\n        else {\n            f += 1;\n        }\n    }\n    /*printf(\"\\n\");*/\n    int test[2];\n    test[0] = 0;\n    test[1] = 1;\n    test[2] = 2;\n    pthread_exit(test);\n}\n</code></pre>\n\n<p>I've already checked the array <code>primeNumbers</code> in my thread and the data within the array is correct, but I can't figure out how to save that array to another array in my main function.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8969424"}, "edited": false, "score": 0, "creation_date": 1531331251, "post_id": 51291430, "comment_id": 89560672, "body": "Please explain what errors you are seeing and what have you done so far to debug it. SO is not a debugging service. See <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question?</a>. It is also a good time to start learning about debugging techniques. Have a look at <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531331448, "post_id": 51291430, "comment_id": 89560759, "body": "I added a paragraph with all the errors i got, i debugged it"}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531331840, "post_id": 51291430, "comment_id": 89560939, "body": "I did read every comment here, and i wouldn&#39;t have posted here if i didn&#39;t try everything i could until this moment, it&#39;s just that this is my current level of programming, i know it&#39;s a complete disaster but i&#39;m trying to improve"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1531332877, "post_id": 51291430, "comment_id": 89561401, "body": "On a side note, if you are unfamiliar with pointers, it may be a good idea to make their use more explicit: try to avoid <code>typedef ListNode *ListNodePtr;</code> and use <code>ListNode *</code> (or <code>ListNode **</code>) directly."}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531333030, "post_id": 51291430, "comment_id": 89561470, "body": "Thanks, i am indeed not really familiar with pointers, so i should just follow your advice"}], "answers": [{"comments": [{"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531333566, "post_id": 51291843, "comment_id": 89561693, "body": "I did NOT change %c to %s, but it still keeps saving one character per node, instead of a string, i don&#39;t know why"}, {"owner": {"reputation": 896, "user_id": 9996322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKb7ymEsXic/AAAAAAAAAAI/AAAAAAAAAUE/PhlIctjmhPI/photo.jpg?sz=128", "display_name": "Jacob Boertjes", "link": "https://stackoverflow.com/users/9996322/jacob-boertjes"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1531333568, "post_id": 51291843, "comment_id": 89561696, "body": "@Bob__ Thanks, I missed that, have edited accordingly"}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531334272, "post_id": 51291843, "comment_id": 89562014, "body": "Thank you! One last thing: where should i put fgets(item, sizeof(item), stdin);  ?"}, {"owner": {"reputation": 896, "user_id": 9996322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKb7ymEsXic/AAAAAAAAAAI/AAAAAAAAAUE/PhlIctjmhPI/photo.jpg?sz=128", "display_name": "Jacob Boertjes", "link": "https://stackoverflow.com/users/9996322/jacob-boertjes"}, "reply_to_user": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531334363, "post_id": 51291843, "comment_id": 89562060, "body": "@Gerard22 inder <code>case 1</code> in your <code>main</code> function, the line was <code>scanf(&quot;%c&quot;, &amp;item);</code> but should instead be  <code>fgets(item, sizeof(item), stdin);</code>"}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531334536, "post_id": 51291843, "comment_id": 89562145, "body": "I got this error with fgets:  warning: passing argument 2 of \u2018insert\u2019 from incompatible pointer type [-Wincompatible-pointer-types]              insert(&amp;startPtr, &amp;item); // insert item in list"}, {"owner": {"reputation": 896, "user_id": 9996322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKb7ymEsXic/AAAAAAAAAAI/AAAAAAAAAUE/PhlIctjmhPI/photo.jpg?sz=128", "display_name": "Jacob Boertjes", "link": "https://stackoverflow.com/users/9996322/jacob-boertjes"}, "reply_to_user": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531335184, "post_id": 51291843, "comment_id": 89562458, "body": "@Gerard22 This is because you updates <code>item</code> from a <code>char</code> to a <code>char</code> array. If you change <code>insert &amp;startPtr, &amp;item);</code> to <code>insert &amp;startPtr, item);</code> it will work. If you want to know why an array behaves like a pointer (which it is in this case) check this out! <a href=\"https://stackoverflow.com/questions/4607128/in-c-are-arrays-pointers-or-used-as-pointers\" title=\"in c are arrays pointers or used as pointers\">stackoverflow.com/questions/4607128/&hellip;</a>"}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531336349, "post_id": 51291843, "comment_id": 89563012, "body": "Ok! I tried this: fgets(item, sizeof(item), stdin); / insert(&amp;startPtr, item); but still got the error! Thanks for the source, i&#39;m checking it right now."}, {"owner": {"reputation": 896, "user_id": 9996322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKb7ymEsXic/AAAAAAAAAAI/AAAAAAAAAUE/PhlIctjmhPI/photo.jpg?sz=128", "display_name": "Jacob Boertjes", "link": "https://stackoverflow.com/users/9996322/jacob-boertjes"}, "reply_to_user": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531338979, "post_id": 51291843, "comment_id": 89564173, "body": "@Gerard22 Here is a link to my version of the working code <a href=\"https://pastebin.com/qnuqvTg6\" rel=\"nofollow noreferrer\">pastebin.com/qnuqvTg6</a> Hope it helps!"}, {"owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "edited": false, "score": 0, "creation_date": 1531348325, "post_id": 51291843, "comment_id": 89567602, "body": "Of course it helps, thank you a lot for your contribution @jacob!"}], "tags": [], "owner": {"reputation": 896, "user_id": 9996322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CKb7ymEsXic/AAAAAAAAAAI/AAAAAAAAAUE/PhlIctjmhPI/photo.jpg?sz=128", "display_name": "Jacob Boertjes", "link": "https://stackoverflow.com/users/9996322/jacob-boertjes"}, "is_accepted": true, "score": 3, "last_activity_date": 1531333942, "last_edit_date": 1531333942, "creation_date": 1531332536, "answer_id": 51291843, "question_id": 51291430, "link": "https://stackoverflow.com/questions/51291430/saving-a-string-into-a-dynamic-list/51291843#51291843", "title": "Saving a string into a dynamic list", "body": "<p>To get user input you are using </p>\n\n<pre><code>scanf(\"%c\", &amp;item); \n</code></pre>\n\n<p>This will only get one character from their input. If you want to get a string, you could update <code>item</code> to be a character array:</p>\n\n<pre><code>char item[20];\n</code></pre>\n\n<p>I also believe that <code>fgets</code> is better for getting user input strings, as described <a href=\"https://stackoverflow.com/questions/3302255/c-scanf-vs-gets-vs-fgets\">here</a>. So using the following would probably make your program a bit more durable:</p>\n\n<pre><code>fgets(item, sizeof(item), stdin);\n</code></pre>\n\n<p>After these changes, here is the output:</p>\n\n<pre><code>Enter your choice:\n1 to insert an element into the list.\n2 to delete an element from the list.\n3 to end.\n? 1\nEnter a character: The list is:\n\n--&gt; NULL\n\n? Testing\nEnter a character: The list is:\n\n--&gt; Testing\n--&gt; NULL\n\n? What\nEnter a character: The list is:\n\n--&gt; Testing\n--&gt; What\n--&gt; NULL\n\n? About\nEnter a character: The list is:\n\n--&gt; Testing\n--&gt; What\n--&gt; About\n--&gt; NULL\n\n? This\nEnter a character: The list is:\n\n--&gt; Testing\n--&gt; What\n--&gt; About\n--&gt; This\n--&gt; NULL\n\n? \n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong> The following has already been addressed in the question's code.</p>\n\n<p><code>newPtr-&gt;data</code> is a <code>char</code>, however it seems you would like it to be a string. You should change the struct definition so that <code>data</code> is a <code>char *</code> instead.</p>\n\n<p>If you are trying to print a string instead of a single character, you should replace:</p>\n\n<pre><code>printf(\"%c not inserted. No memory available.\\n\", value);\n// as well as\nprintf(\"%c --&gt; \", currentPtr-&gt;data);\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>printf(\"%s not inserted. No memory available.\\n\", value);\n// and\nprintf(\"%s --&gt; \", currentPtr-&gt;data);\n</code></pre>\n\n<p>The <code>%c</code> is used for formatting a single character, but <code>%s</code> is used for printing a string, and must be matched with a <code>char *</code></p>\n"}], "owner": {"reputation": 253, "user_id": 9217311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/62d8f46918cfc7178d43c5f94d93f624?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard22", "link": "https://stackoverflow.com/users/9217311/gerard22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 51291843, "answer_count": 1, "score": 2, "last_activity_date": 1531333942, "creation_date": 1531330905, "last_edit_date": 1531332936, "question_id": 51291430, "link": "https://stackoverflow.com/questions/51291430/saving-a-string-into-a-dynamic-list", "title": "Saving a string into a dynamic list", "body": "<p>I'm trying to create a dynamic list, which should read an input string and save every string into a new node of the lis. The program will print every node, after that i want to add a function to delete a node, but i'm getting a lot of errors, mostly because i'm not so good at using pointers and i'm new to data structures, can someone please help me?</p>\n\n<p>EDIT: I corrected the code, now i'm not getting the errors anymore but the program seems to print for each node a single character, instead a string for each node, this is the current output:</p>\n\n<pre><code>// Inserting and deleting nodes in a list\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// self-referential structure                       \nstruct listNode {                                      \n   char *data; // each listNode contains a character \n   struct listNode *nextPtr; // pointer to next node\n}; \ntypedef struct listNode ListNode; // synonym for struct listNode\ntypedef ListNode *ListNodePtr; // synonym for ListNode*\n\n// prototypes\nvoid insert(ListNodePtr *sPtr, char *value);\nint isEmpty(ListNodePtr sPtr);\nvoid printList(ListNodePtr currentPtr);\nvoid instructions(void);\nint main(void)\n{ \n   ListNodePtr startPtr = NULL; // initially there are no nodes\n   char item; // char entered by user\n   instructions(); // display the menu\n   printf(\"%s\", \"? \");\n   unsigned int choice; // user's choice\n   scanf(\"%u\", &amp;choice);\n   // loop while user does not choose 3\n   while (choice != 3) { \n      switch (choice) { \n         case 1:\n            printf(\"%s\", \"Enter a character: \");\n            scanf(\"%c\", &amp;item);\n            insert(&amp;startPtr, &amp;item); // insert item in list\n            printList(startPtr);\n            break;\n\n         default:\n            puts(\"Invalid choice.\\n\");\n            instructions();\n            break;\n      } // end switch\n      printf(\"%s\", \"? \");\n      scanf(\"%u\", &amp;choice);\n   } \n   puts(\"End of run.\");\n} \n// display program instructions to user\nvoid instructions(void)\n{ \n   puts(\"Enter your choice:\\n\"\n      \"   1 to insert an element into the list.\\n\"\n      \"   2 to delete an element from the list.\\n\"\n      \"   3 to end.\");\n}\n\n// insert a new value into the list in sorted order\nvoid insert(ListNodePtr *sPtr, char *value)\n{ \n   ListNodePtr newPtr = malloc(sizeof(ListNode)); // create node\n\n   if (newPtr != NULL) { // is space available\n      newPtr-&gt;data= malloc(strlen(value)+1);\n      strcpy(newPtr-&gt;data, value);\n      newPtr-&gt;nextPtr = NULL; // node does not link to another node\n      ListNodePtr previousPtr = NULL;\n      ListNodePtr currentPtr = *sPtr;\n      // loop to find the correct location in the list       \n      while (currentPtr != NULL &amp;&amp; value &gt; currentPtr-&gt;data) {\n         previousPtr = currentPtr; // walk to ...               \n         currentPtr = currentPtr-&gt;nextPtr; // ... next node \n      }                                          \n      // insert new node at beginning of list\n      if (previousPtr == NULL) { \n         newPtr-&gt;nextPtr = *sPtr;\n         *sPtr = newPtr;\n      } \n      else { // insert new node between previousPtr and currentPtr\n         previousPtr-&gt;nextPtr = newPtr;\n         newPtr-&gt;nextPtr = currentPtr;\n      } \n   } \n   else {\n      printf(\"%s not inserted. No memory available.\\n\", value);\n   } \n} \n\nint isEmpty(ListNodePtr sPtr)\n{ \n   return sPtr == NULL;\n}\n\n\n// print the list\nvoid printList(ListNodePtr currentPtr)\n{ \n   // if list is empty\n   if (isEmpty(currentPtr)) {\n      puts(\"List is empty.\\n\");\n   } \n   else { \n      puts(\"The list is:\");\n      // while not the end of the list\n      while (currentPtr != NULL) { \n         printf(\"%s --&gt; \", currentPtr-&gt;data);\n         currentPtr = currentPtr-&gt;nextPtr;   \n      } \n      puts(\"NULL\\n\");\n   } \n} \n</code></pre>\n\n<p>Here is a sample of the output currently:</p>\n\n<pre><code>    ./test\nEnter your choice:\n   1 to insert an element into the list.\n   2 to delete an element from the list.\n   3 to end.\n? 1\nEnter a character: The list is:\n\n --&gt; NULL\n\n? Test\nEnter a character: The list is:\n\n --&gt; T --&gt; NULL\n\n? Enter a character: The list is:\n\n --&gt; T --&gt; e --&gt; NULL\n\n? Enter a character: The list is:\n\n --&gt; T --&gt; e --&gt; s --&gt; NULL\n\n? Enter a character: The list is:\n\n --&gt; T --&gt; e --&gt; s --&gt; t --&gt; NULL\n\n? \n</code></pre>\n\n<p>Where i want it to be, for example: Word One -> Word Two etc.</p>\n"}, {"tags": ["mysql", "c", "linux", "fork"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1531330655, "post_id": 51291277, "comment_id": 89560394, "body": "Is there a reason why you aren&#39;t using a delayed insert instead?"}, {"owner": {"reputation": 8114, "user_id": 5962802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2zAfR.png?s=128&g=1", "display_name": "IVO GELOV", "link": "https://stackoverflow.com/users/5962802/ivo-gelov"}, "edited": false, "score": 4, "creation_date": 1531330952, "post_id": 51291277, "comment_id": 89560545, "body": "MySQL does not allow issuing new query before you fetch ALL the results from the previous query - otherwise it gives a <code>Commands out of sync</code> error. When you have multiple processes you have to somehow synchronize the send/receive - otherwise it is easier to use a separate connection for each process. In your example you will issue 2 overlapping queries which is not good. You are also not fetching results back - not a good practice."}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 3, "creation_date": 1531331997, "post_id": 51291277, "comment_id": 89561006, "body": "Generally, no; even if you put some some locking in place to prevent overlapping use of the connection, depending on how you lock, you can risk the scenario where something like &quot;SELECT last_insert_id()&quot; ends up getting the value for an insert made from a different thread in the time between it&#39;s insert and select. Of course, you can hold the lock until such a task is completely done with the connection. But I said &quot;generally&quot;; if db access is short and intermittent, or you only have a limited number of connections to work with in the first place, the sync overhead could be worth it."}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 1, "creation_date": 1531332059, "post_id": 51291277, "comment_id": 89561046, "body": "tldr version of my comment above.... I wouldn&#39;t have them share the connection unless circumstances require you to do so."}, {"owner": {"reputation": 61, "user_id": 2044821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c527bf125dff45d4205ca0f9278a960?s=128&d=identicon&r=PG", "display_name": "beddu", "link": "https://stackoverflow.com/users/2044821/beddu"}, "reply_to_user": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1531332328, "post_id": 51291277, "comment_id": 89561165, "body": "@IgnacioVazquez-Abrams delayed inserts are deprecated since version 5.6 - <a href=\"https://dev.mysql.com/doc/refman/8.0/en/insert-delayed.html\" rel=\"nofollow noreferrer\">dev.mysql.com/doc/refman/8.0/en/insert-delayed.html</a>"}, {"owner": {"reputation": 61, "user_id": 2044821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c527bf125dff45d4205ca0f9278a960?s=128&d=identicon&r=PG", "display_name": "beddu", "link": "https://stackoverflow.com/users/2044821/beddu"}, "reply_to_user": {"reputation": 8114, "user_id": 5962802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2zAfR.png?s=128&g=1", "display_name": "IVO GELOV", "link": "https://stackoverflow.com/users/5962802/ivo-gelov"}, "edited": false, "score": 0, "creation_date": 1531332430, "post_id": 51291277, "comment_id": 89561206, "body": "@IVOGELOV I am quite new to mysql c api and I did not know that, thank you for the precious hint."}, {"owner": {"reputation": 61, "user_id": 2044821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c527bf125dff45d4205ca0f9278a960?s=128&d=identicon&r=PG", "display_name": "beddu", "link": "https://stackoverflow.com/users/2044821/beddu"}, "reply_to_user": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1531332839, "post_id": 51291277, "comment_id": 89561386, "body": "@Uueerdo Altough I am coding for a system with limited resources, I guess that circumstances are not yet here... thanks for the advice."}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1531333091, "post_id": 51291277, "comment_id": 89561496, "body": "@beddu I am not very familiar with the C api, but you might want to see if it has support for connection pooling; or if there are any semi-standardized wrappers that implement pooling. With connection pooling, basically, the limited connections are managed in a &quot;pool&quot; (hence the name), and handed out and taken back without needing to completely reopen a connection at every use."}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1531333476, "post_id": 51291277, "comment_id": 89561649, "body": "It&#39;s not a direct answer to your question, but this q&amp;a looks like it would be good to consider. <a href=\"https://stackoverflow.com/questions/1455190/how-to-access-mysql-from-multiple-threads-concurrently\" title=\"how to access mysql from multiple threads concurrently\">stackoverflow.com/questions/1455190/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531333848, "post_id": 51291277, "comment_id": 89561822, "body": "The forked children will inherit copies of the open file descriptors from their parent, including any associated with the database connection, which is probably ok, but they will also get <i>copies</i> of the C-side data structure.  That is, they will not share the C-side data.  I am not aware of the consequences being explicitly documented, but this seems a recipe for disaster to me."}], "owner": {"reputation": 61, "user_id": 2044821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c527bf125dff45d4205ca0f9278a960?s=128&d=identicon&r=PG", "display_name": "beddu", "link": "https://stackoverflow.com/users/2044821/beddu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531330368, "creation_date": 1531330261, "last_edit_date": 1531330368, "question_id": 51291277, "link": "https://stackoverflow.com/questions/51291277/is-it-good-to-use-the-same-mysql-connection-across-forked-processes", "title": "Is it good to use the same MySQL connection across forked processes?", "body": "<p>Is it good/safe/reliable to do so, and why?</p>\n\n<pre><code>int main()\n{\n    MYSQL *mysqldbconn = mysql_init(NULL);\n\n    if(mysqldbconn != NULL)\n    {\n        if(mysql_real_connect(mysqldbconn, host,\n                              user, password,\n                              NULL, port, NULL, 0) != NULL)\n        {\n            pid_t pid = fork();\n            if(pid &gt;= 0)\n            {\n                if(pid == 0)\n                {\n                    mysql_query(mysqldbconn, \"insert into `test`.`abc`(`x`, `y`) values (1, 2)\");\n                    exit(0);\n                }\n                else\n                {\n                    mysql_query(mysqldbconn, \"insert into `test`.`abc`(`x`, `y`) values (3, 4)\");\n                    usleep(1000000);\n                }\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I am wondering if I should open a new connection for every child process, or I can simply connect once at the beginning and then use it in every forked child.\nIs it possible that the usage example above leads to dangerous data races? Is <code>mysql_query</code> atomic?</p>\n\n<p>Thank you for your advices.</p>\n"}, {"tags": ["c", "char", "int"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531328820, "post_id": 51290872, "comment_id": 89559489, "body": "<code>printf(&quot;%d&quot;, b)</code> will do..."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1531328855, "post_id": 51290872, "comment_id": 89559506, "body": "Puts does not print numbers. It prints strings. You need to printf with the %hhd format"}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531329052, "post_id": 51290872, "comment_id": 89559604, "body": "@EugeneSh Then I would need to add more details for clarification."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1531329336, "post_id": 51290872, "comment_id": 89559757, "body": "if you thought that copying an <code>int</code> to a <code>char</code> would help printing it, I guess you have learned now that that&#39;s not the right way... So if that was the only reason for having a <code>char</code> get rid of it because the assignment may overflow and produce unexpected results."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531329347, "post_id": 51290872, "comment_id": 89559762, "body": "You don&#39;t assign anything to array of char. There is no arrays in your code."}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "edited": false, "score": 0, "creation_date": 1531329440, "post_id": 51290872, "comment_id": 89559809, "body": "The fact is that this code isn&#39;t the original It seems I must edit the code too to get rid of the downvote you gave me"}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1531329645, "post_id": 51290872, "comment_id": 89559938, "body": "@JonnyHenly Well, the latest edit should tell you that this isn&#39;t that simple."}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "edited": false, "score": 0, "creation_date": 1531329746, "post_id": 51290872, "comment_id": 89559981, "body": "@JonnyHenly haven&#39;t done programming for two years. I forgot some facts."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1531329832, "post_id": 51290872, "comment_id": 89560025, "body": "What output do you expect from the updated code? Btw. for <code>puts()</code> the array had to be NUL terminated"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531329913, "post_id": 51290872, "comment_id": 89560069, "body": "All chances are you&#39;re looking for <b>sprintf</b>."}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "reply_to_user": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1531329945, "post_id": 51290872, "comment_id": 89560081, "body": "@IngoLeonhardt The original array has one more node with a null assigned. Don&#39;t try to find errors in the code it isn&#39;t the original."}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 3, "creation_date": 1531329947, "post_id": 51290872, "comment_id": 89560084, "body": "It&#39;s still unclear what you&#39;re trying to do with <code>int a</code> though. <i>The original array has one more node with a null assigned.</i> Then please <a href=\"https://stackoverflow.com/posts/51290872/edit\">edit</a> your question to include the actual code so we can stop shooting in the dark."}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1531330164, "post_id": 51290872, "comment_id": 89560189, "body": "@JonnyHenly Does that really matter ? It is creating a char array mixed of random numbers and chars and prints the array which is a string."}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 2, "creation_date": 1531330249, "post_id": 51290872, "comment_id": 89560224, "body": "Yes it matters, you asked this question 25 minutes ago and multiple solutions to multiple problems have been suggested, none of which answer your actual question, which is still unknown."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1531330333, "post_id": 51290872, "comment_id": 89560262, "body": "Do you expect this program to output &quot;e123d4&quot;?"}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531330467, "post_id": 51290872, "comment_id": 89560323, "body": "@dbush Exactly. Yet everyone wants the original code."}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1531330555, "post_id": 51290872, "comment_id": 89560355, "body": "Thank you for including the actual code, +1. I think Vikas Gautam&#39;s answer below is one way of doing what you&#39;re looking for. Be careful though, you should keep track of how many char&#39;s and int&#39;s are in the array and where they are. Otherwise your array length vs. array entries count will be off."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1531330795, "post_id": 51290872, "comment_id": 89560466, "body": "@Programmer This is why we ask for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Now that we&#39;ve seen your whole code, it&#39;s apparent what you&#39;re trying to do, and it&#39;s also apparent that what you originally asked isn&#39;t really the solution to your problem."}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "edited": false, "score": 0, "creation_date": 1531332395, "post_id": 51290872, "comment_id": 89561190, "body": "I would like to know the reason for the downvote now.  If what I was searching wasn&#39;t the good way to achieve my goal it doesn&#39;t mean an unclear or unuseful question."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 7812263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J1kEA.jpg?s=128&g=1", "display_name": "Nath", "link": "https://stackoverflow.com/users/7812263/nath"}, "is_accepted": false, "score": 0, "last_activity_date": 1531329589, "last_edit_date": 1531329589, "creation_date": 1531329088, "answer_id": 51290984, "question_id": 51290872, "link": "https://stackoverflow.com/questions/51290872/assign-a-number-to-a-char-variable-in-c/51290984#51290984", "title": "Assign a Number to a char variable in C?", "body": "<p>Using <strong>printf()</strong> would help, puts() is used to print strings to the console</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void){\n    int a = 12;\n    char b = a;\n    printf(\"%d\",b);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 363, "user_id": 8033051, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-xwE_VNJHwqs/AAAAAAAAAAI/AAAAAAAAACo/InOvfJOM11Q/photo.jpg?sz=128", "display_name": "Vikas Gautam", "link": "https://stackoverflow.com/users/8033051/vikas-gautam"}, "is_accepted": false, "score": 2, "last_activity_date": 1531330253, "creation_date": 1531330253, "answer_id": 51291274, "question_id": 51290872, "link": "https://stackoverflow.com/questions/51290872/assign-a-number-to-a-char-variable-in-c/51291274#51291274", "title": "Assign a Number to a char variable in C?", "body": "<p>I think you want type conversion from int to char, but since we can convert only single digit to char at a time, so we have to extract all digits and store it in a string and then reverse string to get answer.</p>\n\n<p>hope this code will give you some ideas</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define max 10000\nint main(void){\n    int a = 12233;\n    char b[max];             // Create a char array of max size\n    int i=0,j;\n    while(a)\n    {\n        int rem = a%10;            // since we can only convert single int digit to char use loop to extract digits\n        b[i] = rem + '0';          // and convert into char\n        i++;\n        a = a/10;\n    }\n    b[i] = '\\0';                  // don't forget to insert '\\0' to make it string\n    for(i=0,j=strlen(b)-1;i&lt;=j;i++,j--)        // now we have char array like 21, so we have to reverse it\n    {\n        char temp = b[i];\n        b[i] = b[j];\n        b[j] = temp;\n    }\n\n    puts(b);                       // print string\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "edited": false, "score": 0, "creation_date": 1531331376, "post_id": 51291497, "comment_id": 89560728, "body": "Would your last code be a secure one?  And the last line is what I need to understand."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "edited": false, "score": 0, "creation_date": 1531331465, "post_id": 51291497, "comment_id": 89560770, "body": "@Programmer Not really, since neither version is using a cryptographically secure random number generator, but it&#39;s more clear and concise."}, {"owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "edited": false, "score": 0, "creation_date": 1531331555, "post_id": 51291497, "comment_id": 89560804, "body": "cryptographically secure random number generator ? do you have any reference to this expression?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "edited": false, "score": 0, "creation_date": 1531331830, "post_id": 51291497, "comment_id": 89560935, "body": "@Programmer It&#39;s a random number generator where it&#39;s more difficult to guess the values.  The <code>rand</code> function doesn&#39;t qualify, but OpenSSL&#39;s <code>RAND_bytes</code> does."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1531331107, "creation_date": 1531331107, "answer_id": 51291497, "question_id": 51290872, "link": "https://stackoverflow.com/questions/51290872/assign-a-number-to-a-char-variable-in-c/51291497#51291497", "title": "Assign a Number to a char variable in C?", "body": "<p>Since what you're actually doing is populating a string with either letters or single digits, you don't actually want to store the numbers themselves but the ASCII codes for the digits.</p>\n\n<p>You can do that as follows:</p>\n\n<pre><code>ushort getRandomNumber(){\n    return '0' + (ushort)(rand() % 10);\n}\n</code></pre>\n\n<p>Note the use of a character constant instead of a \"magic number\" for the ASCII code.  You can make a similar change when getting a character:</p>\n\n<pre><code>char getRandomChar() {\n    ushort chance = (rand() % 2) + 1;\n    if(chance == 1)\n        return 'a' + (rand() % ('z'- 'a' + 1));\n    else\n        return 'a' + (rand() % ('Z' - 'A' + 1));\n}\n</code></pre>\n\n<p>The C standard guarantees that the digits for 0 - 9 are consecutive in whatever character encoding is used.  That guarantee does <strong>not</strong> exists however for letters.</p>\n\n<p>You can simplify the logic a bit more by creating an array of all the characters you want to use and index into that array to get a given random character:</p>\n\n<pre><code>char characters[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for(ushort i = 1 ; i &lt;= size ; ++i){\n        Password[i] = characters[rand() % sizeof(characters)];\n    }\n    Password[i] = 0;\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 3199111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLnVp.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3199111/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2332, "favorite_count": 0, "accepted_answer_id": 51291497, "answer_count": 3, "score": -2, "last_activity_date": 1531331107, "creation_date": 1531328663, "last_edit_date": 1531330413, "question_id": 51290872, "link": "https://stackoverflow.com/questions/51290872/assign-a-number-to-a-char-variable-in-c", "title": "Assign a Number to a char variable in C?", "body": "<p>I'm planning to assign a number datatype into the char variable.\nThe code would be something like this :</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef unsigned short ushort;\ntypedef unsigned u;\n\nushort getRandomNumber(){\n    return (ushort)(rand() % 9);\n}\n\nushort getASCII(char Char) {\n    return (ushort)Char;\n}\n\nchar getRandomChar() {\n    ushort chance = (rand() % 2) + 1;\n    const ushort aASCII = 97 , zASCII = 122 , AASCII = 65 , ZASCII = 89;\n    if(chance == 1)\n        return (char)(aASCII + (rand() % (zASCII - aASCII)));\n    else\n        return (char)(AASCII + (rand() % (ZASCII - AASCII)));\n}\n\nint main(void) {\n    srand(time(NULL));\n    ushort size;\n    puts(\"Enter password size : \" );\n    fflush(stdout);\n    scanf(\"%i\" , &amp;size);\n    if(size &gt;= 4) {\n    char Password[size + 1];\n        for(ushort i = 1 ; i &lt;= size ; ++i){\n            ushort chance = (rand() % 2) + 1;\n                if(chance == 1)\n                    Password[i] = getRandomChar();\n                else\n                    Password[i] = getRandomNumber();\n\n        }\n    printf(\"%s\" , Password);\n    return EXIT_SUCCESS;\n    }\n    else {\n        puts(\"Error. Try again\");\n    }\n}\n</code></pre>\n\n<p>It will not return any error but it will print the character that matches the ASCII code. So this code won't be the right one.</p>\n\n<p>The original code is a random password generator that isn't very good and secure one I know it. the random numbers show up as ASCII characters in the output.</p>\n\n<p>I searched on Google but no useful result. Only <a href=\"https://stackoverflow.com/questions/21400018/how-can-you-assign-a-character-value-to-a-integer-type-variable-in-c\">this</a> but it is the reverse process.\nWhat is the command/algorithm for that?</p>\n\n<p>Thanks for your help.</p>\n\n<p>EDIT: The problem here is that I'm assigning the int to the array of char that has chars that I don't want to show as numbers.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531328742, "post_id": 51290838, "comment_id": 89559438, "body": "Shouldn&#39;t there be <i>20</i> elements of the inner structure in the initializer?"}, {"owner": {"reputation": 15415, "user_id": 982257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pRf2i.jpg?s=128&g=1", "display_name": "Iguananaut", "link": "https://stackoverflow.com/users/982257/iguananaut"}, "edited": false, "score": 1, "creation_date": 1531328820, "post_id": 51290838, "comment_id": 89559490, "body": "This doesn&#39;t have anything to do with your use of a macro (which is what the blocks of code defined with a <code>#define</code> are called).  Try it without the macro and see if that works first."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1531329159, "post_id": 51290838, "comment_id": 89559661, "body": "Remove the comma(s) before the closing <code>}</code>."}, {"owner": {"reputation": 105, "user_id": 4555476, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/057d3bd8e93d943ba822d1dfcea43f24?s=128&d=identicon&r=PG&f=1", "display_name": "Gokhan Sahin", "link": "https://stackoverflow.com/users/4555476/gokhan-sahin"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531329380, "post_id": 51290838, "comment_id": 89559778, "body": "@PaulOgilvie which commas?"}, {"owner": {"reputation": 105, "user_id": 4555476, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/057d3bd8e93d943ba822d1dfcea43f24?s=128&d=identicon&r=PG&f=1", "display_name": "Gokhan Sahin", "link": "https://stackoverflow.com/users/4555476/gokhan-sahin"}, "edited": false, "score": 1, "creation_date": 1531329475, "post_id": 51290838, "comment_id": 89559829, "body": "@EugeneSh.No, it should initalize only two struct, the rest of it be empty"}, {"owner": {"reputation": 105, "user_id": 4555476, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/057d3bd8e93d943ba822d1dfcea43f24?s=128&d=identicon&r=PG&f=1", "display_name": "Gokhan Sahin", "link": "https://stackoverflow.com/users/4555476/gokhan-sahin"}, "edited": false, "score": 0, "creation_date": 1531329555, "post_id": 51290838, "comment_id": 89559876, "body": "it gives the &quot;extra brace group at end of initializer&quot; error."}, {"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "edited": false, "score": 0, "creation_date": 1531331148, "post_id": 51290838, "comment_id": 89560622, "body": "C is zero(0)-indexed, so your initialization occurs at line[0] instead of line[1] -- once you get the other issues resolved; myStruct.setting[0].line[1].number to be 5"}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531331062, "post_id": 51291401, "comment_id": 89560589, "body": "Indeed, the braces around array initializers were missing (I found out after puzzling....)"}, {"owner": {"reputation": 105, "user_id": 4555476, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/057d3bd8e93d943ba822d1dfcea43f24?s=128&d=identicon&r=PG&f=1", "display_name": "Gokhan Sahin", "link": "https://stackoverflow.com/users/4555476/gokhan-sahin"}, "edited": false, "score": 0, "creation_date": 1531331439, "post_id": 51291401, "comment_id": 89560755, "body": "Yes, it&#39;s correct. Thank you. I know wrong about using braces while using any structure."}, {"owner": {"reputation": 105, "user_id": 4555476, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/057d3bd8e93d943ba822d1dfcea43f24?s=128&d=identicon&r=PG&f=1", "display_name": "Gokhan Sahin", "link": "https://stackoverflow.com/users/4555476/gokhan-sahin"}, "edited": false, "score": 0, "creation_date": 1531331587, "post_id": 51291401, "comment_id": 89560819, "body": "Why it&#39;s horrid structure? If I initialize it as you show, c file will be very complicated."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531332902, "post_id": 51291401, "comment_id": 89561413, "body": "It&#39;s horrid (or, at least, unpleasant and tricky to work with) because there are two levels of arrays inside with no auxilliary information alongside them.  It is adding levels of complexity (as evidenced by the extra braces needed) to no apparent purpose."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1531330784, "creation_date": 1531330784, "answer_id": 51291401, "question_id": 51290838, "link": "https://stackoverflow.com/questions/51290838/how-can-to-initialize-the-struct-with-a-definition/51291401#51291401", "title": "How can to initialize the struct with a definition?", "body": "<p>Write an initializer out manually before converting to a macro.  I used:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ntypedef struct {\n  struct {\n    struct {\n      char name[16];\n      uint16_t number;\n    } line[20];\n  } setting[2];\n} MyStruct_t;\n\nMyStruct_t mst =\n{                                   // structure as a whole\n    {                               // setting\n        {                           // setting[0]\n            {                       // line\n                { \"name\",   16 },   // line[0]\n                { \"number\",  1 },   // line[1]\n            }\n        },\n        {                           // setting[1]\n            {                       // line\n                { \"zoo\",   16 },    // line[0]\n                { \"bronx\",  1 },    // line[1]\n                { \"new\",    0 },    // line[2]\n                { \"york\",   5 },    // line[3]\n            }\n        }\n    }\n};\n\n#define MY_DEFINITION \\\n{\\\n    {\\\n        {\\\n            {\\\n                { \"menu\",     20 },\\\n                { \"setting\",   5 },\\\n            }\\\n        },\\\n        {\\\n            {\\\n                { \"menu2\",    50 },\\\n                { \"setting2\", 15 },\\\n            }\\\n        }\\\n    }\\\n}\n\nMyStruct_t myStruct = MY_DEFINITION;\n</code></pre>\n\n<p>First I got the initializer without the macro to compile.  Then I rewrote the macro to include the extra braces that the manual edition shows are necessary.  If you're truly determined, you can investigate eliminating braces from the working versions, but it is probably better to work with the fully braced initializer.</p>\n\n<p>May I say \u2014 that is a horrid structure to work with!</p>\n"}], "owner": {"reputation": 105, "user_id": 4555476, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/057d3bd8e93d943ba822d1dfcea43f24?s=128&d=identicon&r=PG&f=1", "display_name": "Gokhan Sahin", "link": "https://stackoverflow.com/users/4555476/gokhan-sahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 51291401, "answer_count": 1, "score": -1, "last_activity_date": 1551013371, "creation_date": 1531328528, "last_edit_date": 1551013371, "question_id": 51290838, "link": "https://stackoverflow.com/questions/51290838/how-can-to-initialize-the-struct-with-a-definition", "title": "How can to initialize the struct with a definition?", "body": "<p>I have a following definition in my config file and want to initialize automatically my structure while definiting in compile time. My aim is myStruct.setting[0].line[1].number to be 5. But I get an error while definiting. How can I initialize it like I want?      </p>\n\n<pre><code>#define MY_DEFINITION \\\n{\\\n  {\\\n    {\"menu\"    ,20},\\\n    {\"setting\" , 5},\\\n  },\\\n  {\\\n    {\"menu2\"   ,50},\\\n    {\"setting2\",15},\\\n  },\\\n}\n\ntypedef struct{\n  struct{\n    struct{\n      char name[16];\n      uint16_t number;\n    }line[20];\n  }setting[2];\n}MyStruct_t;\n\nMyStruct_t myStruct=MY_DEFINITION;\n</code></pre>\n"}, {"tags": ["android", "python", "c++", "ios", "c"], "answers": [{"tags": [], "owner": {"reputation": 4794, "user_id": 220765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H8vnV.png?s=128&g=1", "display_name": "mhsmith", "link": "https://stackoverflow.com/users/220765/mhsmith"}, "is_accepted": false, "score": 1, "last_activity_date": 1531994589, "creation_date": 1531994589, "answer_id": 51419755, "question_id": 51290516, "link": "https://stackoverflow.com/questions/51290516/can-i-create-based-on-python-code-executable-code-for-android-and-or-ios/51419755#51419755", "title": "Can I create based on Python code executable code for Android and/or iOS?", "body": "<p>You've asked a lot of questions, so forgive me for only answering one of them.</p>\n\n<p>Cython won't save you any work in this situation. Although it can translate Python code into C, the generated code consists mostly of calls to the Python C API. So you'd still need to manage all the details of including the <code>libpython</code> library in your app, loading it and initializing it. </p>\n"}], "owner": {"reputation": 91, "user_id": 4831289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09b046dc73c266fb106c707f3a45603?s=128&d=identicon&r=PG&f=1", "display_name": "Joker3139", "link": "https://stackoverflow.com/users/4831289/joker3139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531994589, "creation_date": 1531327246, "last_edit_date": 1531402574, "question_id": 51290516, "link": "https://stackoverflow.com/questions/51290516/can-i-create-based-on-python-code-executable-code-for-android-and-or-ios", "title": "Can I create based on Python code executable code for Android and/or iOS?", "body": "<p>I developed in Python an algorithm library (+ usage of e.g. pandas and numpy) and I search a way to deploy those algorithms on Android and iOS without rewritting the code native or in any other language.</p>\n\n<p>After exploring several options, I see four major possibilities how to solve the Python migration:</p>\n\n<ul>\n<li>Translate the <strong>Python code into native code</strong> (Java or Swift/Objective-C) for each platform (which I do not prefer as keeping the same code in line seems a lot of redundant work)</li>\n<li>Translate the <strong>Python code into C or C++</strong> which is executable by both OS (unfortunately, I am not fluent in C/C++ and I think I won't be ;)) But there are tools or interpreters as <a href=\"http://cython.org/\" rel=\"nofollow noreferrer\">Cypthon</a> or <a href=\"http://nuitka.net/\" rel=\"nofollow noreferrer\">Nuikta</a> which can maybe translate the Python code into executable C or C++ versions?</li>\n<li>Use <strong><a href=\"https://kivy.org/#home\" rel=\"nofollow noreferrer\">Kivy</a> to create a Python based app for both OS</strong>, however I do not want a complete .apk instead just a AAR or library that can I use as a module by other apps (I am not sure if this works)</li>\n<li>With the help of <a href=\"https://chaquo.com/chaquopy/\" rel=\"nofollow noreferrer\">Chaquopy</a> <strong>run Python code in Android via an Python interpreter</strong>. However, I do not see any comparable solution for iOS...</li>\n</ul>\n\n<p>Spanning around these four options, I have several questions:</p>\n\n<ul>\n<li>Is it possible with <a href=\"http://cython.org/\" rel=\"nofollow noreferrer\">Cython</a>, <a href=\"http://nuitka.net/\" rel=\"nofollow noreferrer\">Nuitka</a>, or any other tool to translate Python code with all dependencies into executable C/C++ code that can be used by Android and iOS?</li>\n<li>Can I use <a href=\"https://kivy.org/#home\" rel=\"nofollow noreferrer\">Kivy</a> to create a library (e.g. like this on <a href=\"https://developer.android.com/studio/projects/android-library\" rel=\"nofollow noreferrer\">Android</a> or a <a href=\"https://swift.org/package-manager/\" rel=\"nofollow noreferrer\">library package on iOS</a>)</li>\n<li>Is there any obvious option I miss?</li>\n</ul>\n\n<p>I know that using native code will be probably the fastest solution whereas automatic generated code may have flaws and is kind of inefficient (and one has always to rely on the maintainer). Nevertheless, I would now prefer the way to keep the Python code as my core as long as I am still in a prototype phase, would be great to hear the community's view!</p>\n"}, {"tags": ["c", "gcc", "asterisk"], "comments": [{"owner": {"reputation": 59, "user_id": 6468372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d880ec738a5fc67f0063cc673727ad?s=128&d=identicon&r=PG&f=1", "display_name": "stacker", "link": "https://stackoverflow.com/users/6468372/stacker"}, "edited": false, "score": 0, "creation_date": 1531327264, "post_id": 51290408, "comment_id": 89558742, "body": "readelf -a ./myfile.so"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1531327460, "post_id": 51290408, "comment_id": 89558855, "body": "How did you produce <code>00019350 g     F .text  00000034 MyFunc</code>? What tool?"}, {"owner": {"reputation": 59, "user_id": 6468372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d880ec738a5fc67f0063cc673727ad?s=128&d=identicon&r=PG&f=1", "display_name": "stacker", "link": "https://stackoverflow.com/users/6468372/stacker"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1531327600, "post_id": 51290408, "comment_id": 89558911, "body": "This is part of makefile.rules:  %: %.o \t$(ECHO_PREFIX) echo &quot;   [LD] $^ -&gt; $@&quot; \t$(CMD_PREFIX) $(CXX) $(STATIC_BUILD) -o $@ $(PTHREAD_CFLAGS) $(_ASTLDFLAGS) $^ $(CXX_LIBS) $(ASTLDFLAGS)"}, {"owner": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 0, "creation_date": 1531327608, "post_id": 51290408, "comment_id": 89558916, "body": "Is MyFunc exported?"}, {"owner": {"reputation": 59, "user_id": 6468372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d880ec738a5fc67f0063cc673727ad?s=128&d=identicon&r=PG&f=1", "display_name": "stacker", "link": "https://stackoverflow.com/users/6468372/stacker"}, "edited": false, "score": 0, "creation_date": 1531327766, "post_id": 51290408, "comment_id": 89558981, "body": "2Peter L.: Surely."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1531327932, "post_id": 51290408, "comment_id": 89559052, "body": "Can you show the code you used to export it?"}, {"owner": {"reputation": 59, "user_id": 6468372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d880ec738a5fc67f0063cc673727ad?s=128&d=identicon&r=PG&f=1", "display_name": "stacker", "link": "https://stackoverflow.com/users/6468372/stacker"}, "edited": false, "score": 0, "creation_date": 1531328220, "post_id": 51290408, "comment_id": 89559178, "body": "2Ian Abbott: Not right now."}, {"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 1, "creation_date": 1531418389, "post_id": 51290408, "comment_id": 89600408, "body": "If the function is not called, it may be removed from the .so by link time optimization (LTO), if you have that - just an option"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 6468372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d880ec738a5fc67f0063cc673727ad?s=128&d=identicon&r=PG&f=1", "display_name": "stacker", "link": "https://stackoverflow.com/users/6468372/stacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1531463115, "last_edit_date": 1531463115, "creation_date": 1531462482, "answer_id": 51318679, "question_id": 51290408, "link": "https://stackoverflow.com/questions/51290408/why-function-exist-in-o-file-but-does-not-exist-in-so-file/51318679#51318679", "title": "Why function exist in .o file, but does not exist in .so file?", "body": "<p>I got it. The my trouble happens because I made mistake for depend of method of declaration function.</p>\n\n<p>I forgot to clarify that I'm transferring the old code from asterisk 1.4. to asterisk 13.21. (<a href=\"http://downloads.asterisk.org/pub/telephony/asterisk/\" rel=\"nofollow noreferrer\">http://downloads.asterisk.org/pub/telephony/asterisk/</a>)\nATTENTION: The way to define the exported functions in the this project is own of asterisk company (since 13 version).\nSo, in order for the exported functions to be available in the \".so\" file, these functions MUST BE explicitly specified in the text file (with prefix \"LINKER_SYMBOL_PREFIX\"), which have same name as the source file, but with the extension \".exports.in\", e.g.: </p>\n\n<pre><code>myfile.h (contains: int MyFunc();)\nmyfile.c (contains: int MyFunc(){})\nmyfile.exports.in (contains: LINKER_SYMBOL_PREFIXMyFunc)\n</code></pre>\n\n<p>After compile, all needed functions will be availble in \"myfile.so\".\nThat is design.</p>\n\n<p>Many thanks to all guys.</p>\n"}], "owner": {"reputation": 59, "user_id": 6468372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d880ec738a5fc67f0063cc673727ad?s=128&d=identicon&r=PG&f=1", "display_name": "stacker", "link": "https://stackoverflow.com/users/6468372/stacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531463115, "creation_date": 1531326820, "last_edit_date": 1531462530, "question_id": 51290408, "link": "https://stackoverflow.com/questions/51290408/why-function-exist-in-o-file-but-does-not-exist-in-so-file", "title": "Why function exist in .o file, but does not exist in .so file?", "body": "<p>Why function MyFunc() exist in .o file, but does not exist in .so file?\nExample .o file:</p>\n\n<pre><code>00019350 g     F .text  00000034 MyFunc\n</code></pre>\n\n<p>In .so file I don't see function \"MyFunc\".</p>\n"}, {"tags": ["c", "logic"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1531326567, "post_id": 51290254, "comment_id": 89558348, "body": "This is a convoluted way of shifting the <code>tailX</code> and <code>tailY</code> arrays by 1, and putting a new value in the 0 index."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531326709, "post_id": 51290254, "comment_id": 89558427, "body": "I would rather use a &quot;ring&quot; buffer and keep the index of the &quot;head&quot;. So each step only only one value has to change."}, {"owner": {"reputation": 11, "user_id": 10065983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e039cbe99b968cb914717ecee70669?s=128&d=identicon&r=PG&f=1", "display_name": "Anon", "link": "https://stackoverflow.com/users/10065983/anon"}, "edited": false, "score": 0, "creation_date": 1531326893, "post_id": 51290254, "comment_id": 89558530, "body": "I can implement other logic like your logic but I want to know how above code logic is working bcz each time zero is assigned so how x and y coordinates were generated"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531326939, "post_id": 51290254, "comment_id": 89558558, "body": "No zero is assigned anywhere in the code posted."}, {"owner": {"reputation": 11, "user_id": 10065983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e039cbe99b968cb914717ecee70669?s=128&d=identicon&r=PG&f=1", "display_name": "Anon", "link": "https://stackoverflow.com/users/10065983/anon"}, "edited": false, "score": 0, "creation_date": 1531327115, "post_id": 51290254, "comment_id": 89558656, "body": "tailX[1] is equals to zero because default value of uninitialized global variables is zero so zero is assigned to prev2X and prev2Y that&#39;s why I am confusing"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531327228, "post_id": 51290254, "comment_id": 89558719, "body": "You forgot about <code>int prevX = tailX[0];     int prevY = tailY[0];</code>. And these are set from <code>x</code> and <code>y</code>."}, {"owner": {"reputation": 11, "user_id": 10065983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e039cbe99b968cb914717ecee70669?s=128&d=identicon&r=PG&f=1", "display_name": "Anon", "link": "https://stackoverflow.com/users/10065983/anon"}, "edited": false, "score": 0, "creation_date": 1531327885, "post_id": 51290254, "comment_id": 89559034, "body": "OK  you are right <code>prevX=tailX[0]</code> will not equal to zero but in <b>for</b> loop last line <code>prevX=prev2X </code> is equals to what ? I think zero ? I am still confused \ud83d\ude11"}], "owner": {"reputation": 11, "user_id": 10065983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e039cbe99b968cb914717ecee70669?s=128&d=identicon&r=PG&f=1", "display_name": "Anon", "link": "https://stackoverflow.com/users/10065983/anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531329420, "creation_date": 1531326328, "last_edit_date": 1531329420, "question_id": 51290254, "link": "https://stackoverflow.com/questions/51290254/logic-for-snake-tail-in-c", "title": "Logic for snake tail in c", "body": "<p>I am new to C programming and found a code for snake game but I am unable to understand the logic part for tail creation here is code</p>\n\n<pre><code>void Logic()\n{\n    int prevX = tailX[0];\n    int prevY = tailY[0];\n    int prev2X, prev2Y;\n    tailX[0] = x;\n    tailY[0] = y;\n    for (int i = 1; i &lt; nTail; i++)\n    {\n        prev2X = tailX[i];\n        prev2Y = tailY[i];\n        tailX[i] = prevX;\n        tailY[i] = prevY;\n        prevX = prev2X;\n        prevY = prev2Y;\n    }\n</code></pre>\n\n<p>Actually I am not understanding <strong>for</strong> loop part, by the way according to my understanding , in first iteration</p>\n\n<p>1) <code>prev2X = tailX[1] // prev2X = 0</code></p>\n\n<p>2) <code>prev2Y = tailY[1] // again 0</code></p>\n\n<p>3) <code>tailX[1] = prevX // assuming value of prevX 5</code></p>\n\n<p>4) <code>tailY[1] = prevY // assuming value of prevY 6</code></p>\n\n<p>5) <code>prevX = prev2X // prevX =0</code></p>\n\n<p>6) <code>prevY = prev2Y // again 0</code></p>\n\n<p>In second iteration </p>\n\n<p>1) <code>prev2X = tailX[2] // prev2X = 0</code></p>\n\n<p>2) <code>prev2Y = tailY[2] // again 0</code></p>\n\n<p>3) <code>tailX[1] = prevX // prevX is 0 bcz of 1st iteration</code></p>\n\n<p>4) <code>tailY[1] = prevY // same 0</code></p>\n\n<p>5) <code>prevX = prev2X // 0</code></p>\n\n<p>6) <code>prevY = prev2Y // again 0</code></p>\n\n<p>But I know it is wrong so how this logic is working please explain step by step  at least for 2 iterations </p>\n"}, {"tags": ["c", "char"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1531326470, "post_id": 51290223, "comment_id": 89558295, "body": "For one thing, an array passed into a function decays to a pointer, so <code>sizeof</code> will not tell you the number of bytes in the buffer and instead tell you the size of the pointer."}, {"owner": {"reputation": 2359, "user_id": 1736256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1948628470196fe729837363a59e153f?s=128&d=identicon&r=PG", "display_name": "ILostMySpoon", "link": "https://stackoverflow.com/users/1736256/ilostmyspoon"}, "reply_to_user": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 0, "creation_date": 1531326604, "post_id": 51290223, "comment_id": 89558366, "body": "@NickS Sorry, I typoed. It was in fact *inputBuffer already. Still getting the warning."}, {"owner": {"reputation": 2359, "user_id": 1736256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1948628470196fe729837363a59e153f?s=128&d=identicon&r=PG", "display_name": "ILostMySpoon", "link": "https://stackoverflow.com/users/1736256/ilostmyspoon"}, "edited": false, "score": 0, "creation_date": 1531326754, "post_id": 51290223, "comment_id": 89558447, "body": "foo(inputBuffer);"}, {"owner": {"reputation": 2359, "user_id": 1736256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1948628470196fe729837363a59e153f?s=128&d=identicon&r=PG", "display_name": "ILostMySpoon", "link": "https://stackoverflow.com/users/1736256/ilostmyspoon"}, "edited": false, "score": 0, "creation_date": 1531326821, "post_id": 51290223, "comment_id": 89558489, "body": "I guess I can just assign the constant 500 to readBuffer as well..."}, {"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 2, "creation_date": 1531326872, "post_id": 51290223, "comment_id": 89558521, "body": "If the size is needed you should pass it to the function as well"}, {"owner": {"reputation": 2359, "user_id": 1736256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1948628470196fe729837363a59e153f?s=128&d=identicon&r=PG", "display_name": "ILostMySpoon", "link": "https://stackoverflow.com/users/1736256/ilostmyspoon"}, "edited": false, "score": 0, "creation_date": 1531326898, "post_id": 51290223, "comment_id": 89558534, "body": "Got it! Thanks everyone."}], "answers": [{"comments": [{"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 0, "creation_date": 1531338437, "post_id": 51290439, "comment_id": 89563930, "body": "Does this code properly null-terminate the <code>readBuffer</code> variable?"}, {"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 0, "creation_date": 1531338461, "post_id": 51290439, "comment_id": 89563941, "body": "<a href=\"http://www.cplusplus.com/reference/cstring/strncpy/\" rel=\"nofollow noreferrer\">The docs</a> would suggest otherwise."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 1, "creation_date": 1531338532, "post_id": 51290439, "comment_id": 89563973, "body": "@orhtej2 You&#39;re correct, it will not in this case.  Changing to <code>strcpy</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1531338552, "last_edit_date": 1531338552, "creation_date": 1531326963, "answer_id": 51290439, "question_id": 51290223, "link": "https://stackoverflow.com/questions/51290223/passing-char-array-to-function-and-copying-contents-to-another-char-array/51290439#51290439", "title": "Passing char array to function and copying contents to another char array", "body": "<p>In the function <code>foo</code>, <code>inputBuffer</code> is a pointer to char, not an array.  Arrays and pointers are not the same.  One of the places this is apparent is the <code>sizeof</code> operator.</p>\n\n<p>If you use the <code>sizeof</code> operator on a pointer, it will give you the size of a pointer (most likely 4 or 8), <em>not</em> the size of what it points to.</p>\n\n<p>Note also that the function parameter <code>inputBuffer</code> masks the global variable of the same name.</p>\n\n<p>Given that <code>inputBuffer</code> contains user input and is probably a string, you instead want to use <code>strlen</code> to get the length of the string.</p>\n\n<pre><code>void foo(char *inputBuffer)\n{\n    char readBuffer[strlen(inputBuffer) + 1];\n    strcpy(readBuffer, inputBuffer);\n    // do something with readBuffer\n}\n</code></pre>\n\n<p>Note also that the size given to <code>readBuffer</code> contains an extra byte for the terminating null byte.</p>\n"}], "owner": {"reputation": 2359, "user_id": 1736256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1948628470196fe729837363a59e153f?s=128&d=identicon&r=PG", "display_name": "ILostMySpoon", "link": "https://stackoverflow.com/users/1736256/ilostmyspoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 51290439, "answer_count": 1, "score": 2, "last_activity_date": 1551296744, "creation_date": 1531326183, "last_edit_date": 1551296744, "question_id": 51290223, "link": "https://stackoverflow.com/questions/51290223/passing-char-array-to-function-and-copying-contents-to-another-char-array", "title": "Passing char array to function and copying contents to another char array", "body": "<p>I have a char array in which user input from the command line gets placed in. I want to pass that array to function <code>foo</code>and copy its content to a similar char array of the size of the contents contained in the original array. I am getting this warning however. Where am I going wrong?</p>\n\n<pre><code>char inputBuffer[500];\n\nvoid foo(char *inputBuffer)\n{\n    char readBuffer[sizeof(inputBuffer)];\n    strncpy(readBuffer, inputBuffer, sizeof(inputBuffer));\n}\n</code></pre>\n\n<blockquote>\n  <p>warning: argument to 'sizeof' in '__builtin_strncpy' call is the same\n  expression as the source, did you mean to provide an explicit length</p>\n</blockquote>\n"}, {"tags": ["c", "queue"], "answers": [{"tags": [], "owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "is_accepted": false, "score": 3, "last_activity_date": 1531346375, "last_edit_date": 1531346375, "creation_date": 1531344861, "answer_id": 51294480, "question_id": 51290070, "link": "https://stackoverflow.com/questions/51290070/c-sys-queue-h-how-to-pass-a-pointer-to-tailq-head-into-a-function-instead/51294480#51294480", "title": "C: sys/queue.h - how to pass a pointer to TAILQ_HEAD() into a function, instead of having TAILQ_HEAD() be global?", "body": "<p>I never work with this queue but one way I found is add TAILQ_HEAD() inside q_item itself. Its help to avoid global usage of head.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/queue.h&gt;\n\ntypedef struct q_item {\n    int value;\n    TAILQ_ENTRY(q_item) entries;\n    TAILQ_HEAD(, q_item) head;\n} q_item;\n\nvoid enqueue(int n, q_item *q) {\n    // enqueue the node with value n\n    q_item *item;\n    item = malloc(sizeof(q_item));\n    item-&gt;value = n;\n    printf(\"queued %d\\n\", item-&gt;value);\n    TAILQ_INSERT_TAIL(&amp;q-&gt;head, item, entries);\n}\n\nvoid dequeue(q_item *q) {\n    q_item *returned_item;\n    returned_item = TAILQ_FIRST(&amp;q-&gt;head);\n    printf(\"dequeued %d\\n\", returned_item-&gt;value);\n    TAILQ_REMOVE(&amp;q-&gt;head, returned_item, entries);\n    free(returned_item);\n}\n\nint main() {\n\n    q_item q;\n    TAILQ_INIT(&amp;q.head);\n\n    enqueue(1, &amp;q);\n    enqueue(2, &amp;q);\n    enqueue(3, &amp;q);\n\n    dequeue(&amp;q);\n    dequeue(&amp;q);\n\n    return 0;\n}\n</code></pre>\n\n<p>Also it may be useful to look how this macros expand, just compile with <code>gcc</code> using <code>-E</code> option, and you will see that for example <code>TAILQ_HEAD(, qitem) head</code> expand  to</p>\n\n<pre><code>struct {\n       struct q_item *tqh_first; \n       struct q_item **tqh_last; \n } head;\n</code></pre>\n\n<p>Also you can find it in <code>&lt;sys/queue.h&gt;</code> <a href=\"http://unix.superglobalmegacorp.com/xnu/newsrc/bsd/sys/queue.h.html\" rel=\"nofollow noreferrer\">header</a> </p>\n\n<pre><code>/*\n * Tail queue definitions.\n */\n#define TAILQ_HEAD(name, type)                                  \\\nstruct name {                                                   \\\n    struct type *tqh_first; /* first element */                 \\\n    struct type **tqh_last; /* addr of last next element */     \\\n}\n</code></pre>\n\n<p>that's why your try with <code>void enqueue(int n, TAILQ_HEAD(, q_item) * head)</code> didn't work because preprocessor makes simple substituion. </p>\n"}], "owner": {"reputation": 416, "user_id": 3700490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l1lB9.png?s=128&g=1", "display_name": "Casey L", "link": "https://stackoverflow.com/users/3700490/casey-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531346375, "creation_date": 1531325639, "question_id": 51290070, "link": "https://stackoverflow.com/questions/51290070/c-sys-queue-h-how-to-pass-a-pointer-to-tailq-head-into-a-function-instead", "title": "C: sys/queue.h - how to pass a pointer to TAILQ_HEAD() into a function, instead of having TAILQ_HEAD() be global?", "body": "<p>Pretty new to C here. I'm using <code>sys/queue.h</code> to make a simple queue. I've searched quite a bit on SO and Google and cannot find a solution to this particular question.</p>\n\n<p>This works fine:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/queue.h&gt; \n\nTAILQ_HEAD(, q_item) head;\n\ntypedef struct q_item {\n        int value;\n        TAILQ_ENTRY(q_item) entries;\n} q_item;\n\nvoid enqueue(int n) {\n    // enqueue the node with value n\n    q_item *item;\n    item = malloc(sizeof(q_item));\n    item-&gt;value = n;\n    printf(\"queued %d\\n\", item-&gt;value);\n    TAILQ_INSERT_TAIL(&amp;head, item, entries);\n}\n\nvoid dequeue() {\n    q_item *returned_item;\n    returned_item = TAILQ_FIRST(&amp;head);\n    printf(\"dequeued %d\\n\", returned_item-&gt;value);\n    TAILQ_REMOVE(&amp;head, returned_item, entries);\n    free(returned_item);\n}\n\nint main() {\n\n    TAILQ_INIT(&amp;head);\n\n    enqueue(1);\n    enqueue(2);\n    enqueue(3);\n\n    dequeue();\n\n    return 0;\n}\n</code></pre>\n\n<p>I know in general global variables should be avoided. Though I also know TAILQ_HEAD() is a macro, so maybe that changes how I should think about this. Anyway, this doesn't compile:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/queue.h&gt; \n\ntypedef struct q_item {\n        int value;\n        TAILQ_ENTRY(q_item) entries;\n} q_item;\n\nvoid enqueue(int n, TAILQ_HEAD(, q_item) * head) {\n    // enqueue the node with value n\n    q_item *item;\n    item = malloc(sizeof(q_item));\n    item-&gt;value = n;\n    printf(\"queued %d\\n\", item-&gt;value);\n    TAILQ_INSERT_TAIL(head, item, entries);\n}\n\nvoid dequeue(TAILQ_HEAD(, q_item) * head) {\n    q_item *returned_item;\n    returned_item = TAILQ_FIRST(head);\n    printf(\"dequeued %d\\n\", returned_item-&gt;value);\n    TAILQ_REMOVE(head, returned_item, entries);\n    free(returned_item);\n}\n\nint main() {\n\n    TAILQ_HEAD(, q_item) head; // &lt;-- I've moved TAILQ_HEAD into main()\n    TAILQ_INIT(&amp;head);\n\n    enqueue(1, &amp;head);\n    enqueue(2, &amp;head);\n    enqueue(3, &amp;head);\n\n    dequeue(&amp;head);\n\n    return 0;\n}\n</code></pre>\n\n<p>When I try to compile the latter I get the following errors. They are unhelpful since I cannot tell the difference between <code>\u2018struct &lt;anonymous&gt; *\u2019</code> and <code>\u2018struct &lt;anonymous&gt; *\u2019</code>.</p>\n\n<pre><code>test_tailq_noglobal.c:32:13: warning: passing argument 2 of \u2018enqueue\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n      enqueue(1, &amp;head);\n                 ^\ntest_tailq_noglobal.c:10:6: note: expected \u2018struct &lt;anonymous&gt; *\u2019 but argument is of type \u2018struct &lt;anonymous&gt; *\u2019\n     void enqueue(int n, TAILQ_HEAD(, q_item) * head) {\n      ^~~~~~~\n</code></pre>\n\n<p>I know the man page for TAILQ_HEAD shows that you can define the following:</p>\n\n<pre><code>TAILQ_HEAD(tailhead, entry) head;\nstruct tailhead *headp;                 /* Tail queue head. */\n</code></pre>\n\n<p>But I am not sure what to do with this <code>struct tailhead *headp</code>. I have tried passing it as a pointer in place of <code>&amp;head</code> as follows, but this does not seem to work either:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/queue.h&gt; \n\ntypedef struct q_item {\n        int value;\n        TAILQ_ENTRY(q_item) entries;\n} q_item;\n\nvoid enqueue(int n, struct headname *headp) {\n    // enqueue the node with value n\n    q_item *item;\n    item = malloc(sizeof(q_item));\n    item-&gt;value = n;\n    printf(\"queued %d\\n\", item-&gt;value);\n    TAILQ_INSERT_TAIL(headp, item, entries);\n}\n\nvoid dequeue(struct headname *headp) {\n    q_item *returned_item;\n    returned_item = TAILQ_FIRST(headp);\n    printf(\"dequeued %d\\n\", returned_item-&gt;value);\n    TAILQ_REMOVE(headp, returned_item, entries);\n    free(returned_item);\n}\n\nint main() {\n\n    TAILQ_HEAD(headname, q_item) head;\n    struct headname *headp;\n    TAILQ_INIT(headp);\n\n    enqueue(1, headp);\n    enqueue(2, headp);\n    enqueue(3, headp);\n\n    dequeue(headp);\n\n    return 0;\n}\n</code></pre>\n\n<p>Errors:</p>\n\n<pre><code>test_tailq_headp.c: In function \u2018dequeue\u2019:\ntest_tailq_headp.c:21:18: error: dereferencing pointer to incomplete type \u2018struct headname\u2019\n  returned_item = TAILQ_FIRST(headp);\n                  ^\ntest_tailq_headp.c: In function \u2018main\u2019:\ntest_tailq_headp.c:33:13: warning: passing argument 2 of \u2018enqueue\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n  enqueue(1, headp);\n             ^~~~~\ntest_tailq_headp.c:10:6: note: expected \u2018struct headname *\u2019 but argument is of type \u2018struct headname *\u2019\n void enqueue(int n, struct headname *headp) {\n      ^~~~~~~\n</code></pre>\n\n<p>Can someone tell me what I'm doing wrong, either in my code or in the way I'm thinking about this problem? Thanks.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531325582, "post_id": 51290020, "comment_id": 89557839, "body": "Perimeter is not <code>2.0*(height*width)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1155, "user_id": 7120016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6ab5a11884f43f89f55c766c76e8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Jain", "link": "https://stackoverflow.com/users/7120016/rajat-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1531325587, "creation_date": 1531325587, "answer_id": 51290046, "question_id": 51290020, "link": "https://stackoverflow.com/questions/51290020/why-is-this-prgram-not-working-in-c/51290046#51290046", "title": "Why is this prgram not working in C?", "body": "<p>Correct this as follows:</p>\n\n<pre><code>scanf(\" %c\", &amp;choice);\n</code></pre>\n\n<p>&amp;choice will point to an address where you want to store the value.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10041537, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690006711112357/picture?type=large", "display_name": "Hrithik Agrawal", "link": "https://stackoverflow.com/users/10041537/hrithik-agrawal"}, "edited": false, "score": 0, "creation_date": 1531326323, "post_id": 51290114, "comment_id": 89558217, "body": "but we are not suppose to use &amp; symbol while entering character or string. I show that line somewhere I don&#39;t remember though"}, {"owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "reply_to_user": {"reputation": 1, "user_id": 10041537, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690006711112357/picture?type=large", "display_name": "Hrithik Agrawal", "link": "https://stackoverflow.com/users/10041537/hrithik-agrawal"}, "edited": false, "score": 0, "creation_date": 1531326435, "post_id": 51290114, "comment_id": 89558274, "body": "We are supposed to use <code>&amp;</code> for character @HrithikAgrawal . Only in the case of strings , we don&#39;t use <code>&amp;</code>"}], "tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": false, "score": 0, "last_activity_date": 1531325813, "creation_date": 1531325813, "answer_id": 51290114, "question_id": 51290020, "link": "https://stackoverflow.com/questions/51290020/why-is-this-prgram-not-working-in-c/51290114#51290114", "title": "Why is this prgram not working in C?", "body": "<p>This is not working Because you forgot <code>&amp;</code> in <code>scanf(\" %c\", choice);</code> . It should be <code>scanf(\" %c\", &amp;choice);</code> . In <code>scanf</code> function , you have to provide the address of the item to be scanned <em>(Similar to scanf(\"%f\", &amp;height);).</em></p>\n\n<p>Modified code :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    float height = 0;\n    float width = 0;\n    float area = 0;\n    float perimeter = 0;\n    printf(\"Enter height of rectangle :\");\n    scanf(\"%f\", &amp;height);\n    printf(\"Enter width of rectangle :\");\n    scanf(\"%f\", &amp;width);\n\n    char choice;\n    printf(\"Enter P for perimeter and A for area: \");\n    scanf(\" %c\", &amp;choice);\n    if (choice == 'P' || choice == 'p')\n    {\n        printf(\"Width: %f\", width);\n        printf(\"Height: %f\", height);\n        perimeter = 2.0 * (height * width);\n        printf(\"Perimeter of rectangle is: %f\", perimeter);\n    }\n    else if (choice == 'A' || choice == 'a')\n    {\n        printf(\"Width: %f\", width);\n        printf(\"Height: %f\", height);\n        area = (height * width);\n        printf(\"Area of rectangle is: %f\", area);\n    }\n    else\n        printf(\"Invalid Input\");\n}\n</code></pre>\n\n<p><strong>Output :-</strong></p>\n\n<pre><code>Enter height of rectangle :4\nEnter width of rectangle :5\nEnter P for perimeter and A for area: A\nWidth: 5.000000Height: 4.000000Area of rectangle is: 20.000000\n</code></pre>\n\n<p>I recommend to add <code>\\n</code> before your <code>printf()</code>  statements for better readability.  </p>\n"}], "owner": {"reputation": 1, "user_id": 10041537, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690006711112357/picture?type=large", "display_name": "Hrithik Agrawal", "link": "https://stackoverflow.com/users/10041537/hrithik-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1531327759, "creation_date": 1531325479, "last_edit_date": 1531327759, "question_id": 51290020, "link": "https://stackoverflow.com/questions/51290020/why-is-this-prgram-not-working-in-c", "title": "Why is this prgram not working in C?", "body": "<p>I program doesn't work after entering P or A. why?\nit's challenge from udemy course. I am just a beginner in programming :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    float height=0;\n    float width=0;\n    float area=0;\n    float perimeter=0;\n    printf(\"Enter height of rectangle :\");\n    scanf(\"%f\",&amp;height);\n    printf(\"Enter width of rectangle :\");\n    scanf(\"%f\", &amp;width);\n\n    char choice;\n    printf(\"Enter P for perimeter and A for area: \");\n    scanf(\" %c\", choice);\n    if(choice=='P' || choice=='p'){       \n        printf(\"Width: %f\", width);\n        printf(\"Height: %f\", height);\n        perimeter= 2.0*(height*width);\n        printf(\"Perimeter of rectangle is: %f\", perimeter);\n    }else if(choice=='A' || choice=='a'){\n        printf(\"Width: %f\", width);\n        printf(\"Height: %f\", height);\n        area= (height*width);\n        printf(\"Area of rectangle is: %f\", area);\n    }else\n        printf(\"Invalid Input\");\n}\n</code></pre>\n"}, {"tags": ["c", "while-loop", "pthreads", "iteration", "mutex"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531324611, "post_id": 51289745, "comment_id": 89557348, "body": "So you know what mutex is and how to use it?"}, {"owner": {"reputation": 378, "user_id": 6952369, "user_type": "registered", "profile_image": "https://graph.facebook.com/1222752527797253/picture?type=large", "display_name": "Hongyu Wang", "link": "https://stackoverflow.com/users/6952369/hongyu-wang"}, "edited": false, "score": 0, "creation_date": 1531324660, "post_id": 51289745, "comment_id": 89557375, "body": "Can&#39;t u just use gettimeofday if you don&#39;t want to sleep your main thread?"}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 1, "creation_date": 1531324679, "post_id": 51289745, "comment_id": 89557386, "body": "Another approach may be another thread (that contains the code in the main), which is synchronised with <code>thread_proc</code> through a semaphore"}, {"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531324707, "post_id": 51289745, "comment_id": 89557404, "body": "@EugeneSh. I understand the concept, but I do not know how to use it"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531324748, "post_id": 51289745, "comment_id": 89557428, "body": "Simplest thing would be to &quot;guard&quot; your existing flag with the mutex. You must do it anyway, as you might have some race condition."}, {"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "reply_to_user": {"reputation": 378, "user_id": 6952369, "user_type": "registered", "profile_image": "https://graph.facebook.com/1222752527797253/picture?type=large", "display_name": "Hongyu Wang", "link": "https://stackoverflow.com/users/6952369/hongyu-wang"}, "edited": false, "score": 0, "creation_date": 1531324752, "post_id": 51289745, "comment_id": 89557433, "body": "@HongyuWang, thank you. I did consider this, I would just like to know if it is possible to do this with threads instead."}, {"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "reply_to_user": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1531324790, "post_id": 51289745, "comment_id": 89557459, "body": "@Jose, thank you, I did not consider this idea. Could you please expand on it?"}, {"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531324833, "post_id": 51289745, "comment_id": 89557474, "body": "@EugeneSh., thank you very much. How does guarding work here?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531324898, "post_id": 51289745, "comment_id": 89557512, "body": "Meaning that the thread which is accessing the flag (for read or write) should first aquire the mutex, and release after the operation."}, {"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531324951, "post_id": 51289745, "comment_id": 89557542, "body": "@EugeneSh. Perfect, I think I understand. Thank you very much."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1531325330, "post_id": 51289745, "comment_id": 89557738, "body": "A mutex is the wrong type of synchro.  Use a condvar or semaphore."}], "answers": [{"tags": [], "owner": {"reputation": 112, "user_id": 9835665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b2be8a4356b166b3f8a01e9a185b5e?s=128&d=identicon&r=PG&f=1", "display_name": "MasterRem", "link": "https://stackoverflow.com/users/9835665/masterrem"}, "is_accepted": false, "score": 1, "last_activity_date": 1531327992, "creation_date": 1531327992, "answer_id": 51290707, "question_id": 51289745, "link": "https://stackoverflow.com/questions/51289745/use-mutex-to-control-timing-of-while-loop/51290707#51290707", "title": "Use mutex to control timing of while loop", "body": "<p>You can use signals to communicate between threads.</p>\n\n<p>You block the first thread with a condition and a mutex locked by the calling thread. Then a second thread send a signal to unblock the thread blocked by the condition.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n\npthread_cond_t cv;\npthread_mutex_t lock;\n\nvoid *thread2(void *arg)\n{\n    //Send signal\n    pthread_cond_signal(&amp;cv);\n}\n\nint main()\n{\n    //Create thread2\n    pthread_t threadId;\n    pthread_create(&amp;threadId, NULL, &amp;thread2, NULL);\n\n    //Lock the mutex\n    pthread_mutex_lock(&amp;lock);\n\n    //Block the thread on a condition with the locked mutex\n    pthread_cond_wait(&amp;cv, &amp;lock);\n\n    printf(\"The thread is now unblocked\");\n\n    //Unlock the mutex\n    pthread_mutex_unlock(&amp;lock);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "is_accepted": true, "score": -1, "last_activity_date": 1557745814, "creation_date": 1557745814, "answer_id": 56111133, "question_id": 51289745, "link": "https://stackoverflow.com/questions/51289745/use-mutex-to-control-timing-of-while-loop/56111133#56111133", "title": "Use mutex to control timing of while loop", "body": "<p>Based on MasterRem's answer, you can do the following if you want to time an action, and use a <code>while</code> loop to do this repeatedly.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n\npthread_cond_t cv = PTHREAD_COND_INITIALIZER;\npthread_mutex_t lock;\n\nvoid *thread2(void *arg)\n{\n    while(1) {\n        sleep(1);\n        //Send signal\n        pthread_cond_signal(&amp;cv);\n    }\n}\n\nint main()\n{\n    //Create thread2\n    pthread_t threadId;\n    pthread_create(&amp;threadId, NULL, &amp;thread2, NULL);\n\n    //Lock the mutex\n    pthread_mutex_init(&amp;lock, NULL);\n    pthread_mutex_lock(&amp;lock);\n\n    int counter = 0;\n\n    while(1) {\n        //Block the thread on a condition with the locked mutex\n        pthread_cond_wait(&amp;cv, &amp;lock);\n        counter += 1;\n        printf(\"%d\\n\", counter);\n    }\n\n    //Unlock the mutex\n    pthread_mutex_unlock(&amp;lock);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 56111133, "answer_count": 2, "score": -1, "last_activity_date": 1557745814, "creation_date": 1531324483, "question_id": 51289745, "link": "https://stackoverflow.com/questions/51289745/use-mutex-to-control-timing-of-while-loop", "title": "Use mutex to control timing of while loop", "body": "<p>I would like to understand how to use threads to control the execution of an instruction within a loop. I cannot use sleep in the main function for this purpose, as that would block the main thread for some time. Instead, I just want to ensure that the next iteration of the while loop is not reached if a certain time hasn't elapsed yet. Currently, I have another thread that just enables a flag called <code>go_on</code>. </p>\n\n<p>It works, but, is there a way to do this with mutex?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid *thread_proc(void *arg)\n{\n    int *go_on = (int *)arg;\n    while(1)\n    {\n        sleep(1);\n        *(go_on) = 1;\n    }\n}\n\nint main()\n{\n    int go_on = 0;\n\n    pthread_t tid;\n    pthread_create(&amp;tid, NULL, &amp;thread_proc, (void *)&amp;go_on);\n\n    int counter = 0;    \n    while(1)\n    {\n        while(go_on == 0){};\n        go_on = 0;\n        counter += 1;\n        printf(\"%d\\n\", counter);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "cygwin", "codeblocks"], "comments": [{"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 0, "creation_date": 1531426277, "post_id": 51289705, "comment_id": 89604083, "body": "have you followed <code>readme.cyg</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 653, "user_id": 4410323, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NBejJ.png?s=128&g=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/4410323/sergio"}, "is_accepted": false, "score": 0, "last_activity_date": 1531691042, "last_edit_date": 1531691042, "creation_date": 1531676114, "answer_id": 51350611, "question_id": 51289705, "link": "https://stackoverflow.com/questions/51289705/dislin-is-not-working-on-code-blocks/51350611#51350611", "title": "DISLIN is not working on Code Blocks", "body": "<p>Perhaps you need to add the library files (with extension  *.a) and the library path to those files.</p>\n"}], "owner": {"reputation": 74, "user_id": 5949111, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-h5FOThFEtbA/AAAAAAAAAAI/AAAAAAAAAXY/_8pEOLMPCXQ/photo.jpg?sz=128", "display_name": "Josue Manuel Pareja Contreras", "link": "https://stackoverflow.com/users/5949111/josue-manuel-pareja-contreras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "closed_date": 1531684796, "answer_count": 1, "score": -1, "last_activity_date": 1531691042, "creation_date": 1531324350, "question_id": 51289705, "link": "https://stackoverflow.com/questions/51289705/dislin-is-not-working-on-code-blocks", "closed_reason": "Duplicate", "title": "DISLIN is not working on Code Blocks", "body": "<p>I am using:</p>\n\n<p>-IDE: Code Blocks 13.12</p>\n\n<p>-C language</p>\n\n<p>-Cygwin64 Compiler (<a href=\"http://www.cygwin.com/\" rel=\"nofollow noreferrer\">http://www.cygwin.com/</a>)</p>\n\n<p>-Dislin Distribution for Cygwin: dl_11_gc (<a href=\"http://www.mps.mpg.de/dislin/win-64-bit\" rel=\"nofollow noreferrer\">http://www.mps.mpg.de/dislin/win-64-bit</a>)</p>\n\n<p>-Windows 7 OS</p>\n\n<p>I have been trying to make DISLIN graphic library works on Code Blocks, the problem is that, even thougth I have added the correct path to the search directories I am always getting these kind of errors:</p>\n\n<pre><code>        undefined reference to `metafl'\n        undefined reference to `scrmod'\n        ...\n</code></pre>\n\n<p>These functions are used in the first example code that is provided in this link:<a href=\"http://www.mps.mpg.de/1757268/exa_c#section_1\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n\n<p>Apparently my Code Blocks project was able to find the \"dislin.h\" file, but I want to know what cause this kind of errors, do I am missing something?.</p>\n"}, {"tags": ["c", "structure", "padding"], "comments": [{"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1531323466, "post_id": 51289389, "comment_id": 89556663, "body": "This topic may be useful: <a href=\"https://stackoverflow.com/questions/4306186/structure-padding-and-packing\" title=\"structure padding and packing\">stackoverflow.com/questions/4306186/&hellip;</a>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1531323597, "post_id": 51289389, "comment_id": 89556743, "body": "What if you had an array of these structs?  You&#39;d need each of the elements of the array to be aligned."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1531323649, "post_id": 51289389, "comment_id": 89556769, "body": "The basic rule is that members still must be aligned correctly when the struct values are stored in an array.  With the double requiring alignment to 8, that can only happen when the struct has a size that is a multiple of 8.  16 is the next best match."}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 0, "creation_date": 1531323827, "post_id": 51289460, "comment_id": 89556886, "body": "@fvu It&#39;s not that it requires bigger alignment.  It just needs extra padding so that all elements of an array are aligned."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531324303, "post_id": 51289460, "comment_id": 89557158, "body": "Can you please explain &quot;properly aligned&quot;? I see no reason why doubles can&#39;t start on non-8 byte boundaries. Address calculation is just <code>&amp;x+(sizeof(x)*index)+offset(member)</code> in bytes."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531324597, "post_id": 51289460, "comment_id": 89557338, "body": "@PaulOgilvie While strictly speaking alignment is implementation defined, in general any non-derived type (<code>char</code>, <code>int</code>, <code>double</code>, pointers, etc.) is expected to reside at a memory address that is a multiple of the size of the object.  Some CPUs will generate a fault if unaligned memory access is performed."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531324956, "post_id": 51289460, "comment_id": 89557547, "body": "Is that CPU architecture or memory/bus architecture? (As long as the memory places the data on the data pins of the CPU, the CPU shouldn&#39;t care.) Anyway, I understand the padding is apparently a function of the architecture for which the compiler generates code."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531325314, "post_id": 51289460, "comment_id": 89557733, "body": "Hmmm...I forget the cache on the CPU chip, which is part of the memory architecture. So the CPU dictates the memory architecture and so dictates the allignment requirements. Upvote for your answer."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1531323729, "last_edit_date": 1531323729, "creation_date": 1531323548, "answer_id": 51289460, "question_id": 51289389, "link": "https://stackoverflow.com/questions/51289389/understanding-structure-padding-in-c/51289460#51289460", "title": "Understanding Structure Padding in C", "body": "<p>In the case of <code>x</code>, it contains a <code>double</code> which (in your case) has size 8.  That means that the structure as a whole needs to be a multiple of that size in order for an array of <code>x</code> to be properly aligned.  </p>\n\n<p>Since arrays are contiguously allocated, each member of the array comes immediately after the prior one in memory.  If <code>x</code> had size 10, then for an array the second element would have the <code>A</code> member at offset 10.  For proper alignment, each array member needs to start at a multiple of the size of the largest element.  So the structure contains padding at the end to accomplish this.</p>\n"}], "owner": {"reputation": 5, "user_id": 10065810, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qM7kAAu11Zw/AAAAAAAAAAI/AAAAAAAAAOU/FlVCTBrAjyM/photo.jpg?sz=128", "display_name": "mani kanta", "link": "https://stackoverflow.com/users/10065810/mani-kanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 51289460, "answer_count": 1, "score": 0, "last_activity_date": 1531323729, "creation_date": 1531323328, "last_edit_date": 1531323418, "question_id": 51289389, "link": "https://stackoverflow.com/questions/51289389/understanding-structure-padding-in-c", "title": "Understanding Structure Padding in C", "body": "<p>I understand by data alignment concept that int's and floats's should be stored at address which is divisible by 4 (the starting byte address) .According to it, the size of the below structure is 12</p>\n\n<pre><code> typedef struct{\n    char A;\n    int B;\n    float C;\n}y;\n</code></pre>\n\n<p>I have no doubt in understanding the size of above structure\nNow my doubt is about the size of below structure</p>\n\n<pre><code>typedef struct {\n    double A;\n    char B;\n    char C;\n}x;\n</code></pre>\n\n<p>the size of x is 16. what  my doubt  is that the two characters used can be allocated in 2 bytes such that a whole structure uses 10 bytes of data\nand the remaining 2 bytes  can be used to allocate to another short int when it was declared right? </p>\n\n<p>But the compiler uses 16 bytes of data and pads the other 6 cells. I can't understand why it is wasting another 6 cells if it can use them for another variables when they are declared?. Can anyone please help me in understanding the above concept?.(I am assuming the size of int ,float and double as 4,4,8 bytes respectively. )</p>\n"}, {"tags": ["c", "embedded", "structure", "instance"], "comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 3, "creation_date": 1531330406, "post_id": 51289325, "comment_id": 89560299, "body": "Off-site links to your code makes for a poor question.  Questions last indefinitely on SO; can you say the same for your externally served file?  If you later take that file down or it otherwise becomes unavailable, the question will no longer make much sense."}], "answers": [{"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531330627, "post_id": 51289375, "comment_id": 89560384, "body": "Whilst that is the way you would correctly do what Cy is attempting and failing to do, it is not a solution I&#39;d encourage. Globals - especially large and complex globals <a href=\"https://www.embedded.com/electronics-blogs/break-points/4025723/A-pox-on-globals\" rel=\"nofollow noreferrer\">should be avoided</a>"}, {"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531493195, "post_id": 51289375, "comment_id": 89630743, "body": "I never said use a global, I told him to put the structure in the header which is perfectly acceptable because it doesn&#39;t generate any actual code on it&#39;s own.  Then I told him what an extern actually is because he&#39;s not using it correctly.  A getter/setter would work but that&#39;s really dumb for a single member of the structure, especially when you&#39;re embedded and may be limited for space."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531496210, "post_id": 51289375, "comment_id": 89632599, "body": "In the question he is attempting to get global access to <code>struct gyro_State_s st</code>, and your answer tells him how to do that.  An accessor is exactly appropriate when you want access to a single member and <i>nothing else</i>.   Did you follow my link in the previous comment?  If you think globals are acceptable and an accessor &quot;really dumb&quot;, I think you are in the minority within the <i>profession</i>. As it happens if you look at the existing code you will see that there is already an &#39;setter&#39; accessor for that member, a &#39;getter&#39; is therefore entirely appropriate regardless."}, {"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531498578, "post_id": 51289375, "comment_id": 89633926, "body": "global access to the structure/member does NOT mean his instance of the structure is in global scope, or even globally defined. Global access simply means that wherever his instance is defined (global or not) he can still access the member.  A getter/setter for ONE member is brainbroken, if you&#39;re going the route of getter/setters then you should make getter/setters for all the members of the huge structure, which again is brainbroken especially in an embedded environment where space may be limited and you&#39;re wasting it writing identical getter/setter functions for every single member."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531500513, "post_id": 51289375, "comment_id": 89634891, "body": "This is no longer an appropriate discussion for comments.  Readers should take it or leave it, and you need not defend your solution - it was not an attack on your answer, merely advice (and I did not down-vote).  Your answer does not mention global data, but in the question Cy is attempting to make <code>st</code> global, and you assisted in this ill advised solution.  I have much to say on your opinion in comment, but it is irrelevant to the question in hand - you see out of touch with the fundamental principles of minimal coupling, maximal cohesion, access control and data hiding - not my problem.."}, {"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531503237, "post_id": 51289375, "comment_id": 89636098, "body": "Apologies I didn&#39;t realize he actually had a global instance already, I thought he had some instance &#39;st&#39; that he wanted to access from another file, and I didn&#39;t bother reading his externally linked source code so it seemed strange to create a getter for a single variable.  I am realizing now that the instance was global and static, in which case a getter would be the perfect solution, please excuse my lazy answer and ignorant comments.  And of course like you mentioned a getter will entirely decouple the calling code from the structure definition."}], "tags": [], "owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "is_accepted": false, "score": -2, "last_activity_date": 1531323295, "creation_date": 1531323295, "answer_id": 51289375, "question_id": 51289325, "link": "https://stackoverflow.com/questions/51289325/embedded-c-utilizing-a-flag-from-a-complex-structure/51289375#51289375", "title": "Embedded C utilizing a flag from a complex structure", "body": "<p>Put the structure in a shared header that is included in both files.</p>\n\n<p>extern means: 'this is defined/instantiated elsewhere'</p>\n\n<p>Since a structure on it's down doesn't compile to any physical code (an instance of a structure does, the structure itself just describes how to create an instance of it) you just need to define the same structure in both files, this is best done by putting the structure in a shared header then including the header in both of the files you need the structure in.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": -2, "last_activity_date": 1531501258, "last_edit_date": 1531501258, "creation_date": 1531328577, "answer_id": 51290852, "question_id": 51289325, "link": "https://stackoverflow.com/questions/51289325/embedded-c-utilizing-a-flag-from-a-complex-structure/51290852#51290852", "title": "Embedded C utilizing a flag from a complex structure", "body": "<p>Attempting to expose <em>all of <code>st</code></em> and its definition just to access this one flag is a bad design and should be avoided.  <a href=\"https://www.embedded.com/electronics-blogs/break-points/4025723/A-pox-on-globals\" rel=\"nofollow noreferrer\">Globals are always bad</a>, and in this case you would be unnecessarily making all the internals of <code>st</code> visible to the entire program.</p>\n\n<p>inv_mpu.c already has a function <code>mpu_set_bypass()</code> which is called before it is used, so must have a prototype somewhere, most likely in the existing header inv_mpu.h.  The simplest, safest and most in-keeping with the existing code style solution would be to add a \"<em>getter</em>\" accessor counter-part <code>mpu_get_bypass()</code>.</p>\n\n<p>In inv_mpu.c you might add:</p>\n\n<pre><code>unsigned char mpu_get_bypass( void )\n{\n    return st.chip_cfg.bypass_mode ;\n}\n</code></pre>\n\n<p>The add the prototype declaration to inv_mpu.h thus:</p>\n\n<pre><code>unsigned char mpu_get_bypass( void ) ;\n</code></pre>\n\n<p>Then in the accessing source file, you <code>#include \"inv_mpu.h\"</code>, then call the getter, thus for example:</p>\n\n<pre><code>if( !mpu_get_bypass() ) ...\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5403059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dRdJg8oOmsc/AAAAAAAAAAI/AAAAAAAAATI/LPGQwOMe86I/photo.jpg?sz=128", "display_name": "Cy Drollinger", "link": "https://stackoverflow.com/users/5403059/cy-drollinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 51290852, "answer_count": 2, "score": -1, "last_activity_date": 1531639161, "creation_date": 1531323130, "last_edit_date": 1531501096, "question_id": 51289325, "link": "https://stackoverflow.com/questions/51289325/embedded-c-utilizing-a-flag-from-a-complex-structure", "title": "Embedded C utilizing a flag from a complex structure", "body": "<p>In a source file <a href=\"https://drive.google.com/file/d/1IDhPfvlmOGV8HhAZx8WBUMZ-YNYk0SR9/view?usp=sharing\" rel=\"nofollow noreferrer\">inv_mpu.c</a> there is a structure definition <code>gyro_state_s</code> and a file scope variable declaration:</p>\n\n<pre><code>static struct gyro_state_s st = {\n    .reg = &amp;reg,\n    .hw = &amp;hw,\n    .test = &amp;test\n};\n</code></pre>\n\n<p>Nested in this structure is a member <code>st.chip_cfg.bypass_mode</code> that I wish to access from withing another file.</p>\n\n<p>Question: How to read the state of this flag <code>st.chip_cfg.bypass_mode</code> within another file?</p>\n\n<p>I have tried <code>extern struct gyro_State_s st ;</code>, but this remains unrecognized when I test it in <code>if(!st.chip_cfg.bypass_mode)</code>.</p>\n"}, {"tags": ["c", "linux", "sockets", "bind"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 2, "creation_date": 1531319257, "post_id": 51287930, "comment_id": 89553754, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/21099041/608639\">Why do we cast sockaddr_in to sockaddr when calling bind()?</a> and <a href=\"https://stackoverflow.com/q/27120486/608639\">Casting structure pointers between structs containing pointers to different types?</a>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1531340393, "post_id": 51287930, "comment_id": 89564753, "body": "I personally use an union for this case."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1531359117, "post_id": 51288055, "comment_id": 89569749, "body": "&quot;<i>Presumably, the <code>bind</code> function knows what kind of socket descriptor it has</i>&quot; - yes, as the address family is part of the socket&#39;s internal info. <code>bind()</code> (and <code>connect()</code>) validates the passed in <code>sockaddr</code> matches the socket&#39;s address family. &quot;<i>and converts the <code>struct sockaddr *</code> back to a <code>struct sockaddr_in *</code></i>&quot; - yes (for <code>AF_INET</code>) after checking that the passed <code>sockaddr</code> is the correct family AND byte size (which is why <code>bind()</code>, <code>connect()</code>, and <code>accept()</code> have a parameter to receive the size of the <code>sockaddr</code>). If a mismatch occurs, <code>bind()</code> (and <code>connect()</code> and <code>accept()</code>) fails."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1531319798, "last_edit_date": 1531319798, "creation_date": 1531319194, "answer_id": 51288055, "question_id": 51287930, "link": "https://stackoverflow.com/questions/51287930/why-does-a-cast-from-sockaddr-in-to-sockaddr-work/51288055#51288055", "title": "Why does a cast from sockaddr_in to sockaddr work", "body": "<p>It is allowed to convert a struct pointer to a different struct pointer and back.  This is detailed in section 6.3.2.3p7  of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p><strong>A pointer to an object type may be converted to a pointer to a\n  different object type.</strong> If the resulting pointer is not correctly\n  aligned for the referenced type, the behavior is undefined.\n  Otherwise, <strong>when converted back again, the result shall compare equal\n  to the original pointer.</strong> When a pointer to an object is converted to a\n  pointer to a character type, the result points to the lowest addressed\n  byte of the object. Successive increments of the result, up to the\n  size of the object, yield pointers to the remaining bytes of the\n  object.</p>\n</blockquote>\n\n<p>There is a restriction in the above passage regarding alignment which is further detailed in section 6.2.5p28:</p>\n\n<blockquote>\n  <p>A pointer to void shall have the same representation and alignment\n  requirements as a pointer to a character type.48) Similarly, pointers\n  to qualified or unqualified versions of compatible types shall have\n  the same representation and alignment requirements. <strong>All pointers to\n  structure types shall have the same representation and alignment\n  requirements as each other.</strong> All pointers to union types shall have the\n  same representation and alignment requirements as each other. Pointers\n  to other types need not have the same representation or alignment\n  requirements.</p>\n</blockquote>\n\n<p>Presumably, the <code>bind</code> function knows what kind of socket descriptor it has and converts the <code>struct sockaddr *</code> back to a <code>struct sockaddr_in *</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1531358673, "post_id": 51288071, "comment_id": 89569656, "body": "&quot;<i>So any \u201cchild\u201d struct that may be sent must have 14 bytes of data in it, no more or less</i>&quot; - not true. <code>sockaddr</code> is defined the way it is to maintain size-compatibility with <code>sockaddr_in</code>, which is 16 bytes, and is what <code>sockaddr</code> <i>used</i> to be in the days when <code>AF_INET</code> was the only address family. But newer families are NOT limited to 14 bytes of data. For instance, <code>sockaddr_in6</code> has <b>26 bytes</b> (the <code>sin6_addr</code> field alone is <b>16 bytes</b>). The ONLY requirement is ALL <code>sockaddr_...</code> types MUST start with a 2-byte <code>family</code> member, whose value dictates the size of the remaining data."}], "tags": [], "owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "is_accepted": true, "score": 3, "last_activity_date": 1531319624, "last_edit_date": 1531319624, "creation_date": 1531319255, "answer_id": 51288071, "question_id": 51287930, "link": "https://stackoverflow.com/questions/51287930/why-does-a-cast-from-sockaddr-in-to-sockaddr-work/51288071#51288071", "title": "Why does a cast from sockaddr_in to sockaddr work", "body": "<p>The <code>sockaddr</code> struct basically has only one field, the address family. The code that receives this structure can use this field to determine what is the actual type of the structure. All the structures that are really used also have this field as the first one and therefore the value is deterministic. </p>\n\n<p>The implementations also make the structures the same size with padding, so the memory usage is also completely deterministic. This makes it work properly. </p>\n\n<p>For example Microsoft defines the <a href=\"https://docs.microsoft.com/en-us/cpp/mfc/reference/sockaddr-structure\" rel=\"nofollow noreferrer\"><code>sockaddr</code></a> structure in Visual Studio 2017 as</p>\n\n<pre><code>struct sockaddr {  \n    unsigned short sa_family;  \n    char sa_data[14];  \n};\n</code></pre>\n\n<blockquote>\n  <p>sa_data<br>\n  Maximum size of all the different socket address structures.</p>\n</blockquote>\n\n<p>So any \u201cchild\u201d struct that may be sent must have 14 bytes of data in it, no more or less. </p>\n\n<p>Whereas <code>sockaddr_in</code> is</p>\n\n<pre><code>struct sockaddr_in{  \n    short sin_family;  \n    unsigned short sin_port;  \nstruct in_addr sin_addr;  \n    char sin_zero[8];  \n};\n</code></pre>\n\n<p>Here the port and <code>in_addr</code> require six bytes in total so 8 bytes of padding is used to keep the size the same as <code>sockaddr</code>.</p>\n\n<p>Of course it would be possible to create for example <code>sockaddr_un</code>, set its address family to claim it\u2019s <code>sockaddr_in</code> and any code receiving the structure would cast it wrong and get completely wrong values. </p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1531359325, "post_id": 51288085, "comment_id": 89569782, "body": "The only common field in all <code>sockaddr_...</code> structs is the 1st field - the address <code>family</code>.  Based on that value alone, <code>bind()</code> can cast the <code>sockaddr*</code> pointer to a more appropriate pointer type (<code>sockaddr_in*</code>, <code>sockaddr_in6*</code>, <code>sockaddr_un*</code>, etc).  Couple that with the <code>addrlen</code> parameter, which <code>bind()</code> uses to check that the <code>sockaddr*</code> points to a buffer that is large enough for <code>bind()</code> to safely access all of the <code>sockaddr_...</code> fields after performing the cast."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1531319289, "creation_date": 1531319289, "answer_id": 51288085, "question_id": 51287930, "link": "https://stackoverflow.com/questions/51287930/why-does-a-cast-from-sockaddr-in-to-sockaddr-work/51288085#51288085", "title": "Why does a cast from sockaddr_in to sockaddr work", "body": "<p>It works because the <code>bind</code> function uses only some of the first fields that apparently are the same in all the elements of the <code>sockrt_addr</code> struct family.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 2, "last_activity_date": 1531339608, "creation_date": 1531339608, "answer_id": 51293470, "question_id": 51287930, "link": "https://stackoverflow.com/questions/51287930/why-does-a-cast-from-sockaddr-in-to-sockaddr-work/51293470#51293470", "title": "Why does a cast from sockaddr_in to sockaddr work", "body": "<p>The <code>sockaddr</code> type is intended for use on quality compilers that are suitable for low-level programming.  On such compilers, casting the address of a structure to a pointer of a different structure type that shares a common initial sequence will yield a pointer that may be used to inspect members of that common initial sequence at least until one of the following has occurred:</p>\n\n<ol>\n<li><p>Code writes those fields via means other than the derived pointer.</p></li>\n<li><p>Code forms a pointer, via means other than the derived pointer, that will be used to write those fields.  [A compiler might reorder a subsequent write via the latter pointer back to the point where it is created, even if the write \"should\" be after the code that inspects the CIS member, but a compiler can't reorder such a write unless it can prove that it will be performed].</p></li>\n<li><p>Code enters a loop wherein one of the above will occur.</p></li>\n<li><p>Code calls a function wherein one of the above will occur.</p></li>\n</ol>\n\n<p>From the point of view of the Standard, support for constructs like the above is essentially a quality-of-implementation issue.  The Rationale expressly recognizes the possibility that a \"conforming\" implementation might be of such poor quality as to be useless.  Any allowance for compilers that are too primitive to handle even simple cases like those described above (e.g. gcc and clang) should be viewed in that light.</p>\n"}], "owner": {"reputation": 1973, "user_id": 7721600, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WsGqD.jpg?s=128&g=1", "display_name": "Moritz Schmidt", "link": "https://stackoverflow.com/users/7721600/moritz-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1680, "favorite_count": 0, "accepted_answer_id": 51288071, "answer_count": 4, "score": 3, "last_activity_date": 1587911344, "creation_date": 1531318795, "last_edit_date": 1587911344, "question_id": 51287930, "link": "https://stackoverflow.com/questions/51287930/why-does-a-cast-from-sockaddr-in-to-sockaddr-work", "title": "Why does a cast from sockaddr_in to sockaddr work", "body": "<p>In the C language a typical way to <code>bind</code> a Socket would be the following way:</p>\n\n<pre><code>int server_socket_fd = socket(AF_INET, SOCK_STREAM, 0);\nstruct sockaddr_in addr;\nint port_number = 55555;\n\naddr.sin_family = AF_INET;\naddr.sin_addr.s_addr = htonl(INADDR_ANY);\naddr.sin_port = htons(port_number);\n\nint result = bind(server_socket_fd,(struct sockaddr *)&amp;addr , sizeof(addr));\nif(bind_result &gt; 0)\n{\n    // Stuff\n}\n</code></pre>\n\n<p>I am wondering why the cast from <code>sockaddr_in</code> to <code>sockaddr</code> works since I cant find any documentation why it works.\nIt just seems like everyone just does it.</p>\n\n<p>Why does the typecast work here?</p>\n\n<p>I am not asking why we cast it, this has been answered <a href=\"https://stackoverflow.com/questions/21099041/why-do-we-cast-sockaddr-in-to-sockaddr-when-calling-bind\">here</a>. I am asking why it works.</p>\n"}, {"tags": ["c", "gcc", "gdb"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531318376, "post_id": 51287694, "comment_id": 89553096, "body": "Is the <code>printf</code> printing the expected values?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1531318507, "post_id": 51287694, "comment_id": 89553189, "body": "My guess is that <code>p&#47;x *ptr</code> includes the <i>padding</i> between members. Related question: <a href=\"https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member\">Why isn&#39;t sizeof for a struct equal to the sum of sizeof of each member?</a>"}, {"owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531318593, "post_id": 51287694, "comment_id": 89553252, "body": "@Some programmer dude I think you mean <i>excludes</i>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531318689, "post_id": 51287694, "comment_id": 89553309, "body": "Note there is one padding byte after the <code>char[3]</code>. Nothing is changed."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "edited": false, "score": 0, "creation_date": 1531318757, "post_id": 51287694, "comment_id": 89553370, "body": "@meat <i>Includes</i> like in printing the padding bytes"}, {"owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "edited": false, "score": 0, "creation_date": 1531318885, "post_id": 51287694, "comment_id": 89553459, "body": "You&#39;re right. Misinterpreted what he was saying."}, {"owner": {"reputation": 156, "user_id": 5990941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787acc022c8bd1bc888352d89aa4d8f6?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash Bansal", "link": "https://stackoverflow.com/users/5990941/prakash-bansal"}, "edited": false, "score": 0, "creation_date": 1531320535, "post_id": 51287694, "comment_id": 89554765, "body": "I ran your code through gcc version 4.8.1 and also through an online gcc compiler and the code works fine. The output is what you desire."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531320725, "post_id": 51287694, "comment_id": 89554898, "body": "Correct printf format for short is &quot;hx&quot;..."}, {"owner": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "edited": false, "score": 0, "creation_date": 1531321788, "post_id": 51287694, "comment_id": 89555624, "body": "print is also not printing correct values.It looks padding is doing something wrong here.  Same code when I run in home computer it is working fine."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531321832, "post_id": 51287694, "comment_id": 89555657, "body": "What does it print?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531322008, "post_id": 51287694, "comment_id": 89555760, "body": "@Aconcagua <code>short</code> in variadic argumens is promoted to <code>int</code> anyway"}, {"owner": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "edited": false, "score": 0, "creation_date": 1531322082, "post_id": 51287694, "comment_id": 89555806, "body": "0x4400    0xff29    0xfff  This is the output"}, {"owner": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "edited": false, "score": 0, "creation_date": 1531322181, "post_id": 51287694, "comment_id": 89555871, "body": "In f1() function , data is started 1 byte earlier."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531322224, "post_id": 51287694, "comment_id": 89555905, "body": "Somehow I tend not to believe you.... Are you sure you are running the exact same code you have posted?"}, {"owner": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "edited": false, "score": 0, "creation_date": 1531322423, "post_id": 51287694, "comment_id": 89556055, "body": "Eugene Sh :- Yes . same code is not working in office. Even I discussed this with my 4 to 5 colleague. None of them was able to explain the reason."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531322461, "post_id": 51287694, "comment_id": 89556072, "body": "Which compiler are you using?"}, {"owner": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "edited": false, "score": 0, "creation_date": 1531322553, "post_id": 51287694, "comment_id": 89556145, "body": "gcc 4.9.3 on Ubuntu 14 with gdb 7.7.1"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531322958, "post_id": 51287694, "comment_id": 89556394, "body": "Then it sounds like some compiler bug or, which is more likely, you are doing something wrong. Like not compiling after the change or something."}, {"owner": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "edited": false, "score": 0, "creation_date": 1531324605, "post_id": 51287694, "comment_id": 89557345, "body": "Yes it could be compiler bug. I will check again and come back"}], "answers": [{"comments": [{"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "edited": false, "score": 0, "creation_date": 1531493322, "post_id": 51296857, "comment_id": 89630824, "body": "@shekharsingh Rearranged in what way? Did you find the problem?"}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1531365803, "creation_date": 1531365803, "answer_id": 51296857, "question_id": 51287694, "link": "https://stackoverflow.com/questions/51287694/struct-values-are-changing-from-one-function-to-other-in-unexpected-manner/51296857#51296857", "title": "struct values are changing from one function to other in unexpected manner", "body": "<blockquote>\n  <p>Can any one explain what happened</p>\n</blockquote>\n\n<p>The most likely explanation is that</p>\n\n<ul>\n<li>the functions <code>f</code> and <code>f1</code> are in different translation units, and</li>\n<li>the definition of <code>struct abc</code> is <em>different</em> between them (for example, in one translation unit the struct has <code>__attribute__((packed))</code>, while in the other one it doesn't.</li>\n</ul>\n\n<p>If so, this is an ODR (one definition rule) violation; your program is malformed, no compiler diagnostic required.</p>\n\n<p>Printing <code>sizeof(struct abc)</code> in both <code>f</code> and <code>f1</code> is one way to confirm or disprove this guess.</p>\n\n<p>If the sizes <em>are</em> different, then saving pre-processed output (<code>gcc -E</code>) and looking inside for how <code>struct abc</code> is defined will likely be illuminating.</p>\n"}], "owner": {"reputation": 61, "user_id": 2381572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4160b5999d01839f292f8d9f6e76ec7e?s=128&d=identicon&r=PG", "display_name": "shekhar singh", "link": "https://stackoverflow.com/users/2381572/shekhar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531365803, "creation_date": 1531318177, "question_id": 51287694, "link": "https://stackoverflow.com/questions/51287694/struct-values-are-changing-from-one-function-to-other-in-unexpected-manner", "title": "struct values are changing from one function to other in unexpected manner", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct\n{\n    unsigned char a[3];\n    unsigned short data[3];\n    unsigned int d1;\n    unsigned int d2;\n} abc; \n\nvoid f1(abc *ptr)\n{\n    printf(\"values are :0x%x  \\t0x%x  \\t0%x\",ptr-&gt;data[0],ptr-&gt;data[1],ptr-&gt;data[2]);\n    //Hex map of ptr  is given below (taken by  gdb --&gt; x/20b ptr )\n    //ptr--&gt;0x01 0x00 0x00 0x00 0x44 0x29 0xff 0xff\n    //      0xff 0xff        \n}\nvoid f()\n{\n    abc req;\n    req.a[0]=1;\n    req.a[1]=0;\n    req.a[2]=0;\n    req.data[0]=0x2944;\n    req.data[1]=0xffff;\n    req.data[2]=0xffff;\n    req.d1= 0xffff;\n    req.d2= 0xffff;\n    f1(&amp;req);   \n\n    //Hex map of req  is given below (taken by  gdb --&gt; x/20b req )\n    // req--&gt; 0x01 0x00 0x00 0x00 0x44 0x29 0xff 0xff\n    //        0xff 0xff    \n}\nint main()\n{\n    f();\n    return 0;\n}\n</code></pre>\n\n<p>I am working on the code sample given above . \nfilling values in one struct in 1 function and passing struct to other function.\nBut values of struct are changed in the caller function. When I checked with gdb, struct byte representation is same.\nBut some how values are changed. Can any one explain what happened and how to overcome it\ngcc version is 4.9.3 and gdb version is 7.7.1 and OS is ubuntu 14.</p>\n\n<p>Below is the output from gdb.</p>\n\n<pre><code>req values in f() --&gt; \n(gdb) p/x req\n$1 = {\n  a = {0x1, 0x0, 0x0},\n  data = {0x2944, 0xffff, 0xffff},\n  d1 = 0xffff,\n  d2 = 0xffff\n\n(gdb) x/20b &amp;req\n0xffffcb80:     0x01    0x00    0x00    0x00    0x44    0x29    0xff    0xff\n\n\nptr values in f1()----&gt;\n(gdb) p/x *ptr\n$1 = {\n  a = {0x1, 0x0, 0x0},\n  data = {0x4400, 0xff29, 0xffff},\n\n  (gdb) x/20b ptr\n0xffffcb80:     0x01    0x00    0x00    0x00    0x44    0x29    0xff    0xff\n</code></pre>\n"}, {"tags": ["c", "strlen"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1531317640, "post_id": 51287436, "comment_id": 89552469, "body": "How do you define your string&#39;s length when it&#39;s not NUL-terminated?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 4, "creation_date": 1531317877, "post_id": 51287436, "comment_id": 89552658, "body": "To use <code>strnlen()</code>, the second argument needs to specify an upper limit of length.   In your case, the call of <code>strnlen()</code> should not have a second argument exceeding <code>5</code>.   If you don&#39;t respect that, you will cause undefined behaviour, and there is no way around that."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1531317877, "post_id": 51287436, "comment_id": 89552659, "body": "The question is how to use <code>strnlen</code> and is tagged with C, not how to avoid <code>strnlen</code> and ditch C."}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1531317879, "post_id": 51287436, "comment_id": 89552661, "body": "The C-safe approach may be <code>strnlen</code> or <code>memchr</code>"}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1531317878, "post_id": 51287556, "comment_id": 89552660, "body": "Not so fast. The behaviour of reading uninitialised bytes <code>char</code> by <code>char</code> is not undefined. But indeed reading beyond the buffer <i>is</i> undefined."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1531317954, "post_id": 51287556, "comment_id": 89552726, "body": "@Bathsheba True in theory, very much <i>not</i> true in practice; every compiler I have tested takes J.2 &quot;The behavior is undefined if ... a value [of any type whatsoever, whether or not it has trap representations] is used while it is indeterminate&quot; as normative, even though a close reading of the actual text does not go that far."}, {"owner": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "edited": false, "score": 0, "creation_date": 1531318104, "post_id": 51287556, "comment_id": 89552847, "body": "In this case it is undefined as the allocated block is 5 bytes and the <code>strnlen</code> max len is <code>10</code>, therefore, that is a problem. Else if the <code>maxlen</code> is less than or equal to the allocated memory block length, then it should be fine."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "edited": false, "score": 1, "creation_date": 1531318205, "post_id": 51287556, "comment_id": 89552931, "body": "@phoxis: It was incorrect prior to the edit, my guess is that the downvoters have not retracted yet."}, {"owner": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1531318338, "post_id": 51287556, "comment_id": 89553062, "body": "@Bathsheba: You are correct: &quot; You&#39;re reading uninitialized bytes, &quot; part is not correct."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1531318587, "last_edit_date": 1531318587, "creation_date": 1531317844, "answer_id": 51287556, "question_id": 51287436, "link": "https://stackoverflow.com/questions/51287436/how-to-use-strnlen-safely/51287556#51287556", "title": "How to use strnlen safely?", "body": "<p>This code will most likely invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  </p>\n\n<p>The bytes returned by <code>malloc</code> have indeterminate values.  If there are no null bytes in the 5 bytes that are returned, then <code>strnlen</code> will read past those bytes since it was passed a max of 10, and reading past the end of allocated memory invokes undefined behavior.</p>\n\n<p>Simply reading the bytes that were returned however should <em>not</em> be undefined.  While indeterminate values could hold a trap representation,  <code>strnlen</code> reads the bytes using a <code>char *</code>, and character types do <em>not</em> have trap representation, so the values are merely unspecified and reading them is safe.</p>\n\n<p>If the value passed to <code>strnlen</code> is no larger than the size of allocated memory, then its usage is safe.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 6, "last_activity_date": 1531318137, "creation_date": 1531318137, "answer_id": 51287672, "question_id": 51287436, "link": "https://stackoverflow.com/questions/51287436/how-to-use-strnlen-safely/51287672#51287672", "title": "How to use strnlen safely?", "body": "<p>In order to use <code>strnlen</code> safely you need to</p>\n\n<ol>\n<li><p>Keep track of the size of the input buffer yourself (5 in your case) and pass <em>that</em> as the second parameter, <em>not</em> a number greater than that.</p></li>\n<li><p>Make sure the input pointer is not <code>NULL</code>.</p></li>\n<li><p>Make sure another thread is not writing to the buffer.</p></li>\n</ol>\n\n<p>Formally, you don't need to initialise the contents of the buffer, as conceptually the function reads the buffer as if they are <code>char</code> types.</p>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1531321481, "post_id": 51287725, "comment_id": 89555418, "body": "You&#39;ve almost answered the first part of the question (<i>Is this behavior undefined?</i>), but not the main question (<i>What&#39;s the correct way to use <code>strnlen()</code>?</i>).  So this doesn&#39;t really qualify as an answer, I&#39;m afraid."}], "tags": [], "owner": {"reputation": 29, "user_id": 9820010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6efe532f99fae7c41a17fd2ee2a307?s=128&d=identicon&r=PG&f=1", "display_name": "Tutulan Andrei", "link": "https://stackoverflow.com/users/9820010/tutulan-andrei"}, "is_accepted": false, "score": 0, "last_activity_date": 1531318264, "creation_date": 1531318264, "answer_id": 51287725, "question_id": 51287436, "link": "https://stackoverflow.com/questions/51287436/how-to-use-strnlen-safely/51287725#51287725", "title": "How to use strnlen safely?", "body": "<p>Since the actual length of data is 5 and you most likely don't have a '\\0' in there, it will start reading unallocated memory(starting at data[5]), which might be a little unpleasant.</p>\n"}], "owner": {"reputation": 9495, "user_id": 1395740, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/793c4377313587d742fad6f069d92d89?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/1395740/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "accepted_answer_id": 51287672, "answer_count": 3, "score": 1, "last_activity_date": 1531318587, "creation_date": 1531317536, "last_edit_date": 1531317851, "question_id": 51287436, "link": "https://stackoverflow.com/questions/51287436/how-to-use-strnlen-safely", "title": "How to use strnlen safely?", "body": "<p>I am trying to understand what is the correct way to use <code>strnlen</code> so that it will be used safely even considering edge cases.</p>\n\n<p>Like for example having a non null-terminated string as input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    void* data = malloc(5);\n\n    size_t len = strnlen((const char*)data, 10);\n    printf(\"len = %zu\\n\", len);\n\n    return 0;\n}\n</code></pre>\n\n<p>If I expect a string of max size <code>10</code>, but the string does not contain the null character within those 10 characters <code>strnlen</code> will read out of bounds bytes (the input pointer may point to heap allocated data). Is this behavior undefined? If yes, is there a way to safely use <code>strnlen</code> to compute the length of a string which takes into account this type of scenario and does not lead to undefined behavior?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531316962, "post_id": 51287190, "comment_id": 89551898, "body": "you&#39;re forgetting 1) to use your <code>myfile</code> variable (you have to format your command) 2) a <code>&gt;</code> just before the file. But don&#39;t do this, use <code>popen</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1531317016, "post_id": 51287190, "comment_id": 89551944, "body": "You escape all backslashes <i>except one</i> (or possibly three, depending on what <code>Location</code> is)."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10037856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da9d9bd57d97301a13f4c66215a73fb?s=128&d=identicon&r=PG&f=1", "display_name": "Chess Man", "link": "https://stackoverflow.com/users/10037856/chess-man"}, "edited": false, "score": 0, "creation_date": 1531326436, "post_id": 51287379, "comment_id": 89558275, "body": "Thank you very much. I&#39;ll be working on familiarizing myself with this code. Thank you for the thorough explanation."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1531317386, "creation_date": 1531317386, "answer_id": 51287379, "question_id": 51287190, "link": "https://stackoverflow.com/questions/51287190/ipconfig-all-using-c-programming-leads-to-incomplete-command-line-error/51287379#51287379", "title": "Ipconfig /all using C programming leads to incomplete command line error", "body": "<p>a lot of errors here</p>\n\n<ul>\n<li>not using the string you just inputted</li>\n<li>wrong escaping of backslashes</li>\n<li>forgetting a redirection in the command line (just before the filename). Ex: <code>system(\"C:\\\\Windows\\\\System32\\\\ipconfig /all 2&gt;&amp;1 &gt; myfile.txt\")</code></li>\n</ul>\n\n<p>but:</p>\n\n<ul>\n<li>you shouldn't use <code>system</code> for this, <code>popen</code> can get a command output, no need for ugly redirections</li>\n<li>no need to silence standard error, all the interesting output is in standard output</li>\n<li>no need to specify the path for the command it's a system command already in the path</li>\n</ul>\n\n<p>my proposal using <code>popen</code> (which is missing some error checking and whatnot, but basically works) which returns you a pipe handle. Just read it char by char until the end and write the result in an output file:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define MAX_LEN 20\n\nint main()\n{\n    char myfile[MAX_LEN];\n\n    printf (\"Enter text file name: \");\n    fflush(stdout);\n    scanf (\"%19s\", myfile);\n    FILE *f = popen(\"ipconfig /all\",\"r\");\n    FILE *fw = fopen(myfile,\"w\");\n    if (fw)\n    {\n     while(1)\n     {\n       int c = fgetc(f);\n       if (c == EOF) break;\n       fputc(c,fw);\n     }\n     fclose(fw);\n     pclose(f);\n    }\n\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10037856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da9d9bd57d97301a13f4c66215a73fb?s=128&d=identicon&r=PG&f=1", "display_name": "Chess Man", "link": "https://stackoverflow.com/users/10037856/chess-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 51287379, "answer_count": 1, "score": -2, "last_activity_date": 1531317386, "creation_date": 1531316898, "question_id": 51287190, "link": "https://stackoverflow.com/questions/51287190/ipconfig-all-using-c-programming-leads-to-incomplete-command-line-error", "title": "Ipconfig /all using C programming leads to incomplete command line error", "body": "<p>A programming beginner here so I am working on a simple program that uses the user's input to name a text file and then the program stores the ipconfig /all information in that text file. I receive an error \"unrecognized or incomplete command line.\" I understand it's quite easy to write the ipconfig /all to a text file using the command prompt but I was hoping to get it working using C. </p>\n\n<p>Thank you!</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n\n#define MAX_LEN 20\n\nint main()\n{\n    char myfile[MAX_LEN];\n\n    printf (\"Enter text file name: \");\n    scanf (\"%s\", myfile);\n\n    system(\"C:\\\\Windows\\\\System32\\\\ipconfig /all 2&gt;&amp;1 \\\\Location\\myfile.txt\");\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "permutation", "itertools"], "comments": [{"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1531319010, "post_id": 51287171, "comment_id": 89553567, "body": "@anatolyg  I need select k of n permutations, that link just permutes a complete range"}, {"owner": {"reputation": 128, "user_id": 9898745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5505187ff447cfc66920b143ba0532?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/9898745/emil"}, "edited": false, "score": 0, "creation_date": 1531319290, "post_id": 51287171, "comment_id": 89553777, "body": "Along with using the code for <code>std::next_permutation</code>, <a href=\"https://stackoverflow.com/a/28712605/9898745\">this algorithm</a> is what you are looking for. The algorithm is an answer to the question : <a href=\"https://stackoverflow.com/q/28711797/9898745\">Generating N choose K Permutations in C++</a>. The key is to reverse the elements from <code>k+1</code> to <code>n</code> after each permutation to avoid duplicate permutations."}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "reply_to_user": {"reputation": 128, "user_id": 9898745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5505187ff447cfc66920b143ba0532?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/9898745/emil"}, "edited": false, "score": 0, "creation_date": 1531319484, "post_id": 51287171, "comment_id": 89553930, "body": "@Emil no that works on the principle of choose k then permute those k, the order of permutations is different from my desired output. Look at behaviour difference in output of choose k and permute and my desired output. also specifically needs to be in C"}, {"owner": {"reputation": 128, "user_id": 9898745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5505187ff447cfc66920b143ba0532?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/9898745/emil"}, "edited": false, "score": 0, "creation_date": 1531319616, "post_id": 51287171, "comment_id": 89554049, "body": "I see what you are saying. This actually reminds me of heap&#39;s algorithm."}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "reply_to_user": {"reputation": 128, "user_id": 9898745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5505187ff447cfc66920b143ba0532?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/9898745/emil"}, "edited": false, "score": 0, "creation_date": 1531319693, "post_id": 51287171, "comment_id": 89554113, "body": "@Emil yup, have linked that in my question as well"}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "reply_to_user": {"reputation": 128, "user_id": 9898745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5505187ff447cfc66920b143ba0532?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/9898745/emil"}, "edited": false, "score": 0, "creation_date": 1531338842, "post_id": 51287171, "comment_id": 89564107, "body": "@Emil based on Heaps algorithm I found a solution that works take a look"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1531344867, "post_id": 51287171, "comment_id": 89566479, "body": "That has nothing whatsoever to do with Heap&#39;s algorithm. But if it works for you, that&#39;s cool."}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531337286, "post_id": 51292710, "comment_id": 89563408, "body": "but I am looking for incremental permutation? since these permutation act an indices for a large k dimensional data set (k&gt;=10) and I need to beable to access nextPerm and possibly prevoiusPerm"}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1531347327, "post_id": 51292710, "comment_id": 89567324, "body": "Did you read my answer? My algorithm is exactly what you describe in the first part of your answer. I just didn&#39;t define swap and reverse methods and instead did those directly in place. Maybe I&#39;m missing something."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1531347558, "post_id": 51292710, "comment_id": 89567405, "body": "@joseph: Yes, they&#39;re essentially the same, now that I look at it. Maybe I should have left the Heap&#39;s k-permutation solution at the beginning."}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1531347719, "post_id": 51292710, "comment_id": 89567457, "body": "Confirms that I&#39;m not crazy :) anywho, I really like your explanation and implementation"}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1531349790, "post_id": 51292710, "comment_id": 89567950, "body": "@rici I&#39;m removing my answer as yours is a million times better in every regard. Leaving mine would only take away."}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531379174, "post_id": 51292710, "comment_id": 89575326, "body": "I would love to.. only i mentioned 2 things.. code needs to be in c only, and it fails to compile as a C file i need to change my environment to cpp. 2nd there is an error in your second algorithm."}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "reply_to_user": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1531380066, "post_id": 51292710, "comment_id": 89575849, "body": "@JosephWood Heap permute does not give output in lexicographical order and first algorithm is worse that n^k iterations"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531381163, "post_id": 51292710, "comment_id": 89576506, "body": "@siddharth: the code is certainly C. Neither algorithm is n^k; what evidence do you have of that? And what error do you claim there is anything in the Heap algorithm? (It is certainly true that it does not produce lexicographic order. That&#39;s by design.)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1531381829, "post_id": 51292710, "comment_id": 89576908, "body": "Of course, there are n!/(n-k)! k-permutations of a set of n elements, so any algorithm which generates all of them will take O(n!/(n-k)!) to produce them all. There&#39;s no way around that."}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531383936, "post_id": 51292710, "comment_id": 89578194, "body": "@rici I am using a VC 2018 c environment and it fails to compile with a simple copy paste give 4000+ errors. that is besides the point, it could be a VC issue. 2nd the &quot;minor&quot; error is in th e k_heap function <code>return helper(array, n - k, k, n, baton, process);</code> baton and process args need to be reversed. 3rd you are only counting the recursion is the program order, not the flip,reverse and swap statements. run your programs for k = 5 and n = 52. you will get some interesting results. Your effective order is O(k!)(n!)/(n-k)!"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 1, "creation_date": 1531404276, "post_id": 51292710, "comment_id": 89592102, "body": "@siddharth: Maybe you copy+pasted incorrectly. The only MSVC incompatibility I know of is the use of a VLA in the main function, which is hardly relevant to the algorithm implementation. I don&#39;t have MSVC but I checked it with gcc.godbolt.org: <a href=\"https://godbolt.org/g/u5kwnH\" rel=\"nofollow noreferrer\">godbolt.org/g/u5kwnH</a> (I changed <code>int elements[n]</code> to <code>int elements[52]</code> in that version to avoid the lack of VLAs.)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1531404459, "post_id": 51292710, "comment_id": 89592235, "body": "I fixed the copy&amp;paste error I made with the change to argument order. Sorry about that, and thanks for reporting it."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1531405010, "post_id": 51292710, "comment_id": 89592584, "body": "I ran k_heap_permute with k=5 and n=52, as suggested, and it printed the expected 311875200 5-permutations in 144 seconds. Of course, most of that time is printing; when I changed the callback to just count calls and added counters to the helper functions, it took 6.2 seconds and reported &quot;311875200 permutations; 7485004799 swaps; 311875200 flips; 0 rotate_lefts&quot;. (Since it always makes the same decision at the bottom of the recursion, you either get all flips or all rotate_lefts). The 7485004799 swaps are because flip calls swap 23 times (to flip 47 elements), plus one swap per permutation."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1531405595, "post_id": 51292710, "comment_id": 89593005, "body": "Interestingly, k_heap_permute with k=5 and n=53 took about half the time despite generating about 10% more permutations, because rotate_left is faster than flip. But both are O(n-k), so I think the time to produce all n!/(n-k)! permutations is (n-k)n!/(n-k)! == n!/(n-k-1)!. Why do you think it is multiplied by k! ?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531444802, "post_id": 51292710, "comment_id": 89609200, "body": "@SiddharthChabra: So I figured out how to get rid of the (n-k) multiplier in the Heap&#39;s algorithm implementation, but I suppose you&#39;re not interested because of the interface and the fact that it generates the permutations in a different order. But just to let you know, I generated the 5/52 permutations in exactly 1 second in a single thread on an i7 laptop. That&#39;s 3 nanoseconds each, although of course all I do is count them."}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531477396, "post_id": 51292710, "comment_id": 89621075, "body": "@rici I am always interested in improvement. If you run my last implementation of next per. I get it to run n=52 k=5 in 1.5 seconds on a 6 year old i5. If you make nested for loops you get the perms in an insane 0.5 seconds. The problem with your implementation of heaps algorithm is that you are permuting elements in place . That means your algo is slowed down because you have to access elements which is an array lookup which is slower that an increment nor decrement. My implementation skips this. I am purmuting indices. So a swap for you in an increment for me. Hence my in order algo faster"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531497096, "post_id": 51292710, "comment_id": 89633129, "body": "@siddharth: That&#39;s an interesting point. Certainly, a general-purpose algorithm is going to be a bit slower. But I can still beat your generator using an in-place heap permuter, particularly as k grows larger (because of the k&#178; factor from the backwards search)."}, {"owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "edited": false, "score": 0, "creation_date": 1531507352, "post_id": 51292710, "comment_id": 89637922, "body": "@rici agreed but i need ordered perms which your faster algo doe now give"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 3, "last_activity_date": 1582027505, "last_edit_date": 1582027505, "creation_date": 1531336446, "answer_id": 51292710, "question_id": 51287171, "link": "https://stackoverflow.com/questions/51287171/generating-k-permutations-from-n-in-c/51292710#51292710", "title": "Generating k permutations from n in C", "body": "<p>There are simple modification to the standard permutation algorithms which will produce k-permutations.</p>\n\n<h3>Lexicographically-ordered permutations (aka <code>std::next_permutation</code>)</h3>\n\n<p>In C++, k-permutations can be generated by the simple expedient using <code>std::next_permutation</code>, and just reversing the <code>n-k</code>-suffix of the permutation before each call to <code>std::next_permutation</code>.</p>\n\n<p>It's reasonably clear how that works: the algorithm generates permutations in order, so the first permutation starting with a given prefix has the remaining suffix in increasing order, and the last permutation with the same prefix has its suffix in decreasing order. Decreasing order is simply the reverse of increasing order, so a single call to <code>std::reverse</code> is sufficient.</p>\n\n<p>The lexicographical order next-permutation algorithm is very simple:</p>\n\n<ol>\n<li><p>Search backwards from the end for an element which could be increased by swapping it with some later element.</p></li>\n<li><p>Once the rightmost such element is found, find the smallest following element with which it could be swapped, and swap them.</p></li>\n<li><p>Sort the new suffix into increasing order (by reversing it, since it was previously in decreasing order).</p></li>\n</ol>\n\n<p>An advantage of the lexicographical algorithm is that it transparently handles arrays with repeated elements. As long as the number of repetitions of any given element is O(1), <code>next-permutation</code> is amortized O(1) (per call), and in the worst case it is O(n). When generating k-permutations, the extra flip causes the cost of <code>next_k_permutation</code> to be O(n-k), which is effectively O(n) if <code>k</code> is fixed. That's still reasonably fast, but not as fast as non-iterative algorithms which can maintain state instead of doing the search in step 1 to figure out which element to move.</p>\n\n<p>The following C implementation is equivalent to <code>std::reverse(); std::next_permutation();</code> (except that it swaps before reversing):</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n\n/* Helper functions */\nstatic void swap(int* elements, size_t a, size_t b) {\n  int tmp = elements[a]; elements[a] = elements[b]; elements[b] = tmp;\n}\nstatic void flip(int* elements, size_t lo, size_t hi) {\n  for (; lo + 1 &lt; hi; ++lo, --hi) swap(elements, lo, hi - 1);\n}\n\n/* Given an array of n elements, finds the next permutation in\n * lexicographical order with a different k-prefix; in effect, it \n * generates all k-permutations of the array.\n * It is required that the suffix be sorted in ascending order. This\n * invariant will be maintained by the function.\n * Before the first call, the array must be sorted in ascending order.\n * Returns true unless the input is the last k-permutation.\n */ \nint next_k_permutation(int* elements, size_t n, size_t k) {\n  // Find the rightmost element which is strictly less than some element to its\n  // right.\n  int tailmax = elements[n - 1];\n  size_t tail = k;\n  while (tail &amp;&amp; elements[tail - 1] &gt;= tailmax)\n    tailmax = elements[--tail];\n  // If no pivot was found, the given permutation is the last one.\n  if (tail) {\n    size_t swap_in;\n    int pivot = elements[tail - 1];\n    // Find the smallest element strictly greater than the pivot, either\n    // by searching forward from the pivot or backwards from the end.\n    if (pivot &gt;= elements[n - 1]) {\n      for (swap_in = tail; swap_in + 1 &lt; k &amp;&amp; elements[swap_in + 1] &gt; pivot; ++swap_in) {}\n    } else {\n      for (swap_in = n - 1; swap_in &gt; k &amp;&amp; elements[swap_in - 1] &gt; pivot; --swap_in) {}\n    }\n    // Swap the pivots\n    elements[tail - 1] = elements[swap_in];\n    elements[swap_in] = pivot;\n    // Flip the tail. \n    flip(elements, k, n);\n    flip(elements, tail, n);\n  }\n  return tail;\n}\n</code></pre>\n\n<p>Here's a simple driver and a sample run:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint intcmp(const void* a, const void* b) {\n  return *(int*)a &lt; *(int*)b ? -1 : \n         *(int*)a &gt; *(int*)b ?  1 :\n                                0 ;\n}\n\nint main(int argc, char** argv) {\n  size_t k = (argc &gt; 1) ? atoi(argv[1]) : 0;\n  if (argc &lt; k + 2) {\n    fprintf(stderr, \"Usage: %s K element...\\n\"\n                    \"       where K &lt;= number of elements\\n\",\n                    argv[0]);\n    return 1;\n  }\n  size_t n = argc - 2;\n  int elements[n];\n  for (int i = 0; i &lt; n; ++i) elements[i] = atoi(argv[i + 2]);\n  qsort(elements, n, sizeof *elements, intcmp);\n  do {\n    const char* delimiter = \"\";\n    for (size_t i = 0; i &lt; k; ++i) {\n      printf(\"%s%2d \", delimiter, elements[i]);\n      delimiter = \" \";\n    }\n    putchar('\\n');\n  } while (next_k_permutation(elements, n, k));\n  return 0;\n}\n</code></pre>\n\n<p>Sample run (with repeated element):</p>\n\n<pre><code>$ ./k_next_permutation 2 7 3 4 4 5\n 3   4 \n 3   5 \n 3   7 \n 4   3 \n 4   4 \n 4   5 \n 4   7 \n 5   3 \n 5   4 \n 5   7 \n 7   3 \n 7   4 \n 7   5 \n</code></pre>\n\n<h3>Modified Heap's algorithm</h3>\n\n<p>As an example of an algorithm which maintains state, Heap's algorithm can be easily modified to produce k-permutations. The only change is that when the algorithm recurses down to position <code>n - k</code>, the k-suffix is reported as the k-permutation and the (n-k)-prefix is transformed the way the Heap algorithm would transform it if it were run to conclusion: the prefix reversed if its length is odd and rotated one to the left if its length is even. (That's a big hint about how Heap's algorithm works, by the way.)</p>\n\n<p>Using the recursive algorithm is a bit annoying because it doesn't really allow incremental permutations. However, it's simple to follow. Here, I've just passed a functor into the recursive procedure which is called with each permutation in turn.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stddef.h&gt;\n\n/* Helper functions */\nstatic void swap(int* elements, size_t a, size_t b) {\n  int tmp = elements[a]; elements[a] = elements[b]; elements[b] = tmp;\n}\nstatic void flip(int* elements, size_t lo, size_t hi) {\n  for (; lo + 1 &lt; hi; ++lo, --hi) swap(elements, lo, hi - 1);\n}\nstatic void rotate_left(int* elements, size_t lo, size_t hi) {\n  if (hi &gt; lo) {\n    int tmp = elements[lo];\n    for (size_t i = lo + 1; i &lt; hi; ++i) elements[i - 1] = elements[i];\n    elements[hi - 1] = tmp;\n  }\n}\n\n/* Recursive function; the main function will fill in the extra parameters */\n/* Requires hi &gt;= lo and hi &gt;= k. Array must have size (at least) lo + k */    \nstatic bool helper(int* array, size_t lo, size_t k, size_t hi,\n                       bool(*process)(void*, int*, size_t), void* baton) {\n  if (hi == lo) {\n    if (!process(baton, array + lo, k)) return false;\n    if (lo % 2)\n      flip(array, 0, lo);\n    else\n      rotate_left(array, 0, lo);\n  }\n  else {\n    for (size_t i = 0; i &lt; hi - 1; ++i) {\n      if (!helper(array, lo, k, hi - 1, process, baton))\n        return false;\n      swap(array, hi % 2 ? 0 : i, hi - 1);\n    }\n    if (!helper(array, lo, k, hi - 1, process, baton))\n      return false;\n  }\n  return true;\n}\n\n/* Generate all k-permutations of the given array of size n.\n * The process function is called with each permutation; if it returns false,\n * generation of permutations is terminated.\n */ \nbool k_heap_permute(int* array, size_t n, size_t k,\n                    bool(*process)(void*, int*, size_t), void* baton) {\n  assert(k &lt;= n);\n  return helper(array, n - k, k, n, process, baton);\n}\n</code></pre>\n\n<p>Here's an example of its use:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nbool print_array(void* vf, int* elements, size_t n) {\n  FILE* f = vf;\n  const char* delim = \"\";\n  for (size_t i = 0; i &lt; n; ++i) {\n    fprintf(f, \"%s%2d\", delim, elements[i]);\n    delim = \" \";\n  }\n  putc('\\n', f);\n  return true;\n}\n\nint main(int argc, char** argv) {\n  size_t k = (argc &gt; 1) ? atoi(argv[1]) : 0;\n  if (argc &lt; k + 2) {\n    fprintf(stderr, \"Usage: %s K element...\\n\"\n                    \"       where K &lt;= number of elements\\n\",\n                    argv[0]);\n    return 1;\n  }\n  size_t n = argc - 2;\n  int elements[n];\n  for (int i = 0; i &lt; n; ++i)\n    elements[i] = atoi(argv[i + 2]);\n  k_heap_permute(elements, n, k, print_array, stdout);\n  return 0;\n}\n</code></pre>\n\n<p>Sample run:</p>\n\n<pre><code>$ ./permut 2      1 5 9 7 3\n 7  3\n 9  3\n 5  3\n 1  3\n 1  5\n 7  5\n 9  5\n 3  5\n 3  9\n 1  9\n 7  9\n 5  9\n 5  7\n 3  7\n 1  7\n 9  7\n 9  1\n 5  1\n 3  1\n 7  1\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 8277802, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159015143920646/picture?type=large", "display_name": "Siddharth Chabra", "link": "https://stackoverflow.com/users/8277802/siddharth-chabra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1240, "favorite_count": 2, "accepted_answer_id": 51292710, "answer_count": 1, "score": 4, "last_activity_date": 1582027505, "creation_date": 1531316833, "last_edit_date": 1531344000, "question_id": 51287171, "link": "https://stackoverflow.com/questions/51287171/generating-k-permutations-from-n-in-c", "title": "Generating k permutations from n in C", "body": "<p>I basically need the equivalent result of the following Python <code>itertools</code> command in C:</p>\n\n<p><code>a = itertools.permutations(range(4),2))</code></p>\n\n<p>Currently my process involves first \"choosing\" 5 elements from 10 then generating permutations for those 5 elements as shown <a href=\"http://faculty.cse.tamu.edu/djimenez/ut/utsa/cs3343/lecture25.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>The issue with this approach is the order of the outputs. I need it to be (a), while what i get is (b), shown below.</p>\n\n<pre><code>a = itertools.permutations(range(4),2)\nfor i in a:\n    print(i)\n\n(0, 1)\n(0, 2)\n(0, 3)\n(1, 0)\n(1, 2)\n(1, 3)\n(2, 0)\n(2, 1)\n(2, 3)\n(3, 0)\n(3, 1)\n(3, 2)\n\nb = itertools.combinations(range(4),2) \nfor i in b:\n    c = itertools.permutations(i)\n    for j in c:\n        print(j)\n(0, 1)\n(1, 0)\n(0, 2)\n(2, 0)\n(0, 3)\n(3, 0)\n(1, 2)\n(2, 1)\n(1, 3)\n(3, 1)\n(2, 3)\n(3, 2)\n</code></pre>\n\n<p>An alternate approach which I am using is as follows</p>\n\n<pre><code>void perm(int n, int k)\n{\n    bool valid = true;\n    int h = 0, i = 0, j = 0, limit = 1;\n    int id = 0;\n    int perm[10] = { 0,0,0,0,0,0,0,0,0,0 };\n    for (i = 0; i &lt; k; i++)\n        limit *= n;\n    for (i = 0; i &lt; limit; i++)\n    {\n        id = i;\n        valid = true;\n        for (j = 0; j &lt; k; j++)\n        {\n            perms[j] = id % n;\n            id /= n;\n            for (h = j - 1; h &gt;= 0; h--)\n                if (perms[j] == perms[h])\n                {\n                    valid = false; break;\n                }\n            if (!valid) break;\n        }\n        if (valid)\n        {\n            for (h = k - 1; h &gt; 0; h--)\n                printf(\"%d,\", perms[h]);\n            printf(\"%d\\n\", perms[h]);\n            count++;\n        }\n    }\n}\n</code></pre>\n\n<p>Memory is my constraint, so I cannot store the permutations indefinitely. Performance needs to be better than the algorithm above, as when <code>n</code> is 50 and <code>k</code> is 10, I end up iterating through more invalid combinations(60+%)</p>\n\n<p>I am aware of <a href=\"https://en.wikipedia.org/wiki/Heap%27s_algorithm\" rel=\"nofollow noreferrer\">heaps algorithm</a> for generating permutations in place but again it generates for entire array not k of n like I need.</p>\n\n<p>Questions.</p>\n\n<ol>\n<li>Is there a better way to do this than iterate n^k times?</li>\n<li>Can I make a lazy iterator which moves to next permutation given current permutation?</li>\n</ol>\n\n<p><strong>EDIT</strong> this is not a duplicate of std::next_permutation implementation as that will permute and entire range of the input.\nI have clearly mentioned i need k of n permutation .ie if my range is 10 I want all permutations of a length (k) say 5,  std::next_permutation works when length or permutation is same as length of input range</p>\n\n<p><strong>UPDATE</strong>\nHere is an ugly recursive NextPerm solution which is about 4 times faster than my older solution and gives the incremental nextPerm like a Python lazy iterator.</p>\n\n<pre><code>int nextPerm(int perm[], int k, int n)\n{\n    bool invalid = true;\n    int subject,i;\n    if (k == 1)\n    {\n        if (perm[0] == n - 1)\n            return 0;\n        else { perm[0]=perm[0]+1; return 1; }\n    }\n    subject = perm[k - 1]+1;\n\n    while (invalid)\n    {\n        if (subject == n)\n        {\n            subject = 0;\n            if (!nextPerm(perm, k - 1, n))\n                return 0;\n        }\n        for (i = 0; i &lt; k-1; i++)\n        {\n            if (perm[i] != subject)\n                invalid = false;\n            else\n            {\n                invalid = true;subject++; break; \n            }\n        }\n    }\n    perm[k - 1] = subject;\n    return 1;\n}\nint main()\n{\n    int a, k =3 ,n = 10;\n    int perm2[3] = { 0,1,2}; //starting permutation\n    unsigned long long count = 0;\n    int depth = 0;\n    do\n    {\n        for (a = 0; a &lt; k - 1; a++)\n            printf(\"%d,\", perm2[a]);\n        printf(\"%d\\n\", perm2[k - 1]);\n        count++;\n    }\n    while (nextPerm(perm2,k,n));\n    printf(\"\\n%llu\", count);\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "compression", "gzip", "zlib", "stm32"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10005851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jm0IZaNlpuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3F-_3WphnrrzddctdEVndmHvnucA/mo/photo.jpg?sz=128", "display_name": "Jules A", "link": "https://stackoverflow.com/users/10005851/jules-a"}, "edited": false, "score": 0, "creation_date": 1531397322, "post_id": 51290788, "comment_id": 89587144, "body": "Alright, thanks, it works but I got another problem : my out buffer now has some null char in between the &quot;normal&quot; characters after the deflate. I used to call strlen(out buffer) . Is that normal behaviour ? Following question : I simulate streaming meaning that my string <code>answer</code> is filled multiple times. What do I have to do ? Using the deflateinit2 + deflate multiple times ? Cause it seems to only work once for now.."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "reply_to_user": {"reputation": 5, "user_id": 10005851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jm0IZaNlpuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3F-_3WphnrrzddctdEVndmHvnucA/mo/photo.jpg?sz=128", "display_name": "Jules A", "link": "https://stackoverflow.com/users/10005851/jules-a"}, "edited": false, "score": 0, "creation_date": 1531406693, "post_id": 51290788, "comment_id": 89593763, "body": "The result of deflate is binary data, which will have zeros with equal probability as any other byte value. You can&#39;t treat it as a &quot;string&quot;."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "reply_to_user": {"reputation": 5, "user_id": 10005851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jm0IZaNlpuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3F-_3WphnrrzddctdEVndmHvnucA/mo/photo.jpg?sz=128", "display_name": "Jules A", "link": "https://stackoverflow.com/users/10005851/jules-a"}, "edited": false, "score": 0, "creation_date": 1531406734, "post_id": 51290788, "comment_id": 89593793, "body": "You can look at <a href=\"http://zlib.net/zlib_how.html\" rel=\"nofollow noreferrer\">this example</a> for how to use the <code>deflate</code> and <code>inflate</code> functions."}, {"owner": {"reputation": 5, "user_id": 10005851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jm0IZaNlpuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3F-_3WphnrrzddctdEVndmHvnucA/mo/photo.jpg?sz=128", "display_name": "Jules A", "link": "https://stackoverflow.com/users/10005851/jules-a"}, "edited": false, "score": 0, "creation_date": 1531407082, "post_id": 51290788, "comment_id": 89594025, "body": "Alright thanks. Yea I already went through it but it&#39;s not really my case cause, in the example, we get a full buffer . Meanwhile, I wanna gzip my buffers one by one (and send them right after each operation)"}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "reply_to_user": {"reputation": 5, "user_id": 10005851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jm0IZaNlpuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3F-_3WphnrrzddctdEVndmHvnucA/mo/photo.jpg?sz=128", "display_name": "Jules A", "link": "https://stackoverflow.com/users/10005851/jules-a"}, "edited": false, "score": 0, "creation_date": 1531410659, "post_id": 51290788, "comment_id": 89596324, "body": "You need to ask a new question with more information on what you&#39;re trying to do."}, {"owner": {"reputation": 5, "user_id": 10005851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jm0IZaNlpuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3F-_3WphnrrzddctdEVndmHvnucA/mo/photo.jpg?sz=128", "display_name": "Jules A", "link": "https://stackoverflow.com/users/10005851/jules-a"}, "edited": false, "score": 0, "creation_date": 1531486304, "post_id": 51290788, "comment_id": 89626028, "body": "Done, thanks for the answer : <a href=\"https://stackoverflow.com/questions/51322449/c-loop-compression-send-gzip-zlib\">new question</a>"}], "tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": true, "score": 1, "last_activity_date": 1531328367, "creation_date": 1531328367, "answer_id": 51290788, "question_id": 51286931, "link": "https://stackoverflow.com/questions/51286931/z-mem-error-zlib-deflateinit2-embedded-device/51290788#51290788", "title": "Z_MEM_ERROR Zlib deflateInit2() embedded device", "body": "<p>zlib's deflate normally needs about 256K of RAM. See <a href=\"https://zlib.net/zlib_tech.html\" rel=\"nofollow noreferrer\">zlib technical details</a>. 30K is a bit restrictive, but you can still get deflate to work using the <code>memLevel</code> and <code>windowBits</code> parameters to reduce the memory footprint. From that page:</p>\n\n<pre><code>deflate memory usage (bytes) = (1 &lt;&lt; (windowBits+2)) + (1 &lt;&lt; (memLevel+9))\n</code></pre>\n\n<p>So you can get there with a <code>memLevel</code> of 5, and a <code>windowBits</code> of 11, taking about 24K (plus some other structures). This will reduce the compression effectiveness somewhat, but at least it will work. (You can still add 16 to <code>windowBits</code> for gzip encoding.)</p>\n"}], "owner": {"reputation": 5, "user_id": 10005851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jm0IZaNlpuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3F-_3WphnrrzddctdEVndmHvnucA/mo/photo.jpg?sz=128", "display_name": "Jules A", "link": "https://stackoverflow.com/users/10005851/jules-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 51290788, "answer_count": 1, "score": 0, "last_activity_date": 1531328367, "creation_date": 1531316226, "last_edit_date": 1531318452, "question_id": 51286931, "link": "https://stackoverflow.com/questions/51286931/z-mem-error-zlib-deflateinit2-embedded-device", "title": "Z_MEM_ERROR Zlib deflateInit2() embedded device", "body": "<p>Please mind this code:</p>\n\n<pre><code>  #define CHUNK 0x4000\n  z_stream strm;\n  unsigned char out[CHUNK];\n  int ret;\n\n  strm.zalloc = Z_NULL;\n  strm.zfree = Z_NULL;\n  strm.opaque = Z_NULL;\n\n  int windowsBits = 15;\n  int GZIP_ENCODING = 16;\n\n  ret = deflateInit2(&amp;strm, Z_BEST_SPEED, Z_DEFLATED, windowsBits | GZIP_ENCODING, 1, \n                     Z_DEFAULT_STRATEGY);\n  if(ret == Z_OK) {\n     strm.next_in = (z_const unsigned char *)answer;\n     strm.avail_in = strlen(answer);\n     do {\n        strm.avail_out = CHUNK;\n        strm.next_out = out;\n        ret = deflate(&amp;strm, Z_FINISH);\n     } while (strm.avail_out == 0);\n  }\n\n    /* clean up and return */\n  (void)deflateEnd(&amp;strm);\n</code></pre>\n\n<p>With <code>answer</code> (unsigned char array of 200 elements with the last one being \\0) filled in between the 4 declarations &amp; the rest.</p>\n\n<p>It crashes in the <code>deflateInit2</code> on <code>Z_MEM_ERROR</code>.</p>\n\n<p>I'm working on a STM32F4 (microcontroller). My RAM was almost full (~87%) before trying to implement the compression.</p>\n\n<p>I got this part working once when I used different parameters but I had an error later in the program(because I want to send the gzip'ed string to an HTTP output, error was: </p>\n\n<blockquote>\n  <p>unrecognized encoding.</p>\n</blockquote>\n\n<p>I have : ~30 KB of free RAM.</p>\n"}, {"tags": ["c", "lua"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1531316012, "post_id": 51286776, "comment_id": 89551165, "body": "Yes, the big important parts of Lua is written in C, like for example the actual compiler and interpreter, as well as some libraries. However, you only need the compiler <i>once</i>, to build the compiler, interpreter and the Lua libraries written in C. Once built, you don&#39;t need the C compiler anymore."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1531316031, "post_id": 51286776, "comment_id": 89551177, "body": "I can&#39;t answer the question completely, but a lot of languages use C or other such languages for their internal functioning or libraries. Some examples that come to mind are MATLAB and Python."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1531316347, "post_id": 51286776, "comment_id": 89551409, "body": "While you can theoretically build your own Lua libraries in other languages, you will need to translate the relevant parts of the Lua headers which make up the API. That&#39;s most likely more trouble than it&#39;s worth.."}, {"owner": {"reputation": 26889, "user_id": 369792, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fdc806d0a8834e57b2d9309849dea8cd?s=128&d=identicon&r=PG", "display_name": "Jason Goemaat", "link": "https://stackoverflow.com/users/369792/jason-goemaat"}, "edited": false, "score": 0, "creation_date": 1531464286, "post_id": 51286776, "comment_id": 89613997, "body": "If you want to embed LUA in an application written in a different language, you need some library in that language that interacts with LUA directly.  LUA is written in C.  If you are using C#, you should <i>probably</i> use a library that is meant to embed LUA in C#.  This will inevitably have some calls at some point that interact with the LUA C code directly.  Same for Java, Python, whatever you are using."}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 5524954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d40a932ec6ff67cda8ba84be8807295d?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger", "link": "https://stackoverflow.com/users/5524954/r%c3%bcdiger"}, "edited": false, "score": 0, "creation_date": 1531599689, "post_id": 51287131, "comment_id": 89659482, "body": "Alright, so where is the Lua interpreter when I just need to provide a C compiler to embed my Lua-code? How is the Lua code executed when it is not compiled before but also not transformed to C-code?"}, {"owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "reply_to_user": {"reputation": 661, "user_id": 5524954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d40a932ec6ff67cda8ba84be8807295d?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger", "link": "https://stackoverflow.com/users/5524954/r%c3%bcdiger"}, "edited": false, "score": 0, "creation_date": 1531600102, "post_id": 51287131, "comment_id": 89659582, "body": "@R&#252;diger, The Lua library contains a interpreter for a virtual machine. Lua scripts are compiled to instructions for this VM when scripts are loaded by the Lua library. The command line interpreter is just an interface to the Lua library."}], "tags": [], "owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "is_accepted": true, "score": 5, "last_activity_date": 1531316718, "creation_date": 1531316718, "answer_id": 51287131, "question_id": 51286776, "link": "https://stackoverflow.com/questions/51286776/why-are-lua-libraries-written-in-c-code/51287131#51287131", "title": "Why are Lua libraries written in C-Code", "body": "<p>Those instructions are for embedding Lua into your C or C++ program. In that case, you need to interact with the C API for Lua to run Lua scripts inside your program.</p>\n\n<p>If you want to program in pure Lua, you just need the Lua interpreter <code>lua</code>.</p>\n\n<p>Lua scripts are not converted to C before execution.</p>\n"}, {"comments": [{"owner": {"reputation": 661, "user_id": 5524954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d40a932ec6ff67cda8ba84be8807295d?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger", "link": "https://stackoverflow.com/users/5524954/r%c3%bcdiger"}, "edited": false, "score": 0, "creation_date": 1531599541, "post_id": 51292018, "comment_id": 89659448, "body": "Thanks for that. That means as soon as I do something network-related it is basically a C-library used there and nothing that I can do in pure lua? Did I get that right?"}, {"owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "reply_to_user": {"reputation": 661, "user_id": 5524954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d40a932ec6ff67cda8ba84be8807295d?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger", "link": "https://stackoverflow.com/users/5524954/r%c3%bcdiger"}, "edited": false, "score": 1, "creation_date": 1531600020, "post_id": 51292018, "comment_id": 89659559, "body": "@R&#252;diger Yes, you get it completely right. Of course, you can build libraries on local machine and copy to host (if same ABI is used (OS+Architecture))."}], "tags": [], "owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1531467128, "last_edit_date": 1531467128, "creation_date": 1531333364, "answer_id": 51292018, "question_id": 51286776, "link": "https://stackoverflow.com/questions/51286776/why-are-lua-libraries-written-in-c-code/51292018#51292018", "title": "Why are Lua libraries written in C-Code", "body": "<p>Another one thing to mention: many lua libraries (like <code>lua-socket</code>) <em>are</em> written on C, so you need compiler to use them.</p>\n\n<p>Why they use C? Because they do things <em>impossible</em> in pure lua (e.g, working with internet) due to extreme portable lua nature.</p>\n"}], "owner": {"reputation": 661, "user_id": 5524954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d40a932ec6ff67cda8ba84be8807295d?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger", "link": "https://stackoverflow.com/users/5524954/r%c3%bcdiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 51287131, "answer_count": 2, "score": 1, "last_activity_date": 1531467128, "creation_date": 1531315864, "question_id": 51286776, "link": "https://stackoverflow.com/questions/51286776/why-are-lua-libraries-written-in-c-code", "title": "Why are Lua libraries written in C-Code", "body": "<p>I have started to do some research about Lua and I got pretty confused about how <a href=\"https://www.lua.org/start.html#embedding\" rel=\"nofollow noreferrer\">embedded</a> Lua works:</p>\n\n<p>It says that </p>\n\n<blockquote>\n  <p>You'll also need a C or C++ compiler for your program, because the Lua headers and library are written in C.</p>\n</blockquote>\n\n<p>So that means, that I only need a C/C++ compiler for executing Lua, because the library and headers are written in C. That means that all the libraries I write and/or use are C-Code?</p>\n\n<p>I probably misunderstood that, but for me that would mean: </p>\n\n<p>I write some code in Lua and it gets translated into C-code before it is compiled? Or is there a difference between what I import as library and write as \"Lua-Code\"?</p>\n"}, {"tags": ["c++", "c", "optimization", "bit-manipulation", "vectorization"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 4, "creation_date": 1531311414, "post_id": 51285210, "comment_id": 89547762, "body": "BTW <code>1&lt;&lt;N</code> has type <i>int</i>. You need to cast <code>1</code> or suffix it <code>1U</code> for the arithmetic to happen with unsigned."}, {"owner": {"reputation": 7045, "user_id": 1000551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8cb0eaa4de7f781e42328ec7544ca3?s=128&d=identicon&r=PG", "display_name": "Vadim Kotov", "link": "https://stackoverflow.com/users/1000551/vadim-kotov"}, "edited": false, "score": 1, "creation_date": 1531311794, "post_id": 51285210, "comment_id": 89548061, "body": "Is it C or C++? Please take a look at <a href=\"https://meta.stackoverflow.com/a/252433/1000551\">meta.stackoverflow.com/a/252433/1000551</a>"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1531312200, "post_id": 51285210, "comment_id": 89548355, "body": "The <code>flag ||</code> is redundant, since the loop checks for <code>!flag</code>."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1531312489, "post_id": 51285210, "comment_id": 89548584, "body": "So N must be at most 32? And <code>i</code>, <code>is</code> and <code>pi</code> are constants, or just fixed for a given call?"}, {"owner": {"reputation": 779, "user_id": 5765675, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/449794481879116/picture?type=large", "display_name": "Meet Taraviya", "link": "https://stackoverflow.com/users/5765675/meet-taraviya"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531367710, "post_id": 51285210, "comment_id": 89571328, "body": "@AnttiHaapala I used a <code>#define</code> to set that (No overhead of memory access), and <code>N</code> will be atmost 20 (This was a part of larger program, and N=6 is already taking too lon)"}], "answers": [{"comments": [{"owner": {"reputation": 779, "user_id": 5765675, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/449794481879116/picture?type=large", "display_name": "Meet Taraviya", "link": "https://stackoverflow.com/users/5765675/meet-taraviya"}, "edited": false, "score": 0, "creation_date": 1531367519, "post_id": 51286586, "comment_id": 89571302, "body": "This was awesome! I tried to think on the same line, but was kind of struck on the third condition"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1531332552, "last_edit_date": 1531332552, "creation_date": 1531315341, "answer_id": 51286586, "question_id": 51285210, "link": "https://stackoverflow.com/questions/51285210/optimizing-a-check-using-bit-manipulations/51286586#51286586", "title": "Optimizing a check using bit manipulations", "body": "<p>A solution can be computed directly with no loops other than iterating through <code>pi_stack[i]</code> and <code>is_stack[i]</code>.</p>\n\n<p>A criterion of the form <code>(pi_ ^ v) &amp; m</code> requires that <code>pi_</code> and <code>v</code> have the same values in each bit position for which the bit is set in <code>m</code>.  We can represent that:</p>\n\n<pre><code>uint RequiredBits   = m; // Mask of bits that must have certain values.\nuint RequiredValues = v &amp; m; // Record of the values the bits must have.\n</code></pre>\n\n<p>Your tests show two such criteria:</p>\n\n<pre><code>((pi_ ^ pi) &amp; (is ^ N_MASK)) == 0\n\n((pi_ ^ pi_stack[i]) &amp; is_stack[i]) == 0\n</code></pre>\n\n<p>Suppose we have already represented the first criterion:</p>\n\n<pre><code>uint RequiredBits   = is ^ N_MASK;\nuint RequiredValues = pi &amp; RequiredBits;\n</code></pre>\n\n<p>Now we want to also require the second criterion. For brevity, let\u2019s assign <code>v = pi_stack[i]</code> and <code>m = is_stack[i]</code>. We have two problems: Is it possible to satisfy both criteria simultaneously?  And, if so, what one criterion is the combination of both?</p>\n\n<p>If <code>m</code> and <code>RequiredBits</code> do not have any set bits in common, then there is no conflict, because <code>pi_</code> is free to have the required values in whatever bit positions they each control. If they do have set bits in common, then <code>v</code> and <code>RequiredValue</code> must be the same in those bits, because <code>pi_</code> cannot have both 0 and 1 in the same position. So a test for conflict is:</p>\n\n<pre><code>if (((v ^ RequiredValues) &amp; (m &amp; RequiredBits)) != 0)\n    print/exit/return/whatever; // Report no solution is possible.\n</code></pre>\n\n<p>If the two criteria are consistent, then we can combine them:</p>\n\n<pre><code>RequiredValues = RequiredValues | (v &amp; m);\nRequiredBits   = RequiredBits | m;\n</code></pre>\n\n<p>If there are multiple instances of the criteria involving <code>pi_stack[i]</code> and <code>is_stack[i]</code> for different values of <code>i</code>, then the above can be repeated.</p>\n\n<p>Finally, we have the criterion  <code>pi_ ^ pi) &amp; is</code>. This says that <code>pi_</code> an <code>pi</code> must differ in at least one bit position for which the bit is set in <code>is</code>. This position must be a position that is not set in <code>RequiredBits</code>, because the earlier criteria require that <code>pi_</code> and <code>pi</code> be the same in those positions, and it is not possible for <code>pi_</code> and <code>pi</code> to be both the same and to differ in the same position.</p>\n\n<p>Therefore, <code>pi_</code> and <code>pi</code> must differ in at least one bit that is in <code>is &amp; ~RequiredBits</code>. If <code>is &amp; ~RequiredBits</code> is zero, this is not possible, because then there are no positions in <code>is</code> that <code>pi_</code> and <code>pi</code> are allowed to differ in. So we test:</p>\n\n<pre><code>if ((is &amp; ~RequiredBits) == 0)\n    print/exit/return/whatever; // Report no solution is possible.\n</code></pre>\n\n<p>Otherwise, we construct some differences between <code>pi_</code> and <code>pi</code> in the required (by <code>is</code>) and available (by <code>~RequiredBits</code>) positions:</p>\n\n<pre><code>uint Differences = ~pi &amp; (is &amp; ~RequiredBits);\n</code></pre>\n\n<p>Then a solution is:</p>\n\n<pre><code>uint pi_ = RequiredValues | Differences;\n</code></pre>\n\n<p>All possible solutions could be iterated by:</p>\n\n<ul>\n<li>Iterate all the bits of <code>pi_</code> other than those in <code>is | RequiredBits</code> through all possible values.</li>\n<li>Iterate all the bits of <code>pi_</code> that are in <code>is &amp; ~RequiredBits</code> through all possible values except <code>pi &amp; (is &amp; ~RequiredBits)</code> (because that is one in which all the bits specified by <code>is &amp; ~RequiredBits</code> have the values they do in <code>pi</code>, but we want at least one to be different).</li>\n</ul>\n"}], "owner": {"reputation": 779, "user_id": 5765675, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/449794481879116/picture?type=large", "display_name": "Meet Taraviya", "link": "https://stackoverflow.com/users/5765675/meet-taraviya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 51286586, "answer_count": 1, "score": 1, "last_activity_date": 1531332552, "creation_date": 1531311222, "last_edit_date": 1531311406, "question_id": 51285210, "link": "https://stackoverflow.com/questions/51285210/optimizing-a-check-using-bit-manipulations", "title": "Optimizing a check using bit manipulations", "body": "<p>I have the following code snippet as a part of one algorithm. I am using <code>pi_</code>, <code>pi</code>, <code>pi_stack[i]</code>, <code>is</code> and <code>is_stack[i]</code> (all <code>unsigned int</code>) as subsets of a set of size <code>N</code>.</p>\n\n<ul>\n<li><code>N_MASK=(1&lt;&lt;N)-1</code> is a mask that determines what portion of the <code>unsigned int</code> is useful.</li>\n<li><code>N_POLICY=(1&lt;&lt;N)</code>.</li>\n</ul>\n\n<p>I want to find if there exists a subset <code>pi_</code> such that <code>((pi_^pi) &amp; (is^N_MASK)) == 0 &amp;&amp; ((pi_^pi_stack[i]) &amp; is_stack[i]) == 0 &amp;&amp; ((pi_^pi) &amp; is)</code> holds true. Currently I am iterating over all possible subsets. What should be the relation between <code>is</code>, <code>pi_stack[i]</code>, <code>is_stack[i]</code> and <code>pi</code> so that no such <code>pi_</code> exists?</p>\n\n<pre><code>bool flag=false;\nfor(uint pi_=0; pi_&lt;N_POLICY &amp;&amp; !flag; pi_++){\n    flag = flag || (\n        ((pi_^pi) &amp; (is^N_MASK)) == 0 &amp;&amp;\n        ((pi_^pi_stack[i]) &amp; is_stack[i]) == 0 &amp;&amp;\n        ((pi_^pi) &amp; is)\n    );\n}\n</code></pre>\n\n<p>I came up with:-\n<code>flag = (((is_stack[i] &amp; (is^N_MASK)) &amp; (pi_stack[i]^pi))) || 0 == (is_stack[i] &amp; (pi^pi_stack[i])) ;</code> But this does not work, but it gives an idea of what I am looking for. This code was meant to replace the loop above.</p>\n"}, {"tags": ["c", "oop", "embedded"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531309703, "post_id": 51284409, "comment_id": 89546644, "body": "There&#39;s one thing you forget about your &quot;member functions&quot;: Passing the object itself! The compiler will not do it automatically, there&#39;s no <code>this</code> variable in the functions. You explicitly have to pass the object to the functions, by modifying them to take a <i>pointer</i> to the &quot;object&quot;."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531310159, "post_id": 51284409, "comment_id": 89546934, "body": "Ah, yes. Like <code>void write(sensor this, uint26_t param2)</code>? Yes this is needed if I wish to <code>self</code> address the object inside these functions. Good idea, I can have my buffer pointer and other stuff inside the object too. Everything will be so organized. Sorry, new to OOPs"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531320256, "post_id": 51284409, "comment_id": 89554558, "body": "Sidenote: That&#39;s a potentially dangerous thing, expecially in embedded systems. And many coding standards disallow function pointers in RAM or at least combined with the data."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531327253, "post_id": 51284409, "comment_id": 89558735, "body": "@Olaf I&#39;ve heard the dangers that function pointers can bring but the author &quot;Bruce Powel Douglass&quot; doesn&#39;t (or hasn&#39;t, I&#39;m still reading the book) addressed this in the book. How different is an embedded system to a PC when it has to handle function pointers? Also, how do you build modular, reusable code?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531330457, "post_id": 51284409, "comment_id": 89560321, "body": "@ClamentJohn: Would you like to be in your car/train/plane at 200+km/h if e.g. by EMI the pointer to the breeak function flips a bit?? I don&#39;t know the author, nor the book, but in general reading a book does not off-load one from thinking."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531340002, "post_id": 51284409, "comment_id": 89564593, "body": "@Olaf Woah can that seriously happen?! But your argument can apply to pure C too. The program counter could go to the wrong function (or no function at all) by a flip in bits."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531353968, "post_id": 51284409, "comment_id": 89568820, "body": "@ClamentJohn: This is certainly not the place to discuss good software design practice or principles of functional safety. So this is my last contribution: do you really consider anything which might go wrong with a game or document (which will show up on next load, btw.) to be as problematic as e.g. cars or medical devices? Btw: for all these OOP in C is common practice. Just not the way it seems to be propagated by this book. I leave it to you judge its quality in this light."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531370892, "post_id": 51284409, "comment_id": 89572045, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/174852/discussion-between-clament-john-and-olaf\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "edited": false, "score": 0, "creation_date": 1531309313, "post_id": 51284534, "comment_id": 89546337, "body": "Great, thank you! How can I change the parameter values <code>sensor Sensor1 = sensor_create(parameter1 = 22)</code> on run time? Eg, if two sensors are to have different settings"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531309469, "post_id": 51284534, "comment_id": 89546474, "body": "It can be abbreviated to: <code>sensor sensor_create(){return (sensor){1, 2, 3, 4, sensor_init, sensor_read, sensor_write};}</code> because all members are initialized so the membe designators are not needed (and my old C compiler likes it better)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "edited": false, "score": 0, "creation_date": 1531309470, "post_id": 51284534, "comment_id": 89546475, "body": "@ClamentJohn Unfortunately you then have to provide arguments for <i>all</i> member variables. You can create different factory functions taking different sets of parameters for different and common combinations."}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "edited": false, "score": 0, "creation_date": 1531309533, "post_id": 51284534, "comment_id": 89546522, "body": "Oh, got it. Thanks that was really helpful. So I use the factory function (which is again part of design pattern I hope to learn) to create the instance and before &#39;init&#39;, I have to update the &#39;params&#39;. Cool"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531309590, "post_id": 51284534, "comment_id": 89546563, "body": "@PaulOgilvie A compiler which accepts compound literals but not designators? That&#39;s a weird combination... :)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531309658, "post_id": 51284534, "comment_id": 89546612, "body": "No, you must update the instance <i>after</i> the factory function as that overwrites all membes."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531309844, "post_id": 51284534, "comment_id": 89546734, "body": "@Someprogrammerdude, indeed, VC2008 doesn&#39;t accept any of these forms."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531309959, "post_id": 51284534, "comment_id": 89546812, "body": "@PaulOgilvie Ah, well MSVC have always been the odd one out, especially the older versions... :)"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1531312902, "post_id": 51284534, "comment_id": 89548896, "body": "@Someprogrammerdude could you explain why there has to be a parenthesis around <code>return (sensor)...</code> ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 1, "creation_date": 1531313016, "post_id": 51284534, "comment_id": 89548964, "body": "@pbn My function is returning a <a href=\"https://en.cppreference.com/w/c/language/compound_literal\" rel=\"nofollow noreferrer\"><i>compound literal</i></a>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1531309047, "creation_date": 1531309047, "answer_id": 51284534, "question_id": 51284409, "link": "https://stackoverflow.com/questions/51284409/oops-in-c-default-values-for-classes/51284534#51284534", "title": "OOPs in C. Default values for classes", "body": "<p>You can make a <em>factory</em> function which creates and sets up your \"object\" from the \"class\". This is a very common way to do it.</p>\n\n<p>Example</p>\n\n<pre><code>sensor sensor_create()\n{\n    return (sensor){\n        .parameter1 = 1, .parameter2 = 2, .parameter3 = 3, .parameter4 = 4,\n       .initilize = sensor_init, .read = sensor_read, .write = sensor_write\n    };\n};\n\n// ...\n\nsensor Sensor1 = sensor_create();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1531310379, "creation_date": 1531310379, "answer_id": 51284939, "question_id": 51284409, "link": "https://stackoverflow.com/questions/51284409/oops-in-c-default-values-for-classes/51284939#51284939", "title": "OOPs in C. Default values for classes", "body": "<p>You can add your structure as parameter of your function pointer initialize:</p>\n\n<p><code>void (*initilize)(uint8_t parameter1, uint8_t parameter2, uint8_t, parameter3, uint8_t parameter4, struct class1_t *this);</code></p>\n\n<p>Then you can <code>this-&gt;parameter1 = parameter1;</code> in the initialize function</p>\n"}], "owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 51284534, "answer_count": 2, "score": 2, "last_activity_date": 1531310768, "creation_date": 1531308690, "last_edit_date": 1531310768, "question_id": 51284409, "link": "https://stackoverflow.com/questions/51284409/oops-in-c-default-values-for-classes", "title": "OOPs in C. Default values for classes", "body": "<p>I'm learning to write C in OOPs to learn design patterns mentioned in the book \"<a href=\"https://books.google.co.in/books/about/Design_Patterns_for_Embedded_Systems_in.html?id=UnpIKZmodSAC&amp;redir_esc=y&amp;hl=en\" rel=\"nofollow noreferrer\">Design Patterns for Embedded Systems in C</a>\" by Bruce Powel Douglass. </p>\n\n<p>I would like to make a <code>__init__</code> method like in python where values are predefined and only if the user/dev wishes to change it he/she needs to.</p>\n\n<p><strong>What have I done</strong><br/>I define an <code>instance of a struct</code> with default values and <code>extern</code> it to the application/middleware. So if the user needs two instances he needs to go create another instance with the default values.</p>\n\n<pre><code>/* Sensor */\ntypedef struct sensor sensor;\nstruct sensor{\n    uint8_t parameter1;\n    uint8_t parameter2;\n    uint8_t parameter3;\n    uint8_t parameter4;\n    void (*initilize)(uint8_t parameter1, uint8_t parameter2, \n            uint8_t, parameter3, uint8_t parameter4);\n    void (*read)(uint8_t * parameter1, uint16_t parameter2);\n    void (*write)(uint16_t *parameter2);\n};\n\nvoid sensor_init(sensor *this, uint8_t parameter1, uint8_t parameter2, \n            uint8_t, parameter3, uint8_t parameter4);\nvoid sensor_read(sensor *this, uint8_t * parameter1, uint16_t parameter2);\nvoid sensor_write(sensor *this, uint16_t *parameter2);\n</code></pre>\n\n<p>And then every time the user needs to make a new object me must:</p>\n\n<pre><code>sensor Sensor1 = {\n    .parameter1 = 1, .parameter2 = 2, .parameter3 = 3, .parameter4 = 4,\n    .initilize = sensor_init, .read = sensor_read, .write = sensor_write\n};\n</code></pre>\n\n<p>Is there a better way to initialize? Where the user/dev can call</p>\n\n<pre><code>sensor Sensor;\nSensor.init();\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sensor.Init(parameter1 = 22);\n</code></pre>\n\n<p>Something like polymorphism.</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "multitasking", "freertos"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1531324252, "post_id": 51284339, "comment_id": 89557126, "body": "&#39;simple&#39; and &#39;reading&#39; are not often seen in the same sentence when discussing I/O in an RTOS environment.  Interrupts, DMA and kenel signaling are usually required to perform I/O in any kind of efficient, RTOS-friendly manner:("}], "answers": [{"tags": [], "owner": {"reputation": 836, "user_id": 724291, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2d3db1d74832604414387026e5bc3c8a?s=128&d=identicon&r=PG", "display_name": "lkanab", "link": "https://stackoverflow.com/users/724291/lkanab"}, "is_accepted": false, "score": 2, "last_activity_date": 1541042426, "creation_date": 1541042426, "answer_id": 53094791, "question_id": 51284339, "link": "https://stackoverflow.com/questions/51284339/when-should-i-use-threads-within-tasks-freertos/53094791#53094791", "title": "When should I use threads within tasks? - FreeRTOS", "body": "<p>FreeRTOS have tasks. pthread is suggested as a wrapper to task for portability and compatability with POSIX systems and code.</p>\n\n<p>Anyway, FreeRTOS do not have memory seperation, virtualization and remapping on context switch between tasks, so all it's tasks are what POSIX would call threads.</p>\n"}], "owner": {"reputation": 65, "user_id": 7977981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b0tV2.jpg?s=128&g=1", "display_name": "prodx", "link": "https://stackoverflow.com/users/7977981/prodx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1983, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1541042426, "creation_date": 1531308488, "last_edit_date": 1531309695, "question_id": 51284339, "link": "https://stackoverflow.com/questions/51284339/when-should-i-use-threads-within-tasks-freertos", "title": "When should I use threads within tasks? - FreeRTOS", "body": "<p>I'm about to develop an FreeRTOS based embedded system that will run on a ESP32 chip. According to the <a href=\"https://esp-idf.readthedocs.io/en/latest/api-reference/system/index.html\" rel=\"nofollow noreferrer\">API Reference</a> I can create tasks and as well as pthreads. </p>\n\n<p>Is there any rule of thumb that tells me if I should implement a functionality as a task or as thread? \nFor example: If I'd like to handle three peripherals paralelly (just simple reading, so: short code, low performace, nearly any memory needed), I should create a new task or a new thread?</p>\n"}, {"tags": ["python", "c", "inheritance", "cython", "cythonize"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1531308606, "post_id": 51284315, "comment_id": 89545875, "body": "Unless the bottlenecks is in your code, there&#39;s not much you can do really. The Python libraries you use are highly optimized and for the critical parts they are already coded in C or C++. To find the bottlenecks you need to <i>profile</i> your code. And even if your code <i>is</i> the bottleneck, you could possibly optimize the worst parts, or convert only parts of your code to C, instead of rewriting your whole project."}, {"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1531314612, "post_id": 51284315, "comment_id": 89550127, "body": "<a href=\"https://spark.apache.org/\" rel=\"nofollow noreferrer\">Apache Spark</a> might be interesting to you too. It has ML capabilities as well and handles parallelization very nicely (yes, it&#39;s for Python too). I definitely agree with the others though that you should profile your code. Your logic is likely a bottleneck somewhere, though Spark could give you extra performance on top of that fix as well."}], "answers": [{"comments": [{"owner": {"reputation": 1118, "user_id": 1507669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pMaaM.jpg?s=128&g=1", "display_name": "hmmftg", "link": "https://stackoverflow.com/users/1507669/hmmftg"}, "edited": false, "score": 0, "creation_date": 1531728000, "post_id": 51284483, "comment_id": 89686364, "body": "Hi, thanks for your advice, you mean I can move some time consuming function in my code to C and re-implement them, then call them from python and this will give me better performance?"}, {"owner": {"reputation": 638, "user_id": 253154, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c51aa59aedc21fa58d287a9060ad714e?s=128&d=identicon&r=PG", "display_name": "jdowner", "link": "https://stackoverflow.com/users/253154/jdowner"}, "reply_to_user": {"reputation": 1118, "user_id": 1507669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pMaaM.jpg?s=128&g=1", "display_name": "hmmftg", "link": "https://stackoverflow.com/users/1507669/hmmftg"}, "edited": false, "score": 0, "creation_date": 1531731061, "post_id": 51284483, "comment_id": 89687977, "body": "That is a reasonable path to take. If you are comfortable in C then writing a python extension is pretty straightforward (see <a href=\"https://docs.python.org/3/extending/index.html\" rel=\"nofollow noreferrer\">docs.python.org/3/extending/index.html</a>)."}], "tags": [], "owner": {"reputation": 638, "user_id": 253154, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c51aa59aedc21fa58d287a9060ad714e?s=128&d=identicon&r=PG", "display_name": "jdowner", "link": "https://stackoverflow.com/users/253154/jdowner"}, "is_accepted": true, "score": 3, "last_activity_date": 1531308899, "creation_date": 1531308899, "answer_id": 51284483, "question_id": 51284315, "link": "https://stackoverflow.com/questions/51284315/convert-python-project-into-c/51284483#51284483", "title": "Convert Python Project Into C", "body": "<p>I believe the answer is no -- you are not going to be able to do a simple conversion to C for the whole project. At least, not in a way that is likely to give you better performance. Also, the libraries you have listed are mostly implemented in C already, so the calls to those libraries are generally fast.</p>\n\n<p>Have you profiled the code? I think you would have more luck if you can identify where the bottle-necks are rather than attempt a total conversion.</p>\n"}], "owner": {"reputation": 1118, "user_id": 1507669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pMaaM.jpg?s=128&g=1", "display_name": "hmmftg", "link": "https://stackoverflow.com/users/1507669/hmmftg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "accepted_answer_id": 51284483, "answer_count": 1, "score": 0, "last_activity_date": 1531314357, "creation_date": 1531308402, "last_edit_date": 1531314357, "question_id": 51284315, "link": "https://stackoverflow.com/questions/51284315/convert-python-project-into-c", "title": "Convert Python Project Into C", "body": "<p>I am new to python but have experience in C.</p>\n\n<p>I have a python 3 project including a <code>main.py</code> file and some other <code>.py</code> files in another folder like this:</p>\n\n<pre><code>Root\n\u251c\u2500\u2500 main.py\n\u251c\u2500\u2500 subfolder1\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 models.py\n\u2502   \u2514\u2500\u2500 subfolder2\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2514\u2500\u2500 models.py\n</code></pre>\n\n<p>inside <strong>main.py</strong>:</p>\n\n<pre><code>from subfolder1.model import BaseClass\n</code></pre>\n\n<p>inside first  <strong>__init__.py</strong>:</p>\n\n<pre><code>from .model import BaseClass\n</code></pre>\n\n<p>inside second  <strong>__init__.py</strong>:</p>\n\n<pre><code>from .model import BaseClass\n</code></pre>\n\n<p>I want to convert this project into a C project to increase its performance, in this project a lot of Libraries like <code>numpy</code>, <code>sklearn</code>, <code>keras</code> and <code>scipy</code> are used. </p>\n\n<p>I tried <code>cython</code> and I know how to get <code>main.c</code> from <code>main.py</code>, but for the other files and how to convert and use child class methods and is there a way to convert the whole project with one <code>setup.py</code>?(I don't understand a lot from its docs)</p>\n\n<p>the main purpose is to run in C and get better performance so if there is alternate way please help in it.</p>\n\n<p>thanks.</p>\n\n<p><strong>================================  Edit  ===================================</strong></p>\n\n<p>I want to use <code>BaseClass</code> methods in <code>models.py</code> and functions in <code>main.py</code> in the <code>C Project</code> and problem is how to use other <code>.py</code> files in sub-folders and generate <code>C</code> code using <code>cython</code>. I was able to convert single python file <code>main.py</code> but don't know how to add, import or ... other files in my <code>C Project</code>.</p>\n\n<p>thanks again.</p>\n"}, {"tags": ["c", "algorithm", "graph", "depth-first-search"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1531307442, "post_id": 51283782, "comment_id": 89545197, "body": "<code>for(i=1;i&lt;=n;i++)</code> is <b>wrong</b> because arrays in C go from <code>0..n-1</code>.  Use: <code>for(i=0;i&lt;n;i++)</code>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531308120, "post_id": 51283782, "comment_id": 89545585, "body": "It is called &quot;Depth-first <i>search</i>&quot; but I don&#39;t see you searching anything."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9041062, "user_type": "registered", "profile_image": "https://graph.facebook.com/1947829522147251/picture?type=large", "display_name": "\u9ad8\u5b87\u68ee", "link": "https://stackoverflow.com/users/9041062/%e9%ab%98%e5%ae%87%e6%a3%ae"}, "edited": false, "score": 0, "creation_date": 1531409943, "post_id": 51287235, "comment_id": 89595837, "body": "Hello Lukas, this code is not my code, the code is book example code, I just paste code, wanna to know, how to do let 4 to 2 to 1 back to path\u3002 thank your feedback\u3002"}], "tags": [], "owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "is_accepted": true, "score": 0, "last_activity_date": 1531317028, "creation_date": 1531317028, "answer_id": 51287235, "question_id": 51283782, "link": "https://stackoverflow.com/questions/51283782/algorithm-graph-depth-first-search/51287235#51287235", "title": "Algorithm Graph depth - first search", "body": "<p>I assume you're asking why your DFS is first exploring 1, then 2, then 4? Well, that's how a DFS works: It greedily goes to the next unvisited vertex. What output would you expect?</p>\n\n<p><strong>Some remarks regarding your code:</strong></p>\n\n<p>To improve the answers that you get, I'd suggest posting code that is <em>a lot</em> cleaner than the code in your question:</p>\n\n<ul>\n<li>Please use variable names that tell your readers what they mean. For example: Use something like <code>bool visited[]</code> instead of <code>int book[]</code>.</li>\n<li>Use the correct data type! If you want to store whether an edge is there or not, or whether a vertex was visited or not, use <code>bool</code>, not some magic <code>int</code> values.</li>\n<li>Global variables are usually not the right thing. There is no reason why all your variables should be global.</li>\n<li>Neither is there a reason why the arrays should have the constant size <code>101</code>.</li>\n</ul>\n"}], "owner": {"reputation": 25, "user_id": 9041062, "user_type": "registered", "profile_image": "https://graph.facebook.com/1947829522147251/picture?type=large", "display_name": "\u9ad8\u5b87\u68ee", "link": "https://stackoverflow.com/users/9041062/%e9%ab%98%e5%ae%87%e6%a3%ae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 51287235, "answer_count": 1, "score": -3, "last_activity_date": 1531365327, "creation_date": 1531306738, "last_edit_date": 1531365327, "question_id": 51283782, "link": "https://stackoverflow.com/questions/51283782/algorithm-graph-depth-first-search", "title": "Algorithm Graph depth - first search", "body": "<p>This is graph code, I want to understand Depth-first search algorithm, but I had some problem with this code, </p>\n\n<p>If I input params:</p>\n\n<p>5 5 <br>\n1 2 <br>\n1 3 <br> \n1 5 <br>\n2 4 <br>\n3 5 <br></p>\n\n<p>Why cur become return 4 to 2 to 1 in function dfs?\nthank your response</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint book[101], sum,e[101][101];\nint n,m,a,b;\n\nvoid dfs(int cur){\n    int i;\n    printf(\"%d \",cur);\n\n    sum++;\n    if(sum==n){\n        return;\n    }\n\n    // \n    for(i=1;i&lt;=n;i++){\n        if( e[cur][i]==1 &amp;&amp; book[i]==0 ){\n            book[i]=1;\n            dfs(i);\n        }\n    }\n    return;\n}\n\nint main(){\n    int i,j;\n    scanf(\"%d %d \", &amp;n,&amp;m);\n\n    for(i=1;i&lt;=n;i++){\n        for(j=1;j&lt;=n;j++){\n            if(i==j){\n                e[i][j] = 0;\n            }else{\n                e[i][j] = 99999999;\n            }\n        };\n    };\n\n    for(i=1;i&lt;=m;i++){\n        scanf(\"%d %d\" ,&amp;a, &amp;b);\n        e[a][b] = 1;\n        e[b][a] = 1;\n    }\n\n    book[1] = 1;\n    dfs(1);\n    getchar();\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "server", "esp32"], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1531306857, "last_edit_date": 1531306857, "creation_date": 1531306551, "answer_id": 51283709, "question_id": 51283617, "link": "https://stackoverflow.com/questions/51283617/esp32-idf-multi-socket-server/51283709#51283709", "title": "esp32 idf multi-socket-server", "body": "<p>I don't see you <em>closing</em> your sockets anywhere?</p>\n\n<p>Sockets, no matter the platform, is usually a limited resource, and a resource that will be reused. If you don't close the sockets then the system will think that you still use then, and can't reuse those sockets for new connections (and on POSIX systems even opening <em>files</em> will be affected).</p>\n\n<p>So close connections <em>immediately</em> when they are not needed any more.</p>\n\n<p>Usually this is done by checking what <code>recv</code> and <code>send</code> returns: If they return a value less than zero an error occured and in most cases it's a non-recoverable errors, so connection should be closed. Even if it is a recoverable error, it's easier to close the connection and let the client reconnect.</p>\n\n<p>For <code>recv</code> there's also the special case when it returns zero. That means the other end has closed the connection. That of course you need to close your end as well.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10064351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7mrS4vOefJI/AAAAAAAAAAI/AAAAAAAALBs/V8TwGayYPGM/photo.jpg?sz=128", "display_name": "Jerzy Stusiski Jurstu", "link": "https://stackoverflow.com/users/10064351/jerzy-stusiski-jurstu"}, "is_accepted": false, "score": 0, "last_activity_date": 1531481538, "creation_date": 1531481538, "answer_id": 51324152, "question_id": 51283617, "link": "https://stackoverflow.com/questions/51283617/esp32-idf-multi-socket-server/51324152#51324152", "title": "esp32 idf multi-socket-server", "body": "<p>this post solved all my problems\n<a href=\"https://www.esp32.com/viewtopic.php?t=911\" rel=\"nofollow noreferrer\">https://www.esp32.com/viewtopic.php?t=911</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10064351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7mrS4vOefJI/AAAAAAAAAAI/AAAAAAAALBs/V8TwGayYPGM/photo.jpg?sz=128", "display_name": "Jerzy Stusiski Jurstu", "link": "https://stackoverflow.com/users/10064351/jerzy-stusiski-jurstu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531481538, "creation_date": 1531306299, "question_id": 51283617, "link": "https://stackoverflow.com/questions/51283617/esp32-idf-multi-socket-server", "title": "esp32 idf multi-socket-server", "body": "<p>It's my first post so ask for remotely anything if it can help and I didn't provide it.</p>\n\n<p>My application requires multiple sockets being opened at once from Master, then the slaves connect to WiFi, and then to the sockets</p>\n\n<p>Problem is: I have to make it \"bulletproof\" against constant reconnecting from slaves and i get Accept error:\nE (23817) TCP SOCKET: accept error: -1 Too many open files in system\nIt appears when I reconnect client for 5th time, when Max Number of Open Sockets = 5 in menuconfig, </p>\n\n<p>I disconnect clients from the server when they don't send anything in 1second -> then i assume they got DC-d.\nI do it with close() procedure.</p>\n\n<pre><code>void closeOvertimedTask(void * ignore)\n{\n    while(1)\n    {\n        for(int i = 0; i &lt; openedSockets;)\n        {\n            if(needsRestart[i] == 1)\n            {\n                ESP_LOGI(\"RESTARTING\", \" task#%d\",i);\n                //lwip_close_r(clientSock[i]);\n\n                //closesocket(clientSock[i]);\n\n                //ESP_LOGI(\"closing result\", \"%d\", close(clientSock[i]));\n                stopSocketHandler(i);\n                needsRestart[i] = 0;\n                //if(isSocketOpened[i])\n                {\n\n                }\n\n                ESP_LOGI(\"close\", \"%d\", lwip_close_r(clientSock[i]));\n                isSocketOpened[i] = 0;\n\n                xTaskCreate( handleNthSocket, \"TCP_HANDLER\", 10*1024, &amp;(sockNums[i]) , tskIDLE_PRIORITY, &amp;socketHandlerHandle[i]);\n                configASSERT(socketHandlerHandle[i]);\n                needsRestart[i] = 0;\n            }\n\n            if(isSocketOpened[i])\n            {\n                int diff = ((int)((uint64_t)esp_timer_get_time()) - lastWDT[i]) - 2*TCPWDT;\n\n                if(diff &gt; 0)\n                {\n                    if(isSocketOpened[i])\n                    {\n                        ESP_LOGI(\"I FOUND OUT HE DC-d\",\"\");\n                        //closesocket(clientSock[i]);\n                    }\n                    ESP_LOGI(\"close\", \"%d\", close(clientSock[i]));\n\n                    stopSocketHandler(i);\n                    isSocketOpened[i] = 0;\n\n                    xTaskCreate( handleNthSocket, \"TCP_HANDLER\", 10*1024, &amp;(sockNums[i]) , tskIDLE_PRIORITY, &amp;socketHandlerHandle[i]);\n                    configASSERT(socketHandlerHandle[i]);\n                }\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>For each socket I run 1 task that is supposed to receive from that socket and act further.</p>\n\n<p>For all of them I have an other task that checks last time a message arrived and restarts tasks when time has exceeded  (it's 2 seconds)</p>\n\n<p>I need around 16 sockets opened in the final version so there is no room to have sockets that are still closing after Slave has restarted whole connection</p>\n\n<ol>\n<li>How to properly close a Task with running recv() procedure in it to properly close Socket.</li>\n<li>Is there a way to read from Server side that socket has been closed if WiFi hasn't realized STA DC-d</li>\n<li>Is this about TIME_WAIT from tcp stack ? </li>\n</ol>\n\n<p>Socket read code:</p>\n\n<pre><code>void handleNthSocket(void * param) // 0 &lt;= whichSocket &lt; openedSockets \n{\n    int whichSocket =  *((int *) param);\n\n    ESP_LOGI(\"TCP SOCKET\", \"%s     #%d\", getSpaces(whichSocket), whichSocket);\n    struct sockaddr_in clientAddress;\n\n    while (1) \n    {\n        if(needsRestart [whichSocket] == 0)\n        {\n            socklen_t clientAddressLength = sizeof(clientAddress);\n            clientSock[whichSocket] = accept(sock[whichSocket], (struct sockaddr *)&amp;clientAddress, &amp;clientAddressLength);\n            if (clientSock[whichSocket] &lt; 0) \n            {\n                ESP_LOGE(\"TCP SOCKET\", \"accept error: %d %s\", clientSock[whichSocket], strerror(errno));  //HERE IT FLIPS\n                //E (232189) TCP SOCKET: accept error: -1 Too many open files in system\n\n                isSocketOpened[whichSocket] = 0;\n                needsRestart[whichSocket] = 1;\n                continue;\n            }\n            //isSocketOpened[whichSocket] = 1;\n            // We now have a new client ...\n\n            int total = 1000;\n\n            char dataNP[1000];\n            char *data;\n            data = &amp;dataNP[0];\n\n            for(int z = 0; z &lt; total; z++)\n            {\n                dataNP[z] = 0;\n            } \n            ESP_LOGI(\"TCP SOCKET\", \"%snew client\",getSpaces(whichSocket));\n            ESP_LOGI(\"          \", \"%s#%d connected\",getSpaces(whichSocket), whichSocket);\n            lastWDT[whichSocket] = (uint64_t)esp_timer_get_time() + 1000000;\n            isSocketOpened[whichSocket] = 1;\n            // Loop reading data.\n\n\n            while(isSocketOpened[whichSocket]) \n            {\n                /*\n                if (sizeRead &lt; 0) \n                {\n                    ESP_LOGE(tag, \"recv: %d %s\", sizeRead, strerror(errno));                \n                    goto END;\n                }\n\n                if (sizeRead == 0) \n                {\n                    break;\n                }\n                sizeUsed += sizeRead;\n                */\n\n                ssize_t sizeRead = recv(clientSock[whichSocket], data, total, 0);\n                /*for (int k = 0; k &lt; sizeRead; k++)\n                {\n                    if(*(data+k) == '\\n')\n                    {\n                        ESP_LOGI(\"TCP DATA  \", \"%sthere was enter\", getSpaces(whichSocket));\n                        //ESP_LOGI(\"TIME      \", \"%d\", (int)esp_timer_get_time());\n                    }\n                    //ESP_LOGI(\"last wdt\", \"%d\", (int)lastWDT[whichSocket]);\n\n                }*/\n\n\n                lastWDT[whichSocket] = (uint64_t)esp_timer_get_time();\n                int diff = ((int)((uint64_t)esp_timer_get_time()) - lastWDT[whichSocket]) - 2*TCPWDT;\n                ESP_LOGI(\"last wdt\", \"%d, data = %s\", (int)lastWDT[whichSocket], data);\n\n                if(diff &gt; 0)\n                {\n                    ESP_LOGI(\"last wdt\", \"too long - %d\", diff);\n                    isSocketOpened[whichSocket] = 0;\n                }\n\n                if (sizeRead &lt; 0)\n                {\n                    isSocketOpened[whichSocket] = 0;\n                }\n\n\n                //TODO: all RX from slave routine\n                for(int k = 0; k &lt; sizeRead; k++)\n                {\n                    *(data+k) = 0;\n                }\n\n\n\n    //          ESP_LOGI(\"lol data\", \"clientSock[whichSocket]=%d, \n                /*if(sizeRead &gt; -1)\n                {\n                    ESP_LOGI(\"TCP DATA: \", \"%c\", *(data + sizeRead-1));\n                }\n                else\n                {\n                    ESP_LOGI(\"TCP DC    \", \"\");\n                    goto END;               \n                }*/     \n\n\n\n            }\n            if(isSocketOpened[whichSocket])\n            {\n                ESP_LOGI(\"closing result\", \"%d\", close(clientSock[whichSocket]));\n            }\n        }       \n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1531306380, "post_id": 51283563, "comment_id": 89544477, "body": "What is &quot;not correct&quot; about it?"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1531306428, "post_id": 51283563, "comment_id": 89544499, "body": "static int tab[2]; is executed exactly one time, the first time you call the function."}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531306500, "post_id": 51283563, "comment_id": 89544553, "body": "When I call it multiple time it gives me correct result only for the first call ,the second call ,the third call and other call incorrect result."}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531306543, "post_id": 51283563, "comment_id": 89544576, "body": "I want to call this function many time not only one time.  I want to execute it multiple time"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1531306553, "post_id": 51283563, "comment_id": 89544581, "body": "@kais: One final attempt before I give up: what is the &quot;incorrect result&quot;? What result were you expecting? What result did you get?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531306735, "post_id": 51283563, "comment_id": 89544690, "body": "I would expect that the last call will have &quot;correct&quot; result as the array values are changed for each call and all return values point to the same array. Last one rules..."}, {"owner": {"reputation": 370, "user_id": 8666346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c02448740db629e971da051df442aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sister Fister", "link": "https://stackoverflow.com/users/8666346/sister-fister"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1531306825, "post_id": 51283563, "comment_id": 89544759, "body": "@nicomp <code>static int tab[2];</code> is only the array definition, it&#39;s not executed at all..."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531306878, "post_id": 51283563, "comment_id": 89544803, "body": "since the array declared within <code>ftab</code> is <code>static</code>, it means that it has the same address all the time. Reusing the array doesn&#39;t work you have to make a copy. It&#39;s much better to return an allocated array, or use an output parameter to fill it in"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1531307012, "post_id": 51283563, "comment_id": 89544915, "body": "it isn&#39;t c++11 related, or even c++. Looks like a pure C question to me."}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531307081, "post_id": 51283563, "comment_id": 89544969, "body": "I tested the first call it give me correct answer int* tab = ftab(3) : tab[0]=3 ; tab[1]=4 ; when I call it this function another time tab[0] and tab[1] are not correct. I dont know it return correct result only for the first call.I dont know there is any problem of memory ?"}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531307125, "post_id": 51283563, "comment_id": 89545001, "body": "How can I execute it many times"}, {"owner": {"reputation": 370, "user_id": 8666346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c02448740db629e971da051df442aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sister Fister", "link": "https://stackoverflow.com/users/8666346/sister-fister"}, "edited": false, "score": 0, "creation_date": 1531307177, "post_id": 51283563, "comment_id": 89545030, "body": "Please provide a full example where you print the values."}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531307255, "post_id": 51283563, "comment_id": 89545088, "body": "static array is executed only one time ?"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 370, "user_id": 8666346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c02448740db629e971da051df442aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sister Fister", "link": "https://stackoverflow.com/users/8666346/sister-fister"}, "edited": false, "score": 0, "creation_date": 1531307663, "post_id": 51283563, "comment_id": 89545335, "body": "@SisterFister You&#39;re confusing declaration and definition"}, {"owner": {"reputation": 370, "user_id": 8666346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c02448740db629e971da051df442aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sister Fister", "link": "https://stackoverflow.com/users/8666346/sister-fister"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1531307903, "post_id": 51283563, "comment_id": 89545468, "body": "@nicomp Maybe, but I still think nothing is executed there..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531317497, "post_id": 51283563, "comment_id": 89552354, "body": "@kais This question was closed because you didn&#39;t tell us why the second call is incorrect.  If you want the question to be reopened, you need to edit the question telling us what output you expected to get and what output (cut and paste this part) you actually got."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1531308215, "last_edit_date": 1531308215, "creation_date": 1531307181, "answer_id": 51283933, "question_id": 51283563, "link": "https://stackoverflow.com/questions/51283563/return-static-array-in-a-function/51283933#51283933", "title": "return static array in a function", "body": "<p>Here is a cleaned-up version of your program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint *ftab(int n)\n{\n    static int tab[2];\n    tab[0] = n;\n    tab[1] = n+1;\n    return tab;\n}\n\nint main()\n{\n    int *tab1 = ftab(3);\n    printf(\"first: %d %d\\n\", tab1[0], tab1[1]);\n\n    int *tab2 = ftab(2);\n    printf(\"second: %d %d\\n\", tab2[0], tab2[1]);\n\n    printf(\"but first is now: %d %d\\n\", tab1[0], tab1[1]);\n }\n</code></pre>\n\n<p>First it prints</p>\n\n<pre><code>first: 3 4\n</code></pre>\n\n<p>which is the right answer for a call to <code>ftab(3)</code>.</p>\n\n<p>Then it prints</p>\n\n<pre><code>second: 2 3\n</code></pre>\n\n<p>which is the right answer for a call to <code>ftab(2)</code>.</p>\n\n<p>But then it prints</p>\n\n<pre><code>but first is now: 2 3\n</code></pre>\n\n<p>The answer to the first call changed behind our backs!  How can that be?</p>\n\n<p>And the answer, of course, is that the array <code>tab[]</code> inside the function <code>ftab()</code> is static.  There's exactly one copy of it.  It gets reused every time you call <code>ftab</code>.  The previous contents are overwritten by each new call.</p>\n\n<p>You can see more clearly what's going on if you also print out the pointer values that <code>ftab</code> is returning.  If I change <code>main</code> to this:</p>\n\n<pre><code>int main()\n{\n    int *tab1 = ftab(3);\n    printf(\"first: %p: %d %d\\n\", tab1, tab1[0], tab1[1]);\n    int *tab2 = ftab(2);\n    printf(\"second: %p: %d %d\\n\", tab2, tab2[0], tab2[1]);\n    printf(\"but first is now: %p: %d %d\\n\", tab1, tab1[0], tab1[1]);\n }\n</code></pre>\n\n<p>now it prints</p>\n\n<pre><code>first: 0x10b35e018: 3 4\nsecond: 0x10b35e018: 2 3\nbut first is now: 0x10b35e018: 2 3\n</code></pre>\n\n<p>So <code>ftab</code> is returning the <em>exact same pointer value every time!</em>  How can that be?  And the answer is, it's always returning a pointer to the same static array <code>tab</code>, but it's filling in the array with different values each time.</p>\n\n<p>There are several lessons here:</p>\n\n<ol>\n<li>Functions can't return arrays.</li>\n<li>A function can return a pointer to a static array, but it's an imperfect substitute.</li>\n<li>When a function returns a pointer to a static array, you do not want to save a copy of that pointer and use it later, because the result may get overwritten by another call to the function.</li>\n<li>A pointer is not an array.  A pointer can point to an array, but the contents of that array can change out from under the pointer.</li>\n<li>When using pointers, you have to keep clear in your mind the distinction between <em>the pointer</em> and <em>what the pointer points to</em>.  This code provides a perfect example of that distinction.  Do the calls <code>ftab(2)</code> and <code>ftab(3)</code> return the same thing, or different things?  Well, they return the same <em>pointer</em>, but after each call, <em>what that pointer points to</em> is different.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1531307210, "creation_date": 1531307210, "answer_id": 51283947, "question_id": 51283563, "link": "https://stackoverflow.com/questions/51283563/return-static-array-in-a-function/51283947#51283947", "title": "return static array in a function", "body": "<p>You must turn warnings of your compiler on. It will tell you what is wrong:</p>\n\n<pre><code>   int *tab = ftab(3);\n   int *tab = ftab(2);\n</code></pre>\n\n<p>Your second <code>int *tab</code> is an error because <code>tab</code> is already declared. The statement also had an error in that it had no terminating semi-colon. So, your compiler made something of it and you see an error. How do you see an error? I see no print statements.</p>\n\n<p>The following should work perfectly fine:</p>\n\n<pre><code>   int *tab= ftab(3);\n   printf(\"%d, %d\\n\", tab[0], tab[1]);\n   ftab(2);\n   printf(\"%d, %d\\n\", tab[0], tab[1]);\n</code></pre>\n\n<p>Note that in the second call you don't need an assignment as <code>tab</code> is already pointing to the static array. It only got new values.</p>\n"}], "owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "closed_date": 1531317191, "answer_count": 2, "score": -6, "last_activity_date": 1531317185, "creation_date": 1531306107, "last_edit_date": 1531317185, "question_id": 51283563, "link": "https://stackoverflow.com/questions/51283563/return-static-array-in-a-function", "closed_reason": "Needs details or clarity", "title": "return static array in a function", "body": "<p>I have this function </p>\n\n<pre><code>int* ftab(int n)\n {\n  static int tab[2];\n   tab[0] = n;\n   tab[1] = n+1;\n   return tab;\n   }\n\n void caller()\n  {\n   int* tab = ftab(3); // it gives me correct result\n   int * tab=ftab(2)  // but when I use another time it makes incorrect \n                         answer\n }\n</code></pre>\n\n<p>It gives me the correct answer only the first time only in the first call but in the other calls it is not correct. I don't know why, thanks for help.</p>\n"}, {"tags": ["c", "lvalue", "pre-increment"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1531304842, "post_id": 51283056, "comment_id": 89543410, "body": "<code>++x</code> is a lvalue in C++, not C."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1531305612, "post_id": 51283056, "comment_id": 89543942, "body": "What would it even mean?  What is it that&#39;s being assigned a value of 5?  Does <code>x</code> get a value 1 more than it had, or does it get a value of 5, or what?  This is like <code>(x = x + 1) = 5</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1531304908, "creation_date": 1531304908, "answer_id": 51283146, "question_id": 51283056, "link": "https://stackoverflow.com/questions/51283056/why-this-is-invalid-c-code/51283146#51283146", "title": "Why this is invalid C code?", "body": "<p>++x vaguely translates to x = x + 1.\nIt does not act as a lvalue ( in C ) so you cannot assign it any value.</p>\n"}], "owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "closed_date": 1531304815, "answer_count": 1, "score": 1, "last_activity_date": 1531304908, "creation_date": 1531304666, "question_id": 51283056, "link": "https://stackoverflow.com/questions/51283056/why-this-is-invalid-c-code", "closed_reason": "Duplicate", "title": "Why this is invalid C code?", "body": "<p>If <code>x</code> is of type <code>int</code>, for what I understand, <code>++x</code> is a lvalue, so</p>\n\n<pre><code>++x = 5;\n</code></pre>\n\n<p>is valid. But the compiler doesn't like it. It days that</p>\n\n<blockquote>\n  <p>lvalue required as left operand of assignment</p>\n</blockquote>\n\n<p>What is happening here? Isn't <code>++x</code> an lvalue?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1531304568, "post_id": 51282846, "comment_id": 89543249, "body": "Note: you are multiplying when you say &quot;power&quot;"}, {"owner": {"reputation": 1, "user_id": 10064100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gYKq_Mlg8sA/AAAAAAAAAAI/AAAAAAAAAE4/ZUsMq-GRezM/photo.jpg?sz=128", "display_name": "Alexander Vershinin", "link": "https://stackoverflow.com/users/10064100/alexander-vershinin"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1531304625, "post_id": 51282846, "comment_id": 89543277, "body": "to be precise because i think its not clear what i want. i need each odd index element to be like 3pow0, 3pow1... 3pow4 etc. and each even index to be like 2pow0, 2pow1... 2pow5 etc..."}, {"owner": {"reputation": 3364, "user_id": 693294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5935d56f077497b60c12cf86b9d2e1?s=128&d=identicon&r=PG", "display_name": "Gilbert", "link": "https://stackoverflow.com/users/693294/gilbert"}, "edited": false, "score": 1, "creation_date": 1531304896, "post_id": 51282846, "comment_id": 89543450, "body": "Guessing, so not an official answer.  pow[0] = pow[1] = 1; for ( k = 2; k &lt; n; k+= 2 ) { k[n] = k[n-2] * 2; k[n+1] = k[n-1] * 3; } // debugging is left as an exorcise to the student. Like the answer and I can make it official."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531307063, "post_id": 51282846, "comment_id": 89544955, "body": "I assume, the purpose of that task is to use modulo operator."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1531307234, "post_id": 51282846, "comment_id": 89545075, "body": "Your code and your question do not match. Please provide a sample set of values you want to get. Your code does not use any power of a number."}, {"owner": {"reputation": 1, "user_id": 10064100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gYKq_Mlg8sA/AAAAAAAAAAI/AAAAAAAAAE4/ZUsMq-GRezM/photo.jpg?sz=128", "display_name": "Alexander Vershinin", "link": "https://stackoverflow.com/users/10064100/alexander-vershinin"}, "edited": false, "score": 0, "creation_date": 1531307790, "post_id": 51282846, "comment_id": 89545395, "body": "Yes I\u2019m sorry it\u2019s NOT the powered by 2 and powered by 3 question. I want to get 1 1 2 3 4 9 8 27 16 81 32 243 64 729 128 etc. sorry for wrong Q title"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10064100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gYKq_Mlg8sA/AAAAAAAAAAI/AAAAAAAAAE4/ZUsMq-GRezM/photo.jpg?sz=128", "display_name": "Alexander Vershinin", "link": "https://stackoverflow.com/users/10064100/alexander-vershinin"}, "edited": false, "score": 0, "creation_date": 1531305411, "post_id": 51282986, "comment_id": 89543814, "body": "I like this solution, but looks like i need smth like: [0] = 1, [1] is odd = 3pow0, [2] is even = 2pow0, [3] is odd = 3pow1, [4] is even = 2pow1, [5] is odd = 3pow2 etc... maybe i understood my task wrong, but feels like it wants from me smth like this. Sorry that can&#39;t show how this task sounds, because it&#39;s not originally written in english. anyway is it possible to make smth like what i mentioned in this comment? sorry for bothering with studying questions =/"}, {"owner": {"reputation": 1, "user_id": 10064100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gYKq_Mlg8sA/AAAAAAAAAAI/AAAAAAAAAE4/ZUsMq-GRezM/photo.jpg?sz=128", "display_name": "Alexander Vershinin", "link": "https://stackoverflow.com/users/10064100/alexander-vershinin"}, "edited": false, "score": 0, "creation_date": 1531308308, "post_id": 51282986, "comment_id": 89545692, "body": "i like this answer very much it&#39;s just my english was wrong. btw my code during my tries was:      while(k &lt; n){         if (k % 2 == 0){             pwr[k] = pwr[k - 1] * 2;             printf(&quot;%d &quot;, pwr[k]);             k++;         }         else {pwr[k] = pwr[k - 1] * 3;             printf(&quot;%d &quot;, pwr[k]);             k++;         }     }  which do the same as your&#39;s compact example &quot;pwr[k] = pwr[k - 1] * ((k%2) + 2); so your answer is very elegant and useful anyway. Thank you"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1531304481, "creation_date": 1531304481, "answer_id": 51282986, "question_id": 51282846, "link": "https://stackoverflow.com/questions/51282846/array-where-each-even-index-powered-by-2-odd-index-powered-by-3/51282986#51282986", "title": "array where each even index powered by 2, odd index powered by 3", "body": "<p>You can use:</p>\n\n<pre><code>    pwr[k] = pwr[k - 1] * ((k%2)+2);\n</code></pre>\n\n<p>If <code>k</code> is odd, <code>k%2</code> is 1 and so it will multiply with 3.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1531305805, "creation_date": 1531305805, "answer_id": 51283458, "question_id": 51282846, "link": "https://stackoverflow.com/questions/51282846/array-where-each-even-index-powered-by-2-odd-index-powered-by-3/51283458#51283458", "title": "array where each even index powered by 2, odd index powered by 3", "body": "<p>In pseudocode, I think what you want is</p>\n\n<pre><code>for(i in some range of values) {\n    if(i is even) {\n        array[i] = i * i;\n    } else {\n        array[i] = i * i * i;\n    }\n}\n</code></pre>\n\n<p>I'll let you translate this into proper C.</p>\n"}], "owner": {"reputation": 1, "user_id": 10064100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gYKq_Mlg8sA/AAAAAAAAAAI/AAAAAAAAAE4/ZUsMq-GRezM/photo.jpg?sz=128", "display_name": "Alexander Vershinin", "link": "https://stackoverflow.com/users/10064100/alexander-vershinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1531305805, "creation_date": 1531304056, "last_edit_date": 1531304200, "question_id": 51282846, "link": "https://stackoverflow.com/questions/51282846/array-where-each-even-index-powered-by-2-odd-index-powered-by-3", "title": "array where each even index powered by 2, odd index powered by 3", "body": "<p>I'm new here. I have this code where each array's element is powered by 3 along the way to result something like 3pow0, 3pow1, 3pow2, 3pow3 etc...:</p>\n\n<pre><code>#include    &lt;stdio.h&gt;\n#include    &lt;stdlib.h&gt;\n\nint main(void){\n\n    const int n = 10;\n    int pwr[n];\n    pwr[0] = 1;\n    int k = 1;\n    printf(\"%d \", pwr[0]);\n\n    while(k &lt; n){\n        pwr[k] = pwr[k - 1] * 3;\n        printf(\" %d \", pwr[k]);\n        k++;\n        }\n    return 0;\n}\n</code></pre>\n\n<p>Now I need to make each odd index in array to be powered by 3, and each even index to become powered by 2.</p>\n\n<p>I tried to use something like <code>while(k &lt; n &amp;&amp; k % 2 == 1)</code> and also played with \"for\" and \"if-else\". Can't figure out how to make it work. </p>\n"}, {"tags": ["c", "linux", "gcc", "libtool"], "comments": [{"owner": {"reputation": 445, "user_id": 1502922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/97d68e6f0614d29c8d4b902681e66a3c?s=128&d=identicon&r=PG", "display_name": "rishi", "link": "https://stackoverflow.com/users/1502922/rishi"}, "edited": false, "score": 0, "creation_date": 1531303592, "post_id": 51282609, "comment_id": 89542670, "body": "Ex: gcc ../libnd.a tideways_xhprof.o tracing.o -shared -o libhello.so .. is it good ?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1531467671, "post_id": 51282609, "comment_id": 89615672, "body": "nope, see my answer, please."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1531416086, "post_id": 51282688, "comment_id": 89599197, "body": "please, look at the linker documentation... parameter order is essential for object modules in archive files to be selected.  they are only selected if some unsolved reference is already detected that can be solved including the module from the archive... else the module will not be included in the final executable."}, {"owner": {"reputation": 3652, "user_id": 1610530, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb145246cb9e317aa990ffa9bcf2f67c?s=128&d=identicon&r=PG", "display_name": "Moshe Gottlieb", "link": "https://stackoverflow.com/users/1610530/moshe-gottlieb"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1531419941, "post_id": 51282688, "comment_id": 89601144, "body": "@LuisColorado of course, i was under the impression your SO is the component that needs the A. If that is not the case, you can\u2019t bundle it in the SO file, it\u2019s not like a macOS framework that can embed any type of resource."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1531467329, "post_id": 51282688, "comment_id": 89615492, "body": "Nope, you are doing a mixed linking, with <code>.so</code> files to be dynamically loaded at runtime, and <code>.o</code> static objects, bound at linking time.  It is common to archive them in a <code>.a</code> archive, as the linker only uses the required ones.  But for a file to be selected you need to have triggered the unresolved before.  You can add the <code>.o</code> to the <code>.so</code> when linking the <code>.so</code> or later to the final executable, always, when linking the <code>.so</code>  both strategies are possible."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1531467592, "post_id": 51282688, "comment_id": 89615633, "body": "btw, the <code>.a</code> is not a resource... it&#39;s only an archive... It has nothing special but the linker goes into it, and gets from there only what is neccessary at that time.  It simplifies the linking of a library with numerous static objects only..."}, {"owner": {"reputation": 3652, "user_id": 1610530, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb145246cb9e317aa990ffa9bcf2f67c?s=128&d=identicon&r=PG", "display_name": "Moshe Gottlieb", "link": "https://stackoverflow.com/users/1610530/moshe-gottlieb"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1531470127, "post_id": 51282688, "comment_id": 89616943, "body": "@LuisColorado I think we misunderstand each other"}], "tags": [], "owner": {"reputation": 3652, "user_id": 1610530, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb145246cb9e317aa990ffa9bcf2f67c?s=128&d=identicon&r=PG", "display_name": "Moshe Gottlieb", "link": "https://stackoverflow.com/users/1610530/moshe-gottlieb"}, "is_accepted": false, "score": 0, "last_activity_date": 1531303534, "creation_date": 1531303534, "answer_id": 51282688, "question_id": 51282609, "link": "https://stackoverflow.com/questions/51282609/binding-a-file-with-the-so-shared-library-file-in-linux/51282688#51282688", "title": "binding .a file with the .so shared library file in linux", "body": "<p>If your <code>.so</code> file needs the <code>.a</code> file, link your <code>.so</code> with the <code>.a</code> file and all of the needed code from the <code>.a</code> archive will be available in the <code>.so</code> file.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1531468051, "last_edit_date": 1592644375, "creation_date": 1531415949, "answer_id": 51311273, "question_id": 51282609, "link": "https://stackoverflow.com/questions/51282609/binding-a-file-with-the-so-shared-library-file-in-linux/51311273#51311273", "title": "binding .a file with the .so shared library file in linux", "body": "<p>Reorder your command and put the <code>.a</code> library at the end...</p>\n<pre><code>gcc ../../ndagentlibc/obj/*.o tideways_xhprof.o tracing.o -shared -o libhello.so /usr/local/apr/lib/libapr-1.a\n</code></pre>\n<p>as the <code>ld(1)</code> linker only selects the object modules (<code>*.o</code>) included in a library archive that it knows have unsolved references for <em>at the moment of reading it</em> (as you put it first in your command line, no unsolved references appear by that time, so no library <code>.o</code> component is selected and included at the time of library processing)</p>\n<p>In the case of an archive of object modules, the linker tries to do its best, selecting only the ones that appear to be necessary, and putting an archive at first makes the linker to select no files from it to be linked.</p>\n<h1>note</h1>\n<p>BTW, the <code>-shared</code> option is used to create a shared object (a <code>.so</code> module) which probably is not what you want.  If you want to create a final executable program, don't use <code>-shared</code>.  I point at this, because the first time I had to fight with this, I assumed the kind of linking (shared or static) was specified with some option (common mistake, I think)  but the kind of linking is actually given, object by object, by the kind of file you feed to the linker, and not with a command line option.  Apart of other things, it makes the linker <em>not to comply when some references are missing in the program</em> (it assumes those will be resolved in a later linking)</p>\n"}], "owner": {"reputation": 445, "user_id": 1502922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/97d68e6f0614d29c8d4b902681e66a3c?s=128&d=identicon&r=PG", "display_name": "rishi", "link": "https://stackoverflow.com/users/1502922/rishi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1531468051, "creation_date": 1531303267, "last_edit_date": 1531304199, "question_id": 51282609, "link": "https://stackoverflow.com/questions/51282609/binding-a-file-with-the-so-shared-library-file-in-linux", "title": "binding .a file with the .so shared library file in linux", "body": "<p>I have one .a file ( ar command ) which I want to bind it with my .so file during GCC compilation.</p>\n\n<p>How can I do this.</p>\n\n<p>If I run this command :</p>\n\n<pre><code>gcc /usr/local/apr/lib/libapr-1.a ../../ndagentlibc/obj/*.o tideways_xhprof.o tracing.o -shared -o libhello.so\n\n\nnm libhello.so | grep apr_term\n\noutput:  U    apr_terminate\n</code></pre>\n\n<p>apr_terminate is not getting its defination    </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531302296, "post_id": 51282169, "comment_id": 89541852, "body": "Do you mean you want to read a <i>string</i> from the user, and make each node have a copy of those strings?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531302299, "post_id": 51282169, "comment_id": 89541856, "body": "What do you mean by &quot;dynamic array&quot; in a node? What do you mean &quot;print it to file&quot; - change <code>printList</code> so that that prints to <code>FILE *</code> or what? I don&#39;t see the beginnings of either?"}, {"owner": {"reputation": 97, "user_id": 8773581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51acbe6ded26cd0f961aaeac68dc9285?s=128&d=identicon&r=PG&f=1", "display_name": "Sile", "link": "https://stackoverflow.com/users/8773581/sile"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531302382, "post_id": 51282169, "comment_id": 89541918, "body": "Yes exactly @Someprogrammerdude"}, {"owner": {"reputation": 97, "user_id": 8773581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51acbe6ded26cd0f961aaeac68dc9285?s=128&d=identicon&r=PG&f=1", "display_name": "Sile", "link": "https://stackoverflow.com/users/8773581/sile"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531302433, "post_id": 51282169, "comment_id": 89541956, "body": "For dynamic array i mean using heap allocation @AnttiHaapala"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531302567, "post_id": 51282169, "comment_id": 89542045, "body": "Then begin by <i>reading</i> a string. Dynamic allocation you already know (you do it now for the nodes), so the most important thing you have to remember that <code>char</code> strings in C are really called <b><i>null-terminated</b> byte strings</i>. That <i>null-terminated</i> bit is important, and of course needs its space in the strings."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1531302596, "post_id": 51282169, "comment_id": 89542065, "body": "<code>newPtr-&gt;data = value</code> - that is a problem all on its own. If you want to store <i>dynamic strings</i> than all your single-char code management needs to be changed."}, {"owner": {"reputation": 97, "user_id": 8773581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51acbe6ded26cd0f961aaeac68dc9285?s=128&d=identicon&r=PG&f=1", "display_name": "Sile", "link": "https://stackoverflow.com/users/8773581/sile"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531302679, "post_id": 51282169, "comment_id": 89542128, "body": "Got it! @Someprogrammerdude"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1531303344, "creation_date": 1531303344, "answer_id": 51282626, "question_id": 51282169, "link": "https://stackoverflow.com/questions/51282169/how-to-save-a-word-into-a-dynamic-list/51282626#51282626", "title": "How to save a word into a dynamic list", "body": "<p>You must turn warnings of your compiler on. It will tell you where you violate certain rules of C. For example, <code>newPtr-&gt;data = value;</code> should complain because <code>data</code> is a pointer but <code>value</code> is a char.</p>\n\n<p>However, you should read a string from the user using the <code>\"%s\"</code> format specifier of <code>scanf</code> into a buffer that is large enough (or give bounds when reading), for example a buffer <code>char strbuf[256];</code>.</p>\n\n<p>You pass this buffer to <code>insert</code>. Instead of assigning this <code>value</code> to <code>data</code>, you first allocate an new string and then copy the value to the new string:</p>\n\n<pre><code>newPtr-&gt;data = malloc(strlen(value)+1);\nstrcpy(newPtr-&gt;data, value);\n</code></pre>\n\n<p>(This answer excludes any other bugs or problems your solution may have.)</p>\n"}], "owner": {"reputation": 97, "user_id": 8773581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51acbe6ded26cd0f961aaeac68dc9285?s=128&d=identicon&r=PG&f=1", "display_name": "Sile", "link": "https://stackoverflow.com/users/8773581/sile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 51282626, "answer_count": 1, "score": -2, "last_activity_date": 1531303344, "creation_date": 1531302134, "question_id": 51282169, "link": "https://stackoverflow.com/questions/51282169/how-to-save-a-word-into-a-dynamic-list", "title": "How to save a word into a dynamic list", "body": "<p>So i managed to create a dynamic list, at the moment i can only insert a character into each node, i can remove a node and print the whole list, but i'm having a lot of troubles trying to change the list so that i can insert a dynamic array into each node and print it to a file, can someone give me some advice?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n// self-referential structure                       \nstruct listNode {                                      \n   char * data; // each listNode contains a character \n   struct listNode *nextPtr; // pointer to next node\n}; \ntypedef struct listNode ListNode; // synonym for struct listNode\ntypedef ListNode *ListNodePtr; // synonym for ListNode*\n// prototypes\nvoid insert(ListNodePtr *sPtr, char value);\nchar delete(ListNodePtr *sPtr, char value);\nint isEmpty(ListNodePtr sPtr);\nvoid printList(ListNodePtr currentPtr);\nvoid instructions(void);\nint main(void)\n{ \n   ListNodePtr startPtr = NULL; // initially there are no nodes\n   char item; // char entered by user\n   instructions(); // display the menu\n   printf(\"%s\", \"? \");\n   unsigned int choice; // user's choice\n   scanf(\"%u\", &amp;choice);\n   // loop while user does not choose 3\n   while (choice != 3) { \n      switch (choice) { \n         case 1:\n            printf(\"%s\", \"Enter a character: \");\n            scanf(\"\\n%c\", &amp;item);\n            insert(&amp;startPtr, item); // insert item in list\n            printList(startPtr);\n            break;\n         case 2: // delete an element\n            // if list is not empty\n            if (!isEmpty(startPtr)) { \n               printf(\"%s\", \"Enter character to be deleted: \");\n               scanf(\"\\n%c\", &amp;item);\n               // if character is found, remove it\n               if (delete(&amp;startPtr, item)) { // remove item\n                  printf(\"%c deleted.\\n\", item);\n                  printList(startPtr);\n               } \n               else {\n                  printf(\"%c not found.\\n\\n\", item);\n               } \n            } \n            else {\n               puts(\"List is empty.\\n\");\n            } \n            break;\n         default:\n            puts(\"Invalid choice.\\n\");\n            instructions();\n            break;\n      } // end switch\n      printf(\"%s\", \"? \");\n      scanf(\"%u\", &amp;choice);\n   } \n   puts(\"End of run.\");\n} \n// display program instructions to user\nvoid instructions(void)\n{ \n   puts(\"Enter your choice:\\n\"\n      \"   1 to insert an element into the list.\\n\"\n      \"   2 to delete an element from the list.\\n\"\n      \"   3 to end.\");\n} \n// insert a new value into the list in sorted order\nvoid insert(ListNodePtr *sPtr, char value)\n{ \n   ListNodePtr newPtr = malloc(sizeof(ListNode)); // create node\n   if (newPtr != NULL) { // is space available\n      newPtr-&gt;data = value; // place value in node\n      newPtr-&gt;nextPtr = NULL; // node does not link to another node\n      ListNodePtr previousPtr = NULL;\n      ListNodePtr currentPtr = *sPtr;\n      // loop to find the correct location in the list       \n      while (currentPtr != NULL &amp;&amp; value &gt; currentPtr-&gt;data) {\n         previousPtr = currentPtr; // walk to ...               \n         currentPtr = currentPtr-&gt;nextPtr; // ... next node \n      }                                          \n      // insert new node at beginning of list\n      if (previousPtr == NULL) { \n         newPtr-&gt;nextPtr = *sPtr;\n         *sPtr = newPtr;\n      } \n      else { // insert new node between previousPtr and currentPtr\n         previousPtr-&gt;nextPtr = newPtr;\n         newPtr-&gt;nextPtr = currentPtr;\n      } \n   } \n   else {\n      printf(\"%c not inserted. No memory available.\\n\", value);\n   } \n} \n// delete a list element\nchar delete(ListNodePtr *sPtr, char value)\n{ \n   // delete first node if a match is found\n   if (value == (*sPtr)-&gt;data) { \n      ListNodePtr tempPtr = *sPtr; // hold onto node being removed\n      *sPtr = (*sPtr)-&gt;nextPtr; // de-thread the node\n      free(tempPtr); // free the de-threaded node\n      return value;\n   } \n   else { \n      ListNodePtr previousPtr = *sPtr;\n      ListNodePtr currentPtr = (*sPtr)-&gt;nextPtr;\n      // loop to find the correct location in the list\n      while (currentPtr != NULL &amp;&amp; currentPtr-&gt;data != value) { \n         previousPtr = currentPtr; // walk to ...  \n         currentPtr = currentPtr-&gt;nextPtr; // ... next node  \n      } \n      // delete node at currentPtr\n      if (currentPtr != NULL) { \n         ListNodePtr tempPtr = currentPtr;\n         previousPtr-&gt;nextPtr = currentPtr-&gt;nextPtr;\n         free(tempPtr);\n         return value;\n      } \n   } \n   return '\\0';\n} \n// return 1 if the list is empty, 0 otherwise\nint isEmpty(ListNodePtr sPtr)\n{ \n   return sPtr == NULL;\n} \n// print the list\nvoid printList(ListNodePtr currentPtr)\n{ \n   // if list is empty\n   if (isEmpty(currentPtr)) {\n      puts(\"List is empty.\\n\");\n   } \n   else { \n      puts(\"The list is:\");\n      // while not the end of the list\n      while (currentPtr != NULL) { \n         printf(\"%c --&gt; \", currentPtr-&gt;data);\n         currentPtr = currentPtr-&gt;nextPtr;   \n      } \n      puts(\"NULL\\n\");\n   } \n} \n</code></pre>\n"}, {"tags": ["c", "arrays", "variables", "initialization", "declaration"], "comments": [{"owner": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 0, "creation_date": 1531298307, "post_id": 51280869, "comment_id": 89539053, "body": "Welcome, have you tried?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1531298355, "post_id": 51280869, "comment_id": 89539085, "body": "Why the need for it?"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1531299610, "post_id": 51280869, "comment_id": 89539943, "body": "This is exactly why dynamic memory allocation exists. Look up on <code>malloc</code> and family"}], "answers": [{"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1531298674, "creation_date": 1531298674, "answer_id": 51281007, "question_id": 51280869, "link": "https://stackoverflow.com/questions/51280869/can-i-define-a-variable-through-user-input-inside-the-brackets-parameters-of-an/51281007#51281007", "title": "Can I define a variable through user input inside the brackets/parameters of an array AFTER defining the array?", "body": "<blockquote>\n  <p>Is it possible?</p>\n</blockquote>\n\n<p><strong>No</strong>, because variable <code>i</code> is uninitialized. In C language, used uninitialized auto variable invoke undefined behaviour.  </p>\n"}, {"tags": [], "owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "is_accepted": true, "score": 0, "last_activity_date": 1531300774, "creation_date": 1531300774, "answer_id": 51281727, "question_id": 51280869, "link": "https://stackoverflow.com/questions/51280869/can-i-define-a-variable-through-user-input-inside-the-brackets-parameters-of-an/51281727#51281727", "title": "Can I define a variable through user input inside the brackets/parameters of an array AFTER defining the array?", "body": "<p>An array is just a chunk of contiguous memory of specified size. To allocate an array you <strong>must</strong> specify its size.\nHowever, there are instances where you may not know the size required in advance. For those situations, we have dynamic memory malloc.\nYou may allocate the required memory at run-time using <a href=\"https://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\">malloc</a>. </p>\n\n<pre><code>int* a;\na=(int *)malloc(sizeof(int)*required_size);\n</code></pre>\n\n<p>And then access this memory as easily as you did for array e.g. <code>a[i]</code> \nor by dereferencing e.g. <code>*(a + i)</code></p>\n"}, {"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1531303073, "creation_date": 1531303073, "answer_id": 51282535, "question_id": 51280869, "link": "https://stackoverflow.com/questions/51280869/can-i-define-a-variable-through-user-input-inside-the-brackets-parameters-of-an/51282535#51282535", "title": "Can I define a variable through user input inside the brackets/parameters of an array AFTER defining the array?", "body": "<p>This line will give you an error:</p>\n\n<pre><code>int i, number_of_values, variable[i];\n</code></pre>\n\n<p>The compiler don't know how much memory to reserve for the array <code>variable[i]</code>, because he don't know a value for <code>i</code>.\nOnly chance is dynamic memory allocation.</p>\n"}], "owner": {"reputation": 11, "user_id": 10048267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZwKge.jpg?s=128&g=1", "display_name": "Tariq Aziz", "link": "https://stackoverflow.com/users/10048267/tariq-aziz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 51281727, "answer_count": 3, "score": -2, "last_activity_date": 1531303073, "creation_date": 1531298240, "last_edit_date": 1531298599, "question_id": 51280869, "link": "https://stackoverflow.com/questions/51280869/can-i-define-a-variable-through-user-input-inside-the-brackets-parameters-of-an", "title": "Can I define a variable through user input inside the brackets/parameters of an array AFTER defining the array?", "body": "<p>For example, can I do this:</p>\n\n<pre><code>int i, number_of_values, variable[i];\nprintf(\"Enter the number of values you would like to insert: \\n\");\nscanf(\"%d\", &amp;number_of_arrays);\nfor (i=0; i&lt;number_of_values; i++)\n</code></pre>\n\n<p>Instead of using a method like this:</p>\n\n<pre><code>printf(\"Enter the number of values you would like to insert: \\n\");\nscanf(\"%d\", &amp;number_of_values);\nint variable[no_of_values];\n</code></pre>\n\n<p>Is it possible?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "multithreading", "pointers", "pthreads", "function-pointers"], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531301960, "post_id": 51280918, "comment_id": 89541605, "body": "And to counter the &quot;correct&quot; way, I&#39;d say that the <i>best way</i> is to use the shortest construct allowed by the language which is still correct."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1531302633, "last_edit_date": 1531302633, "creation_date": 1531298388, "answer_id": 51280918, "question_id": 51280801, "link": "https://stackoverflow.com/questions/51280801/pthreads-create-executed-function-pointer-confusion/51280918#51280918", "title": "pthreads_create(...) executed function - pointer confusion", "body": "<p>For the first question, a function will naturally decay to a pointer to itself, similar to the way that arrays decays to a pointer to its first element.</p>\n\n<p>So if you have a function</p>\n\n<pre><code>void *thr_fun(void *arg) { ... }\n</code></pre>\n\n<p>then you can pass a pointer to it using either <code>&amp;thr_fun</code> which is the explicit and (some would say) \"correct\" way. The other is to use plain <code>thr_fun</code> as it will decay to <code>&amp;thr_fun</code> anyway. So in C it's really a question about style and personal preference.</p>\n\n<hr>\n\n<p>For your second question, remember that <code>void *</code> is a generic pointer that can point to anything but it doesn't have any explicit type. Therefore you can't dereference it (since a dereferenced <code>void *</code> would have the type <code>void</code>).</p>\n\n<p>That's the reason you need to cast it.</p>\n\n<p>And no you should <em>not</em> get the address of the pointer, since that will give you a pointer <em>to the pointer</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 8170936, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03c2f11bf1e799676771aa25eadc52ec?s=128&d=identicon&r=PG&f=1", "display_name": "Leo ", "link": "https://stackoverflow.com/users/8170936/leo"}, "edited": false, "score": 0, "creation_date": 1531302403, "post_id": 51281164, "comment_id": 89561181, "body": "Okay, I think I got it. I didn&#39;t know that the function name &amp; the address-operator applied to it are interchangeable, but it makes sense since the only thing we&#39;re interested in might be the start position of a function in the address space of the program. In your explanation <code>void *my_void_ptr = &amp;my_int</code> simply declares a void pointer to my_int."}, {"owner": {"reputation": 42285, "user_id": 2057919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec600dcd84770c5d835cd4c943514088?s=128&d=identicon&r=PG&f=1", "display_name": "elixenide", "link": "https://stackoverflow.com/users/2057919/elixenide"}, "reply_to_user": {"reputation": 37, "user_id": 8170936, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03c2f11bf1e799676771aa25eadc52ec?s=128&d=identicon&r=PG&f=1", "display_name": "Leo ", "link": "https://stackoverflow.com/users/8170936/leo"}, "edited": false, "score": 0, "creation_date": 1531332588, "post_id": 51281164, "comment_id": 89561272, "body": "[Continuation of @Leo&#39;s previous comment:] Since this pointer has not yet been assigned a type, we need to cast it using: <code>...= (int *) my_void_ptr;</code> &amp; assign it to f.e. <code>int *my__int_ptr = (int *) my_void_ptr;</code> in order to use it inside the function which is also just a pointer now pointing to the same address as <code>my_void_ptr</code>. Now having had declared <code>my_int_ptr</code> as a pointer, see: <code>int *my_int_ptr =...;</code>, we can simply dereference and get its value via <code>....*my_int_ptr;</code> and get the address of the stored value (<code>my_int</code>/7 in your example) by <code>...&amp;(*my_int_ptr);</code>."}], "tags": [], "owner": {"reputation": 761, "user_id": 7050476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c2df49356fac6994f4b447eb135c37?s=128&d=identicon&r=PG&f=1", "display_name": "afarah", "link": "https://stackoverflow.com/users/7050476/afarah"}, "is_accepted": false, "score": 1, "last_activity_date": 1531299559, "last_edit_date": 1531299559, "creation_date": 1531299105, "answer_id": 51281164, "question_id": 51280801, "link": "https://stackoverflow.com/questions/51280801/pthreads-create-executed-function-pointer-confusion/51281164#51281164", "title": "pthreads_create(...) executed function - pointer confusion", "body": "<ol>\n<li>Passing the function name as a parameter is equivalent to passing its address using the <code>&amp;</code> operator. I.e. <code>pthread_create(...,thr_func,...)</code> and <code>pthread_create(...,&amp;thr_func,...)</code> are interchangeable. This has nothing to do with pthreads, it is a language construct. </li>\n<li><code>arg</code> is a pointer of type <code>void</code>. In order to cast it to a pointer of type <code>thread_data_t</code> you should do <code>(thread_data_t *)arg</code>. By using <code>thread_data_t *data = &amp;arg</code> you are attributing the address of <code>arg</code> itself to <code>data</code>, not the address <code>arg</code> is pointing to.</li>\n</ol>\n\n<p>Consider the following:</p>\n\n<pre><code>int my_int = 7;\nvoid *my_void_ptr = &amp;my_int;\n\nint *my_int_ptr = (int *)my_void_ptr; // Just a cast, points to my_int\nprintf(\"%d\", *my_int_ptr);            // 7\nint *my_int_ptr2 = &amp;my_void_ptr;      // int pointer to the address of my_void_ptr, issues a warning\nprintf(\"%d\", *my_int_ptr2 );          // The address of my_void_ptr as an integer\n</code></pre>\n\n<p>Finally, pthreads stands for POSIX threads, so \"POSIX pthreads\" is redundant.</p>\n"}], "owner": {"reputation": 37, "user_id": 8170936, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03c2f11bf1e799676771aa25eadc52ec?s=128&d=identicon&r=PG&f=1", "display_name": "Leo ", "link": "https://stackoverflow.com/users/8170936/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1531302633, "creation_date": 1531298021, "question_id": 51280801, "link": "https://stackoverflow.com/questions/51280801/pthreads-create-executed-function-pointer-confusion", "title": "pthreads_create(...) executed function - pointer confusion", "body": "<p>so i'm diving into multithreading in c via POSIX pthreads but i do really struggle with the general concept of pointers and their referencing and dereferencing mechanisms. \nOne of the parameters in\n<code>pthread_create(...,pthread_attr_t *attr,...)</code> \nis a function pointer. </p>\n\n<p>This function is usually declared like this:</p>\n\n<p><code>void *thr_func(void *arg){\n  thread_data_t *data = (thread_data_t *)arg;\n  ...\n}</code></p>\n\n<p>thr_func is a function pointer, so usually i use a function pointer to reference to an existing, implemented function via &amp;, e.g.:</p>\n\n<p><code>thr_func = &amp;thr_func_impl;</code></p>\n\n<p>while the arguments of thr_func are also pointers dereferenced for example via * to retrieve the values they are pointing to.</p>\n\n<p>What I don't understand is the following:</p>\n\n<ul>\n<li><p>when i create a thread, why do i just give the function name in <code>pthread_create(...,thr_func,...)</code> instead of its address so that it can be used, e.g.: <code>pthread_create(...,&amp;thr_func,...)</code> or is this done by <code>pthread_create()</code> already ?</p></li>\n<li><p>How do i have to understand this part: \n<code>thread_data_t *data = (thread_data_t *)arg;</code> okay i want to dereference a\nstructure of type thread_data called data via <code>thread_data_t *data = ...</code> . \nShouldn't i do it this way:\n<code>thread_data_t *data;\ndata = &amp;arg; /* now * on data ,e.g.: *data == struct-data (dereferencing) gives the struct data and data without * just gives the structs start address */</code></p></li>\n</ul>\n\n<p>-> I cannot really follow the things happening inside:</p>\n\n<p><code>void *thr_func(void *arg){\n  thread_data_t *data = (thread_data_t *)arg;\n  ...\n}</code></p>\n\n<p>I'd be glad if somebody had a good explanation, thanks!</p>\n"}, {"tags": ["c", "malloc", "calloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 10, "creation_date": 1531297759, "post_id": 51280674, "comment_id": 89538705, "body": "Why does it matter? You&#39;ll only be able to use the requested size, the remaining, if any, is not available to you anyways."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1531301263, "post_id": 51280674, "comment_id": 89541112, "body": "@SouravGhosh: The OP is asking about an extension in which the C implementation provides <code>malloc_usable_size</code> or similar function to report the usable size of the memory, which may be more than requested. In such an implementation, the amount reported as usable is usable, and the behavior of using it is defined."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1531301632, "post_id": 51280674, "comment_id": 89541375, "body": "@Aiueiia: The behavior you ask about is dependent on the C implementation you use. You must specify which C implementation it is, such as a particular version of GCC, a compiler provided by a processor manufacturer, <i>et cetera</i>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1531302693, "post_id": 51280674, "comment_id": 89542140, "body": "Please read the documentation for <code>malloc_usable_size</code>: <b>The main use of this function is for debugging and introspection.</b>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531304758, "post_id": 51280674, "comment_id": 89543362, "body": "@AndrewHenle: It is not \u201cbrain-damaged\u201d to use an extension an implementation provides. If an implementation has allocated (and supports the use of) more memory than requested (due to the design of its memory management), and a program is able to make productive use of the additional memory, then it is fine for it to do so."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1531305039, "post_id": 51280674, "comment_id": 89543551, "body": "@AndrewHenle: What you <b>need</b> and what you can <b>productively use</b> may be different things. A process might allocate space for caching purposes, for example. To do so, it may request some reasonable amount that will help it provide services efficiently. If the C implementation provides more, then using the additional space could further improve performance at no cost."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531306156, "post_id": 51280674, "comment_id": 89544317, "body": "@AndrewHenle I think that among those who uses functions like <code>malloc_usable_size</code> it is extremely few who does not understand that they are playing with fire."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531306256, "post_id": 51280674, "comment_id": 89544371, "body": "@AndrewHenle: I have neither deleted your comments nor requested their deletion or flagged or reported them. As the issue is not about requesting less memory than is needed, your statement about requesting less memory than needed is irrrelevant. As for whether the benefit of using more memory may be worth losing some service of valgrind, it is certainly possible."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1531309176, "post_id": 51280674, "comment_id": 89546235, "body": "Given that this question is asking about behaviour related to particular extensions offered by a particular (albeit not specified) compiler/library, the only way to get a definitive answer would be by referring to documentation for that compiler/library.  In the C standard there is no guarantee that <code>calloc()</code> would reserve more memory than requested and, if it does so, no guarantee that such additional memory be initialised to zero.   Practically, different compilers (or their libraries) do actually behave differently in this regard."}, {"owner": {"reputation": 85, "user_id": 9907095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d506247a8a21f16f3a30796cef9c3782?s=128&d=identicon&r=PG&f=1", "display_name": "Aiueiia", "link": "https://stackoverflow.com/users/9907095/aiueiia"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1531311884, "post_id": 51280674, "comment_id": 89548128, "body": "@Andrew Henle: You are wrong. The requested size is not the only usable memory. On compilers/libs that provide a way to determine the usable size of an allocation all of the returned size can safely be used by the program. And calling something &quot;utterly brain-damaged&quot;, without even asking for the use-case is just plain rude. You are certainly mistaken about assuming that the required allocation size is known up-front: Many data structures rely on resizing buffers when they run out of space, and using the entire allocation might improve performance by avoiding some calls to realloc."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1531336766, "post_id": 51280674, "comment_id": 89563215, "body": "@Aiueiia Are you sure that you <i>always</i> can safely assume such things?"}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 2, "last_activity_date": 1531305011, "last_edit_date": 1531305011, "creation_date": 1531297778, "answer_id": 51280722, "question_id": 51280674, "link": "https://stackoverflow.com/questions/51280674/does-calloc-zero-out-the-entire-allocation/51280722#51280722", "title": "Does calloc zero out the entire allocation?", "body": "<p>It depends on the implementation. The standard does not require it to zero more than the requested memory size.</p>\n\n<p><a href=\"https://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">The standard</a> says:</p>\n\n<blockquote>\n  <p><strong>Synopsis</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\nvoid *calloc(size_t nmemb, size_t size);\n</code></pre>\n  \n  <p><strong>Description</strong></p>\n  \n  <p>The calloc function allocates space for an array of nmemb objects, each of whose size is size. The space is initialized to all bits zero.</p>\n</blockquote>\n\n<p>I would say that it is pretty clear that this does not enforce zeroing anything except the space you have requested in the <code>calloc</code> call.</p>\n\n<p>This is from an <a href=\"https://code.woboq.org/gcc/libiberty/calloc.c.html\" rel=\"nofollow noreferrer\">existing implementation</a>:</p>\n\n<pre><code>PTR memset (PTR dest, register int val, register size_t len) {\n  register unsigned char *ptr = (unsigned char*)dest;\n  while (len-- &gt; 0)\n    *ptr++ = val;\n  return dest;\n}\n\nvoid bzero (void *to, size_t count) {\n  memset (to, 0, count);\n}\n\nPTR calloc (size_t nelem, size_t elsize) {\n  register PTR ptr;  \n  if (nelem == 0 || elsize == 0)\n    nelem = elsize = 1;\n\n  ptr = malloc (nelem * elsize);\n  if (ptr) bzero (ptr, nelem * elsize);\n\n  return ptr;\n}\n</code></pre>\n\n<p>It does only zero the memory you have requested. Other implementations may do it differently.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1531301492, "post_id": 51280727, "comment_id": 89541273, "body": "How do you know this? The OP is asking about a C implementation in which the implementation supports using more memory than requested if more was actually allocated, as reported by a function the implementation provides. That C implementation might also clear all the memory allocated by <code>calloc</code>, not just the requested amount. This question needs to be answered by reference to documentation of the C implementation, not the C standard."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1531302715, "post_id": 51280727, "comment_id": 89542152, "body": "@EricPostpischil As an example, GNU libc only guarantees to zero out the requested allocation, as can be determined by examining its source code."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1531306784, "post_id": 51280727, "comment_id": 89544721, "body": "@IanAbbott That&#39;s the right thing to check, but it obviously doesn&#39;t give you the same long-term guarantee that a clear statement in the documentation would.  (And, to be sure, even a clear statement in the documentation might be amended in a later version, also.)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531327787, "post_id": 51280727, "comment_id": 89558991, "body": "@SteveSummit I don&#39;t think a clear statement is warranted in this case. The documentation for <code>malloc_userable_size</code> already puts off the programmer from trying to make use of any extra space that the block contains."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1531330994, "post_id": 51280727, "comment_id": 89560560, "body": "@IanAbbott All I meant was that, in general, answering a question about an undocumented feature by peeking at the source code and saying &quot;it is guaranteed...&quot; is a risky proposition. :-)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531387859, "post_id": 51280727, "comment_id": 89580813, "body": "@SteveSummit But saying &quot;it&#39;s only guaranteed [in some limited case covered by the standard]&quot; is not risky."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 5, "last_activity_date": 1531297799, "creation_date": 1531297799, "answer_id": 51280727, "question_id": 51280674, "link": "https://stackoverflow.com/questions/51280674/does-calloc-zero-out-the-entire-allocation/51280727#51280727", "title": "Does calloc zero out the entire allocation?", "body": "<p>It's only guaranteed to zero out the requested allocation.</p>\n\n<p>You should <em>never</em> rely on over-allocation.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 5, "last_activity_date": 1531306403, "creation_date": 1531306403, "answer_id": 51283656, "question_id": 51280674, "link": "https://stackoverflow.com/questions/51280674/does-calloc-zero-out-the-entire-allocation/51283656#51283656", "title": "Does calloc zero out the entire allocation?", "body": "<p>Short answer: Without more information it's impossible to say, but I wouldn't count on it.</p>\n\n<p>Longer answer:</p>\n\n<p>If you ask for N bytes, the C Standard guarantees that (unless it fails) <code>calloc</code> will give you N bytes, and that they will all be 0.  As far as the C standard is concerned, that's all we can say.</p>\n\n<p>If you have a C library that (a) sometimes gives you more than N bytes and (b) gives you a well-defined way of finding out how many and (c) guarantees that it's permissible for you to use these extra bytes, we obviously can't say whether those bytes are guaranteed to be 0 or not.  The C Standards don't tell us, and we don't know what C library you're using or what its special guarantees are.</p>\n\n<p>Since it's your C library that might give you (a), (b), and (c), you're going to have to consult that particular library's documentation, source code, and/or author to answer the question (d) is any extra memory guaranteed to be 0?  There is no universal, non-library-specific answer to this question.</p>\n"}], "owner": {"reputation": 85, "user_id": 9907095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d506247a8a21f16f3a30796cef9c3782?s=128&d=identicon&r=PG&f=1", "display_name": "Aiueiia", "link": "https://stackoverflow.com/users/9907095/aiueiia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 51280722, "answer_count": 3, "score": 3, "last_activity_date": 1531306403, "creation_date": 1531297623, "last_edit_date": 1531297968, "question_id": 51280674, "link": "https://stackoverflow.com/questions/51280674/does-calloc-zero-out-the-entire-allocation", "title": "Does calloc zero out the entire allocation?", "body": "<p>The <code>calloc</code> function in C is used to allocate zeroed memory capable of holding at least the requested amount of elements of a specified size. In practice, most memory allocators may allocate a bigger block in order to increase efficiency and minimize fragmentation. The actual usable block size of an allocation in such systems is usually discoverable by means of special functions, i.e. <code>_msize</code> or <code>malloc_usable_size</code>.</p>\n\n<p>Will <code>calloc</code> make sure the entire usable block is zeroed, or will it only zero the requested count*size part of the allocation?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6519, "user_id": 2069380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fac5cb90925b4059b6b2c0885c9ffaf?s=128&d=identicon&r=PG", "display_name": "Ohad Eytan", "link": "https://stackoverflow.com/users/2069380/ohad-eytan"}, "edited": false, "score": 0, "creation_date": 1531296747, "post_id": 51280365, "comment_id": 89538108, "body": "Welcome to StackOverflow. Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a> and <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>, than come back and rephrase your question"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1531296818, "post_id": 51280365, "comment_id": 89538148, "body": "<code>scanf(&quot; %s&quot;, &amp;password);</code> Remove the <code>&amp;</code>. Also, <code>for (loop = 0; loop &lt; 21; loop++)</code> should be <code>int len = strlen(loop); for(loop = 0; loop &lt; len; loop++)</code> to avoid checking uninitialized array locations"}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1531296841, "post_id": 51280365, "comment_id": 89538165, "body": "<code>for(char *p = &amp;password[0]; p &lt; sizeof(password) &#47; sizeof(char); p++) { .... }</code>"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1531296865, "post_id": 51280365, "comment_id": 89538178, "body": "@Tibrogargan <code>sizeof(char)</code> is 1 by definition."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1531296878, "post_id": 51280365, "comment_id": 89538190, "body": "Do you know what <code>break</code> does?"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1531296905, "post_id": 51280365, "comment_id": 89538207, "body": "Do you know how <code>break</code> works? You shouldn&#39;t have the <code>else</code> part <i>inside</i> the loop. The condition should be checked <i>after</i> the loop"}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1531297017, "post_id": 51280365, "comment_id": 89538265, "body": "@Agnew yes, and?  I should show people special cases instead of using the generic version that works for pretty much anything?  I suppose I could have done <code>sizeof(password[0])</code> instead"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 1, "creation_date": 1531297115, "post_id": 51280365, "comment_id": 89538321, "body": "@Tibrogargan You&#39;re comparing pointers to integers there. And I&#39;m not really sure how that loop relates to the OP&#39;s question"}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1531297320, "post_id": 51280365, "comment_id": 89538423, "body": "@CoolGuy much more useful, thanks.  should have been <code>p &lt; password + sizeof...</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531300611, "post_id": 51280365, "comment_id": 89540651, "body": "Always <b>validate</b> the <b>return</b> of <code>scanf</code> and limit your loop to the number of characters in <code>password</code>, e.g. <code>for (loop = 0; password[loop]; loop++) {...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531300499, "post_id": 51281012, "comment_id": 89540568, "body": "What if the user enters <code>&quot;pass123&quot;</code> at the prompt? What happens when you <code>for (loop = 0; loop &lt; 21; loop++)</code> and access <code>password[loop]</code> where loop is <code>7-20</code>? Additionally what is the return from <code>scanf</code> is <code>EOF</code>? How would you know? In either case, you invoke <i>Undefined Behavior</i> accessing indeterminate values within <code>password</code>."}], "tags": [], "owner": {"reputation": 376, "user_id": 6251862, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mGZ5TGlhzC0/AAAAAAAAAAI/AAAAAAAAAGE/I90CXhrOcO4/photo.jpg?sz=128", "display_name": "Shivam Tripathi", "link": "https://stackoverflow.com/users/6251862/shivam-tripathi"}, "is_accepted": false, "score": 3, "last_activity_date": 1531388757, "last_edit_date": 1531388757, "creation_date": 1531298706, "answer_id": 51281012, "question_id": 51280365, "link": "https://stackoverflow.com/questions/51280365/how-can-i-loop-a-string/51281012#51281012", "title": "How can I loop a string?", "body": "<p>So, let's do a simple dry run here. Let's take your code for the first condition (and as remaining all same in logic, so that should do).</p>\n\n<pre><code>for (loop = 0; loop &lt; 21; loop++) {\n    if (password[loop] == '$') {\n        dollar = 1;\n        break;\n    }\n    else {\n        printf(\"Invalid password, recheck for condition 1.\\n\\n\");\n        break;\n    }\n}\n</code></pre>\n\n<p>Let's begin with <code>loop</code> value equals zero. Now the following conditions exist:</p>\n\n<ol>\n<li>The first character is a <code>$</code>. In this case the <code>if</code> condition is satisfies, and we exit out after setting the <code>dollar</code> flag.</li>\n<li>The first character <strong>is not</strong> a <code>$</code> (this is where we primarily go wrong). The <code>if</code> condition fails, as expected - and so we move to the <code>else</code> straightaway. Here we go on to print the error message and break out of the loop, without checking the remaining characters! Logically, we should wait to print the error till we have processed ALL the characters and not found the condition to be satisfied.</li>\n</ol>\n\n<p>So, now we understand the problem - we are printing the error and breaking out after just checking for the first character. But, how can we fix this?</p>\n\n<p>Well, for starters we should wait till we search through all the characters. So the else part must move out of the loop. Also, we know that if we do indeed have the condition satisfied, we will set the <code>dollar</code> variable, and exit the loop. What if we don't find the condition satisfied? Well, in that case <code>dollar</code> will remain zero - and that's how we detect the error! </p>\n\n<p>So, we could possibly do something like: </p>\n\n<pre><code>// Loop through the characters, and as soon as we find $ we set the dollar variable and break\nfor (loop = 0; loop &lt; 21; loop++) {\n    if (password[loop] == '$') {\n        dollar = 1;\n        break;\n    }\n}\n\n// If dollar is still zero, we didn't encounter the $ character\nif (dollar == 0) {\n    printf(\"Invalid password, recheck for condition 1.\\n\\n\");\n}\n</code></pre>\n\n<p>There are a couple of other simple mistakes in the code you posted, but primarily the logical flaw is the above. Look out for the comments to understand the other possible loopholes. Cheers!</p>\n"}], "owner": {"reputation": 49, "user_id": 10063279, "user_type": "registered", "profile_image": "https://graph.facebook.com/603019173420440/picture?type=large", "display_name": "Shawn Michael Armstrong", "link": "https://stackoverflow.com/users/10063279/shawn-michael-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531388757, "creation_date": 1531296664, "last_edit_date": 1531296824, "question_id": 51280365, "link": "https://stackoverflow.com/questions/51280365/how-can-i-loop-a-string", "title": "How can I loop a string?", "body": "<p>In an attempt to familiarize myself with fundamentals, I've been trying to write a simple program for choosing a password. The password is suppose to conform to the 5 listed conditions. The code is designed to loop through the password to determine if the conditions are satisfied and prompt users of any issues. </p>\n\n<p>If the conditions are satisfied its coinciding variable is set to 1. Any variable left 0 is intended to prompt an invalid password. Unfortunately, it would appear that only the first character is being identified. All other conditions, aside from the first character, will fail regardless of the string. </p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\nint main(void) {\n\n    char password[21];\n    int loop;\n    int dollar = 0;\n    int digit = 0;\n    int upperCase = 0;\n    int lowerCase = 0;\n\n    printf(\"Requirements for a valid password:\\n\\n\");\n    printf(\"1. Contain at least one $ sign.\\n\");\n    printf(\"2. Contain at least one number.\\n\");\n    printf(\"3. Contain at least one uppercase letter.\\n\");\n    printf(\"4. Contain at least one lowercase letter.\\n\");\n    printf(\"5. Contain no more than 20 characters.\\n\\n\");\n    printf(\"Enter password: \");\n    scanf(\" %s\", &amp;password);\n    printf(\"\\n\");\n\n    for (loop = 0; loop &lt; 21; loop++) {\n        if (password[loop] == '$') {\n            dollar = 1;\n            break;\n        }\n        else {\n            printf(\"Invalid password, recheck for condition 1.\\n\\n\");\n            break;\n        }\n    }\n\n    for (loop = 0; loop &lt; 21; loop++) {\n        if (isdigit(password[loop])) {\n            digit = 1;\n            break;\n        }\n        else {\n            printf(\"Invalid password, recheck for condition 2.\\n\\n\");\n            break;\n        }\n    }\n\n    for (loop = 0; loop &lt; 21; loop++) {\n        if (isupper(password[loop])) {\n            upperCase = 1;\n            break;\n        }\n        else {\n            printf(\"Invalid password, recheck for condition 3.\\n\\n\");\n            break;\n        }\n    }\n\n    for (loop = 0; loop &lt; 21; loop++) {\n        if (islower(password[loop])) {\n            lowerCase = 1;\n            break;\n        }\n        else {\n            printf(\"Invalid password, recheck for condition 4.\\n\\n\");\n            break;\n        }\n    }\n\n    if ((dollar * digit * upperCase * lowerCase) != 0) {\n        printf(\"Password saved!\");\n    }\n\n    system(\"pause\");\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1531295783, "post_id": 51280044, "comment_id": 89537502, "body": "You forgot the NUL terminator (<code>&#39;\\0&#39;</code>) which <code>printf(&quot;%s</code> expects"}, {"owner": {"reputation": 145, "user_id": 4770412, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FTMw9EpYFEY/AAAAAAAAAAI/AAAAAAAABgs/gEO10Y4rcvE/photo.jpg?sz=128", "display_name": "Aamir Shaikh", "link": "https://stackoverflow.com/users/4770412/aamir-shaikh"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1531295974, "post_id": 51280044, "comment_id": 89537638, "body": "So I just need to copy &#39;\\0&#39; before doing the return?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1531296111, "post_id": 51280044, "comment_id": 89537725, "body": "Remember, in C, all strings must be <i>nul-terminated</i>, otherwise it is simply an array or block of characters in memory. The <code>&quot;%s&quot;</code> format specifier (and all C-library <code>str...</code> functions) expect a <i>nul-terminated</i> string."}], "answers": [{"tags": [], "owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "is_accepted": false, "score": 0, "last_activity_date": 1531296805, "creation_date": 1531296805, "answer_id": 51280413, "question_id": 51280044, "link": "https://stackoverflow.com/questions/51280044/after-memcpy-garbage-data-is-getting-printed/51280413#51280413", "title": "After memcpy garbage data is getting printed", "body": "<p>There are few issues with your program</p>\n\n<p>1) Your <code>while</code> loops makes your memcpy to access the memory beyond what is allocated by you. So make your while look like <code>while(n &lt; out_len-rem){</code> </p>\n\n<p>2) strings should always end with <code>\\0</code>. So your <code>memcpy</code> should look like <code>memcpy(&amp;c[n], ip_str, rem-1);</code></p>\n"}, {"tags": [], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "is_accepted": true, "score": 1, "last_activity_date": 1531307783, "last_edit_date": 1531307783, "creation_date": 1531298098, "answer_id": 51280824, "question_id": 51280044, "link": "https://stackoverflow.com/questions/51280044/after-memcpy-garbage-data-is-getting-printed/51280824#51280824", "title": "After memcpy garbage data is getting printed", "body": "<p>The code in your question contains ~5 syntax errors. It's better to show the code that you used exactly.</p>\n\n<p>Once fixed to be syntactically correct C, your program attempts to write more data to the malloc-allocated block than can fit: <a href=\"https://taas.trust-in-soft.com/tsnippet/t/9c2ce34f\" rel=\"nofollow noreferrer\">https://taas.trust-in-soft.com/tsnippet/t/9c2ce34f</a></p>\n\n<p>It has been pointed out by Frankie_C in the comments that you may want to reserve room for a final <code>'\\0'</code>, but this is not sufficient to make the program defined: there is also a logic error in that the program attempts to copy <code>in_len</code> more chars as soon as there remains room for one more char: <a href=\"https://taas.trust-in-soft.com/tsnippet/t/3a2b848b\" rel=\"nofollow noreferrer\">https://taas.trust-in-soft.com/tsnippet/t/3a2b848b</a></p>\n\n<p>I changed the loop condition to <code>while (n &lt; out_len - rem) {</code> just like in Karthick's answer. Now the problem is that the array of chars passed to <code>printf(\"%s\"</code> does not end with a final <code>'\\0'</code>: <a href=\"https://taas.trust-in-soft.com/tsnippet/t/7c1ca032\" rel=\"nofollow noreferrer\">https://taas.trust-in-soft.com/tsnippet/t/7c1ca032</a></p>\n\n<p>The final <code>\\'0'</code> has to be written. Since the destination block was allocated by <code>malloc</code> and is not guaranteed to be 0-initialized, it is not enough to leave room for a character at the end. You must also explicitly set the last character to <code>'\\0'</code>, for instance with:</p>\n\n<pre><code>c[out_len] = '\\0'; \n</code></pre>\n\n<p>Finally, the modified version of your program that does not produce undefined behavior is (<a href=\"https://taas.trust-in-soft.com/tsnippet/t/dea9e8b2\" rel=\"nofollow noreferrer\">https://taas.trust-in-soft.com/tsnippet/t/dea9e8b2</a> ):</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nchar *cpy_data(char *ip_str, int in_len, int out_len)\n{\n    char *c = malloc(out_len + 1);\n    memset(c, 0, out_len);\n    int rem, n;\n    rem = out_len % in_len;\n    n = 0;\n    while(n &lt; out_len - rem){\n        memcpy(&amp;c[n], ip_str, in_len);\n        n += in_len;\n    }\n    if (rem)\n        memcpy(&amp;c[n], ip_str, rem);\n    c[out_len] = '\\0';    \n    printf(\"%s \\n\", c);\n    return c;\n}\n\nint main(int argc, char **argv) {\n  char *ch = \"apples\";\n  ch = cpy_data(ch, 6, 20);  \n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4770412, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FTMw9EpYFEY/AAAAAAAAAAI/AAAAAAAABgs/gEO10Y4rcvE/photo.jpg?sz=128", "display_name": "Aamir Shaikh", "link": "https://stackoverflow.com/users/4770412/aamir-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 51280824, "answer_count": 2, "score": -1, "last_activity_date": 1531307783, "creation_date": 1531295603, "question_id": 51280044, "link": "https://stackoverflow.com/questions/51280044/after-memcpy-garbage-data-is-getting-printed", "title": "After memcpy garbage data is getting printed", "body": "<p>I was recently trying to create a function that duplicates the string eg: ip: \"apple\" count=5, output:\"appleappleappleappleapple\"</p>\n\n<pre><code>char *ch = \"apples\"\nch = cpy_data(ch, 6, 20);  \n\nchar *cpy_data(char *ip_str, int in_len, out_len)\n{\n    char *c = malloc(out_len);\n    memset(c, 0, out_len);\n    int rem, n;\n    rem = out_len % in_len;\n    n = 0;\n    while(n &lt; out_len){\n        memcpy(&amp;c[n], ip_str, in_len);\n        n += in_len;\n    }\n    if (rem)\n        memcpy(&amp;c[n], ip_str, rem);\n    printf(\"%s \\n\" c);\n    return c;\n}\nOutPut: applesapplesapplesapplesaph\ufffd\n</code></pre>\n\n<p>The output len is considerably larger than the expected input as well as some trailing garbage data is getting printed. </p>\n"}, {"tags": ["c", "linux", "bash", "shell", "sh"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1531290708, "post_id": 51278612, "comment_id": 89534773, "body": "Why do you think the other coders did not know klhow to code?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1531290954, "post_id": 51278612, "comment_id": 89534879, "body": "Which architecture? You can always read the sources and see what it does. Everything consumes CPU but usually it\u2019s not a busy loop."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1531291122, "post_id": 51278612, "comment_id": 89534953, "body": "<a href=\"http://man7.org/linux/man-pages/man3/sleep.3.html\" rel=\"nofollow noreferrer\"><code>man sleep</code></a> and click through to <a href=\"http://man7.org/linux/man-pages/man2/nanosleep.2.html\" rel=\"nofollow noreferrer\"><code>man nanosleep</code></a>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1531295258, "post_id": 51278612, "comment_id": 89537180, "body": "What is the purpose of most of the sleeps?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1531295935, "post_id": 51278612, "comment_id": 89537611, "body": "@PeterJ_01 If a large code base uses a lot of sleep, chances are, that indeed the previous coders or architects didn&#39;t know what they were doing..."}], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 5, "last_activity_date": 1569836601, "last_edit_date": 1569836601, "creation_date": 1531294306, "answer_id": 51279647, "question_id": 51278612, "link": "https://stackoverflow.com/questions/51278612/does-using-sleep-in-scripts-consume-cpu-cycles/51279647#51279647", "title": "Does using sleep in scripts consume cpu cycles?", "body": "<p>In Linux <code>sleep</code> doesn't consume CPU cycles, at least not more than not sleeping would. If the kernel doesn't find anything better to do, it will use the time to do some useful stuff in the idle process - and if that doesn't have anything to do, the kernel would temporarily halt the CPU until an external event occurs to lower power consumption.</p>\n\n<p>In any case <em>I'd say</em> that \"a lot of <code>sleep</code>\" usually <em>is</em> a symptom of bad coding - how did the programmer know before execution what would be the time that would be spent before the next event would occur! An IO-bound program should be <strong><em>blocked</strong> waiting for events</em> most of time, not <em>sleeping</em>! If the program is CPU-bound, then it should be <strong><em>calculating</strong> the results</em> most of the time, not sleeping.</p>\n"}], "owner": {"reputation": 37, "user_id": 10062932, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qnyeasJB4dI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oY-qmrkgSA8u96oOecrTh8Pu3ViQ/mo/photo.jpg?sz=128", "display_name": "Sayooj Krishnan", "link": "https://stackoverflow.com/users/10062932/sayooj-krishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1865, "favorite_count": 0, "accepted_answer_id": 51279647, "answer_count": 1, "score": 2, "last_activity_date": 1569836601, "creation_date": 1531290510, "last_edit_date": 1531374092, "question_id": 51278612, "link": "https://stackoverflow.com/questions/51278612/does-using-sleep-in-scripts-consume-cpu-cycles", "title": "Does using sleep in scripts consume cpu cycles?", "body": "<p>I find a lot of sleep used in a large code base, in-order to optimize it I want to remove all the sleep used and perform those operations in an alternative way. Does using sleep command consume CPU cycle, or does in send the process to waiting state only?</p>\n"}, {"tags": ["c++", "c", "for-loop", "declaration"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531288594, "post_id": 51278123, "comment_id": 89533811, "body": "There&#39;s no compiler bug"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1531288610, "post_id": 51278123, "comment_id": 89533822, "body": "C and C++ are different languages with different rules."}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1531288814, "post_id": 51278123, "comment_id": 89533904, "body": "@user2864740 gcc prog.c -Wall -pedantic"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1531290196, "post_id": 51278123, "comment_id": 89534529, "body": "You are not redeclaring <code>i</code> you are shadowing it in a nested scope."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1531294067, "post_id": 51278123, "comment_id": 89536498, "body": "@rsp -- Actually, what you need is <code>-Wshadow</code> in C, the warning is not issued through either <code>-Wall</code> or <code>-pedantic</code> (which you assume it would be, but isn&#39;t)"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1531326114, "post_id": 51278123, "comment_id": 89558113, "body": "It looks like you forgot to enable a good set of warnings.  For GCC, I recommend <code>-Wall -Wextra -Wwrite-strings</code> as a minimum; consider also <code>-Wpedantic -Warray-bounds</code> for identifying some other common mistakes."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1531288667, "creation_date": 1531288667, "answer_id": 51278163, "question_id": 51278123, "link": "https://stackoverflow.com/questions/51278123/why-doesnt-the-c-compiler-give-a-redeclaration-error-inside-a-for-loop-body/51278163#51278163", "title": "Why doesn&#39;t the C compiler give a redeclaration error inside a for loop body?", "body": "<p>First of all, there is no re-declaration inside the loop. Inside the loop body. <code>i</code> is defined every time the loop is entered, and the scope is only till the loop body.</p>\n\n<p>Once the loop finishes the iteration, the variable does not exist anymore. (<em>First quote</em>)</p>\n\n<p>That being said, what you are seeing is a result of <em>shadowing</em>. (<em>Second quote</em>)</p>\n\n<p>Quoting <code>C11</code>,</p>\n\n<blockquote>\n  <p>If the declarator or type specifier that\n  declares the identifier appears inside a block or within the list of parameter declarations in\n  a function definition, the identifier has block scope, which terminates at the end of the\n  associated block. [...]</p>\n</blockquote>\n\n<p>and,</p>\n\n<blockquote>\n  <p>[...] If an identifier designates two different entities in the same name\n  space, the scopes might overlap. If so, the scope of one entity (the inner scope) will end\n  strictly before the scope of the other entity (the outer scope). Within the inner scope, the\n  identifier designates the entity declared in the inner scope; the entity declared in the outer\n  scope is hidden (and not visible) within the inner scope.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1531290471, "post_id": 51278258, "comment_id": 89534659, "body": "The directly on point quote is [stmt.iter]/3."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 13, "last_activity_date": 1531291411, "last_edit_date": 1531291411, "creation_date": 1531289100, "answer_id": 51278258, "question_id": 51278123, "link": "https://stackoverflow.com/questions/51278123/why-doesnt-the-c-compiler-give-a-redeclaration-error-inside-a-for-loop-body/51278258#51278258", "title": "Why doesn&#39;t the C compiler give a redeclaration error inside a for loop body?", "body": "<p>C++ and C make a distinction here. According to <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.8.5\" rel=\"noreferrer\">C11 (n1570) \u00a76.8.5 \u00b65</a>, emphasis mine:</p>\n\n<blockquote>\n  <p>An iteration statement is a block whose scope is a strict subset of\n  the scope of its enclosing block. <strong>The loop body is also a block whose\n  scope is a strict subset of the scope of the iteration statement</strong>.</p>\n</blockquote>\n\n<p>Which translates to this for a for loop:</p>\n\n<pre><code>{\n    declaration \n    while ( expression) {\n        statement\n        expression ;\n    }\n}\n</code></pre>\n\n<p>Anything you put in the <code>statement</code> part can hide whatever is introduced in the declaration. Now, C++(17, n4659) explicitly says something similar at <a href=\"https://timsong-cpp.github.io/cppwp/n4659/stmt.for#1\" rel=\"noreferrer\">[stmt.for]/1</a>. But it also goes on to add:</p>\n\n<blockquote>\n  <p>except that names declared in the init-statement are in the same\n  declarative region as those declared in the condition,</p>\n</blockquote>\n\n<p>So here the second <code>i</code> is indeed an attempt at a re-declaration. The above may sound confusing (names declared in the condidion!?), but the \"condition\" here is defined like this (<a href=\"https://timsong-cpp.github.io/cppwp/n4659/stmt.stmt#nt:condition\" rel=\"noreferrer\">[stmt.stmt]/1</a>):</p>\n\n<pre><code>condition:\n    expression\n    attribute-specifier-seq decl-specifier-seq declarator brace-or-equal-initializer\n</code></pre>\n\n<p>It's that which allows while loops like this (<a href=\"https://timsong-cpp.github.io/cppwp/n4659/stmt.while\" rel=\"noreferrer\">C++ only</a>):</p>\n\n<pre><code>while (T t = x) statement \n</code></pre>\n\n<p>And <a href=\"https://timsong-cpp.github.io/cppwp/n4659/stmt.stmt#3\" rel=\"noreferrer\">you may not re-declare <code>t</code></a> inside the statement of the while loop. </p>\n\n<hr>\n\n<p>Alternatively, the entire conclusion I reach is summarized in <a href=\"https://timsong-cpp.github.io/cppwp/n4659/stmt.iter#3\" rel=\"noreferrer\">[stmt.iter]/3</a> (thank you @T.C.):</p>\n\n<blockquote>\n  <p>If a name introduced in an init-statement or for-range-declaration is\n  redeclared in the outermost block of the substatement, the program is\n  ill-formed.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1531292371, "post_id": 51278429, "comment_id": 89535633, "body": "&quot;If it wasn&#39;t allowed, it would be very hard to maintain large projects, as you would constantly run into naming collisions.&quot; I&#39;m not sure that follows. We do just fine in C++."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1531292753, "post_id": 51278429, "comment_id": 89535823, "body": "What Bathsheba said. And it&#39;s only disallowed in the outermost block anyway. Which makes sense. What possible naming collision could have that, such that you <i>immediately</i> need to hide the loop control variable?"}, {"owner": {"reputation": 39, "user_id": 9006219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1839891e302380d8ddfb298364638778?s=128&d=identicon&r=PG&f=1", "display_name": "Sailesh010", "link": "https://stackoverflow.com/users/9006219/sailesh010"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1531297152, "post_id": 51278429, "comment_id": 89538341, "body": "It&#39;s just that C++ compiler is more strict. @Bathsheba"}], "tags": [], "owner": {"reputation": 39, "user_id": 9006219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1839891e302380d8ddfb298364638778?s=128&d=identicon&r=PG&f=1", "display_name": "Sailesh010", "link": "https://stackoverflow.com/users/9006219/sailesh010"}, "is_accepted": false, "score": 0, "last_activity_date": 1531297342, "last_edit_date": 1531297342, "creation_date": 1531289838, "answer_id": 51278429, "question_id": 51278123, "link": "https://stackoverflow.com/questions/51278123/why-doesnt-the-c-compiler-give-a-redeclaration-error-inside-a-for-loop-body/51278429#51278429", "title": "Why doesn&#39;t the C compiler give a redeclaration error inside a for loop body?", "body": "<p><strong>It's not redeclaration.</strong> <em>(Not literally, some may still call it though)</em></p>\n\n<p>See this carefully...</p>\n\n<pre><code>for(int i = 0; i &lt; 7; i++)\n{\n    printf(\"i = %d\\n\", i);\n    int i = 5;\n    printf(\"new i = %d\\n\", i);\n}\n</code></pre>\n\n<p>Output of the above code:-</p>\n\n<pre><code>i = 0\nnew i = 5\ni = 1\nnew i = 5\ni = 2\nnew i = 5\ni = 3\nnew i = 5\ni = 4\nnew i = 5\ni = 5\nnew i = 5\ni = 6\nnew i = 5\n</code></pre>\n\n<p>Clearly, there are two different <code>i</code>'s</p>\n\n<p>The newer <code>i</code> has a more local scope.</p>\n\n<p><strong>Is it a bug?</strong></p>\n\n<p>No</p>\n\n<p><strong>What is the purpose?</strong></p>\n\n<p>If it wasn't allowed, it might be very hard to maintain large projects, as you would constantly run into naming collisions.</p>\n\n<p>Generally though, it is considered very poor practice to give the same name to different variables in different scopes, you should avoid doing that whenever possible.</p>\n\n<p><strong>Why is there no warning message?</strong></p>\n\n<p>Use <code>gcc file_name.c -Wshadow</code> to compile.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> <strong><em>You can also locally lock the originally declared variables by redeclaring them in for loops.</em></strong></p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "closed_date": 1531290350, "accepted_answer_id": 51278258, "answer_count": 3, "score": 7, "last_activity_date": 1531311810, "creation_date": 1531288503, "last_edit_date": 1531311810, "question_id": 51278123, "link": "https://stackoverflow.com/questions/51278123/why-doesnt-the-c-compiler-give-a-redeclaration-error-inside-a-for-loop-body", "closed_reason": "Duplicate", "title": "Why doesn&#39;t the C compiler give a redeclaration error inside a for loop body?", "body": "<p>In the C language, if we write this:</p>\n\n<pre><code>for(int i = 0; i &lt; 7; i++)\n{\n    // for loop Body\n}\n</code></pre>\n\n<p>The scope of variable <code>i</code> is inside the for loop body. It is OK.</p>\n\n<p>But, if I write this:</p>\n\n<pre><code>for(int i = 0; i &lt; 7; i++)\n{\n    long int i = 1; // Redeclaration of i\n}\n</code></pre>\n\n<p>Here, the variable <code>i</code> is declared again inside the loop body, yet it successfully compiles and runs in C.</p>\n\n<p>But, in C++, the compiler gives a <strong>\"redeclaration of 'long int i'\"</strong> error.</p>\n\n<p>So, why doesn't the C compiler give a redeclaration error? Is it a compiler bug?</p>\n"}, {"tags": ["c", "debugging", "watch"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 4, "creation_date": 1531288882, "post_id": 51278115, "comment_id": 89533938, "body": "How does the variable <code>dc</code> get assigned to 1? Can&#39;t you just call the function at the same time?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8969424"}, "edited": false, "score": 1, "creation_date": 1531291075, "post_id": 51278115, "comment_id": 89534936, "body": "your question is highly confusing. Do you want to call a function when it dc becomes 1 or every time you update dc? Other than losing connection, under what other condition(s) can it be set to 1? You can update dc in a function &amp; within the function do <code>if (dc == 1) { fn(); } return;</code> Where is the <i>lot of <code>if-else</code></i> coming from?"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1531288909, "creation_date": 1531288909, "answer_id": 51278221, "question_id": 51278115, "link": "https://stackoverflow.com/questions/51278115/how-to-watch-a-variable/51278221#51278221", "title": "How to watch a variable?", "body": "<p>Nothing like this exists. Interpreted or managed languages have completely different rules. There is no other way than if. </p>\n\n<p>You can wrap it into some kind of assertion or function but there is no other way than if in that wrapper</p>\n"}, {"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1531289703, "creation_date": 1531289703, "answer_id": 51278396, "question_id": 51278115, "link": "https://stackoverflow.com/questions/51278115/how-to-watch-a-variable/51278396#51278396", "title": "How to watch a variable?", "body": "<p>The sad answer is: No, there's no reliable way to watch a variable in C this way. </p>\n\n<p>Depending on how the code works there are some workarounds.</p>\n\n<p>One way is to hide (yes I know, it's hard to hide stuff completely in C) the variable. Define functions:</p>\n\n<pre><code>int noConnection() { return _noConnection; }\nvoid lostConnection() { _noConnection = 1; myFunction(); }\n</code></pre>\n\n<p>Another way is to code some monitor that checks the variable at regular intervals. A drawback is if you really need this function to be run every time it changes, because it will not catch the event that a variable is changed and changed back between checks.</p>\n"}, {"tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1531374562, "last_edit_date": 1531374562, "creation_date": 1531289958, "answer_id": 51278457, "question_id": 51278115, "link": "https://stackoverflow.com/questions/51278115/how-to-watch-a-variable/51278457#51278457", "title": "How to watch a variable?", "body": "<p>If the variable is <em>not referenced by any pointers</em> then <strong>you already know the places where it is updated</strong>, so you can use visibleman's method. There won't be a lot of <code>if-else</code>s like you anticipated. Just create a function like this</p>\n\n<pre><code>inline void update_dc(int new_dc) // or a macro if you want, \n{                                 //  but inline functions are more preferrable\n#ifdef DEBUG_DC\n    if (new_dc == 1) // or if (new_dc != dc)\n    {\n        trap();\n    }\n#endif\n    dc = new_dc;\n}\n</code></pre>\n\n<p>and replace all assignments to dc with this function. You can do that easily with a regex in any text editors' find/replace command, or find/sed in the terminal</p>\n\n<hr>\n\n<p>However in the general case when you don't know exactly at what point it can be updated, the easiest way is using a <em>separate thread</em> for watching it. You'll do some kind of polling by using a timer, or by checking the value and then sleep for some time to avoid wasting CPU usage. But you won't get the exact place where the change happens, unless you insert a value check after every instruction, which slows down your app many times.</p>\n\n<p>You may also run a debugger like gdb and <a href=\"https://stackoverflow.com/q/58851/995714\"><strong>attach it to your own process</strong> to watch</a>. It'll be a lot more flexible this way, but you'll need more memory. You can also try some debugging library if available</p>\n\n<p>See <a href=\"https://stackoverflow.com/q/8941711/995714\">Is is possible to set a gdb watchpoint programatically?</a></p>\n\n<hr>\n\n<p>Many architectures do have <a href=\"https://lwn.net/Articles/353050/\" rel=\"nofollow noreferrer\"><strong>hardware watch points</strong></a>, so debuggers will try to use them up before turning up to software watching (<a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/Set-Watchpoints.html\" rel=\"nofollow noreferrer\">which is extremely slow</a>). If you know about the architecture you can also <strong>set up the debug registers manually</strong> like that instead of running a full-fledged debugger. Of course most of the time you'll need to run in privileged mode to set those registers</p>\n\n<p>On x86 there are 3 breakpoints stored in DR0-DR3 which will break on execution, data write, data read/write and IO read/write. I don't know the situation on ARM but it <a href=\"https://stackoverflow.com/q/31005781/995714\">seems to have 6 hardware breakpoints</a>. You can check those on <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0446g/BEICGIFG.html\" rel=\"nofollow noreferrer\">ARM's documentation</a> if you want to go that way.</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 1687327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e68d5cef3ad7bbb3c97872dd85b9e03d?s=128&d=identicon&r=PG", "display_name": "user1687327", "link": "https://stackoverflow.com/users/1687327/user1687327"}, "is_accepted": false, "score": 0, "last_activity_date": 1531375278, "creation_date": 1531375278, "answer_id": 51298282, "question_id": 51278115, "link": "https://stackoverflow.com/questions/51278115/how-to-watch-a-variable/51298282#51298282", "title": "How to watch a variable?", "body": "<p>The most straightforward solution seems to be to stop changing the variable directly and write a getter and setter function, that will call some callback.</p>\n"}], "owner": {"reputation": 9, "user_id": 10062779, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209171703369941/picture?type=large", "display_name": "Usman Ahmad Khan", "link": "https://stackoverflow.com/users/10062779/usman-ahmad-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1613743929, "creation_date": 1531288474, "last_edit_date": 1613743929, "question_id": 51278115, "link": "https://stackoverflow.com/questions/51278115/how-to-watch-a-variable", "title": "How to watch a variable?", "body": "<p>I have a code base of almost 16000 lines of C code in which I am performing different operations (on a Raspberry Pi). After each operation, I am updating the value of <code>dc</code>. <code>dc</code> is initially 0 and if through some error my controller loses its connection with my laptop it becomes 1.</p>\n<p>I need to call a function whenever it goes 1. I heard of a function in JavaScript called <code>Object.prototype.watch()</code> and <code>unwatch()</code>. Basically what it does is watches a variable and whenever its value changes, it calls a function. I need to implement a similar function or statement or anything that calls a function when my <code>dc</code> value changes.</p>\n<p>I cannot use if-else after each update of <code>dc</code> because it is not a good way of coding and there are going to be a lot of <code>if-else</code> if I use it.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "usb", "linux-device-driver"], "comments": [{"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 1, "creation_date": 1531296816, "post_id": 51277983, "comment_id": 89538147, "body": "The documentation <a href=\"https://elixir.bootlin.com/linux/v4.17.5/source/Documentation/driver-api/usb/error-codes.rst\" rel=\"nofollow noreferrer\">states what error codes mean</a>. If you don&#39;t know what &quot;stall&quot; means, check the USB specs. A frequent cause of stalls is erroneous data sent to the device."}, {"owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1531297072, "post_id": 51277983, "comment_id": 89538299, "body": "Thanks for the link. My error is happening in usb_submit_urb. The pipe type specified in the URB doesn&#39;t match the endpoint&#39;s actual type. As per my knowledge of USB, each and every USB device has control endpoint, which works in both direction IN and OUT.  To verify control endpoint, I tried USB_REQ_GET_INTERFACE, it returned successfully"}], "owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531287841, "creation_date": 1531287841, "question_id": 51277983, "link": "https://stackoverflow.com/questions/51277983/usb-control-msg-returns-epipe", "title": "usb_control_msg returns -EPIPE", "body": "<p>I am converting WinCE USB Code to Linux, so here is the WinCE code that gets the APP Revision using Control message.</p>\n\n<pre><code>        ControlHeader.bmRequestType = USB_REQUEST_DEVICE_TO_HOST | USB_REQUEST_VENDOR | USB_REQUEST_FOR_INTERFACE;\n        ControlHeader.bRequest = RADS_GET_APPREVISION;\n        ControlHeader.wValue = 0;                               // unused\n        ControlHeader.wIndex = 0;                               // unused\n        ControlHeader.wLength = sizeof(USHORT);                 // size of output buffer\n\n        dwError = IssueVendorTransfer(pGENDevice-&gt;lpUsbFuncs,\n                                      pGENDevice-&gt;hUsbDevice,\n                                      NULL,\n                                      NULL,\n                                      (USB_IN_TRANSFER|USB_SHORT_TRANSFER_OK),\n                                      &amp;ControlHeader,\n                                      pusTemp,\n                                      0,\n                                      &amp;dwBytesTransferred,\n                                      0,\n                                      &amp;dwUsbError); \n</code></pre>\n\n<p>I converted it as below for Linux:</p>\n\n<pre><code> retval = usb_control_msg(dev-&gt;usb_dev,\n                                                usb_rcvctrlpipe(dev-&gt;usb_dev, 0),\n                                                RADS_GET_APPREVISION,\n                                                USB_DIR_IN | USB_TYPE_VENDOR | USB_RECIP_INTERFACE,\n                                                0,\n                                                0,\n                                                &amp;appRevision,\n                                                sizeof(unsigned short),\n                                                USB_CTRL_SET_TIMEOUT);\n</code></pre>\n\n<p>I am getting -EPIPE as retval.  What does the return value -EPIPE signifies</p>\n\n<p>Can you help me in resolving this issue.. Thanks for your time..</p>\n"}, {"tags": ["c", "read-write"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1531285448, "post_id": 51277567, "comment_id": 89532663, "body": "You need to test the results of <code>open()</code> and <code>write()</code>.  Your call with <code>O_APPEND</code> needs <code>O_WRONLY</code> too.  And if you want it to create the file too, you need various other options too \u2014 <code>O_CREAT</code>; maybe <code>O_TRUNC</code> but probably not; maybe <code>O_EXCL</code>; maybe some others too \u2014 and you need a mode argument for the third argument (e.g. <code>0644</code> \u2014 owner can read or write, group and others can only read; or something more restrictive)."}, {"owner": {"reputation": 19, "user_id": 10062575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tVtKlpHp864/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7os7BwxjwroCuaw4tTpCOvR5p7aJQ/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10062575/anonymous"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531285756, "post_id": 51277567, "comment_id": 89532772, "body": "Yep, got it. Thanks!"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1531288301, "post_id": 51277567, "comment_id": 89533691, "body": "And in the first place, you should test if <code>arg&gt;=3</code>."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1531288549, "creation_date": 1531288549, "answer_id": 51278140, "question_id": 51277567, "link": "https://stackoverflow.com/questions/51277567/concatenating-files-using-read-and-write-system-calls/51278140#51278140", "title": "Concatenating files using read and write system calls", "body": "<p>As I noted in a comment:</p>\n\n<blockquote>\n  <p>You need to test the results of <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html\" rel=\"nofollow noreferrer\"><code>open()</code></a> and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/write.html\" rel=\"nofollow noreferrer\"><code>write()</code></a>. Your call with <code>O_APPEND</code> needs <code>O_WRONLY</code> too. And if you want it to create the file too, you need various other options too \u2014 <code>O_CREAT</code>; maybe <code>O_TRUNC</code> but probably not; maybe <code>O_EXCL</code>; maybe some others too \u2014 and you need a mode argument for the third argument (e.g. 0644 \u2014 owner can read or write, group and others can only read; or something more restrictive).</p>\n</blockquote>\n\n<p>You also need to check that you have 2 file name arguments.</p>\n\n<p>Fixing those issues leads to code similar to this:</p>\n\n<pre><code>int main(int arg, char* argv[]){  \n    if (argc &lt; 3)\n    {\n        fprintf(stderr, \"Usage: %s out-file in-file\\n\", argv[0]);\n        return 1;\n    }\n    int fd1 = open(argv[1], O_APPEND|O_WRONLY|O_CREAT, 0644);\n    if (fd1 &lt; 0)\n    {\n        fprintf(stderr, \"%s: failed to open/create file %s for writing\\n\", argv[0], argv[1]);\n        return 1;\n    }\n    int fd2 = open(argv[2], O_RDONLY);  \n    if (fd2 &lt; 0)\n    {\n        fprintf(stderr, \"%s: failed to open file %s for reading\\n\", argv[0], argv[2]);\n        return 1;\n    }\n    char c;\n    while (read(fd2, &amp;c, sizeof(c)) == sizeof(c)) {  \n        if (write(fd1, &amp;c, sizeof(c)) != sizeof(c))\n            break;  \n    }  \n    close(fd1);  \n    close(fd2);  \n    return 0;  \n}\n</code></pre>\n\n<p>I note that you might get warnings about comparing signed and unsigned values with the <code>read()</code> and <code>write()</code> tests \u2014 the functions return a <code>ssize_t</code> and <code>sizeof</code> produces a <code>size_t</code> (2 vs 1 letters <code>s</code>).  You can cast around that, but it's ugly.  The code is also woefully inefficient.  Single character reads and writes work, but you get dramatically better performance in general with buffer sizes in the 1 KiB to 4 KiB range, and even bigger.  Of course, then you have to trap and use the value returned by <code>read()</code> so that the correct amount of data is written.</p>\n\n<p>Note that the original code would continue the loop if the <code>read()</code> failed (returned <code>-1</code>).  It would only stop if the <code>read()</code> was successful at returning <code>0</code> when it reached EOF.</p>\n"}], "owner": {"reputation": 19, "user_id": 10062575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tVtKlpHp864/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7os7BwxjwroCuaw4tTpCOvR5p7aJQ/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10062575/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531288549, "creation_date": 1531285312, "last_edit_date": 1531288310, "question_id": 51277567, "link": "https://stackoverflow.com/questions/51277567/concatenating-files-using-read-and-write-system-calls", "title": "Concatenating files using read and write system calls", "body": "<p>I wrote this simple code to concatenate two files. Why doesn't this work? Please help.  </p>\n\n<pre><code>int main(int arg, char* argv[]){  \n    int fd1, fd2;  \n    char c;  \n    fd1 = open(argv[1], O_APPEND);  \n    fd2 = open(argv[2], O_RDONLY);  \n    while(read(fd2, &amp;c, sizeof(c))) {  \n        write(fd1, &amp;c, sizeof(c));  \n    }  \n    close(fd1);  \n    close(fd2);  \n    return 0;  \n}  \n</code></pre>\n"}, {"tags": ["c", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 5, "creation_date": 1531284134, "post_id": 51277347, "comment_id": 89532272, "body": "A C array of size 500 has indices from 0 to 499. 499 squared is 249001. Your program is doing exactly what it is supposed to. If you want 250000, that would be index 500, the last element in a <i>501</i>-element array. See <a href=\"https://en.wikipedia.org/wiki/Off-by-one_error\" rel=\"nofollow noreferrer\">Off-by-1 error / Fencepost error</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531284321, "post_id": 51277347, "comment_id": 89532323, "body": "Note that it is conventional to use <code>for (int i = 0; i &lt; size; i++)</code> rather than <code>i &lt;= (size - 1)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9843867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIG_-4ZYr2M/AAAAAAAAAAI/AAAAAAAAACg/8c05NQq8oSc/photo.jpg?sz=128", "display_name": "Benjamin John", "link": "https://stackoverflow.com/users/9843867/benjamin-john"}, "edited": false, "score": 0, "creation_date": 1531329607, "post_id": 51277429, "comment_id": 89559912, "body": "Thank you, much appreciated!"}], "tags": [], "owner": {"reputation": 8391, "user_id": 7896849, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Q2qxc.jpg?s=128&g=1", "display_name": "Sreeram TP", "link": "https://stackoverflow.com/users/7896849/sreeram-tp"}, "is_accepted": true, "score": 1, "last_activity_date": 1531284333, "creation_date": 1531284333, "answer_id": 51277429, "question_id": 51277347, "link": "https://stackoverflow.com/questions/51277347/loading-an-array-with-the-squares-of-its-subscripts-in-c/51277429#51277429", "title": "Loading an array with the squares of it&#39;s subscripts in C", "body": "<p>In your code you have defined an array of size 500. It will contain indices from 0 to 499.</p>\n\n<p>So, the last result of your calculation will be <code>499*499 = 249001</code>.</p>\n\n<p>If you want to get the result of <code>500*500</code> then you have to declare an array of 501 locations. The below code shows how.</p>\n\n<pre><code>#define N 501\n\nint subscriptSquares[N];\n\nvoid loadArray(int nums[], int size)\n{\n    for(int i = 0; i &lt;= (size - 1); i++)\n    {\n        nums[i] = i * i;\n        printf(\"%i\\n\", nums[i]);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9843867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIG_-4ZYr2M/AAAAAAAAAAI/AAAAAAAAACg/8c05NQq8oSc/photo.jpg?sz=128", "display_name": "Benjamin John", "link": "https://stackoverflow.com/users/9843867/benjamin-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1531495823, "accepted_answer_id": 51277429, "answer_count": 1, "score": -1, "last_activity_date": 1531284333, "creation_date": 1531283838, "question_id": 51277347, "link": "https://stackoverflow.com/questions/51277347/loading-an-array-with-the-squares-of-its-subscripts-in-c", "closed_reason": "Not suitable for this site", "title": "Loading an array with the squares of it&#39;s subscripts in C", "body": "<pre><code>#define N 500\n\nint subscriptSquares[N];\n\nvoid loadArray(int nums[], int size)\n{\n    for(int i = 0; i &lt;= (size - 1); i++)\n    {\n        nums[i] = i * i;\n        printf(\"%i\\n\", nums[i]);\n    }\n}\n</code></pre>\n\n<p>What I'm trying to do more specifically is load an array of size 500 with its subscript squares (so subscriptSquares = {0, 1, 4, 9, 16, 25, ...250000}). My problem is somewhere along the line the values are shortened. The last value in the array actually becomes 249001 instead of 250000 and so on so forth. I thought it had something to with the data type so I switched it to double but ended up with same values with the obvious annoyance of decimals. <code>int subscriptSquares[N]</code> is inside the main function. If you need more information let me know</p>\n"}, {"tags": ["c", "printf", "scanf", "c11"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8969424"}, "edited": false, "score": 1, "creation_date": 1531283641, "post_id": 51277253, "comment_id": 89532175, "body": "lose the \\n in your scanf. Read about the <a href=\"https://stackoverflow.com/questions/19499060/what-is-the-effect-of-trailing-white-space-in-a-scanf-format-string\">effects of trailing white space in scanf</a>"}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 1, "creation_date": 1531283978, "post_id": 51277253, "comment_id": 89532243, "body": "use cout and cin it should work"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531284756, "post_id": 51277315, "comment_id": 89532462, "body": "Not checking the return value in a loop..."}], "tags": [], "owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "is_accepted": true, "score": 2, "last_activity_date": 1531283617, "creation_date": 1531283617, "answer_id": 51277315, "question_id": 51277253, "link": "https://stackoverflow.com/questions/51277253/what-is-the-proper-way-of-running-for-loop-with-scanf-function/51277315#51277315", "title": "what is the proper way of running for loop with scanf function", "body": "<p>Your <code>scanf</code> doesn't need the space and the newline character, just <code>\"%d\"</code>.</p>\n\n<pre><code>for(i=0; i&lt;5; i++)\n{\n     printf(\"enter the %d position no: \",i+1);\n     scanf(\"%d\",&amp;a[i]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 7654857, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6f9f64151ccdbbb68939881934ec1d95?s=128&d=identicon&r=PG&f=1", "display_name": "sikka karma", "link": "https://stackoverflow.com/users/7654857/sikka-karma"}, "edited": false, "score": 0, "creation_date": 1531284039, "post_id": 51277317, "comment_id": 89532253, "body": "thanks,its working"}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 2, "last_activity_date": 1531284478, "last_edit_date": 1531284478, "creation_date": 1531283633, "answer_id": 51277317, "question_id": 51277253, "link": "https://stackoverflow.com/questions/51277253/what-is-the-proper-way-of-running-for-loop-with-scanf-function/51277317#51277317", "title": "what is the proper way of running for loop with scanf function", "body": "<p>Quick fix to your problem: <code>scanf(\"%d \\n\",&amp;a[i])</code> -> <code>scanf(\"%d\",&amp;a[i])</code></p>\n\n<p>Also, remember to always check <code>scanf</code> for errors. It can be done like this: </p>\n\n<pre><code>if(scanf(\"%d\", &amp;a[i]) &lt; 0) {\n    // Print error message and/or exit or whatever you want to do\n} else {\n    // Do something else\n}\n</code></pre>\n\n<p>In the long run:</p>\n\n<p>Take some time studying input methods in C. They are a bit tricky and there are millions of pitfalls. In short, <code>scanf</code> is a good choice <em>provided</em> that the input is in the exact format that you expect. This makes it a bad choice for user input, because users are quite unpredictable.</p>\n\n<p>Here is a link worth reading:</p>\n\n<p><a href=\"http://www.giannistsakiris.com/2008/02/07/scanf-and-why-you-should-avoid-using-it/\" rel=\"nofollow noreferrer\">http://www.giannistsakiris.com/2008/02/07/scanf-and-why-you-should-avoid-using-it/</a></p>\n"}, {"tags": [], "owner": {"reputation": 396, "user_id": 8454073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcaBH.jpg?s=128&g=1", "display_name": "Ankita Mehta", "link": "https://stackoverflow.com/users/8454073/ankita-mehta"}, "is_accepted": false, "score": 0, "last_activity_date": 1531284309, "creation_date": 1531284309, "answer_id": 51277425, "question_id": 51277253, "link": "https://stackoverflow.com/questions/51277253/what-is-the-proper-way-of-running-for-loop-with-scanf-function/51277425#51277425", "title": "what is the proper way of running for loop with scanf function", "body": "<p>you can use like below:</p>\n\n<pre><code>for(i=0;i&lt;5;i++)\n{\n   printf(\"enter the %d position on : \",i+1);\n   scanf(\"%d\",&amp;a[i]);\n   printf(\"\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 7654857, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6f9f64151ccdbbb68939881934ec1d95?s=128&d=identicon&r=PG&f=1", "display_name": "sikka karma", "link": "https://stackoverflow.com/users/7654857/sikka-karma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "closed_date": 1531285265, "accepted_answer_id": 51277315, "answer_count": 3, "score": 0, "last_activity_date": 1531284478, "creation_date": 1531283180, "last_edit_date": 1531284444, "question_id": 51277253, "link": "https://stackoverflow.com/questions/51277253/what-is-the-proper-way-of-running-for-loop-with-scanf-function", "closed_reason": "Duplicate", "title": "what is the proper way of running for loop with scanf function", "body": "<p>I just started learning c. I have a code here for taking input from users and printing it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int a[5];\n    int i ;\n\n    for(i=0;i&lt;5;i++)\n    {\n         printf(\"enter the %d position no: \",i+1);\n         scanf(\"%d \\n\",&amp;a[i]);\n    }\n\n    for(i = 0;i&lt;5;i++)\n        printf(\"position %d : %d \\n\",i+1,a[i]);\n\n}\n</code></pre>\n\n<p>Here is my output console.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NNRjN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NNRjN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But the output is giving misleading result.\nat line 2 when scanf is reding it is not showing the string \"enter the %d position\" it is directly asking for value.</p>\n"}, {"tags": ["c", "microbenchmark", "puts"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user177800"}, "edited": false, "score": 0, "creation_date": 1531280665, "post_id": 51276908, "comment_id": 89531442, "body": "<i>seems more efficient than ...</i> what profiling have you done that shows a significant difference in the two that is unacceptable and why? Especially since the disk I/O, even with buffering, is orders and orders of magnitude longer than cpu cycles?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531284547, "post_id": 51276908, "comment_id": 89532388, "body": "Both those function calls (<code>fputs(fileptr, string);</code> and <code>fputc(fileptr, &#39;\\n&#39;);</code>) are wrong.  The file stream parameter comes last, except for <code>fprintf()</code> and <code>fscanf()</code> and their variants.  The function calls should be <code>fputs(string, fileptr);</code> and <code>fputc(&#39;\\n&#39;, fileptr);</code>, therefore."}], "answers": [{"comments": [{"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "edited": false, "score": 0, "creation_date": 1531280727, "post_id": 51276932, "comment_id": 89531456, "body": "Is that better than fprintf(fileptr, &quot;%s\\n&quot;, string);?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "edited": false, "score": 0, "creation_date": 1531281150, "post_id": 51276932, "comment_id": 89531549, "body": "You are way way down in the weeds here @Billy. A good compiler will likely optimize both to be identical. This is implementation defined, but should be close among compilers. The point being made about buffering is that the I/O operations read and write from a <code>BUFSIZ</code> buffer (see: C-library source <code>IO_BUFSIZ</code> (generally 8192 on Linux and 512 on windoze). So from an I/O standpoint it will be a basic wash. The ideological difference is that <code>fprintf</code> is a <i>variadic</i> function that generally has additional overhead compared to a function with fixed parameters - but optimization handles most."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531281567, "post_id": 51276932, "comment_id": 89531646, "body": "There is the link I was looking for, it&#39;s now under <a href=\"https://github.com/lattera/glibc/blob/master/sysdeps/gnu/_G_config.h\" rel=\"nofollow noreferrer\">_G_BUFSIZ in Gnu libc (_G_config.h)</a> (with <code>_IO_BUFSIZ</code> defined as <code>_G_BUFSIZ</code> and <code>BUFSIZ</code> defined as <code>_IO_BUFSIZ</code> in separate header files)"}, {"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531281766, "post_id": 51276932, "comment_id": 89531706, "body": "@DavidC.Rankin Thanks for the writeup. You seem to be write, I ran <code>strings</code> on my program after compiling with <code>fprintf(fileptr, &quot;%s\\n&quot;, string);</code>, and I didn&#39;t see any occurences of <code>%s</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531282016, "post_id": 51276932, "comment_id": 89531791, "body": "Easier just to dump to assembly and look at it that way. <code>gcc -S -O2 -masm=intel -o yourfile.asm yourfile.c</code> to dump <code>yourfile.c</code> to <code>yourfile.asm</code> (using intel syntax which I find easier than ATT -- up to you). You will likely find your actual output reduced to a system call to <code>write</code>. (you can play with the optimization levels <code>-O0, -O1, -O2, -O3, -Ofast</code> and see how optimizations effect the code generation. (and being <i>way way down in the weed</i> isn&#39;t bad, but you generally end up either profiling, dumping assembly, or at the C-Standard or library source-code to get a final answer)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1531284916, "post_id": 51276932, "comment_id": 89532501, "body": "If you need to group together operations on a single file stream, a POSIX application can use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/flockfile.html\" rel=\"nofollow noreferrer\"><code>flockfile()</code></a> and <code>funlockfile()</code> and <code>ftrylockfile()</code>.  They&#39;re designed to be used so that <code>flockfile(fp); fprintf(fp, &quot;\u2026&quot;, \u2026); fprintf(fp, &quot;\u2026&quot;, \u2026); funlockfile(fp);</code> keeps the output from the two <code>fprintf()</code> operations consecutive without a chance for another thread to interpose its output."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 8, "last_activity_date": 1531284611, "last_edit_date": 1531284611, "creation_date": 1531280684, "answer_id": 51276932, "question_id": 51276908, "link": "https://stackoverflow.com/questions/51276908/fputs-with-newline-like-puts-in-c/51276932#51276932", "title": "fputs() with newline like puts() in C", "body": "<blockquote>\n  <p>I was wondering if there was a way to do that with one disk write.</p>\n</blockquote>\n\n<p>You're over-optimizing things. The writing to disk <em>is</em> buffered, <em>unless</em> you happened to mess with the buffering settings or you're using a really bad libc implementation. In general, the best way to achieve what you want is</p>\n\n<pre><code>fputs(string, fileptr);\nfputc('\\n', fileptr);\n</code></pre>\n\n<p>hands down. If you <em>wouldn't</em> care about optimization, <em>or</em> you believe your compiler would optimize it, you can use </p>\n\n<pre><code>fprintf(fileptr, \"%s\\n\", string);\n</code></pre>\n\n<p>it would need to parse the format string - and even then, internally, use the equivalent of <code>fputs</code> to write the <code>%s</code> and <code>fputc</code> to print the newline.</p>\n\n<hr>\n\n<p>However there is one gotcha - be aware that the <code>FILE</code> structure usually has some kind of locking for thread safety. <code>fputs</code> + <code>fputc</code> would require acquiring the lock twice, whereas <code>fprintf</code> would probably do it just once. In a single-threaded application the lock wouldn't be contested, however. But it might just be that for a complicated format and multithreaded program, the <code>fprintf</code> parsing is faster than acquiring the locks for separate operations. Another is that a call from another thread can interleave the <code>fputs</code>/<code>fputc</code>, but <code>fprintf</code> is supposed to be atomic.</p>\n\n<hr>\n\n<p>P.S. the <code>puts</code> code of Glibc is in <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=libio/ioputs.c;h=c9967c3883b303979c9a184a1e928345d6dcf3c5;hb=HEAD\" rel=\"nofollow noreferrer\"><code>libio/ioputs.c</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1584279531, "last_edit_date": 1584279531, "creation_date": 1531288601, "answer_id": 51278154, "question_id": 51276908, "link": "https://stackoverflow.com/questions/51276908/fputs-with-newline-like-puts-in-c/51278154#51278154", "title": "fputs() with newline like puts() in C", "body": "<p>Nothing will be more effective than :</p>\n\n<ol>\n<li>Make sure that your string can accommodate one char more</li>\n<li>Assign <code>\\n</code> to the string </li>\n<li><code>fputs</code> the string</li>\n</ol>\n"}], "owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1768, "favorite_count": 0, "accepted_answer_id": 51276932, "answer_count": 2, "score": 2, "last_activity_date": 1584279531, "creation_date": 1531280499, "last_edit_date": 1532239672, "question_id": 51276908, "link": "https://stackoverflow.com/questions/51276908/fputs-with-newline-like-puts-in-c", "title": "fputs() with newline like puts() in C", "body": "<p>In C, <code>puts(string);</code> will print <code>string</code> to stdout, followed by a newline. <code>fputs(fileptr, string);</code>, on the other hand, will write <code>string</code> to <code>fileptr</code> without the trailing newline. Is there any function like <code>fputs()</code> that appends a newline, or should I stick with <code>fprintf(fileptr, \"%s\\n\", string);</code> like I've been using?</p>\n\n<p><code>fputs()</code> seems more efficient than <code>fprintf()</code> to me as it doesn't parse it's input. I know I could also use</p>\n\n<pre><code>fputs(string, fileptr);\nfputc('\\n', fileptr);\n</code></pre>\n\n<p>but I was wondering if there was a way to do that with one disk write.</p>\n\n<p>I tried to figure out how <code>puts()</code> appends the newline (since <code>printf()</code> is really just a wrapper for <code>vfprintf(stdout, ...)</code>, I thought the same might hold true for <code>puts()</code> and <code>fputs()</code>), but I oddly cannot find <code>puts()</code> in the glibc source.</p>\n"}, {"tags": ["c++", "c", "directx", "directx-9"], "comments": [{"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 2, "creation_date": 1532800497, "post_id": 51276586, "comment_id": 90113579, "body": "The general answer to all questions of the form &quot;How do I do X with Direct3D 9?&quot; is: <i>Don&#39;t use Direct3D 9, use Direct3D 11 instead</i>. It&#39;s legacy and there&#39;s basically no reason to use it at all. See <a href=\"https://docs.microsoft.com/en-us/windows/desktop/directx-sdk--august-2009-\" rel=\"nofollow noreferrer\">MSDN</a> and <a href=\"https://blogs.msdn.microsoft.com/chuckw/2015/08/05/where-is-the-directx-sdk-2015-edition/\" rel=\"nofollow noreferrer\">this blog post</a>"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8662729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20c3382df268c681a03e0da2054d3dd?s=128&d=identicon&r=PG&f=1", "display_name": "cYeR", "link": "https://stackoverflow.com/users/8662729/cyer"}, "edited": false, "score": 0, "creation_date": 1531632429, "post_id": 51340898, "comment_id": 89664157, "body": "Your example helped me a lot, but I&#39;m having a problem, I&#39;m using ID3DXSprite to draw the texture, the text is drawing, but with a black box, why is this happening? Am I doing it wrong?  Code(sorry for posting link, the code is too big to post in the comments):  <code>paste.ofcode.org&#47;bZ7dwEwqHGdj8KG2xLMSGK</code>"}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "reply_to_user": {"reputation": 115, "user_id": 8662729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20c3382df268c681a03e0da2054d3dd?s=128&d=identicon&r=PG&f=1", "display_name": "cYeR", "link": "https://stackoverflow.com/users/8662729/cyer"}, "edited": false, "score": 0, "creation_date": 1531656058, "post_id": 51340898, "comment_id": 89668913, "body": "You didn&#39;t provide full code, I don&#39;t know who calls print_text or how the sprite was created. I&#39;m no directx expert but I can take a look if you provide all the code."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1532800598, "post_id": 51340898, "comment_id": 90113605, "body": "D3DX9, D3DX10, and D3DX11 are all deprecated. You should move to using DirectX 11 instead, in which case you can use the <code>SpriteFont</code> class in the <a href=\"https://github.com/Microsoft/DirectXTK/wiki/Getting-Started\" rel=\"nofollow noreferrer\">DirectX Tool Kit</a> which is open source. See <a href=\"https://blogs.msdn.microsoft.com/chuckw/2013/08/20/living-without-d3dx/\" rel=\"nofollow noreferrer\">Living without D3DX</a>. Note that if very high-quality and scalable text is important to you, then you should consider using Direct3D 11 with <a href=\"https://docs.microsoft.com/en-us/windows/desktop/DirectWrite/direct-write-portal\" rel=\"nofollow noreferrer\">DirectWrite</a>."}], "tags": [], "owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "is_accepted": true, "score": 5, "last_activity_date": 1531582564, "creation_date": 1531582564, "answer_id": 51340898, "question_id": 51276586, "link": "https://stackoverflow.com/questions/51276586/how-to-render-text-in-directx9-with-stb-truetype/51340898#51340898", "title": "How to render text in directx9 with stb_truetype?", "body": "<p>One way to do this would be to create a D3D9 texture and then load the rendered text bitmap into it. You can then use the generated texture like any other texture.</p>\n\n<pre><code>#define STB_TRUETYPE_IMPLEMENTATION \n#include \"stb_truetype.h\"\nIDirect3DTexture9 *LoadTextureFromText(const char *text)\n{\n    IDirect3DTexture9 *d3dTexture = 0;\n\n    /* load font file */\n    long size;\n    unsigned char* fontBuffer;\n\n    FILE* fontFile = fopen(\"C:\\\\path\\\\to\\\\font.ttf\", \"rb\");\n    fseek(fontFile, 0, SEEK_END);\n    size = ftell(fontFile); /* how long is the file ? */\n    fseek(fontFile, 0, SEEK_SET); /* reset */\n\n    fontBuffer = (unsigned char*)malloc(size);\n\n    fread(fontBuffer, size, 1, fontFile);\n    fclose(fontFile);\n\n    /* prepare font */\n    stbtt_fontinfo info;\n    if (!stbtt_InitFont(&amp;info, fontBuffer, 0))\n    {\n        printf(\"failed\\n\");\n    }\n\n    int b_w = 512; /* bitmap width */\n    int b_h = 128; /* bitmap height */\n    int l_h = 64; /* line height */\n\n    /* create a bitmap for the phrase */\n    unsigned char* bitmap = (unsigned char*)calloc(b_w * b_h, sizeof(unsigned char));\n\n    /* calculate font scaling */\n    float scale = stbtt_ScaleForPixelHeight(&amp;info, l_h);\n\n    int x = 0;\n\n    int ascent, descent, lineGap;\n    stbtt_GetFontVMetrics(&amp;info, &amp;ascent, &amp;descent, &amp;lineGap);\n\n    ascent *= scale;\n    descent *= scale;\n\n    int i;\n    for (i = 0; i &lt; strlen(text); ++i)\n    {\n        /* get bounding box for character (may be offset to account for chars that dip above or below the line */\n        int c_x1, c_y1, c_x2, c_y2;\n        stbtt_GetCodepointBitmapBox(&amp;info, text[i], scale, scale, &amp;c_x1, &amp;c_y1, &amp;c_x2, &amp;c_y2);\n\n        /* compute y (different characters have different heights */\n        int y = ascent + c_y1;\n\n        /* render character (stride and offset is important here) */\n        int byteOffset = x + (y  * b_w);\n        stbtt_MakeCodepointBitmap(&amp;info, bitmap + byteOffset, c_x2 - c_x1, c_y2 - c_y1, b_w, scale, scale, text[i]);\n\n        /* how wide is this character */\n        int ax;\n        stbtt_GetCodepointHMetrics(&amp;info, text[i], &amp;ax, 0);\n        x += ax * scale;\n\n        /* add kerning */\n        int kern;\n        kern = stbtt_GetCodepointKernAdvance(&amp;info, text[i], text[i + 1]);\n        x += kern * scale;\n    }\n\n    //Create a D3D9 texture and load the generated image. The text bitmap is 1 channel.\n    D3DXCreateTexture(direct3DDevice, b_w, b_h, 1, D3DUSAGE_DYNAMIC, D3DFMT_L8, D3DPOOL_DEFAULT, (LPDIRECT3DTEXTURE9*)&amp;d3dTexture);\n    D3DLOCKED_RECT rect;\n    d3dTexture-&gt;LockRect(0, &amp;rect, NULL, 0);\n    memcpy(rect.pBits, bitmap, b_w * b_h);\n    d3dTexture-&gt;UnlockRect(0);\n\n    free(fontBuffer);\n    free(bitmap);\n\n    return d3dTexture;\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8662729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20c3382df268c681a03e0da2054d3dd?s=128&d=identicon&r=PG&f=1", "display_name": "cYeR", "link": "https://stackoverflow.com/users/8662729/cyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1936, "favorite_count": 0, "accepted_answer_id": 51340898, "answer_count": 1, "score": 10, "last_activity_date": 1531582564, "creation_date": 1531277741, "question_id": 51276586, "link": "https://stackoverflow.com/questions/51276586/how-to-render-text-in-directx9-with-stb-truetype", "title": "How to render text in directx9 with stb_truetype?", "body": "<p>How to render a text with the stb_truetype library using D3D9 in C/C++? I looked in various forums/sites and in the library's documentation for some example in d3d9 and I didn't find any example.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1531277710, "post_id": 51276547, "comment_id": 89530921, "body": "You&#39;re writing to memory you didn&#39;t allocate all over the place (starting with your first <code>strcat()</code>, and continuing every other line afterward until just before the last <code>printf()</code>), which leads to all kinds of strange behavior. It might be beneficial for you to find a C tutorial."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9207084"}, "edited": false, "score": 0, "creation_date": 1531277911, "post_id": 51276584, "comment_id": 89530960, "body": "Thank you! I changed char fmName[] = {}; to  fmName[50]; and it seemed to solve my problem!"}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 1, "last_activity_date": 1531277733, "creation_date": 1531277733, "answer_id": 51276584, "question_id": 51276547, "link": "https://stackoverflow.com/questions/51276547/why-does-this-c-code-change-my-variable-lastname-to-another-value-without-tellin/51276584#51276584", "title": "Why does this C code change my variable lastName to another value without telling it to?", "body": "<pre><code>char firstName[] = \"Bill\";\n</code></pre>\n\n<p>This is making an array containing five elements: <code>B</code>, <code>i</code>, <code>l</code>, <code>l</code>, and <code>\\0</code>.</p>\n\n<pre><code>strcat(firstName, middleName);\n</code></pre>\n\n<p>This is taking and overwriting the null at the end, then overflowing. You're writing to memory out of the bounds of <code>firstName</code>. This is <a href=\"https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior\">undefined behavior</a>, which means anything could happen. In practice, the latter local variables are likely being overwritten, which explains the symptoms you're seeing. But the point is you've hit UB, which means anything could happen.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9207084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1531277842, "accepted_answer_id": 51276584, "answer_count": 1, "score": 0, "last_activity_date": 1531277756, "creation_date": 1531277462, "last_edit_date": 1531277664, "question_id": 51276547, "link": "https://stackoverflow.com/questions/51276547/why-does-this-c-code-change-my-variable-lastname-to-another-value-without-tellin", "closed_reason": "Duplicate", "title": "Why does this C code change my variable lastName to another value without telling it to?", "body": "<p>When I compile this code, the lastName variable is changed the third time I ask it to print it before telling it to change. What is causing this to happen? </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\n int main(void)\n {\n\n    char firstName[] = \"Bill\";\n\n    char middleName[] = \"Bryan\";\n\n    char lastName[] = \"Max\";\n\n    char fmName[] = {};\n\n    char fmlName[] = {};\n\n    printf(\"%s\\n\", lastName);\n\n    strcat(firstName, middleName);\n\n    printf(\"%s\\n\", lastName);\n\n    strcpy(fmName, firstName);\n\n    printf(\"%s\\n\", lastName);\n\n    strcat(fmName, lastName);\n\n    printf(\"%s\\n\", fmName);\n\n    return 0;\n\n }\n</code></pre>\n\n<p><strong>OUTPUT</strong></p>\n\n<pre><code>&gt;&gt;&gt; Max\n&gt;&gt;&gt; Max\n&gt;&gt;&gt; BillBryan // &lt;- Why is it printing that lastName is this value when I did not change it?\n</code></pre>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 3, "creation_date": 1531277074, "post_id": 51276475, "comment_id": 89530804, "body": "The &quot;array&quot; you&#39;re creating is a literal string stored in static memory.  Any attempt to modify it will crash.  (s1 is just pointing into your app&#39;s static memory, which is fine)"}, {"owner": {"reputation": 2176, "user_id": 5402401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dPV49.jpg?s=128&g=1", "display_name": "0.sh", "link": "https://stackoverflow.com/users/5402401/0-sh"}, "reply_to_user": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1531277158, "post_id": 51276475, "comment_id": 89530820, "body": "@Tibrogargan can we also static field is a string literal pool"}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1531277319, "post_id": 51276475, "comment_id": 89530848, "body": "<a href=\"/a/2036125/2487517\">This</a> may help."}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "reply_to_user": {"reputation": 2176, "user_id": 5402401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dPV49.jpg?s=128&g=1", "display_name": "0.sh", "link": "https://stackoverflow.com/users/5402401/0-sh"}, "edited": false, "score": 0, "creation_date": 1531277395, "post_id": 51276475, "comment_id": 89530866, "body": "@0.sh parse error before &#39;is&#39;"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531281884, "post_id": 51276475, "comment_id": 89531750, "body": "<code>s1 = (char[]){&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;\\0&#39;};</code> (equivalent to <code>s1 = (char[]){ &quot;abcd&quot; };</code> is a <i>compound-literal</i> (it is a cast of the <i>string-literal</i> <code>&quot;abcd&quot;</code> to an array of characters which is <b>modifiable</b>). <code>s1 = &quot;abcd&quot;;</code> initializes <code>s1</code> to point to a <i>string-literal</i> created in <b>read-only</b> memory -- it cannot be modified -- and usually results in a <code>SEGFAULT</code> if you try."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531282076, "post_id": 51276475, "comment_id": 89531807, "body": "Example D has a buffer overflow, the <code>strcpy</code> function also copies null terminator"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1531282503, "post_id": 51276475, "comment_id": 89531904, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string-initialized-with-cha\">Why do I get a segmentation fault when writing to a string initialized with &quot;char *s&quot; but not &quot;char s&#91;&#93;&quot;?</a> <a href=\"https://stackoverflow.com/a/3131362/7076153\">How to correctly assign a new string value?</a> <a href=\"https://stackoverflow.com/questions/1704407/what-is-the-difference-between-char-s-and-char-s\">What is the difference between char s&#91;&#93; and char *s?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1531285713, "post_id": 51277352, "comment_id": 89532753, "body": "&quot;A string-literal is created in read-only memory&quot;, it&#39;s implemented behavior."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1531285868, "post_id": 51277352, "comment_id": 89532807, "body": "That is a good point -- though I have not run across an implementation that does not create string literals in read-only memory, I&#39;m sure they exists, but that also makes about 1000 other answers here on SO subject to that same addition and qualification. Updated."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1531286139, "last_edit_date": 1531286139, "creation_date": 1531283886, "answer_id": 51277352, "question_id": 51276475, "link": "https://stackoverflow.com/questions/51276475/get-and-set-values-of-a-char-array-via-pointer-arithmetic-in-c/51277352#51277352", "title": "get and set values of a char array via pointer arithmetic in c", "body": "<p>Let's look at your examples and make sure you know why what is happening is happening. But first, a quick review of pointers to make sure we are on the same page:</p>\n\n<p><strong>A Pointer &amp; Pointer Arithmetic</strong></p>\n\n<p>A pointer is simply a normal variable that holds the <em>address of</em> something else as its value. In other words, a pointer <em>points to</em> the address where something else can be found. Where you normally think of a variable holding an immediate values, such as <code>int a = 5;</code>, a pointer would simply hold the address where <code>5</code> is stored in memory, e.g. <code>int *b = &amp;a;</code>. It works the same way regardless what type of object the pointer points to. It is able to work that way because the <code>type</code> of the pointer controls the pointer arithmetic, e.g. with a <code>char *</code> pointer, <code>pointer+1</code> point to the next byte, for an <code>int *</code> pointer (normal 4-byte integer), <code>pointer+1</code> will point to an offset 4-bytes after <code>pointer</code>. (so a pointer, is just a pointer.... where arithmetic is automatically handled by the <code>type</code>)</p>\n\n<p><strong>What am I doing in Example A?</strong></p>\n\n<p>Your initialization is key to why Example A works and why Example B crashes. Example A uses a <em>compound literal</em> to initialize <code>s1</code> so <code>s1</code> points to the first character <code>'a'</code> in <code>\"abcd\"</code> in <strong>modifiable</strong> memory. The <em>compound-literal</em> was introduced in C99, but gcc provides the <em>compound-literal</em> as an extension to C89 as well. In Example A you use:</p>\n\n<pre><code>s1 = (char[]){'a','b','c','d','\\0'};\n</code></pre>\n\n<p>which is equivalent to </p>\n\n<pre><code>s1 = (char[]){ \"abcd\" };\n</code></pre>\n\n<p>The <em>compound literal</em> is <code>(type){ ..initializer.. }</code>, the key part being the <code>(type)</code> which works as a cast of the initializer value to that type. In your example A <code>\"abcd\"</code> is cast to <code>char[]</code> (a character array) which you can freely modify.</p>\n\n<p><strong>Why does Example B Crash?</strong></p>\n\n<p>On the other hand:</p>\n\n<pre><code>s1 = \"abcd\";\n</code></pre>\n\n<p>initializes <code>s1</code> to a <em>string-literal</em>. A <em>string-literal</em> is created in <strong>read-only</strong> memory by most Operating Systems (generally in the <code>.rodata</code> section of the executable). See: <a href=\"https://softwareengineering.stackexchange.com/questions/294748/why-are-c-string-literals-read-only\">Why are C string literals read-only?</a> for a historical view. You cannot modify values in <strong>read-only</strong> memory and attempting to do so generally results in a <code>SEGFAULT</code> (as you have probably found).</p>\n\n<p><strong>You were right in your comment on Example D!</strong></p>\n\n<pre><code>char s1[4];\n</code></pre>\n\n<p>Creates a character array with space for 4-characters (ASCII). When you call <code>strcpy (s1, \"abcd\");</code> you are attempting to copy 1-more character than will fit:</p>\n\n<pre><code>'a','b','c','d','\\0'\n 1   2   3   4   5\n</code></pre>\n\n<p>This results in <em>Undefined Behavior</em> and can result in exploitable buffer-overflow. From <code>man 3 strcpy</code>,</p>\n\n<blockquote>\n  <p>If the destination string of a strcpy() is not large enough, then\n  anything \n      might happen. Overflowing fixed-length string buffers is a favorite cracker \n      technique for taking complete control of the machine. Any time a program \n      reads or copies data into a buffer, the program first needs to check that \n      there's enough space. This may be unnecessary if you can show that overflow \n      is impossible, but be careful: programs can get changed over time, in ways \n      that may make the impossible possible.</p>\n</blockquote>\n\n<p>So just as you allocated <code>(4+1)</code> chars/bytes in Example C, you need at least <code>(4+1)</code> chars/bytes of storage in <code>s1</code> in Example D. </p>\n\n<p><em>Remember</em>, every C-library <code>str...</code> function requires a <em>nul-terminated</em> string. When you create a character-array, it is your responsibility to insure that it is <em>nul-terminated</em> to make it a string in C. If it's not <em>nul-terminated</em>, then it is simply an array of characters -- and any time you fail to pass a <em>nul-terminated</em> string to a function expecting one, the function will not know when to stop reading and will happily stray off reading out-of-bounds until it happens to stumble upon a zero-byte, or SEGFAULTS, whichever occurs first.</p>\n\n<p>Look things over and digest them and let me know if you have further questions. (and add a <code>'\\n'</code> to your <code>printf</code> format string (e.g. <code>\"%s\\n\"</code>) so that a newline is output -- at the very least on your last call to make your program POSIX compliant)</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1531290051, "creation_date": 1531290051, "answer_id": 51278485, "question_id": 51276475, "link": "https://stackoverflow.com/questions/51276475/get-and-set-values-of-a-char-array-via-pointer-arithmetic-in-c/51278485#51278485", "title": "get and set values of a char array via pointer arithmetic in c", "body": "<p>The first example creates the char array in the read/write memory which you can modify. \nThe second one the pointer to the read only char array. When you try to modify the read only memory location, you get the error. </p>\n\n<p>You can also create the array in the read/write memory by \n        char x[] =\"1234\";</p>\n"}], "owner": {"reputation": 29, "user_id": 4944114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82af48c8a0e758fe9d48cdf6b582cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Nat S", "link": "https://stackoverflow.com/users/4944114/nat-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531290051, "creation_date": 1531276912, "last_edit_date": 1531281558, "question_id": 51276475, "link": "https://stackoverflow.com/questions/51276475/get-and-set-values-of-a-char-array-via-pointer-arithmetic-in-c", "title": "get and set values of a char array via pointer arithmetic in c", "body": "<p>I am missing something regarding pointers and strings in c.  I am trying to simply get and set an element of a character array in c that was created via a pointer.  I can easily get each character via pointer arithmetic, but I can not set any of the elements via pointer arithmetic.  Please see the example.  What am I missing here?  Isn't s1 in both examples the same?  I am using mingw(gcc) on win10.</p>\n\n<p><strong>Example A) This works, s1 is printed as \"abxd\"</strong></p>\n\n<pre><code>char *s1;\ns1 = (char[]){'a','b','c','d','\\0'};\n*(s1+2)='x';\nprintf(\"%s\",s1);\n</code></pre>\n\n<p><strong>Example B) This does not work, it just crashes.</strong></p>\n\n<pre><code>char *s1;\ns1 = \"abcd\";\n*(s1+2)='x';    //this is the problem, can get but can not set\nprintf(\"%s\",s1);\n</code></pre>\n\n<p>Edit: based on the comments received regarding example B using static memory and being impossible to edit.  So basically this means that I have to use malloc(heap memory, eg. C) or defining the array on stack memory (eg. D) if I want to edit the string, correct?.</p>\n\n<p><strong>Example C) - works</strong></p>\n\n<pre><code>char *s1;\ns1 = (char*)malloc((4+1)*sizeof(char));\ns1 = strcpy(s1,\"abcd\");\n*(s1+2)='x';  //or s1[2] = 'x'\nprintf(\"%s\",s1);\n</code></pre>\n\n<p><strong>Example D) - works</strong></p>\n\n<pre><code>char s1[4];  // would have thought need to be min of s1[5]\ns1 = strcpy(s1,\"abcd\");\n*(s1+2)='x';   // or s1[2]='x';\nprintf(\"%s\",s1);\n</code></pre>\n"}, {"tags": ["c", "audio", "aubio"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531279891, "post_id": 51276464, "comment_id": 89531304, "body": "First result from <a href=\"https://www.dsprelated.com/freebooks/sasp/Choice_Hop_Size.html\" rel=\"nofollow noreferrer\">Google search</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531280230, "post_id": 51276464, "comment_id": 89531359, "body": "I.e. <code>hop_size</code> tells how many samples it can jump forward after one frame of FFT analysis. 1 is the best, any larger is a trade-off between quality and speed."}], "answers": [{"tags": [], "owner": {"reputation": 532, "user_id": 8876321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a230ce2c3ac7b3ab4cfd15e2211f32ce?s=128&d=identicon&r=PG&f=1", "display_name": "fdcpp", "link": "https://stackoverflow.com/users/8876321/fdcpp"}, "is_accepted": true, "score": 2, "last_activity_date": 1531355690, "last_edit_date": 1531355690, "creation_date": 1531301710, "answer_id": 51282039, "question_id": 51276464, "link": "https://stackoverflow.com/questions/51276464/hop-size-meaning-in-aubio/51282039#51282039", "title": "Hop_Size meaning in aubio", "body": "<p>Hop Size should refer to the number of samples in between successive frames. For signal analysis, Hop Size should be less than the frame size, so that frames overlap.</p>\n\n<p>In this diagram the Hop Size would be 'Q' and 'K' is the frame size for a signal 's(n)'</p>\n\n<p><a href=\"https://i.stack.imgur.com/Jg5EG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jg5EG.png\" alt=\"enter image description here\"></a></p>\n\n<p>If your follow up question is 'why would you do that?', then there is a good answer to be found at this topic here:</p>\n\n<p><a href=\"https://dsp.stackexchange.com/questions/36509/why-is-each-window-frame-overlapping\">https://dsp.stackexchange.com/questions/36509/why-is-each-window-frame-overlapping</a></p>\n"}], "owner": {"reputation": 95, "user_id": 9680370, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sher222", "link": "https://stackoverflow.com/users/9680370/sher222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2265, "favorite_count": 1, "accepted_answer_id": 51282039, "answer_count": 1, "score": 3, "last_activity_date": 1531355690, "creation_date": 1531276851, "question_id": 51276464, "link": "https://stackoverflow.com/questions/51276464/hop-size-meaning-in-aubio", "title": "Hop_Size meaning in aubio", "body": "<p>I'm trying to use the aubio(<a href=\"https://aubio.org\" rel=\"nofollow noreferrer\">https://aubio.org</a>) library for pitch detection. I'm trying to use the API for C and one of the parameters of the <code>new_aubio_pitch</code> function is <code>hop_size</code>. What does <code>hop_size</code> mean and how do you choose one?</p>\n"}, {"tags": ["c", "windows", "winapi", "64-bit"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1531277094, "post_id": 51276399, "comment_id": 89530808, "body": "Nope, the start address is always the same since Vista: RtlUserThreadStart().  You&#39;ll need a stack walk to find out where it jumped to."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1531291513, "post_id": 51276399, "comment_id": 89535142, "body": "<i>start address is always the same</i> - this is start address. when exist separate <code>ThreadQuerySetWin32StartAddress</code> infoclass, which return actual win32 start address (passed for <code>CreateThread</code> )"}, {"owner": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "edited": false, "score": 1, "creation_date": 1531318759, "post_id": 51276399, "comment_id": 89553372, "body": "NtQueryInformationThread isn&#39;t really an undocumented routine for user-mode, but Microsoft do advise to rely on the Win32 APIs for retrieving thread information in user-mode. However, the ThreadQuerySetWin32StartAddress has been around for so long, I really doubt you will encounter an issue with it... any-time soon. If one day it breaks because of internal changes to Windows, chances are Microsoft will introduce a public way to retrieve the information, because I am sure you&#39;re not the only person who has needed this functionality before."}], "answers": [{"comments": [{"owner": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "edited": false, "score": 1, "creation_date": 1531319149, "post_id": 51276604, "comment_id": 89553659, "body": "You could also hook NtCreateThread/NtCreateThreadEx, which would let you track the start address with a thread handle/other provided data as well. And then of course, catch thread termination to clear the tracking for the watched thread."}], "tags": [], "owner": {"reputation": 142, "user_id": 4789099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b065f2458addd0ca5e1e231894f0db7d?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4789099/jason"}, "is_accepted": true, "score": 1, "last_activity_date": 1531277858, "creation_date": 1531277858, "answer_id": 51276604, "question_id": 51276399, "link": "https://stackoverflow.com/questions/51276399/get-start-address-of-current-thread/51276604#51276604", "title": "Get start address of current thread", "body": "<p>Unfortunately NtQueryInformationThread is the only way to obtain that information when you pass ThreadQuerySetWin32StartAddress as an argument. The reason for this is that the Win32StartAddress is contained in the kernel data structure that represents the thread object (ETHREAD). NtQueryInformationThread requests that information from the structure and outputs it.</p>\n\n<p>You can monitor the creation of future threads though with a hook to RtlUserThreadStart. This is where the thread begins its execution and is also a callback from kernel-mode for when a thread is created in the process. The accumulator register contains the initial address of execution specified in the argument for creating a thread. For example, say there is a subroutine called \"begin\".</p>\n\n<pre><code>CreateThread(NULL, NULL, begin, NULL, NULL, NULL);\n</code></pre>\n\n<p>The EAX (accumulator) register will contain the address of \"begin\" if you hook RtlUserThreadStart. </p>\n\n<p>This is the signature for the routine you would need to hook if you do not use NtQueryInformationThread:</p>\n\n<pre><code>void RtlUserThreadStart(PTHREAD_START_ROUTINE BaseExecutionAddress, PVOID Context);\n</code></pre>\n\n<p>There is no documented way by Microsoft for obtaining this information from user-mode though.</p>\n"}], "owner": {"reputation": 71, "user_id": 9856600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c9707b8d6c48aa1e3afad2189bd471?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/9856600/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "accepted_answer_id": 51276604, "answer_count": 1, "score": 1, "last_activity_date": 1531279636, "creation_date": 1531276292, "last_edit_date": 1531279636, "question_id": 51276399, "link": "https://stackoverflow.com/questions/51276399/get-start-address-of-current-thread", "title": "Get start address of current thread", "body": "<p>I'm trying to figure out how to get the entry point of the current thread(I only need to read it). </p>\n\n<p>I tried reading RCX from <code>RtlCaptureContext</code> but this doesn't give me an address that contains the start address of the thread. </p>\n\n<p>I know there's the <code>NtQueryThreadInformation</code> function but I'd like to know if there's any better way to do it internally as I'd like to avoid using an undocumented function.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 433, "user_id": 5723554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/skVBK.jpg?s=128&g=1", "display_name": "Andre.Santarosa", "link": "https://stackoverflow.com/users/5723554/andre-santarosa"}, "edited": false, "score": 0, "creation_date": 1531271840, "post_id": 51275838, "comment_id": 89529717, "body": "Think about the process flow first, then code. Before you insert the number on the array, you need to check if its -1, and only if it&#39;s not, you should insert it. On the example you are first inserting and performing the check after."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10061951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dedmgl2kA9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r1PCog_GiMsR5b-hsX7UPQ59u_tg/mo/photo.jpg?sz=128", "display_name": "Brian Skelton", "link": "https://stackoverflow.com/users/10061951/brian-skelton"}, "is_accepted": false, "score": 0, "last_activity_date": 1531271878, "creation_date": 1531271878, "answer_id": 51275918, "question_id": 51275838, "link": "https://stackoverflow.com/questions/51275838/array-that-will-stop-asking-from-input-after-1-is-entered-do-not-print-the-1/51275918#51275918", "title": "Array that will stop asking from input after -1 is entered ( do not print the -1)", "body": "<p>never mind all that and sorry for using the wrong tag, i figured out \n         what i did wrong is was the order of the code i moved the printf statement out \n        of the for loop</p>\n\n<pre><code>    for (i = 0; i &lt; ARR; i++) {\n        if (arr[i] == -1) {\n            break;\n        }\n        printf(\"\\n %i, %i\", i, arr[i]);\n    }\n     and now its working as intended. Someday i hope to able to post more here and \n     help others right now im just a noob learning as i go.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 843, "user_id": 2322474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/zdbAs.png?s=128&g=1", "display_name": "KennyC", "link": "https://stackoverflow.com/users/2322474/kennyc"}, "is_accepted": true, "score": 0, "last_activity_date": 1531272010, "creation_date": 1531272010, "answer_id": 51275933, "question_id": 51275838, "link": "https://stackoverflow.com/questions/51275838/array-that-will-stop-asking-from-input-after-1-is-entered-do-not-print-the-1/51275933#51275933", "title": "Array that will stop asking from input after -1 is entered ( do not print the -1)", "body": "<p>Just move the <code>if</code> condition earlier so that it checks for -1 first before printing.</p>\n\n<pre><code>if (arr[i] == -1) {\n  break;\n}\nprintf(\"\\n %i, %i\", i, arr[i]);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10061951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dedmgl2kA9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r1PCog_GiMsR5b-hsX7UPQ59u_tg/mo/photo.jpg?sz=128", "display_name": "Brian Skelton", "link": "https://stackoverflow.com/users/10061951/brian-skelton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 51275933, "answer_count": 2, "score": -2, "last_activity_date": 1531272120, "creation_date": 1531271078, "last_edit_date": 1531272120, "question_id": 51275838, "link": "https://stackoverflow.com/questions/51275838/array-that-will-stop-asking-from-input-after-1-is-entered-do-not-print-the-1", "title": "Array that will stop asking from input after -1 is entered ( do not print the -1)", "body": "<p>Im working on a an Array, rather simple infact that will allow a user to enter 5 numbers and then print that array, this much i have gotten to work, however there is a second condition that can be met when the user inputs -1, which will cause the Array to print based on the numbers currently enter but should include the -1, i cannot seem to get this to occur, this is my code : currently it does everything i need but still prints that -1 any help would be much appreciated  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define ARR 5\n\nmain() {\n    int i = 0;\n    int arr[ARR];\n\n    for (i = 0; i &lt; ARR; i++)\n    {\n        printf(\" Enter a number: \");\n        scanf(\"%i\", &amp;arr[i]);\n        if (arr[i] == -1) {\n            break;\n        }\n    }\n\n    printf(\" the Numbers in the array are %i : \", i);\n\n    for (i = 0; i &lt; ARR; i++) {\n        printf(\"\\n %i, %i\", i, arr[i]);\n        if (arr[i] == -1) {\n            break;\n        }\n    }\n\n    printf(\"\\n\");\n    system(\"pause\");\n}\n</code></pre>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 5, "creation_date": 1531266424, "post_id": 51275329, "comment_id": 89528671, "body": "You are supposed to use <code>return 0;</code> in your function to set the exit code.  Odd that your compiler does not complain about it, be sure to raise the warning level."}, {"owner": {"reputation": 39, "user_id": 10061688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YU8wR5Jma1E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p7oXoBccu2n1DtS3uvNcPR_MgW-Q/mo/photo.jpg?sz=128", "display_name": "Daniel Sadeghi", "link": "https://stackoverflow.com/users/10061688/daniel-sadeghi"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1531266634, "post_id": 51275329, "comment_id": 89528716, "body": "I didnt figure that omitting it would cause what seems to be undefined behavior. Apparently most compilers add it when compiling? At least it seems to do so when using <code>int main()</code> but not <code>WinMain()</code>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 2, "creation_date": 1531266786, "post_id": 51275329, "comment_id": 89528740, "body": "return 0 is optional from main according to the standard. WinMain is obviously not covered in that and not returning a value means you end up with whatever was in that spot on the stack usually, if it doesn&#39;t crash. 0xcccc is uninitialized stack memory when using the debug heap in Windows. <a href=\"https://stackoverflow.com/questions/127386/in-visual-studio-c-what-are-the-memory-allocation-representations\" title=\"in visual studio c what are the memory allocation representations\">stackoverflow.com/questions/127386/&hellip;</a>"}, {"owner": {"reputation": 14052, "user_id": 183397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e44d2e9eaaa792ed3990b4a4a4d33c38?s=128&d=identicon&r=PG", "display_name": "clstrfsck", "link": "https://stackoverflow.com/users/183397/clstrfsck"}, "edited": false, "score": 0, "creation_date": 1531266848, "post_id": 51275329, "comment_id": 89528748, "body": "This is a quirk of the way this particular compiler&#39;s code generation works with the optimisation settings you are using.  What is likely happening here is that the new value of <code>var</code> is being calculated using the same register as is used for the return value of a function. If you increase the optimisation level sufficiently, I expect you will see this behaviour change."}, {"owner": {"reputation": 2653, "user_id": 3515931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0edddc6a265a0a22058bb2343328d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnH", "link": "https://stackoverflow.com/users/3515931/johnh"}, "edited": false, "score": 0, "creation_date": 1531274853, "post_id": 51275329, "comment_id": 89530319, "body": "Microsoft&#39;s MSDN <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633559%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">guide for WinMain</a> says:  &quot;If the function terminates before entering the message loop, it should return zero.&quot;  Those are instructions to you, the developer."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1534591004, "post_id": 51275329, "comment_id": 90766239, "body": "-858993460 = 0xCCCCCCCC which means <a href=\"https://stackoverflow.com/q/370195/995714\">you&#39;ve accessed uninitialized memory</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10061688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YU8wR5Jma1E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p7oXoBccu2n1DtS3uvNcPR_MgW-Q/mo/photo.jpg?sz=128", "display_name": "Daniel Sadeghi", "link": "https://stackoverflow.com/users/10061688/daniel-sadeghi"}, "edited": false, "score": 0, "creation_date": 1531266923, "post_id": 51275375, "comment_id": 89528761, "body": "Thanks for the help :) It&#39;s quite interesting that it won&#39;t work without it but <code>int main()</code> will"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 39, "user_id": 10061688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YU8wR5Jma1E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p7oXoBccu2n1DtS3uvNcPR_MgW-Q/mo/photo.jpg?sz=128", "display_name": "Daniel Sadeghi", "link": "https://stackoverflow.com/users/10061688/daniel-sadeghi"}, "edited": false, "score": 0, "creation_date": 1531267007, "post_id": 51275375, "comment_id": 89528777, "body": "&quot;main()&quot; is a &quot;standard C&quot; thing.  &quot;WinMain()&quot; is a &quot;Microsoft thing&quot;.  Simple as that :)  Again - I&#39;d definitely encourage you to examine the assembly language output of both, to satisfy your curiosity.  Per  msandiford&#39;s suggestion, you can also change optmization level, and see if the assembly changes.  It might :)"}, {"owner": {"reputation": 39, "user_id": 10061688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YU8wR5Jma1E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p7oXoBccu2n1DtS3uvNcPR_MgW-Q/mo/photo.jpg?sz=128", "display_name": "Daniel Sadeghi", "link": "https://stackoverflow.com/users/10061688/daniel-sadeghi"}, "edited": false, "score": 0, "creation_date": 1531267179, "post_id": 51275375, "comment_id": 89528802, "body": "Will do! Thanks"}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": false, "score": 5, "last_activity_date": 1531266630, "creation_date": 1531266630, "answer_id": 51275375, "question_id": 51275329, "link": "https://stackoverflow.com/questions/51275329/strange-return-behavior-from-winmain/51275375#51275375", "title": "Strange return behavior from WinMain", "body": "<p>The problem is that you're not explicitly returning ANYTHING.</p>\n\n<p>I guess maybe the fact that you did some arbitrary assignment (var = var + 5) happened to leave a \"valid looking\" number in the register Windows is using for your return value.</p>\n\n<p>But the fact is: without an explicit <code>return SOMEVALUE;</code>, then your program is exhibiting <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">\"undefined behavior\"</a>.</p>\n\n<p>To check this theory, I urge you to compile with \"/Fa\", and look at the assembly output :)</p>\n"}], "owner": {"reputation": 39, "user_id": 10061688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YU8wR5Jma1E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p7oXoBccu2n1DtS3uvNcPR_MgW-Q/mo/photo.jpg?sz=128", "display_name": "Daniel Sadeghi", "link": "https://stackoverflow.com/users/10061688/daniel-sadeghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "closed_date": 1531526471, "answer_count": 1, "score": 3, "last_activity_date": 1531266630, "creation_date": 1531266240, "question_id": 51275329, "link": "https://stackoverflow.com/questions/51275329/strange-return-behavior-from-winmain", "closed_reason": "Duplicate", "title": "Strange return behavior from WinMain", "body": "<p>First I should specify that I'm using the clang compiler from Visual Studio. When debugging the following simple program, the WinMain function returns the value of the variable when a peculiar condition seems to be met.</p>\n\n<pre><code>#include &lt;windows.h&gt;    \n\nint CALLBACK WinMain(\n    HINSTANCE hInstance,\n    HINSTANCE hPrevInstance,\n    LPSTR lpCmdLine,\n    int nCmdShow)\n{\n    int var = 1;\n    var = var + 5;\n}\n</code></pre>\n\n<p>The above would output in the debugger: <code>The program '[11396] Project1.exe' has exited with code 6 (0x6).</code> This behavior seems to happen without fail whenever there is a variable name in the right hand expression of the assignment. If I were to modify the last line to assign just a literal such as <code>var = 5</code>, the output would be a consistent unrelated value every time: <code>The program '[4148] Project1.exe' has exited with code -858993460 (0xcccccccc).</code></p>\n\n<p>I suspect that this behavior has to do with WinMain, because when I use plain-old main() instead, I get the expected return of 0. Any idea as to what could be the cause of this strange behavior?</p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 3, "creation_date": 1531265193, "post_id": 51275123, "comment_id": 89528445, "body": "<code>a</code> and <code>b</code> are distinct variables, so there is no relationship between <code>&amp;a</code> and <code>&amp;b</code>. The compiler knows this, so it does not need to actually do the comparison; it substitutes <code>0</code> for <code>&amp;a + 1 == &amp;b</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1531265413, "post_id": 51275123, "comment_id": 89528491, "body": "gcc intentionally doesn&#39;t follow the standard, and it has been recommended that 6.5.9p6 be changed for C20"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1531265594, "post_id": 51275123, "comment_id": 89528520, "body": "And regarding your final question, one should always assume that all requirements in all language standards are qualified with <i>&quot;if it is at all practicable for the compiler to follow this rule&quot;</i>."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1531265684, "post_id": 51275123, "comment_id": 89528535, "body": "I don&#39;t see any need for &quot;tracking&quot;. Your tests show that the compiler deliberately refuses to acknowledge the pointer equality only when the situation is obvious at compile time (i.e. localized). In all other cases it makes a honest comparison of the pointers. No &quot;tracking&quot; necessary. The compiler apparently rejects the equality because it does not want users to rely on it. The resultant behavior is &quot;weird&quot;, of course."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1531265901, "post_id": 51275123, "comment_id": 89528581, "body": "@AlexP Thanks. That&#39;s an excellent point. I believe <code>&amp;a+1</code>  makes the whole thing undefined due to <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.6p8\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.6p8</a>. However, if I to change the integers to 1-member integer arrays and do the equivalent operations, then the pointer arithmetic should no longer render the program undefined and yet the results are the same. I guess that&#39;s gcc not following the standard as M.M says."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1531266004, "post_id": 51275123, "comment_id": 89528595, "body": "What do you mean when you say that &quot;<code>&amp;a+1</code> makes the whole thing undefined&quot;? I don&#39;t see any problems with 6.5.6p8."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1531266229, "post_id": 51275123, "comment_id": 89528636, "body": "@AnT &quot;If both the pointer operand and the result point to elements of the same array object, or one past the last element of the array object, the evaluation shall not produce an overflow; otherwise, the behavior is undefined.&quot;"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 3, "creation_date": 1531266579, "post_id": 51275123, "comment_id": 89528704, "body": "@PSkocik: And? A &quot;single&quot; object acts as an &quot;array of size 1&quot; for the purposes of pointer arithmetic (see 6.5.6/7). There&#39;s nothing wrong with pointer arithmetic in <code>&amp;a + 1</code>. It produces a pointer, which points past-the-end of the conceptual &quot;array of size 1&quot; represented by <code>a</code>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1531267053, "post_id": 51275123, "comment_id": 89528782, "body": "@AlexP: The authors of the C Standard deliberately recognize the possibility of implementations that are conforming but of such poor quality as to be useless.  It is also possible to have useful compilers that process non-conforming C dialects.  What is the point of the C Standard if conforming implementations can disregard it whenever they want?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1531267208, "post_id": 51275123, "comment_id": 89528805, "body": "@AnT: GCC has a tendency to combine optimizations which would be fine if done individually, but are deadly if done together.  That combined with a lack of any guarantees about when various optimizations will or will not be performed mean that it can only be counted upon to reliably process a tiny subset of the C language, since there&#39;s no telling in what circumstances a future compiler might manage to find &quot;optimizations&quot; [ways of breaking code] that today&#39;s compilers &quot;miss&quot;."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1531267607, "post_id": 51275123, "comment_id": 89528872, "body": "@PSkocik: It is not that <code>&amp;a + 1</code> is undefined. It is very well defined. The point is that the compiler <i>knows</i> that <code>a</code> and <code>b</code> are unrelated variables, and therefore a pointer derived from <code>&amp;a</code> should never be equal to a pointer derived from <code>&amp;b</code>. This is a perfectly valid inference. It is meaningless to compare pointers derived from unrelated variables."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1531268801, "post_id": 51275123, "comment_id": 89529063, "body": "@AlexP That&#39;s Octalist is arguing in the linked question&#39;s answer, but I think that inference is wrong (see mine and AnT&#39;s comment on that answer). Equality-comparison (as opposed to relational comparison)  of unrelated objects shouldn&#39;t be UB, and 6.5.6/76 specifically allows for a pointer one past the end of an array (6.5.6/7 makes non array objects equivalent to 1-sized arrays of them) to point to an array object that &quot;happens to follow&quot; the first object. Would then equality comparison of unrelated objects be undefined except when objects &quot;happen to follow&quot; each other?"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1531270646, "post_id": 51275123, "comment_id": 89529434, "body": "@PSkocik: It <i>not</i> undefined behavior. It is well-defined behavior. Two pointers known to be derived from unrelated variables are always unequal. A pointer one past the end of the array is still a pointer in that array, and <i>in principle</i> it should never compare equal to a pointer derived from another object. In some cases it is just not practicable for the compiler to keep track of where the pointers are ultimately derived from, and in such cases the program may get the wrong result for the comparison."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1531271224, "post_id": 51275123, "comment_id": 89529571, "body": "@AlexP Glad you agree it&#39;s not UB.  But <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.9p6\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.9p6</a> says the pointers should compare equal if, among other things, the &amp;a+1 pointer points to an array object that <i>happens to follow</i> <code>&amp;a</code> in the address space (And the next point clarifies that non-arrays are considered as 1-member arrays for the purposes of these comparisons), which is the case here. So as M.M said, gcc&#39;s is doing it wrong with the inequality."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1531278814, "post_id": 51275123, "comment_id": 89531120, "body": "My approach is more &quot;fun&quot;: <a href=\"https://stackoverflow.com/q/32100245/963864\">Dereferencing a 50% out of bound pointer (array of array)</a>"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1531337739, "post_id": 51275123, "comment_id": 89563598, "body": "@AlexP: If the objects in question are declared <code>extern</code>, a quality compiler suitable for low-level programming on a platform where some languages (or linker configuration files) would allow more precise control over object placement than C does should allow for the possibility that a programmer might have reason to care about a relationship like the above.  For example, some linkers for fixed-memory targets like embedded systems can generate a symbol that points just past the highest allocated object and another that points just below top of memory.  It may be perfectly reasonable..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1531337893, "post_id": 51275123, "comment_id": 89563681, "body": "...and realistic for code to do something like <code>extern uint32_t HEAP_START[], HEAP_END[]; for (uint32_t *p = HEAP_START; p != HEAP_END; p++) *p = 0;</code>  C might not have any way to specify such placement for those objects, but a quality implementation suitable for low-level programming on a platform that does have such means should support the semantics implied thereby."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1531338467, "post_id": 51275123, "comment_id": 89563945, "body": "Unfortunately, I can&#39;t find any mode in which gcc behaves as a quality implementation suitable for low-level programming.  In <code>-O0</code> it has correct semantics, but the code quality is generally dreadful.  Even in <code>-O1</code> it can&#39;t handle things like <code>if ((uintptr_t)&amp;someExtern == 0xC000000)</code> despite the fact that it has no way of knowing whether <code>someExtern</code> might have been placed there."}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 1, "closed_date": 1531265925, "answer_count": 0, "score": 4, "last_activity_date": 1531264584, "creation_date": 1531264584, "question_id": 51275123, "link": "https://stackoverflow.com/questions/51275123/identically-valued-pointers-comparing-unequal", "closed_reason": "Duplicate", "title": "Identically-valued pointers comparing unequal", "body": "<p>I came across this post <a href=\"https://stefansf.de/post/pointers-are-more-abstract-than-you-might-expect/\" rel=\"nofollow noreferrer\">https://stefansf.de/post/pointers-are-more-abstract-than-you-might-expect/</a> which mentions </p>\n\n<blockquote>\n  <p>C11 \u00a7 6.5.9 paragraph 6 Two pointers compare equal if and only if both\n  are null pointers, both are pointers to the same object (including a\n  pointer to an object and a subobject at its beginning) or function,\n  both are pointers to one past the last element of the same array\n  object, or one is a pointer to one past the end of one array object\n  and the other is a pointer to the start of a different array object\n  that happens to immediately follow the first array object in the\n  address space.</p>\n</blockquote>\n\n<p>as rationalization for why in this program may address <code>b</code> right after <code>a</code> and yet have <code>&amp;a+1</code> compare unequal to <code>&amp;b</code> even though the printouts of the addresses are indentical</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    int a, b; int *p = &amp;b; int *q = &amp;a + 1;\n    printf(\"%p %p %d\\n\", (void *)p, (void *)q, p == q);\n}\n</code></pre>\n\n<p>This made me wonder that this cannot possibly be maintained across noninlinable function boundaries (or translation unit boundaries or DSO boundaries) so I <a href=\"https://www.jdoodle.com/embed/v0/yJY\" rel=\"nofollow noreferrer\">tried</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#pragma GCC optimize \"O2\"\nvoid addrcmp(void *a1_p, void *b_p)\n{\n    printf(\"%p %c= %p\\n\", a1_p,\"!=\"[a1_p==b_p],b_p);\n    int *a1p = a1_p;\n    int *bp = b_p;\n    a1p[-1] *= 10;\n    bp[0] *= 10;\n}\n\nint main()\n{\n#if __clang__ /*clang appears to lay the variables in reverse order*/\n    int b=1, a=2;\n#else\n    int a=1, b=2;\n#endif\n    printf(\"%p %c= %p\\n\", (void*)(&amp;a+1),\"!=\"[&amp;a+1==&amp;b],(void*)&amp;b);\n    printf(\"%d %d\\n\", a, b);\n    addrcmp(&amp;a+1,&amp;b);\n    printf(\"%d %d\\n\", a, b);\n}\n</code></pre>\n\n<p>and indeed, this is getting me </p>\n\n<pre><code>0x7ffc38b8ec5c != 0x7ffc38b8ec5c\n1 2\n0x7ffc38b8ec5c == 0x7ffc38b8ec5c\n10 20\n</code></pre>\n\n<p>with gcc (6.4), and even </p>\n\n<pre><code>0x7ffe5d0cee6c == 0x7ffe5d0cee6c\n2 1\n0x7ffe5d0cee6c == 0x7ffe5d0cee6c\n20 10\n</code></pre>\n\n<p>with clang (3.4).</p>\n\n<p>My question is, does the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.9p6\" rel=\"nofollow noreferrer\">6.5.9p6</a> rule even make sense? It seems impossible to track something like that efficiently.</p>\n"}, {"tags": ["c++", "c", "programming-languages", "low-level", "systems-programming"], "comments": [{"owner": {"reputation": 609, "user_id": 1593858, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c0099e8e5222c889539207836a6d395?s=128&d=identicon&r=PG", "display_name": "user1593858", "link": "https://stackoverflow.com/users/1593858/user1593858"}, "edited": false, "score": 4, "creation_date": 1531264161, "post_id": 51275068, "comment_id": 89528225, "body": "An extreme example would seem to be something like a python interpreter written in C. You could probably dream up some type of c interpreter but that sounds a lot like a compiler. What are you try to do?"}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1531264183, "post_id": 51275068, "comment_id": 89528232, "body": "<a href=\"https://stackoverflow.com/questions/8696653/dynamically-load-a-function-from-a-dll\">possibly useful</a>"}, {"owner": {"reputation": 11664, "user_id": 207791, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c9ffc6f77d7f8ee002acd0e9ebc872f2?s=128&d=identicon&r=PG", "display_name": "Victor Sergienko", "link": "https://stackoverflow.com/users/207791/victor-sergienko"}, "edited": false, "score": 1, "creation_date": 1531264197, "post_id": 51275068, "comment_id": 89528236, "body": "Any purely-C++ solution would be quite complicated. It&#39;s easier - but not easy - to embed another, scripting language into your program, Lua or Python or whatever. Google &quot;Lua C interface&quot; or &quot;Python C interface&quot;."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1531264210, "post_id": 51275068, "comment_id": 89528240, "body": "How would your program refer to and use the struct it read in from file? Without knowing what it contains how can you write code that uses it?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1531264225, "post_id": 51275068, "comment_id": 89528243, "body": "A database comes close to providing a dynamic data type. Interpreters could probably apply JIT compilation to achieve something close. C/C++ projects can embed interpreters. Dynamically loaded objects can be used to extend an executables functionality at runtime, but the object has to be compiled before being loaded."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1531264330, "post_id": 51275068, "comment_id": 89528261, "body": "No, this is fantasy."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1531264350, "post_id": 51275068, "comment_id": 89528267, "body": "Is it possible in any language - sure. Is it possible directly in C or C++, no."}, {"owner": {"reputation": 270, "user_id": 9518258, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "0xdd", "link": "https://stackoverflow.com/users/9518258/0xdd"}, "edited": false, "score": 0, "creation_date": 1531265149, "post_id": 51275068, "comment_id": 89528434, "body": "To echo some of the other comments -- it&#39;s strictly speaking possible but best case, the means to that end are self-defeating."}, {"owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 1, "creation_date": 1531269500, "post_id": 51275068, "comment_id": 89529210, "body": "Thanks for all your suggestions guys. By the way, regarding python/Lua/etc interpreter in C, the interpreter is the executing program and the source code(python or any) is the input file passed to it. But to my best knowledge, I guess that if we define a datatype in python(say) then that datatype&#39;s metadata is just a data structure(something like- struct PyObject{}) already defined in the python interpreter&#39;s code. Here we are not making any changes in the metadata of the interpreter program itself. I guess I would somewhat agree with @Myst&#39;s answer below."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531291361, "post_id": 51275068, "comment_id": 89535069, "body": "@i_rigia: yes, that&#39;s right.  Unless you do run-time code generation (i.e. JIT-compile some new machine code that has the new data types hard coded into it) the code that&#39;s actually running is only what you originally compiled.  Everything it does is just manipulating data."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1531532100, "post_id": 51275068, "comment_id": 89644307, "body": "Please explain what C syntax would allow your program to refer to a type name that has not been defined nor declared. If you agree that the new type will only be defined for the new code that is also loaded with it, there will be possible solutions in C."}], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531269740, "post_id": 51275443, "comment_id": 89529256, "body": "Thanks for ur suggestion. But one small query here... is it possible to link and load a .dll or .so when the program is in execution. I hope it is."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 5, "creation_date": 1531270349, "post_id": 51275443, "comment_id": 89529370, "body": "@i_rigia: It&#39;s possible to load a shared object (DLL) at runtime, but the program loading it must know about the types it will encounter to be able to use the loaded shared object.  You&#39;d have to write some system to describe the new, previously unknown type, and provide access functions to the data, and so on.  You&#39;d not be able to assign values or compare values or do anything with the values.  You couldn&#39;t even dereference the pointers meaningfully \u2014 you&#39;d have to coerce them to some other type and then play with fire.  So, in practice, the answer is &quot;No&quot;."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 1, "creation_date": 1531275932, "post_id": 51275443, "comment_id": 89530560, "body": "@i_rigia, as mentioned by Jonathan Leffler, you&#39;d be able to load the <code>dll</code> / <code>so</code>, but the original code (the program, not the loaded library) will still have no knowledge of the new type. My answer assumes the new type is either used by the new code or &quot;opaque&quot;."}, {"owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531301917, "post_id": 51275443, "comment_id": 89541564, "body": "Hmmm...So I guess its not possible as desired."}, {"owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531302343, "post_id": 51275443, "comment_id": 89541890, "body": "But what about a concept like linux modules? There we can write a whole new C code which may include new custom datatypes and still link and load it over the in-execution kernel program and still be able to execute the module on-the-go. How that works? Or maybe am I missing a point here?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531316849, "post_id": 51275443, "comment_id": 89551805, "body": "@i_rigia - I&#39;m not sure I understand the question in the comment. When using kernel modules, the core kernel that loaded the module has no knowledge of any new types. The loaded module uses the new types it declares (either internally or allowing user access using pre-defined headers) - not the original kernel."}, {"owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531326296, "post_id": 51275443, "comment_id": 89558204, "body": "Oh ok. I get u. So the kernel has no knowledge of the types defined in our module ryt?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 1, "creation_date": 1531335675, "post_id": 51275443, "comment_id": 89562691, "body": "@i_rigia - yap, that&#39;s right. The pre-compiled code (the kernel) doesn&#39;t have pre-knowledge of what types the future code (the module) might define... But still, they &quot;communicate&quot; with each other using pre-designed callbacks, functions and/or types as needed."}, {"owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531341637, "post_id": 51275443, "comment_id": 89565216, "body": "So I guess we have to come up with an OS design that has this weird feature. I mean more enhanced feature than kernel modules or DLLs. And somehow I feel that the solution for this problem is quite possible. hehe!!!"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531342680, "post_id": 51275443, "comment_id": 89565636, "body": "@i_rigia lol .... I&#39;m curious, why insist of static types instead of using a dynamic type scheme? I mean, it&#39;s quite easy to implements a dynamic type scheme in C. Even a flexible dynamic type system that can be translated to JSON isn&#39;t that hard (I coded one for facil.io, so I know) and the price in performance doesn&#39;t have to be that high (depending on the required features)... so, why not?"}, {"owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531472118, "post_id": 51275443, "comment_id": 89618044, "body": "@Myst Yeah! But I guess to have a dynamically typed language the only solution currently available is to have an interpreter. If Im not wrong!"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "edited": false, "score": 0, "creation_date": 1531493889, "post_id": 51275443, "comment_id": 89631195, "body": "@i_rigia , I updated my answer with the comments. Note that you don&#39;t need a dynamically typed language. It&#39;s possible to author dynamic types with C. As for an interpreter, than by definition the answer is &quot;yes&quot;. Whenever you read external code and parse it, you are in fact implementing an interpreter. You don&#39;t have to use an existing one. You can author your own. For example, you could convert JSON data to dynamic type definitions using your own interpreter."}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 1, "last_activity_date": 1531493564, "last_edit_date": 1531493564, "creation_date": 1531267382, "answer_id": 51275443, "question_id": 51275068, "link": "https://stackoverflow.com/questions/51275068/is-it-possible-to-create-a-user-defined-datatype-in-a-language-like-c-cor-may/51275443#51275443", "title": "Is it possible to create a user-defined datatype in a language like C/C++(or maybe any) from a string as user input or from file", "body": "<p>What you're asking about is basically \"can we implement C as a scripting language?\", since this is the only way code can be executed after compilation.</p>\n\n<p>I'm aware that people have been writing (mostly in the comments) that it's possible in other languages but isn't possible in C, since C is a compiled language (hence data types should be defined during compile time).</p>\n\n<p>However, to the best of my knowledge it's actually possible (and might not be as hard as one would imagine).</p>\n\n<p>There are many possible approaches (machine code emulation (VM), JIT compilation, etc').</p>\n\n<p>One approach will use a C compiler to compile the C script as an external dynamic library (<code>.dll</code> on windows, <code>.so</code> on linux, etc') and than \"load\" the compiled library and execute the code (this is pretty much the JIT compilation approach, for lazy people).</p>\n\n<hr>\n\n<h3>EDIT:</h3>\n\n<p>As mentioned in the comments, by using this approach, the new type is loaded as part of an external library.</p>\n\n<p>The original code won't know about this new type, only the new code (or library) will be \"aware\" of this new type and able to properly use it.</p>\n\n<p>On the other hand, I'm not sure why you're insisting on the need to use static types and a compiler-linker-loader level solution.</p>\n\n<p>The language itself (the C language) can manage this task dynamically (during execution time).</p>\n\n<p>Consider Ruby MRI, for example. The Ruby language supports dynamic types that can be defined during runtime...</p>\n\n<p>...However, this is implemented in C and it's possible to use the code from within C to define new modules and classes. These aren't static types that can be tested during compilation (type creation and identification is performed during runtime).</p>\n\n<p>This is a perfect example showing that C (as a language) can dynamically define \"types\".</p>\n\n<p>However, this is also a poor example because Ruby's approach is slow. A custom approved can be far faster since it would avoid the huge overhead related to functionality you might not need (such as inheritance).</p>\n"}], "owner": {"reputation": 86, "user_id": 4490515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7KbF.jpg?s=128&g=1", "display_name": "i_rigia", "link": "https://stackoverflow.com/users/4490515/i-rigia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531493564, "creation_date": 1531263974, "question_id": 51275068, "link": "https://stackoverflow.com/questions/51275068/is-it-possible-to-create-a-user-defined-datatype-in-a-language-like-c-cor-may", "title": "Is it possible to create a user-defined datatype in a language like C/C++(or maybe any) from a string as user input or from file", "body": "<p>Well this might be a very weird question but my curiosity has striken pretty hard on this. So here it goes...</p>\n\n<p><strong>NOTE:</strong> Lets take the language C into consideration here.</p>\n\n<p>As programmers we usually define a user-defined datatype(say struct) in the source code with the appropriate name. <br>\nSuppose I have a program in which I have a structure defined as:</p>\n\n<pre><code>struct Animal {\n  char *name;\n  int lifeSpan;\n};\n</code></pre>\n\n<p>And also I have started the execution of this program.<br>\nNow, my question here is;<br>\nWhat if I want to define a new structure called \"Plant\" just like \"Animal\" mentioned above in my program, without writing its definition in the source code itself(which is obviously impossible currently) but rather from a user input string(or a file input) during runtime.\n<br>\nLets say my program takes input string from a text file named <em>file1.txt</em> whose content is:</p>\n\n<pre><code>struct Plant {\n  char *name;\n  int lifeSpan;\n};\n</code></pre>\n\n<p>What I want now is to have a new structure named \"Plant\" in my program which is already in execution. The program should read the file content and create a structure as written in the file and attach it to itself on-the-go.<br><br>\nI have checked out a solution for C++ in the discussion <a href=\"https://stackoverflow.com/questions/2834139/declaring-a-data-type-dynamically-in-c\">Declaring a data type dynamically in C++</a> but it doesnt seem to have a very convincing solution.<br><br>\n<strong>The solution I am looking for is at the compiler-linker-loader level rather than from the language itself.<br>I would be very pleased and thankful if anyone is looking forward to sharing their ideas on this.</strong></p>\n"}, {"tags": ["c", "network-programming", "udp", "tcp-ip"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9220751, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/049e22575f248e8f7e296e6957c7697f?s=128&d=identicon&r=PG&f=1", "display_name": "C. DAVID", "link": "https://stackoverflow.com/users/9220751/c-david"}, "edited": false, "score": 0, "creation_date": 1531300383, "post_id": 51275358, "comment_id": 89540460, "body": "Thanks. Do you mean that I should set this option somewhere in my c code ?"}], "tags": [], "owner": {"reputation": 329, "user_id": 2288914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e8785d362a66ec4c5c8fd10c71812f0?s=128&d=identicon&r=PG", "display_name": "Yingyu YOU", "link": "https://stackoverflow.com/users/2288914/yingyu-you"}, "is_accepted": false, "score": 3, "last_activity_date": 1531267069, "last_edit_date": 1531267069, "creation_date": 1531266508, "answer_id": 51275358, "question_id": 51275053, "link": "https://stackoverflow.com/questions/51275053/c-read-udp-data-from-a-already-used-port/51275358#51275358", "title": "c read udp data from a already used port", "body": "<p>No, basically you cannot open a UDP port which was used by another process already, unless all the sockets bound to and to bind to the same port has option SO_REUSEPORT set.</p>\n\n<p>Whithout SO_REUSEPORT option being set, your second binding to the used port will fail with error code being EINVAL, See manual of <a href=\"http://man7.org/linux/man-pages/man2/bind.2.html\" rel=\"nofollow noreferrer\">bind(2)</a></p>\n\n<blockquote>\n  <p>EINVAL The socket is already bound to an address.</p>\n</blockquote>\n\n<p>For option SO_REUSEPORT, you can refer to this <a href=\"https://stackoverflow.com/questions/14388706/socket-options-so-reuseaddr-and-so-reuseport-how-do-they-differ-do-they-mean-t\">post</a> in SO.</p>\n"}], "owner": {"reputation": 41, "user_id": 9220751, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/049e22575f248e8f7e296e6957c7697f?s=128&d=identicon&r=PG&f=1", "display_name": "C. DAVID", "link": "https://stackoverflow.com/users/9220751/c-david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531267069, "creation_date": 1531263852, "question_id": 51275053, "link": "https://stackoverflow.com/questions/51275053/c-read-udp-data-from-a-already-used-port", "title": "c read udp data from a already used port", "body": "<p>I have been using the code example given in </p>\n\n<p><a href=\"https://stackoverflow.com/questions/31686628/how-to-read-the-udp-data-payload-coming-from-a-port-using-c-program\">How to read the UDP data payload coming from a port using C program</a></p>\n\n<p>for reading udp data from the 5000 port.</p>\n\n<p>However in my machine this port is used by another process and I know it. What I want to know is a solution to keep the c code receiving data from the port even if it is used from the other process.</p>\n\n<p>Thank you guy for your help.</p>\n"}, {"tags": ["c", "struct", "binaryfiles"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531264423, "post_id": 51275062, "comment_id": 89528289, "body": "I tried as you said to me, but the problem is still there and I don&#39;t really get it why. It says no match for the first recipe in the record and if I try to delete the last one, it deletes the others too"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "reply_to_user": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531271363, "post_id": 51275062, "comment_id": 89529606, "body": "Hmm, I&#39;m not really sure what might be going on, but you could further test the return values of <code>fwrite()</code> and <code>fclose()</code> etc to see if there is an error you are not detecting."}], "tags": [], "owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1531263915, "creation_date": 1531263915, "answer_id": 51275062, "question_id": 51274996, "link": "https://stackoverflow.com/questions/51274996/my-delete-function-deletes-the-wrong-record-of-struct/51275062#51275062", "title": "My delete function deletes the wrong record of struct", "body": "<p>The problem is here:</p>\n\n<pre><code>while(fread(&amp;recipe,sizeof(recipe),1,fbr) &amp;&amp; found == 0)\n</code></pre>\n\n<p>Once you find a recipe, you exit the loop, so the remaining elements are not copied to the new file. I recommend you delete the <code>&amp;&amp; found == 0</code> clause.</p>\n\n<p>Furthermore:</p>\n\n<pre><code>if(!found)\n{\n    printf(\"No match.\\n\");\n}\n</code></pre>\n\n<p>This is actually inside the <code>while</code> loop, so it will report <code>No match</code> multiple times. Please move it outside the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531264484, "post_id": 51275078, "comment_id": 89528301, "body": "I tried as you suggested but the problem is still there and I don&#39;t get it why"}], "tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": false, "score": 1, "last_activity_date": 1531264137, "creation_date": 1531264137, "answer_id": 51275078, "question_id": 51274996, "link": "https://stackoverflow.com/questions/51274996/my-delete-function-deletes-the-wrong-record-of-struct/51275078#51275078", "title": "My delete function deletes the wrong record of struct", "body": "<ol>\n<li><p>Proper indentation would help you see the actual structure of the program. This is how the posted program looks with consistent indentation:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint stringCmpi (char *s1,char *s2);\n\nstruct _recipe\n{\n    char name[40];\n    int count_i;\n    char ingredients[20][40];\n    char diff[12];\n    int timr;\n    int calories;\n    int count_p;\n    char procedure[30][500];\n} recipe;\n\nint main()\n{\n    FILE* fbr;\n    FILE* temp;\n    char ricetta_name[] = \"ricette.bin\";\n    char temp_name[] = \"temp.bin\";\n    fbr = fopen(\"ricette.bin\", \"rb\");\n    temp = fopen(\"temp.bin\", \"wb\");\n    int found = 0;\n    char name_t[40];\n    int i;\n    char space = '\\n';\n\n    if(fbr == NULL)\n    {\n        printf(\"Couldn't open the file.\\n\");\n        exit(1);\n    }\n    if(fbr == NULL)\n    {\n        printf(\"Couldn't open the file.\\n\");\n        exit(1);\n    }\n\n    printf(\"Write the name of the recipe you want to delete:\\n\");\n    fgets(name_t,sizeof(name_t),stdin);\n    space = getchar();\n    while(fread(&amp;recipe,sizeof(recipe),1,fbr) &amp;&amp; found == 0)\n    {\n        if(stringCmpi(name_t,recipe.name) == 0)\n        {\n            found = 1;\n            printf(\"Match found. Recipe deleted.\\n\");\n        }\n\n        else\n        {\n            fwrite(&amp;recipe,sizeof(recipe),1,temp);\n        }\n        if(!found)\n        {\n            printf(\"No match.\\n\");\n        }\n    }\n\n    fclose(fbr);\n    fclose(temp);\n    remove(ricetta_name);\n    rename(temp_name,ricetta_name);\n    system(\"PAUSE\");\n    return 0;\n}\n\nint stringCmpi (char *s1,char *s2)\n{\n    int i=0;\n    for(i=0; s1[i]!='\\0'; i++)\n    {\n        if( toupper(s1[i])!=toupper(s2[i]) )\n            return 1;\n    }\n    return 0;\n}\n</code></pre></li>\n<li><p>The program is checking that <code>fbr</code> is not NULL twice. Probably the second check should be for <code>temp</code>.</p></li>\n<li><p>The programs stops reading and copying when the recipe to be deleted is found; this means that the following records are not copied over.</p></li>\n<li><p>The program complains that the recipe was not found for each recipe until the desired one is found.</p></li>\n</ol>\n\n<p>Suggestions:</p>\n\n<ul>\n<li><p>Modify the <code>while</code> loop condition eliminating the <code>&amp;&amp; ! found</code>, so that all records are copied except those matching the given name.</p></li>\n<li><p>Move the check for <code>if (! found)</code> outside the loop.</p></li>\n</ul>\n\n<p>Bonus:</p>\n\n<ul>\n<li>The function <code>stringCmpi()</code> stops comparing at the end of string <code>s1</code>; which means that \"abc\" and \"abcdef\" will compare equal. You probably want to change <code>return 0</code> to <code>return s1 [i] != s2 [i]</code>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531297046, "post_id": 51280443, "comment_id": 89538283, "body": "I didn&#39;t use the standard function because my recipes have spaces and that function won&#39;t work with that kind of strings, that&#39;s why I was forced to write another one"}, {"owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "reply_to_user": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531297655, "post_id": 51280443, "comment_id": 89538638, "body": "<code>str*cmp()</code> just compares string no matter what they are. Why do you think it doesn&#39;t work with spaces? <code>strcasecmp(&quot;a b  c   d&quot;, &quot;a b  c   d&quot;)</code> just returns 0."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531297882, "post_id": 51280443, "comment_id": 89538784, "body": "Because when I tried it, it always states there&#39;s no match. But the problem is even with strcasecmp, it deletes the recipe from the first to the last even if I write the name of the last one"}, {"owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "reply_to_user": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531300457, "post_id": 51280443, "comment_id": 89540529, "body": "Did you meant that <code>strcasecmp()</code> always returns 0? Can you try my code? It works well for me. I wrote 10 recipes structure whose names are <code>name0</code>, ..., <code>name9</code> in a file, and it correctly removed what I specified."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531301567, "post_id": 51280443, "comment_id": 89541325, "body": "I tried your code, but for the system the string comparison is always false, so it doesn&#39;t delete anything and I don&#39;t know why"}, {"owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "reply_to_user": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531358024, "post_id": 51280443, "comment_id": 89569562, "body": "Just print your strings to see what happened, <code>printf(&quot;cmp(&lt;%s&gt;, &lt;%s&gt;)=%d\\n&quot;, s1, s2, *cmp(s1, s2))</code>. I guess the reason is space(` `) or newline (&#39;\\n&#39;) in string."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1531383652, "post_id": 51280443, "comment_id": 89578026, "body": "Oh don&#39;t worry I solvedi it, I just had to leave the newline on the string since I saved it on my file with the newline too, thank you"}], "tags": [], "owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "is_accepted": false, "score": 0, "last_activity_date": 1531296919, "creation_date": 1531296919, "answer_id": 51280443, "question_id": 51274996, "link": "https://stackoverflow.com/questions/51274996/my-delete-function-deletes-the-wrong-record-of-struct/51280443#51280443", "title": "My delete function deletes the wrong record of struct", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct _recipe\n{\n    char name[40];\n    int count_i;\n    char ingredients[20][40];\n    char diff[12];\n    int timr;\n    int calories;\n    int count_p;\n    char procedure[30][500];\n} recipe;\n\nint main(int argc, char *argv[])\n{\n    FILE* fbr;\n    FILE* temp;\n    char *ricetta_name = \"recipe.bin\";\n    char *temp_name = \"temp.bin\";\n    int found = 0;\n    char name_t[40];\n\n    // Use command line arguments if possible\n    if (argc == 2)\n    {\n        ricetta_name = argv[1];\n    }\n\n    if((fbr = fopen(ricetta_name, \"rb\")) == NULL)\n    {\n       printf(\"Couldn't open the file %s.\\n\", ricetta_name);\n       exit(1);\n    }\n    if((temp = fopen(temp_name, \"wb\")) == NULL)\n    {\n       printf(\"Couldn't open the file %s.\\n\", temp_name);\n       exit(1);\n    }\n\n    printf(\"Write the name of the recipe you want to delete:\\n\");\n    fgets(name_t, sizeof(name_t), stdin);\n\n    // Remove '\\n'\n    if (name_t[strlen(name_t) - 1] == '\\n')\n        name_t[strlen(name_t) - 1] = 0;\n\n    while(fread(&amp;recipe,sizeof(recipe), 1, fbr))\n    {  \n        // Use standard strcasecmp()\n        if(strcasecmp(name_t, recipe.name) == 0)\n        {\n            found = 1;\n            printf(\"Match found. Recipe deleted.\\n\");\n        }\n        else\n        {\n            fwrite(&amp;recipe, sizeof(recipe), 1, temp);\n        }\n    }\n\n    if (!found)\n    {\n        printf(\"No match.\\n\");\n    }\n\n    fclose(fbr);\n    fclose(temp);\n    remove(ricetta_name);\n    rename(temp_name,ricetta_name);\n    return 0;\n}\n</code></pre>\n\n<p>Please format your code: add space(' ') after comma(','). And use standard function if possible.</p>\n"}], "owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1531296919, "creation_date": 1531263409, "question_id": 51274996, "link": "https://stackoverflow.com/questions/51274996/my-delete-function-deletes-the-wrong-record-of-struct", "title": "My delete function deletes the wrong record of struct", "body": "<p>I have this function which is supposed to delete the recipe requested by the user. I've always deleted records in this way, but I don't know why this time it doesn't work in the right way. Sometimes it states that there's no match but it deletes the recipe or it deletes all the recipes inside the file and I don't get it why since I basically created a temp file in which writing all the records except for the one the user wants to delete and I used a function that worked for another record so I really don't get it. Is that because the length of ingredients and procedure is not the same for all the recipes?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint stringCmpi (char *s1,char *s2);\n\nstruct _recipe\n{\n    char name[40];\n    int count_i;\n    char ingredients[20][40];\n    char diff[12];\n    int timr;\n    int calories;\n    int count_p;\n    char procedure[30][500];\n} recipe;\n\nint main()\n{\n    FILE* fbr;\n    FILE* temp;\n    char ricetta_name[] = \"ricette.bin\";\n    char temp_name[] = \"temp.bin\";\n    fbr = fopen(\"ricette.bin\", \"rb\");\n    temp = fopen(\"temp.bin\", \"wb\");\n    int found = 0;\n    char name_t[40];\n    int i;\n    char space = '\\n';\n\n    if(fbr == NULL)\n    {\n       printf(\"Couldn't open the file.\\n\");\n       exit(1);\n    }\n    if(fbr == NULL)\n    {\n       printf(\"Couldn't open the file.\\n\");\n       exit(1);\n    }\n\n\n    printf(\"Write the name of the recipe you want to delete:\\n\");\n    fgets(name_t,sizeof(name_t),stdin);\n    space = getchar();\n    while(fread(&amp;recipe,sizeof(recipe),1,fbr) &amp;&amp; found == 0)\n    {   \n        if(stringCmpi(name_t,recipe.name) == 0)\n        {\n            found = 1;\n            printf(\"Match found. Recipe deleted.\\n\");\n        }\n\n        else\n        {\n\n            fwrite(&amp;recipe,sizeof(recipe),1,temp);\n\n        }\n            if(!found)\n    {\n        printf(\"No match.\\n\");\n    }\n    }\n\n\n\n    fclose(fbr);\n    fclose(temp);\n    remove(ricetta_name);\n    rename(temp_name,ricetta_name);\n    system(\"PAUSE\");\n    return 0;\n}\n\nint stringCmpi (char *s1,char *s2)\n{\n    int i=0;\n    for(i=0; s1[i]!='\\0'; i++)\n    {\n        if( toupper(s1[i])!=toupper(s2[i]) )\n            return 1;           \n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "c-preprocessor"], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 1188470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9e9032beede85fd517ca7586ed822a05?s=128&d=identicon&r=PG", "display_name": "detroitwilly", "link": "https://stackoverflow.com/users/1188470/detroitwilly"}, "edited": false, "score": 0, "creation_date": 1531327408, "post_id": 51275077, "comment_id": 89558824, "body": "Thanks for the response, my new solution is to create two arrays - one of type <code>enum gpio_port</code> and one of type <code>uint8_t</code> - and then call the <code>GPIO(a,b)</code> macro myself in the code.  I&#39;ve edited the question to reflect what I&#39;m really trying to do - that is, create an array of macros, rather than an array of <code>#define</code> directives."}], "tags": [], "owner": {"reputation": 564, "user_id": 1165946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fYEZj.png?s=128&g=1", "display_name": "rdowell", "link": "https://stackoverflow.com/users/1165946/rdowell"}, "is_accepted": false, "score": 2, "last_activity_date": 1531264124, "creation_date": 1531264124, "answer_id": 51275077, "question_id": 51274782, "link": "https://stackoverflow.com/questions/51274782/building-an-array-of-define-directives/51275077#51275077", "title": "Building an Array of #define Directives", "body": "<p><code>#define</code> statements perform text replacement, they have no inherent type.  As you noted, <code>GPIO</code> is not a valid type, it's a macro that appears to calculate pin numbers/addresses (actually <code>GPIO</code> is undefined, while <code>GPIO(a,b)</code> is the macro).</p>\n\n<p>If you want to store an array of many of these, then you need to know what actual type they all evaluate to.  Given that the <code>GPIO</code> macro returns a sum of a <code>port</code> and a <code>pin</code> value, where <code>port</code> is an enum, whose underlying type is <code>int</code> (technically, it's an implementation specific integral type - see <a href=\"https://stackoverflow.com/questions/1122096/what-is-the-underlying-type-of-a-c-enum\">What is the underlying type of a c++ enum?</a>) and <code>pin</code> is a <code>uint8_t</code>, the actual type of your array values would also be an integer type - which one specifically depends on your implementation and the range of possible values.</p>\n"}, {"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1531414496, "post_id": 51275099, "comment_id": 89598481, "body": "sorry but that example is useless... as <code>PA3</code> (for example) expands to <code>GPIO(GPIO_PORTA, 3)</code> which instead expands to <code>((((GPIO_PORTA)&amp;0x7u) &lt;&lt; 5) + ((3)&amp;0x1Fu))</code> which is a constant expression of type <code>int</code> (evaluating to the constant <code>3</code> in this case), so your <code>switch</code> will ignore the result of the case statements, giving finally nothing at all.  The array as shown in the question is perfectly legal, as each macro expands to a constant expression, that can be used as initializer.  The OP has not tested his  example, and that&#39;s the reason he is asking here."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1531264329, "creation_date": 1531264329, "answer_id": 51275099, "question_id": 51274782, "link": "https://stackoverflow.com/questions/51274782/building-an-array-of-define-directives/51275099#51275099", "title": "Building an Array of #define Directives", "body": "<p>No, you cannot create an array of macros like that.  </p>\n\n<p>If you want to execute a particular macro based on an input, you will need to use an <code>if-else</code> or <code>switch</code> statement.  If the input is an integer, you could do something like:</p>\n\n<pre><code>switch( input )\n{\n  case 0: PA3; break;\n  case 1: PA4; break;\n  case 2: PA21; break;\n  ...\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 731, "user_id": 1188470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9e9032beede85fd517ca7586ed822a05?s=128&d=identicon&r=PG", "display_name": "detroitwilly", "link": "https://stackoverflow.com/users/1188470/detroitwilly"}, "edited": false, "score": 0, "creation_date": 1531428152, "post_id": 51311015, "comment_id": 89604939, "body": "I had, in fact, tested my code.  The error I received from my compiler was <code>unknown type name &#39;GPIO&#39;</code>.  I will admit that I should have posted the error message in the question, but the gist of it was expressed in &quot;But this obviously doesn&#39;t work as <code>GPIO</code> is not a recognized C-type, but in fact a macro&quot;.  Which is why I asked the question &quot;How would I note the type of for what I&#39;m working with?&quot;."}, {"owner": {"reputation": 731, "user_id": 1188470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9e9032beede85fd517ca7586ed822a05?s=128&d=identicon&r=PG", "display_name": "detroitwilly", "link": "https://stackoverflow.com/users/1188470/detroitwilly"}, "edited": false, "score": 0, "creation_date": 1531429999, "post_id": 51311015, "comment_id": 89605714, "body": "I tried compiling with <code>int knavePinList[15] = {PA3, ... };</code>, which works.  Thank you for pointing out how the macros resolve!"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 731, "user_id": 1188470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9e9032beede85fd517ca7586ed822a05?s=128&d=identicon&r=PG", "display_name": "detroitwilly", "link": "https://stackoverflow.com/users/1188470/detroitwilly"}, "edited": false, "score": 0, "creation_date": 1531467143, "post_id": 51311015, "comment_id": 89615401, "body": "Well, try declaring it as <code>int</code>, as probably that was the intention.  With the snippet of code you have post, it&#39;s difficult to say."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": true, "score": 1, "last_activity_date": 1531415174, "last_edit_date": 1531415174, "creation_date": 1531414811, "answer_id": 51311015, "question_id": 51274782, "link": "https://stackoverflow.com/questions/51274782/building-an-array-of-define-directives/51311015#51311015", "title": "Building an Array of #define Directives", "body": "<p>The array you post is perfectly legal, I think you have not tested it.  Anyway, it is best to ask with a testable example, (see <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>) but the code:</p>\n\n<pre><code>GPIO knavePinList[] = {PA3, PA4, PA21, PB4, PHY_RESET_PIN, PD0, PD1, PD2, PD3, PD4, PD5, PD6, PD7, PD8, PD9};\n</code></pre>\n\n<p>will produce a perfectly legally initialized array of integers, with the bitwise values of the constants you have expanded from the macros.  Try to use</p>\n\n<pre><code>cpp source.c | more\n</code></pre>\n\n<p>to see how the array declaration is actually expanded.  By the way, you have another, different problem in your code... you are using <strong>the same identifier</strong>, <code>GPIO</code>, to indicate the <code>GPIO</code> macro name, and the type of the array elements, so when the macro processor encounters it, it sees no parameters, which is not how you have <code>#define</code>d it, and complaints about a two parameter macro <code>GPIO</code> called with no parameters at all.</p>\n\n<p>You have to test your code... and send 1. what you expect... and 2. what you get instead... because the error should be evident, if you had simply stopped to read it.</p>\n\n<p>A solution to your problem is to rename the macro <code>GPIO</code> to <code>GPIO_BITS</code> for example... and then change all the definitions:</p>\n\n<pre><code>#define GPIO_BITS(port, pin) ((((port)&amp;0x7u) &lt;&lt; 5) + ((pin)&amp;0x1Fu))\n\n...\n\n#define PA3 GPIO_BITS(GPIO_PORTA, 3)\n</code></pre>\n\n<p>so when you encounter the array definition, the type name is not tried to expand as a macro.</p>\n"}], "owner": {"reputation": 731, "user_id": 1188470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9e9032beede85fd517ca7586ed822a05?s=128&d=identicon&r=PG", "display_name": "detroitwilly", "link": "https://stackoverflow.com/users/1188470/detroitwilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 1, "accepted_answer_id": 51311015, "answer_count": 3, "score": 0, "last_activity_date": 1531428314, "creation_date": 1531261931, "last_edit_date": 1531428314, "question_id": 51274782, "link": "https://stackoverflow.com/questions/51274782/building-an-array-of-define-directives", "title": "Building an Array of #define Directives", "body": "<p>I have some microcontroller code that uses some header files where GPIO pins are defined like this:</p>\n\n<pre><code>#define PA3 GPIO(GPIO_PORTA, 3)\n</code></pre>\n\n<p>Using the IDE, I can navigate to the implementation of <code>GPIO</code> and I find this:</p>\n\n<pre><code>#define GPIO(port, pin) ((((port)&amp;0x7u) &lt;&lt; 5) + ((pin)&amp;0x1Fu))\n</code></pre>\n\n<p>Where <code>pin</code> is defined as:</p>\n\n<pre><code>const uint8_t pin\n</code></pre>\n\n<p>and <code>port</code> is an <code>enum</code> defined as:</p>\n\n<pre><code>enum gpio_port { GPIO_PORTA, GPIO_PORTB, GPIO_PORTC, GPIO_PORTD, GPIO_PORTE }\n</code></pre>\n\n<p>I would like to create an array of all the GPIO defins (<code>PA3</code>, <code>PA4</code>, etc.) that can be indexed by an integer passed over a serial port.  </p>\n\n<p>I tried the following:</p>\n\n<pre><code>GPIO knavePinList[] = {PA3, PA4, PA21, PB4, PHY_RESET_PIN, PD0, PD1, PD2, PD3, PD4, PD5, PD6, PD7, PD8, PD9};\n</code></pre>\n\n<p>But this obviously doesn't work as <code>GPIO</code> is not a recognized C-type, but in fact a macro.  While trying to build, I receive this error message:</p>\n\n<pre><code>unknown type name 'GPIO'\n</code></pre>\n\n<p>Is it even possible for me to declare an array of macros?  If so, how would I note the type for what I'm working with?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "libxml2"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1531259383, "post_id": 51274354, "comment_id": 89526942, "body": "You can&#39;t compile a xml-file. Remove the <code>note.xml</code> from your command line."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1531259670, "post_id": 51274354, "comment_id": 89527044, "body": "You need that .xml file when you <i>run</i> your program.  Not when you build it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531269437, "post_id": 51274354, "comment_id": 89529197, "body": "your <code>readfile()</code> function can return with out actually reading the XML file. However, in your <code>main()</code> function the returned value is not being checked, so these statement: <code>xmlCleanupParser();      xmlMemoryDump();</code> are trying to process a XML file that has not been read.  This is a logic error.  strongly suggest having the error exit and the success exit from <code>readfile()</code> return values that the <code>main()</code> function can check"}], "answers": [{"tags": [], "owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "is_accepted": true, "score": 3, "last_activity_date": 1531269991, "last_edit_date": 1531269991, "creation_date": 1531259516, "answer_id": 51274394, "question_id": 51274354, "link": "https://stackoverflow.com/questions/51274354/why-am-i-getting-error-file-format-not-reognized-while-compiling/51274394#51274394", "title": "Why am I getting error file format not reognized while compiling?", "body": "<p>The error explains it all:</p>\n\n<pre><code>/usr/bin/ld:note.xml: file format not recognized; treating as linker script\n</code></pre>\n\n<p>File format not recognized. Which file? <code>note.xml</code>. Is it code? No, it isn't part of your C code. It should not be compiled at all, so don't pass it as an argument to <code>gcc</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8382752, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fmvFvmokf7o/AAAAAAAAAAI/AAAAAAAAEdo/qdFtvw7bJnw/photo.jpg?sz=128", "display_name": "hatim master", "link": "https://stackoverflow.com/users/8382752/hatim-master"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 51274394, "answer_count": 1, "score": -3, "last_activity_date": 1531270108, "creation_date": 1531259307, "last_edit_date": 1531270108, "question_id": 51274354, "link": "https://stackoverflow.com/questions/51274354/why-am-i-getting-error-file-format-not-reognized-while-compiling", "title": "Why am I getting error file format not reognized while compiling?", "body": "<p>I am using libxml2 parser for parsing xml file. But when I compile using using gcc compiler:</p>\n\n<pre><code>gcc test.c note.xml -I/usr/include/libxml2 -lxml2 -o output\n</code></pre>\n\n<p>It gives me following error:</p>\n\n<pre><code>/usr/bin/ld:note.xml: file format not recognized; treating as linker script\n/usr/bin/ld:note.xml:1: syntax error\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Here is my test.c file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;libxml/parser.h&gt;\n#include &lt;libxml/tree.h&gt;\n\nvoid readfile(const char* filename) {\n    xmlDocPtr doc;\n    doc = xmlReadFile(filename,NULL,0);\n    if(doc == NULL)\n       return;\n    xmlFreeDoc(doc);\n}\n\nint main(int argc,char* argv[]) {\n    if(argc != 2)\n        return 1;\n    LIBXML_TEST_VERSION\n    readfile(argv[1]);\n    xmlCleanupParser();\n    xmlMemoryDump();\n    return 0; \n} \n</code></pre>\n\n<p>Here is my xml file:</p>\n\n<pre><code>&lt;note&gt;\n  &lt;to&gt;Tove&lt;/to&gt;\n    &lt;from&gt;Jani&lt;/from&gt;\n      &lt;heading&gt;Reminder&lt;/heading&gt;\n        &lt;body&gt;Don't forget me this weekend!&lt;/body&gt;\n   &lt;/note&gt;\n</code></pre>\n"}, {"tags": ["c++", "c", "types", "integer"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1531259382, "post_id": 51274339, "comment_id": 89526941, "body": "Width and signedness aren&#39;t enough to identify a type, even an integer type. For example, <code>long</code> is almost always the same size as either <code>int</code> or <code>long long</code>."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1531259505, "post_id": 51274339, "comment_id": 89526986, "body": "Well, clearly neither <code>long</code> nor <code>long long</code> are 16 bytes! What do you suggest in order to identify an integer data type?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1531259567, "post_id": 51274339, "comment_id": 89527006, "body": "I believe some versions of gcc implement a 128-bit type, although it&#39;s typically &quot;emulated in software&quot;, since you&#39;re right, most CPUs don&#39;t have registers and ALU&#39;s operating on such a size."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1531259727, "post_id": 51274339, "comment_id": 89527068, "body": "If you want to make decisions based on the type of an expression, <a href=\"https://en.cppreference.com/w/c/language/generic\" rel=\"nofollow noreferrer\"><code>_Generic</code></a> would be the standard way to go."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1531260153, "post_id": 51274339, "comment_id": 89527203, "body": "to print the result of <code>sizeof</code>, you should use <code>%zu</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531263294, "post_id": 51274339, "comment_id": 89528054, "body": "&quot;Well, clearly neither long nor long long are 16 bytes!&quot; this statement requires additional qualifiers. C++ only specifies the <b>minimum</b> size of the fundamental integer types and leaves the upper end restricted only by the size of the next type up (<code>int</code> cannot be larger than <code>long</code>). It is entirely possible to have a system where all integers <code>char</code> through <code>long long</code> are 128 bits wide. Or 4096 bits, for that matter."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1531265106, "post_id": 51274339, "comment_id": 89528421, "body": "Yes, that kind of data types arrangement would indeed conform to the standard! Actually, I meant that on my 64-bit computer both, <code>long</code> and <code>long long</code> are 8 bytes wide."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531265780, "post_id": 51274339, "comment_id": 89528556, "body": "Also there are no negative literals. The expression <code>-3</code> is unary minus operator applied to the literal <code>3</code>."}], "answers": [{"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1531261339, "post_id": 51274619, "comment_id": 89527554, "body": "For C++,  Scott Mayers has recommended printing types with a compiler error on an declared but undefined template <code>template&lt;class T&gt; class TP; TP&lt;decltype(LITERAL)&gt; tp;</code>. My answer&#39;s basically using a <code>_Generic</code>-based C version of that strategy. (Anyway, you might not want to answer C-tagged questions with C++ code. Everybody knows us C programmers often HATE C++ :D )."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1531261658, "post_id": 51274619, "comment_id": 89527641, "body": "@PSkocik No problem, added the <code>c++</code> tag! Anyway, I tend to use C++ features interchangeably with C features. If I want to use something that C++ has that C lacks, I just do <code>#ifdef __cplusplus</code> and put that straight into the <code>.c</code> source code file, or I use an <code>extern &quot;C&quot;</code> to link C and C++ code together. Well, just use the tools that are available in your hands."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1531261742, "post_id": 51274619, "comment_id": 89527660, "body": "For me it&#39;s just like using any GNU compiler extensions or inline assembly code in C. So yes, it&#39;s not pure C."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1531261793, "post_id": 51274619, "comment_id": 89527674, "body": "Whereas <code>C++</code> is a programming language, <code>++C</code> is <code>C</code> code with c++ code and various non-standard extensions mixed in! :D"}], "tags": [], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "is_accepted": true, "score": 3, "last_activity_date": 1531262406, "last_edit_date": 1531262406, "creation_date": 1531260807, "answer_id": 51274619, "question_id": 51274339, "link": "https://stackoverflow.com/questions/51274339/what-is-a-16-byte-signed-integer-data-type/51274619#51274619", "title": "What is a 16 byte signed integer data type?&quot;", "body": "<p>After some digging this is what I've found. I converted the code to C++, assuming that C and C++ behave similarly in this case. I want to create a template function to be able to accept any data type. I use <code>__PRETTY_FUNCTION__</code> which is a GNU compiler extension which returns a C-string containing the \"prototype\" of the function, I mean the return type, the name, and the formal parameters that are input. I am interested in the formal parameters. Using this technique, I am able to determine the data type of the expression that gets passed in exactly, without guessing!</p>\n\n<pre><code>/**\n * This is a templated function.\n * It accepts a value \"object\" of any data type, which is labeled as \"T\".\n *\n * The __PRETTY_FUNCTION__ is a GNU compiler extension which is actually\n * a C-string that evaluates to the \"pretty\" name of a function,\n * means including the function's return type and the types of its\n * formal parameters.\n *\n * I'm using __PRETTY_FUNCTION__ to determine the data type of the passed\n * in expression to the function, during the runtime!\n */\ntemplate&lt;typename T&gt;\nvoid foo(T value)\n{\n    std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; std::endl;\n}\n\nfoo(5);\nfoo(-9223372036854775808);\n</code></pre>\n\n<p>Compiling and running, I get this output:</p>\n\n<pre><code>$ g++ -m64 -std=c++11 experiment2.cpp\n$\n$ ./a.out\nvoid foo(T) [with T = int]\nvoid foo(T) [with T = __int128]\n</code></pre>\n\n<p>I see that the passed in expression is of type <code>__int128</code>. Apparently, this is a GNU compiler specific extension, not part of the C standard.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29638723/why-isnt-there-int128-t\">Why isn&#39;t there int128_t?</a></p>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.6.4/gcc/_005f_005fint128.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-4.6.4/gcc/_005f_005fint128.html</a></p>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.6.4/gcc/C-Extensions.html#C-Extensions\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-4.6.4/gcc/C-Extensions.html#C-Extensions</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/25109065/how-is-a-16-byte-data-type-stored-on-a-64-bit-machine\">How is a 16 byte data type stored on a 64 bit machine</a></p>\n"}, {"comments": [{"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1531261168, "post_id": 51274626, "comment_id": 89527516, "body": "Clever way to find out the data type of a passed in expression or literal!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531265862, "post_id": 51274626, "comment_id": 89528572, "body": "There&#39;s no cast involved. I think you mean to say that gcc uses the type of <code>__int128</code> for this constant."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1531266634, "post_id": 51274626, "comment_id": 89528715, "body": "Right, it just has the <code>__int128</code> type."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 3, "last_activity_date": 1531266681, "last_edit_date": 1531266681, "creation_date": 1531260835, "answer_id": 51274626, "question_id": 51274339, "link": "https://stackoverflow.com/questions/51274339/what-is-a-16-byte-signed-integer-data-type/51274626#51274626", "title": "What is a 16 byte signed integer data type?&quot;", "body": "<p>With all warnings enabled -Wall gcc will issue <code>warning: integer constant is so large that it is unsigned</code> warning. Gcc assigns this integer constant the type <code>__int128</code> and <code>sizeof(__int128) = 16</code>.<br>\nYou can check that with _Generic macro:</p>\n\n<pre><code>#define typestring(v) _Generic((v), \\\n    long long: \"long long\", \\\n    unsigned long long: \"unsigned long long\", \\\n    __int128: \"__int128\" \\\n    )\n\nint main()\n{\n    printf(\"Type is %s\\n\", typestring(-9223372036854775808));\n    return 0;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>Type is __int128\n</code></pre>\n\n<p>Or with warnings from printf:</p>\n\n<pre><code>int main() {\n    printf(\"%s\", -9223372036854775808);\n    return 0;\n}\n</code></pre>\n\n<p>will compile with warning:</p>\n\n<pre><code>warning: format '%s' expects argument of type 'char *', but argument 2 has type '__int128' [-Wformat=]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531266009, "post_id": 51274642, "comment_id": 89528598, "body": "@M.M Because the type is evidently signed."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531266081, "post_id": 51274642, "comment_id": 89528607, "body": "@M.M O.P&#39;s question even includes a signedness test showing that the resulting type is signed."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 3, "last_activity_date": 1531261430, "last_edit_date": 1531261430, "creation_date": 1531260941, "answer_id": 51274642, "question_id": 51274339, "link": "https://stackoverflow.com/questions/51274339/what-is-a-16-byte-signed-integer-data-type/51274642#51274642", "title": "What is a 16 byte signed integer data type?&quot;", "body": "<p>Your platform likely has <code>__int128</code> and <code>9223372036854775808</code> is acquiring that type.</p>\n\n<p>A simple way to get a C compiler to print a typename is with something like:</p>\n\n<pre><code>int main(void)\n{\n\n    #define LITERAL (-9223372036854775808)\n    _Generic(LITERAL, struct {char x;}/*can't ever match*/: \"\");\n\n}\n</code></pre>\n\n<p>On my x86_64 Linux, the above is generating an \n<code>error: \u2018_Generic\u2019 selector of type \u2018__int128\u2019 is not compatible with any association</code> error message, implying <code>__int128</code> is indeed the type of the literal.</p>\n\n<p>(With this, the <code>warning: integer constant is so large that it is unsigned</code> is wrong. Well, gcc isn't perfect.)</p>\n"}], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2893, "favorite_count": 0, "accepted_answer_id": 51274619, "answer_count": 3, "score": 3, "last_activity_date": 1531268712, "creation_date": 1531259225, "last_edit_date": 1531268712, "question_id": 51274339, "link": "https://stackoverflow.com/questions/51274339/what-is-a-16-byte-signed-integer-data-type", "title": "What is a 16 byte signed integer data type?&quot;", "body": "<p>I made this program to test what data types arbitrary integer literals get evaluated to. This program was inspired from reading some other questions on StackOverflow.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27612996/how-do-i-define-a-constant-equal-to-2147483648\">How do I define a constant equal to -2147483648?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/26003893/why-do-we-define-int-min-as-int-max-1\">Why do we define INT_MIN as -INT_MAX - 1?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/14695118/2147483648-0-returns-true-in-c\">(-2147483648&gt; 0) returns true in C++?</a></p>\n\n<p>In these questions, we have an issue: the programmer wants to write INT_MIN as <code>-</code><em>2^31</em>, but <em>2^31</em> is actually a literal and <code>-</code> is the unary negation operator. Since INT_MAX is usually <em>2^31 - 1</em> having a 32-bit int, the literal <em>2^31</em> cannot be represented as an <code>int</code>, and so it gets promoted to a larger data type. The second answer in the third question has a chart according to which the data type of the integer literals is determined. The compiler goes down the list from the top until it finds a data type which can fit the literal.</p>\n\n<blockquote>\n  <p><code>Suffix       Decimal constants\n  none         int\n               long int\n               long long int</code></p>\n</blockquote>\n\n<p>=========================================================================</p>\n\n<p>In my little program, I define a macro that will return the \"name\" of a variable, literal, or expression, as a C-string. Basically, it returns the text that is passed inside of the macro, exactly as you see it in the code editor. I use this for printing the literal expression.</p>\n\n<p>I want to determine the data type of the expression, what it evaluates to. I have to be a little clever about how I do this. How can we determine the data type of a variable or an expression in C? I've concluded that only two \"bits\" of information are necessary: the width of the data type in bytes, and the signedness of the data type.</p>\n\n<p>I use the <code>sizeof()</code> operator to determine the width of the data type in bytes. I also use another macro to determine if the data type is signed or not. <code>typeof()</code> is a GNU compiler extension that returns the <strong>data type</strong> of a variable or expression. But I cannot <strong>read</strong> the data type. I typecast <code>-1</code> to whatever that data type is. If it's a signed data type, it will still be <code>-1</code>, if it's an unsigned data type, it will become the <code>UINT_MAX</code> for that data type.</p>\n\n<pre><code>#include &lt;stdio.h&gt;   /* C standard input/output - for printf()     */\n#include &lt;stdlib.h&gt;  /* C standard library      - for EXIT_SUCCESS */\n\n/**\n * Returns the name of the variable or expression passed in as a string.\n */\n#define NAME(x) #x\n\n/**\n * Returns 1 if the passed in expression is a signed type.\n * -1 is cast to the type of the expression.\n * If it is signed, -1 &lt; 0 == 1 (TRUE)\n * If it is unsigned, UMax &lt; 0 == 0 (FALSE)\n */\n#define IS_SIGNED_TYPE(x) ((typeof(x))-1 &lt; 0)\n\nint main(void)\n{\n\n    /* What data type is the literal -9223372036854775808? */\n\n    printf(\"The literal is %s\\n\", NAME(-9223372036854775808));\n    printf(\"The literal takes up %u bytes\\n\", sizeof(-9223372036854775808));\n    if (IS_SIGNED_TYPE(-9223372036854775808))\n        printf(\"The literal is of a signed type.\\n\");\n    else\n        printf(\"The literal is of an unsigned type.\\n\");\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>As you can see, I'm testing <code>-</code><em>2^63</em> to see what data type it is. The problem is that in ISO C90, the \"largest\" data type for integer literals appears to be <code>long long int</code>, if we can believe the chart. As we all know, <code>long long int</code> has a numerical range <em>-2^63</em> to <em>2^63 - 1</em> on a modern 64-bit system. However, the <code>-</code> above is the unary negation operator, not really part of the integer literal. I'm attempting to determine the data type of <em>2^63</em>, which is too big for the <code>long long int</code>. I'm attempting to cause a bug in C's type system. That is intentional, and only for educational purposes.</p>\n\n<p>I am compiling and running the program. I use <code>-std=gnu99</code> instead of <code>-std=c99</code> because I am using <code>typeof()</code>, a GNU compiler extension, not actually part of the ISO C99 standard. I get the following output:</p>\n\n<pre><code>$ gcc -m64 -std=gnu99 -pedantic experiment.c\n$\n$ ./a.out\nThe literal is -9223372036854775808\nThe literal takes up 16 bytes\nThe literal is of a signed type.\n</code></pre>\n\n<p>I see that the integer literal equivalent to <em>2^63</em> evaluates to a 16 byte signed integer type! As far as I know, there is no such data type in the C programming language. I also don't know of any Intel x86_64 processor that has a 16 byte register to store such an rvalue. Please correct me if I'm wrong. Explain what's going on here? Why is there no overflow? Also, is it possible to define a 16 byte data type in C? How would you do it?</p>\n"}, {"tags": ["python", "c", "python-c-api"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1531256700, "post_id": 51273804, "comment_id": 89525920, "body": "You may want to look into generating bindings with <a href=\"http://www.swig.org/\" rel=\"nofollow noreferrer\">SWIG</a>. It&#39;s probably a lot more convenient than writing up an extension module and defining a bunch of extension types yourself, or going through ctypes for everything."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1531256980, "post_id": 51273804, "comment_id": 89526038, "body": "Ctypes is definitly not an option.  I would prefer to use the standard api if possibl, but thank you for the advice"}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1531257812, "post_id": 51273804, "comment_id": 89526362, "body": "It&#39;s also worth looking into lower-level libraries like PyCxx, boost::python, Pyd, rust-python, etc. Instead of writing code to drive an interface generator like SWIG, you write code in a general-purpose language like C++ or D or Rust that can talk directly to C, and there are templates/macros/etc. that generate Python types, manage Python refcounting, etc. so you don&#39;t have to deal with all of that boilerplate (and all of the annoying bugs that you&#39;re going to face in doing this)."}], "answers": [{"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1531257923, "post_id": 51274059, "comment_id": 89526403, "body": "<code>long</code> and <code>PyLong_FromLong</code> should probably be <code>size_t</code> and <code>PyLong_FromSize_t</code>, since <code>long</code> might not be big enough. (That option is still a bad idea even with <code>size_t</code>, though.)"}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1531258331, "post_id": 51274059, "comment_id": 89526551, "body": "@user2357112 Fixed. But anyway, the point of that section is really to scare people into understanding why they want to do all the hard work of writing a real extension type (or, better, letting PyCxx do it for them). Anyone who looks at that and says, &quot;Yes, that&#39;s what I want, Python objects that can&#39;t be inspected, and that regularly cause segfaults&quot; is probably beyond help\u2026"}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1531258513, "post_id": 51274059, "comment_id": 89526624, "body": "&quot;D, or Rust&quot; are not supported sadly, and I don&#39;t know C++ so I think I am stuck with C for the forseeable future."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "reply_to_user": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 1, "creation_date": 1531259137, "post_id": 51274059, "comment_id": 89526844, "body": "@Simon One more option to consider: can you use Cython? It lets you write C extension modules in a language that\u2019s basically Python, except that it can directly interface with C. So your wrapper class looks more like a Python class with a special private member variable than like a bunch of functions using <code>PyArgs</code> calls and a couple of structs to tie them together."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1531259651, "post_id": 51274059, "comment_id": 89527034, "body": "Can it deal with things like header files and runtimes?   I&#39;m stuck with a bunch of header files and runtimes (the reason I am using C in the first place).  I cannot interact with the runtimes directly.  Only with the help of the header files"}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 1, "creation_date": 1531259845, "post_id": 51274059, "comment_id": 89527103, "body": "I don&#39;t know what you mean by &quot;runtimes&quot;. Do you mean .so/.dylib/.dll files? If so, then yes, Cython can deal with those. It may make the <code>setup.py</code> slightly more complicated, and of course you need to distribute those shared libs together with your module, but otherwise, it doesn&#39;t really matter whether the C code you&#39;re linking to is in <code>.c</code> files, <code>.o</code>/<code>.obj</code> files, or shared libs."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1531260067, "post_id": 51274059, "comment_id": 89527171, "body": "I meant <code>.dll</code>s. I&#39;ll look into an alternative as you suggest.  Cython or SWIG both seem feasable, thank you so much for you detailed answer and help.  I really do appreciate it."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "reply_to_user": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 2, "creation_date": 1531261321, "post_id": 51274059, "comment_id": 89527550, "body": "@Simon It&#39;s definitely worth learning how to write a C extension module\u2014including at least one real extension type\u2014from scratch. But once you&#39;ve learned it, it&#39;s often worth doing whatever you can (Cython, PyCxx, ctypes/cffi, SWIG, \u2026) to avoid doing it again. :)"}], "tags": [], "owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "is_accepted": true, "score": 2, "last_activity_date": 1531259470, "last_edit_date": 1531259470, "creation_date": 1531257672, "answer_id": 51274059, "question_id": 51273804, "link": "https://stackoverflow.com/questions/51273804/returning-a-function-python-c-api/51274059#51274059", "title": "Returning a function python-c-api", "body": "<p>The problem here is that <code>MethFunc()</code> returns an <code>IHandle *</code>, but you're telling Python to treat it as a <code>PyObject *</code>. Presumably those are completely unrelated types. </p>\n\n<p>A <code>PyObject *</code> (or any <code>struct</code> you or Python defines that starts with an appropriate <a href=\"https://docs.python.org/3/c-api/structures.html#c.PyObject_HEAD\" rel=\"nofollow noreferrer\"><code>HEAD</code></a> macro) begins with pointers to a refcount and a type, and the first thing Python is going to do with any object you hand it is deal with those pointers. So, if you give it an object that instead starts with, say, two <code>int</code>s, Python is going to end up trying to access a type at <code>0x00020001</code> or similar, which is almost certain to segfault. </p>\n\n<p>If you need to pass around a pointer to some C object, you have to wrap it up in a Python object. There are three ways to do this, from hackiest to most solid.</p>\n\n<hr>\n\n<p>First, you can just cast the <code>IHandle *</code> to a <code>size_t</code>, then <code>PyLong_FromSize_t</code> it.</p>\n\n<p>This is dead simple to implement. But it means these objects are going to look exactly like numbers from the Python side, because that's all they are.</p>\n\n<p>Obviously you can't attach a method to this number; instead, your API has to be a free function that takes a number, then casts that number back to an <code>IHandle*</code> and calls a method.</p>\n\n<p>It's more like, e.g., C's <code>stdio</code>, where you have to keep passing <code>stdin</code> or <code>f</code> as an argument to <code>fread</code>, instead of Python's <code>io</code>, where you call methods on <code>sys.stdin</code> or <code>f</code>.</p>\n\n<p>But even worse, because there's no type checking, static or dynamic, to protect you from some Python code accidentally passing you the number <code>42</code>. Which you'll then cast to an <code>IHandle *</code> and try to dereference, leading to a segfault\u2026</p>\n\n<p>And if you were hoping Python's garbage collector would help you know when the object is still referenced, you're out of luck. You need to make your users manually keep track of the number and call some <code>CloseHandle</code> function when they're done with it.</p>\n\n<p>Really, this isn't that much better than accessing your code from <code>ctypes</code>, so hopefully that inspires you to keep reading.</p>\n\n<hr>\n\n<p>A better solution is to cast the <code>IHandle *</code> to a <code>void *</code>, then <code>PyCapsule_New</code> it.</p>\n\n<p>If you haven't read about <a href=\"https://docs.python.org/3/c-api/capsule.html\" rel=\"nofollow noreferrer\">capsules</a>, you need to at least skim the main chapter. But the basic idea is that it wraps up a <code>void*</code> as a Python object.</p>\n\n<p>So, it's almost as simple as passing around numbers, but solves most of the problems. Capsules are opaque values which your Python users can't accidentally do arithmetic on; they can't send you <code>42</code> in place of a capsule; you can attach a function that gets called when the last reference to a capsule goes away; you can even give it a nice name to show up in the <code>repr</code>.</p>\n\n<p>But you still can't attach any behavior to capsules. </p>\n\n<p>So, your API will still have to be a <code>MethSetAttribute(mymodule, foo)</code> instead of <code>mymeth.SetAttribute(foo)</code> if <code>mymodule</code> is a capsule, just as if it's an <code>int</code>. (Except now it's type-safe.)</p>\n\n<hr>\n\n<p>Finally, you can build a new Python extension type for a struct that contains an <code>IHandle *</code>.</p>\n\n<p>This is a lot more work. And if you haven't read the tutorial on <a href=\"https://docs.python.org/3/extending/newtypes_tutorial.html\" rel=\"nofollow noreferrer\">Defining Extension Types</a>, you need to go thoroughly read through that whole chapter.</p>\n\n<p>But it means that you have an actual Python type, with everything that goes with it.</p>\n\n<p>You can give it a <code>SetAttribute</code> method, and Python code can just call that method. You can give it whatever <code>__str__</code> and <code>__repr__</code> you want. You can give it a <code>__doc__</code>. Python code can do <code>isinstance(mymodule, MyMeth)</code>. And so on.</p>\n\n<hr>\n\n<p>If you're willing to use C++, or D, or Rust instead of C, there are some great libraries (PyCxx, boost::python, Pyd, rust-python, etc.) that can do most of the boilerplate for you. You just declare that you want a Python class and how you want its attributes and methods bound to your C attributes and methods and you get something you can use like a C++ class, except that it's actually a <code>PyObject *</code> under the covers. (And it'll even takes care of all the refcounting cruft for you via RAII, which will save you endless weekends debugging segfaults and memory leaks\u2026)</p>\n\n<p>Or you can use <a href=\"http://cython.org\" rel=\"nofollow noreferrer\">Cython</a>, which lets you write C extension modules in a language that's basically Python, but extended to interface with C code. So your wrapper class is just a <code>class</code>, but with a special private <code>cdef</code> attribute that holds the <code>IHandle *</code>, and your <code>SetAttribute(self, s)</code> can just call the C <code>SetAttribute</code> function with that private attribute.</p>\n\n<p>Or, as suggested by user, you can also use <a href=\"http://www.swig.org/\" rel=\"nofollow noreferrer\">SWIG</a> to generate the C bindings for you. For simple cases, it's pretty trivial\u2014just feed it your C API, and it gives you back the code to build your Python <code>.so</code>. For less simple cases, I personally find it a lot more painful than something like PyCxx, but it definitely has a lower learning curve if you don't already know C++.</p>\n"}], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 51274059, "answer_count": 1, "score": 0, "last_activity_date": 1531259470, "creation_date": 1531256285, "question_id": 51273804, "link": "https://stackoverflow.com/questions/51273804/returning-a-function-python-c-api", "title": "Returning a function python-c-api", "body": "<p>I am  creating Python bindings for a C library.  </p>\n\n<p>In C the code to use the functions would look like this:</p>\n\n<pre><code>Ihandle *foo;\nfoo = MethFunc();\nSetArribute(foo, 's');\n</code></pre>\n\n<p>I am trying to get this into Python. Where I have <code>MethFunc()</code> and <code>SetAttribute()</code> functions that could be used in my Python code:</p>\n\n<pre><code>import mymodule\nfoo = mymodule.MethFunc()\nmymodule.SetAttribute(foo)\n</code></pre>\n\n<p>So far my C code to return the function looks like this:</p>\n\n<pre><code>static PyObject * _MethFunc(PyObject *self, PyObject *args) {\n    return Py_BuildValue(\"O\", MethFunc());\n}\n</code></pre>\n\n<p>But that fails by crashing (no errors)</p>\n\n<p>I have also tried <code>return MethFunc();</code> but that failed.  </p>\n\n<p>How can I return the function <code>foo</code> (or if what I am trying to achieve is completely wrong, how should I go about passing <code>MethFunc()</code> to <code>SetAttribute()</code>)?</p>\n"}, {"tags": ["c", "gtk", "ubuntu-16.04", "mime"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1531307468, "post_id": 51273775, "comment_id": 89545215, "body": "Replace <code>Exec=sudo taskset -c 6 &#47;home&#47;DC1&#47;Codes&#47;.&#47;CCC_DC</code> with <code>Exec=gksudo taskset -c 6 &#47;home&#47;DC1&#47;Codes&#47;.&#47;CCC_DC</code>. Using <code>sudo</code> in the desktop file won&#39;t work, because there is no terminal. <code>gksudo</code> is a GTK+ frontend for <code>sudo</code> and will work similarly, except that it will use a graphical prompt for the password if necessary."}, {"owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1531337754, "post_id": 51273775, "comment_id": 89563609, "body": "The solution was incredibly simple. Having forgot that command line arguments are being passed, I didn&#39;t realize that I had to update the sudoers file (the command to execute the app was in there to disable asking for a password - necessary when running a .desktop file with sudo) and append that line with a * to account for the extra command line arguments. Foolish in retrospect."}], "owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531273482, "creation_date": 1531256182, "last_edit_date": 1531273482, "question_id": 51273775, "link": "https://stackoverflow.com/questions/51273775/opening-a-file-associated-with-a-gtk-application-in-c-via-a-double-click-in-u", "title": "Opening a file associated with a GTK+ application (in C) via a double-click in Ubuntu 16.04", "body": "<p>I have a GTK+3 program that I have written and it uses GKeyFile's to store user parameters. There is a default keyfile that is loaded when the application is executed that stores the previously used parameters, but the user has the option to store information at anytime into a GKeyFile with the extension \"*.dc1\" and open these files through the program. I am trying to get the application to fire when a user double-clicks on a file with the extension \"*.dc1\". I have associated the files with an icon, and I have also associated the files with the application by creating a new MIME type. The MIME XML instructions are:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n &lt;mime-info xmlns='http://www.freedesktop.org/standards/shared-mime-info'&gt;\n   &lt;mime-type type=\"application/x-dc1\"&gt;  \n   &lt;comment&gt;DC1 Configuration File&lt;/comment&gt;\n   &lt;glob pattern=\"*.dc1\"/&gt;\n  &lt;/mime-type&gt;\n &lt;/mime-info&gt;\n</code></pre>\n\n<p>An icon in the form of an .svg file was also created. Then the following commands were performed:</p>\n\n<pre><code>sudo cp ccc_dc1.xml /usr/share/mime/packages\nsudo cp application-x-dc1.svg /usr/share/icons/Humanity/mimes\nsudo cp application-x-dc1.svg /usr/share/icons/gnome/scalable/mimetypes\n</code></pre>\n\n<p>The MIME type file was appended by running:</p>\n\n<pre><code>sudo -H gedit /etc/mime.types\n</code></pre>\n\n<p>and adding \"application/x-dc1\". Then the icons are added to the file extension with:</p>\n\n<pre><code>sudo update-mime-database /usr/share/mime\nsudo gtk-update-icon-cache /usr/share/icons/Humanity -f\nsudo gtk-update-icon-cache /usr/share/icons/gnome -f\n</code></pre>\n\n<p>The .desktop file has the form:</p>\n\n<pre><code>[Desktop Entry]\nVersion=1.0\nName=DC1\nComment=GUI\nExec=sudo taskset -c 6 /home/DC1/Codes/./CCC_DC1\nIcon=/home/DC1/SourceFiles/Images/cytoDC1.png\nTerminal=false\nType=Application\nCategories=Utility;Application;\nMimeType=application/x-dc1;\nName[en_US]=DC1\n</code></pre>\n\n<p>And the following commands were performed:</p>\n\n<pre><code>sudo cp DC1.desktop /usr/share/applications\nxdg-mime default DC1.desktop application/x-dc1\n</code></pre>\n\n<p>When this was done, the icon was associated with the file extension, but when I double click a file with that extension the icon appears in the Unity Launcher, blinks a few times, and disappears. My understanding is that when I file is opened via a double click, its absolute path is passed through argc/argv, but despite my Gtk program handling this in two ways:</p>\n\n<ol>\n<li>By handling argv when using gtk_init() in main</li>\n<li>By using the open signal when using GtkApplication</li>\n</ol>\n\n<p>both instances fail when double clicking a file. However, when passing the name of the file on the command line, both methods succeed. This leads me to believe that it is not the application code, but something else that I can't put my finger on. The two Gtk examples are below. The first is using gtk_init: </p>\n\n<pre><code>int main(int argc, char * argv[]) \n{\n  GtkWidget * window;\n\n  // Declare read_data of type data and a pointer;\n  struct data read_data;\n\n  gtk_init( &amp; argc, &amp; argv);\n\n  read_data.builder = gtk_builder_new();\n  read_data.keyfile = g_key_file_new();\n\n  GError * err = NULL;\n  GKeyFileFlags flags = G_KEY_FILE_KEEP_COMMENTS | G_KEY_FILE_KEEP_TRANSLATIONS;\n\n  // Creating a GtkBuilder from a .glade file\n  gtk_builder_add_from_file(read_data.builder, GLADE_FILE, &amp; err);\n\n  if (err != NULL) {\n    fprintf(stderr, \"Unable to read glade file: %s\\n\", err -&gt; message);\n    g_error_free(err);\n\n    return 1;\n  }\n\n  // If the program isn't opened by double clicking a key-file, load the previously used parameters\n  if (argv[1] == NULL) {\n    // Load the GKeyFile from config (.dc1) file\n    g_key_file_load_from_file(read_data.keyfile, \"/home/DC1/SourceFiles/cfg.dc1\", flags, &amp; err);\n\n    if (err != NULL) {\n      fprintf(stderr, \"Unable to read keyfile: %s\\n\", err -&gt; message);\n      g_error_free(err);\n\n      return 1;\n    }\n  }\n  // If the program was opened by double clicking a key-file, load the parameters from that file instead\n  else {\n    // Load the GKeyFile from config (.dc1) file\n    g_key_file_load_from_file(read_data.keyfile, argv[1], flags, &amp; err);\n\n    printf(\"The keyfile being loaded has path: %s\\n\", argv[1]);\n\n    if (err != NULL) {\n      fprintf(stderr, \"Unable to read keyfile: %s\\n\", err -&gt; message);\n      g_error_free(err);\n\n      return 1;\n    }\n  }\n\n....AND SO ON\n}\n</code></pre>\n\n<p>And the second is using GtkApplication:</p>\n\n<pre><code>static void open_callback (GtkApplication *app, gpointer *files, gint n_files, __attribute__((unused)) gchar *hint, \n        __attribute__((unused)) gpointer user_data)\n{\n  GtkWidget *window;\n\n  // Declare read_data of type data and a pointer;\n  struct data read_data;\n\n  read_data.builder = gtk_builder_new();\n  read_data.keyfile = g_key_file_new();\n\n  GError * err = NULL;\n  GKeyFileFlags flags = G_KEY_FILE_KEEP_COMMENTS | G_KEY_FILE_KEEP_TRANSLATIONS;\n\n  // Creating a GtkBuilder from a .glade file\n  gtk_builder_add_from_file(read_data.builder, GLADE_FILE, &amp; err);\n\n  if (err != NULL) {\n    fprintf(stderr, \"Unable to read glade file: %s\\n\", err -&gt; message);\n    g_error_free(err);\n\n    return;\n  }\n\n  gint i;\n\n  // Open the file via the command line arguments (i.e. by clicking a *.dc1 file associated with the software)\n  for (i = 0; i &lt; n_files; i++)\n  {\n    gchar *filepath = g_file_get_path (files[i]);\n\n    // Load the GKeyFile from config (.dc1) file\n    g_key_file_load_from_file (read_data.keyfile, filepath, flags, &amp;err);\n\n    printf(\"The keyfile being loaded has path: %s\\n\", filepath);\n\n    if (err != NULL)\n    {\n      fprintf(stderr, \"Unable to read keyfile: %s\\n\", err-&gt;message);\n      g_error_free(err);\n\n      return;\n    }\n\n    g_free (filepath);\n  }\n\n....AND SO ON\n}\n</code></pre>\n\n<p>If anyone has any suggestions as to what I may be missing here, I would greatly appreciate the help.</p>\n"}, {"tags": ["c++", "c", "gcc", "crosstool-ng"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1531255458, "post_id": 51273557, "comment_id": 89525408, "body": "Known bug: <a href=\"https://github.com/crosstool-ng/crosstool-ng/issues/735\" rel=\"nofollow noreferrer\">github.com/crosstool-ng/crosstool-ng/issues/735</a> You just need to upgrade the tool"}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "is_accepted": true, "score": 2, "last_activity_date": 1531347730, "creation_date": 1531347730, "answer_id": 51294962, "question_id": 51273557, "link": "https://stackoverflow.com/questions/51273557/error-compiling-gcc-with-crosstool-ng/51294962#51294962", "title": "Error compiling gcc with crosstool-ng", "body": "<p>Cloning from github instead of using the latest release solved the problem.</p>\n"}], "owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 0, "accepted_answer_id": 51294962, "answer_count": 1, "score": 1, "last_activity_date": 1531347730, "creation_date": 1531255160, "question_id": 51273557, "link": "https://stackoverflow.com/questions/51273557/error-compiling-gcc-with-crosstool-ng", "title": "Error compiling gcc with crosstool-ng", "body": "<p>Does somebody can help me solve this error? I was trying build arm-unknown-linux-gnueabi using ct-ng (version 1.23.0).</p>\n\n<pre><code>[ERROR]    /home/tomas/crosstool-ng-1.23.0/.build/src/gcc-6.3.0/gcc/ubsan.c:1474:23: error: ISO C++ forbids comparison between pointer and integer [-fpermissive]\n[ERROR]    make[3]: *** [ubsan.o] Error 1\n[ERROR]    make[3]: *** Waiting for unfinished jobs....\n[ERROR]    make[2]: *** [all-gcc] Error 2\n[ERROR]   \n[ERROR]  &gt;&gt;\n[ERROR]  &gt;&gt;  Build failed in step 'Installing pass-1 core C gcc compiler'\n[ERROR]  &gt;&gt;        called in step '(top-level)'\n[ERROR]  &gt;&gt;\n[ERROR]  &gt;&gt;  Error happened in: CT_DoExecLog[scripts/functions@338]\n[ERROR]  &gt;&gt;        called from: do_gcc_core_backend[scripts/build/cc/100-gcc.sh@674]\n[ERROR]  &gt;&gt;        called from: do_gcc_core_pass_1[scripts/build/cc/100-gcc.sh@227]\n[ERROR]  &gt;&gt;        called from: do_cc_core_pass_1[scripts/build/cc.sh@35]\n[ERROR]  &gt;&gt;        called from: main[scripts/crosstool-NG.sh@653]\n[ERROR]  &gt;&gt;\n[ERROR]  &gt;&gt;  For more info on this error, look at the file: 'build.log'\n[ERROR]  &gt;&gt;  There is a list of known issues, some with workarounds, in:\n[ERROR]  &gt;&gt;      'docs/B - Known issues.txt'\n[ERROR]  &gt;&gt;\n[ERROR]  &gt;&gt;  If you feel this is a bug in crosstool-NG, report it at:\n[ERROR]  &gt;&gt;      https://github.com/crosstool-ng/crosstool-ng/issues/\n[ERROR]  &gt;&gt;\n[ERROR]  &gt;&gt;  Make sure your report includes all the information pertinent to this issue.\n[ERROR]  &gt;&gt;  Read the bug reporting guidelines here:\n[ERROR]  &gt;&gt;      http://crosstool-ng.github.io/support/\n[ERROR]   \n[ERROR]  (elapsed: 23:56.63)\n[23:57] / /home/tomas/crosstool-ng-1.23.0/ct-ng:147: recipe for target 'build' failed\nmake[1]: *** [build] Error 2\nct-ng:150: recipe for target 'build.3' failed\nmake: *** [build.3] Error 2\n</code></pre>\n\n<p>I am not sure if it's a gcc source code issue or if there is some configuration I can change in ct-ng to ignore this error.</p>\n\n<pre><code>[ERROR]    /home/tomas/crosstool-ng-1.23.0/.build/src/gcc-6.3.0/gcc/ubsan.c:1474:23: error: ISO C++ forbids comparison between pointer and integer [-fpermissive]\n[ALL  ]           || xloc.file == '0' || xloc.file[0] == 'xff'\n[ALL  ]                           ^~~~\n[ALL  ]    Makefile:1085: recipe for target 'ubsan.o' failed\n[ERROR]    make[3]: *** [ubsan.o] Error 1\n</code></pre>\n\n<p>Apparently that's the error right there.</p>\n"}, {"tags": ["c", "struct", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 5, "creation_date": 1531254850, "post_id": 51273477, "comment_id": 89525142, "body": "<code>makeNode</code> should set <code>node-&gt;next = NULL</code> also initialize <code>stack_head</code> to <code>NULL</code> in your main."}, {"owner": {"reputation": 3817, "user_id": 2082884, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8c1a7c51faf6f8622ecdbb8b638d3550?s=128&d=identicon&r=PG", "display_name": "hetepeperfan", "link": "https://stackoverflow.com/users/2082884/hetepeperfan"}, "edited": false, "score": 2, "creation_date": 1531255146, "post_id": 51273477, "comment_id": 89525274, "body": "Your use of scanf is quite unsafe. For a short discussion see this thread for example: <a href=\"https://stackoverflow.com/questions/1621394/how-to-prevent-scanf-causing-a-buffer-overflow-in-c\" title=\"how to prevent scanf causing a buffer overflow in c\">stackoverflow.com/questions/1621394/&hellip;</a>"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1531256697, "post_id": 51273477, "comment_id": 89525918, "body": "C has <code>isdigit</code> so you don&#39;t need to write <code>isNumericChar</code>. You already have the necessary header that defines it."}, {"owner": {"reputation": 37, "user_id": 5093061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/909ee5c0055d361dd8ee39323c559cc9?s=128&d=identicon&r=PG&f=1", "display_name": "ender554", "link": "https://stackoverflow.com/users/5093061/ender554"}, "edited": false, "score": 0, "creation_date": 1531282495, "post_id": 51273477, "comment_id": 89531903, "body": "Thanks all! just needed to initialize it in main.  As far as scanf I know it is unsafe, unfortunately it was part of the requirement for this assignment."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531320461, "post_id": 51273477, "comment_id": 89554702, "body": "regarding: <code>break;             return 0;</code>  in function: <code>myAtoi()</code>, the &#39;return&#39; statement will never be executed because the &#39;break&#39; exits the &#39;for()&#39; loop so instead the statement: <code>return sign*res;</code> will be executed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531320703, "post_id": 51273477, "comment_id": 89554883, "body": "OT: when calling any of the heap allocation functions: <code>malloc</code> <code>calloc</code> <code>realloc</code>: 1) the returned type is <code>void*</code> which can be assigned to any other pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  2) always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531320840, "post_id": 51273477, "comment_id": 89554980, "body": "OT: for ease of readability and understanding: 1) separate code blocks: <code>for</code> <code>if</code> <code>else</code> <code>while</code> <code>do...while</code> <code>switch</code> <code>case</code> <code>default</code> via a single blank line."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531321014, "post_id": 51273477, "comment_id": 89555099, "body": "regarding: <code>while(EOF != scanf(&quot;%s&quot;, input )) {</code>  there are other reasons a call to <code>scanf()</code> can fail besides EOF.  strongly suggest (in this case) to use: <code>while( 1 == scanf(&quot;%s&quot;, input )) {</code>  Also, when using the &#39;%s&#39; and/or &#39;%[...]&#39; input format specifiers, always include a MAX CHARACTERS modifier that is one less than the length of the input buffer to avoid any chance of a buffer overflow (and the attendant undefined behavior)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531321145, "post_id": 51273477, "comment_id": 89555190, "body": "the posted code contains some &#39;magic&#39; numbers.  &#39;magic&#39; numbers are numbers with no basis.  I.E. 10.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, etc.  Suggest giving those &#39;magic&#39; numbers meaningful names via a <code>enum</code> statement or <code>#define</code> statement, then using those meaningful names throughout the code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531321451, "post_id": 51273477, "comment_id": 89555394, "body": "the posted code contains a major memory leak.  This is because many memory allocations (via call to malloc()` ) were made, but the resulting memory was never returned to the heap (via calls to <code>free()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531321681, "post_id": 51273477, "comment_id": 89555543, "body": "regarding: `    while( stack_head != NULL )      {         num = stack_head-&gt;number;         printf(&quot;%d\\n&quot;, num );         stack_head = stack_head-&gt;next;     }`  This destroys the pointer to the head of the linked list,  This results in two problems.  1) the list cannot ever be referenced again 2) the pointer cannot be used to initiate passing the memory back to the heap."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531321894, "post_id": 51273477, "comment_id": 89555690, "body": "it is a poor programming practice to <code>#include</code> header files those contents are not being used.  Suggest removing: <code>#include &lt;ctype.h&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5093061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/909ee5c0055d361dd8ee39323c559cc9?s=128&d=identicon&r=PG&f=1", "display_name": "ender554", "link": "https://stackoverflow.com/users/5093061/ender554"}, "edited": false, "score": 0, "creation_date": 1531282462, "post_id": 51273669, "comment_id": 89531898, "body": "Thank you so much! I knew it was something silly like that"}, {"owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "reply_to_user": {"reputation": 37, "user_id": 5093061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/909ee5c0055d361dd8ee39323c559cc9?s=128&d=identicon&r=PG&f=1", "display_name": "ender554", "link": "https://stackoverflow.com/users/5093061/ender554"}, "edited": false, "score": 0, "creation_date": 1531316855, "post_id": 51273669, "comment_id": 89551810, "body": "Not that it is relevant to the original question, but the way you iterate through the stack at the end leaks memory."}], "tags": [], "owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "is_accepted": true, "score": 4, "last_activity_date": 1531255694, "creation_date": 1531255694, "answer_id": 51273669, "question_id": 51273477, "link": "https://stackoverflow.com/questions/51273477/c-programming-link-list-segmentation-fault/51273669#51273669", "title": "c programming link list segmentation fault", "body": "<p>Try initializing <code>stack_head</code> to <code>NULL</code>. Local variables are not guaranteed to be initialized, so your <code>stack_head == NULL</code> check may fail.</p>\n"}], "owner": {"reputation": 37, "user_id": 5093061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/909ee5c0055d361dd8ee39323c559cc9?s=128&d=identicon&r=PG&f=1", "display_name": "ender554", "link": "https://stackoverflow.com/users/5093061/ender554"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 51273669, "answer_count": 1, "score": 0, "last_activity_date": 1531255694, "creation_date": 1531254705, "question_id": 51273477, "link": "https://stackoverflow.com/questions/51273477/c-programming-link-list-segmentation-fault", "title": "c programming link list segmentation fault", "body": "<p>for some reason my code works fin on my system running ubuntu 16.04 but when I run it on my schools computer (also running Ubuntu 16.04) I get a segmentation fault. The line when I run debugger claims it is coming from the print loop at the end which makes no sense as a int should not trigger a segmentation fault. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;ctype.h&gt;\n\nint RETURN = 0; //return value to change if error found\n\n// check if entered value is a number\nbool isNumericChar(char x)\n{\n    return (x &gt;= '0' &amp;&amp; x &lt;= '9')? true: false;\n}\n\n// Recreated atoi to check for non ints\nint myAtoi(char *str)\n{\n  if (*str == '\\0'){\n    return 0;\n  }\n\n  int res = 0; \n  int sign = 1;\n  int i = 0;  \n\n  // If number is negative, then update sign\n  if (str[0] == '-'){\n    sign = -1;\n    i++;  \n  }\n\n  // Iterate through all digits of input string and update result\n  for (; str[i] != '\\0'; ++i){\n    if (isNumericChar(str[i]) == false){\n      RETURN = 1;\n      fprintf(stderr, \"must be integer\\n\");\n      break;\n      return 0;\n    }\n    res = res*10 + str[i] - '0';\n  }\n\n    // Return result with sign\n  return sign*res;\n}\n\n// this is main struct of a node of the linked list\nstruct LL {\n  int number;\n  struct LL *next;\n};\n\n// this function allocates memory for a node and returns the\n// allcoated node item\nstruct LL *makeNode(int num) {\n  struct LL *node = (struct LL *) malloc( sizeof(struct LL) );\n  node-&gt;number = num;\n  return node;\n}\n\nint main() {\n  char input[10];   \n  struct LL * stack_head; \n  bool wasPush = false; \n  int num = 0; \n  while(EOF != scanf(\"%s\", input )) {\n    if( 0 == strcmp(input, \"push\") ) {   // if the word is push, then next item may be a number\n      wasPush = true;\n    } \n    else if( 0 == strcmp( input, \"pop\" ) ) { \n      wasPush = false; \n      if( stack_head != NULL ) {\n        stack_head = stack_head-&gt;next;   \n      }\n    } \n    else{\n      // probably a number\n      if( !wasPush ){\n        continue;   // and last word was a push\n      }\n      int number = myAtoi(input);   //convert this to a number\n\n      if( stack_head == NULL ) {   //an empty linked list then this is the first node\n        stack_head = makeNode(number);\n        stack_head-&gt;next = NULL;\n      }\n      else{   // list and can have a next item in it\n        struct LL * prev_head = stack_head;\n        stack_head = makeNode(number);\n        stack_head-&gt;next = prev_head;\n      }\n      wasPush = false;\n    }\n  }\n\n  // we print the items on the stack now by iterating\n  // from the top to the bottom of the stack\n  while( stack_head != NULL ) {\n    num = stack_head-&gt;number;\n    printf(\"%d\\n\", num );\n    stack_head = stack_head-&gt;next;\n  }\n  return RETURN;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1531251886, "post_id": 51272912, "comment_id": 89523936, "body": "&quot;No error&quot; does not always mean &quot;works as expected&quot;. You may not have all of the compiler warnings turned on that will alert you to potential pitfalls."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 1, "creation_date": 1531251963, "post_id": 51272912, "comment_id": 89523962, "body": "When a compiler does not give an error, that means the syntax is correct. It does not give you any hint about the programming logic (in most cases). Tipp: Enable all warnings (for gcc, add <code>-Wall</code> to your Makefile or compilation command)."}, {"owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 1, "creation_date": 1531251997, "post_id": 51272912, "comment_id": 89523977, "body": "But it worked on online compilers as well."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1531252031, "post_id": 51272912, "comment_id": 89523992, "body": "Does &quot;work&quot; mean &quot;does what I want&quot; or &quot;does something&quot;?"}, {"owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 1, "creation_date": 1531252069, "post_id": 51272912, "comment_id": 89524005, "body": "it dispalyed what i want.."}], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "edited": false, "score": 0, "creation_date": 1531252448, "post_id": 51272955, "comment_id": 89524158, "body": "Okk @dbush ,this is declaration of a pointer but single pointer should accept address of one dimensional array rather than it&#39;s accepting address of two dimensional array.How?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1531251973, "creation_date": 1531251973, "answer_id": 51272955, "question_id": 51272912, "link": "https://stackoverflow.com/questions/51272912/array-declaration-with-assigning-address/51272955#51272955", "title": "Array declaration with assigning address", "body": "<p>In your second example, <code>ptr</code> is not an array but a <strong>pointer to an array</strong>.  </p>\n\n<p>This pointer is initialized with <code>a</code> which is an array that, in this context, <em>decays</em> to a pointer to its first element.  The type of <code>a</code> is <code>int [6][3]</code>, i.e. an array of size 6, where each element is an array of type <code>int [3]</code>.  So a pointer to an element of <code>a</code> has type <code>int (*)[3]</code>, which matches the type of <code>ptr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1531257829, "last_edit_date": 1531257829, "creation_date": 1531256534, "answer_id": 51273846, "question_id": 51272912, "link": "https://stackoverflow.com/questions/51272912/array-declaration-with-assigning-address/51273846#51273846", "title": "Array declaration with assigning address", "body": "<p>Your teacher is correct - an array expression may not be the target of an assignment.  However, what's happening in </p>\n\n<pre><code>int b[2] = a;\n</code></pre>\n\n<p>is that an initializer for an array in a declaration <em>must</em> be a brace-delimited sequence of values.  The expression <code>a</code> is not a brace-delimited sequence, hence the error.  </p>\n\n<p>What your teacher is talking about is situations like</p>\n\n<pre><code>int b[N];\n...\nb = some_expression;\n</code></pre>\n\n<p>This is not allowed - you cannot assign to an <em>array</em> using the <code>=</code> operator.    </p>\n\n<p>You can assign to individual array elements (as long as those elements are not arrays themselves):</p>\n\n<pre><code>b[i] = some_value;\nb[j] = a[i];\n</code></pre>\n\n<p>Except when it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is a string literal used to initialize a character array in a declaration, an <em>expression</em> of type \"N-element array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\" and the value of the expression will be the address of the first element of the array.</p>\n\n<p>The declaration</p>\n\n<pre><code>int a[][3] = {1, 2, 3, 4, 5, 6};\n</code></pre>\n\n<p>creates a 2-element array of 3-element arrays of <code>int</code>.  Graphically:</p>\n\n<pre><code>   +---+\na: | 1 | a[0][0]\n   +---+\n   | 2 | a[0][1]\n   +---+\n   | 3 | a[0][2]\n   +---+\n   | 4 | a[1][0]\n   +---+\n   | 5 | a[1][1]\n   +---+\n   | 6 | a[1][2]\n   +---+\n</code></pre>\n\n<p>Thus, when the <em>expression</em> <code>a</code> appears in the line</p>\n\n<pre><code>int (*ptr)[3] = a;\n</code></pre>\n\n<p>it is converted from type \"2-element array of 3-element array of <code>int</code>\" to \"pointer to 3-element array of <code>int</code>\", or <code>int (*)[3]</code>, and the value of the expression is the address of <code>a[0][0]</code>.  Since you declare <code>ptr</code> as a pointer to a 3-element array of <code>int</code>, the initialization works, and <code>ptr</code> points to the first element of the array (<code>a[0]</code>):</p>\n\n<pre><code>   +---+\na: | 1 | a[0][0] &lt;--- ptr\n   +---+\n   | 2 | a[0][1]\n   +---+\n   | 3 | a[0][2]\n   +---+\n   | 4 | a[1][0]\n   +---+\n   | 5 | a[1][1]\n   +---+\n   | 6 | a[1][2]\n   +---+\n</code></pre>\n\n<p>Since <code>ptr</code> points to a 3-element array of <code>int</code>, <code>ptr+1</code> will point to the <em>next</em> 3-element array of <code>int</code> (<code>a[1]</code>):</p>\n\n<pre><code>   +---+\na: | 1 | a[0][0] &lt;--- ptr\n   +---+\n   | 2 | a[0][1]\n   +---+\n   | 3 | a[0][2]\n   +---+\n   | 4 | a[1][0] &lt;--- ptr + 1\n   +---+\n   | 5 | a[1][1]\n   +---+\n   | 6 | a[1][2]\n   +---+\n</code></pre>\n\n<p>Edit:</p>\n\n<p>A handy chart for declarations involving arrays, functions, and pointers:</p>\n\n<pre><code>T *a[N];   // a is an array of pointers to T\nT (*a)[N]; // a is a pointer to an array of T\nT *f();    // f is a function returning a pointer to T\nT (*f)();  // f is a pointer to a function returning T\n</code></pre>\n\n<p>Things can get even more complicated:</p>\n\n<pre><code>T (*f[N])(); // f is an array of pointers to functions returning T\nT (*a())[N]; // a is a function returning a pointer to an array of T\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 9849018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMQ9cua2IMk/AAAAAAAAAAI/AAAAAAAADY4/CvtkcOYdVls/photo.jpg?sz=128", "display_name": "Shivanshu", "link": "https://stackoverflow.com/users/9849018/shivanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "accepted_answer_id": 51272955, "answer_count": 2, "score": 3, "last_activity_date": 1531257829, "creation_date": 1531251732, "last_edit_date": 1531251828, "question_id": 51272912, "link": "https://stackoverflow.com/questions/51272912/array-declaration-with-assigning-address", "title": "Array declaration with assigning address", "body": "<p>As my teacher told me ,array declaration can't accept address as an assignment.</p>\n\n<pre><code>int a[]={1,2};\nint b[2]=a;\n</code></pre>\n\n<p>This shows an error as invalid initializer.\nBut i was playing with such things and found \n weird example as following.</p>\n\n<pre><code>int a[][3] = {1, 2, 3, 4, 5, 6};\nint (*ptr)[3] = a;\n</code></pre>\n\n<p>This is also a declaration of an array whose address is kept with ptr pointer and this accept the address of 2 Dimensional array a,but this shows no error.\nWhy,can somebody explain me in simple words? thanks in advance.</p>\n"}, {"tags": ["c", "enums", "header-files"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1531246960, "post_id": 51271714, "comment_id": 89521794, "body": "You don&#39;t compile .h files, only .c files."}, {"owner": {"reputation": 57, "user_id": 10037835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59684994594e5e9cf2a483c3bd271f93?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas M", "link": "https://stackoverflow.com/users/10037835/thomas-m"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1531247255, "post_id": 51271714, "comment_id": 89521918, "body": "It still gives the same error when i dont compile with .h:        $ gcc -std=c99 main.c invoc.c -o main"}, {"owner": {"reputation": 4187, "user_id": 1718477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iisrz.jpg?s=128&g=1", "display_name": "rkersh", "link": "https://stackoverflow.com/users/1718477/rkersh"}, "edited": false, "score": 7, "creation_date": 1531247357, "post_id": 51271714, "comment_id": 89521967, "body": "In <code>invoc.h</code> you are defining <code>INVOC_H</code> before the <code>#ifndef INVOC_H</code> block. That is, it will never see the stuff inside the block."}, {"owner": {"reputation": 57, "user_id": 10037835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59684994594e5e9cf2a483c3bd271f93?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas M", "link": "https://stackoverflow.com/users/10037835/thomas-m"}, "edited": false, "score": 0, "creation_date": 1531247863, "post_id": 51271714, "comment_id": 89522185, "body": "D&#39;oh, completely missed that. Thank you."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531270114, "post_id": 51271714, "comment_id": 89529326, "body": "regarding: <code>void func1(alg_t myalg) {     myalg = NRU;</code>   the assignment to <code>myalg</code> will only modify the local parameter (typically on the stack)  BTW: the function <code>funct1()</code> is never invoked."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1531270178, "post_id": 51271714, "comment_id": 89529336, "body": "regarding: <code>extern alg_t pr_alg;</code>  there is no instance of the enum <code>pr_alg</code> anywhere in the posted code."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1531247838, "post_id": 51271961, "comment_id": 89522176, "body": "I am pretty certain OP doesn&#39;t want a global variable."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 12, "last_activity_date": 1555476400, "last_edit_date": 1555476400, "creation_date": 1531247374, "answer_id": 51271961, "question_id": 51271714, "link": "https://stackoverflow.com/questions/51271714/enumerations-in-c-head-files-shared-across-multiple-files/51271961#51271961", "title": "Enumerations in C head files shared across multiple files", "body": "<ol>\n<li><p>You have an error in your <code>invoc.h</code> file:</p>\n\n<pre><code>#define INVOC_H\n#ifndef INVOC_H\n...\n#endif\n</code></pre>\n\n<p>You first define a macro <code>INVOC_H</code>, then check if it does not exists (it does), so the code inside is removed by the preprocessor and not parsed by the compiler.<br>\nIt should be:</p>\n\n<pre><code>#ifndef INVOC_H\n#define INVOC_H\n...\n#endif\n</code></pre>\n\n<p>After this change your code will work fine.</p></li>\n<li><p>You don't compile <code>.h</code> files, only <code>.c</code> files.  That's why we put all definitions in <code>.c</code> files, and only declarations in <code>.h</code> files. To compile, just do:</p>\n\n<pre><code>gcc -std=c99 mmu.c invoc.c\n</code></pre></li>\n<li><p>You declare <code>pr_alg</code> in <code>main()</code> as <code>extern</code> variable. If the line you provided is the whole compilation line, the compile will issue linker error as variable <code>pr_alg</code> is nowhere defined. Remove <code>extern</code> or define variable <code>pr_alg</code> with global storage duration in one of the <code>.c</code> files.</p></li>\n</ol>\n"}], "owner": {"reputation": 57, "user_id": 10037835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59684994594e5e9cf2a483c3bd271f93?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas M", "link": "https://stackoverflow.com/users/10037835/thomas-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555476400, "creation_date": 1531246354, "last_edit_date": 1531247223, "question_id": 51271714, "link": "https://stackoverflow.com/questions/51271714/enumerations-in-c-head-files-shared-across-multiple-files", "title": "Enumerations in C head files shared across multiple files", "body": "<p>I want to define an enumeration type ONCE and have that type be shared across all the other files when I include the file, however I keep getting the following errors:</p>\n\n<pre><code>$ gcc -std=c99 main.c invoc.h invoc.c\nmain.c: In function \u2018main\u2019:\nmain.c:12: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018pr_alg\u2019\nmain.c:12: error: \u2018pr_alg\u2019 undeclared (first use in this function)\nmain.c:12: error: (Each undeclared identifier is reported only once\nmain.c:12: error: for each function it appears in.)\nmain.c:13: error: \u2018FIFO\u2019 undeclared (first use in this function)\ninvoc.c:7: error: expected \u2018)\u2019 before \u2018myalg\u2019\n</code></pre>\n\n<p>The code is as follows:</p>\n\n<p><code>invoc.h</code>:</p>\n\n<pre><code>#define INVOC_H\n#ifndef INVOC_H\n\ntypedef enum {FIFO, SECOND_CHANCE, RANDOM, NRU, CLOCK, AGING} alg_t;\n\nvoid func1(alg_t myalg);\n\n#endif\n</code></pre>\n\n<p><code>invoc.c</code>:</p>\n\n<pre><code>#include \"invoc.h\"\n\nvoid func1(alg_t myalg) {\n    myalg = NRU;\n}\n</code></pre>\n\n<p><code>main.c</code>:</p>\n\n<pre><code>#include \"invoc.h\"\n\nint main(int argc, char **argv) {\n\n    extern alg_t pr_alg;\n    pr_alg = FIFO;\n    printf(\"PR_ALG: %d\\n\", pr_alg);\n\n    return 0;\n}\n</code></pre>\n\n<p>Is there any way that I can define an enumeration in a .h file, and include it in all other files so that I can both create different variables of that type and pass it to functions?</p>\n"}, {"tags": ["c", "gcc", "stanford-nlp"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1531246127, "post_id": 51271557, "comment_id": 89521402, "body": "Are you interested in building the entire project or simply trying to compile <code>glove.c</code> to object code?"}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1531246184, "post_id": 51271557, "comment_id": 89521435, "body": "@yano Thanks for replying. Simply compile the glove.c code!"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1531246282, "post_id": 51271557, "comment_id": 89521471, "body": "<code>check_nan</code> is a local function with the <code>inline</code> specifier.  Try removing <code>inline</code>."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1531246289, "post_id": 51271557, "comment_id": 89521475, "body": "@yano I&#39;ve fixed other undefined errors by adding &quot;-pthread&quot; and &quot;-lm&quot; flags."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531246376, "post_id": 51271557, "comment_id": 89521520, "body": "@dbush how do I remove inline? (Sorry C newbie here!)"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1531246392, "post_id": 51271557, "comment_id": 89521529, "body": "in that case you don&#39;t need to invoke the linker at all, try something like <code>gcc -c glove.c -o glove.out</code>, although typically your object files end in <code>.o</code>. <code>-c</code> option says don&#39;t run the linker, so it won&#39;t try to find/link the <code>check_nan</code> function. Also no need link in the math library."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1531246464, "post_id": 51271557, "comment_id": 89521563, "body": "@Aaron Remove the keyword <code>inline</code> from the source line where <code>check_nan</code> is defined."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1531246506, "post_id": 51271557, "comment_id": 89521579, "body": "@yano This solved the issue! Please add it on the answer. I&#39;ll select it! Thanks a lot!"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531246911, "post_id": 51271557, "comment_id": 89521774, "body": "@Aaron What yano suggested doesn&#39;t actually give you a runnable program.  It just gives you an object file that you still need to link later."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531246942, "post_id": 51271557, "comment_id": 89521788, "body": "@dbush Yes, I just found out that..."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531246994, "post_id": 51271557, "comment_id": 89521812, "body": "@dbush but I aslo don&#39;t think I can remove &quot;check_nan&quot; part because I have to check nan."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531247097, "post_id": 51271557, "comment_id": 89521854, "body": "@Aaron I didn&#39;t say to remove the function.  Just to remove the <code>inline</code> specifier from the definition."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1531247146, "post_id": 51271557, "comment_id": 89521877, "body": "@Aaron Also, what version of gcc are you using?  It compiled fine for me with no changes."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531247191, "post_id": 51271557, "comment_id": 89521890, "body": "@dbush gcc (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1531247296, "post_id": 51271557, "comment_id": 89521935, "body": "@Aaron Well, that&#39;s why I asked my first question. Simply compiling <code>glove.c</code> (what you said you wanted to do) will produce executable code, but not runnable code. If you want to build the entire executable project, you&#39;re welcome to go through and compile each source file individually, then link them all together with the appropriate libraries (<code>check_nan</code> is in the math library?), but that will take forever and be error prone. Use the project makefile instead."}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531247576, "post_id": 51271557, "comment_id": 89522059, "body": "@dbush can you let me know the gcc version that you are using?"}, {"owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1531248056, "post_id": 51271557, "comment_id": 89522263, "body": "@yano still thanks for the help!!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1531319772, "post_id": 51271557, "comment_id": 89554171, "body": "When compiling, always enable the warnings;  I compiled it with: <code>gcc -Wall -Wextra -Wconversion -pedantic -std=gnu11  -ggdb -c &quot;glove.c&quot;</code>  This had no problems with the &#39;inline&#39; function: <code>check_nan()</code>.  However, the compiler output 16 messages about implicit conversions.  Warnings should be fixed, not ignored"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1531247613, "creation_date": 1531247613, "answer_id": 51272005, "question_id": 51271557, "link": "https://stackoverflow.com/questions/51271557/undefined-reference-to-check-nan/51272005#51272005", "title": "undefined reference to &#39;check_nan&#39;", "body": "<p>If you look in the makefile for the full project, you'll see that some options are being passed that you aren't including:</p>\n\n<pre><code>CFLAGS = -lm -pthread -Ofast -march=native -funroll-loops -Wall -Wextra -Wpedantic\n...\nglove : $(SRCDIR)/glove.c\n    $(CC) $(SRCDIR)/glove.c -o $(BUILDDIR)/glove $(CFLAGS)\n</code></pre>\n\n<p>The flag in pariticular you're missing is <code>-Ofast</code>.  Add that and it should compile fine.</p>\n\n<p>Alternately, just run <code>make</code> from the top level directory to build everything.</p>\n"}], "owner": {"reputation": 12740, "user_id": 3907250, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/RIhjj.jpg?s=128&g=1", "display_name": "Aerin", "link": "https://stackoverflow.com/users/3907250/aerin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 51272005, "answer_count": 1, "score": 1, "last_activity_date": 1552927334, "creation_date": 1531245665, "question_id": 51271557, "link": "https://stackoverflow.com/questions/51271557/undefined-reference-to-check-nan", "title": "undefined reference to &#39;check_nan&#39;", "body": "<p>I'm trying to compile the file (<code>glove.c</code> from Stanford NLP <a href=\"https://github.com/stanfordnlp/GloVe/blob/master/src/glove.c\" rel=\"nofollow noreferrer\">https://github.com/stanfordnlp/GloVe/blob/master/src/glove.c</a>) but I'm getting an undefined reference error.</p>\n\n<pre><code>aerin@capa:~/Desktop/GloVe/src$ gcc -pthread  glove.c -o glove.out -lm\n\n/tmp/ccZMsGyg.o: In function `glove_thread':\nglove.c:(.text+0x9d7): undefined reference to `check_nan'\nglove.c:(.text+0xa6a): undefined reference to `check_nan'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I can't find the answer about \"check_nan\" on google.  What flag should I use to compile this file? Any tip will greatly help!</p>\n"}, {"tags": ["c", "hadoop", "shared-libraries", "static-libraries", "apache-zookeeper"], "comments": [{"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531248700, "post_id": 51271388, "comment_id": 89522540, "body": "But <code>gcc -Wall main.c -o test &#47;workspace&#47;zookeeper&#47;lib&#47;libzookeeper_mt.a -std=c99</code> works?"}, {"owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531248787, "post_id": 51271388, "comment_id": 89522581, "body": "no it doesn&#39;t same error is given. Sorry i didn&#39;t notice -o main was there instead of -o test"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531249285, "post_id": 51271388, "comment_id": 89522827, "body": "Have you build the library with <code>ar cru libzookeeper_mt.a all.o object.o files.o that.o belong.o in.o libzoo.o</code> followed by a <code>ranlib libzookeeper_mt.a</code>?"}, {"owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531249769, "post_id": 51271388, "comment_id": 89523018, "body": "I can unarchive the files on my Mac from the libzookeeper_mt.a to give me all the .o files that belong to libzookeeper_mt.a . Should I send those files over to my secondary device and ranlib them together into libzookeeper_mt.a? (There is also a __.SYMDEF SORTED file.. will that go into ranlib? i&#39;ll try it anyways)"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531250647, "post_id": 51271388, "comment_id": 89523374, "body": "It might be that the sytem on your second device is slightly different, so it is an idea to move all <code>*.o</code> to that system, and run the two commands I listed above there."}, {"owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531251073, "post_id": 51271388, "comment_id": 89523606, "body": "After running ar cru libzookeeper_mt.a hashtable.o hashtable_itr.o . . . (and the rest of .o files) and then running ranlib libzookeeper_mt.a. I tried navigating back to my main.c and running the gcc and got the same error. I&#39;ll try deleting the libzookeeper_mt.a and trying the ranlib after deleting it."}, {"owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531253725, "post_id": 51271388, "comment_id": 89524677, "body": "Sadly deleting libzookeeper_mt.a and replacing it with a fresh copy of it and then running the ar cru libzookeeper_mt.a &lt;all .o files&gt;  and then running ranlib libzookeeper_mt.a did not work."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531255566, "post_id": 51271388, "comment_id": 89525458, "body": "I peeked into the building of <code>libzookeeper_mt.a</code> (version 3.4.12) and it is a bit more complicated than that although not much. The simplest way is probably to install it to your second device from the original build-directory. Go to <code>zookeeper-3.4.12&#47;src&#47;c&#47;</code> (adjust version-number) and do a <code>make distclean &amp;&amp; .&#47;configure --prefix=&#47;workspace&#47;zookeeper&#47; --libdir=&#47;workspace&#47;zookeeper&#47;lib &amp;&amp; make install;</code> It should make both, the static and the dynamic library, you can switch one off with <code>.&#47;configure</code> with <code>--disable-static</code> or <code>--disable-shared</code> respectively."}, {"owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531257012, "post_id": 51271388, "comment_id": 89526050, "body": "The make install brings a whole other issue I posted in one of my other posts, but slightly different error msg.  &#39;mt.so -lnsl -lsocket -lm -lpthread -R/workspace/kunalp/zookeeper/lib Undefined                       first referenced  symbol                           in file __sync_fetch_and_add      ./.libs/libzookeeper_mt.so ld: fatal: symbol referencing errors. No output written to .libs/cli_mt collect2: ld returned 1 exit status *** Error code 1 make: Fatal error: Command failed for target `cli_mt&#39; &#39;  This the error I was trying to avoid by moving all files and including library."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 1, "creation_date": 1531258229, "post_id": 51271388, "comment_id": 89526516, "body": "If you base your question on another post: please put a link to it."}, {"owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531258516, "post_id": 51271388, "comment_id": 89526628, "body": "link is hyperlinked to where I mentioned it on my question. I will remember to do so next time. Here it is in the comments for convenience:   <a href=\"https://stackoverflow.com/questions/51255329/zookeeper-c-binding-installation?noredirect=1#comment89490736_51255329\" title=\"zookeeper c binding installation\">stackoverflow.com/questions/51255329/&hellip;</a>"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 1, "creation_date": 1531260414, "post_id": 51271388, "comment_id": 89527291, "body": "Link is to the comment &#39;Are you actually running &quot;i386-pc-solaris2.11&quot;?&#39; so I assume the client needs to run under Solaris. According to <a href=\"https://zookeeper.apache.org/doc/r3.4.12/zookeeperAdmin.html#sc_supportedPlatforms\" rel=\"nofollow noreferrer\">zookeeper.apache.org/doc/r3.4.12/&hellip;</a> the client is not supported for Solaris."}, {"owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1531260727, "post_id": 51271388, "comment_id": 89527373, "body": "@deamentiaemundi That is probably the issue.. I hope not. Then again I am running it fine on Mac so the C client is working. I am not using multiple servers nor am I trying to connect to an ensemble."}], "owner": {"reputation": 13, "user_id": 10012341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c38c4b6d2c6dc6f8b217daeb08e871?s=128&d=identicon&r=PG&f=1", "display_name": "kpandey1337", "link": "https://stackoverflow.com/users/10012341/kpandey1337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531258474, "creation_date": 1531244945, "last_edit_date": 1531258474, "question_id": 51271388, "link": "https://stackoverflow.com/questions/51271388/zookeeper-c-library-issue", "title": "ZooKeeper C Library issue", "body": "<p>I previously made a <a href=\"https://stackoverflow.com/questions/51255329/zookeeper-c-binding-installation?noredirect=1#comment89490736_51255329\">post asking on the installation of zookeeper</a>. I decided to just send the library files and zookeeper source files along with my code to the second device in hopes to compile it with gcc.</p>\n\n<p>After creating a directory for the user/local/lib files such as libzookeeper_mt.a and the rest. I also created a directory for my code where I would just link the zookeeper library upon compilation. Navigating to the directory in which my code was saved, I typed this into the command line:</p>\n\n<pre><code>gcc -Wall main.c -o test -L/workspace/zookeeper/lib -lzookeeper_mt -std=c99\n</code></pre>\n\n<p>This should link my code to the zookeeper libraries as it works on my local computer, but not on the computer I sent the files to. Here is the error I am getting:</p>\n\n<pre><code>-bash-4.0$ gcc -Wall  main.c -o test  -L/workspace/zookeeper/lib \n-lzookeeper_mt -std=c99  \nIn file included from main.c:3:\nzookeeper.h:309: warning: declaration does not declare anything\nld: warning: file /workspace/zookeeper/lib/libzookeeper_mt.a \nignored: unable to locate archive symbol table\nld: fatal: library -lzookeeper_mt: not found\nld: fatal: file processing errors. No output written to test\ncollect2: ld returned 1 exit status\n</code></pre>\n\n<p>Why is the library being ignored? I tried researching it and I was told to ranlib the library. I tried indexing all the zookeeper _st and _mt files to the libzookeeper_mt.a and it didn't work.</p>\n"}, {"tags": ["c", "command-line", "minifilter"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1531253933, "post_id": 51271308, "comment_id": 89524757, "body": "What filesystem is on drive C?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531272762, "post_id": 51271308, "comment_id": 89529892, "body": "If you close all of those environments and try again after restarting each of them, does the difference persist?"}, {"owner": {"reputation": 31, "user_id": 7834441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1449fcc3af7e57d4f4e3b9f93b159924?s=128&d=identicon&r=PG&f=1", "display_name": "TheEncode", "link": "https://stackoverflow.com/users/7834441/theencode"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1531288849, "post_id": 51271308, "comment_id": 89533923, "body": "@stark It&#39;s NTFS (Windows 10 x64 Pro)"}, {"owner": {"reputation": 31, "user_id": 7834441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1449fcc3af7e57d4f4e3b9f93b159924?s=128&d=identicon&r=PG&f=1", "display_name": "TheEncode", "link": "https://stackoverflow.com/users/7834441/theencode"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531288974, "post_id": 51271308, "comment_id": 89533967, "body": "@Yunnosch Yes. I even tried own C++ apps to delete this file and it&#39;s blocked."}], "answers": [{"tags": [], "owner": {"reputation": 961, "user_id": 1340606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/77RGE.jpg?s=128&g=1", "display_name": "Gabriel Bercea", "link": "https://stackoverflow.com/users/1340606/gabriel-bercea"}, "is_accepted": false, "score": 1, "last_activity_date": 1537459240, "creation_date": 1537459240, "answer_id": 52429053, "question_id": 51271308, "link": "https://stackoverflow.com/questions/51271308/minifilter-driver-cmd-can-still-delete-a-file/52429053#52429053", "title": "Minifilter Driver - CMD can still delete a file", "body": "<p>Make sure you check for the FILE_DELETE_ON_CLOSE flag being set in the Create path.</p>\n"}], "owner": {"reputation": 31, "user_id": 7834441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1449fcc3af7e57d4f4e3b9f93b159924?s=128&d=identicon&r=PG&f=1", "display_name": "TheEncode", "link": "https://stackoverflow.com/users/7834441/theencode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1537459240, "creation_date": 1531244587, "last_edit_date": 1531248492, "question_id": 51271308, "link": "https://stackoverflow.com/questions/51271308/minifilter-driver-cmd-can-still-delete-a-file", "title": "Minifilter Driver - CMD can still delete a file", "body": "<p>I'm trying to block access to a file (C:\\pass\\secret.txt) with a minifilter.</p>\n\n<p>When I try to delete this file, I get the \"Access Denied Msgbox\" as expected.\nBut I can still delete the file with the \"del\" command from the command prompt.</p>\n\n<p>What is the command prompt doing differently than the powershell, explorer or any other program I tried?</p>\n\n<p>I saw this post <a href=\"https://stackoverflow.com/questions/48466308/minifilter-driver-not-blocking-file-edition\">minifilter-driver-not-blocking-file-edition</a> but as I said, everything else is blocked.</p>\n\n<p>The FltPreOperationCallback function:</p>\n\n<pre><code>FLT_PREOP_CALLBACK_STATUS PtPreOperationPassThrough(_Inout_ PFLT_CALLBACK_DATA Data, _In_ PCFLT_RELATED_OBJECTS FltObjects, _Flt_CompletionContext_Outptr_ PVOID *CompletionContext) {  \n\nNTSTATUS status;\n\nUNREFERENCED_PARAMETER( FltObjects );\nUNREFERENCED_PARAMETER( CompletionContext );\n\nif (PtDoRequestOperationStatus(Data)) {\n    status = FltRequestOperationStatusCallback(Data, PtOperationStatusCallback, (PVOID)(++OperationStatusCtx));\n    if (!NT_SUCCESS(status)) {\n        PT_DBG_PRINT(PTDBG_TRACE_OPERATION_STATUS, (\"PassThrough!PtPreOperationPassThrough: FltRequestOperationStatusCallback Failed, status=%08x\\n\", status));\n    }\n}\n\nif (Data-&gt;Iopb-&gt;MajorFunction == IRP_MJ_WRITE || Data-&gt;Iopb-&gt;MajorFunction == IRP_MJ_SET_INFORMATION || Data-&gt;Iopb-&gt;MajorFunction == IRP_MJ_CREATE) {\n    UNICODE_STRING ourFile;\n    RtlInitUnicodeString(&amp;ourFile, L\"\\\\pass\\\\secret.txt\");\n\n    if (RtlCompareUnicodeString(&amp;Data-&gt;Iopb-&gt;TargetFileObject-&gt;FileName, &amp;ourFile, FALSE) == 0) {\n        DbgPrintEx(DPFLTR_IHVDRIVER_ID, DPFLTR_INFO_LEVEL, \"PtPreOperationPassThrough: %wZ\\n\", &amp;Data-&gt;Iopb-&gt;TargetFileObject-&gt;FileName);\n        Data-&gt;IoStatus.Status = STATUS_ACCESS_DENIED;\n        Data-&gt;IoStatus.Information = 0;\n        return FLT_PREOP_COMPLETE;\n    }\n}\n\nreturn FLT_PREOP_SUCCESS_WITH_CALLBACK;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531243894, "post_id": 51271132, "comment_id": 89520395, "body": "Please format the code properly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531243938, "post_id": 51271132, "comment_id": 89520418, "body": "One of the first things to learn when programming is how to keep your code organized. Please pay particular attention to indentation. This communicates intent and structure and is especially important for us when trying to quickly review your code."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531243973, "post_id": 51271132, "comment_id": 89520438, "body": "When you say &quot;array&quot; do you mean &quot;string buffer&quot;? This looks like <code>append_string</code> is a reimplementation of <code>strcat</code> with some allocation features. It&#39;s also not really C-style to send in a mutable pointer (<code>char**</code>), but instead to return a pointer instead of <code>void</code>. This code is also <i>full</i> of memory leaks because it doesn&#39;t properly release the old buffer when reallocating and appending."}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 9441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ee837f445a23aca0b18c64088b157?s=128&d=identicon&r=PG&f=1", "display_name": "claymorehack", "link": "https://stackoverflow.com/users/9441097/claymorehack"}, "edited": false, "score": 0, "creation_date": 1531244506, "post_id": 51271238, "comment_id": 89520681, "body": "it still giving leak, didn&#39;t change anything."}, {"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "reply_to_user": {"reputation": 48, "user_id": 9441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ee837f445a23aca0b18c64088b157?s=128&d=identicon&r=PG&f=1", "display_name": "claymorehack", "link": "https://stackoverflow.com/users/9441097/claymorehack"}, "edited": false, "score": 0, "creation_date": 1531244574, "post_id": 51271238, "comment_id": 89520710, "body": "@claymorehack See my answer about memory leaks <a href=\"https://stackoverflow.com/questions/5134891/how-do-i-use-valgrind-to-find-memory-leaks/44989219#44989219\">here</a>. I think I see your leak though. When you have a 2D array, you have a list of pointers. The list itself is also a pointer (I&#39;m implying dynamically allocated here). Are you freeing all of those?"}, {"owner": {"reputation": 48, "user_id": 9441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ee837f445a23aca0b18c64088b157?s=128&d=identicon&r=PG&f=1", "display_name": "claymorehack", "link": "https://stackoverflow.com/users/9441097/claymorehack"}, "reply_to_user": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1531245131, "post_id": 51271238, "comment_id": 89520984, "body": "@JoshDetwiler last of the main file i get free in for loop double pointer , but might be problem which allocate memory in function. But how can get them free? I want to use and of the program, then free! . I try to convert to c array&#39;s python list type."}, {"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "reply_to_user": {"reputation": 48, "user_id": 9441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ee837f445a23aca0b18c64088b157?s=128&d=identicon&r=PG&f=1", "display_name": "claymorehack", "link": "https://stackoverflow.com/users/9441097/claymorehack"}, "edited": false, "score": 0, "creation_date": 1531245265, "post_id": 51271238, "comment_id": 89521038, "body": "@claymorehack I&#39;m sorry, I didn&#39;t understand any of that."}, {"owner": {"reputation": 48, "user_id": 9441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ee837f445a23aca0b18c64088b157?s=128&d=identicon&r=PG&f=1", "display_name": "claymorehack", "link": "https://stackoverflow.com/users/9441097/claymorehack"}, "reply_to_user": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1531245864, "post_id": 51271238, "comment_id": 89521278, "body": "@Josh Detwiler I mean  I get free 2d array end of the code using for loop . Is it right ?"}, {"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "reply_to_user": {"reputation": 48, "user_id": 9441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ee837f445a23aca0b18c64088b157?s=128&d=identicon&r=PG&f=1", "display_name": "claymorehack", "link": "https://stackoverflow.com/users/9441097/claymorehack"}, "edited": false, "score": 0, "creation_date": 1531246008, "post_id": 51271238, "comment_id": 89521345, "body": "@claymorehack Where do you free the 2D array itself? You dynamically allocated that too. You can&#39;t just free its entries---you need to free your <code>array</code> variable as well."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1023602"}, "is_accepted": false, "score": 0, "last_activity_date": 1531244277, "creation_date": 1531244277, "answer_id": 51271238, "question_id": 51271132, "link": "https://stackoverflow.com/questions/51271132/array-function-in-c-append-delete-basic/51271238#51271238", "title": "array function in c /Append/Delete basic", "body": "<p>There will be several crashes, but here is one:</p>\n\n<pre><code>   char** arr = calloc(1,sizeof(char));\n</code></pre>\n\n<p>You are allocating 1 byte which is not sufficient to store a (char *), which needs between 2 and 8 bytes depending on the OS and target machine.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>   char** arr = calloc(1,sizeof(char*));\n</code></pre>\n\n<p>You should double-check each line of code. C is not a forgiving language - mistakes are severely punished.</p>\n"}, {"tags": [], "owner": {"reputation": 9567, "user_id": 7916438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8541ff62182bcfd172e116a4e0d2fa58?s=128&d=identicon&r=PG", "display_name": "tevemadar", "link": "https://stackoverflow.com/users/7916438/tevemadar"}, "is_accepted": false, "score": 1, "last_activity_date": 1531246061, "creation_date": 1531246061, "answer_id": 51271653, "question_id": 51271132, "link": "https://stackoverflow.com/questions/51271132/array-function-in-c-append-delete-basic/51271653#51271653", "title": "array function in c /Append/Delete basic", "body": "<p>Your <code>create_xy_array</code> functions allocate an array of 1 element, and they stay that way until the very end. When you have a one-element array and index, read/write its second and further elements, C itself happily approves, but the result will not work, it silently destroys everything in its path.</p>\n\n<p>First of all, for having a dynamic array, you have to track its length yourself, C allocations/arrays do not know their own size. So you need a struct, containing the length and a pointer, something like</p>\n\n<pre><code>typedef struct IntArray {\n  int length;\n  int *elements;\n} IntArray;\n</code></pre>\n\n<p>Then allocate it, for 0 elements, as there is nothing inside at the beginning:</p>\n\n<pre><code>IntArray* create_int_array() {\n  IntArray* ret = (IntArray*) malloc(sizeof(IntArray));\n  ret-&gt;length = 0;\n  ret-&gt;elements = NULL;\n  return ret;\n}\n\nvoid free_int_array(IntArray* arr) {\n  free(arr-&gt;elements);\n  free(arr);\n}\n</code></pre>\n\n<p>Then you can try putting something inside:</p>\n\n<pre><code>void append_int(IntArray* arr, int element) {\n  arr-&gt;length++;\n  arr-&gt;elements = (int*) realloc(arr-&gt;elements, arr-&gt;length*sizeof(int));\n  arr-&gt;elements[length-1] = element;\n}\n</code></pre>\n\n<p>(appending means adding something to the end of an array, there is no need for indices here)</p>\n\n<p>And this could go on forever, deletion of an arbitrary element should shift the \"upper\" part of the array (memcpy) and resize the result to one element smaller or you could track the capacity of the array, which can be larger than its current length (but then it has to be incorporated into the append function and probably others).</p>\n\n<p>(Disclaimer: I hope the snippet is correct, but I do not use C too often - and I can not suggest a good tutorial for the same reason, but that is what you probably need)</p>\n"}, {"tags": [], "owner": {"reputation": 1324, "user_id": 7231449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K4GZN.jpg?s=128&g=1", "display_name": "acarlstein", "link": "https://stackoverflow.com/users/7231449/acarlstein"}, "is_accepted": true, "score": 0, "last_activity_date": 1531248388, "creation_date": 1531248388, "answer_id": 51272166, "question_id": 51271132, "link": "https://stackoverflow.com/questions/51271132/array-function-in-c-append-delete-basic/51272166#51272166", "title": "array function in c /Append/Delete basic", "body": "<p><strong>Note: I haven't code in C for years and I haven't check the code so double check and let me know.</strong></p>\n\n<p>Based on your description, you are trying to do a Vector.</p>\n\n<p>Therefore, there are different ways that you can handle this.</p>\n\n<h1>Approach 1:</h1>\n\n<p>Create a structure which will hold the array, the capacity of the array, and the size of the array.</p>\n\n<pre><code>typedef struct StrArray{\n    int capacity;\n    int size;\n    int *integers;\n}\n</code></pre>\n\n<p>The trick here is to take attention when you increase/decrease the capacity.</p>\n\n<p>If you increase the capacity above the size of the array, then:</p>\n\n<ul>\n<li>You need to create a new array with double the capacity</li>\n<li>Copy all elements to the new array</li>\n<li>Change pointer to new array</li>\n<li>Free the memory of the old array</li>\n</ul>\n\n<h1>Approach 2</h1>\n\n<p>You can extend the previous approach by creating a function which returns a struct which holds the storage plus function pointers to the methods you wish to implement.</p>\n\n<pre><code>typedef struct StrStorage{\n    int capacity;\n    int size;\n    int *integers;\n} StrStorage;\n\ntypedef struct StrArray {\n    StrStorage storage;\n    int (*capacity)(StrArray*);\n    int (*size)(StrArray*);\n    StrArray *(*append)(StrArray*, int);\n    void (*increaseStorage)(StrArray*);\n    // Add other methods here\n} StrArray;\n\nint capacity(StrArray *self) {\n    return self-&gt;storage-&gt;capacity;\n}\n\nint size(StrArray *self) {\n    return self-&gt;storage-&gt;size;\n}\n\nStrArray *append(StrArray *self, int integer){\n    if ((self-&gt;capacity() + 1) &gt; self-&gt;size()){\n        self-&gt;increaseStorage();\n    }\n    // The rest of the magic goes here\n    return self;\n}\n\nStrArray *initializeStrArray(int n) {\n    StrArray* strArray = malloc(sizeof(StrArray));\n    strArray-&gt;chars = malloc(sizeof(char) * n);\n    strArray-&gt;capacity= capacity;\n    strArray-&gt;append = append;\n    return strArray;\n}\n</code></pre>\n\n<p>Approach 3:</p>\n\n<p>This approach is a continuation of the previous one.</p>\n\n<p>In order to reduce the memory allocation, you can create an equivalent to a singleton which holds all the manipulation functions and then assi</p>\n"}], "owner": {"reputation": 48, "user_id": 9441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ee837f445a23aca0b18c64088b157?s=128&d=identicon&r=PG&f=1", "display_name": "claymorehack", "link": "https://stackoverflow.com/users/9441097/claymorehack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 51272166, "answer_count": 3, "score": -1, "last_activity_date": 1531248388, "creation_date": 1531243829, "last_edit_date": 1531244894, "question_id": 51271132, "link": "https://stackoverflow.com/questions/51271132/array-function-in-c-append-delete-basic", "title": "array function in c /Append/Delete basic", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint* create_int_array(){\n   int* arr;\n   arr = (int *)calloc(1,sizeof(int));\n   return arr;\n}\n\n\nchar** create_string_array(){\n   char** arr = calloc(1,sizeof(char));\n   return arr;\n}\n\nvoid append_int(int* array, int element, int index){\n  array = (array+index);\n  *array = element;\n}\n\nvoid append_string(char** array , char* element,int index){\n  *(array + index) = calloc(1,sizeof(char*));\n  strcpy(*(array + index),element);\n}\n\nvoid delete_string(char** array, int index){\n  free(array[index]);\n}\n\nvoid delete_int(int* array,int index){\n  array[index] = NULL;\n}\n\n/////// M A I N   F I L E ///////\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"basic_data_file.h\"\n\nint main(int argc, char const *argv[])\n{\n  /* code */\n  char **array;\n  array = create_string_array();\n\n  char *full_name = calloc(strlen(\"hamza arslan\"),sizeof(char*));\n  strcpy(full_name,\"hamza arslan\");\n\n  char* mail = calloc(strlen(\"test@gmail.com\"),sizeof(char*));\n  strcpy(mail,\"test@gmail.com\");\n\n  char* address = calloc(strlen(\"Hacettepe Universty\"),sizeof(char*));\n  strcpy(address,\"Hacettepe Universty\");\n\n  char* statu = calloc(strlen(\"student\"),sizeof(char*));\n  strcpy(statu,\"student\");\n\n  append_string(array,full_name,0);\n  append_string(array,mail,1);\n  append_string(array,address,2);\n  append_string(array,statu,4);\n\n  for(int i=0; i&lt; 3; i++){\n    printf(\"%s\\n\",array[i]);\n    free(array[i]); // get free double pointer\n  }\n  printf(\"%s\\n\",array[4]); // because index 3 blow up\n\n  free(full_name);\n  free(mail);\n  free(address);\n  free(statu);\n  return 0;\n}\n</code></pre>\n\n<p>I was try to own my basic array library . As you know else in some languages have high level array types. They are making easy our stocking operation. But in c, it's more complicated especially about string. I have 2 problem in here . First of all , when i give index=3 in append_string function , code blow up with Aborted(core dumped) error.(./run': double free or corruption (out)). Secondly , when i was checking leak memory ,it's get memory leak even i use free. What can i do?</p>\n"}, {"tags": ["c", "linux", "gdb"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1531243596, "post_id": 51271058, "comment_id": 89520236, "body": "you want <code>getenv</code>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1531243920, "post_id": 51271058, "comment_id": 89520407, "body": "What do you intend to print? Your shellcode? Then you have to print <code>pointer</code>, not <code>*pointer</code>. If you dereference it first, you give <code>0x90</code> as address where your string to print is located to <code>printf()</code>, which of course results in a segv."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1531244312, "post_id": 51271058, "comment_id": 89520601, "body": "In some environments, you can also access environment variables by adding <a href=\"https://stackoverflow.com/q/10321435/1679849\"><code>*envp[]</code></a> as a third argument to <code>main()</code>."}, {"owner": {"reputation": 15, "user_id": 8396368, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mp6mWjt5OOk/AAAAAAAAAAI/AAAAAAAADzI/5QUoxNs2zNU/photo.jpg?sz=128", "display_name": "sotanishy", "link": "https://stackoverflow.com/users/8396368/sotanishy"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531245206, "post_id": 51271058, "comment_id": 89521017, "body": "@Ctx That&#39;s true. Thanks for your help."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1531259770, "post_id": 51271058, "comment_id": 89527079, "body": "Normally when the OS create a new processo it maps in the process virtual memory a copy of environment block. Such an address is valid only in that process. Even for 2 identical instances of same process the address can be different due to ASLR mechanism."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8396368, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mp6mWjt5OOk/AAAAAAAAAAI/AAAAAAAADzI/5QUoxNs2zNU/photo.jpg?sz=128", "display_name": "sotanishy", "link": "https://stackoverflow.com/users/8396368/sotanishy"}, "edited": false, "score": 0, "creation_date": 1531245800, "post_id": 51271129, "comment_id": 89521253, "body": "Your code worked, thank you, but I don&#39;t know why my code still doesn&#39;t work. I  replaced the getenv(&quot;SHELLCODE&quot;) with the address it gave me (which was 0x7fffffffe294), and this time it worked in gdb. But when I run it from the command line, it gives segmentation fault."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 15, "user_id": 8396368, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mp6mWjt5OOk/AAAAAAAAAAI/AAAAAAAADzI/5QUoxNs2zNU/photo.jpg?sz=128", "display_name": "sotanishy", "link": "https://stackoverflow.com/users/8396368/sotanishy"}, "edited": false, "score": 0, "creation_date": 1531246068, "post_id": 51271129, "comment_id": 89521371, "body": "@sotanishy It probably has to do with ASLR (Address Space Layout Randomization), meaning there&#39;s no guarantee a variable or string will live at the same memory address each time.  That&#39;s one of the things you need to work around to execute a buffer overflow."}, {"owner": {"reputation": 15, "user_id": 8396368, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mp6mWjt5OOk/AAAAAAAAAAI/AAAAAAAADzI/5QUoxNs2zNU/photo.jpg?sz=128", "display_name": "sotanishy", "link": "https://stackoverflow.com/users/8396368/sotanishy"}, "edited": false, "score": 0, "creation_date": 1531247262, "post_id": 51271129, "comment_id": 89521925, "body": "It makes so much more sense. I&#39;ll try to figure that out.  I really appreciate your help."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1531243814, "creation_date": 1531243814, "answer_id": 51271129, "question_id": 51271058, "link": "https://stackoverflow.com/questions/51271058/c-code-to-access-environment-variables/51271129#51271129", "title": "C code to access environment variables", "body": "<p>The <code>getenv</code> function is used to retrieve the values of environment variables:</p>\n\n<pre><code>const char *shellcode = getenv(\"SHELLCODE\");\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8396368, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mp6mWjt5OOk/AAAAAAAAAAI/AAAAAAAADzI/5QUoxNs2zNU/photo.jpg?sz=128", "display_name": "sotanishy", "link": "https://stackoverflow.com/users/8396368/sotanishy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 51271129, "answer_count": 1, "score": -1, "last_activity_date": 1531243814, "creation_date": 1531243527, "question_id": 51271058, "link": "https://stackoverflow.com/questions/51271058/c-code-to-access-environment-variables", "title": "C code to access environment variables", "body": "<p>I created an environment variable SHELLCODE which contains a 200-byte long NOP sled and a shellcode. It is stored at 0x7fffffffe285, but I'll try to access 0x7fffffffe2e5, which is around the middle of the NOP sled.</p>\n\n<p>Then I wrote the following code to try to access the variable.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main() {\n    char *pointer = 0x00007fffffffe2e5;\n    printf(\"%s\\n\", *pointer);\n}\n</code></pre>\n\n<p>I used gdb to see the memory</p>\n\n<pre><code>(gdb) list 1\n1   #include &lt;stdio.h&gt;\n2   \n3   int main() {\n4       char *pointer = (char *) 0x00007fffffffe2e5;\n5       printf(\"%s\\n\", *pointer);\n6   }\n(gdb) break 5\n(gdb) run\n(gdb) p pointer\n$1 = 0x7fffffffe2e5 '\\220' &lt;repeats 119 times&gt;, \"\\061\\300\\061\\333\\061\u0259\\260\\244\u0340j\\vXQh//shh/bin\\211\\343Q\\211\\342S\\211\\341\u0340\"\n(gdb) p *pointer\n$2 = -112 '\\220'\n(gdb) p/x *pointer\n$3 = 0x90\n(gdb) c\nContinuing.\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff7a5bcc0 in _IO_vfprintf_internal (\n    s=0x7ffff7dd2620 &lt;_IO_2_1_stdout_&gt;, format=&lt;optimized out&gt;, \n    ap=ap@entry=0x7fffffffdc58) at vfprintf.c:1632\n1632    vfprintf.c: No such file or directory.\n</code></pre>\n\n<p>The pointer was clearly pointing to the middle of the NOP sled, and gdb could access and see what was at that address. But I keep getting this Segmentation fault error.</p>\n\n<p>Is this because C programs are not allowed to access memory where environment variables are stored? If so, is there a way to allow it to access the memory?</p>\n\n<p>I'm using Ubuntu 16.04 and gcc 5.4.0.\nThanks in advance.</p>\n"}, {"tags": ["c++", "c", "standards"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 7, "creation_date": 1531242762, "post_id": 51270869, "comment_id": 89519817, "body": "&quot;Can I use variadic args without va_* macros?&quot; - portably and reliably? No."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 9, "creation_date": 1531242774, "post_id": 51270869, "comment_id": 89519824, "body": "If by&quot;use&quot; you mean, <i>ignore</i>, yes. If by &quot;use&quot; you mean continuing to dereference <code>p</code> after that increment, <i>no</i>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1531243158, "post_id": 51270869, "comment_id": 89520020, "body": "There is zero guarantee that the subsequent arguments live anywhere close to <code>i</code> in terms of memory location. The compiler is free to supply these to the function in any method it desires, and a good optimizing compiler will often use registers instead of the stack. The <code>int* p = &amp;i</code> part probably prevents the compiler from optimizing since it will have to force that back into a <i>slower</i> memory location."}, {"owner": {"reputation": 355, "user_id": 4631347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128d8d252fbe10aa32143df8f7c90fc?s=128&d=identicon&r=PG&f=1", "display_name": "yrHeTateJlb", "link": "https://stackoverflow.com/users/4631347/yrhetatejlb"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1531243214, "post_id": 51270869, "comment_id": 89520058, "body": "@WhozCraig, yes I&#39;m talking about using passed data, not about SFINAE"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1531243316, "post_id": 51270869, "comment_id": 89520104, "body": "BTW, in C++, you may use variadic template instead of C-ellipsis."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1531243372, "post_id": 51270869, "comment_id": 89520132, "body": "@yrHeTaTeJlb Never said, or intended to be interpreted as, regarding SFINAE. What I&#39;m said is you don&#39;t have to use variadic macros if you don&#39;t actually utilize any arguments in <code>...</code>. But if you do need to access <i>any</i> of those arguments provided through <code>...</code>, the variadic macros are the <i>only</i> way to do it."}, {"owner": {"reputation": 355, "user_id": 4631347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128d8d252fbe10aa32143df8f7c90fc?s=128&d=identicon&r=PG&f=1", "display_name": "yrHeTateJlb", "link": "https://stackoverflow.com/users/4631347/yrhetatejlb"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1531243635, "post_id": 51270869, "comment_id": 89520265, "body": "@WhozCraig, oh, I see, I didn&#39;t get your point. But anyway my answer is &quot;I want to use passed data&quot;."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531246979, "post_id": 51270869, "comment_id": 89521807, "body": "@tadman i have to correct you a bit. Like any other function, vararg functions have ABI, and that ABI is fixed. Compiler can&#39;t decide if it wants to pass arguments through stack or registers as part of optimization (unless function was inlined, but inlining vararg functions is very tricky)."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1531248635, "post_id": 51270869, "comment_id": 89522502, "body": "@SergeyA Interesting, though is that documented anywhere? Is it compiler specific?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1531248907, "post_id": 51270869, "comment_id": 89522644, "body": "@tadman this is platform-specific (and compiler-specific in a sense that they adopt the platform). With one ABI I am familiar with (AMD64) it is defined in section 3.5.7: <a href=\"https://software.intel.com/sites/default/files/article/402129/mpx-linux64-abi.pdf\" rel=\"nofollow noreferrer\">software.intel.com/sites/default/files/article/402129/&hellip;</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531248943, "post_id": 51270869, "comment_id": 89522659, "body": "If you &quot;often&quot; see tutorials recommending that technique, you&#39;re either hanging out on the wrong side of the net, or you&#39;ve fallen into a time warp back to the 1970s or 1980s.  <code>&lt;stdarg.h&gt;</code> (or <code>&lt;varargs.h&gt;</code> before it) has been <i>the</i> way to access variable arguments for many, many years now."}, {"owner": {"reputation": 355, "user_id": 4631347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128d8d252fbe10aa32143df8f7c90fc?s=128&d=identicon&r=PG&f=1", "display_name": "yrHeTateJlb", "link": "https://stackoverflow.com/users/4631347/yrhetatejlb"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531254764, "post_id": 51270869, "comment_id": 89525119, "body": "@SteveSummit, you cought me:) Sometimes. I sometimes see such tutorials:)"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1531258478, "post_id": 51270869, "comment_id": 89526606, "body": "<i>is this approach correct in terms of standard?</i> - No."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1531269924, "post_id": 51270869, "comment_id": 89529289, "body": "You should stop looking in places where such tutorials are found.  If they contain nonsense like this, it is going to be hard for you to know when they&#39;re spouting other dangerous nonsense too."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531288702, "post_id": 51270869, "comment_id": 89533861, "body": "@JonathanLeffler Like I do :) (and well said)"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 4631347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128d8d252fbe10aa32143df8f7c90fc?s=128&d=identicon&r=PG&f=1", "display_name": "yrHeTateJlb", "link": "https://stackoverflow.com/users/4631347/yrhetatejlb"}, "edited": false, "score": 0, "creation_date": 1531243385, "post_id": 51270901, "comment_id": 89520137, "body": "Just as I thought. Thanks."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1531247014, "last_edit_date": 1531247014, "creation_date": 1531242850, "answer_id": 51270901, "question_id": 51270869, "link": "https://stackoverflow.com/questions/51270869/is-it-acceptable-to-use-ellipsis-without-va/51270901#51270901", "title": "Is it acceptable to use ellipsis without va_*?", "body": "<p>The mechanism for how parameters are passed to a function is very implementation specific.  They could be passed on the stack, via registers, or some other method, and the method can differ based on the datatype.</p>\n\n<p>The stdarg family of functions / macros (<code>va_start</code>, <code>va_arg</code>, <code>va_end</code>, etc.) specified in section 7.16 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> abstracts away all this and is the <strong>only</strong> standard compliant way of handling variable arguments lists.</p>\n"}, {"tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 3, "last_activity_date": 1531243941, "creation_date": 1531243941, "answer_id": 51271159, "question_id": 51270869, "link": "https://stackoverflow.com/questions/51270869/is-it-acceptable-to-use-ellipsis-without-va/51271159#51271159", "title": "Is it acceptable to use ellipsis without va_*?", "body": "<blockquote>\n  <p>I often see tutorials about ellipsis with examples like this:</p>\n</blockquote>\n\n<p>Just for absolute clarity - that example is atrocious and the tutorial best avoided.</p>\n\n<p>There <em>are</em> valid uses (variadic templates and macros) of the <code>...</code> syntax which don't require using the <code>va_*</code> facilities, but none of them look like the example code you posted.</p>\n"}], "owner": {"reputation": 355, "user_id": 4631347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128d8d252fbe10aa32143df8f7c90fc?s=128&d=identicon&r=PG&f=1", "display_name": "yrHeTateJlb", "link": "https://stackoverflow.com/users/4631347/yrhetatejlb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 51270901, "answer_count": 2, "score": 1, "last_activity_date": 1531247014, "creation_date": 1531242702, "last_edit_date": 1531244666, "question_id": 51270869, "link": "https://stackoverflow.com/questions/51270869/is-it-acceptable-to-use-ellipsis-without-va", "title": "Is it acceptable to use ellipsis without va_*?", "body": "<p>I often see tutorials about ellipsis with examples like this:</p>\n\n<pre><code>void foo(int i, ...){\n    int *p = &amp;i;\n    ++p;\n    //...\n}\n</code></pre>\n\n<p>And I'm just wondering, is this approach correct in terms of standard? Can I use variadic args without va_* macros? Maybe some implementations store args in reversed order, or something like this.</p>\n\n<p><strong>UPD:</strong> \"Use\" = pass args portably and reliably</p>\n"}, {"tags": ["c", "gcc", "c99"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1531242067, "post_id": 51270671, "comment_id": 89519481, "body": "Are you looking or GCC&#39;s <code>-Warray-bounds</code> compile flag?"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1531242128, "creation_date": 1531242128, "answer_id": 51270726, "question_id": 51270671, "link": "https://stackoverflow.com/questions/51270671/can-i-enforce-explicitly-initialized-array-size-at-compile-time-with-gcc-extensi/51270726#51270726", "title": "Can I enforce explicitly-initialized array size at compile-time with gcc extensions?", "body": "<p>How about</p>\n\n<pre><code>const char *my_enum_names[MY_ENUM_COUNT] = { ... };\n</code></pre>\n\n<p>Then the array will always contain enough elements, but some may be <code>NULL</code> which you then need to add check for instead. It's still better than risking going out of bounds.</p>\n\n<p>Also, with the above, if you remove enumerations then the compiler will warn you about to many initializers if you forget to update the array initialization.</p>\n"}, {"comments": [{"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "edited": false, "score": 0, "creation_date": 1531255652, "post_id": 51270822, "comment_id": 89525499, "body": "it&#39;s strange that i am having trouble finding any real, official documentation on <code>_Static_assert</code> from gcc. it looks like <code>static_assert</code> is part of C11, and glibc implements it in <code>assert.h</code>, and gcc itself has supported <code>_Static_assert</code> since 4.6, but i don&#39;t see any manpages or even a document describing the arguments and expected behavior of either variant of the function."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1531255774, "post_id": 51270822, "comment_id": 89525555, "body": "gcc/tcc/clang all accept zero-sized arrays without error. You usually want to turn the bool the zero into a negative int to really fail the compilation."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "edited": false, "score": 0, "creation_date": 1531258048, "post_id": 51270822, "comment_id": 89526450, "body": "@WoodrowBarlow: It is not a GCC extension. It is a part of standard C since 2011."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1531251349, "last_edit_date": 1531251349, "creation_date": 1531242456, "answer_id": 51270822, "question_id": 51270671, "link": "https://stackoverflow.com/questions/51270671/can-i-enforce-explicitly-initialized-array-size-at-compile-time-with-gcc-extensi/51270822#51270822", "title": "Can I enforce explicitly-initialized array size at compile-time with gcc extensions?", "body": "<pre><code>_Static_assert(sizeof my_enum_names / sizeof *my_enum_names == MY_ENUM_COUNT,\n    \"my_enum_names is the wrong size.\");\n</code></pre>\n\n<p>Prior to the addition of <code>_Static_assert</code> to the language, you could force errors in these situations with declarations such as:</p>\n\n<pre><code>extern char my_enum_namesIsTheWrongSize[1];\nextern char my_enum_namesIsTheWrongSize[sizeof my_enum_names / sizeof *my_enum_names == MY_ENUM_COUNT];\n</code></pre>\n\n<p>If the test in the latter were false, it would attempt to declare an array with zero elements, which is an error itself, but, just in case the compiler does not report zero-size arrays, also conflicts with the preceding declaration, and so it should generate an error message.</p>\n"}], "owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 51270822, "answer_count": 2, "score": 1, "last_activity_date": 1531255371, "creation_date": 1531241906, "last_edit_date": 1531255371, "question_id": 51270671, "link": "https://stackoverflow.com/questions/51270671/can-i-enforce-explicitly-initialized-array-size-at-compile-time-with-gcc-extensi", "title": "Can I enforce explicitly-initialized array size at compile-time with gcc extensions?", "body": "<p><strong>Can I force GCC to throw a warning or error at compile-time if the number of elements in a certain explicitly-initialized C array is not equal to a certain value?</strong></p>\n\n<p>Consider the following simple C program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nenum my_enum {\n    MY_ENUM_FIRST,\n    MY_ENUM_SECOND,\n    MY_ENUM_THIRD,\n    MY_ENUM_COUNT\n};\n\n// indexable by my_enum\nconst char *my_enum_names[] = {\n    \"first\",\n    \"second\",\n    \"third\",\n};\n\nint main(void) {\n    int i;\n\n    for (i = 0; i &lt; MY_ENUM_COUNT; i++)\n    {\n        printf(\"%s\\n\", my_enum_names[i]);\n    }\n}\n</code></pre>\n\n<p>Unless they are directly adjacent in the code, a developer might not realize that the enum and array must be kept \"synchronized\" with each other. A developer may add an entry to the enum but not to the array (or vice-versa) and therefore expose an out-of-bounds vulnerability.</p>\n\n<p><strong>Can I add some sort of pragma or attribute to the definition of <code>my_enum_names</code> so that if its size is not equal to <code>MY_ENUM_COUNT</code>, the compiler will throw a warning or error?</strong></p>\n\n<p>Some clarifications:</p>\n\n<ul>\n<li>I am referring specifically to arrays which are explicitly initialized, meaning their size is known at compile-time.</li>\n<li>I am referring specifically to the GCC compiler, including compiler extensions.</li>\n</ul>\n\n<p>I swear I've done this before, possibly using one of GCC's <code>__attribute__</code> extensions, but now I can't find any documentation on any feature that does what I want.</p>\n"}, {"tags": ["c", "memory-management", "realloc"], "comments": [{"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 3, "creation_date": 1531241628, "post_id": 51270559, "comment_id": 89519269, "body": "Is this really a c++ question?  If so, then it would be best (in general) to let std::string to handle the memory allocation for you."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531241647, "post_id": 51270559, "comment_id": 89519278, "body": "It depends. For your use-case, try both and meassure (and try many times to get an average, and with optimized code)."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1531241688, "post_id": 51270559, "comment_id": 89519293, "body": "there&#39;s always trade-offs,, what&#39;s more important/constrained? Speed or memory?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1531241697, "post_id": 51270559, "comment_id": 89519297, "body": "On another note, don&#39;t forget that <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc</code></a> returns an <i><code>int</code></i>. That&#39;s actually important for the comparison to <code>EOF</code>."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1531241926, "post_id": 51270559, "comment_id": 89519422, "body": "Just map the file into memory."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1531255696, "post_id": 51270559, "comment_id": 89525521, "body": "sizeof(char) is guaranteed to be one, Just use 1 instead of <code>sizeof(char)</code>, and <code>count</code> instead of <code>count * sizeof(char)</code>.  Better yet, use <code>char* s = malloc(sizeof(*s));</code> and <code>char* snew = realloc(s, size*sizeof(*snew));</code> That type of construct saves lots of headaches if you ever decide to change the type of s to something else."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1531241854, "creation_date": 1531241854, "answer_id": 51270661, "question_id": 51270559, "link": "https://stackoverflow.com/questions/51270559/overuse-of-realloc/51270661#51270661", "title": "Overuse of realloc", "body": "<p>Memory is abundant these days, so having an exact amount of memory isn't quite as important as minimizing your run time.</p>\n\n<p>The second scheme, where you double the allocated memory anytime you need more, is generally considered the better option.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 2, "last_activity_date": 1531242383, "last_edit_date": 1531242383, "creation_date": 1531242081, "answer_id": 51270712, "question_id": 51270559, "link": "https://stackoverflow.com/questions/51270559/overuse-of-realloc/51270712#51270712", "title": "Overuse of realloc", "body": "<p>The latter is <em>absolutely</em> better if you've got unconstrained line length, because the time spent building a string of length <code>n</code> will be <code>O(n)</code> whereas the former is <code>O(n\u00b2)</code> due to unnecessary copying. If you want to decrease overallocation, you can make a trade off for a higher constant factor - for example, by always increasing the buffer by say 20 % <strong>and</strong> 1 character.</p>\n\n<hr>\n\n<p>P.S. <a href=\"https://stackoverflow.com/q/35356322/918959\"><code>fgetc</code> returns an <code>int</code></a> - otherwise no amount of memory will be enough on a platform where <code>char</code> is unsigned...</p>\n"}], "owner": {"reputation": 35, "user_id": 8302898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f032700268278cf13b0eeda155fa7f5?s=128&d=identicon&r=PG&f=1", "display_name": "aabceh", "link": "https://stackoverflow.com/users/8302898/aabceh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 51270661, "answer_count": 2, "score": 0, "last_activity_date": 1531242383, "creation_date": 1531241461, "last_edit_date": 1531241723, "question_id": 51270559, "link": "https://stackoverflow.com/questions/51270559/overuse-of-realloc", "title": "Overuse of realloc", "body": "<p>When reading in data to a string, is it better to use as many <code>realloc</code>'s as necessary to get the correct amount of memory, or is it better to use less <code>realloc</code>'s but potentially end up with unused memory?</p>\n\n<p>For instance, is this better:</p>\n\n<pre><code>char c;\nint count = 1;\nchar* s = malloc(sizeof(char));\nwhile((c = fgetc(file)) != EOF) {\n    char* snew = (char *)realloc(s, count*sizeof(char));\n    if(!snew) {\n        exit(1);\n    }\n    s = snew;\n    s[count-1] = c;\n    count++;\n}\n</code></pre>\n\n<p>Or is this better:</p>\n\n<pre><code>char c;\nint count = 0;\nint size = 1;\nchar* s = malloc(sizeof(char));\nwhile((c = fgetc(file)) != EOF) {\n    s[count] = c;\n    count++;\n    if(count &gt;= size) {\n        size*=2;\n        char* snew = (char *)realloc(s, size*sizeof(char));\n        if(!snew) {\n            exit(1);\n        }\n        s = snew;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "arm", "system-calls", "gem5"], "comments": [{"owner": {"reputation": 3686, "user_id": 2510655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460a7e6ff5c136b73116066c58a4a9eb?s=128&d=identicon&r=PG", "display_name": "Samuel Peter", "link": "https://stackoverflow.com/users/2510655/samuel-peter"}, "edited": false, "score": 1, "creation_date": 1531241402, "post_id": 51270445, "comment_id": 89519154, "body": "Try compiling with <code>-nodefaultlibs</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531241430, "post_id": 51270445, "comment_id": 89519167, "body": "<code>-ffreestanding</code>?"}, {"owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "edited": false, "score": 0, "creation_date": 1531241710, "post_id": 51270445, "comment_id": 89519302, "body": "<code>-nodefaultlibs</code> is giving me some errors:  <code>&#47;usr&#47;lib&#47;gcc-cross&#47;arm-linux-gnueabi&#47;7&#47;..&#47;..&#47;..&#47;..&#47;arm-linux&zwnj;&#8203;-gnueabi&#47;lib&#47;..&#47;lib&#47;&zwnj;&#8203;crt1.o: In function </code>_start&#39;: (.text+0x28): undefined reference to <code>__libc_start_main&#39; (.text+0x2c): undefined reference to </code>abort&#39; (.text+0x30): undefined reference to <code>__libc_csu_fini&#39; (.text+0x38): undefined reference to </code>__libc_csu_init&#39; collect2: error: ld returned 1 exit status `"}, {"owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "edited": false, "score": 0, "creation_date": 1531241943, "post_id": 51270445, "comment_id": 89519428, "body": "<code>-ffreestanding</code> still gives me issues. Standalone gem5 complains about it being dinamic: <code>fatal: Unable to open dynamic executable&#39;s interpreter.</code>. Combined with <code>-static</code> it compiles it using syscalls."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1531244884, "post_id": 51270445, "comment_id": 89520871, "body": "disassemble the program to see where the syscalls if any are, then work to remove them.  it may just be an assumption, building a program for this platform you are likley going to need syscalls so lets just setup the infrastructure in the bootstrap."}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1531324736, "last_edit_date": 1531324736, "creation_date": 1531241257, "answer_id": 51270504, "question_id": 51270445, "link": "https://stackoverflow.com/questions/51270445/why-would-a-simple-c-program-need-syscalls/51270504#51270504", "title": "Why would a simple C program need syscalls?", "body": "<blockquote>\n  <p>My question is, why would a simple program like this require syscalls?</p>\n</blockquote>\n\n<p>The run-time loader <code>ld.so</code> does syscalls. The C run-time does syscalls. Do <code>strace &lt;application&gt;</code> and see.</p>\n"}, {"comments": [{"owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "edited": false, "score": 0, "creation_date": 1531255508, "post_id": 51270524, "comment_id": 89525425, "body": "Thanks for the thorough explanation. While this helps me understand better what&#39;s happening I think my problem will not be solved until the syscalls are implemented in gem5, or I run gem5 Full System. gem5 is not being able to run the bare-metal code for now. My problem is gem5&#39;s limitations."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 13, "last_activity_date": 1531243833, "last_edit_date": 1531243833, "creation_date": 1531241329, "answer_id": 51270524, "question_id": 51270445, "link": "https://stackoverflow.com/questions/51270445/why-would-a-simple-c-program-need-syscalls/51270524#51270524", "title": "Why would a simple C program need syscalls?", "body": "<p>Without syscalls the program cannot exit. The way it works is typically something like this:</p>\n\n<pre><code>// Not how it's actually implemented... just a sketch.\nvoid _start() {\n    char **argv = ...;\n    int argc = ...;\n    // ... other initialization code ...\n    int retcode = main(argc, argv);\n    exit(retcode);\n}\n</code></pre>\n\n<p>The exact details depend on the operating system, but <code>exit()</code>, which terminates the process, typically has to be a system call or is implemented with system calls.</p>\n\n<p>Note that this is true for \"hosted\" C implementations, not for \"freestanding\" C implementations, and is highly operating-system specific. There are freestanding C implementations can run on bare metal, but hosted C implementations usually need an operating system.</p>\n\n<p>You can compile without standard libraries and without the runtime but your entry point cannot return... there is nothing to return to, without a runtime.</p>\n\n<h2>Creating a baremetal program</h2>\n\n<p>It is generally possible to compile programs capable of running baremetal.</p>\n\n<ul>\n<li><p>Use <code>-ffreestanding</code>. This makes GCC generate code that does not assume that the standard library is available (and has other effects).</p></li>\n<li><p>Use <code>-nostdlib</code>. This will prevent GCC from linking with the standard library. Note that <code>memcmp</code>, <code>memset</code>, <code>memcpy</code>, and <code>memmove</code> calls may be generated anyway, so you may have to provide these yourself.</p></li>\n</ul>\n\n<p>At this point you can write your program, but you typically have to use <code>_start</code> instead of <code>main</code>:</p>\n\n<pre><code>void _start(void) {\n    while (1) { }\n}\n</code></pre>\n\n<p>Note that you can't return from <code>_start</code>! Think about it... there is nowhere to return to. When you compile a program like this you can see that it doesn't use any system calls and doesn't have a loader.</p>\n\n<pre>\n$ gcc -ffreestanding -nostdlib test.c\n</pre>\n\n<p>We can verify that it loads no libraries:</p>\n\n<pre>\n$ ldd a.out                              \n    statically linked\n$ readelf -d a.out \n\nDynamic section at offset 0xf30 contains 8 entries:\n  Tag        Type                         Name/Value\n 0x000000006ffffef5 (GNU_HASH)           0x278\n 0x0000000000000005 (STRTAB)             0x2b0\n 0x0000000000000006 (SYMTAB)             0x298\n 0x000000000000000a (STRSZ)              1 (bytes)\n 0x000000000000000b (SYMENT)             24 (bytes)\n 0x0000000000000015 (DEBUG)              0x0\n 0x000000006ffffffb (FLAGS_1)            Flags: PIE\n 0x0000000000000000 (NULL)               0x0\n</pre>\n\n<p>We can also see that it doesn't contain any code that makes system calls:</p>\n\n<pre>\n$ objdump -d a.out\n\na.out:     file format elf64-x86-64\n\n\nDisassembly of section .text:\n\n00000000000002c0 &lt;_start&gt;:\n 2c0:   eb fe                   jmp    2c0 &lt;_start&gt;\n</pre>\n"}, {"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 2, "last_activity_date": 1531242644, "last_edit_date": 1531242644, "creation_date": 1531241462, "answer_id": 51270562, "question_id": 51270445, "link": "https://stackoverflow.com/questions/51270445/why-would-a-simple-c-program-need-syscalls/51270562#51270562", "title": "Why would a simple C program need syscalls?", "body": "<p>There are some parameters to gcc you might want to checkout. Among others:</p>\n\n<ul>\n<li>-ffreestanding</li>\n<li>-nostdlib</li>\n<li>-nodefaultlibs</li>\n</ul>\n\n<blockquote>\n  <p>My question is, why would a simple program like this require syscalls?</p>\n</blockquote>\n\n<p>Because entering main and exiting the program is based on syscalls.</p>\n"}, {"tags": [], "owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "is_accepted": false, "score": 0, "last_activity_date": 1531340236, "creation_date": 1531340236, "answer_id": 51293591, "question_id": 51270445, "link": "https://stackoverflow.com/questions/51270445/why-would-a-simple-c-program-need-syscalls/51293591#51293591", "title": "Why would a simple C program need syscalls?", "body": "<p>Compiling with arm-unknown-linux-uclibcgnueabi solved the issue. Apparently uclibc implementation doesn't use the syscalls that gem5 doesn't have implemented.</p>\n"}], "owner": {"reputation": 380, "user_id": 6553631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a382e5eed46ae9d3558510513079c683?s=128&d=identicon&r=PG&f=1", "display_name": "tgonzaleza", "link": "https://stackoverflow.com/users/6553631/tgonzaleza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 2, "accepted_answer_id": 51270524, "answer_count": 4, "score": 4, "last_activity_date": 1531340236, "creation_date": 1531241045, "question_id": 51270445, "link": "https://stackoverflow.com/questions/51270445/why-would-a-simple-c-program-need-syscalls", "title": "Why would a simple C program need syscalls?", "body": "<p>Related to <a href=\"https://stackoverflow.com/questions/51256193/missing-syscalls-in-gem5-arm\">this</a> other question. I am trying to run this simple C program in gem5:</p>\n\n<pre><code>int main() {\n    int a=1, b=2;\n    int c=a+b;\n    return c;\n}\n</code></pre>\n\n<p>And it fails because gem5 doesn't have some syscalls implemented.</p>\n\n<p>My question is, why would a simple program like this require syscalls? This should run bare-metal without trouble. Is there a way to compile this to avoid syscalls? I am using arm-linux-gnueabi-gcc -static -DUNIX to compile it.</p>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1531240444, "post_id": 51270255, "comment_id": 89518676, "body": "are you trying to declare pointers? Using <code>&#39;&amp;&#39;</code> in that context makes no sense"}, {"owner": {"reputation": 1718, "user_id": 2760375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25679f917da6b6f54efa1b30a0546d57?s=128&d=identicon&r=PG", "display_name": "user2760375", "link": "https://stackoverflow.com/users/2760375/user2760375"}, "edited": false, "score": 0, "creation_date": 1531240468, "post_id": 51270255, "comment_id": 89518691, "body": "what kind of variable is &amp;random1, this is not valid name."}], "answers": [{"tags": [], "owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "is_accepted": true, "score": 4, "last_activity_date": 1531240801, "creation_date": 1531240801, "answer_id": 51270378, "question_id": 51270255, "link": "https://stackoverflow.com/questions/51270255/expected-identifier-or-before-token/51270378#51270378", "title": "expected identifier or &#39;(&#39; before &#39;&amp;&#39; token", "body": "<p>Don't use the &amp; operator in a declaration.  Change to:</p>\n\n<pre><code>    unsigned long random1, random2, random3; /* error code on this line */\n</code></pre>\n\n<p>The <code>&amp;</code> operator is used in the call to your function to provide pointers to those variables, presumably for your <code>MersenneTwister</code> function to fill in.  The variables themselves are ordinary unsigned long objects.</p>\n"}], "owner": {"reputation": 3, "user_id": 10060435, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-csEtrD-etVs/AAAAAAAAAAI/AAAAAAAAAGA/4wZ9RXpZ3yc/photo.jpg?sz=128", "display_name": "Kaleb Jen", "link": "https://stackoverflow.com/users/10060435/kaleb-jen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 51270378, "answer_count": 1, "score": -2, "last_activity_date": 1531240801, "creation_date": 1531240349, "question_id": 51270255, "link": "https://stackoverflow.com/questions/51270255/expected-identifier-or-before-token", "title": "expected identifier or &#39;(&#39; before &#39;&amp;&#39; token", "body": "<p>I am building a piece of code that implements the mersenne twister random unsigned long generator to simulate a slot machine. When I declare my variables in my main, I get this error code:\n    error: expected identifier or '(' before '&amp;' token.</p>\n\n<pre><code>int main()\n{\n    int window1 = 0, window2 = 0, window3 = 0;\n    unsigned long &amp;random1, &amp;random2, &amp;random3; /* error code on this line */\n    ...\n    mersenneTwister(&amp;random1, &amp;random2, &amp;random3); /* calls a subroutine named mersenneTwister */\n    ...\n    return 0;\n}\n</code></pre>\n\n<p>The subroutine runs fine; I tested it by running it on its own, and the only error is that one declaration line.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531239797, "post_id": 51270097, "comment_id": 89518357, "body": "Are you trying to get a binary representation of a number?"}, {"owner": {"reputation": 27, "user_id": 9888020, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oa9sNNXbAGE/AAAAAAAAAAI/AAAAAAAAAUw/jR_u9uLpWUM/photo.jpg?sz=128", "display_name": "studentForever", "link": "https://stackoverflow.com/users/9888020/studentforever"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531239829, "post_id": 51270097, "comment_id": 89518371, "body": "yes that&#39;s what i want to do"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1531239835, "post_id": 51270097, "comment_id": 89518378, "body": "What is the expected output of your example program, and the actual output?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531239959, "post_id": 51270097, "comment_id": 89518425, "body": "<code>printf</code> the value <i>before</i> you increment <code>i</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1531240060, "post_id": 51270171, "comment_id": 89518475, "body": "It&#39;s also worth mentioning that <code>main()</code> should return 0, and <code>divise()</code> should return <code>void</code> instead of <code>int</code>."}, {"owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "reply_to_user": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1531240290, "post_id": 51270171, "comment_id": 89518599, "body": "@frslm thanks for notify that."}], "tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": false, "score": 1, "last_activity_date": 1531240119, "last_edit_date": 1531240119, "creation_date": 1531239996, "answer_id": 51270171, "question_id": 51270097, "link": "https://stackoverflow.com/questions/51270097/store-the-rest-of-a-successive-division-in-a-array/51270171#51270171", "title": "store the rest of a successive division in a array", "body": "<p>The mistake is with your <code>i++</code> statement . It should be after <code>printf(\"%d\\n\",remain[i]);</code>.</p>\n\n<p>Modified code :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint divise(int n)\n{\n    int i = 0;\n    int remain[20];\n    int rest;\n    while (n != 0)\n    {\n        rest = n % 2;\n        remain[i] = rest;\n        n = n / 2;\n        printf(\"%d\\n\", remain[i]);\n        i++;                        // repositioned \n    }\n}\nint main()\n{\n    divise(10);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output :-</strong></p>\n\n<pre><code>0\n1\n0\n1\n</code></pre>\n\n<p>Your function <code>int divise(int n)</code> do not return any int values . So better make it <code>void divise(int n)</code> .Also <code>int main()</code> should have a <code>return 0</code> . </p>\n"}], "owner": {"reputation": 27, "user_id": 9888020, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oa9sNNXbAGE/AAAAAAAAAAI/AAAAAAAAAUw/jR_u9uLpWUM/photo.jpg?sz=128", "display_name": "studentForever", "link": "https://stackoverflow.com/users/9888020/studentforever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1531495488, "answer_count": 1, "score": -1, "last_activity_date": 1531240119, "creation_date": 1531239697, "last_edit_date": 1531239755, "question_id": 51270097, "link": "https://stackoverflow.com/questions/51270097/store-the-rest-of-a-successive-division-in-a-array", "closed_reason": "Not suitable for this site", "title": "store the rest of a successive division in a array", "body": "<p>I want to create a program who store the rest of successive division in the array.But unfortunately the array i created refuse store the remain correctly for example 5/2 the remain is suppose to be 1 but the array store another value</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint divise(int n){\n    int i=0;\n    int remain[20];\n    int rest;\n    while(n!=0){\n        rest = n%2;\n        remain[i] = rest;\n        n = n/2;\n        i++;\n        printf(\"%d\\n\",remain[i]);\n    }\n}\n\nint main(){\n    divise(10);\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "bison"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1531247645, "post_id": 51270023, "comment_id": 89522085, "body": "What embedded platform? Is this question about rapberrypi or stm32 or atmega8?"}, {"owner": {"reputation": 1529, "user_id": 3884536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a012f11c32e66223b1a149e37ee4d839?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Jaritz", "link": "https://stackoverflow.com/users/3884536/stefan-jaritz"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1531384946, "post_id": 51270023, "comment_id": 89578873, "body": "I am playing around with Zephyr OS on stm32 ARM. With own linker files and no stdlib"}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1531269447, "creation_date": 1531269447, "answer_id": 51275668, "question_id": 51270023, "link": "https://stackoverflow.com/questions/51270023/how-to-do-a-multi-instance-comandline-parser-and-checker-with-bison-and-flex-for/51275668#51275668", "title": "How to do a multi instance comandline parser and checker with bison and flex for use in firmware(bare metal build enviroment)?", "body": "<p>You've got the basic setup already, although there are a few details missing. Once you have a reentrant scanner, you can use as many instances of it as you want, since each instance has its own <code>scanner_t</code> object.</p>\n\n<p>If you want to scan a specific buffer, you will want to call <a href=\"https://westes.github.io/flex/manual/Multiple-Input-Buffers.html#index-yy_005fscan_005fbuffer\" rel=\"nofollow noreferrer\"><code>yy_scan_buffer</code></a>. (That description applies to the non-reentrant interface; as indicated in the section on reentrant scanners, <a href=\"https://westes.github.io/flex/manual/Extra-Reentrant-Argument.html#Extra-Reentrant-Argument\" rel=\"nofollow noreferrer\">all APIs take the scanner_t object as an additional <em>last</em> argument</a>.)</p>\n\n<p>Please read the documentation of <code>yy_scan_buffer</code> carefully. The interface is designed to avoid copying, but it means handing your input buffer over to the flex scanner, and it will take advantage of that. There are two things you need to be aware of:</p>\n\n<ul>\n<li><p>the scanner will modify the buffer, and there is no guarantee that it will be restored.</p></li>\n<li><p>the buffer must be terminated with <strong><em>two</em></strong> NUL bytes, for obscure reasons. (<code>yy_scan_buffer</code> checks to make sure you've done this, in order to avoid problems later.)</p></li>\n</ul>\n\n<p>(There is an annotated, fully-functional example of a reentrant parser and scanner in <a href=\"https://stackoverflow.com/questions/48850242/thread-safe-reentrant-bison-flex/48879103#48879103\">this answer</a>. Below, I've just noted some important points.)\nUnless you use a push parser (which I personally prefer), you will need to pass the appropriate <code>scanner_t</code> object to the parser. The easiest way to do that is to just add it as an extra parameter to both the parser and the lexer by adding the following declaration to your bison file:</p>\n\n<pre><code>%param {scanner_t scanner}\n</code></pre>\n\n<p>That will cause <code>yyparse</code> to expect a scanner_t as an argument, and to pass it directly to <code>yyflex</code>.</p>\n\n<p>If you are using a reentrant parser as well (which you appear to be doing, since you've asked for a pure parser), then bison will pass <em>a pointer to</em> <code>yylval</code>  (and <code>yylloc</code>, if you're using locations) into the scanner. You'll have to make sure that the scanner is expecting those arguments, which is most easily accomplished by adding a <a href=\"https://westes.github.io/flex/manual/Bison-Bridge.html#Bison-Bridge\" rel=\"nofollow noreferrer\">bison-bridge declaration</a> to your flex file.</p>\n\n<p>The result of passing <code>yylval</code> as a pointer rather than using a global variable is that you need to change your flex actions. Instead of <code>yylval.ival = atoi(yytext);</code>, you'll want:</p>\n\n<pre><code>yylval-&gt;ival = atoi(yytext);\n</code></pre>\n"}], "owner": {"reputation": 1529, "user_id": 3884536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a012f11c32e66223b1a149e37ee4d839?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Jaritz", "link": "https://stackoverflow.com/users/3884536/stefan-jaritz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "closed_date": 1531313281, "answer_count": 1, "score": 0, "last_activity_date": 1531417439, "creation_date": 1531239442, "last_edit_date": 1531417439, "question_id": 51270023, "link": "https://stackoverflow.com/questions/51270023/how-to-do-a-multi-instance-comandline-parser-and-checker-with-bison-and-flex-for", "closed_reason": "Needs details or clarity", "title": "How to do a multi instance comandline parser and checker with bison and flex for use in firmware(bare metal build enviroment)?", "body": "<p>I am playing a bit around with flex and bison in the embedded firmware creation context.</p>\n\n<p>I like to create a commando line interface for my evaluation board. The commands can be send via UART or USB(ACM). That is why the parser and lexer run buffer based as two instances.</p>\n\n<p>The data and processing looks like:</p>\n\n<p>UART -> buffer A[10] &lt;- lexer instance A @ main -> parser instance A -> handler</p>\n\n<p>USB -> buffer B[255] &lt;- lexer instance B @ main -> parser instance B -> handler</p>\n\n<p>The buffers are filled asynchronous by the IOs. To simplify I bought everything down to a main + lexer + parser structure. There is no need for synchronization via UART and main.</p>\n\n<p><strong>My question deals with the setup of fflex and bison. How to set it up, that I can run 2 instances of them, which are buffer based?</strong></p>\n\n<p>I attach my \"not working\" code as simple example:</p>\n\n<ol>\n<li>bl_lexer.c - the lexer</li>\n<li>bl_parser.y - the parser</li>\n<li>main.c - the main</li>\n<li>CMakeLists.txt - cmake build</li>\n</ol>\n\n<p>The following code:</p>\n\n<p>bl_lexer.l</p>\n\n<pre><code>%option noyywrap\n%option reentrant\n%option prefix=\"bl_\"\n\n%{\n#include &lt;stdio.h&gt;\n\n#include \"bl_parser.h\"\n\n%}\n\n%%\n[ \\t]   ; // ignore all whitespace\n[0-9]+      {yylval.ival = atoi(yytext); return t_int;}\n\\n          {return t_nl;}\n\"help\"      {return t_help;}\n\"info\"      {return t_info;}\n%%\n</code></pre>\n\n<p>bl_parser.y</p>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n%}\n\n%define api.pure full\n\n%union {\n    int ival;\n}\n\n%token&lt;ival&gt; t_int\n%token t_nl\n%token t_help\n%token t_info\n\n%start commandL\n\n%%\n\ninfo_cmd: t_info t_nl { printf(\"info\\n\");}\n    ;\n\nhelp_cmd: t_help t_nl { printf(\"help\\n\");}\n    ;\n\nnum_cmd: t_int t_nl { printf(\"num: %i \\n\", $1);}\n    ;\n\ncommandL:\n    | command\n    ;\n\ncommand: info_cmd |\n    help_cmd |\n    num_cmd \n    ;\n\n%%\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include \"pl_parser.h\"\n\nchar buf_A[10];\nchar buf_B[255];\n\nint main() {\n??\n    return 0;\n}\n</code></pre>\n\n<p>CMakeLists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.1)\n\nproject(bl_cmdl)\n\nfind_package(BISON REQUIRED)\nfind_package(FLEX REQUIRED)\n\nset(GEN_DIR \"${CMAKE_CURRENT_SOURCE_DIR}/generated\")\n\nFILE(MAKE_DIRECTORY ${GEN_DIR})\n\nBISON_TARGET(bl_parser ${CMAKE_CURRENT_SOURCE_DIR}/bl_parser.y \"${GEN_DIR}/bl_parser.c\"\n             DEFINES_FILE \"${GEN_DIR}/bl_parser.h\")\n\nFLEX_TARGET(bl_lexer ${CMAKE_CURRENT_SOURCE_DIR}/bl_lexer.l \"${GEN_DIR}/bl_lexer.c\")\nADD_FLEX_BISON_DEPENDENCY(bl_lexer bl_parser)\n\nadd_executable(bl_cmdL_test\n    main.c\n    ${FLEX_bl_lexer_OUTPUTS}\n    ${BISON_bl_parser_OUTPUTS}\n)\n\ntarget_include_directories(bl_cmdL_test PRIVATE ${GEN_DIR})\n</code></pre>\n"}, {"tags": ["c", "linux", "dbus"], "answers": [{"tags": [], "owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "is_accepted": false, "score": 4, "last_activity_date": 1531335984, "last_edit_date": 1531335984, "creation_date": 1531236565, "answer_id": 51269130, "question_id": 51269129, "link": "https://stackoverflow.com/questions/51269129/minimal-gdbus-client/51269130#51269130", "title": "Minimal GDBus client", "body": "<p>Here's a Makefile:</p>\n\n<pre><code>LIBS=gio-2.0\nCFLAGS=-O0 -ggdb3 `pkg-config --cflags $(LIBS)`\nLDFLAGS=`pkg-config --libs $(LIBS)`\n\n.PHONY: clean\ndefault: gdbus-example\ngdbus-example: gdbus-example.o\n    gcc $^ $(LDFLAGS) -o $@\n\n%.o: %.c\n    gcc $(INCLUDE) $(CFLAGS) -o $@ -c $^\n\nclean:\n    rm -f *.o gdbus-example\n</code></pre>\n\n<p>And here's a minimal C file to build with it that connects and watches for bluez:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;gio/gio.h&gt;\n\nvoid name_appeared(GDBusConnection *connection,\n                   const gchar *name,\n                   const gchar *name_owner,\n                   gpointer user_data)\n{\n    printf(\"Name appeared: %s\\n\", name);\n    printf(\"Owned by: %s\\n\", name_owner);\n}\n\nvoid name_vanished(GDBusConnection *connection,\n                   const gchar *name,\n                   gpointer user_data)\n{\n    printf(\"Name vanished: %s\\n\", name);\n}\n\nint main(void)\n{\n    GMainLoop *loop;\n    GError *error;\n    guint name;\n\n    loop = g_main_loop_new(NULL, FALSE);\n    name = g_bus_watch_name(G_BUS_TYPE_SYSTEM,\n                            \"org.bluez\", // \n                            G_BUS_NAME_WATCHER_FLAGS_NONE,\n                            name_appeared,\n                            name_vanished,\n                            NULL,\n                            NULL);\n\n    g_main_loop_run(loop);\n}\n</code></pre>\n\n<p>And here's a sample terminal session where I restarted the bluetooth service:</p>\n\n<pre><code>$ ./gdbus-example \nName appeared: org.bluez\nOwned by: :1.16\nName vanished: org.bluez\nName appeared: org.bluez\nOwned by: :1.1152\n</code></pre>\n\n<p>Here is the <a href=\"https://developer.gnome.org/gio/2.56/index.html\" rel=\"nofollow noreferrer\">gio documentation</a>, which includes GDBus. It covers how to build and initialize GDBus programs. The DBus project points to the <a href=\"https://developer.gnome.org/gio/stable/gdbus-convenience.html\" rel=\"nofollow noreferrer\">high level</a> and <a href=\"https://developer.gnome.org/gio/stable/gdbus-lowlevel.html\" rel=\"nofollow noreferrer\">low level</a> API docs.</p>\n"}], "owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "closed_date": 1531285767, "answer_count": 1, "score": 0, "last_activity_date": 1531335984, "creation_date": 1531236565, "question_id": 51269129, "link": "https://stackoverflow.com/questions/51269129/minimal-gdbus-client", "closed_reason": "Not suitable for this site", "title": "Minimal GDBus client", "body": "<p>I've been trying to make a simple program that does some of what bluetoothctl does, but automatically. It needs to not be GPL'd, so I can't just copy bluetoothctl's source. The biggest stumbling block has been just getting a simple D-Bus program to work. Since I'm targeting an embedded system (albeit a fairly powerful one) I can't afford to run Python or use just any programming language.</p>\n\n<p>I've seen several questions here and loads of web sites with pointers to <a href=\"https://dbus.freedesktop.org/doc/dbus-glib/\" rel=\"nofollow noreferrer\">obsolete things</a> or broken links or <a href=\"https://dbus.freedesktop.org/doc/api/html/index.html\" rel=\"nofollow noreferrer\">documentation</a> that says I'm \"signing up for some pain.\" How is there not a simple minimal example that sets up a D-Bus connection?</p>\n"}, {"tags": ["c", "fortran", "gfortran", "fortran-iso-c-binding"], "comments": [{"owner": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "reply_to_user": {"reputation": 24099, "user_id": 3157076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mB4zi.png?s=128&g=1", "display_name": "francescalus", "link": "https://stackoverflow.com/users/3157076/francescalus"}, "edited": false, "score": 0, "creation_date": 1531235425, "post_id": 51268567, "comment_id": 89515634, "body": "Fixed, thanks for pointing this out!"}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "edited": false, "score": 0, "creation_date": 1531237981, "post_id": 51269204, "comment_id": 89517382, "body": "Thanks for your feedback. Could you please give an example using <code>c_loc</code>? That would be great!"}, {"owner": {"reputation": 24099, "user_id": 3157076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mB4zi.png?s=128&g=1", "display_name": "francescalus", "link": "https://stackoverflow.com/users/3157076/francescalus"}, "reply_to_user": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "edited": false, "score": 0, "creation_date": 1531240798, "post_id": 51269204, "comment_id": 89518872, "body": "You do of course have the (non-portable) option of trying to understand gfortran&#39;s array descriptor which is passed (those first 528 bytes in this case).  Even if I could help there I would advise heavily against it."}, {"owner": {"reputation": 4153, "user_id": 2938526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aba561f633da5f6fe58b227c5e685b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Rodrigues", "link": "https://stackoverflow.com/users/2938526/rodrigo-rodrigues"}, "edited": false, "score": 0, "creation_date": 1531247470, "post_id": 51269204, "comment_id": 89522006, "body": "Check <a href=\"https://gcc.gnu.org/onlinedocs/gfortran/Further-Interoperability-of-Fortran-with-C.html\" rel=\"nofollow noreferrer\">this</a> for further information on the status of this feature in gfortran. Also, if you want to dive into the gfortran array descriptor, take look at <a href=\"https://thinkingeek.com/2017/01/14/gfortran-array-descriptor/\" rel=\"nofollow noreferrer\">this</a>."}], "tags": [], "owner": {"reputation": 24099, "user_id": 3157076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mB4zi.png?s=128&g=1", "display_name": "francescalus", "link": "https://stackoverflow.com/users/3157076/francescalus"}, "is_accepted": true, "score": 3, "last_activity_date": 1531238396, "last_edit_date": 1531238396, "creation_date": 1531236745, "answer_id": 51269204, "question_id": 51268567, "link": "https://stackoverflow.com/questions/51268567/passing-both-scalars-and-arrays-of-any-dimensions-from-fortran-to-c/51269204#51269204", "title": "Passing both scalars and arrays (of any dimensions) from Fortran to C", "body": "<p>Although your first case, with scalar argument, works correctly matching with the <code>void*</code> argument, when the argument to the call is assumed-rank (which <code>type(*), dimension(..) :: variable</code> represents) the Fortran procedure is not interoperable with the C procedure with corresponding formal argument <code>const void *variable</code>.</p>\n\n<p>Instead, it is necessary to use the <code>CFI_cdesc_t</code> mechanism:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ISO_Fortran_binding.h&gt;\n\nvoid show_value(const CFI_cdesc_t* variable)\n{\n  printf(\"%d\\n\", *(int*) variable-&gt;base_addr);\n}\n</code></pre>\n\n<p>You can find details of this in Fortran 2018 18.5.3.</p>\n\n<p>Essentially, however, this is a descriptor which has much of the detail of the Fortran entity.  Here, <code>base_addr</code> is the start of the data, but you'll also find allocatable/pointer/data status, rank, extents, type.</p>\n\n<p>Alas, gfortran 4.9 doesn't support this.  If it is supported at all, it will be in only very recent versions.</p>\n\n<hr>\n\n<p>Alternatively, you may avoid using an assumed-rank assumed-type actual argument and pass instead the C-address of the argument using <code>c_loc</code>.  Not quite so elegant, but more widely supported:</p>\n\n<pre><code>use, intrinsic :: iso_c_binding, only : c_loc, c_ptr, c_int\ninterface\n  subroutine show_value(variable) bind(c)\n    import c_ptr\n    type(c_ptr), value :: variable\n  end subroutine\nend interface\n\ninteger(c_int), target :: x, y(3)\n\nx = 12\ny = [15, 17, 19]\n\ncall show_value(c_loc(x))\ncall show_value(c_loc(y))\n\nend\n</code></pre>\n\n<p>This, however, leaves the problem of how the C function knows what to do with the argument.</p>\n"}], "owner": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 1, "accepted_answer_id": 51269204, "answer_count": 1, "score": 4, "last_activity_date": 1531238396, "creation_date": 1531234966, "last_edit_date": 1531236988, "question_id": 51268567, "link": "https://stackoverflow.com/questions/51268567/passing-both-scalars-and-arrays-of-any-dimensions-from-fortran-to-c", "title": "Passing both scalars and arrays (of any dimensions) from Fortran to C", "body": "<p>I have the following Fortran subroutine named <code>show_value</code> that calls a C function named <code>show_value</code>:</p>\n\n<pre class=\"lang-fortran prettyprint-override\"><code>INTERFACE\n    SUBROUTINE show_value(variable) BIND(C, name = \"show_value\")\n        USE, INTRINSIC :: iso_c_binding\n        TYPE(*) :: variable\n    END SUBROUTINE\nEND INTERFACE\n</code></pre>\n\n<p>The C function <code>show_value</code>:</p>\n\n<pre><code>void show_value(const void *variable)\n{\n    printf(\"%d\\n\", *(int *) variable);\n}\n</code></pre>\n\n<p>The Fortran subroutine works well when passing scalars to it. Example:</p>\n\n<pre class=\"lang-fortran prettyprint-override\"><code>INTEGER :: x\nx = 12\ncall show_value(x)\n</code></pre>\n\n<p>This will call the C function <code>show_value</code> and print <code>12</code>, which is correct.</p>\n\n<p>Now, according to the Fortran documentation, if one wants to enable subroutine <code>show_value</code> to receive also arrays (of any dimensions) and not just scalars, the line <code>TYPE(*) :: variable</code> should be changed to <code>TYPE(*), DIMENSION(..) :: variable</code>.</p>\n\n<p>After making this change, when executing the following Fortran code:</p>\n\n<pre class=\"lang-fortran prettyprint-override\"><code>INTEGER, DIMENSION(3) :: y\ny(1) = 15\ny(2) = 17\ny(3) = 19\ncall show_value(y)\n</code></pre>\n\n<p>The C function <code>show_value</code> no longer prints the correct message (i.e. prints random numbers). Moreover, I found out that the address that the C function receives is 528 lower than the original (in Fortran). To confirm this:</p>\n\n<pre><code>void show_value(const void *variable)\n{\n    printf(\"%d\\n\", *(int *) (variable + 528));\n}\n</code></pre>\n\n<p>... which prints <code>15</code> (correct number).</p>\n\n<p>Any idea what is going here?</p>\n\n<p>Environment: Ubuntu 14.04 64 bit, gfortran 4.9</p>\n"}, {"tags": ["c", "windows", "cmake", "cuda"], "comments": [{"owner": {"reputation": 739, "user_id": 8281970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHXs.jpg?s=128&g=1", "display_name": "Ketan Mukadam", "link": "https://stackoverflow.com/users/8281970/ketan-mukadam"}, "edited": false, "score": 1, "creation_date": 1531236068, "post_id": 51268433, "comment_id": 89516116, "body": "Is <a href=\"https://stackoverflow.com/questions/41385346/error-undefined-reference-to-cudaregisterlinkedbinary-when-compiling-cuda-w\">this post</a> useful for you?"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531238309, "post_id": 51268433, "comment_id": 89517560, "body": "You don&#39;t need separate compilation for that use case, but it is likely you are missing a device linking stage"}, {"owner": {"reputation": 354, "user_id": 1103014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e383ebb3fd71fb1f693c852e42e3458e?s=128&d=identicon&r=PG", "display_name": "Dullson", "link": "https://stackoverflow.com/users/1103014/dullson"}, "reply_to_user": {"reputation": 739, "user_id": 8281970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHXs.jpg?s=128&g=1", "display_name": "Ketan Mukadam", "link": "https://stackoverflow.com/users/8281970/ketan-mukadam"}, "edited": false, "score": 0, "creation_date": 1531238844, "post_id": 51268433, "comment_id": 89517874, "body": "@KetanMukadam I saw that post before asking my question, It is for an older version of cmake when cuda wasn&#39;t a first-class language. <a href=\"https://cmake.org/cmake/help/latest/module/FindCUDA.html\" rel=\"nofollow noreferrer\">Cmake help page</a> says most of that stuff isn&#39;t required now and is kept for the compatibility reasons. Also, their building system is Linux, not windows. Still, I have tried the suggestions posted in there but no luck."}, {"owner": {"reputation": 354, "user_id": 1103014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e383ebb3fd71fb1f693c852e42e3458e?s=128&d=identicon&r=PG", "display_name": "Dullson", "link": "https://stackoverflow.com/users/1103014/dullson"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531239693, "post_id": 51268433, "comment_id": 89518308, "body": "@talonmies This is just a barebones example to demonstrate what I am trying to achieve. The separate compilation is required for the real project. It may or may not be related to the problem I am facing right now. I also suspect the linking stage and shared my findings. Cmake is supposed to handle all the middle steps here so it&#39;s not like I am skipping a command for the linking."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1531319449, "post_id": 51268433, "comment_id": 89553903, "body": "You didn&#39;t show the <i>device</i> linking output, which is where the problem is occurring. And this isn&#39;t a missing library, it is a missing operation on the GPU object files which nvcc is emitting"}, {"owner": {"reputation": 354, "user_id": 1103014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e383ebb3fd71fb1f693c852e42e3458e?s=128&d=identicon&r=PG", "display_name": "Dullson", "link": "https://stackoverflow.com/users/1103014/dullson"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531355201, "post_id": 51268433, "comment_id": 89569047, "body": "@talonmies I am adding full console output if you are curious about the whole process."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1531373413, "post_id": 51268433, "comment_id": 89572852, "body": "There is something broken in that log output. kernel.cu is being compiled twice, but there is no device linking step."}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 1103014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e383ebb3fd71fb1f693c852e42e3458e?s=128&d=identicon&r=PG", "display_name": "Dullson", "link": "https://stackoverflow.com/users/1103014/dullson"}, "is_accepted": true, "score": 3, "last_activity_date": 1532738380, "last_edit_date": 1532738380, "creation_date": 1532736486, "answer_id": 51566919, "question_id": 51268433, "link": "https://stackoverflow.com/questions/51268433/cmake-error-while-linking-c-code-with-cuda/51566919#51566919", "title": "CMake error while linking C code with CUDA", "body": "<p>I think I got a solution on the issue. ( thanks for the guidance @talonmies )</p>\n\n<p>I had to force device linking using:</p>\n\n<pre><code>set_property(TARGET c-lib PROPERTY CUDA_RESOLVE_DEVICE_SYMBOLS ON)\n</code></pre>\n\n<p>and it works!</p>\n\n<p>from <code>CUDA_RESOLVE_DEVICE_SYMBOLS</code> man page:</p>\n\n<blockquote>\n  <p>CUDA only: Enables device linking for the specific static library\n  target</p>\n  \n  <p>If set this will enable device linking on this static library target.\n  Normally device linking is deferred until a shared library or\n  executable is generated, allowing for multiple static libraries to\n  resolve device symbols at the same time.</p>\n</blockquote>\n\n<p>I am still not sure why my executable generation doesn't trigger a device link before host linking everything together.</p>\n\n<p><strong>Edit:</strong> Looks like it is a <a href=\"https://gitlab.kitware.com/cmake/cmake/issues/17520\" rel=\"nofollow noreferrer\">known bug</a> which affects windows builds but works fine on linux.</p>\n"}], "owner": {"reputation": 354, "user_id": 1103014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e383ebb3fd71fb1f693c852e42e3458e?s=128&d=identicon&r=PG", "display_name": "Dullson", "link": "https://stackoverflow.com/users/1103014/dullson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 1, "accepted_answer_id": 51566919, "answer_count": 1, "score": 2, "last_activity_date": 1532738380, "creation_date": 1531234594, "last_edit_date": 1531354329, "question_id": 51268433, "link": "https://stackoverflow.com/questions/51268433/cmake-error-while-linking-c-code-with-cuda", "title": "CMake error while linking C code with CUDA", "body": "<p>I am having linking errors while building a project using cmake. The build was doing fine on linux using a makefile (manually generated / no cmake) but windows build is giving me problems.\nHere is a barebones example to demonstrate my approach:</p>\n\n<p>I have 3 files in the same directory ( kernel.cu, kernel.h, main.c)</p>\n\n<p>main.c:</p>\n\n<pre><code>extern void kernel_wrapper();\nint main(){\n    kernel_wrapper();\n}\n</code></pre>\n\n<p>kernel.h:</p>\n\n<pre><code>#ifndef KERNELH\n#define KERNELH \nextern \"C\" void kernel_wrapper();\n#endif\n</code></pre>\n\n<p>kernel.cu:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"kernel.h\"\n\n__global__ void kernel (){\n    printf(\"hello from GPU!\");\n}\n\nvoid kernel_wrapper(){\n    kernel&lt;&lt;&lt;1,1&gt;&gt;&gt;();\n}\n</code></pre>\n\n<p>I want to use separable compilation so the host code is isolated from device code using externs.\nHere is the CMakeLists.txt file I am using:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.9 FATAL_ERROR)\nproject(cudatest LANGUAGES C CUDA)\nadd_executable(c-exec main.c)\nadd_library(cu-lib STATIC kernel.cu kernel.h)\nset_target_properties(cu-lib PROPERTIES CUDA_SEPARABLE_COMPILATION ON)\ntarget_link_libraries(c-exec PUBLIC cu-lib)\n</code></pre>\n\n<p>The library and the executable compile successfully but when it comes to linking step, the following error occurs:</p>\n\n<pre><code>cu-lib.lib(kernel.obj) : error LNK2019: unresolved external symbol __cudaRegisterLinkedBi\nnary_41_tmpxft_00003dd0_00000000_7_kernel_cpp1_ii_b81a68a1 referenced in function \"void _\n_cdecl __nv_cudaEntityRegisterCallback(void * *)\" (?__nv_cudaEntityRegisterCallback@@YAXP\nEAPEAX@Z) [C:\\cudatest\\build\\c-exec.vcxproj]\nC:\\cudatest\\build\\Debug\\c-exec.exe : fatal error LNK1120: 1 unresolved externals [C:\\cuda\ntest\\build\\c-exec.vcxproj]\n</code></pre>\n\n<p>It sounds like the linker is missing some includes to libraries (probably cudart?) however, link command on the console looks normal to me, with the static includes and everything:</p>\n\n<pre><code>Link:\n  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\link.exe /ERRORREP\n  ORT:QUEUE /OUT:\"C:\\cudatest\\build\\Debug\\c-exec.exe\" /INCREMENTAL /NOLOGO /LIBPATH:\"C:\\P\n  rogram Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\lib\\x64\" \"Debug\\cu-lib.lib\" cudart_\n  static.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut3\n  2.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTUAC:\"level='asInvoker' uiAc\n  cess='false'\" /manifest:embed /DEBUG /PDB:\"C:/cudatest/build/Debug/c-exec.pdb\" /SUBSYST\n  EM:CONSOLE /TLBID:1 /DYNAMICBASE /NXCOMPAT /IMPLIB:\"C:/cudatest/build/Debug/c-exec.lib\"\n   /MACHINE:X64  /machine:x64 \"c-exec.dir\\Debug\\main.obj\"\n</code></pre>\n\n<p>I am clueless at the moment.  If I give up on the separate compilation (change add_executable parameters to \"c-exec main.c kernel.h kernel.cu\" and skip library step) problem disappears, but I am required to use separate compilation.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13553015/cuda-c-linker-error-undefined-reference\">This</a> question looks relevant to mine and I tried to apply the solution suggested there. Placing externs around include line and before function definition changed nothing. </p>\n\n<p>I am using Windows 10 with Cmake v3.11.4, CUDA v9.2 and select cmake generator using \"cmake -G \"Visual Studio 15 2017 Win64\" -T v140\" since the latest version of Visual Studio doesn't get supported by CUDA yet.</p>\n\n<p>Edit: Added full console output</p>\n\n<pre><code>Build started 12.07.2018 03:03:42.\nProject \"C:\\cudatest\\build\\ALL_BUILD.vcxproj\" on node 1 (default targets).\nProject \"C:\\cudatest\\build\\ALL_BUILD.vcxproj\" (1) is building \"C:\\cudatest\\build\\ZERO_\nCHECK.vcxproj\" (2) on node 1 (default targets).\nPrepareForBuild:\n  Creating directory \"x64\\Debug\\ZERO_CHECK\\\".\n  Creating directory \"x64\\Debug\\ZERO_CHECK\\ZERO_CHECK.tlog\\\".\nInitializeBuildStatus:\n  Creating \"x64\\Debug\\ZERO_CHECK\\ZERO_CHECK.tlog\\unsuccessfulbuild\" because \"AlwaysCre\n  ate\" was specified.\nCustomBuild:\n  Checking Build System\n  CMake does not need to re-run because C:/cudatest/build/CMakeFiles/generate.stamp is\n   up-to-date.\nFinalizeBuildStatus:\n  Deleting file \"x64\\Debug\\ZERO_CHECK\\ZERO_CHECK.tlog\\unsuccessfulbuild\".\n  Touching \"x64\\Debug\\ZERO_CHECK\\ZERO_CHECK.tlog\\ZERO_CHECK.lastbuildstate\".\nDone Building Project \"C:\\cudatest\\build\\ZERO_CHECK.vcxproj\" (default targets).\n\nProject \"C:\\cudatest\\build\\ALL_BUILD.vcxproj\" (1) is building \"C:\\cudatest\\build\\c-exe\nc.vcxproj\" (3) on node 1 (default targets).\nProject \"C:\\cudatest\\build\\c-exec.vcxproj\" (3) is building \"C:\\cudatest\\build\\cu-lib.v\ncxproj\" (4) on node 1 (default targets).\nPrepareForBuild:\n  Creating directory \"cu-lib.dir\\Debug\\\".\n  Creating directory \"C:\\cudatest\\build\\Debug\\\".\n  Creating directory \"cu-lib.dir\\Debug\\cu-lib.tlog\\\".\nInitializeBuildStatus:\n  Creating \"cu-lib.dir\\Debug\\cu-lib.tlog\\unsuccessfulbuild\" because \"AlwaysCreate\" was\n   specified.\nCustomBuild:\n  Building Custom Rule C:/cudatest/CMakeLists.txt\n  CMake does not need to re-run because C:/cudatest/build/CMakeFiles/generate.stamp is\n   up-to-date.\nAddCudaCompileDeps:\n  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\cl.exe /E /nolo\n  go /showIncludes /TP /D__CUDACC__ /D_WINDOWS /DCMAKE_INTDIR=\"Debug\" /DCMAKE_INTDIR=\"\n  Debug\" /D_MBCS /I\"C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\include\" /\n  I\"C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\bin\" /I\"C:\\Program Files\\N\n  VIDIA GPU Computing Toolkit\\CUDA\\v9.2\\include\" /I. /FIcuda_runtime.h /c C:\\cudatest\\\n  kernel.cu\nProject \"C:\\cudatest\\build\\cu-lib.vcxproj\" (4) is building \"C:\\cudatest\\build\\cu-lib.v\ncxproj\" (4:2) on node 1 (CudaBuildCore target(s)).\nCudaBuildCore:\n  Compiling CUDA source file ..\\kernel.cu...\n  cmd.exe /C \"C:\\Users\\dulls\\AppData\\Local\\Temp\\tmpd0a36f1624184bf982dc8082e9a727be.cm\n  d\"\n  \"C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\bin\\nvcc.exe\" -gencode=arch\n  =compute_30,code=\\\"sm_30,compute_30\\\" --use-local-env -ccbin \"C:\\Program Files (x86)\n  \\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\" -x cu -rdc=true -I\"C:\\Program Files\\\n  NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\include\" -I\"C:\\Program Files\\NVIDIA GPU Compu\n  ting Toolkit\\CUDA\\v9.2\\include\"     --keep-dir x64\\Debug -maxrregcount=0  --machine\n  64 --compile -cudart static -Xcompiler=\"/EHsc -Zi -Ob0\" -g   -D\"_WINDOWS\" -D\"CMAKE_I\n  NTDIR=\\\"Debug\\\"\" -D\"CMAKE_INTDIR=\\\"Debug\\\"\" -D_MBCS -Xcompiler \"/EHsc /W3 /nologo /O\n  d /FS /Zi /RTC1 /MDd /GR\" -o cu-lib.dir\\Debug\\kernel.obj \"C:\\cudatest\\kernel.cu\"\n\n  C:\\cudatest\\build&gt;\"C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\bin\\nvcc.\n  exe\" -gencode=arch=compute_30,code=\\\"sm_30,compute_30\\\" --use-local-env -ccbin \"C:\\P\n  rogram Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\" -x cu -rdc=true -I\n  \"C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\include\" -I\"C:\\Program File\n  s\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\include\"     --keep-dir x64\\Debug -maxrregc\n  ount=0  --machine 64 --compile -cudart static -Xcompiler=\"/EHsc -Zi -Ob0\" -g   -D\"_W\n  INDOWS\" -D\"CMAKE_INTDIR=\\\"Debug\\\"\" -D\"CMAKE_INTDIR=\\\"Debug\\\"\" -D_MBCS -Xcompiler \"/E\n  Hsc /W3 /nologo /Od /FS /Zi /RTC1 /MDd /GR\" -o cu-lib.dir\\Debug\\kernel.obj \"C:\\cudat\n  est\\kernel.cu\"\n  kernel.cu\nDone Building Project \"C:\\cudatest\\build\\cu-lib.vcxproj\" (CudaBuildCore target(s)).\n\nLib:\n  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\Lib.exe /OUT:\"C\n  :\\cudatest\\build\\Debug\\cu-lib.lib\" /NOLOGO /MACHINE:X64  /machine:x64 \"cu-lib.dir\\De\n  bug\\kernel.obj\"\n  cu-lib.vcxproj -&gt; C:\\cudatest\\build\\Debug\\cu-lib.lib\nFinalizeBuildStatus:\n  Deleting file \"cu-lib.dir\\Debug\\cu-lib.tlog\\unsuccessfulbuild\".\n  Touching \"cu-lib.dir\\Debug\\cu-lib.tlog\\cu-lib.lastbuildstate\".\nDone Building Project \"C:\\cudatest\\build\\cu-lib.vcxproj\" (default targets).\n\nPrepareForBuild:\n  Creating directory \"c-exec.dir\\Debug\\\".\n  Creating directory \"c-exec.dir\\Debug\\c-exec.tlog\\\".\nInitializeBuildStatus:\n  Creating \"c-exec.dir\\Debug\\c-exec.tlog\\unsuccessfulbuild\" because \"AlwaysCreate\" was\n   specified.\nCustomBuild:\n  Building Custom Rule C:/cudatest/CMakeLists.txt\n  CMake does not need to re-run because C:/cudatest/build/CMakeFiles/generate.stamp is\n   up-to-date.\nClCompile:\n  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\CL.exe /c /I\"C:\n  \\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\include\" /Zi /nologo /W3 /WX-\n  /Od /Ob0 /D \"WIN32\" /D \"_WINDOWS\" /D \"CMAKE_INTDIR=\\\"Debug\\\"\" /D _MBCS /Gm- /RTC1 /M\n  Dd /GS /fp:precise /Zc:wchar_t /Zc:forScope /Zc:inline /Fo\"c-exec.dir\\Debug\\\\\" /Fd\"c\n  -exec.dir\\Debug\\vc140.pdb\" /Gd /TC /errorReport:queue C:\\cudatest\\main.c\n  main.c\nLink:\n  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\link.exe /ERROR\n  REPORT:QUEUE /OUT:\"C:\\cudatest\\build\\Debug\\c-exec.exe\" /INCREMENTAL /NOLOGO /LIBPATH\n  :\"C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\lib\\x64\" \"Debug\\cu-lib.lib\n  \" cudart_static.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32\n  .lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTUAC:\"level='\n  asInvoker' uiAccess='false'\" /manifest:embed /DEBUG /PDB:\"C:/cudatest/build/Debug/c-\n  exec.pdb\" /SUBSYSTEM:CONSOLE /TLBID:1 /DYNAMICBASE /NXCOMPAT /IMPLIB:\"C:/cudatest/bu\n  ild/Debug/c-exec.lib\" /MACHINE:X64  /machine:x64 \"c-exec.dir\\Debug\\main.obj\"\n     Creating library C:/cudatest/build/Debug/c-exec.lib and object C:/cudatest/build/\n  Debug/c-exec.exp\ncu-lib.lib(kernel.obj) : error LNK2019: unresolved external symbol __cudaRegisterLinke\ndBinary_41_tmpxft_00013688_00000000_7_kernel_cpp1_ii_b81a68a1 referenced in function \"\nvoid __cdecl __nv_cudaEntityRegisterCallback(void * *)\" (?__nv_cudaEntityRegisterCallb\nack@@YAXPEAPEAX@Z) [C:\\cudatest\\build\\c-exec.vcxproj]\nC:\\cudatest\\build\\Debug\\c-exec.exe : fatal error LNK1120: 1 unresolved externals [C:\\c\nudatest\\build\\c-exec.vcxproj]\nDone Building Project \"C:\\cudatest\\build\\c-exec.vcxproj\" (default targets) -- FAILED.\n\nDone Building Project \"C:\\cudatest\\build\\ALL_BUILD.vcxproj\" (default targets) -- FAILE\nD.\n\n\nBuild FAILED.\n\n\"C:\\cudatest\\build\\ALL_BUILD.vcxproj\" (default target) (1) -&gt;\n\"C:\\cudatest\\build\\c-exec.vcxproj\" (default target) (3) -&gt;\n(Link target) -&gt;\n  cu-lib.lib(kernel.obj) : error LNK2019: unresolved external symbol __cudaRegisterLin\nkedBinary_41_tmpxft_00013688_00000000_7_kernel_cpp1_ii_b81a68a1 referenced in function\n \"void __cdecl __nv_cudaEntityRegisterCallback(void * *)\" (?__nv_cudaEntityRegisterCal\nlback@@YAXPEAPEAX@Z) [C:\\cudatest\\build\\c-exec.vcxproj]\n  C:\\cudatest\\build\\Debug\\c-exec.exe : fatal error LNK1120: 1 unresolved externals [C:\n\\cudatest\\build\\c-exec.vcxproj]\n\n    0 Warning(s)\n    2 Error(s)\n</code></pre>\n"}, {"tags": ["c", "doxygen", "local-variables", "dependency-graph"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531233854, "post_id": 51268088, "comment_id": 89514568, "body": "I have <i>never</i> seen anything like that. Moreover, I highly doubt it is possible for C (well, maybe just partially) as the same object can be accessed in some non-obvious and not visible to implementation ways."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531234416, "post_id": 51268088, "comment_id": 89514944, "body": "I guess this asks for the obvious ways i.e. which function is dependent on which symbol?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531234616, "post_id": 51268088, "comment_id": 89515080, "body": "Apart from what @EugeneSh mentioned  once you have code, use <code>cscope</code>, it gives all option including <i>which function calls whom</i>."}, {"owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1531236855, "post_id": 51268088, "comment_id": 89516638, "body": "Regarding doxygen there are small possibilities. Global variables are shown by means of the setting of <code>REFERENCED_BY_RELATION = YES</code> and <code>REFERENCES_RELATION    = YES</code>. It does not follow the variable when it is passed as an argument, just when it is used &quot;plain&quot; it is shown. You can see this in the HTML documentation but also in the xml output (<code>GENERATE_XML=YES</code>), the later can be used for some own processing."}, {"owner": {"reputation": 33, "user_id": 4804522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7dc98980a837917202c46b9468a23aa?s=128&d=identicon&r=PG&f=1", "display_name": "murph_sof", "link": "https://stackoverflow.com/users/4804522/murph-sof"}, "edited": false, "score": 0, "creation_date": 1531242033, "post_id": 51268088, "comment_id": 89519468, "body": "I am especially NOT looking for which function calls which other function! I need the information of how a specific variable affects other variables. So the solution is NOT a call graph like from doxygen (right?)"}, {"owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1531243740, "post_id": 51268088, "comment_id": 89520312, "body": "It is not a call graph it is just a list where the variable is used (when using REF...)."}, {"owner": {"reputation": 3432, "user_id": 604642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48daad611ba387f8473b0c1e5792aa3f?s=128&d=identicon&r=PG", "display_name": "shawnhcorey", "link": "https://stackoverflow.com/users/604642/shawnhcorey"}, "edited": false, "score": 0, "creation_date": 1532089634, "post_id": 51268088, "comment_id": 89854865, "body": "Data is transferred between function via arguments and return values or via global variables. A function-call graph is the way to start but I know of no tool that shows global variables in them."}], "owner": {"reputation": 33, "user_id": 4804522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7dc98980a837917202c46b9468a23aa?s=128&d=identicon&r=PG&f=1", "display_name": "murph_sof", "link": "https://stackoverflow.com/users/4804522/murph-sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531233610, "creation_date": 1531233610, "question_id": 51268088, "link": "https://stackoverflow.com/questions/51268088/tool-to-view-variable-dependencies", "title": "Tool to view variable dependencies", "body": "<p>I try to understand how variables in a c code influence each other. I was searching for hours for a tool. Doxygen, etc will give me call graphs (\u201cwhich function calls whom?\u201c), but does not provide information on specifically the variables/data.\nA dependency matrix generated from source code would help for example.</p>\n\n<p>How can I best visualize this?</p>\n"}, {"tags": ["c++", "c", "wrapper"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1531232528, "post_id": 51267562, "comment_id": 89513643, "body": "You are getting the error because the type <i>is</i> incomplete. The <i>definition</i> of <code>wr_Class</code> is not available where you are trying to <code>new</code> it. Also please remove all the boilerplate comments and irrelevant code (relevant read: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>), it makes this a lot harder to read"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1531232697, "post_id": 51267562, "comment_id": 89513790, "body": "The code you reference defines the wrapper struct. Your code doesn&#39;t. It&#39;s as simple as that; it has nothing to do with DLLs."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1531234945, "post_id": 51267562, "comment_id": 89515311, "body": "<i>&quot;Copyright:    (c) 2018 Infrared Telemetrics, Inc.&quot;</i> raises some eyebrows."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1531232761, "creation_date": 1531232761, "answer_id": 51267797, "question_id": 51267562, "link": "https://stackoverflow.com/questions/51267562/how-do-i-resolve-invalid-use-of-incomplete-type-in-wrapper-code/51267797#51267797", "title": "How do I resolve &quot;Invalid use of incomplete type&quot; in Wrapper Code?", "body": "<p>In Wrapper.cpp, no definition of <code>struct wr_Class_Ignored</code> exists so you can't access any of its members.</p>\n\n<p>The actual definition of this class probably exists in a separate header, so include that header in Wrapper.cpp.  You'll see that the example code you modeled from does the same.</p>\n"}], "owner": {"reputation": 3, "user_id": 4028684, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000020922962/picture?type=large", "display_name": "Colleen Kobe", "link": "https://stackoverflow.com/users/4028684/colleen-kobe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1531232761, "creation_date": 1531232112, "question_id": 51267562, "link": "https://stackoverflow.com/questions/51267562/how-do-i-resolve-invalid-use-of-incomplete-type-in-wrapper-code", "title": "How do I resolve &quot;Invalid use of incomplete type&quot; in Wrapper Code?", "body": "<p>I'm trying to write Wrapper code so that I can call C++ routines from C. The C++ routines will be in an EXE file, while the C routines will be in a DLL.  The wrapper code will be in a separate DLL.</p>\n\n<p>I used the code on <a href=\"https://www.teddy.ch/c++_library_in_c/\" rel=\"nofollow noreferrer\">https://www.teddy.ch/c++_library_in_c/</a> as a blueprint, but in that example, all the code ends up in a single EXE.  I've edited my Wrapper code to produce a DLL.</p>\n\n<p>I'm trying to build only the Wrapper code DLL right now.  The Wrapper code DLL consists of three files:  Wrapper.h, Wrapper.cpp, and datatypes.h.  I'm getting \"Invalid use of incomplete type\" and \"forward declaration\" errors when I try to compile the wrapper code.  I understand I'm getting the errors because \"wr_Class\" is declared, but not defined. But where do I add a definition for a class, and how do I word it as a C program?</p>\n\n<p>And why doesn't the code that I'm basing my code on, get those errors? They don't define the type, either. Ever. But their code compiles and runs. I know this because I copied and ran it.  The big difference that I can see is that their code results in one executable, and mine results in one DLL.</p>\n\n<p>I've looked here on Stack Overflow for answers. But the wrapper code examples I've seen here either do not produce wrapper code in its own DLL, and/or they don't define the Class struct either.</p>\n\n<p>Wrapper.h -- I added leading line numbers for reference.</p>\n\n<pre><code> 1. // *****************************************************************************\n 2. // *                             W r a p p e r . h                             *\n 3. // *                                                                           *\n 4. // *                        C &lt;----&gt; Wrapper &lt;----&gt; C++                        *\n 5. // *                                                                           *\n 6. // *  Programmer:   Colleen Kobe                                               *\n 7. // *                                                                           *\n 8. // *  Project:      Small Business Innovative Research (SBIR) AF051-071,       *\n 9. // *                Phase 2                                                    *\n10. // *  Date:         July 09, 2018                                              *\n11. // *    Revised:    tbd                                                        *\n12. // *                                                                           *\n13. // *  Description:  This C header file contains the \"wrapper\" code that allows *\n14. // *                data to be passed between the C and C++ code in this       *\n15. // *                project.                                                   *\n16. // *                                                                           *\n17. // *                This code was based on the code on:                        *\n18. // *                https://www.teddy.ch/c++_library_in_c/                     *\n19. // *                                                                           *\n20. // *  Copyright :    (c) 2018 Infrared Telemetrics, Inc.                       *\n21. // *****************************************************************************\n22.\n23. #ifndef WRAPPER_H\n24. #define WRAPPER_H\n25.\n26. // =============================================================================\n27. //                               Compiler Options\n28. // =============================================================================\n29.\n30. // Make sure functions are exported with C linkage under C++ compilers.\n31. #ifdef __cplusplus\n32. extern \"C\"\n33. {                                       // Export the code below with C linkage.\n34. #endif                                  // Close this block below.\n35.\n36.\n37. #define DllExport  __declspec (dllexport)   // Add this code to a DLL.\n38. #define DllImport  __declspec (dllimport)\n39. #define CALL_TYPE  __stdcall\n40.\n41.\n42. // =============================================================================\n43. //                             External Header Files\n44. // =============================================================================\n45. #include \"datatypes.h\"                  //  2 a\n46.\n47. // =============================================================================\n48. //                               Global Constants\n49. // =============================================================================\n50. // tbd\n51.\n52. // =============================================================================\n53. //                                 Global Types\n54. // =============================================================================\n55. typedef struct  wr_Class_Ignored    wr_Class;   // \"C\" definition of Wrapper_Class.\n56.\n57.\n58. // =============================================================================\n59. //                               Global Variables\n60. // =============================================================================\n61. // wr_Class*   Local_wr_Ptr;        // Local pointer to Wrapper_Class.\n62.\n63.\n64. // =============================================================================\n65. //                                  Prototypes\n66. // =============================================================================\n67. DllExport   void        CALL_TYPE   wr_Initialize               (void);         // Perform initialization.\n68.\n69. DllExport   wr_Class*   CALL_TYPE   wr_Create_New_Wrapper_Class (void);         // Create a \"new\" wrapper class.\n70.\n71. DllExport   void        CALL_TYPE   wr_Delete_Wrapper_Class     (wr_Class* wr); // \"Delete\" a wrapper class.\n72.\n73. DllExport   void        CALL_TYPE   wr_Terminate                (void);         // Perform termination.\n74.\n75. // .............................................................................\n76. //  Add these in later, one by one\n77. // .............................................................................\n78.\n79. // void     wr_Set_P07_NACK_Counter (wr_Class*  wr,     UInt32 n);   // Set Qty_P07_NACKS_Received.\n80. // UInt32   wr_Get_P07_NACK_Counter (wr_Class*  wr);                 // Get Qty_P07_NACKS_Received.\n81. // void     wr_mf_Set_P08_SysID     (wr_Class*  wr,     char   SysID_ch [gd_bg_P08_QTY_DATAWORDS]); // Set P08 SysID.\n82. // void     wr_mf_Get_P08_SysID     (wr_Class*  wr,     char * SysID_ch [gd_bg_P08_QTY_DATAWORDS]); // Set P08 SysID.\n83.\n84.\n85. #ifdef __cplusplus\n86. }               // Export the following code with C linkage.\n87. #endif\n88.\n89. #endif // WRAPPER_H\n</code></pre>\n\n<p>Wrapper.cpp -- again, I added leading line numbers for reference</p>\n\n<pre><code>  1. // *****************************************************************************\n  2. // *                           W r a p p e r . c p p                           *\n  3. // *                                                                           *\n  4. // *                        C &lt;----&gt; Wrapper &lt;----&gt; C++                        *\n  5. // *                                                                           *\n  6. // *  Programmer:   Colleen Kobe                                               *\n  7. // *                                                                           *\n  8. // *  Project:      Small Business Innovative Research (SBIR) AF051-071,       *\n  9. // *                Phase 2                                                    *\n 10. // *  Date:         July 09, 2018                                              *\n 11. // *    Revised:    tbd                                                        *\n 12. // *                                                                           *\n 13. // *  Description:  This C header file contains the \"wrapper\" code that allows *\n 14. // *                data to be passed between the C and C++ code in this       *\n 15. // *                project.                                                   *\n 16. // *                                                                           *\n 17. // *                This code was based on the code on:                        *\n 18. // *                https://www.teddy.ch/c++_library_in_c/                     *\n 19. // *                                                                           *\n 20. // *  Copyright :    (c) 2018 Infrared Telemetrics, Inc.                       *\n 21. // *****************************************************************************\n 22.\n 23. // =============================================================================\n 24. //                             External Header Files\n 25. // =============================================================================\n 26. #include \"Wrapper.h\"                    //  5 w\n 27.\n 28. // =============================================================================\n 29. //                            Set Up Compiler Options\n 30. // =============================================================================\n 31. extern \"C\" {\n 32.\n 33. #define CALL_TYPE __stdcall\n 34.\n 35.\n 36. // =============================================================================\n 37. //                        Constants Public in This File\n 38. // =============================================================================\n 39. // tbd\n 40.\n 41. // =============================================================================\n 42. //                               Global Variables\n 43. // =============================================================================\n 44. UInt32      Qty_P07_NACKS_Received;\n 45. wr_Class*   Local_wr_Ptr;\n 46.\n 47. // P07_NACK_Pkts   P07_NACKS;           // tbd -- add in later\n 48. // P07_Packet      P07_Pkt;             // tbd -- add in later\n 49.\n 50.\n 51. // +===========================================================================+\n 52. // |                               wr_Initialize                               |\n 53. // |                                                                           |\n 54. // |  Description:  Performs the necessary initialization for the Wrapper      |\n 55. // |                code.                                                      |\n 56. // +===========================================================================+\n 57. DllExport   void        CALL_TYPE   wr_Initialize   (void)\n 58. {\n 59.     Local_wr_Ptr = wr_Create_New_Wrapper_Class ();  //  Create a new Local_wr_Ptr;\n 60. } // wr_Initialize\n 61.\n 62.\n 63. // +===========================================================================+\n 64. // |                        wr_Create_New_Wrapper_Class                        |\n 65. // |                                                                           |\n 66. // |  Description:  Creates a new instance of Wrapper_Class, and returns a     |\n 67. // |                pointer to it.                                             |\n 68. // +===========================================================================+\n 69. DllExport   wr_Class*   CALL_TYPE   wr_Create_New_Wrapper_Class (void)\n 70. {\n 71.\n 72.     wr_Class*   temp_wr_ptr;    // for debugging--shorten this code when it's clear that it works.\n 73.     temp_wr_ptr =   new wr_Class;\n 74.\n 75.     return  (temp_wr_ptr);\n 76.\n 77. } // wr_Create_New_Wrapper_Class\n 78.\n 79.\n 80. // +===========================================================================+\n 81. // |                          wr_Delete_Wrapper_Class                          |\n 82. // |                                                                           |\n 83. // |  Description:  Deletes an existing instance of Wrapper_Class.             |\n 84. // +===========================================================================+\n 85. DllExport   void        CALL_TYPE   wr_Delete_Wrapper_Class (wr_Class* wr)\n 86. {\n 87.     delete  wr;\n 88. } // wr_Delete_Wrapper_Class\n 89.\n 90.\n 91. // +===========================================================================+\n 92. // |                               wr_Terminate                                |\n 93. // |                                                                           |\n 94. // |  Description:  Performs the necessary termination for the Wrapper code.   |\n 95. // |                code.                                                      |\n 96. // +===========================================================================+\n 97. DllExport   void        CALL_TYPE   wr_Terminate   (void)\n 98. {\n 99.     wr_Delete_Wrapper_Class (Local_wr_Ptr);     //  Delete our Local_wr_Ptr.\n100. } // wr_Terminate\n101.\n102.\n103. // .............................................................................\n104. //  Add these in later, one by one\n105. // .............................................................................\n106.\n107. //     void wr_Class_int_set  (wr_Class* wr, int i)\n108. //     {\n109. //         wr-&gt;int_set  (i);\n110. //     }\n111.\n112. //     int wr_Class_int_get  (wr_Class* wr)\n113. //     {\n114. //         return wr-&gt;int_get  ();\n115. //     }\n116.\n117. //     void    wr_mf_Set_SysID (wr_Class* wr, char SysID_ch [gd_bg_P08_QTY_DATAWORDS])\n118. //     {\n119. // //        mf_Set_SysID (char SysID_ch [gd_bg_P08_QTY_DATAWORDS]);\n120. //         ;\n121. //     }\n122.\n123. }   // extern \"C\"\n</code></pre>\n\n<p>datatypes.h -- I added leading line numbers for reference. You probably don't need this but here it is anyway.</p>\n\n<pre><code> 1. // *****************************************************************************\n 2. // *                           d a t a t y p e s . h                           *\n 3. // *                                                                           *\n 4. // *  Programmer:   Colleen Kobe                                               *\n 5. // *                                                                           *\n 6. // *  Project:      Small Business Innovative Research (SBIR) AF051-071        *\n 7. // *  Date:         March 14, 2016                                             *\n 8. // *    Revised:    July 10, 2018                                              *\n 9. // *    Revised:    tbd                                                        *\n10. // *                                                                           *\n11. // *  Description:  This C header file contains public declarations for        *\n12. // *                general use data types.                                    *\n13. // *                                                                           *\n14. // *                I created these type names to establish with absolute      *\n15. // *                certainty the range and bit length of an integer variable. *\n16. // *                                                                           *\n17. // *  Copyright:    (c) 2018 Infrared Telemetrics, Inc.                        *\n18. // *****************************************************************************\n19.\n20. #ifndef DATATYPES_H\n21. #define DATATYPES_H\n22.\n23. // =============================================================================\n24. //                            Set Up Compiler Options\n25. // =============================================================================\n26.\n27. /* Make sure functions are exported with C linkage under C++ compilers. */\n28. #ifdef __cplusplus\n29. extern \"C\"\n30. {               // Export the following code with C linkage.\n31. #endif          // Notice that this block is still open. It is closed below.\n32.\n33. #define DllExport  __declspec (dllexport)\n34. #define DllImport  __declspec (dllimport)\n35. #define CALL_TYPE __stdcall\n36.\n37. // =============================================================================\n38. //                             External Header Files\n39. // =============================================================================\n40. #include &lt;stdint.h&gt;                     //  1 c3\n41.\n42. // =============================================================================\n43. //                               Global Constants\n44. // =============================================================================\n45. // None.\n46.\n47. // =============================================================================\n48. //                                 Global Types\n49. // =============================================================================\n50.\n51.                                                             //  --------------------------------------------------------------------------------\n52.                                                             //                                       Range\n53.                                                             //  --------------------------------------------------------------------------------\n54. typedef signed char     Int08;                              //  -2** 7 .. (2** 7) - 1 [                       -128 ..                        127]\n55. typedef short           Int16;                              //  -2**15 .. (2**15) - 1 [                    -32,768 ..                     32,767]\n56. typedef int             Int32;  // AKA long                 //  -2**31 .. (2**31) - 1 [             -2,147,483,648 ..              2,147,483,647]\n57. typedef int64_t         Int64;  // AKA long long            //  -2**63 .. (2**63) - 1 [ -9,223,372,036,854,775,808 ..  9,223,372,036,854,775,807]\n58.\n59. typedef unsigned char   UInt08;                             //       0 .. (2** 8) - 1 [                          0 ..                        255]\n60. typedef unsigned short  UInt16;                             //       0 .. (2**16) - 1 [                          0 ..                     65,535]\n61. typedef unsigned int    UInt32; // AKA DWORD                //       0 .. (2**32) - 1 [                          0 ..              4,294,967,295]\n62. typedef uint64_t        UInt64; // AKA unsigned long long   //       0 .. (2**64) - 1 [                          0 .. 18,446,744,073,709,551,615]\n63.\n64.\n65. // =============================================================================\n66. //                                  Prototypes\n67. // =============================================================================\n68. // None.\n69.\n70. #ifdef __cplusplus\n71. }               // export the following code with C linkage.\n72. #endif\n73.\n74. #endif // DATATYPES_H\n</code></pre>\n\n<p>Buildlog.txt</p>\n\n<pre><code> 1. C:\\Windows\\system32\\cmd.exe /C C:/MinGW/bin/mingw32-make.exe -j4 SHELL=cmd.exe -e -f  \"Wrapper_Code.mk\"  MakeIntermediateDirs &amp;&amp; C:/MinGW/bin/mingw32-make.exe -j4 SHELL=cmd.exe -e -f  \"Wrapper_Code.mk\"  all\n 2. ----------Building project:[ Wrapper_Code - Debug ]----------\n 3. C:/MinGW/bin/g++.exe  -c  \"F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp\" -g -O0 -Wall -c  -o ./Debug/Wrapper.cpp.o -I. -IC:\\MinGW\\include -IC:\\wxWidgets\\include -I. -I..\\Background -I..\\Behind_the_Scenes -I..\\Main -I..\\Resources -I..\\Run_Here -I..\\Wrapper_Code\n 4. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp: In function 'wr_Class* wr_Create_New_Wrapper_Class()':\n 5. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp:73:25: error: invalid use of incomplete type 'wr_Class {aka struct wr_Class_Ignored}'\n 6.      temp_wr_ptr =   new wr_Class;\n 7.                          ^~~~~~~~\n 8. In file included from F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp:26:0:\n 9. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.h:55:17: note: forward declaration of 'wr_Class {aka struct wr_Class_Ignored}'\n10.  typedef struct  wr_Class_Ignored    wr_Class;   // \"C\" definition of Wrapper_Class.\n11.                  ^~~~~~~~~~~~~~~~\n12. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp: In function 'void wr_Delete_Wrapper_Class(wr_Class*)':\n13. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp:87:13: warning: possible problem detected in invocation of delete operator: [-Wdelete-incomplete]\n14.      delete  wr;\n15.              ^~\n16. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp:85:72: warning: 'wr' has incomplete type\n17.  DllExport   void        CALL_TYPE   wr_Delete_Wrapper_Class (wr_Class* wr)\n18.                                                                         ^~\n19. In file included from F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp:26:0:\n20. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.h:55:17: note: forward declaration of 'struct wr_Class_Ignored'\n21.  typedef struct  wr_Class_Ignored    wr_Class;   // \"C\" definition of Wrapper_Class.\n22.                  ^~~~~~~~~~~~~~~~\n23. F:/SBIR_Phase_II_A/Wrapper_Code/Wrapper.cpp:87:13: note: neither the destructor nor the class-specific operator delete will be called, even if they are declared when the class is defined\n24.      delete  wr;\n25.              ^~\n26. mingw32-make.exe: *** [Debug/Wrapper.cpp.o] Error 1\n27. Wrapper_Code.mk:101: recipe for target 'Debug/Wrapper.cpp.o' failed\n28. ====1 errors, 7 warnings====\n</code></pre>\n\n<p>How do I resolve the \"invalid use of incomplete type\" warning?  Am I getting it because I'm building a DLL instead of an EXE?  If so, what are my other options regarding how to declare the Wrapper class so that I can deal successfully with both the C and C++ compilers &amp; linkers?</p>\n\n<p>Suggestions?  Comments?</p>\n\n<p>Coding Environment:</p>\n\n<pre><code> Windows 10\n C &amp; C++\n MinGW / gcc / g++\n wxWidgets\n CodeLite v12.0.3\n</code></pre>\n\n<p>Thank you!\nColleen</p>\n"}, {"tags": ["c", "macros", "c89"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1531231134, "post_id": 51267107, "comment_id": 89512486, "body": "You can&#39;t. C89 does not support neither the compound literals nor designated initializers."}, {"owner": {"reputation": 49, "user_id": 4743279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ds1OE.jpg?s=128&g=1", "display_name": "Antonino DG", "link": "https://stackoverflow.com/users/4743279/antonino-dg"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531231211, "post_id": 51267107, "comment_id": 89512554, "body": "@Eugene Sh. Thanks a lot!"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1531231962, "post_id": 51267107, "comment_id": 89513182, "body": "Would creating a named object, as with <code>foo MyDummy = { 0, 0 };</code> and then defining the macro to refer to it, <code>#define DUMMY MyDummy</code>, serve your purposes? (Or, for that matter, simply defining <code>foo DUMMY = { 0, 0 };</code> and not using a macro at all.)"}, {"owner": {"reputation": 49, "user_id": 4743279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ds1OE.jpg?s=128&g=1", "display_name": "Antonino DG", "link": "https://stackoverflow.com/users/4743279/antonino-dg"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1531233065, "post_id": 51267107, "comment_id": 89514039, "body": "@Eric Postpischil, thanks a lot! yes both solutions could fit! Is the second solution compatible with C89?"}], "answers": [{"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1531342469, "creation_date": 1531342469, "answer_id": 51294021, "question_id": 51267107, "link": "https://stackoverflow.com/questions/51267107/use-of-define-to-create-a-dummy-record-compatible-with-c89-std/51294021#51294021", "title": "use of #define to create a dummy record compatible with C89 std", "body": "<p>In C89, the only values of aggregate (struct/union) type that can be used within a function are named objects, function return values, dereferenced pointers, or members of other aggregates.  While C includes a construct which defines a character array initialized with constant data and yields it as an lvalue [i.e. a string literal], there is no equivalent for any other type.</p>\n\n<p>As noted, if you can create a named static object, you could use:</p>\n\n<pre><code>static struct foo const doubleZero = {0,0};\n#define DUMMY doubleZero\n</code></pre>\n\n<p>Use of the macro would be compatible with code that uses <code>#ifdef DUMMY</code> to determine whether it has already been defined.</p>\n\n<p>If you needed the ability to create an object based upon parameters that might vary, you could use something like:</p>\n\n<pre><code>struct fooWrapper { struct foo dat[1]; };\nstruct fooWrapper makeFoo(int a, int b)\n{ struct fooWrapper result; result[0].a=a; result[0].b=b; return result; }\n#define MAKEFOO(a,b) (*(fooWrapper((a),(b)).dat))\n</code></pre>\n\n<p>which would then allow code to treat the result of MAKEFOO like an lvalue, thus allowing for e.g.</p>\n\n<pre><code>memcpy(whatever, &amp;MAKEFOO(3,5), sizeof (struct foo));\n</code></pre>\n\n<p>The lifetime of the returned wrapper object wouldn't be quite as long as that of a C compound literal, but should be adequate for most purposes where that of a C compound literal would suffice.</p>\n"}], "owner": {"reputation": 49, "user_id": 4743279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ds1OE.jpg?s=128&g=1", "display_name": "Antonino DG", "link": "https://stackoverflow.com/users/4743279/antonino-dg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531342469, "creation_date": 1531230795, "question_id": 51267107, "link": "https://stackoverflow.com/questions/51267107/use-of-define-to-create-a-dummy-record-compatible-with-c89-std", "title": "use of #define to create a dummy record compatible with C89 std", "body": "<p>How can I use #define to create a dummy record according to C89 standards?\nI tried:</p>\n\n<pre><code>    typedef struct foo{int a; int b;}foo;\n    #define DUMMY (foo) {.a=0, .b=0}\n</code></pre>\n\n<p>It works well but gives me a lot of warnings when I compile with -std=c89. Warnings say that this kind of thing is compatible only with C99 standards. Thanks anyone!!</p>\n"}, {"tags": ["c", "reverse-engineering"], "comments": [{"owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "edited": false, "score": 1, "creation_date": 1531231634, "post_id": 51267088, "comment_id": 89512929, "body": "Is it C or C++? It can&#39;t be both!"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1531232842, "post_id": 51267088, "comment_id": 89513906, "body": "Wrong object type.  That string does not exactly look like a valid section object name, my crystal ball says that you meant to use NtCreateSection()."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10052324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1cb7b74ca0b9967f5434033d268f47?s=128&d=identicon&r=PG&f=1", "display_name": "forbiddenhi", "link": "https://stackoverflow.com/users/10052324/forbiddenhi"}, "edited": false, "score": 0, "creation_date": 1531312322, "post_id": 51267965, "comment_id": 89548453, "body": "How sure &quot;\\\\??\\\\E:\\\\Myfile.dat&quot; is a valid name for a valid section object?"}], "tags": [], "owner": {"reputation": 8101, "user_id": 9199167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqdLV.jpg?s=128&g=1", "display_name": "Max Vollmer", "link": "https://stackoverflow.com/users/9199167/max-vollmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1531233282, "creation_date": 1531233282, "answer_id": 51267965, "question_id": 51267088, "link": "https://stackoverflow.com/questions/51267088/why-ntopensection-return-error-number-0xc0000024/51267965#51267965", "title": "Why NtOpenSection return error number 0xc0000024?", "body": "<p>As for <strong>what</strong> the error means, you can check that <a href=\"https://msdn.microsoft.com/en-us/library/cc704588.aspx\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>|===============================|=====================================================|\n| 0xC0000024                    | {Wrong Type} There is a mismatch between the type   |\n| STATUS_OBJECT_TYPE_MISMATCH   | of object that is required by the requested         |\n|                               | operation and the type of object that               |\n|                               | is specified in the request.                        |\n|===============================|=====================================================|\n</code></pre>\n\n<p>As for <strong>why</strong> it happens, that's for you to determine. Make sure <code>\"\\\\??\\\\E:\\\\Myfile.dat\"</code> is a valid name for a valid section object.</p>\n"}], "owner": {"reputation": 7, "user_id": 10052324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1cb7b74ca0b9967f5434033d268f47?s=128&d=identicon&r=PG&f=1", "display_name": "forbiddenhi", "link": "https://stackoverflow.com/users/10052324/forbiddenhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531233282, "creation_date": 1531230755, "last_edit_date": 1531232628, "question_id": 51267088, "link": "https://stackoverflow.com/questions/51267088/why-ntopensection-return-error-number-0xc0000024", "title": "Why NtOpenSection return error number 0xc0000024?", "body": "<p>I want to call NtOpensection but return 0xc0000024 error</p>\n\n<pre><code>UNICODE_STRING ObFileName;\nOBJECT_ATTRIBUTES objA;\nHANDLE hSectionHandle = NULL;\n\nRtlInitUnicodeString(&amp;ObFileName, L\"\\\\??\\\\E:\\\\Myfile.dat\");\nInitializeObjectAttributes(&amp;objA, &amp;ObFileName, OBJ_CASE_INSENSITIVE, (HANDLE)NULL, (PSECURITY_DESCRIPTOR)NULL);\nNTSTATUS ntStatus = _NtOpenSection(&amp;hSectionHandle, SECTION_MAP_READ | SECTION_MAP_WRITE, &amp;objA);\n</code></pre>\n"}, {"tags": ["c", "bash", "memory-leaks"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531230052, "post_id": 51266813, "comment_id": 89511623, "body": "What is the point of this question without any source code?"}, {"owner": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531230207, "post_id": 51266813, "comment_id": 89511737, "body": "@EugeneSh. The C code itself doesn&#39;t seem to be a problem, as I said it runs without any leaks, the problem is in the bash script and not in the C code. Also, the C code is a few thousand lines long, and as it doesn&#39;t appear to have any issues I would have no idea what to include."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "edited": false, "score": 0, "creation_date": 1531230295, "post_id": 51266896, "comment_id": 89511798, "body": "So is the reachable memory leak expected in that case? Just worried in case it is a subtlety in bash programming I&#39;m missing as I know very little! The difference with the valgrind running makes sense though, thanks!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "edited": false, "score": 3, "creation_date": 1531230436, "post_id": 51266896, "comment_id": 89511926, "body": "@DanielJ Unless you want to debug Bash and send bug-reports to the Bash maintainers, there&#39;s no need to worry about it. Bash is complicated, and as such it <i>will</i> contain bugs. It is also likely that some things that might be seen as bugs by outsiders like us really aren&#39;t, and the reports are false positives. More importantly, running Valgrind on Bash doesn&#39;t say <i>anything</i> about your program!"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 6, "last_activity_date": 1531230319, "last_edit_date": 1531230319, "creation_date": 1531230232, "answer_id": 51266896, "question_id": 51266813, "link": "https://stackoverflow.com/questions/51266813/memory-leak-when-c-program-ran-from-bash-script/51266896#51266896", "title": "Memory leak when C program ran from bash script", "body": "<p><code>valgrind ./run</code> will debug the <em>shell</em> and not your program.</p>\n\n<p>Take a look at the output, see how it mentions (e.g.)</p>\n\n<blockquote>\n  <p>==4518==    by 0x41C482: main (<strong>in /usr/bin/bash</strong>)</p>\n</blockquote>\n\n<p><sub>[Emphasis mine]</sub></p>\n\n<p>If you want to debug your program, you need to run <code>valgrind</code> <em>in</em> the script:</p>\n\n<pre><code>arg1=thing1\narg2=thing2\n\nvalgrind ./Coupled $thing1 $thing2\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 51266896, "answer_count": 1, "score": -2, "last_activity_date": 1531230319, "creation_date": 1531230002, "question_id": 51266813, "link": "https://stackoverflow.com/questions/51266813/memory-leak-when-c-program-ran-from-bash-script", "title": "Memory leak when C program ran from bash script", "body": "<p>I have a C program that takes various command line arguments, i.e</p>\n\n<pre><code>./Coupled arg1 argv2\n</code></pre>\n\n<p>And when I run this with valgrind as </p>\n\n<pre><code>valgrind ./Coupled arg1 arg2\n</code></pre>\n\n<p>I get no memory leaks. But when I use a bash script, called <code>run</code>, of the form</p>\n\n<pre><code>arg1=thing1\narg2=thing2\n\n./Coupled $thing1 $thing2\n</code></pre>\n\n<p>and then run</p>\n\n<pre><code>valgrind ./run\n</code></pre>\n\n<p>I get a lot of still reachable memory leakage. I have read that that still reachable memory leakage isn't a huge problem, but I would quite like to know why this is happening? When running valgrind with <code>--leak-check=full --show-leak-kinds=all</code> flags, an example bit of output (the full valgrind output is many pages long)</p>\n\n<pre><code>==4518== 1 bytes in 1 blocks are still reachable in loss record 1 of 269\n==4518==    at 0x4C29BE3: malloc (vg_replace_malloc.c:299)\n==4518==    by 0x46A3DA: xmalloc (in /usr/bin/bash)\n==4518==    by 0x437219: make_variable_value (in /usr/bin/bash)\n==4518==    by 0x438230: ??? (in /usr/bin/bash)\n==4518==    by 0x43A35E: initialize_shell_variables (in /usr/bin/bash)\n==4518==    by 0x41DD92: ??? (in /usr/bin/bash)\n==4518==    by 0x41C482: main (in /usr/bin/bash)\n</code></pre>\n"}, {"tags": ["c", "pointers", "structure"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 4, "creation_date": 1531229585, "post_id": 51266635, "comment_id": 89511289, "body": "Ask yourself: How would the assignment-operator know the <b>actual</b> size of the array?"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1531229648, "creation_date": 1531229648, "answer_id": 51266696, "question_id": 51266635, "link": "https://stackoverflow.com/questions/51266635/why-for-structure-with-flexible-array-member-we-shouldnt-use-structure-assignm/51266696#51266696", "title": "why for structure with flexible array member, we shouldn&#39;t use structure assignment for copying", "body": "<p>The size of the structure doesn\u2019t count the FAM. The compiler has no way to know how big the FAM is.  Consequently, any copy ignores the FAM.  Since that\u2019s very seldom the desired behaviour, don\u2019t use structure copying on structures with a FAM. </p>\n"}], "owner": {"reputation": 8548, "user_id": 5581182, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc277bc00b89d827aba59b3e2509a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Thor", "link": "https://stackoverflow.com/users/5581182/thor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1531234777, "accepted_answer_id": 51266696, "answer_count": 1, "score": -2, "last_activity_date": 1531229648, "creation_date": 1531229456, "question_id": 51266635, "link": "https://stackoverflow.com/questions/51266635/why-for-structure-with-flexible-array-member-we-shouldnt-use-structure-assignm", "closed_reason": "Duplicate", "title": "why for structure with flexible array member, we shouldn&#39;t use structure assignment for copying", "body": "<p>I'm currently learning c structure, especially structure with flexible array member. </p>\n\n<p>Given a structure flexible array </p>\n\n<pre><code>struct flex\n{\n    size_t count;\n    double average;\n    double scores[]; // flexible array member\n};\n</code></pre>\n\n<p>I have been told not to use assignment for copying </p>\n\n<p><a href=\"https://i.stack.imgur.com/bfxVo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bfxVo.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm not sure why this operation only copy the non-flexible member of  the structure. </p>\n\n<p>Could someone please explain to me the underlying reasons why this is the case? </p>\n"}]