[{"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 3, "creation_date": 1484783530, "post_id": 41731474, "comment_id": 70657300, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16976328/explain-2d-array-iteration-with-1-loop\">Explain 2D array iteration with 1 loop</a>"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1484783603, "post_id": 41731474, "comment_id": 70657323, "body": "Just use the first subarray... eg. for <code>int arr[3][3]</code> index <code>arr[0]</code> from <code>arr[0][0]</code> to <code>arr[0][8]</code>... or use an <code>int *</code>, eg: <code>int *p = arr[0];</code> and use <code>p[0]</code> ... <code>p[8]</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484783930, "post_id": 41731474, "comment_id": 70657428, "body": "<a href=\"http://ideone.com/qDXQhT\" rel=\"nofollow noreferrer\">example</a>"}, {"owner": {"reputation": 10398, "user_id": 4398966, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Md0LP.jpg?s=128&g=1", "display_name": "DCR", "link": "https://stackoverflow.com/users/4398966/dcr"}, "edited": false, "score": 0, "creation_date": 1484784295, "post_id": 41731474, "comment_id": 70657520, "body": "Dmitri, your comment doesn&#39;t make any sense.  How can you access arr[0][8] when it&#39;s declared [3][3]?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484784757, "post_id": 41731474, "comment_id": 70657674, "body": "The suggested duplicate is not good; that is using a complicated scheme to access the 2D array with 2 subscripts, whereas this seeks to access a 2D array with 1 subscript (unless I&#39;m misunderstanding the code)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484784819, "post_id": 41731474, "comment_id": 70657693, "body": "@DCR: Dmitri&#39;s suggestion is correct.  <code>p</code> is declared as an <code>int *</code> \u2014 not as a 3x3 array."}, {"owner": {"reputation": 10398, "user_id": 4398966, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Md0LP.jpg?s=128&g=1", "display_name": "DCR", "link": "https://stackoverflow.com/users/4398966/dcr"}, "edited": false, "score": 0, "creation_date": 1484785095, "post_id": 41731474, "comment_id": 70657771, "body": "his second part is correct but this eg. for int arr[3][3] index arr[0] from arr[0][0] to arr[0][8]  doesn&#39;t make any sense"}, {"owner": {"reputation": 10398, "user_id": 4398966, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Md0LP.jpg?s=128&g=1", "display_name": "DCR", "link": "https://stackoverflow.com/users/4398966/dcr"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484785219, "post_id": 41731474, "comment_id": 70657809, "body": "@BLUEPIXY your example is great.  thanks.  Isn&#39;t there a way to just move the memory address inside the index?  p[? + (i*4)]"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484785439, "post_id": 41731474, "comment_id": 70657867, "body": "<code>for(int i = 0; i &lt; 2; ++i) for(int j = 0; j &lt; 2; ++j) p[i * 2 + j]</code> ?"}, {"owner": {"reputation": 10398, "user_id": 4398966, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Md0LP.jpg?s=128&g=1", "display_name": "DCR", "link": "https://stackoverflow.com/users/4398966/dcr"}, "edited": false, "score": 0, "creation_date": 1484785709, "post_id": 41731474, "comment_id": 70657936, "body": "sort of but i thought there was a way to express the move or offset as 4 bytes at a time"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484785856, "post_id": 41731474, "comment_id": 70657966, "body": "It is not necessary to multiply the index of the array(or  pointer to <code>int</code>) by the offset (<code>sizeof(int)</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 10398, "user_id": 4398966, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Md0LP.jpg?s=128&g=1", "display_name": "DCR", "link": "https://stackoverflow.com/users/4398966/dcr"}, "edited": false, "score": 0, "creation_date": 1484785337, "post_id": 41731606, "comment_id": 70657836, "body": "how can that possibly be right a[0][3] and a[1][1] hold different values.  in fact, based on your example a[0][3] is out of bounds while a[1][1] stores 400.  Oh, they are both 4 places offset.  and int[][] is almost an *"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1484784592, "last_edit_date": 1484784592, "creation_date": 1484784267, "answer_id": 41731606, "question_id": 41731474, "link": "https://stackoverflow.com/questions/41731474/c-how-to-move-through-2-dimensional-array-based-on-address/41731606#41731606", "title": "C how to move through 2 dimensional array based on address", "body": "<p>2D arrays can be iterated through in a single loop like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int a[2][2], *p;\n    a[0][0] = 100;\n    a[0][1] = 200;\n    a[1][0] = 300;\n    a[1][1] = 400;\n\n    p = &amp;a[0][0];\n\n    while(p!=&amp;a[0][4])\n        printf(\"%d\\n\", *p++);\n\n    return 0;\n}\n</code></pre>\n\n<p>Remember that an array index is just an offset from the first element of the array, so there is no real difference between <code>a[0][3]</code> and <code>a[1][1]</code> - they both refer to the same memory location.</p>\n"}, {"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1484785319, "creation_date": 1484785319, "answer_id": 41731747, "question_id": 41731474, "link": "https://stackoverflow.com/questions/41731474/c-how-to-move-through-2-dimensional-array-based-on-address/41731747#41731747", "title": "C how to move through 2 dimensional array based on address", "body": "<p>Access 2D arrays like this</p>\n\n<pre><code>int *array;   // note one level of pointer indirection\narray = malloc(width * height * sizeof(int));  / allocate buffer somehow\n\nfor(y=0;y&lt;height;y++)\n  for(x=0;x&lt;width;x++)\n    array[y*width+x] = 0; // address the element by calculation\n</code></pre>\n\n<p>In three dimensions</p>\n\n<pre><code>  int *array;   // note one level of pointer indirection\n  array = malloc(width * height * depth * sizeof(int));  / allocate buffer somehow\n\n for(z=0;z&lt;depth;z++)\n   for(y=0;y&lt;height;y++)\n     for(x=0;x&lt;width;x++)\n       array[z*width*height + y*width+x] = 0; // address the element by calculation\n</code></pre>\n\n<p>Generally it's easier to use flat buffers than to mess around with C and C++ convoluted rules for multi-dimensional arrays. You can also of course\niterate through the entire array with a single index. If you want to set \nup a 2D array, then cast the array to a  single pointer, it behaves the\nsame way.</p>\n\n<pre><code>     #define HEIGHT 50\n     #define WIDTH 90\n     int array2D[HEIGHT][WIDTH}:\n\n     int * array = reinterpret_cast&lt;int *&gt;(array2D): \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 84, "user_id": 3889119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927b78a99d4950f6a34afdd7efc3da95?s=128&d=identicon&r=PG&f=1", "display_name": "Koorosh Hajiani", "link": "https://stackoverflow.com/users/3889119/koorosh-hajiani"}, "is_accepted": false, "score": 0, "last_activity_date": 1484787798, "last_edit_date": 1484787798, "creation_date": 1484785896, "answer_id": 41731850, "question_id": 41731474, "link": "https://stackoverflow.com/questions/41731474/c-how-to-move-through-2-dimensional-array-based-on-address/41731850#41731850", "title": "C how to move through 2 dimensional array based on address", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;   \n\nint arr[4][3]={{1,2,3},{4,5,6},{7,8,9},{10,11,12}};\n\n\nvoid my_fun(int(*a)[],int m,int n)\n{\n\nfor(int i=0;i&lt;m*n;i++)\n {\n   printf(\"%d\\n\",(*a)[i]);\n }\n\n}\n\nint main()\n{\n\n  my_fun(arr,3,4);\n\n return 0;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 10398, "user_id": 4398966, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Md0LP.jpg?s=128&g=1", "display_name": "DCR", "link": "https://stackoverflow.com/users/4398966/dcr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "accepted_answer_id": 41731606, "answer_count": 3, "score": -1, "last_activity_date": 1484787798, "creation_date": 1484783343, "last_edit_date": 1484784664, "question_id": 41731474, "link": "https://stackoverflow.com/questions/41731474/c-how-to-move-through-2-dimensional-array-based-on-address", "title": "C how to move through 2 dimensional array based on address", "body": "<p>I'm trying to figure out how to loop through a 2 dimensional array as a single dimensional array.  Since a 2 dimensional array will occupy continuous memory, is there a way to address the two dimensional array as a single dimensional array by changing the index by 4 bytes.  I'm assuming an integer array.  Could some one provide an example?  I tried the following but it doesn't work:</p>\n\n<pre><code>for (int i = 0; i &lt; 2; i++){\n    for (int j = 0;j &lt; 2; j++){\n        z[i][j] = count;\n        count++;\n    }\n}\n\nfor (int i = 0; i &lt; 4; i++)\n    printf(\"%d\\n\", z[i]);\n</code></pre>\n"}, {"tags": ["c", "unix", "process", "signals"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1484783152, "post_id": 41731429, "comment_id": 70657169, "body": "Put them in a process group and send the signal to the whole group."}, {"owner": {"reputation": 1, "user_id": 7438300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c722b5a4dbea1858c088393af2473d00?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Skrzypkowski", "link": "https://stackoverflow.com/users/7438300/pawel-skrzypkowski"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484783389, "post_id": 41731429, "comment_id": 70657257, "body": "Each of these processes must be able to handle the task of the operator. So when the operator write in terminal: kill -sig pid1 kill -sig PID2 kill -sig PID3 it have to work: /"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484784329, "post_id": 41731429, "comment_id": 70657531, "body": "The parent process can&#39;t catch signals sent to children. The operator needs to send the signal to the parent, so it can then signal the children."}, {"owner": {"reputation": 1, "user_id": 7438300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c722b5a4dbea1858c088393af2473d00?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Skrzypkowski", "link": "https://stackoverflow.com/users/7438300/pawel-skrzypkowski"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484784727, "post_id": 41731429, "comment_id": 70657662, "body": "I know. So in this case process group won&#39;t work. Do you have any other ideas?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1484784768, "post_id": 41731429, "comment_id": 70657677, "body": "No, you need to redesign."}], "owner": {"reputation": 1, "user_id": 7438300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c722b5a4dbea1858c088393af2473d00?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Skrzypkowski", "link": "https://stackoverflow.com/users/7438300/pawel-skrzypkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484838271, "creation_date": 1484783055, "last_edit_date": 1484783141, "question_id": 41731429, "link": "https://stackoverflow.com/questions/41731429/resuming-several-processes-with-one-signal", "title": "Resuming several processes with one signal", "body": "<p>I need help with the implementation of such a problem: I have a 3 child processes and 1 parent process. Child processes are paused by signal SIGSTOP (parent is not). Operator (user) sends to one of these 3 processes a signal(should work for all 3), which has to resume them all(3 children). I am using library signals.h, but the function which is a handler does not work:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void coninue(int sig)\n{\n    if(pid_parent == getpid())//if parent get signal\n    {\n        kill(pid3, 25);\n        kill(pid2, 25);\n        kill(pid1, 25);\n    }\n    else//if child get signal\n        kill(pid_parent, 25);\n}\n</code></pre>\n\n<p>I've tried many ways, but no one work. The main problem is that the process which is paused can only pick up signals SIGCONT and SIGKILL (which can not be captured), so i can only use SIGCONT. \nThanks for any help :)</p>\n\n<p>PS: Works on UNIX</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484782676, "post_id": 41731323, "comment_id": 70657039, "body": "<code>scanf</code> is a library function. But not sure what your prof means by &quot;use simple type casts&quot;. Type casting doesn&#39;t seem like the right way to solve this. At least, not just type casting on its own. Your idea of using basic math operations seems more on track."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1484782769, "post_id": 41731323, "comment_id": 70657061, "body": "That <code>scanf(&quot;%.2f&quot;, &amp;v);</code> is a format error. Please use <code>scanf(&quot;%f&quot;, &amp;v);</code> and print it like you did to round to 2 dec places. Floating point variables themselves have no concept of decimal places."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484783093, "post_id": 41731323, "comment_id": 70657148, "body": "@Chimera It&#39;s not. I edited my question as to how it&#39;s not. I already looked in depth at that link and did not find the answer to my question. Mine involves user input which is why I felt it was reasonable to be posted."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1484783135, "post_id": 41731323, "comment_id": 70657162, "body": "The line <code>v = 0;</code> destroys the input to <code>v</code> from <code>scanf</code>."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 1, "creation_date": 1484783180, "post_id": 41731323, "comment_id": 70657179, "body": "@J.Nav It doesn&#39;t matter how the code gets the number to be rounded. This question is still about how to round a float. It is therefore a duplicate."}, {"owner": {"reputation": 750, "user_id": 6876037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acf7e5bb30e124f2597567bfd9aab1?s=128&d=identicon&r=PG&f=1", "display_name": "anonymoose", "link": "https://stackoverflow.com/users/6876037/anonymoose"}, "edited": false, "score": 0, "creation_date": 1484783189, "post_id": 41731323, "comment_id": 70657185, "body": "@J.Nav, are you sure you looked at it in depth? <a href=\"http://stackoverflow.com/questions/1343890/rounding-number-to-2-decimal-places-in-c#answer-1344260\" title=\"rounding number to 2 decimal places in c%23answer 1344260\">stackoverflow.com/questions/1343890/&hellip;</a> has your answer."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484783203, "post_id": 41731323, "comment_id": 70657191, "body": "@WeatherVane I thought I would use the %.2f because it would specify that I wanted the user&#39;s input to be rounded to only two decimal places. Is this something that is only appropriate in JAVA programming?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484783244, "post_id": 41731323, "comment_id": 70657206, "body": "That does not round the input. <code>scanf</code> is similar in many ways to <code>printf</code> but is also different. As I said, it is a formatting error. The man page will be your friend as well as the links."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484783244, "post_id": 41731323, "comment_id": 70657207, "body": "@J.Nav If you read the answers in the other question you will surely find several workable answers."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 1, "creation_date": 1484783368, "post_id": 41731323, "comment_id": 70657249, "body": "@Chimera It isn&#39;t a duplicate because it wasn&#39;t good enough for me. I wasn&#39;t sure how much the fact that I needed user input to be rounded changed the entire thing. Thank you for being concerned but I truly feel like mine is original in the fact that I gave my own coding, prompted my ideas, and listed the source I had previously been to."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1484783431, "post_id": 41731323, "comment_id": 70657268, "body": "Where the input comes from (a file, user input, or a code assigned variable) is irrelevant. Rounding output is the same regardless of where the input is obtained. This is in fact a duplicate of the post you say it doesn&#39;t duplicate."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484783474, "post_id": 41731323, "comment_id": 70657284, "body": "Rounding user input is fruitless. Always work to the highest accuracy available. C floating point variables hold no information of decimals, or decimal places."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484783661, "post_id": 41731323, "comment_id": 70657344, "body": "@WeatherVane If you want to tell that to my professor, go ahead, but this was the assignment I was given."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1484783668, "post_id": 41731323, "comment_id": 70657348, "body": "If you may only use typecasts, then use these! I don&#39;t see any typecast. (Note that there is only one logical cast here, <i>away</i> from <code>float</code>.)"}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484783722, "post_id": 41731323, "comment_id": 70657362, "body": "you haven&#39;t actually got a the rounded value in a variable, you have only printed the variable with reduced precision, I think your prof. wants you to do the calculation explicitly."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1484783781, "post_id": 41731323, "comment_id": 70657379, "body": "@KenWhite I&#39;m totally done with this site. You guys have almost never given me an answer I can actually use, and every time I ask a question it is shut down as being a duplicate despite thoroughly searching for an answer to my specific question. The fact that you even asked that blows my mind given that I&#39;m a complete beginner at this, and did not know that. I&#39;ll take it down."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484783809, "post_id": 41731323, "comment_id": 70657390, "body": "@J.Nav I suspect the prof was asking you to round the <i>output</i> of the value that was entered. As I already said, rounding a floating point variable itself to decimal places will not work, because f.p. cannot represent most decimal fractions exactly anyway."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484783837, "post_id": 41731323, "comment_id": 70657402, "body": "@Jasen Thanks Jasen. I was unsure but now I&#39;m starting to see what it is that needs to be done."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1484784602, "post_id": 41731323, "comment_id": 70657625, "body": "I didn&#39;t <i>ask</i> you anything, so I don&#39;t know what question <i>blows your mind</i>. One of the things that new users here have difficulty learning is that this is not a site for posting a specific solution for <b>your exact situation</b>. This site is for questions that will help many people now and in the future, and it&#39;s <i>your</i> job to apply those previous answers to your specific case. In regards to <b>this question</b>, the other post tells you <b>exactly</b> how to <b>round the output</b>, and you asked how to <b>round the output</b>, which makes it a duplicate."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1484784768, "post_id": 41731323, "comment_id": 70657676, "body": "To make it more clear: If a user asks <i>How do I add the int vars b and c in the C language?</i>, it&#39;s not a different post than <i>How do I add A and B in the C language?</i> simply because the variables are named differently. The answer to both questions are the same, making the second a duplicate."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484784976, "post_id": 41731323, "comment_id": 70657733, "body": "Oh god. Please just one more close vote."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1484785240, "post_id": 41731323, "comment_id": 70657813, "body": "@KenWhite Then I&#39;ll go to a different site."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 4, "creation_date": 1484786498, "post_id": 41731323, "comment_id": 70658130, "body": "OK.  Sorry to see you go. Good luck with that; there aren&#39;t many good sites out there (which is why we try to keep the noise and clutter down here)."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 0, "creation_date": 1484783527, "post_id": 41731483, "comment_id": 70657299, "body": "But I can&#39;t use library functions, so does that mean I can&#39;t use things like scanf?"}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "reply_to_user": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 2, "creation_date": 1484783635, "post_id": 41731483, "comment_id": 70657334, "body": "You can&#39;t read else....What your professor means is to calculate the rounded number without libraries ..."}], "tags": [], "owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "is_accepted": false, "score": 2, "last_activity_date": 1484783402, "creation_date": 1484783402, "answer_id": 41731483, "question_id": 41731323, "link": "https://stackoverflow.com/questions/41731323/c-programming-rounding-users-input/41731483#41731483", "title": "C Programming Rounding User&#39;s Input", "body": "<p>First of all #include is a command that you need in order to include and use function that c provides for example for <code>scanf</code> you need to include  library.</p>\n\n<p>To round the number in two decimals without using <code>%.2f</code> in <code>scanf</code> you could write:</p>\n\n<pre><code>int x= (v*1000);\nif(x%10&gt;6) x=x/10+1 ;\nelse x= x/10;\nprintf(\"%d.%d\",x/100,x%100);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 0, "creation_date": 1484783605, "post_id": 41731489, "comment_id": 70657324, "body": "It does use mathematic formulas, but where did you get the int? I only have one variable and it&#39;s v. V cannot be an integer since it will have decimal places."}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "edited": false, "score": 0, "creation_date": 1484783726, "post_id": 41731489, "comment_id": 70657363, "body": "This is wrong, firstly for 13.334 it gives 13.33 which is cutting digits not rounding!! and it also prints more digits since it is float.. e.g 13.3300000"}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484783828, "post_id": 41731489, "comment_id": 70657397, "body": "you should probably use long instead of int. but if user enters 9e19 it will still give wrong answer."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "edited": false, "score": 0, "creation_date": 1484784150, "post_id": 41731489, "comment_id": 70657484, "body": "@coder so you would definitely recommend doing something with mathematics? But how can I read the user&#39;s input without the scanner and therefore the library functions? I guess with a loop?"}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "reply_to_user": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 0, "creation_date": 1484784298, "post_id": 41731489, "comment_id": 70657521, "body": "@J.NAV, YOU CAN&#39;T is the answer, to take the input from keyboard you need a system call to your os which is done by scanf ,you can&#39;t read without libraries, again the point here  is to read a float and then without libraries round it..."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "edited": false, "score": 0, "creation_date": 1484784381, "post_id": 41731489, "comment_id": 70657549, "body": "@coder: you are right concerning &quot;rounding&quot;, of course. But I&#39;m not sure at what the assignment aims, and if it is really about rounding in the sense that 1.349 should yield 1.35; And I&#39;d neglect the issue with the trailing <code>0</code>, too. But who knows :-)"}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484784402, "post_id": 41731489, "comment_id": 70657559, "body": "@Chimera The theory of it is, sure, but the fact is that I have no idea where they got the int. I need my program to accept a floating value which then needs to be printed in a rounded format. Which makes me think I need to declare the variable and then get the input, then use math formulas to round it. Then printf the rounded value."}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "edited": false, "score": 0, "creation_date": 1484784520, "post_id": 41731489, "comment_id": 70657601, "body": "@Stephan Lechner , I think that since is it asked for rounding then 1.349 should be 1.35 ...."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1484784523, "post_id": 41731489, "comment_id": 70657602, "body": "See the edited answer; the &#39;int&#39; is just an intermediate value, not even a variable, for calculating the result"}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "edited": false, "score": 0, "creation_date": 1484784542, "post_id": 41731489, "comment_id": 70657609, "body": "@coder So when he says, &quot;accepts an arbitrary floating point value from standard input&quot;, I don&#39;t actually need to have user input? I just need to input my own value that gets rounded? I&#39;ve emailed him for clarification but he hasn&#39;t gotten back to me yet."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484784630, "post_id": 41731489, "comment_id": 70657637, "body": "I was taught that <code>1.330000</code> implies the accuracy is to 6 decimal places. If you are rounding <code>1.333333</code> to 2 decimal places, the answer is <code>1.33</code>."}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "reply_to_user": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 0, "creation_date": 1484784728, "post_id": 41731489, "comment_id": 70657663, "body": "@J.NAV, No you need to have as input a floating number and the only way is by using a library function like scanf.... but then you need to calculate the rounded number by doing some mathematics...."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484784736, "post_id": 41731489, "comment_id": 70657666, "body": "@WeatherVane That&#39;s correct. Unless you are doing stats, then when you have a value where the next place over is 5 or higher, then you always round up. In this instance, it&#39;d just be left at 1.33 like you said."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "edited": false, "score": 0, "creation_date": 1484784884, "post_id": 41731489, "comment_id": 70657712, "body": "@coder What you&#39;re saying makes complete sense, thank you. He does say I cannot use library functions when it comes to computing the value. Which means I should be able to use them to get the actual value, but not for the rounding itself. Thank you for your patience."}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "reply_to_user": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 0, "creation_date": 1484784951, "post_id": 41731489, "comment_id": 70657727, "body": "@J.Nav glad to help!!!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484784951, "post_id": 41731489, "comment_id": 70657729, "body": "...and of course you&#39;ll need a library function to see the output anyway, unless you are expected to view variables with a debugger."}, {"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484785115, "post_id": 41731489, "comment_id": 70657777, "body": "@WeatherVane My professor said debuggers are useless so no."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1484785403, "post_id": 41731489, "comment_id": 70657853, "body": "I think you have now told all about your &quot;professor&quot; that is needed. Just try to work past him/her."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1484785652, "post_id": 41731489, "comment_id": 70657923, "body": "debuggers are in deed useless if it&#39;s not about programming"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1484784166, "last_edit_date": 1484784166, "creation_date": 1484783421, "answer_id": 41731489, "question_id": 41731323, "link": "https://stackoverflow.com/questions/41731323/c-programming-rounding-users-input/41731489#41731489", "title": "C Programming Rounding User&#39;s Input", "body": "<p>I think your professor aims not so much in user input but rather in understanding what happens when converting basic datatypes. Rounding, or at least cutting off digits, without library functions could look as follows:</p>\n\n<pre><code>int main (void)\n{\n    //v is my variable for the value which the user will input\n    //Declaring variable as floating\n    float v;\n\n    printf(\"Enter your value: \\n\");\n    scanf(\"%f\", &amp;v);\n    v = float((int)(v*100))/100;\n\n    printf(\"The rounded version is: %f\", v);\n\n    return 0;\n}\n</code></pre>\n\n<p>Input/Output:</p>\n\n<pre><code>Enter your value: \n1.3333333\nThe rounded version is: 1.330000\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 0, "creation_date": 1484785070, "post_id": 41731666, "comment_id": 70657760, "body": "Thank you for this example. It&#39;s very helpful. From what I understand, I can&#39;t do something like &quot;%.2f&quot; because it&#39;s a Java thing. So I have to use multiplication to make sure the decimal place is correct. Still unsure as to why you would multiply the float by the int."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "edited": false, "score": 0, "creation_date": 1484785194, "post_id": 41731666, "comment_id": 70657797, "body": "@J.Nav It first turns 3.456 into 346. Then divides by 100.0 to get it back into a float."}], "tags": [], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "is_accepted": false, "score": 1, "last_activity_date": 1484784658, "creation_date": 1484784658, "answer_id": 41731666, "question_id": 41731323, "link": "https://stackoverflow.com/questions/41731323/c-programming-rounding-users-input/41731666#41731666", "title": "C Programming Rounding User&#39;s Input", "body": "<p>Here is a working example that rounds properly without using any library calls other than stdio.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    float v; \n\n    printf(\"Enter your value: \\n\");\n    scanf(\"%f\", &amp;v);\n\n\n    v = (float)((int)(v * 100 + .5) / 100.0);\n\n    printf(\"The rounded version is: %f\\n\",v);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>jnorton@mint18 ~ $ ./a.out \nEnter your value: \n3.456\nThe rounded version is: 3.460000\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6939067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7b11a688258d739e27e42a79fc88dec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Nav", "link": "https://stackoverflow.com/users/6939067/j-nav"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1729, "favorite_count": 0, "closed_date": 1484785380, "answer_count": 3, "score": 2, "last_activity_date": 1484784658, "creation_date": 1484782404, "last_edit_date": 1495540896, "question_id": 41731323, "link": "https://stackoverflow.com/questions/41731323/c-programming-rounding-users-input", "closed_reason": "Duplicate", "title": "C Programming Rounding User&#39;s Input", "body": "<p>I've just started a class in C Programming, and while I have some background knowledge in JAVA, I'm trying to transition to this programming language. I have a project where I have to round user's input from something like 1.3333 to only two decimal places.</p>\n\n<p>What I have so far is this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main (void)\n{\n   //v is my variable for the value which the user will input\n   //Declaring variable as floating\n   float v; \n\n   printf(\"Enter your value: \\n\");\n   scanf(\"%.2f\", &amp;v);\n   v = 0;\n\n   printf(\"The rounded version is: %.2f\");\n\n   return 0;\n}\n</code></pre>\n\n<p>This is what I have so far based off of what I've read in my book and this link: <a href=\"https://stackoverflow.com/questions/1343890/rounding-number-to-2-decimal-places-in-c\">Rounding Number to 2 Decimal Places in C</a> which my question is different from because it involves user input. My professor does say that I can't use a library function and need to use simple type casts to calculate it. This makes me feel that what I have might be wrong. Would the <code>#include &lt;stdio.h&gt;</code> be considered a library function? Given this information, is my thought process on the right track? If not, then would I do something like divide by variable by 100? Maybe %e for scientific notation? </p>\n\n<p>Thanks ahead of time! Only asking for specific information, not coding or anything. Really want to understand the \"hows\" and \"whys\".</p>\n"}, {"tags": ["c", "winapi", "menu", "tooltip"], "comments": [{"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "edited": false, "score": 0, "creation_date": 1484782915, "post_id": 41731311, "comment_id": 70657104, "body": "Not sure about this, but did you try any of WM_MOUSEHOVER, WM_MOUSEMOVE or WM_NCMOUSEMOVE events, whether they work?"}, {"owner": {"reputation": 738, "user_id": 1124866, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/309a6de4e95a2ce2001ad1294b060213?s=128&d=identicon&r=PG", "display_name": "Salvador", "link": "https://stackoverflow.com/users/1124866/salvador"}, "reply_to_user": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "edited": false, "score": 0, "creation_date": 1484787733, "post_id": 41731311, "comment_id": 70658432, "body": "@Laszlo: <code>WM_NCMOUSEMOVE</code> is the only useful: <code>wParam</code> always 5 all over the menu, but <code>lParam</code> x and y mouse coordinates... that I can use to identify the button with <code>GetMenuItemRect()</code>!"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1484788450, "post_id": 41731311, "comment_id": 70658623, "body": "<code>WM_MENUSELECT</code> is sent whenever a menu item is <i>selected</i>, whether that be from rolling/hovering over the menu item, or using the keyboard.  This is the correct message to handle to display a tooltip.  It works fine.  If you are having trouble using it, please show your actual code."}, {"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "edited": false, "score": 0, "creation_date": 1484789362, "post_id": 41731311, "comment_id": 70658838, "body": "@Salvador: Cool. Thanks for the info."}, {"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1484789610, "post_id": 41731311, "comment_id": 70658892, "body": "@RemyLebeau: Yes, right, but I think Salvador wants to display a tooltip always, whenever the cursor hovers over it, not just when it is selected. Whether or not the menu is selected on mouse move depends on user settings."}], "answers": [{"tags": [], "owner": {"reputation": 738, "user_id": 1124866, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/309a6de4e95a2ce2001ad1294b060213?s=128&d=identicon&r=PG", "display_name": "Salvador", "link": "https://stackoverflow.com/users/1124866/salvador"}, "is_accepted": false, "score": 0, "last_activity_date": 1485132539, "creation_date": 1485132539, "answer_id": 41797798, "question_id": 41731311, "link": "https://stackoverflow.com/questions/41731311/how-to-add-tooltip-to-menu-item/41797798#41797798", "title": "How to add tooltip to menu item", "body": "<p>Finally come to a solution good enough to make the tooltip appear on mouse over and disappear on mouse out (not perfect because has no initial nor autopop delay time).</p>\n\n<pre><code>#define _WIN32_IE 0x0300    // to reach TTM_TRACKACTIVATE in &lt;commctrl.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;commctrl.h&gt;\n\nHWND hToolTip;\nTOOLINFO ti = {0}; \n\n// WndProc\n    case WM_CREATE: {\n        HMENU hmenu = CreateMenu();\n        AppendMenu( hmenu, MF_HELP, 123, \"?\" );\n        SetMenu( hWnd, hmenu );\n\n        hToolTip = CreateWindow( TOOLTIPS_CLASS, 0, WS_POPUP, CW_USEDEFAULT, CW_USEDEFAULT,\n                                 CW_USEDEFAULT, CW_USEDEFAULT, hWnd, 0, 0, 0);\n        ti.cbSize = sizeof(TOOLINFO);\n        ti.hwnd = hWnd;\n        ti.uId = (UINT)hToolTip;\n        ti.lpszText = \"My tooltip\";\n        SendMessage( hToolTip, TTM_ADDTOOL, 0, (LPARAM)&amp;ti );\n        break;\n    }\n    case WM_NCMOUSEMOVE: {\n        RECT rect;\n        GetMenuItemRect( hWnd, GetMenu(hWnd), 0, &amp;rect );\n                                           // ^ zero-based position of the menu item\n        int x = LOWORD(lParam);\n        int y = HIWORD(lParam);\n        if ( x&gt;=rect.left &amp;&amp; y&gt;=rect.top &amp;&amp; x&lt;rect.right &amp;&amp; y&lt;rect.bottom )\n            SendMessage( hToolTip, TTM_TRACKACTIVATE, TRUE, (LPARAM)&amp;ti );\n        else\n            SendMessage( hToolTip, TTM_TRACKACTIVATE, FALSE, (LPARAM)&amp;ti );\n        break;\n    }\n    case WM_MOUSEMOVE:\n        SendMessage( hToolTip, TTM_TRACKACTIVATE, FALSE, (LPARAM)&amp;ti );\n        break;\n</code></pre>\n\n<p>Why I did use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb760421.aspx\" rel=\"nofollow noreferrer\" title=\"TTM_TRACKACTIVATE message\"><code>TTM_TRACKACTIVATE</code></a> instead of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb760402.aspx\" rel=\"nofollow noreferrer\" title=\"TTM_POPUP message\"><code>TTM_POPUP</code></a>?</p>\n\n<ul>\n<li>Oddly <code>TTM_POPUP</code> is not defined in <code>commctrl.h</code> by MinGW (gcc 5.3.0).</li>\n<li><code>TTM_POPUP</code> needs <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773175.aspx\" rel=\"nofollow noreferrer\" title=\"Enabling Visual Styles\">Visual Styles enabled with manifest</a>.</li>\n<li>Eventually for me <code>TTM_POPUP</code> is <strong>ineffective</strong> in this scenario.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 738, "user_id": 1124866, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/309a6de4e95a2ce2001ad1294b060213?s=128&d=identicon&r=PG", "display_name": "Salvador", "link": "https://stackoverflow.com/users/1124866/salvador"}, "is_accepted": true, "score": 0, "last_activity_date": 1486664176, "creation_date": 1486664176, "answer_id": 42144055, "question_id": 41731311, "link": "https://stackoverflow.com/questions/41731311/how-to-add-tooltip-to-menu-item/42144055#42144055", "title": "How to add tooltip to menu item", "body": "<p>I distilled a simpler and more efficient solution to create a tooltip for a single menu item:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;commctrl.h&gt;\n\n#define ID_BUTTON 123\nHWND hToolTip;\nTOOLINFO ti = {0};\n\n// WndProc\n    case WM_CREATE: {\n        // create menu\n        HMENU hmenu = CreateMenu();\n        AppendMenu( hmenu, MF_HELP, ID_BUTTON, \"?\" );\n        SetMenu( hWnd, hmenu );\n\n        InitCommonControls();   // necessary in Windows XP to register TOOLTIPS_CLASS\n\n        // create tooltip\n        hToolTip = CreateWindow( TOOLTIPS_CLASS, 0, WS_POPUP, 0, 0, 0, 0, hWnd, 0, 0, 0 );\n        ti.cbSize = sizeof(TOOLINFO);\n        ti.uFlags = TTF_SUBCLASS;\n        ti.hwnd = hWnd; // main window handle\n        ti.uId = (UINT)ID_BUTTON;   // distinguish it from eventual other tooltips\n        ti.lpszText = \"My tooltip\";\n        SendMessage(hToolTip, TTM_ADDTOOL, 0, (LPARAM)&amp;ti);\n        break;\n    }\n    case WM_SIZE:\n        ti.uId = (UINT)ID_BUTTON;\n        // get new coordinates of item\n        GetMenuItemRect( hWnd, GetMenu(hWnd), 0, &amp;ti.rect );\n                                           // ^ zero-based position of the menu item\n        // convert from screen to client coordinates\n        MapWindowPoints( NULL, hWnd, (LPPOINT)&amp;ti.rect, 2 );\n                      // ^ desktop handle               ^ POINT structures that is one RECT\n        SendMessage(hToolTip, TTM_NEWTOOLRECT, 0, (LPARAM)&amp;ti);\n        break;\n</code></pre>\n\n<p>I used <code>InitCommonControls</code> because is shorter and works, but is also obsolete and  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb775697.aspx\" rel=\"nofollow noreferrer\" title=\"InitCommonControlsEx function\"><code>InitCommonControlsEx</code></a> should be used instead.</p>\n\n<p>Above code was tested also on Windows XP: it works, but <code>GetLastError</code> after <code>CreateWindow</code> returns a 1309 <code>ERROR_NO_IMPERSONATION_TOKEN</code>.<br>\nIn order to solve it, <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773175.aspx#using_manifests\" rel=\"nofollow noreferrer\" title=\"Using Manifests\">create a manifest file</a> and in resource (.rc) file add the line:</p>\n\n<pre><code>CREATEPROCESS_MANIFEST_RESOURCE_ID RT_MANIFEST \"YourApp.exe.manifest\"\n</code></pre>\n"}], "owner": {"reputation": 738, "user_id": 1124866, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/309a6de4e95a2ce2001ad1294b060213?s=128&d=identicon&r=PG", "display_name": "Salvador", "link": "https://stackoverflow.com/users/1124866/salvador"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1234, "favorite_count": 0, "accepted_answer_id": 42144055, "answer_count": 2, "score": 0, "last_activity_date": 1486664176, "creation_date": 1484782275, "question_id": 41731311, "link": "https://stackoverflow.com/questions/41731311/how-to-add-tooltip-to-menu-item", "title": "How to add tooltip to menu item", "body": "<p>I'm looking for a solution to display a tooltip for a single menu item in my WinAPI program.</p>\n\n<pre><code>ID_MAIN_MENU MENU\n    BEGIN\n        ...\n    END\n    MENUITEM \"?\", ID_RIGHT_BUTTON, HELP\nEND\n</code></pre>\n\n<p>I'm able to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/hh298368.aspx\" rel=\"nofollow noreferrer\" title=\"How to Create a Tooltip for a Control\">add tooltip for a control</a> with <code>TOOLINFO</code> structure and <code>TTM_ADDTOOL</code> message, but this seems not apply to <code>HMENU</code> handle.</p>\n\n<p>I found <a href=\"http://www.codeguru.com/cpp/controls/controls/tooltipcontrols/\" rel=\"nofollow noreferrer\" title=\"Latest Tooltip controls Articles\">some C++ libraries</a> that add tooltips to menu items, but I'm using C.<br>\nMoreover here it's not possible to use the <code>WM_MENUSELECT</code> message, which is sent only clicking on the menu, not hovering over.</p>\n\n<p><a href=\"https://i.stack.imgur.com/weYLU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/weYLU.png\" alt=\"Tooltip on single menu item\"></a> An hypothetical image of what I want.</p>\n\n<p>Any suggestion is appreciated.</p>\n"}, {"tags": ["c", "string", "strstr"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1484782845, "post_id": 41731296, "comment_id": 70657084, "body": "While this is not necessarily the issue, in order to use arbitrary seeking (like negative offset from <code>SEEK_CUR</code>) you have to open the stream in binary mode. Your stream is open in text mode."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 3, "creation_date": 1484783039, "post_id": 41731296, "comment_id": 70657131, "body": "Also, is there any chance you are searching through a binary file, i.e.a file with zero bytes in it?"}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1484836003, "post_id": 41731296, "comment_id": 70681068, "body": "@AnT  Yep, that&#39;s probably it.  Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1484783556, "post_id": 41731469, "comment_id": 70657307, "body": "Sounds right.  Is there a fix other than going through byte by byte, that is, some equivalent to <code>strstr</code> that works for general byte arrays?"}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": false, "score": 1, "last_activity_date": 1484811813, "last_edit_date": 1484811813, "creation_date": 1484783313, "answer_id": 41731469, "question_id": 41731296, "link": "https://stackoverflow.com/questions/41731296/subtlety-in-strstr/41731469#41731469", "title": "Subtlety in strstr?", "body": "<p>A binary data file is going to contain '\\0' bytes acting as string ends. The more that are in there, the shorter the area <code>strstr</code> is going to search will be. Note <code>strstr</code> will consider its work done once it hits a 0 byte. </p>\n\n<p>You can scan the memory in intervals like</p>\n\n<pre><code>while (strlen (chunk) &lt; CHUNKSIZE) \n   chunk += strlen (chunk) + 1;\n</code></pre>\n\n<p>i.e. restart after a null byte in the chunk as long as you are still within the chunk.</p>\n"}, {"comments": [{"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484784811, "post_id": 41731510, "comment_id": 70657690, "body": "He has <code>bash</code> so he probably has <code>memmem()</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484785080, "post_id": 41731510, "comment_id": 70657764, "body": "@Jasen: There&#39;s a reasonable chance, yes, but I&#39;ve worked on machines with Bash that don&#39;t have <code>memmem()</code> \u2014 they&#39;re not running Linux, of course."}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1484838142, "post_id": 41731510, "comment_id": 70682731, "body": "@JonathanLeffler  Thanks for the great answer.  Had to go with chrqlie&#39;s since he went to the trouble of giving an implementation of memmem(), but this helped alot.  Much obliged."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 5, "last_activity_date": 1484785742, "last_edit_date": 1484785742, "creation_date": 1484783548, "answer_id": 41731510, "question_id": 41731296, "link": "https://stackoverflow.com/questions/41731296/subtlety-in-strstr/41731510#41731510", "title": "Subtlety in strstr?", "body": "<p>Since you say your file is binary, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strstr.html\" rel=\"nofollow noreferrer\"><code>strstr()</code></a> will stop scanning at the first null byte in the file.</p>\n\n<p>If you wish to look for patterns in binary data, then the <a href=\"http://man7.org/linux/man-pages/man3/memmem.3.html\" rel=\"nofollow noreferrer\"><code>memmem()</code></a> function is appropriate, if it is available. It is available on Linux and some other platforms (BSD, macOS, \u2026) but it is not defined as part of standard C or POSIX. It bears roughly the same relation to <code>strstr()</code> that <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/memcpy.html\" rel=\"nofollow noreferrer\"><code>memcpy()</code></a> bears to <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strcpy.html\" rel=\"nofollow noreferrer\"><code>strcpy()</code></a>.</p>\n\n<hr>\n\n<p>Note that your code should detect the number of bytes read by <code>fread()</code> and only search on that.</p>\n\n<pre><code>char   *tag = \u2026;     // Identify the data to be searched for\nsize_t  taglen = \u2026;  // Identify the data's length (maybe strlen(tag))\nint     nbytes;\nwhile ((nbytes = fread(chunk, 1, (CHUNK_SIZE + 1), infile)) &gt; 0)\n{\n    \u2026\n    tagcln = memmem(chunk, nbytes, tag, taglen);\n    if (tagcln != 0)\n        \u2026found it\u2026\n    \u2026\n}\n</code></pre>\n\n<p>It isn't really clear why you have the <code>+1</code> on the chunk size.  The <code>fread()</code> function doesn't add null bytes at the end of the data or anything like that.  I've left that aspect unchanged, but would probably not use it in my own code.</p>\n\n<p>It is good that you take care of identifying a tag that spans the boundaries between two chunks.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1484785979, "last_edit_date": 1484785979, "creation_date": 1484783815, "answer_id": 41731546, "question_id": 41731296, "link": "https://stackoverflow.com/questions/41731296/subtlety-in-strstr/41731546#41731546", "title": "Subtlety in strstr?", "body": "<p>The most likely reason for <code>strstr</code> to fail in your code is the presence of null bytes in the file.  Furthermore, you should open the file in binary mode for the file offsets to be meaningful.</p>\n\n<p>To scan for a sequence of bytes in a block, use the <code>memmem()</code> function.  If it is not available on your system, here is a simple implementation:</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nvoid *memmem(const void *haystack, size_t n1, const void *needle, size_t n2) {\n    const unsigned char *p1 = haystack;\n    const unsigned char *p2 = needle;\n\n    if (n2 == 0)\n        return (void*)p1;\n    if (n2 &gt; n1)\n        return NULL;\n\n    const unsigned char *p3 = p1 + n1 - n2 + 1;\n    for (const unsigned char *p = p1; (p = memchr(p, *p2, p3 - p)) != NULL; p++) {\n        if (!memcmp(p, p2, n2))\n            return (void*)p;\n    }\n    return NULL;\n}\n</code></pre>\n\n<p>You would modify your program this way:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid *memmem(const void *haystack, size_t n1, const void *needle, size_t n2);\n\n#define CHUNK_SIZE 65536\n\nint main(int argc, char **argv) {\n\n    if (argc &lt; 3) {\n        fprintf(sderr, \"missing parameters\\n\");\n        exit(1);\n    }\n\n    // open file\n    char *fname = argv[1];\n    FILE *infile = fopen(fname, \"rb\");\n    if (infile == NULL) {\n        fprintf(sderr, \"cannot open file %s: %s\\n\", fname, strerror(errno));\n        exit(1);\n    }\n\n    char *tag = argv[2];\n    size_t tag_len = strlen(tag);\n    size_t overlap_len = 0;\n    long long pos = 0;\n\n    char *chunk = malloc(CHUNK_SIZE + tag_len - 1);\n    if (chunk == NULL) {\n        fprintf(sderr, \"cannot allocate memory\\n\");\n        exit(1);\n    }\n\n    // loop\n    for (;;) { \n        // read chunk\n        size_t chunk_len = overlap_len + fread(chunk + overlap_len, 1, \n                                               CHUNK_SIZE, infile);\n        if (chunk_len &lt; tag_len) {\n            // end of file or very short file\n            break;\n        }\n        // look for tag\n        char *tag_location = memmem(chunk, chunk_len, tag, tag_len);\n        if (tag_location != NULL) {\n            // if you find tag, add to location the offset in bytes from beginning of chunk\n            printf(\"string found at %lld\\n\", pos + (tag_location - chunk));\n            break;\n        } else {\n            // if you don't find tag, add chunk size minus back_step to location and ...\n            overlap_len = tag_len - 1;\n            memmove(chunk, chunk + chunk_len - overlap_len, overlap_len);\n            pos += chunk_len - overlap_len;\n        }\n    }\n\n    fclose(infile);\n    free(chunk);\n    return 0;\n}\n</code></pre>\n\n<p>Note that the file is read in chunks of <code>CHUNK_SIZE</code> bytes, which is optimal if <code>CHUNK_SIZE</code> is a multiple of the file system block size.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1484786572, "creation_date": 1484786572, "answer_id": 41731936, "question_id": 41731296, "link": "https://stackoverflow.com/questions/41731296/subtlety-in-strstr/41731936#41731936", "title": "Subtlety in strstr?", "body": "<p>For some really simple code, you can use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/mmap.html\" rel=\"nofollow noreferrer\"><code>mmap()</code></a> and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/memcmp.html\" rel=\"nofollow noreferrer\"><code>memcmp()</code></a>.</p>\n\n<p>Error checking and proper header files are left as an exercise for the reader (there is at least one bug - another exercise for the reader to find):</p>\n\n<pre><code>int main( int argc, char **argv )\n{\n    // put usable names on command-line args\n    char *fname = argv[ 1 ];\n    char *tag = argv[ 2 ];\n\n    // mmap the entire file\n    int fd = open( fname, O_RDONLY );\n    struct stat sb;\n    fstat( fd, &amp;sb );\n    char *contents = mmap( NULL, sb.st_size, PROT_READ, MAP_PRIVATE, fd, 0 );\n    close( fd );\n\n    size_t tag_len = strlen( tag );\n\n    size_t bytes_to_check = 1UL + sb.st_size - tag_len;\n\n    for ( size_t ii = 0; ii &lt; bytes_to_check; ii++ )\n    {\n        if ( !memcmp( contents + ii, tag, tag_len ) )\n        {\n             // match found\n             // (probably want to check if contents[ ii + tag_len ]\n             //  is a `\\0' char to get actual string matches)\n        }\n    }\n\n    munmap( contents, sb.st_len );\n\n    return( 0 );\n}\n</code></pre>\n\n<p>That likely won't be anywhere near the fastest way (in general, <code>mmap()</code> is not going to be anywhere near a performance winner, especially in this use case of simply streaming through a file from beginning to end), but it's <em>simple</em>.</p>\n\n<p>(Note that <code>mmap()</code> also has problems if the file size changes while it's being read.  If the file grows, you won't see the additional data.  If the file is shortened, you'll get <code>SIGBUS</code> when you try to read the removed data.)</p>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 41731546, "answer_count": 4, "score": 2, "last_activity_date": 1484811813, "creation_date": 1484782190, "last_edit_date": 1484783512, "question_id": 41731296, "link": "https://stackoverflow.com/questions/41731296/subtlety-in-strstr", "title": "Subtlety in strstr?", "body": "<p>I have a file of binary data with various character strings sprinkled throughout.  I am trying to write a C code to find the first occurrence of user-specified strings in the file.  (I know this can be done with bash but I need a C code for other reasons.)  The code as it stands is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define CHUNK_SIZE 512\n\nint main(int argc, char **argv) {\n    char *fname = argv[1];\n    char *tag = argv[2];\n    FILE *infile;\n    char *chunk;\n    char *taglcn = NULL;\n    long lcn_in_file = 0;\n    int back_step;\n    fpos_t pos;\n\n    // allocate chunk\n    chunk = (char*)malloc((CHUNK_SIZE + 1) * sizeof(char));\n\n    // find back_step\n    back_step = strlen(tag) - 1;\n\n    // open file\n    infile = fopen(fname, \"r\");\n\n    // loop\n    while (taglcn == NULL) { \n        // read chunk\n        memset(chunk, 0, (CHUNK_SIZE + 1) * sizeof(char));\n        fread(chunk, sizeof(char), CHUNK_SIZE, infile);\n        printf(\"Read %c\\n\", chunk[0]);\n        // look for tag\n        taglcn = strstr(chunk, tag);\n        if (taglcn != NULL) {\n            // if you find tag, add to location the offset in bytes from beginning of chunk\n            lcn_in_file += (long)(taglcn - chunk);\n            printf(\"HEY I FOUND IT!\\n\");\n        } else {\n            // if you don't find tag, add chunk size minus back_step to location and ...\n            lcn_in_file += ((CHUNK_SIZE - back_step) * sizeof(char)); \n            // back file pointer up by back_step for next read \n            fseek(infile, -back_step, SEEK_CUR);\n            fgetpos(infile, &amp;pos);\n            printf(\"%ld\\n\", pos);\n            printf(\"%s\\n\\n\\n\", chunk);\n        }\n    }\n    printf(\"%ld\\n\", lcn_in_file);\n\n    fclose(infile);\n    free(chunk);\n}\n</code></pre>\n\n<p>If you're wondering, <code>back_step</code> is put in to take care of the unlikely eventuality that the string in question is split by a <code>chunk</code> boundary.</p>\n\n<p>The file I am trying to examine is about 1Gb in size.  The problem is that for some reason I can find any string within the first 9000 or so bytes, but beyond that, <code>strstr</code> is somehow not detecting any string.  That is, if I look for a string located beyond 9000 or so bytes into the file, <code>strstr</code> does not detect it.  The code reads through the entire file and never finds the search string.</p>\n\n<p>I have tried varying <code>CHUNK_SIZE</code> from 128 to 50000, with no change in results.  I have tried varying <code>back_step</code> as well.  I have even put in diagnostic code to print out <code>chunk</code> character by character when <code>strstr</code> fails to find the string, and sure enough, the string is exactly where it is supposed to be.  The diagnostic output of <code>pos</code> is always correct.</p>\n\n<p>Can anyone tell me where I am going wrong?  Is <code>strstr</code> the wrong tool to use here?</p>\n"}, {"tags": ["c", "printf", "scanf"], "comments": [{"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "edited": false, "score": 0, "creation_date": 1484781624, "post_id": 41731170, "comment_id": 70656709, "body": "You passed a pointer to an int as an argument to a function that takes an int in that position. remove the <code>*</code> from the variable declaration so that it reads <code>int number;</code> and see if that works."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1484781629, "post_id": 41731170, "comment_id": 70656711, "body": "Well, let&#39;s deal with the warning first. <code>%i</code> expects an <code>int</code> and you&#39;re giving it <code>number</code> which is <code>int*</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1484781714, "post_id": 41731170, "comment_id": 70656740, "body": "<code>int *number;</code> --&gt; <code>int number;</code>,  <code>sscanf(toSend,&quot;%199[^:]: %i:%299s&quot;, IP,  &amp;number, email);</code>"}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 2, "creation_date": 1484783195, "post_id": 41731170, "comment_id": 70657188, "body": "<code>0100</code> means sixty-four, right?  if you disagree use <code>%d</code> instead if <code>%i</code>"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484783328, "post_id": 41731170, "comment_id": 70657234, "body": "@Jasen: you are <b>right</b>, <code>%i</code> will magically <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">parse <code>0</code> prefixed numbers as octal</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484786043, "post_id": 41731170, "comment_id": 70658013, "body": "Dotted decimal notation should not have leading zeros, and neither should port numbers.  However, it is probably better safe than sorry \u2014 <code>%i</code> is probably not appropriate."}], "answers": [{"comments": [{"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "edited": false, "score": 0, "creation_date": 1484781760, "post_id": 41731220, "comment_id": 70656758, "body": "I don&#39;t think passing a reference to <code>number</code> is correct, that&#39;ll still have the type <code>int*</code> won&#39;t it?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 109, "user_id": 5654171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DHQttW6OW_E/AAAAAAAAAAI/AAAAAAAAAFM/Vxf2Lo_06JA/photo.jpg?sz=128", "display_name": "Arnau Van Boschken ArnauB", "link": "https://stackoverflow.com/users/5654171/arnau-van-boschken-arnaub"}, "edited": false, "score": 0, "creation_date": 1484782596, "post_id": 41731220, "comment_id": 70657016, "body": "@ArnauVanBoschkenArnauB - Please use BLUEPIXY sscanf with the enhancement that avoid buffer overruns"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1484783327, "post_id": 41731220, "comment_id": 70657232, "body": "Yes - Was thinking that myself. - Updated the answer. Not sure if assert is the best way to go - but it will do"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 1, "creation_date": 1484785827, "post_id": 41731220, "comment_id": 70657960, "body": "assert should only be used for debug runs. It&#39;s designed to compile to nothing on release builds. So N = scanf(...)  assert(N ==3) is fine, but not to wrap the call."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1484786490, "post_id": 41731220, "comment_id": 70658127, "body": "Space before <code>%i</code> is redundant. There&#39;s absolutely no reason for it to be there."}], "tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": false, "score": 4, "last_activity_date": 1484786596, "last_edit_date": 1484786596, "creation_date": 1484781659, "answer_id": 41731220, "question_id": 41731170, "link": "https://stackoverflow.com/questions/41731170/sscanf-problems-with-c/41731220#41731220", "title": "Sscanf Problems with C", "body": "<p>You need some memory to store number</p>\n\n<p>i.e. change</p>\n\n<pre><code>int *number;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>int number;\n</code></pre>\n\n<p>Then use</p>\n\n<pre><code> sscanf(toSend,\"%[^:]:%i:%[^:]\",IP, &amp;number, email);\n</code></pre>\n\n<p>I have also correct the typos - here is the code <a href=\"http://ideone.com/hpqGDZ\" rel=\"nofollow noreferrer\">http://ideone.com/hpqGDZ</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\nint main(){\n  char *toSend = \"175.85.10.147:2589:edward@gmail.com\";\n  int number;\n  char IP[200];\n  char email[300];\n  if (sscanf(toSend, \"%199[^:]:%i:%299[^:]\", IP, &amp;number, email) != 3) {\n     return 1;\n  }\n  printf(\"%s\\n\", IP);\n  printf(\"%i\\n\", number);\n  printf(\"%s\\n\", email);\n  return 0; \n}\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5654171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DHQttW6OW_E/AAAAAAAAAAI/AAAAAAAAAFM/Vxf2Lo_06JA/photo.jpg?sz=128", "display_name": "Arnau Van Boschken ArnauB", "link": "https://stackoverflow.com/users/5654171/arnau-van-boschken-arnaub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1484786596, "creation_date": 1484781377, "last_edit_date": 1484783143, "question_id": 41731170, "link": "https://stackoverflow.com/questions/41731170/sscanf-problems-with-c", "title": "Sscanf Problems with C", "body": "<p>Hi I am having problems with <code>sscanf</code>. I am just trying to write a simple test program to help me understand how it works. The problem arises when writing to differents variables with <code>sscanf</code>. Here is what their values should be:</p>\n\n<p>IP=175.85.10.147</p>\n\n<p>number=2589</p>\n\n<p>email = edward@gmail.com</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n int main() {\n     char *toSend = \"175.85.10.147:2589:edward@gmail.com\";\n     int *number;\n     char IP[200];\n     char email[300];\n     sscanf(toSend, \"%[^:]: %i%[^:]: \", IP, number, email);\n     printf(\"%s\", IP);\n     printf(\"%i\", number);\n     printf(\"%s\", email);\n     return 0; \n }\n</code></pre>\n\n<p>The IP it prints correct. </p>\n\n<p>The number doesn't print correctly, which might be related to this warning I'm getting at compile time: <code>format '%i' expects argument of type 'int' but argument 2 has type 'int *'</code>. </p>\n\n<p>The <code>email</code> variable just contains bizarre characters for some reason.</p>\n"}, {"tags": ["c", "bison", "yacc"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1484781157, "post_id": 41731019, "comment_id": 70656554, "body": "I guess you can do <code>lista: elemento { $$=$1; puts($1.str);}</code>."}, {"owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1484785266, "post_id": 41731019, "comment_id": 70657821, "body": "@DYZ you think will work in <code>linha: ESCREVER lista &#39;;&#39;</code>"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1484785443, "post_id": 41731019, "comment_id": 70657868, "body": "Printing a non-terminal is usually harder than a terminal. You can try, of course. You will need a loop over <code>lista</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484786702, "post_id": 41731019, "comment_id": 70658170, "body": "It&#39;s not immediately clear why you have a struct inside your union.  It undoes the benefit of using a union in the first place.  However, it could be that it is a side-effect of creating an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>), in which case, you&#39;re excused."}, {"owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484923302, "post_id": 41731019, "comment_id": 70723689, "body": "@JonathanLeffler  check the update"}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1484791137, "post_id": 41731969, "comment_id": 70659331, "body": "You don&#39;t need to use a <code>%union</code> declaration if all grammar symbols have the same <code>struct</code> type, which is quite common when using discriminated unions. Unfortunately, bison doesn&#39;t have any mechanism to automatically set the discriminator, unless you change to the C++ interface and use variant types. Anyway, see <a href=\"https://www.gnu.org/software/bison/manual/bison.html#Structured-Value-Type\" rel=\"nofollow noreferrer\">gnu.org/software/bison/manual/bison.html#Structured-Value-Ty&zwnj;&#8203;pe</a> for very brief documentation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1484807457, "post_id": 41731969, "comment_id": 70664120, "body": "@rici: I agree about a single structure in <code>%union</code> being ... undesirable; I&#39;m assuming that this is a stripped down MCVE and that there would be other structures in the union in the full code.  (Maybe I&#39;m being too charitable, but we can pretend.). Sometime, I&#39;ll look up the reference \u2014 it may be more immediately useful to the OP.  At least I think I&#39;ve given decent pointers in the right general direction; that may help the OP get the rest of the way."}, {"owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "edited": false, "score": 0, "creation_date": 1484840785, "post_id": 41731969, "comment_id": 70684690, "body": "@JonathanLeffler i try but the it is showing this error : ** error: field \u2018type\u2019 has incomplete type enum TokenType type; **                     ^"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484840901, "post_id": 41731969, "comment_id": 70684751, "body": "You&#39;re likely to need to update the question, <i>adding</i> new material (not modifying the existing material) so that the information can be properly formatted.  Please make sure it is as close to an MCVE as possible.  That said, did you include the <code>%{ \u2026 %}</code> section I showed?  If so, I&#39;ll have to play a bit; you need to be able to use user-defined types in unions."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484841529, "post_id": 41731969, "comment_id": 70685225, "body": "The fallback is to make <code>type</code> an <code>int</code> and perhaps use defines instead of the <code>enum</code>."}, {"owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "edited": false, "score": 0, "creation_date": 1484841547, "post_id": 41731969, "comment_id": 70685238, "body": "yes i included <code>%{ %}</code> , you are saying i need use <code>enum TokenType { T_STR, T_NUM }; </code> inside union?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1484857877, "post_id": 41731969, "comment_id": 70694721, "body": "Tl;dr: <code>%code requires { enum TokenType { T_STR, T_NUM }; }</code> so that the <code>enum</code> declaration ends up in the generated header file. The lexer (from which that error comes) needs the declaration in order to compile the semantic type <code>YYSTYPE</code>. Longer description in the <a href=\"https://www.gnu.org/software/bison/manual/bison.html#Prologue-Alternatives\" rel=\"nofollow noreferrer\">bison manual</a>"}, {"owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1484953040, "post_id": 41731969, "comment_id": 70738852, "body": "@rici %code requires work but now i have a question how did compiler will know <code>T_STR</code> is for string and <code>T_NUM</code> for integer , how i can declarate this?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "edited": false, "score": 0, "creation_date": 1484955161, "post_id": 41731969, "comment_id": 70739498, "body": "@Duboskydumont: Succinctly, the compiler doesn&#39;t know (that <code>T_STR</code> is for string type and <code>T_NUM</code> is for integer type); you need to write the code so that it is correct.  This is usual in language parsers written in C plus Bison plus Flex, at least in my experience.  Basically, C doesn&#39;t have a &#39;discriminated union&#39; type, unlike Pascal variant records, for example.  So, since the compiler doesn&#39;t know about this, the programmer must."}, {"owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "edited": false, "score": 0, "creation_date": 1485010375, "post_id": 41731969, "comment_id": 70751696, "body": "@JonathanLeffler iam trying do something like that <code>elemento:       TEXTO {        $$.type = T_STR;        $$.u.strval = $1;      }      | expr {        $$.type = T_NUM;        $$.u.intval = $1;       }     ;</code> and than use ur if code"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485010828, "post_id": 41731969, "comment_id": 70751818, "body": "If you have a union as I suggested, you can only store either an integer <i>or</i> a string but not both. So, when using <code>T_STR</code>, do not set <code>$$.u.intval</code>."}, {"owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "edited": false, "score": 0, "creation_date": 1485011988, "post_id": 41731969, "comment_id": 70752134, "body": "but i cant figure out how to set string in T_STR , i guess is impossible , i have experiencie only in C#"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1484786871, "creation_date": 1484786871, "answer_id": 41731969, "question_id": 41731019, "link": "https://stackoverflow.com/questions/41731019/bison-parser-trouble-in-print-token/41731969#41731969", "title": "Bison Parser: trouble in print token", "body": "<p>You need to be able to tell whether you've got a <code>u.str</code> or <code>u.num</code> value to work with \u2014 this is normally done by adding a flag to indicate which you have.  So, you might have a <code>u.type</code> element in the structure, and you'd set it to <code>T_STR</code> or <code>T_NUM</code> (values from an enumeration, perhaps), and then you can do:</p>\n\n<pre><code>if ($$.u.type == T_STR)\n    printf(\"str: [%s]\\n\", $$.u.str);\nelse\n{\n    assert($$.u.type == T_NUM);  // Make sure it gets changed with more types\n    printf(\"num: %d\\n\", $$.u.num);\n}\n</code></pre>\n\n<p>You might well factor that into a function, in fact; it is often useful to be able to dump structures on demand.  You'd need to think about whether the structure should have a tag so you can reference the type more easily.</p>\n\n<pre><code>%{\nenum TokenType { T_STR, T_NUM };\n%}\n\n%union {\n\n   struct token\n   {\n       enum TokenType type;\n       union\n       {\n           char *str;\n           int   num;\n       };\n   } u;\n}\n</code></pre>\n\n<p>This uses the anonymous union types added in C11.  You can now pass a <code>struct token *</code> into a function that prints the data appropriately.</p>\n"}], "owner": {"reputation": 53, "user_id": 7409720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-FuuT3R0eSE8/AAAAAAAAAAI/AAAAAAAAAWo/4aXGcxsA8Vw/photo.jpg?sz=128", "display_name": "A. Dubosky", "link": "https://stackoverflow.com/users/7409720/a-dubosky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "accepted_answer_id": 41731969, "answer_count": 1, "score": 2, "last_activity_date": 1484923198, "creation_date": 1484780616, "last_edit_date": 1484923198, "question_id": 41731019, "link": "https://stackoverflow.com/questions/41731019/bison-parser-trouble-in-print-token", "title": "Bison Parser: trouble in print token", "body": "<p>I already do some change , i try to change $$ to $2 but i still  with error becuase i dont recognize T_NUM and  T_STR , and it showing that error:\n$$ linha' Does not have a declared type</p>\n\n<p>bison -d -o gram.c pro.y:</p>\n\n<pre><code>pro.y:45.32-33: erro: $$ linha Does not have a declared type\n linha: ESCREVER lista ';' { if($$.u.type==T_STR){\n                                ^^\npro.y:46.48-49: erro: $$ de linha Does not have a declared type\n                                printf(\"[%s]\\n\",$$.u.str);\n                                                ^^\npro.y:49.43-44: erro: $$  linha Does not have a declared type\n                                    assert($$.u.type==T_NUM);\n                                           ^^\npro.y:50.50-51: erro: $$ linha Does not have a declared type\n                                    printf(\"%d\\n\",$$.u.num);\n                                                  ^^\nMakefile:9: recipe for target 'gram.c' failed\nmake: *** [gram.c] Error 1\n</code></pre>\n\n<p><strong>bison/yacc code(update)</strong></p>\n\n<pre><code>%{\n\n  #include &lt;stdio.h&gt;\n  #include \"pro.h\"\n  int yylex(void);\n  int yyerror(const char *s);\n%}\n\n%code requires\n{\nenum TokenType{ T_STR ,T_NUM };\n\n}\n\n%union{\n\n  struct token{\n\n    enum TokenType type;\n    union{ char *str;\n          int num;\n         };\n               }u;\n      }\n\n\n%token TERMINAR ESCREVER\n%token SUBTRACAO \n%token MULTIPLICACAO \n%token DIVISAO \n%token SOMA\n%token&lt;u.num&gt; NUM \n%token&lt;u.str&gt; TEXTO \n%type&lt;u&gt; elemento\n%type&lt;u.num&gt; expr \n%type&lt;u&gt; lista\n%start s\n\n%%\n\ns:linha s\n |TERMINAR ';' {return 0;}\n ;\n\nlinha: ESCREVER lista ';' { if($$.u.type==T_STR){\n                               printf(\"[%s]\\n\",$$.u.str);\n                                                } \n                            else{\n                                   assert($$.u.type==T_NUM);\n                                   printf(\"%d\\n\",$$.u.num);\n\n\n                                        }}\n     | VARS\n     ;\n\nlista: elemento { $$=$1; }\n     | lista ',' elemento \n     ;\n\nelemento:TEXTO { $&lt;u.str&gt;$=$1;}\n        |expr  { $&lt;u.num&gt;$=$1;}\n        ;\n\n\n\n\n\nVARS :\n     | NUM \n     | TEXTO\n     | expr\n     | TEXTO '=' VARS ';' /* para delcaracoes */\n     ;\n\n\n\nexpr     : NUM  SOMA expr                {$$=$1+$3;}\n         | NUM  SUBTRACAO expr           {$$=$1-$3;}\n         | NUM  MULTIPLICACAO expr       {$$=$1*$3;}\n         | NUM  DIVISAO expr             {$$=$1/$3;}\n     | NUM  '+' expr                 {$$=$1+$3;}\n         | NUM  '=' expr                 {$$=$1=$3;}\n         | NUM  '-' expr                  {$$=$1-$3;}\n         | NUM  '*' expr                 {$$=$1*$3;}\n         | NUM  '/' expr                  {$$=$1/$3;}\n         | NUM                           {$$=$1;   }\n         ;             \n\n\n%%\n</code></pre>\n"}, {"tags": ["c", "arduino", "infrared"], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1484782713, "creation_date": 1484782713, "answer_id": 41731370, "question_id": 41730980, "link": "https://stackoverflow.com/questions/41730980/arduino-infrared-not-entering-if/41731370#41731370", "title": "Arduino Infrared not entering IF", "body": "<p>First, have you checked if at line 71, <code>resultCode</code> actually  is <code>BUTTON_CHMI</code>?\nOtherwise you won't even enter the first switch-statement.</p>\n\n<p>Second, from line 93 onwards, you have a <code>switch</code>-statement with several <code>CASE</code>-entries, and each of them lacks a <code>break</code>; hence, regardless of which <code>CASE'-statement applies, you may fall into</code>BUTTON_BACK`, where the exit condition is set to true; I suppose you will always exit the menu, regardless which button you press.</p>\n"}], "owner": {"reputation": 29, "user_id": 3058510, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/48c6f4e2e661125393bdec4b260016b7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeopa", "link": "https://stackoverflow.com/users/3058510/jeopa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1484782713, "creation_date": 1484780375, "question_id": 41730980, "link": "https://stackoverflow.com/questions/41730980/arduino-infrared-not-entering-if", "title": "Arduino Infrared not entering IF", "body": "<p>I have an issue with my code, I have used Infrared Control in the past, but this time I'm 'nesting' it, so it could work like a menu. However I'm not entering the IF loop at line 84, can anybody see any issues? Thanks in advance.</p>\n\n<p><a href=\"http://pastebin.com/jNiL6m4X\" rel=\"nofollow noreferrer\">http://pastebin.com/jNiL6m4X</a></p>\n\n<p>Note that the exact same if loop is used at line 61 where it does work</p>\n"}, {"tags": ["css", "c", "gtk", "progress-bar", "glade"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1484945080, "post_id": 41730946, "comment_id": 70735562, "body": "Please add the warnings to the question. They are trying to tell you what&#39;s wrong."}, {"owner": {"reputation": 95, "user_id": 3977652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa4068136425001d3262ba5d2e4477b8?s=128&d=identicon&r=PG&f=1", "display_name": "nightk", "link": "https://stackoverflow.com/users/3977652/nightk"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1485372036, "post_id": 41730946, "comment_id": 70903582, "body": "The warning is right there, all I got its <code>min-height</code>or <code>height</code>followed by <code>is not a valid property name</code> ....I told that in the question"}, {"owner": {"reputation": 95, "user_id": 3977652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa4068136425001d3262ba5d2e4477b8?s=128&d=identicon&r=PG&f=1", "display_name": "nightk", "link": "https://stackoverflow.com/users/3977652/nightk"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1485372152, "post_id": 41730946, "comment_id": 70903655, "body": "And what is wrong it is the GTK version itself, on Windows I&#39;m using GTK 3.20 and this problem doesn&#39;t happen, the problem is with the 3.14 version of GTK, which is the most updated on Debian Jessie."}], "owner": {"reputation": 95, "user_id": 3977652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa4068136425001d3262ba5d2e4477b8?s=128&d=identicon&r=PG&f=1", "display_name": "nightk", "link": "https://stackoverflow.com/users/3977652/nightk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1259, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1497452448, "creation_date": 1484780179, "question_id": 41730946, "link": "https://stackoverflow.com/questions/41730946/gtk3-progressbar-c-css-styling-issues-progress-bar-is-too-thin", "title": "Gtk3 ProgressBar C. CSS/styling issues, progress bar is too thin", "body": "<p>I'm using C, GTK3 (debian jessie updated GTK to 3.14), Glade and CSS. I made a simple window with a GtkProgressBar and a few buttons to initiate and stop the progression, it all worked perfectly, but I thought that the progress bar was to thin so I've decided to make it bigger with CSS. But I could not use any kind of CSS height propriety without having an warning like <code>(progress:1722): Gtk-WARNING **: Theme parsing error: progress.css:17:14: 'min-height' is not a valid property name</code>. And I do can change colors, include border size/color/radius, everything but not the size of the progress bar itself, I've read and tried all styling options in the <a href=\"https://developer.gnome.org/gtk3/stable/GtkProgressBar.html#GtkProgressBar--s-min-horizontal-bar-height\" rel=\"nofollow noreferrer\">Developer Gnome ProgressBar page</a> (which are not many) and some CSS ones including these down below and a few others: </p>\n\n<pre><code>    -GtkProgressBar-min-horizontal-bar-height: 10px;\n\n    min-height: 10px;\n\n    height: 10px;    \n\n    background-size: 30px 30px; /*Just trying...*/\n</code></pre>\n\n<p>but every one of those gives me same kind of warning, so my question is: Is it possible to make progress bar thicker while using Gtk3, Glade, C and CSS?</p>\n"}, {"tags": ["c", "file", "header", "include", "embedded"], "comments": [{"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1484778615, "post_id": 41730539, "comment_id": 70655673, "body": "You should include them in the header file. That statement is nonsense. I&#39;m working on a embeded system with a SIL2 standard and we sure do have include statements in the header files."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1484778629, "post_id": 41730539, "comment_id": 70655678, "body": "What&#39;s wrong with includes on an embedded system? The standard has its list of headers that must appear on all conforming implementations for freestanding environments."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1484779549, "post_id": 41730539, "comment_id": 70656032, "body": "When was the book first published?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1484780771, "post_id": 41730539, "comment_id": 70656420, "body": "The <a href=\"http://www.literateprogramming.com/indhill-annot.pdf\" rel=\"nofollow noreferrer\">Indian Hill C Style and Coding Standards</a> (circa 1997) promulgated this theory.  It was produced by well-respected people.  The general consensus has changed and that guideline is no longer accepted in modern practice."}, {"owner": {"reputation": 19, "user_id": 5253564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0927c7a454314d884f514947b771307?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazy", "link": "https://stackoverflow.com/users/5253564/ghazy"}, "edited": false, "score": 0, "creation_date": 1484838895, "post_id": 41730539, "comment_id": 70683274, "body": "What code standard do guys recommend for embedded C? This one was suppose to be a good one."}, {"owner": {"reputation": 19, "user_id": 5253564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0927c7a454314d884f514947b771307?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazy", "link": "https://stackoverflow.com/users/5253564/ghazy"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1484857672, "post_id": 41730539, "comment_id": 70694615, "body": "@user3386109 it was published in 2008"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484915720, "post_id": 41730539, "comment_id": 70719012, "body": "It&#39;s really sad that there&#39;s such a flood of crap programming books on the market. Just today someone asked me if I could recommend any good C programming books for beginners... all I could say was &quot;I can give you anti-recommendations&quot;."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484916937, "post_id": 41730539, "comment_id": 70719694, "body": "@Ismailghazy I would strongly recommend MISRA-C:2012. It is a very professional document written by actual experts, rather than wannabe-experts."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1484919017, "post_id": 41730539, "comment_id": 70720957, "body": "Specifying the book in question (title, author, ISBN, publication date, and/or direct link for example) would give context to your question.  You may be misinterpreting the directive or reporting it out of context, or you may be reading trash.  If the &quot;book&quot; was free and antique, you should be cautious - there may be a reason that it is out of print!  &quot;supposed to be a good one&quot; by whom?  Citation! Citation! Citation!  Published in eBook form in 2008 or 1st print edition from 2008?  Why so secretive about what you are reading?  How do you expect to get a measured answer without revealing!?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484920367, "post_id": 41730539, "comment_id": 70721759, "body": "Get a better book. Even the standard headers include other standard headers."}, {"owner": {"reputation": 19, "user_id": 5253564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0927c7a454314d884f514947b771307?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazy", "link": "https://stackoverflow.com/users/5253564/ghazy"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1484920680, "post_id": 41730539, "comment_id": 70721975, "body": "@Clifford I did not not want to tarnish someones image. The book in question is &quot;embedded c coding standard&quot; by Micheal Barr. I have seen useful information on Barr group&#39;s website. I sent them a message to see what their reasoning was for that rule. the have the same rules on their website and I am guessing it is up to date with what they follow. <a href=\"http://barrgroup.com/Embedded-Systems/Books/Embedded-C-Coding-Standard/Introduction\" rel=\"nofollow noreferrer\">barrgroup.com/Embedded-Systems/Books/Embedded-C-Coding-Stand&zwnj;&#8203;ard/&hellip;</a>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1484926190, "post_id": 41730539, "comment_id": 70725609, "body": "You could tarnish his image only if you misrepresented what he&#39;d written or took it out of context (which is why the context is important).  If you truly and accurately report what he has stated in its correct context, then it is not <i>you</i> tarnishing his reputation - anyone can read his book and come to a view.  A good coding standard will include with any directive, its justification, what potential problem it is trying to solve and possibly circumstances where it may not apply and may be deviated from.  That (if present) is the context missing from here."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484926320, "post_id": 41730539, "comment_id": 70725703, "body": "@Ismailghazy Michael Barr usually knows what he is talking about. For example he gives some sound advice about this very topic in his blog <a href=\"http://embeddedgurus.com/barr-code/2010/11/what-belongs-in-a-c-h-header-file/\" rel=\"nofollow noreferrer\">here</a>. However, that particular rule in his coding standard seems weird indeed. <a href=\"http://barrgroup.com/Embedded-Systems/Books/Embedded-C-Coding-Standard/Module-Rules/Header-Files\" rel=\"nofollow noreferrer\">It can be found here</a>. All other rules on that page are sound, so I&#39;m wondering what the rationale behind this is. As it stands, it does indeed make no sense."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1484926518, "post_id": 41730539, "comment_id": 70725842, "body": "On the face of it however, the rule makes little sense.  When including an interface you should not have to know what interfaces it in turn requires; that will lead to many confusing errors and require you to include headers (by trial and error) that are not directly relevant to your code.  Your code may work because you have included something that your code needed but later remove, or it may work because your includes are in a specific order and reordering could break the code.  A header should include everything it needs to resolve any symbol it uses."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1484927257, "post_id": 41730539, "comment_id": 70726359, "body": "The &quot;reasoning&quot; for Rules 4.2 a to d make clear the intent - to not expose unnecessary interfaces , but adhering 4.2d just causes a worse problem of missing <i>necessary</i> interfaces.  If all the other rules are followed any perceived problem that 4.2d attempts to solve is lessened in any case.  If you don&#39;t include necessary interfaces there, you will have to include or declare then elsewhere and in the correct order - with no means of knowing what the order is.  For reusable or third-party library code it is impractical and undesirable to follow this rule."}], "answers": [{"tags": [], "owner": {"reputation": 865, "user_id": 40495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6542b6531e55a40f5bf5311c7a97ca65?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/40495/dave"}, "is_accepted": false, "score": 4, "last_activity_date": 1484779401, "creation_date": 1484779401, "answer_id": 41730795, "question_id": 41730539, "link": "https://stackoverflow.com/questions/41730539/include-in-header-files-in-embedded/41730795#41730795", "title": "#include in header files in embedded", "body": "<p>This is a stupid and counterproductive rule for precisely the reason you identified.  The alternative is for every .c file to include all of the .h files that a subsequently included header will require.  You can imagine that if you introduce a new dependency in a commonly included header that you will now have to update every C file that includes that header.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 5253564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0927c7a454314d884f514947b771307?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazy", "link": "https://stackoverflow.com/users/5253564/ghazy"}, "edited": false, "score": 1, "creation_date": 1484841534, "post_id": 41730848, "comment_id": 70685229, "body": "Ok. I agree with this. That is what I usually do and then I read this and thought  I was making a mistake. Perhaps it was easier with older tools to not have headers within headers. Also, its an e book I&#39;ll have to Shift+Delete"}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 8, "last_activity_date": 1484779652, "creation_date": 1484779652, "answer_id": 41730848, "question_id": 41730539, "link": "https://stackoverflow.com/questions/41730539/include-in-header-files-in-embedded/41730848#41730848", "title": "#include in header files in embedded", "body": "<p>Throw that book away; it is absolute garbage. In fact, you should burn it, to make sure no other poor soul ever picks it up.</p>\n\n<p>Header files should <strong><em>absolutely</em></strong> include all of the header files necessary for them to be self-sufficient. There is nothing worse than trying to carefully massage the order of your <code>#include</code> statements to be sure that the types needed by one are already defined before it is included.</p>\n"}], "owner": {"reputation": 19, "user_id": 5253564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0927c7a454314d884f514947b771307?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazy", "link": "https://stackoverflow.com/users/5253564/ghazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 1, "closed_date": 1484780853, "answer_count": 2, "score": 1, "last_activity_date": 1484779739, "creation_date": 1484778192, "last_edit_date": 1484779739, "question_id": 41730539, "link": "https://stackoverflow.com/questions/41730539/include-in-header-files-in-embedded", "closed_reason": "Duplicate", "title": "#include in header files in embedded", "body": "<p>I am reading through an embedded C standard book and I noticed the following:</p>\n\n<blockquote>\n  <p>No header file shall contain an #include statement</p>\n</blockquote>\n\n<p>What should I do with function declarations that have non-standard types?</p>\n\n<p>example: <code>void function(some_funky_type x);</code></p>\n"}, {"tags": ["c", "linux", "gnu"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1484778363, "post_id": 41730537, "comment_id": 70655573, "body": "The &#39;variable&#39; <code>errno</code> is thread-local, not global."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1484778365, "post_id": 41730537, "comment_id": 70655574, "body": "Not clear what you are asking. <code>errno</code> is accessible globally per thread. So you don&#39;t need any library function to get it&#39;s value. Simply: <code>r = some_libc_function(); if (r==-1) last_errno = errno;</code>"}, {"owner": {"reputation": 1, "user_id": 7437928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4542cf560f92711e2f6007af05f34d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/7437928/ryan"}, "edited": false, "score": 0, "creation_date": 1484779132, "post_id": 41730537, "comment_id": 70655872, "body": "Thanks for the replies. I probably should have clarified further that I am accessing these libraries from an environment that provides an interface for calling libraries, but does not have a way to compile code alongside these library calls, such as including &lt;errno.h&gt; and accessing errno directly as a variable. This is why I&#39;m trying to see if there is any way to access errno if I have not written code specifically to do so. Not sure if that makes sense."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 3, "creation_date": 1484779381, "post_id": 41730537, "comment_id": 70655974, "body": "@Ryan: In that case you probably need to make an additional stub library containing a <code>get_errno</code> function or similar that simply returns the value (or address) of <code>errno</code>. Alternatively you could use the <code>__errno_location</code> function that&#39;s the backend of <code>errno</code> on glibc, but this would not be a portable design."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1484781227, "post_id": 41730537, "comment_id": 70656577, "body": "Love the stub idea @_R..  So, Ryan, why can&#39;t you get errno by its address? What about <code>dlsym()</code>?  Or I guess the problem there is you need the already opened library in the image&#39;s runtime list..."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1484781402, "post_id": 41730537, "comment_id": 70656635, "body": "@clearlight: <code>errno</code> is a thread-local symbol, not a global symbol, so it doesn&#39;t have an address as such -- just an offset in the thread local section.  For historical reasons, it is often not implemented simply as a thread-local symbol called <code>errno</code>, so you can&#39;t just declare that, even if your compiler supports thread-local symbols."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1484781552, "post_id": 41730537, "comment_id": 70656679, "body": "@ChrisDodd, so if it&#39;s in TLS are can it be inferred that there&#39;s some non-ugly way to access it without a stub function?"}, {"owner": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "reply_to_user": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1484781613, "post_id": 41730537, "comment_id": 70656705, "body": "@clearlight: depends on C library. For example, Solaris libc does this: <code>#define errno (*(___errno()))</code>"}, {"owner": {"reputation": 1, "user_id": 7437928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4542cf560f92711e2f6007af05f34d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/7437928/ryan"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1484782137, "post_id": 41730537, "comment_id": 70656868, "body": "@R.. Thanks for the stub idea. I gave this a try by forcing close() to generate an error (gave it an fd of -1) and then used __errno_location to get the errno pointer. Then deref&#39;ing this address returned a value of 9 (EBADFD), which is what I expected. I understand this isn&#39;t portable, so I&#39;ll need to look further to see if this will be an issue for my API, but at the moment it does what I need."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1484787531, "post_id": 41730537, "comment_id": 70658378, "body": "@ChrisDodd: Formally, <code>errno</code> is a macro, not an external object of any sort, so you can&#39;t expect there to be a symbol for it. Whether <code>errno</code> has an address is an open question: see <a href=\"http://stackoverflow.com/questions/12945486/is-errno-legal-c\">stackoverflow.com/questions/12945486/is-errno-legal-c</a>"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1484787895, "post_id": 41730537, "comment_id": 70658478, "body": "@R: <code>errno</code> might be a macro, or it might not be -- different implementations differ. You can rely on it being a single lvalue for any particular thread, so you can get the address of it for a thread, that address will be stable for that thread."}], "answers": [{"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1484805127, "creation_date": 1484805127, "answer_id": 41734686, "question_id": 41730537, "link": "https://stackoverflow.com/questions/41730537/way-to-access-errno-value-from-previous-libc-so-6-library-call/41734686#41734686", "title": "Way to access errno value from previous libc.so.6 library call?", "body": "<p><code>errno</code> is not a global per process variable (as it used to be) in a multithread environment like linux, there is a different <code>errno</code> pseudovariable per thread (actually <code>errno</code> is a macro defined in <code>#include &lt;errno.h&gt;</code>).  Answering your question, the best and easiest way to save the <code>errno</code> from a previous system call is to make a copy of <code>errno</code> as soon as the system call finishes.  You can even make a wrapper around your system calls to store errno values in a circular buffer so you can get the last, previous to last, and so on, up to some fixed value.  As storing all those values needs some amount of memory, no provision in the system for it has been called.  Also, the <code>errno</code> value is something associated to the last system call made by one thread, so as you have to decide how and when you do a system call, you have also the possibility to decide if you want to store how and when the value of the error. </p>\n"}], "owner": {"reputation": 1, "user_id": 7437928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4542cf560f92711e2f6007af05f34d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/7437928/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484805127, "creation_date": 1484778190, "last_edit_date": 1484781132, "question_id": 41730537, "link": "https://stackoverflow.com/questions/41730537/way-to-access-errno-value-from-previous-libc-so-6-library-call", "title": "Way to access errno value from previous libc.so.6 library call?", "body": "<p>If what I am trying to do is not a good idea or not supported, please feel free to let me know. I am trying to use various system libraries (<code>libc.so.6</code>, <code>libpthread.so.0</code>, etc.) for an API. The API will be calling into these libraries to access <code>open()</code>, `close(), etc...</p>\n\n<p>I'm not sure to handle errno on failures, returning -1, rather than returning errno directly. When I make a call to <code>close()</code> in <code>libc.so.6</code>, it returns -1 on failure, so I can detect an error occurred. However, I cannot seem to find any mechanism in libc that allows me to query the current value of errno that may have been set by a previous function call in the same thread. This isn't a problem when calling pthread functions because they return errno's value directly, and I can work with this.</p>\n\n<p>Is there a way to determe the current value of errno for a given thread following the execution of a function that would have set errno (such as <code>close()</code>) using a library call of some kind?</p>\n\n<p>Possible solutions:</p>\n\n<p>I could write a wrapper library that calls <code>close()</code>, etc... queries errno in an error state, and returns errno directly, but I'm trying to avoid having to include custom libraries that would have to be included with the API. </p>\n\n<p>If there is a way to call a standard library, that would be ideal.</p>\n"}, {"tags": ["c", "text", "non-english"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1484778088, "post_id": 41730460, "comment_id": 70655452, "body": "Make sure your file is encoded as UTF-8 and your console expects UTF-8. Apparently that\u2019s done on Windows like this: <a href=\"https://stackoverflow.com/questions/388490/unicode-characters-in-windows-command-line-how\" title=\"unicode characters in windows command line how\">stackoverflow.com/questions/388490/&hellip;</a>"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1484778157, "post_id": 41730460, "comment_id": 70655488, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "edited": false, "score": 0, "creation_date": 1484778208, "post_id": 41730460, "comment_id": 70655508, "body": "Det &#228;r f&#246;rmodligen inget fel p&#229; ditt program. Det du ser i DOS burken har med code page inst&#228;llningen att g&#246;ra. Du f&#229;r st&#228;lla in code page 851."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1484778229, "post_id": 41730460, "comment_id": 70655517, "body": "Look up <code>wchar</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1484778652, "post_id": 41730460, "comment_id": 70655688, "body": "(Do not use wide characters [wchar]. It doesn\u2019t save you from having to deal with encodings and will make things worse.)"}, {"owner": {"reputation": 19, "user_id": 7040261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f001032eb110e51b378ef0ad36041cc4?s=128&d=identicon&r=PG&f=1", "display_name": "mohxinn", "link": "https://stackoverflow.com/users/7040261/mohxinn"}, "edited": false, "score": 0, "creation_date": 1484830010, "post_id": 41730460, "comment_id": 70676987, "body": "I have added code sample and screenshoit of program output and text file that is used. I am trying to search for string &quot;FR&#197;GA&quot; which as you can see is present in the file but it is not found. I opened and checked in Notepad++ and file encoding is UTF-8"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1484839134, "post_id": 41730460, "comment_id": 70683447, "body": "@mohxinn: What character encoding is used by the input file? What character encoding is expected by the console? Are they the same? If not, you must transcode the characters before displaying them."}], "answers": [{"comments": [{"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1484838921, "post_id": 41745237, "comment_id": 70683295, "body": "Nice explanation but it doesn&#39;t answer the question."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "reply_to_user": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1484839078, "post_id": 41745237, "comment_id": 70683403, "body": "@CareyGregory: The question cannot be answered unless we know what encoding is used in the input file and what encoding is used by the console. That&#39;s the point of the explanation."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1484839181, "post_id": 41745237, "comment_id": 70683499, "body": "He said it&#39;s UTF-8 in the comments."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "reply_to_user": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 1, "creation_date": 1484839242, "post_id": 41745237, "comment_id": 70683551, "body": "@CareyGregory: The input file is UTF-8, but the console isn&#39;t. The console looks like CP437 or CP850. I have made a comment asking for clarification."}, {"owner": {"reputation": 19, "user_id": 7040261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f001032eb110e51b378ef0ad36041cc4?s=128&d=identicon&r=PG&f=1", "display_name": "mohxinn", "link": "https://stackoverflow.com/users/7040261/mohxinn"}, "edited": false, "score": 0, "creation_date": 1484853107, "post_id": 41745237, "comment_id": 70691970, "body": "As shown in the screenshot from Notepad++, the encoding on the file is UTF-8  @AlexP How do I check the encoding expected by the console? Is it possible to change the encoding via the CodeBlocks IDE that I am using?  I am using Windows 10 if that is of any consequence :)"}, {"owner": {"reputation": 19, "user_id": 7040261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f001032eb110e51b378ef0ad36041cc4?s=128&d=identicon&r=PG&f=1", "display_name": "mohxinn", "link": "https://stackoverflow.com/users/7040261/mohxinn"}, "edited": false, "score": 0, "creation_date": 1484853410, "post_id": 41745237, "comment_id": 70692128, "body": "Ok I manage to figure out what codepage is used and it seems to be 850  C:\\Users\\mohsi&gt;chcp Active code page: 850  What should be the codepage set to for UTF-8? Is it 65001 as mentioned here: <a href=\"http://superuser.com/questions/269818/change-default-code-page-of-windows-console-to-utf-8\" title=\"change default code page of windows console to utf 8\">superuser.com/questions/269818/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": false, "score": 1, "last_activity_date": 1484839637, "last_edit_date": 1484839637, "creation_date": 1484838730, "answer_id": 41745237, "question_id": 41730460, "link": "https://stackoverflow.com/questions/41730460/reading-text-file-with-non-english-character-in-c/41745237#41745237", "title": "Reading text file with non-english character in C", "body": "<p>Summary: If you read text from a file encoded in UTF-8 and display it on the console you must either set the console to UTF-8 or transcode the text from UTF-8 to the encoding used by the console (in English-speaking countries, usually MS-DOS code page 437 or 850).</p>\n\n<h3>Longer explanation</h3>\n\n<p>Bytes are not characters and characters are not bytes. The <code>char</code> data type in C holds a byte, not a character. In particular, the character <code>\u00c5</code> (Unicode <code>&lt;U+00C5&gt;</code>) mentioned in the comments can be represented in many ways, called <em>encodings</em>:</p>\n\n<ul>\n<li>In UTF-8 it is two bytes, <code>'\\xC3'</code> <code>'\\x85'</code>;</li>\n<li>In UTF-16 it is two bytes, either <code>'\\xC5'</code> <code>'\\x00'</code> (little-endian UTF-16), or <code>'\\x00'</code> <code>'\\xC5'</code> (big-endian UTF-16);</li>\n<li>In Latin-1 and Windows-1252, it is one byte, <code>'\\xC5'</code>;</li>\n<li>In MS-DOS code page 437 and code page 850, it is one byte, <code>'\\x8F'</code>.</li>\n</ul>\n\n<p>It is the responsibility of the programmer to translate between the internal encoding used by the program (usually but not always Unicode), the encoding used in input or output files, and the encoding expected by the display device.</p>\n\n<p>Note: Sometimes, if the program does not do much with the characters it reads and outputs, one can get by just by making sure that the input files, the output files, and the display device all use the same encoding. In Linux, this encoding is almost always UTF-8. Unfortunately, on Windows the existence of multiple encodings is a fact of life. System calls expect either UTF-16 or Windows-1252. By default, the console displays Code Page 437 or 850. Text files are quite often in UTF-8. Windows is old and complicated.</p>\n"}], "owner": {"reputation": 19, "user_id": 7040261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f001032eb110e51b378ef0ad36041cc4?s=128&d=identicon&r=PG&f=1", "display_name": "mohxinn", "link": "https://stackoverflow.com/users/7040261/mohxinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484839637, "creation_date": 1484777925, "last_edit_date": 1484829883, "question_id": 41730460, "link": "https://stackoverflow.com/questions/41730460/reading-text-file-with-non-english-character-in-c", "title": "Reading text file with non-english character in C", "body": "<p>Is it possible to read a text file hat has non-english text?</p>\n\n<p>Example of text in file:</p>\n\n<blockquote>\n  <p>E 37</p>\n  \n  <p>SVAR:</p>\n  \n  <p>Fettembolisyndrom. (1 po\u00e4ng)</p>\n</blockquote>\n\n<p>Example of what is present in buffer which stores \"fread\" output using \"puts\" :</p>\n\n<blockquote>\n  <p>E 37   SVAR:</p>\n  \n  <p>Fettembolisyndrom.\n  (1 po\u251c\u00f1ng)</p>\n</blockquote>\n\n<p>Under Linux my program was working fine but in Windows I am seeing this problem with non-english letters. Any advise how this can be fixed?</p>\n\n<p>Program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n\nint debug = 0;\n\nint main(int argc, char* argv[])\n{\n    if (argc &lt; 2)\n    {\n        puts(\"ERROR! Please enter a filename\\n\");\n        exit(1);\n    }\n    else if (argc &gt; 2)\n    {\n        debug = atoi(argv[2]);\n        puts(\"Debugging mode ENABLED!\\n\");\n    }\n\n    FILE *fp = fopen(argv[1], \"rb\");\n    fseek(fp, 0, SEEK_END);\n    long fileSz = ftell(fp);\n    fseek(fp, 0, SEEK_SET);\n\n    char* buffer;\n    buffer = (char*) malloc (sizeof(char)*fileSz);\n    size_t readSz = fread(buffer, 1, fileSz, fp);\n    rewind(fp);\n\n    if (readSz == fileSz)\n    {\n        char tmpBuff[100];\n        fgets(tmpBuff, 100, fp);\n\n        if (!ferror(fp))\n        {\n            printf(\"100 characters from text file: %s\\n\", tmpBuff);\n        }\n        else\n        {\n            printf(\"Error encounter\");\n        }\n    }\n\n    if (strstr(\"FR\u00c5GA\",buffer) == NULL)\n    {\n        printf(\"String not found!\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3zxCl.jpg\" rel=\"nofollow noreferrer\">Sample output</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/pLdTs.png\" rel=\"nofollow noreferrer\">Text file</a></p>\n"}, {"tags": ["c", "arduino", "avr"], "comments": [{"owner": {"reputation": 5310, "user_id": 1790864, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/u8BJF.png?s=128&g=1", "display_name": "Rev", "link": "https://stackoverflow.com/users/1790864/rev"}, "edited": false, "score": 0, "creation_date": 1484816600, "post_id": 41730068, "comment_id": 70668575, "body": "Do you want a code review or is something actually not working as expected? And from the code you posted its not really clear what you intend to achieve. In general there is nothing wrong with setting OCR in the interrupt handler."}, {"owner": {"reputation": 1, "user_id": 7437990, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tPKAdMU9xkk/AAAAAAAAAAI/AAAAAAAAGTc/lDioQyfOxOY/photo.jpg?sz=128", "display_name": "Aleksander Motyka", "link": "https://stackoverflow.com/users/7437990/aleksander-motyka"}, "reply_to_user": {"reputation": 5310, "user_id": 1790864, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/u8BJF.png?s=128&g=1", "display_name": "Rev", "link": "https://stackoverflow.com/users/1790864/rev"}, "edited": false, "score": 0, "creation_date": 1484853966, "post_id": 41730068, "comment_id": 70692424, "body": "Yeah, it works not like I intended to. INT2 interrupt has signal at 120Hz frequency. The PWM I mentioned in code controls LEDs. So after this code i should be able to see very short blinks of LEDs. But there is no blinks. I wondered what I am doing wrong."}, {"owner": {"reputation": 1, "user_id": 7437990, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tPKAdMU9xkk/AAAAAAAAAAI/AAAAAAAAGTc/lDioQyfOxOY/photo.jpg?sz=128", "display_name": "Aleksander Motyka", "link": "https://stackoverflow.com/users/7437990/aleksander-motyka"}, "reply_to_user": {"reputation": 5310, "user_id": 1790864, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/u8BJF.png?s=128&g=1", "display_name": "Rev", "link": "https://stackoverflow.com/users/1790864/rev"}, "edited": false, "score": 0, "creation_date": 1484854579, "post_id": 41730068, "comment_id": 70692811, "body": "I&#39;ve edited code above. It should tell more about what timer3 interrupt does. Color and time are structs with volatile variables. I have to mention that if there is no INT2 signal LEDs blinks randomly."}], "owner": {"reputation": 1, "user_id": 7437990, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tPKAdMU9xkk/AAAAAAAAAAI/AAAAAAAAGTc/lDioQyfOxOY/photo.jpg?sz=128", "display_name": "Aleksander Motyka", "link": "https://stackoverflow.com/users/7437990/aleksander-motyka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484854248, "creation_date": 1484776116, "last_edit_date": 1484854248, "question_id": 41730068, "link": "https://stackoverflow.com/questions/41730068/set-ocr-register-in-interrupt", "title": "Set OCR register in interrupt?", "body": "<p>On ATmega 32u4 I've got two timers. One is for measuring ticks between interrupts and second which counts 1/60 of number of ticks. I'm not sure I'm allowed what I'm doing and if that is correct. If you could tell me what is wrong I would greatfull.</p>\n\n<pre><code>void setup(){\n    EIMSK |= (1 &lt;&lt; INT2); //INT2 enable\n    EICRA |= (1 &lt;&lt; ISC21) | (1 &lt;&lt; ISC20); //INT2 RISING EDGE\n    DDRD &amp;= ~(1 &lt;&lt; PD2); //PD0 (INT0)(3) as input\n    PORTD &amp;= ~(1 &lt;&lt; PD2); //PD0 pulldown\n\n    TCCR1B |= (1 &lt;&lt; CS11); //prescaler 8\n    //TIMER3 - 1/60\n    TCCR3A |= (1 &lt;&lt; WGM32); //CTC Mode\n    TCCR3B |= (1 &lt;&lt; CS31); //prescaler 8\n    TIMSK3 |= (1 &lt;&lt; OCIE3A); //compate interrupt enable\n    sei();\n}\n\nISR(INT2_vect) {\n    TCNT3 = 0;\n    OCR3A = TCNT1 / 60;\n    TCNT1 = 0;\n    degree = 30;\n}\n\nISR(TIMER3_COMPA_vect) {\n    Color * currentColor = &amp;bColor;\n    if (degree == 0)\n        degree = 59;\n    else degree--;\n    if (degree == time.second)\n        currentColor = &amp;sColor;\n    else if (degree == time.minute)\n        currentColor = &amp;mColor;\n    else if (degree % 5 == 0 &amp;&amp; degree / 5 == time.hour)\n        currentColor = &amp;hColor;\n\n    //set pwm\n    RedReg = currentColor-&gt;Red;\n    GreenReg = currentColor-&gt;Green;\n    BlueReg = currentColor-&gt;Blue;\n}\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484775371, "post_id": 41729861, "comment_id": 70654208, "body": "Why do you think it doesn&#39;t work? Anyway, I bet that&#39;s the <code>\\n</code> problem from the previous <code>scanf</code>..."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 1, "creation_date": 1484775556, "post_id": 41729861, "comment_id": 70654315, "body": "There are some missing brackets. And where is the <code>else</code> case ?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 2, "creation_date": 1484775602, "post_id": 41729861, "comment_id": 70654340, "body": "Fix your formatting and post your full code as this does not compile. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Also, define &quot;doesn&#39;t work&quot;"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1484775751, "post_id": 41729861, "comment_id": 70654417, "body": "<code>herhangibirinedonusum</code> Why would you name your function that?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1484775879, "post_id": 41729861, "comment_id": 70654476, "body": "Does <i>herhangibirinedonusum</i> really mean &quot;anyway&quot;? Herhangibirinedonusum, there is no <code>else</code>in the code you posted."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484775913, "post_id": 41729861, "comment_id": 70654492, "body": "In the <code>herhangibirinedonusum()</code>, you are computing <code>pow(ilk_taban, i)</code>, but the local variable <code>i</code> is allocated but not initialized."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1484777925, "post_id": 41729861, "comment_id": 70655391, "body": "If a is <b>not</b> 1, you still check for <code>b==1</code> even though b has not been initialized. This could cause an error. You should explicitly initialize <code>int b=0&#39;</code> just in case your compiler does not set it for you."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 2, "creation_date": 1484778063, "post_id": 41729861, "comment_id": 70655438, "body": "Final comment - use a debugger"}, {"owner": {"reputation": 231, "user_id": 7437962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e808880ad681c0a265db6a8cf9e0f9cc?s=128&d=identicon&r=PG&f=1", "display_name": "webteroyal", "link": "https://stackoverflow.com/users/7437962/webteroyal"}, "edited": false, "score": 0, "creation_date": 1484814918, "post_id": 41729861, "comment_id": 70667611, "body": "i edited my code. Can you remove negative points. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 7437962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e808880ad681c0a265db6a8cf9e0f9cc?s=128&d=identicon&r=PG&f=1", "display_name": "webteroyal", "link": "https://stackoverflow.com/users/7437962/webteroyal"}, "edited": false, "score": 0, "creation_date": 1484845327, "post_id": 41730564, "comment_id": 70687754, "body": "my question was why function doesn&#39;t work in if-else statement. I find solution, but your answer isn&#39;t related to question asked. Thanks."}], "tags": [], "owner": {"reputation": 41, "user_id": 3167637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AtrFU.png?s=128&g=1", "display_name": "Guy", "link": "https://stackoverflow.com/users/3167637/guy"}, "is_accepted": false, "score": 0, "last_activity_date": 1484779112, "last_edit_date": 1484779112, "creation_date": 1484778340, "answer_id": 41730564, "question_id": 41729861, "link": "https://stackoverflow.com/questions/41729861/function-does-not-work-in-if-else-statement-in-c/41730564#41730564", "title": "Function does not work in if else statement in c", "body": "<p>You haven't said to return any value from function <code>herhangibirinedonusum</code>, add <code>return SOMETHING</code> (replace SOMETHING with a variable) so that in <code>int main()</code> it will know what values follow the if statement and which don't (else: stops the loop that is in <code>int main()</code>). Also if you are trying to start a loop in: </p>\n\n<pre><code>if (b == 1) {\n        herhangibirinedonusum(sayi, 2, 8);\n    } \"\n</code></pre>\n\n<p>make sure to have a while loop: </p>\n\n<pre><code>while(i=1){\n   herhangibirinedonusum(sayi, 2, 8)\n   if(\"herhangibirinedonusum==VALUE){ /*REPLACE WITH NEEDED VALUE*/\n      continue;\n      /*(or do something else)*/\n   }\n   else{\n      break;\n      /*(or do something else)*/\n   }\n}\n</code></pre>\n\n<p>Also when you declared <code>donusturulen</code> as a long int it was not necessary to say: </p>\n\n<pre><code>long int donustrululen;\ndonustrululen = 0;\n</code></pre>\n\n<p>You should have used:\n<code>long int donustrululen = 0</code> because there is no need to say that the variable equals 0 after you declared it (same for index variable) because it makes the code longer (which is not what you should do - try to make the code as short as possible but still keep it working), and also don't name functions that long.</p>\n"}], "owner": {"reputation": 231, "user_id": 7437962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e808880ad681c0a265db6a8cf9e0f9cc?s=128&d=identicon&r=PG&f=1", "display_name": "webteroyal", "link": "https://stackoverflow.com/users/7437962/webteroyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1484845484, "creation_date": 1484775253, "last_edit_date": 1484845484, "question_id": 41729861, "link": "https://stackoverflow.com/questions/41729861/function-does-not-work-in-if-else-statement-in-c", "title": "Function does not work in if else statement in c", "body": "<p>I want to write Base transformations.\nAnd i ask to user first base and last base with if - else.\nFunction herhangibirinedonusum works in main method.\nBut this function doesn't work in if else statement, can you help me?</p>\n\n<p>i edited my codes. problem is function doesn't work in if-else statement. \nthanks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\nint herhangibirinedonusum(long int girilen_sayi, int ilk_taban, int son_taban) \n{\n    char taban_rakamlari[16] ={'0', '1', '2', '3', '4', '5', '6', '7',\n                               '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'};\n\n    int son_donusum[64];\n\n    long int donusturulen;\n    donusturulen = 0;\n\n    int index;\n    index = 0;\n\n    int i;\n\n    while (girilen_sayi != 0) {\n        donusturulen += (girilen_sayi % 10) * (int) pow(ilk_taban, i);\n        girilen_sayi /= 10;\n        i++;\n    }\n\n    while (donusturulen != 0) {\n        son_donusum[index] = donusturulen % son_taban;\n        donusturulen = donusturulen / son_taban;\n        ++index;\n    }\n\n    --index; \n    printf(\"\\n\\nDonusturulmus sayi = \");\n    for (; index &gt;= 0; index--){\n        printf(\"%c\", taban_rakamlari[son_donusum[index]]);\n    }\n    printf(\"\\n\");\n}\n\nint main() \n{\n    int a, b, c, d, e;\n    long int sayi;\n    herhangibirinedonusum(110010, 2, 10);\n\n    printf(\"\\nGirilecek say\u0131 taban\u0131n\u0131 se\u00e7iniz:\");\n    printf(\"\\n1: 2'lik taban\");\n    scanf(\"%i\", &amp;a);\n\n    if (a == 1) {\n        printf(\"\\nL\u00fctfen d\u00f6n\u00fc\u015ft\u00fcr\u00fclecek taban\u0131 se\u00e7iniz:\");\n        printf(\"\\n1: 8'lik tabana \u00e7evir\");\n        scanf(\"%i\", &amp;b);\n\n        printf(\"L\u00fctfen say\u0131y\u0131 giriniz:\");\n        scanf(\"%ld\", &amp;sayi);\n\n        if (b == 1) {\n            herhangibirinedonusum(sayi, 2, 8);\n        }\n        else\n        {\n            printf(\"\\nwrong choose\");\n        }\n    }\n\n}\n</code></pre>\n\n<p>Solution: arrays and all variables must be free at the beginning.</p>\n\n<pre><code>int herhangibirinedonusum(long int girilen_sayi, int ilk_taban, int son_taban) {\n    char taban_rakamlari[16] ={'0', '1', '2', '3', '4', '5', '6', '7',\n        '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'};\n\n    int son_donusum[64];\n    int z;\n    for (z = 0; z &lt; 64; z++) {\n        son_donusum[z] = 0;\n    }\n\n    long int donusturulen = 0;\n    int index = 0;\n    int i = 0;\n\n    //sayi ilk olarak onluk tabana cevrilir.\n    while (girilen_sayi != 0) {\n        donusturulen += (girilen_sayi % 10) * (int) pow(ilk_taban, i);\n        girilen_sayi /= 10;\n        i++;\n    }\n\n    /* onluk tabandan istenilen tabana donusum yapilan kisim */\n    while (donusturulen != 0) {\n        son_donusum[index] = donusturulen % son_taban;\n        donusturulen = donusturulen / son_taban;\n        ++index;\n    }\n\n    // onluk tabandan herhangi bir tabana gecis yaparken kalanlardan once bolum\n    // sonrasinda da kalanlar sagdan sola dogru yazilir.\n    // Bu kisimda da ayni islemi yapiyoruz. Diziye tersten baslayarak\n    // yazdiriyoruz.\n    --index; /* diziyi tersten yazdirmak icin index sayisini azaltarak */\n    printf(\"\\n\\nDonusturulmus sayi = \");\n    for (; index &gt;= 0; index--) /* diziyi tersten okuyarak yazdirilan kisim */ {\n        printf(\"%c\", taban_rakamlari[son_donusum[index]]);\n    }\n    printf(\"\\n\");\n\n    return 1;\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 59721, "user_id": 72631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/42a1d7b456fc3d77050f124927ad70ab?s=128&d=identicon&r=PG", "display_name": "rlbond", "link": "https://stackoverflow.com/users/72631/rlbond"}, "edited": false, "score": 1, "creation_date": 1484774163, "post_id": 41729517, "comment_id": 70653612, "body": "Does it have to be a 2D array? If you make the objects <code>struct</code>s, you can easily use <code>qsort</code> to do what you want."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 59721, "user_id": 72631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/42a1d7b456fc3d77050f124927ad70ab?s=128&d=identicon&r=PG", "display_name": "rlbond", "link": "https://stackoverflow.com/users/72631/rlbond"}, "edited": false, "score": 0, "creation_date": 1484774247, "post_id": 41729517, "comment_id": 70653655, "body": "@ribond I&#39;d like to avoid making a struct if I can. I&#39;m trying to keep it simple as it is only the tip of the iceberg of my project. But I will bear that in mind, thanks man"}, {"owner": {"reputation": 1215, "user_id": 6686454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56a060e2f62b3ebdca28de71f2c6ad78?s=128&d=identicon&r=PG&f=1", "display_name": "t.m.", "link": "https://stackoverflow.com/users/6686454/t-m"}, "edited": false, "score": 2, "creation_date": 1484774470, "post_id": 41729517, "comment_id": 70653756, "body": "r=0 should be before for loop not inside it. Use a debugger."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 1215, "user_id": 6686454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56a060e2f62b3ebdca28de71f2c6ad78?s=128&d=identicon&r=PG&f=1", "display_name": "t.m.", "link": "https://stackoverflow.com/users/6686454/t-m"}, "edited": false, "score": 0, "creation_date": 1484774551, "post_id": 41729517, "comment_id": 70653795, "body": "@t.m. omg thank you"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 59721, "user_id": 72631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/42a1d7b456fc3d77050f124927ad70ab?s=128&d=identicon&r=PG", "display_name": "rlbond", "link": "https://stackoverflow.com/users/72631/rlbond"}, "edited": false, "score": 3, "creation_date": 1484774756, "post_id": 41729517, "comment_id": 70653891, "body": "@rlbond: You can use <code>qsort</code> on the array too. <code>qsort()</code> doesn&#39;t care much about the stuff it works on."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1484775014, "post_id": 41729517, "comment_id": 70654018, "body": "<code>i &lt; 63</code>, <code>i &lt; 62</code> --&gt; <code>i &lt; 64</code> (Excluding sorting part)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484775210, "post_id": 41729517, "comment_id": 70654120, "body": "Normally, people working in C regard an array <code>int colors[64][2]</code> as having 64 rows and 2 columns, whereas your question description at the moment seems to be thinking the other way around."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484775339, "post_id": 41729517, "comment_id": 70654195, "body": "<code>for (i = 0; i &lt; 63; ++i){             r=0;</code> --&gt; <code>r=0; for (i = 0; i &lt; 63; ++i){</code> <a href=\"http://ideone.com/tJ4Wyl\" rel=\"nofollow noreferrer\">DEMO</a>"}], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "is_accepted": false, "score": 0, "last_activity_date": 1484781291, "creation_date": 1484781291, "answer_id": 41731153, "question_id": 41729517, "link": "https://stackoverflow.com/questions/41729517/c-sorting-two-dimensional-array-of-integers/41731153#41731153", "title": "C - sorting two dimensional array of Integers", "body": "<p>Using your example code, the task could be accomplished like so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n   int colors[64][2];\n   int r; int a; int b; int i;\n   for (i = 0; i &lt; 64; ++i){\n      r = rand() % 40;\n      colors[i][0] = i;\n      colors[i][1] = r;\n   }\n   for (i = 0; i &lt; 64; ++i){\n      printf(\"%d : \", colors[i][0]);\n      printf(\"%d\\n\", colors[i][1]);\n   }\n   printf(\"--------------------------------------------------------------\\n\");\n\n   //sort colors now\n   for (i = 0; i &lt; 64; ++i) {\n      for (int j = i + 1; j &lt; 64; ++j) {\n         if (colors[j][1] &lt; colors[i][1]) {\n            a = colors[i][0];\n            b = colors[i][1];\n            colors[i][0] = colors[j][0];\n            colors[i][1] = colors[j][1];\n            colors[j][0] = a;\n            colors[j][1] = b;\n         }\n      }\n   }\n\n   for (i = 0; i &lt; 64; ++i){\n      printf(\"%d : \", colors[i][0]);\n      printf(\"%d\\n\", colors[i][1]);\n   }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 865, "user_id": 40495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6542b6531e55a40f5bf5311c7a97ca65?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/40495/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1484781293, "creation_date": 1484781293, "answer_id": 41731154, "question_id": 41729517, "link": "https://stackoverflow.com/questions/41729517/c-sorting-two-dimensional-array-of-integers/41731154#41731154", "title": "C - sorting two dimensional array of Integers", "body": "<p><strong>Program</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;                                                                                                                                                                                                                                                          \n#include &lt;stdio.h&gt;                                                                                                                                                                                                                                                           \n\n#define ARRAY_SIZE(_a_) (sizeof(_a_) / sizeof(_a_[0]))                                                                                                                                                                                                                       \n\nstruct ColorPrevalence                                                                                                                                                                                                                                                       \n{                                                                                                                                                                                                                                                                            \n    unsigned int color_id;                                                                                                                                                                                                                                                   \n    unsigned int count;                                                                                                                                                                                                                                                      \n} sample_data[] =                                                                                                                                                                                                                                                            \n{                                                                                                                                                                                                                                                                            \n    {10, 3},                                                                                                                                                                                                                                                                 \n    {4, 17},                                                                                                                                                                                                                                                                 \n    {19, 6},                                                                                                                                                                                                                                                                 \n    {7, 3},                                                                                                                                                                                                                                                                  \n    {3, 0},                                                                                                                                                                                                                                                                  \n    {2, 1},                                                                                                                                                                                                                                                                  \n};                                                                                                                                                                                                                                                                           \n\nvoid print_data(void)                                                                                                                                                                                                                                                        \n{                                                                                                                                                                                                                                                                            \n    for (size_t i = 0; i &lt; ARRAY_SIZE(sample_data); i++)                                                                                                                                                                                                                     \n    {                                                                                                                                                                                                                                                                        \n        printf(                                                                                                                                                                                                                                                              \n            \"{color: %u, count: %u}\\n\",                                                                                                                                                                                                                                      \n            sample_data[i].color_id,                                                                                                                                                                                                                                         \n            sample_data[i].count);                                                                                                                                                                                                                                           \n    }                                                                                                                                                                                                                                                                        \n}                                                                                                                                                                                                                                                                            \n\nint compare_ColorPrevalence(const void *v1, const void *v2)                                                                                                                                                                                                                  \n{                                                                                                                                                                                                                                                                            \n    const struct ColorPrevalence *c1 = v1;                                                                                                                                                                                                                                   \n    const struct ColorPrevalence *c2 = v2;                                                                                                                                                                                                                                   \n    return c1-&gt;count - c2-&gt;count;                                                                                                                                                                                                                                            \n}                                                                                                                                                                                                                                                                            \n\nint main(int argc, char **argv)                                                                                                                                                                                                                                              \n{                                                                                                                                                                                                                                                                            \n    puts(\"Before Sorting:\");                                                                                                                                                                                                                                                 \n    print_data();                                                                                                                                                                                                                                                            \n    qsort(                                                                                                                                                                                                                                                                   \n        sample_data,                                                                                                                                                                                                                                                         \n        ARRAY_SIZE(sample_data),                                                                                                                                                                                                                                             \n        sizeof(struct ColorPrevalence),                                                                                                                                                                                                                                      \n        compare_ColorPrevalence);                                                                                                                                                                                                                                            \n    puts(\"After Sorting:\");                                                                                                                                                                                                                                                  \n    print_data();                                                                                                                                                                                                                                                            \n}                        \n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>$ ./qsort \nBefore Sorting:\n{color: 10, count: 3}\n{color: 4, count: 17}\n{color: 19, count: 6}\n{color: 7, count: 3}\n{color: 3, count: 0}\n{color: 2, count: 1}\nAfter Sorting:\n{color: 3, count: 0}\n{color: 2, count: 1}\n{color: 10, count: 3}\n{color: 7, count: 3}\n{color: 19, count: 6}\n{color: 4, count: 17}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 0, "last_activity_date": 1484825653, "creation_date": 1484825653, "answer_id": 41740787, "question_id": 41729517, "link": "https://stackoverflow.com/questions/41729517/c-sorting-two-dimensional-array-of-integers/41740787#41740787", "title": "C - sorting two dimensional array of Integers", "body": "<p>You can try something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define ROWS 64\n#define COLS 2\n\nenum {ID, COUNT};\n\nint cmp_func(const void *a, const void *b) {\n    const int *num1 = (const int *)a;\n    const int *num2 = (const int *)b;\n\n    if (num1[COUNT] &gt; num2[COUNT]) {\n        return +1;\n    } else if (num1[COUNT] &lt; num2[COUNT]) {\n        return -1;\n    }\n\n    return 0;\n}\n\nvoid print_array(int colors[][COLS], size_t nrows) {\n    size_t row;\n\n    for (row = 0; row &lt; nrows; row++) {\n        printf(\"%d %d\\n\", colors[row][ID], colors[row][COUNT]);\n    }\n}\n\nvoid add_numbers(int colors[][COLS], size_t nrows) {\n    size_t row;\n\n    for (row = 0; row &lt; nrows; row++) {\n        colors[row][ID] = row;\n        colors[row][COUNT] = rand()%40;\n    }\n}\n\nint main(void) {\n    int colors[ROWS][COLS];\n\n    add_numbers(colors, ROWS);\n\n    printf(\"\\nBefore:\\n\");\n    print_array(colors, ROWS);\n\n    qsort(colors, ROWS, sizeof(*colors), cmp_func);\n\n    printf(\"\\nAfter:\\n\");\n    print_array(colors, ROWS);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1484825653, "creation_date": 1484773979, "question_id": 41729517, "link": "https://stackoverflow.com/questions/41729517/c-sorting-two-dimensional-array-of-integers", "title": "C - sorting two dimensional array of Integers", "body": "<p>I have a two dimensional array where the first row is an id, and the second is a number of occurrences. I want to sort the array by the number of occurrences (with the id being moved with the number)\nI have the following code (minimal viable example sort of):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n    int colors[64][2];\n    int r;int a;int b;int i;\n    for (i = 0; i &lt; 63; ++i){\n        r=rand()%40;\n        colors[i][0]=i;\n        colors[i][1]=r;\n    }\n    for (i = 0; i &lt; 62; ++i){\n        printf(\"%d : \", colors[i][0]);\n        printf(\"%d\\n\", colors[i][1]);\n    }\n    printf(\"--------------------------------------------------------------\\n\");\n    //sort colors now\n    r=1;\n    while(r==1){\n        for (i = 0; i &lt; 63; ++i){\n            r=0;\n            if (colors[i][1] &lt; colors[i+1][1]){\n                a = colors[i][0];\n                b = colors[i][1];\n                colors[i][0] = colors[i+1][0];\n                colors[i][1] = colors[i+1][1];\n                colors[i+1][0] = a;\n                colors[i+1][1] = b;\n                r=1;\n            }\n        }\n    }\n    for (i = 0; i &lt; 62; ++i){\n        printf(\"%d : \", colors[i][0]);\n        printf(\"%d\\n\", colors[i][1]);\n    }\n}\n</code></pre>\n\n<p>However, the output isn't sorted in anyway except that the the id=1 value has been moved between 9 and 10.\nCurrent output:</p>\n\n<pre><code>0 : 23\n2 : 17\n3 : 35\n4 : 33\n5 : 15\n6 : 26\n7 : 12\n8 : 9\n9 : 21\n1 : 6\n11 : 27\n12 : 10\n13 : 19\n14 : 3\n15 : 6\n16 : 20\n17 : 26\n18 : 12\n19 : 16\n20 : 11\n21 : 8\n22 : 7\n23 : 29\n24 : 22\n25 : 10\n26 : 22\n27 : 3\n28 : 27\n29 : 15\n30 : 9\n10 : 2\n32 : 22\n33 : 18\n34 : 29\n35 : 7\n36 : 33\n37 : 16\n38 : 11\n31 : 2\n40 : 29\n41 : 13\n42 : 21\n43 : 39\n44 : 24\n45 : 17\n46 : 38\n47 : 4\n48 : 35\n49 : 10\n50 : 13\n51 : 6\n52 : 11\n53 : 20\n54 : 36\n55 : 33\n56 : 22\n57 : 10\n58 : 36\n39 : 2\n60 : 25\n61 : 5\n62 : 4\n</code></pre>\n\n<p>All help is greatly appreciated, thanks</p>\n"}, {"tags": ["c", "linux", "synchronization", "mkfifo"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 3, "creation_date": 1484772683, "post_id": 41729176, "comment_id": 70652806, "body": "Yes, you need - for the PID2-&gt;PID3 stage. A fifo is self-synchronized, but a file is not."}], "owner": {"reputation": 83, "user_id": 6584956, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1db80733d25ebbff9b9ae311544e7cf2?s=128&d=identicon&r=PG&f=1", "display_name": "voidmat", "link": "https://stackoverflow.com/users/6584956/voidmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1484779742, "creation_date": 1484772547, "last_edit_date": 1484779742, "question_id": 41729176, "link": "https://stackoverflow.com/questions/41729176/linux-c-process-communication", "title": "Linux C process communication", "body": "<p>I got school project in which I need to write a program that forks to 3 child process and they need to communicate:</p>\n\n<pre><code>stdin --&gt; PID1 ---fifo---&gt; PID2 ---file---&gt; PID3 ---&gt; stdout\n</code></pre>\n\n<p>CH2 translates that data to hex string. I also need to implement pause for whole program. My question is: do I need to implement synchronization mechanisms such as semaphores?  </p>\n"}, {"tags": ["c", "pointers", "struct", "types", "member-variables"], "comments": [{"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1484772348, "post_id": 41729086, "comment_id": 70652594, "body": "The size of that struct is easy to calculate. It&#39;s just 1 pointer and an int. It&#39;s all done at compile time."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1484772429, "post_id": 41729086, "comment_id": 70652639, "body": "What the pointer points to has nothing to do with the struct itself. Perhaps that is confusing you."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1484772559, "post_id": 41729086, "comment_id": 70652734, "body": "The struct has a definition, thus it has a (fixed) size. <code>sizeof (struct node)</code>  is a constant, which is already available at compile time. An object of type <code>struct node</code> will have exactly the same type and size. a pointer to such an object <b>,when dereferenced,</b> will have the same size, too."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1484772566, "post_id": 41729086, "comment_id": 70652737, "body": "A pointer is typed, but you can cast it to another type. For example, you can convert it to a generic pointer: <code>struct node *nodep = &amp;mynode; void *ptr = (void*)nodep;</code>."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1484772880, "post_id": 41729086, "comment_id": 70652931, "body": "<i>&quot;But it can&#39;t possibly, since it&#39;s declared before an arbitrary amount of other variables which can make the struct of any size.&quot;</i> First, it doesn\u2019t have to all be done in one pass; the compiler could leave the size of <code>struct node</code> undecided and then go back and change it\u2026 if it needed to store that information in the field, which it probably doesn\u2019t. It can just store the type of the field and look the type up when necessary instead. This is kind of hard to explain since it\u2019s really up to the compiler what to do as long as it follows specification."}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 8, "last_activity_date": 1484773813, "last_edit_date": 1484773813, "creation_date": 1484772547, "answer_id": 41729177, "question_id": 41729086, "link": "https://stackoverflow.com/questions/41729086/when-does-a-pointer-in-c-figure-out-the-amount-of-memory-it-references/41729177#41729177", "title": "When does a pointer in C figure out the amount of memory it references?", "body": "<p>Pointer is just a single value, it holds a single address in memory.</p>\n\n<p>It is the compiler that knows the size of structures and offsets of fields in those structures. Whenever you access a field in a referenced structure, it adds an offset.</p>\n\n<p>Look at the following program:</p>\n\n<pre><code>struct X {\n    char a;\n    int  b;\n    long c;\n};\n\nvoid y() {\n    struct X x;\n    x.a = 42;\n    x.b = 43;\n    x.c = 44;\n}\n</code></pre>\n\n<p>Function <code>y</code> is translated to the following assembler code (<code>gcc -s</code>):</p>\n\n<pre><code>y:  \n.LFB0:\n    .cfi_startproc\n    pushq   %rbp\n    .cfi_def_cfa_offset 16\n    .cfi_offset 6, -16\n    movq    %rsp, %rbp\n    .cfi_def_cfa_register 6\n    movb    $42, -16(%rbp)\n    movl    $43, -12(%rbp)\n    movq    $44, -8(%rbp)\n    nop\n    popq    %rbp\n    .cfi_def_cfa 7, 8\n    ret\n    .cfi_endproc\n</code></pre>\n\n<p>You can clearly see values 42, 43, 44. Compiler calculated offsets of the fields in a structure x. They are relative to the stack pointer (rbp) because the value x is allocated on the stack. </p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1484773242, "last_edit_date": 1484773242, "creation_date": 1484772663, "answer_id": 41729207, "question_id": 41729086, "link": "https://stackoverflow.com/questions/41729086/when-does-a-pointer-in-c-figure-out-the-amount-of-memory-it-references/41729207#41729207", "title": "When does a pointer in C figure out the amount of memory it references?", "body": "<p>At the time of structure declaration, (with a member as a pointer to the same type) it is only required to have knowledge about the type, i.e, a pointer to type. Maybe at that point, the type is not complete, but a pointer to the type is known for that platform. </p>\n\n<p>In other words, this is the same reason you cannot have a member of that structure type inside a structure declaration (at that point, the structure is not <em>complete</em>) but can have a pointer to the type. </p>\n\n<p>Once you make the pointer member to point to some valid memory, then it knows the beginning address, too. Then, upon the dereference, it calculates the offset address and gets the value from <em>that</em> location, based on the previously mentioned <em>\"type\"</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1484776607, "post_id": 41729507, "comment_id": 70654839, "body": "While it&#39;s true that pointers to different types typically do have the same sizes and representations on modern desktop and server platforms, that&#39;s not guaranteed; the language allows pointers to different types to have different sizes and representations."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1484778454, "post_id": 41729507, "comment_id": 70655607, "body": "The 4 or 8 bytes for int and for pointers is an optimistic bet at best. It&#39;s neither guaranteed (take a 16bit microprocessor architecture and enjoy) nor does it correlate (eg. on Win64 with Visual Studio, int is 4 byte while pointer is 8 byte). I didn&#39;t know about the possibility of different pointer sizes, but thats just so c... these guys wrote a language standard for compilers, not for programmers."}, {"owner": {"reputation": 1, "user_id": 5165132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9471bf1011b977de22620a41abd8041?s=128&d=identicon&r=PG&f=1", "display_name": "korkutserkan", "link": "https://stackoverflow.com/users/5165132/korkutserkan"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1484778484, "post_id": 41729507, "comment_id": 70655620, "body": "@John Bode ,Do you mean that a void/integer/char/something pointer have different sizes in the same compiler or changing a single pointer&#39;s size , for example a 4 bytes integer pointer to 8 bytes pointer at runtime ?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1484778855, "post_id": 41729507, "comment_id": 70655760, "body": "@korkutserkan: 6.2.5/28: &quot;A pointer to void shall have the same representation and alignment requirements as a pointer to a character type.48) Similarly, pointers to qualified or unqualified versions of compatible types shall have the same representation and alignment requirements. All pointers to structure types shall have the same representation and alignment requirements as each other. All pointers to union types shall have the same representation and alignment requirements as each other. Pointers to other types need not have the same representation or alignment requirements.&quot;"}], "tags": [], "owner": {"reputation": 1, "user_id": 5165132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9471bf1011b977de22620a41abd8041?s=128&d=identicon&r=PG&f=1", "display_name": "korkutserkan", "link": "https://stackoverflow.com/users/5165132/korkutserkan"}, "is_accepted": false, "score": 0, "last_activity_date": 1484773932, "creation_date": 1484773932, "answer_id": 41729507, "question_id": 41729086, "link": "https://stackoverflow.com/questions/41729086/when-does-a-pointer-in-c-figure-out-the-amount-of-memory-it-references/41729507#41729507", "title": "When does a pointer in C figure out the amount of memory it references?", "body": "<p>Every pointer have same size depending on your system (4 or 8 bytes as far as I had seen). </p>\n\n<p>So when you type such a struct</p>\n\n<pre><code>struct node {\n   struct node *next; // 4 or 8 bytes \n   int data; // 4 or 8 bytes\n};                           \n</code></pre>\n\n<p>the compiler knows that it's exact size.</p>\n\n<p>But try this way instead and see on your own.</p>\n\n<pre><code>//Wrong declaration\nstruct node {\n   struct node next; // The compiler cannot decide structure's size\n   int data; // 4 or 8 bytes\n}; \n</code></pre>\n\n<p>This will give a compile error. </p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1484777259, "last_edit_date": 1484777259, "creation_date": 1484776187, "answer_id": 41730084, "question_id": 41729086, "link": "https://stackoverflow.com/questions/41729086/when-does-a-pointer-in-c-figure-out-the-amount-of-memory-it-references/41730084#41730084", "title": "When does a pointer in C figure out the amount of memory it references?", "body": "<p><strong>Edit</strong></p>\n\n<p>Derp.  Now I understand the question you're actually asking.</p>\n\n<p>There are two parts to this.  First, the compiler allows you to create pointers to \"incomplete\" types, where the size isn't yet known.  Secondly, all pointers to <code>struct</code> types have the same size and representation, regardless of the size of the actual <code>struct</code> type.</p>\n\n<p>Going by your example:</p>\n\n<pre><code>struct node {\n    struct node *next;\n    int data;\n};\n</code></pre>\n\n<p>When the compiler sees the declaration for <code>next</code>, the type <code>struct node</code> is <em>incomplete</em> - the compiler doesn't yet know how big <code>struct node</code> will be.  However, at this point in the process, it doesn't <em>need</em> to know that size in order for you to declare a pointer to that type.  You're not yet at a point where the compiler needs to know <code>sizeof *next</code>.  </p>\n\n<p>The type definition is complete when the compiler sees the closing <code>};</code> of the <code>struct</code> definition - at that point, the compiler knows how big the <code>struct node</code> type actually is.  </p>\n\n<p><strong>Original</strong></p>\n\n<p>The compiler knows the size of the pointed-to type, so given a pointer <code>p</code>, the expression <code>p + 1</code> will yield the address of the next object of the pointed-to type.</p>\n\n<p>Given</p>\n\n<pre><code>int    *ip = 0x1000; // 4 bytes\nchar   *cp = 0x1000; // 1 byte\ndouble *dp = 0x1000; // 8 bytes\n</code></pre>\n\n<p>the expression <code>ip + 1</code> will yield the address of the next 4-byte <code>int</code> object, or <code>0x1004</code>, <code>cp + 1</code> will yield the address of the next 1-byte <code>char</code> object, or <code>0x1001</code>, and <code>dp + 1</code> will yield the address of the next 8-byte <code>double</code> object, or <code>0x1008</code>.</p>\n\n<p>The pointer itself points to a single object, period.  It has no way of knowing whether the object it's pointing to is part of a sequence, or how large any such sequence would be.  </p>\n"}], "owner": {"reputation": 229, "user_id": 7188330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b1faff19f7efae6ee99dae9344c322f?s=128&d=identicon&r=PG&f=1", "display_name": "nek28", "link": "https://stackoverflow.com/users/7188330/nek28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 41730084, "answer_count": 4, "score": 3, "last_activity_date": 1484777259, "creation_date": 1484772207, "last_edit_date": 1484773267, "question_id": 41729086, "link": "https://stackoverflow.com/questions/41729086/when-does-a-pointer-in-c-figure-out-the-amount-of-memory-it-references", "title": "When does a pointer in C figure out the amount of memory it references?", "body": "<p>I've been learning about linked lists and the recursive definition of the node struct has been bugging me</p>\n\n<pre><code>struct node {\n    struct node *next;\n    int data;\n};\n</code></pre>\n\n<p>I guess I've always imagined that since a pointer is typed, it knows both the beginning address and the amount of memory it can access when it's dereferenced, at the time of declaration. But it can't possibly, since it's declared before an arbitrary amount of other variables which can make the struct of any size. Does it figure it out only when dereferenced, or is there some sort of memory table that gets filled at the end of the struct definition and before the pointer could be used?</p>\n"}, {"tags": ["c", "nm"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1484772190, "post_id": 41729039, "comment_id": 70652500, "body": "It could be optimised out, since it is never used."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1484772990, "post_id": 41729039, "comment_id": 70652984, "body": "<a href=\"http://catb.org/jargon/html/M/mu.html\" rel=\"nofollow noreferrer\">catb.org/jargon/html/M/mu.html</a>"}, {"owner": {"reputation": 61, "user_id": 6658514, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fbfe49cca57bc475a1ac4811c76dcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Iulian Barbu", "link": "https://stackoverflow.com/users/6658514/iulian-barbu"}, "edited": false, "score": 0, "creation_date": 1484774580, "post_id": 41729039, "comment_id": 70653816, "body": "@Arkadiy, what&#39;s the connection of your answer with my question? it&#39;s an interesting post, however."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1484774636, "post_id": 41729039, "comment_id": 70653839, "body": "\u201cYour question cannot be answered because it depends on incorrect assumptions\u201d. Also, reading Hacker&#39;s Dictionary is good for your soul."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6658514, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fbfe49cca57bc475a1ac4811c76dcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Iulian Barbu", "link": "https://stackoverflow.com/users/6658514/iulian-barbu"}, "edited": false, "score": 0, "creation_date": 1484774405, "post_id": 41729092, "comment_id": 70653715, "body": "So if I use it like this, printf(&quot;%s&quot;, a), still doesn&#39;t appear nothing. I have to ask you, how could I get in nms output a line which describes where &quot;a&quot; is stored?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 61, "user_id": 6658514, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fbfe49cca57bc475a1ac4811c76dcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Iulian Barbu", "link": "https://stackoverflow.com/users/6658514/iulian-barbu"}, "edited": false, "score": 0, "creation_date": 1484774601, "post_id": 41729092, "comment_id": 70653827, "body": "You could move <code>char * a =&quot;askaskasd&quot;;</code> outside of <code>main</code>, forcing the name to be made public."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1484772238, "creation_date": 1484772238, "answer_id": 41729092, "question_id": 41729039, "link": "https://stackoverflow.com/questions/41729039/finding-the-address-of-a-main-function-local-variable/41729092#41729092", "title": "Finding the address of a main function local variable", "body": "<p>It's not there. Since the code can't tell at execution time whether it's there or not, the linker removed it to save space.</p>\n"}], "owner": {"reputation": 61, "user_id": 6658514, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fbfe49cca57bc475a1ac4811c76dcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Iulian Barbu", "link": "https://stackoverflow.com/users/6658514/iulian-barbu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 41729092, "answer_count": 1, "score": 1, "last_activity_date": 1484772238, "creation_date": 1484772018, "question_id": 41729039, "link": "https://stackoverflow.com/questions/41729039/finding-the-address-of-a-main-function-local-variable", "title": "Finding the address of a main function local variable", "body": "<p>Let's say we have the following C code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n  char *a = \"askakasd\";\n  return 0;\n}\n</code></pre>\n\n<p>I tried to find my local variable \"a\", but I don't know how to recognize it looking in this output, where p is the C code compiled:</p>\n\n<p><a href=\"https://i.stack.imgur.com/W6JQx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W6JQx.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484780569, "post_id": 41728922, "comment_id": 70656366, "body": "The code for this question about <a href=\"https://stackoverflow.com/questions/41664603/\">Swap two most frequent characters in a string</a> \u2014 a question which actually has a totally different title, but the objective is closely related to this (it goes further, swapping all occurrences of the most common with the second most common letter, and all occurrences of the second most common with the most common letter, but that&#39;s trivia).  The code to find the maximum and second maximum is very similar to <a href=\"https://stackoverflow.com/users/2491551/xzenon\">Xzenon</a>&#39;s."}], "answers": [{"comments": [{"owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1484773035, "post_id": 41729076, "comment_id": 70653008, "body": "I don&#39;t think you read the question correctly, he wants the characters, not the number of occurrences."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5697768"}, "reply_to_user": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1484773145, "post_id": 41729076, "comment_id": 70653065, "body": "he can use max 1 or max2 to get those character easily.. i just told how to get those max values"}, {"owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1484773729, "post_id": 41729076, "comment_id": 70653393, "body": "First of all, you added those AFTER I posted my comment. Second, your solution has flaws. Example: freq[&#39;a&#39;]=5,freq[&#39;b&#39;]=2;freq[&#39;c&#39;]=6 will give you a max = 6 and max2 = 2 (not 5)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5697768"}, "reply_to_user": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1484774127, "post_id": 41729076, "comment_id": 70653588, "body": "Well it&#39;s not mentioned in the question just replace smaller with smaller than equal to"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5697768"}, "reply_to_user": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1484774213, "post_id": 41729076, "comment_id": 70653635, "body": "I have edited for understanding of people who read the main idea is logic of finding those two max"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5697768"}, "is_accepted": false, "score": 0, "last_activity_date": 1484774260, "last_edit_date": 1484774260, "creation_date": 1484772147, "answer_id": 41729076, "question_id": 41728922, "link": "https://stackoverflow.com/questions/41728922/how-do-i-print-the-next-common-element-in-a-string/41729076#41729076", "title": "How do I print the next common element in a string?", "body": "<p>use code like below one:-</p>\n\n<pre><code>int max = INT_MIN , max2 = INT_MIN,maxi,max2i; //using &lt;limits.h&gt;   \nfor(i = 0; i &lt; MAX_FREQ; i++)\n{\n\n    if(max&lt;=freq[i])\n    {\n        max = freq[i];\n        maxi =i;\n    }\n\n    if(freq[i]&lt;=max &amp;&amp; freq[i]=&gt;Max &amp;&amp; max1i! =i)\n    {max2 = freq[i];\n      max2i = i;\n     }\n}\n</code></pre>\n\n<p>now you can easily use max1i and max2i index to print those characters</p>\n"}, {"tags": [], "owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "is_accepted": false, "score": 2, "last_activity_date": 1484772846, "creation_date": 1484772846, "answer_id": 41729248, "question_id": 41728922, "link": "https://stackoverflow.com/questions/41728922/how-do-i-print-the-next-common-element-in-a-string/41729248#41729248", "title": "How do I print the next common element in a string?", "body": "<p>I think the comments in the code will be enough for you to understand.</p>\n\n<pre><code>// max - most common, snd - second most common\nint max_freq = 0, snd_freq = 0;\nchar max_char, snd_char;\n\n// iterate through frequency array\nfor (int i = 0; i &lt; MAX_FREQ; i++)\n{\n    if (freq[i] &gt; max_freq)\n    {\n        /*\n         * we had a previous max_freq that satisfied max_freq &gt; snd_freq\n         * since we found a new freq &gt; max_freq, we'll change snd_freq as well\n         * to max_freq\n         * order: freq[i] &gt; max_freq &gt; snd_freq\n        */\n\n        snd_freq = max_freq;\n        max_freq = i; //it'll be converted, don't worry\n\n        snd_char = max_char;\n        max_char = str[i];\n    }\n    else if (freq[i] &gt; snd_freq)\n    {\n        snd_freq = freq[i];\n        snd_char = i;\n    }\n}\n\n// print most and second most common characters\nprintf(\"%c %c\", max_char, snd_char);\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 7350448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/649078feaf1e14298ad543d388f0a4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Ma250", "link": "https://stackoverflow.com/users/7350448/ma250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1484774260, "creation_date": 1484771568, "question_id": 41728922, "link": "https://stackoverflow.com/questions/41728922/how-do-i-print-the-next-common-element-in-a-string", "title": "How do I print the next common element in a string?", "body": "<p>I wrote a program that finds a common letter in a string, I intend to print that letter, and the letter that is the second most common, how do I achieve that?</p>\n\n<p>Here's my code: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\n #define MAX 10\n #define MAX_FREQ 256\nint main()\n{\n    char string[MAX] = {0};\n\n    int i = 0; \n    int freq[MAX_FREQ] = {0};\n\n    printf(\"Enter a String: \");\n    fgets(string, MAX, stdin);\n    if(string[strlen(string)-1] == '\\n') {string[strlen(string)-1] = 0;}\n\n    for(i = 0; string[i]; i++)\n    {\n        freq[string[i]]++;\n    }\n\n    for(i = 0; i &lt; MAX_FREQ; i++)\n    {\n        if(freq[i])\n        {\n            printf(\"Most common: %c, 2nd most common: %c\\n\", i, i-1);\n        }\n    }\n    return (0);\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "c", "floating-point", "overflow", "rounding-error"], "comments": [{"owner": {"reputation": 127019, "user_id": 59303, "user_type": "moderator", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/gIt1g.png?s=128&g=1", "display_name": "ChrisF", "link": "https://stackoverflow.com/users/59303/chrisf"}, "edited": false, "score": 1, "creation_date": 1484773832, "post_id": 41728910, "comment_id": 70653438, "body": "All comments removed as they were getting noisy and veering into antagonistic territory. If there is anything that still needs clarifying repost your comment but <b>be civil</b>"}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 1, "creation_date": 1484773869, "post_id": 41728910, "comment_id": 70653456, "body": "Hopefully this will be reopened soon, but what you want is called a &quot;superaccumulator&quot;. Some relevant code and references are here: <a href=\"https://github.com/aseldawy/sumn\" rel=\"nofollow noreferrer\">github.com/aseldawy/sumn</a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 4, "creation_date": 1484773883, "post_id": 41728910, "comment_id": 70653463, "body": "If there is additional information that can be added to this question to make it clear that it is not a duplicate, please edit it into the question."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484773955, "post_id": 41728910, "comment_id": 70653505, "body": "This question does not require any additional information. I could provide additional information as soon as it is agreed that it is not required but just helpful."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1484774025, "post_id": 41728910, "comment_id": 70653536, "body": "@EOF The accepted solution for this is to use Kahan&#39;s Summation. That&#39;s spelled out in one of the answers to: <a href=\"http://stackoverflow.com/q/6699066/2642059\">stackoverflow.com/q/6699066/2642059</a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 4, "creation_date": 1484774170, "post_id": 41728910, "comment_id": 70653620, "body": "@szpanczyk any clarifying comments you made earlier are now lost, which is why I ask you to edit the question. And a question can be considered duplicate if the answers to that question answer yours as well."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774268, "post_id": 41728910, "comment_id": 70653663, "body": "And I can clarify the question, sure, but all my clarifying was actually informing that what should have been assumed as default was indeed what I meant.  For example, if I did not provide information on limited range of values in the question, there is no reason to assume this information is missing. It&#39;s obvious, that there is no limited range and all values are possible."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484774292, "post_id": 41728910, "comment_id": 70653668, "body": "@JonathanMee Kahan summation, while more accurate, still isn&#39;t exact. e.g. try adding <code>1e40</code>, <code>1e20</code> and <code>1.0</code>"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774304, "post_id": 41728910, "comment_id": 70653676, "body": "As for inifinites and nans, those are specific values which as such do not pose problem for any solution, because they can be checked for in constant time per variable."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 2, "creation_date": 1484774392, "post_id": 41728910, "comment_id": 70653712, "body": "@SimonByrne I&#39;m just saying that it&#39;s the accepted solution for this problem. If we needed an exact solution we wouldn&#39;t be using floating point numbers in the first place."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774435, "post_id": 41728910, "comment_id": 70653733, "body": "I may have made a mistake somewhere in the question, forgotten about something or made something unclear, but nobody as of yet has pointed me to such mistake that I would accept as mistake. If I was politely asked to clarify anything that doesn&#39;t necessarily  require clarifying, I would have just done it without hesitation. But I wasn&#39;t, I was told that my question is missing some information and generally is a bad question. Which it is not."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484774553, "post_id": 41728910, "comment_id": 70653798, "body": "@JonathanMee there are perfectly valid reasons for wanting exact sums of floating point numbers. e.g. computational geometry"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774582, "post_id": 41728910, "comment_id": 70653818, "body": "I have already said both: I assume the values are exact because such are the constraints of my problem. Why? There may be various reasons, one of which is to provide reliable comparison that does not depend on ordering of values.   This is a good reason for this question, but I don&#39;t think that every question must have it&#39;s reason stated explicitly. If a question is good and could have been asked for various reasons, why would You need particular one stated?  I think I have had enough. It just can&#39;t be reasoned in some circumstances and my time is probably better spent elsewhere."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774786, "post_id": 41728910, "comment_id": 70653905, "body": "Assume this comparison is to be performed in many, many environments. One of which is a C++ implementation of some service. Reliable is the keyword here - I want for those two sets of data to have the exact same result of comparison everywhere. So I have to establish a standard on what should be the right answer, that is perfectly precise. It doesn&#39;t matter that precision was lost upon storing data in this format. It&#39;s irrelevant."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 0, "creation_date": 1484774797, "post_id": 41728910, "comment_id": 70653909, "body": "@SimonByrne You&#39;re saying that there is a need for an exact solution using floating point numbers o.O Floating point numbers are inherently inexact? Is there an alternative to Kahan&#39;s Summation that you&#39;re proposing, cause if so, you&#39;ve snagged my interest."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 2, "creation_date": 1484775033, "post_id": 41728910, "comment_id": 70654032, "body": "@JonathanMee Floating point numbers themselves are exact, it&#39;s the operations with them (arithmetic, conversion to/from decimal) that are inexact. As I mentioned in a comment above, there are algorithms called superaccumulators which can be used to compute exact sums."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484775338, "post_id": 41728910, "comment_id": 70654194, "body": "Let me say that I think this question is a duplicate of: <a href=\"http://stackoverflow.com/q/6699066/2642059\">stackoverflow.com/q/6699066/2642059</a> but other than that I&#39;ve read through <a href=\"http://stackoverflow.com/help/how-to-ask\">the asking guidelines</a> and the only point that I&#39;m seeing this answer failing on is the &quot;Help Others Reproduce the Problem&quot; section."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775363, "post_id": 41728910, "comment_id": 70654205, "body": "And this section is not universally relevant too."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775452, "post_id": 41728910, "comment_id": 70654255, "body": "I mean, I can provide code that shows how order of addition changes result of comparison, but do I really need to? Isn&#39;t that a little bit too obvious for those that may be interested in the problem?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484775466, "post_id": 41728910, "comment_id": 70654268, "body": "@szpanczyk In my proud opinion an example would have been beneficial to the question. (Though I wouldn&#39;t go add it at this point.)"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775557, "post_id": 41728910, "comment_id": 70654316, "body": "Yeah it could have been helpful. Now, why would it be? In my opinion not because it is needed for the merit discussion. Just because if there was an example provided, it would help the odds. Because after asking a couple of questions recently, I really think this is a matter of chance. If You happen to be well understood, Your question will be upvoted. If You&#39;re misunderstood, there&#39;s just no reasoning with downvoters."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775576, "post_id": 41728910, "comment_id": 70654326, "body": "One of my questions was downvoted for lack of my code too."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775676, "post_id": 41728910, "comment_id": 70654380, "body": "<a href=\"http://stackoverflow.com/questions/41660299/using-objects-of-two-or-more-data-types-as-key-for-c-map-oop\" title=\"using objects of two or more data types as key for c map oop\">stackoverflow.com/questions/41660299/&hellip;</a>  they told me to provide mcv example. Of what? This kind of thing is useful if there is a dissonance between understanding and observed phenomena, I thought my code would work, it doesn&#39;t. My question was not of the kind, yet two people commented I should provide minimal example of my own code. It seems some people on this website are really not helpful."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 0, "creation_date": 1484775724, "post_id": 41728910, "comment_id": 70654405, "body": "@SimonByrne So my understanding of superaccumulators was just that you&#39;d use multiple accumulators where Kahan&#39;s summation only uses one. Is that accurate?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 2, "creation_date": 1484775762, "post_id": 41728910, "comment_id": 70654421, "body": "This post may have suffered because no explicit question was ever asked.  This site has a history of dismissing &quot;questions&quot; that just describe a program that someone should write."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775856, "post_id": 41728910, "comment_id": 70654463, "body": "My next question is dedicated to you personally - please, tell me how did you become a telepath."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1484775959, "post_id": 41728910, "comment_id": 70654517, "body": "@JonathanMee Yes, that&#39;s more or less the idea (though I would say that Kahan summation uses 2 accumulators)."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1484776034, "post_id": 41728910, "comment_id": 70654556, "body": "@szpanczyk don&#39;t get upset on my account.  That&#39;s not my goal."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484776111, "post_id": 41728910, "comment_id": 70654597, "body": "@szpanczyk I glanced at your linked question you have an answer from <a href=\"http://stackoverflow.com/users/335858/dasblinkenlight\">dasblinkenlight</a> who is one of the brightest minds on here. I share your frustration with asking <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> questions though. That tag is commonly known as the shark-tank. It just has a lot of negativity. Ultimately I resolved my thoughts in the meta here: <a href=\"http://stackoverflow.com/users/335858/dasblinkenlight\">stackoverflow.com/users/335858/dasblinkenlight</a> I hope you find this encouraging."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484776218, "post_id": 41728910, "comment_id": 70654643, "body": "I don&#39;t know what&#39;s you goal. I am upset because this whole situation was very frustrating for me. This is a valid question and I am not yet convinced Kahan summation solves the problem the way I need. I feel I was treated unjustly, I am still sure there is nothing wrong with my question (maybe it could be better, but it&#39;s good already), it was asked with best intentions and after all that all that was missing in this discussion was accusing me of laziness and wanting others to provide me with a working program. What You wrote was inconsiderate and not thoughtful at all. That&#39;s why I am upset."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 0, "creation_date": 1484776244, "post_id": 41728910, "comment_id": 70654651, "body": "@SimonByrne Yeah, I hadn&#39;t considered the idea of using more accumulators, but thanks to you I started reading through a paper on accumulator distribution. It&#39;s quite an interesting topic. Thanks for the tip!"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484776331, "post_id": 41728910, "comment_id": 70654692, "body": "The answer on that question was good. I really like this website. It&#39;s just annoying when someone declares there si something wrong with your question and does not have to prove it. I know the mechanism. People with certain amount of points get to close questions. It would be nice if they did not act like despotic monarchs, but rather restrain themselves to the role of judges."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484776411, "post_id": 41728910, "comment_id": 70654737, "body": "@szpanczyk My apologies. I&#39;d encourage you to spend more time with Kahan&#39;s Summation, if you feel like that doesn&#39;t totally solve your problem I&#39;d encourage you to ask a follow up question on it. (If you place a link here I&#39;d be happy to come assist.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484780889, "post_id": 41728910, "comment_id": 70656466, "body": "&quot;which set has larger sum&quot; --&gt; This can be converted into another problem.  By negating each element of the 2nd group and simply adding the 2 groups together, all we need to do is find if the sum if + or - or 0.  The <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan summation</a> is similar, yet we do not need to know the sum, just the sign of the sum.  Now how to precisely add and maintain the sign ...."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484784890, "post_id": 41728910, "comment_id": 70657713, "body": "@chux I have been thinking about it, and I think this still is non-trivial. Does this address the issue of intermediate result overflowing?"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484784915, "post_id": 41728910, "comment_id": 70657720, "body": "@MarkRansom what resulted in the question being reopened?"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484785658, "post_id": 41728910, "comment_id": 70657925, "body": "It takes a vote, and evidently enough people thought the question was worthwhile. As far as keeping it open, I&#39;d put as much detail and supporting information into the question as you can. For example, in a comment that was deleted you had the reason why you needed the comparison to be stable. If the duplicates you&#39;ve seen don&#39;t solve your problem, mention why."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484785775, "post_id": 41728910, "comment_id": 70657945, "body": "I&#39;ll do whatever I decide to do. Thanks."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484794938, "post_id": 41728910, "comment_id": 70660252, "body": "And I have decided to create a rewrite to use the opportunity that question reopening has given to show with superfluous content how this was a proper question from the beginning. Everything I mentioned, people of good will would have been either able to correctly assume as obvious (fe. in absence of range limit for values, it&#39;s obvious all values are to be expected, including NaNs and infs whose presence is nevertheless irrelevant.)."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484795082, "post_id": 41728910, "comment_id": 70660290, "body": "Whatever clarification would&#39;ve been asked for with respect to common courtesy and with recognition of the fact that problem was already defined well enough, would&#39;ve been gladly given and probably edited into the text of question. But if somebody judges and acts rather than ask first to give someone benefit of doubt, that&#39;s a different case completely."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484828181, "post_id": 41728910, "comment_id": 70675807, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6699066/in-which-order-should-floats-be-added-to-get-the-most-precise-result\">In which order should floats be added to get the most precise result?</a>"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484836948, "post_id": 41728910, "comment_id": 70681759, "body": "@JonathanMee do you genuinely don&#39;t understand the difference between minimizing error and obtaining perfect answer in a well defined bool function?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484837451, "post_id": 41728910, "comment_id": 70682162, "body": "@szpanczyk As I mention in my answer: You will not obtain a perfect answer with a floating point number. Does that answer your question? I may have misunderstood what you&#39;re asking."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484837978, "post_id": 41728910, "comment_id": 70682590, "body": "Yes, You did misunderstand it. I tried to explain that since yesterday, this is one of the reasons why I&#39;m so frustrated and fed up. I can&#39;t help You anymore, I&#39;ve put more than a fair share of effort and now all I can say is - read the question once again perhaps."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838152, "post_id": 41728910, "comment_id": 70682740, "body": "Compare my self posted answer."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838396, "post_id": 41728910, "comment_id": 70682920, "body": "&quot;While for some the idea that it may be useful exercise seems controversial at best, consider the following scenario: comparison between those value sets could be a cornerstone of other operations performed on entire datasets independently in various environments. Synchronized, flawless operation of some systems may depend on this comparison being well defined and deterministically implemented, irregardless of addends order and particular architecture implementing IEEE754 or not.  This, or just curiosity.&quot;"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838568, "post_id": 41728910, "comment_id": 70683039, "body": "Perhaps we&#39;re in a setting where we take responsibility for results of this comparison, and we&#39;re not supposed to make any assumptions about acceptable approximation. We&#39;re given data in this form from the outside and we&#39;re doing whatever we&#39;re doing, but have to treat every value as equal exactly what it represents in IEEE754.  As was earlier stated - values are exactly what they are, it&#39;s the operations that are approximate. I don&#39;t have a problem with operations yielding 1000.0 when the correct answer would be 0.001. All I care about is the sign. It has to be perfectly correct."}], "answers": [{"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484828260, "post_id": 41741276, "comment_id": 70675858, "body": "Incidentally you can find pseudo-code for Kahan&#39;s Summation here: <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Kahan_summation_algorithm</a>"}], "tags": [], "owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "is_accepted": false, "score": 6, "last_activity_date": 1484827155, "creation_date": 1484827155, "answer_id": 41741276, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41741276#41741276", "title": "comparing two sums of floating point values in C or C++", "body": "<p>One possible approach is to compute the sum using a <em>superaccumulator</em>: this is an algorithm for computing exact sums of floating point numbers. Although these ideas have been around for a while, the term is a relatively new one.</p>\n\n<p>In some sense, you can think of it as an extension of Kahan summation, where the sequential sum is stored as an array of values, rather than just a pair. The main challenge then becomes figuring out how to allocate the precision amongst the various values.</p>\n\n<p>Some relevant papers and code:</p>\n\n<ul>\n<li><p>Y. K. Zhu and W. B. Hayes. \"Algorithm 908: Online Exact Summation of Floating-Point Streams\". <em>ACM Transactions on Mathematical Software</em> (ACM TOMS), 37(3):37:1-37:13, September 2010. doi: <a href=\"http://dx.doi.org/10.1145/1824801.1824815\">10.1145/1824801.1824815</a></p>\n\n<ul>\n<li>Unfortunately the paper and code are behind a paywall, but this appears to be <a href=\"https://github.com/aseldawy/sumn/tree/master/908\">the C++ code</a>.</li>\n</ul></li>\n<li><p>R. M. Neal, \"Fast Exact Summation using Small and Large Superaccumulators\". 2015. arXiv: <a href=\"https://arxiv.org/abs/1505.05571\">1505.05571</a></p>\n\n<ul>\n<li><a href=\"https://arxiv.org/src/1505.05571v1\">C code available</a></li>\n</ul></li>\n<li><p>M. T. Goodrich, A. Eldawy \"Parallel Algorithms for Summing Floating-Point Numbers\". 2016. arXiv: <a href=\"https://arxiv.org/abs/1605.05436\">1605.05436</a></p>\n\n<ul>\n<li><a href=\"https://github.com/aseldawy/sumn\">Java code of this and the above</a></li>\n</ul></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484836776, "post_id": 41743731, "comment_id": 70681635, "body": "You&#39;re kind of saying that because what I need to do is costly, I should do something else."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484837732, "post_id": 41743731, "comment_id": 70682387, "body": "@szpanczyk More specifically I&#39;m saying that pouring massive computation into finding the exact number but using floating point numbers to evaluate is wasted effort. It&#39;s like measuring a cut to the picometer, then making the cut with a chainsaw. Measuring to the millimeter is more than sufficient. Since you can&#39;t represent that level of precision with your tool."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484837907, "post_id": 41743731, "comment_id": 70682538, "body": "The point where you&#39;re mistaken is the order of operations. What if you&#39;re making the cut with a chainsaw, and then measuring it to the milimeter? Anyway, rationale for this question was presented in revised version, you&#39;re free to ignore that."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838096, "post_id": 41743731, "comment_id": 70682685, "body": "@szpanczyk Clearly I&#39;ve misunderstood something. I read through the question and thought that I was answering it? Perhaps you can elaborate on your order of operations statement?"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838750, "post_id": 41743731, "comment_id": 70683175, "body": "&quot;While for some the idea that it may be useful exercise seems controversial at best, consider the following scenario: comparison between those value sets could be a cornerstone of other operations performed on entire datasets independently in various environments. Synchronized, flawless operation of some systems may depend on this comparison being well defined and deterministically implemented, irregardless of addends order and particular architecture implementing IEEE754 or not. This, or just curiosity.&quot;"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838760, "post_id": 41743731, "comment_id": 70683184, "body": "Perhaps we&#39;re in a setting where we take responsibility for results of this comparison, and we&#39;re not supposed to make any assumptions about acceptable approximation. We&#39;re given data in this form from the outside and we&#39;re doing whatever we&#39;re doing, but have to treat every value as equal exactly what it represents in IEEE754. As was earlier stated - values are exactly what they are, it&#39;s the operations that are approximate. I don&#39;t have a problem with operations yielding 1000.0 when the correct answer would be 0.001. All I care about is the sign. It has to be perfectly correct."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484839646, "post_id": 41743731, "comment_id": 70683858, "body": "@szpanczyk The result of the total comparison will always be inexact, there&#39;s no escaping it while using floating point numbers. Whether you&#39;re summing both sets and comparing results or finding the difference between each pair from the sets then summing those differences, you must perform operations which will give you inexact results, this inexactness may well cause a change in the final sign as well. Summing both sets with Kahan&#39;s and comparing the results is as about as good as you can do."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484839703, "post_id": 41743731, "comment_id": 70683902, "body": "Compare to my answer. You&#39;re assuming constraints that just aren&#39;t there in the question."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484840494, "post_id": 41743731, "comment_id": 70684485, "body": "@szpanczyk Fixed point is an option. It will give you exact results. I&#39;d encourage you to attempt implementation though. You won&#39;t be able to use a <code>bitset</code> as you&#39;ve suggested. <code>vector&lt;bool&gt;</code> will work. If you can demonstrate functionality rather than just hand waving I&#39;d be thrilled to offer your answer a +1."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484842417, "post_id": 41743731, "comment_id": 70685825, "body": "I am only interested in alternatives to my concept, not in points. If my answer was the best answer to my own question, that would leave me dissatisfied."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 1, "creation_date": 1484843069, "post_id": 41743731, "comment_id": 70686280, "body": "@szpanczyk If you&#39;re saying input floating point numbers are perfectly accurate already and you must preserve perfect accuracy, the only way to do that is fixed point math, exactly as you have suggested. If you&#39;re interested you will probably find Dr. Dobb&#39;s article on fixed point helpful: <a href=\"http://www.drdobbs.com/cpp/fixed-point-arithmetic-types-for-c/184401992?pgno=1\" rel=\"nofollow noreferrer\">drdobbs.com/cpp/fixed-point-arithmetic-types-for-c/&hellip;</a>"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484843400, "post_id": 41743731, "comment_id": 70686507, "body": "I do not need perfect accuracy. I use perfect accuracy to perform comparison to zero with certainty. However since I am comparing to a very specific value, which zero is, perhaps there is room for alternative approaches."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484846391, "post_id": 41743731, "comment_id": 70688334, "body": "@szpanczyk and Jonathan, the key consideration here is that this is not about calculating a single sum, it&#39;s about the <i>difference</i> between <i>two</i> sums. It took me a while yesterday to grasp the distinction. Obviously one approach is to calculate both sums perfectly, but there might be other approaches as well."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484853057, "post_id": 41743731, "comment_id": 70691950, "body": "If the general direction to take is to calculate sum, any error is acceptable as long, as it can be proven the sign is correct."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484863294, "post_id": 41743731, "comment_id": 70697562, "body": "Respected @MarkRansom, that&#39;s an interesting perspective.  But I think a generic solution would <i>have to</i> be able to calculate a single perfect sum.  If one of the two sets contained only the number <code>0.0</code>, then the solution would need to observe the perfect sum of the other set.  No?"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1484867022, "post_id": 41743731, "comment_id": 70699158, "body": "@DrewDormann no, not true. If you could prove that the error for a positive sum would always be positive, and the error for a negative sum would always be negative, it would still work with your example. (I&#39;m not claiming such an algorithm exists, just that I don&#39;t dismiss it out of hand)."}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 0, "last_activity_date": 1484834722, "creation_date": 1484834722, "answer_id": 41743731, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41743731#41743731", "title": "comparing two sums of floating point values in C or C++", "body": "<p>The floating point number resulting from the summation of 2 floating point numbers is only an <em>approximation</em>. Given <em>i<sub>1</sub></em> and <em>i<sub>2</sub></em> to sum we can find an <em>approximation</em> of the error in floating point summation by doing this:</p>\n\n<p><em>i<sub>1</sub></em> + <em>i<sub>2</sub></em> = <em>i<sub>12</sub></em><br>\n<em>i<sub>12</sub></em> - <em>i<sub>2</sub></em> = <em>i<sub>~1</sub></em><br>\n<em>i<sub>1</sub></em> - <em>i<sub>~1</sub></em> = <em>i<sub>\u0394</sub></em></p>\n\n<p>The closest <em>approximation</em> we could come up with for the summation of <em>n</em> numbers would be the to calculate the error for the <em>n</em> - <em>1</em> addition operations, then to sum those <em>n</em> - <em>1</em> errors again taking the <em>n</em> - <em>2</em>. And you'll repeat this process <em>n</em> - <em>2</em> times or until all the errors have gone to 0.0</p>\n\n<p>There are a couple things that could be done to drive the error calculations to 0.0 faster:</p>\n\n<ol>\n<li>Use a larger floating point type, for example <code>long double</code></li>\n<li>Sort the list prior to summing so that you're adding small numbers to small numbers and large numbers to large numbers</li>\n</ol>\n\n<p>Now you can make an assessment of how important accuracy is to you. I will tell you that in the general case the computational expense of the above operation is outrageous considering the result you get will <em>still be an approximation</em>.</p>\n\n<p>The generally accepted solution is <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan's Summation</a> it's a happy marriage between speed and precision. Rather than holding the error to the end of the summation Kahan will roll it into each addition, preventing it's value from escalating outside the hghest precision floating point range. Say that we're given <code>vector&lt;long double&gt; i1</code> we could run Kahan's Summation on it as follows:</p>\n\n<pre><code>auto c = 0.0L;\nconst auto sum = accumulate(next(cbegin(i1)), cend(i1), i1.front(), [&amp;](const auto&amp; sum, const auto&amp; input) {\n    const auto y = input - c;\n    const auto t = sum + y;\n\n    c = t - sum - y;\n    return t;\n} ) - c;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1484840291, "last_edit_date": 1484840291, "creation_date": 1484838125, "answer_id": 41745019, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41745019#41745019", "title": "comparing two sums of floating point values in C or C++", "body": "<p>One of the possibilities to perform this comparison with certainty is to create a class for fixed point arithmetic of precision equal to the types in use and without limit on absolute value.</p>\n\n<p>It could be a class implementing following public methods:</p>\n\n<pre><code>    FixedPoint(double d);\n    ~FixedPoint();\n\n    FixedPoint operator+(const FixedPoint&amp; rhs);\n    FixedPoint operator-(const FixedPoint&amp; rhs);\n    bool isPositive();\n</code></pre>\n\n<p>(Every supported floating point type needs separate constructor.)</p>\n\n<p>Depending upon circumstances implementation would require a collection of <code>bool</code> of fixed, decided upon construction or dynamic size; possibly <code>std::bitset</code>, <code>vector&lt;bool&gt;</code> or static or dynamic <code>bool</code> array.</p>\n\n<p>For ease of implementation I would suggest implementing the 2's complement encoding.</p>\n\n<p><em>This is an obvious and very costly solution, that would hurt performance if this comparison was core of some system. Hopefully there is a better solution.</em></p>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484850912, "post_id": 41748978, "comment_id": 70690809, "body": "Thank You for an on point answer. <code>c</code> tag was removed by someone else, as part of the whole know-it-all-better deal that took place."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 1, "creation_date": 1484851054, "post_id": 41748978, "comment_id": 70690893, "body": "It seems this answer is much better than mine, in terms of performance. I&#39;ll wait some more to see if other answers emerge."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484988452, "post_id": 41748978, "comment_id": 70745557, "body": "Differences between <a href=\"http://stackoverflow.com/a/41748978/2410359\">this</a> and <a href=\"http://stackoverflow.com/a/41741276/2410359\">that</a> are 1) explicit precision requirements of <code>log2(FLT_MAX) - log2(FLT_TRUE_MIN) + log2(SIZE_MAX)</code> vs. a TBD <code>log2(superaccumulator)</code>  2) efficiency of having the array <code>sums[]</code> vs. one very <i>wide superaccumulator</i> and 3) reality vs. conceptual."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1484850433, "last_edit_date": 1484850433, "creation_date": 1484850021, "answer_id": 41748978, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41748978#41748978", "title": "comparing two sums of floating point values in C or C++", "body": "<p>Post was originally also a C one and so my code applies to that.<br>\nI now see post is C++ only, yet I see little in the following that would not readily apply to C++.</p>\n\n<p><strong>Simplify to finding the sign of the sum of a list of FP numbers</strong></p>\n\n<p>Comparing 2 sets of numbers is like appending the negation of the second set to the first and then finding the sign of the sum of the joint list.  This sign maps to <code>&gt;</code>, <code>==</code> or <code>&lt;</code> of the 2 original sets.</p>\n\n<p><strong>Perform only exact FP math</strong></p>\n\n<p><em>Assumption</em>: FP employs IEEE like numbers including sub-normals, base 2, and is exact for certain operations:</p>\n\n<ol>\n<li><p>Addition of <code>a +b</code> with the same binary exponent and differing sign.</p></li>\n<li><p>Subtraction of same sign 0.5 from a number in the <code>0.5 &lt;= |x| &lt; 1.0</code> range.</p></li>\n<li><p><code>ldexp*()</code> (break number into significant and exponent parts) function returns an exact value.</p></li>\n</ol>\n\n<p><strong>Form array per exponent</strong></p>\n\n<p>Form an array of sums <code>sums[]</code> whose values will only ever be <code>(0 or 0.5 &lt;= |sums[i]| &lt; 1.0)</code>, one for each possible exponent and for some exponents larger than the max.  The larger ones are needed to accumulate a <code>|total_sum|</code> that exceeds <code>FP_MAX</code>.  This needs up to <code>log2(SIZE_MAX)</code> more elements.</p>\n\n<p><strong>Add the set of numbers to <code>sums[]</code></strong></p>\n\n<p>For each element of the number set, add it to the corresponding <code>sums[]</code> per its binary exponent.    This is key as addition of same sign and differing sign FP numbers with a common FP binary exponent can be done <em>exactly</em>.  The addition may result in a carry with same sign values and cancellation with differing sign values - this is handled. The incoming set of numbers need not be sorted. </p>\n\n<p><strong>Normalize <code>sum[]</code></strong></p>\n\n<p>For each element on <code>ones[]</code>, insure any values not 0.5, 0.0 or -0.5 is reduced, the remaining portion added to smaller  <code>ones[]</code>.</p>\n\n<p><strong>Inspect <code>sum[]</code> for the most significant digit</strong></p>\n\n<p>The most significant (non-zero) <code>one[s]</code> is the sign of the result.</p>\n\n<hr>\n\n<p>The below code performs the task using <code>float</code> as the set's FP type.  Some parallel calculations are done using <code>double</code> to check for sanity, but do not contribute to the <code>float</code> calculation.</p>\n\n<p>The normalizing step in the end iterates typically twice.  Even a worst case set, I suspect would iterate the binary width of the <code>float</code> signicand, about 23 times.</p>\n\n<p>The solution appears to be about <code>O(n)</code>, but does use an array about the size of the FP's exponent range.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;float.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n#if RAND_MAX/2 &gt;= 0x7FFFFFFFFFFFFFFF\n#define LOOP_COUNT 1\n#elif RAND_MAX/2 &gt;= 0x7FFFFFFF\n#define LOOP_COUNT 2\n#elif RAND_MAX/2 &gt;= 0x1FFFFFF\n#define LOOP_COUNT 3\n#elif RAND_MAX/2 &gt;= 0xFFFF\n#define LOOP_COUNT 4\n#else\n#define LOOP_COUNT 5\n#endif\n\nuint64_t rand_uint64(void) {\n  uint64_t r = 0;\n  for (int i = LOOP_COUNT; i &gt; 0; i--) {\n    r = r * (RAND_MAX + (uint64_t) 1u) + ((unsigned) rand());\n  }\n  return r;\n}\n\ntypedef float fp1;\ntypedef double fp2;\n\nfp1 rand_fp1(void) {\n  union {\n    fp1 f;\n    uint64_t u64;\n  } u;\n  do {\n    u.u64 = rand_uint64();\n  } while (!isfinite(u.f));\n  return u.f;\n}\n\nint pre = DBL_DECIMAL_DIG - 1;\n\n\nvoid exact_add(fp1 *sums, fp1 x, int expo);\n\n// Add x to sums[expo]\n// 0.5 &lt;= |x| &lt; 1\n// both same sign.\nvoid exact_fract_add(fp1 *sums, fp1 x, int expo) {\n  assert(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0);\n  assert(fabsf(sums[expo]) &gt;= 0.5 &amp;&amp; fabsf(sums[expo]) &lt; 1.0);\n  assert((sums[expo] &gt; 0.0) == ( x &gt; 0.0));\n\n  fp1 half = x &gt; 0.0 ? 0.5 : -0.5;\n  fp1 sum = (sums[expo] - half) + (x - half);\n  if (fabsf(sum) &gt;= 0.5) {\n    assert(fabsf(sums[expo]) &lt; 1.0);\n    sums[expo] = sum;\n  } else  {\n    sums[expo] = 0.0;\n    if (sum) exact_add(sums, sum, expo);\n  }\n  exact_add(sums, half, expo+1);  // carry\n}\n\n// Add  x to sums[expo]\n// 0.5 &lt;= |x| &lt; 1\n// differing sign\nvoid exact_fract_sub(fp1 *sums, fp1 x, int expo) {\n  if(!(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0)) {\n    printf(\"%d %e\\n\", __LINE__, x);\n    exit(-1);\n  }\n  assert(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0);\n  assert((sums[expo] &gt; 0.0) != ( x &gt; 0.0));\n  fp1 dif = sums[expo] + x;\n  sums[expo] = 0.0;\n  exact_add(sums, dif, expo);\n}\n\n// Add x to sums[]\nvoid exact_add(fp1 *sums, fp1 x, int expo) {\n  if (x == 0) return;\n  assert (x &gt;= -FLT_MAX &amp;&amp; x &lt;= FLT_MAX);\n  //while (fabsf(x) &gt;= 1.0) { x /= 2.0; expo++; }\n  while (fabsf(x) &lt; 0.5) { x *= (fp1)2.0; expo--; }\n  assert(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0);\n\n  if (sums[expo] == 0.0) {\n    sums[expo] = x;\n    return;\n  }\n  if(!(fabsf(sums[expo]) &gt;= 0.5 &amp;&amp; fabsf(sums[expo]) &lt; 1.0)) {\n    printf(\"%e\\n\", sums[expo]);\n    printf(\"%d %e\\n\", expo, x);\n    exit(-1);\n  }\n  assert(fabsf(sums[expo]) &gt;= 0.5 &amp;&amp; fabsf(sums[expo]) &lt; 1.0);\n  if ((sums[expo] &gt; 0.0) == (x &gt; 0.0)) {\n    exact_fract_add(sums, x, expo);\n  } else {\n    exact_fract_sub(sums, x, expo);\n  }\n}\n\nvoid exact_add_general(fp1 *sums, fp1 x) {\n  if (x == 0) return;\n  assert (x &gt;= -FLT_MAX &amp;&amp; x &lt;= FLT_MAX);\n  int expo;\n  x = frexpf(x, &amp;expo);\n  exact_add(sums, x, expo);\n}\n\nvoid sum_of_sums(const char *s, const fp1 *sums, int expo_min, int expo_max) {\n  fp1 sum1 = 0.0;\n  fp2 sum2 = 0.0;\n  int step = expo_max &gt;= expo_min ? 1 : -1;\n  for (int expo = expo_min; expo/step &lt;= expo_max/step; expo += step) {\n    sum1 += ldexpf(sums[expo], expo);\n    sum2 += ldexp(sums[expo], expo);\n  }\n  printf(\"%-20s = %+.*e %+.*e\\n\", s, pre, sum2, pre, sum1);\n}\n\n\nint test_sum(size_t N) {\n  fp1 a[N];\n  fp1 sum1 = 0.0;\n  fp2 sum2 = 0.0;\n  for (size_t i = 0; i &lt; N; i++) {\n    a[i] = (fp1) rand_fp1();\n    sum1 += a[i];\n    sum2 += a[i];\n  }\n  printf(\"%-20s = %+.*e %+.*e\\n\", \"initial  sums\", pre, sum2, pre, sum1);\n\n  int expo_min;\n  int expo_max;\n  frexpf(FLT_TRUE_MIN, &amp;expo_min);\n  frexpf(FLT_MAX, &amp;expo_max);\n  size_t ln2_size = SIZE_MAX;\n  while (ln2_size &gt; 0) {\n    ln2_size &gt;&gt;= 1;\n    expo_max++;\n  };\n  fp1 sum_memory[expo_max - expo_min + 1];\n  memset(sum_memory, 0, sizeof sum_memory);  // set to 0.0 cheat\n  fp1 *sums = &amp;sum_memory[-expo_min];\n\n  for (size_t i = 0; i&lt;N; i++)  {\n    exact_add_general(sums, a[i]);\n  }\n  sum_of_sums(\"post add  sums\", sums, expo_min,  expo_max);\n\n  // normalize\n  int done;\n  do {\n    done = 1;\n    for (int expo = expo_max; expo &gt;= expo_min; expo--) {\n      fp1 x = sums[expo];\n      if ((x &lt; -0.5) || (x &gt; 0.5)) {\n        //printf(\"xxx %4d %+.*e \", expo, 2, x);\n        done = 0;\n        if (x &gt; 0.0) {\n          sums[expo] = 0.5;\n          exact_add(sums, x - (fp1)0.5, expo);\n        } else {\n          sums[expo] = -0.5;\n          exact_add(sums, x - -(fp1)0.5, expo);\n        }\n      }\n    }\n    sum_of_sums(\"end  sums\", sums, expo_min,  expo_max);\n  } while (!done);\n\n  for (int expo = expo_max; expo &gt;= expo_min; expo--) {\n    if (sums[expo]) {\n      return (sums[expo] &gt; 0.5) ? 1 : -1;\n    }\n  }\n  return 0;\n}\n\n#define ITERATIONS 10000\n#define MAX_NUMBERS_PER_SET 10000\nint main() {\n  unsigned seed = (unsigned) time(NULL);\n  seed = 0;\n  printf(\"seed = %u\\n\", seed);\n  srand(seed);\n\n  for (unsigned i = 0; i &lt; ITERATIONS; i++) {\n    int cmp = test_sum((size_t)rand() % MAX_NUMBERS_PER_SET + 1);\n    printf(\"Compare %d\\n\\n\", cmp);\n    if (cmp == 0) break;\n  }\n  printf(\"Success\");\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Infinities and NaN can also be handled, to a degree, leave that for later.</p>\n"}], "owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1484851174, "creation_date": 1484771536, "last_edit_date": 1495540889, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c", "title": "comparing two sums of floating point values in C or C++", "body": "<p>Assume You're given two sets of floating point variables implemented according to IEEE754, meant to be treated as exact values calculated according to formulae present in standard. All legal values are possible. The amount of variables in set may be any natural number.</p>\n\n<p>What would be a good way to compare exact, in mathematical sense, sums of values represented by said variables. Due to domain's nature, the problem can easily be represented as comparing a single sum to zero. You can disregard the possibility of presence of NaNs or Infinities, as it is irrelevant to core problem. (Those values can be checked for easily and independently, and acted upon in a manner suiting particular application of this problem.)</p>\n\n<p>A naive approach would be to simply sum and compare, or sum values of one set and subtract values of another.</p>\n\n<pre><code>    bool compare(const std::vector&lt;float&gt;&amp; lhs, const std::vector&lt;float&gt;&amp; rhs)\n    {\n        float lSum = 0.0f;\n        for (auto value : lhs)\n        {\n            lSum += value;\n        }\n        float rSum = 0.0f;\n        for (auto value : rhs)\n        {\n            rSum += value;\n        }\n\n        return lSum &lt; rSum;\n    }\n</code></pre>\n\n<p>Quite obviously there are problems with naive approach, as mentioned in various other questions regarding floating point arithmetic. Most of the problems are related to two difficulties:</p>\n\n<ul>\n<li>result of addition of floating point values differs depending on order</li>\n<li><p>certain orders of addition of certain sets of values may result in intermediate overflow (intermediate result of calculations goes beyond range supported by available data type)</p>\n\n<pre><code>float small = strtof(\"0x1.0p-126\", NULL);\nfloat big = strtof(\"0x1.8p126\", NULL);\n\nstd::cout &lt;&lt; std::hexfloat &lt;&lt; small + big - big &lt;&lt; std::endl;\nstd::cout &lt;&lt; std::hexfloat &lt;&lt; (big-2*small) + (big-small) + big - (big+small) - (big+2*small) &lt;&lt; std::endl;\n</code></pre>\n\n<p>This code will result in <code>0</code> and <code>inf</code>; this illustrates how ordering affects the result. Hopefully, also that the problem of ordering is non-trivial.</p>\n\n<pre><code>float prev;\nfloat curr = 0.0f;\n\ndo\n{\n    prev = curr;\n    curr += strtof(\"0x1.0p-126\", NULL);\n} while (prev != curr);\n\nstd::cout &lt;&lt; std::hexfloat &lt;&lt; curr &lt;&lt; std::endl;\n</code></pre></li>\n</ul>\n\n<p>This code, given sufficient time to actually finish computing, would result in <code>0x1.000000p-102</code>, not, as could be naively expected, <code>0x1.fffffep127</code> (Change of curr initialization to `strtof(\"0x1.fff000p-103\") would be advised to actually observe this.); this illustrates how proportion between intermediate results of addition and particular addends affects the result.</p>\n\n<p>A lot has been said about obtaining best precision, eg. <a href=\"https://stackoverflow.com/questions/6699066/in-which-order-should-floats-be-added-to-get-the-most-precise-result\">this question</a>.</p>\n\n<p>The problem at hand differs in that we do not want to maximize precision, but we have a well-defined function that needs to be implemented exactly.</p>\n\n<p>While for some the idea that it may be useful exercise seems controversial at best, consider the following scenario: comparison between those value sets could be a cornerstone of other operations performed on entire datasets independently in various environments. Synchronized, flawless operation of some systems may depend on this comparison being well defined and deterministically implemented, irregardless of addends order and particular architecture implementing IEEE754 or not. </p>\n\n<p>This, or just curiosity.</p>\n\n<p>In the discussion, <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan summation algorithm</a> has been mentioned as relevant. However this algorithm is a reasonable attempt at minimizing error. It neither guarantees correct sign of result, nor is independent of the order of operations (to at least guarantee consistent, if wrong, result, for permutations of sets).</p>\n\n<p>One of the most obvious solutions would be to employ/implement fixed point arithmetic using sufficient amount of bits to represent every possible operand value exactly and keep exact intermediate result.</p>\n\n<p>Perhaps however this can be done using only floating point arithmetic in a manner that guarantees correct sign of result. If so, the problem of overflow (as illustrated in one of the examples above) needs to be addressed in solution, as this question has particular technical aspect.</p>\n\n<p>(What follows is original question.)</p>\n\n<p><em>I have two sets of multiple floating point (float or double) values. I want to provide a perfect answer to the question, which set has larger sum. Because of artifacts in floating point arithmetic, in some corner cases the result of naive approach may be wrong, depending on order of operations. Not to mention simple sum can result in overflow.\nI can't provide any effort on my side, because all I have is vague ideas, all of them complicated and not convincing.</em></p>\n"}, {"tags": ["c", "string", "memory", "duplicates"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1484771563, "post_id": 41728908, "comment_id": 70652191, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "edited": false, "score": 0, "creation_date": 1484771631, "post_id": 41728908, "comment_id": 70652223, "body": "<a href=\"http://en.cppreference.com/w/c/experimental/dynamic/strdup\" rel=\"nofollow noreferrer\"><code>strdup</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484772006, "post_id": 41728970, "comment_id": 70652411, "body": "Thanks, it does clear stuff up! any idea about my other problem? because the string gets duplicated, but crashes if it gets too long."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484773714, "post_id": 41728970, "comment_id": 70653385, "body": "@Dimakossover how long?"}, {"owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484773826, "post_id": 41728970, "comment_id": 70653432, "body": "If the input string is : &quot;hi&quot;, it will copy it twice, so it becomes hi-&gt;hihi-&gt;hihihihi-&gt;hihihihihihihihi-&gt;At this point, it will crash. (after calling the duplicate function again.)"}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484774224, "post_id": 41728970, "comment_id": 70653639, "body": "Making an educated guess, I think that returning the input string in your version is not sane. You see, you&#39;re actually changing the input buffer."}, {"owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484775506, "post_id": 41728970, "comment_id": 70654287, "body": "Hello @101010 i actually forgot to pass over the new value to ptr_s in main from the code, now that I&#39;ve done it it&#39;s all good, no crashes and very smooth, thank you for you attention and help, greatly appreciated !"}], "tags": [], "owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "is_accepted": false, "score": 0, "last_activity_date": 1484774037, "last_edit_date": 1484774037, "creation_date": 1484771746, "answer_id": 41728970, "question_id": 41728908, "link": "https://stackoverflow.com/questions/41728908/duplicating-a-string-in-c-include-memory-allocating-pointers-etc/41728970#41728970", "title": "Duplicating a string in C (Include memory allocating, pointers, etc.)", "body": "<p>You can avoid all the boilerplate by just using <a href=\"http://en.cppreference.com/w/c/experimental/dynamic/strdup\" rel=\"nofollow noreferrer\"><code>strdup</code></a>:</p>\n\n<pre><code>char *s1 = \"String\";\nchar *s2 = strdup(s1);\n...\nfree(s2);\n</code></pre>\n\n<p>Your function would become:</p>\n\n<pre><code>char* duplicate(char const *str) {\n  char *ptr = strdup(str);\n  ptr = (char*) realloc(ptr, 2 * strlen(str) + 1);\n  strcat(ptr, str);\n\n  return ptr;\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/d9896c5d02809440\" rel=\"nofollow noreferrer\"><strong>Live Demo</strong></a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484772884, "post_id": 41729209, "comment_id": 70652932, "body": "Thanks, this is very informative! my question is, what does memcpy doe? (obviously it copies memory blocks) but how can i recreate without the use of this function? thanks in advance."}, {"owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484772996, "post_id": 41729209, "comment_id": 70652990, "body": "After using your code, same thing happens, i can duplicate a string a few times and after the 3rd-5th time program crashes."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484773182, "post_id": 41729209, "comment_id": 70653085, "body": "@Dimakossover Show us the entire code. Maybe you do something illegal like <code>duplicate(&quot;foo&quot;);</code> or <code>char *foo = &quot;foo&quot;; duplicate(foo);</code>. (You see why that&#39;s illegal, right?)"}, {"owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484773363, "post_id": 41729209, "comment_id": 70653194, "body": "hi @DavidSchwartz i copied the relevant code here:<a href=\"http://pastebin.com/VssF3wBe\" rel=\"nofollow noreferrer\">pastebin.com/VssF3wBe</a> , thanks in advance."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484773490, "post_id": 41729209, "comment_id": 70653277, "body": "@Dimakossover Since you have so much code that messes with <code>ptr_s</code>, the bug could be anywhere. I&#39;d look at <code>get</code> first. (Or give us enough code to reproduce the problem.)"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1484773537, "post_id": 41729209, "comment_id": 70653302, "body": "With 6 duplications you need 64 times as (2^6) as much memory. If your strings are large, the allocations might be failing. Don&#39;t forget to check the return codes to makes sure you&#39;re not getting NULLs."}, {"owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "edited": false, "score": 0, "creation_date": 1484773733, "post_id": 41729209, "comment_id": 70653396, "body": "this is my get() function : <a href=\"http://pastebin.com/AAfrdXKL\" rel=\"nofollow noreferrer\">pastebin.com/AAfrdXKL</a> , i did notice that the maximum length of my initial string input should not be larger then 250, (LEN is defined 250) , but after getting input from user once, i do not mess with get() no more."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1484772680, "creation_date": 1484772680, "answer_id": 41729209, "question_id": 41728908, "link": "https://stackoverflow.com/questions/41728908/duplicating-a-string-in-c-include-memory-allocating-pointers-etc/41729209#41729209", "title": "Duplicating a string in C (Include memory allocating, pointers, etc.)", "body": "<p>You don't need that extra allocation:</p>\n\n<pre><code>char * duplicate(char *str)\n{\n    size_t len = strlen(str);\n    char *ret = realloc(str, 2*len+1); //assuming no overflow\n    if(ret){\n        memcpy(ret+len, ret, len);\n        ret[2*len]=0;\n    }\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5284705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbebaeac34b47c956718bb211a4861?s=128&d=identicon&r=PG&f=1", "display_name": "TricksterJoe", "link": "https://stackoverflow.com/users/5284705/tricksterjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1484774037, "creation_date": 1484771519, "last_edit_date": 1484773059, "question_id": 41728908, "link": "https://stackoverflow.com/questions/41728908/duplicating-a-string-in-c-include-memory-allocating-pointers-etc", "title": "Duplicating a string in C (Include memory allocating, pointers, etc.)", "body": "<p>This is the code I have so far:</p>\n\n<pre><code>char * duplicate(char *str)\n{\n    int len = strlen(str) + 1;\n    char *ptr;\n    ptr = (char *)malloc(len);\n    strcpy(ptr, str);\n    str = (char *)realloc((void *)str, len * 2 * sizeof(char));\n    strcat(str, ptr);\n    free((void *)ptr);\n    present(str);\n    return(str);\n}\n</code></pre>\n\n<p><strong>sidenote</strong>: I know I should be checking if the memory is actually allocated, I will do so later.</p>\n\n<p>The program asks the user to input a string, proceeds to double it and prints out the new string.\n<code>present-&gt;a</code> function I made so it would print the string out.</p>\n\n<p>Now my thought process was as follows:</p>\n\n<p>1) Allocate memory to a placeholder pointer, copy <code>str</code> string onto <code>ptr</code></p>\n\n<p>2) Reallocate memory for <code>str</code>, now with double the size</p>\n\n<p>3) Using <code>strcat</code> to copy the string</p>\n\n<p>4) Freeing <code>ptr</code> memory</p>\n\n<p>Output should be as follows: </p>\n\n<pre><code>string input by users for example: \"Hi\"\n\noutput: \"HiHi\"\n</code></pre>\n\n<p>If we run the function again output should be: <code>\"HiHiHiHi\"</code></p>\n\n<p>The problem I am facing is, after running the function around 2-4 times (depends on the input string size) the program will crash, it will say it had a trigger point and something along the lines of: <code>\"wntdll.pdb not loaded\".</code></p>\n\n<p>I believe it has something to do with the memory, because if I am trying to duplicate larger strings, it will simply crash after the first time.</p>\n\n<p>Am I allocating memory properly? I am not sure what to do at this point.</p>\n\n<p>Thanks for the help :)</p>\n"}, {"tags": ["c", "linux", "networking", "go", "system-calls"], "answers": [{"comments": [{"owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "edited": false, "score": 0, "creation_date": 1484783433, "post_id": 41731291, "comment_id": 70657269, "body": "Thank you for your answer. But, it doesn&#39;t seem to work. Go is telling me <code>cannot use cStruct (type *sockaddr.C.struct_sockaddr_any) as type *C.struct_sockaddr in argument to _Cfunc_printPointer</code>. I would like to avoid unsafe.Pointer if possible. Do you have another idea to help me? Thank you very much"}, {"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "reply_to_user": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "edited": false, "score": 0, "creation_date": 1484788702, "post_id": 41731291, "comment_id": 70658682, "body": "Well, then keep the original function signature void printPointer(struct sockaddr_any*), declare struct sockadr_any in four C code as shown and then access .addr."}, {"owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "edited": false, "score": 0, "creation_date": 1484810818, "post_id": 41731291, "comment_id": 70665570, "body": "In fact this is impossible to use the addr field as sockaddr_any has incomplete type (I&#39;m not able to locate the header); but as typecast works, the problem is solved :)"}], "tags": [], "owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "is_accepted": false, "score": 1, "last_activity_date": 1484788802, "last_edit_date": 1484788802, "creation_date": 1484782149, "answer_id": 41731291, "question_id": 41728874, "link": "https://stackoverflow.com/questions/41728874/go-language-use-internal-structures-from-c/41731291#41731291", "title": "Go language use internal structures from C", "body": "<p>You can use struct sockaddr*:</p>\n\n<pre><code>void printPointer(struct sockaddr_any *pp) {\n    struct sockaddr *p = pp-&gt;addr;\n    printf(\":: %p :: \", p); \n}\n</code></pre>\n\n<p>since sockaddr_any is defined as:</p>\n\n<pre><code>struct sockaddr_any {\n   struct sockaddr addr;\n   char pad[sizeof(union sockaddr_all) - sizeof(struct sockaddr)];\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "edited": false, "score": 0, "creation_date": 1484789152, "post_id": 41731636, "comment_id": 70658778, "body": "You&#39;re welcome. That was my first idea too, but wanted to avoid a type cast."}], "tags": [], "owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1484784434, "creation_date": 1484784434, "answer_id": 41731636, "question_id": 41728874, "link": "https://stackoverflow.com/questions/41728874/go-language-use-internal-structures-from-c/41731636#41731636", "title": "Go language use internal structures from C", "body": "<p>Using Laszlo answer, there is a simple solution for my problem. It isn't because the definition of the structure <code>sockaddr_any</code> isn't accessible in my context (there's no simple way to access the <code>addr</code> field) that we can't cast the pointer. So, I can simply do: </p>\n\n<pre><code>// #include &lt;stdio.h&gt;\n// void printPointer(struct sockaddr_any *p){\n//     struct sockaddr *usable_pointer = (struct sockaddr *) p; \n// }\nimport \"C\"\n</code></pre>\n\n<p>Then, I can use <code>usable_pointer</code> as any other <code>sockaddr</code> variable. </p>\n\n<p>Thank you very much</p>\n"}], "owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484788802, "creation_date": 1484771414, "last_edit_date": 1484784512, "question_id": 41728874, "link": "https://stackoverflow.com/questions/41728874/go-language-use-internal-structures-from-c", "title": "Go language use internal structures from C", "body": "<p>I would like to be able, in Go, to translate one host address (let's use 'www.google.be') to a sockaddr structure and then use it from a C code. </p>\n\n<p>Translating the host address to a sockaddr_any structure isn't too hard using the <a href=\"http://github.com/jbenet/go-sockaddr\" rel=\"nofollow noreferrer\">http://github.com/jbenet/go-sockaddr</a> module. My code works and is the following: </p>\n\n<pre><code>ipAddr, _ := net.ResolveIPAddr(\"ip\", \"www.google.be\")\nsockAddr := sockaddrnet.IPAddrToSockaddr(ipAddr)\nrawSockaddr, socklen, _ := sockaddr.SockaddrToAny(sockAddr)\ncStruct := sockaddr.AnyToCAny(rawSockaddr)\nC.printPointer(cStruct)\n</code></pre>\n\n<p>But, I'm not able to use this <code>*sockaddr.C.struct_sockaddr_any</code> variable: <code>cStruct</code>, from my C code (it has incomplete definition, so I can't use any of its fields), which is the following: </p>\n\n<pre><code>// #include &lt;stdio.h&gt;\n// void printPointer(struct sockaddr_any *p){\n//     printf(\":: %p :: \", p); \n//     // How to use P as a sockaddr? \n// }\nimport \"C\"\n</code></pre>\n\n<p><code>sockaddr_any</code> is defined in the core of the Go language (from <a href=\"https://golang.org/src/syscall/types_linux.go\" rel=\"nofollow noreferrer\">https://golang.org/src/syscall/types_linux.go</a>). So, I believe it should be linked by default with my C code. But, it seems not to be true. Does someone know what line could I use to include headers from the go language itself (here the syscall structures). </p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["c", "microcontroller", "stm32", "stm32f0"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484770494, "post_id": 41728281, "comment_id": 70651668, "body": "Just a guess, could it be because you pass the same control structure to timer 3 and then to timer 1?"}, {"owner": {"reputation": 45, "user_id": 5351948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/370e49fe19743c1f7186c8c222c0cced?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby Digital", "link": "https://stackoverflow.com/users/5351948/bobby-digital"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484773815, "post_id": 41728281, "comment_id": 70653428, "body": "i was curious about that too.  if i comment out the tim3 stuff the error is the same"}, {"owner": {"reputation": 635, "user_id": 2010398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnCdn.png?s=128&g=1", "display_name": "gmug", "link": "https://stackoverflow.com/users/2010398/gmug"}, "edited": false, "score": 0, "creation_date": 1484815823, "post_id": 41728281, "comment_id": 70668121, "body": "Seems that you have to define a <code>TIM_Output_Compare_N_State</code> for Timer TIM1, try to add <code>TIM__OCInitStructure.TIM_OutputNState = TIM_OutputNState_Disable;</code> or <code>TIM__OCInitStructure.TIM_OutputNState = TIM_OutputNState_Enable;</code> before calling <code>TIMOC1Init</code> for <code>TIM1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5351948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/370e49fe19743c1f7186c8c222c0cced?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby Digital", "link": "https://stackoverflow.com/users/5351948/bobby-digital"}, "edited": false, "score": 0, "creation_date": 1485212633, "post_id": 41773515, "comment_id": 70822622, "body": "TIM_CtrlPWMOutputs(TIM1, ENABLE); did it, thank you!  I added that line to the end of TIM_TIMER_Init() and everything performed as expected.  Can&#39;t thank you enough!    ////////     Digging some more, TIM_OCNIdleState, TIM_OCNPolarity, and TIM_OCIdleState can be removed and there is no effect.  Not sure I understand that since they are right under the original assert_param() errors from the original post     /////////      Thanks for the SPL examples.  New to STM32 so had not heard of it.  I downloaded the STM32CubeF0 and will check it out."}, {"owner": {"reputation": 45, "user_id": 5351948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/370e49fe19743c1f7186c8c222c0cced?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby Digital", "link": "https://stackoverflow.com/users/5351948/bobby-digital"}, "edited": false, "score": 0, "creation_date": 1485218323, "post_id": 41773515, "comment_id": 70824449, "body": "can you post a link to the SPL examples you had in mind?  i&#39;m not sure i&#39;m seeing exactly what you were talking about."}, {"owner": {"reputation": 516, "user_id": 6490190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c28036f5e41e1db1ea8d989c9264820?s=128&d=identicon&r=PG", "display_name": "Yuriy", "link": "https://stackoverflow.com/users/6490190/yuriy"}, "reply_to_user": {"reputation": 45, "user_id": 5351948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/370e49fe19743c1f7186c8c222c0cced?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby Digital", "link": "https://stackoverflow.com/users/5351948/bobby-digital"}, "edited": false, "score": 0, "creation_date": 1485241501, "post_id": 41773515, "comment_id": 70831532, "body": "STM32 series (STM32F0, STM32F1, ...) each has its own Standard Peripheral Library (your code as I see uses this library), they can be found <a href=\"http://www.st.com/en/embedded-software/stm32-standard-peripheral-libraries.html?querycriteria=productId=LN1939\" rel=\"nofollow noreferrer\">here</a>. And inside library folder there is folder &quot;Projects&quot; in which you can find folder with examples (&quot;STM32F0xx_StdPeriph_Examples&quot; in your case). STM32CubeFX uses HAL instead SPL, so your current code won&#39;t work with Cube."}], "tags": [], "owner": {"reputation": 516, "user_id": 6490190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c28036f5e41e1db1ea8d989c9264820?s=128&d=identicon&r=PG", "display_name": "Yuriy", "link": "https://stackoverflow.com/users/6490190/yuriy"}, "is_accepted": true, "score": 0, "last_activity_date": 1484951982, "creation_date": 1484951982, "answer_id": 41773515, "question_id": 41728281, "link": "https://stackoverflow.com/questions/41728281/error-using-tim1-for-pwm-on-stm32f0/41773515#41773515", "title": "Error using TIM1 for PWM on STM32F0", "body": "<p>This is strange that you program fails on line IS_TIM_OUTPUTN_STATE with the code you give, of course it may be STL error but it sounds improbable. So try to change TIM_OutputNState_Disable on TIM_OutputNState_Enable.</p>\n\n<p>If you catch assert the program falls into infinite loop and the following setting code does not executed, so no pwm signal generates. Also you may try to configure timer with undefined USE_FULL_ASSERT, bad policy but at least it will not cause falling to assert. </p>\n\n<p>In terms of code, you can try to add TIM_CtrlPWMOutputs(TIM1, ENABLE); after configuring and enabling timer. And your functions seems strange for me, cause you either call TIM_PWM_Init() before enabling rcc (that's wrong) or after enabling timer, that is also strange. </p>\n\n<p>I think that the easiest way to solve the problem is to copy-paste all the beautiful code from SPL examples (like \"STM32F0xx_StdPeriph_Lib_V1.5.0\\Projects\\STM32F0xx_StdPeriph_Examples\\TIM\\TIM_7PWMOutputs\") and then remove the excess.</p>\n"}], "owner": {"reputation": 45, "user_id": 5351948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/370e49fe19743c1f7186c8c222c0cced?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby Digital", "link": "https://stackoverflow.com/users/5351948/bobby-digital"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1774, "favorite_count": 0, "accepted_answer_id": 41773515, "answer_count": 1, "score": 0, "last_activity_date": 1484951982, "creation_date": 1484769193, "last_edit_date": 1484863979, "question_id": 41728281, "link": "https://stackoverflow.com/questions/41728281/error-using-tim1-for-pwm-on-stm32f0", "title": "Error using TIM1 for PWM on STM32F0", "body": "<p>I'm trying to isolate this as much as possible (by commenting out the working TIM3 code for comparison).  I've got PWM to work fine on TIM3, but have not seen anything on TIM1.  Originally, the issue was pointed out in the comments that some of the TIM_OCInitStructure. calls, but I have them all in there and am still not seeing any signal.  Does anyone see anything else missing in the code? </p>\n\n<pre><code>void TIM_TIMER_Init(void)\n{\n    TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;\n\n//  RCC_APB1PeriphClockCmd(RCC_APB1ENR_TIM3EN, ENABLE);   //timer 3\n    RCC_APB2PeriphClockCmd(RCC_APB2Periph_TIM1, ENABLE);   //timer 1\n    TIM_TimeBaseStructure.TIM_Prescaler = 0;\n    TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  \n    TIM_TimeBaseStructure.TIM_Period = 4799;  // PER = F_timer / F_pwm - 1\n    TIM_TimeBaseStructure.TIM_ClockDivision = TIM_CKD_DIV1;\n    TIM_TimeBaseStructure.TIM_RepetitionCounter = 0;\n\n    // Initialize TIMx\n//  TIM_TimeBaseInit(TIM3, &amp;TIM_TimeBaseStructure);\n    TIM_TimeBaseInit(TIM1, &amp;TIM_TimeBaseStructure);\n\n    // Start count on TIMx\n//  TIM_Cmd(TIM3, ENABLE);\n    TIM_Cmd(TIM1, ENABLE);\n}\n\nvoid TIM_PWM_Init(void)\n{\n    TIM_OCInitTypeDef   TIM_OCInitStructure;\n\n    TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2;   // PWM1/PWM2 = set/clear on compare match\n    TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable;\n    TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_Low;\n    TIM_OCInitStructure.TIM_OutputNState = TIM_OutputNState_Disable;\n    TIM_OCInitStructure.TIM_OCNIdleState = TIM_OCNIdleState_Reset;\n    TIM_OCInitStructure.TIM_OCNPolarity = TIM_OCNPolarity_Low;\n    TIM_OCInitStructure.TIM_OCIdleState = TIM_OCIdleState_Reset;\n\n    TIM_OCInitStructure.TIM_Pulse = 959;    // 20% Duty Cycle on ch. 1\n//  TIM_OC1Init(TIM3, &amp;TIM_OCInitStructure);\n//  TIM_OC1PreloadConfig(TIM3, TIM_OCPreload_Enable);\n    TIM_OC1Init(TIM1, &amp;TIM_OCInitStructure);\n    TIM_OC1PreloadConfig(TIM1, TIM_OCPreload_Enable);\n/*\n    TIM_OCInitStructure.TIM_Pulse = 1919;   // 40% Duty Cycle on ch. 2\n//  TIM_OC2Init(TIM3, &amp;TIM_OCInitStructure);\n//  TIM_OC2PreloadConfig(TIM3, TIM_OCPreload_Enable);\n    TIM_OC2Init(TIM1, &amp;TIM_OCInitStructure);\n    TIM_OC2PreloadConfig(TIM1, TIM_OCPreload_Enable);\n\n    TIM_OCInitStructure.TIM_Pulse = 2879;   // 60% Duty Cycle on ch. 3\n//  TIM_OC3Init(TIM3, &amp;TIM_OCInitStructure);\n//  TIM_OC3PreloadConfig(TIM3, TIM_OCPreload_Enable);\n    TIM_OC3Init(TIM1, &amp;TIM_OCInitStructure);\n    TIM_OC3PreloadConfig(TIM1, TIM_OCPreload_Enable);\n\n    TIM_OCInitStructure.TIM_Pulse = 3839;   // 80% Duty Cycle on ch. 4\n//  TIM_OC4Init(TIM3, &amp;TIM_OCInitStructure);\n//  TIM_OC4PreloadConfig(TIM3, TIM_OCPreload_Enable);\n    TIM_OC4Init(TIM1, &amp;TIM_OCInitStructure);\n    TIM_OC4PreloadConfig(TIM1, TIM_OCPreload_Enable);\n*/}\n\n//\"using convenience methods instead of CMSIS\"\nvoid TIM_PINS_Init(void)\n{\n    GPIO_InitTypeDef    GPIO_InitStructure;\n\n//  RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOC, ENABLE);  //enabling port C\n    RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOA, ENABLE);  //enabling port A \n\n    // Alternative Functions for pins\n//  GPIO_PinAFConfig(GPIOC, GPIO_PinSource6, GPIO_AF_0);  // PC6\n//  GPIO_PinAFConfig(GPIOC, GPIO_PinSource7, GPIO_AF_0);  // PC7\n//  GPIO_PinAFConfig(GPIOC, GPIO_PinSource8, GPIO_AF_0);  // PC8\n//  GPIO_PinAFConfig(GPIOC, GPIO_PinSource9, GPIO_AF_0);  // PC9\n\n    GPIO_PinAFConfig(GPIOA, GPIO_PinSource8, GPIO_AF_2);    // PA8\n    GPIO_PinAFConfig(GPIOA, GPIO_PinSource9, GPIO_AF_2);    // PA9\n    GPIO_PinAFConfig(GPIOA, GPIO_PinSource10, GPIO_AF_2);   // PA10\n    GPIO_PinAFConfig(GPIOA, GPIO_PinSource11, GPIO_AF_2);   // PA11\n\n    // Set pins\n//  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6 | GPIO_Pin_7 | GPIO_Pin_8 | GPIO_Pin_9;\n    GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;\n    GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;\n\n\nGPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;\n    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;\n\n//  GPIO_Init(GPIOC, &amp;GPIO_InitStructure);  \n\n    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11;\n    GPIO_Init(GPIOA, &amp;GPIO_InitStructure);\n}\n</code></pre>\n\n<p>//////////////////\nOriginal Question\n//////////////////</p>\n\n<p>Does anyone see a problem with this bit of code?</p>\n\n<pre><code>TIM_OCInitTypeDef   TIM_OCInitStructure;\n\n    TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2;\n    TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable;\n    TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_Low;\n\n    TIM_OCInitStructure.TIM_Pulse = 959;    // 20% Duty Cycle on ch. 1\n    TIM_OC1Init(TIM3, &amp;TIM_OCInitStructure);\n    TIM_OC1PreloadConfig(TIM3, TIM_OCPreload_Enable);\n    TIM_OC1Init(TIM1, &amp;TIM_OCInitStructure);\n    TIM_OC1PreloadConfig(TIM1, TIM_OCPreload_Enable);\n</code></pre>\n\n<p>The problem is with </p>\n\n<pre><code>TIM_OC1Init(TIM1, &amp;TIM_OCInitStructure);\n</code></pre>\n\n<p>The error is </p>\n\n<p>assert_param() failed: file \"../system/src/stm32f0-stdperiph/stm32f0xx_tim.c\", line 811.  Looking that up that line is:</p>\n\n<pre><code>  if((TIMx == TIM1) || (TIMx == TIM15) || (TIMx == TIM16) || (TIMx == TIM17))\n  {\n    assert_param(IS_TIM_OUTPUTN_STATE(TIM_OCInitStruct-&gt;TIM_OutputNState)); // &lt;- line 811\n</code></pre>\n\n<p>The TIM_OC1Init() function seems to work for TIM3, but not TIM1.  I've seen others in this forum use TIM_OC1Init() for TIM1, so I'm not sure what the issue is for me.  Isn't this how I set ch.1?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 3, "creation_date": 1484768303, "post_id": 41727945, "comment_id": 70650436, "body": "Can you demonstrate <i>any</i> attempt at solving this yourself?  Have you verified that the program even works properly?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484768872, "post_id": 41727945, "comment_id": 70650765, "body": "&quot;I don&#39;t know how to calculate it&quot;. Did you ask your teaching staff? If they have required you to do this then I am assuming they have covered order of complexity in their teaching and thus you must have some idea. And it&#39;s not really clear whether you actually do mean order of complexity or actual clock run time. Can you clarify?"}, {"owner": {"reputation": 1, "user_id": 7437535, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5ASojw-rV00/AAAAAAAAAAI/AAAAAAAAMH4/R0kUyhNmtFE/photo.jpg?sz=128", "display_name": "Ronald Granovski", "link": "https://stackoverflow.com/users/7437535/ronald-granovski"}, "edited": false, "score": 0, "creation_date": 1484769583, "post_id": 41727945, "comment_id": 70651169, "body": "sorry my presentations are not in english so i am trying to translate my question properly, i think i mean how do i calculate the order of complexity,in class that Taught us spesific sort methods,and didnt explain how to calculate your order of complexity yet"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5697768"}, "is_accepted": false, "score": 0, "last_activity_date": 1484769648, "creation_date": 1484769648, "answer_id": 41728408, "question_id": 41727945, "link": "https://stackoverflow.com/questions/41727945/run-time-or-a-new-idea/41728408#41728408", "title": "Run time or a new idea", "body": "<p>Your runtime for this Code is  O(N^2) </p>\n\n<p>You can use Counting Sort to sort an array in linear time \nFor reference  <a href=\"http://www.geeksforgeeks.org/counting-sort/\" rel=\"nofollow noreferrer\">Counting Sort</a></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1484771546, "last_edit_date": 1495535363, "creation_date": 1484770920, "answer_id": 41728768, "question_id": 41727945, "link": "https://stackoverflow.com/questions/41727945/run-time-or-a-new-idea/41728768#41728768", "title": "Run time or a new idea", "body": "<p>As <a href=\"https://stackoverflow.com/a/41728408/2410359\">@VenuKant Sahu</a> answered, OP's code is <code>O(n*n)</code></p>\n\n<p>That is due to its double nested <code>for</code> loops</p>\n\n<pre><code>for (i=0;i&lt;size-1;i++)\n   ...\n   for (j=i;j&lt;size;j++)\n     ...\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>I need to write code that sorts in 'n' run time </p>\n</blockquote>\n\n<p>O(n) algorithm  (did not want to just give the code)</p>\n\n<p>The number of loop iterations below can not exceed <code>n/2</code>.<br>\nThe increment even_side happens at most <code>n</code> times.<br>\nThe decrement odd_side happens at most <code>n</code> times.</p>\n\n<pre><code>  // set up indexes\n  int even_side = left-most valid index\n  int odd_side = right-most valid index\n  loop {\n    while (the_even_index_is_not_at_the_right_end &amp;&amp; is_even(a[even_side]) increment even_side;\n    while (the_odd_index_is_not_at_the_left_end &amp;&amp; !is_even(a[odd_side]) decrement odd_side\n\n    compare the indexes\n    if (done) exit the loop;\n\n    a[even_side] &lt;==&gt; a[odd_side]\n  }\n</code></pre>\n\n<hr>\n\n<p>Some helper code to set up a random array.</p>\n\n<pre><code>  #define N 10\n  srand(time(NULL));\n  int a[N];\n  for (int i = 0; i&lt;N; i++) {\n    a[i] = rand()%100;\n    printf(\" %d\", a[i]);\n  }\n  puts(\"\");\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7437535, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5ASojw-rV00/AAAAAAAAAAI/AAAAAAAAMH4/R0kUyhNmtFE/photo.jpg?sz=128", "display_name": "Ronald Granovski", "link": "https://stackoverflow.com/users/7437535/ronald-granovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1484771546, "creation_date": 1484768027, "last_edit_date": 1484769127, "question_id": 41727945, "link": "https://stackoverflow.com/questions/41727945/run-time-or-a-new-idea", "title": "Run time or a new idea", "body": "<p>I need to write code that sorts in 'n' run time and I don't know how to calculate it. I need to simply sort an array so that left side is odd and right side is even. This is what I wrote and I wonder how do I to find the run time.</p>\n\n<pre><code>for (i=0;i&lt;size-1;i++)\n        {\n            if(ptr[i]%2==0 || ptr[i]==0)\n            {\n                for (j=i;j&lt;size;j++)\n                {\n                    if(ptr[j]%2!=0)\n                    {\n                        temp=ptr[i];\n                        ptr[i]=ptr[j];\n                        ptr[j]=temp;\n                        break;\n                    }\n\n                }\n            }\n        }\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "arrays", "qt"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1484768446, "post_id": 41727943, "comment_id": 70650522, "body": "It already is. Are you having trouble printing it?"}, {"owner": {"reputation": 301, "user_id": 1743514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/02da8087bd6dd9ef2bbae125c0634ff3?s=128&d=identicon&r=PG", "display_name": "user1743514", "link": "https://stackoverflow.com/users/1743514/user1743514"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1484769052, "post_id": 41727943, "comment_id": 70650858, "body": "yes, In debugger it is showing the values. But I print it , it is showing something different."}], "answers": [{"comments": [{"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 0, "creation_date": 1484768677, "post_id": 41728054, "comment_id": 70650667, "body": "why not add <code>std:size_t size = sizeof(arr) &#47; sizeof(char);</code>?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484768916, "post_id": 41728054, "comment_id": 70650785, "body": "It is not necessary to cast <code>char</code> when assigned to <code>int</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1484769595, "post_id": 41728054, "comment_id": 70651176, "body": "With respect to <code>int* ptr = new int[size]</code>, may I pitch <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector&lt;int&gt; vec(size);</code></a> ?"}], "tags": [], "owner": {"reputation": 718, "user_id": 4885127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03a4283a4fb815a1f77e8793b1c94cf?s=128&d=identicon&r=PG&f=1", "display_name": "Moshe D", "link": "https://stackoverflow.com/users/4885127/moshe-d"}, "is_accepted": true, "score": -1, "last_activity_date": 1484770567, "last_edit_date": 1484770567, "creation_date": 1484768427, "answer_id": 41728054, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array/41728054#41728054", "title": "decimal ascii value for unsigned char array", "body": "<p>This should work</p>\n\n<pre><code>char arr[] = {'1','9','2'};\nstd::vector&lt;int&gt; vec(size); //size of the char array - in this case 3\nfor(int i = 0; i &lt; size; i++)\n{\n   vec[i] = arr[i];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 4, "last_activity_date": 1484768650, "creation_date": 1484768650, "answer_id": 41728117, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array/41728117#41728117", "title": "decimal ascii value for unsigned char array", "body": "<blockquote>\n  <p>How to convert char array to its equivalent ascii decimal array ?</p>\n</blockquote>\n\n<p>You do not, it is already stored that way. If you want to print your array as decimal numbers for ASCII just output it accordingly (as integers):</p>\n\n<pre><code>char str[] = \"1,9,10,2\";\nfor( const char *s = str; *s; ++s ) std::cout &lt;&lt; static_cast&lt;int&gt;( *s ) &lt;&lt; \",\"; \n// just output number instead of character\n</code></pre>\n\n<p><code>char</code> in C++ is a numerical type similar to <code>int</code>, difference is <code>std::ostream</code> outputs <code>char</code> as a symbol and <code>int</code> and other integer types as integer.</p>\n"}, {"comments": [{"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484770078, "post_id": 41728425, "comment_id": 70651463, "body": "@latedeveloper I&#39;m sorry you are not able to run it. Why shouldn&#39;t it?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770125, "post_id": 41728425, "comment_id": 70651487, "body": "<code>char output[2*strlen(input) + 1];</code> is a VLA and is not standard C++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484770182, "post_id": 41728425, "comment_id": 70651514, "body": "@Nitro What Nathan said."}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770398, "post_id": 41728425, "comment_id": 70651627, "body": "@NathanOliver right... I guess you may replace &quot;strlen&quot; with &quot;sizeof&quot;..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770586, "post_id": 41728425, "comment_id": 70651719, "body": "Still it is a very brittle solution.  You are basically using the assumption that the characters are mapped to values in the range of [10, 99].  If that is ever not the case then problems ensue."}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484770605, "post_id": 41728425, "comment_id": 70651730, "body": "by the way, as it is constant, probably my compiler does not complain even if I ask --std=c++0x"}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484770777, "post_id": 41728425, "comment_id": 70651817, "body": "you&#39;re totally right, I quickly copied the code with %X and when replaced to %d I forgot it; also output shall be initialised to 0, at least the first element."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770783, "post_id": 41728425, "comment_id": 70651819, "body": "You need better compiler flags.  <a href=\"http://coliru.stacked-crooked.com/a/140c992a28be47cc\" rel=\"nofollow noreferrer\">See this example</a>"}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484771097, "post_id": 41728425, "comment_id": 70651979, "body": "Thanks @NathanOliver, &quot;-pedantic&quot; did the trick. I edited the proposed solution to mitigate the issues you kindly spotted"}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484772388, "post_id": 41728425, "comment_id": 70652612, "body": "you think I better remove it?"}], "tags": [], "owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "is_accepted": false, "score": 0, "last_activity_date": 1484771493, "last_edit_date": 1484771493, "creation_date": 1484769697, "answer_id": 41728425, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array/41728425#41728425", "title": "decimal ascii value for unsigned char array", "body": "<p>You can easily do this way. It's C++ but it will work in C with proper includes and printf in place of std:cout.</p>\n\n<pre><code>int main() {\n    char input[] = \"1,9,10,2\";\n    char output[3*sizeof(input) + 1];\n\n    output[0] = '\\0';\n    for (size_t i = 0; i &lt; strlen(input); i++) {\n        sprintf(output, \"%s%d\", output, input[i]);\n    }\n\n    std::cout &lt;&lt; input &lt;&lt; std::endl;\n    std::cout &lt;&lt; output &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Followed some hint from @Nathan, it should be better now...</p>\n"}], "owner": {"reputation": 301, "user_id": 1743514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/02da8087bd6dd9ef2bbae125c0634ff3?s=128&d=identicon&r=PG", "display_name": "user1743514", "link": "https://stackoverflow.com/users/1743514/user1743514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 0, "accepted_answer_id": 41728054, "answer_count": 3, "score": 0, "last_activity_date": 1484771493, "creation_date": 1484768009, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array", "title": "decimal ascii value for unsigned char array", "body": "<p>How to convert char array to its equivalent ascii decimal array ? I tried in QT using QString and QbyteArray. But it is not working. </p>\n\n<p>i/p: \"1,9,10,2\" </p>\n\n<p>o/p:  \"4944574449484450\"  (1's ascii decimal value is 49, \n                            , ascii decimal value is 44, \n                            9's ascii decimal value is 57, and so on..). </p>\n"}, {"tags": ["c++", "c", "windows", "audio"], "comments": [{"owner": {"reputation": 2103, "user_id": 1865694, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bP5UU.jpg?s=128&g=1", "display_name": "Alex Zywicki", "link": "https://stackoverflow.com/users/1865694/alex-zywicki"}, "edited": false, "score": 0, "creation_date": 1484781757, "post_id": 41727448, "comment_id": 70656755, "body": "Have a look at PortAudio: <a href=\"http://www.portaudio.com\" rel=\"nofollow noreferrer\">portaudio.com</a>"}, {"owner": {"reputation": 6079, "user_id": 734335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9047f5d438178c9530b93f39f0126c2?s=128&d=identicon&r=PG", "display_name": "Mathieu Rodic", "link": "https://stackoverflow.com/users/734335/mathieu-rodic"}, "edited": false, "score": 0, "creation_date": 1486350335, "post_id": 41727448, "comment_id": 71291933, "body": "Have a look here: <a href=\"http://stackoverflow.com/questions/25291097/capture-global-audio-output-in-c-portaudio\" title=\"capture global audio output in c portaudio\">stackoverflow.com/questions/25291097/&hellip;</a>"}], "owner": {"reputation": 15, "user_id": 5372576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fkgFy.png?s=128&g=1", "display_name": "Hate9", "link": "https://stackoverflow.com/users/5372576/hate9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1484766286, "creation_date": 1484766286, "question_id": 41727448, "link": "https://stackoverflow.com/questions/41727448/recording-audio-from-output-device", "title": "Recording audio from output device", "body": "<p>I'm trying to set up a program to record audio in windows, and I need to record from the output device. I'm looking into using the waveform audio interface, but I can't find a way to use the output device for recording.</p>\n\n<p>Is there any way to make a hook in between the windows sound mixer and the physical output device?</p>\n"}, {"tags": ["c", "switch-statement", "language-lawyer"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484766313, "post_id": 41727415, "comment_id": 70649283, "body": "Doesn&#39;t your compiler already warn you about dead code in general?"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1484766364, "post_id": 41727415, "comment_id": 70649318, "body": "Perhaps you didn&#39;t read the question:  <b>YES</b> the compiler should warn against unreachable code. <b>NO</b> this bit was <i>NOT</i> flagged as unreachable."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1484766368, "post_id": 41727415, "comment_id": 70649321, "body": "@KerrekSB tried to reproduce: My GCC 5.3.1 doesn&#39;t."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 1, "creation_date": 1484766444, "post_id": 41727415, "comment_id": 70649360, "body": "@MarcusM&#252;ller: My <a href=\"http://melpon.org/wandbox/permlink/fokam99wkp5KgwEH\" rel=\"nofollow noreferrer\">GCC 7 does</a> :-)"}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 52, "creation_date": 1484766506, "post_id": 41727415, "comment_id": 70649397, "body": "GCC has a special flag for this. It&#39;s <code>-Wswitch-unreachable</code>"}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1484766539, "post_id": 41727415, "comment_id": 70649410, "body": "@EliSadoff well, GCC 7 does seem to have that, but 5.3.1 doesn&#39;t know that flag :)"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 58, "creation_date": 1484766599, "post_id": 41727415, "comment_id": 70649444, "body": "<i>&quot;Does this serve any purpose at all?&quot;</i> Well, you can <code>goto</code> in and out of the otherwise unreachable part, which may be useful for various hacks."}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 13, "creation_date": 1484766627, "post_id": 41727415, "comment_id": 70649459, "body": "@HolyBlackCat Wouldn&#39;t that be such for all unreachable code?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 28, "creation_date": 1484766858, "post_id": 41727415, "comment_id": 70649613, "body": "@EliSadoff Indeed. I guess it doesn&#39;t serve any <i>special</i> purpose. I bet it is allowed just because there is no reason to forbid it. After all, <code>switch</code> is just a conditional <code>goto</code> with multiple labels. There are more or less same restrictions on it&#39;s body as you would have on a regular block of code filled with goto labels."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 5, "creation_date": 1484767132, "post_id": 41727415, "comment_id": 70649799, "body": "@HolyBlackCat The body doesn&#39;t even have to be a block. Any statement will do."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1484767620, "post_id": 41727415, "comment_id": 70650057, "body": "@PSkocik Huh, who would have thought."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 4, "creation_date": 1484783325, "post_id": 41727415, "comment_id": 70657230, "body": "@HolyBlackCat: <a href=\"http://ideone.com/8XKE7\" rel=\"nofollow noreferrer\">ideone.com/8XKE7</a> look where the <code>do {</code> is."}, {"owner": {"reputation": 60850, "user_id": 221955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0bc09e1bd45610fc85274cd7bb002c56?s=128&d=identicon&r=PG", "display_name": "Michael Anderson", "link": "https://stackoverflow.com/users/221955/michael-anderson"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 16, "creation_date": 1484792054, "post_id": 41727415, "comment_id": 70659546, "body": "Worth pointing out that @MooingDuck s example is a variant on Duff&#39;s device (<a href=\"https://en.wikipedia.org/wiki/Duff&#39;s_device\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Duff&#39;s_device</a>)"}, {"owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "edited": false, "score": 0, "creation_date": 1484839937, "post_id": 41727415, "comment_id": 70684063, "body": "what I don&#39;t get is what&#39;s the difference in behavior when we look at duff&#39;s device vs. the <code>printf</code> in OP. why is one reached, and the other never? is it just because of the fall-through in the last case? could a for loop be used instead of the while? i.e., are &quot;both ends of the loop a goto target&quot;?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1484898121, "post_id": 41727415, "comment_id": 70708477, "body": "@HolyBlackCat Re &quot;you can goto in and out of the otherwise unreachable part&quot;: If you can do that, the code is obviously not unreachable. Duh. The <code>printf</code> in the OP cannot be reached, period."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484903640, "post_id": 41727415, "comment_id": 70711320, "body": "@dlatikayYes, one can think of both ends of a loop as labels (just imagine how a loop would be coded without loop constructs). While a <code>for</code> and a <code>while</code> loop technically only need a label at the beginning, a <code>do..while</code> loop has a virtual label at the end as well which is jumped to with a <code>continue</code>, in order to check the end condition."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484910924, "post_id": 41727415, "comment_id": 70716022, "body": "@PeterA.Schneider Please read my comment closely. I know that, and that why I said &quot;<i>otherwise</i> unreachable&quot;."}, {"owner": {"reputation": 25726, "user_id": 453435, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SjPwA.jpg?s=128&g=1", "display_name": "Ben Leggiero", "link": "https://stackoverflow.com/users/453435/ben-leggiero"}, "edited": false, "score": 0, "creation_date": 1485285512, "post_id": 41727415, "comment_id": 70859654, "body": "Another reason I don&#39;t touch C with a ten-foot stick; the compiler is just fine with stuff like this :)"}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 7407065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29c5df2bfbde7cf5795faf3a36e2311?s=128&d=identicon&r=PG&f=1", "display_name": "16tons", "link": "https://stackoverflow.com/users/7407065/16tons"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484766784, "post_id": 41727475, "comment_id": 70649559, "body": "Having experienced the issue first hand always helps!"}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484854703, "post_id": 41727475, "comment_id": 70692871, "body": "@JonathanLeffler: The general issue of gcc warnings being susceptible to the particular set of optimization passes selected is still true, unfortunately, and makes for a poor user experience. It&#39;s really annoying to have a clean Debug build followed by a failing Release build :/"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1484925510, "post_id": 41727475, "comment_id": 70725138, "body": "@MatthieuM.: It would seem that such a warning would be extremely easy to detect in cases involving grammatical rather than semantic analysis [e.g. code follows an &quot;if&quot; which has returns in both branches], and make it easier to stifle &quot;annoyance&quot; warnings.  On the other hand, there are some cases where it&#39;s useful to have errors or warning in release builds that aren&#39;t in debug builds (if nothing else, in places where a hack which is put in for debugging is supposed to be cleaned up for release)."}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1484926080, "post_id": 41727475, "comment_id": 70725531, "body": "@supercat: Well, <code>#ifndef NDEBUG</code> allows debug only code sections and <code>#pragma warning</code> (I think) lets you write your own warning. However, my problem is more than having <code>-Wuninitialized</code> only work for maybe 30% of its potential reach in Debug and 100% in Release mean that you have to compile in both modes when developing, which slows down the edit-compile-test cycle (or you put it off &#39;till the end, and then discover that your approach has a flaw)... Clang manages to have such warnings have 100% coverage in Debug, I don&#39;t see why gcc couldn&#39;t."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 1, "creation_date": 1484927453, "post_id": 41727475, "comment_id": 70726486, "body": "@MatthieuM.: If significant semantic analysis would be required to discover that a certain variable will always be false at some spot in the code, code which is conditional upon that variable being true would be found to be unreachable only if such analysis were performed.  On the other hand, I would consider a notice that such code was unreachable rather differently from a warning about syntactically-unreachable code, since it should be entirely <i>normal</i> to have various conditions be possible with some project configurations but not others.  It may at times be helpful for programmers..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1484927821, "post_id": 41727475, "comment_id": 70726702, "body": "...to know why some configurations generate larger code than others [e.g. because a compiler could regard some condition as impossible in one configuration but not another] but that doesn&#39;t mean that there&#39;s anything &quot;wrong&quot; with code which could be optimized in that fashion with some configurations."}], "tags": [], "owner": {"reputation": 605, "user_id": 7407065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29c5df2bfbde7cf5795faf3a36e2311?s=128&d=identicon&r=PG&f=1", "display_name": "16tons", "link": "https://stackoverflow.com/users/7407065/16tons"}, "is_accepted": false, "score": 15, "last_activity_date": 1487100660, "last_edit_date": 1487100660, "creation_date": 1484766388, "answer_id": 41727475, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41727475#41727475", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>Assuming you are using gcc on Linux, it would have given you a warning if you're using 4.4 or earlier version. </p>\n\n<p>The -Wunreachable-code option <a href=\"https://gcc.gnu.org/ml/gcc-help/2011-05/msg00360.html\" rel=\"nofollow noreferrer\">was removed in gcc 4.4</a> onward.</p>\n"}, {"comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1484767489, "post_id": 41727535, "comment_id": 70650001, "body": "&quot;... but is never initialized ...&quot; Looks like <code>i</code> is initialized to 4, what am I missing?"}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 7, "creation_date": 1484767765, "post_id": 41727535, "comment_id": 70650120, "body": "Note that if the variable is <code>static</code>, it will be initialized to zero, so there&#39;s a safe usage for this as well."}, {"owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 23, "creation_date": 1484767928, "post_id": 41727535, "comment_id": 70650221, "body": "@yano We always jump over the <code>i = 4;</code>initialization, so it never takes place."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 12, "creation_date": 1484768144, "post_id": 41727535, "comment_id": 70650349, "body": "Hah of course! ... whole point of the question ... geez. The desire is strong to delete this stupidity"}, {"owner": {"reputation": 23582, "user_id": 598289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b04c9074fed0dd215caec771c2a9ea98?s=128&d=identicon&r=PG", "display_name": "SJuan76", "link": "https://stackoverflow.com/users/598289/sjuan76"}, "edited": false, "score": 1, "creation_date": 1484831335, "post_id": 41727535, "comment_id": 70677918, "body": "Nice! Sometimes I needed a temp variable inside a <code>case</code>, and always had to use different names in each <code>case</code> or define it outside the switch."}], "tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": true, "score": 227, "last_activity_date": 1484862358, "last_edit_date": 1484862358, "creation_date": 1484766585, "answer_id": 41727535, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41727535#41727535", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>Perhaps not the most useful, but not <em>completely</em> worthless. You may use it to declare a local variable available within <code>switch</code> scope.</p>\n\n<pre><code>switch (foo)\n{\n    int i;\ncase 0:\n    i = 0;\n    //....\ncase 1:\n    i = 1;\n    //....\n}\n</code></pre>\n\n<p>The standard (<code>N1579 6.8.4.2/7</code>) has the following sample:</p>\n\n<blockquote>\n  <p>EXAMPLE&nbsp;&nbsp;&nbsp;&nbsp;In the artificial program fragment</p>\n\n<pre><code>switch (expr)\n{\n    int i = 4;\n    f(i);\ncase 0:\n    i = 17;\n    /* falls through into default code */\ndefault:\n    printf(\"%d\\n\", i);\n}\n</code></pre>\n  \n  <p>the object whose identifier is <code>i</code> exists with automatic storage duration (within the block) but is never\n  initialized, and thus if the controlling expression has a nonzero value, the call to the <code>printf</code> function will\n  access an indeterminate value. Similarly, the call to the function <code>f</code> cannot be reached.</p>\n</blockquote>\n\n<p><strong>P.S.</strong> BTW, the sample is not valid C++ code. In that case (<code>N4140 6.7/3</code>, emphasis mine):</p>\n\n<blockquote>\n  <p>A program that jumps<sup>90</sup> from a point where a variable with automatic storage duration is not in scope to a\n  point where it is in scope is ill-formed <strong><em>unless the variable has scalar type</em></strong>, class type with a trivial default\n  constructor and a trivial destructor, a cv-qualified version of one of these types, or an array of one of the\n  preceding types <strong><em>and is declared without an initializer</em></strong> (8.5).</p>\n  \n  <hr>\n  \n  <p><sup>90) The transfer from the condition of a <code>switch</code> statement to a case label is considered a jump in this respect.</sup></p>\n</blockquote>\n\n<p>So replacing <code>int i = 4;</code> with <code>int i;</code> makes it a valid C++.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 10, "last_activity_date": 1484766809, "creation_date": 1484766809, "answer_id": 41727593, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41727593#41727593", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>You got your answer related to the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options\">required <code>gcc</code> option</a> <code>-Wswitch-unreachable</code> to generate the warning, this answer is to elaborate on the <em>usability</em> / <em>worthyness</em> part.</p>\n\n<p>Quoting straight out of <code>C11</code>, chapter \u00a76.8.4.2, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n<pre><code>switch (expr)\n{\nint i = 4;\nf(i);\ncase 0:\ni = 17;\n/* falls through into default code */\ndefault:\nprintf(\"%d\\n\", i);\n}\n</code></pre>\n  \n  <p><strong>the object whose identifier is <code>i</code> exists with automatic storage\n  duration (within the block) but is never initialized</strong>, and thus if the\n  controlling expression has a nonzero value, the call to the <code>printf</code>\n  function will access an indeterminate value. Similarly, the call to\n  the function <code>f</code> cannot be reached.</p>\n</blockquote>\n\n<p>Which is very self-explanatory. You can use this to define a locally scoped variable which is available only within the <code>switch</code> statement scope.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1484840286, "post_id": 41727617, "comment_id": 70684301, "body": "@MatthieuM Duff&#39;s Device does have case labels inside a loop, but starts with a case label before the loop."}, {"owner": {"reputation": 23184, "user_id": 527968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E7VJQ.jpg?s=128&g=1", "display_name": "Liviu T.", "link": "https://stackoverflow.com/users/527968/liviu-t"}, "edited": false, "score": 2, "creation_date": 1484869440, "post_id": 41727617, "comment_id": 70699896, "body": "I&#39;m not sure if I should upvote for the interesting example or downvote for the utter madness of writing this in a real program :). Congrats for diving into the abyss and returning back in one piece."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 966, "user_id": 1755715, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J3dKX.png?s=128&g=1", "display_name": "Nat", "link": "https://stackoverflow.com/users/1755715/nat"}, "edited": false, "score": 0, "creation_date": 1484931402, "post_id": 41727617, "comment_id": 70728859, "body": "@ChemicalEngineer: If the code is part of a loop, as it is in Duff&#39;s Device, <code>{ &#47;*code*&#47; switch(x) { } }</code> may look cleaner but it is also <i>wrong</i>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": false, "score": 98, "last_activity_date": 1484766894, "creation_date": 1484766894, "answer_id": 41727617, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41727617#41727617", "title": "Valid, but worthless syntax in switch-case?", "body": "<blockquote>\n  <p>Does this serve any purpose at all?</p>\n</blockquote>\n\n<p>Yes. If instead of a statement, you put a declaration before the first label, this can make perfect sense:</p>\n\n<pre><code>switch (a) {\n  int i;\ncase 0:\n  i = f(); g(); h(i);\n  break;\ncase 1:\n  i = g(); f(); h(i);\n  break;\n}\n</code></pre>\n\n<p>The rules for declarations and statements are shared for blocks in general, so it's the same rule that allows that that also allows statements there.</p>\n\n<hr>\n\n<p>Worth mentioning as well is also that if the first statement is a loop construct, case labels may appear in the loop body:</p>\n\n<pre><code>switch (i) {\n  for (;;) {\n    f();\n  case 1:\n    g();\n  case 2:\n    if (h()) break;\n  }\n}\n</code></pre>\n\n<p>Please don't write code like this if there is a more readable way of writing it, but it's perfectly valid, and the <code>f()</code> call is reachable.</p>\n"}, {"comments": [{"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484909122, "post_id": 41727732, "comment_id": 70714818, "body": "And what is difference between <code>nocase:</code> and <code>default:</code>?"}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "reply_to_user": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484921643, "post_id": 41727732, "comment_id": 70722641, "body": "@i486 When<code>i=4</code> it does not trigger <code>nocase</code>."}, {"owner": {"reputation": 36814, "user_id": 671543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2145962377da9419f2446cd565f614ee?s=128&d=identicon&r=PG", "display_name": "njzk2", "link": "https://stackoverflow.com/users/671543/njzk2"}, "edited": false, "score": 0, "creation_date": 1484924582, "post_id": 41727732, "comment_id": 70724508, "body": "@SanchkeDellowar that&#39;s what I mean."}, {"owner": {"reputation": 17954, "user_id": 1248008, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Z3JaL.png?s=128&g=1", "display_name": "Jonas Sch&#228;fer", "link": "https://stackoverflow.com/users/1248008/jonas-sch%c3%a4fer"}, "edited": false, "score": 0, "creation_date": 1485153464, "post_id": 41727732, "comment_id": 70789006, "body": "Why the heck would one do that instead of simply putting case 1 before case 0 and using fallthrough?"}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "reply_to_user": {"reputation": 17954, "user_id": 1248008, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Z3JaL.png?s=128&g=1", "display_name": "Jonas Sch&#228;fer", "link": "https://stackoverflow.com/users/1248008/jonas-sch%c3%a4fer"}, "edited": false, "score": 0, "creation_date": 1485185385, "post_id": 41727732, "comment_id": 70807680, "body": "@JonasWielicki In this objective, you could do that. But this code is just a display case of what can be done."}], "tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 11, "last_activity_date": 1484767593, "last_edit_date": 1484767593, "creation_date": 1484767278, "answer_id": 41727732, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41727732#41727732", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>Not only for variable declaration but advanced jumping as well. You can utilize it well if and only if you're not prone to spaghetti code. </p>\n\n<pre><code>int main()\n{\n    int i = 1;\n    switch(i)\n    {\n        nocase:\n        printf(\"no case\\n\");\n\n        case 0: printf(\"0\\n\"); break;\n        case 1: printf(\"1\\n\"); goto nocase;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>1\nno case\n0 /* Notice how \"0\" prints even though i = 1 */\n</code></pre>\n\n<p>It should be noted that switch-case is one of the fastest control flow clauses. So it must be very flexible to the programmer, which sometimes involves cases like this.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1484870992, "post_id": 41738481, "comment_id": 70700365, "body": "The addition of variable-length arrays led to the imposition of structural restrictions related to them."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1484905861, "post_id": 41738481, "comment_id": 70712719, "body": "@supercat What kind of restrictions?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1484924048, "post_id": 41738481, "comment_id": 70724155, "body": "Neither a <code>goto</code> nor <code>switch&#47;case&#47;default</code> label may appear within the scope of any variably-declared object or type.  This effectively means that if a block contains any declarations of variable-length-array objects or types, any labels must precede those declarations.  There&#39;s a confusing bit of verbiage in the Standard which would suggest that in some cases the scope of a VLA declaration extends to the entirety of a switch statement; see <a href=\"http://stackoverflow.com/questions/41752072/meaning-of-this-rule-about-variable-length-arrays-and-switch-statements\" title=\"meaning of this rule about variable length arrays and switch statements\">stackoverflow.com/questions/41752072/&hellip;</a> for my question on that."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1485975190, "post_id": 41738481, "comment_id": 71152455, "body": "@supercat: You just misunderstood that verbiage (which I presume is why you deleted your question). It imposes a requirement on the scope in which a VLA may be defined. It doesn&#39;t extend that scope, it just makes certain VLA definitions invalid."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1485977189, "post_id": 41738481, "comment_id": 71153555, "body": "@KeithThompson: Yeah, I had misunderstood it.  The weird use of the present tense in the footnote made things confusing, and I think the concept could have been better expressed as a prohibition: &quot;A switch statement whose body contains a VLA declaration within it shall not include any switch or case labels within the scope of that VLA declaration&quot;."}], "tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 11, "last_activity_date": 1484994028, "last_edit_date": 1495542867, "creation_date": 1484819077, "answer_id": 41738481, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41738481#41738481", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>It should be noted, that there are virtually no structural restrictions on the code within the <code>switch</code> statement, or on where the <code>case *:</code> labels are placed within this code*. This makes programming tricks like <a href=\"https://en.wikipedia.org/wiki/Duff%27s_device\" rel=\"nofollow noreferrer\">duff's device</a> possible, one possible implementation of which looks like this:</p>\n\n<pre><code>int n = ...;\nint iterations = n/8;\nswitch(n%8) {\n    while(iterations--) {\n        sum += *ptr++;\n        case 7: sum += *ptr++;\n        case 6: sum += *ptr++;\n        case 5: sum += *ptr++;\n        case 4: sum += *ptr++;\n        case 3: sum += *ptr++;\n        case 2: sum += *ptr++;\n        case 1: sum += *ptr++;\n        case 0: ;\n    }\n}\n</code></pre>\n\n<p>You see, the code between the <code>switch(n%8) {</code> and the <code>case 7:</code> label is definitely reachable...</p>\n\n<hr>\n\n<p>* <sub>As <a href=\"https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case#comment70700365_41738481\">supercat thankfully pointed out in a comment</a>: Since C99, neither a <code>goto</code> nor a label (be it a <code>case *:</code> label or not) may appear within the scope of a declaration that contains a VLA declaration. So it's not correct to say that there are <em>no</em> structural restrictions on the placement of the <code>case *:</code> labels. However, duff's device predates the C99 standard, and it does not depend on VLA's anyway. Nevertheless, I felt compelled to insert a \"virtually\" into my first sentence due to this.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 702, "user_id": 3565320, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3cf5aa13df85456c370354fb11906a62?s=128&d=identicon&r=PG&f=1", "display_name": "Dancia", "link": "https://stackoverflow.com/users/3565320/dancia"}, "reply_to_user": {"reputation": 783, "user_id": 1633949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2kdP.jpg?s=128&g=1", "display_name": "Richard II", "link": "https://stackoverflow.com/users/1633949/richard-ii"}, "edited": false, "score": 0, "creation_date": 1484914037, "post_id": 41738776, "comment_id": 70717997, "body": "@RichardII Is it a pun or what? Please explain."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "reply_to_user": {"reputation": 702, "user_id": 3565320, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3cf5aa13df85456c370354fb11906a62?s=128&d=identicon&r=PG&f=1", "display_name": "Dancia", "link": "https://stackoverflow.com/users/3565320/dancia"}, "edited": false, "score": 1, "creation_date": 1484944378, "post_id": 41738776, "comment_id": 70735224, "body": "@Dancia He&#39;s saying that this is pretty clearly <i>not</i> the best way to do something like this, and &quot;might not&quot; is something of an understatement."}], "tags": [], "owner": {"reputation": 17966, "user_id": 1032073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/649a4.png?s=128&g=1", "display_name": "celtschk", "link": "https://stackoverflow.com/users/1032073/celtschk"}, "is_accepted": false, "score": 9, "last_activity_date": 1484819918, "creation_date": 1484819918, "answer_id": 41738776, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41738776#41738776", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>It is possible to implement a \"loop and a half\" with it, although it might not be the best way to do it:</p>\n\n<pre><code>char password[100];\nswitch(0) do\n{\n  printf(\"Invalid password, try again.\\n\");\ndefault:\n  read_password(password, sizeof(password));\n} while (!is_valid_password(password));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1484931525, "post_id": 41745305, "comment_id": 70728950, "body": "Of course, this would still be possible without allowing statements above the first case, as the order of <code>do {</code> and <code>case 0:</code> don&#39;t matter, both serve to place a jump target on the first <code>*to = *from++;</code>."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1484944260, "post_id": 41745305, "comment_id": 70735169, "body": "@BenVoigt I&#39;d argue that putting the <code>do {</code> is more readable. Yes, arguing about readability for Duff&#39;s Device is stupid and pointless and likely a simple way to go mad."}, {"owner": {"reputation": 17954, "user_id": 1248008, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Z3JaL.png?s=128&g=1", "display_name": "Jonas Sch&#228;fer", "link": "https://stackoverflow.com/users/1248008/jonas-sch%c3%a4fer"}, "reply_to_user": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 1, "creation_date": 1485153223, "post_id": 41745305, "comment_id": 70788920, "body": "@QPaysTaxes You should check out Simon Tatham\u2019s <a href=\"http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html\" rel=\"nofollow noreferrer\">Coroutines in C</a>. Or maybe not."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 17954, "user_id": 1248008, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Z3JaL.png?s=128&g=1", "display_name": "Jonas Sch&#228;fer", "link": "https://stackoverflow.com/users/1248008/jonas-sch%c3%a4fer"}, "edited": false, "score": 0, "creation_date": 1556466393, "post_id": 41745305, "comment_id": 98440672, "body": "@JonasSch&#228;fer Amusingly, that is basically what C++20 coroutines are going to do for you."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 40, "last_activity_date": 1484838911, "creation_date": 1484838911, "answer_id": 41745305, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case/41745305#41745305", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>There is a famous use of this called <a href=\"https://en.wikipedia.org/wiki/Duff&#39;s_device\">Duff's Device</a>.</p>\n\n<pre><code>int n = (count+3)/4;\nswitch (count % 4) {\n  do {\n    case 0: *to = *from++;\n    case 3: *to = *from++;\n    case 2: *to = *from++;\n    case 1: *to = *from++;\n  } while (--n &gt; 0);\n}\n</code></pre>\n\n<p>Here we copy a buffer pointed to by <code>from</code> to a buffer pointed to by <code>to</code>.  We copy <code>count</code> instances of data.</p>\n\n<p>The <code>do{}while()</code> statement starts before the first <code>case</code> label, and the <code>case</code> labels are embedded within the <code>do{}while()</code>.</p>\n\n<p>This reduces the number of conditional branches at the end of the <code>do{}while()</code> loop encountered by roughly a factor of 4 (in this example; the constant can be tweaked to whatever value you want).</p>\n\n<p>Now, optimizers can sometimes do this for you (especially if they are optimizing streaming/vectorized instructions), but without profile guided optimization they cannot know if you expect the loop to be large or not.</p>\n\n<p>In general, variable declarations can occur there and be used in every case, but be out of scope after the switch ends.  (note any initialization will be skipped)</p>\n\n<p>In addition, control flow that isn't switch-specific can get you into that section of the switch block, as illustrated above, or with a <code>goto</code>.</p>\n"}], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14178, "favorite_count": 20, "protected_date": 1563538631, "accepted_answer_id": 41727535, "answer_count": 8, "score": 208, "last_activity_date": 1487100660, "creation_date": 1484766177, "question_id": 41727415, "link": "https://stackoverflow.com/questions/41727415/valid-but-worthless-syntax-in-switch-case", "title": "Valid, but worthless syntax in switch-case?", "body": "<p>Through a little typo, I accidentally found this construct:</p>\n\n<pre><code>int main(void) {\n    char foo = 'c';\n\n    switch(foo)\n    {\n        printf(\"Cant Touch This\\n\");   // This line is Unreachable\n\n        case 'a': printf(\"A\\n\"); break;\n        case 'b': printf(\"B\\n\"); break;\n        case 'c': printf(\"C\\n\"); break;\n        case 'd': printf(\"D\\n\"); break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>It seems that the <code>printf</code> at the top of the <code>switch</code> statement is valid, but also completely unreachable.</p>\n\n<p>I got a clean compile, without even a warning about unreachable code, but this seems pointless.</p>\n\n<p>Should a compiler flag this as unreachable code?<br>\nDoes this serve any purpose at all?</p>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1484767769, "post_id": 41727300, "comment_id": 70650123, "body": "<code>int main(void)</code> does not get any arguments from the terminal. And why have you redefined <code>char* s</code>?"}, {"owner": {"reputation": 15, "user_id": 7437330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/458ce6f16817af59e2604a048a7b4116?s=128&d=identicon&r=PG&f=1", "display_name": "RealityArchitect", "link": "https://stackoverflow.com/users/7437330/realityarchitect"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484774807, "post_id": 41727300, "comment_id": 70653916, "body": "you are right I changed that;"}], "answers": [{"tags": [], "owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "is_accepted": true, "score": 3, "last_activity_date": 1484870558, "last_edit_date": 1495535364, "creation_date": 1484787320, "answer_id": 41732028, "question_id": 41727300, "link": "https://stackoverflow.com/questions/41727300/get-argument-from-command-line-in-inline-assembly/41732028#41732028", "title": "Get argument from command line in inline assembly", "body": "<p>So first, let's look at your \"working\" code.  While it works, there are a few \"teachable\" items here.</p>\n\n<p>First of all, please get in the habit of using comments in your code.  I realize English is not your first language so I probably couldn't <em>read</em> your comments, but still, you should have them.</p>\n\n<p>Second, stop using <code>;</code> to terminate your asm instructions.  Yes, it looks a little clunkier to use <code>\\n\\t</code>, but when you use gcc's <code>-S</code> to output the assembler (a great way to see what's really going on), your code will be a mess without \\n\\t.</p>\n\n<p>So far, that gets us:</p>\n\n<pre><code>asm volatile(\n\".intel_syntax noprefix\\n\\t\"\n\n// %1 is read-only, so use eax as temp\n\"mov eax,%1\\n\\t\"\n\n// # of words found\n\"xor edx,edx\\n\\t\"\n\n\"jmp petla\\n\"\n\n// Skip over spaces\n\"petla0:\\n\\t\"\n\"inc eax\\n\"\n\n\"petla:\\n\\t\"\n\"cmp [eax],byte ptr 0\\n\\t\"\n\"jz wyjscie\\n\\t\" // End of string\n\"cmp [eax],byte ptr 32\\n\\t\"\n\"jz petla0\\n\\t\" // Another space\n\n// Starting new word\n\"inc edx\\n\"\n\n// Walk the rest of the current word\n\"petla1:\\n\\t\"\n\"inc eax\\n\\t\"\n\n\"cmp [eax],byte ptr 0\\n\\t\"\n\"jz wyjscie\\n\\t\" // End of string\n\"cmp [eax],byte ptr 32\\n\\t\"\n\"jz petla\\n\\t\" // End of word\n\"jmp petla1\\n\" // Not end of word\n\n\"wyjscie:\\n\\t\"\n\"mov %0,edx\\n\\t\"    \n\n\".att_syntax prefix\"\n: \"=r\" (x)\n: \"r\" (s)\n: \"eax\",\"edx\"\n);\n</code></pre>\n\n<p>Third, you need to understand that when using extended asm, <code>%0</code> is just a way to refer to whatever is being passed in as the first argument.  In this case, you specify that it must be a register (<code>\"=r\"</code>).  So the value is <em>already</em> a register.  Instead of using both edx and %0, you can store the count directly in %0.</p>\n\n<p>Fourth, the purpose of <code>byte ptr</code> is so the assembler knows whether <code>[eax]</code> means: The byte at [eax], the word as [eax], the dword at [eax], etc.  Such being the case, it is more commonly placed on the other side of a <code>cmp</code> instruction:</p>\n\n<pre><code>asm volatile(\n\".intel_syntax noprefix\\n\\t\"\n\n// %1 is read-only, so use eax as temp\n\"mov eax,%1\\n\\t\"\n\n// # of words found\n\"xor %0,%0\\n\\t\"\n\n\"jmp petla\\n\"\n\n// Skip over spaces\n\"petla0:\\n\\t\"\n\"inc eax\\n\"\n\n\"petla:\\n\\t\"\n\"cmp byte ptr [eax], 0\\n\\t\"\n\"jz wyjscie\\n\\t\" // End of string\n\"cmp byte ptr [eax], ' '\\n\\t\"\n\"jz petla0\\n\\t\" // Another space\n\n// Starting new word\n\"inc %0\\n\"\n\n// Walk the rest of the current word\n\"petla1:\\n\\t\"\n\"inc eax\\n\\t\"\n\n\"cmp byte ptr [eax], 0\\n\\t\"\n\"jz wyjscie\\n\\t\" // End of string\n\"cmp byte ptr [eax], ' '\\n\\t\"\n\"jz petla\\n\\t\" // End of word\n\"jmp petla1\\n\" // Not end of word\n\n\"wyjscie:\\n\\t\"\n\n\".att_syntax prefix\"\n: \"=r\" (x)\n: \"r\" (s)\n: \"eax\",\"edx\"\n);\n</code></pre>\n\n<p>What's next?  Oh yeah.  When you use jz or jnz, if it doesn't jump, the code falls thru to the next instruction.  This means that this:</p>\n\n<pre><code>\"cmp byte ptr [eax], 0\\n\\t\"\n\"jz wyjscie\\n\\t\" // End of string\n\"cmp byte ptr [eax], ' '\\n\\t\"\n\"jz petla\\n\\t\" // End of word\n\"jmp petla1\\n\" // Not end of word\n\n\"wyjscie:\\n\\t\"\n</code></pre>\n\n<p>Can be done like this:</p>\n\n<pre><code>\"cmp byte ptr [eax], 0\\n\\t\"\n\"jz petla\\n\\t\" // End of word\n\"cmp byte ptr [eax], ' '\\n\\t\"\n\"jnz petla1\\n\\t\" // Not end of string\n\n\"wyjscie:\\n\\t\"\n</code></pre>\n\n<p>As a general rule, I avoid doing memory reads multiple times.  So where you do:</p>\n\n<pre><code>\"cmp byte ptr [eax], 0\\n\\t\"\n\"cmp byte ptr [eax], ' '\\n\\t\"\n</code></pre>\n\n<p>I would do:</p>\n\n<pre><code>\"mov dl, [eax]\\n\\t\"\n\"cmp dl, 0\\n\\t\"\n\"cmp dl, ' '\\n\\t\"\n</code></pre>\n\n<p>This also lets us get rid of the <code>byte ptr</code>.  dl can only hold a byte, so that must be what we are reading.</p>\n\n<p>Another subtle point: In your original code, when you are walking the letters, if you encounter a space, you jump back to petla, where you check <em>again</em> to see if it is a space instead of to petla0 to read the next byte.</p>\n\n<p>And 2 other nits: When comparing something with zero, I use <code>test</code> instead of <code>cmp</code> (generates <em>slightly</em> better code).  And while it does <em>exactly</em> the same thing, when I compare 2 values (<code>cmp edx, ' '</code>), I find it easier to think in terms of \"Are these things 'equal'\" rather than \"Is the difference between them zero?\"  As a result, I would use <code>je</code> instead of <code>jz</code>.</p>\n\n<p>Putting all this together gives me:</p>\n\n<pre><code>asm (\n\".intel_syntax noprefix\\n\\t\"\n\n// %1 is read-only, so use eax as temp\n\"mov eax, %1\\n\\t\"\n\n// # of words found\n\"xor %0,%0\\n\"\n\n// Skip over spaces\n\"petla0:\\n\\t\"\n\"mov dl, [eax]\\n\\t\"\n\"inc eax\\n\\t\"\n\n\"test dl, dl\\n\\t\"\n\"jz wyjscie\\n\\t\" // End of string\n\"cmp dl, ' '\\n\\t\"\n\"je petla0\\n\\t\" // Another space\n\n// Starting new word\n\"inc %0\\n\"\n\n// Walk the rest of the current word\n\"petla1:\\n\\t\"\n\"mov dl, [eax]\\n\\t\"\n\"inc eax\\n\\t\"\n\n\"cmp dl, ' '\\n\\t\"\n\"je petla0\\n\\t\" // end of word\n\"test dl, dl\\n\\t\"\n\"jnz petla1\\n\" // not end of string\n\n\"wyjscie:\\n\"\n\n\".att_syntax prefix;\"\n: \"=r\" (x)\n: \"r\" (s)\n: \"eax\", \"edx\", \"cc\", \"memory\"\n);\n</code></pre>\n\n<p>I also removed the <code>volatile</code>.  Since you are using the output (by printing <code>x</code>), this is not required.</p>\n\n<p>I will let you roll any of this that you want to keep into your pure asm by yourself.</p>\n\n<p>As for why your pure asm doesn't work, I'm not on linux, so I can't run this.  However, I don't see anything actually wrong with your counting code.  You might look at <a href=\"https://stackoverflow.com/a/12753230/2189500\">this</a> for accessing the command line arguments, but what you are doing should not give you 1.</p>\n\n<p>How are you specifying your command line?  I suspect you are not using the <code>\"</code> marks around your string: <code>a.out \" aqr  b qabxx xryc pqr\"</code>.  This would cause each word to be treated as a separate (null terminated) argument.</p>\n\n<hr>\n\n<p>Edit 1:  After some more <a href=\"http://www.dreamincode.net/forums/topic/285550-nasm-linux-getting-command-line-parameters/\" rel=\"nofollow noreferrer\">reading</a>, it looks like the pointer to argv[1] really should be at [esp + 8].  At least on linux.  You aren't on Windows, right?  Pretty sure it uses a different scheme.</p>\n\n<p>You can try this to make sure your asm is working correctly, but I'm pretty sure that isn't your problem.</p>\n\n<pre><code>lea ecx, str\n\n// Down by .data add:\nstr:    .ascii \" asdf adfs asd f adsf \"\n</code></pre>\n\n<ul>\n<li>You can try using the <code>msg</code> format string you have to print argc.  If you are passing the arguments correctly, this should be 2.</li>\n<li>Change your <code>msg</code> to use %s, and print out the value from argv[0] (aka [esp+4]).  This should be the program name.</li>\n<li>Using that %s, you can print out argv[1].</li>\n</ul>\n"}], "owner": {"reputation": 15, "user_id": 7437330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/458ce6f16817af59e2604a048a7b4116?s=128&d=identicon&r=PG&f=1", "display_name": "RealityArchitect", "link": "https://stackoverflow.com/users/7437330/realityarchitect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 41732028, "answer_count": 1, "score": 0, "last_activity_date": 1485025256, "creation_date": 1484765806, "last_edit_date": 1485025256, "question_id": 41727300, "link": "https://stackoverflow.com/questions/41727300/get-argument-from-command-line-in-inline-assembly", "title": "Get argument from command line in inline assembly", "body": "<p>I have to count the number of words in a string that you get as an argument from the command line.\nFirst I made this program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main( int argc, char *argv[] ){\nchar* s;\nif(argc==1)\n{\n    s=\"\";\n} else {\n    s = argv[1];\n}\n//char* s = \" aqr  b qabxx xryc pqr\"; example\n\nint x;\nasm volatile(\n\".intel_syntax noprefix;\"\n\n\"mov eax,%1;\"\n\"xor edx,edx;\"\n\"jmp petla;\"\n\n\"petla0:\"\n\"inc eax;\"\n\n\"petla:\"\n\"cmp [eax],byte ptr 0;\"\n\"jz wyjscie;\"\n\"cmp [eax],byte ptr 32;\"\n\"jz petla0;\"\n\n\"inc edx;\"\n\n\"petla1:\"\n\"inc eax;\"\n\"cmp [eax],byte ptr 0;\"\n\"jz wyjscie;\"\n\"cmp [eax],byte ptr 32;\"\n\"jz petla;\"\n\"jmp petla1;\"\n\n\"wyjscie:\"\n\"mov %0,edx;\"\n\n\".att_syntax prefix;\"\n: \"=r\" (x)\n: \"r\" (s)\n: \"eax\",\"edx\"\n);\nprintf(\"%hd\\n\",x);\nreturn 0;\n}\n</code></pre>\n\n<p>and it works fine; I get <code>5</code> as answer for \"aqr  b qabxx xryc pqr\". But I need my program written only using assembly code. Something like this:</p>\n\n<pre><code>.intel_syntax noprefix\n    .globl main\n    .text\n\n\nmain:\n\nmov ecx,?\n</code></pre>\n\n<p>?&lt;- here is the issue: I don't know how to get an argument from the command line and access it as a <code>char *</code>.</p>\n\n<pre><code>xor edx,edx\n\njmp petla\n\npetla0:\ninc ecx\n\npetla:\ncmp byte ptr [ecx],0\njz wyjscie\ncmp byte ptr [ecx],32\njz petla0\n\n\ninc edx\n\npetla1:\ninc ecx\n\ncmp byte ptr [ecx],0\njz wyjscie\ncmp byte ptr [ecx], 32\njz petla\njmp petla1\n\nwyjscie:\n\npush edx\npush offset msg\ncall printf\nadd esp, 8\nmov edx,0\nret\n\n\n.data\nmsg:    .ascii \"number of words=%d\\n\"\n</code></pre>\n"}, {"tags": ["c", "operand"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1484765843, "post_id": 41727282, "comment_id": 70649072, "body": "Try a simpler program first. As you build it up step by step, you&#39;ll either discover your error or a better question."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1484765927, "post_id": 41727282, "comment_id": 70649106, "body": "<code>d.year % 100 = 0</code> should be <code>d.year % 100 == 0</code>"}, {"owner": {"reputation": 9, "user_id": 7437378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce6796a925b7e54e34d1b32d68d71a0?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Burka", "link": "https://stackoverflow.com/users/7437378/m%c3%a1rk-burka"}, "edited": false, "score": 0, "creation_date": 1484767462, "post_id": 41727282, "comment_id": 70649985, "body": "Kerrek: I done it that way. This is the 9th chapter in the book. Lashane: Thanks! Sadly the error still occurs."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7437378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce6796a925b7e54e34d1b32d68d71a0?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Burka", "link": "https://stackoverflow.com/users/7437378/m%c3%a1rk-burka"}, "edited": false, "score": 0, "creation_date": 1484767599, "post_id": 41727407, "comment_id": 70650047, "body": "Thank you. Yes those were typos. Sadly the error still occurs."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 9, "user_id": 7437378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce6796a925b7e54e34d1b32d68d71a0?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Burka", "link": "https://stackoverflow.com/users/7437378/m%c3%a1rk-burka"}, "edited": false, "score": 0, "creation_date": 1484768321, "post_id": 41727407, "comment_id": 70650445, "body": "@M&#225;rkBurka I do not see any other compilation error."}, {"owner": {"reputation": 9, "user_id": 7437378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce6796a925b7e54e34d1b32d68d71a0?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Burka", "link": "https://stackoverflow.com/users/7437378/m%c3%a1rk-burka"}, "edited": false, "score": 0, "creation_date": 1484848786, "post_id": 41727407, "comment_id": 70689702, "body": "Yeah. Well, thanks anyway!"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1484766657, "last_edit_date": 1484766657, "creation_date": 1484766147, "answer_id": 41727407, "question_id": 41727282, "link": "https://stackoverflow.com/questions/41727282/c2106-left-operand-must-be-l-value/41727407#41727407", "title": "C2106: &#39;=&#39; : left operand must be l-value", "body": "<p>Here is a typo</p>\n\n<pre><code>if ( (d.year % 4 == 0 &amp;&amp; d.year % 100 = 0) || d.year % 400 == 00) \n                                    ^^^^\n</code></pre>\n\n<p>I think you mean</p>\n\n<pre><code>if ( (d.year % 4 == 0 &amp;&amp; d.year % 100 != 0) || d.year % 400 == 00) \n                                     ^^^^\n</code></pre>\n\n<p>And 00 is equivalent to 0.:)</p>\n\n<p>The function can be written simpler</p>\n\n<pre><code>bool isLeapYear( struct date d )\n{\n    return ( d.year % 4 == 0 &amp;&amp; d.year % 100 != 0 ) || ( d.year % 400 == 0 );\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7437378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce6796a925b7e54e34d1b32d68d71a0?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Burka", "link": "https://stackoverflow.com/users/7437378/m%c3%a1rk-burka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "closed_date": 1484783666, "answer_count": 1, "score": -3, "last_activity_date": 1484766657, "creation_date": 1484765727, "question_id": 41727282, "link": "https://stackoverflow.com/questions/41727282/c2106-left-operand-must-be-l-value", "closed_reason": "Not suitable for this site", "title": "C2106: &#39;=&#39; : left operand must be l-value", "body": "<p>So, I'm learning C as my first language and as doing some coding for practise I got the error above. I done everything as the book says (Stephen G. Kochan: Programming in C, Third Edition).\nWhat am I doing wrong?\nI'm using Microsoft Visual Studio 2015.</p>\n\n<p>Thanks for your help!\nMark</p>\n\n<pre><code>struct date\n{\nint month;\nint day;\nint year;\n};\n\nint main(void)\n{\n    struct date today, tomorrow;\n    int numberOfDays(struct date d);\n\n    printf(\"Adja meg a mai datumot (hh nn eeee): \");\n    scanf_s(\"%i%i%i\", &amp;today.month, &amp;today.day, &amp;today.year);\n\n    if (today.day != numberOfDays(today))\n    {\n        tomorrow.day = today.day + 1;\n        tomorrow.month = today.month;\n        tomorrow.year = today.year;\n    }\n    else if (today.month == 12)\n    {\n        tomorrow.day = 1;\n        tomorrow.month = 1;\n        tomorrow.year = today.year + 1;\n    }\n    else\n    {\n        tomorrow.day = 1;\n        tomorrow.month = today.month + 1;\n        tomorrow.year = today.year;\n    }\n    printf(\"A holnapi datum: %i/%i/%.2i.\\n\", tomorrow.month, tomorrow.day, tomorrow.year % 100);\n\n    return 0;\n}\n\nint numberOfDays(struct date d)\n{\n    int days;\n    bool isLeapYear(struct date d);\n    const int daysPerMonth[12] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };\n\n    if (isLeapYear(d) == true &amp;&amp; d.month == 2)\n        days = 29;\n    else\n        days = daysPerMonth[d.month - 1];\n\n    return days;\n}\n\nbool isLeapYear(struct date d)\n{\n    bool leapYearFlag;\n\n    if ( (d.year % 4 == 0 &amp;&amp; d.year % 100 = 0) || d.year % 400 == 00) //The error shows up here\n        leapYearFlag = true;\n    else\n        leapYearFlag = false;\n\n    return leapYearFlag;\n}\n</code></pre>\n"}, {"tags": ["c", "raspberry-pi2", "i2c", "wiringpi"], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 7892036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a690f2ecf473002d7cdbc5fa1131e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Rangel Flavio", "link": "https://stackoverflow.com/users/7892036/rangel-flavio"}, "is_accepted": true, "score": 0, "last_activity_date": 1511811958, "last_edit_date": 1511811958, "creation_date": 1511810967, "answer_id": 47518430, "question_id": 41727205, "link": "https://stackoverflow.com/questions/41727205/wiringpi-library-of-raspberry-pi-2-to-rotate-bidirectional-dc-servo-motor/47518430#47518430", "title": "wiringPi library of Raspberry Pi 2 to rotate bidirectional DC servo motor", "body": "<p>You must use signed value in last 2 bytes of data:</p>\n\n<p><strong>To spin backwards:</strong></p>\n\n<pre><code>...\n\nI2C_Write(1); // send the command variable for speed\n\nI2C_Write(1); // send LSB of 1 \n\nI2C_Write(255);// send MSB of 255 to and so Speed of backward 255 \n\n...\n</code></pre>\n\n<p><strong>To spin forwards:</strong></p>\n\n<pre><code>...\n\nI2C_Write(1);// send the command variable for speed  \nI2C_Write(255);// send LSB of 255  \nI2C_Write(0);// send MSB of 0 to and so Speed of forward 255\n\n...\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7254101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b2649d15b7a3039765b1641a23b069b?s=128&d=identicon&r=PG&f=1", "display_name": "user7254101", "link": "https://stackoverflow.com/users/7254101/user7254101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 47518430, "answer_count": 1, "score": 1, "last_activity_date": 1511811958, "creation_date": 1484765403, "question_id": 41727205, "link": "https://stackoverflow.com/questions/41727205/wiringpi-library-of-raspberry-pi-2-to-rotate-bidirectional-dc-servo-motor", "title": "wiringPi library of Raspberry Pi 2 to rotate bidirectional DC servo motor", "body": "<p>I am trying to spin the motor (RMCS-220X High-Torque Encoder DC Servo Motor and Driver) using Raspberry pi 2's i2c interface with the following code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;wiringPi.h&gt;\n#include &lt;wiringPiI2C.h&gt;\n#define Motoraddrs 0x08 //motor address\n\nint main(void){\nint I2C_fd;\n\nwiringPiSetupGpio();\nwiringPiSetup(); \n\nI2C_fd = wiringPiI2CSetup(Motoraddrs);\n\nwiringPiI2CWriteReg16(I2C_fd, 0x01, 0xff);//spins from low speed of 0x01 to\n                                            max 0xff in right side\ndelay(100);\n\nreturn 0; \n}\n</code></pre>\n\n<p>The bytes written in function wiringPiI2CWriteReg16 are as of the following code below which are given in Datasheet of the motor.</p>\n\n<p>/*Here is an example usage of updating the speed variable on the RMCS-220x to forward 255 */</p>\n\n<pre><code>I2C_Start(0x10 + 0); // send the slave address of the RMCS-220x and write   \n                        bit 0                \nI2C_Write(1); // send the command variable for speed\nI2C_Write(255); // send LSB of 255\nI2C_Write(0); // send MSB of 0 to and so Speed of forward 255\nI2C_Stop(); // send I2C stop\n</code></pre>\n\n<p>/*Here is an example usage of updating the speed variable on the RMCS-220x to reverse 255 and reading it back */</p>\n\n<pre><code>I2C_Start(0x10 + 0); // send the slave address of the RMCS-220x and \n                       write bit 0\nI2C_Write(1); // send the command variable for speed\nI2C_Write(1); // send LSB of 1\nI2C_Write(255); // send MSB of 255 to and so Speed of backward 255\nI2C_Rep_Start(0x10 + 1); // send I2C address with rep start and 1 to read\nspeed = I2C_Read_Ack(); // read speed LSB byte and ack\nspeed = I2C_Read_Nak(); // read speed MSB byte and don\u2019t ack\nI2C_Stop(); // send I2C stop\n</code></pre>\n\n<p>In my case with the code above using wiringPi library, allowing me to rotate the motor only in one (right) direction. Now I want to rotate it in left direction as well. </p>\n\n<p>Would really appreciate your suggestions. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 605, "user_id": 7407065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29c5df2bfbde7cf5795faf3a36e2311?s=128&d=identicon&r=PG&f=1", "display_name": "16tons", "link": "https://stackoverflow.com/users/7407065/16tons"}, "edited": false, "score": 1, "creation_date": 1484765435, "post_id": 41727173, "comment_id": 70648849, "body": "<code>a[3]=&#39; &#39;;</code> in your code is problamatic. Use <code>a[0]</code> and make <code>a[1]</code> as NULL"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1484765602, "post_id": 41727173, "comment_id": 70648944, "body": "Turn on compiler warnings (usually by adding <code>-Wall</code>). They will catch things like the <code>a[3] = &#39; &#39;</code> problem."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 7435656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7xG6.jpg?s=128&g=1", "display_name": "Abhijeet Singh", "link": "https://stackoverflow.com/users/7435656/abhijeet-singh"}, "edited": false, "score": 0, "creation_date": 1484766262, "post_id": 41727291, "comment_id": 70649257, "body": "Thank you very much. I understood how to solve the issue."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1484767529, "post_id": 41727291, "comment_id": 70650023, "body": "There&#39;s no need for <code>a</code>, <code>strcat(name[i], &quot; &quot;)</code> works fine. Note that <code>scanf</code> and <code>strcat</code> still contain the potential for buffer overflow. <a href=\"http://stackoverflow.com/a/41727793/14660\">See my answer</a>."}], "tags": [], "owner": {"reputation": 605, "user_id": 7407065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29c5df2bfbde7cf5795faf3a36e2311?s=128&d=identicon&r=PG&f=1", "display_name": "16tons", "link": "https://stackoverflow.com/users/7407065/16tons"}, "is_accepted": false, "score": 0, "last_activity_date": 1484765763, "creation_date": 1484765763, "answer_id": 41727291, "question_id": 41727173, "link": "https://stackoverflow.com/questions/41727173/scan-and-print-full-names-in-a-list-c-language/41727291#41727291", "title": "Scan and print full names in a list (C language)", "body": "<p>As mentioned in the comment, use <code>a[0]</code> as space and make <code>a[1]</code> null. Code below works.</p>\n\n<pre><code>int main()\n{\n    int n,i;\n    char name[64][64],sur[15][15],a[3];\n\n    printf(\"How many names? \");\n    scanf(\"%d\",&amp;n);\n    printf(\"\\nEnter names:\\n\");\n\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%s%s\",name[i],sur[i]);\n    }\n\n    for(i=0;i&lt;n;i++)\n    {\n        a[0]=' ';\n        a[1]='\\0';\n        strcat(name[i],a);\n        strcat(name[i],sur[i]);\n    }\n\n    printf(\"\\nThe names are:\\n\");\n    for(i=0;i&lt;n;i++)\n    {\n        printf(\"%s\\n\",name[i]);\n    }\n    getch();\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 462, "user_id": 7435656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7xG6.jpg?s=128&g=1", "display_name": "Abhijeet Singh", "link": "https://stackoverflow.com/users/7435656/abhijeet-singh"}, "edited": false, "score": 1, "creation_date": 1484767810, "post_id": 41727793, "comment_id": 70650150, "body": "You&#39;re right, I didn&#39;t consider the memory management. Thank you for your advice. I&#39;ll edit the program accordingly."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 1, "last_activity_date": 1484768167, "last_edit_date": 1495540916, "creation_date": 1484767479, "answer_id": 41727793, "question_id": 41727173, "link": "https://stackoverflow.com/questions/41727173/scan-and-print-full-names-in-a-list-c-language/41727793#41727793", "title": "Scan and print full names in a list (C language)", "body": "<p><a href=\"https://stackoverflow.com/a/41727291/14660\">@16tons addresses the most obvious issue</a>, but there are lurking memory problems. The <code>scanf</code> and <code>strcat</code> calls are vulnerable to <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\" rel=\"nofollow noreferrer\">buffer overflows</a>. They will not limit themselves to just the allocated memory.</p>\n\n<pre><code>for(i=0;i&lt;n;i++)\n{\n    scanf(\"%s%s\",name[i],sur[i]);\n}\n</code></pre>\n\n<p>This will try to put any number of input characters into <code>name[i]</code> and <code>sur[i]</code> which can only hold strings of 63 and 14 characters respectively. That means <a href=\"https://en.wikipedia.org/wiki/Hubert_Blaine_Wolfeschlegelsteinhausenbergerdorff,_Sr.\" rel=\"nofollow noreferrer\">Hubert Wolfe\u00adschlegel\u00adstein\u00adhausen\u00adberger\u00addorff</a> will cause <code>name[i]</code> to contain <code>\"Hubert\\0\"</code> and <code>sur[i]</code> will contain <code>\"Wolfe\u00adschlegel\u00adst\"</code> (no null byte) and the rest will spill over into adjacent memory causing problems. Because of the lack of a null byte, trying to use <code>sur[i]</code> as a string will result in reading whatever garbage is after it.</p>\n\n<p>Same with <code>strcat</code>.</p>\n\n<pre><code>for(i=0;i&lt;n;i++)\n{\n    a[0]=' ';\n    a[1]='\\0';\n    strcat(name[i],a);\n    strcat(name[i],sur[i]);\n}\n</code></pre>\n\n<p>If <code>name[i]</code> is already full, adding to the end of it will overflow its buffer scribbling over adjacent memory and causing weird problems.</p>\n\n<pre><code>How many names? 3\n\nEnter names:\nHubert Wolfeschlegelsteinhausenbergerdorff\nHubert Wolfeschlegelsteinhausenbergerdorff\nHubert Wolfeschlegelsteinhausenbergerdorff\n\nThe names are:\nHubert WolfeschlegelstWolfeschlegelstWolfeschlegelsteinhausenbergerdorff WolfeschlegelstWolfeschlegelsteinhausenbergerdorff\ngerdorff WolfeschlegelstWolfeschlegelsteinhausenbergerdorff\nHubert Wolfeschlegelsteinhausenbergerdorff\n</code></pre>\n\n<hr>\n\n<p>To avoid this, <code>scanf</code> must be limited to the buffer size. When using <code>strcat</code>, the string being added to must have sufficient space to accept the new characters.</p>\n\n<p>Since you're using <code>name[i]</code> to store both the first name and then the full name, it's important that you limit the size of the first name to leave space for the last time. Since <code>sur[i]</code> can have 14 characters, and <code>name[i]</code> can have 63, that's 63 - 14 or 49. Don't forget the space! 48.</p>\n\n<pre><code>for(i=0;i&lt;n;i++)\n{\n    scanf(\"%48s%14s\",name[i],sur[i]);\n}\n</code></pre>\n\n<p>This ensures that <code>scanf</code> will read no more than 48 characters into <code>name[i]</code> (using 49 bytes because of the null byte) and no more than 14 into <code>sur[i]</code> (using 15).</p>\n\n<p>Now your <code>strcat</code>s are safe. We know for sure <code>name[i]</code> has the space to accept a space and <code>sur[i]</code> on the end. 48 (max chars already in <code>name[i]</code>) + 1 (the space) + 14 (max in <code>sur[i]</code>) + 1 (null byte) = 64.</p>\n\n<p>While your technique saves some memory, it's <strong><em>much</em></strong> safer to have separate <code>given</code> and <code>surname</code> variables which are concatenated into a fresh <code>name</code> variable. Then all you need to do is add up the sizes of <code>given</code>, <code>surname</code>, and the space to know how big <code>name</code> should be. The limits on <code>scanf</code> are simply the size of the buffers. No needing to remember that one variable has to keep some extra space around, nor having to redo all those calculations (or more likely forget to redo them) if <code>surname</code> gets bigger.</p>\n\n<p>For your particular purposes, the <code>strcat</code>s are unnecessary. <code>printf</code> can do it safer.</p>\n\n<pre><code>printf(\"\\nThe names are:\\n\");\nfor(i=0;i&lt;n;i++)\n{\n    printf(\"%s %s\\n\",name[i], sur[i]);\n}\n</code></pre>\n\n<p>It's safer, easier, and faster to print a bunch of variables to a stream than to concatenate them together and then print them.</p>\n"}], "owner": {"reputation": 462, "user_id": 7435656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7xG6.jpg?s=128&g=1", "display_name": "Abhijeet Singh", "link": "https://stackoverflow.com/users/7435656/abhijeet-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5985, "favorite_count": 0, "accepted_answer_id": 41727793, "answer_count": 2, "score": -1, "last_activity_date": 1484768167, "creation_date": 1484765279, "last_edit_date": 1484765872, "question_id": 41727173, "link": "https://stackoverflow.com/questions/41727173/scan-and-print-full-names-in-a-list-c-language", "title": "Scan and print full names in a list (C language)", "body": "<p>I want to create a C program that can read 'n' number of full names from keyboard input and print them. I tried to use <code>fgets()</code>, but couldn't figure out how to scan multiple entries, so I ended up writing the code below. </p>\n\n<p>The issue is, it takes the names as input and just prints garbage values.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    int n,i;\n    char name[64][64],sur[15][15],a[3];\n\n    printf(\"How many names? \");\n    scanf(\"%d\",&amp;n);\n    printf(\"\\nEnter names:\\n\");\n\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%s%s\",name[i],sur[i]);\n    }\n\n    for(i=0;i&lt;n;i++)\n    {\n        a[3]=' ';\n        strcat(name[i],a);\n        strcat(name[i],sur[i]);\n    }\n\n    printf(\"\\nThe names are:\\n\");\n    for(i=0;i&lt;n;i++)\n    {\n        printf(\"%s\",name[i]);\n    }\n    getch();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "realloc"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484770468, "post_id": 41727062, "comment_id": 70651658, "body": "Don&#39;t ever do <code>x = realloc(x, ...);</code>"}, {"owner": {"reputation": 29, "user_id": 7153148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/meeNw.jpg?s=128&g=1", "display_name": "Mr PC", "link": "https://stackoverflow.com/users/7153148/mr-pc"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484813663, "post_id": 41727062, "comment_id": 70666955, "body": "why? We were encouraged to use it... @0andriy"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484817840, "post_id": 41727062, "comment_id": 70669352, "body": "Just give a thought about it. It is easy to fix. Your code contains a serious bug right now."}], "answers": [{"tags": [], "owner": {"reputation": 13359, "user_id": 489590, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e16b3d117fa188c4dbdafb8dc27a4df0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Cain", "link": "https://stackoverflow.com/users/489590/brian-cain"}, "is_accepted": false, "score": 0, "last_activity_date": 1484765698, "creation_date": 1484765698, "answer_id": 41727272, "question_id": 41727062, "link": "https://stackoverflow.com/questions/41727062/realloc-dynamic-memory-allocation/41727272#41727272", "title": "realloc, dynamic memory allocation", "body": "<p>The fault happens on the <code>scanf()</code>.</p>\n\n<pre><code>$ echo 4 | ./a.out \nASAN:DEADLYSIGNAL\n=================================================================\n==3684==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f37ae1007fe bp 0x7fffb3148b60 sp 0x7fffb3148480 T0)\n==3684==The signal is caused by a WRITE memory access.\n==3684==Hint: address points to the zero page.\n    #0 0x7f37ae1007fd in _IO_vfscanf (/lib/x86_64-linux-gnu/libc.so.6+0x5c7fd)\n    #1 0x7f37ae10f72f in __isoc99_vscanf (/lib/x86_64-linux-gnu/libc.so.6+0x6b72f)\n    #2 0x433206 in __interceptor___isoc99_vscanf /home/development/llvm/3.9.0/final/llvm.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1187:1\n    #3 0x433206 in __interceptor___isoc99_scanf /home/development/llvm/3.9.0/final/llvm.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1208\n    #4 0x4e4954 in main /home/brian/tmp/collatz/coll.c:15:5\n    #5 0x7f37ae0c482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #6 0x418dc8 in _start (/home/brian/tmp/collatz/a.out+0x418dc8)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV (/lib/x86_64-linux-gnu/libc.so.6+0x5c7fd) in _IO_vfscanf\n==3684==ABORTING\n</code></pre>\n\n<p>In addition, I got warnings when trying to compile, these look like they can help identify the problem:</p>\n\n<pre><code>$ clang -fsanitize=address -g coll.c \ncoll.c:15:18: warning: format specifies type 'unsigned long *' but the argument has type 'unsigned long' [-Wformat]\n    scanf(\"%lu\", input);\n           ~~~   ^~~~~\ncoll.c:47:15: warning: incompatible pointer types assigning to 'int *' from 'long *' [-Wincompatible-pointer-types]\n        for (i=n;*i!=input;i--)\n              ^~\ncoll.c:49:28: warning: format specifies type 'unsigned long' but the argument has type 'int' [-Wformat]\n            printf(\"%lu\\t\",*i);\n                    ~~~    ^~\n                    %d\n3 warnings generated.\n</code></pre>\n\n<p>After fixing <code>scanf()</code> I can still see a runtime fault occurring on the <code>*u=*n</code> line.  You should fire up a debugger in order to see this problem.</p>\n"}], "owner": {"reputation": 29, "user_id": 7153148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/meeNw.jpg?s=128&g=1", "display_name": "Mr PC", "link": "https://stackoverflow.com/users/7153148/mr-pc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484765698, "creation_date": 1484764887, "question_id": 41727062, "link": "https://stackoverflow.com/questions/41727062/realloc-dynamic-memory-allocation", "title": "realloc, dynamic memory allocation", "body": "<p>i have the tast to take one random natural number and print out the collatz conjecture from the last number to the input. The steps to the collatz conjecture are:\n(a) Start with any positive integer N.\n(b) If N is odd, multiply it by 3 and add 1. (i.e. N \u2190 3N + 1)\n(c) If N is even, divide it by 2. (i.e. N \u2190 N/2)\n(d) Repeat.\nand it always ends in 4 ->2->1->4->2->1...\nMy Computer tells me that (projectname).exe stopped working after entering the integer.</p>\n\n<p>The most important point is probably that we should allocate space for the conjecture and double it if it is used completely.</p>\n\n<p>My Code is:</p>\n\n<pre><code>int main()\n{\nunsigned long int input =0;\nint max =16;\nlong int *collatz;\ncollatz = malloc(max*sizeof(long int));\nlong int *n = NULL;\nlong int *u = NULL;\nint counter=0;\n\nprintf(\"Please enter a natural number:\");\nscanf(\"%lu\", input);\nprintf(\"%lu\\n\",input);\nif (input &lt;1)\n{\n    printf (\"ERROR, not a natural number\");\n    return 1;\n}\n\nn = collatz;\n*n = input;\n\nwhile (*n!=1)\n{\n    if (counter == max)\n    {\n        max = max*2;\n        collatz = realloc (collatz,max*sizeof(long int));\n    }\n\n    if ((*n)%2 == 1)\n    {\n        *n=(3*(*n))+1;\n    }\n    else if ((*n)%2 == 0)\n    {\n        *n=(*n)/2;\n    }\n    *u=*n;\n    n=n+1;\n    *n=*u;\n    counter++;\n    int *i =0;\n    for (i=n;*i!=input;i--)\n    {\n        printf(\"%lu\\t\",*i);\n    }\n}\nreturn 0;\n}\n</code></pre>\n\n<p>I suppose I got the realloc wrong, most of the other stuff is no big mistery for me (that doesn't mean there are no errors, thereprobably are).</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["c", "arrays", "constants", "sizeof"], "comments": [{"owner": {"reputation": 51, "user_id": 7437254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e402d23e9e8c607b70fbf2d9bca77f7?s=128&d=identicon&r=PG&f=1", "display_name": "ManofManyTigers", "link": "https://stackoverflow.com/users/7437254/manofmanytigers"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484768056, "post_id": 41727050, "comment_id": 70650289, "body": "Maybe it is the compiler I am using; it should display all elements of the array but all that happens when I attempt to run it is it runs and ends with no printed output."}, {"owner": {"reputation": 51, "user_id": 7437254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e402d23e9e8c607b70fbf2d9bca77f7?s=128&d=identicon&r=PG&f=1", "display_name": "ManofManyTigers", "link": "https://stackoverflow.com/users/7437254/manofmanytigers"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484769442, "post_id": 41727050, "comment_id": 70651080, "body": "okay; I copied the code into ideone.com into the C compiler/executor and it comes up as well with no output. However when I change the code as listed in the original description it works as expected; still unsure."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484769465, "post_id": 41727050, "comment_id": 70651092, "body": "I am getting the same result... No output. The only way to have expected output is to assign <code>int dmax = (TOTAL_ELEMENTS-2);</code> and change the loop to <code>for(d=-1;d &lt;= dmax;d++)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484769943, "post_id": 41728378, "comment_id": 70651375, "body": "You can force a signed comparison by casting to <code>int</code> in the loop <code>for(d=-1;d &lt;= (int)(TOTAL_ELEMENTS-2);d++)</code>."}, {"owner": {"reputation": 51, "user_id": 7437254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e402d23e9e8c607b70fbf2d9bca77f7?s=128&d=identicon&r=PG&f=1", "display_name": "ManofManyTigers", "link": "https://stackoverflow.com/users/7437254/manofmanytigers"}, "edited": false, "score": 0, "creation_date": 1484770680, "post_id": 41728378, "comment_id": 70651771, "body": "Thank all of you! That was a major help."}], "tags": [], "owner": {"reputation": 563, "user_id": 1622041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WN5H2.jpg?s=128&g=1", "display_name": "HamidReza", "link": "https://stackoverflow.com/users/1622041/hamidreza"}, "is_accepted": true, "score": 1, "last_activity_date": 1484771004, "last_edit_date": 1484771004, "creation_date": 1484769516, "answer_id": 41728378, "question_id": 41727050, "link": "https://stackoverflow.com/questions/41727050/c-program-about-sizeof-and-constant-used-together/41728378#41728378", "title": "C Program - About Sizeof and Constant Used Together", "body": "<p>This issue is not related to <code>sizeof</code>. this is because of the comparing signed with unsigned value. In your code , <code>(TOTAL_ELEMENTS-2)</code> has an unsigned value , but <code>d</code> is a signed variable. therefore , <code>for</code> condition will compare 5 with 0xFFFFFFFF and 5 is less than 0xFFFFFFFF then it is false always!\nFor example :</p>\n\n<pre><code>int main()\n{\n    int d;\n    unsigned int e = 5;\n    for (d = -1; d &lt;= e; d++)\n        printf(\"%d\\n\", array[d + 1]);\n\n    return 0;\n}\n</code></pre>\n\n<p>It do not print any things! , same as your code.</p>\n"}], "owner": {"reputation": 51, "user_id": 7437254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e402d23e9e8c607b70fbf2d9bca77f7?s=128&d=identicon&r=PG&f=1", "display_name": "ManofManyTigers", "link": "https://stackoverflow.com/users/7437254/manofmanytigers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 41728378, "answer_count": 1, "score": 1, "last_activity_date": 1484771004, "creation_date": 1484764860, "last_edit_date": 1484765313, "question_id": 41727050, "link": "https://stackoverflow.com/questions/41727050/c-program-about-sizeof-and-constant-used-together", "title": "C Program - About Sizeof and Constant Used Together", "body": "<p>Below is the code I am having issues with. I understand constants and believe I understand the sizeof function but must be missing something. Here is what I have tried to do to solve on my own:\n- <code>printf</code> statement with TOTAL_ELEMENTS as the <code>%d</code> - it returns 7\n- <code>printf</code> statement of TOTAL_ELEMENTS - 2  - it returns 5 (as expected)\n- substitute 5 in the for loop - loop runs correctly\n- initialize a global int variable of any name and set it equal to <code>(sizeof(array) / sizeof(array[0]))</code>. Then used the variable in the for loop where TOTAL_ELEMENTS would go - again the loop runs correctly.</p>\n\n<p>So (at least in my head), it has to be something involving both the constant and the sizeof function - I'm positive the array/array[0] also plays a part but through testing and substitution I can't figure out what the issue is. I have read up on the sizeof function as well as constants to no avail. I have tried searching but have gotten no where as I'm not fully certain what I'm searching for. I don't necessarily need answers but if someone could point me in the right direction it would be much appreciated. Thank you in advance.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define TOTAL_ELEMENTS (sizeof(array) / sizeof(array[0]))\nint array[] = {23,34,12,17,204,99,16};\n\nint main()\n{\n    int d;\n\n    for(d=-1;d &lt;= (TOTAL_ELEMENTS-2);d++)\n        printf(\"%d\\n\",array[d+1]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "video", "windows-7", "driver", "display"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7335194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3074f600e25bec7c3b6e1ae4eaec4d3?s=128&d=identicon&r=PG&f=1", "display_name": "DD314", "link": "https://stackoverflow.com/users/7335194/dd314"}, "edited": false, "score": 0, "creation_date": 1484764919, "post_id": 41727039, "comment_id": 70648580, "body": "Ok. How would I go through the display driver in kernel mode?"}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 59, "user_id": 7335194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3074f600e25bec7c3b6e1ae4eaec4d3?s=128&d=identicon&r=PG&f=1", "display_name": "DD314", "link": "https://stackoverflow.com/users/7335194/dd314"}, "edited": false, "score": 0, "creation_date": 1484765446, "post_id": 41727039, "comment_id": 70648856, "body": "Use normal windows API from userland, if possible. That&#39;s the way you&#39;d normally handle this: have a daemon in userland running, blocked reading from something that in fact attaches to your kernel driver, and as soon as you have something to display, let that reader know."}, {"owner": {"reputation": 59, "user_id": 7335194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3074f600e25bec7c3b6e1ae4eaec4d3?s=128&d=identicon&r=PG&f=1", "display_name": "DD314", "link": "https://stackoverflow.com/users/7335194/dd314"}, "edited": false, "score": 0, "creation_date": 1484765893, "post_id": 41727039, "comment_id": 70649091, "body": "Normally I would use the Windows API. In fact, I would either use Direct2D, or GDI to do this. However, for simplicity and educational sake, I am going to do my display operations in Kernel mode. This way I don&#39;t have to have a separate project for the userland app, and the code associated with it. It will be just one simply driver that can visually report things to me."}, {"owner": {"reputation": 59, "user_id": 7335194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3074f600e25bec7c3b6e1ae4eaec4d3?s=128&d=identicon&r=PG&f=1", "display_name": "DD314", "link": "https://stackoverflow.com/users/7335194/dd314"}, "edited": false, "score": 0, "creation_date": 1484765947, "post_id": 41727039, "comment_id": 70649116, "body": "So is there some Kernel functions that would allow me to write to the display? Much like the GDI functions in the Win32 API?"}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 59, "user_id": 7335194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3074f600e25bec7c3b6e1ae4eaec4d3?s=128&d=identicon&r=PG&f=1", "display_name": "DD314", "link": "https://stackoverflow.com/users/7335194/dd314"}, "edited": false, "score": 4, "creation_date": 1484765951, "post_id": 41727039, "comment_id": 70649117, "body": "Well, the point is very simple: write a driver that is a driver and not a user interface. That&#39;s not the job of a driver. Putting UI functionality into a driver is a bad idea for many reasons, and you simply shouldn&#39;t do it."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1484772523, "post_id": 41727039, "comment_id": 70652704, "body": "I believe the interface for writing a display driver is documented, so <i>in principle</i> it might be possible to backwards engineer that to send the display driver IRPs or whatever from kernel mode.  It&#39;s unlikely that anybody here already knows how to do it, and it would probably be too complex to post as an answer.  My best guess is that it would take you at least three months to get it working, and that&#39;s assuming you&#39;re a fricking genius and don&#39;t mind too much if it makes the system unstable.  Bottom line, I agree with Marcus: don&#39;t bother."}], "tags": [], "owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "is_accepted": false, "score": 3, "last_activity_date": 1484767746, "last_edit_date": 1484767746, "creation_date": 1484764803, "answer_id": 41727039, "question_id": 41726984, "link": "https://stackoverflow.com/questions/41726984/windows-write-to-the-video-display-directly-using-kernel-driver/41727039#41727039", "title": "Windows - Write to the video display directly using kernel driver?", "body": "<blockquote>\n  <p>Now I know that I can just use the DbgPrint or the KdPrint functions, but I want to output my string or anything, directly to my monitor.</p>\n</blockquote>\n\n<p>You'll have to go through the display driver. Who says that your computer running windows has a monitor at all? </p>\n\n<p>Even if it has, there won't be a MSDOS-style single framebuffer in RAM that stores your current picture. Modern GPUs just don't work that way any more \u2013 instead, operating systems ask them to compose the whole screen of single buffers they hand over for compositing \u2013 in simplification: Every window is its own framebuffer, and it's the GPU's job to compose everything to a whole screen picture.</p>\n\n<p>You also can't just write to some memory region from your kernel driver just because you like to do so \u2013 a) you don't know where that would be and b) you'd compete with other components, and that would be a bad thing.</p>\n\n<p><strong>EDIT</strong> I feel like I should add this for posteriority: </p>\n\n<blockquote>\n  <p>the point is very simple: write a driver that is a driver and not a user interface. That's not the job of a driver. Putting UI functionality into a driver is a bad idea for many reasons, and you simply shouldn't do it. </p>\n</blockquote>\n"}], "owner": {"reputation": 59, "user_id": 7335194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3074f600e25bec7c3b6e1ae4eaec4d3?s=128&d=identicon&r=PG&f=1", "display_name": "DD314", "link": "https://stackoverflow.com/users/7335194/dd314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1484767746, "creation_date": 1484764571, "question_id": 41726984, "link": "https://stackoverflow.com/questions/41726984/windows-write-to-the-video-display-directly-using-kernel-driver", "title": "Windows - Write to the video display directly using kernel driver?", "body": "<p>I am in the process of writing a windows 7 kernel driver. Today, I want to have it output debug information via the display. Now I know that I can just use the DbgPrint or the KdPrint functions, but I want to output my string or anything, directly to my monitor. This way, I don't have to fire up Debug View to see my output. This also serves as an educational exercise.</p>\n\n<p>As I understand it, I will have to access the frame buffer for the display and write my values to it, correct? However, I have no clue how to do this. Basically, I want to be able to write something onto the monitor directly, thus it would overlap anything that windows is displaying. I know this might sound weird, but its just for fun.</p>\n\n<p>The main goal is to do this from a KERNEL DRIVER. Not inside a userland process. Note that I am only wanting to use a 640x480 resolution. Not anything higher. If I understand correctly, anything higher than this would require me to write my own display driver for my current video card.</p>\n\n<p>My system setup:\nWindows 7 SP1 x86\nIntel Pentium 4 @ 3.00Ghz\nNvidia GeForce FX 5200</p>\n\n<p>Thanks for all of you help in advance!</p>\n"}, {"tags": ["c++", "c", "azure", "arduino-esp8266"], "comments": [{"owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "edited": false, "score": 0, "creation_date": 1484764717, "post_id": 41726934, "comment_id": 70648463, "body": "For an actual example of how this is done in the IoT Hub, see <a href=\"https://github.com/Azure-Samples/iot-hub-c-huzzah-getstartedkit/tree/master/remote_monitoring\" rel=\"nofollow noreferrer\">remote_monitoring</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484766570, "post_id": 41726934, "comment_id": 70649428, "body": "Why are you printing <code>float</code> with <code>%d</code> modifier?"}, {"owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484846507, "post_id": 41726934, "comment_id": 70688400, "body": "Good point.  I replaced the %d with %f and the output becomes <code>Value seen in modifyFloat: 22.55 The value that was returned is: %f</code> Why does it escape the %f?  I looked around and can&#39;t find a reason for this behaviour."}, {"owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484847097, "post_id": 41726934, "comment_id": 70688751, "body": "I found the reason: <a href=\"http://stackoverflow.com/questions/27651012/arduino-sprintf-float-not-formatting\" title=\"arduino sprintf float not formatting\">stackoverflow.com/questions/27651012/&hellip;</a> Looks like it&#39;s working now.  I&#39;ll update the code to reflect the correct syntax. <code>Value seen in modifyFloat: 22.55 The value that was returned is: 22.55</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "is_accepted": true, "score": 0, "last_activity_date": 1484847400, "creation_date": 1484847400, "answer_id": 41748220, "question_id": 41726934, "link": "https://stackoverflow.com/questions/41726934/c-function-in-arduino-esp8266-modifies-a-float-generated-in-a-c-file-gibberis/41748220#41748220", "title": "c++ function in Arduino esp8266 modifies a float generated in a c file, gibberish seen in the c file after the c++ function exits", "body": "<p>The issue was the use of the %d in the printf string in RunTest.c.  Updating the code to that shown below fixes the issue and makes the output:</p>\n\n<pre><code>Value seen in modifyFloat: 22.55\nThe value that was returned is: 22.55\n</code></pre>\n\n<h1>RunTest.c</h1>\n\n<pre><code>#include \"FloatTest.h\"\n\nvoid runInLoop(void)\n{\n    while(1)\n    {\n        float testValue;\n        modifyFloat(&amp;testValue);\n        char str_tmp[6];\n        dtostrf(testValue, 4, 2, str_tmp);\n        (void)printf(\"The value that was returned is: %s\\r\\n\", str_tmp);\n        delay(1000);\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 41748220, "answer_count": 1, "score": -1, "last_activity_date": 1484847400, "creation_date": 1484764417, "question_id": 41726934, "link": "https://stackoverflow.com/questions/41726934/c-function-in-arduino-esp8266-modifies-a-float-generated-in-a-c-file-gibberis", "title": "c++ function in Arduino esp8266 modifies a float generated in a c file, gibberish seen in the c file after the c++ function exits", "body": "<p>I am writing code for the Azure IoT Hub, which requires the use of c-functions in the Arduino loop().  The issue that I'm having is that if I pass a pointer to a float created in the c-file to a c++ file and modify the value, what is seen in the c-file after the c++ function returns is gibberish.</p>\n\n<p>Here's a psuedocode example, and a working example is included below:</p>\n\n<p>loop() in ino file:<br>\nruns runInLoop(), defined in the c-file RunTest.c</p>\n\n<p>runInLoop() in RunTest.c:<br>\ncreate a float<br>\npass the address to modifyFloat(float *address) defined in FloatTest.cpp<br>\nprint the value of the float after modifyFloat() returns.</p>\n\n<p>modifyFloat(float *address) in FloatTest.cpp:<br>\nassign a vale to *address<br>\nprint the value<br>\nreturn</p>\n\n<p>I've executed this pseudocode in the working example below and the result in the serial monitor is:</p>\n\n<pre><code>Value assigned in modifyFloat: 22.55\nThe value that was returned is: 1077316812\n</code></pre>\n\n<p>I'm using an Adafruit Huzzah Feather, configured exactly as they indicate in their documentation.</p>\n\n<p>Here is a working example:</p>\n\n<h1>azure_troubleshoot.ino</h1>\n\n<pre><code>#include \"RunTest.h\"\n\nvoid setup()\n{\n    initSerial();\n}\n\nvoid loop()\n{\n    Serial.println(\"Starting main loop!\\r\\n\");\n    runInLoop();\n}\n\nvoid initSerial()\n{\n    Serial.begin(9600);\n}\n</code></pre>\n\n<h1>RunTest.c</h1>\n\n<pre><code>#include \"FloatTest.h\"\n\nvoid runInLoop(void)\n{\n    while(1)\n    {\n        float testValue;\n        modifyFloat(&amp;testValue);\n        (void)printf(\"The value that was returned is: %d\\r\\n\", testValue);\n        delay(1000);\n    }\n\n}\n</code></pre>\n\n<h1>RunTest.h</h1>\n\n<pre><code>#ifndef RUNTEST_H\n#define RUNTEST_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid runInLoop(void);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif // RUNTEST_H\n</code></pre>\n\n<h1>FloatTest.cpp</h1>\n\n<pre><code>#include &lt;Arduino.h&gt;\n#include \"FloatTest.h\"\n\nvoid modifyFloat(float *address)\n{\n    *address = 22.55;\n    Serial.print(\"Value assigned in modifyFloat: \");\n    Serial.println(*address);\n}\n</code></pre>\n\n<h1>FloatTest.h</h1>\n\n<pre><code>#ifndef FLOATTEST_H\n#define FLOATTEST_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid modifyFloat(float* address);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif // FLOATTEST_H\n</code></pre>\n"}, {"tags": ["c", "macos", "clang", "code-generation", "compiler-optimization"], "comments": [{"owner": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "edited": false, "score": 0, "creation_date": 1484774995, "post_id": 41726839, "comment_id": 70654011, "body": "Did your code was compiled in debug mode? If so, that could explain why the assembly code was written in this way."}, {"owner": {"reputation": 835, "user_id": 1906641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Dl1w.jpg?s=128&g=1", "display_name": "Jody Bruchon", "link": "https://stackoverflow.com/users/1906641/jody-bruchon"}, "reply_to_user": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "edited": false, "score": 0, "creation_date": 1484791079, "post_id": 41726839, "comment_id": 70659310, "body": "It was compiled with <code>-O0 -g3</code>. It still seems a bit strange that it produced a jump to a jump, but that would probably explain it."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1484860413, "post_id": 41726839, "comment_id": 70696082, "body": "Since you added the tag C as well: what are the source lines that resulted in this code?"}, {"owner": {"reputation": 835, "user_id": 1906641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Dl1w.jpg?s=128&g=1", "display_name": "Jody Bruchon", "link": "https://stackoverflow.com/users/1906641/jody-bruchon"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1484874015, "post_id": 41726839, "comment_id": 70701196, "body": "@RadLexus I&#39;ve added the originating code with a little bit of extra context and a link to the original C file on Github if interested."}], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "is_accepted": false, "score": 0, "last_activity_date": 1484860042, "creation_date": 1484860042, "answer_id": 41751731, "question_id": 41726839, "link": "https://stackoverflow.com/questions/41726839/why-is-clangs-assembler-output-conditionally-jumping-to-an-unconditional-jump/41751731#41751731", "title": "Why is Clang&#39;s assembler output conditionally jumping to an unconditional jump?", "body": "<p><code>-O0</code> is for </p>\n\n<blockquote>\n  <p>Reduce compilation time and make debugging produce the expected\n  results. This is the default.</p>\n</blockquote>\n\n<p>It could be interesting to compare with the according source code.</p>\n"}], "owner": {"reputation": 835, "user_id": 1906641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Dl1w.jpg?s=128&g=1", "display_name": "Jody Bruchon", "link": "https://stackoverflow.com/users/1906641/jody-bruchon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484873554, "creation_date": 1484764113, "last_edit_date": 1484873554, "question_id": 41726839, "link": "https://stackoverflow.com/questions/41726839/why-is-clangs-assembler-output-conditionally-jumping-to-an-unconditional-jump", "title": "Why is Clang&#39;s assembler output conditionally jumping to an unconditional jump?", "body": "<p>While debugging an issue with a program crashing on a mangled pointer being dereferenced, I ran <code>lldb</code> and did a disassembly of the crashing function. While perusing the disassembled code, I noticed this odd-looking choice of instructions:</p>\n\n<blockquote>\n<pre><code>0x100002b06 &lt;+86&gt;:   cmpl   $0x0, %eax\n0x100002b09 &lt;+89&gt;:   je     0x100002b14\n0x100002b0f &lt;+95&gt;:   jmp    0x10000330e\n0x100002b14 &lt;+100&gt;:  jmp    0x100002c1d\n</code></pre>\n</blockquote>\n\n<p>I would expect the code to look like this instead:</p>\n\n<blockquote>\n<pre><code>0x100002b06 &lt;+86&gt;:   cmpl   $0x0, %eax\n0x100002b09 &lt;+89&gt;:   je     0x100002c1d\n0x100002b0f &lt;+95&gt;:   jmp    0x10000330e\n</code></pre>\n</blockquote>\n\n<p>I'm curious as to why Clang made this choice. Is it some sort of branch prediction optimization since this is a NULL pointer check that's very unlikely to match?</p>\n\n<p><strong>edit:</strong> <a href=\"https://github.com/jbruchon/jdupes/blob/1f2fe4a0c1bca7486cfc5aa84877246e90d1321a/jdupes.c#L539-L543\" rel=\"nofollow noreferrer\">This is the originating C code,</a> specifically the line with the NULL pointer check.</p>\n\n<pre><code>traverse = travdone_head;\nwhile (1) {\n  if (traverse == NULL) nullptr(\"grokdir() traverse\");\n  /* Don't re-traverse directories we've already seen */\n  if (inode == traverse-&gt;inode &amp;&amp; device == traverse-&gt;device) {\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1484763589, "post_id": 41726590, "comment_id": 70647826, "body": "A good start might be to actually <i>check</i> for errors. Just about all functions you call will return a specific value on error, and then you check the <code>errno</code> variable to see what the error is. Read the <a href=\"http://man7.org/linux/man-pages/index.html\" rel=\"nofollow noreferrer\">manual pages</a> for all the functions."}, {"owner": {"reputation": 43, "user_id": 7427859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0297a2e52245a66e4e3159f93f0ab37a?s=128&d=identicon&r=PG&f=1", "display_name": "Indesejavel Coisa", "link": "https://stackoverflow.com/users/7427859/indesejavel-coisa"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1484763799, "post_id": 41726590, "comment_id": 70647948, "body": "Sorry I did not put it here, but I already checked for errors, and everything return the expected values, no -1 or any other errors associated with each function"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484765093, "post_id": 41726590, "comment_id": 70648667, "body": "Should not <code>if(i) write(STDOUT_FILENO, bufOut, i);</code> be <code>if(i &gt;0) write(...</code> and use <code>ssize_t i = 0;</code>.  <code>ssize_t read(int fd, void *buf, size_t count);</code> returns a signed type."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1484770011, "post_id": 41726590, "comment_id": 70651418, "body": "@IndesejavelCoisa <i>&quot;scanf not blocking&quot;</i> (unexpectedly) and <i>&quot;everything return the expected values&quot;</i> are mutually exclusive. If <code>scanf</code> returns expected value, then it did manage to read what you asked."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1484775654, "post_id": 41726590, "comment_id": 70654369, "body": "What do you expect after <code>in = open(.... O_NONBLOCK)</code>?"}], "owner": {"reputation": 43, "user_id": 7427859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0297a2e52245a66e4e3159f93f0ab37a?s=128&d=identicon&r=PG&f=1", "display_name": "Indesejavel Coisa", "link": "https://stackoverflow.com/users/7427859/indesejavel-coisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484763815, "creation_date": 1484763231, "last_edit_date": 1484763815, "question_id": 41726590, "link": "https://stackoverflow.com/questions/41726590/c-scanf-not-blocking-for-named-pipe-fifo", "title": "C - Scanf not blocking for named pipe / FIFO", "body": "<p>Usually when a program call a scanf it waits until something is available in stdin to read from it. I am currently making a fifo for input and another one for output that will be used by another process to write an read from a background proccess. But, the background process seem not to wait for any scanf in it, does anyone know why? </p>\n\n<p>Here is the code:</p>\n\n<p>Background:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/ioctl.h&gt;\nint main()\n{\n    int out, in, err;\n\n    char *cFifo = \"/tmp/out\";\n    char *cInFifo = \"/tmp/in\";\n\n    mkfifo(cFifo, S_IRUSR|S_IWUSR);\n    mkfifo(cInFifo, S_IRUSR|S_IWUSR);\n\n    out = open(cFifo, O_RDWR|O_TRUNC|O_NONBLOCK);\n    in = open(cInFifo, O_RDWR|O_TRUNC|O_NONBLOCK);\n\n    dup2(out, STDOUT_FILENO);\n    dup2(out, STDERR_FILENO);\n    dup2(in, STDIN_FILENO);\n\n\n    scanf(\"%*c\");\n\n    while(1)\n    {\n        scanf(\"%*c\");\n        printf(\"Hello\\n\");\n        fflush(stdout);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Foreground:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/ioctl.h&gt;\nint main()\n{\n\n    int out, in;\n    size_t i = 0;\n\n    char bufOut[1024];\n    char *cFifo = \"/tmp/out\";\n    char *cFifoIn = \"/tmp/in\";\n\n    out = open(cFifo, O_RDONLY);\n\n    in = open(cFifoIn, O_WRONLY);\n\n\n    while(1)\n    {\n        i =0;\n        while(!i)\n        {\n            i = read(out, bufOut, 1024);\n        }\n\n        if(i)\n            write(STDOUT_FILENO, bufOut, i);\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I have already tried to force write on the new input fifo but the result is the same.</p>\n\n<p>I already checked for errors, and everything return the expected values, no -1 or any other errors associated with each function</p>\n"}, {"tags": ["c", "switch-statement", "break"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484762373, "post_id": 41726313, "comment_id": 70647098, "body": "You mind creating a <a href=\"http://stackoverflow.com/help/mcve\"><b><i>MCVE</i></b></a>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1484762407, "post_id": 41726313, "comment_id": 70647123, "body": "<code>if(option == 1)</code> and alike.. D.R.Y."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1484762490, "post_id": 41726313, "comment_id": 70647175, "body": "Check the return value from <code>scanf()</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484762491, "post_id": 41726313, "comment_id": 70647176, "body": "SO isn&#39;t a debugging service. Compile with symbols, run the code inside a debugger to trace through the program(s) line by line inspecting the values of the relevant variables to learn what is really going on. If then a <i>specific</i> question arises feel free to come back here."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484763094, "post_id": 41726313, "comment_id": 70647548, "body": "I recommend you <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">find a good beginners book to read</a>."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "edited": false, "score": 0, "creation_date": 1484763030, "post_id": 41726388, "comment_id": 70647508, "body": "Yeah i completely forgot about the break statements. But even after adding them in, it still has the same problem."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "edited": false, "score": 0, "creation_date": 1484763206, "post_id": 41726388, "comment_id": 70647609, "body": "@ShoaibAhmed you mean it still executes <i>all</i> the functions?"}, {"owner": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "edited": false, "score": 0, "creation_date": 1484763415, "post_id": 41726388, "comment_id": 70647742, "body": "All the functions are not executed. Let&#39;s say I enter 2 for variable &quot;option&quot; which finds the factorial of a an entered number. The function is executed properly. The only problem is that it keeps displaying the answer constantly in an infinite loop."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "edited": false, "score": 0, "creation_date": 1484763495, "post_id": 41726388, "comment_id": 70647782, "body": "Ahh.. I see, i get it now..wait for an update to answer."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1484763656, "last_edit_date": 1484763656, "creation_date": 1484762556, "answer_id": 41726388, "question_id": 41726313, "link": "https://stackoverflow.com/questions/41726313/using-several-different-functions/41726388#41726388", "title": "using several different functions", "body": "<p>First of all, C has unstructured <code>switch</code> statement.</p>\n\n<p>You need to add a <code>break;</code> statement after each of your <code>case</code> body to <em>limit</em> the execution for a particular case to the body mentioned under that <code>case</code>.</p>\n\n<p>Otherwise, by default, (with the absence of a <code>break</code> statement) all the <code>case</code> statements works in <strong>fall-through</strong> manner. You can read more about it <a href=\"https://en.wikipedia.org/wiki/Switch_statement#Fallthrough\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<hr>\n\n<p>That said, regarding the repeated execution of a single function, there's a serious flaw in most (if not all) of the the logic. For example, let's take this</p>\n\n<pre><code>   while(n &gt; 0) {\n     if(n &lt; 1) { //message displayed if an invalid value is entered\n         printf(\"invalid value\");\n     }\n     else {\n         printf(\"Summation of %d is %d\", n, summation(n));\n     }\n   }\n</code></pre>\n\n<p>here, you're replying on <code>n</code> becoming 0 at some point to break out of the loop, but you did not modify <code>n</code>, at all. </p>\n\n<p>To elaborate, C uses pass-by-value for argument passing, so for the call, <code>summation(n)</code>, inside the function, whatever change you make to the parameter receiving the value of <code>n</code>, is not reflected in the caller, and thus, the <code>n</code> in the caller remains unchanged.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5697768"}, "is_accepted": false, "score": 0, "last_activity_date": 1484771558, "last_edit_date": 1484771558, "creation_date": 1484770872, "answer_id": 41728757, "question_id": 41726313, "link": "https://stackoverflow.com/questions/41726313/using-several-different-functions/41728757#41728757", "title": "using several different functions", "body": "<p>You just need a <code>break</code> statement at the end of every case \nlike:</p>\n\n<pre><code> case 1: if(option == 1) { \n                printf(\"Enter a number: \");\n                scanf(\"%d\", &amp;n);\n                while(n &gt; 0) {\n                    if(n &lt; 1) { //message displayed if an invalid value is entered\n                        printf(\"invalid value\");\n                    }\n                    else {\n                        printf(\"Summation of %d is %d\", n, summation(n));\n                    }\n                }\n            } \nbreak;\n</code></pre>\n\n<p>As the control will fall down to next case if no break statement is present.</p>\n"}], "owner": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484771558, "creation_date": 1484762316, "last_edit_date": 1484762901, "question_id": 41726313, "link": "https://stackoverflow.com/questions/41726313/using-several-different-functions", "title": "using several different functions", "body": "<p>For my assignment, my program needs to ask the user which of the five functions he wants to execute. The five functions include:</p>\n\n<ol>\n<li>Summation of a number</li>\n<li>Factorial of a number</li>\n<li>Fibonacci value of the nth term.</li>\n<li>gcd of two numbers</li>\n<li>a to the power of b.</li>\n</ol>\n\n<p>The user will be prompted repeatedly until he wishes to exit. All my functions work fine. However, i think i messed up on one of the loops because once i enter which function i want to execute and enter a value, it keeps displaying the answer in an infinite loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\n// function to find summation of a number\nint summation(int k) {\n  int i;\n\n  for(i = k; i &gt;= 0; i--) {\n    k = i + (i-1);\n  }\n  return k;\n}\n\n// function to find the factorail of a number\nint factorial(int num) {\n  int i;\n\n  for(i = num - 1; i &gt; 0; i--) {\n    num = num * i;\n  }\n  return num;\n}\n\n// dunxtion to find the fibonacci of the nth term\nint fibonacci(int n){\n  int i, t1 = 0, t2 = 1, nextTerm;\n\n  for(i = 1; i &lt;= n; i++) {\n    if(i == 1) {\n        printf(\"%d, \", t1);\n        continue;\n    }\n    if(i == 2) {\n        printf(\"%d, \", t2);\n        continue;\n    }\n    nextTerm = t1 + t2;\n    t1 = t2;\n    t2 = nextTerm;\n    printf(\"%d, \", nextTerm);\n  }\n  return nextTerm;\n}\n\n// function to find the gcd of two numbers\nint gcd(int n, int m) {\n  int i, gcd;\n\n  for(i=1; i &lt;= n &amp;&amp; i &lt;= m; i++) {\n    // Checks if i is a factor of both integers\n    if(n % i == 0 &amp;&amp; m % i == 0)\n        gcd = i;\n  }\n  return gcd;\n}\n\n// function to find value of n to the power of m\nint power(int n, int m) {\n  return pow(n, m);\n}\n\nint main(void) {;\n  int option ,n, m;\n\n//Asks user for what they want to find\n  printf(\"If you would like to find the summation of a number, enter 1 \\n\");\n  printf(\"If you would like to find the factorial of a number, enter 2 \\n\");\n  printf(\"If you would like to find the fibonacci sequence of a number, enter 3 \\n\");\n  printf(\"If you would like to find the gcd of two numbers, enter 4 \\n\");\n  printf(\"If you would like to find the power of a number a to b, enter 5 \\n\");\n  printf(\"If you would like to exit, enter 0 \\n\");\n  scanf(\"%d\", &amp;option);\n\n// Enables the program to prompt the user until they wish to exit\n  while(option != 0) {  \n    switch(option) { //If user wishes to find the summation\n        case 1: if(option == 1) {   \n                    printf(\"Enter a number: \");\n                    scanf(\"%d\", &amp;n);\n                    while(n &gt; 0) {\n                        if(n &lt; 1) { //message displayed if an invalid value is entered\n                            printf(\"invalid value\");\n                        }\n                        else {\n                            printf(\"Summation of %d is %d\", n, summation(n));\n                        }\n                    }\n                }\n        case 2: if(option == 2) { //if user wishes to find factorial of a number\n                    printf(\"Enter a number: \");\n                    scanf(\"%d\", &amp;n);\n                    while(n &gt;= 0) {//message displayed if an invalid value is entered\n                        if(n &lt; 0) {\n                            printf(\"invalid value\");\n                        }\n                        else {\n                            printf(\"factorial of %d is %d\", n, factorial(n));\n                        }\n                    }\n                }\n        case 3: if(option == 3) { //if user wishes to find the fibonacci value of the nth term\n                    printf(\"Enter a number: \");\n                    scanf(\"%d\", &amp;n);\n                    while(n &gt;= 0) {//message displayed if an invalid value is entered\n                        if(n &lt; 0) {\n                            printf(\"invalid value\");\n                        }\n                        else {\n                            printf(\"fibonacci of %d is %d\", n, fibonacci(n));\n                        }\n                    }\n                }\n        case 4: if(option == 4) { \n                    printf(\"Enter a number: \");\n                    scanf(\"%d %d\", &amp;n, &amp;m);\n                    while(n &gt;= 0 &amp;&amp; m &gt;= 0) {\n                        if(n &lt; 0 || m &lt; 0) {//message displayed if an invalid value is entered\n                            printf(\"invalid value\");\n                        }\n                        else {\n                            printf(\"GCD of %d and %d is %d\", n, m, gcd(n, m));\n                        }\n                    }\n                }\n        case 5: if(option == 5) {\n                    printf(\"Enter a number: \");\n                    scanf(\"%d %d\", &amp;n, &amp;m);\n                    while(n &gt;= 0 &amp;&amp; m &gt;= 0) {\n                        if(n &lt;= 0 || m &lt; 0) {\n                            printf(\"invalid value\");\n                        }\n                        else {\n                            printf(\"%d to the power of %d is %d\", n, m, power(n, m));\n                        }\n                    }\n                }\n        default: if(option == 0) {\n            break;\n        }\n    }\n    scanf(\"%d\", &amp;option);\n}\n}\n</code></pre>\n"}, {"tags": ["c", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1811, "user_id": 5968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gBgib.jpg?s=128&g=1", "display_name": "James Williams", "link": "https://stackoverflow.com/users/5968/james-williams"}, "edited": false, "score": 0, "creation_date": 1484776852, "post_id": 41729770, "comment_id": 70654953, "body": "I tried calling file.flush() after the file.ioctl call but didn&#39;t notice any change in behavior. :("}, {"owner": {"reputation": 2470, "user_id": 1175090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bd5ca9726b8546e77c9fe21cae2f1e95?s=128&d=identicon&r=PG", "display_name": "Snake Sanders", "link": "https://stackoverflow.com/users/1175090/snake-sanders"}, "reply_to_user": {"reputation": 1811, "user_id": 5968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gBgib.jpg?s=128&g=1", "display_name": "James Williams", "link": "https://stackoverflow.com/users/5968/james-williams"}, "edited": false, "score": 0, "creation_date": 1484810257, "post_id": 41729770, "comment_id": 70665332, "body": "The last I could suggest for the moment is to check if the data is actually written at the moment the program is supposed to write it, not at the end. Check if the data is not only flushed from ruby environment but also from the OS to the IO. You can verify it using <a href=\"http://ruby-doc.org/core-2.4.0/IO.html#method-i-fsync\" rel=\"nofollow noreferrer\">fsync</a>. It will tell you with an exception if the underlying OS writes the data right away."}, {"owner": {"reputation": 1811, "user_id": 5968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gBgib.jpg?s=128&g=1", "display_name": "James Williams", "link": "https://stackoverflow.com/users/5968/james-williams"}, "edited": false, "score": 0, "creation_date": 1484826243, "post_id": 41729770, "comment_id": 70674596, "body": "The part where I said &quot;The do_latch functions are necessary so I can see the result in my hardware; but are probably not germane to this problem.&quot; was in fact the problem.   I was so busy looking at ioctl that I missed that I wasn&#39;t flushing when writing the latch values.   Thank you so much!"}], "tags": [], "owner": {"reputation": 2470, "user_id": 1175090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bd5ca9726b8546e77c9fe21cae2f1e95?s=128&d=identicon&r=PG", "display_name": "Snake Sanders", "link": "https://stackoverflow.com/users/1175090/snake-sanders"}, "is_accepted": true, "score": 1, "last_activity_date": 1484774901, "creation_date": 1484774901, "answer_id": 41729770, "question_id": 41726292, "link": "https://stackoverflow.com/questions/41726292/ruby-ioctl-and-complex-structures/41729770#41729770", "title": "Ruby, ioctl, and complex structures", "body": "<p>It is a common issue not to flush the buffer, you could check it out and try it.</p>\n\n<p><a href=\"http://ruby-doc.org/core-2.4.0/IO.html#method-i-flush\" rel=\"nofollow noreferrer\">Flush</a>:\nFlushes any buffered data within ios to the underlying operating system (note that this is Ruby internal buffering only; the OS may buffer the data as well).</p>\n\n<pre><code>rb_io_flush(VALUE io)\n{\n    return rb_io_flush_raw(io, 1);\n}\n</code></pre>\n"}], "owner": {"reputation": 1811, "user_id": 5968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gBgib.jpg?s=128&g=1", "display_name": "James Williams", "link": "https://stackoverflow.com/users/5968/james-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 41729770, "answer_count": 1, "score": 4, "last_activity_date": 1484776800, "creation_date": 1484762267, "last_edit_date": 1484776800, "question_id": 41726292, "link": "https://stackoverflow.com/questions/41726292/ruby-ioctl-and-complex-structures", "title": "Ruby, ioctl, and complex structures", "body": "<p>I have a piece of hardware that I'm trying to control via my computer's built-in SPI driver. The SPI driver is controlled via ioctl. </p>\n\n<p>I can successfully drive the hardware from a small C program; but when I try to duplicate the C program in Ruby I run into problems. </p>\n\n<p>Using <a href=\"http://ruby-doc.org/core-2.4.0/IO.html\" rel=\"nofollow noreferrer\">IO#ioctl</a> to set basic registers (with u32 and u8 ints) works fine (I know because I can also use ioctl to read back the values I set); but as soon as I try to set a complex struct, the program fails with</p>\n\n<pre><code>small.rb:51:in 'ioctl': Connection timed out @ rb_ioctl - /dev/spidev32766.0 (Errno::ETIMEDOUT)\n</code></pre>\n\n<p>I might be running into trouble because the <a href=\"https://www.apt-browse.org/browse/ubuntu/precise/main/i386/linux-libc-dev/3.2.0-23.36/file/usr/include/linux/spi/spidev.h\" rel=\"nofollow noreferrer\">spi_ioc_transfer  struct</a> has two pointers to byte buffers but the pointers are typed as unsigned 64-bit ints even on 32-bit platforms -- necessitating a cast to <code>(unsigned long)</code> in C. I'm trying to replicate that in Ruby but am quite unsure of myself. </p>\n\n<p>Below are the C program which works and the Ruby port which doesn't work. The <code>do_latch</code> functions are necessary so I can see the result in my hardware; but are probably not germane to this problem. </p>\n\n<p>C (which works):</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;linux/spi/spidev.h&gt;\n\nint do_latch() {\n    int fd = open(\"/sys/class/gpio/gpio1014/value\", O_RDWR);\n    write(fd, \"1\", 1);\n    write(fd, \"0\", 1);\n\n    close(fd);\n}\n\nint do_transfer(int fd, uint8_t *bytes, size_t len) {\n    uint8_t *rx_bytes = malloc(sizeof(uint8_t) * len);\n\n    struct spi_ioc_transfer transfer = {\n        .tx_buf = (unsigned long)bytes,\n        .rx_buf = (unsigned long)rx_bytes,\n\n        .len = len,\n        .speed_hz = 100000,\n\n        .delay_usecs = 0,\n        .bits_per_word = 8,\n        .cs_change = 0,\n        .tx_nbits = 0,\n        .rx_nbits = 0,\n        .pad = 0\n    };\n\n    if(ioctl(fd, SPI_IOC_MESSAGE(1), &amp;transfer) &lt; 1) {\n        perror(\"Could not send SPI message\"); \n        exit(1); \n    }\n\n    free(rx_bytes);\n}\n\nint main() {\n    int fd = open(\"/dev/spidev32766.0\", O_RDWR);\n\n    uint8_t mode = 0;\n    ioctl(fd, SPI_IOC_WR_MODE, &amp;mode);\n\n    uint8_t lsb_first = 0;\n    ioctl(fd, SPI_IOC_WR_LSB_FIRST, lsb_first);\n\n    uint32_t speed_hz = 100000;\n    ioctl(fd, SPI_IOC_WR_MAX_SPEED_HZ, speed_hz);\n\n    size_t data_len = 36;\n    uint8_t *tx_data = malloc(sizeof(uint8_t) * data_len);\n\n    memset(tx_data, 0xFF, data_len);\n\n    do_transfer(fd, tx_data, data_len);\n    do_latch();\n\n    sleep(2);\n\n    memset(tx_data, 0x00, data_len);\n\n    do_transfer(fd, tx_data, data_len);\n    do_latch();\n\n    free(tx_data);\n    close(fd);\n    return 0;\n}\n</code></pre>\n\n<p>Ruby (which fails on the ioctl line in <code>do_transfer</code>):</p>\n\n<pre><code>SPI_IOC_WR_MODE = 0x40016b01\nSPI_IOC_WR_LSB_FIRST = 0x40016b02\nSPI_IOC_WR_BITS_PER_WORD = 0x40016b03\nSPI_IOC_WR_MAX_SPEED_HZ = 0x40046b04\nSPI_IOC_WR_MODE32 = 0x40046b05\nSPI_IOC_MESSAGE_1 = 0x40206b00 \n\ndef do_latch()\n  File.open(\"/sys/class/gpio/gpio1014/value\", File::RDWR) do |file|\n    file.write(\"1\")\n    file.write(\"0\")\n  end\nend\n\ndef do_transfer(file, bytes)\n  ##########################################################################################\n  #begin spi_ioc_transfer struct (cat /usr/include/linux/spi/spidev.h)\n\n    #pack bytes into a buffer; create a new buffer (filled with zeroes) for the rx\n    tx_buff = bytes.pack(\"C*\")        \n    rx_buff = (Array.new(bytes.size) { 0 }).pack(\"C*\")       \n\n    #on 32-bit, the struct uses a zero-extended pointer for the buffers (so it's the same\n    #byte layout on 64-bit as well) -- so do some trickery to get the buffer addresses \n    #as 64-bit strings even though this is running on a 32-bit computer\n    tx_buff_pointer = [tx_buff].pack(\"P\").unpack(\"L!\")[0]   #u64 (zero-extended pointer)\n    rx_buff_pointer = [rx_buff].pack(\"P\").unpack(\"L!\")[0]   #u64 (zero-extended pointer)\n\n    buff_len = bytes.size                                   #u32\n    speed_hz = 100000                                       #u32\n\n    delay_usecs = 0                                         #u16\n    bits_per_word = 8                                       #u8\n    cs_change = 0                                           #u8\n    tx_nbits = 0                                            #u8\n    rx_nbits = 0                                            #u8\n    pad = 0                                                 #u16\n\n    struct_array = [tx_buff_pointer, rx_buff_pointer, buff_len, speed_hz, delay_usecs, bits_per_word, cs_change, tx_nbits, rx_nbits, pad]\n    struct_packed = struct_array.pack(\"QQLLSCCCCS\")\n\n    #in C, I pass a pointer to the the structure; so mimic that here\n    struct_pointer_packed = [struct_packed].pack(\"P\")\n  #end spi_ioc_transfer struct\n  ##########################################################################################\n\n  file.ioctl(SPI_IOC_MESSAGE_1, struct_pointer_packed)\nend\n\nFile.open(\"/dev/spidev32766.0\", File::RDWR) do |file|\n\n  file.ioctl(SPI_IOC_WR_MODE, [0].pack(\"C\"));\n  file.ioctl(SPI_IOC_WR_LSB_FIRST, [0].pack(\"C\"));\n  file.ioctl(SPI_IOC_WR_MAX_SPEED_HZ, [0].pack(\"L\"));\n\n  data_bytes = Array.new(36) { 0x00 }\n\n  do_transfer(file, data_bytes)\n  do_latch()\n\n  sleep(2) \n\n  data_bytes = []\n  data_bytes = Array.new(36) { 0xFF }\n\n  do_transfer(file, data_bytes)\n  do_latch()\n\nend\n</code></pre>\n\n<p>I pulled the magic number constants out by having C print them (they're macros in C). I can validate that most of them work; I'm a little unsure about the ioctl message that fails (<code>SPI_IOC_MESSAGE_1</code>) since that doesn't work and it's a complicated macro. Still, I have no reason to think that it's incorrect and it's always the same when I look at it from C. </p>\n\n<p>When I print out the structure in C and then print it out in Ruby, the only differences are in the buffer addresses, so if something's going wrong, that feels like the right place to look. But I've run out of things to try. </p>\n\n<p>I can also print out the addresses in both versions and they look like what I would expect, 32 bits extended to 64 bits, and match the values in the structure (although the structure is little-endian -- this is an ARM). </p>\n\n<p>Structure in C (that works):</p>\n\n<pre><code>60200200 00000000 a8200200 00000000 24000000 40420f00 00000800 00000000\n</code></pre>\n\n<p>Structure in Ruby (that fails):</p>\n\n<pre><code>a85da27f 00000000 08399b7f 00000000 24000000 40420f00 00000800 00000000\n</code></pre>\n\n<p>Is there an obvious mistake that I'm making when I lay out the struct in Ruby? Is there something else that I'm missing? </p>\n\n<p>My next step is to write a library in C and use FFI to access it from Ruby. But that seems like giving up; and using the native <code>ioctl</code> function feels like the better approach if I can ever make it work. </p>\n\n<h3>Update</h3>\n\n<p>Above, I'm doing </p>\n\n<pre><code>    struct_array = [tx_buff_pointer, rx_buff_pointer, buff_len, speed_hz, delay_usecs, bits_per_word, cs_change, tx_nbits, rx_nbits, pad]\n    struct_packed = struct_array.pack(\"QQLLSCCCCS\")\n\n    #in C, I pass a pointer to the the structure; so mimic that here\n    struct_pointer_packed = [struct_packed].pack(\"P\")\n    file.ioctl(SPI_IOC_MESSAGE_1, struct_pointer_packed)\n</code></pre>\n\n<p>because I have to pass a pointer to the struct in C. But that's what's causing the error! </p>\n\n<p>Instead, it needs to be </p>\n\n<pre><code>    struct_array = [tx_buff_pointer, rx_buff_pointer, buff_len, speed_hz, delay_usecs, bits_per_word, cs_change, tx_nbits, rx_nbits, pad]\n    struct_packed = struct_array.pack(\"QQLLSCCCCS\")\n\n    file.ioctl(SPI_IOC_MESSAGE_1, struct_packed)\n</code></pre>\n\n<p>I guess Ruby is automatically making it an array when it marshalls it over? </p>\n\n<p>Unfortunately, now it only intermittently works. The second call <em>never</em> works and the first call doesn't work if I pass in all zeros. It's very mysterious. </p>\n"}, {"tags": ["c", "x509certificate", "cryptoapi"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1484762527, "post_id": 41726085, "comment_id": 70647205, "body": "Don&#39;t write your own crypto code."}, {"owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1484762788, "post_id": 41726085, "comment_id": 70647361, "body": "Agree with @stark, consider to use built-in <code>CertCreateCertificateChainEngine</code> function: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa376032(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 1513, "user_id": 2556354, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d17ecb069c4cf3205de82341203f9525?s=128&d=identicon&r=PG", "display_name": "madz", "link": "https://stackoverflow.com/users/2556354/madz"}, "edited": false, "score": 0, "creation_date": 1484762935, "post_id": 41726085, "comment_id": 70647446, "body": "Actually I&#39;m not intended to write my own, the problem is, I don&#39;t know how to do it using Crypt api."}, {"owner": {"reputation": 1513, "user_id": 2556354, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d17ecb069c4cf3205de82341203f9525?s=128&d=identicon&r=PG", "display_name": "madz", "link": "https://stackoverflow.com/users/2556354/madz"}, "reply_to_user": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1484762997, "post_id": 41726085, "comment_id": 70647485, "body": "Thanks @Crypt32, I&#39;ve started to investigate how to use CertCreateCertificateChainEngine for my particular purpose."}, {"owner": {"reputation": 1513, "user_id": 2556354, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d17ecb069c4cf3205de82341203f9525?s=128&d=identicon&r=PG", "display_name": "madz", "link": "https://stackoverflow.com/users/2556354/madz"}, "reply_to_user": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1485032310, "post_id": 41726085, "comment_id": 70758805, "body": "@Crypt32, unfortunatly after couple of days digging into CertCreateCertificateChainEngine could not find the proper solution with this function."}], "answers": [{"comments": [{"owner": {"reputation": 1513, "user_id": 2556354, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d17ecb069c4cf3205de82341203f9525?s=128&d=identicon&r=PG", "display_name": "madz", "link": "https://stackoverflow.com/users/2556354/madz"}, "edited": false, "score": 0, "creation_date": 1544469397, "post_id": 53448963, "comment_id": 94278816, "body": "Thank you @ravin.wang for sharing your solution. Actually I gave up native code and decided to use openssl when I was working on that project. Right now I can&#39;t test your code on that project but hopefully someone would find this code and let us know if its useful for this particular need."}, {"owner": {"reputation": 1066, "user_id": 3968307, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XUJMx.jpg?s=128&g=1", "display_name": "ravin.wang", "link": "https://stackoverflow.com/users/3968307/ravin-wang"}, "reply_to_user": {"reputation": 1513, "user_id": 2556354, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d17ecb069c4cf3205de82341203f9525?s=128&d=identicon&r=PG", "display_name": "madz", "link": "https://stackoverflow.com/users/2556354/madz"}, "edited": false, "score": 0, "creation_date": 1544838823, "post_id": 53448963, "comment_id": 94429311, "body": "I have written a runnable sample for windows OPM management, there are workable codes in <a href=\"https://github.com/wangf1978/D3DTest\" rel=\"nofollow noreferrer\">github.com/wangf1978/D3DTest</a>, the related implementation and sample code lie at CryptoUtil.cpp and OPMSessioncpp"}], "tags": [], "owner": {"reputation": 1066, "user_id": 3968307, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XUJMx.jpg?s=128&g=1", "display_name": "ravin.wang", "link": "https://stackoverflow.com/users/3968307/ravin-wang"}, "is_accepted": false, "score": 4, "last_activity_date": 1542986519, "last_edit_date": 1542986519, "creation_date": 1542985310, "answer_id": 53448963, "question_id": 41726085, "link": "https://stackoverflow.com/questions/41726085/x509-certificate-verification-with-windows-crypto-api/53448963#53448963", "title": "X509 Certificate verification with Windows Crypto API", "body": "<p>Here is the sample code for you, hopefully it can help you.</p>\n\n<pre><code>HRESULT hr = E_FAIL;\nDWORD dwError = 0;\nPCCERT_CONTEXT  pCert = NULL;\n\nHCERTSTORE hCertStore = CertOpenStore(\n    CERT_STORE_PROV_FILENAME,                   \n    PKCS_7_ASN_ENCODING | X509_ASN_ENCODING,\n    NULL,                                   \n    (CERT_STORE_OPEN_EXISTING_FLAG | CERT_STORE_READONLY_FLAG),             \n    L\"certificate-chain.pem.cert\");\n\ndo\n{\n    if ((pCert = CertEnumCertificatesInStore(hCertStore, pCert)) == NULL)\n        break;\n\n    PCCERT_CONTEXT pcIssuer = NULL;\n    PCCERT_CONTEXT pcSubject = CertDuplicateCertificateContext(pCert);\n    for (; NULL != pcSubject;)\n    {\n        DWORD dwFlags = 0;\n        BOOL bret = TRUE;\n        hr = S_OK;\n\n        pcIssuer = CertGetIssuerCertificateFromStore(\n            hCertStore, pcSubject, NULL, &amp;dwFlags);\n\n        if (pcIssuer == NULL)\n        {\n            dwError = GetLastError();\n            if (CRYPT_E_SELF_SIGNED != dwError)\n            {\n                hr = E_FAIL;\n                break;\n            }\n            else\n            {\n                if ((bret = CertCompareCertificateName(\n                    X509_ASN_ENCODING, \n                    &amp;pcSubject-&gt;pCertInfo-&gt;Subject, \n                    &amp;pcSubject-&gt;pCertInfo-&gt;Issuer)) == FALSE)\n                {\n                    hr = E_FAIL;\n                    break;\n                }\n            }\n        }\n\n        HCRYPTPROV hprov = NULL;\n        bret = CryptAcquireContext(\n                    &amp;hprov, nullptr, nullptr, PROV_RSA_FULL, \n                    CRYPT_SILENT | CRYPT_VERIFYCONTEXT | CRYPT_NEWKEYSET);\n\n        if (FALSE == bret)\n        {\n            dwError = GetLastError();\n            if (NTE_EXISTS == dwError)\n                bret = CryptAcquireContext(\n                        &amp;hprov, nullptr, nullptr, PROV_RSA_FULL,\n                        CRYPT_SILENT | CRYPT_VERIFYCONTEXT);\n            if (FALSE == bret)\n            {\n                hr = E_FAIL;\n                break;\n            }\n        }\n\n        if ((bret = CryptVerifyCertificateSignatureEx(\n            hprov, X509_ASN_ENCODING,\n            CRYPT_VERIFY_CERT_SIGN_SUBJECT_CERT,\n            (void*)pcSubject,\n            CRYPT_VERIFY_CERT_SIGN_SUBJECT_CERT, \n            (void*)(pcIssuer == nullptr ? pcSubject : pcIssuer),\n            0, nullptr)) == FALSE)\n        {\n            hr = E_FAIL;\n            break;\n        }\n\n        if (nullptr == pcIssuer)\n        {\n            CERT_PUBLIC_KEY_INFO msCert;\n            msCert.Algorithm = \n                pcSubject-&gt;pCertInfo-&gt;SubjectPublicKeyInfo.Algorithm;\n            msCert.PublicKey.cbData = \n                sizeof(PETRUSTED_ROOTCERT_PUBKEY);\n            msCert.PublicKey.pbData = \n                const_cast&lt;LPBYTE&gt;(PETRUSTED_ROOTCERT_PUBKEY);\n            msCert.PublicKey.cUnusedBits = \n                pcSubject-&gt;pCertInfo-&gt;SubjectPublicKeyInfo.PublicKey.cUnusedBits;\n\n            if (FALSE == CertComparePublicKeyInfo(\n                X509_ASN_ENCODING | PKCS_7_ASN_ENCODING, \n                &amp;pcSubject-&gt;pCertInfo-&gt;SubjectPublicKeyInfo, &amp;msCert))\n            {\n                hr = E_FAIL;\n                break;\n            }\n        }\n\n        bret = CryptReleaseContext(hprov, 0);\n        hprov = NULL;\n\n        CertFreeCertificateContext(pcSubject);\n        pcSubject = pcIssuer;\n        pcIssuer = NULL;\n    }\n\n    if (pcIssuer != NULL)\n        CertFreeCertificateContext(pcIssuer);\n\n    if (pcSubject != NULL)\n        CertFreeCertificateContext(pcSubject);\n\n    if (FAILED(hr))\n    {\n        CertFreeCertificateContext(pCert);\n        break;\n    }\n\n} while (pCert != NULL);\n\nCertCloseStore(hCertStore, 0);\n\nif (FAILED(hr))\n    wprintf(L\"Failed to verify X509 certification.\\n\");\nelse\n    wprintf(L\"Successfully verify X509 certification.\\n\");\n</code></pre>\n"}], "owner": {"reputation": 1513, "user_id": 2556354, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d17ecb069c4cf3205de82341203f9525?s=128&d=identicon&r=PG", "display_name": "madz", "link": "https://stackoverflow.com/users/2556354/madz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1542986519, "creation_date": 1484761569, "question_id": 41726085, "link": "https://stackoverflow.com/questions/41726085/x509-certificate-verification-with-windows-crypto-api", "title": "X509 Certificate verification with Windows Crypto API", "body": "<p>I need to write a C program for Windows that receives a certificate from network (in PEM format) and validates its signature with a certificate chain file (which is already presented in the application's folder).</p>\n\n<p>Writing such an application is pretty easy and strait forward with openssl library but seems a little complicated with the Windows Crypto API.</p>\n\n<p>Here is what I've tried so far:</p>\n\n<p>First I thought I can create a HCERTSTORE using the certificate-chain file:</p>\n\n<pre><code>HCERTSTORE hFileStoreHandle = CertOpenStore( \nCERT_STORE_PROV_FILENAME,\nPKCS_7_ASN_ENCODING | X509_ASN_ENCODING, NULL,\n(CERT_STORE_OPEN_EXISTING_FLAG | CERT_STORE_READONLY_FLAG),\nL\"certificate-chain.pem.cert\");\n</code></pre>\n\n<p>Then I figured I can iterate through the store and get PCCERT_CONTEXT struct of certificates:</p>\n\n<pre><code>PCCERT_CONTEXT CAfileContext = NULL;\nwhile(CAfileContext = CertEnumCertificatesInStore(\n hCertStore,\n CAfileContext)) {\n\n    //start verification here\n}\n</code></pre>\n\n<p>I don't know if I am on the right track or not but I'm facing two major problems here.</p>\n\n<p>First is I don't know how to get the received certificate from buffer and convert it to a proper struct in order to validate its signature with certificate-chain file.</p>\n\n<p>Second is I don't know how to verify a certificate signature using the CA chain file.</p>\n\n<p>I'll appreciate all the suggestions and helps. </p>\n"}, {"tags": ["c", "algorithm", "data-structures", "time-complexity", "big-o"], "comments": [{"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484761446, "post_id": 41726006, "comment_id": 70646638, "body": "I think you&#39;re correct, apart from instead of &quot;since it has (n^3 + 1) * (m^2 + 1)&quot; it should be, as you did for the first analysis, n^3/2..."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1484764727, "post_id": 41726006, "comment_id": 70648475, "body": "Well it depends what <code>m</code> and <code>n</code> are. In the first case, if <code>n</code> is a constant then the loop is constant time O(1). Remember, free and bound variables... As you write it, we generally consider both n and m as free, then first is of O(n^3) and second of O(n^3*m^2) (outer loop occurs n^3 and for each of these inner loop occurs m^2)."}], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 4600577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8lfWK.jpg?s=128&g=1", "display_name": "Ardavel", "link": "https://stackoverflow.com/users/4600577/ardavel"}, "is_accepted": false, "score": 4, "last_activity_date": 1484761415, "creation_date": 1484761415, "answer_id": 41726042, "question_id": 41726006, "link": "https://stackoverflow.com/questions/41726006/what-is-the-time-complexity-of-n-n-n-iterations-inside-a-for-loop/41726042#41726042", "title": "What is the time complexity of n * n * n iterations inside a for loop?", "body": "<p>In the first case the time complexity is <code>O(n^3)</code>. It captures the most significant term so you ignore the scaling factor of <code>1/2</code> and the constant <code>+1</code>. In the latter case it is <code>O(n^3 * m^2)</code> unless you treat <code>m</code> as a constant and not as a variable. In the Big-O notation you don't necessary need to have only a single variable to represent the size of the input data.</p>\n"}, {"tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": false, "score": 2, "last_activity_date": 1484761422, "creation_date": 1484761422, "answer_id": 41726046, "question_id": 41726006, "link": "https://stackoverflow.com/questions/41726006/what-is-the-time-complexity-of-n-n-n-iterations-inside-a-for-loop/41726046#41726046", "title": "What is the time complexity of n * n * n iterations inside a for loop?", "body": "<blockquote>\n  <p>This loop is O(n^3) because it's got (n^3)/2 + 1 iterations. </p>\n</blockquote>\n\n<p>Correct.</p>\n\n<blockquote>\n  <p>This loop is O(n^3 * m^2) since it has (n^3 + 1) * (m^2 + 1) iterations. Or would this just be O(n^3) since the inner loop is not a variable n? </p>\n</blockquote>\n\n<p>Both are correct. It depends if you consider <code>m</code> a variable or a constant. </p>\n"}, {"tags": [], "owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "is_accepted": false, "score": 0, "last_activity_date": 1484883237, "creation_date": 1484883237, "answer_id": 41755652, "question_id": 41726006, "link": "https://stackoverflow.com/questions/41726006/what-is-the-time-complexity-of-n-n-n-iterations-inside-a-for-loop/41755652#41755652", "title": "What is the time complexity of n * n * n iterations inside a for loop?", "body": "<p>In asymptotic notations one can have more than one variables.\nFor the second case considering both n and m as variables the complexity will be O(n^3 * m^2). If m is treated as a constant then the complexity is O(n^3).</p>\n"}], "owner": {"reputation": 971, "user_id": 4909889, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/0e55dadcd074d895900a408cba1b258b?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy Saechao", "link": "https://stackoverflow.com/users/4909889/tommy-saechao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1484883237, "creation_date": 1484761273, "question_id": 41726006, "link": "https://stackoverflow.com/questions/41726006/what-is-the-time-complexity-of-n-n-n-iterations-inside-a-for-loop", "title": "What is the time complexity of n * n * n iterations inside a for loop?", "body": "<p>What is the time complexity of these loops? Correct me if I am wrong. </p>\n\n<p>This loop is O(n^3) because it's got (n^3)/2 + 1 iterations. </p>\n\n<pre><code>for (int i = 0; i &lt; n * n * n; i+=2)\n{\n     //body\n}\n</code></pre>\n\n<p>and</p>\n\n<p>This loop is O(n^3 * m^2) since it has (n^3 + 1) * (m^2 + 1) iterations. Or would this just be O(n^3) since the inner loop is not a variable n? </p>\n\n<pre><code>for (int i = 0; i &lt; n * n * n; i+=2)\n{\n     for (int j = 0; j &lt; m * m; j++)\n     {\n     //Body\n     }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "edited": false, "score": 3, "creation_date": 1484761081, "post_id": 41725933, "comment_id": 70646436, "body": "use <code>&#39;</code> instead of <code>&quot;</code> for 1 char"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1484761088, "post_id": 41725933, "comment_id": 70646439, "body": "use single quotes around character constants."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1484761091, "post_id": 41725933, "comment_id": 70646443, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8004237/how-do-i-properly-compare-strings-in-c\">How do I properly compare strings in C?</a>"}, {"owner": {"reputation": 622, "user_id": 3803749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gYFxy.jpg?s=128&g=1", "display_name": "MAP", "link": "https://stackoverflow.com/users/3803749/map"}, "edited": false, "score": 0, "creation_date": 1484761337, "post_id": 41725933, "comment_id": 70646580, "body": "Actually, since the OP didn&#39;t give us the declaration of <code>choice</code>, it could be either.  If choice is a <code>char</code> you want to test against a <code>char</code>, i.e. <code>&#39;+&#39;</code>.  If choice is a <code>char *</code> you need to test with <code>strcmp</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 2824, "user_id": 2064000, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5d77af4b886ea2ab7dec47f0fb8fb2e7?s=128&d=identicon&r=PG", "display_name": "user2064000", "link": "https://stackoverflow.com/users/2064000/user2064000"}, "edited": false, "score": 0, "creation_date": 1484761439, "post_id": 41725933, "comment_id": 70646634, "body": "@user2064000: Your suggestions assume <code>choice</code> is a string, what it most likely isn&#39;t (see the call to <code>scanf</code>)."}, {"owner": {"reputation": 6398, "user_id": 4284627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2e017633cda5465e6683c74992cdec5e?s=128&d=identicon&r=PG", "display_name": "Donald Duck", "link": "https://stackoverflow.com/users/4284627/donald-duck"}, "edited": false, "score": 0, "creation_date": 1484762107, "post_id": 41725933, "comment_id": 70646969, "body": "You also have a semicolon (<code>;</code>) after your if statement before the <code>{</code>, so the if statement will be ignored. I recommend using the syntax <code>if(something){</code> instead (with the <code>{</code> on the same line as the if statement) because it makes it less likely to make such mistakes."}], "answers": [{"tags": [], "owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "is_accepted": false, "score": 2, "last_activity_date": 1484761310, "creation_date": 1484761310, "answer_id": 41726013, "question_id": 41725933, "link": "https://stackoverflow.com/questions/41725933/why-cant-i-use-variable-or-variable-in-c-for-example/41726013#41726013", "title": "Why cant I use variable!=+ or variable!=- in C for example", "body": "<p>In your code, I see the following statement:</p>\n\n<p><code>scanf(\"%c\", &amp;choice);</code></p>\n\n<p>So I am judging that the type of the variable 'choice' is char.</p>\n\n<p>For character comparison, you need to use a single quote, not double quotes. So replace the </p>\n\n<p><code>if (choice!=\"+\"&amp;&amp;choice!=\"-\"&amp;&amp;choice!=\"*\"&amp;&amp;choice!=\"/\");</code></p>\n\n<p>with </p>\n\n<p><code>if (choice!='+'&amp;&amp;choice!='-'&amp;&amp;choice!='*'&amp;&amp;choice!='/')</code></p>\n\n<p>Also, remove the semicolon from the end of the <code>if</code> statement. It doesn't make sense.</p>\n"}], "owner": {"reputation": 15, "user_id": 7437049, "user_type": "registered", "profile_image": "https://graph.facebook.com/1379484608742586/picture?type=large", "display_name": "Claudio Albino", "link": "https://stackoverflow.com/users/7437049/claudio-albino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1484804357, "answer_count": 1, "score": -6, "last_activity_date": 1484761310, "creation_date": 1484761002, "question_id": 41725933, "link": "https://stackoverflow.com/questions/41725933/why-cant-i-use-variable-or-variable-in-c-for-example", "closed_reason": "Not suitable for this site", "title": "Why cant I use variable!=+ or variable!=- in C for example", "body": "<p>I am doing a simple calculator using switch case but i ran into some problems and decided to do it in another way to check if what the user inputs is invalid but I cant make it work.</p>\n\n<p>this is a piece of code from the program:</p>\n\n<pre><code>if (choice!=\"+\"&amp;&amp;choice!=\"-\"&amp;&amp;choice!=\"*\"&amp;&amp;choice!=\"/\");\n    {\n    printf(\"The type of operation is invalid\\n\");\n    invalid=1;\n    printf(\"Chose the type of operation, + for sum, - for subtraction, * for multiplication and / for division\\n\");\n    scanf(\"%c\", &amp;choice);\n    }\n</code></pre>\n\n<p>I cant verify if what the user inputs is different than +, -,, * or /.</p>\n\n<p>I would love some help.\nThank you in advance!</p>\n"}, {"tags": ["c", "arrays", "queue", "output"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1484761655, "post_id": 41725924, "comment_id": 70646739, "body": "unrelated .. you don&#39;t need the <code>fflush (stdout);</code>. <code>printf</code> is line-buffered, so when it sees a <code>\\n</code> character (which you have) it flushes its buffer to <code>stdout</code>."}, {"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1484763390, "post_id": 41725924, "comment_id": 70647729, "body": "Thank you, yano, for the info. Does it lower performance, when I add fflush (stdout) where it is not necessary?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1484765101, "post_id": 41725924, "comment_id": 70648670, "body": "hmm, good question. You&#39;d have to check the generated assembly, but I suspect yes, adding <code>fflush(stdout);</code> here would add extra (unnecessary) instructions and thus lower performace. I don&#39;t <i>think</i> the compiler would optimize that out (even if it looked at the <code>printf</code> string and saw the <code>&#39;\\n&#39;</code> at the end, it would have to be sure nothing else had written to <code>stdout</code> by that time). But I&#39;m just thinking out loud, somebody smarter than me will need to answer."}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484762047, "post_id": 41726039, "comment_id": 70646944, "body": "O. k., that was an stupid mistake... Thank you! Can not give you an upvote, because of my low reputation."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 0, "last_activity_date": 1484761408, "creation_date": 1484761408, "answer_id": 41726039, "question_id": 41725924, "link": "https://stackoverflow.com/questions/41725924/has-anyone-an-idea-how-this-weird-output-of-my-c-program-occurs/41726039#41726039", "title": "Has anyone an idea how this weird output of my C program occurs?", "body": "<p>You're not printing the element that was just assigned to the array, but the next one. When printf is called the variable last indexes the next element. </p>\n\n<p>In the first MAX loops you print uninitialized elements of the array, and in subsequent loops, you print the values that were assigned in the previous MAX loops.</p>\n"}, {"comments": [{"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484763158, "post_id": 41726114, "comment_id": 70647580, "body": "Thank you (Can not give you an upvote, because of my low reputation), I have corrected this mistake, but now I have another problem (see my edit of first post). Do you have a solution for that, too?"}, {"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484835961, "post_id": 41726114, "comment_id": 70681037, "body": "I&#39;ve got it by myself, why this happened (see EDIT2)."}], "tags": [], "owner": {"reputation": 515, "user_id": 5469885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed99ece1a8fe696f9460c14043f0d09a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Stiffler", "link": "https://stackoverflow.com/users/5469885/robert-stiffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1484761693, "creation_date": 1484761693, "answer_id": 41726114, "question_id": 41725924, "link": "https://stackoverflow.com/questions/41725924/has-anyone-an-idea-how-this-weird-output-of-my-c-program-occurs/41726114#41726114", "title": "Has anyone an idea how this weird output of my C program occurs?", "body": "<p>It is because you update the value of <code>last</code> before you print the result.</p>\n\n<pre><code>last = enqueue_fct (newElem++, array, last);\nprintf (\"array[%d] --&gt; %d\\n\", last, array [last]);\nfflush (stdout);\n</code></pre>\n\n<p><code>enqueue_fct</code> returns the index value of the next element in the array (rolling over at the end of the array). You are using this value to print the element that was just assigned, however after <code>enqueue_fct</code> returns, it points at the next element. </p>\n\n<p>For example, after calling <code>enqueue_fct</code> for the first time with <code>last=0</code>, it assigns <code>last=1</code>. Then you print <code>array[last]</code> which is the second element of the array, not the first.Since the array is uninitialized, you'll get garbage out.</p>\n"}, {"comments": [{"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484763170, "post_id": 41726303, "comment_id": 70647586, "body": "Thank you (Can not give you an upvote, because of my low reputation), I have corrected this mistake, but now I have another problem (see my edit of first post). Do you have a solution for that, too?"}, {"owner": {"reputation": 4452, "user_id": 1782782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/99Sl0.jpg?s=128&g=1", "display_name": "Pierre Fran&#231;ois", "link": "https://stackoverflow.com/users/1782782/pierre-fran%c3%a7ois"}, "reply_to_user": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484768636, "post_id": 41726303, "comment_id": 70650649, "body": "No, no, the statement &#171; printf (&quot;array[%d] --&gt; %d\\n&quot;, last, array [last-1]); &#187; makes no sense; keep it this way: array[last] but add the variable newlast as I told you."}, {"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484774308, "post_id": 41726303, "comment_id": 70653679, "body": "Yes, [last-1] was my own try, after the answer of the user 2501, which solved my first problem but caused a new one. After that, I tried your answer and it works fine and stays this way in my program, thanks. But I&#39;m still interested, why the [last-1] causes the &#39;1&#39; at each array[0]. Can you tell me?"}, {"owner": {"reputation": 4452, "user_id": 1782782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/99Sl0.jpg?s=128&g=1", "display_name": "Pierre Fran&#231;ois", "link": "https://stackoverflow.com/users/1782782/pierre-fran%c3%a7ois"}, "reply_to_user": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484815219, "post_id": 41726303, "comment_id": 70667776, "body": "Without my modification, your [last - 1] would work only if you change in a consistent way both parameters of the printf function in this way: &#171; printf (&quot;array[%d] --&gt; %d\\n&quot;, last - 1, array [last-1]); &#187;"}, {"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484834682, "post_id": 41726303, "comment_id": 70680142, "body": "No, this change makes no difference in relation to the problem, that at every output of array[0] the result is &#39;1&#39; and not &#39;4&#39;, &#39;9&#39;, &#39;14&#39;, &#39;19&#39;, like I would expect. It&#39;s a complete mystery for me, why this happens."}, {"owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "edited": false, "score": 0, "creation_date": 1484835669, "post_id": 41726303, "comment_id": 70680850, "body": "I&#39;ve got it by myself, why this happened (see EDIT2)."}], "tags": [], "owner": {"reputation": 4452, "user_id": 1782782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/99Sl0.jpg?s=128&g=1", "display_name": "Pierre Fran&#231;ois", "link": "https://stackoverflow.com/users/1782782/pierre-fran%c3%a7ois"}, "is_accepted": false, "score": 0, "last_activity_date": 1484815410, "last_edit_date": 1484815410, "creation_date": 1484762288, "answer_id": 41726303, "question_id": 41725924, "link": "https://stackoverflow.com/questions/41725924/has-anyone-an-idea-how-this-weird-output-of-my-c-program-occurs/41726303#41726303", "title": "Has anyone an idea how this weird output of my C program occurs?", "body": "<p>Perhaps you mean this:</p>\n\n<pre><code>int main (void)\n{\n    int newElem = 0;\n    int array [MAX];\n    int last = 0;\n    int i, newlast;\n\n    for (i = 0; i &lt; 20; i++)\n    {\n        newlast = enqueue_fct (newElem++, array, last);\n        printf (\"array[%d] --&gt; %d\\n\", last, array [last]);\n        last = newlast;\n    }\n\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 7436464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eaf66d8cc896d6c3598f76961a8f5495?s=128&d=identicon&r=PG&f=1", "display_name": "a kind person", "link": "https://stackoverflow.com/users/7436464/a-kind-person"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 41726039, "answer_count": 3, "score": 1, "last_activity_date": 1484835581, "creation_date": 1484760975, "last_edit_date": 1484835581, "question_id": 41725924, "link": "https://stackoverflow.com/questions/41725924/has-anyone-an-idea-how-this-weird-output-of-my-c-program-occurs", "title": "Has anyone an idea how this weird output of my C program occurs?", "body": "<p>I do not understand, why the following C-code leads to the following output. </p>\n\n<p>I want to program an array-queue and what I have done allready is to write the function \"enqueue_fct\" which adds new elements to the queue and \"loops\" the array.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX 5\n\nint enqueue_fct (int newElem_e, int * array_e, int last_e)\n    {\n    array_e [last_e] = newElem_e;\n    last_e = (last_e + 1) % MAX;\n    return (last_e);\n    }\n\nint main (void)\n    {\n    int newElem = 0;\n    int array [MAX];\n    int last = 0;\n    int i;\n\n    for (i = 0; i &lt; 20; i++)\n    {\n    last = enqueue_fct (newElem++, array, last);\n    printf (\"array[%d] --&gt; %d\\n\", last, array [last]);\n    fflush (stdout);\n    }\n\n    return (EXIT_SUCCESS);\n    }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>array[1] --&gt; 0\narray[2] --&gt; -13210\narray[3] --&gt; 0\narray[4] --&gt; 0\narray[0] --&gt; 0\narray[1] --&gt; 1\narray[2] --&gt; 2\narray[3] --&gt; 3\narray[4] --&gt; 4\narray[0] --&gt; 5\narray[1] --&gt; 6\narray[2] --&gt; 7\narray[3] --&gt; 8\narray[4] --&gt; 9\narray[0] --&gt; 10\narray[1] --&gt; 11\narray[2] --&gt; 12\narray[3] --&gt; 13\narray[4] --&gt; 14\narray[0] --&gt; 15\n</code></pre>\n\n<p>From the fifth line on the output is what i expected, but what about the first four lines? I do not mean, why it does not start with \"array[0]\", it is clear why this is the case. But I do not get, where the \"0, -13210, 0, 0\" comes from, before the correct output starts with the second \"loop\" of the array.</p>\n\n<p>I am a beginner, so if there is a very stupid mistake in the code, be lenient with me and please try to explain in simple words a beginner can understand ;-)</p>\n\n<p>Thank you very much for your help!</p>\n\n<p>P. S.: \nI am using Eclipse Neon.2 Release (4.6.2) with newest cygwin gcc compiler on Windows 10 64bit.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Because of 2501s answer I corrected my code and added a <strong>-1</strong> to the printf statement.</p>\n\n<pre><code>printf (\"array[%d] --&gt; %d\\n\", last, array [last-1]);\n</code></pre>\n\n<p>Now there is another problem in the output, which I do not understand:</p>\n\n<pre><code>array[1] --&gt; 0\narray[2] --&gt; 1\narray[3] --&gt; 2\narray[4] --&gt; 3\narray[0] --&gt; 1\narray[1] --&gt; 5\narray[2] --&gt; 6\narray[3] --&gt; 7\narray[4] --&gt; 8\narray[0] --&gt; 1\narray[1] --&gt; 10\narray[2] --&gt; 11\narray[3] --&gt; 12\narray[4] --&gt; 13\narray[0] --&gt; 1\narray[1] --&gt; 15\narray[2] --&gt; 16\narray[3] --&gt; 17\narray[4] --&gt; 18\narray[0] --&gt; 1\n</code></pre>\n\n<p>Why is array[0] always '1' and not '4', '9', '14', '19'? Sorry, as I said, I'm a beginner...   </p>\n\n<p><strong>EDIT2:</strong></p>\n\n<p>I've got it by myself: When 'last' becomes '0' at the beginning of a loop \"array [last-1]\" is \"array [-1]\", which is not part of the array, so the '1' ist junk-data. </p>\n\n<p>Everyone starts as complete programming noob ;-) </p>\n"}, {"tags": ["c++", "c", "r"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 3, "creation_date": 1484759773, "post_id": 41725476, "comment_id": 70645692, "body": "<i>&quot;The existing solutions for this type of problem did not help me.&quot;</i> - We ain&#39;t mind readers. We don&#39;t know which solutions you have tried that apparently didn&#39;t help. Anyway, you are loading a 64-bit module into a 32-bit process. This isn&#39;t going to end well. You&#39;ll have to get a hold of a 32-bit module."}], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 7158505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ucFS3.jpg?s=128&g=1", "display_name": "Eduard Malakhov", "link": "https://stackoverflow.com/users/7158505/eduard-malakhov"}, "is_accepted": false, "score": -1, "last_activity_date": 1484760092, "creation_date": 1484760092, "answer_id": 41725679, "question_id": 41725476, "link": "https://stackoverflow.com/questions/41725476/loadlibrary-failure-1-is-not-a-valid-win32-application-in-r/41725679#41725679", "title": "LoadLibrary failure: %1 is not a valid Win32 application. in R", "body": "<p>Such errors often refer to architecture mismatch, apparently when one tries to load a x86-64 module on a x86 machine. Please, make sure that on the x86 machine you're loading a .dll compiled specifically for the x86 architecture.</p>\n"}], "owner": {"reputation": 29, "user_id": 7436887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b345e0f366046789fb9c8f8d4aa21f57?s=128&d=identicon&r=PG&f=1", "display_name": "Quincy", "link": "https://stackoverflow.com/users/7436887/quincy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4652, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484768353, "creation_date": 1484759550, "last_edit_date": 1484768353, "question_id": 41725476, "link": "https://stackoverflow.com/questions/41725476/loadlibrary-failure-1-is-not-a-valid-win32-application-in-r", "title": "LoadLibrary failure: %1 is not a valid Win32 application. in R", "body": "<p>I have a C code which is loaded through R for my project. Using dyn.load, I was able to load the C code in Windows 64 bit machine and Linux server. However, I am getting the following error when I try to load .dll in Windows 32bit machine. </p>\n\n<p><a href=\"https://i.stack.imgur.com/t68fR.png\" rel=\"nofollow noreferrer\">R error while using dyn.load</a></p>\n\n<p>I tried using the whole path, running the dyn.load command from working directory but none of them worked. \nMy R version:\n<a href=\"https://i.stack.imgur.com/RWEYC.png\" rel=\"nofollow noreferrer\">R version</a></p>\n\n<p>Also, I have edited the system variables and below you can find the system variables.</p>\n\n<pre><code>`C:\\ProgramData\\Oracle\\Java\\javapath;\n%SystemRoot%\\system32;\n%SystemRoot%;\n%SystemRoot%\\System32\\Wbem;\n%SYSTEMROOT%\\System32\\WindowsPowerShell\\v1.0\\;\nC:\\Program Files\\Common Files\\Roxio Shared\\DLLShared\\;\nC:\\Program Files\\Common Files\\Roxio Shared\\10.0\\Roxio Central36;\nC:\\Program Files\\Windows Imaging\\;\nC:\\Program Files\\QuickTime\\QTSystem\\;\nC:\\Program Files\\R\\R-3.3.2\\bin;\nC:\\Rtools\\bin;\nC:\\Rtools\\mingw_32\\bin;\nC:\\Rtools\\mingw_32\\lib\\gcc\\i686-w64-mingw32\\4.9.3;\nC:\\Users\\******\\Documents\\R\\R-3.3.2\\library\\Rcpp`\n</code></pre>\n\n<p>The existing solutions for this type of problem did not help me.</p>\n\n<p>It would be great if someone can help me solve this problem.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 3, "creation_date": 1484759245, "post_id": 41725183, "comment_id": 70645359, "body": "Searching for a solution will be far more fruitful than asking for a solution. See <a href=\"https://stackoverflow.com/help\">help center</a> for the purpose/scope of SO"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 2, "creation_date": 1484760741, "post_id": 41725183, "comment_id": 70646252, "body": "Too many issues about what sort of environment you have. Needing to run something at fairly coarse intervals (in computer terms) is a common enough requirement, but there are many ways of achieving it."}], "answers": [{"tags": [], "owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "is_accepted": true, "score": 0, "last_activity_date": 1484937664, "creation_date": 1484937664, "answer_id": 41770365, "question_id": 41725183, "link": "https://stackoverflow.com/questions/41725183/c-how-can-i-execute-a-method-every-x-seconds/41770365#41770365", "title": "C - How can i execute a method every X seconds?", "body": "<p>Ended up spawning a new thread and doing stuff that way.</p>\n"}], "owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 2, "accepted_answer_id": 41770365, "answer_count": 1, "score": -2, "last_activity_date": 1484937664, "creation_date": 1484758657, "last_edit_date": 1484759615, "question_id": 41725183, "link": "https://stackoverflow.com/questions/41725183/c-how-can-i-execute-a-method-every-x-seconds", "title": "C - How can i execute a method every X seconds?", "body": "<p>Probably really trivial question, but:</p>\n\n<p>Recently started working an open-source system - <a href=\"https://github.com/meetecho/janus-gateway\" rel=\"nofollow noreferrer\">janus-gateway</a> and i am in a need to run a method every 1 second(checking if all users muted). </p>\n\n<p>What are the options to do this in C?\nShould i spawn a new thread?</p>\n\n<p>Answer with an example would much appreciated!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484758348, "post_id": 41724977, "comment_id": 70644759, "body": "Perhaps your <code>my_printf</code> is broken? Or the segfault is not happening? BTW, if <code>execve</code> is successful you will never get to the <code>signal</code> function at all..."}, {"owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484758445, "post_id": 41724977, "comment_id": 70644831, "body": "Even with a normal printf, it doesn&#39;t work. And if I launch the specified program with bash, it segfaults !"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1484758503, "post_id": 41724977, "comment_id": 70644868, "body": "As I said in the update: <code>execve</code> is not returning if successful."}, {"owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484758595, "post_id": 41724977, "comment_id": 70644940, "body": "Thanks but if you relook at the code you&#39;ll see that signal is out of the condition statement."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484759558, "post_id": 41724977, "comment_id": 70645541, "body": "So? It won&#39;t ever get there."}, {"owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484759765, "post_id": 41724977, "comment_id": 70645688, "body": "Why not ? The program doesn&#39;t exit if there&#39;s a segfault"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484759954, "post_id": 41724977, "comment_id": 70645803, "body": "You call <code>execve</code> <b>before</b> you call <code>signal</code>. Do you agree?"}, {"owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484759977, "post_id": 41724977, "comment_id": 70645824, "body": "Yes but if I don&#39;t how am I supposed to handle the error ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484760197, "post_id": 41724977, "comment_id": 70645951, "body": "Like this: <a href=\"http://stackoverflow.com/questions/7339664/c-catch-a-segfault-in-exec-which-was-run-in-a-child-process\" title=\"c catch a segfault in exec which was run in a child process\">stackoverflow.com/questions/7339664/&hellip;</a> BTW, I think it&#39;s a duplicate..."}, {"owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484760313, "post_id": 41724977, "comment_id": 70646017, "body": "Nop, like I said, I have to use signal function. I can&#39;t use any other function..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1484760399, "post_id": 41724977, "comment_id": 70646055, "body": "Good luck then. You will need it."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484760663, "post_id": 41724977, "comment_id": 70646197, "body": "What is this <code>if</code>-statement for: <code>if (signal(SIGSEGV, segf_handler) == SIG_ERR);</code>"}, {"owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "edited": false, "score": 0, "creation_date": 1484760700, "post_id": 41724977, "comment_id": 70646223, "body": "It&#39;s a a precaution because when my problem will be solved, I suppose that I&#39;ll need it."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484760760, "post_id": 41724977, "comment_id": 70646261, "body": "The moment an <code>exec*()</code> was successful any signal handler established by the process calling the <code>exec*()</code> function is gone, as the successful call to <code>exec*()</code> replaced the whole process with the process <code>exec*()</code>ed"}], "answers": [{"comments": [{"owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "edited": false, "score": 0, "creation_date": 1484761781, "post_id": 41725958, "comment_id": 70646817, "body": "This solved my problem because it caused me to ask someone to know if I could use the macros and I could ! Thanks !"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 3, "last_activity_date": 1484761101, "creation_date": 1484761101, "answer_id": 41725958, "question_id": 41724977, "link": "https://stackoverflow.com/questions/41724977/sigsegv-signal-handling-in-a-child-process/41725958#41725958", "title": "SIGSEGV signal handling in a child process", "body": "<p>You can't catch the SEGV signal inside the child because calling execve replaces the code running in the child with that program.</p>\n\n<p>You can however catch the CHLD signal in the parent when the child process dies. You'll need to examine the status returned from wait() to see how/why it died though.</p>\n"}], "owner": {"reputation": 705, "user_id": 5770601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fcff4e00f6308d83beb849e557a2820?s=128&d=identicon&r=PG&f=1", "display_name": "Orionss", "link": "https://stackoverflow.com/users/5770601/orionss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1220, "favorite_count": 0, "closed_date": 1484761799, "accepted_answer_id": 41725958, "answer_count": 1, "score": 1, "last_activity_date": 1484761101, "creation_date": 1484758096, "last_edit_date": 1484758485, "question_id": 41724977, "link": "https://stackoverflow.com/questions/41724977/sigsegv-signal-handling-in-a-child-process", "closed_reason": "Duplicate", "title": "SIGSEGV signal handling in a child process", "body": "<p>I have a program that creates a fork that uses execve to run a program that have a SegFault and exit after catching the signal. In my signal handler, I should obtain \"Segmentation fault (Core dumped)\" but nothing is written. So I'm asking : how to handle a segfault signal in a child process ? My code is the following : </p>\n\n<pre><code>int     child_management(char **env, char **arguments)\n{\n  char  **paths;\n  char  *current_path;\n  char  *target_path;\n  int   found;\n  int   i;\n\n  i = -1;\n  found = 0;\n  paths = get_paths(env);\n  if (execve(arguments[0], arguments, env) == -1)\n    {\n      while (paths[++i] != NULL)\n        {\n          current_path = my_strcat(paths[i], \"/\");\n          target_path = my_strcat(current_path, arguments[0]);\n          found = (execve(target_path, arguments, env) == -1 &amp;&amp; found == 0) ? 0 : 1;\n          free(current_path);\n          free(target_path);\n        }\n      if (!found &amp;&amp; !is_existing_builtin(arguments[0]))\n        my_printf(\"%s: Command not found.\\n\", arguments[0]);\n    }\n  free(arguments);\n  free(paths);\n  if (signal(SIGSEGV, segf_handler) == SIG_ERR);\n  exit(0);\n}\n\nvoid    segf_handler()\n{\n  my_printf(\"Segmentation fault (Core dumped)\\n\");\n}\n\nint     execute_program(char *str, char **av, char **env)\n{\n  pid_t pid;\n  char  **arguments;\n\n  pid = fork();\n  arguments = my_str_explode(str, ' ');\n  if (pid &gt; 0)\n    {\n      parent_management(pid, arguments, env);\n    }\n  else if (pid == 0)\n    {\n      child_management(env, arguments);\n    }\n}\n</code></pre>\n\n<p>Please notice that I am doing an exercice and I'm not allowed to use another function than signal so don't tell me about sigaction </p>\n"}, {"tags": ["c", "arrays", "typedef"], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1484758755, "last_edit_date": 1484758755, "creation_date": 1484758374, "answer_id": 41725084, "question_id": 41724938, "link": "https://stackoverflow.com/questions/41724938/an-array-which-takes-multiple-elements-of-different-data-type/41725084#41725084", "title": "an array which takes multiple elements of different data type", "body": "<p>In your code, for all the usage like</p>\n\n<pre><code> scanf(\"%s\",&amp;info1.name);\n             ^^^^^\n</code></pre>\n\n<p>are wrong, as <code>info</code> is an alias to a datatype, not a variable.</p>\n\n<p>You have already defined a variable of that type, <code>print</code>, make use of that.</p>\n"}, {"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1484768808, "creation_date": 1484768808, "answer_id": 41728166, "question_id": 41724938, "link": "https://stackoverflow.com/questions/41724938/an-array-which-takes-multiple-elements-of-different-data-type/41728166#41728166", "title": "an array which takes multiple elements of different data type", "body": "<pre><code>struct Student\n{\n    char name[50];\n    int number;\n};\n</code></pre>\n\n<p>This is fine and unexceptional</p>\n\n<pre><code> typedef struct Student info1;\n info1 print[100];\n</code></pre>\n\n<p>This strongly suggests to me you don't know what you are doing. info1 is now an alias for struct Student. Rather an odd name. Then you are creating a buffer called print with a capacity of a hundred. </p>\n\n<p>We can easily fix your compile time errors. You can assign a strudnet</p>\n\n<pre><code> struct Student astudent;   \n\n print[i] = astudent;  \n</code></pre>\n\n<p>and you have to initialise him first</p>\n\n<pre><code>  scanf(\"%s %d\", astudent.name, &amp;astudent.number);\n</code></pre>\n\n<p>but you can't assign to the type \"info1\". And \"print\" is a very poor choice for an array of students. Make it \"printlist\" at least.</p>\n"}], "owner": {"reputation": 11, "user_id": 7436803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JpjaQ-KaPs0/AAAAAAAAAAI/AAAAAAAAAF4/XDfzn4iqFD0/photo.jpg?sz=128", "display_name": "nakul nair", "link": "https://stackoverflow.com/users/7436803/nakul-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1484768808, "creation_date": 1484757994, "last_edit_date": 1484758816, "question_id": 41724938, "link": "https://stackoverflow.com/questions/41724938/an-array-which-takes-multiple-elements-of-different-data-type", "title": "an array which takes multiple elements of different data type", "body": "<p>I want to take information of a class which contains student name,roll no. and print it\nI used structure but code not working</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint size,i,j;\n\nstruct Student\n{\n    char name[50];\n    int number;\n};\n\ntypedef struct Student info1;\ninfo1 print[100];\n\nint main()\n{\n     printf(\"Size of class : \");\n     scanf(\"%d\",&amp;size);\n\n\n    for(j=0;j&lt;(20);)\n    {\n        for(i=1;i&lt;=size;i++)\n        {\n\n            printf(\"%d.Name:\",i);\n            scanf(\"%s\",&amp;info1.name);// i get an error here that an exp is expected\n            print[j]=info1.name; // i get an error here that an exp is expected\n            j++;\n            printf(\"Rollno:\");\n            scanf(\"%d\", &amp;info1.number);// i get an error here that an exp is expected\n            print[j]=info1.number;// i get an error here that an exp is expected\n\n        }\n\n    }   \n    for (j = 0;j &lt;(20);)\n    {\n        printf(\"%s Name\", print[j]);\n        j++;\n        printf(\"%d Rollno\", print[j]);\n    }\n\n    return 0;  \n}\n</code></pre>\n\n<p>while debugging I get the following errors:</p>\n\n<blockquote>\n  <p>expected exp before info1</p>\n</blockquote>\n"}, {"tags": ["c", "struct", "cobol", "unions"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 4, "creation_date": 1484757591, "post_id": 41724735, "comment_id": 70644183, "body": "There is no language called C/C++. There is either C, or C++. What you have written (and asking about) is C."}, {"owner": {"reputation": 574, "user_id": 3049983, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Tebxd.jpg?s=128&g=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/3049983/rohit"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1484757682, "post_id": 41724735, "comment_id": 70644248, "body": "Yes I know :). I mentioned it just for tagging purpose. Thank you."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1484757733, "post_id": 41724735, "comment_id": 70644281, "body": "C strings are null terminated"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 4, "creation_date": 1484757739, "post_id": 41724735, "comment_id": 70644285, "body": "@Rohit Don&#39;t spam tags. Only tag what is relevant. C++ was <b>not</b> relevant in your question."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1484758298, "post_id": 41724735, "comment_id": 70644718, "body": "After adding NULs, <code>date_mmddyy</code> and <code>system_date_mmddyy</code> are no longer equal. In the first you have &quot;01\\018\\017\\0&quot; and in the second &quot;011817\\0&quot;."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1484758494, "post_id": 41724735, "comment_id": 70644858, "body": "Try: <code>strcpy(redef.date_mmddyy.date_mm, &quot;01&quot;);</code>  --&gt;&gt; <code>memcpy(redef.date_mmddyy.date_mm, &quot;01&quot;, 2);</code> (similar for dd and yy)"}, {"owner": {"reputation": 12672, "user_id": 1927206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434140a485dca639d56237db0fbeef54?s=128&d=identicon&r=PG", "display_name": "Bill Woodger", "link": "https://stackoverflow.com/users/1927206/bill-woodger"}, "edited": false, "score": 0, "creation_date": 1484762672, "post_id": 41724735, "comment_id": 70647280, "body": "Does C have any &quot;substring&quot; capability? In COBOL, those are not &quot;strings&quot;, they are just data. I assume &quot;substring&quot; use would not dictate that the source is a string. Can you give a better example of what you want to do? This REDEFINES is &quot;fake&quot;. DATE-MMDDYY could be used directly to get your six-byte data. Your major issue is trying to output the data as &quot;already strings&quot;."}, {"owner": {"reputation": 12672, "user_id": 1927206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434140a485dca639d56237db0fbeef54?s=128&d=identicon&r=PG", "display_name": "Bill Woodger", "link": "https://stackoverflow.com/users/1927206/bill-woodger"}, "edited": false, "score": 1, "creation_date": 1484762740, "post_id": 41724735, "comment_id": 70647330, "body": "GnuCOBOL (SourceForge.Net) compiles to C. You could get yourself a copy, generate the C code for your COBOL program, and look at how that deals with a more realistic REDEFINES."}, {"owner": {"reputation": 484, "user_id": 972091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f80467e7392483c79d28f061f2fd38?s=128&d=identicon&r=PG", "display_name": "Scott Nelson", "link": "https://stackoverflow.com/users/972091/scott-nelson"}, "edited": false, "score": 2, "creation_date": 1484836472, "post_id": 41724735, "comment_id": 70681406, "body": "The first union was correct, but COBOL PIC X(nn) fields are <i>not</i> NUL terminated, so using strcpy will not work right.  You could use memcpy instead of strcpy so that you can copy the data without the trailing NULs."}, {"owner": {"reputation": 4615, "user_id": 5027456, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4402d93af57510a743974c4b2062720?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Sobisch", "link": "https://stackoverflow.com/users/5027456/simon-sobisch"}, "edited": false, "score": 0, "creation_date": 1509486150, "post_id": 41724735, "comment_id": 81037281, "body": "@Rohit Did the provided answer &quot;worked for you&quot;? If yes: please accept as working answer, if there&#39;s something unclear add this in its comment and I&#39;ll try to add the missing bits. stackoverflow.com/help/someone-answers"}], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 3049983, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Tebxd.jpg?s=128&g=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/3049983/rohit"}, "edited": false, "score": 0, "creation_date": 1484758122, "post_id": 41724866, "comment_id": 70644574, "body": "Updated with your suggestion. That doesn&#39;t help either. :("}, {"owner": {"reputation": 1741, "user_id": 2487023, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b43fedcd2290573209fdc2a0cc0c03fd?s=128&d=identicon&r=PG", "display_name": "koalo", "link": "https://stackoverflow.com/users/2487023/koalo"}, "reply_to_user": {"reputation": 574, "user_id": 3049983, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Tebxd.jpg?s=128&g=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/3049983/rohit"}, "edited": false, "score": 0, "creation_date": 1484758224, "post_id": 41724866, "comment_id": 70644650, "body": "No that makes it worse ;-) This is because now the positions in the string do no longer match. Actually it does not seem to be sensible in C to do it with a union. I will add a suggestion in an edit."}], "tags": [], "owner": {"reputation": 1741, "user_id": 2487023, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b43fedcd2290573209fdc2a0cc0c03fd?s=128&d=identicon&r=PG", "display_name": "koalo", "link": "https://stackoverflow.com/users/2487023/koalo"}, "is_accepted": false, "score": 1, "last_activity_date": 1484759024, "last_edit_date": 1484759024, "creation_date": 1484757798, "answer_id": 41724866, "question_id": 41724735, "link": "https://stackoverflow.com/questions/41724735/implement-cobol-redefines-in-c/41724866#41724866", "title": "Implement COBOL REDEFINES in C", "body": "<p>The problem is the output itself. In C all strings (at least those that you want to print with printf(\"%s\",...)) need a 0 byte at the end. Since your \"strings\" are meant to have a fixed length of 2 or 6 bytes, this will not work, because every of the 2 byte \"strings\" would require a third byte to finalize the string.</p>\n\n<p>So, actually it \"works\", but the result is an array of characters and that is something different than a string in C, so you can not use the usual string operations.</p>\n\n<p>It is not what you want to hear, but I would suggest to forget about the strings and work with integers and use conversion functions. For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Date {\n    int day, month, year;\n};\n\nvoid dateFromString(char* input, struct Date* output) {\n    char tmp[3];\n    tmp[2] = '\\0';\n    memcpy(tmp, &amp;input[0], 2);\n    output-&gt;day = atoi(tmp);\n    memcpy(tmp, &amp;input[2], 2);\n    output-&gt;month = atoi(tmp);\n    memcpy(tmp, &amp;input[4], 2);\n    output-&gt;year = atoi(tmp);\n}\n\nvoid stringFromDate(struct Date* input, char* output) {\n    sprintf(output,\"%02i%02i%02i\",input-&gt;day,input-&gt;month,input-&gt;year);\n}\n\nint main() {\n    char text[] = \"120456\";\n    struct Date d;\n    dateFromString(text, &amp;d);\n\n    printf(\"%i\\n\",d.day);\n    printf(\"%i\\n\",d.month);\n    printf(\"%i\\n\",d.year);\n\n    char buffer[7];\n    stringFromDate(&amp;d,buffer);\n    printf(\"%s\\n\",buffer);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1484758351, "post_id": 41725048, "comment_id": 70644763, "body": "It <b>was</b> working before the update. And you mean &#39;&quot;%.2s&#39;&quot;"}], "tags": [], "owner": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "is_accepted": false, "score": 2, "last_activity_date": 1484758290, "creation_date": 1484758290, "answer_id": 41725048, "question_id": 41724735, "link": "https://stackoverflow.com/questions/41724735/implement-cobol-redefines-in-c/41725048#41725048", "title": "Implement COBOL REDEFINES in C", "body": "<p>Your union is working. The problem comes from missing NULL terminator character in your string when you are displaying the structure fields.</p>\n\n<p>If you don't want to modify your structure, maybe could you adapt the format qualifiers.</p>\n\n<pre><code>printf(\"%2s\\n\",redef.date_mmddyy.date_mm);\nprintf(\"%2s\\n\",redef.date_mmddyy.date_dd);\nprintf(\"%2s\\n\",redef.date_mmddyy.date_yy);\nprintf(\"%6s\\n\",redef.system_date_mmddyy);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4615, "user_id": 5027456, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4402d93af57510a743974c4b2062720?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Sobisch", "link": "https://stackoverflow.com/users/5027456/simon-sobisch"}, "is_accepted": false, "score": 4, "last_activity_date": 1484906399, "last_edit_date": 1495540375, "creation_date": 1484764352, "answer_id": 41726913, "question_id": 41724735, "link": "https://stackoverflow.com/questions/41724735/implement-cobol-redefines-in-c/41726913#41726913", "title": "Implement COBOL REDEFINES in C", "body": "<p>If you want to use the <code>REDEFINE</code> logic from COBOL in C there is only one option: <strong>Don't use C strings for COBOL storage as COBOL data is using only character arrays for data structure.</strong>\nand:\n<strong>Be aware of <a href=\"https://stackoverflow.com/questions/4306186/structure-padding-and-packing\">structure padding</a></strong>(for any item not declared as <code>PIC X</code>)!</p>\n\n<p>This would lead to something like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunion redef\n{\n        struct date_mmddyy{\n               char date_mm[2];\n               char date_dd[2];\n               char date_yy[2];\n        }date_mmddyy;\n        char system_date_mmddyy[6];\n};\ntypedef union redef redef;\nint main(){\n        redef redef;\n        redef.date_mmddyy.date_mm[0] = '0';\n        redef.date_mmddyy.date_mm[1] = '1';\n        redef.date_mmddyy.date_dd[0] = '1';\n        redef.date_mmddyy.date_dd[1] = '8';\n        redef.date_mmddyy.date_yy[0] = '1';\n        redef.date_mmddyy.date_yy[1] = '7';\n        // or:\n        memcpy((void *)redef.date_mmddyy, (void *)\"011817\", 6);\n\n        printf(\"%c%c\\n\",redef.date_mmddyy.date_mm[0],\n                        redef.date_mmddyy.date_mm[1]);\n        [...]\n</code></pre>\n\n<p>To make this actually usable you'd likely use two things:</p>\n\n<ul>\n<li>additional to the struct which contains the data add a field structure containing at least a pointer to the storage, the size and the type (in your sample 'x' and 'numeric-display' are enough</li>\n<li>add helper functions to set/get a field value</li>\n</ul>\n\n<p>Something like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nenum cob_type {\n    T_DISPLAY = 0, \n    T_NUMERIC_DISPLAY\n};\n\nstruct cob_field{\n       char *data;\n       int size;\n       enum cob_type;     \n};\n\n/* one for the actual storage - could be a simple unnamed char array */\nstruct date_mmddyy{\n       char date_mm[2];\n       char date_dd[2];\n       char date_yy[2];\n} date_mmddyy;\n\n/* fields with pointers to the storage and the size */\ncob_field date_mmddyy = {&amp;date_mmddyy, 6, T_DISPLAY};\ncob_field date_mm     = {&amp;date_mmddyy.date_mm, 2, T_NUMERIC_DISPLAY};\ncob_field date_dd     = {&amp;date_mmddyy.date_dd, 2, T_NUMERIC_DISPLAY};\ncob_field date_yy     = {&amp;date_mmddyy.date_yy, 2, T_NUMERIC_DISPLAY};\ncob_field system_date_mmddyy = {&amp;date_mmddyy, 6, T_DISPLAY};\n\nint main(){\n        set_field_data(system_date_mmddyy, \"011817\");\n        printf(\"SYSTEM-DATE-MMDDYY: %s\\n', get_field_data(system_date_mmddyy));\n        printf(\"DATE-MM: %s\\n', get_field_data(date_mm));\n        printf(\"DATE-DD: %s\\n', get_field_data(date_dd));\n        printf(\"DATE-YY: %s\\n', get_field_data(date_yy));\n\n        puts(\"CHANGING DATE-YY = 18\");\n        set_field_data(date_yy, \"18\");\n        printf(\"SYSTEM-DATE-MMDDYY: %s\\n', get_field_data(system_date_mmddyy));\n\n        return 0;\n}\n</code></pre>\n\n<p>Given that COBOL has many different types you'd need to write lots of logic in the helper functions - the ones needed here <code>void set_field (cob_field *f, char *data)</code> and <code>char *get_field (cob_field *f)</code> are quite simply, this changes when using all types COBOL has, gets much more complicated when using more than <code>MOVE</code> from literal (adding implicit type conversions) and <code>DISPLAY</code>.</p>\n\n<p>BTW: You may want to check <a href=\"https://www.gnu.org/software/gnucobol/\" rel=\"nofollow noreferrer\">GnuCOBOL</a> - it translates COBOL to C...</p>\n"}], "owner": {"reputation": 574, "user_id": 3049983, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Tebxd.jpg?s=128&g=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/3049983/rohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1484906399, "creation_date": 1484757485, "last_edit_date": 1484758058, "question_id": 41724735, "link": "https://stackoverflow.com/questions/41724735/implement-cobol-redefines-in-c", "title": "Implement COBOL REDEFINES in C", "body": "<p>I am trying to implement REDEFINES logic used in COBOL in C language.</p>\n\n<p>Below is the COBOL Program:</p>\n\n<pre><code>   IDENTIFICATION DIVISION.\n   ENVIRONMENT DIVISION.\n   DATA DIVISION.\n   WORKING-STORAGE SECTION.\n\n   01  DATE-MMDDYY.\n       10  DATE-MM               PIC 9(02).\n       10  DATE-DD               PIC 9(02).\n       10  DATE-YY               PIC 9(02).\n   01  SYSTEM-DATE-MMDDYY REDEFINES DATE-MMDDYY PIC X(6).\n\n   PROCEDURE DIVISION.\n\n       MOVE '011817' TO SYSTEM-DATE-MMDDYY.\n       DISPLAY 'SYSTEM-DATE-MMDDYY: ' SYSTEM-DATE-MMDDYY.\n       DISPLAY 'DATE-MM: ' DATE-MM.\n       DISPLAY 'DATE-DD: ' DATE-DD.\n       DISPLAY 'DATE-YY: ' DATE-YY.\n\n       DISPLAY 'CHANGING DATE-YY = 18'\n       MOVE '18' TO DATE-YY.\n       DISPLAY 'New SYSTEM-DATE-MMDDYY: ' SYSTEM-DATE-MMDDYY.\n\n       STOP RUN.\n</code></pre>\n\n<p>And below is the execution of above program:</p>\n\n<pre><code>SYSTEM-DATE-MMDDYY: 011817\nDATE-MM: 01\nDATE-DD: 18\nDATE-YY: 17\nCHANGING DATE-YY = 18\nNew SYSTEM-DATE-MMDDYY: 011818\n</code></pre>\n\n<p>I understand that UNION in C can be used to achieve similar thing. But it is not working for me.</p>\n\n<p>Below is the C program which I wrote:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nunion redef\n{\n        struct date_mmddyy{\n                char date_mm[2];\n                char date_dd[2];\n                char date_yy[2];\n        }date_mmddyy;\n        char system_date_mmddyy[6];\n};\ntypedef union redef redef;\nint main(){\n        redef redef;\n        strcpy(redef.date_mmddyy.date_mm, \"01\");\n        strcpy(redef.date_mmddyy.date_dd, \"18\");\n        strcpy(redef.date_mmddyy.date_yy, \"17\");\n        printf(\"%s\\n\",redef.date_mmddyy.date_mm);\n        printf(\"%s\\n\",redef.date_mmddyy.date_dd);\n        printf(\"%s\\n\",redef.date_mmddyy.date_yy);\n        printf(\"%s\\n\",redef.system_date_mmddyy);\n\n        strcpy(redef.system_date_mmddyy, \"021918\");\n        printf(\"%s\\n\",redef.date_mmddyy.date_mm);\n        printf(\"%s\\n\",redef.date_mmddyy.date_dd);\n        printf(\"%s\\n\",redef.date_mmddyy.date_yy);\n        printf(\"%s\\n\",redef.system_date_mmddyy);\n\n        return 0;\n}\n</code></pre>\n\n<p>And it runs as below:</p>\n\n<pre><code>011817\n1817\n17\n011817\n021918\n1918\n18\n021918\n</code></pre>\n\n<p>Can you please share some idea? </p>\n\n<p><strong>UPDATE 1:</strong></p>\n\n<p>I have terminated all char array with <code>\\0</code> now. Below is the changed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nunion redef\n{\n        struct date_mmddyy{\n                char date_mm[3];\n                char date_dd[3];\n                char date_yy[3];\n        }date_mmddyy;\n        char system_date_mmddyy[7];\n};\ntypedef union redef redef;\nint main(){\n        redef redef;\n        redef.date_mmddyy.date_mm[2] = '\\0';\n        redef.date_mmddyy.date_dd[2] = '\\0';\n        redef.date_mmddyy.date_yy[2] = '\\0';\n        redef.system_date_mmddyy[6] = '\\0';\n\n        strcpy(redef.date_mmddyy.date_mm, \"01\");\n        strcpy(redef.date_mmddyy.date_dd, \"18\");\n        strcpy(redef.date_mmddyy.date_yy, \"17\");\n        printf(\"%s\\n\",redef.date_mmddyy.date_mm);\n        printf(\"%s\\n\",redef.date_mmddyy.date_dd);\n        printf(\"%s\\n\",redef.date_mmddyy.date_yy);\n        printf(\"%s\\n\",redef.system_date_mmddyy);\n\n        strcpy(redef.system_date_mmddyy, \"021918\");\n        printf(\"%s\\n\",redef.date_mmddyy.date_mm);\n        printf(\"%s\\n\",redef.date_mmddyy.date_dd);\n        printf(\"%s\\n\",redef.date_mmddyy.date_yy);\n        printf(\"%s\\n\",redef.system_date_mmddyy);\n\n        return 0;\n}\n</code></pre>\n\n<p>And below is the execution:</p>\n\n<pre><code>01\n18\n17\n01\n021918\n918\n\n021918\n</code></pre>\n\n<p>Output goes far away from what it is in COBOL.</p>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484757476, "post_id": 41724653, "comment_id": 70644103, "body": "The first program never uses <code>i</code> and <code>j</code>, so the compiler simply ignored them."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484757685, "post_id": 41724653, "comment_id": 70644252, "body": "Both of them are undefined behavior."}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484757741, "post_id": 41724653, "comment_id": 70644288, "body": "Try to compile your program to assembler code and you&#39;ll see what @Barmar said: the first program simply has <b>no</b> <code>int</code> varables <code>i</code> and <code>j</code> \u2013 the compiler found them unreferenced, so unnecessary, and removed them."}], "answers": [{"comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1484762041, "post_id": 41724707, "comment_id": 70646941, "body": "Nitpicking: In the standard &quot;implementation defined&quot; means that the implementation must document what it does. Not so here."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1484757398, "creation_date": 1484757398, "answer_id": 41724707, "question_id": 41724653, "link": "https://stackoverflow.com/questions/41724653/c-variable-not-where-i-expect-to-find-it-in-memory/41724707#41724707", "title": "C variable not where I expect to find it in memory", "body": "<p>The location of local variables is implementation defined.  The compiler may put them in any order it deems best.</p>\n\n<p>Making seemingly unrelated code changes such as an extra print statement or changing the optimization level can change how the compiler lays out the variables.</p>\n\n<p>In short, you can't depend on any particular layout of variables in memory.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1484766540, "last_edit_date": 1484766540, "creation_date": 1484757414, "answer_id": 41724712, "question_id": 41724653, "link": "https://stackoverflow.com/questions/41724653/c-variable-not-where-i-expect-to-find-it-in-memory/41724712#41724712", "title": "C variable not where I expect to find it in memory", "body": "<p>You're relying on something<sup>Note 1</sup> which is not specified in C standard. The behaviour cannot be defined. It invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.<sup>Note 2</sup></p>\n\n<p>That said, you should always cast the argument of <code>%p</code> to <code>void *</code>, as the expected type is <code>void *</code> and there's no default promotion for pointers.</p>\n\n<hr>\n\n<p><strong>Note 1:</strong></p>\n\n<p>C does not mention or guarantee the order of allocation of variables / objects in a program. There's no guarantee that they will have consecutive memory locations, either increasing or decreasing. They are purely allowed to have random memory locations, so the <em>theory</em> you're believing in,</p>\n\n<pre><code> for ( pos=&amp;c; pos&lt;=&amp;a; pos++ )\n</code></pre>\n\n<p>does not hold true. An(y) implementation can choose to place (<em>reorder</em>) variable(s) however it does see fit. There's absolutely <strong>no guarantee</strong> of the order of memory address with respect to their definition in the code.</p>\n\n<hr>\n\n<p><strong>Note 2:</strong></p>\n\n<p>For relational operators, quoting <code>C11</code>. chapter \u00a76.5.8, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>When two pointers are compared, the result depends on the relative locations in the\n  address space of the objects pointed to. If two pointers to object types both point to the\n  same object, or both point one past the last element of the same array object, they\n  compare equal. If the objects pointed to are members of the same aggregate object,\n  pointers to structure members declared later compare greater than pointers to members\n  declared earlier in the structure, and pointers to array elements with larger subscript\n  values compare greater than pointers to elements of the same array with lower subscript values. All pointers to members of the same union object compare equal. If the\n  expression <code>P</code> points to an element of an array object and the expression <code>Q</code> points to the\n  last element of the same array object, the pointer expression <code>Q+1</code> compares greater than\n  <code>P</code>. <strong>In all other cases, the behavior is undefined.</strong></p>\n</blockquote>\n\n<p>So, for your case, the comparison <code>pos&lt;=&amp;a;</code> is an attempt to compare two pointers which are neither</p>\n\n<ul>\n<li>pointing to same object</li>\n<li>members of the same aggregate object</li>\n<li>pointers to array elements</li>\n<li>pointers to members of the same union object</li>\n</ul>\n\n<p>In short, they are not within the defined scope and hence, using them as operand of the relational operator invokes undefined behaviour.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484757928, "post_id": 41724892, "comment_id": 70644431, "body": "Sorry to say, but this may mislead people. There&#39;s no inherent &quot;stack&quot; defined in C."}, {"owner": {"reputation": 743, "user_id": 1085203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dXQg1.png?s=128&g=1", "display_name": "ivand58", "link": "https://stackoverflow.com/users/1085203/ivand58"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484825651, "post_id": 41724892, "comment_id": 70674244, "body": "Indeed - &quot;The language does not define any storage allocation facility other than static definition and the stack discipline provided by the local variables of functions;&quot; (The C Programming Language-Brian W. Kernighan, Dennis M. Ritchie)"}], "tags": [], "owner": {"reputation": 743, "user_id": 1085203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dXQg1.png?s=128&g=1", "display_name": "ivand58", "link": "https://stackoverflow.com/users/1085203/ivand58"}, "is_accepted": false, "score": 0, "last_activity_date": 1484757868, "creation_date": 1484757868, "answer_id": 41724892, "question_id": 41724653, "link": "https://stackoverflow.com/questions/41724653/c-variable-not-where-i-expect-to-find-it-in-memory/41724892#41724892", "title": "C variable not where I expect to find it in memory", "body": "<p>Local variables are placed in the stack (or in register if possible &amp; if their address is not referred). In your example the i is first and j is second local vars, so you have <code>push i, push j</code> - the address of the second <code>&amp;j</code> is <code>&amp;i-1</code>.</p>\n"}], "owner": {"reputation": 90, "user_id": 2101221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bca06da2c1954e1045934e391b044a37?s=128&d=identicon&r=PG", "display_name": "CSmith", "link": "https://stackoverflow.com/users/2101221/csmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 41724712, "answer_count": 3, "score": 1, "last_activity_date": 1484766540, "creation_date": 1484757191, "last_edit_date": 1484757400, "question_id": 41724653, "link": "https://stackoverflow.com/questions/41724653/c-variable-not-where-i-expect-to-find-it-in-memory", "title": "C variable not where I expect to find it in memory", "body": "<p>Can someone explain why printing the pointers to the two ints results in them being placed in different locations in relation to the chars.</p>\n\n<p>The piece of code below should print out the memory address from &amp;a to &amp;c which (I think) should include the two ints defined but it doesn't, however when I try to find out where they're stored in memory (see second code segment) it does print them between the two chars as expected.</p>\n\n<p>Please explain why printing the int pointers effects the ints being stored between the chars in memory.</p>\n\n<p>The two code samples are the same except code 2 has an extra line <code>printf(\"\\n\\n%p,%p\\n\",&amp;i,&amp;j);</code> which prints the pointers of the two ints.</p>\n\n<p><sub>Edit: Yes I know the prinf formating is ugly but the code was only to help me clarify how memory and pointers work, so I didn't need it to be pretty</sub></p>\n\n<p>Code1</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main (int argc, char **argv){\n    char a='a';\n    int i=1;\n    int j=2;\n    char c='c';\n    char *pos;\n    for ( pos=&amp;c; pos&lt;=&amp;a; pos++ ){\n        printf(\"%p\\t\",pos);\n    }\n    printf(\"\\n\");\n    for ( pos=&amp;c; pos&lt;=&amp;a; pos++ ){\n        printf(\"%i\\t\\t\",*pos);\n    }\n}\n</code></pre>\n\n<p>Results from Code1</p>\n\n<pre><code>0x7ffde6321e7e  0x7ffde6321e7f  \n99              97      \n</code></pre>\n\n<p>Code2</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main (int argc, char **argv){\n    char a='a';\n    int i=1;\n    int j=2;\n    char c='c';\n    char *pos;\n    for ( pos=&amp;c; pos&lt;=&amp;a; pos++ ){\n        printf(\"%p\\t\",pos);\n    }\n    printf(\"\\n\");\n    for ( pos=&amp;c; pos&lt;=&amp;a; pos++ ){\n        printf(\"%i\\t\\t\",*pos);\n    }\n    printf(\"\\n\\n%p,%p\\n\",&amp;i,&amp;j);\n}\n</code></pre>\n\n<p>Results from Code2</p>\n\n<pre><code>0x7ffc3575616b  0x7ffc3575616c  0x7ffc3575616d  0x7ffc3575616e  0x7ffc3575616f  0x7ffc35756170  0x7ffc35756171  0x7ffc35756172  0x7ffc35756173  0x7ffc35756174  0x7ffc35756175  0x7ffc35756176  0x7ffc35756177  \n99              2               0               0               0               1               0               0               0               -4              127             0               97              \n\n0x7ffc35756170,0x7ffc3575616c\n</code></pre>\n"}, {"tags": ["c", "memory-management", "abort"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1487683452, "post_id": 41724520, "comment_id": 71886729, "body": "The <code>i += 2</code> will eventually make the <code>Hello[i]</code> read out of bounds"}], "owner": {"reputation": 31, "user_id": 7387560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d411dcb9c447f0e5be1016e338c5d90?s=128&d=identicon&r=PG&f=1", "display_name": "GFM", "link": "https://stackoverflow.com/users/7387560/gfm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "closed_date": 1485531845, "answer_count": 0, "score": 2, "last_activity_date": 1487678260, "creation_date": 1484756815, "last_edit_date": 1487678260, "question_id": 41724520, "link": "https://stackoverflow.com/questions/41724520/abort-trap-6-error-in-c", "closed_reason": "Duplicate", "title": "abort trap 6 error in C", "body": "<p>I am working on an homework assignment and it compiles and run, but I keep getting this abort trap error 6 message.\nDon't know why ?.</p>\n\n<p>Help appreciated. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    float Hello[100];\n\n    int i = 0;\n    int j = 0;\n\n    for(i = 0 ; i &lt; 100; i++)\n    {\n\n       for(j = 0; j &lt; 100; j++)   \n       {\n         Hello [i] = i + 2;\n\n         printf(\"%2d : 1/(%.2f * %.2f * %.2f)\\n\",\n         j, Hello[i], Hello[i] + 1, Hello[i] + 2);\n         i += 2;\n       }  \n\n    }\n\n }\n</code></pre>\n"}, {"tags": ["c", "sockets", "unix"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484758368, "post_id": 41724500, "comment_id": 70644777, "body": "You&#39;re not sending the whole sentence. <code>%s</code> in <code>scanf()</code> just reads one word. Use <code>fgets()</code> to read a whole line."}], "answers": [{"tags": [], "owner": {"reputation": 215, "user_id": 5466496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c79e9540ca7d65f26fc8f36e091e211?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Madapura", "link": "https://stackoverflow.com/users/5466496/vinay-madapura"}, "is_accepted": true, "score": 1, "last_activity_date": 1484758463, "last_edit_date": 1495540915, "creation_date": 1484758463, "answer_id": 41725122, "question_id": 41724500, "link": "https://stackoverflow.com/questions/41724500/unable-to-send-full-sentence-in-udp/41725122#41725122", "title": "Unable to send full sentence in UDP", "body": "<p>I am answering because I cannot comment.\n<code>scanf(\"%s\", variable);</code> accepts characters as long as it encounters an <code>'\\n'</code> or a <code>'whitespace'</code>.\nYou could use <code>'scanf(\"%[^\\n]s\", variable);'</code> instead, which takes characters till it encounters a <code>'\\n'</code> character.</p>\n\n<p>The question might be a possible duplicate of <a href=\"https://stackoverflow.com/questions/1247989/how-do-you-allow-spaces-to-be-entered-using-scanf\">How do you allow spaces to be entered using scanf?</a></p>\n"}], "owner": {"reputation": 207, "user_id": 6436918, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/99f883b964e82c4caa019e1c3a71cb48?s=128&d=identicon&r=PG&f=1", "display_name": "kautilya hari", "link": "https://stackoverflow.com/users/6436918/kautilya-hari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 41725122, "answer_count": 1, "score": 0, "last_activity_date": 1484758463, "creation_date": 1484756780, "question_id": 41724500, "link": "https://stackoverflow.com/questions/41724500/unable-to-send-full-sentence-in-udp", "title": "Unable to send full sentence in UDP", "body": "<p>I am trying communicate using the socket Unix API under udp protocol\nWhen i try to send sentence for example <code>\"THIS IS A SAMPLE SENTENCE\"</code></p>\n\n<p>and towards the other side i only receive <code>\"THIS\"</code></p>\n\n<p>CLIENT.c</p>\n\n<pre><code>#include&lt;sys/socket.h&gt;\n#include&lt;arpa/inet.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;netinet/in.h&gt;\n#include&lt;unistd.h&gt;\n\nint main() \n{\n      int s,b,opt,port,r,len,sntb,recb;\n      char server_addr[100],*gets_func;\n      struct sockaddr_in server,client;\n      char buff[1024];\n      printf(\"Enter the port number for client\");\n      scanf(\"%d\",&amp;port);\n\n// The socket is now being created\n      s=socket(AF_INET,SOCK_DGRAM,0);\n      if(s==-1)\n      {\n            perror(\"SOCKET NOT CREATED \\n\");\n            exit(0);\n      }\n      printf(\"SOCKET SUCCESSFULL \");\n      printf(\"\\n Do you wish to input address for client \\n 1.YES 2.NO : \");\n      scanf(\"%d\",&amp;opt);\n\n      if(opt==1)\n      {\n          printf(\"Input the address of ther server :\");\n          scanf(\"%s\",server_addr);\n          printf(\"%s\",server_addr);\n          server.sin_addr.s_addr=inet_addr(server_addr);    \n      }\n      else\n      {\n          server.sin_addr.s_addr=inet_addr(\"127.0.0.6\");\n\n      }\n      server.sin_family=AF_INET;\n      server.sin_port=htons(port);\n      len=sizeof(client);\n\n      //send sentence\n      printf(\"\\n Type message:\");\n      scanf(\"%s\",buff);\n\n      sntb=sendto(s,buff,sizeof(buff),0,(struct sockaddr*)&amp;server,len);\n      if(sntb==-1)\n      {\n         perror(\"\\nerror sending\");\n      }\n\n//send word\n      printf(\"\\n Type Word:\");\n      scanf(\"\\n %s\",buff);\n\n      sntb=sendto(s,buff,sizeof(buff),0,(struct sockaddr*)&amp;server,len);\n      if(sntb==-1)\n      {\n         perror(\"\\nerror sending\");\n      }\n//accept the sentence\n      recb=recvfrom(s,buff,sizeof(buff),0,(struct sockaddr *)&amp;server,&amp;len);\n      if(recb==-1)\n      {\n         printf(\"\\nMessage Recieving Failed\");      \n      }\n      else\n      {\n         printf(\"%s\",buff);\n      }\n\n      printf(\"\\nMessage Recieved: \");\n      printf(\"%s\", buff);\n\n\n\n      close(s);\n } \n</code></pre>\n\n<p>SERVER.c</p>\n\n<pre><code>  #include&lt;sys/socket.h&gt;\n  #include&lt;arpa/inet.h&gt;\n  #include&lt;stdlib.h&gt;\n  #include&lt;stdio.h&gt;\n  #include&lt;string.h&gt;\n  #include&lt;sys/types.h&gt;\n  #include&lt;netinet/in.h&gt;\n  #include&lt;unistd.h&gt;\n\n\n  int main()\n  {\n        int s,b,opt,port,ns,len,recb,sntb;\n        char server_addr[100],*gets_func;\n        struct sockaddr_in server,client;\n        char sentence[1024],word[10];\n        printf(\"Enter the port number \");\n        scanf(\"%d\",&amp;port);\n\n// The socket is now being created\n        s=socket(AF_INET,SOCK_DGRAM,0);\n        if(s==-1)\n        {\n            perror(\"SOCKET NOT CREATED \\n\");\n            exit(0);\n        }\n        printf(\"SOCKET SUCCESSFULL \");\n        printf(\"\\n Do you wish to input address \\n 1.YES 2.NO : \");\n        scanf(\"%d\",&amp;opt);\n\n        if(opt==1)\n        {\n\n            printf(\"Input the address of ther server :\");\n            scanf(\"%s\",server_addr);\n            printf(\"%s\",server_addr);\n            server.sin_addr.s_addr=inet_addr(server_addr);  \n        }\n        else\n        {\n            server.sin_addr.s_addr=inet_addr(\"127.0.0.6\");\n\n        }\n        server.sin_family=AF_INET;\n        server.sin_port=htons(port);\n// Bind the server to the given address\n\n        b=bind(s,(struct sockaddr*)&amp;server,sizeof(server));\n        if(b==-1)\n        {\n            perror(\"\\nBind not successfull\");\n            exit(0);    \n        }\n        printf(\"BIND SUCCESSFULL \");\n\n\n//accept the sentence   \n        int ca=sizeof(client);\n        recb=recvfrom(s,sentence,sizeof(sentence),0,(struct sockaddr*)&amp;client,&amp;ca);\n        if(recb==-1)\n        {\n            perror(\"\\nerror receving message : \");\n            exit(0);\n        }else\n        {   \n            printf(\"\\n %s\", sentence);\n        }\n        len=sizeof(client);\n//accept the word   \n\n        recb=recvfrom(s,word,sizeof(word),0,(struct sockaddr*)&amp;client,&amp;ca);\n        if(recb==-1)\n        {\n            perror(\"\\nerror receving message : \");\n            exit(0);\n        }else\n        {   \n            printf(\"\\n %s\", word);\n        }\n        len=sizeof(client);\n//omit the word\n\n//send sentence\n        sntb=sendto(s,sentence,sizeof(sentence),0,(struct sockaddr *)&amp;client, len);\n        if(sntb==-1)\n        {\n            perror(\"\\nerror sending\");\n            exit(0);\n        }\n        printf(\"\\nSent succesfully\");\n        printf(\"\\n\");\n\n  }\n</code></pre>\n\n<p>Can you help me to understand how i send the entire sentence?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484755571, "post_id": 41723991, "comment_id": 70642763, "body": "Remember that strings in C are really called <i>null-terminated byte strings</i>. If you want a string to contain at most six characters, it actually needs <i>seven</i> characters. Your six character, <i>plus the terminator</i>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1484755576, "post_id": 41723991, "comment_id": 70642766, "body": "If your password has a length of 6 characters, the behavior is undefined."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1484755581, "post_id": 41723991, "comment_id": 70642769, "body": "<code>if(password[strlen(password)-1] = &#39;\\n&#39;)</code> --&gt;&gt;  <code>if(password[strlen(password)-1] == &#39;\\n&#39;) </code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484755597, "post_id": 41723991, "comment_id": 70642786, "body": "Greater than 4? How much greater?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484755695, "post_id": 41723991, "comment_id": 70642849, "body": "So your problem is a combination of <i>two</i> issues: The size of the array, and the assignment in the <code>if</code> condition instead of checking for equality."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484756293, "post_id": 41723991, "comment_id": 70643272, "body": "@EugeneSh. From 5 upwards.  There&#39;s the null, then the newline code zaps the byte before that, and since the maximum length was 6 including null, that means the newline assigned at position 4 is zapped with a null byte, leaving the string length at 4, regardless."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484756774, "post_id": 41723991, "comment_id": 70643631, "body": "@Someprogrammerdude @SouravGhosh @EOF The linked question is not a duplicate as we do have the nul terminater here. With <code>fgets(password, MAX, stdin);</code> we get up to 5 characters + \\0 and everything is fine with regard to nul termination."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1484757913, "post_id": 41723991, "comment_id": 70644414, "body": "@Gerhardh I don&#39;t claim the terminator is missing, only that there&#39;s not enough space for it. But I agree that it&#39;s not a duplicate."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484761976, "post_id": 41723991, "comment_id": 70646909, "body": "On the 1st iteration (<code>i==0</code>) this <code>.... == password[i-1]</code> invokes undefined behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1484756063, "post_id": 41724036, "comment_id": 70643110, "body": "And if the password is longer, the extra characters plus the newline will be left in the buffer.  It would be more sensible to use a buffer size of, oh, 128 or 4096, to make sure the whole line is read, then drop the newline, then worry about the length of the password."}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 4, "last_activity_date": 1484755575, "creation_date": 1484755575, "answer_id": 41724036, "question_id": 41723991, "link": "https://stackoverflow.com/questions/41723991/why-strlen-returns-an-unexpected-value/41724036#41724036", "title": "Why strlen() returns an unexpected value", "body": "<pre><code>#define MAX 6\nchar password[MAX] = { 0 }; // The LONGEST your password can be is 5-characters + NULL Terminator (\\0)\n\nstrlen(password); // will never return anything more than 5.\n</code></pre>\n\n<p>If you want your password to be 6 characters, the buffer has to be 7-characters:</p>\n\n<ul>\n<li>6 for the password</li>\n<li>1 for the end-of-string marker: <code>\\0</code></li>\n</ul>\n"}], "owner": {"reputation": 345, "user_id": 7350448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/649078feaf1e14298ad543d388f0a4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Ma250", "link": "https://stackoverflow.com/users/7350448/ma250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484757923, "creation_date": 1484755468, "last_edit_date": 1484756375, "question_id": 41723991, "link": "https://stackoverflow.com/questions/41723991/why-strlen-returns-an-unexpected-value", "title": "Why strlen() returns an unexpected value", "body": "<p>I wrote a program that gets a string (password) and checks its validity,<br>\nthe conditions for the string are:</p>\n\n<ol>\n<li>At least one number  </li>\n<li>At least one upper case and one lower case letter  </li>\n<li>Must contain  6 elements </li>\n</ol>\n\n<p>So I covered the most of the conditions, but then I got troubled with the third condition, I tried using <code>strlen()</code> but it returned a wrong value.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 6\n#define TRUE 1\n#define FALSE 0\n\nint passCheck(char password[]);\n\n/*\nmain will ask the user to enter a password and then it will send it to \npassCheck, and check the return value, if the password is valid or not.\ninput: none\noutput: none\n*/\nint main()\n{\n    char password[MAX] = { 0 };\n    printf(\"Enter a password: \");\n    fgets(password, MAX, stdin);\n    if(password[strlen(password)-1] = '\\n') {password[strlen(password)-1] = 0;}\n    if (passCheck(password) == TRUE)\n    {\n        printf(\"Valid\");\n    }\n    else \n    {\n        printf(\"Invalid\");\n    }\n    return (0);\n} \n/*\npassCheck will take the password and will see if it's meeting the conditions\n, then passCheck will return true(valid) or false(invalid).\ninput: password string\noutput: flag\n*/\nint passCheck(char password[])\n{\n    int i = 0;\n    int flag = FALSE; // true(1) or false(0)\n    int len = 0;\n    int checkInt = 0; // checks if password has a digit\n    int checkChar = 0;\n    int copy = 0;\n\n    for (i = 0; password[i]; i++)\n    {   \n        if (strlen(password) == MAX)\n        {\n            len = TRUE;\n        }\n        if (isdigit(password[i]))/*checks if the input is a number(0-9) or \n        a char (A-Z, a-z)\n        */\n        {       \n            checkInt = TRUE;\n\n        }\n        if ((password[i] &gt;= 'A' &amp;&amp; password[i] &lt;= 'Z') || (password[i] &gt;= 'a' &amp;&amp; password[i] &lt;= 'z'))\n        {\n            checkChar = TRUE;\n        }\n\n        if (password[i] == password[i-1]) // checks if there is the same char/num in a row\n        {\n            copy = TRUE;\n        }\n        else\n        {\n            copy = FALSE;\n        }\n    }\n    printf(\"%d %d %d %d\\n\" , len,checkInt, checkChar,strlen(password));\n    if (copy)\n    {\n        flag = FALSE;\n    }\n    else if (len &amp;&amp; checkInt &amp;&amp; checkChar)\n    {\n        flag = TRUE;\n    }\n    return flag;\n}\n</code></pre>\n\n<p>The <code>printf()</code> in the <code>passCheck()</code> function I used is for checking if the string meets the conditions, the output is working well, however <code>len</code> is not working and the <code>strlen()</code> function always returns 4 if the number is great than 4. Where did I go wrong?</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1484755297, "post_id": 41723857, "comment_id": 70642579, "body": "No, this is <i>not</i> permissible. However, why don&#39;t you put the common part into a struct that is then used as the first member of the other structs? You could then convert a pointer to one of those derived structs to a pointer to the base struct."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1484755316, "post_id": 41723857, "comment_id": 70642587, "body": "Just move the &quot;common fields&quot; into another sub-structure and make it a field of the others. then pass that field to the init function"}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1484756082, "post_id": 41724007, "comment_id": 70643117, "body": "Your answer would be technically wrong, but practically debatable if the question was whether <code>my_struct_n*</code> could be cast to <code>my_struct_1*</code> safely. However, the question asks whether they can be cast to <code>my_struct_3*</code>, which contains members that <code>my_struct_1</code> does not contain, so even the alignment may be wrong. (Consider a machine where <code>sizeof(int) == 2</code> and <code>sizeof(uint32) == 4</code>)."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1484755498, "creation_date": 1484755498, "answer_id": 41724007, "question_id": 41723857, "link": "https://stackoverflow.com/questions/41723857/generic-api-to-initialize-structs-with-common-fields/41724007#41724007", "title": "generic API to initialize structs with common fields", "body": "<p>It's semi-safe. If the first member is identical, you are guaranteed that a pointer to the structure is also a pointer to the first member. Technically, a compiler could insert arbitrary padding after the first member. In fact, no compiler will do so, so if two structs share a first and second member, the pointers to the second members also have the same offset. However the offset may not be address + sizeof(int) for your member \"b\". ints might e padded to 8 bytes for performance. </p>\n\n<p>To avoid ambiguity, you can explicitly set the common members to a struct \"common\".</p>\n"}, {"comments": [{"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "edited": false, "score": 0, "creation_date": 1484760495, "post_id": 41725531, "comment_id": 70646109, "body": "Thanks for comments, I&#39;ll take advantage of this approach in a future work, however for now it is not possible, see my updated post."}], "tags": [], "owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "is_accepted": false, "score": 2, "last_activity_date": 1484759715, "creation_date": 1484759715, "answer_id": 41725531, "question_id": 41723857, "link": "https://stackoverflow.com/questions/41723857/generic-api-to-initialize-structs-with-common-fields/41725531#41725531", "title": "generic API to initialize structs with common fields", "body": "<p>To flesh out what the comments of EOF and Eugene Sh. already explain:</p>\n\n<p>It would not be safe to cast a my_struct1 to a my_struct3, as my_struct3 has more members that my_struct1 and the compiler would not warn at all about accessing those additional members (d and e), overwriting whatever is behind the my_struct1. Doing it the other way around may work, as long as my_struct1 exactly corresponds to the start of my_struct3. I am not sure if there is any guarantee in the standard that would cover you there, but I would not bet on it.</p>\n\n<p>The advantages of separating out the common part in a separate structure type\nare the following:</p>\n\n<ul>\n<li>This reduces repetition in your code which has the advantage of\nallowing  you to change the common code in one place, reducing the\nrisk of errors. </li>\n<li>The compiler can check the types passed around, by\ncasting the structs you would be effectively disabling such checks.</li>\n<li>There is no need for the common struct to be at the start of a struct, by making it a struct member the compiler can figure out the correct offsets for you.</li>\n</ul>\n\n<hr>\n\n<pre><code>struct common {\n    int a;\n    int b;\n    int c;\n};\n\nstruct my_struct1 {\n   struct common com;\n};\n\nstruct my_struct2 {\n   struct common com;\n   uint32_t d;\n   uint32_t e;\n};\n\nstruct my_struct3 {\n   struct common com;\n   uint16_t d;\n   char e;\n};\n\nvoid init_common(struct common *com)\n{\n   com-&gt;a = 1;\n   com-&gt;b = 2;\n   /* ... */\n}\n\nstruct my_struct1 s = {{1, 2, 3}};\nstruct my_struct2 p = {{1, 2, 3}, 4, 5};\nstruct my_struct3 q = {{1, 2, 3}, 4, 'a'};\n\ninit_common(&amp;s.com);\ninit_common(&amp;p.com);\ninit_common(&amp;q.com);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 2, "last_activity_date": 1484774965, "creation_date": 1484774965, "answer_id": 41729790, "question_id": 41723857, "link": "https://stackoverflow.com/questions/41723857/generic-api-to-initialize-structs-with-common-fields/41729790#41729790", "title": "generic API to initialize structs with common fields", "body": "<p>As far as I can interpret the standard, casting a pointer of type <code>my_struct1*</code> to a pointer of type <code>mystruct_3*</code> or vice vera <em>may</em> yield undefined behaviour because of pointer conversion rules (cf. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">C11 standard ISO/IEC 9899:TC2</a>):</p>\n\n<blockquote>\n  <p>6.3.2.3 Pointers ... (7) A pointer to an object or incomplete type may be converted to a pointer to a different object or incomplete type. If\n  the resulting pointer is not correctly aligned for the pointed-to\n  type, the behavior is undefined. ...</p>\n</blockquote>\n\n<p>Hence, as <code>my_struct1</code> and <code>my_struct3</code> may have different alignment, a pointer that is correctly aligned according to <code>my_struct1</code> does not necessarily be correctly aligned according to <code>my_struct3</code>.</p>\n\n<p>But even if you can guarantee that all structs have the same alignment, passing a pointer to an object of type <code>my_struct1</code> to <code>func3</code> is - in my opinion -\nnot safe, even if the common members are the first ones in each struct and even if <code>func3</code> accesses only the common members.\nThe reason is that a compiler may introduce padding between members:</p>\n\n<blockquote>\n  <p>6.7.2.1 Structure and union specifiers ... (13) Within a structure object, the non-bit-field members and the units in which bit-fields\n  reside have addresses that increase in the order in which they are\n  declared. A pointer to a structure object, suitably converted, points\n  to its initial member (or if that member is a bit-field, then to the\n  unit in which it resides), and vice versa. <strong>There may be unnamed\n  padding within a structure object, but not at its beginning.</strong></p>\n</blockquote>\n\n<p>Hence, as <code>my_struct1</code> and <code>my_struct3</code> have different sets of members, the rules of how a compiler introduces padding may vary between these two structs. I think that it is unlikely that this happens, but I did not find any statement in the standard that guarantees that padding - even for the first three members - is the same for <code>my_struct1</code>  and <code>my_struct3</code>. </p>\n"}], "owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 41729790, "answer_count": 3, "score": 0, "last_activity_date": 1484774965, "creation_date": 1484755112, "last_edit_date": 1484760425, "question_id": 41723857, "link": "https://stackoverflow.com/questions/41723857/generic-api-to-initialize-structs-with-common-fields", "title": "generic API to initialize structs with common fields", "body": "<p>I have a number of structures, which have first 3 fields common, below is\nsimplified example:</p>\n\n<pre><code>struct my_struct1 {\n   /* common fields. */\n   int a;\n   int b;\n   int c;\n};\n\nstruct my_struct2 {\n   int a;\n   int b;\n   int c;\n   uint32_t d;\n   uint32_t e;\n};\n\nstruct my_struct3 {\n   int a;\n   int b;\n   int c;\n   uint16_t d;\n   char e;\n};\n\nstatic void func1(struct my_struct1 *s)\n{\n   /* ... */\n}\n\nstatic void func2(struct my_struct2 *s)\n{\n   /* ... */\n}\n\nstatic void func3(struct my_struct3 *s)\n{\n   /* ... */\n}\n\nint main(void)\n{\n   struct my_struct1 s = {1, 2, 3};\n   struct my_struct2 p = {1, 2, 3, 4, 5};\n   struct my_struct3 q = {1, 2, 3, 4, 'a'};\n\n   func1(&amp;s);\n   func2(&amp;p);\n   func3(&amp;q);\n\n   /* XXX */\n   func3((struct my_struct3 *)&amp;s);\n\n   return 0;\n}\n</code></pre>\n\n<p>Is it safe to typecast <code>s</code> to <code>struct my_struct3 *</code> and pass to <code>func3</code> and ensure that <code>s</code> or other objects allocated on stack would not be corrupted?</p>\n\n<p>The reason is that I would like to write a generic API that takes a pointer, initializes common fields (which are common for structures). The other function is specific to <code>my_struct*</code> and sets the rest of the fields.</p>\n\n<p>I'm not sure if <code>void *</code> can solve this.</p>\n\n<p><strong>UPDATE</strong>\nI should mention, that unfortunately I can't change the structures layout, i.e. adding a common part isn't an option, because the code I'm working with is pretty old and I'm not allowed to change its core structures.</p>\n\n<p>The only ugly workaround I'm seeing is to pass <code>void *</code> and <code>enum struct_type</code> parameters to <code>generic_init</code> function, and based on <code>struct_type</code> cast <code>void *</code> to appropriate structure.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484755092, "post_id": 41723828, "comment_id": 70642434, "body": "Which line the error is?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484755103, "post_id": 41723828, "comment_id": 70642446, "body": "Welcome to Stack Overflow! <a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484755196, "post_id": 41723828, "comment_id": 70642500, "body": "Please learn how to properly format the code. Readability is a major aspect of good code. :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1484755205, "post_id": 41723828, "comment_id": 70642509, "body": "It seems to me that you need to <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">find a good beginners book about C</a> and start over."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1484756679, "post_id": 41723828, "comment_id": 70643558, "body": "@KevinDTimm ehh? isn&#39;t that the same as <code>array[i].aa</code>, seeing memory is allocated?"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 47, "user_id": 7436609, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ul8ug.png?s=128&g=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/7436609/edward"}, "edited": false, "score": 0, "creation_date": 1484934350, "post_id": 41723874, "comment_id": 70730398, "body": "@Edward  You&#39;re welcome. You can also <a href=\"http://meta.stackexchange.com/q/5234/244062\">consider accepting an answer that helped you</a>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1484755371, "last_edit_date": 1484755371, "creation_date": 1484755157, "answer_id": 41723874, "question_id": 41723828, "link": "https://stackoverflow.com/questions/41723828/i-get-an-error-compiling-this-struct-program-in-c/41723874#41723874", "title": "I get an error compiling this struct program in c", "body": "<p>The problem is with the function call. In your code, you've written</p>\n\n<pre><code> load(struct lottery array);\n</code></pre>\n\n<p>which is wrong. You should pass only the variable as the argument, like</p>\n\n<pre><code>load(array);\n</code></pre>\n\n<p>That said, your <code>fopen()</code> failure check and subsequent code also looks wrong. You're checking for the failure case but continue to use the returned pointer anyway, which kinds of nullifies the effect of having the check in the first place.</p>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1484755320, "creation_date": 1484755320, "answer_id": 41723941, "question_id": 41723828, "link": "https://stackoverflow.com/questions/41723828/i-get-an-error-compiling-this-struct-program-in-c/41723941#41723941", "title": "I get an error compiling this struct program in c", "body": "<p>Parameters passed to functions when calling them are just variables - you don't need to include the data types as well. So the line</p>\n\n<pre><code>load(struct lottery array);\n</code></pre>\n\n<p>should just be</p>\n\n<pre><code>load(array);\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7436609, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ul8ug.png?s=128&g=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/7436609/edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1484762196, "creation_date": 1484755004, "last_edit_date": 1484762196, "question_id": 41723828, "link": "https://stackoverflow.com/questions/41723828/i-get-an-error-compiling-this-struct-program-in-c", "title": "I get an error compiling this struct program in c", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct date {\n    int day;\n    int month;\n    int year;\n};\n\nstruct lottery {\n    int aa;\n    struct date date1;\n    int n1;\n    int n2;\n    int n3;\n    int n4;\n    int n5;\n    int joker;\n};\n\nvoid load(struct lottery *array) {\n    FILE *fp;\n    fp = fopen(\"as.txt\", \"r\");\n    if (fp == NULL)\n        printf(\"00000\\n\");\n    int i;\n    for (i = 0; i &lt; 1; i++) {\n        fscanf(fp, \"%d;%d/%d/%d;%d;%d;%d;%d;%d;%d\", &amp;array[i].aa, &amp;array[i].date1.day, &amp;array[i].date1.month, &amp;array[i].date1.year, &amp;array[i].n1, &amp;array[i].n2, &amp;array[i].n3, &amp;array[i].n4, &amp;array[i].n5, &amp;array[i].joker);\n        if (feof(fp))\n            break;\n    }\n    array = (struct lottery*)realloc(array, i * sizeof(struct lottery));\n    //  printf(\"%d;%d/%d/%d;%d;%d;%d;%d;%d;%d\", array[0].aa, array[0].date1.day, array[0].date1.month, array[0].date1.year, array[0].n1, array[0].n2, array[0].n3, array[0].n4, array[0].n5, array[0].joker);\n }\n\nint main() {\n    struct lottery *array;\n    array = (struct lottery *)malloc(4 * sizeof(struct lottery));\n    // printf(\"%d\", sizeof(struct lottery));\n    load(struct lottery array);\n    printf(\"%d\",array[0].aa);\n\n    return 0;\n}\n</code></pre>\n\n<p>Hello, I get an error at the line <code>load(struct lottery array);</code>\nin my <code>main</code> function. The error says <em>Expected expression before struct</em>.\nI googled it and I couldn't understand why would it expect an expression there and I am kinda confused.</p>\n"}, {"tags": ["c", "arrays", "pointers", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1484753256, "post_id": 41723148, "comment_id": 70641170, "body": "<code>int (*a)[height][width] = malloc(3 * sizeof *a);</code> should give you a 3d array."}, {"owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1484753414, "post_id": 41723148, "comment_id": 70641284, "body": "wouldn&#39;t this create a pointer to a 2D array of sizes height , width?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1484753668, "post_id": 41723148, "comment_id": 70641480, "body": "yes, <code>a</code> is a pointer to a 2d array and can be used with <code>a[i][j][k]</code>."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1484755082, "post_id": 41723148, "comment_id": 70642427, "body": "Why can&#39;t you just do a 1D-allocation, and do the indexing yourself? Much more compact, and I&#39;m not convinced the two multiplications are more expensive than all that memory-traversing. Not to mention the more efficient heap usage."}, {"owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1484755197, "post_id": 41723148, "comment_id": 70642502, "body": "@unwind that <i>would</i> be the better way to deal with this, however, all I wanted was some practice with the tricky part of memory management, and array to pointer decay and whatnot."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484755463, "post_id": 41723148, "comment_id": 70642685, "body": "@VahagnTumanyan Pointer-to-pointers are not some &quot;tricky part of memory management&quot;. The only case where you would use pointer-to-pointers as you attempt here, is when you need an array of pointers, where each array item points to an array of variable length. Such an item is <i>not</i> an array, but a look-up table. Whenever you use true arrays, you should <i>always</i> allocate all memory in one go, so that it ends up in adjacent memory cells. This reduces heap fragmentation and utilizes data cache optimally."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484755545, "post_id": 41723148, "comment_id": 70642747, "body": "WARNING: There&#39;s a lot of rotten programming books, stinking internet tutorials and mouldy teachers preaching pointer-to-pointers for dynamic allocation of multi-dimensional arrays. They are incorrect and incompetent, don&#39;t listen to them. This very topic has been debated endlessly on SO."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484756034, "post_id": 41723148, "comment_id": 70643083, "body": "@VahagnTumanyan Creating an n-dimensional &quot;array&quot; with a single call to <code>malloc()</code> will test your ability to deal with memory a lot more thoroughly than creating such an &quot;array&quot; with a <code>malloc()</code> call in every loop iteration.  One hard part that&#39;s often overlooked is the need to ensure the &quot;data element&quot; portion of the single <code>malloc()</code>&#39;d block of memory is properly aligned per the standard <code>malloc()</code> requirements."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484756373, "post_id": 41723148, "comment_id": 70643336, "body": "@Lundin <i>Whenever you use true arrays, you should always allocate all memory in one go, so that it ends up in adjacent memory cells. This reduces heap fragmentation and utilizes data cache optimally.</i>  It&#39;s also a tremendously faster.  But, doing it for an arbitrary n-dimensional &quot;array&quot; of arbitrary dimensions known only at run-time isn&#39;t easy - imagine an implementation with 4-byte pointers that requires 8- or 16-byte alignment to properly meet all the alignment requirements for <code>malloc()</code>&#39;d memory.  The &quot;<code>malloc()</code> in the loop&quot; method may be inefficient, but it&#39;s a lot less bug-prone."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484765010, "post_id": 41723148, "comment_id": 70648631, "body": "@AndrewHenle That&#39;s quite easy to fix. If you suspect that malloc doesn&#39;t give you aligned memory chunks, you simply embed your data in structs and then the problem is solved. On most systems I don&#39;t think this is an issue though. Systems that use malloc in the first place are typically high-end 32 CPUs or larger. Exotic microcontrollers or DSPs tend not to use malloc at all."}], "answers": [{"comments": [{"owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 0, "creation_date": 1484753765, "post_id": 41723350, "comment_id": 70641532, "body": "I know it doesn&#39;t allocate the whole array, what I wanted to do there was to allocate 3 pointers of type <code>int**</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 0, "creation_date": 1484753808, "post_id": 41723350, "comment_id": 70641567, "body": "@VahagnTumanyan Why? You said you wanted a 3D array. Pointer-to-pointers aren&#39;t meaningful in that context."}, {"owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 0, "creation_date": 1484753993, "post_id": 41723350, "comment_id": 70641701, "body": "Simply as an exercise for dealing with several pointers of pointers of any dimensions. And also, use the more correct syntax (semantics?) for <code>malloc</code>, as in casting the returned <code>void *</code> to the correct type of pointer and having <code>(number_of_elems * sizeof(type))</code> rather than simply allocating an array."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 0, "creation_date": 1484754184, "post_id": 41723350, "comment_id": 70641829, "body": "@VahagnTumanyan Pointers are not arrays. Arrays are not pointers. Arrays happen to decay into a pointer to the first element when used in an expression, but that doesn&#39;t make pointers arrays. There is no relation whatsoever between a pointer-to-pointer and arrays. Casting the returned type from malloc is widely recognized as bad/pointless practice in C, see <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">the most FAQ on Stack Overflow C of all time</a>."}, {"owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 0, "creation_date": 1484754554, "post_id": 41723350, "comment_id": 70642082, "body": "Alright. thanks. However something like <code>int (*a)[y][z] = malloc( sizeof(int[x][y][z]) );</code> doesn&#39;t compile for me on gcc, it tells that I have an illegal conversion from <code>void *</code> to <code>(*)[][]</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 1, "creation_date": 1484754709, "post_id": 41723350, "comment_id": 70642181, "body": "@VahagnTumanyan Make sure that you 1) aren&#39;t actually using a C++ compiler, in which case you will get weird errors, and 2) that you aren&#39;t accidentally using an 27 years old version of gcc, by adding either the compiler option <code>-std=c99</code> or <code>-std=c11</code>."}, {"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1484924478, "post_id": 41723350, "comment_id": 70724444, "body": "Call me a three-star programmer; I still think it is fun to create 3D arrays using pointers to pointers to pointers and <code>malloc</code>ing them all separately."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 1, "creation_date": 1484925297, "post_id": 41723350, "comment_id": 70724978, "body": "@GregSchmit Again, these are not 3D arrays, since the memory is not allocated adjacently. It is a look-up table of look-up tables pointing at data. Personally, I don&#39;t quite see why slow programs are more fun than a fast program doing the same task. My idea of fun is rather to benchmark the two snippets above, then get a good laugh when I measure execution time of the second one."}, {"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1484925930, "post_id": 41723350, "comment_id": 70725423, "body": "@Lundin You still aren&#39;t reading very thoroughly. I didn&#39;t say that it was more fun to write programs that are slower, did I? Rather I said that it is fun to implement a three-level pointer correctly, especially when you start out not really having a good understanding of pointers. That those programs are slower than a contiguous memory block is a good argument to not implement them in real software, but that doesn&#39;t take away the value of implementing them for the purposes of bettering one&#39;s understanding of pointers, pointer arithmetic, and memory allocation."}, {"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1484926246, "post_id": 41723350, "comment_id": 70725651, "body": "@Lundin Serious question though since I am not too experienced with C. You declared the data as <code>*a[y][z]</code> and did one memory allocation. Is <code>a</code> a triple pointer, or just a single pointer when you do that? As in, would dereferencing it more than once make any sense?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1484926885, "post_id": 41723350, "comment_id": 70726101, "body": "@GregSchmit The most correct form would be <code>int (*a)[x][y][z]</code> - a pointer to a 3D array. But that form is inconvenient, since that pointer has to be de-referenced like any other pointer, when you want to access the contents (the 3D array). That is: <code>(*a)[i][j][k]</code>. This syntax is tedious, so therefore there&#39;s a trick to point at the first item of the 3D array instead - which is a 2D array. Then you can do <code>a[i][j][k]</code>. <a href=\"http://stackoverflow.com/a/32050859/584518\">Detailed explanation</a>."}, {"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1485401141, "post_id": 41723350, "comment_id": 70914355, "body": "@Lundin I also now remember another reason I preferred the raw pointer way. If you need to pass your array to another method, that method has to know the <code>y</code> and <code>z</code> dimension, right? At least that is how I have to set it up to make it work. I cannot just pass it as a triple pointer. Is my understanding correct?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1485421713, "post_id": 41723350, "comment_id": 70922096, "body": "@GregSchmit In general, functions in C always have to know the array size, no matter what kind of array it is. For example <code>void func (size_t x, int array[x])</code>. Pointer-to-pointer syntax doesn&#39;t change that. If your function for some reason already know the array size, then I would strongly suspect that poor program design is the reason."}, {"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1485450546, "post_id": 41723350, "comment_id": 70940028, "body": "@Lundin Oh, cool I didn&#39;t know that was the standard way to pass size (I would usually pass it as a second parameter). Your way makes sense though."}, {"owner": {"reputation": 537, "user_id": 3956027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36721ee1d4c111a09faab918c6d0297b?s=128&d=identicon&r=PG&f=1", "display_name": "Ondrej", "link": "https://stackoverflow.com/users/3956027/ondrej"}, "edited": false, "score": 0, "creation_date": 1522532601, "post_id": 41723350, "comment_id": 86192945, "body": "@Lundin great answer! Make me laugh and teach me a lot in the same time. +1 from me."}, {"owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "edited": false, "score": 0, "creation_date": 1533307629, "post_id": 41723350, "comment_id": 90313214, "body": "lets say i am working with a global 3d matrix how does one declare such variable length array out of file scope. Normally for a 3D pointer i declare it as follows <code>double ***a</code> and <code>extern double ***a</code>"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1533545722, "last_edit_date": 1533545722, "creation_date": 1484753663, "answer_id": 41723350, "question_id": 41723148, "link": "https://stackoverflow.com/questions/41723148/allocate-space-for-a-3-dimensional-array-in-c/41723350#41723350", "title": "Allocate space for a 3 dimensional array in C", "body": "<pre><code>int ***a = (int***)malloc(3 * sizeof(int*));\n</code></pre>\n\n<p>This doesn't allocate anything meaningful. In particular, it does not allocate a 3D array, or even a part of a 3D array. It allocates space for 3 integer pointers, which doesn't make any sense. Neither does a <code>int***</code> make any sense.</p>\n\n<p>Instead, allocate a 3D array:</p>\n\n<pre><code>int (*a)[y][z] = malloc( sizeof(int[x][y][z]) );\n\nfor(int i=0; i&lt;x; i++)\n  for(int j=0; j&lt;y; j++)\n    for(int k=0; k&lt;z; k++)\n      a[i][j][k] = something;\n\nfree(a);\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong> (any sarcastic tone in the below text is fully intentional)</p>\n\n<p>For the benefit of the three-star programmers who refuse to accept any solution with less than three levels of indirection, here is an example of how to properly do three-star programming. </p>\n\n<p>Unfortunately it does not yet contain non-conditional branching upwards, memory leaks or complex pointer arithmetic. But for a three-star programmer, such joyful things are of course trivial to add later. It does however guarantee data cache misses, so that the program will run with equal performance as a system without any data cache.</p>\n\n<p>One may also consider to pass the allocated pointer-to-pointer-to-pointer as a parameter, thus achieving 4 stars!!!</p>\n\n<p>[As in, the pointer-to-pointer method is very bad practice, but if you for reasons unknown insist on using it, you might as well do it proper.]</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\nvoid free_int_3d (int*** ppp, size_t X, size_t Y, size_t Z)\n{\n  (void)Z;\n\n  if(ppp == NULL)\n  {\n    return ;\n  }\n\n  for(size_t x=0; x &lt; X; x++)\n  {\n    if(ppp[x] != NULL)\n    {\n      for(size_t y=0; y &lt; Y; y++)\n      {\n        if(ppp[x][y] != NULL)\n        {\n          free(ppp[x][y]);\n        }\n      }\n      free(ppp[x]);\n    }\n  }\n  free(ppp);\n}\n\n\n#define malloc_with_cleanup(ptr, size)     \\\nptr = malloc(size);                        \\\nif(ptr == NULL)                            \\\n{                                          \\\n  free_int_3d(result, X, Y, Z);            \\\n  return NULL;                             \\\n}\n\nint*** int_alloc_3d (size_t X, size_t Y, size_t Z)\n{\n  int*** result = NULL;\n\n  malloc_with_cleanup(result, sizeof(int**[X]));\n  for(size_t x=0; x&lt;X; x++)\n  {\n    malloc_with_cleanup(result[x], sizeof(int*[Y]));\n    for(size_t y=0; y&lt;Y; y++)\n    {\n      malloc_with_cleanup(result[x][y], sizeof(int[Z]));\n    }\n  }\n  return result;\n}\n\n\nint main (void)\n{\n  const size_t X = 5;\n  const size_t Y = 3;\n  const size_t Z = 4;\n\n  int*** ppp = int_alloc_3d(X, Y, Z);\n\n  for(size_t i=0; i&lt;X; i++)\n  {\n    for(size_t j=0; j&lt;Y; j++)\n    {\n      for(size_t k=0; k&lt;Z; k++)\n      {\n        ppp[i][j][k] = (int)k;\n        printf(\"%d \", ppp[i][j][k]);\n      }\n      printf(\"\\n\");\n    }\n    printf(\"\\n\");\n  }\n\n  free_int_3d(ppp, X, Y, Z);\n\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 1 2 3\n0 1 2 3\n0 1 2 3\n\n0 1 2 3\n0 1 2 3\n0 1 2 3\n\n0 1 2 3\n0 1 2 3\n0 1 2 3\n\n0 1 2 3\n0 1 2 3\n0 1 2 3\n\n0 1 2 3\n0 1 2 3\n0 1 2 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484758204, "post_id": 41724416, "comment_id": 70644637, "body": "I wonder who downvoted this. Seems perfectly legit to me. But I guess, you might have stopped that downvoter by moving that last paragraph up to the top and proceed with the explanation later."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484758999, "post_id": 41724416, "comment_id": 70645199, "body": "@cmaster OK  answer amended."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1484759130, "post_id": 41724416, "comment_id": 70645289, "body": "What is gained by using a pointer to a 3d VLA and <code>malloc</code>ing space instead of just declaring a 3d VLA in the first place? The <code>malloc</code>ed array could be larger, I suppose."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1484762611, "post_id": 41724416, "comment_id": 70647249, "body": "@DavidBowling A VLA failure is not detectable, a <code>malloc()</code> failure is.  I see no great value in either approach above, preferring a simple <code>int *a = malloc(sizeof *a * 3 * height * width);</code>.  Yet OP asked how to allocate space for a 3D array, so this answer focuses on that."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1484758985, "last_edit_date": 1495542281, "creation_date": 1484756598, "answer_id": 41724416, "question_id": 41723148, "link": "https://stackoverflow.com/questions/41723148/allocate-space-for-a-3-dimensional-array-in-c/41724416#41724416", "title": "Allocate space for a 3 dimensional array in C", "body": "<p>To solve OP's higher goal, I suspect a pointer to a 2D array would suffice <a href=\"https://stackoverflow.com/questions/41723148/allocate-space-for-a-3-dimensional-array-in-c/41724416#comment70641170_41723148\">@mch</a></p>\n\n<pre><code>int (*a)[height][width] = malloc(sizeof *a * 3);\n\n a[c][i][j] = i + j + c;\n</code></pre>\n\n<hr>\n\n<p>But per OP's request....</p>\n\n<blockquote>\n  <p>... to allocate space for a 3D array ...</p>\n</blockquote>\n\n<p>How would code typically create a 3D array?<br>\nThe below code does that using a <em>variable length array</em> available in C99.<br>\n(VLA is optionally support in C11)</p>\n\n<pre><code>int a1[3][height][width];\n// and assign it accordingly\nfor (int c = 0; c &lt; 3; c++) {\n  for (int i = 0; i &lt; height; i++) {\n    for (int j = 0; j &lt; width; j++) {\n      a1[c][i][j] = i + j + c;\n</code></pre>\n\n<p>Yet OP wants to <em>allocate</em> space for such an array.  </p>\n\n<p><code>malloc()</code> returns a <em>pointer</em>.  A pointer to allocated memory. So we need to create a pointer to such an array.  Once we have done that, allocation and element assignment is easy.</p>\n\n<pre><code>int (*a2)[3][height][width] = malloc(sizeof *a2);\n\n// 3 nested for loop as above\n    (*a2)[c][i][j] = i + j + c;\n</code></pre>\n\n<hr>\n\n<p>Example code</p>\n\n<pre><code>void VT_3_dimensional_array(int height, int width) {\n  assert(height &gt; 0 &amp;&amp; width &gt; 0);\n\n  int (*a2)[3][height][width] = malloc(sizeof *a2);\n  printf(\"%p %zu\\n\", (void*) a2, sizeof *a2);\n  if (a2 == NULL) {\n    perror(\"Out of memory\");\n    exit(EXIT_FAILURE);\n  }\n  for (int c = 0; c &lt; 3; c++) {\n    for (int i = 0; i &lt; height; i++) {\n      for (int j = 0; j &lt; width; j++) {\n        (*a2)[c][i][j] = i + j + c;\n      }\n    }\n  }\n\n  // use a;\n  for (int c = 0; c &lt; 3; c++) {\n    for (int i = 0; i &lt; height; i++) {\n      putchar('(');\n      for (int j = 0; j &lt; width; j++) {\n        printf(\" %X\", (*a2)[c][i][j]);\n      }\n      putchar(')');\n    }\n    puts(\"\");\n  }\n\n  free(a2);\n}\n\nint main() {\n  VT_3_dimensional_array(5, 7);\n  return 0;\n}\n</code></pre>\n\n<p>output</p>\n\n<pre><code>0x80071980 420\n( 0 1 2 3 4 5 6)( 1 2 3 4 5 6 7)( 2 3 4 5 6 7 8)( 3 4 5 6 7 8 9)( 4 5 6 7 8 9 A)\n( 1 2 3 4 5 6 7)( 2 3 4 5 6 7 8)( 3 4 5 6 7 8 9)( 4 5 6 7 8 9 A)( 5 6 7 8 9 A B)\n( 2 3 4 5 6 7 8)( 3 4 5 6 7 8 9)( 4 5 6 7 8 9 A)( 5 6 7 8 9 A B)( 6 7 8 9 A B C)\n</code></pre>\n\n<hr>\n\n<p>Note, technically OP's code is using the wrong size.   Usually <code>sizeof(int*)</code> will be the same as <code>sizeof(int**)</code>, so no great harm.  Yet it does indicate confusion about the allocation.</p>\n\n<pre><code>// wrong type  -----------------------v  should be int**\nint ***a = (int***)malloc(3 * sizeof(int*));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484898462, "post_id": 41727402, "comment_id": 70708611, "body": "Note that the picture does not show a 3D array, but a number of scattered segments pointed at by a look-up table. So if you want a 3D array, this is not the correct solution. In addition, combining three-star programming with spaghetti programming might not be the best idea ever. Instead of spaghetti gotos, you can simply initialize all pointers to NULL before calling malloc. That way, you can pass them to <code>free()</code> no matter if they point at allocated memory or not. Only one clean-up routine is needed then."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484916931, "post_id": 41727402, "comment_id": 70719687, "body": "@Lundin: The OP wanted an example of <i>non-contiguous</i> allocation extended to 3 dimensions, which is what I provided."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484917163, "post_id": 41727402, "comment_id": 70719843, "body": "I suspect that the question is about an XY problem. The OP asks how to use pointer-to-pointer look-up tables for dynamic memory allocation. While the actual problem they are trying to solve is probably just &quot;how to allocate a 3D array dynamically&quot;."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 3, "last_activity_date": 1484771765, "last_edit_date": 1484771765, "creation_date": 1484766130, "answer_id": 41727402, "question_id": 41723148, "link": "https://stackoverflow.com/questions/41723148/allocate-space-for-a-3-dimensional-array-in-c/41727402#41727402", "title": "Allocate space for a 3 dimensional array in C", "body": "<p>Let's visualize what you're trying to do first, and then I'll show the code to get there:</p>\n\n<pre><code>  int ***         int **                int *                  int \n\n  +---+           +---+                 +---+                  +---+\na |   | ---&gt; a[0] |   | ------&gt; a[0][0] |   | ----&gt; a[0][0][0] |   |\n  +---+           +---+                 +---+                  +---+\n             a[1] |   | ----+   a[0][1] |   | -+    a[0][0][1] |   |\n                  +---+     |           +---+  |               +---+\n             a[2] |   |     |            ...   |                ...\n                  +---+     |           +---+  |               +---+\n                            | a[0][h-1] |   |  |  a[0][0][w-1] |   | \n                            |           +---+  |               +---+\n                            |                  |\n                            |           +---+  |               +---+\n                            +-&gt; a[1][0] |   |  +--&gt; a[0][1][0] |   |\n                                        +---+                  +---+\n                                a[1][1] |   |       a[0][1][1] |   |\n                                        +---+                  +---+\n                                         ...                    ...\n                                        +---+                  +---+\n                              a[1][h-1] |   |     a[0][1][w-1] |   |\n                                        +---+                  +---+\n</code></pre>\n\n<p>Types:</p>\n\n<ul>\n<li>Each <code>a[i][j][k]</code> has type <code>int</code>;</li>\n<li>Each <code>a[i][j]</code> points to the first element of a sequence of <code>int</code> objects, so it must have type <code>int *</code>;</li>\n<li>Each <code>a[i]</code> points to the first element of a sequence of <code>int *</code> objects, so it must have type <code>int **</code>;</li>\n<li><code>a</code> points to the first element of a sequence of <code>int **</code> objects, so it must have type <code>int ***</code>.</li>\n</ul>\n\n<p>Since you're doing a piecemeal nested allocation, you need to check the result of each <code>malloc</code> call, and if there's an error, you will want to clean up any previously allocated memory before bailing out, otherwise you risk memory leaks.  Unfortunately, there's no really clean or elegant way to do that - you either carry a flag around and do a bunch of extra tests, or you throw in a couple of <code>goto</code>s.  I'm going to show two different approaches, neither of which is all that pretty.</p>\n\n<p>First method - as we allocate each <code>a[i]</code>, we also allocate each <code>a[i][j]</code> (a \"depth-first\" approach) and initialize each <code>a[i][j][k]</code>.  If an allocation on <code>a[i][j]</code> fails, we must deallocate all of <code>a[i][0]</code> through <code>a[i][j-1]</code>, then deallocate <code>a[i]</code>, then repeat the process for each of <code>a[0]</code> through <code>a[i-1]</code>:</p>\n\n<pre><code>/**\n * Depth-first approach: allocate each a[i][j] with each a[i]\n */\nint ***alloc1( size_t pages, size_t height, size_t width )\n{\n  size_t i, j, k;\n\n  int ***a = malloc( sizeof *a * pages ); // allocate space for N int **\n                                          // objects, where N == pages\n\n  if ( !a )\n    return NULL;\n\n  for ( i = 0; i &lt; pages; i++ )\n  {\n    a[i] = malloc( sizeof *a[i] * height );  // for each a[i], allocate space for\n    if ( !a[i] )                             // N int * objects, where N == height\n      goto cleanup_1;\n\n    for ( j = 0; j &lt; height; j++ )\n    {\n      a[i][j] = malloc( sizeof *a[i][j] * width ); // for each a[i][j], allocate      \n      if ( !a[i][j] )                              // space for N int objects,\n        goto cleanup_2;                            // where N == w\n\n      for ( k = 0; k &lt; width; k++ )\n        a[i][j][k] = initial_value( i, j, k );\n    }\n  }\n  goto done;\n\n/**\n * Free all of a[i][0] through a[i][j-1], then free a[i]\n */\ncleanup_2:\n  while ( j-- )\n    free( a[i][j] );\n  free( a[i] );\n\n/**\n * Free all of a[0] through a[i-1], then free a\n */\ncleanup_1:\n  while ( i-- )\n  {\n    j = height;\n    goto cleanup_2;\n  }\n  free( a );\n  a = NULL;\n\ndone:\n  return a;  // at this point, a is either a valid pointer or NULL.\n}\n</code></pre>\n\n<p>Yes, this code contains <code>goto</code>s, and it violates one of my pet rules (never branch backwards).  But, there's a fairly clean separation between the allocation code and the cleanup code, and we don't repeat ourselves in the cleanup sections.  <code>cleanup_2</code> deallocates all the rows within a page, along with the page itself; <code>cleanup_1</code> deallocates all of the pages.  <code>cleanup_2</code> \"falls through\" into <code>cleanup_1</code>.  </p>\n\n<p>Here's a second method - first we allocate <em>all</em> <code>a[i]</code> before allocating any <code>a[i][j]</code>, then we make sure all <code>a[i][j]</code> were successfully allocated before initializing the array contents.</p>\n\n<pre><code>/**\n * Breadth-first approach; allocate all a[i], then all a[i][j], then initialize\n */\nint ***alloc2( size_t pages, size_t height, size_t width )\n{\n  size_t i, j, k;\n\n  /**\n   * Allocate space for N int ** objects, where N == pages\n   */\n  int ***a = malloc( sizeof *a * pages );\n\n  if ( !a )\n    return NULL;                        // allocation failed for initial sequence, return NULL\n\n  for ( i = 0; i &lt; pages; i++ )  // For each a[i], allocate N objects of type\n  {                              // int *, where N == height\n    a[i] = malloc( sizeof *a[i] * height );\n    if ( !a[i] )\n      break;\n  }\n\n  if ( i &lt; pages )\n  {\n    while ( i-- )                       // allocation of a[i] failed, free up a[0] through a[i-1]\n      free( a[i] );\n    free( a );                          // free a\n    return NULL;\n  }\n\n  for ( i = 0; i &lt; pages; i++ )    \n  {\n    for ( j = 0; j &lt; height; j++ )\n    {\n      a[i][j] = malloc( sizeof *a[i][j] * width ); // for each a[i][j], allocate    \n      if ( !a[i][j] )                             // space for N int objects, \n        break;                                    // where N == width\n    }\n  }\n\n  if ( j &lt; h )\n  {\n    do\n    {\n      while ( j-- )                     // allocation of a[i][j] failed, free up a[i][0] through a[i][j-1]\n        free( a[i][j] );                // repeat for all of a[0] through a[i-1].\n      free( a[i] );\n      j = h;\n    } while ( i-- );\n    free( a );                          // free a\n    return NULL;\n  }\n\n  /**\n   * All allocations were successful, initialize array contents\n   */    \n  for ( i = 0; i &lt; pages; i++ )\n    for ( j = 0; j &lt; height; j++ )\n      for ( k = 0; k &lt; width; k++ )\n        a[i][j][k] = initial_value( i, j, k );\n\n  return a;\n}\n</code></pre>\n\n<p>No <code>goto</code>s!  But the code doesn't \"flow\" as well IMO.  There's not as clean a separation between allocation and cleanup code, and there's a bit of repetitiveness between the cleanup sections.</p>\n\n<p>Note that for both methods, the memory is <em>not</em> contiguous - the element immediately following <code>a[0][0][h-1]</code> is not going to be <code>a[0][1][0]</code>.  If you need all your array elements to be adjacent in memory, you will need to use the method shown by the others:</p>\n\n<pre><code>int (*a)[h][w] = malloc( sizeof *a * 3 );\n</code></pre>\n\n<p>with the caveat that if <code>h</code> and <code>w</code> are large, you may not have enough contiguously allocated memory to satsify the request.  </p>\n"}], "owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2159, "favorite_count": 0, "accepted_answer_id": 41727402, "answer_count": 3, "score": 2, "last_activity_date": 1533545722, "creation_date": 1484753020, "last_edit_date": 1495541804, "question_id": 41723148, "link": "https://stackoverflow.com/questions/41723148/allocate-space-for-a-3-dimensional-array-in-c", "title": "Allocate space for a 3 dimensional array in C", "body": "<p>This question has been answered <a href=\"https://stackoverflow.com/questions/1052818/create-a-pointer-to-two-dimensional-array\">here</a> but for me some things are still left open and the discussion is too old for anyone to reply to comments, besides I wanted to ask what was wrong in my implementation. </p>\n\n<p>Anyway, the problem setting. I want to allocate space for a 3D array of dimensions <code>3, h, w</code>. What I am doing: </p>\n\n<pre><code>int ***a = (int***)malloc(3 * sizeof(int*));\nfor (int i = 0; i &lt; 3; i++)\n{\n   a[i] = (int **) malloc(height * sizeof(int*)); \n}\n</code></pre>\n\n<p>I understand this as creating first space for three 3 <code>int**</code> and then allocating height <code>int**</code>; \nThen : </p>\n\n<pre><code>for (int i = 0; i &lt; 3; i++)\n{\n  a[i][0] = (int *) malloc(height * width * sizeof(int *));\n  for (int j = 1; j &lt; height; j++)\n   {\n     a[i][j] = a[i][j-1] + width;\n   }\n}\n</code></pre>\n\n<p>So now I think that each <code>a[i][0]</code> is basically space for a 2D array of sizes height and width; furthermore the rest of <code>a[i][j]</code> for <code>j != 0</code> is initialized to the <code>j th</code> row of <code>a[i][0]</code>; </p>\n\n<p>then I initialize values by: </p>\n\n<pre><code>for (int c = 0; c &lt; 3; c++){\n  for (int i = 0; i &lt; height; i++){\n    for (int j = 0; j &lt; width; j++){\n      a[c][i][j] = i+j+c;\n</code></pre>\n\n<p>This however is incorrect. I wanted to do this as an extension exercise to allocating a 2D array in the following way:</p>\n\n<pre><code>int *a[height]; \na[0] = (int*)malloc(height * width * sizeof(int));\nfor (int i = 1; i &lt; height; i++){\n  a[i] = a[i-1] + widht;\n}\n</code></pre>\n\n<p>This way a is an array of pointers of length height, <code>a[0]</code> is allocated for the whole 2D array and the consequent pointers point to their respective rows and I can write to them simply by calling <code>a[i][j] = some number;</code> </p>\n\n<p>What I want to do is extend this 2D idea to the 3D case, but I am sadly failing. </p>\n"}, {"tags": ["c++", "c", "performance", "gcc", "optimization"], "comments": [{"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 3, "creation_date": 1484765005, "post_id": 41723001, "comment_id": 70648627, "body": "Best bet is to profile the code, then put in exp2 calls by hand. (pow() will also call exp()). Often the code will fall over because of the lost accuracy, you need to do this sort of thing carefully."}], "answers": [{"tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 1, "last_activity_date": 1484765312, "last_edit_date": 1484765312, "creation_date": 1484764697, "answer_id": 41727014, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library/41727014#41727014", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>This is more like a workaround (<em>gainarie</em>): </p>\n\n<p>Place <code>exp2</code> definition in a <em>.h</em> file:</p>\n\n<pre><code>//  exp2.h\n\n#if !defined(__EXP2__H__)\n#define __EXP2__H__\n\ninline double exp2(double x) {\n    x = 1.0 + x / 1024;\n    x *= x; x *= x; x *= x; x *= x;\n    x *= x; x *= x; x *= x; x *= x;\n    x *= x; x *= x;\n    return x;\n}\n\n#endif  //__EXP2__H__\n</code></pre>\n\n<p>Now, this file must end up included (whether directly or indirectly) in <strong>all</strong> the <em>.c(xx)</em> files that call <code>exp</code> - which might be a painful job if the existing codebase is large.</p>\n\n<p>Then, when compiling the code, pass <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Preprocessor-Options.html\" rel=\"nofollow noreferrer\">-D</a>(preprocessor definition) to <em>gcc</em> (I don't know the minimum version that supports this form; <em>v5.4.0</em> does) like this: <code>-D'exp(X)=exp2(X)'</code>.</p>\n\n<p><strong>Note</strong>: You no longer need <em>libm.so.*</em>(<code>-lm</code>) at link time (at least not as far as <code>exp</code> is concerned), so you can remove it. Actually, it would be a good idea to remove it (temporarily - if you're using other math functions, permanently - otherwise), so that if there are any <em>.c(xx)</em> files that don't include <em>exp2.h</em>, the linker will spit an <code>exp</code> related <em>undefined reference</em> error (if using other math functions, after resolving all these errors by including <em>exp2.h</em> in the appropriate <em>.c(xx)</em> file you must add it back), otherwise you might end up with a mixture of <code>exp</code>/<code>exp2</code> calls in the code.</p>\n"}, {"comments": [{"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1484774067, "post_id": 41727786, "comment_id": 70653555, "body": "Good point. I will note that the author of the article that the OP got the implementation from led with &quot;In neutral networks, where the math function <code>e^n</code> where <code>n</code> is usually small (less than 2, for instance), you can avoid the expensive <code>exp()</code> provided by math.h (for other programming languages, similar inbuilt system functions are provided)&quot;, so it is intended only for small arguments. I agree though that the speed claims are unreasonable. The recursive self-multiplication would yield a ton of data dependencies, making it very much limited by instruction latency."}, {"owner": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "edited": false, "score": 0, "creation_date": 1484800862, "post_id": 41727786, "comment_id": 70661860, "body": "I almost tried to Implement it, I guess I should be looking for a faster exp(x) implementation then."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "edited": false, "score": 1, "creation_date": 1484802144, "post_id": 41727786, "comment_id": 70662252, "body": "@DominicGuana No. You should be looking for a way to optimize your application to reduce the number of calls to <code>exp()</code>."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 8, "last_activity_date": 1484774067, "last_edit_date": 1484774067, "creation_date": 1484767461, "answer_id": 41727786, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library/41727786#41727786", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>Don't. This function is slower than the native implementation of <code>exp</code>, and is an extremely poor approximation.</p>\n\n<p>First, the speed. My benchmarking indicates that, depending on your compiler and CPU, this implementation of <code>exp2</code> may be anywhere between 1.5x and 4.5x <strong>slower</strong> than the native <code>exp</code>. I'm not sure where the web site got their figures -- \"360 times faster than the traditional <code>exp</code>\" seems absurd, and is completely inconsistent with my tests.</p>\n\n<p>Second, the accuracy. <code>exp2(x)</code> is reasonably close to <code>exp(x)</code> for <code>x \u2264 1</code>, but fails badly for larger values. For instance:</p>\n\n<pre><code>exp(1)   = 2.7182818\nexp2(1)  = 2.7169557 (0.05% too low)\n\nexp(2)   = 7.3890561\nexp2(2)  = 7.3746572 (0.20% too low)\n\nexp(5)   = 148.41316\nexp2(5)  = 146.61829 (1.21% too low)\n\nexp(10)  = 22026.466\nexp2(10) = 20983.411 (4.74% too low)\n\nexp(20)  = 4.851652e+08\nexp2(20) = 4.0008755e+08 (17.5% too low)\n</code></pre>\n\n<p>While the web site you got this function from claims that there is \"very good agreement for input smaller than 5\", this is simply not true. A 1.21% difference (for <code>x=5</code>) is <em>huge</em>, and is likely to cause significant errors in any calculations using this approximation.</p>\n"}, {"comments": [{"owner": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "edited": false, "score": 0, "creation_date": 1484801250, "post_id": 41729752, "comment_id": 70661966, "body": "Hi, I accepted the other answer but upvoted you as well for showing much faster exp(x) implementation, I think I will try to Implement this one based on Cristi&#39;s post."}], "tags": [], "owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "is_accepted": false, "score": 3, "last_activity_date": 1484774847, "creation_date": 1484774847, "answer_id": 41729752, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library/41729752#41729752", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>Simply don't. That function looks <em>way</em> slower than the built-in code, and it's definitely not OK with respect to precision. </p>\n\n<p>If you need SIMD (single instruction, multiple data) optimized exp functionality, ie. you're not calculating a single value but a series of those, there's C libraries that do that for you. I'd like to highlight <a href=\"http://libvolk.org\" rel=\"nofollow noreferrer\">VOLK</a>, the <em>Vector Optimized Library of Kernels</em>, a spin-off of the DSP-intense GNU Radio project.</p>\n\n<p>It implements its own <code>expf</code> (single precision exponentiation \u2013 if you're willing to accept errors, there's certainly no reason to lug double precision floats around); here's how that compares on my machine :</p>\n\n<pre><code>RUN_VOLK_TESTS: volk_32f_expfast_32f(131071,1987)\na_avx completed in 60.119ms\na_sse4_1 completed in 62.052ms\nu_avx completed in 60.376ms\nu_sse4_1 completed in 62.131ms\ngeneric completed in 2383.73ms\n</code></pre>\n\n<p>So, for 1987 iterations over a vector of 131071 elements, all the SIMD-optimized kernels were faster by a factor of 40 \u2013 that's pretty OK, but it's far away from the audacious 360x claim of the website you quote.</p>\n\n<p>The source code of the expfast functions used can be found <a href=\"https://github.com/gnuradio/volk/blob/master/kernels/volk/volk_32f_expfast_32f.h\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>In its core, that implementation relies on the floating point representation \u2013 which is a pretty good idea.</p>\n\n<p>It admits it has a 7% error boundary \u2013 that's pretty much!</p>\n"}], "owner": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 41727014, "answer_count": 3, "score": 2, "last_activity_date": 1484774847, "creation_date": 1484752594, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>__ieee754_exp_avx from libm*.so being used intensively in a certain source code, I would like to replace it with a faster exp(x) implementation?</p>\n\n<p>custom exp(x):</p>\n\n<pre><code>inline\ndouble exp2(double x) {\n   x = 1.0 + x / 1024;\n   x *= x; x *= x; x *= x; x *= x;\n   x *= x; x *= x; x *= x; x *= x;\n   x *= x; x *= x;\nreturn x;\n}\n</code></pre>\n\n<p>What gcc tags should I use to make gcc automatically use a custom exp(x) implementation? If it is not possible with gcc how can I do it then?</p>\n\n<p><a href=\"https://codingforspeed.com/using-faster-exponential-approximation/\" rel=\"nofollow noreferrer\">https://codingforspeed.com/using-faster-exponential-approximation/</a></p>\n"}, {"tags": ["c", "malloc", "b-tree"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1484751278, "post_id": 41722531, "comment_id": 70639667, "body": "And <i>what is</i> <code>bTree</code>?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1484751309, "post_id": 41722531, "comment_id": 70639693, "body": "So <code>bTree</code> is a typedef for a pointer? Please don&#39;t do this. This is among the worst uses of a typedef in existence. Pointer semantics need to be explicit. You yourself are already stumbling over it."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1484751317, "post_id": 41722531, "comment_id": 70639702, "body": "Use C compiler instead of C++ compiler."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1484752295, "post_id": 41722531, "comment_id": 70640405, "body": "... or <code>b = (bTree)malloc(sizeof(*b));</code>. All other comments still apply."}], "answers": [{"tags": [], "owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "is_accepted": false, "score": 3, "last_activity_date": 1484753971, "creation_date": 1484753971, "answer_id": 41723462, "question_id": 41722531, "link": "https://stackoverflow.com/questions/41722531/c-cannot-convert-void-to-btree-an-object/41723462#41723462", "title": "C - cannot convert &#39;void *&#39; to &#39;bTree&#39; an object", "body": "<p>assuming that bTree is declared as :</p>\n\n<pre><code>typedef struct\n{\n int isLeaf;\n int numKeys;\n}bTree;\n</code></pre>\n\n<p>This is an example of call for your function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct\n{\n  int isLeaf;\n  int numKeys;\n}bTree;\n\nbTree* btCreate(void)\n{\n  bTree *b;\n\n  b = malloc(sizeof(bTree)); //pay attention here sizeof(bTree) \n  if (b==NULL)\n  {\n    printf (\"malloc failed \\n\");\n    return NULL;\n  }\n  //initialization\n  b-&gt;isLeaf = 1;\n  b-&gt;numKeys = 0;\n\n return b;\n}\n\nint main()\n{\n   bTree* ptree;\n   ptree = btCreate();\n\n   if(ptree!=NULL){\n     printf (\"initial values:\\n\");\n     printf (\"isLeaf = %d  \\n\",ptree-&gt;isLeaf);\n     printf (\"numKeys = %d  \\n\",ptree-&gt;numKeys);\n   }\n   return 0;\n}\n</code></pre>\n\n<p>Hope this help</p>\n"}], "owner": {"reputation": 741, "user_id": 5635189, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-GtVjyBrCkoA/AAAAAAAAAAI/AAAAAAAAADg/jgwzYhE3ZS8/photo.jpg?sz=128", "display_name": "Masoud Tavakkoli", "link": "https://stackoverflow.com/users/5635189/masoud-tavakkoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484753971, "creation_date": 1484751233, "question_id": 41722531, "link": "https://stackoverflow.com/questions/41722531/c-cannot-convert-void-to-btree-an-object", "title": "C - cannot convert &#39;void *&#39; to &#39;bTree&#39; an object", "body": "<p>I have a code that create a free BTree but I have an error in line 6 that said <code>cannot convert void to object</code> how can I fix it? </p>\n\n<pre><code>bTree btCreate(void)\n{\nbTree b;\n\n\nb = malloc(sizeof(*b)); // '=':cannot convert 'void *' to 'bTree' \nassert(b);\n\nb-&gt;isLeaf = 1;\nb-&gt;numKeys = 0;\n\nreturn b;\n\n}\n</code></pre>\n\n<p>any idea?\nthanks.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1484751055, "post_id": 41722314, "comment_id": 70639531, "body": "What value is <code>SIZEOFRAW</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484751165, "post_id": 41722314, "comment_id": 70639600, "body": "You know arrays in C are zero-based, don&#39;t you?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484751625, "post_id": 41722314, "comment_id": 70639900, "body": "This smells UB."}, {"owner": {"reputation": 43, "user_id": 5753104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kqPQ.jpg?s=128&g=1", "display_name": "ItsYou", "link": "https://stackoverflow.com/users/5753104/itsyou"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1484752070, "post_id": 41722314, "comment_id": 70640228, "body": "@Ian SIZEOFRAW=10 Its 2d array but Iimple.ented in my whole program as a 1d. I play with pointers a lot."}, {"owner": {"reputation": 43, "user_id": 5753104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kqPQ.jpg?s=128&g=1", "display_name": "ItsYou", "link": "https://stackoverflow.com/users/5753104/itsyou"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484752320, "post_id": 41722314, "comment_id": 70640430, "body": "@Eugene Do you mean why I used calloc ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484752460, "post_id": 41722314, "comment_id": 70640543, "body": "I mean that your code is never using index <code>0</code> anywhere, which is making me suspect you afraid of accessing the array element number <code>0</code>."}, {"owner": {"reputation": 43, "user_id": 5753104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kqPQ.jpg?s=128&g=1", "display_name": "ItsYou", "link": "https://stackoverflow.com/users/5753104/itsyou"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484753099, "post_id": 41722314, "comment_id": 70641048, "body": "@Eugene I have to calculate the numbers I could use i-1 but I don&#39;t want to add -1 everywhere :p"}, {"owner": {"reputation": 484, "user_id": 1625818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b725c0a18612df0fd65bc5a07db00bfd?s=128&d=identicon&r=PG", "display_name": "wybourn", "link": "https://stackoverflow.com/users/1625818/wybourn"}, "edited": false, "score": 0, "creation_date": 1484754823, "post_id": 41722314, "comment_id": 70642253, "body": "If you&#39;re sure the database doesn&#39;t change (or shouldn&#39;t change) then you should mark it as const so that the compiler enforces it."}, {"owner": {"reputation": 43, "user_id": 5753104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kqPQ.jpg?s=128&g=1", "display_name": "ItsYou", "link": "https://stackoverflow.com/users/5753104/itsyou"}, "reply_to_user": {"reputation": 484, "user_id": 1625818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b725c0a18612df0fd65bc5a07db00bfd?s=128&d=identicon&r=PG", "display_name": "wybourn", "link": "https://stackoverflow.com/users/1625818/wybourn"}, "edited": false, "score": 0, "creation_date": 1484755109, "post_id": 41722314, "comment_id": 70642449, "body": "@wybourn The value of database can change later in my program because I use realloc() but this is a diffrent functionality"}], "answers": [{"tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": true, "score": 1, "last_activity_date": 1484761959, "creation_date": 1484761959, "answer_id": 41726196, "question_id": 41722314, "link": "https://stackoverflow.com/questions/41722314/c-function-returns-correct-results-in-first-run-but-false-in-second-runs/41726196#41726196", "title": "C Function returns correct results in first run but false in second+ runs", "body": "<p>As written, <code>numberSeen</code> contents in not initializes.</p>\n\n<p>I suppose that the intention was</p>\n\n<pre><code>        for (i=1;i&lt;=20;i++)\n            numbersSeen[i]=0;\n</code></pre>\n\n<p>instead of redundant initialization of <code>numberCount</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 5753104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kqPQ.jpg?s=128&g=1", "display_name": "ItsYou", "link": "https://stackoverflow.com/users/5753104/itsyou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 41726196, "answer_count": 1, "score": -1, "last_activity_date": 1484761959, "creation_date": 1484750600, "last_edit_date": 1484750960, "question_id": 41722314, "link": "https://stackoverflow.com/questions/41722314/c-function-returns-correct-results-in-first-run-but-false-in-second-runs", "title": "C Function returns correct results in first run but false in second+ runs", "body": "<p>I am creating a program that computes what was the last time a number was shown in a number of lotteries. The thing is that I have created two function , one that returns an array and one that short the array and prints the results , BUT when I first run the function from my program it prints the correct results but in the second ,third etc it produces wrong results .</p>\n\n<p>Also I would like to say that the array stored in *database doesnt change!</p>\n\n<p>//First function</p>\n\n<pre><code>void LateJoker(int *database){\n            int i,j,k;\n            int *numbersCount,numbersSeen[21];\n            int numbersShort[21],max,pos,tmp;\n            int size = *database;\n            int *memAddress;\n            int currentNumber;\n            int countBreak;\n            /*\n\n            for (i=1;i&lt;=20;i++)\n                numbersCount[i]=0;\n\n            for (i=size*SIZEOFRAW;i&gt;=10;i-=10){\n                memAddress = database + i;\n\n                numbersSeen[*(memAddress +9)] = 1;\n\n\n                for(k=1;k&lt;=20;k++){\n                    if (numbersSeen[k] != 1){\n                        numbersCount[k] += 1;\n                    }\n                }\n            }*/\n            numbersCount = LateJokerRet(database);\n            //short the numebrsCount array (insertion short)\n            for (i=1;i&lt;=20;i++)\n                numbersShort[i] = i;\n\n            for (i=1;i&lt;=19;i++){\n                pos = i;\n                for (j=i+1;j&lt;=20;j++){\n                    if (numbersCount[pos] &lt; numbersCount[j]){\n                        pos = j;\n                    }\n                }\n                if (pos != i){\n                    tmp = numbersCount[pos];\n                    numbersCount[pos] = numbersCount[i];\n                    numbersCount[i] = tmp;\n\n                    tmp = numbersShort[i];\n                    numbersShort[i] = numbersShort[pos];\n                    numbersShort[pos] = tmp;\n                }\n            }\n\n            for (i=1;i&lt;=20;i++){\n                printf(\"%d=%d  \",numbersShort[i],numbersCount[i] );\n                if (i % 5 == 0) printf(\"\\n\");\n            }\n            free(numbersCount);\n        }\n</code></pre>\n\n<p>//Second fuction that calculates the array</p>\n\n<pre><code>int *LateJokerRet(int *database){\n            int i,j,k;\n            int *numbersCount,numbersSeen[21];\n            int size = *database;\n            int *memAddress;\n            int currentNumber;\n\n\n            numbersCount = (int *) calloc (21,sizeof(*numbersCount));\n\n            for (i=1;i&lt;=20;i++)\n                numbersCount[i]=0;\n\n            for (i=size*SIZEOFRAW;i&gt;=10;i-=10){\n                memAddress = database + i;\n\n                numbersSeen[*(memAddress +9)] = 1;\n\n\n                for(k=1;k&lt;=20;k++){\n                    if (numbersSeen[k] != 1){\n                        numbersCount[k] += 1;\n                    }\n                }\n            }\n\n\n            return  numbersCount;\n        }\n</code></pre>\n\n<p>Correct output:</p>\n\n<pre><code>14=111  16=74  12=47  7=42  5=39  \n18=27  3=18  4=17  17=16  15=13  \n10=12  13=10  9=9  11=7  20=6  \n1=5  8=4  6=2  2=1  19=0  \n</code></pre>\n\n<p>Wrong output: </p>\n\n<pre><code>14=111  16=74  12=47  7=42  18=27  \n3=18  17=16  15=13  10=12  13=10  \n9=9  11=7  20=6  1=5  8=4  \n6=2  2=1  5=0  19=0  4=0  \n</code></pre>\n\n<p>As you can see the wrong numbers are only 5 and 4 .</p>\n\n<p>What is wrong ? :/</p>\n"}, {"tags": ["c", "strcmp"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1484750302, "post_id": 41722163, "comment_id": 70638949, "body": "<code>if (inputread[3] == &#39;,&#39;) {</code> is how you compare a <i>char</i>. <code>strcmp()</code> is for comparing <i>strings</i> (sequence of chars terminated with a null byte)."}, {"owner": {"reputation": 745, "user_id": 3075562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8e36f8b2ba52c2e976c5c00f5f720f?s=128&d=identicon&r=PG&f=1", "display_name": "qwattash", "link": "https://stackoverflow.com/users/3075562/qwattash"}, "edited": false, "score": 0, "creation_date": 1484750467, "post_id": 41722163, "comment_id": 70639072, "body": "See this related <a href=\"https://stackoverflow.com/questions/10490636/compare-between-a-char-in-a-string-to-a-given-char\">question</a>. Not really a duplicate since you are asking for a C solution but the accepted answer there is also C."}, {"owner": {"reputation": 745, "user_id": 3075562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8e36f8b2ba52c2e976c5c00f5f720f?s=128&d=identicon&r=PG&f=1", "display_name": "qwattash", "link": "https://stackoverflow.com/users/3075562/qwattash"}, "edited": false, "score": 1, "creation_date": 1484750539, "post_id": 41722163, "comment_id": 70639138, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10490636/compare-between-a-char-in-a-string-to-a-given-char\">Compare between a char in a string to a given char</a>"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484751328, "post_id": 41722163, "comment_id": 70639709, "body": "Be sure you read enough into <code>in</code> (your buffer): if you read only 3 chars, you can&#39;t test the 4th. Then, use <code>doParseInput(in)</code> without ampersand. Then, compare like <code>inputread[3] == &#39;,&#39;</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484751672, "post_id": 41722163, "comment_id": 70639943, "body": "What kind of crappy compiler let this code compile?"}], "answers": [{"comments": [{"owner": {"reputation": 1973, "user_id": 1187098, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c31da844ec3d4c6889e2dd5e9323037?s=128&d=identicon&r=PG", "display_name": "art vanderlay", "link": "https://stackoverflow.com/users/1187098/art-vanderlay"}, "edited": false, "score": 0, "creation_date": 1484751046, "post_id": 41722224, "comment_id": 70639520, "body": "can you expand or point to some docs on &quot;why&quot; not to use the &amp; to pass a buffer. Using both with <code>&amp;</code> and without works, I am interested to understand the good practice behind not using it, thx Art"}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 1, "last_activity_date": 1484750331, "creation_date": 1484750331, "answer_id": 41722224, "question_id": 41722163, "link": "https://stackoverflow.com/questions/41722163/in-c-the-correct-way-to-test-nth-character-x-in-a-string-passed-to-a-functi/41722224#41722224", "title": "in C the correct way to test nth character == &quot;x&quot; in a string passed to a function", "body": "<p>To pass a buffer to a function, don't use <code>&amp;</code>.<br>\nInstead:</p>\n\n<pre><code>doParseInput(in);\n</code></pre>\n\n<p>To compare the 4th character of a buffer (index == 3):</p>\n\n<pre><code>if (theParsedString[3] == ','){ \n</code></pre>\n\n<p><em>(Notice the single-quotes, meaning <code>Character-Value</code>, rather than the double-quotes, which would mean <code>\"String\"</code>)</em></p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1484750418, "creation_date": 1484750418, "answer_id": 41722248, "question_id": 41722163, "link": "https://stackoverflow.com/questions/41722163/in-c-the-correct-way-to-test-nth-character-x-in-a-string-passed-to-a-functi/41722248#41722248", "title": "in C the correct way to test nth character == &quot;x&quot; in a string passed to a function", "body": "<p>First, you're passing the wrong type of argument to <code>doParseInput</code>.  It expects a <code>char *</code> but you're passing it a <code>char (*)[]</code>.  Your compiler should have warned you of this.</p>\n\n<p>The other issue is that you're using a string comparison to check a single character.  You need to use a character constant (i.e. use single quotes not double quotes) and compare that against the array member directly.</p>\n\n<pre><code>if (theParsedString[3] == ',') {\n</code></pre>\n"}], "owner": {"reputation": 1973, "user_id": 1187098, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c31da844ec3d4c6889e2dd5e9323037?s=128&d=identicon&r=PG", "display_name": "art vanderlay", "link": "https://stackoverflow.com/users/1187098/art-vanderlay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 41722224, "answer_count": 2, "score": -1, "last_activity_date": 1484750418, "creation_date": 1484750163, "last_edit_date": 1484750319, "question_id": 41722163, "link": "https://stackoverflow.com/questions/41722163/in-c-the-correct-way-to-test-nth-character-x-in-a-string-passed-to-a-functi", "title": "in C the correct way to test nth character == &quot;x&quot; in a string passed to a function", "body": "<p>Given the following I am getting a segmentation fault and I am not sure if it is because I am testing against a pointer or other issue.</p>\n\n<p>What is the correct way to test if the 4th character is a comma?</p>\n\n<p>string is read from fifo <code>abc,def,xyz</code></p>\n\n<pre><code>char in[BUFFER] = {'\\0'};\nif ((in_fl = open(*fifofile, O_RDONLY)) == -1)\n    {\n     while (read(in_fl, in, BUFFER)&gt;0) {\n      doParseInput(&amp;in);\n    }\n\n\nvoid *doParseInput(char *inputread){\n//copy string to use later....\n char* theParsedString = calloc(strlen(inputread)+1, sizeof(char));\n strcpy(theParsedString , inputread);\n if (strcmp(theParsedString[3], \",\") == 0){ //causes seg fault\n</code></pre>\n\n<p>I have also tried using the passed string directly, but also seg fault</p>\n\n<pre><code>if (strcmp(inputread[3], \",\") == 0){ //causes seg fault\n</code></pre>\n"}, {"tags": ["c", "windows", "gcc", "linker", "ftdi"], "comments": [{"owner": {"reputation": 3403, "user_id": 7135046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8f6eS.jpg?s=128&g=1", "display_name": "SergeyLebedev", "link": "https://stackoverflow.com/users/7135046/sergeylebedev"}, "edited": false, "score": 0, "creation_date": 1484753881, "post_id": 41721944, "comment_id": 70641625, "body": "Look up this link: <a href=\"https://www.technovelty.org/c/relocation-truncated-to-fit-wtf.html\" rel=\"nofollow noreferrer\">technovelty.org/c/relocation-truncated-to-fit-wtf.html</a>"}, {"owner": {"reputation": 3403, "user_id": 7135046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8f6eS.jpg?s=128&g=1", "display_name": "SergeyLebedev", "link": "https://stackoverflow.com/users/7135046/sergeylebedev"}, "edited": false, "score": 0, "creation_date": 1484754092, "post_id": 41721944, "comment_id": 70641764, "body": "And try tu add <code>-mmodel</code> key switch to <code>gcc</code> commandline"}, {"owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "reply_to_user": {"reputation": 3403, "user_id": 7135046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8f6eS.jpg?s=128&g=1", "display_name": "SergeyLebedev", "link": "https://stackoverflow.com/users/7135046/sergeylebedev"}, "edited": false, "score": 0, "creation_date": 1484755042, "post_id": 41721944, "comment_id": 70642402, "body": "Thank you for your answer. But how do I use the -mmodel flag. It&#39;s not gcc -L/cygdrive/e/jschubert/workspaces/testSimple/ -o &quot;testSimple.exe&quot;  ./main.o   -lftd2xx -mmodel. I can&#39;t fint a lot about this flag in the web."}, {"owner": {"reputation": 3403, "user_id": 7135046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8f6eS.jpg?s=128&g=1", "display_name": "SergeyLebedev", "link": "https://stackoverflow.com/users/7135046/sergeylebedev"}, "edited": false, "score": 0, "creation_date": 1484755262, "post_id": 41721944, "comment_id": 70642556, "body": "Have you tried <code>-mcmodel=medium</code> switch?"}, {"owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "reply_to_user": {"reputation": 3403, "user_id": 7135046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8f6eS.jpg?s=128&g=1", "display_name": "SergeyLebedev", "link": "https://stackoverflow.com/users/7135046/sergeylebedev"}, "edited": false, "score": 0, "creation_date": 1484756108, "post_id": 41721944, "comment_id": 70643133, "body": "Yes I tried: gcc -L/cygdrive/e/jschubert/workspaces/testSimple/ -mcmodel=medium -o &quot;testSimple.exe&quot;  ./main.o   -lftd2xx            resulting in the same linker error output."}, {"owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "reply_to_user": {"reputation": 3403, "user_id": 7135046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8f6eS.jpg?s=128&g=1", "display_name": "SergeyLebedev", "link": "https://stackoverflow.com/users/7135046/sergeylebedev"}, "edited": false, "score": 0, "creation_date": 1484758334, "post_id": 41721944, "comment_id": 70644746, "body": "On Cygwin -mcmodel=medium is already default. Adding -Wl,--image-base -Wl,0x10000000 to GCC linker fixed the error."}], "answers": [{"tags": [], "owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "is_accepted": true, "score": 1, "last_activity_date": 1484758971, "creation_date": 1484758971, "answer_id": 41725284, "question_id": 41721944, "link": "https://stackoverflow.com/questions/41721944/using-cygwin-to-compile-a-c-application-using-ftd2xx-lib-by-ftdi/41725284#41725284", "title": "Using cygwin to compile a c application using ftd2xx.lib by FTDI", "body": "<p>On Cygwin -mcmodel=medium is already default. Adding -Wl,--image-base -Wl,0x10000000 to GCC linker fixed the error.</p>\n"}], "owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 41725284, "answer_count": 1, "score": 0, "last_activity_date": 1484758971, "creation_date": 1484749541, "last_edit_date": 1495540917, "question_id": 41721944, "link": "https://stackoverflow.com/questions/41721944/using-cygwin-to-compile-a-c-application-using-ftd2xx-lib-by-ftdi", "title": "Using cygwin to compile a c application using ftd2xx.lib by FTDI", "body": "<p>I'm trying to compile a sample 64-bit c progam using the ftd2xx lib by FTDI using gcc within cygwin without any success. I always end up in linker errors. </p>\n\n<p>My project contains these file:</p>\n\n<ul>\n<li>main.c    My Sample Application</li>\n<li>ftd2xx.h    The header of the library</li>\n<li>ftd2xx.lib    Importlibrary </li>\n<li>ftd2xx64.dll  dynamic library 64 bit</li>\n<li>wintypes.h   Wrapper used by ftd2xx.h to include windows.h</li>\n</ul>\n\n<p>This is my main function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;  // for windows specific keywords in ftd2xx.h\n#include \"ftd2xx.h\"   // Header file for ftd2xx.lib\nint main()\n{\n   FT_HANDLE ft_handle;  // handle to the USB ic\n   FT_STATUS ft_status;  // for status report(error,io status etc)\n\n   ft_status = FT_Open(0,&amp;ft_handle); //open a connection\n\n   if(ft_status == FT_OK) //error checking\n     {\n        printf(\"\\n\\n\\tConnection with FT 232 successfull\\n\");\n     }\n   else\n     {\n        printf(\"\\n\\n\\tConnection Failed !\");\n        printf(\"\\n\\tCheck device connection\");\n     }\n    FT_Close(ft_handle);    //Close the connection\n    return 0;\n }\n</code></pre>\n\n<p>This is my linker cmd</p>\n\n<pre><code>Building target: testSimple.exe\nInvoking: Cygwin C Linker\ngcc -L/cygdrive/e/jschubert/workspaces/testSimple/ -o \"testSimple.exe\"  ./main.o   -lftd2xx\n</code></pre>\n\n<p>And here is my output</p>\n\n<pre><code>/cygdrive/e/jschubert/workspaces/testSimple//ftd2xx.lib(FTD2XX.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_FT_Open' defined in .idata$5 section in /cygdrive/e/jschubert/workspaces/testSimple//ftd2xx.lib(FTD2XX.dll.b)\n/cygdrive/e/jschubert/workspaces/testSimple//ftd2xx.lib(FTD2XX.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_FT_Close' defined in .idata$5 section in /cygdrive/e/jschubert/workspaces/testSimple//ftd2xx.lib(FTD2XX.dll.b)\n</code></pre>\n\n<p>After reading the article <a href=\"https://stackoverflow.com/questions/3573475/how-does-the-import-library-work-details\">How does the Import Library work? Details?</a> and <a href=\"http://www.mikrocontroller.net/topic/26484\" rel=\"nofollow noreferrer\">http://www.mikrocontroller.net/topic/26484</a> I'm pretty shure that there is a problem with the generated export lib functions. But how do I correct them?</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1484749727, "post_id": 41721899, "comment_id": 70638498, "body": "<i>it gives a lot of errors</i>.  <b>What</b> errors, specifically?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 7, "creation_date": 1484749815, "post_id": 41721899, "comment_id": 70638561, "body": "This sounds like an XY problem. Why would you want to do that? <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>"}, {"owner": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 0, "creation_date": 1484750366, "post_id": 41721899, "comment_id": 70638995, "body": "actually i meant warnings, that im redefining a macro. And im not sure why i wrote alot, because it is only one warning"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1484998142, "post_id": 41721899, "comment_id": 70748078, "body": "The way to discover macro definitions depends on your compiler. What compiler is it?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 0, "creation_date": 1484750314, "post_id": 41721954, "comment_id": 70638957, "body": "Thank you.  so does that mean there is no way to check if a variable macro is defined?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 0, "creation_date": 1484750414, "post_id": 41721954, "comment_id": 70639024, "body": "@InstaFjelle - A macro and a variable are two very different things. I&#39;m starting to second the notion you have an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. I suggest you ask another question on SO about your problem, instead of about what you think is the solution."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1484750420, "post_id": 41721954, "comment_id": 70639032, "body": "<code>#ifdef</code> checks if a macro is defined ... if that&#39;s not what you want, you need to explain it more clearly"}, {"owner": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 0, "creation_date": 1484751055, "post_id": 41721954, "comment_id": 70639529, "body": "basically i have to check if a variable is defined as a Macro. Specifically if a incoming process signal is a defined/valid signal. No i dont think i have.  I cant be more specific because it&#39;s for an exam, and i normally wouldnt ask here, but im taking a chance and assuming this is a syntax question rather than a specific solution question."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 0, "creation_date": 1484751220, "post_id": 41721954, "comment_id": 70639644, "body": "@InstaFjelle - I assure you, that you do. If you post a complete question that describes your situation (not &quot;I need to do this to resolve a situation&quot;). You may learn there is a better way. But please do so in a completely new post. If you edit your current one, it will make existing answers be off-topic, and that is bad SO etiquette."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 1, "creation_date": 1484751941, "post_id": 41721954, "comment_id": 70640139, "body": "@InstaFjelle In that case you don&#39;t want to know if the value of <code>i</code> corresponds to <i>any</i> defined macro, but rather to one of the allowed signals. This is done by creating a list of all allowed signals as a <code>const</code> array, which you can then search through with the value of <code>i</code> as search key."}, {"owner": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 0, "creation_date": 1484754522, "post_id": 41721954, "comment_id": 70642055, "body": "well the signals are already defined in a header file as macros. And yeah i would&#39;ve done that if i was implementing it myself, but i doubt i have to change the current implementation"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "edited": false, "score": 0, "creation_date": 1484755165, "post_id": 41721954, "comment_id": 70642481, "body": "@InstaFjelle Anywhere in your program you could do <code>const int SIGNALS []  = { SOME_MACRO, SOME_OTHER_MACRO, YET_ANOTHER_MACRO }</code> regardless of who defined those macros or where they were defined. Preferably these should be sorted after their values, to enable faster search."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1484750081, "last_edit_date": 1484750081, "creation_date": 1484749578, "answer_id": 41721954, "question_id": 41721899, "link": "https://stackoverflow.com/questions/41721899/check-if-int-is-defined-as-macro-c/41721954#41721954", "title": "Check if int is defined as macro. C", "body": "<p>Short answer: You can't use the <em>value</em> of <code>i</code> as a condition in a preprocessor expression. You can't even check if it's defined.</p>\n\n<p>Longer answer: preprocessing is one of the early translation stages. It happens even before the code is compiled. The value of <code>i</code> is available only during run time. Meaning after the program has been compiled, linked, and then executed. The two stages are as far apart as they can be.</p>\n\n<p>You can't check if an <code>i</code> variable is defined either, since the symbol <code>i</code> is known as a variable only during the compilation stage (again, after the preprocessor has finished its run).</p>\n\n<p>It's true that the preprocessor allows you to conditionally compile code, but you cannot base those conditions on things which are known only at later translation stages.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1484750530, "creation_date": 1484750530, "answer_id": 41722289, "question_id": 41721899, "link": "https://stackoverflow.com/questions/41721899/check-if-int-is-defined-as-macro-c/41722289#41722289", "title": "Check if int is defined as macro. C", "body": "<p>The reason you're getting a warning is because you redefine <code>DEFINED</code> in the event the macro <code>i</code> is not defined.  You need to define this macro entirely within an <code>#if</code>.</p>\n\n<pre><code>#ifndef i\n#define DEFINED 0\n#else\n#define DEFINED 1\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1484751567, "last_edit_date": 1484751567, "creation_date": 1484751041, "answer_id": 41722465, "question_id": 41721899, "link": "https://stackoverflow.com/questions/41721899/check-if-int-is-defined-as-macro-c/41722465#41722465", "title": "Check if int is defined as macro. C", "body": "<p>The preprocessor doesn't \"know\" C.  Barring special directives like <code>#error</code> and <code>#pragma</code>, it is much just a text-substitution system.</p>\n\n<p><code>#if((n)def)</code> only works for macros declared <em>with the preprocessor</em> with the <code>#define</code> keyword; C variables like <code>int i</code> are not macros.</p>\n\n<p>To give you a better idea: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MYFORLOOP for(i = 0; i &lt; 25; i++)\n\nint main()\n{\n    int i;\n    int data[25];\n    MYFORLOOP\n    {\n        data[i] = i;\n    }\n\n    MYFORLOOP\n    {\n        printf(\"%d\\n\", data[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The code is then preprocessed before it is actually compiled, so what the compiler actually \"sees\" is:</p>\n\n<pre><code>// &lt; The contents of stdio.h, including any headers it includes itself &gt;\n\nint main()\n{\n    int i;\n    int data[25];\n    for(i = 0; i &lt; 25; i++)\n    {\n        data[i] = i;\n    }\n\n    for(i = 0; i &lt; 25; i++)\n    {\n        printf(\"%d\\n\", data[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The reason <code>#ifdef i</code> would fail is because the variable <code>i</code> is not a <code>#define</code> macro.</p>\n"}], "owner": {"reputation": 31, "user_id": 5843519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153552077759565/picture?type=large", "display_name": "InstaFjelle", "link": "https://stackoverflow.com/users/5843519/instafjelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1484751567, "creation_date": 1484749393, "last_edit_date": 1484751174, "question_id": 41721899, "link": "https://stackoverflow.com/questions/41721899/check-if-int-is-defined-as-macro-c", "title": "Check if int is defined as macro. C", "body": "<p>I've tried to check around, but I can't seem to find an answer.</p>\n\n<p>I'm writing some C code, and I want to figure out if given <code>int i</code>, is that defined as a macro somewhere. For instance, running a <code>for</code> loop checking if the counter is a macro. I've come up with the following, but it give me warnings when I compile, so I'm assuming its bad code</p>\n\n<pre><code>for(int i = 1; i &lt; 25; i++){\n   #define DEFINED 1\n   #ifndef i\n   #define DEFINED 0\n   #endif\n   int a = DEFINED;\n   if(a){\n      bla bla\n   }\n}\n</code></pre>\n\n<p>Thank you so much.</p>\n"}, {"tags": ["c", "microcontroller", "wireless"], "comments": [{"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1484750125, "post_id": 41721891, "comment_id": 70638811, "body": "I think you want the joystick to control the motor. Joystick move =&gt; accelerate &#39;x&#39; on transmitter MCU =&gt; wireless =&gt; receiver MCU receives &quot;accelerate X&quot; command =&gt; accelerate motor. If this is right - what is the question?"}, {"owner": {"reputation": 1, "user_id": 7312824, "user_type": "registered", "profile_image": "https://graph.facebook.com/1159658114131010/picture?type=large", "display_name": "Youssef El Halal", "link": "https://stackoverflow.com/users/7312824/youssef-el-halal"}, "reply_to_user": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484750835, "post_id": 41721891, "comment_id": 70639365, "body": "Should I put the command to accelerate the motor into the joystick MCU or the Receiver MCU? The receiver&#39;s MCU will only get the order and pass direct to the motor? I know this is a huge subject to explain but I&#39;m lost where I should start to research about this."}, {"owner": {"reputation": 1, "user_id": 7312824, "user_type": "registered", "profile_image": "https://graph.facebook.com/1159658114131010/picture?type=large", "display_name": "Youssef El Halal", "link": "https://stackoverflow.com/users/7312824/youssef-el-halal"}, "reply_to_user": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484750892, "post_id": 41721891, "comment_id": 70639398, "body": "And yes, what you say is exactly what I want to do."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1484751922, "post_id": 41721891, "comment_id": 70640119, "body": "If &quot;yes&quot; - then I don&#39;t see how you finish the job when you cannot understand on what side to put accelerate command. It is like a pilot asking how to turn on the jet engine."}, {"owner": {"reputation": 1, "user_id": 7312824, "user_type": "registered", "profile_image": "https://graph.facebook.com/1159658114131010/picture?type=large", "display_name": "Youssef El Halal", "link": "https://stackoverflow.com/users/7312824/youssef-el-halal"}, "reply_to_user": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484752579, "post_id": 41721891, "comment_id": 70640632, "body": "Where I start to research? I can program, I just don&#39;t know how the communication process works."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484753652, "post_id": 41721891, "comment_id": 70641470, "body": "Read docs for RF module. Try to find example for transmitter and receiver side."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484813501, "post_id": 41721891, "comment_id": 70666874, "body": "The transmitter &quot;knows&quot; the joystick, but not the motors; the receiver knows the motors, but not the joystick. Let the transmitter send what it knows, i.e. the values in the range -100..100 for each axis, and let the receiver interpret those values as appropriate for the motors. Tomorrow, you will be able to design another transmitter with a gas pedal and a steer instead of a joystick."}], "answers": [{"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 0, "last_activity_date": 1484796348, "creation_date": 1484796348, "answer_id": 41733184, "question_id": 41721891, "link": "https://stackoverflow.com/questions/41721891/send-data-from-a-microcontroller-to-another/41733184#41733184", "title": "Send data from a microcontroller to another", "body": "<p>Well this is most definitely a \"primarily opinion based\" question and may very well get closed...but...</p>\n\n<p>This is your design, you need to design it.  There isnt a wrong answer in this case, you can have the joystick board simply pass the joystick switch state or analog state depending on what kind they are...OR...you can have the joystick board using timing and how long the joystick is held in a position and perhaps compute what you think the devices position should be and just pass that (you need to rotate m steps this way and n steps that way).  Or depending on your overall system design could come up with other solutions to balance the load between the microcontrollers.  I assume what you are really wanting to do here is \"simply\" use the wireless and the extra mcu as a way to have the joystick not wired.  If the joystick were wired and you did it with one mcu and these are switch based (not analog resistance) joysticks then that one mcu would simply be reading the switch state at some interval, perhaps debouncing.  So then when you add wireless to it you would want the wireless solution to simply pass the same switch state, not in the same register space and not necessarily the same bit positions in whatever data, but just the switch state.  As needed you have the added benefit of the joystick mcu can debounce. Also perhaps only send state changes and not have to bother the motor mcu every N units of time.</p>\n\n<p>I tried modules like these recently and was very disappointed, but am considering trying them again or a different vendor/build of them.  They should \"feel\" like a wire for say serial data at some slow rate 4800 baud, 2400 baud, etc.  First try I had to do things like constantly send a pattern say the same byte 0xAA, then every so often have a small payload show up in there so search for 0xAA then when you see something else count out so many bytes that is the payload.  It went downhill from there when I used separate computers/supplies to send the data as if most of my success although marginal was perhaps through ground noise not actually wireless.  They sell tons of these and folks use them so no doubt it was something I did or bought garbage modules, or maybe I shouldnt have bought the ones with antennas, and soldered those on, etc.</p>\n\n<p>I would recommend two things.  First get both mcus up and running the application using a wired connection, just some jumper wires.  You might have to come back to this as you perhaps change your protocol or baud rate, etc if needed.  Perhaps (most likely) you want to send the payload out often even if the data has not changed if the wireless connection is not perfectly reliable, allowing the occasional lost data packet to be handled on the next one.  Second learning to use the wireless connection is a separate experiment, the code on both sides should just be working that one problem how to I talk over this interface, no motor drivers no joysticks, just code to talk from one to the other.</p>\n\n<p>Likely a good idea, esp if you dont need to be constantly transmitting, is to design your own packet.  Ideally one or more features, a sync pattern and length or a sync pattern and checksum or sync pattern, length and checksum (as well as a payload).  So maybe a 0x7E byte as a sync pattern, perhaps you are always going to send 32 bits or 4 bytes of payload so dont need a length and then maybe a checksum of the payload or checksum of the whole thing sync pattern and payload.  your reciever then takes in bytes from the uart into a circular buffer basically or not even that just use a very simple state machine, if searching for sync and byte is not 0x7E then discard, if 0x7e then go to payload state with a count of zero, receive the next four bytes (payload) summing them into a checksum as each arrives. after payload the next byte is checksum, if it matches the the whole thing is good pass the payload to the control system to update the switch state and/or just shove it into the global variable that the control system is watching as if it were a direct connection to the joystick switch state.   </p>\n\n<p>You can get as complicated or not as you want, but I would never in this kind of a design assume that both sides are always in sync and every N bytes is the N bytes sent in the right position, even if you never drop a byte, this is a one direction communication path so if the receiver comes up while the transmitter is mid payload the receiver comes up in the middle of the payload/packet and is always off in its interpretation of the data.  You can do a slip/ppp thing whichever it is and insure the sync pattern is never in the data by adding more work.  Or not, I doubt you need to be that complicated as I assume you are likely only sending one or a few bytes of actual data per update.</p>\n\n<p>why I tried the continuous stream as way back the first time i tried products like these, long before they were a buck or so from china on ebay, we had to insure \"transition density\" you could not string more than a couple bit cells of either state in a row, couldnt have more than say two zeros in a row or two ones in a row basically had to do a biphase-l (manchester II) in software before shoving the bytes into the uart, then undoing it on the other side.  Hopefully the hardware does that for you and you dont have to, but push comes to shove you might have to take every byte and only every other bit in the byte is payload the other bit next to it is the inverse might have to send the byte 0x01 (00000001) as (0101010101010110) 0x55 0x56.  Hopefully you dont have to do that, it is not much fun.</p>\n\n<p>Your microcontroller development toolbox should include some usb to serial solutions, can get them for a buck or two on ebay from china or from adafruit or sparkfun for 10-15 bucks.  The china ones sometimes have a 5v or 3.3v jumper or switch.  One way to start with these modules is to hook one to one of these usb to serial breakouts 5V or 3.3 as needed for that rx or tx module.  For tx put the uart out (tx) on the data pin, for rx the rx in on the data pin.  And then fire up two copies of minicom or whatever dumb terminal program you use, set both to some slow speed like 1200baud, and type in one and see if what you type comes out the other.  Hold down a character, U is a good one as with 8n1 it produces a square wave.  does that come through clean?  what if you slow down both sides?  what if you speed up.  From simple experiments like that you can start to develop your protocol.  If you have a scope (having one is easier these days but can still be pricy, a few hundred bucks, but access to one is pretty important) you can do this even easier, generate the signal either with microcontroller or usb to serial or whatever then look at what shows up on the other side with the scope, how ugly/clean is it?  Can you make it better looking by changing the data or by pounding the interface with continuous data.</p>\n"}], "owner": {"reputation": 1, "user_id": 7312824, "user_type": "registered", "profile_image": "https://graph.facebook.com/1159658114131010/picture?type=large", "display_name": "Youssef El Halal", "link": "https://stackoverflow.com/users/7312824/youssef-el-halal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 747, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1484796348, "creation_date": 1484749373, "question_id": 41721891, "link": "https://stackoverflow.com/questions/41721891/send-data-from-a-microcontroller-to-another", "title": "Send data from a microcontroller to another", "body": "<p>I'm making a project that require send data from one microcontroller to another via wireless (I'm going to use 433Mhz RF modules or 2.4Ghz, didn't decide it yet). Specifically, I'm making a joystick which control 4 dc motors. So my question is: When I write the code, should I put the command to accelerate 'x' motor into the receiver's microcontroller (the board that control the motors) or into the transmitter's microcontroller (the joystick's board)? For example, if I put the joystick to the left to accelerate motor 3 and 4, where would I wrote this code? \nI'm doing this project in arduino (ATmega328 with arduino bootloader).</p>\n"}, {"tags": ["c", "c99", "complex-numbers"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1484812217, "post_id": 41721883, "comment_id": 70666254, "body": "Assuming there is no other way to do this, you might want to add several static assertions to test that <code>sizeof</code>/<code>alignof</code>/<code>offsetof</code> of these types and their members match. It&#39;s not perfect guarantee, though."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1495153814, "post_id": 41721883, "comment_id": 75144361, "body": "@user694733: A more important question is whether gcc and clang can be relied upon to recognize potential aliasing between c[i] and z[i].  Unfortunately, there&#39;s no way to test for that."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1484750058, "post_id": 41722079, "comment_id": 70638768, "body": "&quot;Assuming no padding&quot; != &quot;universally valid&quot;  The question your answer implies is, &quot;Can no padding be universally assumed?&quot;"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484750506, "post_id": 41722079, "comment_id": 70639109, "body": "@AndrewHenle I thought that was implied by my answer. Provided some explanations."}, {"owner": {"reputation": 90, "user_id": 7114463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa60ff8d9cc7b0d12beee4277aeb0d26?s=128&d=identicon&r=PG&f=1", "display_name": "Jan \u0160mydke", "link": "https://stackoverflow.com/users/7114463/jan-%c5%a0mydke"}, "edited": false, "score": 0, "creation_date": 1484751182, "post_id": 41722079, "comment_id": 70639615, "body": "Thanks, that&#39;s useful! However, <b>I may need to know if there is rally no padding within the structure</b> (on all platforms...) so that I can use the structure instead of the array. (The reason for it is that I want to use the C99 complex types in vala and it seems that I can only interface it as structures)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484751771, "post_id": 41722079, "comment_id": 70640010, "body": "@DeiDei It may be - I&#39;m trying to think it through. The assumption <i>feels</i> correct, because if a structure is padded to a specific alignment because of platform restrictions on a hypothetical platform, array elements would need to be similarly aligned for the same reasons."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1495153711, "post_id": 41722079, "comment_id": 75144337, "body": "In modern C, the fact that two types are layout compatible does not imply that a pointer to one may be used to access the other.  Unless there is something that would expressly grant an exemption from aliasing rules for a structure like the above, I would not trust gcc or clang to process the above code usefully except in <code>-fno-strict-aliasing</code> mode."}], "tags": [], "owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "is_accepted": false, "score": 0, "last_activity_date": 1484750427, "last_edit_date": 1484750427, "creation_date": 1484749912, "answer_id": 41722079, "question_id": 41721883, "link": "https://stackoverflow.com/questions/41721883/is-a-c99-complex-type-binary-compatible-with-a-structure-with-two-members/41722079#41722079", "title": "Is a C99 complex type binary compatible with a structure with two members?", "body": "<p>Yes, my copy of the C11 standard says (I assume C99 says the same):</p>\n\n<blockquote>\n  <p>Each complex type has the <strong>same representation and alignment\n  requirements as an array type containing exactly two elements of the\n  corresponding real type;</strong> the first element is equal to the real part,\n  and the second element to the imaginary part, of the complex number.</p>\n</blockquote>\n\n<p>Assuming no padding is added between or after members (as it most likely will not be), your <code>struct</code> is binary compatible with <code>_Complex double</code>.</p>\n\n<p>Obviously the keyword is \"assuming\" which implies not universally valid. Hence the above text from the standard. </p>\n\n<p>If you want universally valid, you'd want to use:</p>\n\n<pre><code>double val[2]; // double _Complex\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1495155053, "creation_date": 1495155053, "answer_id": 44059807, "question_id": 41721883, "link": "https://stackoverflow.com/questions/41721883/is-a-c99-complex-type-binary-compatible-with-a-structure-with-two-members/44059807#44059807", "title": "Is a C99 complex type binary compatible with a structure with two members?", "body": "<p>The pattern I have found most reliable for testing whether gcc will recognize aliasing between two types is exemplified by:</p>\n\n<pre><code>#include &lt;complex.h&gt;\ntypedef struct  { double r,i; } d2;\n\ndouble test(double complex *cd, d2 *dd)\n{\n  if (dd-&gt;r)\n    *cd = 1.0;\n  return dd-&gt;r;\n}\n</code></pre>\n\n<p>The generated code for gcc 7.1 is</p>\n\n<pre><code>.LC1:\n        .long   0\n        .long   1072693248\n        .long   0\n        .long   0\ntest:\n        movsd   xmm0, QWORD PTR [rsi]\n        ucomisd xmm0, QWORD PTR .LC0[rip]\n        jp      .L4\n        je      .L1\n.L4:\n        movsd   xmm1, QWORD PTR .LC1[rip]\n        movsd   QWORD PTR [rdi], xmm1\n        movsd   xmm1, QWORD PTR .LC1[rip+8]\n        movsd   QWORD PTR [rdi+8], xmm1\n.L1:\n        rep ret\n.LC0:\n        .long   0\n        .long   0\n</code></pre>\n\n<p>The return value of the function is in xmm0, which is loaded from dd->r\nand tested against zero.  If it's non-zero, code stores a new value to\n*cd, but does not reload the value in xmm0.</p>\n\n<p>I'm not sure for what purpose the authors of the Standard specified how complex numbers are stored given that they did not in turn make them alias-compatible with anything else, but gcc attaches more importance to the fact that the Standard doesn't mandate that it recognize aliasing than to the fact that being able to alias layout-compatible types is useful.</p>\n"}], "owner": {"reputation": 90, "user_id": 7114463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa60ff8d9cc7b0d12beee4277aeb0d26?s=128&d=identicon&r=PG&f=1", "display_name": "Jan \u0160mydke", "link": "https://stackoverflow.com/users/7114463/jan-%c5%a0mydke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1495155053, "creation_date": 1484749357, "question_id": 41721883, "link": "https://stackoverflow.com/questions/41721883/is-a-c99-complex-type-binary-compatible-with-a-structure-with-two-members", "title": "Is a C99 complex type binary compatible with a structure with two members?", "body": "<p>Can I use <code>typedef struct {double r; double i;} DC;</code>\nas a binary compatible data type for C99 <code>double complex</code> type?</p>\n\n<p>My experimental C code works in my case (gcc / x86-64 / Linux). But <strong>is this universally valid</strong>?</p>\n\n<pre><code>/* gcc -o test test.c (WORKS) */\n/* gcc -O3 -march=native -o test test.c (WORKS with volatiles) */\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;complex.h&gt;\n\ntypedef struct {\n    double r;\n    double i;\n} DC;\n\nint main()\n{\n    /* var */\n    const int N = 3;\n\n    volatile DC *c = malloc(N*sizeof(DC));\n\n    volatile double complex *z;\n    z = (double complex *) c;\n\n    int i;\n\n    /* init */\n    for(i=0; i&lt;N; i++)\n    {\n       c[i].r = (double) i+1;\n       c[i].i = (double) (i+1) * 10;\n    }\n    z[1] = -0.1 -0.2*I; // THE POINT IS HERE\n\n    /* results */\n    for(i=0; i&lt;N; i++)\n    printf(\"i = %d, c[i].r = %f c[i].i = %f\\n\", i, c[i].r, c[i].i);\n\n    /* end */\n    free((void*) c);\n\n    return 0;\n}\n</code></pre>\n\n<p>The program's output is here:</p>\n\n<pre><code>i = 0, c[i].r = 1.000000 c[i].i = 10.000000\ni = 1, c[i].r = -0.100000 c[i].i = -0.200000\ni = 2, c[i].r = 3.000000 c[i].i = 30.000000\n</code></pre>\n"}, {"tags": ["c", "struct", "unions", "xlib", "xorg"], "comments": [{"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1484747989, "post_id": 41721054, "comment_id": 70637236, "body": "Assuming having an <code>int</code> (in the original <code>union</code>) overlapping structures-with-an-initial-int is &quot;safe&quot; (my guess is it&#39;s not guaranteed to be, but probably &quot;works&quot;), then I don&#39;t see a problem with <code>XKeyEvent</code>&#39;s <i>reading</i> that value (presumably <code>KeyPress</code> and <code>KeyRelease</code> are two of the wider event-types that <code>XEvent</code> handles).  It would probably be safer to have a <code>struct { int type; union { .... } }</code> though."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1484748277, "post_id": 41721054, "comment_id": 70637421, "body": "@TripeHound: Except then you have two <code>type</code>s, the one in the outer struct, and the one that precedes each of the other types in the <code>union</code>. It seems like the goal is to have the <code>type</code> readable regardless of which <code>X*Event</code> was stored."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1484748532, "post_id": 41721054, "comment_id": 70637594, "body": "@shadowranger that is exactly the point - The X11 system sends around events as opaque structures. In case someone wants to know what&#39;s in there, he can check the <code>type</code> member and cast the union accordingly to access the actual data members. That is some sort of &quot;OOP in C&quot;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1484748694, "post_id": 41721054, "comment_id": 70637716, "body": "Seems like this is just an obfuscated way of declaring <code>typedef struct _XEvent{     int type; union { XAnyEvent xany; XKeyEvent xkey; XButtonEvent xbutton;} </code> where each struct XAnyEvent  and so on does not have the <code>type</code> member."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484749070, "post_id": 41721054, "comment_id": 70637974, "body": "@Lundin it makes coding a bit easier and sometimes even more clear - You can access the event type both <i>with</i> and <i>without</i> a cast to the inner struct."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1484747993, "creation_date": 1484747993, "answer_id": 41721411, "question_id": 41721054, "link": "https://stackoverflow.com/questions/41721054/accessing-different-members-of-a-c-union-simultaneously/41721411#41721411", "title": "Accessing different members of a c union simultaneously", "body": "<p>C99 (the previous standard of C) and onward to C11 nowadays, allow reading a union member even if it wasn't the last member written.</p>\n\n<p>They state (and I'm paraphrasing) that the value of the last written member is reinterpreted as a value of the member being read (and if their sizes differ, it behaves as \"one would expect\"). That value may be a trap value, but the simple act of reading is allowed and not undefined behavior.</p>\n\n<p>Now, the standard also specifies that if a union contains several member structures that share the same initial sequence, you can inspect the common sequence through any union member.</p>\n\n<p><code>type</code> in <code>XEvent</code> isn't a structure, but the standard says two additional things:</p>\n\n<ol>\n<li>A structure pointer, suitably converted, points to the first member.</li>\n<li>A union pointer, suitably converted, points to any union member.</li>\n</ol>\n\n<p>So each <code>type</code> in each struct must reside at the same memory location as the <code>type</code> in <code>XEvent</code>. So whether you are reading <code>ev.type</code> or <code>ev.xkey.type</code> it will be the same int.</p>\n\n<p>So what is happening in your code:</p>\n\n<ol>\n<li><p>The union is used for type erasure. Only the <code>type</code> field is used to determine the correct handler. Nothing precludes the same function from being registered in <code>handler</code> on several values of <code>type</code>.</p></li>\n<li><p>The handler knows what union member to look at, so it accesses <code>xkey</code>. Then it acts accordingly to the value of <code>type</code>.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1375, "user_id": 6780389, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0e4a17ac5c2908e5c892f6f8f87feb2?s=128&d=identicon&r=PG&f=1", "display_name": "saga", "link": "https://stackoverflow.com/users/6780389/saga"}, "edited": false, "score": 0, "creation_date": 1484748828, "post_id": 41721515, "comment_id": 70637797, "body": "Ahh, I got it now. <code>handler</code> has different entries for <code>ButtonPress</code> and <code>ButtonRelease</code>. Maybe the app doesn&#39;t handle keypresses and keyreleases differently."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 1375, "user_id": 6780389, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0e4a17ac5c2908e5c892f6f8f87feb2?s=128&d=identicon&r=PG&f=1", "display_name": "saga", "link": "https://stackoverflow.com/users/6780389/saga"}, "edited": false, "score": 0, "creation_date": 1484748948, "post_id": 41721515, "comment_id": 70637891, "body": "exactly. <code>KeyPress</code> and <code>KeyRelease</code>, though. But buttons work the same."}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": true, "score": 2, "last_activity_date": 1484748880, "last_edit_date": 1484748880, "creation_date": 1484748280, "answer_id": 41721515, "question_id": 41721054, "link": "https://stackoverflow.com/questions/41721054/accessing-different-members-of-a-c-union-simultaneously/41721515#41721515", "title": "Accessing different members of a c union simultaneously", "body": "<p>It took a while until I understood where you think your problem is - Because actually, there is none...</p>\n\n<p>You seem to be assuming that there must be a 1:1 relationship between event type ints and structures valid in the union. No, there isn't. </p>\n\n<p>What Xlib does is: It will put the same XKeyEvent structure for both KeyPress and KeyRelease events (they use the same data members, thus can be used for both event cases). </p>\n\n<p>The X11 windowing system sends around XEvents as <em>opaque structures</em> (or in OOP terminology \"base classes\") that the receiver <em>can</em> cast to the original structure (or in OOP terminology \"derived classes\") according to the event type. The overlapping <code>int</code> member \"type\" is used as a type selector.</p>\n\n<p>This is done to be able to \"route\" events in generic code to the right place without having to handle each event type. Only the interested party (the actual receiver) will cast the inner union to the correct type and \"extract\" the data members it is interested in.</p>\n"}], "owner": {"reputation": 1375, "user_id": 6780389, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0e4a17ac5c2908e5c892f6f8f87feb2?s=128&d=identicon&r=PG&f=1", "display_name": "saga", "link": "https://stackoverflow.com/users/6780389/saga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 41721515, "answer_count": 2, "score": 3, "last_activity_date": 1484748880, "creation_date": 1484747050, "question_id": 41721054, "link": "https://stackoverflow.com/questions/41721054/accessing-different-members-of-a-c-union-simultaneously", "title": "Accessing different members of a c union simultaneously", "body": "<p>I've encountered a piece of code which seems to use different members a union at the same time:</p>\n\n<pre><code>XEvent ev;\n\nif(handler[ev.type])\n    (handler[ev.type])(&amp;ev);\n</code></pre>\n\n<p>Handler is an array of functions. Here is the definition of XEvent:</p>\n\n<pre><code>typedef union _XEvent{\n    int type;/*must not be changed*/\n    XAnyEvent xany;\n    XKeyEvent xkey;\n    XButtonEvent xbutton;\n............\n} Xevent;\n</code></pre>\n\n<p>All the struct members of XEvent have an int as there first member. The called function uses the appropriate member structure of XEvent.</p>\n\n<pre><code>void\nkpress(XEvent *ev) {\n    XKeyEvent *e = &amp;ev-&gt;xkey;\n</code></pre>\n\n<p>The problem is that <code>XKeyEvent</code> seems to use the value of its first int member as well to determine whether the event was a key press or key release.</p>\n\n<pre><code>typedef struct {\n    int type; /* KeyPress or KeyRelease */\n    unsigned long serial;   /* # of last request processed by server */\n    .............\n} XKeyEvent;\n</code></pre>\n\n<p>What am I missing here?</p>\n\n<p>Note: The above code belongs to simple terminal, a terminal emulator. And all the data structures mentioned belong to Xlib.</p>\n"}, {"tags": ["c", "bit-manipulation", "32bit-64bit"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 2, "creation_date": 1484747164, "post_id": 41720990, "comment_id": 70636694, "body": "You say &quot;in C&quot; in the title, but also tag C++. The languages can be very different and solutions in one may not work in the other."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 2, "last_activity_date": 1484747735, "creation_date": 1484747735, "answer_id": 41721321, "question_id": 41720990, "link": "https://stackoverflow.com/questions/41720990/printing-a-64bit-value-in-c/41721321#41721321", "title": "printing a 64bit value in C", "body": "<p><code>1 &lt;&lt; t</code> is evaluated as <code>int</code>, use <code>1UL &lt;&lt; t</code> to evaluate as <code>unsigned long</code>.</p>\n"}], "owner": {"reputation": 1339, "user_id": 2008835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ckV1n.png?s=128&g=1", "display_name": "Manish Kumar", "link": "https://stackoverflow.com/users/2008835/manish-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 41721321, "answer_count": 1, "score": 0, "last_activity_date": 1484747735, "creation_date": 1484746873, "last_edit_date": 1484747700, "question_id": 41720990, "link": "https://stackoverflow.com/questions/41720990/printing-a-64bit-value-in-c", "title": "printing a 64bit value in C", "body": "<p>I am using ubuntu x86_64 machine and trying to set the bit position corresponding to the character in string.</p>\n\n<p>Character can a-z or A-Z, so I have kept a 64 bit vector.</p>\n\n<pre><code>long unsigned int vector = 0x0;\nchar *getunqchar(char a[]) {\n    char str[30];\n    int i;\n    long unsigned int t, test = 0;\n    for (i = 0; i &lt; strlen(a) - 1; i++) {\n        t = (long unsigned int)(a[i]) - 65;\n        printf(\"t is %ld\", t);\n        test = (long unsigned int)(1 &lt;&lt; t);\n        vector = (vector ) | test;\n\n        printf(\"vec is %ld %ld \\n\", (long unsigned int)vector, (long unsigned int)test);\n    }\n}\n\nint main() {\n    int i = 0;\n    char name[30], *temp;\n    int cnt[52], t;\n\n    memset(cnt, 0, sizeof(cnt));\n    printf(\"vec is %lx\", vector);\n    printf(\"Enter the string name: \");\n    fgets(name, sizeof(name), stdin);\n\n    temp = getunqchar(name);\n}\n</code></pre>\n\n<p>when I input like below:</p>\n\n<pre><code>Enter the string name: mAn\nt is 44vec is 4096 4096\nt is 0vec is 4097 1\nt is 45vec is 12289 8192\n</code></pre>\n\n<p><code>t</code> value is <code>44</code>, I expect output as <code>2^44</code> but I am getting <code>2^12</code>.\n<code>44</code> is <code>32 + 12</code>. It seems to be some issue because of 64 bit. But I am not getting. Any help is appreciated.</p>\n"}, {"tags": ["c", "char", "strlen"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 3, "creation_date": 1484746845, "post_id": 41720935, "comment_id": 70636477, "body": "Because <code>p</code>doesn&#39;t point to a valid (NUL terminated) string"}, {"owner": {"reputation": 31, "user_id": 7302450, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_-lnzxEGQcI/AAAAAAAAAAI/AAAAAAAAAB4/R5cxqk4SGsU/photo.jpg?sz=128", "display_name": "Weiss Zucker", "link": "https://stackoverflow.com/users/7302450/weiss-zucker"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1484746933, "post_id": 41720935, "comment_id": 70636537, "body": "@George Tried but still get 7"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1484747266, "post_id": 41720935, "comment_id": 70636764, "body": "<code>strlen()</code> return type is <code>size_t</code>, you should use a different format: <code>printf(&quot;%lu\\n&quot;,strlen(p));</code> -&gt; <code>printf(&quot;%zu\\n&quot;,strlen(p));</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7302450, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_-lnzxEGQcI/AAAAAAAAAAI/AAAAAAAAAB4/R5cxqk4SGsU/photo.jpg?sz=128", "display_name": "Weiss Zucker", "link": "https://stackoverflow.com/users/7302450/weiss-zucker"}, "edited": false, "score": 0, "creation_date": 1484747217, "post_id": 41721009, "comment_id": 70636728, "body": "Yes I know strlen will look for a terminator. My question is actually why the result is always 7 if strlen just looks for a &#39;\\0&#39; in the memory."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 31, "user_id": 7302450, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_-lnzxEGQcI/AAAAAAAAAAI/AAAAAAAAAB4/R5cxqk4SGsU/photo.jpg?sz=128", "display_name": "Weiss Zucker", "link": "https://stackoverflow.com/users/7302450/weiss-zucker"}, "edited": false, "score": 0, "creation_date": 1484747493, "post_id": 41721009, "comment_id": 70636905, "body": "@WeissZucker Updated my answer, hope it makes it clearer."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1484747476, "last_edit_date": 1484747476, "creation_date": 1484746926, "answer_id": 41721009, "question_id": 41720935, "link": "https://stackoverflow.com/questions/41720935/why-i-get-a-length-of-7-when-i-apply-strlen-to-a-pointer-to-a-single-char/41721009#41721009", "title": "Why I get a length of 7 when I apply strlen() to a pointer to a single char?", "body": "<p>Remember that strings in C are really called <em>null-terminated byte strings</em>. All strings are terminated with a single <code>'\\0'</code> character, meaning that a single-character string actually is <em>two</em> characters: The single character plus the terminator.</p>\n\n<p>When you have the pointer pointing to <code>c</code> in your code, you don't have two characters, only the single characters contained in <code>c</code>. You don't know if there is a terminator after that character in memory, so when <code>strlen</code> looks for that terminator it will pass the character and go out into memory not belonging to any string to look for it, and you will have <em>undefined behavior</em>.</p>\n\n<hr>\n\n<p>To try an illustrate what you have, take a look at this \"graphical\" representation:</p>\n\n<pre>\n+---+     +-----+----------------------\n| p | --> | 'a' | indeterminate data...\n+---+     +-----+----------------------\n</pre>\n\n<p>That's basically how it looks like in memory. The variable <code>p</code> points to the location where your character is stored, but after that in memory is just indeterminate data. This will be seemingly random, and you can not tell where there will be a byte corresponding to a string terminator character.</p>\n\n<p>There's no way to say why <code>strlen</code> get the value <code>7</code> from, except that it finds six non-terminator bytes in the indeterminate data after your character. Next time you run it, or if you run it on a different system, you might get a completely different result.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1484746968, "creation_date": 1484746968, "answer_id": 41721024, "question_id": 41720935, "link": "https://stackoverflow.com/questions/41720935/why-i-get-a-length-of-7-when-i-apply-strlen-to-a-pointer-to-a-single-char/41721024#41721024", "title": "Why I get a length of 7 when I apply strlen() to a pointer to a single char?", "body": "<p>The variable <code>p</code> points to a single character, not to a null terminated string.  So when you call <code>strlen</code> on it, it attempts to access whatever memory is after <code>c</code>.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>What's happening <em>in this particular case</em> is that after <code>a</code> in memory there are six non-zero bytes followed by one zero byte, so you get 7.  You can't however depend on this behavior.  For example, if you add more local variables before and after <code>a</code>, even unused ones, you'll probably get a different result.</p>\n"}, {"tags": [], "owner": {"reputation": 438, "user_id": 1088006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815d232e47fc5f5a457554013cd26bab?s=128&d=identicon&r=PG", "display_name": "FunkyCat", "link": "https://stackoverflow.com/users/1088006/funkycat"}, "is_accepted": false, "score": 0, "last_activity_date": 1484747145, "creation_date": 1484747145, "answer_id": 41721102, "question_id": 41720935, "link": "https://stackoverflow.com/questions/41720935/why-i-get-a-length-of-7-when-i-apply-strlen-to-a-pointer-to-a-single-char/41721102#41721102", "title": "Why I get a length of 7 when I apply strlen() to a pointer to a single char?", "body": "<p>Because strlen finds first null character starting from passed address. You pass address of only character, so strlen tries to look forward in memory until first null char in memory after variable c.</p>\n\n<p>Anyway, you cannot be sure about result and it depends on compiler and all code you wrote. Moreover, you program can even fail with memory exception.</p>\n"}], "owner": {"reputation": 31, "user_id": 7302450, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_-lnzxEGQcI/AAAAAAAAAAI/AAAAAAAAAB4/R5cxqk4SGsU/photo.jpg?sz=128", "display_name": "Weiss Zucker", "link": "https://stackoverflow.com/users/7302450/weiss-zucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1484747120, "answer_count": 3, "score": 0, "last_activity_date": 1484747476, "creation_date": 1484746740, "question_id": 41720935, "link": "https://stackoverflow.com/questions/41720935/why-i-get-a-length-of-7-when-i-apply-strlen-to-a-pointer-to-a-single-char", "closed_reason": "Duplicate", "title": "Why I get a length of 7 when I apply strlen() to a pointer to a single char?", "body": "<p>The C code:  </p>\n\n<pre><code>char c = 'a';\nchar *p = &amp;c;\nprintf(\"%lu\\n\",strlen(p));\n</code></pre>\n\n<p>And I get a result 7 and I have no idea how this 7 come out.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 1, "creation_date": 1484746191, "post_id": 41720702, "comment_id": 70636031, "body": "C or C++? Macro or function or any?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1484746223, "post_id": 41720702, "comment_id": 70636052, "body": "<a href=\"https://graphics.stanford.edu/~seander/bithacks.html#IntegerLogFloat\" rel=\"nofollow noreferrer\">graphics.stanford.edu/~seander/bithacks.html#IntegerLogFloat</a>"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 4, "creation_date": 1484746224, "post_id": 41720702, "comment_id": 70636053, "body": "Why a macro (and not a function)? (Also remove either the C or the C++ tag)"}, {"owner": {"reputation": 584, "user_id": 7213143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d196f6ce0c0fe2a90c2f96e08ccf4c70?s=128&d=identicon&r=PG&f=1", "display_name": "realvictorprm", "link": "https://stackoverflow.com/users/7213143/realvictorprm"}, "edited": false, "score": 2, "creation_date": 1484746252, "post_id": 41720702, "comment_id": 70636075, "body": "I&#39;m sorry, that&#39;s simply mathematics, just think about it once again.."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 5, "creation_date": 1484746289, "post_id": 41720702, "comment_id": 70636116, "body": "<code>pow(2, ceil(log2(10.75)))</code> maybe?"}, {"owner": {"reputation": 2670, "user_id": 346104, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/31duc.jpg?s=128&g=1", "display_name": "franji1", "link": "https://stackoverflow.com/users/346104/franji1"}, "edited": false, "score": 0, "creation_date": 1484746479, "post_id": 41720702, "comment_id": 70636246, "body": "Maybe OP wants to look at the IEEE representation and manipulate the raw DWORD (OP mentioned float, not sure if that was <code>float</code> or the English term)???"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 2670, "user_id": 346104, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/31duc.jpg?s=128&g=1", "display_name": "franji1", "link": "https://stackoverflow.com/users/346104/franji1"}, "edited": false, "score": 1, "creation_date": 1484746605, "post_id": 41720702, "comment_id": 70636322, "body": "@franji1 Since there is not mandate in C++ that floats be IEEE that would bind the OP to specific implementations that do."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "edited": false, "score": 0, "creation_date": 1484747628, "post_id": 41720702, "comment_id": 70636988, "body": "Please, a Macro if possible."}, {"owner": {"reputation": 4025, "user_id": 2599552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bApEQ.png?s=128&g=1", "display_name": "James Snook", "link": "https://stackoverflow.com/users/2599552/james-snook"}, "edited": false, "score": 2, "creation_date": 1484748484, "post_id": 41720702, "comment_id": 70637554, "body": "<code>frexp</code> in the math library will return the result you want, but it&#39;s not a macro (the return value is not the exponent, it&#39;s the value that you&#39;re trying to calculate)."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "edited": false, "score": 0, "creation_date": 1484748831, "post_id": 41720702, "comment_id": 70637803, "body": "Added more info to the questions, please check it."}, {"owner": {"reputation": 18643, "user_id": 1737909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058573b71875bc70b5a4e30140c94040?s=128&d=identicon&r=PG", "display_name": "Ven", "link": "https://stackoverflow.com/users/1737909/ven"}, "edited": false, "score": 4, "creation_date": 1484750700, "post_id": 41720702, "comment_id": 70639270, "body": "why do you want a macro?"}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "edited": false, "score": 0, "creation_date": 1484751451, "post_id": 41720702, "comment_id": 70639780, "body": "Can it be done like the code above?"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 5923332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-etWvSginVQ0/AAAAAAAAAAI/AAAAAAABKcI/bYdEAX9efgM/photo.jpg?sz=128", "display_name": "Furkan Fidan", "link": "https://stackoverflow.com/users/5923332/furkan-fidan"}, "is_accepted": false, "score": 3, "last_activity_date": 1484747909, "creation_date": 1484747909, "answer_id": 41721383, "question_id": 41720702, "link": "https://stackoverflow.com/questions/41720702/finding-closest-power-of-2-for-any-float-at-compile-time/41721383#41721383", "title": "Finding closest power of 2 for any float at compile time", "body": "<p>How about this:</p>\n\n<pre><code>#include &lt;math.h&gt;\n\n#define collapse(value) (value &lt; 0 ? value / pow(2, ceil(log2(value * -1))) : value / pow(2, ceil(log2(value)))) \n\nint main() {\n    cout &lt;&lt; collapse(10.75) &lt;&lt; endl;\n    cout &lt;&lt; collapse(20.91) &lt;&lt; endl;\n    cout &lt;&lt; collapse(-1) &lt;&lt; endl;\n    cout &lt;&lt; collapse(-2.5) &lt;&lt; endl;\n    cout &lt;&lt; collapse(5.7) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>0.671875\n0.653438\n-1\n-0.625\n0.7125\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "is_accepted": true, "score": 0, "last_activity_date": 1485242829, "creation_date": 1485242829, "answer_id": 41822376, "question_id": 41720702, "link": "https://stackoverflow.com/questions/41720702/finding-closest-power-of-2-for-any-float-at-compile-time/41822376#41822376", "title": "Finding closest power of 2 for any float at compile time", "body": "<p>This does it: </p>\n\n<pre><code>#define CALC_SCALE ( x &gt; 16 ? 32 : x &gt; 8 ? 16 : x &gt; 4 ? 8 : x &gt; 2 ? 4 : x &gt; 1 ? 2 : 1 )\n</code></pre>\n\n<p>At compile time: </p>\n\n<pre><code>int x = CALC_SCALE( 13 );\n</code></pre>\n\n<p>is compiled to: </p>\n\n<pre><code>int x = 16;\n</code></pre>\n\n<p>This can easily be changed to support floats.</p>\n"}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 41822376, "answer_count": 2, "score": -7, "last_activity_date": 1485242829, "creation_date": 1484746060, "last_edit_date": 1485242491, "question_id": 41720702, "link": "https://stackoverflow.com/questions/41720702/finding-closest-power-of-2-for-any-float-at-compile-time", "title": "Finding closest power of 2 for any float at compile time", "body": "<p>I need to scale all floats to <code>[-1,1]</code> range by dividing with <strong>closest higher</strong> power of 2. The code needs to be Q0.31 fixed-point, so no floats.</p>\n\n<p>For example, 10.75 would be divided by 16, 20.91 by 32, 1000.17 by 1024, etc, all the way to 2^31. </p>\n\n<p>I'd need the scaling to be done at compilation time. </p>\n\n<p>For example: </p>\n\n<pre><code>#define PARAMETER1 10.0f // this could be changed in various builds\n#define PARAMETER1_SCALE ( CALC_SCALE(PARAMETER1) )\n\n#define float_to_fixed(x) ( (int)( (float)(x)*(float)0x80000000 ) )\n\nint main()\n{\n    int par1 = float_to_fixed( PARAMETER1/PARAMETER1_SCALE );\n\n    // use par1 here\n    // ...\n    // then descale using PARAMETER1_SCALE again      \n}\n</code></pre>\n\n<p>Is there a C macro <code>CALC_SCALE</code> which would calculate this?</p>\n"}, {"tags": ["c", "signals"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1484744399, "post_id": 41720087, "comment_id": 70634703, "body": "I don&#39;t understand the question. Return 1 to what?"}, {"owner": {"reputation": 69, "user_id": 3656189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5dde3880097dbb56d48ba6da690a2ebf?s=128&d=identicon&r=PG&f=1", "display_name": "user100000", "link": "https://stackoverflow.com/users/3656189/user100000"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484744763, "post_id": 41720087, "comment_id": 70634945, "body": "@DavidSchwartz Sorry. I added an edit to my question. Please have a read."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1484744817, "post_id": 41720087, "comment_id": 70634980, "body": "The standard mandates <code>void</code>. You cannot return a value. Use a (<code>volatile</code>) global variable instead (somewhat like <code>errno</code>)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1484744848, "post_id": 41720087, "comment_id": 70635001, "body": "You cannot return a value from a signal handler, since <b>there is no caller</b> to recieve it. The only thing that could possibly help you is one of the <code>wait()</code> functions. Also: SIGSTOP (and SIGKILL) cannot be caught)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1484744963, "post_id": 41720087, "comment_id": 70635081, "body": "<code>signal</code> does not even send a signal - it just sets up the handling of a signal. <code>kill</code> sends a signal."}], "answers": [{"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 4, "creation_date": 1484744999, "post_id": 41720308, "comment_id": 70635111, "body": "This won&#39;t work. Components other than the compiler are free to optimize the <code>while</code> loop to not check <code>g_flag</code> (even if it&#39;s <code>volatile</code>). You need to use a <code>sig_atomic_t</code> or equivalent -- see the C standard."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484745157, "post_id": 41720308, "comment_id": 70635242, "body": "Also, you can&#39;t use a pthread conditional wait since none of those functions are signal safe."}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484745338, "post_id": 41720308, "comment_id": 70635380, "body": "Thanks for pointing this out. But any reference why you say while loop is optimized even if declared volatile? Yes, we cannot use conditional wait as it uses mutex. Something like eventfd is good."}, {"owner": {"reputation": 69, "user_id": 3656189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5dde3880097dbb56d48ba6da690a2ebf?s=128&d=identicon&r=PG&f=1", "display_name": "user100000", "link": "https://stackoverflow.com/users/3656189/user100000"}, "edited": false, "score": 0, "creation_date": 1484745351, "post_id": 41720308, "comment_id": 70635395, "body": "@user1969104 This is a great response and I&#39;m supposed to be implementing conditional pthreads later on but in our course at least we are discouraged from using global variables. Would you be able to explain a little further how I could adapt the code for conditional pthreads?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 69, "user_id": 3656189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5dde3880097dbb56d48ba6da690a2ebf?s=128&d=identicon&r=PG&f=1", "display_name": "user100000", "link": "https://stackoverflow.com/users/3656189/user100000"}, "edited": false, "score": 1, "creation_date": 1484745634, "post_id": 41720308, "comment_id": 70635599, "body": "@user100000 \u2014 just about the only communication mechanism available to signal handlers is via global variables.  If you can&#39;t use them, don&#39;t do signal handling.  It is pretty much as simple as that   Note that many functions are not a sync-signal safe. In particular, the standard I/o functions are not."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1484745647, "post_id": 41720308, "comment_id": 70635609, "body": "It&#39;s what the C standard says. I can&#39;t think of any way it could fail, but you never know what future hardware might do."}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "reply_to_user": {"reputation": 69, "user_id": 3656189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5dde3880097dbb56d48ba6da690a2ebf?s=128&d=identicon&r=PG&f=1", "display_name": "user100000", "link": "https://stackoverflow.com/users/3656189/user100000"}, "edited": false, "score": 0, "creation_date": 1484745871, "post_id": 41720308, "comment_id": 70635795, "body": "@user100000, as David pointed out, conditional variable may not be safe in the signal handler. You may want to read eventfd. Just call eventfd(...) in main, and read(..) instead of while loop. From signal handler, call write(...). You can look into examples of eventfd."}, {"owner": {"reputation": 69, "user_id": 3656189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5dde3880097dbb56d48ba6da690a2ebf?s=128&d=identicon&r=PG&f=1", "display_name": "user100000", "link": "https://stackoverflow.com/users/3656189/user100000"}, "edited": false, "score": 0, "creation_date": 1484746059, "post_id": 41720308, "comment_id": 70635916, "body": "@user1969104 thank you for the information. I&#39;ll take a look at what you suggested."}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484746634, "post_id": 41720308, "comment_id": 70636340, "body": "@DavidSchwartz, Can you please provide a more specific reference to help me understand it better. I assume that compiler will not optimize volatile as mentioned in <a href=\"http://www.keil.com/support/man/docs/armcc/armcc_chr1359124222941.htm\" rel=\"nofollow noreferrer\">keil.com/support/man/docs/armcc/armcc_chr1359124222941.htm</a>. Do you mean a future processor hardware could optimize the execution? Doesn&#39;t it mean the processor is not behaving as expected?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1484747302, "post_id": 41720308, "comment_id": 70636792, "body": "@user1969104 It means the processor is not behaving as you expected. But what in the C standard gives you the right to expect that? You have the right to expect that the C compiler will generate code that makes the CPU execute in a way that the results comply with the requirements of the C standard and that&#39;s it. C99 says &quot;If the signal occurs other than as the result of calling the <code>abort</code> or <code>raise</code> function, the behavior is undefined if the signal handler refers to any object with static storage duration other than by assigning a value to an object declared as <code>volatile sig_atomic_t</code>[.]&quot;"}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484747857, "post_id": 41720308, "comment_id": 70637141, "body": "@DavidSchwartz, Yes, because older C standards did not concern about threads in the first place and I have no right to assume that the write in one thread is visible in another thread unless synchronized explicitly.  But much legacy C code used this logic, and I believe compilers ensure this visibility from signal handlers, regardless of whether you declare it sig_atomic_t. May be I am wrong."}, {"owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484749413, "post_id": 41720308, "comment_id": 70638239, "body": "@DavidSchwartz And also, I hope that as soon as we add eventfd synchronization, the kind of execution optimization that you think as a possibility, may not be there."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1484749560, "post_id": 41720308, "comment_id": 70638374, "body": "@user1969104 C99&#39;s <code>sig_atomic_t</code> type is guaranteed to be atomic in the context of signal handlers (i.e. no &quot;half&quot; updates). That means it can be any type on an implementation as long  as its properties are guaranteed. For example, on my 64-bit Linux <code>sig_atomic_t</code> is typedef&#39;ed to <code>int</code>. But on a different architecture, it may be typedef&#39;ed to something else -- that&#39;s an implementation&#39;s choice provided whatever the type they choose guarantees the semantics required for <code>sig_atomic_t</code>. Regardless of <code>int</code> works or not, there&#39;s no reason to use <code>int</code> when <code>sig_atomic_t</code> is available."}], "tags": [], "owner": {"reputation": 2180, "user_id": 1969104, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26510736e83fe7d8f645b67812a5c13b?s=128&d=identicon&r=PG", "display_name": "user1969104", "link": "https://stackoverflow.com/users/1969104/user1969104"}, "is_accepted": false, "score": 0, "last_activity_date": 1484745356, "last_edit_date": 1484745356, "creation_date": 1484744940, "answer_id": 41720308, "question_id": 41720087, "link": "https://stackoverflow.com/questions/41720087/how-do-i-get-a-return-value-from-a-signal-handler-in-c/41720308#41720308", "title": "How do I get a return value from a signal handler in C?", "body": "<p>Signal handler is like an interrupt and does not return to anyone. The link you posted talks about returning value while setting the signal handler and not about signal handler returning value (Note that <code>signal</code> is just setting signal handler).</p>\n\n<p>You can however do something similar to the following to return from main whenever the signal happens.</p>\n\n<pre><code>volatile int g_flag = 0;\nvoid sigintHandler(int sig_num) {\n\n    signal(SIGINT, sigintHandler);\n\n    /* Not safe to use these functions in a signal handler */\n    printf(\"\\n Cannot be terminated using Ctrl+C \\n\");\n    fflush(stdout);\n    g_flag = 1;\n}\n\nint main (void) {\n\n    signal(SIGINT, sigintHandler);\n    signal(SIGTSTP, sigtstpHandler); \n\n    while(g_flag == 0) {}  //infinite loop.\n    return g_flag;\n}\n</code></pre>\n\n<p>Please note that it is a busy loop in main which is not recommended. You an use something like eventfd to signal.</p>\n"}], "owner": {"reputation": 69, "user_id": 3656189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5dde3880097dbb56d48ba6da690a2ebf?s=128&d=identicon&r=PG&f=1", "display_name": "user100000", "link": "https://stackoverflow.com/users/3656189/user100000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484745356, "creation_date": 1484744329, "last_edit_date": 1495542252, "question_id": 41720087, "link": "https://stackoverflow.com/questions/41720087/how-do-i-get-a-return-value-from-a-signal-handler-in-c", "title": "How do I get a return value from a signal handler in C?", "body": "<p>I read a similar question in <a href=\"https://stackoverflow.com/questions/23076909/return-value-of-signal\">this</a> link but it didn't solve my problem so apologies for the repeat question. </p>\n\n<p>I have the following code that basically receives Ctrl+C and Ctrl+Z when the program is executed but I would like for the 2 signal handler functions to return 1 when it receives the signals from terminal. </p>\n\n<p>The link said something about using typedef and being fairly new to C I don't know how to implement that in the code I have. </p>\n\n<p>Here's the code : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n\n/* Signal Handler for SIGINT */\nvoid sigintHandler(int sig_num) {\n\n    signal(SIGINT, sigintHandler);\n    printf(\"\\n Cannot be terminated using Ctrl+C \\n\");\n    fflush(stdout);\n}\n\n/* Signal Handler for SIGTSTP */\nvoid sigtstpHandler(int sig_num) {  \n    signal(SIGTSTP, sigtstpHandler);\n    printf(\"\\tCtrl+z received\\n\");  \n    fflush(stdout);\n}\n\nint main (void) {\n\n    signal(SIGINT, sigintHandler);\n    signal(SIGTSTP, sigtstpHandler); \n\n    while(1) {}  //infinite loop.\n    return 0;\n}\n</code></pre>\n\n<p>Thank you for your time/help.</p>\n\n<p>EDIT : I'd like for the 2 signal handler functions that are currently </p>\n\n<pre><code>    void sigintHandler(int sig_num)\n    void sigtstpHandler(int sig_num)\n</code></pre>\n\n<p>to return 1 instead of just void. So that I can do something like </p>\n\n<pre><code>int sigIntReturn = signal(SIGINT, sigintHandler);\n</code></pre>\n\n<p>in the main function. </p>\n"}, {"tags": ["c++", "c", "memory", "memory-management"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1484743713, "post_id": 41719845, "comment_id": 70634248, "body": "<i>it is both not bit aligned nor byte aligned</i>. Bit aligned? I don&#39;t get this, the minimal addressable address in C is a byte, isn&#39;t it?."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1484743843, "post_id": 41719845, "comment_id": 70634346, "body": "related/dupe: <a href=\"http://stackoverflow.com/questions/5397447/struct-padding-in-c\">stackoverflow.com/questions/5397447/struct-padding-in-c</a> and <a href=\"http://stackoverflow.com/questions/6025269/data-structure-padding\" title=\"data structure padding\">stackoverflow.com/questions/6025269/data-structure-padding</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1484743917, "post_id": 41719845, "comment_id": 70634400, "body": "Also see this wiki: <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Data_structure_alignment</a>"}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1484744077, "post_id": 41719845, "comment_id": 70634509, "body": "@KeineLust i mistakenly said it incorrectly. It is not aligned at bit boundaries."}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484744128, "post_id": 41719845, "comment_id": 70634538, "body": "@NathanOliver I&#39;m checking links you provided I&#39;ll be seeing if i gets any doubts remaining. Thank you all."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484744309, "post_id": 41719845, "comment_id": 70634648, "body": "What on earth is a &quot;bit boundary&quot;? What happens in between bit boundaries?"}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484744673, "post_id": 41719845, "comment_id": 70634881, "body": "@Kerrek SB Sir i&#39;m new to all this. I&#39;m just quoting what is written in book. Author has written following in this regard:The first structure isn\u2019t even aligned properly on bit boundaries, hence the name ReallySlowStruct. The definition of the 6-bit char variable throws the entire structure out of alignment. The second structure, SlowStruct, is also out of alignment, but at least the byte boundaries are aligned."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484746120, "post_id": 41719845, "comment_id": 70635967, "body": "The fast structure doesn&#39;t hold the same information as the slow structures; the comparison isn&#39;t fair. And using bit-fields is a good way to slow anything down"}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "edited": false, "score": 0, "creation_date": 1484746927, "post_id": 41719845, "comment_id": 70636533, "body": "I&#39;m having a hard time to roll my head around this topic. I need more time to understand memory alignment. If anyone can explain this example in detail it would be very helpful."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1484747181, "post_id": 41719845, "comment_id": 70636707, "body": "From the paraphrases, the book seems a bit glib. The layout of bitfields (i.e., that first struct) is implementation-specific, so statements about the consequences of using bitfields that don&#39;t refer both to a particular compiler and to the settings used to compile the code aren&#39;t useful."}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1484747404, "post_id": 41719845, "comment_id": 70636854, "body": "@PeteBecker i agree with you. I&#39;m just newbie kind of guy here but this book is too good till now. It covers the most important aspects of game programming which is also one of the most difficult fields. Now i think i&#39;m cleared on the concept. Nathan&#39;s links are valuable and i&#39;m marking those excellent links. Thank you all for your support."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1484751966, "post_id": 41719845, "comment_id": 70640155, "body": "The author uses a compiler extension to tell the compiler to produce poorly aligned structures by preventing padding bytes and then inserts padding bytes manually. I hope this is only done in the name of telling you about padding and alignment and this is not what the author would actually do. You should treat it as such."}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1484752506, "post_id": 41719845, "comment_id": 70640586, "body": "@nwp I agree with you partially. I ran and tested code with sizeof operators on DevC++ and the code ran as expected and statements provided in the book are completely correct. I don&#39;t think he used some compiler configuration. I used TDM GCC 4.9.2 and everything is working perfectly fine. For further note you can refer to the book."}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "edited": false, "score": 0, "creation_date": 1484753928, "post_id": 41719845, "comment_id": 70641652, "body": "Sorry everyone. I commited mistake in original question. I forgot to add 64 int var in FastStruct. I apologize. Please correct any statements regarding topic."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "edited": false, "score": 1, "creation_date": 1484752332, "post_id": 41722607, "comment_id": 70640442, "body": "Thank you for answering my question. Just now i ran some code from different links and that given in book and ran experiments, I&#39;m cleared on the topic that there is no particular standard decided upon padding. But author implies to increase performance get to know you compiler padding rules and order declarations in proper manner. Your answer is also extremly helpful. Thank you."}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "edited": false, "score": 0, "creation_date": 1484753863, "post_id": 41722607, "comment_id": 70641607, "body": "I commited mistake in FastStruct code. I forgot to add 64 int var. I&#39;m sorry. Please update the answer accordingly."}, {"owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "edited": false, "score": 0, "creation_date": 1484765722, "post_id": 41722607, "comment_id": 70649009, "body": "Thank you for correcting answer. I appreciate your help and now I&#39;m confident that i&#39;ve understood the topic. Thanks again."}, {"owner": {"reputation": 428, "user_id": 1148866, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/78a955009339665a52f8ac771b5e4392?s=128&d=identicon&r=PG", "display_name": "Victor Stone", "link": "https://stackoverflow.com/users/1148866/victor-stone"}, "edited": false, "score": 3, "creation_date": 1554830854, "post_id": 41722607, "comment_id": 97892837, "body": "In your explanation of FastStruct, you talk about &quot;b&quot; taking up 8 bytes. Shouldn&#39;t that be &quot;d&quot;?"}], "tags": [], "owner": {"reputation": 635, "user_id": 4795318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6c50cc029a14f6ad3af57d725e7c751a?s=128&d=identicon&r=PG&f=1", "display_name": "jwsc", "link": "https://stackoverflow.com/users/4795318/jwsc"}, "is_accepted": true, "score": 20, "last_activity_date": 1596518917, "last_edit_date": 1596518917, "creation_date": 1484751497, "answer_id": 41722607, "question_id": 41719845, "link": "https://stackoverflow.com/questions/41719845/memory-alignment-in-c-c/41722607#41722607", "title": "Memory Alignment in C/C++", "body": "<p>The examples given in the book are highly dependent on the used compiler and computer architecture. If you test them in your own program you may get totally different results than the author. I will assume a 64-bit architecture, because the author does also, from what I've read in the description.\nLets look at the examples one by one:</p>\n<p><strong>ReallySlowStruct</strong>\nIF the used compiler supports non-byte aligned struct members, the start of &quot;d&quot; will be at the seventh bit of the first byte of the struct. Sounds very good for memory saving. The problem with this is, that C does not allow bit-adressing. So to save newValue to the &quot;d&quot; member, the compiler must do a whole lot of bit shifting operations: Save the first two bits of &quot;newValue&quot; in byte0, shifted 6 bits to the right. Then shift &quot;newValue&quot; two bits to the left and save it starting at byte 1. Byte 1 is a non-aligned memory location, that means the bulk memory transfer instructions won't work, the compiler must save every byte at a time.</p>\n<p><strong>SlowStruct</strong>\nIt gets better. The compiler can get rid of all the bit-fiddling. But writing &quot;d&quot; will still require writing every byte at a time, because it is not aligned to the native &quot;int&quot; size. The native size on a 64-bit system is 8. so every memory address not divisable by 8 can only be accessed one byte at a time. And worse, if I switch off packing, I will waste a lot of memory space: every member which is followed by an int will be padded with enough bytes to let the integer start at a memory location divisable by 8. In this case: char a and c will both take up 8 bytes.</p>\n<p><strong>FastStruct</strong>\nthis is aligned to the size of int on the target machine. &quot;d&quot; takes up 8 bytes as it should. Because the chars are all bundled at one place, the compiler does not pad them and does not waste space. chars are only 1 byte each, so we do not need to pad them. The complete structure adds up to an overall size of 16 bytes. Divisable by 8, so no padding needed.</p>\n<hr />\n<p>In most scenarios, you never have to be concerned with alignment because the default alignment is already optimal. In some cases however, you can achieve significant performance improvements, or memory savings, by specifying a custom alignment for your data stuctures.</p>\n<p>In terms of memory space, the compiler pads the structure in a way that naturally aligns each element of the structure.</p>\n<pre><code>struct x_\n{\n   char a;     // 1 byte\n   int b;      // 4 bytes\n   short c;    // 2 bytes\n   char d;     // 1 byte\n} bar[3];\n</code></pre>\n<p><code>struct x_</code> is padded by the compiler and thus becomes:</p>\n<pre><code>// Shows the actual memory layout\nstruct x_\n{\n   char a;           // 1 byte\n   char _pad0[3];    // padding to put 'b' on 4-byte boundary\n   int b;            // 4 bytes\n   short c;          // 2 bytes\n   char d;           // 1 byte\n   char _pad1[1];    // padding to make sizeof(x_) multiple of 4\n} bar[3];\n</code></pre>\n<p>Source: <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/alignment-cpp-declarations?view=vs-2019\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/cpp/cpp/alignment-cpp-declarations?view=vs-2019</a></p>\n"}], "owner": {"reputation": 111, "user_id": 7400399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b03150274ad1f534014ae40bb3e16d?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh Mittal", "link": "https://stackoverflow.com/users/7400399/sourabh-mittal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17367, "favorite_count": 5, "accepted_answer_id": 41722607, "answer_count": 1, "score": 9, "last_activity_date": 1596518917, "creation_date": 1484743644, "last_edit_date": 1550961491, "question_id": 41719845, "link": "https://stackoverflow.com/questions/41719845/memory-alignment-in-c-c", "title": "Memory Alignment in C/C++", "body": "<p>I was reading Game Coding Complete 4th edition. There was a topic regarding Memory alignment. In the code below the author says that first struct is really slow because it is both not bit-aligned nor byte-aligned. The second one is not bit-aligned but byte-aligned. The last one is fast because it's both. He says without pragma, compiler will align the memory itself which causes waste of memory. I couldn't really get the calculations. </p>\n\n<p>This is some portion from the text:-</p>\n\n<blockquote>\n  <p>If the compiler were left to optimize SlowStruct by adding unused\n  bytes, each structure would be 24 bytes instead of just 14. Seven\n  extra bytes are padded after the first char variable, and the\n  remaining bytes are added at the end. This ensures that the entire\n  structure always starts on an 8-byte boundary. That\u2019s about 40 percent\n  of wasted space, all due to a careless ordering of member variables.</p>\n</blockquote>\n\n<p>This is the concluding line in bolds:-</p>\n\n<blockquote>\n  <p><strong>Don\u2019t let the compiler waste precious memory space. Put some of your</strong>\n  <strong>brain cells to work and align your own member variables.</strong></p>\n</blockquote>\n\n<p>Please show me calculations and explain the padding concept more clearly.</p>\n\n<p>Code:-</p>\n\n<pre><code>#pragma pack(push, 1)\nstruct ReallySlowStruct\n{\n    char c : 6;\n    __int64 d : 64;\n    int b : 32;\n    char a : 8;\n};\n\nstruct SlowStruct\n{\n    char c;\n    __int64 d;\n    int b;\n    char a;\n};\n\nstruct FastStruct\n{\n   __int64 d;\n   __int b;\n   char a;\n   char c;\n   char unused[2];\n};\n#pragma pack(pop)\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "file"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 4, "creation_date": 1484739515, "post_id": 41718418, "comment_id": 70631385, "body": "<code>fscanf(... %d ...)</code> is expecting a pointer, change to <code>fscanf(fp,&quot;%s %s %d\\n&quot;, a,b,&amp;c);</code>, (notice the address of operator <code>&amp;</code>), and you are usin <code>z</code> uninitialized in the first iteration of the <code>while</code> loop."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 4, "creation_date": 1484739717, "post_id": 41718418, "comment_id": 70631520, "body": "How much clearer can the error message be?  %d needs an <code>int*</code>, you are passing <code>int</code>."}, {"owner": {"reputation": 1, "user_id": 7435303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--laO_w3S4_k/AAAAAAAAAAI/AAAAAAAAACs/4PWqdKE8UnE/photo.jpg?sz=128", "display_name": "Asher", "link": "https://stackoverflow.com/users/7435303/asher"}, "edited": false, "score": 0, "creation_date": 1484739806, "post_id": 41718418, "comment_id": 70631583, "body": "Oh god, i&#39;m just blind, i placed &amp; in wrong place, thanx!"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1484744207, "last_edit_date": 1484744207, "creation_date": 1484740007, "answer_id": 41718624, "question_id": 41718418, "link": "https://stackoverflow.com/questions/41718418/warning-format-d-expects-argument-of-type-int-but-argument-5-has-type/41718624#41718624", "title": "warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 5 has type \u2018int\u2019 [-Wformat=]", "body": "<p>Function <code>fscanf</code> (actually all <code>scanf</code>-variants) expect, for each format specifier, a <em>memory address</em> to where the values read in can be stored. So the arguments passed to <code>scanf</code> always have to be pointers to values, not the values.</p>\n\n<p>The reason why it works with variables <code>a</code> and <code>b</code> but not with <code>c</code> is that <code>a</code> and <code>b</code> serve as pointers to a memory block of 20 consecutive characters, whereas <code>c</code> holds an integral value (not a pointer).</p>\n\n<p>To overcome this, write <code>fscanf(fp,\"%s %s %d\\n\", a,b,&amp;c);</code>, such that you provide the memory in which the value of <code>c</code> is stored rather than the value of <code>c</code> itself.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 7435303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--laO_w3S4_k/AAAAAAAAAAI/AAAAAAAAACs/4PWqdKE8UnE/photo.jpg?sz=128", "display_name": "Asher", "link": "https://stackoverflow.com/users/7435303/asher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 0, "closed_date": 1484746477, "answer_count": 1, "score": -1, "last_activity_date": 1484744207, "creation_date": 1484739376, "last_edit_date": 1484739879, "question_id": 41718418, "link": "https://stackoverflow.com/questions/41718418/warning-format-d-expects-argument-of-type-int-but-argument-5-has-type", "closed_reason": "Not suitable for this site", "title": "warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 5 has type \u2018int\u2019 [-Wformat=]", "body": "<p>I don't know what's wrong. Imo it's correct, but i have such problem.\nIt's my first program in C connected with files, and i don't know, what i'm doing wrong.</p>\n\n<pre><code>2.c: In function \u2018main\u2019:\n2.c:15:11: warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 5 has type \u2018int\u2019 [-Wformat=]\n fscanf(fp,\"%s %s %d\\n\", a,b,c);\n           ^\n</code></pre>\n\n<p>My program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    FILE *fp;\n    FILE *fb;\n    char z;\n    char a[20], b[20];\n    int c;\n    fp=fopen(\"data.txt\",\"r\");\n    fb=fopen(\"bigmoney.txt\",\"a\");\n    while (z!=EOF)\n    {\n        z=fgetc(fp);\n        fscanf(fp,\"%s %s %d\\n\", a,b,c);\n        if (c &gt; 2000)\n            fprintf(fb,\"%s %s %d\\n\", a,b,c);\n    }\n}\n</code></pre>\n\n<p>File data.txt</p>\n\n<pre><code>Jan Nowak 2000\nIrena Pierwsza 3000\nIrena Druga    2500\nKrzysztof Mrugala 3500\nTadeusz Pat 2000\nEmiliusz Jeden 1200\nAdam Arma 6000\nKornel Robo 5000\nJan Kowalski 15000\nagf dahf 524\nsdgdagf adgdagf 345345\nadgadgf dfdfgh 1168510135\narek kowalski 3300\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1484738744, "post_id": 41718181, "comment_id": 70630874, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\">undefined behavior</a>"}, {"owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 1, "creation_date": 1484738824, "post_id": 41718181, "comment_id": 70630928, "body": "<i>Perfectly fine</i> and <i>Undefined Behavior</i> is like walking with great joy on the streets of gold laced with <a href=\"https://en.wikipedia.org/wiki/Land_mine\" rel=\"nofollow noreferrer\">Land mines</a>."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1484739063, "post_id": 41718181, "comment_id": 70631078, "body": "Also, don&#39;t <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">cast the result of malloc</a>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484739516, "post_id": 41718181, "comment_id": 70631386, "body": "Now the question isn&#39;t about C. Please settle on a language."}], "answers": [{"comments": [{"owner": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484738873, "post_id": 41718210, "comment_id": 70630955, "body": "how to know that what is size allocated to &quot;b&quot; variable in above code? Since sizeof(b) will be always 4byte"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 1, "creation_date": 1484738954, "post_id": 41718210, "comment_id": 70631013, "body": "@Logicbomb - Buffer sizes need to be passed around in C. There is no way around it. Special care must be taken."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 1, "creation_date": 1484738994, "post_id": 41718210, "comment_id": 70631039, "body": "@Logicbomb record it or add a terminator, there is no other way. That said C++ is tagged in your q, if you&#39;re actually using C++ you probably shouldn&#39;t be using <code>malloc()</code>"}, {"owner": {"reputation": 2302, "user_id": 583195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5b273a1d94ed145dd9fec1d4d90738?s=128&d=identicon&r=PG", "display_name": "Gavin Lock", "link": "https://stackoverflow.com/users/583195/gavin-lock"}, "edited": false, "score": 1, "creation_date": 1484739112, "post_id": 41718210, "comment_id": 70631103, "body": "... or even <code>char*</code>. Use <code>std::string</code> and forget about having to handle memory yourself."}, {"owner": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484739182, "post_id": 41718210, "comment_id": 70631150, "body": "yes we are using c++ but this happens same with new operator also."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484739288, "post_id": 41718210, "comment_id": 70631214, "body": "@Logicbomb - (1) Don&#39;t conflate C and C++. Different languages. (2) Don&#39;t use C idioms in C++. There are resource managing objects in the standard library for a reason. (3) Don&#39;t seek to justify undefined behavior. Just avoid writing code that has it."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484739312, "post_id": 41718210, "comment_id": 70631231, "body": "Don&#39;t use <code>new</code> in C++.  Use <code>std::vector</code>, <code>std::string</code>, <code>make_unique</code>, or <code>make_shared</code>.  (There are other options, but that is most of them)"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484739451, "post_id": 41718210, "comment_id": 70631327, "body": "@Logicbomb As pointed out there&#39;s loads of <code>class</code>&#39;s in the standard library that wrap pointers. There&#39;s literally no point in writing a worse version of what is already there."}, {"owner": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484739699, "post_id": 41718210, "comment_id": 70631508, "body": "So my intention is how to restrict memory access more than allocated range. It is NOT possible to pass allocated value everywhere throughout the code."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484739756, "post_id": 41718210, "comment_id": 70631561, "body": "@Logicbomb - You can&#39;t. Neither C nor C++ protect you from it. That&#39;s why it was repeatedly suggested you actually use C++ to the fullest by employing <code>std::string</code>, that class has logic in place that <i>does</i> protect you to a greater extent."}, {"owner": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484740097, "post_id": 41718210, "comment_id": 70631777, "body": "this is NOT about using std::string or not, this about new opearator"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "edited": false, "score": 0, "creation_date": 1484740228, "post_id": 41718210, "comment_id": 70631866, "body": "@Logicbomb - We all understood that, thank you very much. The answer however is to NOT manage memory yourself, and to USE classes which protect you."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1484738880, "last_edit_date": 1484738880, "creation_date": 1484738755, "answer_id": 41718210, "question_id": 41718181, "link": "https://stackoverflow.com/questions/41718181/why-more-string-is-added-than-allocated-memory/41718210#41718210", "title": "Why more string is added than allocated memory", "body": "<p>You are writing past the end of memory you allocated. The C standard clearly says the behavior in this case is undefined.</p>\n\n<p>And undefined behavior doesn't mean \"always crash\". It means it may appear to work. It means the implementation of your C run time environment is within its right to do anything it desires, and that will still be standard compliant.</p>\n\n<p>Undefined behavior is something you should carefully watch out for, precisely because your program may \"work perfectly fine\" until it just won't.</p>\n"}], "owner": {"reputation": 519, "user_id": 3528347, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8f7f8fdaff7e22dd6131954b606fb2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Logicbomb", "link": "https://stackoverflow.com/users/3528347/logicbomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1484738878, "answer_count": 1, "score": -5, "last_activity_date": 1484739468, "creation_date": 1484738671, "last_edit_date": 1484739468, "question_id": 41718181, "link": "https://stackoverflow.com/questions/41718181/why-more-string-is-added-than-allocated-memory", "closed_reason": "Duplicate", "title": "Why more string is added than allocated memory", "body": "<p>Following is code snippet :</p>\n\n<pre><code>char *b = NULL;\n\nb = new char[5];\n\nif(b != NULL) {\n\n    printf(\"b=%p\\n\",b);\n\n    sprintf(b, \"helloPLS...123456789123456789\");\n\n    printf(\"b = %s\\n\", b);\n}\n\noutput : b = helloPLS...123456789123456789\n</code></pre>\n\n<p>If only 5 bytes were allocated then why all \"helloPLS...123456789123456789\" string is added into 5 byte memory?</p>\n\n<p>My program works perfectly fine.</p>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1484739980, "post_id": 41717934, "comment_id": 70631688, "body": "Can&#39;t you just disable <code>Werror</code>?"}, {"owner": {"reputation": 1766, "user_id": 264148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd00a8313fd6255ddbbe88e7aff63d0e?s=128&d=identicon&r=PG", "display_name": "r_ahlskog", "link": "https://stackoverflow.com/users/264148/r-ahlskog"}, "edited": false, "score": 0, "creation_date": 1484740031, "post_id": 41717934, "comment_id": 70631723, "body": "What are you trying to achieve?"}, {"owner": {"reputation": 1, "user_id": 7435251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E49mFy9A1rA/AAAAAAAAAAI/AAAAAAAABfw/OI6yPOWphGc/photo.jpg?sz=128", "display_name": "sanjit", "link": "https://stackoverflow.com/users/7435251/sanjit"}, "edited": false, "score": 0, "creation_date": 1484740209, "post_id": 41717934, "comment_id": 70631850, "body": "Disabling Werror will not be possible. a lot of effort was made in the past to resolve existing warnings. Werror was introduced to prevent further introduction of warnings."}, {"owner": {"reputation": 1, "user_id": 7435251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E49mFy9A1rA/AAAAAAAAAAI/AAAAAAAABfw/OI6yPOWphGc/photo.jpg?sz=128", "display_name": "sanjit", "link": "https://stackoverflow.com/users/7435251/sanjit"}, "edited": false, "score": 0, "creation_date": 1484740313, "post_id": 41717934, "comment_id": 70631919, "body": "We are trying to catch mem crashes during testing phase, but we need a stable build for doing this. Constant build failures due to these warning messages are proving to be a hurdle."}, {"owner": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1484741213, "post_id": 41717934, "comment_id": 70632555, "body": "Warning/Error says &quot;will always overflow destination buffer&quot;. If you do not correct this now, you will have much more trouble in your hands during testing phase. You are complaining about something that is good for you !"}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1484741279, "post_id": 41717934, "comment_id": 70632602, "body": "Does the code in some_file.c:436:13 in fact call memset() with a length argument that&#39;s too large?"}, {"owner": {"reputation": 1766, "user_id": 264148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd00a8313fd6255ddbbe88e7aff63d0e?s=128&d=identicon&r=PG", "display_name": "r_ahlskog", "link": "https://stackoverflow.com/users/264148/r-ahlskog"}, "edited": false, "score": 1, "creation_date": 1484741774, "post_id": 41717934, "comment_id": 70632894, "body": "@sanjit, why I asked was to try and make you stop and think if what you are asking makes any sense. You enable warnings and hardening and then want to sidestep it because it is too much work. Step back and think about if you as an organisation is ready for this, or then as others said temporarily disable <code>Werror</code>"}, {"owner": {"reputation": 1, "user_id": 7435251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E49mFy9A1rA/AAAAAAAAAAI/AAAAAAAABfw/OI6yPOWphGc/photo.jpg?sz=128", "display_name": "sanjit", "link": "https://stackoverflow.com/users/7435251/sanjit"}, "edited": false, "score": 0, "creation_date": 1484742967, "post_id": 41717934, "comment_id": 70633743, "body": "Agree with your comments @ r_ahlskog"}], "owner": {"reputation": 1, "user_id": 7435251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E49mFy9A1rA/AAAAAAAAAAI/AAAAAAAABfw/OI6yPOWphGc/photo.jpg?sz=128", "display_name": "sanjit", "link": "https://stackoverflow.com/users/7435251/sanjit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484738925, "creation_date": 1484738005, "last_edit_date": 1484738925, "question_id": 41717934, "link": "https://stackoverflow.com/questions/41717934/how-to-disable-warning-messages-arising-after-enabling-source-code-fortification", "title": "How to disable warning messages arising after enabling source code fortification", "body": "<p>We have recently added the following compiler flags in our project as part of code hardening.</p>\n\n<pre><code>ARCH_CFLAGS+= -fstack-protector\nARCH_CFLAGS+= -D_FORTIFY_SOURCE=2\n</code></pre>\n\n<p>For some builds, Werror is also enabled.</p>\n\n<p>My problem is that after adding the above flags, we are getting compiler warnings for potential buffer overflows. </p>\n\n<pre><code>Ex. In function \u2018memset\u2019,\n    inlined from \u2018some_function\u2019 at some_file.c:436:13:\n/usr/include/i386-linux-gnu/bits/string3.h:84:3: error: call to __builtin___memset_chk will always overflow destination buffer [-Werror]\n   return __builtin___memset_chk (__dest, __ch, __len, __bos0 (__dest));\n</code></pre>\n\n<p>This triggers a failure in the build process. We have to root cause the failure, patch it, re-trigger the build only to see it proceed a little further and fail at some other location.</p>\n\n<p>Are there any means via which we can prevent these buffer overflow related warnings from showing up during compilation (without removing the hardening flags). In short, I want to avoid the <code>-Wstack-protector</code> flag behavior.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "mpi"], "answers": [{"comments": [{"owner": {"reputation": 2398, "user_id": 4286662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jTNeO.jpg?s=128&g=1", "display_name": "Bub Espinja", "link": "https://stackoverflow.com/users/4286662/bub-espinja"}, "edited": false, "score": 0, "creation_date": 1484769521, "post_id": 41726884, "comment_id": 70651132, "body": "Thanks @francis, I started to get deeper in the topic and I found out the same. Furthermore, I tried with the hostfile option that you propose, and it seems to be ignored. Please, have a look at <a href=\"http://stackoverflow.com/questions/41728334/mpi-comm-spawn-is-ignoring-mpi-info-set-hostfile\" title=\"mpi comm spawn is ignoring mpi info set hostfile\">stackoverflow.com/questions/41728334/&hellip;</a>"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 2398, "user_id": 4286662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jTNeO.jpg?s=128&g=1", "display_name": "Bub Espinja", "link": "https://stackoverflow.com/users/4286662/bub-espinja"}, "edited": false, "score": 1, "creation_date": 1484775373, "post_id": 41726884, "comment_id": 70654209, "body": "You&#39;re welcome. The other way around is to stick to the <code>host</code> key and call <a href=\"https://www.open-mpi.org/doc/v1.8/man3/MPI_Comm_spawn_multiple.3.php\" rel=\"nofollow noreferrer\"><code>MPI_Comm_spawn_multiple()</code></a> using multiple MPI_INFO, each one featuring a different value for the host, as suggested <a href=\"http://lists.mcs.anl.gov/pipermail/mpich-discuss/2006-February/001194.html\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": false, "score": 1, "last_activity_date": 1484764264, "creation_date": 1484764264, "answer_id": 41726884, "question_id": 41717628, "link": "https://stackoverflow.com/questions/41717628/error-when-setting-mpi-info-value-is-too-long/41726884#41726884", "title": "Error when setting MPI_Info: value is too long", "body": "<p><strong>Indeed, there an hard-coded maximal length for the string describing the values in <code>MPI_INFO</code>.</strong> It is defined in <code>mpi.h</code> and it is named <strong><code>MPI_MAX_INFO_VAL</code></strong>. According to the <a href=\"http://mpi-forum.org/docs/mpi-3.1/mpi31-report.pdf\" rel=\"nofollow noreferrer\">MPI standards</a>, at the beginning of chapter 9 (p397):</p>\n\n<blockquote>\n  <p>values have an implementation-defined maximum length\n  of <code>MPI_MAX_INFO_VAL</code>... ... If either key or value are larger than the allowed maximums, the errors MPI_ERR_INFO_KEY or MPI_ERR_INFO_VALUE are raised, respectively.</p>\n</blockquote>\n\n<p>Let's print this value: by trying <code>printf(\"MPI_MAX_INFO_VAL is %d\\n\",MPI_MAX_INFO_VAL);</code>, my openmpi value is 256... There is a line <code>#define MPI_MAX_INFO_VAL      1024</code> in the file mpich3-2/src/include/mpi.h.in of MPICH2. As a result, the list of the hostname can be too long to be stored as the value of a key in an MPI_INFO structure.</p>\n\n<p>As an alternative, the list of the hosts can be stored in a file and the name of the file can be provided to <code>MPI_Comm_spawn()</code> as the value of the key <strong><code>hostfile</code></strong> of the MPI_INFO structure, as detailed in the <a href=\"https://www.open-mpi.org/doc/v2.0/man3/MPI_Comm_spawn.3.php\" rel=\"nofollow noreferrer\">documentation of OpenMPI</a></p>\n"}, {"tags": [], "owner": {"reputation": 2398, "user_id": 4286662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jTNeO.jpg?s=128&g=1", "display_name": "Bub Espinja", "link": "https://stackoverflow.com/users/4286662/bub-espinja"}, "is_accepted": true, "score": 0, "last_activity_date": 1484826898, "last_edit_date": 1484826898, "creation_date": 1484825956, "answer_id": 41740895, "question_id": 41717628, "link": "https://stackoverflow.com/questions/41717628/error-when-setting-mpi-info-value-is-too-long/41740895#41740895", "title": "Error when setting MPI_Info: value is too long", "body": "<p>Taking @francis' comments into account, I decided to give other approach to the problem.</p>\n\n<p>Since <code>MPI_MAX_INFO_VAL</code> cannot be altered and <code>MPI_Info_set(info, \"hostfile\", filename)</code> is ignored, I must use <code>MPI_Comm_spawn_multiple()</code>.</p>\n\n<p><code>MPI_Comm_spawn_multiple()</code> expects a number of nodes and several arrays of that length.</p>\n\n<p>For this solution I keep focus on the MPI_Info field, that now is an array which can be set like that:</p>\n\n<pre><code>MPI_info *infos = malloc(sizeof (MPI_Info) * nodecnt);\nfor (i = 0; i &lt; nodecnt; i++) {\n    MPI_Info_create(&amp;infos[i]);\n    MPI_Info_set(infos[i], \"hosts\", hostnames[i]);\n}\n</code></pre>\n\n<ul>\n<li><code>nodecnt</code> is the total amount of nodes to spawn the new processes.</li>\n<li><code>hostnames</code> is an array of strings which have the host name repeated (separated by commas) as many times as processes will be spawned in that host.</li>\n</ul>\n\n<p>So, in our call to <code>MPI_Comm_spawn_multiple()</code> we will use the variable <code>infos</code>.\nMine is similar to this:</p>\n\n<pre><code>MPI_Comm_spawn_multiple(nodecnt, commands, MPI_ARGVS_NULL, maxprocs, infos, 0, MPI_COMM_WORLD, &amp;newcomm, MPI_ERRCODES_IGNORE);\n</code></pre>\n\n<p>By the way, it is true that this does not solve the problem completely, due to with a very long list of host names, we would get the same problem. However, this solution give us more room have for manoeuvre.</p>\n"}], "owner": {"reputation": 2398, "user_id": 4286662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jTNeO.jpg?s=128&g=1", "display_name": "Bub Espinja", "link": "https://stackoverflow.com/users/4286662/bub-espinja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 41740895, "answer_count": 2, "score": 1, "last_activity_date": 1484827204, "creation_date": 1484737169, "last_edit_date": 1484827204, "question_id": 41717628, "link": "https://stackoverflow.com/questions/41717628/error-when-setting-mpi-info-value-is-too-long", "title": "Error when setting MPI_Info: value is too long", "body": "<p>I am configuring my <em>MPI_Info</em> with the hosts where the processes will be spawned (<em>MPI_Comm Spawn</em>).</p>\n\n<p>The problem is that when I use a big amount of processes the setting is not performed correctly, throwing this error:</p>\n\n<pre><code>Fatal error in MPI_Info_set: Invalid MPI_Info value , error stack:\nMPI_Info_set(117): MPI_Info_set(info=0x9c000000, key=hosts, value=cuda00,cuda00,cuda00,cuda00,cuda00,cuda00,cuda00,cuda00,cuda01,cuda01,cuda01,cuda01,cuda01,cuda01,cuda01,cuda01,cuda02,cuda02,cuda02,cuda02,cuda02,cuda02,cuda02,cuda02,cuda03,cuda03,cuda03,cuda03,cuda04,cuda0\nMPI_Info_set(97).: Value is too long \n</code></pre>\n\n<p>The field \"value\" is the <em>hostlist</em> and this <em>hostlist</em> is assigned to the MPI_Info structure with:</p>\n\n<pre><code>MPI_Info_set(info, \"hosts\", mpihosts);\n</code></pre>\n\n<p>where \"mpihosts\" is a <em>char*</em>.</p>\n\n<p>Can I change the capacity of <em>MPI_Info</em>?</p>\n"}, {"tags": ["python", "c", "python-c-api"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1484737523, "post_id": 41717614, "comment_id": 70630091, "body": "Embed it in an object and make the functions member functions."}, {"owner": {"reputation": 35, "user_id": 7349833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa7e022c84635e8cc9eed23352573de4?s=128&d=identicon&r=PG&f=1", "display_name": "Kramer", "link": "https://stackoverflow.com/users/7349833/kramer"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1484739115, "post_id": 41717614, "comment_id": 70631105, "body": "I think one of the main questions was how I&#39;d do that"}, {"owner": {"reputation": 975, "user_id": 6078401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb74e4a1d8acc16d37b3f01f917b2ae?s=128&d=identicon&r=PG", "display_name": "daragua", "link": "https://stackoverflow.com/users/6078401/daragua"}, "edited": false, "score": 0, "creation_date": 1484739423, "post_id": 41717614, "comment_id": 70631297, "body": "With your current implementation, try storing <code>PyModule_Create</code>&#39;s return value in static var. I suspect that returning it right away may cause the optimizer to remove it right away (or disable compiler optimizations to see if it indeed interferes)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1484740058, "post_id": 41717614, "comment_id": 70631753, "body": "Like : <code>class myrelay(Relay): ... def __init__(self, name): ...</code> (plus other functions). Then you can instantiate by using <code>thisrelay = myrelay( &#39;&#47;dev&#47;ttyS0&#39; )</code>"}, {"owner": {"reputation": 35, "user_id": 7349833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa7e022c84635e8cc9eed23352573de4?s=128&d=identicon&r=PG&f=1", "display_name": "Kramer", "link": "https://stackoverflow.com/users/7349833/kramer"}, "edited": false, "score": 0, "creation_date": 1484745054, "post_id": 41717614, "comment_id": 70635148, "body": "<code>class myrelay(Relay):  \tdef __init__(self, name):  \t\tself.setPort(name)</code> doesn&#39;t work, return error like <code>module.__init__() takes at most 2 arguments (3 given)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7349833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa7e022c84635e8cc9eed23352573de4?s=128&d=identicon&r=PG&f=1", "display_name": "Kramer", "link": "https://stackoverflow.com/users/7349833/kramer"}, "edited": false, "score": 0, "creation_date": 1484744869, "post_id": 41719814, "comment_id": 70635009, "body": "Looks like this solved my problem, however I also needed to add the encoding like this: <code>if (!PyArg_ParseTuple(args, &quot;es&quot;, &quot;utf-8&quot;, &amp;ttyPort))</code>"}], "tags": [], "owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "is_accepted": true, "score": 0, "last_activity_date": 1484743536, "creation_date": 1484743536, "answer_id": 41719814, "question_id": 41717614, "link": "https://stackoverflow.com/questions/41717614/avoid-garbage-collection-of-c-written-python-library/41719814#41719814", "title": "Avoid garbage collection of C written Python library", "body": "<p>One possible fix would be to use 'es' format specifier in <code>PyArg_ParseTuple(args, \"s\", &amp;ttyPort)</code> instead of 's'. From documentation:</p>\n\n<blockquote>\n  <p>In general, when a format sets a pointer to a buffer, the buffer is managed by the corresponding Python object, and the buffer shares the lifetime of this object</p>\n</blockquote>\n\n<p>unless you use 'es'. You will have to free memory manually, however.</p>\n"}], "owner": {"reputation": 35, "user_id": 7349833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa7e022c84635e8cc9eed23352573de4?s=128&d=identicon&r=PG&f=1", "display_name": "Kramer", "link": "https://stackoverflow.com/users/7349833/kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 1, "accepted_answer_id": 41719814, "answer_count": 1, "score": 0, "last_activity_date": 1484743536, "creation_date": 1484737144, "question_id": 41717614, "link": "https://stackoverflow.com/questions/41717614/avoid-garbage-collection-of-c-written-python-library", "title": "Avoid garbage collection of C written Python library", "body": "<p>I'm struggling with my C written Python library. The code is meant to write a register in a cp210x in order to control a Relay card. The code works, however Python clears the object somehow.</p>\n\n<p>With other words, the C variable ttyPort is cleared after ending a function.</p>\n\n<p>Here's the C code:</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stropts.h&gt;\n\n// C variable that holds the tty address (e.g. /dev/ttyUSB0)\nconst char* ttyPort;\n\nint setRelay(int action, int relayNumber)\n{\n    /* more magic over here */\n    printf(\"Port :: %s\\n\", ttyPort);\n\n}\n// All python wrappers below\n\nstatic PyObject*setPort(PyObject* self, PyObject* args)\n{\n    Py_INCREF(self)\n    // Copy python argument to ttyPort\n    if (!PyArg_ParseTuple(args, \"s\", &amp;ttyPort))\n        return NULL;\n\n    printf(\"RelayModule :: Port set (%s)\\n\", ttyPort);\n\n    Py_RETURN_NONE;\n}\n\nstatic PyObject*fanOff(PyObject* self, PyObject* args)\n{\n    //fanMode = 0;\n    printf(\"RelayModule :: Fan off %s\\n\",ttyPort);\n    if (setRelay(RELAY_OFF, 0) == 1){\n        // more magic\n    }\n    Py_RETURN_NONE;\n}\n/* more functions over here */\nstatic PyMethodDef RelayMethods[] =\n{\n     {\"setPort\", setPort, METH_VARARGS, \"Set tty port.\"},\n     {\"fanOff\", fanOff, METH_NOARGS, \"Fan off.\"},\n     {\"fanHalf\", fanHalf, METH_NOARGS, \"Fan half speed.\"},\n     {\"fanFull\", fanFull, METH_NOARGS, \"Fan full on.\"},\n     {\"pumpOn\", pumpOn, METH_NOARGS, \"Pump on.\"},\n     {\"pumpOff\", pumpOff, METH_NOARGS, \"Pump off.\"},\n     {\"isPumpOn\", isPumpOn, METH_NOARGS, \"Check if pump is on.\"},\n     {\"getFanMode\", getFanMode, METH_NOARGS, \"Get fan mode.\"},\n     {NULL, NULL, 0, NULL}\n};\n\nstatic struct PyModuleDef RelayDefs = { \n    PyModuleDef_HEAD_INIT,\"RelayModule\",\"A Python module that controls the Conrad 4ch relay card.\", -1, RelayMethods \n};\n\n\nPyMODINIT_FUNC PyInit_Relay(void)\n{\n    Py_Initialize();\n    return PyModule_Create(&amp;RelayDefs);\n}\n</code></pre>\n\n<p>The python code for example:</p>\n\n<pre><code>import Relay\n\ndef settty():\n    Relay.setPort(\"/dev/ttyUSB0\")\n\ndef gettty():\n    Relay.fanOff()\n\ndef doAll():\n    Relay.setPort(\"/dev/ttyUSB0\")\n    Relay.fanOff()\n\nsettty()\ngettty() #Error, prints 'Port :: [garbage]'\ndoAll() #works!\n</code></pre>\n\n<p>How can I somehow declare an object? In other languages I'd do:\n    RelayObj = new Relay()</p>\n\n<p>Or how can I store a variable correctly?</p>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484736207, "post_id": 41717188, "comment_id": 70629192, "body": "Who knows? UB is UB, <a href=\"http://stackoverflow.com/questions/26331035/why-was-1-31-changed-to-be-implementation-defined-in-c14\">IB is IB</a>. Don&#39;t do it if you want predictable results."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1484736303, "post_id": 41717188, "comment_id": 70629258, "body": "Because, even if the results are well defined on your implementation (which they may not be)   <code>(1 &lt;&lt; 31) != 0x80000000</code>"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 9, "creation_date": 1484736403, "post_id": 41717188, "comment_id": 70629323, "body": "just don&#39;t use signed integer types when bit shifting"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1484736417, "post_id": 41717188, "comment_id": 70629336, "body": "@Danijel  This 0x80000000 is a positive integer constant that can have type long. At the same time 1 &lt;&lt; 31 is an integer expression that yields a negative number."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 5, "creation_date": 1484736433, "post_id": 41717188, "comment_id": 70629348, "body": "<code>1 &lt;&lt; 31</code> is UB for 32-bit <code>int</code>. Use <code>1U &lt;&lt; 31</code> which has a the same type as <code>0x80000000</code> in a system with 32-bit <code>int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 11, "last_activity_date": 1484737884, "creation_date": 1484737884, "answer_id": 41717899, "question_id": 41717188, "link": "https://stackoverflow.com/questions/41717188/defining-1-31-or-using-0x80000000-result-is-different/41717899#41717899", "title": "Defining (1 &lt;&lt; 31) or using 0x80000000? Result is different", "body": "<p><code>1 &lt;&lt; 31</code> is undefined behavior on most platforms (e. g., systems with 16-bit or 32-bit <code>int</code>) as its result cannot be represented in an <code>int</code> (the resulting type of the expression). Don't use that expression in code. On the other hand <code>1U &lt;&lt; 31</code> is a valid expression on systems with 32-bit <code>int</code> as its result is representable in an <code>unsigned int</code> (the resulting type of the expression).</p>\n\n<p>On a 32-bit <code>int</code> system, <code>0x80000000</code> is a (relatively) big positive integer number of type <code>unsigned int</code>. If you are lucky (or unlucky) enough to not have  demons to fly out of your nose by using <code>1 &lt;&lt; 31</code> expression, the most likely result of this expression is <code>INT_MIN</code> which is a (relatively) big negative integer number of type <code>int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 635, "user_id": 2010398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnCdn.png?s=128&g=1", "display_name": "gmug", "link": "https://stackoverflow.com/users/2010398/gmug"}, "is_accepted": false, "score": 1, "last_activity_date": 1484738774, "creation_date": 1484738774, "answer_id": 41718213, "question_id": 41717188, "link": "https://stackoverflow.com/questions/41717188/defining-1-31-or-using-0x80000000-result-is-different/41718213#41718213", "title": "Defining (1 &lt;&lt; 31) or using 0x80000000? Result is different", "body": "<p>0x80000000 is a big number which needs 32 bit to represent that number. This means on a 32 bit system (or in a 32 bit compatible application) an <code>int</code> is too small. So use <code>unsigned long</code> instead:</p>\n\n<pre><code>#define SCALE (1u &lt;&lt; 31)\n\n#define fix_Q31_80(x) ( (unsigned long) ( (float)(x)*(float)0x80000000u ) )\n#define fix_Q31_SC(x) ( (unsigned long) ( (float)(x)*(float)SCALE       ) )\n\nint main()\n{\n    unsigned long fix_80 = fix_Q31_80(0.5f);\n    unsigned long fix_sc = fix_Q31_SC(0.5f);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1484746544, "last_edit_date": 1495541336, "creation_date": 1484746544, "answer_id": 41720872, "question_id": 41717188, "link": "https://stackoverflow.com/questions/41717188/defining-1-31-or-using-0x80000000-result-is-different/41720872#41720872", "title": "Defining (1 &lt;&lt; 31) or using 0x80000000? Result is different", "body": "<p>All integer constants have a type. In the case of <code>1</code>, the type is <code>int</code>. On a system with 32 bit integers, <code>1 &lt;&lt; 31</code> gives a number which is too large to be represented as an <code>int</code>. This is undefined behavior and therefore a bug. </p>\n\n<p>But <code>0x80000000</code> will work as expected, because on a 32 bit system it happens to be the type <code>unsigned int</code>. This is because decimal constants and hexadecimal constants behave differently when the compiler goes looking for what type they should have, <a href=\"https://stackoverflow.com/a/34183176/584518\">as explained here</a>. </p>\n\n<p>As several people have mentioned, don't use bitwise operators on signed types.</p>\n"}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5258, "favorite_count": 0, "accepted_answer_id": 41717899, "answer_count": 3, "score": 7, "last_activity_date": 1484746544, "creation_date": 1484736035, "question_id": 41717188, "link": "https://stackoverflow.com/questions/41717188/defining-1-31-or-using-0x80000000-result-is-different", "title": "Defining (1 &lt;&lt; 31) or using 0x80000000? Result is different", "body": "<pre><code>#define SCALE (1 &lt;&lt; 31)\n\n#define fix_Q31_80(x) ( (int) ( (float)(x)*(float)0x80000000 ) )\n#define fix_Q31_SC(x) ( (int) ( (float)(x)*(float)SCALE      ) )\n\nint main()\n{\n    int fix_80 = fix_Q31_80(0.5f);\n    int fix_sc = fix_Q31_SC(0.5f);\n}\n</code></pre>\n\n<p>Why are the values <code>fix_80</code> and <code>fix_sc</code> different? </p>\n\n<pre><code>fix_80 == Hex:0x40000000\nfix_sc == Hex:0xc0000000\n</code></pre>\n"}, {"tags": ["c", "linux", "memory", "memory-management"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1484735702, "post_id": 41717009, "comment_id": 70628836, "body": "I&#39;m not clear about the code you posted. You have a single <code>{</code> and no closing brace. When you say the value of <code>ckpt</code> do you mean the pointer itself or some value inside the struct (which I don&#39;t know about because you haven&#39;t given the definitions of the structures)."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 2, "creation_date": 1484735751, "post_id": 41717009, "comment_id": 70628865, "body": "What do you do before and after <code>malloc</code>ing?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 3, "creation_date": 1484735775, "post_id": 41717009, "comment_id": 70628881, "body": "&quot;indeterminate&quot;, not &quot;random&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 438, "user_id": 1088006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815d232e47fc5f5a457554013cd26bab?s=128&d=identicon&r=PG", "display_name": "FunkyCat", "link": "https://stackoverflow.com/users/1088006/funkycat"}, "is_accepted": false, "score": 7, "last_activity_date": 1484741639, "last_edit_date": 1484741639, "creation_date": 1484735715, "answer_id": 41717074, "question_id": 41717009, "link": "https://stackoverflow.com/questions/41717009/data-allocated-by-malloc-is-not-zero/41717074#41717074", "title": "Data allocated by malloc() is not zero", "body": "<p>Allocated memory can store <em>any value</em> after allocation, but it does not have to be <em>random</em> - allocation is not random generator at all.</p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 1651758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2fee8120e07874efd5ef536278b2ae77?s=128&d=identicon&r=PG", "display_name": "user1651758", "link": "https://stackoverflow.com/users/1651758/user1651758"}, "edited": false, "score": 0, "creation_date": 1484738604, "post_id": 41717093, "comment_id": 70630796, "body": "Thank you. What the value of &#39;ckpt&#39; would be, if the structure is a local variable rather than memory allocated by malloc()? In such a situation, It will not cause a trap."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 5, "last_activity_date": 1484736089, "last_edit_date": 1484736089, "creation_date": 1484735780, "answer_id": 41717093, "question_id": 41717009, "link": "https://stackoverflow.com/questions/41717009/data-allocated-by-malloc-is-not-zero/41717093#41717093", "title": "Data allocated by malloc() is not zero", "body": "<p>Think of this as a mere intriguing peculiarity.</p>\n\n<p>An uninitialised variable (such as your structure elements following a memory allocation for your structure) can take any value. Such a value is said to be <em>indeterminate</em>. The C standard does not require that they are initialised in any way. Note that the behaviour on reading such a variable (other than an <code>unsigned char</code>) is <em>undefined</em> since an uninitialised value could be a trap representation.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484736135, "post_id": 41717134, "comment_id": 70629143, "body": "I&#39;m feeling extra pedantic today: It&#39;s UB only if the type is not an <code>unsigned char</code>."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484736319, "post_id": 41717134, "comment_id": 70629267, "body": "@Bathsheba that&#39;s very useful extra information. The type is a pointer in this case, so the access is UB in this case. The context I meant to imply wasn&#39;t explicit enough."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 4, "last_activity_date": 1484736204, "last_edit_date": 1484736204, "creation_date": 1484735883, "answer_id": 41717134, "question_id": 41717009, "link": "https://stackoverflow.com/questions/41717009/data-allocated-by-malloc-is-not-zero/41717134#41717134", "title": "Data allocated by malloc() is not zero", "body": "<blockquote>\n  <p>Why?</p>\n</blockquote>\n\n<p>Because the value is indeterminate. And accessing an indeterminate value has undefined behaviour (it wouldn't be UB if the type had been <code>unsigned char</code> as pointed out by Bathsheba).</p>\n\n<blockquote>\n  <p>But the value of 'ckpt' is always ... and does not change</p>\n</blockquote>\n\n<p>Note that even though it has not changed so far, there are no guarantees that it would never change. This sort of value/output is called \"garbage\".</p>\n\n<p>Have you tried another compiler? That could change the value. Have you tried modifying an unrelated part of the program? That could change it. Have you tried to imagine butterflies while you run the program? There is no guarantee that wouldn't change the value, though you might need a mind-reading adapter for that to happpen. None of the above are guaranteed to change the value either.</p>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1484738874, "post_id": 41717785, "comment_id": 70630956, "body": "Note that the allocation and release could have been in the run-time startup code, outside the user program&#39;s control, but the startup code is also determinsitic."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1484739821, "post_id": 41717785, "comment_id": 70631596, "body": "@PaulOgilvie You&#39;re right also runtime functions use <code>malloc</code>. Thanks for the remark."}], "tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1484738305, "last_edit_date": 1484738305, "creation_date": 1484737614, "answer_id": 41717785, "question_id": 41717009, "link": "https://stackoverflow.com/questions/41717009/data-allocated-by-malloc-is-not-zero/41717785#41717785", "title": "Data allocated by malloc() is not zero", "body": "<p>Programmed algorithms are almost always deterministic, they act always the same way, and <code>malloc</code> memory selection got such an algorithm.</p>\n\n<p><code>malloc</code> generally allocates some memory pool at runtime start and then use memory taken from this pool to serve the requests (it can enlarge the pool of preallocated memory if the requests are for very large amount of memory, or reduce it if the user frees a lot of memory).</p>\n\n<p>If in your code you allocate some memory (that <code>malloc</code> take from the pool), initialize it then release it after use, and then reallocate it again in the same sequence, the probability that the you will get the same piece of memory with inside the same data it was initialized before is very high. This can be the reason of your finding.</p>\n\n<p>You may make a try using a fake allocation in another point, maybe as first allocation of your program, and check if the value is still the same...</p>\n\n<p>Anyway this eventual peculiarity have to be connected to the allocation chain in your code, not to the system memory, that because of its more intense use have a very low probability to repeat casual data in allocated sets.</p>\n\n<p>And of course this is an <strong>UB</strong>...</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1484739137, "last_edit_date": 1484739137, "creation_date": 1484738821, "answer_id": 41718231, "question_id": 41717009, "link": "https://stackoverflow.com/questions/41717009/data-allocated-by-malloc-is-not-zero/41718231#41718231", "title": "Data allocated by malloc() is not zero", "body": "<p>Though many things have already been pointed out, the following code demonstrates that you really cannot rely neither on the value being always the same nor being always different. It is not guaranteed that allocated memory is initialized, neither with <code>0</code>-values, nor with randomized values. The result of <code>malloc</code> will simply point to an address out of a (huge) memory block, called the heap; At application startup, the operating system provides a heap to the application, but there is no guarantee that the operating system will always give you the same portion of the system's memory as your application's heap (it may be, but it does not have to be):</p>\n\n<p>Consider the following program, which mallocs the same structure 3 trimes</p>\n\n<pre><code>struct myTestStruct {\n    char* p1;\n    char* p2;\n    char* p3;\n    char* p4;\n    char* pToBeObserved;\n};\n\nint main()\n{\n    struct myTestStruct *myStructs[10];\n\n    for (int i=0; i&lt;10; i++)\n        myStructs[i] = (struct myTestStruct*)malloc(sizeof(myTestStruct));\n\n    for (int i=0; i&lt;10; i++) {\n        printf(\"%d'th instance; value of pToBeObserved: %p\\n\", i, (void*)myStructs[i]-&gt;pToBeObserved);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The output when running this program once is the following: </p>\n\n<pre><code>0'th instance; value of pToBeObserved: 0x636f6c5f6b636f6c\n1'th instance; value of pToBeObserved: 0x0\n2'th instance; value of pToBeObserved: 0x0\n3'th instance; value of pToBeObserved: 0x202020202020202\n4'th instance; value of pToBeObserved: 0x7fff77dd30c8\n5'th instance; value of pToBeObserved: 0x100200380\n6'th instance; value of pToBeObserved: 0x0\n7'th instance; value of pToBeObserved: 0x0\n8'th instance; value of pToBeObserved: 0x100058568\n9'th instance; value of pToBeObserved: 0xc\n</code></pre>\n\n<p>It shows that when you reserve memory several times in the same program execution, the value of <code>pToBeObserved</code> actually changes (though this is not guaranteed that it changes). The reason is, that consecutive calls to <code>malloc</code> point to different portions of the heap, and so the chance that <code>pToBeObserved</code> \"views\" a different value is higher;</p>\n\n<p>If you start the program again and again, it <em>may</em> be the case that at least the first <code>malloc</code> will point to the same portion of the heap, and it <em>may</em> be that the operating system has assigned the same portion of system memory to your application:</p>\n\n<pre><code>Run1: 0'th instance; value of pToBeObserved: 0x636f6c5f6b636f6c\nRun3: 0'th instance; value of pToBeObserved: 0x636f6c5f6b636f6c\nRun4: 0'th instance; value of pToBeObserved: 0x636f6c5f6b636f6c\nRun5: 0'th instance; value of pToBeObserved: 0x636f6c5f6b636f6c\nRun6: 0'th instance; value of pToBeObserved: 0x636f6c5f6b636f6c\n</code></pre>\n\n<p>but at an arbitrary run (run 7 in my test), the value suddenly changes:</p>\n\n<pre><code>Run7: 0'th instance; value of pToBeObserved: 0x0\n</code></pre>\n\n<p>Further, if during the runs, I change the <code>struct</code> and add a member before <code>pToBeObserved</code>, then the next run always yielded a different value in my tests:</p>\n\n<pre><code>Run1: 0'th instance; value of pToBeObserved: 0x636f6c5f6b636f6c\n\nstruct myTestStruct {\n    char added;\n    char* p1;\n    char* p2;\n    char* p3;\n    char* p4;\n    char* pToBeObserved;\n};\n\nNext run: 0'th instance; value of pToBeObserved: 0x6f5f687469775f6b\n</code></pre>\n\n<p>This example shows again that you just get a pointer somewhere in the heap, and if you change the memory layout of your struct (by adding a member), then member <code>pToBeObserved</code> will view a different portion of the (uninitialized) heap memory.</p>\n"}], "owner": {"reputation": 135, "user_id": 1651758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2fee8120e07874efd5ef536278b2ae77?s=128&d=identicon&r=PG", "display_name": "user1651758", "link": "https://stackoverflow.com/users/1651758/user1651758"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1484741639, "creation_date": 1484735546, "last_edit_date": 1484740906, "question_id": 41717009, "link": "https://stackoverflow.com/questions/41717009/data-allocated-by-malloc-is-not-zero", "title": "Data allocated by malloc() is not zero", "body": "<p>I use 'malloc()' to allocate memory for a structure in C language. Part of the structure is as below:</p>\n\n<pre><code>struct f2fs_sb_info {\n    struct f2fs_fsck *fsck;\n    struct f2fs_super_block *raw_super;\n    struct f2fs_nm_info *nm_info;\n    struct f2fs_sm_info *sm_info;\n    struct f2fs_checkpoint *ckpt;\n};\n</code></pre>\n\n<p>I find that the value of <code>raw_super</code> is always zero, while the value of <code>ckpt</code> is always <code>0x40000050</code>.</p>\n\n<p>I know that <code>malloc()</code> will not initialize the allocated memory. So the allocated memory should has random value. But the value of <code>ckpt</code> is always <code>0x40000050</code> and does not change every time I run the program. Why?</p>\n"}, {"tags": ["c", "microcontroller", "ram", "flash-memory"], "comments": [{"owner": {"reputation": 635, "user_id": 4795318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6c50cc029a14f6ad3af57d725e7c751a?s=128&d=identicon&r=PG&f=1", "display_name": "jwsc", "link": "https://stackoverflow.com/users/4795318/jwsc"}, "edited": false, "score": 0, "creation_date": 1484742399, "post_id": 41716987, "comment_id": 70633354, "body": "I cannot think of a case where this would matter. Of course assuming you do not write around in flash. May I know the context of that question? how did it arise in the first place?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484743478, "post_id": 41716987, "comment_id": 70634103, "body": "Flash memories are more likely to have &quot;wait states&quot;, in case the CPU is faster than the physical memory. But any form of memory could have that, including RAM or data cache."}, {"owner": {"reputation": 850, "user_id": 3393524, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/114a62c4bb97c83106056189bdf9ef4a?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Yanakiev", "link": "https://stackoverflow.com/users/3393524/vladimir-yanakiev"}, "edited": false, "score": 0, "creation_date": 1484746595, "post_id": 41716987, "comment_id": 70636316, "body": "I ask for personal curiosity. I understand that const variriables  are not alway keep only in flash. Sometimes( depending compiler, processor) theay are load from flash to ram before main."}, {"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1484756933, "post_id": 41716987, "comment_id": 70643738, "body": "@VladimirYanakiev Are you able to modify your linker script to test both cases?"}, {"owner": {"reputation": 850, "user_id": 3393524, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/114a62c4bb97c83106056189bdf9ef4a?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Yanakiev", "link": "https://stackoverflow.com/users/3393524/vladimir-yanakiev"}, "edited": false, "score": 0, "creation_date": 1484771148, "post_id": 41716987, "comment_id": 70652009, "body": "yes changing rodata or set pic option"}, {"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1484772463, "post_id": 41716987, "comment_id": 70652662, "body": "@VladimirYanakiev - were you able to do some kind of access testing under both scenarios. If so, can you post results?"}, {"owner": {"reputation": 850, "user_id": 3393524, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/114a62c4bb97c83106056189bdf9ef4a?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Yanakiev", "link": "https://stackoverflow.com/users/3393524/vladimir-yanakiev"}, "reply_to_user": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1484773096, "post_id": 41716987, "comment_id": 70653032, "body": "@InfinitelyManic I was using compiler green hills on rh850 and  analyze disassembly. I sawthat in the first case the address of <i>var</i> was in RAM. in the other in ROM depending on wether I use pic option. But this is specific to compiler. It&#39;s gcc based"}], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 4795318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6c50cc029a14f6ad3af57d725e7c751a?s=128&d=identicon&r=PG&f=1", "display_name": "jwsc", "link": "https://stackoverflow.com/users/4795318/jwsc"}, "is_accepted": false, "score": 1, "last_activity_date": 1484742993, "creation_date": 1484742993, "answer_id": 41719623, "question_id": 41716987, "link": "https://stackoverflow.com/questions/41716987/is-there-a-case-when-const-data-should-be-load-in-ram-rather-then-direct-flash-a/41719623#41719623", "title": "Is there a case when const data should be load in RAM rather then direct flash access", "body": "<p>Assuming a Microcontroller architecture like ARM Cortex or Microchip MIPS (and many others), RAM and Flash are mapped to different parts of the internal address space, like a huge array. So the Assembly commands reading from RAM are the same like reading from Flash. No difference here. </p>\n\n<p>Access times of RAM and Flash shouldn't be too different, so no waiting needed on any of the controllers I've worked with.</p>\n\n<p>The only case I can imagine where storing const vars in flash could cause problems is in some sort of bootloader app, when the flash is written. Of course, writing to a flash range where you are executing from is a bad idea and will cause much heavier problems than overwritten const values.</p>\n"}, {"tags": [], "owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1485149396, "creation_date": 1485149396, "answer_id": 41799773, "question_id": 41716987, "link": "https://stackoverflow.com/questions/41716987/is-there-a-case-when-const-data-should-be-load-in-ram-rather-then-direct-flash-a/41799773#41799773", "title": "Is there a case when const data should be load in RAM rather then direct flash access", "body": "<p>Many microcontrollers have a unified address space, but some (such as AVRs) do not.  When there are multiple address spaces, then you may need to use different instructions to access data in those spaces.  (For AVR, the <code>LPM</code> (Load Program Memory) instruction must be used to access data in Flash, instead of one of the ordinary <code>LD</code> (Load) instructions.)</p>\n\n<p>If you imagine a pointer to your <code>const</code> variable, a function receiving the pointer would not be able to access the data unless it knows which address space the pointer points into.  In a case like that, you either have to copy the data to RAM, even though it's <code>const</code>, or the user of the pointer has to know which instruction to use to access the data.</p>\n"}], "owner": {"reputation": 850, "user_id": 3393524, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/114a62c4bb97c83106056189bdf9ef4a?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Yanakiev", "link": "https://stackoverflow.com/users/3393524/vladimir-yanakiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 41799773, "answer_count": 2, "score": 2, "last_activity_date": 1485149396, "creation_date": 1484735489, "last_edit_date": 1484747376, "question_id": 41716987, "link": "https://stackoverflow.com/questions/41716987/is-there-a-case-when-const-data-should-be-load-in-ram-rather-then-direct-flash-a", "title": "Is there a case when const data should be load in RAM rather then direct flash access", "body": "<p>I've used few types microcontrollers.\nWhen I write code like this:</p>\n\n<pre><code>const int var = 5;\n</code></pre>\n\n<p>usually <code>var</code> is kept in flash. I understand that <code>const</code> variables are not always kept only in flash. Sometimes (depending compiler, processor, options like pic etc.) they are loaded from flash to RAM before <code>main</code>. Is there a case, when it is better to load <code>var</code> into RAM?</p>\n"}, {"tags": ["c", "login", "fgets", "strcmp"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1484735379, "post_id": 41716738, "comment_id": 70628598, "body": "The problem is the use of <code>strcspn()</code> function; read the manual of <code>strcspn()</code> to see what it does."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484743557, "post_id": 41716738, "comment_id": 70634159, "body": "Also, why are you not checking the return of <code>fgets()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1484735389, "creation_date": 1484735389, "answer_id": 41716953, "question_id": 41716738, "link": "https://stackoverflow.com/questions/41716738/issue-with-login-function-using-strcspn-and-fgets-in-c/41716953#41716953", "title": "Issue with login function using strcspn and fgets in C", "body": "<p><code>strcspn</code> is not the right tool for this job.</p>\n\n<p>It returns the number of characters at the start of the text which do not exist in the thing you're searching for, so something like:</p>\n\n<pre><code>strcspn (\"password\", \"cap\")\n</code></pre>\n\n<p>will give you zero, because the <code>p</code> in <code>cap</code> is found at the start of the string.</p>\n\n<p>The correct function you should probably be using is <code>strcmp</code>, which compares two strings.</p>\n"}, {"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 0, "last_activity_date": 1484736424, "last_edit_date": 1484736424, "creation_date": 1484735393, "answer_id": 41716958, "question_id": 41716738, "link": "https://stackoverflow.com/questions/41716738/issue-with-login-function-using-strcspn-and-fgets-in-c/41716958#41716958", "title": "Issue with login function using strcspn and fgets in C", "body": "<p>Because both <code>pass</code> and <code>padd</code> starts with <code>p</code>, the return value of <code>strcspn</code> is:</p>\n\n<blockquote>\n  <p>The length <strong>of the initial part</strong> of str1 not containing any of the\n  characters that are part of str2. This is the length of str1 if none\n  of the characters in str2 are found in str1. size_t is an unsigned\n  integral type.</p>\n</blockquote>\n\n<p>Use <code>strcmp</code> instead, but don't forget to remove the trailing newline included by <code>fgets</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1711, "user_id": 2420301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irQpr.jpg?s=128&g=1", "display_name": "Marc Balmer", "link": "https://stackoverflow.com/users/2420301/marc-balmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1484735424, "creation_date": 1484735424, "answer_id": 41716968, "question_id": 41716738, "link": "https://stackoverflow.com/questions/41716738/issue-with-login-function-using-strcspn-and-fgets-in-c/41716968#41716968", "title": "Issue with login function using strcspn and fgets in C", "body": "<p>Replace strcspn() with strcmp() and all will be good.</p>\n"}, {"tags": [], "owner": {"reputation": 3419, "user_id": 7422352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4e9f7e19cb98ee09930bb5454a5e78?s=128&d=identicon&r=PG", "display_name": "Deepak Tatyaji Ahire", "link": "https://stackoverflow.com/users/7422352/deepak-tatyaji-ahire"}, "is_accepted": false, "score": 0, "last_activity_date": 1484736014, "creation_date": 1484736014, "answer_id": 41717182, "question_id": 41716738, "link": "https://stackoverflow.com/questions/41716738/issue-with-login-function-using-strcspn-and-fgets-in-c/41717182#41717182", "title": "Issue with login function using strcspn and fgets in C", "body": "<p>The C library function int strcmp(const char *str1, const char *str2) compares the string pointed to, by str1 to the string pointed to by str2.</p>\n\n<p>Therefore use strcmp() instead.</p>\n"}, {"tags": [], "owner": {"reputation": 3419, "user_id": 7422352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4e9f7e19cb98ee09930bb5454a5e78?s=128&d=identicon&r=PG", "display_name": "Deepak Tatyaji Ahire", "link": "https://stackoverflow.com/users/7422352/deepak-tatyaji-ahire"}, "is_accepted": false, "score": 0, "last_activity_date": 1484736443, "creation_date": 1484736443, "answer_id": 41717336, "question_id": 41716738, "link": "https://stackoverflow.com/questions/41716738/issue-with-login-function-using-strcspn-and-fgets-in-c/41717336#41717336", "title": "Issue with login function using strcspn and fgets in C", "body": "<p>U can also try this code to take password!!</p>\n\n<pre><code>// DEEPAK AHIRE\n#include&lt;stdio.h&gt;\n\nint main(){\n\n    char arr[10];\n\n    char c='a';\n    int k=0;\n\n    while( c != 32){\n\n        c = getch();\n\n        putch('*');\n\n        arr[k++]=c;\n    }\n\n    printf(\"%s\",arr);\n    return 0;\n}\n</code></pre>\n\n<p>And then use strcmp() function(Press space chracter(ASCII =  32) to break).</p>\n"}, {"comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 3, "creation_date": 1484738782, "post_id": 41717505, "comment_id": 70630900, "body": "Re first bullet point: ... computes the number of characters <i>at the start of</i> <code>s1</code> ..."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1484740652, "last_edit_date": 1484740652, "creation_date": 1484736898, "answer_id": 41717505, "question_id": 41716738, "link": "https://stackoverflow.com/questions/41716738/issue-with-login-function-using-strcspn-and-fgets-in-c/41717505#41717505", "title": "Issue with login function using strcspn and fgets in C", "body": "<p>There is some confusion here:</p>\n\n<ul>\n<li><code>strcspn(s1, s2)</code> computes the number of characters at the start of <code>s1</code> not present in <code>s2</code>, which can be used to strip the newline from the buffer filled by <code>fgets()</code>.</li>\n<li>to compare strings, you should use <code>strcmp()</code>.</li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    char username[50] = \"\", password[50] = \"\";\n    char real_Username[] = \"user\", real_Password[] = \"pass\";\n    int confirm_User, confirm_Pass;\n\n    printf(\"Username \");\n    fgets(username, 50, stdin);\n    // strip the trailing newline if any\n    username[strcspn(username, \"\\n\")] = '\\0';\n\n    printf(\"\\n\");\n    printf(\"Password \");\n    fgets(password, 50, stdin);\n    // strip the trailing newline if any\n    password[strcspn(password, \"\\n\")] = '\\0';\n\n    confirm_User = strcmp(username, real_Username);\n    confirm_Pass = strcmp(password, real_Password);\n\n    if (confirm_User == 0 &amp;&amp; confirm_Pass == 0) {\n        printf(\"Correct\\n\");\n    } else {\n        printf(\"Incorrect\\n\");\n    }\n\n    getch();\n}\n</code></pre>\n\n<p>Also note that it is preferable to disable echo when prompting the user for a password, but there is no portable way to do this.</p>\n"}], "owner": {"reputation": 39, "user_id": 5893038, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72aee47a33d39999e0faa94102b09b7b?s=128&d=identicon&r=PG&f=1", "display_name": "SycoSins", "link": "https://stackoverflow.com/users/5893038/sycosins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 6, "score": 0, "last_activity_date": 1484740652, "creation_date": 1484734821, "last_edit_date": 1484740614, "question_id": 41716738, "link": "https://stackoverflow.com/questions/41716738/issue-with-login-function-using-strcspn-and-fgets-in-c", "title": "Issue with login function using strcspn and fgets in C", "body": "<p>I'm trying to make a login function as part of a larger program, this is the dumbed down version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char username[50], password[50];\n    char real_Username[] = \"user\", real_Password[] = \"pass\";\n    int confirm_User, confirm_Pass;\n\n    printf(\"Username \");\n    fgets(username, 50, stdin);\n    printf(\"\\n\");\n    printf(\"Password \");\n    fgets(password, 50, stdin);\n\n    confirm_User = strcspn(username, real_Username);\n    confirm_Pass = strcspn(password, real_Password);\n\n    if (confirm_User == 0 &amp;&amp; confirm_Pass == 0) {\n        printf(\"Correct\\n\");\n    } else {\n        printf(\"Incorrect\\n\");\n    }\n\n    getch();\n}\n</code></pre>\n\n<p>The result of <code>confirm_User</code> and <code>confirm_Pass</code> are still 0 in some cases when the user didn't enter the correct text. For example, entering <code>user</code> and <code>padd</code> will still count as correct input. How do I go about fixing this code?</p>\n"}, {"tags": ["c", "segmentation-fault", "backtrace", "signal-handling"], "answers": [{"comments": [{"owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1484734673, "post_id": 41716673, "comment_id": 70628160, "body": "Yes I know that I can done that myself. But I&#39;m searching for a library which does it for me. Not the printing, I know that there is <code>backtrace</code>, but even the installation and the signal handler itself."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1484734858, "post_id": 41716673, "comment_id": 70628276, "body": "There&#39;s no standard library function; anything you&#39;d use would involve non-standard functions/extensions. Even the backward-cpp you linked to uses <code>_Unwind_Backtrace</code> which is probably your best bet if whatever libc you are using doesn&#39;t already provide something like Glibc&#39;s <code>backtrace</code>."}, {"owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1484735402, "post_id": 41716673, "comment_id": 70628617, "body": "That&#39;s why I&#39;m searching for some library. So you say no-one thought that it might be useful to make such a library? But for C++, there is (backward-cpp). I don&#39;t care how the library implements it. It&#39;s fine if the support on some platforms is limited. Just a simple <code>backtrace()</code> lib would be fine for me."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1484734634, "creation_date": 1484734634, "answer_id": 41716673, "question_id": 41716409, "link": "https://stackoverflow.com/questions/41716409/common-c-library-to-install-standard-signal-handler-for-sigsegv/41716673#41716673", "title": "common C library to install standard signal handler for SIGSEGV", "body": "<p>There's no default handler installed for SIGSEGV on any of the *nix systems. But you can 1) install one yourself, 2) print the backtrace and 3) then exit.\nThe \"exit\" part is required becuase, it's <em>undefined</em> to return from their handler (if one is installed) for some signals; <code>SIGSEGV</code> is one of them.</p>\n\n<p>The tricky part is (2) - printing the backtrace. <a href=\"https://www.gnu.org/software/libc/manual/html_node/Backtraces.html\" rel=\"nofollow noreferrer\">Glibc provides 3 interfaces</a>: <code>backtrace</code>, <code>backtrace_symbols</code> and <code>backtrace_symbols_fd</code>.\nYou can use whichever is suitable and print the stack trace.</p>\n\n<p>If you are <em>not</em> using Glibc then you may have to do more work. For example, you can use <code>_Unwind_Backtrace</code> which is available on systems using gcc (not necessarily Glibc).</p>\n"}], "owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484735955, "creation_date": 1484733846, "last_edit_date": 1495540950, "question_id": 41716409, "link": "https://stackoverflow.com/questions/41716409/common-c-library-to-install-standard-signal-handler-for-sigsegv", "title": "common C library to install standard signal handler for SIGSEGV", "body": "<p>Is here any C library with a function like <code>install_default_signal_handlers()</code> which will install some default signal handler for SIGSEGV and related signals, where the signal handler will print a backtrace?\nThe signal handler, and also the installation of the signal handler should be provided by the library.</p>\n\n<p>I think <a href=\"https://github.com/bombela/backward-cpp\" rel=\"nofollow noreferrer\">backward-cpp</a> does it for C++ with <code>backward::SignalHandling sh;</code>.</p>\n\n<p>There is also <a href=\"https://chromium.googlesource.com/breakpad/breakpad\" rel=\"nofollow noreferrer\">Google Breakpad</a> but this might be overkill.</p>\n\n<p>There is <a href=\"https://stackoverflow.com/a/6599348/133374\">libSegFault</a> which seems to do that but it only seems to be available on some Unixes (part of GlibC, and there is a FreeBSD implementation), not on MacOSX.</p>\n\n<p>Some related discussion is <a href=\"https://stackoverflow.com/questions/77005/how-to-generate-a-stacktrace-when-my-gcc-c-app-crashes\">here</a> but this discusses mostly the code to print the backtrace but I search for a library which provides the signal handler for me.</p>\n"}, {"tags": ["c++", "c", "pointers", "unary-operator"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 6, "creation_date": 1484733268, "post_id": 41716138, "comment_id": 70627213, "body": "To allow <code>auto* p = +[](){};</code> ? ;)"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1484733465, "post_id": 41716138, "comment_id": 70627378, "body": "@Jarod42:  Surely you mean <code>auto* _ = +[](){};</code> ?"}, {"owner": {"reputation": 27011, "user_id": 1490355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296f0478cb1b6724e3f862ace601fa99?s=128&d=identicon&r=PG", "display_name": "SingerOfTheFall", "link": "https://stackoverflow.com/users/1490355/singerofthefall"}, "edited": false, "score": 4, "creation_date": 1484733542, "post_id": 41716138, "comment_id": 70627430, "body": "Relevant: <a href=\"http://stackoverflow.com/questions/9266648/unary-on-pointers\">stackoverflow.com/questions/9266648/unary-on-pointers</a>"}, {"owner": {"reputation": 4795, "user_id": 683905, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7bc5b9f8f9c6f0e5d25b2d88e2cc1386?s=128&d=identicon&r=PG", "display_name": "Jaa-c", "link": "https://stackoverflow.com/users/683905/jaa-c"}, "edited": false, "score": 1, "creation_date": 1484733686, "post_id": 41716138, "comment_id": 70627536, "body": "You can use it to pass value instead of a reference to an overloaded function..."}, {"owner": {"reputation": 2709, "user_id": 360913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/URPxE.jpg?s=128&g=1", "display_name": "Marichyasana", "link": "https://stackoverflow.com/users/360913/marichyasana"}, "edited": false, "score": 0, "creation_date": 1484738662, "post_id": 41716138, "comment_id": 70630823, "body": "What output do you expect? For c++ I get 10."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1484735465, "last_edit_date": 1484735465, "creation_date": 1484734331, "answer_id": 41716583, "question_id": 41716138, "link": "https://stackoverflow.com/questions/41716138/what-is-the-reason-for-the-existent-difference-between-c-and-c-relative-to-the/41716583#41716583", "title": "What is the reason for the existent difference between C and C++ relative to the unary arithmetic operator +", "body": "<p>Different languages may attach different semantics to the same syntax.</p>\n\n<p>C and C++ are different languages with a common ancestor. C++ semantics look deceptively similar but are subtly different for some parts of the common syntax. Another curious case is this:</p>\n\n<pre><code>if (sizeof(char) == sizeof(int)) {\n    printf(\"Hello embedded world\\n\");\n} else {\n    if (sizeof('a') == sizeof(char))\n        printf(\"This is C++ code\\n\");\n    if (sizeof('a') == sizeof(int))\n        printf(\"This is C code\\n\");\n}\n</code></pre>\n\n<p>The reason for C++ to have extended the C syntax in the case of unary <code>+</code> might be to allow for some extended numeric types to be implemented as pointers, or simply for reasons of symmetry.</p>\n\n<p>As Jaa-c mentions in a comment, <code>+p</code> is a computed expression whereas <code>p</code> is a reference to <code>p</code>. You provided another example where <code>+</code> can be used to force expression context. The question is why did the original authors of the C language disallow unary <code>+</code> on non numeric types? Maybe a side effect of the original implementation of <code>pcc</code>.</p>\n\n<p>Note that in Javascript, the unary <code>+</code> operator can be applied to non number types and operates as a conversion to number.</p>\n"}, {"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1490157464, "post_id": 42942489, "comment_id": 72982104, "body": "<code>int</code> is not a class in C++."}, {"owner": {"reputation": 42, "user_id": 7073346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O5CdV.png?s=128&g=1", "display_name": "0x2333", "link": "https://stackoverflow.com/users/7073346/0x2333"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1490158401, "post_id": 42942489, "comment_id": 72982380, "body": "Yeah, but C++ is not a well designed language either. Designers just squeeze lots of new features especially the OOP feature into language C. That&#39;s indeed we can not query menber functions of a class int in C++ like: int.what; but it&#39;s hard to make a judge that stuff in C represent what in C++. Basically All the stuff in C is a sub-set in C++. If we treat the data-types in C like int, char... as Classes in C++, it&#39;s just better for understanding."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1490265922, "post_id": 42942489, "comment_id": 73039648, "body": "All this waffle is totally and utterly irrelevant. You stated that <code>int</code> &#39;can be considered as a class&#39; in C++. It can&#39;t."}], "tags": [], "owner": {"reputation": 42, "user_id": 7073346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O5CdV.png?s=128&g=1", "display_name": "0x2333", "link": "https://stackoverflow.com/users/7073346/0x2333"}, "is_accepted": false, "score": -2, "last_activity_date": 1490155086, "creation_date": 1490155086, "answer_id": 42942489, "question_id": 41716138, "link": "https://stackoverflow.com/questions/41716138/what-is-the-reason-for-the-existent-difference-between-c-and-c-relative-to-the/42942489#42942489", "title": "What is the reason for the existent difference between C and C++ relative to the unary arithmetic operator +", "body": "<p>In my considerations:</p>\n\n<p>C++ is a type of Object-Oriented Language. So every data type can be treated as a \"Class\".</p>\n\n<p>In C int is one of \"the basic data type of C\". But in C++ we can consider int as a Class. Thus, In C++ int pointer and int array belong to the different classes. In C a int pointer variable stored another int variable's address. int array's name instead of the first element's address of that int array. So in C they have kind of the same meaning.</p>\n\n<p>As for the unary opreator \"+\", I understand the C++ language as: Every class In C++ represents a set of stuff. Every stuff in the set has the same properties. And there's some operations can be done onto each stuff. Of course these operations are member functions of a class. Another character In C++ is that users can overload an operator. Overload means we can do the same operation on the different Classes. For example: A man is eating a burger. we can overload action \"Eat\" between cats and rat: A cat is Eating a rat.</p>\n\n<p>So as the C++ standard say:\"<strong>The operand of the unary + operator shall have arithmetic, unscoped enumeration, or pointer type and the result is the value of the argument.</strong>\" That's just a overload for unary operator + in Class <em>unscoped enumeration</em> and <em>pointer type</em>. \"<strong>And The Result Is The Value Of The Argument</strong>\"-> I guess that's the point. </p>\n"}], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 1, "answer_count": 2, "score": 7, "last_activity_date": 1493176556, "creation_date": 1484733123, "last_edit_date": 1495541395, "question_id": 41716138, "link": "https://stackoverflow.com/questions/41716138/what-is-the-reason-for-the-existent-difference-between-c-and-c-relative-to-the", "title": "What is the reason for the existent difference between C and C++ relative to the unary arithmetic operator +", "body": "<p>In C the unary plus operator is called <em>unary arithmetic operator</em> and may not be applied to pointers (the C Standard, 6.5.3.3 Unary arithmetic operators). </p>\n\n<blockquote>\n  <p>1 The operand of the unary + or - operator <strong>shall have arithmetic\n  type</strong>; of the ~ operator, integer type; of the ! operator, scalar\n  type.</p>\n</blockquote>\n\n<p>Thus this program will not compile</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    int a = 10;\n    int *pa = &amp;a;\n\n    printf( \"%d\\n\", *+pa );\n\n    return 0;\n}\n</code></pre>\n\n<p>However in C++ the unary plus operator may be applied to pointers (the C++ Standard, 5.3.1 Unary operators)</p>\n\n<blockquote>\n  <p>7 The operand of the unary + operator shall have arithmetic, unscoped\n  enumeration, <strong>or pointer type</strong> and the result is the value of the\n  argument. Integral promotion is performed on integral or enumeration\n  operands. The type of the result is the type of the promoted operand.</p>\n</blockquote>\n\n<p>And this program compiles successfully.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main() \n{\n    int a = 10;\n    int *pa = &amp;a;\n\n    std::cout &lt;&lt; *+pa &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>What is the reason for maintaining this difference between C and C++?</p>\n\n<hr>\n\n<p>The question arose when I was answering the question <a href=\"https://stackoverflow.com/questions/41699762/why-size-of-int-pointer-is-different-of-size-of-int-array/41699896#41699896\">Why size of int pointer is different of size of int array?</a>. I was going to show how to convert an array to a pointer in the <code>sizeof</code> operator.</p>\n\n<p>At first I wanted to write</p>\n\n<pre><code>sizeof( +array )\n</code></pre>\n\n<p>However this expression is invalid in C. So I had to write</p>\n\n<pre><code>sizeof( array + 0 )\n</code></pre>\n\n<p>and I found that there is such a difference between C and C++.:)</p>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484733934, "post_id": 41716123, "comment_id": 70627698, "body": "1) <code>cap=stack-&gt;capacity;</code> --&gt; <code>stack-&gt;capacity=cap;</code> 2) <code>if (isfull(stack))</code> --&gt; <code>if (!isempty (stack))</code>"}, {"owner": {"reputation": 29, "user_id": 7434819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7PuRQmJBun4/AAAAAAAAAAI/AAAAAAAAARQ/eIhH8mOPyXU/photo.jpg?sz=128", "display_name": "Asif ", "link": "https://stackoverflow.com/users/7434819/asif"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484734933, "post_id": 41716123, "comment_id": 70628337, "body": "Thx @BLUEPIXY i appreciate your help"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7434819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7PuRQmJBun4/AAAAAAAAAAI/AAAAAAAAARQ/eIhH8mOPyXU/photo.jpg?sz=128", "display_name": "Asif ", "link": "https://stackoverflow.com/users/7434819/asif"}, "edited": false, "score": 0, "creation_date": 1484733418, "post_id": 41716182, "comment_id": 70627340, "body": "how to initialize it ?"}, {"owner": {"reputation": 29, "user_id": 7434819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7PuRQmJBun4/AAAAAAAAAAI/AAAAAAAAARQ/eIhH8mOPyXU/photo.jpg?sz=128", "display_name": "Asif ", "link": "https://stackoverflow.com/users/7434819/asif"}, "edited": false, "score": 1, "creation_date": 1484733727, "post_id": 41716182, "comment_id": 70627569, "body": "Thank you so much bro finally got it."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 2, "last_activity_date": 1484734337, "last_edit_date": 1484734337, "creation_date": 1484733248, "answer_id": 41716182, "question_id": 41716123, "link": "https://stackoverflow.com/questions/41716123/why-this-stack-program-is-giving-garbage-value-when-using-pop/41716182#41716182", "title": "Why this stack program is giving garbage value when using POP?", "body": "<p>Because you are using an uninitialized member (<code>stack-&gt;capacity</code>)</p>\n\n<pre><code>stack = malloc(sizeof(struct arraystack));\nstack-&gt;top=-1;\ncap=stack-&gt;capacity; /* HERE */\nstack-&gt;array = malloc(sizeof(int)*stack-&gt;capacity); /* AND HERE */\n</code></pre>\n\n<blockquote>\n  <p>how to initialize it?</p>\n</blockquote>\n\n<p>In the same way you initialize <code>stack-&gt;top</code>:</p>\n\n<pre><code>stack = malloc(sizeof(struct arraystack));\nstack-&gt;top = -1;\nstack-&gt;capacity = cap;\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7434819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7PuRQmJBun4/AAAAAAAAAAI/AAAAAAAAARQ/eIhH8mOPyXU/photo.jpg?sz=128", "display_name": "Asif ", "link": "https://stackoverflow.com/users/7434819/asif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 41716182, "answer_count": 1, "score": 1, "last_activity_date": 1484734337, "creation_date": 1484733082, "question_id": 41716123, "link": "https://stackoverflow.com/questions/41716123/why-this-stack-program-is-giving-garbage-value-when-using-pop", "title": "Why this stack program is giving garbage value when using POP?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nstruct arraystack\n{\nint top;\nint capacity;\nint *array;\n};\n</code></pre>\n\n<p>When i try to run this program after pushing some integer values into stack when i start to POP one from the stack it prints some garbage value but not the one i entered. I want to know where is the problem in my code please help me out ?</p>\n\n<pre><code>struct arraystack *createstack(int cap)\n{\nstruct arraystack *stack;\nstack = malloc(sizeof(struct arraystack));\nstack-&gt;top=-1;\ncap=stack-&gt;capacity;\nstack-&gt;array = malloc(sizeof(int)*stack-&gt;capacity);\nreturn(stack);\n}\n\nint isfull (struct arraystack *stack)\n{\nif (stack-&gt;top==stack-&gt;capacity-1)\n{\n    return 1;\n}\nelse\nreturn 0;\n}\n\nint isempty (struct arraystack *stack)\n{\nif(stack-&gt;top==-1)\n{\n\n    return 1;\n }\nelse\n    return 0;\n }\n\nvoid push (struct arraystack *stack, int item)\n{\nif (!isfull(stack))\n{\n    stack-&gt;top++;\n    stack-&gt;array[stack-&gt;top] = item;\n}\n}\n\n int pop (struct arraystack *stack)\n{\nint item;\nif (isfull(stack))\n{\n    item=stack-&gt;array[stack-&gt;top];\n    stack-&gt;top--;\n    return item;\n}\n else\n    return -1;\n\n }\n\n int main()\n{\nint choice, item;\nstruct arraystack *stack;\nstack=createstack(4);\n\nwhile(1) {\n     clrscr();\n    printf(\"\\n 1.  Push\");\n    printf(\"\\n 2.  Pop\");\n    printf(\"\\n 3.  Exit\\n\");\n    scanf(\"%d\", &amp;choice);\n    switch (choice)\n    {\n        case 1: printf(\"Enter a number\\n\");\n                scanf(\"%d\", &amp;item);\n                push(stack,item);\n                break;\n\n        case 2:\n                 item=pop(stack);\n                 if (item == -1)\n                 {\n                     printf(\"stack is empty\");\n                 }\n                 else\n                    printf(\"popped value is %d\", item);\n                 break;\n\n\n         case 3 : exit(0);\n    }\n  }\n    getch();\n  }\n</code></pre>\n"}, {"tags": ["c", "if-statement", "optimization", "boolean", "embedded"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484732199, "post_id": 41715809, "comment_id": 70626429, "body": "Types, types..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484732400, "post_id": 41715809, "comment_id": 70626590, "body": "To clarify, you&#39;re not asking about the resulting code being generated by the compiler, but about the compilation process itself?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484732487, "post_id": 41715809, "comment_id": 70626653, "body": "More text means the compiler has to parse more text. Might be a couple of nanoseconds in difference there."}, {"owner": {"reputation": 81, "user_id": 2525694, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c40d6e5b4c64b318c81d2afe162e42b5?s=128&d=identicon&r=PG", "display_name": "Stoica Dan", "link": "https://stackoverflow.com/users/2525694/stoica-dan"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484733255, "post_id": 41715809, "comment_id": 70627202, "body": "@Some programmer dude YES"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1484733356, "post_id": 41715809, "comment_id": 70627283, "body": "Then yes there&#39;s a difference, but you need an <i>extremely</i> high resolution clock to be able to notice the difference. Or have millions or even <i>tens</i> of millions of such statements in a single source file. And there might even not <i>be</i> a (measurable) difference, since the the compiler must do different things for the two different expressions, and those differences might outweigh each other."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1484769738, "post_id": 41715809, "comment_id": 70651251, "body": "To be fair, the author is clearly asking about the <i>performance differences</i> of the two approaches, while the linked duplicate seems exclusively about questions of style, readability, maintenance, etc. The author could have made it clear in the title though, rather than leaving it to the last sentence."}], "answers": [{"tags": [], "owner": {"reputation": 1711, "user_id": 2420301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irQpr.jpg?s=128&g=1", "display_name": "Marc Balmer", "link": "https://stackoverflow.com/users/2420301/marc-balmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1484732264, "creation_date": 1484732264, "answer_id": 41715854, "question_id": 41715809, "link": "https://stackoverflow.com/questions/41715809/compile-time-performance-difference-between-ifflag-and-ifflag-0/41715854#41715854", "title": "Compile-time performance difference between if(flag) and if(flag !=0)?", "body": "<p>No, there is no practical difference, if flag is an integral type.</p>\n"}], "owner": {"reputation": 81, "user_id": 2525694, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c40d6e5b4c64b318c81d2afe162e42b5?s=128&d=identicon&r=PG", "display_name": "Stoica Dan", "link": "https://stackoverflow.com/users/2525694/stoica-dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "closed_date": 1484732459, "answer_count": 1, "score": -1, "last_activity_date": 1484769853, "creation_date": 1484732129, "last_edit_date": 1484769853, "question_id": 41715809, "link": "https://stackoverflow.com/questions/41715809/compile-time-performance-difference-between-ifflag-and-ifflag-0", "closed_reason": "Duplicate", "title": "Compile-time performance difference between if(flag) and if(flag !=0)?", "body": "<p>Is there any performance difference between </p>\n\n<pre><code>if (flag) {...} \n</code></pre>\n\n<p>or </p>\n\n<pre><code>if (flag!=0) {...}\n</code></pre>\n\n<p>Considering both compiler execution time or resources needed.</p>\n"}, {"tags": ["c", "signal-processing", "fixed-point"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1484732677, "post_id": 41715661, "comment_id": 70626793, "body": "<code>(float)0x7FFFFFFF</code> is <code>2147483648.00000</code>: <a href=\"http://ideone.com/mawlXx\" rel=\"nofollow noreferrer\">ideone.com/mawlXx</a> . Even after casting to <code>unsigned</code> the value holds: <a href=\"http://ideone.com/7WMeRE\" rel=\"nofollow noreferrer\">ideone.com/7WMeRE</a>"}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1484733290, "post_id": 41715661, "comment_id": 70627232, "body": "Hmm?? How come 0x7FFFFFFF ends up as 2147483648 and not 2147483647??"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 3, "creation_date": 1484733625, "post_id": 41715661, "comment_id": 70627482, "body": "Because 2147483647 is not representable as a <code>float</code> and so the nearest representable number will be taken, which is 2147483648."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1484734525, "post_id": 41715661, "comment_id": 70628070, "body": "Any idea why didn&#39;t the above code just use <code>(float)0x8000000</code> instead of <code>(float)0x7FFFFFFF</code>?"}, {"owner": {"reputation": 4001, "user_id": 671509, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cfc6eb6760f9d2bab7d5b876f283e2a1?s=128&d=identicon&r=PG", "display_name": "John McFarlane", "link": "https://stackoverflow.com/users/671509/john-mcfarlane"}, "edited": false, "score": 0, "creation_date": 1484766719, "post_id": 41715661, "comment_id": 70649511, "body": "Perhaps the author was trying to avoid overflow and/or wished to express the value <code>1.0</code> on architectures where <code>INT_MAX</code> is <code>0x7FFFFFFF</code>. Unfortunately, this solution is unlikely to be successful <i>or</i> correct."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "edited": false, "score": 0, "creation_date": 1497969394, "post_id": 41715661, "comment_id": 76297448, "body": "Would it help to make <code>float</code> a <code>double</code>, <code>(double)(x)*(double)0x7FFFFFFFULL)</code>? This would require casting input <code>x</code> from <code>float</code> to <code>double</code> every time."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487706013, "post_id": 42373028, "comment_id": 71901954, "body": "Why use <code>0x7FFFFF00.p-31F;</code> rather than the largest <code>float</code> under 1?  <code>(0x7FFFFF80.p-31F;)</code>  Better yet, be portable: <code>Q31_MAX_F =  nextafterf(1.0,0.0); Q31_MIN_F = -1.0f;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487706150, "post_id": 42373028, "comment_id": 71902031, "body": "To <i>round</i>, suggest  <code>int32_t result = (int32_t) lround(scalbnf(clamped, 31));</code>"}, {"owner": {"reputation": 78, "user_id": 6744189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qFucL.png?s=128&g=1", "display_name": "Ayan Shafqat", "link": "https://stackoverflow.com/users/6744189/ayan-shafqat"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487706817, "post_id": 42373028, "comment_id": 71902430, "body": "Thanks. Updated according to your comments."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487707521, "post_id": 42373028, "comment_id": 71902845, "body": "Detail: &quot;constant <code>Q31_MAX_F</code> is 1 - (2 ^ -24)&quot;.  Typical <code>float</code> has 24-bits of precision."}, {"owner": {"reputation": 78, "user_id": 6744189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qFucL.png?s=128&g=1", "display_name": "Ayan Shafqat", "link": "https://stackoverflow.com/users/6744189/ayan-shafqat"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1487765158, "post_id": 42373028, "comment_id": 71929396, "body": "Thanks for the correction. Typical <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format#IEEE_754_single-precision_binary_floating-point_format:_binary32\" rel=\"nofollow noreferrer\">IEEE754 single precision floating point</a> has 23 mantissa bits, with an implied MSB, which gives 24 bits of precision."}], "tags": [], "owner": {"reputation": 78, "user_id": 6744189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qFucL.png?s=128&g=1", "display_name": "Ayan Shafqat", "link": "https://stackoverflow.com/users/6744189/ayan-shafqat"}, "is_accepted": true, "score": 2, "last_activity_date": 1502566430, "last_edit_date": 1502566430, "creation_date": 1487695083, "answer_id": 42373028, "question_id": 41715661, "link": "https://stackoverflow.com/questions/41715661/mapping-1-1-floats-to-q31-fixed-point/42373028#42373028", "title": "Mapping [-1,+1] floats to Q31 fixed-point", "body": "<p>The code above is not a good solution to convert from float to fixed point. I am guessing whoever wrote the code used the scale factor of <code>0x7FFFFFFF</code> to avoid an overflow when the input is <code>1.0</code>. The correct scaling factor is <code>2^31</code> and not <code>2^31 - 1</code>. Note that there are also precision issues when converting a <code>float</code> (with 24 bits of precision) to an <code>Q1.31</code> (with 31 bits of precision). Consider saturating the input data before multiplication:</p>\n\n<pre><code>const float Q31_MAX_F =  0x0.FFFFFFp0F;\nconst float Q31_MIN_F = -1.0F;\nfloat clamped = fmaxf(fminf(input, Q31_MAX_F), Q31_MIN_F);\n</code></pre>\n\n<p>The code above will clamp <code>input</code> to the range of <code>[-1.0, 1.0)</code>. The constant<code>Q31_MAX_F</code> is approximately <code>1 - (2 ^ -24)</code>, considering 24-bits of precision, and <code>Q31_MIN_F</code> is <code>-1</code>. Then you can multiply <code>clamped</code> by <code>2^31</code>, or even better, use <a href=\"http://en.cppreference.com/w/c/numeric/math/scalbn\" rel=\"nofollow noreferrer\">scalbnf</a>, or <a href=\"http://en.cppreference.com/w/c/numeric/math/ldexp\" rel=\"nofollow noreferrer\">ldexpf</a>:</p>\n\n<pre><code>int result = (int) scalbnf(clamped, 31);\n</code></pre>\n\n<p>And if you want rounding:</p>\n\n<pre><code>int result = (int) roundf(scalbnf(clamped, 31)));\n</code></pre>\n"}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1247, "favorite_count": 0, "accepted_answer_id": 42373028, "answer_count": 1, "score": 3, "last_activity_date": 1502566430, "creation_date": 1484731769, "last_edit_date": 1489227224, "question_id": 41715661, "link": "https://stackoverflow.com/questions/41715661/mapping-1-1-floats-to-q31-fixed-point", "title": "Mapping [-1,+1] floats to Q31 fixed-point", "body": "<p>I need to convert float to Q31 fixed-point, Q31 meaning 1 sign bit, 0 bits for integer part, and 31 bits for fractional part. This means that Q31 can only represent numbers in the range <code>[-1,0.9999]</code>.</p>\n\n<p>By definition, when converting from float to fixed-point, a multiplication by <code>2\u02c7N</code> is done, where N is the fractional part size, in this case 31. </p>\n\n<p>However, I got confused with this code, it doesn't look right, but works: </p>\n\n<pre><code>#define q31_float_to_int(x) ( (int) ( (float)(x)*(float)0x7FFFFFFF ) )\n</code></pre>\n\n<p>And it seems to work OK. For example: </p>\n\n<pre><code>int a = q31_float_to_int(0.5f); \n</code></pre>\n\n<p>gives <code>Hex: 0x40000000</code>, which is OK. </p>\n\n<p>Why is the multipication here done with <code>2\u02c731 - 1</code>, and not just <code>2\u02c731</code>?</p>\n"}, {"tags": ["c", "algorithm", "sorting", "quicksort"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 0, "creation_date": 1484731695, "post_id": 41715443, "comment_id": 70626051, "body": "As an aside, my impression is that modifying quicksort to make it stable is likely to sacrifice enough of the <i>quick</i> part that you&#39;re better off using a naturally stable sort."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484731770, "post_id": 41715443, "comment_id": 70626112, "body": "@Hurkyl What does sacrificing <i>quick</i> mean?I never thought about meaning of <i>quick</i> in this algorithm"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 0, "creation_date": 1484733482, "post_id": 41715443, "comment_id": 70627385, "body": "Quick sort is popular because it tends to run faster than other algorithms in its category like merge sort and heapsort. But its advantage is not a huge one -- you can easily lose that advantage if you make quick sort do more work. And I expect the work needed to make quick sort stable is enough to lose the advantage."}, {"owner": {"reputation": 3365, "user_id": 2564696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfecfacff3f61943083d01444ade243?s=128&d=identicon&r=PG", "display_name": "dmuir", "link": "https://stackoverflow.com/users/2564696/dmuir"}, "edited": false, "score": 1, "creation_date": 1484734093, "post_id": 41715443, "comment_id": 70627805, "body": "Any sort can be made stable at the cost of using a more complex comparison. If your comprison breaks ties by comparing original indices, the sort will be stable."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484734146, "post_id": 41715443, "comment_id": 70627842, "body": "@Hurkyl Quick sort is faster than merge sort, despite 39% more <code>compare()</code> in quick sort vis-a-vis mergesort. Because,  less <code>swap()</code> operations happen in quicksort. <code>swap()</code> is more costly than <code>compare()</code> at machine level."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1484749138, "post_id": 41715443, "comment_id": 70638026, "body": "@overexchange - If stability via quick sort is gained via an array of pointers as answered by chqrlie, then merge sort is faster, because only the pointers are moved, while, the objects are compared through dereferencing of pointers. On a processor with 16 registers, a 4 way merge sort uses 1/2 the moves but 3/2 the compares, and if compares are faster than moves, a 4 way merge sort is faster than quick sort, although the merge sort will need a second array (O(n) space requirement versus quick sort&#39;s best case of O(log2(n)) space requirement."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484769807, "post_id": 41715443, "comment_id": 70651294, "body": "The relative cost of &#39;swap&#39; and &#39;compare&#39; depends on the sort criteria and the data types.  If you&#39;re comparing multiple elements of big structures but only swapping pointers to those elements, the cost of compare can be far larger than the cost of swap.  If you&#39;re simply comparing and swapping integers, then the comparison is cheaper than the swap."}], "answers": [{"comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484733154, "post_id": 41715969, "comment_id": 70627130, "body": "Query updated. Are you saying that, Quick sort can be stable, if elements are distinct? If yes, that is not the solution to make it stable. Because you are changing the problem to ensure solution to work."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 3, "creation_date": 1484733334, "post_id": 41715969, "comment_id": 70627265, "body": "No, I am saying that the comparison function should not return <code>0</code>: if identical elements compare non zero according to their original positions in the array, your sort will be stable."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484786633, "post_id": 41715969, "comment_id": 70658160, "body": "@overexchange: your compare function does not implement the trick I mentioned, furthermore, it only works if the original array elements have addresses in strictly increasing order.  In your case, the array is already an array of pointers, but you have no guarantee that the elements satisfy the constraint and you did not implement the comparison function with the extra test."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484786918, "post_id": 41715969, "comment_id": 70658221, "body": "I am not relying on address compare(error prone) logic. Am relying on strict value compares, if you see values compares are done before <code>arraySwap()</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484787413, "post_id": 41715969, "comment_id": 70658342, "body": "address compare is not error prone, it is <b>the</b> trick required to make quick-sort stable, for elements that compare equal for the value based comparison and if you have the original addresses. I&#39;m afraid you did not understand the method.  Your code already addresses a special case: you sort an array of pointers. if these pointers are allocated in strictly increasing order, you can make <code>qSort()</code> stable by comparing the addresses for elements that compare equal for the values."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484789267, "post_id": 41715969, "comment_id": 70658811, "body": "I tested your <code>sortptr()</code> with keys <code>2 3 3 1 1</code>.  After first partition <code>3</code> is losing the relative order in with output <code>1 1 2 3 3</code>. In this output, last element <code>3</code> was at index 1 before partition."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484789770, "post_id": 41715969, "comment_id": 70658940, "body": "Did you create an array of pointers to the elements of the array to be sorted?"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1484813477, "post_id": 41715969, "comment_id": 70666865, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/133524/discussion-between-overexchange-and-chqrlie\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 6, "last_activity_date": 1484733796, "last_edit_date": 1484733796, "creation_date": 1484732619, "answer_id": 41715969, "question_id": 41715443, "link": "https://stackoverflow.com/questions/41715443/cant-quick-sort-become-stable-sort/41715969#41715969", "title": "Can&#39;t quick sort become stable sort?", "body": "<p>This looks like home work, so I am not going to solve it completely:</p>\n\n<ul>\n<li><p>quick-sort can be made stable by ensuring that no 2 elements compare equal.</p></li>\n<li><p>choosing a different pivot alone does not provide a solution for this.</p></li>\n</ul>\n\n<p>Since you say this is not homework, here is how to make quick-sort stable:</p>\n\n<ul>\n<li>make an array of pointers to the original array.</li>\n<li><p>use quick-sort to sort this array with a function that compares the pointed values this way:</p>\n\n<pre><code>int sortptr(const void *a, const void *b) {\n    const my_type * const *pa = a;\n    const my_type * const *pb = b;\n    int cmp = original_compare_function(*pa, *pb);\n    return cmp ? cmp : (pa &gt; pb) - (pa &lt; pb);\n}\n</code></pre></li>\n<li><p>copy the sorted items into a sorted array.</p></li>\n</ul>\n\n<p>Note that this approach can be made to work in place, but it is tricky to do so and would still require allocating the array of pointers. merge-sort is much more reliable for stable sorting, but requires working space of approximately half the size of the original array.</p>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521329325, "creation_date": 1484731192, "last_edit_date": 1592644375, "question_id": 41715443, "link": "https://stackoverflow.com/questions/41715443/cant-quick-sort-become-stable-sort", "title": "Can&#39;t quick sort become stable sort?", "body": "<h1>Approach 1</h1>\n<p>C.A.R Hoare introduced partitioning logic(shown below), which is taught in school,</p>\n<pre><code>low = pivot = 0;\ni = 1;\nj = high = listSize-1;\n\nwhile (true) {\n    while (a[i] &lt;= a[pivot] &amp;&amp; (i &lt; high)) {\n        i = i + 1;\n    }\n    while (a[j] &gt;= a[pivot] &amp;&amp; (j &gt; low)) {\n        j = j - 1; \n    }\n\n    if (i &gt;= j)\n        break;\n    swap(a[i], a[j])\n}\n\nswap(a[j], a[pivot]); // pivot element is positioned(once)\nreturn j;\n</code></pre>\n<hr />\n<h1>Approach 2</h1>\n<p>To <strong>basically try  make it stable sort</strong>, Instead <code>j</code> pointing to last index(<code>listSize-1</code>), if <code>j</code> points to <code>listSize/2</code>(i.e., <code>mid</code>), then,</p>\n<p>we get into scenario where  <code>j &gt; high</code> or <code>i &gt;= mid</code>, where <code>a[i]</code> do not have corresponding <code>a[j]</code> to swap with and <em>vice-versa</em>. In such scenario, swapping <code>a[i]</code> with <code>a[pivot]</code> also does not make sense, <strong>which looks an incorrect approach</strong>, To confirm the same,</p>\n<hr />\n<p>My question:</p>\n<p>With approach 2,</p>\n<p>By maintaining the essence of quick sort, Can't we partition with pivot element(at any index)?</p>\n<p><em>Note: Analyzing quick sort, not a home work</em></p>\n"}, {"tags": ["css", "c", "gtk3"], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1484732154, "post_id": 41715710, "comment_id": 70626389, "body": "I already explained the first part of your Answer. And I definitely do not want to silence the compiler warning. I need to change that function some how that works when I click that Button."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 2, "creation_date": 1484733397, "post_id": 41715710, "comment_id": 70627318, "body": "You explained that you removed that first parameter which is the root cause of your problem. The signature of the function is defined by GTK+3. As a user of this interface you are not in the position to change it. The interface definition from GTK is &quot;the law&quot; and you have to stick to it. Use the parameter or silence the warning. There are no other options."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1484751969, "post_id": 41715710, "comment_id": 70640159, "body": "I&#39;m sorry to hear that, but I&#39;m happy for the moment with that."}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 1, "creation_date": 1485053849, "post_id": 41715710, "comment_id": 70763494, "body": "It&#39;s not quite true that you can&#39;t change the function signature. You can drop parameters off the end if you don&#39;t use them. You just can&#39;t remove parameters from the beginning or the middle, like <code>widget</code>. For detailed explanation, see <a href=\"http://stackoverflow.com/questions/22402597/why-does-gobject-method-still-get-called-even-if-callback-arguments-dont-match/22419961#22419961\">this answer</a>."}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1485053889, "post_id": 41715710, "comment_id": 70763501, "body": "<code>G_GNUC_UNUSED</code> is another way to silence the warning, by the way."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 2, "last_activity_date": 1485164126, "last_edit_date": 1495540021, "creation_date": 1484731923, "answer_id": 41715710, "question_id": 41715442, "link": "https://stackoverflow.com/questions/41715442/invalid-cast-from-gtkbutton-to-gtkentry/41715710#41715710", "title": "invalid cast from &#39;GtkButton&#39; to &#39;GtkEntry&#39;", "body": "<p><strong>First the general rule:</strong></p>\n\n<p>You mustn't change the signature of your callback functions!\nIf it is defined to have 2 paramters then you <strong>never ever</strong> drop one paramter!</p>\n\n<p>If you do not use one of these parameters, you can just <a href=\"https://stackoverflow.com/questions/41378893/a-multi-argument-function-in-c-in-which-the-second-argument-is-never-used/41378986#41378986\">silence your compiler warning</a>.</p>\n\n<pre><code>(void)widget;\n</code></pre>\n\n<p>What you do is using a <code>GtkWidget*</code> holding the address of the widget and treat it as if it was your user data pointer.</p>\n\n<p>To make it more obvious what happens when you do this:\nGTK calls your callback function:</p>\n\n<pre><code>button-&gt;event_cb(button, userdata);\n</code></pre>\n\n<p>But your function does not match the signature:</p>\n\n<pre><code>my_button_cb(void* mydata)\n{\n  // here mydata holds the value from argument button.\n  // The value from argument userdata is lost!\n}\n</code></pre>\n\n<p>You mention that it compiles fine. This is no surprise. When you call <code>g_signal_connect</code> to add your callback, the type of the function pointer is not preserved. The compiler does not know how the signature should look like and is not able to throw an error message at you.\nThis does not mean that your code is correct.</p>\n\n<p><strong>Additional note:</strong></p>\n\n<p>As ptomato pointed out, it is possible to drop parameters at the end of the list. While this is technically possibly I would not encourage to use this way. Especially if you are providing the callback function yourself. I would regard this to be bad practice.</p>\n\n<p>Things are a bit different if you want to use a callback function that is provided by some library. There it could happen that the signature does not exactly match and you would need to write a wrapper to make parameters match.\nIn this case I don't see an urgent need to add this wrapper just to have cleaner code.\nAfter browsing some GTK samples I even found a way to use a callback where the order of the parameters is not matching: <code>g_signal_connect_swapped</code>. With this function the parameters are provided in different order to the callback. This would allow to use library functions like <code>gtk_widget_destroy()</code> to signals that provide the window only as userdata in second parameter. </p>\n\n<p>But again: If you provide the callback yourselfe, I wouldn't use such tricks.</p>\n"}], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1569, "favorite_count": 1, "accepted_answer_id": 41715710, "answer_count": 1, "score": -1, "last_activity_date": 1485164126, "creation_date": 1484731188, "question_id": 41715442, "link": "https://stackoverflow.com/questions/41715442/invalid-cast-from-gtkbutton-to-gtkentry", "title": "invalid cast from &#39;GtkButton&#39; to &#39;GtkEntry&#39;", "body": "<p>I wrote a code in <code>GTK3</code> and works fine:\n<a href=\"https://i.stack.imgur.com/lajuX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lajuX.png\" alt=\"enter image description here\"></a></p>\n\n<p>As long as I don't use the compiler FLAGS <code>-Wall -Wextra</code>.\nBut when I turn them ON, I get:</p>\n\n<pre><code>invalid cast from 'GtkButton' to 'GtkEntry'\n</code></pre>\n\n<p>And I can't figure out where the problem is.This happens After the User type something and hits the Button.</p>\n\n<p>Here is the Code:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nstatic void btn_clicked(GtkWidget *widget, gpointer data)\n{\n        g_print(\"%s\\n\", gtk_entry_get_text(GTK_ENTRY(data)));\n        gtk_editable_select_region(GTK_EDITABLE(data), 0,-1);\n        gtk_editable_copy_clipboard(GTK_EDITABLE(data));\n}\n\nint main(int argc, char *argv[])\n{\n    GtkWidget *window, *grid;\n    GtkWidget *label, *label_fn;\n    GtkWidget *fn_entry;\n    GtkWidget *button;\n\n            //---------- CSS -------------\n    GtkCssProvider *provider;\n    GdkDisplay *display;\n    GdkScreen *screen;\n    //---------------------------\n\n    gtk_init(&amp;argc, &amp;argv);\n\n    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    gtk_window_set_title(GTK_WINDOW(window), \"MyApp\");\n    gtk_window_set_default_size(GTK_WINDOW(window), 370, 155);\n    gtk_window_set_resizable (GTK_WINDOW(window), TRUE);\n    gtk_container_set_border_width(GTK_CONTAINER(window), 5);\n    g_signal_connect(window, \"destroy\", G_CALLBACK(gtk_main_quit), NULL);\n\n    /*     Create a Grid     */\n    grid = gtk_grid_new();\n    gtk_container_set_border_width(GTK_CONTAINER (grid), 15);\n    gtk_widget_set_name(grid, \"myGrid\");\n    gtk_grid_set_column_spacing(GTK_GRID(grid), 5);\n    gtk_grid_set_row_spacing(GTK_GRID(grid), 5);\n    gtk_container_add(GTK_CONTAINER(window), grid);\n\n    /*     Create first Label     */\n    label = gtk_label_new(\"Please enter your Information:\");\n    gtk_widget_set_margin_top(label, 25);\n    gtk_widget_set_margin_start(label, 85);\n\n    /*     Create second Label     */\n    label_fn = gtk_label_new(\"First Name: \");\n    gtk_widget_set_margin_start(label_fn, 10);\n\n    /*     Create an Entry:     */\n    fn_entry = gtk_entry_new();\n\n    /*     Create a Button    */\n    button = gtk_button_new_with_mnemonic(\"_Write text\");\n    g_signal_connect(button, \"clicked\", G_CALLBACK(btn_clicked), fn_entry);\n    g_signal_connect(fn_entry, \"activate\", G_CALLBACK(btn_clicked), fn_entry);\n\n\n    /*     Putting all together      */\n    gtk_grid_attach(GTK_GRID(grid), label,      0, 0, 2, 1);\n    gtk_grid_attach(GTK_GRID(grid), label_fn,   0, 1, 1, 1);\n    gtk_grid_attach(GTK_GRID(grid), fn_entry,   1, 1, 1, 1);\n    gtk_grid_attach(GTK_GRID(grid), button,     1, 2, 1, 1);\n\n        // ---------------------------------------------------- CSS -----------------------------------------------------------\n    provider = gtk_css_provider_new ();\n    display = gdk_display_get_default ();\n    screen = gdk_display_get_default_screen (display);\n    gtk_style_context_add_provider_for_screen (screen, GTK_STYLE_PROVIDER (provider), GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);\n\n    const gchar *myCssFile = \"mystyle.css\";\n    GError *error = 0;\n\n    gtk_css_provider_load_from_file(provider, g_file_new_for_path(myCssFile), &amp;error);\n    g_object_unref (provider);\n    // --------------------------------------------------------------------------------------------------------------------\n\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n</code></pre>\n\n<p>mystyle.css:</p>\n\n<pre><code>GtkWindow {\n    background-color: magenta;\n    color: black;\n    border-width: 3px;\n    border-color: blue;\n}\n\n#myGrid {\n    background-color: red;\n    border-style: solid;\n    border-color: black;\n    border-width: 3px;\n    border-radius: 15px;\n    border-color: grey;\n}\n</code></pre>\n\n<p>Compiled with:</p>\n\n<pre><code>gcc myApp.c -o myApp `pkg-config --cflags --libs gtk+-3.0 `\n</code></pre>\n\n<p>works fine.</p>\n\n<p>But the function <code>static void btn_clicked(GtkWidget *widget, gpointer data)</code> has two parameters and used is only <code>gpointer data</code>.</p>\n\n<p>If I use <code>-Wall -Wextra</code> I get:</p>\n\n<pre><code>myApp.c: In function \u2018btn_clicked\u2019:\nmyApp.c:3:36: warning: unused parameter \u2018widget\u2019 [-Wunused-parameter]\n static void btn_clicked(GtkWidget *widget, gpointer data)\n                                    ^\n</code></pre>\n\n<p>And here starts the problem.</p>\n\n<p>When I remove the parameter <code>GtkWidget *widget</code> and compile it (which compiles fine), after I run it and I type something in that field and I click on that Button (Write text) I get the following:</p>\n\n<pre><code>(myApp:5778): GLib-GObject-WARNING **: invalid cast from 'GtkButton' to 'GtkEntry'\n\n(myApp:5778): Gtk-CRITICAL **: gtk_entry_get_text: assertion 'GTK_IS_ENTRY (entry)' failed\n(null)\n\n(myApp:5778): GLib-GObject-WARNING **: invalid cast from 'GtkButton' to 'GtkEditable'\n\n(myApp:5778): Gtk-CRITICAL **: gtk_editable_select_region: assertion 'GTK_IS_EDITABLE (editable)' failed\n\n(myApp:5778): GLib-GObject-WARNING **: invalid cast from 'GtkButton' to 'GtkEditable'\n\n(myApp:5778): Gtk-CRITICAL **: gtk_editable_copy_clipboard: assertion 'GTK_IS_EDITABLE (editable)' failed\n</code></pre>\n\n<p>So, my Question is how to fix that?</p>\n"}, {"tags": ["c", "linux", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484730577, "post_id": 41715172, "comment_id": 70625322, "body": "So you create threads infinitely? Threads is a <i>finite</i> resource, the operating system will not allow you to create infinite number of threads. You also have to think about how multi-tasking works on operating systems, where all threads and processes <i>takes turn</i> to run on the CPU cores. The more threads you have, the less time each have to actually run, and the more time the operating system needs to switch between them."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1484730721, "post_id": 41715172, "comment_id": 70625410, "body": "If only the documentation for <a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html#ERRORS\" rel=\"nofollow noreferrer\">pthread_create</a> explained under what conditions it would return an error, how to tell what the error is, and what could cause it. That would be really swell, wouldn&#39;t it?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484730797, "post_id": 41715172, "comment_id": 70625462, "body": "That&#39;s a number that your code chose to log for reasons only you could possibly know. If you don&#39;t find it useful, don&#39;t log it."}, {"owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "edited": false, "score": 0, "creation_date": 1484731233, "post_id": 41715172, "comment_id": 70625717, "body": "actually my requirment is to start thread once I press &quot;ctrl+c&quot; and work throughout.for this what should need to do.since thread are not infinite?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1484731266, "post_id": 41715172, "comment_id": 70625738, "body": "You should: 1) Clean up after yourself. Don&#39;t leave threads hanging. 2) Check function calls for errors and handle them sanely."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1484731371, "post_id": 41715172, "comment_id": 70625816, "body": "And 3) Don&#39;t have an infinite loop where you continually check <code>if (selection == &#39;s&#39;)</code> and create a thread without changing <code>selection</code> to something which is <i>not</i> <code>&#39;s&#39;</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1484731481, "post_id": 41715172, "comment_id": 70625890, "body": "Furthermore, remember that local variables which are not initialized will have an <i>indeterminate</i> value. Don&#39;t use them (in any way) without initialization. If you&#39;re unlucky the initial value of <code>selection</code> might actually <i>be</i> <code>&#39;s&#39;</code> or <code>&#39;r&#39;</code>, which mean you will run out of threads before you even have time to press CTRL-C."}, {"owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484735335, "post_id": 41715172, "comment_id": 70628570, "body": "yeah it is correct @some programmer,I have used pthread detach to solve this problem.after creating a new thread in &quot;cat /proc/17084/status&quot; .I can able to see in number of threads column as &#39;1&#39; instead of &#39;2&#39;(since I have started 2 threads.I have not made any change in the code shown above."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "edited": false, "score": 0, "creation_date": 1484731341, "post_id": 41715339, "comment_id": 70625794, "body": "yeah it will suit my requirment @David Schwartz"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1484730890, "creation_date": 1484730890, "answer_id": 41715339, "question_id": 41715172, "link": "https://stackoverflow.com/questions/41715172/infinite-loop-terminating-in-pthread/41715339#41715339", "title": "Infinite loop terminating in pthread", "body": "<p>You need to either <a href=\"http://man7.org/linux/man-pages/man3/pthread_attr_setdetachstate.3.html\" rel=\"nofollow noreferrer\">detach</a> your threads or <a href=\"http://man7.org/linux/man-pages/man3/pthread_join.3.html\" rel=\"nofollow noreferrer\">join</a> them. Otherwise, you will run out of resources.</p>\n"}], "owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 41715339, "answer_count": 1, "score": 0, "last_activity_date": 1484730992, "creation_date": 1484730396, "last_edit_date": 1484730992, "question_id": 41715172, "link": "https://stackoverflow.com/questions/41715172/infinite-loop-terminating-in-pthread", "title": "Infinite loop terminating in pthread", "body": "<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;signal.h&gt;\n#include&lt;unistd.h&gt;//getch();\n#include &lt;termios.h&gt;//getch();\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\nunsigned int sleep(unsigned int seconds);\n\nvolatile sig_atomic_t flag = 0;\nint value = 0;\nint count = 0;\n\nchar getch()\n{\n    int buf = 0;\n    struct termios old = { 0 };\n    fflush(stdout);\n    if (tcgetattr(0, &amp;old) &lt; 0)\n        perror(\"tcsetattr()\");\n    old.c_lflag &amp;= ~ICANON;\n    old.c_lflag &amp;= ~ECHO;\n    old.c_cc[VMIN] = 1;\n    old.c_cc[VTIME] = 0;\n    if (tcsetattr(0, TCSANOW, &amp;old) &lt; 0)\n        perror(\"tcsetattr ICANON\");\n    if (read(0, &amp;buf, 1) &lt; 0)\n        perror(\"read()\");\n    old.c_lflag |= ICANON;\n    old.c_lflag |= ECHO;\n    if (tcsetattr(0, TCSADRAIN, &amp;old) &lt; 0)\n        perror(\"tcsetattr ~ICANON\");\n\n    return buf;\n}\nvoid *send_function(void *parg)\n{\n    printf(\"\\n Send Thread \");\n    count++;\n    return parg;\n}\nvoid *receive_function(void *parg)\n{\n    printf(\"\\n Receive Thread \");\n    count++;\n    return parg;\n}\nvoid my_function(int sig)\n{\n    flag = 1; // set flag\n}\n\nint main()\n{\n    char selection; //user input(s or r)\n    pthread_t send;\n    pthread_t receive;\n    while (1)\n    {\n        signal(SIGINT, my_function);\n        if (flag)\n        {\n            printf(\"\\n Choose your terminal S or R \\n\");\n            selection = getch();\n            flag = 0;\n        }\n        if (selection == 's')\n        {\n            if (pthread_create(&amp;send, NULL, send_function, NULL))\n            {\n                printf(\"Error creating thread=%d\\n\", count);\n                return 1;\n            }\n        }\n        else if (selection == 'r')\n        {\n            if (pthread_create(&amp;receive, NULL, receive_function, NULL))\n            {\n                printf(\"Error creating thread=%d\\n\", count);\n                return 1;\n            }\n        }\n\n        printf(\"\\n MAIN LOOP\\n\");\n        //sleep(1);\n    }\n    return 0;\n    //pthread_exit(NULL);\n}\n</code></pre>\n\n<p>Output1 :</p>\n\n<pre><code>MAIN LOOP\n\nReceive Thread\nMAIN LOOP\n\nReceive Thread\nMAIN LOOP\n\nReceive Thread\nMAIN LOOP\n\nReceive Thread\nReceive Thread\nReceive Thread\nReceive Thread Error creating thread=380\nnivas@balakrishnan-HCL-Desktop:~/C_sample$\n</code></pre>\n\n<p>output2:</p>\n\n<pre><code>MAIN LOOP\n\n MAIN LOOP\n\n MAIN LOOP\n\n Send Thread\n Send Thread\n Send Thread\n Send Thread\n Send Thread\n MAIN LOOP\n Error creating thread=379\n</code></pre>\n\n<p>In the above code. the code should run infinitely when I press 's' or 'r' it should print \"send thread\" or \"receive thread\" accordingly for infinite number of times whereas in this code approx 380 times only the while loop is running.I don't know why it is happening.I have used variable count for debugging purpose,can anyone help?</p>\n"}, {"tags": ["c", "undefined-behavior"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1484730730, "post_id": 41715169, "comment_id": 70625417, "body": "Theoretically!? UB behavior means malicious code can run. Practically pointers don&#39;t point to your hard drive. So if you write to a memory location (even an unspecified one) you won&#39;t damage your files."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484730941, "post_id": 41715169, "comment_id": 70625539, "body": "@StoryTeller I think you meant to post that under my answer, right?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484731856, "post_id": 41715169, "comment_id": 70626173, "body": "@SouravGhosh - Not really. The OP seems worried their files will go missing. I was trying to reassure them that the file system is separate from the memory space of a process (malicious code that is invoked because of UB and deleting files notwithstanding)."}, {"owner": {"reputation": 11, "user_id": 5040503, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5af7849ea3ada352b6dad49ba6087915?s=128&d=identicon&r=PG&f=1", "display_name": "MatSiv97", "link": "https://stackoverflow.com/users/5040503/matsiv97"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484731979, "post_id": 41715169, "comment_id": 70626257, "body": "@StoryTeller if I alter the value at a memory address in the central memory and that happens to be a valid instruction that performs an output operation on the hard drive I guess even that is possible, right?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484732440, "post_id": 41715169, "comment_id": 70626613, "body": "@MatSiv97 - Are you in a hosted environment? The OS is there to protect you from such a thing. If you have direct and unrestricted access to memory, then all bets are off."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485552591, "post_id": 41715169, "comment_id": 70988983, "body": "@StoryTeller my apple 2 has memory mapped IO and no MMU  You can delete the entire disk by writing to the wrong memory address."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1484730922, "last_edit_date": 1484730922, "creation_date": 1484730451, "answer_id": 41715190, "question_id": 41715169, "link": "https://stackoverflow.com/questions/41715169/can-undefined-behaviour-in-c-on-codeblocksdebug-mode-corrupt-files-on-my-pc/41715190#41715190", "title": "can undefined behaviour in C on codeblocks(debug mode) corrupt files on my pc?", "body": "<p>Undefined behaviour is undefined. It can do weird things.</p>\n\n<p>Theoretically, it can corrupt <strong><em>any</em></strong> memory location. Side effects range from ignorable to catastrophic actions.</p>\n\n<p>Read this <a href=\"https://en.wikipedia.org/wiki/Halt_and_Catch_Fire\" rel=\"nofollow noreferrer\">very related</a> wiki article.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1484732162, "creation_date": 1484732162, "answer_id": 41715819, "question_id": 41715169, "link": "https://stackoverflow.com/questions/41715169/can-undefined-behaviour-in-c-on-codeblocksdebug-mode-corrupt-files-on-my-pc/41715819#41715819", "title": "can undefined behaviour in C on codeblocks(debug mode) corrupt files on my pc?", "body": "<p>It entirely depends on what your code does and what kind of undefined behavior you are referring to. Code like this could theoretically damage files on your computer:</p>\n\n<pre><code>char* garbage; // not initialized\nFILE* fp = fopen(garbage, \"w\");\nfprintf(fp, \"hello\");\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5040503, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5af7849ea3ada352b6dad49ba6087915?s=128&d=identicon&r=PG&f=1", "display_name": "MatSiv97", "link": "https://stackoverflow.com/users/5040503/matsiv97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484754255, "creation_date": 1484730377, "last_edit_date": 1484754255, "question_id": 41715169, "link": "https://stackoverflow.com/questions/41715169/can-undefined-behaviour-in-c-on-codeblocksdebug-mode-corrupt-files-on-my-pc", "title": "can undefined behaviour in C on codeblocks(debug mode) corrupt files on my pc?", "body": "<p>My question is: is it possible for a C program running in debug mode on codeblocks to delete important data on my computer? (like when changing the value of a pointer rather then the value it points to and then dereferencing it)</p>\n"}, {"tags": ["c", "gcc", "vim", "c-preprocessor"], "comments": [{"owner": {"reputation": 35343, "user_id": 435800, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4f40d75bd1227e2a57c77864047cd9f7?s=128&d=identicon&r=PG", "display_name": "Kiril Kirov", "link": "https://stackoverflow.com/users/435800/kiril-kirov"}, "edited": false, "score": 0, "creation_date": 1484729877, "post_id": 41714992, "comment_id": 70624918, "body": "What&#39;s the question?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484729924, "post_id": 41714992, "comment_id": 70624943, "body": "Where is the code that reproduces your problem?"}, {"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484730093, "post_id": 41714992, "comment_id": 70625036, "body": "no need for the code. I don&#39;t care about execution of the code I am talking about preprocessor phase !!!"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484730565, "post_id": 41714992, "comment_id": 70625315, "body": "@Sabrina - There is always need for code. The preprocessor operates on <b>code</b>."}, {"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484731226, "post_id": 41714992, "comment_id": 70625710, "body": "Can someone confirm that behavior in his machine ?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1484745701, "post_id": 41714992, "comment_id": 70635656, "body": "Your image of text <a href=\"//meta.unix.stackexchange.com/q/4086\">isn&#39;t very helpful</a>.  It can&#39;t be read aloud or copied into an editor, and it doesn&#39;t index very well, meaning that other users with the same problem are less likely to find the answer here.  Please <a href=\"https://stackoverflow.com/posts/41714992/edit\">edit</a> your post to incorporate the relevant text directly (preferably using copy+paste to avoid transcription errors)."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1484746065, "post_id": 41714992, "comment_id": 70635924, "body": "Simpler test case: <code>cpp &lt;&lt;&lt;$&#39;foo\\\\\\n bar baz&#39; | grep -v &#39;^#&#39;</code> (in Bash).  Remove the space to see the tokens concatenated and the following line indented.  It&#39;s an interesting effect; I assume that substituting the next available whitespace in this way allows the preprocessor to preserve source line and column numbers of subsequent code in the most efficient manner."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1485970364, "post_id": 41714992, "comment_id": 71149739, "body": "I&#39;ve found confirmation that this behaviour is intended because it <a href=\"https://gcc.gnu.org/wiki/FAQ#cpp_continuation_discarded\" rel=\"nofollow noreferrer\">maintains the location information for the rest of the compiler</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1572137104, "post_id": 41714992, "comment_id": 103467504, "body": "Related, but different (this is not a duplicate of that): <a href=\"https://stackoverflow.com/questions/21635063/why-both-clang-and-gcc-only-give-a-warning-when-there-is-a-space-after-backslash\">Why both Clang and GCC only give a warning when there is a space after backslash?</a>  In this case, when the backslash and newline are removed, the space before <code>urn</code> means that the consecutive tokens are <code>ret</code> and <code>urn</code> (both identifiers) and not <code>return</code> (a keyword).  See also C11 <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.1.2\" rel=\"nofollow noreferrer\">&#167;5.1.1.2 Translation phases</a> \u2014 phases 1 and 2 are relevant here."}], "answers": [{"comments": [{"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484730280, "post_id": 41715109, "comment_id": 70625159, "body": "the problem I am not getting that I am getting two separate lines. Your answer is the normal behavior. That&#39;s why I am asking the question."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484730360, "post_id": 41715109, "comment_id": 70625207, "body": "@Sabrina - What does <i>&quot;I am getting two separate lines&quot;</i> mean? Where are you supposed to be getting it from?! You write your code."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484731652, "post_id": 41715109, "comment_id": 70626016, "body": "@Sabrina - Thank you for elaborating your question. See my edit please."}, {"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484732249, "post_id": 41715109, "comment_id": 70626467, "body": "Any explanation why it is not joining the two lines even there is backslash + newline at the end ?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484732538, "post_id": 41715109, "comment_id": 70626685, "body": "@Sabrina - Are you asking me why a program written by humans contains a bug?"}, {"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484732643, "post_id": 41715109, "comment_id": 70626767, "body": "So this behavior is considered as a bug."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484732728, "post_id": 41715109, "comment_id": 70626825, "body": "@Sabrina - The <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.2/cpp/Initial-processing.html\" rel=\"nofollow noreferrer\">GCC documentation</a> says the lines will be joined. They are not. So I&#39;d say it&#39;s bug material."}, {"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484732837, "post_id": 41715109, "comment_id": 70626899, "body": "Can an upgrade or downgrade get rid of that presumed bug ?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484732983, "post_id": 41715109, "comment_id": 70627010, "body": "@Sabrina - the version at the site I linked is GCC 6.3. So no fix up to that. I don&#39;t know if this is fixed in GCC 7.0. I must say that you seem to care way to much about that particular behavior. The resulting code is legal or illegal either way since GCC joins the lines when it should."}, {"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484733048, "post_id": 41715109, "comment_id": 70627059, "body": "For some cases like obfuscation it is important. And writing portable code is also important ? or ...."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484733304, "post_id": 41715109, "comment_id": 70627245, "body": "@Sabrina - I highly doubt <i>this</i> will have a major affect on code portability. For obfuscation you should have eliminated <b>all</b> white spaces for maximum unreadability. So this is is again irrelevant."}, {"owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484733424, "post_id": 41715109, "comment_id": 70627346, "body": "I thought that at compilation it will generate error It is a weird behavior but the compiler affair that phase. the output is obvious wrong but then at execution evrything is alright !"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "edited": false, "score": 0, "creation_date": 1484733501, "post_id": 41715109, "comment_id": 70627399, "body": "@Sabrina - Compilation is a separate translation phase. Plus, not all tokens need white-space for separation. <code>int*</code> is two tokens."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1485971311, "post_id": 41715109, "comment_id": 71150318, "body": "It&#39;s <a href=\"https://gcc.gnu.org/wiki/FAQ#cpp_continuation_discarded\" rel=\"nofollow noreferrer\">not a bug</a>."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1484731603, "last_edit_date": 1484731603, "creation_date": 1484730185, "answer_id": 41715109, "question_id": 41714992, "link": "https://stackoverflow.com/questions/41714992/joining-lines-in-c-strange-output-not-compatible-with-documentation/41715109#41715109", "title": "Joining lines in C [Strange output not compatible with documentation]", "body": "<p>The white space is a token separator. Just because you split the line doesn't mean a white space will be ignored.</p>\n\n<p>What the compiler sees is something like <code>ret urn;</code>. Which is not valid C, since it's two tokens which probably weren't defined before, nor are they in a valid expression.</p>\n\n<p>Keywords must be written as a single token with no spaces.</p>\n\n<p>Now, when you do :</p>\n\n<pre><code>  ret\\\nurn;\n</code></pre>\n\n<p>The backslash followed by a newline is removed in the early translation phases, and the subsequent line is appended. If the line has no white spaces at the beginning, the result is a valid token that the compiler understands as the keyword <code>return</code>.</p>\n\n<hr>\n\n<p>Long story short, you seem to be asking about <a href=\"http://coliru.stacked-crooked.com/a/4b8bdd1600d90707\" rel=\"nofollow noreferrer\">specific behavior for GCC</a>. It seems like a compiler bug. Since <a href=\"http://coliru.stacked-crooked.com/a/6ead02fbf9b20cdc\" rel=\"nofollow noreferrer\">clang does the expected thing</a> (although the line count remains the same):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>clang -E -Wall -Wextra -Wimplicit -pedantic -std=c99 -x c main.cpp\n# 1 \"main.cpp\"\n# 1 \"&lt;built-in&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 3\n# 316 \"&lt;built-in&gt;\" 3\n# 1 \"&lt;command line&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 2\n# 1 \"main.cpp\" 2\nint main(void) {\n  ret urn 0;\n\n}\n</code></pre>\n\n<p>It doesn't seem crucial however, since in this particular case the code will be invalid either way.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1484735211, "creation_date": 1484735211, "answer_id": 41716873, "question_id": 41714992, "link": "https://stackoverflow.com/questions/41714992/joining-lines-in-c-strange-output-not-compatible-with-documentation/41716873#41716873", "title": "Joining lines in C [Strange output not compatible with documentation]", "body": "<p>The behavior of the C preprocessor on <code>\\</code> followed by a newline is to remove both bytes from the input.  This is done in a very early phase of the parsing. Yet the preprocessor retains the original line number for each token it sees and tries to output tokens on separate lines for the compiler to issue correct diagnostics for later phases of compilation.</p>\n\n<p>For the input:</p>\n\n<pre><code>ret\\\nurn 1;\n</code></pre>\n\n<p>it may produce:</p>\n\n<pre><code>#line 1 \"myfile.c\"\nreturn\n#line 2 \"myfile.c\"\n 1;\n</code></pre>\n\n<p>Which it may shorten as</p>\n\n<pre><code>return\n 1;\n</code></pre>\n\n<p>Note that you can split any input line at any position with an escaped newline:</p>\n\n<pre><code>#inclu\\\nde &lt;st\\\ndio.h&gt;\\\n\n\"Hello word\\\\\nn\"\n\nfor (i = 0; i &lt; n; i+\\\n+)\n\nret\\\n\\\n\\\nurn;\n\n\\\nr\\\net\\\nurn\\\n123;\\\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 3, "last_activity_date": 1485964237, "last_edit_date": 1485964237, "creation_date": 1485868148, "answer_id": 41958463, "question_id": 41714992, "link": "https://stackoverflow.com/questions/41714992/joining-lines-in-c-strange-output-not-compatible-with-documentation/41958463#41958463", "title": "Joining lines in C [Strange output not compatible with documentation]", "body": "<p><code>-E</code> output is not officially specified by the standard.  It's an engineering tradeoff among several different design constraints, of which the relevant two are:</p>\n\n<ul>\n<li>whitespace must be inserted or deleted as necessary so that the \"compiler proper\" (imagine feeding the <code>-E</code> output back into <code>gcc -fpreprocessed</code> \u2014 which is what <code>-save-temps</code> does) sees the same sequence of <em>pp-tokens</em> that it would normally (without <code>-E</code>). (See C99 section 6.4 for the definition of a pp-token.)</li>\n<li>to the maximum extent possible, tokens should appear at the same line and column position that they did in the original source code, so that error messages and debugging information are as accurate as possible.</li>\n</ul>\n\n<p>Here's how this applies to your examples:</p>\n\n<pre><code>ret\\\nurn 0;\n</code></pre>\n\n<p>The backslash-newline combines <code>ret</code> and <code>urn</code> into a single pp-token, which must therefore appear all together on one line in the output.  The <code>0</code> and <code>;</code>, however, should continue to be on their original line and column so that diagnostics are accurate.  So you get</p>\n\n<pre><code>return\n    0;\n</code></pre>\n\n<p>with spaces inserted to keep the <code>0</code> in its original column.</p>\n\n<pre><code>ret\\\n   urn 0;\n</code></pre>\n\n<p>Here the backslash-newline is immediately followed by whitespace, so <code>ret</code> and <code>urn</code> do <em>not</em> have to be combined, so, again, the diagnostics are most accurate if everything stays where it originally was, and the output is</p>\n\n<pre><code>ret\n   urn 0;\n</code></pre>\n\n<p>which looks like the backslash-newline had no effect at all.</p>\n\n<p>You might find the output of <code>gcc -E -P</code> less surprising.  <code>-P</code> tells the preprocessor not to bother trying to preserve token position (and also turns off all those lines beginning with <code>#</code> in the output).  Your examples produce <code>return 0;</code> and <code>ret urn 0;</code>, both all on one line, in <code>-P</code> mode.</p>\n\n<p>Finally, a word of advice: everyone who ever has to read your code (and that includes yourself six months later) will appreciate it if you <em>never</em> split a token in the middle with backslash-newline, except for very long string literals.  It's a legacy misfeature that wouldn't be included in the language if it were designed from scratch today.</p>\n"}], "owner": {"reputation": 1361, "user_id": 7304770, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c7a710fcb5ccb500839c6e4819efb4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/7304770/sabrina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1485964237, "creation_date": 1484729829, "last_edit_date": 1484738572, "question_id": 41714992, "link": "https://stackoverflow.com/questions/41714992/joining-lines-in-c-strange-output-not-compatible-with-documentation", "title": "Joining lines in C [Strange output not compatible with documentation]", "body": "<p>I started coding <strong>C</strong> in vim and I have some problems.</p>\n\n<p>The backslash is intended to join lines but when I try to write:</p>\n\n<pre><code>ret\\\nurn 0;\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>return\n    0;\n</code></pre>\n\n<p>and when I add spaces before <code>urn;</code> it stay like that without join.</p>\n\n<pre><code>ret\\\n   urn 0;\n</code></pre>\n\n<p>it stay like that.</p>\n\n<p>why in the second case I don't get <code>return 0;</code> but</p>\n\n<pre><code>ret\n   urn 0;\n</code></pre>\n\n<p>code:\n<a href=\"https://i.stack.imgur.com/oFIEr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oFIEr.png\" alt=\"enter image description here\"></a></p>\n\n<p>CPP output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/odJcC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/odJcC.png\" alt=\"enter image description here\"></a></p>\n\n<p>command:</p>\n\n<pre><code>gcc -E -Wall -Wextra -Wimplicit -pedantic -std=c99 main.c -o output.i\n</code></pre>\n\n<p><strong><em>GCC 5.4, \nVim 7.4</em></strong></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1484728435, "post_id": 41714590, "comment_id": 70624023, "body": "Why don&#39;t you look at the generated assembly for both the version? Do you see any difference?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484728837, "post_id": 41714590, "comment_id": 70624263, "body": "Where do you allocate memory for <code>pqr* ptr2</code> to point at?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1484729257, "post_id": 41714590, "comment_id": 70624537, "body": "In how far might this be relevant for the answer?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484729597, "post_id": 41714590, "comment_id": 70624761, "body": "The answer is &quot;probably yes&quot;, but today&#39;s compilers are smart and they are really good at optimization, so maybe it won&#39;t make any difference. To be sure you need to look at the generated assembly code."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1484729660, "post_id": 41714590, "comment_id": 70624804, "body": "@Gerhardh If the pointer is accessed without being initialized or pointing at valid memory, then the code invokes undefined behavior. The compiler is then free to generate any form of machine code, or no machine code at all."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484730130, "post_id": 41714590, "comment_id": 70625058, "body": "This will possibly depend on your compiler settings. To prevent <a href=\"https://en.wikipedia.org/wiki/Pointer_aliasing\" rel=\"nofollow noreferrer\">aliasing problems</a>, conservative compiler settings might force it to read the value each time to make sure it hasn&#39;t changed in between."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484730227, "post_id": 41714590, "comment_id": 70625126, "body": "@Lundin: The question is about performance optimization. With only 1 line of actual code given it does not make much sense to talk about other topics."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484730353, "post_id": 41714590, "comment_id": 70625201, "body": "@Lousy There exists no aliasing problems here. <code>ptr</code> is of type <code>struct pqr *ptr</code> and so is <code>ptr1-&gt;ptr2</code>. Pointer aliasing has nothing to do with the compiler making assumptions about if a variable has been used or not. Sounds like you are mixing it up with the <code>volatile</code> keyword."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1484730584, "post_id": 41714590, "comment_id": 70625330, "body": "@Gerhardh My point is, if the compiler can deduct that <code>ptr1-&gt;ptr2</code> is uninitialized, it is free to complete ignore the whole code, or skip optimizations, or generate complete nonsense code, or crash and burn. It doesn&#39;t make sense to discuss optimization for code that invokes undefined behavior."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484730747, "post_id": 41714590, "comment_id": 70625430, "body": "@Lundin: here is an example, <a href=\"http://tasking.com/support/c166-classic/c166_v8.7.pdf\" rel=\"nofollow noreferrer\">Tasking C166 compiler</a>, page 4\u221298, section 4.6. Alias: <i>&quot;By default the compiler assumes that each pointer may point to any object created in the program, so when any pointer is dereferenced, all register contents are assumed to be invalid afterwards&quot;</i>. Example 3 on next page is a simple example of how this particular compiler can produce two different assemblies (and the <i>default</i> behavior is not to cache pointer values in registers)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484731314, "post_id": 41714590, "comment_id": 70625776, "body": "@Lousy That example does not have the slightest to do with this question."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484735319, "post_id": 41714590, "comment_id": 70628559, "body": "@Lundin, you are right. But this is only possible close to the location where the pointer is assigned. This would be some strict limitation to the relevance of the answer. For a more general answer the compiler cannot deduct this in most places."}], "answers": [{"tags": [], "owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": false, "score": -1, "last_activity_date": 1484730653, "last_edit_date": 1484730653, "creation_date": 1484728633, "answer_id": 41714670, "question_id": 41714590, "link": "https://stackoverflow.com/questions/41714590/c-code-optimization-query/41714670#41714670", "title": "C code optimization query", "body": "<p>I think it will help to reduce CPU cycles. <code>ptr</code> is pointer variable and <code>ptr1-&gt;ptr2</code> value cannot be calculated at compile time. At least the readability is better (with <code>ptr</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484728850, "post_id": 41714680, "comment_id": 70624272, "body": "It may be true for single line <code>ptr-&gt;b = 10;</code>. But if there are 2+ <code>ptr-&gt;XXX</code> below it will be different."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 2, "creation_date": 1484728888, "post_id": 41714680, "comment_id": 70624297, "body": "That may depend on whether the compiler can prove the absence of aliasing."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1484730051, "post_id": 41714680, "comment_id": 70625014, "body": "@i486 No, an optimizing compiler is smart enough to introduce temporary variables where needed."}], "tags": [], "owner": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "is_accepted": false, "score": 0, "last_activity_date": 1484728669, "creation_date": 1484728669, "answer_id": 41714680, "question_id": 41714590, "link": "https://stackoverflow.com/questions/41714590/c-code-optimization-query/41714680#41714680", "title": "C code optimization query", "body": "<p>On non optimized compilers, that will help. But in modern compilers, with optimization flags, you should not see the difference between the 2 syntaxes.</p>\n"}, {"comments": [{"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484730021, "post_id": 41714874, "comment_id": 70624996, "body": "Using slightly more conservative compiler flags (regarding strict aliasing) might easily force it to read the address on each access (at least my experience with embedded/microcontroller assembly)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484730174, "post_id": 41714874, "comment_id": 70625088, "body": "@Lousy Strict aliasing has nothing to do with this. All pointer types in the examples are compatible."}, {"owner": {"reputation": 2131, "user_id": 3726169, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ad0f33269912ab7a2fb9f30df6f2d392?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Chesterfield", "link": "https://stackoverflow.com/users/3726169/jon-chesterfield"}, "edited": false, "score": 0, "creation_date": 1484730451, "post_id": 41714874, "comment_id": 70625258, "body": "Aliasing could matter though. There could easily be two pointers to the same object in scope"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484730471, "post_id": 41714874, "comment_id": 70625270, "body": "@Lundin: it&#39;s not related to <i>strict</i> aliasing, I didn&#39;t express my self clearly enough, it&#39;s related to <a href=\"https://en.wikipedia.org/wiki/Pointer_aliasing\" rel=\"nofollow noreferrer\">pointer aliasing</a>. A different thread/interrupt can easily change the contents of <code>ptr2</code> during the execution of your example. The &quot;improvement in readability&quot; doesn&#39;t functionally equal code, as soon as your device has more than a single interrupt. For example, Tasking C166 compiler for microcontrollers assumes all registers to be invalid after each pointer dereference (unless you explicitly tell it to use relaxed caching)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484730982, "post_id": 41714874, "comment_id": 70625565, "body": "@Lousy Multi-threading/multi-processors is a different topic entirely. Introducing temporary variables will not improve nor break such code. The code <code>struct pqr *ptr = ptr1-&gt;ptr2;</code> does not necessarily mean that the compiler will de-reference that variable - it does not have to since it was not declared as <code>volatile</code>. It can optimize away the temporary variable <code>ptr</code> entirely since it can deduct that this variable is not used. Note that the <code>volatile</code> keyword can protect against optimizer mishaps, but does not necessarily guarantee memory barrier behavior."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484733433, "post_id": 41714874, "comment_id": 70627352, "body": "Here is a comparison of both codes <a href=\"https://godbolt.org/g/9h8Ho2\" rel=\"nofollow noreferrer\">gcc 6.3 -O3</a> and <a href=\"https://godbolt.org/g/e92cVu\" rel=\"nofollow noreferrer\">clang 3.9.1</a>."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1484729758, "last_edit_date": 1484729758, "creation_date": 1484729398, "answer_id": 41714874, "question_id": 41714590, "link": "https://stackoverflow.com/questions/41714590/c-code-optimization-query/41714874#41714874", "title": "C code optimization query", "body": "<p>No, such code will not improve performance. Any half-decent compiler will optimize away that temporary variable. Any of your versions will compile into machine code like the following:</p>\n\n<p>store ptr1->ptr2 in index register x<br>\n...<br>\ndo stuff with contents pointed at by index register x<br>\n...<br>\n// subsequent use of the same variable will use index register x</p>\n\n<hr>\n\n<p>Your temporary variable could however improve readability, if you are going to use that nested struct a lot in several expressions. Replacing code like </p>\n\n<pre><code>something-&gt;something-&gt;something-&gt;x = 5;\nif(something-&gt;something-&gt;something-&gt;x == something-&gt;something-&gt;something-&gt;y)\n  something-&gt;something-&gt;something-&gt;y = 42;\n</code></pre>\n\n<p>with </p>\n\n<pre><code>something_t* s = something-&gt;something-&gt;something;\ns-&gt;x = 5;\nif(s-&gt;x == s-&gt;y)\n  s-&gt;y = 42;\n</code></pre>\n\n<p>is quite an improvement of readability. But it will yield the very same machine code.</p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 3017124, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c997c34113ab4fdde0299b0e01b7dcb?s=128&d=identicon&r=PG&f=1", "display_name": "LML", "link": "https://stackoverflow.com/users/3017124/lml"}, "edited": false, "score": 0, "creation_date": 1484734075, "post_id": 41715154, "comment_id": 70627792, "body": "I dropped the memory allocation part to keep code fragment small. As I mentioned in the original post, there are several lines using ptr1-&gt;ptr2 deferencing, with ptr1-&gt;ptr2-&gt;b = 10 being just one sample line."}], "tags": [], "owner": {"reputation": 2131, "user_id": 3726169, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ad0f33269912ab7a2fb9f30df6f2d392?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Chesterfield", "link": "https://stackoverflow.com/users/3726169/jon-chesterfield"}, "is_accepted": false, "score": 1, "last_activity_date": 1484730335, "creation_date": 1484730335, "answer_id": 41715154, "question_id": 41714590, "link": "https://stackoverflow.com/questions/41714590/c-code-optimization-query/41715154#41715154", "title": "C code optimization query", "body": "<p>There's not enough code shown to tell.</p>\n\n<p>If it's all in one function it should make no difference. If you're passing two of the <code>struct pqr</code> into a function then cross function/module alias analysis becomes necessary to determine whether caching the pointer preserves the program semantics.</p>\n"}, {"comments": [{"owner": {"reputation": 543, "user_id": 5799892, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/549c8d3e3f2bb3041f24177a5fcdb031?s=128&d=identicon&r=PG&f=1", "display_name": "cdcdcd", "link": "https://stackoverflow.com/users/5799892/cdcdcd"}, "edited": false, "score": 0, "creation_date": 1484735624, "post_id": 41716453, "comment_id": 70628775, "body": "I upvoted, but it would be good to see the assembly with no optimisation."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 543, "user_id": 5799892, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/549c8d3e3f2bb3041f24177a5fcdb031?s=128&d=identicon&r=PG&f=1", "display_name": "cdcdcd", "link": "https://stackoverflow.com/users/5799892/cdcdcd"}, "edited": false, "score": 0, "creation_date": 1484749426, "post_id": 41716453, "comment_id": 70638250, "body": "@cdcdcd: check the links from the answer (Compiler Explorer: <a href=\"https://godbolt.org/g/9h8Ho2\" rel=\"nofollow noreferrer\">GCC</a>, <a href=\"https://godbolt.org/g/e92cVu\" rel=\"nofollow noreferrer\">Clang</a>) and clear the text box next to the compiler drop down box. In all cases I&#39;ve checked <code>testA</code> accesses <code>ptr1</code> three times, and <code>testB</code> only once."}, {"owner": {"reputation": 543, "user_id": 5799892, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/549c8d3e3f2bb3041f24177a5fcdb031?s=128&d=identicon&r=PG&f=1", "display_name": "cdcdcd", "link": "https://stackoverflow.com/users/5799892/cdcdcd"}, "edited": false, "score": 0, "creation_date": 1484755947, "post_id": 41716453, "comment_id": 70643025, "body": "Sorry Lousy being lazy. Thanks,"}], "tags": [], "owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "is_accepted": false, "score": 1, "last_activity_date": 1484733989, "creation_date": 1484733989, "answer_id": 41716453, "question_id": 41714590, "link": "https://stackoverflow.com/questions/41714590/c-code-optimization-query/41716453#41716453", "title": "C code optimization query", "body": "<p>This depends on the compiler, but several known compilers <em>will</em> benefit from this explicit optimization in your code.</p>\n\n<p>For this example code:</p>\n\n<pre><code>int getValue() {\n  return rand();\n}\n\nvoid testA() {\n  ptr1-&gt;ptr2-&gt;b = getValue();\n  ptr1-&gt;ptr2-&gt;b = getValue();\n  ptr1-&gt;ptr2-&gt;b = getValue();\n}\n\nvoid testB() {\n  struct pqr *ptr2 = ptr1-&gt;ptr2;\n  ptr2-&gt;b = getValue();\n  ptr2-&gt;b = getValue();\n  ptr2-&gt;b = getValue();\n}\n</code></pre>\n\n<p>Both <a href=\"https://godbolt.org/g/9h8Ho2\" rel=\"nofollow noreferrer\">GCC 6.3</a> and <a href=\"https://godbolt.org/g/e92cVu\" rel=\"nofollow noreferrer\">Clang 3.9.1</a> with -O3 will produce assembly similar to this:</p>\n\n<pre><code>testA():\n        mov     rax, QWORD PTR ptr1[rip]\n        mov     rbx, QWORD PTR [rax+8] // load\n        call    rand            \n        mov     DWORD PTR [rbx], eax   // store\n\n        mov     rax, QWORD PTR ptr1[rip]\n        mov     rbx, QWORD PTR [rax+8]  // load\n        call    rand            \n        mov     DWORD PTR [rbx], eax  // store\n\n        mov     rax, QWORD PTR ptr1[rip]\n        mov     rbx, QWORD PTR [rax+8]  // load\n        call    rand            \n        mov     DWORD PTR [rbx], eax  // store\n\n\ntestB():\n        mov     rax, QWORD PTR ptr1[rip]\n        mov     rbx, QWORD PTR [rax+8]   // load\n\n        call    rand\n        mov     DWORD PTR [rbx], eax  // store\n\n        call    rand\n        mov     DWORD PTR [rbx], eax  // store\n\n        call    rand\n        mov     DWORD PTR [rbx], eax  // store\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 5799892, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/549c8d3e3f2bb3041f24177a5fcdb031?s=128&d=identicon&r=PG&f=1", "display_name": "cdcdcd", "link": "https://stackoverflow.com/users/5799892/cdcdcd"}, "is_accepted": false, "score": 0, "last_activity_date": 1484735747, "last_edit_date": 1484735747, "creation_date": 1484735352, "answer_id": 41716936, "question_id": 41714590, "link": "https://stackoverflow.com/questions/41714590/c-code-optimization-query/41716936#41716936", "title": "C code optimization query", "body": "<p>How many instructions a compiler will output, for the case you've presented, will depend on the degree of optimisation (but here you assume none?), how smart your compiler is and the type of processor (CISC or RISC for example). As you can tell there are just too many variables to get an answer here. You'll need to disassemble and see if different version of your code produces compilations with more or less instructions (and for the offending lines of code only).</p>\n\n<p>But generally in the past, advice was always that any form of \"indirection\" should be avoided if you were doing it inside a loop or within a function that was being called from within a loop. The reason is that the compiler may implement a number of operations in order to resolve indirection - so even if it mightn't look like your strictly dereferencing a pointer in C code, the compiler will produce assembly that will do - if you wish to use any of a structures members that is. Therefore, in your case it will need to resolve two levels of indirection rather than one (the alternative: ptr->b). </p>\n"}], "owner": {"reputation": 151, "user_id": 3017124, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9c997c34113ab4fdde0299b0e01b7dcb?s=128&d=identicon&r=PG&f=1", "display_name": "LML", "link": "https://stackoverflow.com/users/3017124/lml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1484735747, "creation_date": 1484728375, "question_id": 41714590, "link": "https://stackoverflow.com/questions/41714590/c-code-optimization-query", "title": "C code optimization query", "body": "<p>I've a question about following C code.</p>\n\n<pre><code>struct pqr {\n  int b;\n};\n\nstruct abc {\n  int a;\n  struct pqr * ptr2;\n};\n\nstruct abc *ptr1;\n\nptr1-&gt;ptr2-&gt;b = 10;\n</code></pre>\n\n<p>Now if I have several lines of code with ptr1->ptr2 dereferencing in a function,\nwill the following code change help reduce CPU cyles ?</p>\n\n<pre><code>   struct pqr *ptr = ptr1-&gt;ptr2;\n\n   ptr-&gt;b = 10;\n</code></pre>\n"}, {"tags": ["c++", "c", "api", "rdp"], "comments": [{"owner": {"reputation": 1243, "user_id": 1129815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lROzF.jpg?s=128&g=1", "display_name": "Steeve", "link": "https://stackoverflow.com/users/1129815/steeve"}, "edited": false, "score": 1, "creation_date": 1484727577, "post_id": 41714320, "comment_id": 70623486, "body": "Please provide more details (what&#39;s an RDP file?) Give us a code sample of what you have tried. Also, read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> on SO."}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "reply_to_user": {"reputation": 1243, "user_id": 1129815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lROzF.jpg?s=128&g=1", "display_name": "Steeve", "link": "https://stackoverflow.com/users/1129815/steeve"}, "edited": false, "score": 0, "creation_date": 1484727684, "post_id": 41714320, "comment_id": 70623558, "body": "RDP file is a file like json, sql, txt, ... there is no need to say <code>what&#39;s an RDP file?</code>"}, {"owner": {"reputation": 1243, "user_id": 1129815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lROzF.jpg?s=128&g=1", "display_name": "Steeve", "link": "https://stackoverflow.com/users/1129815/steeve"}, "edited": false, "score": 0, "creation_date": 1484727819, "post_id": 41714320, "comment_id": 70623662, "body": "I mean, what format is it? What does it contain? What is your expected output when reading?"}, {"owner": {"reputation": 922, "user_id": 5991102, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh4.googleusercontent.com/-82TFHov0JE0/AAAAAAAAAAI/AAAAAAAAADc/QHywlTFF-Uo/photo.jpg?sz=128", "display_name": "pSoLT", "link": "https://stackoverflow.com/users/5991102/psolt"}, "edited": false, "score": 4, "creation_date": 1484727854, "post_id": 41714320, "comment_id": 70623683, "body": "@joe There is a difference between reading text files and binary files. Also, you use different tools for specific files like xmls, jsons etc. So there is need to say whats and <code>.RDP</code> file. And it&#39;s  good idea to give answers to questions asked in comments, as they are asked by people who try to solve your problem."}, {"owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "edited": false, "score": 0, "creation_date": 1484728028, "post_id": 41714320, "comment_id": 70623777, "body": "Also, define &#39;true output&#39;, what are you expecting to get? Do you really need to just &#39;read&#39; the file, or also &#39;parse&#39; its content into some kind of structured data?"}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "edited": false, "score": 0, "creation_date": 1484728049, "post_id": 41714320, "comment_id": 70623791, "body": "I know jsons, xmls, .... but I want some body who know the rdp file"}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "edited": false, "score": 0, "creation_date": 1484728094, "post_id": 41714320, "comment_id": 70623807, "body": "this is the <a href=\"https://msdn.microsoft.com/en-us/library/gg156129(v=winembedded.70).aspx\" rel=\"nofollow noreferrer\">rdp file format</a>"}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484728352, "post_id": 41714320, "comment_id": 70623963, "body": "@MichaelWalz I know this, but I can&#39;t get the content of the file with readfile"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484728433, "post_id": 41714320, "comment_id": 70624020, "body": "@joe please show more code. It&#39;s hard for us to spot errors in code that we can&#39;t see."}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484728774, "post_id": 41714320, "comment_id": 70624225, "body": "no @MichaelWalz, I can read any file, but the problem is a rdp file..., and the code is the whole code, it&#39;s may main() content"}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "reply_to_user": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "edited": false, "score": 0, "creation_date": 1484728871, "post_id": 41714320, "comment_id": 70624283, "body": "@roalz I want to read it and the parse the content"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484729399, "post_id": 41714320, "comment_id": 70624630, "body": "@joe please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484730251, "post_id": 41714320, "comment_id": 70625144, "body": "@MichaelWalz Why don&#39;t you believe, thats my whole code, I edit my question again and put all the main.cpp content"}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484732181, "post_id": 41714320, "comment_id": 70626418, "body": "With the provided source code, what your debugger is showing to say &quot; doesn&#39;t have the true output&quot; ? Are the conditions &quot;<code>if (hndlRead != INVALID_HANDLE_VALUE)</code>&quot; and the &quot;<code>if (szReadBuffer != NULL)</code>&quot; equal to &quot;True&quot; ?"}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "reply_to_user": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484732382, "post_id": 41714320, "comment_id": 70626576, "body": "@J.Piquard Yes, they are true and ReadFile returns true too, but szReadBuffer isn&#39;t equals to the file content"}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484732963, "post_id": 41714320, "comment_id": 70626993, "body": "@joe, you are using <code>CHAR* szReadBuffer;</code> to read a Binary file. Your buffer should be declared as <code>BYTE* szReadBuffer;</code> and check the <code>nb</code> returned value to verify if all the file has been loaded."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484733397, "post_id": 41714320, "comment_id": 70627319, "body": "Why you are allocating twice the size of the buffer <code>HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, (fileSize)*2);</code> replace <code>&#39;*2);&#39;</code> by <code>&#39;*sizeof(BYTE));&#39;</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484734007, "post_id": 41714320, "comment_id": 70627754, "body": "@joe I&#39;didn&#39;t believe that it was youw whole code, because it wasn&#39;t. Now after your edit it is and now we can have a look."}, {"owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "edited": false, "score": 0, "creation_date": 1484735116, "post_id": 41714320, "comment_id": 70628443, "body": "I add Two Image in my question, please look at them"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 0, "last_activity_date": 1484736411, "last_edit_date": 1484736411, "creation_date": 1484735277, "answer_id": 41716908, "question_id": 41714320, "link": "https://stackoverflow.com/questions/41714320/how-to-read-a-file-with-unicode-contents/41716908#41716908", "title": "How to read a file with Unicode contents", "body": "<p>Your code works fine. It reads the rdp file verbatim into memory.</p>\n\n<p>You are troubled by the <a href=\"https://en.wikipedia.org/wiki/Byte_order_mark\" rel=\"nofollow noreferrer\">BOM (byte order mark)</a> at the beginning of the rdp file.</p>\n\n<p>If you look at the rdp file with text editor (notepad for instance) you will see this:</p>\n\n<pre><code>screen mode id:i:2\nuse multimon:i:0\ndesktopwidth:i:2560\ndesktopheight:i:1600\n....\n</code></pre>\n\n<p>If you look at the rdp file with a hexadecimal editor you will see this:</p>\n\n<pre><code>0000 FFFE 7300 6300 7200 6500 6500 6E00 2000 ..s.c.r.e.e.n. .\n0008 6D00 6F00 6400 6500 2000 6900 6400 3A00 m.o.d.e. .i.d...\n....\n</code></pre>\n\n<p><code>FFFE</code> is the byte order mark which indicates that the file is a text file encoded in little endian UNICODE, so each character takes 2 bytes instead of 1 byte.</p>\n\n<p>Once the file read in memory you will get this (0x00318479 being the address <code>szReadBuffer</code> points to):</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vkw8l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vkw8l.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>BTW 1: you should call <code>CloseHandle(hndlRead)</code> once the file has been read.</li>\n<li>BTW 2: you should'nt use <code>HeapAlloc</code> but rather <code>malloc</code> or <code>calloc</code>.</li>\n</ul>\n\n<p>Corrected program:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nint main()\n{\n  HANDLE hndlRead;\n\n  WCHAR* szReadBuffer;   // WCHAR instead of CHAR\n  INT fileSize;\n\n  hndlRead = CreateFileW(L\"rdp.RDP\", GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n\n  if (hndlRead != INVALID_HANDLE_VALUE)\n  {\n    fileSize = GetFileSize(hndlRead, NULL);\n    szReadBuffer = (WCHAR*)calloc(fileSize + sizeof(WCHAR), 1);  // + sizeof(WCHAR) for NUL string terminator\n    DWORD nb = 0;\n    int nSize = fileSize;\n    if (szReadBuffer != NULL)\n    {\n      ReadFile(hndlRead, szReadBuffer, nSize, &amp;nb, NULL);\n    }\n\n    CloseHandle(hndlRead);   // close what we have opened\n\n    WCHAR *textwithoutbom = szReadBuffer + 1;  // skip BOM\n\n    // put breakpoint here and inspect textwithoutbom\n\n    free(szReadBuffer);  // free what we have allocated\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "is_accepted": false, "score": 0, "last_activity_date": 1484736564, "creation_date": 1484736564, "answer_id": 41717383, "question_id": 41714320, "link": "https://stackoverflow.com/questions/41714320/how-to-read-a-file-with-unicode-contents/41717383#41717383", "title": "How to read a file with Unicode contents", "body": "<p>As suggests @MickaelWalz, the file format of the RDP file is now Unicode.</p>\n\n<p>Here is a way to read and display the content of that file:</p>\n\n<blockquote>\n  <ul>\n  <li>Use <code>wchar_t *</code> buffer instad of <code>CHAR *</code> or <code>BYTE *</code> buffer. </li>\n  <li>Check if the <code>ReadFile()</code> has been successfully performed <code>bRet == True</code> and <code>nSize == nb</code>.</li>\n  <li>Start to the second WCHAR to exclude the 0xFFFE Unicode identifier.</li>\n  <li>Don't forget to close your file <code>CloseHandle(hndlRead);</code> !</li>\n  </ul>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n\nint main()\n{\n    HANDLE hndlRead;\n    OVERLAPPED ol = {0};\n\n    //BYTE* szReadBuffer;\n    INT fileSize;\n    wchar_t *szReadBuffer;\n\n    hndlRead = CreateFileW(L\"rdp.RDP\", GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n\n    if (hndlRead != INVALID_HANDLE_VALUE)\n    {\n        fileSize = GetFileSize(hndlRead, NULL);\n        szReadBuffer = (wchar_t *) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, (fileSize)*sizeof(wchar_t));\n        DWORD nb=0;\n        int nSize=fileSize;\n        BOOL bRet;\n        if (szReadBuffer != NULL)\n        {\n            bRet = ReadFile(hndlRead, szReadBuffer, nSize, &amp;nb, &amp;ol);\n            if ((bRet) &amp;&amp; (nb == nSize)) {\n                printf(\"%02X,%02X... %02X\\n\",szReadBuffer[0],szReadBuffer[1],szReadBuffer[nb-1]);\n                std::wcout &lt;&lt; L\"info \" &lt;&lt; (szReadBuffer+1) &lt;&lt; L\" \" &lt;&lt; nb &lt;&lt; std::endl;\n            }\n        }\n        CloseHandle(hndlRead);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7393003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baac75689f5f993df610bba5f25e914?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/7393003/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 41716908, "answer_count": 2, "score": 0, "last_activity_date": 1484975853, "creation_date": 1484727400, "last_edit_date": 1484975853, "question_id": 41714320, "link": "https://stackoverflow.com/questions/41714320/how-to-read-a-file-with-unicode-contents", "title": "How to read a file with Unicode contents", "body": "<p>How can I read a file with Unicode contents using C/C++?</p>\n\n<p>I used ReadFile function to read a file with Unicode contents, but it doesn't have the true output. <strong>I want to have a buffer that contains all the contents of the file</strong></p>\n\n<p>I use this code:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nint main()\n{\n    HANDLE hndlRead;\n    OVERLAPPED ol = {0};\n\n    CHAR* szReadBuffer;\n    INT fileSize;\n\n    hndlRead = CreateFileW(L\"file\", GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n\n    if (hndlRead != INVALID_HANDLE_VALUE)\n    {\n        fileSize = GetFileSize(hndlRead, NULL);\n        szReadBuffer = (CHAR*) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, (fileSize)*2);\n        DWORD nb=0;\n        int nSize=fileSize;\n        if (szReadBuffer != NULL)\n        {\n            ReadFile(hndlRead, szReadBuffer, nSize, &amp;nb, &amp;ol);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Is there any way to read this file correctly?</p>\n\n<p>This is nb and szReadBuffer:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tNYuo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tNYuo.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is my file content in notpad++:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5bFmw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5bFmw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 1699, "user_id": 4891815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/niZw9.jpg?s=128&g=1", "display_name": "Gnqz", "link": "https://stackoverflow.com/users/4891815/gnqz"}, "edited": false, "score": 0, "creation_date": 1484728435, "post_id": 41714227, "comment_id": 70624024, "body": "Why don&#39;t you just use scanf() instead?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1484731058, "post_id": 41714227, "comment_id": 70625607, "body": "Shouldn&#39;t it be <code>do {...} while (height &lt; 0 || height &gt; 23);</code>? You want to ask the height again if the user input a value outside the boundaries, I presume. Also, does &#39;get_int&#39; manage the cases where the user enters something other the <code>int</code>s?"}, {"owner": {"reputation": 43, "user_id": 7352966, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7B5MWNLUzGA/AAAAAAAAAAI/AAAAAAAAHfU/wU1Z6v_9RJE/photo.jpg?sz=128", "display_name": "Chun Hong Huang", "link": "https://stackoverflow.com/users/7352966/chun-hong-huang"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1484731801, "post_id": 41714227, "comment_id": 70626133, "body": "@Bob__ Thanks so much, you got the point. I should set the inequality more carefully, or, it will be like an infinite loop."}], "answers": [{"tags": [], "owner": {"reputation": 429, "user_id": 5738730, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512490685748177/picture?type=large", "display_name": "Sanjay-sopho", "link": "https://stackoverflow.com/users/5738730/sanjay-sopho"}, "is_accepted": false, "score": 1, "last_activity_date": 1484744439, "creation_date": 1484744439, "answer_id": 41720124, "question_id": 41714227, "link": "https://stackoverflow.com/questions/41714227/c-cs50-pset1-mario-pyramid-challenge/41720124#41720124", "title": "C - CS50 pset1 Mario Pyramid challenge", "body": "<p>Here, in the do while loop you are giving the condition that loop should continue whatever you put the height because every number is either <code>&gt;=0</code> or <code>&lt;=23</code>. </p>\n\n<p>Instead change the condition to <code>while(height&lt;0||height&gt;23)</code></p>\n"}], "owner": {"reputation": 43, "user_id": 7352966, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7B5MWNLUzGA/AAAAAAAAAAI/AAAAAAAAHfU/wU1Z6v_9RJE/photo.jpg?sz=128", "display_name": "Chun Hong Huang", "link": "https://stackoverflow.com/users/7352966/chun-hong-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1587392360, "creation_date": 1484727045, "last_edit_date": 1490003987, "question_id": 41714227, "link": "https://stackoverflow.com/questions/41714227/c-cs50-pset1-mario-pyramid-challenge", "title": "C - CS50 pset1 Mario Pyramid challenge", "body": "<p>I've googled and read posts on stacks, but still don't know where my codes goes wrong on this problem set... it just keep asking typing \"height\". After typed height in, it doesn't go to next step, seems to stuck in an infinite loop.</p>\n\n<p>Brain melting.</p>\n\n<p>Please help to point out where my codes goes wrong. Thx a lot.</p>\n\n<pre><code> #include &lt;cs50.h&gt;\n #include &lt;stdio.h&gt;\n\n int main(void)\n {\n     int height;\n     do\n     {\n        printf (\"height: \");\n        height = get_int();\n     }        \n     while (height &gt;= 0 || height &lt;= 23);\n\n     for (int loop = 0; loop &lt;= height; loop++)\n     {\n         for (int space = height - 1 - loop; space &gt; 0; space--)\n             printf(\"  \");\n\n\n         for (int hash = 2 + loop; hash &lt; height; hash++)\n             printf(\"#\");\n\n         printf(\"\\n\");\n     }\n }\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct", "dynamic-allocation"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484726947, "post_id": 41714124, "comment_id": 70623133, "body": "I recommend you read <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">this discussion about casting the result of <code>malloc</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1484727232, "last_edit_date": 1484727232, "creation_date": 1484726920, "answer_id": 41714191, "question_id": 41714124, "link": "https://stackoverflow.com/questions/41714124/how-to-store-data-in-a-dynamic-array-of-structs/41714191#41714191", "title": "How to store data in a dynamic array of structs?", "body": "<p>The problem is this:</p>\n\n<pre><code>entry = map-&gt;entries[map-&gt;guard++];\n</code></pre>\n\n<p>Here you <strong><em>copy</em></strong> the data from the array into the <code>entry</code> structure instance. Then you modify the data of <code>entry</code> and discard those modifications. The (original) structure data in the array is still unmodified.</p>\n\n<p>That will of course lead to <em>undefined behavior</em> when you in the next call to <code>map_put</code> use the uninitialized structures in the array.</p>\n\n<p>Either modify the array structure instance directly and increase <code>map-&gt;guard</code> separately. Or make <code>entry</code> a <em>pointer</em> and make it point to the array element.</p>\n"}, {"tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 1, "last_activity_date": 1484727370, "creation_date": 1484727370, "answer_id": 41714313, "question_id": 41714124, "link": "https://stackoverflow.com/questions/41714124/how-to-store-data-in-a-dynamic-array-of-structs/41714313#41714313", "title": "How to store data in a dynamic array of structs?", "body": "<p>The problem is that variable <code>entry</code> in <code>map_put</code> is not a pointer. It is a structure. So the code</p>\n\n<pre><code>entry = map-&gt;entries[map-&gt;guard++];\nentry.name = name;\nentry.number = nr;\n</code></pre>\n\n<p>copies the contents of <code>map-&gt;entries[map-&gt;guard]</code> into <code>entry</code>. Then you update the fields in <code>entry</code> and return from the function.</p>\n\n<p>The correct code looks like this</p>\n\n<pre><code>int map_put(Map *map, const char *name, int nr) {\n    Entry *entry;  // &lt;-- entry is a pointer\n    int i = 0;\n\n    for (i = 0; i &lt; map-&gt;guard; ++i) {\n        entry = &amp;map-&gt;entries[i];\n        printf(\"entry (  x , %u) at %p (%p)\\n\", entry-&gt;number, (void *)entry, (void *)entry-&gt;name);\n\n        if (!strcmp(entry-&gt;name, name))\n            return 0;\n    }\n\n    entry = &amp;map-&gt;entries[map-&gt;guard++];\n    entry-&gt;name = name;\n    entry-&gt;number = nr;\n\n    printf(\"entry (%s, %u) at %p (%p)\\n\", entry-&gt;name, entry-&gt;number, (void *)entry, (void *)entry-&gt;name);\n\n    return 1;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1484727857, "creation_date": 1484727857, "answer_id": 41714449, "question_id": 41714124, "link": "https://stackoverflow.com/questions/41714124/how-to-store-data-in-a-dynamic-array-of-structs/41714449#41714449", "title": "How to store data in a dynamic array of structs?", "body": "<p>You have a major problem in <code>map_put</code>. You use a local <code>Entry</code>, in which you <em>copy</em> entries from the map. But when you later assign value to the local copy, the original entries from the map are left unchanged.</p>\n\n<p>So when you later try to compare the new name to the existing entry, you are comparing it to uninitialized values, which is Undefined Behaviour.</p>\n\n<p>You should use an <code>Entry *</code> instead: </p>\n\n<pre><code>int map_put(Map *map, const char *name, int nr) {\n    Entry *entry;\n    int i = 0;\n\n    for (i = 0; i &lt; map-&gt;guard; ++i) {\n        entry = map-&gt;entries + i;\n        printf(\"entry (  x , %u) at %p (%p)\\n\", entry-&gt;number, entry, entry-&gt;name);\n\n        if (!strcmp(entry-&gt;name, name))        // Segmentation fault here\n            return 0;\n    }\n\n    entry = &amp;map-&gt;entries[map-&gt;guard++];\n    entry-&gt;name = name;\n    entry-&gt;number = nr;\n\n    printf(\"entry (%s, %u) at %p (%p)\\n\", entry-&gt;name, entry-&gt;number, entry, entry-&gt;name);\n\n    return 1;\n}\n</code></pre>\n\n<p>But that is not all. You just store the address of a string in name. It is fine in this example, because you are actually passing string litteral constants. But if you read strings from standard input or a file, the content of the buffer will be overwritten with each new value. As you only store the address, you will end with all entries pointing to same value: the last one.</p>\n\n<p>IMHO you should comtemplate using <code>strdup</code> to store copies of the string - and free them at the end. BTW, as you have an init function to initialize you <code>Map</code>, you should build a cleanup one to have all necessary free in one single place.</p>\n"}], "owner": {"reputation": 2648, "user_id": 4375377, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/H6Fa4.png?s=128&g=1", "display_name": "Mr Tsjolder", "link": "https://stackoverflow.com/users/4375377/mr-tsjolder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 41714191, "answer_count": 3, "score": 2, "last_activity_date": 1484727857, "creation_date": 1484726685, "question_id": 41714124, "link": "https://stackoverflow.com/questions/41714124/how-to-store-data-in-a-dynamic-array-of-structs", "title": "How to store data in a dynamic array of structs?", "body": "<p>I have these structs with which I would like to implement a map</p>\n\n<pre><code>typedef struct {\n    const char *name;\n    int number;\n}   Entry;\n\ntypedef struct {\n    int available;\n    int guard;\n    Entry *entries;\n} Map;\n</code></pre>\n\n<p>and code to work to initialise and put elements in it:</p>\n\n<pre><code>Map *map_init() {\n    Map *res = (Map *) malloc(sizeof(Map));\n\n    res-&gt;available = 4;\n    res-&gt;guard = 0;\n    res-&gt;entries = (Entry *) malloc(4 * sizeof(Entry));\n\n    return res;\n}\n\nint map_put(Map *map, const char *name, int nr) {\n    Entry entry;\n    int i = 0;\n\n    for (i = 0; i &lt; map-&gt;guard; ++i) {\n        entry = map-&gt;entries[i];\n        printf(\"entry (  x , %u) at %p (%p)\\n\", entry.number, &amp;entry, entry.name);\n\n        if (!strcmp(entry.name, name))        // Segmentation fault here\n            return 0;\n    }\n\n    entry = map-&gt;entries[map-&gt;guard++];\n    entry.name = name;\n    entry.number = nr;\n\n    printf(\"entry (%s, %u) at %p (%p)\\n\", entry.name, entry.number, &amp;entry, entry.name);\n\n    return 1;\n}\n</code></pre>\n\n<p>when I run my main method</p>\n\n<pre><code>int main(int argc, char **argv) {\n    printf(\"Initialising...\\n\");\n    Map *map = map_init();\n\n    printf(\"Putting...\\n\");\n    map_put(map, \"test\", 2);\n    map_put(map, \"some\", 1);\n\n    // ...\n\n    free(map-&gt;entries);\n    free(map);\n    return 0;\n}\n</code></pre>\n\n<p>I get as output</p>\n\n<pre><code>Initialising...\nPutting...\nentry (test, 2) at 0x7fff50b32a90 (0x10f0cdf77)\nentry (  x , 0) at 0x7fff50b32a90 (0x5000000000000000)\nSegmentation fault: 11\n</code></pre>\n\n<p>from which I could derive that the segmentation fault is due to the fact that <code>entry.name</code> does not point to a string anymore (also the number is lost, but this does not lead to unauthorised memory access). After I set the data in the first invocation of <code>map_put</code>, everything seems to be stored in the correct places. </p>\n\n<p>Anyone an idea where these entries could be overwritten or why the values are not stored?</p>\n"}, {"tags": ["c", "text", "graphics", "polymorphism", "pic"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484726369, "post_id": 41713857, "comment_id": 70622837, "body": "Text base decision making aside. Is the person a <b>former developer</b> because they never heard of functions?"}, {"owner": {"reputation": 3, "user_id": 7434237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936818eb1f2d6d3c1d505efa095e89b?s=128&d=identicon&r=PG&f=1", "display_name": "Tsoof Avtaby", "link": "https://stackoverflow.com/users/7434237/tsoof-avtaby"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484727531, "post_id": 41713857, "comment_id": 70623456, "body": "Functions were in use, function pointers wasn&#39;t..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484727609, "post_id": 41713857, "comment_id": 70623512, "body": "When I read <code>**SAME** actions with only minor changes depending on the language selected.</code> I see <code>Something that could have been extracted to another function with some control flags</code>."}, {"owner": {"reputation": 3, "user_id": 7434237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936818eb1f2d6d3c1d505efa095e89b?s=128&d=identicon&r=PG&f=1", "display_name": "Tsoof Avtaby", "link": "https://stackoverflow.com/users/7434237/tsoof-avtaby"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484728995, "post_id": 41713857, "comment_id": 70624381, "body": "I agree on that, So if for the example that I gave (which I modified a little to provide more info)  A better implementation would be to use a flag, and that is how I&#39;ve done that so far.  But that still seems a bit overhead.  As &quot;DYZ&quot; recommended maybe function pointers are the way."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7434237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936818eb1f2d6d3c1d505efa095e89b?s=128&d=identicon&r=PG&f=1", "display_name": "Tsoof Avtaby", "link": "https://stackoverflow.com/users/7434237/tsoof-avtaby"}, "edited": false, "score": 0, "creation_date": 1484729459, "post_id": 41713943, "comment_id": 70624675, "body": "Thanks, that does seem to be a good approach. I will try to figure out how to implement it in my project."}], "tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": true, "score": 0, "last_activity_date": 1484726030, "creation_date": 1484726030, "answer_id": 41713943, "question_id": 41713857, "link": "https://stackoverflow.com/questions/41713857/text-language-based-decision-making/41713943#41713943", "title": "Text language based decision making", "body": "<p>I would go for an array of language/action structures, then search the array for the language in question, and execute the associated action:</p>\n\n<pre><code>typedef struct {\n  char *lang;\n  void (*action)();\n} action_t;\n\naction_t actions[] = {{\"en\", func1}, {\"de\", func2}, ...};\n...\nfor(int i = 0; i &lt; sizeof(actions)/sizeof(actions[0]); i++)\n  if(!strcmp(actions[i].lang, language)) {\n    actions[i].action();\n    break;\n  }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7434237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936818eb1f2d6d3c1d505efa095e89b?s=128&d=identicon&r=PG&f=1", "display_name": "Tsoof Avtaby", "link": "https://stackoverflow.com/users/7434237/tsoof-avtaby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 41713943, "answer_count": 1, "score": 0, "last_activity_date": 1484727982, "creation_date": 1484725647, "last_edit_date": 1484727982, "question_id": 41713857, "link": "https://stackoverflow.com/questions/41713857/text-language-based-decision-making", "title": "Text language based decision making", "body": "<p>I am currently developing with MPLAB X (IDE) on PIC32 platforms using C programming language.</p>\n\n<p>I have a MAJOR project coming up which includes displaying graphics and text on a TFT screen.\nWe develop our systems for multiple languages ,including languages written \"right to left\" &amp; \"left to right\".\nSo some symbols also change their position, and texts change their alignments on the screen.</p>\n\n<p>So far Iv'e seen my former developer implement the code in a way that every screen displayed, or every object presented on the screen is tested for the language selected and then takes actions accordingly.</p>\n\n<p>e.g:</p>\n\n<pre><code>/**Some actions shared by all the languages**/\n.\n.\n/* language specific actions: */\nif(language == lang1){\n  .\n  .\n  /* Performs some actions */ \n  /* e.g: */ \n  displayText(txt, LEFT_ALIGNED);\n  .\n  .\n} else if(language == lang2){\n  .\n  .\n  /**SAME** actions with only minor changes depending on the language selected. */\n  /* e.g: */ \n  displayText(txt, RIGHT_ALIGNED);\n  .\n  .\n} else if.... (and so on)\n</code></pre>\n\n<p>As you can see, it seems quite an overhead, and the code this way has a lot of superfluous code duplication, especially when this structure is repeated inside almost every function/source file.</p>\n\n<p>I am trying to think of an approach for developing more of a \"polymorphic\" structure that would not require so many \"if else\" statements. </p>\n\n<p>I tried to search the internet for some examples implementing text based decision making, but was unable to find what I need, mostly due to the fact that I find it hard to describe my question.</p>\n\n<p>I hope this is not somewhat a vague question,\nbut is there any structural consensus for implementing this kind of situations?</p>\n\n<p>Many Thanks,\nTsoof A.</p>\n"}, {"tags": ["c", "segmentation-fault", "hashtable", "glib"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1484725558, "post_id": 41713657, "comment_id": 70622474, "body": "have you tried using valgrind or a debugger like gdb? are you sure you are linking with the right library?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484725720, "post_id": 41713657, "comment_id": 70622553, "body": "random idea try <code>GHashTable* HT = g_hash_table_new(&amp;g_int_hash, &amp;g_int_equal);</code>"}, {"owner": {"reputation": 311, "user_id": 7260372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-iyMoXomspnc/AAAAAAAAAAI/AAAAAAAAADg/E69qbcWFWUU/photo.jpg?sz=128", "display_name": "Amninder Singh", "link": "https://stackoverflow.com/users/7260372/amninder-singh"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1484725935, "post_id": 41713657, "comment_id": 70622650, "body": "@bruceg yes, infact, the segmentation fault is spotted by the gdb itself"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1484728351, "post_id": 41713657, "comment_id": 70623961, "body": "Fyi, as you&#39;re using it, both the keys <i>and</i> the values stored in your hash table should be independently memory managed from all other keys and values. You&#39;re storing the <i>same</i> address for each key, and the same address for each value. As you change the values stored at those addresses, the data in the table is corrupted. In short, you&#39;re violating the requirements of the pointer abstraction the GHashTable modus operandi mandates."}], "owner": {"reputation": 311, "user_id": 7260372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-iyMoXomspnc/AAAAAAAAAAI/AAAAAAAAADg/E69qbcWFWUU/photo.jpg?sz=128", "display_name": "Amninder Singh", "link": "https://stackoverflow.com/users/7260372/amninder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484724746, "creation_date": 1484724746, "question_id": 41713657, "link": "https://stackoverflow.com/questions/41713657/segmentation-fault-in-the-pre-defined-element-g-int-hash", "title": "Segmentation Fault in the pre-defined element g_int_hash", "body": "<p>I am using GHashTable in my program to store strings from the files that the user inputs. \nNo error is coming except a Segmentation fault in the line </p>\n\n<p><code>GHashTable* HT = g_hash_table_new(g_int_hash, g_int_equal);</code></p>\n\n<p>I have never seen a segmentation fault in a pre-defined element g_int_hash\nError: Program received signal SIGSEGV, Segmentation fault.\n0x0000003f2ec74b70 in g_int_hash () from /lib64/libglib-2.0.so.0</p>\n\n<p>My main file </p>\n\n<pre><code>#include &lt;cmdheader.h&gt;\nint main(int argc, char* argv[])\n{\n\n        int status = FAILURE;\n        int i; //loop-counter\n        char** safe_pointer = NULL;\n\n        printf(\"before HashTable\");\n        GHashTable* HT = g_hash_table_new(g_int_hash, g_int_equal);\n\n        if(argc &lt; 2)\n        {\n                printf(\"\\n &lt;USAGE&gt; : &lt;Program_name&gt; &lt;file1&gt; &lt;file2&gt; ...\");\n                return FAILURE;\n        }\n        // program needs to be scalable, all files should be read using variable arguments\n\n        for(i = 1; i &lt; argc; i++)\n        {\n                safe_pointer = &amp;argv[i];\n                status = read_CMD(safe_pointer, &amp;HT);\n                if(status == FAILURE)\n                {\n                        FILE_READ_ERROR; \n                }\n        }\n        status = write_CMD();\n        if(status == FAILURE)\n        {\n                FILE_WRITE_ERROR;\n        }\n        return SUCCESS;\n}\n</code></pre>\n\n<p>My header_file</p>\n\n<pre><code>/************************************************************************************************************   \n*   File Name   :   cmdheader.h\n*\n*   Description :   cmdheader.h contains all necessary headerfiles and macros \n*\n* *********************************************************************************************************/\n\n#ifndef __CMD_HEADER_H_\n#define __CMD_HEADER_H_\n\n/***********************************************************************************************************\n *                                      HEADER FILES \n **********************************************************************************************************/\n\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;glib.h&gt;\n\n/***********************************************************************************************************\n *                                         MACROS \n **********************************************************************************************************/\n\n#define SUCCESS 0\n#define FAILURE 1\n#define LINE_LEN 80\n#define DELIMS 3\n\n#define FILE_READ_ERROR printf(\"\\n CANNOT READ THE FILE\")\n#define FILE_WRITE_ERROR printf(\"\\n CANNOT WRITE TO THE FILE\")\n\n#endif\n</code></pre>\n\n<p>My functions file </p>\n\n<pre><code>#include &lt;cmdheader.h&gt;\n\nint read_CMD(char** save_pointer, GHashTable** Hash);\nint write_CMD();\n\nint read_CMD(char** save_pointer, GHashTable **Hash)\n{\n\n        GHashTable *HT = *Hash;\n        char buffer[LINE_LEN];\n        memset(buffer, '\\0', LINE_LEN);\n\n        char* save_pointer_new = *save_pointer;\n        int key = 1;\n        int* key_pointer = &amp;key;\n        int parse_errors = 0;\n        int parse_error_check = 1;\n        char* token = NULL;\n\n        const char delim[DELIMS] = {',', ':', ';'}; \n        FILE* read_file_pointer;\n        read_file_pointer = fopen(save_pointer_new, \"r\");\n\n\n        while(NULL != fgets(buffer, LINE_LEN, read_file_pointer))\n        {\n                // check for parse error\n                token = strtok(buffer,delim);\n                while(NULL != token)\n                {\n                        token = strtok(NULL, delim);\n                        parse_error_check++;\n                }\n\n                // parse_error_check checks number of tokens in a command\n                // 2 tokens is error, from 4, it is a valid command\n                if(parse_error_check != 2 &amp;&amp; \n                                ((parse_error_check % 2) ==0))\n                {\n                        g_hash_table_insert(HT,key_pointer, buffer);\n                        key++;\n                }\n\n                else\n                {\n                        parse_errors++;\n                }\n        }\n\n        printf(\"\\n Element at key : 1 \", g_hash_table_lookup(HT,(gconstpointer)1));\n        printf(\"\\n Parse error count : %d\", parse_errors);\n        return SUCCESS;\n\n\n\n}\n\nint write_CMD()\n{\n\n        return SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 1029, "user_id": 2176845, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3dc89025bf40202b994b24b28e6d71cd?s=128&d=identicon&r=PG", "display_name": "levengli", "link": "https://stackoverflow.com/users/2176845/levengli"}, "edited": false, "score": 0, "creation_date": 1484723923, "post_id": 41713389, "comment_id": 70621685, "body": "new can be called on C++ objects. Are you trying to instatiate an object of some sort?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 3, "creation_date": 1484726038, "post_id": 41713389, "comment_id": 70622688, "body": "Using <code>**</code> to mark the code you want to change is a huge mistake in asking this question, since it has meaning when prefixed to that statement."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6237497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de9d3b1bbbee7cc4cf1b21bc7ff71f21?s=128&d=identicon&r=PG", "display_name": "CharchitJd", "link": "https://stackoverflow.com/users/6237497/charchitjd"}, "edited": false, "score": 0, "creation_date": 1486824316, "post_id": 41713466, "comment_id": 71517725, "body": "thankyou @Some programmer dude, your solution explains me everything i wanted to know."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 8, "last_activity_date": 1484723905, "creation_date": 1484723905, "answer_id": 41713466, "question_id": 41713389, "link": "https://stackoverflow.com/questions/41713389/converting-complex-malloc-to-new-and-suggsest-good-method-to-easily-convert/41713466#41713466", "title": "converting complex malloc() to new() and suggsest good method to easily convert complex malloc", "body": "<p>What you are doing with that <code>malloc</code> call is to allocate an array of pointers to <code>node</code>.</p>\n\n<p>To allocate an array dynamically in C++ you use <code>new[]</code> like</p>\n\n<pre><code>queue-&gt;array = new node*[queue-&gt;size]{};\n</code></pre>\n\n<p>The above statement allocates an array of <code>queue-&gt;size</code> pointers to <code>node</code>, and also default initializes each pointer, which means they will all be null-pointers (so you don't need the loop after the allocation).</p>\n\n<p>And remember that everything you allocate with <code>new[]</code> must be deallocated with <code>delete[]</code>.</p>\n\n<hr>\n\n<p>Now that we solved your problem, the <em>proper</em> solution is to use <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"noreferrer\"><code>std::vector</code></a> instead of dynamically allocate memory like you do.</p>\n\n<p>I would also recommend you don't use pointers, but instances of the structures instead. Both for the vector, and also more generally. Besides polymorphism, there's rarely a need to use pointers in modern C++.</p>\n"}], "owner": {"reputation": 13, "user_id": 6237497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de9d3b1bbbee7cc4cf1b21bc7ff71f21?s=128&d=identicon&r=PG", "display_name": "CharchitJd", "link": "https://stackoverflow.com/users/6237497/charchitjd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 41713466, "answer_count": 1, "score": 0, "last_activity_date": 1484723905, "creation_date": 1484723693, "question_id": 41713389, "link": "https://stackoverflow.com/questions/41713389/converting-complex-malloc-to-new-and-suggsest-good-method-to-easily-convert", "title": "converting complex malloc() to new() and suggsest good method to easily convert complex malloc", "body": "<pre><code>struct node\n{\n    int data;\n    node *right,*left;\n};\n\n// A queue node\nstruct Queue\n{\n    int front, rear;\n    int size;\n    node* *array;\n};\n\n// A utility function to create a new tree node\nnode* newNode(int data)\n{\n    node* temp = new node();\n    temp-&gt;data = data;\n    temp-&gt;left = temp-&gt;right = NULL;\n    return temp;\n}\n\n// A utility function to create a new Queue\nQueue* createQueue(int size)\n{\n    Queue* queue = new Queue();\n\n    queue-&gt;front = queue-&gt;rear = -1;\n    queue-&gt;size = size;\n\n    **queue-&gt;array = (struct node**) malloc(queue-&gt;size * sizeof( struct node* ));**\n\n//this is the malloc statement which i want to convert to new;\n    int i;\n    for (i = 0; i &lt; size; ++i)\n        queue-&gt;array[i] = NULL;\n\n    return queue;\n}\n</code></pre>\n\n<p>i'm unable to convert that malloc() statement in createQueue function to new();\nneed help.\nand also please suggsest me a good method to convert that complex malloc() statements to new() for the next time.</p>\n"}, {"tags": ["c", "rsa", "public-key-encryption", "contiki"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484723537, "post_id": 41713108, "comment_id": 70621528, "body": "Is this the <i>only</i> header you included?"}, {"owner": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484723903, "post_id": 41713108, "comment_id": 70621676, "body": "yes for libtomcrypt library. The rest of the include is inside tomcrypt.h. this is the list of include inside #include &quot;tomcrypt_cfg.h&quot; #include &quot;tomcrypt_macros.h&quot; #include &quot;tomcrypt_cipher.h&quot; #include &quot;tomcrypt_hash.h&quot; #include &quot;tomcrypt_mac.h&quot; #include &quot;tomcrypt_prng.h&quot; #include &quot;tomcrypt_pk.h&quot; #include &quot;tomcrypt_math.h&quot; #include &quot;tomcrypt_misc.h&quot; #include &quot;tomcrypt_argchk.h&quot; #include &quot;tomcrypt_pkcs.h&quot; #include &quot;tomcrypt_pk.h&quot;"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484724065, "post_id": 41713108, "comment_id": 70621762, "body": "Yes, I&#39;ve visited the github page for it. That&#39;s why I asked. Only the top level header (<code>tomcrypt.h</code>) is meant to be included. I personally feel the author could have added a few <code>#error</code> directives to safe guard against it."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "edited": false, "score": 1, "creation_date": 1484723100, "post_id": 41713189, "comment_id": 70621316, "body": "#ifndef _TOMCRYPT_H #define _TOMCRYPT_H its already been add in tomcrypt.h when i download the library"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "edited": false, "score": 0, "creation_date": 1484723246, "post_id": 41713189, "comment_id": 70621393, "body": "Hm - what&#39;s about <code>tomcrypt_pk.h</code>? Does this file contain such a protection?"}, {"owner": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "edited": false, "score": 0, "creation_date": 1484723836, "post_id": 41713189, "comment_id": 70621652, "body": "no it does not have that so i just add #ifndef _TOMCRYPT_PT_H #define _TOMCRYPT_PT_H  right?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "edited": false, "score": 0, "creation_date": 1484724354, "post_id": 41713189, "comment_id": 70621897, "body": "@lol - Modifying library headers is usually a bad idea. Most likely your project has an include for one of the headers which aren&#39;t meant to be included."}, {"owner": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484724701, "post_id": 41713189, "comment_id": 70622084, "body": "@StoryTeller The main reason i think i had this problem is that i need to used the function rsa_make_key and rsa_get_size which is in tomcrypt_pk.h but i don&#39;t see it include inside tomcrpyt.h and i got undefined error so i include tomcrypt_pk.h myself. Is that a bad idea to do that?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "edited": false, "score": 0, "creation_date": 1484724937, "post_id": 41713189, "comment_id": 70622186, "body": "@lol - yes. When I viewed the source <a href=\"https://github.com/libtom/libtomcrypt/blob/develop/src/headers/tomcrypt.h\" rel=\"nofollow noreferrer\">on github</a> it was clear that <code>tomcrypt_pk.h</code> is included in <code>tomcrpyt.h</code>."}, {"owner": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484733377, "post_id": 41713189, "comment_id": 70627302, "body": "@StoryTeller and stephan lechner thanks for the help i include the file twice by accident Thanks alot"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484733592, "post_id": 41713189, "comment_id": 70627456, "body": "@StoryTeller: you are right; editing library files is usually a bad idea; it was more meant as a technique for remotely finding out what the problem is :-)"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 2, "last_activity_date": 1484727515, "last_edit_date": 1484727515, "creation_date": 1484722869, "answer_id": 41713189, "question_id": 41713108, "link": "https://stackoverflow.com/questions/41713108/error-redeclaration-of-enumerator-for-contiki-os-libtomcrypt-library/41713189#41713189", "title": "error: redeclaration of enumerator for contiki os libtomcrypt library", "body": "<p>I suppose that either <code>tomcrypt.h</code> or `tomcrypt_pk.h\" file gets included several times and that therefore the same things get defined several times.</p>\n\n<p>To try out if this is the reason, I'd add the following lines at the top and at the end of <code>tomcrypt.h</code>, respectively.</p>\n\n<p>At the top:</p>\n\n<pre><code>#ifndef _TOMCRYPT_H\n#define _TOMCRYPT_H\n</code></pre>\n\n<p>At the end:</p>\n\n<pre><code>#endif\n</code></pre>\n\n<p>Repeat this for <code>tomcat_pk.h</code>:</p>\n\n<pre><code>#ifndef _TOMCRYPT_PK_H\n#define _TOMCRYPT_PK_H\n...\n#endif\n</code></pre>\n\n<p>If the code then compiles, then the problem is that the same header file gets included (directly or indirectly) more than once in a compilation unit may also apply to other header files, e.g. <code>tomcrypt_pk.h</code>. So you could also check if you incude, for example, <code>tomcrypt_pk.h</code> directly in your <code>.c</code>-file, while another header file (e.g. <code>tomcrypt.h</code>) also includes this file.</p>\n\n<p>If this is the case, you have two principal ways of solving the problem: (1) remove unnecessary include statements, (2) protect the include file from being interpreted more than once, e.g. by surrounding the definitions by <code>#ifndef - #define</code>-statements. I'd prefer option (1) over option (2).</p>\n\n<p>Note that - as pointed out by StoryTeller - it is not encouraged to edit third party library files, even not for introducing such <code>#ifndef-#define</code>-statements. If you cannot manage to follow option (1), you could still surround the respective <code>#include</code>-statements in your files, e.g.</p>\n\n<pre><code>// in myFile.c:\n#ifndef _TOMCRYPT_PK_H\n#define _TOMCRYPT_PH_H\n#include \"tomcrypt_pk.h\"\n#endif\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7424930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071e2dafa1ff3c130a8f716044cfa5d1?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7424930/lol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 41713189, "answer_count": 1, "score": 0, "last_activity_date": 1484727515, "creation_date": 1484722448, "question_id": 41713108, "link": "https://stackoverflow.com/questions/41713108/error-redeclaration-of-enumerator-for-contiki-os-libtomcrypt-library", "title": "error: redeclaration of enumerator for contiki os libtomcrypt library", "body": "<p>I am working on encryption in CONTIKI OS and COOJA simulator which i tired to use the library libtomcrypt. I include the library into CONTIKI folder but when i tired to call the rsa_make_key function it given me this error. Thanks in advance and hope to heard from you guys soon.</p>\n\n<pre><code>&gt; make TARGET=cooja clean \nrm -f *~ *core core *.srec \\\n    *.lst *.map \\\n    *.cprg *.bin *.data contiki*.a *.firmware core-labels.S *.ihex *.ini \\\n    *.ce *.co\nrm -rf \nrm -rf obj_cooja\n\n&gt; make sender-node.cooja TARGET=cooja \n  CC        sender-node.c\nIn file included from ../../../core/./../apps/libtomcrypt/src/headers/tomcrypt.h:80:0,\n                 from sender-node.c:43:\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:4:4: error: redeclaration of enumerator 'PK_PUBLIC'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:4:4: note: previous definition of 'PK_PUBLIC' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:5:4: error: redeclaration of enumerator 'PK_PRIVATE'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:5:4: note: previous definition of 'PK_PRIVATE' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:16:4: error: redeclaration of enumerator 'PKA_RSA'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:16:4: note: previous definition of 'PKA_RSA' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:17:4: error: redeclaration of enumerator 'PKA_DSA'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:17:4: note: previous definition of 'PKA_DSA' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:20:16: error: redefinition of 'struct Oid'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:20:16: note: originally defined here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:24:3: error: conflicting types for 'oid_st'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:24:3: note: previous declaration of 'oid_st' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:26:5: error: conflicting types for 'pk_get_oid'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:26:5: note: previous declaration of 'pk_get_oid' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:32:16: error: redefinition of 'struct Rsa_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:32:16: note: originally defined here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:51:3: error: conflicting types for 'rsa_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:51:3: note: previous declaration of 'rsa_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:53:5: error: conflicting types for 'rsa_make_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:53:5: note: previous declaration of 'rsa_make_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:55:5: error: conflicting types for 'rsa_get_size'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:55:5: note: previous declaration of 'rsa_get_size' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:57:5: error: conflicting types for 'rsa_exptmod'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:57:5: note: previous declaration of 'rsa_exptmod' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:61:6: error: conflicting types for 'rsa_free'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:61:6: note: previous declaration of 'rsa_free' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:80:5: error: conflicting types for 'rsa_encrypt_key_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:80:5: note: previous declaration of 'rsa_encrypt_key_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:85:5: error: conflicting types for 'rsa_decrypt_key_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:85:5: note: previous declaration of 'rsa_decrypt_key_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:91:5: error: conflicting types for 'rsa_sign_hash_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:91:5: note: previous declaration of 'rsa_sign_hash_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:98:5: error: conflicting types for 'rsa_verify_hash_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:98:5: note: previous declaration of 'rsa_verify_hash_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:104:5: error: conflicting types for 'rsa_sign_saltlen_get_max_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:104:5: note: previous declaration of 'rsa_sign_saltlen_get_max_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:107:5: error: conflicting types for 'rsa_export'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:107:5: note: previous declaration of 'rsa_export' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:108:5: error: conflicting types for 'rsa_import'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:108:5: note: previous declaration of 'rsa_import' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:170:16: error: redefinition of 'struct Dh_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:170:16: note: originally defined here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:174:3: error: conflicting types for 'dh_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:174:3: note: previous declaration of 'dh_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:178:5: error: conflicting types for 'dh_get_size'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:178:5: note: previous declaration of 'dh_get_size' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:180:5: error: conflicting types for 'dh_make_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:180:5: note: previous declaration of 'dh_make_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:181:6: error: conflicting types for 'dh_free'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:181:6: note: previous declaration of 'dh_free' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:183:5: error: conflicting types for 'dh_export'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:183:5: note: previous declaration of 'dh_export' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:184:5: error: conflicting types for 'dh_import'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:184:5: note: previous declaration of 'dh_import' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:186:5: error: conflicting types for 'dh_shared_secret'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:186:5: note: previous declaration of 'dh_shared_secret' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:189:5: error: conflicting types for 'dh_encrypt_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:189:5: note: previous declaration of 'dh_encrypt_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:194:5: error: conflicting types for 'dh_decrypt_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:194:5: note: previous declaration of 'dh_decrypt_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:198:5: error: conflicting types for 'dh_sign_hash'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:198:5: note: previous declaration of 'dh_sign_hash' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:202:5: error: conflicting types for 'dh_verify_hash'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:202:5: note: previous declaration of 'dh_verify_hash' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:241:3: error: conflicting types for 'ltc_ecc_set_type'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:241:3: note: previous declaration of 'ltc_ecc_set_type' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:253:3: error: conflicting types for 'ecc_point'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:253:3: note: previous declaration of 'ecc_point' was here\nIn file included from ../../../core/./../apps/libtomcrypt/src/headers/tomcrypt.h:80:0,\n                 from sender-node.c:43:\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:271:3: error: conflicting types for 'ecc_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:271:3: note: previous declaration of 'ecc_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:274:31: error: conflicting types for 'ltc_ecc_sets'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:274:31: note: previous declaration of 'ltc_ecc_sets' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:278:6: error: conflicting types for 'ecc_get_size'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:278:6: note: previous declaration of 'ecc_get_size' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:280:6: error: conflicting types for 'ecc_make_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:280:6: note: previous declaration of 'ecc_make_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:281:6: error: conflicting types for 'ecc_make_key_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:281:6: note: previous declaration of 'ecc_make_key_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:282:6: error: conflicting types for 'ecc_free'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:282:6: note: previous declaration of 'ecc_free' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:284:6: error: conflicting types for 'ecc_export'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:284:6: note: previous declaration of 'ecc_export' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:285:6: error: conflicting types for 'ecc_import'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:285:6: note: previous declaration of 'ecc_import' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:286:6: error: conflicting types for 'ecc_import_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:286:6: note: previous declaration of 'ecc_import_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:288:5: error: conflicting types for 'ecc_ansi_x963_export'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:288:5: note: previous declaration of 'ecc_ansi_x963_export' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:289:5: error: conflicting types for 'ecc_ansi_x963_import'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:289:5: note: previous declaration of 'ecc_ansi_x963_import' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:290:5: error: conflicting types for 'ecc_ansi_x963_import_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:290:5: note: previous declaration of 'ecc_ansi_x963_import_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:292:6: error: conflicting types for 'ecc_shared_secret'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:292:6: note: previous declaration of 'ecc_shared_secret' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:295:6: error: conflicting types for 'ecc_encrypt_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:295:6: note: previous declaration of 'ecc_encrypt_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:300:6: error: conflicting types for 'ecc_decrypt_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:300:6: note: previous declaration of 'ecc_decrypt_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:304:5: error: conflicting types for 'ecc_sign_hash_raw'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:304:5: note: previous declaration of 'ecc_sign_hash_raw' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:308:6: error: conflicting types for 'ecc_sign_hash'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:308:6: note: previous declaration of 'ecc_sign_hash' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:312:5: error: conflicting types for 'ecc_verify_hash_raw'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:312:5: note: previous declaration of 'ecc_verify_hash_raw' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:316:6: error: conflicting types for 'ecc_verify_hash'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:316:6: note: previous declaration of 'ecc_verify_hash' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:321:12: error: conflicting types for 'ltc_ecc_new_point'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:321:12: note: previous declaration of 'ltc_ecc_new_point' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:322:12: error: conflicting types for 'ltc_ecc_del_point'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:322:12: note: previous declaration of 'ltc_ecc_del_point' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:328:5: error: conflicting types for 'ltc_ecc_projective_dbl_point'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:328:5: note: previous declaration of 'ltc_ecc_projective_dbl_point' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:331:5: error: conflicting types for 'ltc_ecc_projective_add_point'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:331:5: note: previous declaration of 'ltc_ecc_projective_add_point' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:349:5: error: conflicting types for 'ltc_ecc_mulmod'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:349:5: note: previous declaration of 'ltc_ecc_mulmod' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:353:5: error: conflicting types for 'ltc_ecc_mul2add'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:353:5: note: previous declaration of 'ltc_ecc_mul2add' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:369:5: error: conflicting types for 'ltc_ecc_map'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:369:5: note: previous declaration of 'ltc_ecc_map' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:403:3: error: conflicting types for 'dsa_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:403:3: note: previous declaration of 'dsa_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:405:5: error: conflicting types for 'dsa_make_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:405:5: note: previous declaration of 'dsa_make_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:406:6: error: conflicting types for 'dsa_free'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:406:6: note: previous declaration of 'dsa_free' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:408:5: error: conflicting types for 'dsa_sign_hash_raw'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:408:5: note: previous declaration of 'dsa_sign_hash_raw' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:412:5: error: conflicting types for 'dsa_sign_hash'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:412:5: note: previous declaration of 'dsa_sign_hash' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:416:5: error: conflicting types for 'dsa_verify_hash_raw'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:416:5: note: previous declaration of 'dsa_verify_hash_raw' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:420:5: error: conflicting types for 'dsa_verify_hash'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:420:5: note: previous declaration of 'dsa_verify_hash' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:424:5: error: conflicting types for 'dsa_encrypt_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:424:5: note: previous declaration of 'dsa_encrypt_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:429:5: error: conflicting types for 'dsa_decrypt_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:429:5: note: previous declaration of 'dsa_decrypt_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:433:5: error: conflicting types for 'dsa_import'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:433:5: note: previous declaration of 'dsa_import' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:434:5: error: conflicting types for 'dsa_export'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:434:5: note: previous declaration of 'dsa_export' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:435:5: error: conflicting types for 'dsa_verify_key'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:435:5: note: previous declaration of 'dsa_verify_key' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:437:5: error: conflicting types for 'dsa_shared_secret'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:437:5: note: previous declaration of 'dsa_shared_secret' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:445:14: error: nested redefinition of 'enum ltc_asn1_type_'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:445:14: error: redeclaration of 'enum ltc_asn1_type_'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:445:14: note: originally defined here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:447:2: error: redeclaration of enumerator 'LTC_ASN1_EOL'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:447:2: note: previous definition of 'LTC_ASN1_EOL' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:448:2: error: redeclaration of enumerator 'LTC_ASN1_BOOLEAN'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:448:2: note: previous definition of 'LTC_ASN1_BOOLEAN' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:449:2: error: redeclaration of enumerator 'LTC_ASN1_INTEGER'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:449:2: note: previous definition of 'LTC_ASN1_INTEGER' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:450:2: error: redeclaration of enumerator 'LTC_ASN1_SHORT_INTEGER'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:450:2: note: previous definition of 'LTC_ASN1_SHORT_INTEGER' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:451:2: error: redeclaration of enumerator 'LTC_ASN1_BIT_STRING'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:451:2: note: previous definition of 'LTC_ASN1_BIT_STRING' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:453:2: error: redeclaration of enumerator 'LTC_ASN1_OCTET_STRING'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:453:2: note: previous definition of 'LTC_ASN1_OCTET_STRING' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:454:2: error: redeclaration of enumerator 'LTC_ASN1_NULL'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:454:2: note: previous definition of 'LTC_ASN1_NULL' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:455:2: error: redeclaration of enumerator 'LTC_ASN1_OBJECT_IDENTIFIER'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:455:2: note: previous definition of 'LTC_ASN1_OBJECT_IDENTIFIER' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:456:2: error: redeclaration of enumerator 'LTC_ASN1_IA5_STRING'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:456:2: note: previous definition of 'LTC_ASN1_IA5_STRING' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:457:2: error: redeclaration of enumerator 'LTC_ASN1_PRINTABLE_STRING'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:457:2: note: previous definition of 'LTC_ASN1_PRINTABLE_STRING' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:459:2: error: redeclaration of enumerator 'LTC_ASN1_UTF8_STRING'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:459:2: note: previous definition of 'LTC_ASN1_UTF8_STRING' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:460:2: error: redeclaration of enumerator 'LTC_ASN1_UTCTIME'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:460:2: note: previous definition of 'LTC_ASN1_UTCTIME' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:461:2: error: redeclaration of enumerator 'LTC_ASN1_CHOICE'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:461:2: note: previous definition of 'LTC_ASN1_CHOICE' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:462:2: error: redeclaration of enumerator 'LTC_ASN1_SEQUENCE'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:462:2: note: previous definition of 'LTC_ASN1_SEQUENCE' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:463:2: error: redeclaration of enumerator 'LTC_ASN1_SET'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:463:2: note: previous definition of 'LTC_ASN1_SET' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:465:2: error: redeclaration of enumerator 'LTC_ASN1_SETOF'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:465:2: note: previous definition of 'LTC_ASN1_SETOF' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:466:2: error: redeclaration of enumerator 'LTC_ASN1_RAW_BIT_STRING'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:466:2: note: previous definition of 'LTC_ASN1_RAW_BIT_STRING' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:467:2: error: redeclaration of enumerator 'LTC_ASN1_TELETEX_STRING'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:467:2: note: previous definition of 'LTC_ASN1_TELETEX_STRING' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:468:2: error: redeclaration of enumerator 'LTC_ASN1_CONSTRUCTED'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:468:2: note: previous definition of 'LTC_ASN1_CONSTRUCTED' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:469:2: error: redeclaration of enumerator 'LTC_ASN1_CONTEXT_SPECIFIC'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:469:2: note: previous definition of 'LTC_ASN1_CONTEXT_SPECIFIC' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:473:16: error: redefinition of 'struct ltc_asn1_list_'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:473:16: note: originally defined here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:484:3: error: conflicting types for 'ltc_asn1_list'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:484:3: note: previous declaration of 'ltc_asn1_list' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:497:5: error: conflicting types for 'der_encode_sequence_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:497:5: note: previous declaration of 'der_encode_sequence_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:502:5: error: conflicting types for 'der_decode_sequence_ex'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:502:5: note: previous declaration of 'der_decode_sequence_ex' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:507:5: error: conflicting types for 'der_length_sequence'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:507:5: note: previous declaration of 'der_length_sequence' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:515:5: error: conflicting types for 'der_decode_subject_public_key_info'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:515:5: note: previous declaration of 'der_decode_subject_public_key_info' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:522:5: error: conflicting types for 'der_encode_set'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:522:5: note: previous declaration of 'der_encode_set' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:525:5: error: conflicting types for 'der_encode_setof'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:525:5: note: previous declaration of 'der_encode_setof' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:533:6: error: conflicting types for 'der_decode_sequence_flexi'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:533:6: note: previous declaration of 'der_decode_sequence_flexi' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:535:6: error: conflicting types for 'der_sequence_free'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:535:6: note: previous declaration of 'der_sequence_free' was here\nIn file included from ../../../core/./../apps/libtomcrypt/src/headers/tomcrypt.h:80:0,\n                 from sender-node.c:43:\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:624:5: error: conflicting types for 'der_decode_choice'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:624:5: note: previous declaration of 'der_decode_choice' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:638:3: error: conflicting types for 'ltc_utctime'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:638:3: note: previous declaration of 'ltc_utctime' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:640:5: error: conflicting types for 'der_encode_utctime'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:640:5: note: previous declaration of 'der_encode_utctime' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:643:5: error: conflicting types for 'der_decode_utctime'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:643:5: note: previous declaration of 'der_decode_utctime' was here\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:646:5: error: conflicting types for 'der_length_utctime'\n../../../core/./../apps/libtomcrypt/src/headers/tomcrypt_pk.h:646:5: note: previous declaration of 'der_length_utctime' was here\nmake: *** [sender-node.co] Error 1\nProcess returned error code 2\n</code></pre>\n\n<p>This is the part where i tired to call the functionprng_state* prng;</p>\n\n<pre><code> prng_state* prng;\n  rsa_key* key;\n  int result = rsa_make_key(\n    prng,\n    0,\n    rsa_get_size(key),\n    65537,\n    key);\n</code></pre>\n\n<p>I had also include the tomcrypt.h for the library in the code</p>\n\n<pre><code>#include \"../apps/libtomcrypt/src/headers/tomcrypt.h\"\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1484719081, "post_id": 41712334, "comment_id": 70619715, "body": "Why not <code>abs(a)</code>?"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1484719083, "post_id": 41712334, "comment_id": 70619716, "body": "It does work, it sets the sign to 0. Maybe not in the way you wanted though. If you want to implement <code>abs</code> with bitmath, it&#39;s a bit more tricky than this."}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "edited": false, "score": 0, "creation_date": 1484719345, "post_id": 41712334, "comment_id": 70619827, "body": "When I printf my variable, I get 2147483148 instead of the intended 500. And I can&#39;t use abs(a) because I am trying to store the absolute value into an unsigned int, and using abs(a) would have problems with -2,147,483,648, right?"}, {"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1484719514, "post_id": 41712334, "comment_id": 70619874, "body": "I haven&#39;t tested it, but why don&#39;t you just use <code>a = a &amp; (~0x80000000);</code> to clear the uppermost bit."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1484719596, "post_id": 41712334, "comment_id": 70619912, "body": "Fair enough, using the standard <code>abs</code> for MIN_INT is a bit dangerous. Not inherently, but overflow and UB yada yada.. You can just do an unsigned <code>abs</code> though, eg <code>if (x &lt; 0) return -(unsigned)x; else return (unsigned)x;</code>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1484719715, "post_id": 41712334, "comment_id": 70619970, "body": "<a href=\"http://stackoverflow.com/q/47981/995714\">How do you set, clear and toggle a single bit in C/C++?</a>"}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "reply_to_user": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1484719787, "post_id": 41712334, "comment_id": 70619999, "body": "@zx485 that gives me the same result as my code above. hm. and at harold: that may solve my issue, but I would still like to know why the method I tried doesn&#39;t work"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484719837, "post_id": 41712334, "comment_id": 70620022, "body": "<code>(unsigned int)a</code> =&gt; <code>2^32 - 1000</code> =&gt; <code>4294966296</code> so <code>(unsigned int)a &gt;&gt; 1</code> =&gt; <code>4294966296 &#47; 2</code> =&gt; <code>2147483148</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 1, "creation_date": 1484720036, "post_id": 41712334, "comment_id": 70620090, "body": "In C and in C++, <code>a &lt;&lt; 1</code> means &quot;multiply by 2&quot;, not &quot;shift the bits in the underlying bit representation left by 1&quot;."}, {"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 2, "creation_date": 1484720104, "post_id": 41712334, "comment_id": 70620117, "body": "Because you asked to change the <code>SIGN</code> bit (x86 asm opCode: <code>NOT</code>) and not turning a negative number into a positive number(x86 asm opCode: <code>NEG</code>). These are two different things. The answer below explains this and is correct."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1484720205, "post_id": 41712334, "comment_id": 70620157, "body": "@Hurkyl is there a difference? In any case if there is, it wasn&#39;t visible here"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1484723490, "post_id": 41712334, "comment_id": 70621500, "body": "You are not in sign-magnitude representation but probably 2&#39;s-complement."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1484724480, "post_id": 41712334, "comment_id": 70621958, "body": "Please edit into the question what your expected output was"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1484727842, "post_id": 41712334, "comment_id": 70623675, "body": "@Hurkyl No, it shifts bits, including the sign bit. Thus the reason that many rules prohibit/specify certain shifts of signed integers. Shifting and mult/division by two are similar in some contexts."}], "answers": [{"comments": [{"owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1562310993, "post_id": 41712513, "comment_id": 100341928, "body": "Im working on gnss coordinates that require me to find out if its 0 or -0? how can i identify -0?"}], "tags": [], "owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "is_accepted": true, "score": 7, "last_activity_date": 1484723593, "last_edit_date": 1484723593, "creation_date": 1484719803, "answer_id": 41712513, "question_id": 41712334, "link": "https://stackoverflow.com/questions/41712334/negative-numbers-how-can-i-change-the-sign-bit-in-a-signed-int-to-a-0/41712513#41712513", "title": "Negative numbers: How can I change the sign bit in a signed int to a 0?", "body": "<p>TL;DR: the easiest way is to use the <code>abs</code> function from <code>&lt;stdlib.h&gt;</code>. The rest of the answer involves the representation of negative numbers on a computer.</p>\n\n<p>Negative integers are (almost always) represented in <a href=\"https://en.wikipedia.org/wiki/Two&#39;s_complement\" rel=\"nofollow noreferrer\">2's complement form</a>. (see note below)</p>\n\n<p>The method of getting the negative of a number is:</p>\n\n<ol>\n<li>Take the binary representation of the whole number (including leading zeroes for the data type, except the MSB which will serve as the sign bit).</li>\n<li>Take the <a href=\"https://en.wikipedia.org/wiki/Ones&#39;_complement\" rel=\"nofollow noreferrer\">1's complement</a> of the above number.</li>\n<li>Add <code>1</code> to the 1's complement.</li>\n<li>Prefix a <a href=\"https://en.wikipedia.org/wiki/Sign_bit\" rel=\"nofollow noreferrer\">sign bit</a>.</li>\n</ol>\n\n<p>Using <code>500</code> as an example,</p>\n\n<ol>\n<li>Take the binary representation of <code>500</code>: <code>_000 0001 1111 0100</code> (<code>_</code> is a placeholder for the sign bit).</li>\n<li>Take the 1's-complement / inverse of it: <code>_111 1110 0000 1011</code> </li>\n<li>Add <code>1</code> to the 1's complement: <code>_111 1110 0000 1011 + 1 = _111 1110 0000 1100</code>. This is the same as <code>2147483148</code> that you obtained, when you replaced the sign-bit by zero.</li>\n<li>Prefix <code>0</code> to show a positive number and <code>1</code> for a negative number: <code>1111 1110 0000 1100</code>. (This will be different from <code>2147483148</code> above. The reason you got the above value is because you nuked the MSB).</li>\n</ol>\n\n<p>Inverting the sign is a similar process. You get leading ones if you use 16-bit or 32-bit numbers leading to the large value that you see. The LSB should be the same in each case.</p>\n\n<p>Note: there are machines with 1's complement representation, but they are a minority. The 2's complement is usually preferred because <code>0</code> has the same representation, i.e., <code>-0</code> and <code>0</code> are represented as all-zeroes in the 2's complement notation.</p>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1484727016, "post_id": 41713996, "comment_id": 70623178, "body": "Left-shift by 31 in your example is UB, because 2^31 isn&#39;t representable in int32_t."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484727724, "post_id": 41713996, "comment_id": 70623589, "body": "Edit: Assuming that int has the same representation as int32_t."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484728529, "post_id": 41713996, "comment_id": 70624075, "body": "@2501 The <code>lu</code> suffix should however not be necessary, since the assert is there."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484728615, "post_id": 41713996, "comment_id": 70624122, "body": "Right, I forgot about that. Still, int may have two padding bytes. :-) sizeof doesn&#39;t calculate the range. You should have used INT_MAX &gt;= 2^31-1. lu avoids all that."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1484728675, "last_edit_date": 1484728675, "creation_date": 1484726223, "answer_id": 41713996, "question_id": 41712334, "link": "https://stackoverflow.com/questions/41712334/negative-numbers-how-can-i-change-the-sign-bit-in-a-signed-int-to-a-0/41713996#41713996", "title": "Negative numbers: How can I change the sign bit in a signed int to a 0?", "body": "<p>Left-shifting negative integers invokes undefined behavior, so you can't do that. You could have used your code if you did <code>a = (unsigned int)a &lt;&lt; 1;</code>. You'd get 500 = <code>0xFFFFFE0C</code>, left-shifted 1 = <code>0xFFFFFC18</code>. </p>\n\n<p><code>a = (unsigned int)a &gt;&gt; 1;</code> does indeed guarantee logical shift, so you get <code>0x7FFFFE0C</code>. This is decimal 2147483148.</p>\n\n<p>But this is needlessly complex. <strong>The best and most portable way to change the sign bit is simply <code>a = -a</code>. Any other code or method is questionable.</strong></p>\n\n<p>If you however insist on bit-twiddling, you could also do something like </p>\n\n<pre><code>(int32_t)a &amp; ~(1u &lt;&lt; 31)\n</code></pre>\n\n<p>This is portable to 32 bit systems, since <code>(int32_t)</code> guarantees two's complement, but <code>1u &lt;&lt; 31</code> assumes 32 bit <code>int</code> type.</p>\n\n<p>Demo:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main (void)\n{\n  int a = -500;\n  a = (unsigned int)a &lt;&lt; 1;\n  a = (unsigned int)a &gt;&gt; 1;\n  printf(\"%.8X = %d\\n\", a, a);\n\n  _Static_assert(sizeof(int)&gt;=4, \"Int must be at least 32 bits.\");\n  a = -500;\n  a = (int32_t)a &amp; ~(1u &lt;&lt; 31);\n  printf(\"%.8X = %d\\n\", a, a);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 7304369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b4f13f4f4d52570d63fcb49e8feb2c?s=128&d=identicon&r=PG&f=1", "display_name": "mcbachman1", "link": "https://stackoverflow.com/users/7304369/mcbachman1"}, "is_accepted": false, "score": -1, "last_activity_date": 1484769365, "last_edit_date": 1495542275, "creation_date": 1484726434, "answer_id": 41714057, "question_id": 41712334, "link": "https://stackoverflow.com/questions/41712334/negative-numbers-how-can-i-change-the-sign-bit-in-a-signed-int-to-a-0/41714057#41714057", "title": "Negative numbers: How can I change the sign bit in a signed int to a 0?", "body": "<p>As you put in the your \"Also\" section, after your first left shift of 1 bit, a DOES reflect -1000 as expected.</p>\n\n<p>The issue is in your cast to unsigned int. As explained above, the negative number is represented as 2's complement, meaning the sign is determined by the left most bit (most significant bit). When cast to an unsigned int, that value no longer represents sign but increases the maximum value your int can take. </p>\n\n<p>Assuming 32 bit ints, the MSB used to represent -2^31 (= -2147483648) and now represents positive 2147483648 in an unsigned int, for an increase of 2* 2147483648 = 4294967296. Add this to your original value of -1000 and you get 4294966296. Right shift divides this by 2 and you arrive at 2147483148.</p>\n\n<p>Hoping this may be helpful: (modified printing func from <a href=\"https://stackoverflow.com/questions/1024389/print-an-int-in-binary-representation-using-c\">Print an int in binary representation using C</a>)</p>\n\n<pre><code>void int2bin(int a, char *buffer, int buf_size) {\n    buffer += (buf_size - 1);\n\n    for (int i = buf_size-1; i &gt;= 0; i--) {\n        *buffer-- = (a &amp; 1) + '0';\n\n        a &gt;&gt;= 1;\n    }\n}\n\nint main() {\n    int test = -500;\n    int bufSize = sizeof(int)*8 + 1;\n    char buf[bufSize];\n    buf[bufSize-1] = '\\0';\n    int2bin(test, buf, bufSize-1);\n    printf(\"%i (%u): %s\\n\", test, (unsigned int)test,  buf);\n    //Prints:   -500 (4294966796): 11111111111111111111111000001100\n\n\n    test = test &lt;&lt; 1;\n    int2bin(test, buf, bufSize-1);\n        printf(\"%i (%u): %s\\n\", test, (unsigned int)test, buf);\n    //Prints:   -1000 (4294966296): 11111111111111111111110000011000\n\n\n    test = 500;\n    int2bin(test, buf, bufSize-1);\n    printf(\"%i (%u): %s\\n\", test, (unsigned int)test, buf);\n    //Prints:   500 (500): 00000000000000000000000111110100\n\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3580, "favorite_count": 0, "accepted_answer_id": 41712513, "answer_count": 3, "score": 2, "last_activity_date": 1484769365, "creation_date": 1484718989, "last_edit_date": 1484720673, "question_id": 41712334, "link": "https://stackoverflow.com/questions/41712334/negative-numbers-how-can-i-change-the-sign-bit-in-a-signed-int-to-a-0", "title": "Negative numbers: How can I change the sign bit in a signed int to a 0?", "body": "<p>I was thinking this world work, but it does not:</p>\n\n<pre><code>int a = -500;\na = a &lt;&lt; 1;\na = (unsigned int)a &gt;&gt; 1;\n//printf(\"%d\",a) gives me \"2147483148\"\n</code></pre>\n\n<p>My thought was that the left-shift would remove the leftmost sign bit, so right-shifting it as an unsigned int would guarantee that it's a logical shift rather than arithmetic. Why is this incorrect?</p>\n\n<p>Also:</p>\n\n<pre><code>int a = -500;\na = a &lt;&lt; 1;\n//printf(\"%d\",a) gives me \"-1000\"\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 3, "creation_date": 1484718259, "post_id": 41712150, "comment_id": 70619420, "body": "Well you don&#39;t say what it must do so how can we know what is wrong?"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 3, "creation_date": 1484718275, "post_id": 41712150, "comment_id": 70619431, "body": "There&#39;s a lot of things wrong; which one exactly are you asking about? For instance, what is <code>d</code> supposed to be? Your string isn&#39;t 100 characters long, etc."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1484718298, "post_id": 41712150, "comment_id": 70619439, "body": "In general, the answer to <a href=\"http://stackoverflow.com/questions/204476/\">What should <code>main()</code> return?</a> is &quot;an <code>int</code>&quot; and not <code>void</code>.  Microsoft gives you an excuse to use <code>void</code>, but portable code avoids that."}, {"owner": {"reputation": 6306, "user_id": 5662469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZYgSJ.png?s=128&g=1", "display_name": "Deepak K Gupta", "link": "https://stackoverflow.com/users/5662469/deepak-k-gupta"}, "edited": false, "score": 1, "creation_date": 1484718319, "post_id": 41712150, "comment_id": 70619451, "body": "What you want to achieve and what this code is not doing?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1484718419, "post_id": 41712150, "comment_id": 70619483, "body": "Maybe you&#39;re missing a <code>break;</code> after the assignment to <code>d</code>, but your loop condition is reprehensible (you read out of bounds of the array) and and you don&#39;t ensure that <code>d</code> is set even if there is no space in the string."}, {"owner": {"reputation": 83, "user_id": 5723010, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/61b884c1288dcc21897ae5a817a95e2a?s=128&d=identicon&r=PG&f=1", "display_name": "vikramnr", "link": "https://stackoverflow.com/users/5723010/vikramnr"}, "edited": false, "score": 0, "creation_date": 1484719692, "post_id": 41712150, "comment_id": 70619957, "body": "Thanks all for above comments. I didn&#39;t post this one properly.  My apologies for that."}], "answers": [{"tags": [], "owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "is_accepted": true, "score": 1, "last_activity_date": 1484718534, "creation_date": 1484718534, "answer_id": 41712238, "question_id": 41712150, "link": "https://stackoverflow.com/questions/41712150/comparing-white-space-and-array/41712238#41712238", "title": "comparing white space and array", "body": "<p>Replace</p>\n\n<p><code>if(mystring[i]==\" \")</code></p>\n\n<p>With</p>\n\n<p><code>if(mystring[i]==' ')</code></p>\n\n<p>Use a single quote for char comparison. </p>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 1, "last_activity_date": 1484720627, "last_edit_date": 1484720627, "creation_date": 1484720135, "answer_id": 41712572, "question_id": 41712150, "link": "https://stackoverflow.com/questions/41712150/comparing-white-space-and-array/41712572#41712572", "title": "comparing white space and array", "body": "<p>Adding to the correct answer, you could also use <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_isspace.htm\" rel=\"nofollow noreferrer\"><code>isspace</code></a> from <code>ctype.h</code>. This function basically checks if the passed character <code>mystring[i]</code> is a whitespace or not. So instead of:</p>\n\n<pre><code>if(mystring[i]==' ')\n</code></pre>\n\n<p>you could do:</p>\n\n<pre><code>if (isspace(mystring[i]))\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5723010, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/61b884c1288dcc21897ae5a817a95e2a?s=128&d=identicon&r=PG&f=1", "display_name": "vikramnr", "link": "https://stackoverflow.com/users/5723010/vikramnr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 41712238, "answer_count": 2, "score": -2, "last_activity_date": 1484720627, "creation_date": 1484718076, "last_edit_date": 1484718189, "question_id": 41712150, "link": "https://stackoverflow.com/questions/41712150/comparing-white-space-and-array", "title": "comparing white space and array", "body": "<p>What is wrong with this code?\nI'm trying to compare string and white space.</p>\n\n<pre><code>void main()\n{\n    char d;\n    int i;\n    char* mystring=\"Vikram Natarajan\";\n    char c=mystring[0];\n    printf(\"%c\\n\",c);\n    for(i=0;i&lt;100; i++)\n    {\n        if(mystring[i]==\" \")\n        {\n            d=mystring[i+1];\n        }\n    }\n    printf(\"%c\\n\",d);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1484718069, "post_id": 41712112, "comment_id": 70619343, "body": "<a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1484718683, "post_id": 41712247, "comment_id": 70619571, "body": "Also, the <code>send_function()</code> claims to return a <code>void*</code>, but returns nothing."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1484728082, "last_edit_date": 1484728082, "creation_date": 1484718571, "answer_id": 41712247, "question_id": 41712112, "link": "https://stackoverflow.com/questions/41712112/why-is-my-simple-pthreads-program-crashing-with-a-segmentation-fault/41712247#41712247", "title": "Why is my simple pthreads program crashing with a segmentation fault?", "body": "<p>Is this line:</p>\n\n<pre><code>if(pthread_create(&amp;send,NULL,send_function(),NULL))\n</code></pre>\n\n<p>A typo?   The third argument to <code>pthread_create</code> is a function pointer, where the thread should start.</p>\n\n<p>It should read:</p>\n\n<pre><code>if(pthread_create(&amp;send,NULL,send_function,NULL))\n</code></pre>\n\n<p>Also, the threads you create won\u2019t really exit unless you set their attribute bits to detached, or explicitly detach them, or collect the status with <code>pthread_join</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "edited": false, "score": 0, "creation_date": 1484728341, "post_id": 41712501, "comment_id": 70623954, "body": "that was the correct one @david.now it is working good.there is no segmentation problem."}, {"owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "edited": false, "score": 0, "creation_date": 1484728655, "post_id": 41712501, "comment_id": 70624146, "body": "after making changes in the code .after I press key &#39;s&#39; it is not working infinitly throughout the program.it stops after few cycle.I don&#39;t know why it is happenig like this ."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "edited": false, "score": 0, "creation_date": 1484738725, "post_id": 41712501, "comment_id": 70630864, "body": "@NivasB-- you probably want to create detached threads here. I added a bit about this to my answer."}, {"owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "edited": false, "score": 0, "creation_date": 1484741675, "post_id": 41712501, "comment_id": 70632836, "body": "Bowing yeah I will make use of it"}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": true, "score": 0, "last_activity_date": 1484741503, "last_edit_date": 1484741503, "creation_date": 1484719741, "answer_id": 41712501, "question_id": 41712112, "link": "https://stackoverflow.com/questions/41712112/why-is-my-simple-pthreads-program-crashing-with-a-segmentation-fault/41712501#41712501", "title": "Why is my simple pthreads program crashing with a segmentation fault?", "body": "<p>You need to change the function <code>send_function()</code>. <a href=\"https://linux.die.net/man/3/pthread_create\" rel=\"nofollow noreferrer\">According to the man page</a>, this function should take a pointer to <code>void</code> as an argument, and should return a pointer to void:</p>\n\n<pre><code>void * send_function(void *parg)\n{\n  printf(\"\\n Send Thread \\n\");\n  return parg;\n}\n</code></pre>\n\n<p>You also need to correct your function call, which includes a pair of stray parenthesis:</p>\n\n<pre><code>if(pthread_create(&amp;send,NULL,send_function,NULL)) {}\n</code></pre>\n\n<p>As it is, your program will loop printing <code>\"Send Thread\"</code> until your system runs out of resources. You can create detached threads that release system resources when they terminate by adding these lines before the loop in <code>main()</code>:</p>\n\n<pre><code>pthread_attr_t attr;\n\nif (pthread_attr_init(&amp;attr) != 0) {\n    perror(\"Error in pthread_attr_init()\");\n    exit(EXIT_FAILURE);\n}\n\nif (pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_DETACHED) != 0) {\n    perror(\"Error in pthread_attr_setdetachstate()\");\n    exit(EXIT_FAILURE);        \n}\n</code></pre>\n\n<p>Then change the <code>pthread_create()</code> call inside the loop to:</p>\n\n<pre><code>if(pthread_create(&amp;send, &amp;attr, send_function, NULL)) {}\n</code></pre>\n\n<p>After this change your program should print <code>\"Send Thread\"</code> repeatedly, releasing resources after each message is printed, until you stop it.</p>\n"}], "owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1254, "favorite_count": 0, "accepted_answer_id": 41712501, "answer_count": 2, "score": 0, "last_activity_date": 1484750753, "creation_date": 1484717877, "last_edit_date": 1484750753, "question_id": 41712112, "link": "https://stackoverflow.com/questions/41712112/why-is-my-simple-pthreads-program-crashing-with-a-segmentation-fault", "title": "Why is my simple pthreads program crashing with a segmentation fault?", "body": "<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;signal.h&gt;\n#include&lt;unistd.h&gt;//getch();\n#include &lt;termios.h&gt;//getch();\n#include &lt;pthread.h&gt;\nvolatile sig_atomic_t flag = 0;\n\nchar getch()\n{\n  int buf=0;\n  struct termios old= {0};\n  fflush(stdout);\n  if(tcgetattr(0, &amp;old)&lt;0)\n    perror(\"tcsetattr()\");\n  old.c_lflag&amp;=~ICANON;\n  old.c_lflag&amp;=~ECHO;\n  old.c_cc[VMIN]=1;\n  old.c_cc[VTIME]=0;\n  if(tcsetattr(0, TCSANOW, &amp;old)&lt;0)\n    perror(\"tcsetattr ICANON\");\n  if(read(0,&amp;buf,1)&lt;0)\n    perror(\"read()\");\n  old.c_lflag|=ICANON;\n  old.c_lflag|=ECHO;\n  if(tcsetattr(0, TCSADRAIN, &amp;old)&lt;0)\n    perror (\"tcsetattr ~ICANON\");\n  //printf(\"%c\\n\",buf);//to print the value typed.\n  return buf;\n}\n\nvoid *send_function()\n{\n  printf(\"\\n Send Thread \\n\");\n  //return 0;\n}\n\nvoid my_function(int sig)\n{ // can be called asynchronously\n  flag = 1; // set flag\n}\n\nint main ()\n{\n  char selection;//user input(s or r)\n  pthread_t send;\n  while(1)\n  {  \n    signal(SIGINT, my_function);\n    //printf(\"\\n Before SIGINT \\n\");            \n    if(flag)\n    { \n        printf(\"\\n Choose your terminal S or R \\n\");\n        selection=getch();\n        flag = 0;\n    }   \n    if(selection=='s')\n        if(pthread_create(&amp;send,NULL,send_function(),NULL))\n        {\n        fprintf(stderr, \"Error creating thread\\n\");\n        return 1;\n        }\n    else if(selection=='r')\n        printf(\"Receive Function is received\");\n    //printf(\"\\n After SIGINT \\n\"); \n }\n  return 0;  \n\n} \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> nivas@balakrishnan-HCL-Desktop:~/C_sample$ gcc -pthread -o thread thread.c\n\n nivas@balakrishnan-HCL-Desktop:~/C_sample$ ./thread\n\n Choose your terminal S or R\n\n Send Thread\n\n Send Thread\n\n Send Thread\n\n Send Thread\n\n Send Thread\n Segmentation fault (core dumped)\n nivas@balakrishnan-HCL-Desktop:~/C_sample$ ^C\n nivas@balakrishnan-HCL-Desktop:~/C_sample$\n</code></pre>\n\n<p>In the above program I'm getting a segmentation fault. My required output is to print <code>\"Send Thread\"</code> continuosly once I press <code>'s'</code>. I have looked into previous similar questions, but I can't find answer. Can anyone help me?</p>\n"}, {"tags": ["c", "arrays", "c99"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1484715085, "post_id": 41711515, "comment_id": 70618344, "body": "The wikipedia link you point to talks about C99, not C++. <code>gcc</code> may or may not treat C99 code and C++ code same."}, {"owner": {"reputation": 18087, "user_id": 261217, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6a20a7f940e6ba33cde991a80d5b6a43?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/261217/mikhail"}, "edited": false, "score": 3, "creation_date": 1484715118, "post_id": 41711515, "comment_id": 70618353, "body": "Not sure about standard way (as much as &quot;standard&quot; is applicable for &quot;non-standard extension&quot;), but to make a quick test you can compare addresses of <code>valtwo</code> and <code>array[0]</code>. If array is on the stack, they should be adjacent. If on the heap, they would be quite different. This is not 100% reliable, but will work most of the times."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1484715254, "post_id": 41711515, "comment_id": 70618393, "body": "It probably won&#39;t complain until you access outside temporary storage, but who knows for sure?"}, {"owner": {"reputation": 18087, "user_id": 261217, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6a20a7f940e6ba33cde991a80d5b6a43?s=128&d=identicon&r=PG", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/261217/mikhail"}, "edited": false, "score": 0, "creation_date": 1484715257, "post_id": 41711515, "comment_id": 70618396, "body": "See also <a href=\"http://stackoverflow.com/a/13720219/261217\">stackoverflow.com/a/13720219/261217</a>"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1484717973, "post_id": 41711515, "comment_id": 70619325, "body": "Note that a stack-overflow situation is not always obvious, especially if you never write to the items at the end of the array (and maybe not even if you do).  So the fact that &quot;it never complains&quot; shouldn&#39;t be taken as signifying anything about the implementation of the non-standard extension."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1484718594, "post_id": 41711515, "comment_id": 70619552, "body": "@RSahu The Wiki link&#39;s reference to variable arrays is actually about GNU Fortran! and doesn&#39;t support the assertion in any way."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1484720472, "post_id": 41711515, "comment_id": 70620259, "body": "@EJP, that article talks about many languages, including C99 and Fortran, but not C++. I didn&#39;t feel the need to mention any of the languages that are not C/C++."}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1484730399, "post_id": 41711717, "comment_id": 70625229, "body": "I think your reasoning in the first paragraph is flawed. If a memory chunk can be allocated implicitly, then that implicitly allocated chunk can also be deallocated implicitly. It is entirely possible that VLA be implemented with malloc."}, {"owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1484773037, "post_id": 41711717, "comment_id": 70653010, "body": "It could be and that&#39;s the reason why in the second paragraph I state I don&#39;t know if there is a case where allocation happens in the heap but behaves as it is a member of the stack. The other way to reason is anything that is allocated in the stack is determined at compile time. That is not true for VLAs in general. As far as I know, anything that is allocated at run time must be allocated in the heap. So we have a dilemma where allocation requirements require the space to be allocated in the heap since it is resolved at run time but behaves as if it is a member of the stack via scope rules."}, {"owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1484773142, "post_id": 41711717, "comment_id": 70653063, "body": "The true examination, I think, would require to know the heap address space in the virtual address space."}], "tags": [], "owner": {"reputation": 564, "user_id": 7281500, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5d78cf0fbd48e2dabbf5572a88fd9326?s=128&d=identicon&r=PG&f=1", "display_name": "nmd_07", "link": "https://stackoverflow.com/users/7281500/nmd-07"}, "is_accepted": false, "score": 0, "last_activity_date": 1484716788, "last_edit_date": 1484716788, "creation_date": 1484715905, "answer_id": 41711717, "question_id": 41711515, "link": "https://stackoverflow.com/questions/41711515/is-there-a-way-to-check-if-variable-length-arrays-are-created-on-stack-heap/41711717#41711717", "title": "Is there a way to check if variable length arrays are created on stack / heap?", "body": "<p>First I assume you know that any memory chunk allocated in the heap using either malloc or new continues its lifespan throughout the program unless explicitly deallocated. Thus we can conclude, if a variable length array only exists within its scope but not in the lifespan of the program, it is most probably allocated in the stack. </p>\n\n<p>I don't know if there are cases where a chuck of memory is allocated in the heap but behaves as if it is a member of the stack. It is best the see the assembly code for that. Such implementation would probably use dynamic allocation functions/syscalls under the hood.</p>\n\n<p>If it looks like a duck, walks like duck and talks like duck, then it should be safe to assume it is a duck(for the most of the time).</p>\n"}, {"comments": [{"owner": {"reputation": 4369, "user_id": 3102935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/22985d9fffff3b76a11b1f2bccbf2f42?s=128&d=identicon&r=PG&f=1", "display_name": "WorldSEnder", "link": "https://stackoverflow.com/users/3102935/worldsender"}, "edited": false, "score": 0, "creation_date": 1484754366, "post_id": 41711918, "comment_id": 70641955, "body": "That&#39;s not perfectly reliable, but also clever and the idea might be enough for op. In op&#39;s case, you can work with an int directly near the array and check if the addresses of the array and the int are near each other"}], "tags": [], "owner": {"reputation": 1351, "user_id": 2082004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/122477da819584aa22bbd3bbb945b2f6?s=128&d=identicon&r=PG", "display_name": "MSD", "link": "https://stackoverflow.com/users/2082004/msd"}, "is_accepted": false, "score": 1, "last_activity_date": 1484716801, "creation_date": 1484716801, "answer_id": 41711918, "question_id": 41711515, "link": "https://stackoverflow.com/questions/41711515/is-there-a-way-to-check-if-variable-length-arrays-are-created-on-stack-heap/41711918#41711918", "title": "Is there a way to check if variable length arrays are created on stack / heap?", "body": "<p>It might be a tricky question and I have tried some thing like </p>\n\n<pre><code>#include \"iostream\"\n\nint Stack_or_heap(void* ptr)\n{\n int dummy;\n return ptr &gt; &amp;dummy;\n}\n\nint main(int argc, char** argv)\n{\n   int* i = new int();\n   int x, y, z;\n   std::cout &lt;&lt; Stack_or_heap(&amp;x) &lt;&lt; Stack_or_heap(&amp;y) &lt;&lt; Stack_or_heap(&amp;z) &lt;&lt; Stack_or_heap(i);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 1, "last_activity_date": 1484994963, "last_edit_date": 1484994963, "creation_date": 1484731437, "answer_id": 41715533, "question_id": 41711515, "link": "https://stackoverflow.com/questions/41711515/is-there-a-way-to-check-if-variable-length-arrays-are-created-on-stack-heap/41715533#41715533", "title": "Is there a way to check if variable length arrays are created on stack / heap?", "body": "<blockquote>\n  <p>the array size seems too big to fit into stack, but it never complains.</p>\n</blockquote>\n\n<p>By \"never complains\", I presume you mean that the program doesn't crash.</p>\n\n<p>You never touch the memory that you allocate and the compiler was smart enough to prove it and didn't allocate anything.</p>\n\n<p>Let us take the address of the variable, and send it to a function that is defined elsewhere:</p>\n\n<pre><code>int array[valone][valtwo] = {};\ncout &lt;&lt; &amp;array &lt;&lt; endl;\n</code></pre>\n\n<p>Now, the compiler wasn't quite so sure that the array is never accessed. That's because it can't go into the streaming operator which implemented in another translation unit. Perhaps the operator will dereference the pointer; we must make sure that the array exists.</p>\n\n<p>Segfault crashed this program on my first attempt. The stack was overflown.</p>\n\n<hr>\n\n<p>I suppose this kind of crash test is a way to test if VLA is on the stack.</p>\n\n<p>Mikhail's suggestion in comments to compare adjacency of automatic variables to the VLA is a decent platform dependant idea, but it can only work if you allocate small enough VLA that it doesn't crash the program.</p>\n"}], "owner": {"reputation": 6306, "user_id": 5662469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZYgSJ.png?s=128&g=1", "display_name": "Deepak K Gupta", "link": "https://stackoverflow.com/users/5662469/deepak-k-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 41715533, "answer_count": 3, "score": 3, "last_activity_date": 1484994963, "creation_date": 1484714678, "last_edit_date": 1484839331, "question_id": 41711515, "link": "https://stackoverflow.com/questions/41711515/is-there-a-way-to-check-if-variable-length-arrays-are-created-on-stack-heap", "title": "Is there a way to check if variable length arrays are created on stack / heap?", "body": "<p>As I understood that the following code generate variable length arrays (via a non standard extension of C++).</p>\n\n<pre><code>int main() \n{\n    int valone = rand();\n    int valtwo = rand();\n    int array[valone][valtwo];\n    // Printing size\n    cout &lt;&lt; sizeof(array) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Is there any way to check whether its generated on stack or heap? The wikipedia description <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">here</a> says that <code>gcc</code> generates the same in stack, but when I tried above code, most of the times, the array size seems too big to fit into stack, but it never complains.</p>\n\n<p>Note: This code works only with gcc &amp; clang and not with visual studio</p>\n"}]