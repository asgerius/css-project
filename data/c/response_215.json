[{"tags": ["java", "c++", "c", "linux"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550722568, "post_id": 54797006, "comment_id": 96375640, "body": "Interesting NaN info, yet what is the question/goal?"}], "answers": [{"comments": [{"owner": {"reputation": 406, "user_id": 4029250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a1142f185334c43f0b8821ddd38c7a?s=128&d=identicon&r=PG&f=1", "display_name": "klog", "link": "https://stackoverflow.com/users/4029250/klog"}, "edited": false, "score": 0, "creation_date": 1550707497, "post_id": 54797140, "comment_id": 96372123, "body": "that seems like a reasonable case, since it would only be checked in the event of a bad parse in the first place, thus we wouldn&#39;t be checking for every valid parse. I&#39;ll wait a little while to see if anyone has anything else to say on the matter."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 406, "user_id": 4029250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a1142f185334c43f0b8821ddd38c7a?s=128&d=identicon&r=PG&f=1", "display_name": "klog", "link": "https://stackoverflow.com/users/4029250/klog"}, "edited": false, "score": 0, "creation_date": 1550708066, "post_id": 54797140, "comment_id": 96372249, "body": "It might be worth tracking down what other libcs use for those values (I think the Windows CRT uses something like <code>1.#QNAN</code>?) and accounting for them too."}, {"owner": {"reputation": 406, "user_id": 4029250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a1142f185334c43f0b8821ddd38c7a?s=128&d=identicon&r=PG&f=1", "display_name": "klog", "link": "https://stackoverflow.com/users/4029250/klog"}, "edited": false, "score": 0, "creation_date": 1550809294, "post_id": 54797140, "comment_id": 96415215, "body": "The functionality of how we are passing floating-point has been bothering me for a while. Basically I\u2019m at the mercy of how it\u2019s been implemented in the languages and I don\u2019t see changes coming to accommodate either side. Your answer covers my question given that Java and libc are just different. That said, I think handling the format on the C side of things would potentially be more efficient as I\u2019d be doing binary comparison via isnan and isfinite as opposed to string comparisons in Java, but on Java the comparison would only occur if parsing fails first."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": true, "score": 1, "last_activity_date": 1550707111, "creation_date": 1550707111, "answer_id": 54797140, "question_id": 54797006, "link": "https://stackoverflow.com/questions/54797006/double-value-that-is-nan-output-as-a-string-as-nan/54797140#54797140", "title": "Double value that is NaN output as a string as &quot;nan&quot;", "body": "<p>Why not just use something like this in your java code for parsing a double?</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>double parseDouble(String s) throws NumberFormatException {\n  try {\n    return Double.valueOf(s);\n  } catch (NumberFormatException e) {\n    if (s.equalsIgnoreCase(\"nan\")) {\n      return Double.NaN;\n    } else if (s.equalsIgnoreCase(\"inf\") || s.equalsIgnoreCase(\"+inf\")) {\n      return Double.POSITIVE_INFINITY;\n    } else if (s.equalsIgnoreCase(\"-inf\")) {\n      return Double.NEGATIVE_INFINITY;\n    } else {\n      throw e; // Invalid string\n    }\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1550809966, "last_edit_date": 1592644375, "creation_date": 1550739999, "answer_id": 54803099, "question_id": 54797006, "link": "https://stackoverflow.com/questions/54797006/double-value-that-is-nan-output-as-a-string-as-nan/54803099#54803099", "title": "Double value that is NaN output as a string as &quot;nan&quot;", "body": "<p>The Linux case is (a) correct behaviour according to <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#7.21.6.1p8\" rel=\"nofollow noreferrer\">ISO/IEC 9899:2001</a>:</p>\n<blockquote>\n<p>[<code>%e</code>, <code>%E</code>]</p>\n<p>[...] A <code>double</code> argument representing an infinity or NaN is converted in the style of an <code>f</code> or <code>F</code> conversion specifier.</p>\n</blockquote>\n<p>and the text for</p>\n<blockquote>\n<p>A double argument representing an infinity is converted in one of the styles <code>[-]inf</code> or <code>[-]infinity</code> -- which style is implementation-defined. A double argument representing a NaN is converted in one of the styles <code>[-]nan</code> or <code>[-]nan(n-char-sequence)</code> -- which style, and the meaning of any n-char-sequence, is implementation-defined. The F conversion specifier produces <code>INF</code>, <code>INFINITY</code>, or <code>NAN</code> instead of <code>inf</code>, <code>infinity</code>, or <code>nan</code>, respectively.277)</p>\n</blockquote>\n<p>I.e. the safest in Java would be to try to parse the double, and if that fails, lowercase the <code>String</code> and test the existence of <code>-</code> as the first character and the remainder after the possible sign with  <code>.startsWith(&quot;nan&quot;)</code> and <code>.startsWith(&quot;inf&quot;)</code></p>\n<p>Of course this doesn't help if you need to support the non-standards-conforming Windows C runtimes.</p>\n"}, {"tags": [], "owner": {"reputation": 406, "user_id": 4029250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a1142f185334c43f0b8821ddd38c7a?s=128&d=identicon&r=PG&f=1", "display_name": "klog", "link": "https://stackoverflow.com/users/4029250/klog"}, "is_accepted": false, "score": 0, "last_activity_date": 1550810224, "creation_date": 1550810224, "answer_id": 54820150, "question_id": 54797006, "link": "https://stackoverflow.com/questions/54797006/double-value-that-is-nan-output-as-a-string-as-nan/54820150#54820150", "title": "Double value that is NaN output as a string as &quot;nan&quot;", "body": "<p>A potentially more universal option would be to convert the floating-point number into hex when written to redis and then converted back when read. This would ensure that there wouldn't be any precision loss by converting it to a decimal string, but also cover the +/-Inf and NaN cases.</p>\n\n<p>This is possible since both sides are using IEEE floating-point numbers.</p>\n"}], "owner": {"reputation": 406, "user_id": 4029250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a1142f185334c43f0b8821ddd38c7a?s=128&d=identicon&r=PG&f=1", "display_name": "klog", "link": "https://stackoverflow.com/users/4029250/klog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 54797140, "answer_count": 3, "score": 0, "last_activity_date": 1550810224, "creation_date": 1550706188, "last_edit_date": 1550723374, "question_id": 54797006, "link": "https://stackoverflow.com/questions/54797006/double-value-that-is-nan-output-as-a-string-as-nan", "title": "Double value that is NaN output as a string as &quot;nan&quot;", "body": "<p>I have a C/C++ application that writes numeric values into redis as a string. I also have a Java application that will read these values out of redis. On occasion for valid reasons, we end up with a floating-point value that has a value of <code>NaN</code> or <code>-NaN</code>. However, when using <code>sprintf(charPtr, \"%e\", dblVal);</code>, the value is output as <code>nan</code>. I also tried the same statement with <code>%E</code>, and it resulted in <code>NAN</code>. When Java attempts to parse via <code>Float.parseFloat()</code> or <code>Double.parseDouble</code> it throws a NumberFormatException.</p>\n\n<p>This application has been ported from Solaris to Linux and subsequently gone through some Linux upgrades and at some point \"NaN\" became \"nan\". I can't say for certain on what upgrade ultimately introduced this behavior.</p>\n\n<p>I have gone through an excercise utilizing cmath's <code>std::isfinite()</code> and <code>std::isnan()</code> and can ultimately define my own valid <code>(-)NaN</code> or <code>(-)Infinity</code> strings, but this doesn't seem like I need to be reinventing normalized NaN and Infinity strings. Infinity may be a bit different as the C side outputs <code>inf</code> yet Java wants <code>Infinity</code>.</p>\n\n<p>Ultimately I need to be able to decode data written by the C++ app in Java. nan and inf cannot be decoded by Java as written. My focus was on NaN, but Infinity is a case that should be covered. </p>\n"}, {"tags": ["c", "checksum"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1550702827, "post_id": 54796296, "comment_id": 96370798, "body": "I can tell you that you definitely <i>don&#39;t</i> want to use <code>sscanf(char_array, &quot;%d&quot;, &amp;i)</code>; that converts a written-out number like <code>&quot;1234&quot;</code> to binary, whereas this sample code is meant to treat a sequence of N raw bytes as if they are already a sequence of (N/2) 16-bit binary numbers.  I can also tell you that the code shown is very old and does things that are considered incorrect in modern C and therefore you probably shouldn&#39;t be using it as a reference.  Unfortunately I don&#39;t have a better reference for you."}], "answers": [{"comments": [{"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1550703855, "post_id": 54796603, "comment_id": 96371158, "body": "I had noticed that solution online as well, but didn&#39;t use it as in my case, I am trying to calculate an <code>int</code>, and not an <code>unsigned int</code> checksum and am unable to import the library for <code>uint16_6</code>.  My apologies if I should have specified that earlier."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1550738965, "post_id": 54796603, "comment_id": 96382244, "body": "@Paradox it is <code>uint16_t</code> and it is available in <code>&lt;stdint.h&gt;</code>."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1551113427, "post_id": 54796603, "comment_id": 96512395, "body": "@Paradox If you don&#39;t have <code>stdint.h</code>, then replace all uses of <code>uint16_t</code> with <code>unsigned short</code>, and also include <code>limits.h</code> and put <code>#if USHRT_MAX != 65535</code> <code>#error &quot;Code below assumes unsigned short is 16 bits&quot;</code> <code>#endif</code> right after the includes."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1550703529, "creation_date": 1550703529, "answer_id": 54796603, "question_id": 54796296, "link": "https://stackoverflow.com/questions/54796296/rfc-1071-checksum-for-char-array/54796603#54796603", "title": "RFC 1071 checksum for char array", "body": "<p>Since the inner loop processes the data in 16-bit increments, <code>addr</code> must be a pointer to a 16-bit value, i.e. <code>uint16_t * addr</code>.</p>\n\n<p><code>checksum</code> is whatever data type you wish to store the final result in. If you're calculating a 16-bit checksum, it would also be <code>uint16_t</code>.</p>\n\n<p>Note that <code>sum</code> should probably be <code>unsigned long</code>, not <code>long</code>. It works in practice because network packets are not generally big enough that the checksum will overflow a <code>long</code> (the packet would have to be at least 32K bytes). But if you're writing general purpose code you should code defensively.</p>\n\n<p>You can find an implementation that uses appropriate, portable data types at:</p>\n\n<p><a href=\"http://www.microhowto.info/howto/calculate_an_internet_protocol_checksum_in_c.html\" rel=\"nofollow noreferrer\">http://www.microhowto.info/howto/calculate_an_internet_protocol_checksum_in_c.html</a></p>\n\n<pre><code>uint16_t ip_checksum(void* vdata,size_t length) {\n    // Cast the data pointer to one that can be indexed.\n    char* data=(char*)vdata;\n\n    // Initialise the accumulator.\n    uint32_t acc=0xffff;\n\n    // Handle complete 16-bit blocks.\n    for (size_t i=0;i+1&lt;length;i+=2) {\n        uint16_t word;\n        memcpy(&amp;word,data+i,2);\n        acc+=ntohs(word);\n        if (acc&gt;0xffff) {\n            acc-=0xffff;\n        }\n    }\n\n    // Handle any partial block at the end of the data.\n    if (length&amp;1) {\n        uint16_t word=0;\n        memcpy(&amp;word,data+length-1,1);\n        acc+=ntohs(word);\n        if (acc&gt;0xffff) {\n            acc-=0xffff;\n        }\n    }\n\n    // Return the checksum in network byte order.\n    return htons(~acc);\n}\n</code></pre>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 54796603, "answer_count": 1, "score": 2, "last_activity_date": 1550703529, "creation_date": 1550701990, "last_edit_date": 1550702431, "question_id": 54796296, "link": "https://stackoverflow.com/questions/54796296/rfc-1071-checksum-for-char-array", "title": "RFC 1071 checksum for char array", "body": "<p>I'm having difficulty understanding the following checksum algorithm from <a href=\"https://tools.ietf.org/html/rfc1071\" rel=\"nofollow noreferrer\">RFC 1071</a>:  </p>\n\n<pre><code>The following \"C\" code algorithm computes the checksum with an inner\nloop that sums 16-bits at a time in a 32-bit accumulator.\n\nin 6\n{\n    /* Compute Internet Checksum for \"count\" bytes\n    *         beginning at location \"addr\".\n    */\n    register long sum = 0;\n\n    while( count &gt; 1 )  {\n        /*  This is the inner loop */\n        sum += * (unsigned short) addr++;\n        count -= 2;\n    }\n\n    /*  Add left-over byte, if any */\n    if( count &gt; 0 )\n        sum += * (unsigned char *) addr;\n\n    /*  Fold 32-bit sum to 16 bits */\n    while (sum&gt;&gt;16)\n        sum = (sum &amp; 0xffff) + (sum &gt;&gt; 16);\n\n    checksum = ~sum;\n}\n</code></pre>\n\n<p>My goal is to take a char array and compute its checksum but I am unsure of what the undefined variables are.  What are the data types of <code>addr</code> and <code>checksum</code> and/or,  how could I convert a char array to a format that could be used in the check-summing process? I am aware that count is the number of bytes in whatever is stored at addr.</p>\n\n<p>Edit:  So far, I am thinking to convert the char array to an integer, then getting the number of bytes:</p>\n\n<pre><code>int char_int = sscanf(char_array, \"%d\", &amp;i);\nint addr = char_int;\nint count = sizeof(char_int);\n</code></pre>\n"}, {"tags": ["c", "variables", "static"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1550700271, "post_id": 54795902, "comment_id": 96369925, "body": "It can behave as a pink unicorn, as the behavior of this code is undefined."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1550700335, "post_id": 54795902, "comment_id": 96369952, "body": "Undefined behaviour includes doing what you expect; the function is called repeatedly, there is no reason to think it will change memory addresses."}, {"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1550700450, "post_id": 54795902, "comment_id": 96370001, "body": "This is a complete guess, but I&#39;d think that your compiler/runtime is initializing <code>i</code> at the same address in memory on each calling of the function and, because you don&#39;t instantiate <code>i</code> afterwards, inherits its previous value."}, {"owner": {"reputation": 3, "user_id": 10671812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UNcX3.jpg?s=128&g=1", "display_name": "Ura", "link": "https://stackoverflow.com/users/10671812/ura"}, "edited": false, "score": 0, "creation_date": 1550700830, "post_id": 54795902, "comment_id": 96370128, "body": "@ Abion47   so .. does it depend on the type of the compiler?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550702012, "post_id": 54795902, "comment_id": 96370526, "body": "@Ura It can depend on what compiler you&#39;re using, on the time of day the program runs, on the activity of solar winds, on ... but to answer your question, no, <code>i</code> is not <code>static</code>. <code>i</code> has <a href=\"https://stackoverflow.com/questions/13423673/what-is-indeterminate-value\">indeterminate value</a> and when you increment an indeterminate value you get another indeterminate value."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1550707132, "post_id": 54795902, "comment_id": 96372038, "body": "When a variable is unitialised, it will <i>typically</i> have whatever value happens to be in the memory in which the variable is instantiated.  Because in this case you are simply calling the same function repeatedly with no intermediate code, the stack frame will be established at the same location each time, so the variable will be instantiated at the same address each time, and that memory is not explicitly modified by initialisation."}], "answers": [{"tags": [], "owner": {"reputation": 1899, "user_id": 8854921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b76055b306b4dbab08ee558957f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Bo R", "link": "https://stackoverflow.com/users/8854921/bo-r"}, "is_accepted": true, "score": 4, "last_activity_date": 1550734436, "last_edit_date": 1550734436, "creation_date": 1550700436, "answer_id": 54795977, "question_id": 54795902, "link": "https://stackoverflow.com/questions/54795902/is-a-not-initialized-local-variable-static/54795977#54795977", "title": "is a not initialized local variable static?", "body": "<p>The value is unspecified, so anything goes. But, likely the same memory is reused for each call to <code>funct</code> and with that, the same memory is reused and the <code>i</code> just pick up the old value left from the previous run.</p>\n"}], "owner": {"reputation": 3, "user_id": 10671812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UNcX3.jpg?s=128&g=1", "display_name": "Ura", "link": "https://stackoverflow.com/users/10671812/ura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1550700500, "accepted_answer_id": 54795977, "answer_count": 1, "score": -2, "last_activity_date": 1550734436, "creation_date": 1550700037, "last_edit_date": 1550700248, "question_id": 54795902, "link": "https://stackoverflow.com/questions/54795902/is-a-not-initialized-local-variable-static", "closed_reason": "Duplicate", "title": "is a not initialized local variable static?", "body": "<p>if the variable is initialized (i = 0), it's still 1 each time the function func is called, BUT</p>\n\n<p>when i is not initialized:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint funct(void);\nint main(void)\n{\n    funct();\n    funct();\n    funct();\n\n    return 0;\n}\n\nint funct(void)\n{\n    int i;  \n    static int j = 0;\n\n    i++;\n    j++;\n\n    printf(\" i = %d         j = %d\\n\", i, j);\n}\n</code></pre>\n\n<p>the output is</p>\n\n<pre><code> i = 1      j = 1\n i = 2      j = 2\n i = 3      j = 3\n</code></pre>\n\n<p>I don't understand why the variable i behaves like a static one! </p>\n"}, {"tags": ["c", "libtiff", "libzip"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1550699515, "post_id": 54795605, "comment_id": 96369642, "body": "Save the tiff data to a temporary file and give it the path to that file?"}, {"owner": {"reputation": 6120, "user_id": 9214517, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uHHGLaUqJK4/AAAAAAAAAAI/AAAAAAAAAAA/EMWzo-f2N9c/photo.jpg?sz=128", "display_name": "adrtam", "link": "https://stackoverflow.com/users/9214517/adrtam"}, "edited": false, "score": 1, "creation_date": 1550699527, "post_id": 54795605, "comment_id": 96369647, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4624144/c-libtiff-read-and-save-file-from-and-to-memory\">C++ LibTiff - Read and Save file from and to Memory</a>"}, {"owner": {"reputation": 645, "user_id": 3979693, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/a1a61f4fd16dc3eb82cc7deee1126761?s=128&d=identicon&r=PG&f=1", "display_name": "lac", "link": "https://stackoverflow.com/users/3979693/lac"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1550704121, "post_id": 54795605, "comment_id": 96371225, "body": "@Shawn Yep I&#39;m aware I can save to temporary file but I feel like thats likely to be slow compared to if I can do it all in memory."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1550704984, "post_id": 54795605, "comment_id": 96371487, "body": "I&#39;d say get it working first and see, especially if it only requires an hour or two of work to do so."}], "owner": {"reputation": 645, "user_id": 3979693, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/a1a61f4fd16dc3eb82cc7deee1126761?s=128&d=identicon&r=PG&f=1", "display_name": "lac", "link": "https://stackoverflow.com/users/3979693/lac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550704067, "creation_date": 1550698625, "last_edit_date": 1550704067, "question_id": 54795605, "link": "https://stackoverflow.com/questions/54795605/reading-a-tiff-file-in-c-from-inside-zip", "title": "Reading a .tiff file in c from inside zip", "body": "<p>I have multiple tiff images stored inside a zip file and would like to read their pixel values in c. I am very new to c so please forgive the dodgy code. I have got to the point where I have a <code>char *</code> with the contents of the tiff file but can't seem to work out how to now process that with libtiff (or something similar). libtiff seems to require that I pass TIFFOpen a filename to open. I could write the tiff to a temporary file but it feels like there must be a more efficient way. </p>\n\n<p>So far I have:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;zip.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    //Open the ZIP archive\n    int err = 0;\n    struct zip *z = zip_open(\"test.zip\", 0, &amp;err);\n\n    // Determine how many files are inside and iterate through them\n    int num_files = zip_get_num_entries(z, 0);\n    printf(\"%u\\n\", num_files);\n\n    int i;\n    for (i=0; i &lt; num_files; i++)\n    {\n        const char * filename;\n        filename = zip_get_name(z, i, 0);\n\n        // If the file name ends in .tif\n        if (strlen(filename) &gt; 4 &amp;&amp; !strcmp(filename + strlen(filename) - 4, \".tif\"))\n        {\n            printf(\"%s\\n\", filename);\n\n            // Get information about file\n            struct zip_stat st;\n            zip_stat_init(&amp;st);\n            zip_stat(z, name, 0, &amp;st);\n            printf(\"%lld\\n\", st.size);\n\n            // Allocate memory for decompressed contents\n            char *contents;\n            contents = (char *)malloc(st.size);\n\n            // Read the file\n            struct zip_file *f = zip_fopen(z, filename, 0);\n            zip_fread(f, contents, st.size);\n            zip_fclose(f);\n\n            // Do something with the contents\n\n            // Free memory\n            free(contents);\n        }\n    }\n    //And close the archive\n    zip_close(z);\n}\n</code></pre>\n\n<p>EDIT: My question is similar to <a href=\"https://stackoverflow.com/questions/4624144\">this one</a> but the accepted answer there relates to c++ and I'm not sure how to translate it to straight c.</p>\n"}, {"tags": ["c", "loops", "decimal"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1550698237, "post_id": 54795501, "comment_id": 96369123, "body": "what is your question?"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1550698516, "post_id": 54795501, "comment_id": 96369244, "body": "the reason you  are using <code>closest=num[0]</code> is because you are using <code>closest</code> once in the if statement BEFORE <code>closest = num[i]</code> it&#39;s the if absolute value of the difference between the current number and the average <code>fabs(num[i] - average</code> is less than the absolute value of difference between the current known closest value and average <code>fabs(closest - average)</code> replace the closest value by the current number <code>closest = num[i]</code>"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1550698546, "post_id": 54795501, "comment_id": 96369254, "body": "OP&#39;s questions are in the comments ...."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1550703672, "last_edit_date": 1550703672, "creation_date": 1550702991, "answer_id": 54796502, "question_id": 54795501, "link": "https://stackoverflow.com/questions/54795501/i-am-confused-about-my-output-that-gives-the-closest-average-of-sum-of-numbers-e/54796502#54796502", "title": "I am confused about my output that gives the closest average of sum of numbers entered by the user.(rounds the decimal to a whole number)", "body": "<p>Your title and code comments suggest that you think the program (always) returns the whole number closest to the average of its inputs.  It does not.  It returns the <em>input</em> that is closest to the average of all the inputs.  That will of course be a whole number if all the inputs are whole numbers, but you're inputting them as floating-point numbers, so they need not be whole numbers.  The output therefore needn't be one, either.</p>\n\n<p>For example, if these inputs are presented to your program:</p>\n\n<blockquote>\n  <p>1 2 2 2 2 1.8</p>\n</blockquote>\n\n<p>, it will accept them and output</p>\n\n<blockquote>\n  <p>Closest is 1.800000</p>\n</blockquote>\n\n<p>.  Additionally, the output is not certain to be particularly close to the average.  For example, try these inputs:</p>\n\n<blockquote>\n  <p>1 1 1 1 1 1000000</p>\n</blockquote>\n\n<p>.  You should get</p>\n\n<blockquote>\n  <p>Closest is 1.000000</p>\n</blockquote>\n\n<p>.  That's a whole number, but it misses the average by about 166666.</p>\n\n<p>With respect to the questions embedded in the code:</p>\n\n<blockquote>\n<pre><code>    closest = num[0]; //why are we even using this??? //initialize?\n</code></pre>\n</blockquote>\n\n<p>The loop immediately following that in the code looks for inputs that are closer to the average than <code>closest</code> is.  That's meaningless if <code>closest</code> has not been assigned a value, and it potentially leads to the wrong result if <code>closest</code> does not contain a value equal to one of the inputs.  Of course, with <code>closest</code> starting with the same value as <code>num[0]</code>, the output would be the same if the loop started testing at index 1 instead of index 0.</p>\n\n<blockquote>\n<pre><code>   //where is it being rounded to the closest number??\n</code></pre>\n</blockquote>\n\n<p>It is not rounded.  At that point, <code>closest</code> already contains a value equal to one of the inputs.  It does not need to be rounded, and in fact rounding would in many cases yield a result that was not among the inputs.</p>\n"}], "owner": {"reputation": 59, "user_id": 9426531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e088b6de203b8255d4c4abafcc46802?s=128&d=identicon&r=PG&f=1", "display_name": "Su.she", "link": "https://stackoverflow.com/users/9426531/su-she"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550703672, "creation_date": 1550698064, "question_id": 54795501, "link": "https://stackoverflow.com/questions/54795501/i-am-confused-about-my-output-that-gives-the-closest-average-of-sum-of-numbers-e", "title": "I am confused about my output that gives the closest average of sum of numbers entered by the user.(rounds the decimal to a whole number)", "body": "<p>Complete the following program to find the closest number to average in the array.\n    For example, the array {2, 4, 6, 3, 9, 10} has average of 5.666667 and closest number to average\n    in the array is 6. Note that closest number can be larger than or smaller than the average.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint main()\n{\n    int i;\n    double num[6],average, sum=0, closest;\n    printf(\"Enter 6 doubles\\n\"); //2,4,6,9,3,10\n\n    for (i=0; i&lt;6; i++)\n        scanf(\"%lf\",&amp;num[i]);\n\n    //professor's code\n    for (i=0; i&lt;6; i++)\n        sum += num[i]; //sum=34\n\n    average=sum/6; //5.6666667\n    closest = num[0]; //why are we even using this??? //initialize?\n\n    for (i=0; i&lt;6; i++)\n        if(fabs(num[i]-average) &lt; fabs(closest-average)) //|6-5.7|&lt;|0-5.7|-&gt; 0.7&lt;5.7-&gt;true \n            closest = num[i]; // why is it giving 6?? \n   //where is it being rounded to the closest number??\n\n    //professor's code ends     \n\n\n    printf(\"Closest is %lf\\n\", closest);\n    return(0);\n\n}\n\n//Output:\n//Closest is 6\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 6, "creation_date": 1550697543, "post_id": 54795376, "comment_id": 96368820, "body": "mallocing the struct doesn&#39;t perform the malloc inside it. You need mallocs for members too"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 6, "creation_date": 1550697563, "post_id": 54795376, "comment_id": 96368828, "body": "<code>free(temp); return temp;</code>? That means you return a dangling pointer"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1550697580, "post_id": 54795376, "comment_id": 96368836, "body": "As an aside, please don&#39;t hide pointers behind typedefs.  It makes code harder to understand."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1550697610, "post_id": 54795376, "comment_id": 96368848, "body": "why not just <code>struct PCB pcb;</code> in your structure? why a pointer there?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1550697656, "post_id": 54795376, "comment_id": 96368874, "body": "checking if temp is NULL after dereferencing it isn&#39;t that useful too"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1550730263, "post_id": 54795376, "comment_id": 96377962, "body": "<code>temp-&gt;pcb</code> does not point anywhere useful."}], "owner": {"reputation": 23, "user_id": 10953877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27244b3933ddd2a5147a1b414f0ef152?s=128&d=identicon&r=PG&f=1", "display_name": "newcoder00", "link": "https://stackoverflow.com/users/10953877/newcoder00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550697404, "creation_date": 1550697404, "question_id": 54795376, "link": "https://stackoverflow.com/questions/54795376/how-to-initialize-nested-structs", "title": "How to initialize nested structs", "body": "<p>I have this code in one file:</p>\n\n<pre><code>struct ReadyQueue {\n    struct PCB *pcb;\n    struct ReadyQueue *next;\n};\n\nextern struct CPU new_cpu;\n\ntypedef struct ReadyQueue *node;\n\nnode* head;\n\nnode createNode() {\n    node temp;\n    temp = (node)malloc(sizeof(struct ReadyQueue));\n\n    if (temp == NULL) {\n        printf(\"Error creating node\");\n        exit(0);\n    }\n\n    temp-&gt;next = NULL;\n    free(temp);\n\n    return temp;\n}\n\nnode* head;\n\nvoid addToReady(FILE *p) {\n\n    node temp;\n    temp = createNode();\n\n    temp-&gt;pcb-&gt;PC = p;  // error here\n\n    if (temp == NULL) {\n        printf(\"Error\");\n    }\n\n}\n</code></pre>\n\n<p>Which creates a linked list of nodes. In my addToReady function, I am having trouble setting the PCB value which has another struct declared in another file:</p>\n\n<pre><code>struct PCB {\n  FILE *PC;\n};\n</code></pre>\n\n<p>I am having the error in <code>temp-&gt;pcb-&gt;PC=p</code> and its giving me a <code>Segmentation Fault 11</code> error.</p>\n"}, {"tags": ["c", "arrays", "flexible-array-member"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550696986, "post_id": 54795235, "comment_id": 96368583, "body": "this looks fishy: <code>sizeof ( sizeof (cell) + cell_size * sizeof(node))</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550697272, "post_id": 54795235, "comment_id": 96368706, "body": "The FAM is not included in the size of the structure. So when you&#39;re indexing the <code>group</code> array, it won&#39;t include the size of the <code>elem</code> array in the nested <code>cell</code>."}, {"owner": {"reputation": 336, "user_id": 4362960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/180e8f44c786a6a3d090d320627f0745?s=128&d=identicon&r=PG&f=1", "display_name": "cyclone125", "link": "https://stackoverflow.com/users/4362960/cyclone125"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550697397, "post_id": 54795235, "comment_id": 96368760, "body": "@ChristianGibbons Yes, may be this calculation is incorrect, but the problem is not allocation, but incorrect behavior of code. Even if I set <code>malloc(10000)</code> the output is still incorrect."}, {"owner": {"reputation": 336, "user_id": 4362960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/180e8f44c786a6a3d090d320627f0745?s=128&d=identicon&r=PG&f=1", "display_name": "cyclone125", "link": "https://stackoverflow.com/users/4362960/cyclone125"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550697511, "post_id": 54795235, "comment_id": 96368808, "body": "@Barmar So, there is no way to make nested flexible arrays working? Something similar?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1550697706, "post_id": 54795235, "comment_id": 96368890, "body": "Add <code>-pedantic</code> warnings <code>&quot;warning: invalid use of structure with flexible array member - cell group[];&quot;</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550697716, "post_id": 54795235, "comment_id": 96368899, "body": "Use a flexible array of <code>cell*</code> pointers. <code>cell *group[]</code>."}, {"owner": {"reputation": 507, "user_id": 2654727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c319a24a493153df59e86b43ff78fde0?s=128&d=identicon&r=PG", "display_name": "Tom Drake", "link": "https://stackoverflow.com/users/2654727/tom-drake"}, "edited": false, "score": 0, "creation_date": 1550697869, "post_id": 54795235, "comment_id": 96368967, "body": "Trying to map a single contiguous block of memory to a complex set of nested structures is not the sort of thing you find in the average C program. And seems like an optimization, and difficult to maintain. If you want to understand what&#39;s going on here, check out the addresses of the various structures, arrays, and elements, relative to the address returned from malloc. These addresses won&#39;t line up with what your expectation is. And you will see what is actually happening in memory."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550715572, "post_id": 54795235, "comment_id": 96373947, "body": "Suggest <code>typedef struct {     int len;     cell group[]; } obj;</code> --&gt; <code>typedef struct {     int len;     cell *group[]; } obj;</code>  (  --&gt;  <code>*</code> and adjust code accordingly.)"}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 2, "last_activity_date": 1550697944, "creation_date": 1550697944, "answer_id": 54795472, "question_id": 54795235, "link": "https://stackoverflow.com/questions/54795235/flexible-array-of-flexible-arrays-in-c/54795472#54795472", "title": "Flexible array of flexible arrays in C", "body": "<p>Correct ... there is no way to make \"nested flexible arrays\".</p>\n\n<p><strong>All</strong> members of an array must have the same size. You must have</p>\n\n<pre><code>sizeof arr[i] == sizeof arr[j]\n</code></pre>\n\n<p>For all <code>i</code>, <code>j</code> within array boundaries.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1550701239, "post_id": 54795730, "comment_id": 96370244, "body": "Flexible array members are neither static or <code>static</code>. Each flexible array member must be the last member of a structure with at least one other member, but there is no reason you cannot have many of them in a translation unit. (Is that what you meant by \u201ccompilation unit\u201d?) And, if somebody attempts to construct an array of structures containing flexible array members, there is no reason they would all \u201cpoint\u201d to the same address. If anything, the flexible array member would be near (plus or minus some padding) the beginning of the next structure, not its last member."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1550701493, "post_id": 54795730, "comment_id": 96370344, "body": "Now we may be talking about the same thing with different terminology. If you have <code>struct foo { int a; int fam[]; }</code> you cannot declare an array of <code>foo</code> because <code>fam</code> will have the same address. While not technically <code>static</code> the behavior is the same. I&#39;ll look for the SO link that discussed this in detail. <a href=\"https://stackoverflow.com/questions/36118536/how-does-an-array-of-structures-with-flexible-array-members-behave\">How does an array of structures with flexible array members behave?</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1550702950, "post_id": 54795730, "comment_id": 96370841, "body": "@EricPostpischil alright, I think I&#39;ve taken care of the terminology and the effect of where declaring an array of a stuct with a FAM would cause the arrayed FAM members to point. Not the &quot;same&quot; location, the &quot;same&quot; location relative to each array element (ending up between adjacent array elements containing the FAM)."}, {"owner": {"reputation": 336, "user_id": 4362960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/180e8f44c786a6a3d090d320627f0745?s=128&d=identicon&r=PG&f=1", "display_name": "cyclone125", "link": "https://stackoverflow.com/users/4362960/cyclone125"}, "edited": false, "score": 0, "creation_date": 1550798713, "post_id": 54795730, "comment_id": 96413187, "body": "@DavidC.Rankin Thank you, the code works fine. I appreciate your answer."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1550702724, "last_edit_date": 1550702724, "creation_date": 1550699157, "answer_id": 54795730, "question_id": 54795235, "link": "https://stackoverflow.com/questions/54795235/flexible-array-of-flexible-arrays-in-c/54795730#54795730", "title": "Flexible array of flexible arrays in C", "body": "<p>Structures with flexible array members cannot be used as members to another structure or in an array. You can only have one FAM. Otherwise, if you attempt to declare an array of FAM, each FAM member of the array of struct would point to a memory location between adjacent array members -- giving you the incorrect overwritten results you see.</p>\n\n<p>For a complete discussion on the C-Standard Sections applicable see: <a href=\"https://stackoverflow.com/questions/36118536/how-does-an-array-of-structures-with-flexible-array-members-behave\">How does an array of structures with flexible array members behave?</a></p>\n\n<blockquote>\n  <p><code>\"So, there is no way to make nested flexible arrays working?\"</code></p>\n</blockquote>\n\n<p>Answer: NO</p>\n\n<p>That would violate <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.7.2.1 Structure and union specifiers(p3)</a></p>\n\n<blockquote>\n  <p><code>\"Something similar?\"</code></p>\n</blockquote>\n\n<p>Answer: Yes</p>\n\n<p>All you need to do is make <code>node elem[];</code> <code>node *elem;</code> and then allocate <code>cell_size * sizeof (node)</code> bytes per <code>set-&gt;group[i].elem</code>, e.g.</p>\n\n<pre><code>typedef struct {\n    int len;\n    node *elem;\n} cell;\n...\n    obj *set = malloc (sizeof *set + obj_size * sizeof (cell));\n    ...\n    for (int i = 0; i &lt; obj_size; i++) {\n        set-&gt;group[i].len = cell_size;\n        set-&gt;group[i].elem = malloc (cell_size * sizeof (node));\n</code></pre>\n\n<p>That will allocate <code>cell_size * sizeof (node)</code> for each <code>set-&gt;group[i].elem</code> doing what you want, e.g.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct {\n    int x;\n    int y;\n} node;\n\ntypedef struct {\n    int len;\n    node *elem;\n} cell;\n\n\ntypedef struct {\n    int len;\n    cell group[];\n} obj;\n\n\nint cell_size = 3;\nint obj_size = 4;\n\nint main (void) {\n\n    obj *set = malloc (sizeof *set + obj_size * sizeof (cell));\n    set-&gt;len = obj_size;\n\n    for (int i = 0; i &lt; obj_size; i++) {\n        set-&gt;group[i].len = cell_size;\n        set-&gt;group[i].elem = malloc (cell_size * sizeof (node));\n        for (int j = 0; j &lt; cell_size; j++) {\n            set-&gt;group[i].elem[j].x = j;\n            set-&gt;group[i].elem[j].y = j * 10 + i;\n        }\n    }\n\n    printf(\"set size: %d\\n\", set-&gt;len);\n    for (int i = 0; i &lt; obj_size; i++) {\n        printf(\"group size: %d\\n\", set-&gt;group[i].len);\n        for (int j = 0; j &lt; cell_size; j++) {\n            printf(\"x: %d, \", set-&gt;group[i].elem[j].x);\n            printf(\"y: %d\\n\", set-&gt;group[i].elem[j].y);\n        }\n        free (set-&gt;group[i].elem);\n    }\n\n    free (set);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/fam_array2\nset size: 4\ngroup size: 3\nx: 0, y: 0\nx: 1, y: 10\nx: 2, y: 20\ngroup size: 3\nx: 0, y: 1\nx: 1, y: 11\nx: 2, y: 21\ngroup size: 3\nx: 0, y: 2\nx: 1, y: 12\nx: 2, y: 22\ngroup size: 3\nx: 0, y: 3\nx: 1, y: 13\nx: 2, y: 23\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<pre><code>$ valgrind ./bin/fam_array2\n==7686== Memcheck, a memory error detector\n==7686== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==7686== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==7686== Command: ./bin/fam_array2\n==7686==\nset size: 4\ngroup size: 3\nx: 0, y: 0\nx: 1, y: 10\nx: 2, y: 20\ngroup size: 3\nx: 0, y: 1\nx: 1, y: 11\nx: 2, y: 21\ngroup size: 3\nx: 0, y: 2\nx: 1, y: 12\nx: 2, y: 22\ngroup size: 3\nx: 0, y: 3\nx: 1, y: 13\nx: 2, y: 23\n==7686==\n==7686== HEAP SUMMARY:\n==7686==     in use at exit: 0 bytes in 0 blocks\n==7686==   total heap usage: 5 allocs, 5 frees, 168 bytes allocated\n==7686==\n==7686== All heap blocks were freed -- no leaks are possible\n==7686==\n==7686== For counts of detected and suppressed errors, rerun with: -v\n==7686== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1550734955, "last_edit_date": 1550734955, "creation_date": 1550699809, "answer_id": 54795861, "question_id": 54795235, "link": "https://stackoverflow.com/questions/54795235/flexible-array-of-flexible-arrays-in-c/54795861#54795861", "title": "Flexible array of flexible arrays in C", "body": "<p>You cannot have flexible array of a objects whose size is not known at compile time. And the size of a struct having a flexible array member is not. The only thing that is known is its size without the flexible member.</p>\n\n<p>But in your use case, all the <em>flexible</em> arrays will have the same size, even it is only known at run time. So you can replace the flexible array of the inner struct with a pointer, allocate enough space for the struct including its flexible array plus enough space for all the nodes and assign the pointers in that free space. Code could be:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\ntypedef struct {\n    int x;\n    int y;\n} node;\n\n\ntypedef struct {\n    int len;\n    node *elem;\n} cell;\n\n\ntypedef struct {\n    int len;\n    cell group[];\n} obj;\n\n\nint cell_size = 3;\nint obj_size = 4;\n\nint main(void) {\n\n    obj *set = malloc(\n        sizeof *set + obj_size * (\n            sizeof(cell) + cell_size * sizeof(node)\n            ));\n    set-&gt;len = obj_size;\n\n    // nodes will exist in the allocated buffer after the cells\n    node *node_start = (node *)(((char *) set) + sizeof *set + obj_size * sizeof(cell));\n\n    for (int i = 0; i &lt; obj_size; i++) {\n        set-&gt;group[i].len = cell_size;\n        // assign the elem pointers in the free space\n        set-&gt;group[i].elem = node_start + i * cell_size;\n        for (int j = 0; j &lt; cell_size; j++) {\n            set-&gt;group[i].elem[j].x = j;\n            set-&gt;group[i].elem[j].y = j * 10 + i;\n        }\n    }\n\n    printf(\"set size: %d\\n\", set-&gt;len);\n    for (int i = 0; i &lt; obj_size; i++) {\n        printf(\"group size: %d\\n\", set-&gt;group[i].len);\n        for (int j = 0; j &lt; cell_size; j++) {\n            printf(\"x: %d, \", set-&gt;group[i].elem[j].x);\n            printf(\"y: %d\\n\", set-&gt;group[i].elem[j].y);\n        }\n    }\n    free(set);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 336, "user_id": 4362960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/180e8f44c786a6a3d090d320627f0745?s=128&d=identicon&r=PG&f=1", "display_name": "cyclone125", "link": "https://stackoverflow.com/users/4362960/cyclone125"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 54795730, "answer_count": 3, "score": 1, "last_activity_date": 1550734955, "creation_date": 1550696763, "question_id": 54795235, "link": "https://stackoverflow.com/questions/54795235/flexible-array-of-flexible-arrays-in-c", "title": "Flexible array of flexible arrays in C", "body": "<p>Is it possible to use nested flexible arrays (flexible array of flexible arrays) in C?</p>\n\n<p>I tried the following code to test flexible arrays:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct {\n    int x;\n    int y;\n} node;\n\ntypedef struct {\n    int len;\n    node elem[];\n} cell;\n\nint cell_size = 3;\n\nint main(void) {\n    cell *set = malloc(sizeof *set + cell_size * sizeof set-&gt;elem[0]);\n    set-&gt;len = cell_size;\n\n    for (int j = 0; j &lt; cell_size; j++) {\n        set-&gt;elem[j].x = j;\n        set-&gt;elem[j].y = j * 10;\n    }\n\n    printf(\"set size: %d\\n\", set-&gt;len);\n    for (int j = 0; j &lt; cell_size; j++) {\n        printf(\"x: %d, \", set-&gt;elem[j].x);\n        printf(\"y: %d\\n\", set-&gt;elem[j].y);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>set size: 3\nx: 0, y: 0\nx: 1, y: 10\nx: 2, y: 20\n</code></pre>\n\n<p>Here everything is fine as expected. Allocated space for <code>set</code> is <strong>28</strong> bytes.</p>\n\n<p>But when I tried to modify this code like this to put flexible array inside other array:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\ntypedef struct {\n    int x;\n    int y;\n} node;\n\n\ntypedef struct {\n    int len;\n    node elem[];\n} cell;\n\n\ntypedef struct {\n    int len;\n    cell group[];\n} obj;\n\n\nint cell_size = 3;\nint obj_size = 4;\n\nint main(void) {\n\n    obj *set = malloc(\n        sizeof *set + obj_size * sizeof (\n        sizeof (cell) + cell_size * sizeof(node)\n    ));\n    set-&gt;len = obj_size;\n\n    for (int i = 0; i &lt; obj_size; i++) {\n        set-&gt;group[i].len = cell_size;\n        for (int j = 0; j &lt; cell_size; j++) {\n            set-&gt;group[i].elem[j].x = j;\n            set-&gt;group[i].elem[j].y = j * 10 + i;\n        }\n    }\n\n    printf(\"set size: %d\\n\", set-&gt;len);\n    for (int i = 0; i &lt; obj_size; i++) {\n        printf(\"group size: %d\\n\", set-&gt;group[i].len);\n        for (int j = 0; j &lt; cell_size; j++) {\n            printf(\"x: %d, \", set-&gt;group[i].elem[j].x);\n            printf(\"y: %d\\n\", set-&gt;group[i].elem[j].y);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Allocated space for <code>set</code> is <strong>20</strong> bytes and the output is wrong:</p>\n\n<pre><code>set size: 4\ngroup size: 3\nx: 3, y: 3\nx: 3, y: 0\nx: 3, y: 1\ngroup size: 3\nx: 3, y: 3\nx: 0, y: 3\nx: 1, y: 13\ngroup size: 3\nx: 3, y: 0\nx: 3, y: 1\nx: 13, y: 2\ngroup size: 3\nx: 0, y: 3\nx: 1, y: 13\nx: 2, y: 23\n</code></pre>\n\n<p>Even if I set <code>malloc</code> manually to any reasonable value the output is still incorrect. I think this is because the compiler don't know the size of <code>group[]</code> member in the top structure (<code>obj</code>). However I didn't get any compiler errors or warnings (GCC 6.3.0).</p>\n\n<p>And I don't know how to set this size and make compiler process this code correctly.</p>\n"}, {"tags": ["c", "arrays", "regex", "printing", "character"], "comments": [{"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1550696878, "post_id": 54795229, "comment_id": 96368531, "body": "The most straightforward way to validate an email address is to use the regex pattern from <a href=\"https://emailregex.com/\" rel=\"nofollow noreferrer\">EmailRegex.com</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1550696897, "post_id": 54795229, "comment_id": 96368543, "body": "Why are you using magic numbers? <code>&#39;@&#39;</code> is very equivalent to <code>64</code> on ASCII-based system."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550697026, "post_id": 54795229, "comment_id": 96368604, "body": "You are starting to write <code>newArr</code> from a non-zero position. The first characters before it are having indeterminate values."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550697379, "post_id": 54795229, "comment_id": 96368749, "body": "Anyway, how about <code>strcpy( newArr, &amp;email[strcspn(email, &quot;@&quot;) + 1])</code>? <a href=\"https://ideone.com/kEP0Bp\" rel=\"nofollow noreferrer\">ideone.com/kEP0Bp</a>"}, {"owner": {"reputation": 51, "user_id": 9892092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49d506026261cccf62a2503318d11fe1?s=128&d=identicon&r=PG&f=1", "display_name": "YM_coding", "link": "https://stackoverflow.com/users/9892092/ym-coding"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550698072, "post_id": 54795229, "comment_id": 96369059, "body": "@EugeneSh. Thanks so much"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550706692, "post_id": 54795229, "comment_id": 96371949, "body": "@EugeneSh. <code>strcpy( newArr, &amp;email[strcspn(email, &quot;@&quot;) + 1])</code> is potential UB when <code>&#39;@&#39;</code> is not found as it attempts to access beyond the end of the string."}], "owner": {"reputation": 51, "user_id": 9892092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49d506026261cccf62a2503318d11fe1?s=128&d=identicon&r=PG&f=1", "display_name": "YM_coding", "link": "https://stackoverflow.com/users/9892092/ym-coding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550696728, "creation_date": 1550696728, "question_id": 54795229, "link": "https://stackoverflow.com/questions/54795229/code-not-printing-the-characters-in-the-array", "title": "Code not printing the characters in the array", "body": "<p>I have been trying to solve a simple algorithm that basically validates a given email. So if there is a '.' or '+' in the local name, then it should be fine and if it has '.' or '+' in the domain name (a.k.a. after '@'), it's invalid. </p>\n\n<p>Now, I know my method is not efficient, far from it. But I just want to solve the problem at this point. For some reason when I have the following code, the characters in my newArr are being printed:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;string.h&gt;\n\nint main() {\n  char email[30] = \"DanGitson@gmail.com\";\n  char newArr[30];\n  int at = 0;\n  for (int i = 0; i &lt; 30; i++) {\n    // get the characters after '@'\n    if (at == 1) {\n      newArr[i] = email[i];\n      printf(\"%c\", newArr[i]);\n    }\n    // if email[i] is equal to '@'\n    if(email[i] == 64){\n      at = 1;\n    }\n  }\n}\n</code></pre>\n\n<p>But when I have the following code, they are not:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;string.h&gt;\n\nint main() {\n  char email[30] = \"DanGitson@gmail.com\";\n  char newArr[30];\n  int at = 0;\n  for (int i = 0; i &lt; 30; i++) {\n    // get the characters after '@'\n    if (at == 1) {\n      newArr[i] = email[i];\n    }\n    // if email[i] is equal to '@'\n    if(email[i] == 64){\n      at = 1;\n    }\n  }\n  for (int j = 0; j &lt; 30; j++) {\n    printf(\"%c\", newArr[j]);\n  }\n}\n</code></pre>\n\n<p>Basically, my approach is to add all of the characters that are after the '@' character. In other words, get the domain and check if there are more than 2 '.'s and if there is a '+' so I can validate whether the email is valid or not.\nAlso, if you have any suggestions or feedback on my method, I would appreciate it. </p>\n\n<p>Thank you for having read this so far, I am waiting for your responses!</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1550696161, "post_id": 54795063, "comment_id": 96368216, "body": "What does <code>struct node</code> look like?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550696163, "post_id": 54795063, "comment_id": 96368218, "body": "<code>break</code> breaks out of the loop, <code>continue</code> ... continues the loop. That&#39;s very basic C knowledge covered in every C text book."}, {"owner": {"reputation": 1175, "user_id": 1175455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4gpIG.jpg?s=128&g=1", "display_name": "Harry Cutts", "link": "https://stackoverflow.com/users/1175455/harry-cutts"}, "edited": false, "score": 2, "creation_date": 1550696186, "post_id": 54795063, "comment_id": 96368230, "body": "Are you getting any errors when you run it? It looks like you should to me, since you&#39;ll be dereferencing a null pointer the first time you evaluate <code>prev-&gt;data</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1550696300, "post_id": 54795063, "comment_id": 96368290, "body": "Aside: the code could be much simplifed by a slight reordering and the removal of the duplication of  <code>prev = ptr; ptr = ptr-&gt;next;</code> which are needed whether or not there was a match found."}, {"owner": {"reputation": 9, "user_id": 9439441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex H", "link": "https://stackoverflow.com/users/9439441/alex-h"}, "edited": false, "score": 0, "creation_date": 1550696405, "post_id": 54795063, "comment_id": 96368343, "body": "struct node {     int data;     struct node* next; }; here&#39;s the struct node"}, {"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1550696460, "post_id": 54795063, "comment_id": 96368370, "body": "@AlexH you should add that code to the question so that everyone can see it right away. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9439441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex H", "link": "https://stackoverflow.com/users/9439441/alex-h"}, "edited": false, "score": 0, "creation_date": 1550697423, "post_id": 54795283, "comment_id": 96368772, "body": "Thank you! It worked. Could you explain what does !prev stand for?"}, {"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "reply_to_user": {"reputation": 9, "user_id": 9439441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex H", "link": "https://stackoverflow.com/users/9439441/alex-h"}, "edited": false, "score": 0, "creation_date": 1550697985, "post_id": 54795283, "comment_id": 96369026, "body": "<code>!prev</code> is a short way of saying <code>prev == NULL</code>. :-)"}], "tags": [], "owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "is_accepted": false, "score": 1, "last_activity_date": 1550697934, "last_edit_date": 1550697934, "creation_date": 1550696982, "answer_id": 54795283, "question_id": 54795063, "link": "https://stackoverflow.com/questions/54795063/linked-list-problem-with-while-loop-should-i-use-continue/54795283#54795283", "title": "Linked list problem with while loop, should I use continue?", "body": "<p>The code as written generates a segmentation fault because you're referencing a NULL pointer. In this line:</p>\n\n<pre><code>if(prev-&gt;data == ptr-&gt;data)\n</code></pre>\n\n<p>Since <code>prev</code> is NULL to start, <code>prev-&gt;data</code> will dereference the NULL pointer and crash the program.  That doesn't explain why you saw it not printing the last element, but the code as written is definitely broken.</p>\n\n<p>Try this:</p>\n\n<pre><code>void printList(struct node *head)  // print out unique items of the list\n{\n\n    struct node *ptr = head;\n    struct node *prev = NULL;\n\n    while (ptr != NULL)\n    {\n        // Check if prev is NULL, and if not, that prev-&gt;data and ptr-&gt;data\n        // don't match.\n        if (! prev || ptr-&gt;data != prev-&gt;data)\n        {\n            printf(\"%d\\n\", ptr-&gt;data);\n        }\n\n        prev = ptr;\n        ptr = ptr-&gt;next;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9439441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex H", "link": "https://stackoverflow.com/users/9439441/alex-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550697934, "creation_date": 1550695947, "last_edit_date": 1550696624, "question_id": 54795063, "link": "https://stackoverflow.com/questions/54795063/linked-list-problem-with-while-loop-should-i-use-continue", "title": "Linked list problem with while loop, should I use continue?", "body": "<p>I have to print out every unique integer in a linked list, it turned out the it's not printing anything.I tried using continue and remove the else but by doing that I only get the first unique item in the linked list. My question is that does continue end the loop or just skip the current iteration? If it only skips the current one, say i have a linked list that looks like 1->5, why am I only getting 1 printed here? Thanks in advance.</p>\n\n<pre><code> struct node {\n    int data; \n    struct node* next; \n }\n\n\nvoid printList(struct node *head)  // print out unique items of the list\n{\n\n    struct node *ptr = head;\n    struct node *prev = NULL;\n\n    while(ptr != NULL)\n    {\n\n        if(prev-&gt;data == ptr-&gt;data)\n        {\n            prev = ptr;\n            ptr = ptr-&gt;next;\n\n        }else{\n        printf(\"%d\", ptr-&gt;data);\n        prev = ptr;\n        ptr = ptr-&gt;next;\n\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "tokenize", "strtok", "strsep"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1550696006, "post_id": 54794978, "comment_id": 96368147, "body": "I believe the way the state is saved is not specified in the <code>strtok_r</code> documentation, so relying on it would be risky."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550696668, "post_id": 54794978, "comment_id": 96368445, "body": "Note, too, that <i>no</i> part of the string is stored in <code>save</code>.  <code>save</code> is a pointer.  However, it would not be at all surprising for <code>save</code> to <i>point to</i> the tail of the string.  It is important to maintain and be mindful of the distinction between a pointer and the thing to which it points."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1550697590, "post_id": 54794978, "comment_id": 96368840, "body": "The designers could have specified the implementation to work the way you want but chose not to.  You are violating the requirement that <code>saveptr</code> be unmodified from the previous call when <code>str</code> is NULL."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1550697761, "post_id": 54794978, "comment_id": 96368921, "body": "@stark Where exactly am I modifying saveptr from the previous call?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1550697834, "post_id": 54794978, "comment_id": 96368948, "body": "Wherever you set its value."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1550697838, "post_id": 54794978, "comment_id": 96368950, "body": "The requirement violated is actually <i>&quot;On the first call to strtok_r(), str should point to the string to be parsed&quot;</i>, but I guess the question here is exactly &quot;Can it be violated?&quot; I think the general answer would be &quot;No&quot;, as nothing is allowing it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1550698626, "post_id": 54794978, "comment_id": 96369278, "body": "Theoretically, an implementation could index the entire string during the first call (when <code>str</code> is not <code>NULL</code>), and <code>save</code> would point to the indexing data rather than just the tail of the string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550698659, "post_id": 54794978, "comment_id": 96369294, "body": "@JohnBollinger No, he makes every call a subsequent call, not a first call."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550698694, "post_id": 54794978, "comment_id": 96369306, "body": "Right you are, @Barmar."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550698861, "post_id": 54794978, "comment_id": 96369380, "body": "@Barmar I don&#39;t think creating an index would be possible as there is no way to free it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550699198, "post_id": 54794978, "comment_id": 96369517, "body": "@balki Isn&#39;t that true in general for whatever <code>save</code> points to? I don&#39;t see anything in the spec that says it must share memory with the original string, although that&#39;s the common implementation."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1550699340, "post_id": 54794978, "comment_id": 96369573, "body": "It&#39;s easier and safer to write your own implementation of <code>strtok_r</code> that will 100% behave this way then to depend on uncertain data."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1550699427, "post_id": 54794978, "comment_id": 96369611, "body": "@KamilCuk Or simply copy the code from glibc, since it&#39;s open source."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1550741655, "post_id": 54794978, "comment_id": 96383888, "body": "Also see the BSD <a href=\"http://man7.org/linux/man-pages/man3/strsep.3.html\" rel=\"nofollow noreferrer\">strsep()</a> function."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1550699850, "last_edit_date": 1550699850, "creation_date": 1550697582, "answer_id": 54795412, "question_id": 54794978, "link": "https://stackoverflow.com/questions/54794978/strtok-r-save-state-behaviour/54795412#54795412", "title": "strtok_r save state behaviour", "body": "<blockquote>\n  <p>Are there any downsides in this approach?</p>\n</blockquote>\n\n<p>Yes, it loses the original value of <code>str</code>, making it impossible (in this case) to free it.  You therefore have a memory leak.  That could be solved by keeping a separate copy of the pointer, but that boils down to very nearly the same thing as your first code.</p>\n\n<p>Additionally, as was observed in comments, it does not comply with the specifications of <code>strtok_r</code> in that the behavior of a call to <code>strtok_r</code> with the first argument <code>NULL</code> is defined only in the context of a previous call to <code>strtok_r</code> that provided the value to which the third argument points.</p>\n\n<p>Also, it departs from idiomatic, well-understood use of <code>strtok_r</code>, even going so far as to hide it in a different function.  The normal idiom is not onerous, and it is well known and understood.  Being clever about it makes your code a bit harder to maintain.</p>\n\n<blockquote>\n  <p>Am I causing any undefined behavior?</p>\n</blockquote>\n\n<p>Yes, in the sense of \"behavior that is not defined\", as opposed to behavior that is explicitly called out as <em>un</em>defined.  But the relevant standards attribute the same significance to those alternatives.  See above.</p>\n"}], "owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 54795412, "answer_count": 1, "score": 1, "last_activity_date": 1550702967, "creation_date": 1550695641, "last_edit_date": 1550702967, "question_id": 54794978, "link": "https://stackoverflow.com/questions/54794978/strtok-r-save-state-behaviour", "title": "strtok_r save state behaviour", "body": "<p>The <a href=\"https://stackoverflow.com/q/15961253\">correct</a> way to use <code>strtok_r</code> is as follows:</p>\n\n<pre><code>char* str = strdup(string);\nchar* save;\nchar* ptr = strtok_r(str, delim, &amp;save);\nwhile(ptr) {\n  puts(ptr);\n  ptr = strtok_r(NULL, delim, &amp;save);\n}\n</code></pre>\n\n<p>When trying to inspect what actually is stored in <code>save</code>, I found it is just the rest of the unparsed string. So I tried to make the second call look like the first and wrote a wrapper as follows.</p>\n\n<pre><code>char* as_tokens(char** str, const char* const delim) {\n  return strtok_r(NULL, delim, str);\n}\n</code></pre>\n\n<p>This can be used like below which is much less verbose. We don't have to differentiate between first call and rest.</p>\n\n<pre><code>char* str = strdup(string);\nchar* ptr;\nwhile(ptr = as_tokens(&amp;str, delim))\n  puts(ptr);\n</code></pre>\n\n<p>Are there any downsides in this approach? Am I causing any undefined behavior? I tried some edge cases and both approaches work similarly.</p>\n\n<p>Online Compiler: <a href=\"https://wandbox.org/permlink/rkGiwXOUtzqrbMpP\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/rkGiwXOUtzqrbMpP</a></p>\n\n<p>P.S. Ignoring memory leaks for brevity.</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>There already exists a function almost similar to my <code>as_tokens</code>: <a href=\"https://linux.die.net/man/3/strsep\" rel=\"nofollow noreferrer\">strsep</a>.\nIt differs in the case when there are consecutive delimiters. <code>strsep</code> returns an empty string while <code>as_tokens</code> (i.e strtok_r) treats them as one.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1550691635, "post_id": 54794046, "comment_id": 96366105, "body": "You can&#39;t assign to a result of a cast in C, but I think there is/was a GCC extension for that. Try <code>-fpermissive</code> or an older version of GCC. If you&#39;re willing to change the code, you can just remove the cast and (in this case) it should just work."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1550691642, "post_id": 54794046, "comment_id": 96366112, "body": "Why not use <code>*pexit = xit;</code> as you have <code>EXIT_DATA * *pexit</code> and <code>EXIT_DATA *xit</code>. No cast is necessary."}, {"owner": {"reputation": 21, "user_id": 11092070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B0eG5nF1-ao/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO2GX0apm8tF9lvfTveAyijGohVQA/mo/photo.jpg?sz=128", "display_name": "Code Lyfe", "link": "https://stackoverflow.com/users/11092070/code-lyfe"}, "edited": false, "score": 0, "creation_date": 1550692239, "post_id": 54794046, "comment_id": 96366447, "body": "<code>act_move.c:591:28: error: lvalue required as left operand of assignment      ( EXIT_DATA * ) *pexit = xit;</code>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550692375, "post_id": 54794046, "comment_id": 96366497, "body": "@CodeLyfe Weather Vane meant for you to get rid of the cast altogether.  Remove <code>( EXIT_DATA * )</code>"}, {"owner": {"reputation": 21, "user_id": 11092070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B0eG5nF1-ao/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO2GX0apm8tF9lvfTveAyijGohVQA/mo/photo.jpg?sz=128", "display_name": "Code Lyfe", "link": "https://stackoverflow.com/users/11092070/code-lyfe"}, "edited": false, "score": 0, "creation_date": 1550692436, "post_id": 54794046, "comment_id": 96366524, "body": "Worked Perfect. Thank you all very much."}, {"owner": {"reputation": 21, "user_id": 11092070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B0eG5nF1-ao/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO2GX0apm8tF9lvfTveAyijGohVQA/mo/photo.jpg?sz=128", "display_name": "Code Lyfe", "link": "https://stackoverflow.com/users/11092070/code-lyfe"}, "edited": false, "score": 0, "creation_date": 1550703266, "post_id": 54794046, "comment_id": 96370953, "body": "Because I dont believe in free work. Ill reward you with the SRC code [link]<a href=\"https://github.com/codelyfe/SWROTS-MUD-RESTORED-2019\" rel=\"nofollow noreferrer\">github.com/codelyfe/SWROTS-MUD-RESTORED-2019</a> you helped restore. Even credited everyones help at bottom by posting link to this post on README."}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1550691697, "creation_date": 1550691697, "answer_id": 54794104, "question_id": 54794046, "link": "https://stackoverflow.com/questions/54794046/error-lvalue-required-as-left-operand-of-assignment-swrots/54794104#54794104", "title": "error: lvalue required as left operand of assignment (swrots)", "body": "<p>Per the <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note104\" rel=\"nofollow noreferrer\">C Standard, &sect; 6.5.4, footnote 104</a>:</p>\n\n<blockquote>\n  <p><strong>A cast does not yield an lvalue</strong>. Thus, a cast to a qualified type has the same effect as a cast to the unqualified version of the type.</p>\n</blockquote>\n\n<p>Emphasis mine.</p>\n\n<p>You may not have a type-casted value as the destination for an assignment, since it's not an l-value. It would appear that since <code>pexit</code> is of type <code>EXIT_DATA **</code> and <code>xit</code> is of type <code>EXIT_DATA *</code>, this will work:</p>\n\n<pre><code>*pexit = xit;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11092070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B0eG5nF1-ao/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO2GX0apm8tF9lvfTveAyijGohVQA/mo/photo.jpg?sz=128", "display_name": "Code Lyfe", "link": "https://stackoverflow.com/users/11092070/code-lyfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1550691692, "accepted_answer_id": 54794104, "answer_count": 1, "score": 0, "last_activity_date": 1550692675, "creation_date": 1550691439, "last_edit_date": 1550692675, "question_id": 54794046, "link": "https://stackoverflow.com/questions/54794046/error-lvalue-required-as-left-operand-of-assignment-swrots", "closed_reason": "Duplicate", "title": "error: lvalue required as left operand of assignment (swrots)", "body": "<p>As I was trying to restore an old Star Wars mud I ran into this bug and unfortunately I am stuck. </p>\n\n<p>This is the error I recieve when I try to compile \"act_move.c\" </p>\n\n<pre><code>act_move.c:591:27: error: lvalue required as left operand of assignment\n ( EXIT_DATA * ) pexit = xit;\n</code></pre>\n\n<p>Here is where the bug is located</p>\n\n<pre><code>ROOM_INDEX_DATA *generate_exit( ROOM_INDEX_DATA *in_room, EXIT_DATA * *pexit \n)\n{\nEXIT_DATA *xit, *bxit;\nEXIT_DATA *orig_exit = (EXIT_DATA *) *pexit;\n\nROOM_INDEX_DATA *room, *backroom;\n\nint brvnum;\nint serial;\nint roomnum;\nint distance = -1;\nint vdir = orig_exit-&gt;vdir;\n\nsh_int hash;\n\nbool found = FALSE;\n\nif ( in_room-&gt;vnum &gt; 32767 )    /* room is virtual */\n{\n  serial = in_room-&gt;vnum;\n  roomnum = in_room-&gt;tele_vnum;\n\nif ( (serial &amp; 65535) == orig_exit-&gt;vnum )\n{\n  brvnum = serial &gt;&gt; 16;\n  --roomnum;\n  distance = roomnum;\n}\n\nelse\n{\n  brvnum = serial &amp; 65535;\n  ++roomnum;\n  distance = orig_exit-&gt;distance - 1;\n}\nbackroom = get_room_index( brvnum );\n}\nelse\n{\n\nint r1 = in_room-&gt;vnum;\nint r2 = orig_exit-&gt;vnum;\n\nbrvnum = r1;\nbackroom = in_room;\nserial = (UMAX( r1, r2 ) &lt;&lt; 16) | UMIN( r1, r2 );\ndistance = orig_exit-&gt;distance - 1;\nroomnum = r1 &lt; r2 ? 1 : distance;\n}\nhash = serial % 64;\n\nfor ( room = vroom_hash[hash]; room; room = room-&gt;next )\nif ( room-&gt;vnum == serial &amp;&amp; room-&gt;tele_vnum == roomnum )\n{\n    found = TRUE;\n    break;\n}\nif ( !found )\n{\nCREATE( room, ROOM_INDEX_DATA, 1 );\nroom-&gt;area    = in_room-&gt;area;\nroom-&gt;vnum    = serial;\nroom-&gt;tele_vnum   = roomnum;\nroom-&gt;sector_type = in_room-&gt;sector_type;\nroom-&gt;room_flags  = in_room-&gt;room_flags;\ndecorate_room( room );\nroom-&gt;next    = vroom_hash[hash];\nvroom_hash[hash]  = room;\n++top_vroom;\n}\nif ( !found || ( xit=get_exit(room, vdir)) == NULL )\n{\nxit = make_exit( room, orig_exit-&gt;to_room, vdir );\nxit-&gt;keyword        = STRALLOC( \"\" );\nxit-&gt;description    = STRALLOC( \"\" );\nxit-&gt;key        = -1;\nxit-&gt;distance = distance;\n}\nif ( !found )\n{\nbxit = make_exit(room, backroom, rev_dir[vdir]);\nbxit-&gt;keyword       = STRALLOC( \"\" );\nbxit-&gt;description   = STRALLOC( \"\" );\nbxit-&gt;key       = -1;\nif ( (serial &amp; 65535) != orig_exit-&gt;vnum )\n  bxit-&gt;distance = roomnum;\nelse\n{\n  EXIT_DATA *tmp = get_exit( backroom, vdir );\n  int fulldist = tmp-&gt;distance;\n\n  bxit-&gt;distance = fulldist - distance;\n}\n}\n( EXIT_DATA * ) pexit = xit;\nreturn room;\n}\n</code></pre>\n\n<p>I must be looking way to hard at this. Any help would be appreciated and I apologize if this has been repeated anywhere else. I did search first.</p>\n"}, {"tags": ["c", "runtime", "endianness", "c99", "misra"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1550692202, "post_id": 54793993, "comment_id": 96366427, "body": "There appears to be something that might help you <i><a href=\"https://stackoverflow.com/a/2103095/645128\">here</a></i>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1550692221, "post_id": 54793993, "comment_id": 96366439, "body": "Out of curiosity, <b>why</b> you need run-time detection? endianness will not change from run to run!"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1550693207, "post_id": 54793993, "comment_id": 96366866, "body": "I, too, would be interested to know why it must be done at run time.  But if you must, anything stopping you from using <code>endian.h</code>? <code>return __BYTE_ORDER == __LITTLE_ENDIAN ? endi_little : endi_big</code>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1550693485, "post_id": 54793993, "comment_id": 96367004, "body": "Also, I noticed that you tagged the question <code>C99</code> but mentioned <code>C11</code> in the question.  I don&#39;t know that it really affects your question so much, but last I knew, MISRA doesn&#39;t support <code>C11</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1550693599, "post_id": 54793993, "comment_id": 96367066, "body": "Make it <code>char</code> instead of <code>uint8_t</code>. Will it still complain?"}, {"owner": {"reputation": 2446, "user_id": 791430, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d7a48fac6733df00214a21b33c3220f?s=128&d=identicon&r=PG", "display_name": "Omer Tuchfeld", "link": "https://stackoverflow.com/users/791430/omer-tuchfeld"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1550738989, "post_id": 54793993, "comment_id": 96382257, "body": "@ryyker Most examples use a union which is not allowed. I tried the compound literals one and it failed for <code>Operand to a unary operator has an inappropriate essential type &#39;unsigned char&#39;</code>   @SergeyA It&#39;s a very boring reason, hard to explain, no good reason   @ChristianGibbons endian.h is not available on some of my targets   @ChristianGibbons I meant to say C99, my bad   @EugeneSh. Yes, it still complains   Thank you all some much for your attempts to help though"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1550756810, "post_id": 54793993, "comment_id": 96393595, "body": "@SergeyA Except it can on Power PC, and in theory on ARM too (though I have yet to encounter a big endian ARM). But well, it would be complete madness to change endianess variably."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550756854, "post_id": 54793993, "comment_id": 96393635, "body": "Also, the compiler isn&#39;t necessary able to reliably and portably detect endianess at compile-time."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550759645, "post_id": 54793993, "comment_id": 96395583, "body": "@Lundin compiler might not be able, but <code>endian.h</code> should."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1550760248, "post_id": 54793993, "comment_id": 96396038, "body": "@SergeyA That&#39;s not even POSIX, just some Linux thing. Determining CPU endianess or swapping the byte order of integers isn&#39;t rocket science."}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1551104392, "post_id": 54793993, "comment_id": 96506836, "body": "MISRA doesn&#39;t support C11 <b>yet</b> (but keep watching this space, for 24 hours or so...)"}], "answers": [{"comments": [{"owner": {"reputation": 2446, "user_id": 791430, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d7a48fac6733df00214a21b33c3220f?s=128&d=identicon&r=PG", "display_name": "Omer Tuchfeld", "link": "https://stackoverflow.com/users/791430/omer-tuchfeld"}, "edited": false, "score": 0, "creation_date": 1550738401, "post_id": 54796345, "comment_id": 96381898, "body": "This header is not available on some of my targets, but thank you for the attempt"}, {"owner": {"reputation": 667, "user_id": 6069586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e311d75e91cf59485b157b5b8e8004be?s=128&d=identicon&r=PG&f=1", "display_name": "JWCS", "link": "https://stackoverflow.com/users/6069586/jwcs"}, "edited": false, "score": 1, "creation_date": 1578592856, "post_id": 54796345, "comment_id": 105498297, "body": "For the record, if you&#39;re shipping (they have) the standard library as compiled <code>.so</code> files (per target) along with a limited subset of the headers, then this function most likely already exists (within the <code>.so</code>), but is just unknown/not-exposed. If you <code>extern</code> the function prototype you would still be able to use it, despite not having the header."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 0, "last_activity_date": 1550702185, "creation_date": 1550702185, "answer_id": 54796345, "question_id": 54793993, "link": "https://stackoverflow.com/questions/54793993/misra-compliant-run-time-detection-of-endianness/54796345#54796345", "title": "MISRA compliant run-time detection of endianness", "body": "<p>In a MISRA context, I suppose this header and this function might not be available, but:</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n\nstatic endi get_endianness(void)\n{\n    return htons(0x0001u) == 0x0001u ? endi_big : endi_little;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1551965600, "post_id": 54808525, "comment_id": 96840633, "body": "+1 for the union observation... the Rule is there for a reason - which is that there is some dubious behavior, although most compilers do behave."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1550757231, "last_edit_date": 1550757231, "creation_date": 1550756640, "answer_id": 54808525, "question_id": 54793993, "link": "https://stackoverflow.com/questions/54793993/misra-compliant-run-time-detection-of-endianness/54808525#54808525", "title": "MISRA compliant run-time detection of endianness", "body": "<p>I think you have misunderstood the MISRA-C rules. Code such as this is fine:</p>\n\n<pre><code> uint16_t u16 = 0xAABBu;\n bool big_endian = *(uint8_t*)&amp;u16 == 0xAAu;\n</code></pre>\n\n<p>MISRA-C:2012 rule 11.3 has an exception allowing pointer conversions to pointer to character types (which <code>uint8_t</code> can safely be regarded as), but not the other way around. The purpose of the rule is to protect against misaligned access and strict aliasing bugs.</p>\n\n<hr>\n\n<p>Also, MISRA allows <code>union</code> just fine, the rule against it is advisory, just to force people to stop and think <em>how</em> they are using unions. MISRA does not allow <code>union</code> for the sake of storing multiple unrelated things in the same memory area, such as creating <em>variants</em> and other such nonsense. But controlled type punning, where padding/alignment and endianess has been considered, can be used with MISRA. That is, if you don't like this advisory rule. Personally I always ignore it in my MISRA implementations.</p>\n"}], "owner": {"reputation": 2446, "user_id": 791430, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d7a48fac6733df00214a21b33c3220f?s=128&d=identicon&r=PG", "display_name": "Omer Tuchfeld", "link": "https://stackoverflow.com/users/791430/omer-tuchfeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1550757231, "creation_date": 1550691274, "last_edit_date": 1550739988, "question_id": 54793993, "link": "https://stackoverflow.com/questions/54793993/misra-compliant-run-time-detection-of-endianness", "title": "MISRA compliant run-time detection of endianness", "body": "<p>(First note that I know determining endianness at run-time is not an ideal solution and there are better ideas. Please don't bring that up)</p>\n\n<p>I need to check the endianness of my CPU at run-time. I also have to do it while staying MISRA-compliant. I'm using C99.</p>\n\n<p>MISRA doesn't allow conversion between different types of pointers, so simply casting a <code>uint32_t*</code> to <code>uint8_t*</code> and de-referencing to see what value the <code>uint8_t</code> holds is not allowed. Using <code>union</code>s is also out of the question (MISRA doesn't allow <code>union</code>s).</p>\n\n<p>I also attempted to use <code>memcmp</code> like in the following piece of code: </p>\n\n<pre><code>static endi get_endianess(void)\n{\n    uint32_t a = 1U;\n    uint8_t b = 1U;\n\n    return memcmp(&amp;a, &amp;b, 1) == 0 ? endi_little : endi_big;\n}\n</code></pre>\n\n<p>but MISRA says that <code>The pointer arguments to the Standard Library function 'memcmp' are not pointers to qualified or unqualified versions of compatible types</code>, meaning I've failed to out-smart it by converting to legal <code>void*</code> pointers and letting <code>memcmp</code> do the dirty work.</p>\n\n<p>Any other clever ideas will be appreciated. If you don't have a MISRA checker, just send me your idea and I'll let you know what my checker says</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1550691261, "post_id": 54793898, "comment_id": 96365916, "body": "You can open a file for reading more than once anyway."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1550691442, "post_id": 54793898, "comment_id": 96366007, "body": "first in both cases you are simply getting a dirfd back and <code>dirfd</code> in any _at functions is used to resolve relative path., so the behavior is still well defined"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550692128, "post_id": 54793898, "comment_id": 96366392, "body": "You can&#39;t do this with a file, only with a directory, since <code>.</code> is the name of the directory relative to itself."}, {"owner": {"reputation": 33, "user_id": 10202078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195c105d0a8b874e1e92ee10c34401e6?s=128&d=identicon&r=PG&f=1", "display_name": "peeed", "link": "https://stackoverflow.com/users/10202078/peeed"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550768237, "post_id": 54793898, "comment_id": 96401494, "body": "@Barmar You&#39;re right, I&#39;ll update the title accordingly to make it more descriptive."}], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 2, "last_activity_date": 1550692550, "creation_date": 1550692550, "answer_id": 54794301, "question_id": 54793898, "link": "https://stackoverflow.com/questions/54793898/reopen-a-directory-using-openat/54794301#54794301", "title": "reopen a directory using openat", "body": "<p>This is just the same as calling <code>open</code> twice on the same file, which you are allowed to do:</p>\n\n<pre><code>int fd1 = open(\"filename\", flags1);\nint fd2 = open(\"filename\", flags2);\n</code></pre>\n\n<p>where <code>filename</code> refers to an existing file (of any type) and <code>flags1</code> and <code>flags2</code> are any set of <code>O_</code> flags that can be validly applied to that type of file and won't destroy its contents.  (In particular, we assume that they do not include <code>O_CREAT</code>, <code>O_TRUNC</code>, or <code>O_EXCL</code>.)</p>\n\n<p><code>fd1</code> and <code>fd2</code> will refer to separate \"<a href=\"https://unix.stackexchange.com/a/195097/21167\">open file descriptions</a>\", so for instance <code>lseek</code> on one will not affect the other, <code>flock</code> on one will block <code>flock</code> on the other, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1550693116, "creation_date": 1550693116, "answer_id": 54794425, "question_id": 54793898, "link": "https://stackoverflow.com/questions/54793898/reopen-a-directory-using-openat/54794425#54794425", "title": "reopen a directory using openat", "body": "<p>With <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/openat.html\" rel=\"nofollow noreferrer\"><code>openat()</code></a>, the first argument, <code>fd</code>, should be the file descriptor for a directory \u2014 such as the one you obtained from opening <code>\".\"</code> \u2014 or the special value <code>AT_FDCWD</code> (which means open relative paths relative the current directory).  Note that the <code>O_PATH</code> option you use is a Linux-only extension to <a href=\"http://man7.org/linux/man-pages/man2/openat.2.html\" rel=\"nofollow noreferrer\"><code>openat()</code></a>.</p>\n\n<p>So, because you're using a valid file descriptor for a directory, the call to <code>openat()</code> should succeed.  You now have two file descriptors both pointing (independently \u2014 with separate open file descriptions) to the current directory.  In general, it is possible to open the same file multiple times in a single process (or in multiple processes \u2014 ensuring access by a single process is actually very hard on Unix-like (POSIX) systems).</p>\n\n<p>There isn't a lot else you can do with those descriptors other than use them in <code>*at()</code> system calls.  Either of the file descriptors would have been sufficient; opening both was overkill.</p>\n"}], "owner": {"reputation": 33, "user_id": 10202078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195c105d0a8b874e1e92ee10c34401e6?s=128&d=identicon&r=PG&f=1", "display_name": "peeed", "link": "https://stackoverflow.com/users/10202078/peeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 54794301, "answer_count": 2, "score": 1, "last_activity_date": 1550768441, "creation_date": 1550690870, "last_edit_date": 1550768441, "question_id": 54793898, "link": "https://stackoverflow.com/questions/54793898/reopen-a-directory-using-openat", "title": "reopen a directory using openat", "body": "<p>As it seems, it is possible to use <code>openat()</code> to <em>re</em>open an already opened directory. For instance on my Linux system I can do the following:</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void) {\n\n    int fd1 = open(\".\", O_PATH);\n    if (fd1 == -1) {\n        perror(\"open\");\n        return 1;\n    }\n    int fd2 = openat(fd1, \".\", O_RDONLY);\n    if (fd2 == -1) {\n        perror(\"openat\");\n        close(fd1);\n        return 1;\n    }\n    close(fd1);\n\n    // do fancy things with fd2, now opened\n    // with access mode read-only\n\n    return 0;\n}\n</code></pre>\n\n<p>I could not find this documented anywhere and it feels a bit like an edge case. Also I didn't find other code doing this. Is this well-defined behavior?</p>\n\n<p>EDIT: changed the title: file -> directory</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1550690805, "post_id": 54793767, "comment_id": 96365701, "body": "Why not <code>O_LONG == flag</code>?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1550690810, "post_id": 54793767, "comment_id": 96365704, "body": "Pleas make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1550690848, "post_id": 54793767, "comment_id": 96365725, "body": "Also, your code doesn&#39;t skip spaces."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 8027470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1637b4a50635f77fc6605b1b1285082?s=128&d=identicon&r=PG&f=1", "display_name": "Asaf Rosemarin", "link": "https://stackoverflow.com/users/8027470/asaf-rosemarin"}, "is_accepted": true, "score": 2, "last_activity_date": 1550691191, "creation_date": 1550691191, "answer_id": 54793970, "question_id": 54793767, "link": "https://stackoverflow.com/questions/54793767/parse-options-with-binary-masks/54793970#54793970", "title": "Parse options with binary masks", "body": "<p>'r' is <code>0x72</code> and 'p' is <code>0x70</code> so if <code>flag = 0x70</code>, then <code>flag &amp; O_SORT</code>  = <code>0x70 &amp; 0x72</code> = <code>0x70</code> = <code>flag</code>. You should modify the conditions to <code>if (flag == O_SOMETHING) {...}</code>.</p>\n"}], "owner": {"reputation": 303, "user_id": 9750048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21cfd026d734661c84cbd0ab78bf0e0?s=128&d=identicon&r=PG&f=1", "display_name": "7hsk", "link": "https://stackoverflow.com/users/9750048/7hsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 54793970, "answer_count": 1, "score": -3, "last_activity_date": 1550691191, "creation_date": 1550690303, "last_edit_date": 1550690623, "question_id": 54793767, "link": "https://stackoverflow.com/questions/54793767/parse-options-with-binary-masks", "title": "Parse options with binary masks", "body": "<p>and good evening! I am currently creating an executable for linux. However, when parsing the options of my executable, I encounter errors.</p>\n\n<p>I  do not understand why the \"-p\" option passes the verification conditions..</p>\n\n<p>The header file my project:</p>\n\n<pre><code># define O_LONG         0x6c // -l\n# define O_RECUR        0x52 // -R\n# define O_ALL          0x61 // -a\n# define O_SORT         0x72 // -r\n# define O_R_SORT       0x74 // -t\n\n# define O_MSK_LONG             1\n# define O_MSK_REC              2\n# define O_MSK_ALL              4\n# define O_MSK_SORT             8\n# define O_MSK_R_SORT           16\n</code></pre>\n\n<p>My function that parses the options: (<code>option</code> -> number X program argument, and <code>options</code> is a pointer to my result)</p>\n\n<pre><code>int     parse_option(int *options, char *option)\n{\n    char    flag;\n\n    option++; // To pass the first character -\n    while ((flag = *(char*)option))\n    {\n        if ((O_ALL &amp; flag) == flag)\n            *options |= O_MSK_ALL;\n        else if ((O_RECUR &amp; flag) == flag)\n            *options |= O_MSK_REC;\n        else if ((O_SORT &amp; flag) == flag)\n            *options |= O_MSK_SORT;\n        else if ((flag &amp; O_R_SORT) == flag)\n            *options |= O_MSK_R_SORT;\n        else if ((O_LONG &amp; flag) == flag)\n            *options |= O_MSK_LONG;\n        else {\n            printf(\"command: invalid option -- '%c'\\n\", flag);\n            return (-1);\n        }\n        printf(\"%c %i\\n\", flag, *options);\n        option++;\n    }\n    return (1);\n}\n</code></pre>\n"}, {"tags": ["c", "fork", "wait"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550689873, "post_id": 54793571, "comment_id": 96365313, "body": "You better create <i>two</i> processes rather than some hard to explain process tree, and make them print stuff."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1550690182, "post_id": 54793571, "comment_id": 96365437, "body": "Congratulations, you&#39;ve written a fork bomb."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1550690234, "post_id": 54793571, "comment_id": 96365459, "body": "<code>using namespace std;</code> I don&#39;t think you&#39;re using C."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1550690337, "post_id": 54793571, "comment_id": 96365504, "body": "You were told to use <code>wait()</code> in a loop, but you don\u2019t."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550690530, "post_id": 54793571, "comment_id": 96365591, "body": "you are supposed to write the value of &quot;j&quot; in the CHILD not the parent... @JonathanLeffler errr actually the wait supposed to be outside the loop as it is."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1550690727, "post_id": 54793571, "comment_id": 96365667, "body": "HINT 1) you are missing one itty bitty if statement around your printf and you&#39;ve got it. :P  HINT 2) don&#39;t forget to exit(0) your child after printing the result"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550690834, "post_id": 54793571, "comment_id": 96365717, "body": "Reread the quotation starting \u201cIn order to wait for all the children\u2026\u201d"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550691060, "post_id": 54793571, "comment_id": 96365823, "body": "@JonathanLeffler ah I stand corrected :P ... .In that case HINT 3) the wait is supposed to be in its own loop."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550702648, "post_id": 54794269, "comment_id": 96370733, "body": "I&#39;d probably be a little gentler than &quot;You understood wrong&quot;.  The key point is that if <code>fork()</code> does not fail, it returns twice \u2014 once in the parent process, once in the child process.  There aren&#39;t many differences between them (see <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fork.html\" rel=\"nofollow noreferrer\"><code>fork()</code></a> for the details), but the key one is the return value from <code>fork()</code>.  It is crucial, as you say, to handle the two cases (parent, child) differently and appropriately.  And making sure the child exits when done is a key part of &#39;appropriately&#39;."}, {"owner": {"reputation": 11, "user_id": 10892021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/382yo.jpg?s=128&g=1", "display_name": "SeifeUndSalz", "link": "https://stackoverflow.com/users/10892021/seifeundsalz"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550709683, "post_id": 54794269, "comment_id": 96372641, "body": "Oh, I didn&#39;t know that phrase was harsh. English is not my first language. I wrote that  because I learned about this stuff not too long ago and the fact that fork() returns different values for each process was one of the &quot;gotcha&quot; moments for me. Based on what the OP wrote I think OP probably misunderstood it like me. So no hard feeling here !"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550709946, "post_id": 54794269, "comment_id": 96372695, "body": "I am not surprised to learn English is not your first language, based primarily on your user name.  Your command of English is good. I think it would be sufficient to use &quot;I think you misunderstood how <code>fork()</code> behaves&quot; (or &#39;misunderstand&#39; \u2014 either is OK, though there are subtle differences in meaning).  Only nit-pickers like me would be likely to pick up on the original; I&#39;ve not yet inured myself to all the modern techniques of communication and it likely would pass unremarked by most people."}], "tags": [], "owner": {"reputation": 11, "user_id": 10892021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/382yo.jpg?s=128&g=1", "display_name": "SeifeUndSalz", "link": "https://stackoverflow.com/users/10892021/seifeundsalz"}, "is_accepted": false, "score": 1, "last_activity_date": 1550702439, "last_edit_date": 1550702439, "creation_date": 1550692397, "answer_id": 54794269, "question_id": 54793571, "link": "https://stackoverflow.com/questions/54793571/how-to-demonstrate-the-unpredictable-order-of-fork-in-c/54794269#54794269", "title": "How to demonstrate the unpredictable order of fork() in C?", "body": "<p>You understood it wrong. On fork(), you can imagine the code from fork() onward is executed simultaneously, with both processes share the same code ( because memory is copied). The way to distinguish between parent and child is via an if-clause, because fork() returns different values for each process. As demonstrated below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(void) {\n    for (int i=0; i&lt;15; i++){\n        for(int j=0; j&lt;10; j++){\n            if (fork()==0){\n                //child process return 0 from fork()\n                printf(\"%d\", j);\n                exit(0);\n            }\n            else{\n                //parent process return pid of the forked process from fork()\n                continue;\n            }\n        }\n        while (wait(NULL)!=-1);//wait for all child processes. wait() only return -1 when no more children to wait for\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 11092103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcf126640e9b906e39b2e076e65d8a2?s=128&d=identicon&r=PG&f=1", "display_name": "Tucker", "link": "https://stackoverflow.com/users/11092103/tucker"}, "is_accepted": false, "score": 1, "last_activity_date": 1550692864, "creation_date": 1550692864, "answer_id": 54794372, "question_id": 54793571, "link": "https://stackoverflow.com/questions/54793571/how-to-demonstrate-the-unpredictable-order-of-fork-in-c/54794372#54794372", "title": "How to demonstrate the unpredictable order of fork() in C?", "body": "<p>You need to differentiate between the code to be run in the parent or child process (now you are running the same code on both processes). This can be done with the return value of fork(), as fork returns the child's pid to the parent and returns 0 to the child. Therefore, you can implement a check like:</p>\n\n<pre><code>pid = fork();\nif (pid == 0) {\n    //Code for child process\n    exit(0);\n}\n//Code for parent process\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10455396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gHhqL.png?s=128&g=1", "display_name": "Vrantamar", "link": "https://stackoverflow.com/users/10455396/vrantamar"}, "is_accepted": false, "score": 1, "last_activity_date": 1550702322, "last_edit_date": 1550702322, "creation_date": 1550693000, "answer_id": 54794395, "question_id": 54793571, "link": "https://stackoverflow.com/questions/54793571/how-to-demonstrate-the-unpredictable-order-of-fork-in-c/54794395#54794395", "title": "How to demonstrate the unpredictable order of fork() in C?", "body": "<p>Whenever you use child processes, always differentiate between parents code and child code. A child is identified by having <code>pid=0</code>, while the parent process will have a <code>pid &gt; 0</code> according to what pid has at execution time. Also, if an error occur while forking a child process, fork will return a value <code>&lt;0</code> so you should consider this case.</p>\n\n<p>In your code there is no such thing. The classical way to go about this is to do something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(void) {\n    pid_t pid;\n    for(int i=0;i&lt;15;i++){\n        for(int j=0; j&lt;10; j++){\n            if((pid = fork())&lt;0){\n               perror(\"Fork Failed.\");\n               exit(EXIT_FAILURE);\n            }\n            if(pid==0){ /*Child Code here*/\n               printf(\"%d\", j);\n               exit(EXIT_SUCCESS);\n            }\n        }\n        while(wait(NULL)!=-1); //while loop to wait\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550695433, "post_id": 54794532, "comment_id": 96367877, "body": "<code>exit(0)</code> forces the flush of standard output."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550697737, "post_id": 54794532, "comment_id": 96368907, "body": "@JonathanLeffler Ah ha, it&#39;s the <i>parent</i> that needs to flush stdout if it prints without a newline."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550698013, "post_id": 54794532, "comment_id": 96369041, "body": "Yes \u2014 though if the output is line buffered (not being piped to <code>less</code>, for example), then simply using <code>printf(&quot;\\n&quot;);</code> in the parent should force the output."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550698505, "post_id": 54794532, "comment_id": 96369241, "body": "@JonathanLeffler See my edits just now. This really bedeviled me. I spent a long time wondering how I&#39;d messed up the forking."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550699893, "post_id": 54794532, "comment_id": 96369777, "body": "I wrote a variant of the code in which (a) each child exits with status 20 + the child number based on the launch loop counter and (b) the parent collects the PID and status of each child into arrays in the <code>while (wait)</code> loop, then prints the newline and flushes standard output, then prints the information from the arrays.  (It also took care to avoid the <a href=\"https://stackoverflow.com/questions/2530663/\"><code>printf()</code> anomaly after <code>fork()</code></a>.)  I consistently got the output <code>0123456789</code>, but the sequence in which the corpses were returned was very variable. The consistency of output surprised me."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1550698482, "last_edit_date": 1550698482, "creation_date": 1550693599, "answer_id": 54794532, "question_id": 54793571, "link": "https://stackoverflow.com/questions/54793571/how-to-demonstrate-the-unpredictable-order-of-fork-in-c/54794532#54794532", "title": "How to demonstrate the unpredictable order of fork() in C?", "body": "<p>You've written a <a href=\"https://en.wikipedia.org/wiki/Fork_bomb\" rel=\"nofollow noreferrer\">fork bomb</a>. This is when a process spawns children which then spawn children which then spawn children... until all memory is consumed or the operation system kills it.</p>\n\n<p><code>fork</code> can be difficult to get your head around. When its called, both the parent <em>and</em> child processes continue on executing the code. Because of this it's important to separate the child code and make sure the child exits. If the parent and child are running the same code, how do you ensure the child stops and the parent continues?</p>\n\n<p><code>fork</code> in the parent returns the process ID of the child. <code>fork</code> in the child returns 0.  And if there's an error it will return -1. So the typical idiom looks like this:</p>\n\n<pre><code>        pid_t pid = fork();\n        if( pid == 0 ) {\n            // child\n            exit(0);\n        }\n        else if( pid &lt; 0 ) {\n            // error\n            perror(\"fork failed\");\n        }\n\n        // parent\n</code></pre>\n\n<p>Once done you have to wait for <em>all</em> children to complete. <code>wait</code> will return when <em>any</em> child process completes, returning the child pid. You need to keep calling <code>wait</code> until it returns with &lt; 0 indicating there were no more child processes.</p>\n\n<pre><code>void wait_all() {\n    while(wait(NULL) &gt; 0);\n}\n</code></pre>\n\n<p>Putting them all together, and removing the compilation of doing it 15 times...</p>\n\n<pre><code>    for(int j=0; j&lt;10; j++){\n        pid_t pid = fork();\n        if( pid == 0 ) {\n            // print\n            printf(\"%d\", j);\n            // job's done\n            exit(0);\n        }\n        else if( pid &lt; 0 ) {\n            perror(\"fork failed\");\n        }\n    }\n\n    wait_all();\n    printf(\"\\n\");\n</code></pre>\n\n<p>Even so I still get them in order. Probably because each child is executing the exact same very simple and predictable thing. They all take roughly the same amount of time to execute, so they're probably going to come out in the same order.</p>\n\n<hr>\n\n<p><em>Side Note</em>: <code>stdout</code> is line buffered, meaning it will only display, or flush, its contents when it sees a newline. <code>printf(\"%d\", j);</code> won't display until a newline is printed or <code>stdout</code> gets flushed. <code>exit</code> will flush and close all streams, so that's ok.</p>\n\n<p>However, the child inherits the parent's buffer. This can lead to some pretty weird behavior if the parent leaves anything on the buffer. For example...</p>\n\n<pre><code>    for(int j=0; j&lt;10; j++){\n        pid_t pid = fork();\n        if( pid == 0 ) {\n            printf(\"child: %d, \", j);\n            exit(0);\n        }\n        else if( pid &lt; 0 ) {\n            perror(\"fork failed\");\n        }\n        printf(\"parent: %d, \", j);\n    }\n    wait_all();\n    printf(\"\\n\");\n</code></pre>\n\n<p>We get:</p>\n\n<pre><code>child: 0, parent: 0, child: 1, parent: 0, parent: 1, child: 2, parent: 0, parent: 1, parent: 2, child: 3, parent: 0, parent: 1, parent: 2, parent: 3, child: 4, parent: 0, parent: 1, parent: 2, parent: 3, parent: 4, child: 5, parent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, child: 6, parent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, child: 7, parent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, parent: 7, child: 8, parent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, parent: 7, parent: 8, child: 9, parent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, parent: 7, parent: 8, parent: 9,\n</code></pre>\n\n<p>What's going on? This boggled me for a while. It's a little clearer if we put a newline in the child's print.</p>\n\n<pre><code>    for(int j=0; j&lt;10; j++){\n        pid_t pid = fork();\n        if( pid == 0 ) {\n            printf(\"child: %d\\n\", j);\n            exit(0);\n        }\n        else if( pid &lt; 0 ) {\n            perror(\"fork failed\");\n        }\n        printf(\"parent: %d, \", j);\n    }\n    wait_all();\n    printf(\"\\n\");\n\nchild: 0\nparent: 0, child: 1\nparent: 0, parent: 1, child: 2\nparent: 0, parent: 1, parent: 2, child: 3\nparent: 0, parent: 1, parent: 2, parent: 3, child: 4\nparent: 0, parent: 1, parent: 2, parent: 3, parent: 4, child: 5\nparent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, child: 6\nparent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, child: 7\nparent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, parent: 7, child: 8\nparent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, parent: 7, parent: 8, child: 9\nparent: 0, parent: 1, parent: 2, parent: 3, parent: 4, parent: 5, parent: 6, parent: 7, parent: 8, parent: 9, \n</code></pre>\n\n<p>Each time the child is forked it gets a copy of the parent's <code>stdout</code> buffer. Each time through the loop the parent adds <code>parent: %d,</code> to that buffer without flushing. When the child does <code>printf(\"child: %d\\n\", j);</code> it <em>adds</em> to the existing buffer and then flushes it.</p>\n\n<ul>\n<li>The first child copies <code>\"\"</code> from the parent, adds <code>child: 0\\n</code>, and flushes.</li>\n<li>The parent adds <code>parent: 0,</code> to <code>stdout</code>.</li>\n<li>The second child copies <code>parent: 0,</code>, adds <code>child: 1\\n</code>, and flushes.</li>\n<li>The parent adds <code>parent: 1,</code> to <code>stdout</code>, its now <code>parent: 0, parent: 1,</code></li>\n<li>The third child copies <code>parent: 0, parent: 1,</code>, adds <code>child: 2\\n</code>, and flushes.</li>\n</ul>\n\n<p>And so on.</p>\n\n<p>Flushing <code>stdout</code> after the parent does a partial print avoids this, and ensures everything is displayed as it happens.</p>\n\n<pre><code>    for(int j=0; j&lt;10; j++){\n        pid_t pid = fork();\n        if( pid == 0 ) {\n            printf(\"child: %d\\n\", j);\n            exit(0);\n        }\n        else if( pid &lt; 0 ) {\n            perror(\"fork failed\");\n        }\n        printf(\"parent: %d, \", j);\n        fflush(stdout);\n    }\n    wait_all();\n    printf(\"\\n\");\n\nparent: 0, child: 0\nparent: 1, child: 1\nparent: 2, child: 2\nparent: 3, child: 3\nparent: 4, child: 4\nparent: 5, child: 5\nparent: 6, child: 6\nparent: 7, child: 7\nparent: 8, child: 8\nparent: 9, child: 9\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 0, "last_activity_date": 1550704565, "creation_date": 1550704565, "answer_id": 54796771, "question_id": 54793571, "link": "https://stackoverflow.com/questions/54793571/how-to-demonstrate-the-unpredictable-order-of-fork-in-c/54796771#54796771", "title": "How to demonstrate the unpredictable order of fork() in C?", "body": "<blockquote>\n  <p>I try this the numbers just print in order with no unpredictability at all.</p>\n</blockquote>\n\n<p>When a thread calls <code>fork()</code>:</p>\n\n<ul>\n<li>maybe the kernel is designed so that the CPU creates the new process and switches to the new process, and maybe (if there's multiple CPUs) the new process has to wait for a different CPU to wake up and check its scheduler queue before the new process gets any CPU time</li>\n<li>maybe the kernel is designed so that the CPU creates the new process and returns to the old process, and maybe (if there's multiple CPUs) the old process has to wait for a different CPU to wake up and check its scheduler queue before the new process gets any CPU time</li>\n<li>maybe the kernel is designed so that the CPU does the least work possible before returning to the old process, then (possibly much later) when the new process gets CPU time the kernel finished doing any work needed to create the new process before returning to the new process</li>\n</ul>\n\n<p>Notice that all of these things are \"unpredictable\" if you don't know which kernel/OS your program will run on or if there will/won't be multiple CPUs; but with \"same kernel/OS on same computer\" they're all completely predictable and won't change (e.g. a kernel doesn't just redesign itself while running).</p>\n\n<p>However:</p>\n\n<ul>\n<li>maybe the old task has used almost all of its time slice before calling <code>fork()</code> and the kernel decides that the old task has used its entire time slice immediately after <code>fork()</code> finishes; and this upsets the timing</li>\n<li>maybe lots of other processes are constantly blocking/unblocking; and this upsets the timing</li>\n<li>maybe an IRQ occurs at a specific point and that upsets the timing</li>\n</ul>\n\n<p>Notice that these things create \"unpredictability\" even with \"same kernel/OS on same computer\"; but all of them are relatively infrequent. You might need to <code>fork()</code> a few million times before you get lucky and one of these things upsets the timing enough to change \"who reaches <code>printf()</code> first\".</p>\n\n<p>With this in mind; to demonstrate \"rare unpredictability on same kernel/OS on same computer\"; I'd probably write a program that:</p>\n\n<ul>\n<li>calls <code>fork()</code></li>\n<li>gets both processes to print something different without any newline characters (e.g. old process prints \"0\" and new process prints \"1\")</li>\n<li>the new process calls <code>exit()</code></li>\n<li>the old process waits for the new process to terminate</li>\n<li>the old process prints a newline character (e.g. so that the complete line printed will be \"01\\n\" or \"10\\n\")</li>\n<li>the old process goes back to the start (e.g. a loop that's executed a million times).</li>\n</ul>\n\n<p>That way, by checking the whole 1 million lines of output you'd have a relatively high chance of seeing some \"rare unpredictability\".</p>\n"}], "owner": {"reputation": 63, "user_id": 11091914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcc74a12c8e8ba52b82b5fc0238696b4?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/11091914/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "answer_count": 5, "score": 4, "last_activity_date": 1550704565, "creation_date": 1550689509, "question_id": 54793571, "link": "https://stackoverflow.com/questions/54793571/how-to-demonstrate-the-unpredictable-order-of-fork-in-c", "title": "How to demonstrate the unpredictable order of fork() in C?", "body": "<p>I'm really stuck on this assignment. It is a pretty simple program I have to write in C. The idea is to demonstrate the use of fork() and wait(). <br>\nThe instructions say to \"Perform exactly 15 iterations before terminating. In each iteration, the program will create 10 child processes (p0 to p9). Each process will print its decimal digit once without a newline before exiting. After creating the 10 children, the parent process will wait until it's 10 children have completed, then print a newline before going to the next iteration or exiting. Do not have 10 explicit calls to fork(), use a loop with only one instance of the fork() call. In order to wait for all the children to complete, use wait(NULL) in a loop until the return value of wait(NULL) is -1.\" <br>\nHere is a sample output: <br></p>\n\n<pre><code>9856724310\n8149765320\n2789654310\n0139874265\n8765320149\n2145367809\n0123456798\n0124356789\n0123546789\n9854320761\n0123678594\n0142685379\n0123456789\n6795438210\n2394567081\n</code></pre>\n\n<p><br><br>\nHere is what I have but it seems that every way I try this the numbers just print in order with no unpredictability at all.</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/types.h&gt;\n\nusing namespace std;\nint main(int argc, char** argv) {\n    pid_t pid;\n    for(int i=0; i&lt;15; i++){\n        //fork();\n        for(int j=0; j&lt;10; j++){\n            pid = fork();\n            printf(\"%d\", j);\n        }\n        wait(NULL);\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Any help is greatly appreciated! Thank you!</p>\n"}, {"tags": ["mysql", "c", "database-connection", "prepared-statement"], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 6211236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515d77ab22ec24182c973e8265b662f0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel ", "link": "https://stackoverflow.com/users/6211236/daniel"}, "is_accepted": true, "score": 0, "last_activity_date": 1550692572, "creation_date": 1550692572, "answer_id": 54794305, "question_id": 54793506, "link": "https://stackoverflow.com/questions/54793506/syntax-error-in-mysql-prepare-statement-using-c-api/54794305#54794305", "title": "Syntax error in mySQL prepare statement using C API", "body": "<p>It looks like the string length being passed to <code>mysql_stmt_prepare</code> is wrong - try changing the 64 to 24.</p>\n\n<p>Or better yet, try something like:</p>\n\n<pre><code>const char sql_sp[] = \"call esame_cancella(?) \";\n...\nstatus = mysql_stmt_prepare(stmt, sql_sp, sizeof(sql_sp));\n</code></pre>\n"}], "owner": {"reputation": 212, "user_id": 8024584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-Pwwdk425ODE/AAAAAAAAAAI/AAAAAAAAAC4/LtAdfXYroZE/photo.jpg?sz=128", "display_name": "sixpain", "link": "https://stackoverflow.com/users/8024584/sixpain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 54794305, "answer_count": 1, "score": 0, "last_activity_date": 1550692572, "creation_date": 1550689283, "question_id": 54793506, "link": "https://stackoverflow.com/questions/54793506/syntax-error-in-mysql-prepare-statement-using-c-api", "title": "Syntax error in mySQL prepare statement using C API", "body": "<p>I created a mySQL database, with some stored procedures. Using mySQL Workbench the SP forks fine, and now i need to launch them using a c program.</p>\n\n<p>I created the program, which connect successfully to my db, and i'm able to launch procedures wich not requires parameters.</p>\n\n<p>To launch more complex procedure i need to use the prepare statement in c: in particular, i want to call the procedure <code>esame_cancella(IN code CHAR(5))</code> wich delete a selected row of the table 'esame'.</p>\n\n<pre><code>    int status;\n    MYSQL_RES *result;\n    MYSQL_ROW row;\n    MYSQL_FIELD *field;\n    MYSQL_RES *rs_metadata;\n    MYSQL_STMT *stmt;\n    MYSQL_BIND ps_params[6];\n    unsigned long length[6];\n    char cod[64];\n\n    printf(\"Codice: \");\n    scanf (\"%s\",cod);\n    length[0] = strlen(cod);\n\n    stmt = mysql_stmt_init(conn);\n    if (stmt == NULL) {\n        printf(\"Could not initialize statement\\n\");\n        exit(1);\n    }\n\n    status = mysql_stmt_prepare(stmt, \"call esame_cancella(?) \", 64);\n    test_stmt_error(stmt, status); //line which gives me the syntax error \n\n    memset(ps_params, 0, sizeof(ps_params));\n\n    ps_params[0].buffer_type = MYSQL_TYPE_VAR_STRING;\n    ps_params[0].buffer = cod;\n    ps_params[0].buffer_length = 64;\n    ps_params[0].length = &amp;length[0];\n    ps_params[0].is_null = 0;\n\n\n    // bind parameters\n    status = mysql_stmt_bind_param(stmt, ps_params); //muore qui\n    test_stmt_error(stmt, status);\n\n    // Run the stored procedure\n    status = mysql_stmt_execute(stmt);\n    test_stmt_error(stmt, status);\n\n    }\n</code></pre>\n\n<p>i use <code>test_stmt_error</code> to see mySQL log calling procedures.</p>\n\n<pre><code>    static void test_stmt_error(MYSQL_STMT * stmt, int status)\n    {\n        if (status) {\n            fprintf(stderr, \"Error: %s (errno: %d)\\n\",\n            mysql_stmt_error(stmt), mysql_stmt_errno(stmt));\n            exit(1);\n        }\n    }\n</code></pre>\n\n<p>when i compile, and launch my program, i have the following log:</p>\n\n<p>Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1 (errno: 1064)</p>\n\n<p>Any help?</p>\n"}, {"tags": ["c", "arrays", "casting"], "comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1550690627, "post_id": 54793505, "comment_id": 96365632, "body": "Only if you want to treat the 2D array as a 1D array..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8310693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EYf0ZxAtoUQ/AAAAAAAAAAI/AAAAAAAABAo/c0OFo6EJBqA/photo.jpg?sz=128", "display_name": "Sports TV", "link": "https://stackoverflow.com/users/8310693/sports-tv"}, "edited": false, "score": 0, "creation_date": 1550691418, "post_id": 54793837, "comment_id": 96365991, "body": "Thank you so much.I am learning to code and it was written in a book.I was having a hard time.Now it makes sense."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550695174, "post_id": 54793837, "comment_id": 96367753, "body": "What if you did <code>float *p = &amp;(balance[0][0]);</code>?  You can use pointer arithmetics with it."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1550697709, "post_id": 54793837, "comment_id": 96368895, "body": "@CacahueteFrito <code>&amp;(balance[0][0])</code> is the same thing as <code>*balance</code>: a pointer to the first element of the first row. The only problem is that the standard only defines pointer arithmetics <b>inside</b> an array (or one past end) and that here the float arrays only have size 2."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1550690619, "creation_date": 1550690619, "answer_id": 54793837, "question_id": 54793505, "link": "https://stackoverflow.com/questions/54793505/type-cast-in-pointer-arithmetic-for-two-dimensional-arrayc/54793837#54793837", "title": "Type cast in Pointer arithmetic for two dimensional array(C)", "body": "<p>Balance is a 2D array that is an array of arrays. It will decay like any array to a pointer to its first element... but that element is still an array and not a float!</p>\n\n<p>That is the reason why you need a cast here, but in fact casting a pointer to an array to a pointer to its first element is not really standard wise. The correct way is to dereference <code>balance</code>: it will be an 1D array which will nicely decay to a pointer to the first float:</p>\n\n<pre><code>p = *balance;    // no cast required here\n</code></pre>\n\n<p>That being said, on a pedantic point of view, the next line (<code>*(p+(3*2)+1)</code>) aliases a 2D 2x5 array to an 1D array of size 10. The result is undefined per the standard as soon as the index is larger that the row size here 2. Of course all common implementation allow it for compatibility with old code, but you really should wonder why you need it and avoid that if you can.</p>\n\n<p>The correct and conformant way would be:</p>\n\n<pre><code>float (*pp)[2];\nfloat balance[5][2] = { 2.34,\n    5.66,7.85,12.56,9.87,76.22,56.55,21.02,66.12,10.001 };\npp = balance;\nprintf(\"%.2f\\n\", pp[3][1]);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8310693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EYf0ZxAtoUQ/AAAAAAAAAAI/AAAAAAAABAo/c0OFo6EJBqA/photo.jpg?sz=128", "display_name": "Sports TV", "link": "https://stackoverflow.com/users/8310693/sports-tv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1550694415, "creation_date": 1550689282, "question_id": 54793505, "link": "https://stackoverflow.com/questions/54793505/type-cast-in-pointer-arithmetic-for-two-dimensional-arrayc", "title": "Type cast in Pointer arithmetic for two dimensional array(C)", "body": "<p>Do I need to do type casting when I want to index a specific array element of a two dimensional array manually with pointer arithmetic.If so why? Here's what I mean:</p>\n\n<pre><code>float *p;\nfloat balance[5][2]={2.34, \n5.66,7.85,12.56,9.87,76.22,56.55,21.02,66.12,10.001};\np=(float *) balance;   //Do I need this type casting and if so why?    \nprintf(\"%.2f\",*(p+(3*2)+1));  \n</code></pre>\n"}, {"tags": ["c", "embedded", "microcontroller", "startup", "stack-pointer"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1550688780, "post_id": 54793321, "comment_id": 96364781, "body": "The initial stack pointer state should be specified in the data sheet of the microcontroller."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1550688894, "post_id": 54793321, "comment_id": 96364830, "body": "The quick answer is you do.  Generally, the stack pointer is one of the first things defined in startup code.  Where in memory you place the stackpointer is generally strongly hinted at by your datasheet, but you ( or whomever writes crt0 or init kernel or whatever) gets to choose.  Your board will jump to some hardwired address in memory and start executing code on powerup.  This is where that define would go or where you would .org your startup code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1550689567, "post_id": 54793321, "comment_id": 96365151, "body": "Aside: in some processors the NMI is not really non-maskable: it is only enabled once you set the stack pointer."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1550711062, "post_id": 54793321, "comment_id": 96372911, "body": "both.  some architectures the stack pointer is defined by hardware, i would assume this to be rare.  think 6502 for example.  Other architectures it is all up to you like arm7 and cortex-m based.  you read the documentation see how much ram the device has decide how you the software developer wants to divide that memory up for your project leaving some for stack."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1550711088, "post_id": 54793321, "comment_id": 96372919, "body": "HOW you set the stack pointer if you can and choose to is also architecture specific."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1550711185, "post_id": 54793321, "comment_id": 96372944, "body": "You are responsible as the software developer but most of the sandboxed environments will detect or ask you what chip you are using, their compilers will have a linker script, and bootstrap code setup for you, very likely including the initialization of the stack pointer.  But there are many sandboxes to play in and they all are both similar and different."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1550692299, "creation_date": 1550692299, "answer_id": 54794240, "question_id": 54793321, "link": "https://stackoverflow.com/questions/54793321/who-defines-the-stack-pointer-address/54794240#54794240", "title": "Who defines the stack pointer address", "body": "<p>Every architecture does it it's way. ARM Cortex uCs have the initial stack pointer location stored as the first 32 bits value in the vector table. This value is loaded by the hardware when the uC is booted. So this address is fully controllable by the programmer. </p>\n\n<p>Then the start-up routine can change it or set the double stack (one for the thread another for the privileged mode).</p>\n"}, {"comments": [{"owner": {"reputation": 3037, "user_id": 4768946, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dca1cd14f29e197b1547ac5127218d95?s=128&d=identicon&r=PG&f=1", "display_name": "Engineer999", "link": "https://stackoverflow.com/users/4768946/engineer999"}, "edited": false, "score": 0, "creation_date": 1550748993, "post_id": 54804841, "comment_id": 96388580, "body": "Ok Thanks for that. Normally is the start-up-code always provided by the chip vendor? , or we have to write it from scratch? for example an ARM chip from Atmel"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1550744900, "creation_date": 1550744900, "answer_id": 54804841, "question_id": 54793321, "link": "https://stackoverflow.com/questions/54793321/who-defines-the-stack-pointer-address/54804841#54804841", "title": "Who defines the stack pointer address", "body": "<p>The stack location in RAM is almost always configurable through software. In your tool chain-specific linker script, there will be an area called <code>.stack</code> or similar, which you can decide to place at a certain address, or give a certain size. This is only the memory mapping part though.</p>\n\n<p>The first thing done in any start-up code is to set the stack pointer. It has to be done through assembler, since C has no means of directly writing to the stack pointer. On some cores like ARM, the stack pointer is set automatically by hardware out of reset, from a value that your linker script has placed in the vector table and programmed in flash.</p>\n\n<p>So generally, the silicon vendor almost always leaves this completely to the programmer to decide. The core does specify if there's an up-counting or down-counting stack however. The most common by far is down-counting, but some oddball architectures have up-counting stacks (most famously PIC).</p>\n\n<p>As for where the stack pointer is set, you'll find it very early on in the start-up code (\"CRT\"), if such code is delivered with your tool chain. Typically it takes a value obtained from the linker script, but you could as well hard-code it if you wish. It needs to be done before any C code is executed, since C loves to use the stack.</p>\n\n<p>In case you write everything yourself, you should write to the stack pointer the first thing you do out of reset, from inside the reset vector.</p>\n"}], "owner": {"reputation": 3037, "user_id": 4768946, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dca1cd14f29e197b1547ac5127218d95?s=128&d=identicon&r=PG&f=1", "display_name": "Engineer999", "link": "https://stackoverflow.com/users/4768946/engineer999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1550744900, "creation_date": 1550688652, "question_id": 54793321, "link": "https://stackoverflow.com/questions/54793321/who-defines-the-stack-pointer-address", "title": "Who defines the stack pointer address", "body": "<p>In terms of microcontrollers and embedded systems with C startup code, one of the functions of the C startup code is to initialize the stack pointer. </p>\n\n<p>Is this initial stack pointer address and C startup code generally defined and provided by the chip vendor?</p>\n\n<p>Or is it up to us as the firmware / software developers to manually modify or create the C startup code and specify the stack pointer? This part confuses me.</p>\n"}, {"tags": ["c", "shrink"], "comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 2, "creation_date": 1550692499, "post_id": 54793261, "comment_id": 96366550, "body": "<code>scanf (&quot;%s&quot;, &amp;selection);</code> will overwrite memory since <code>selection</code> is defined as a char, not a char array."}], "answers": [{"tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": false, "score": 1, "last_activity_date": 1550698592, "last_edit_date": 1550698592, "creation_date": 1550688617, "answer_id": 54793314, "question_id": 54793261, "link": "https://stackoverflow.com/questions/54793261/how-do-i-create-a-shrink-function-that-would-divide-the-input-by-2/54793314#54793314", "title": "How do I create a shrink function that would divide the input by 2?", "body": "<p>There you go, the shrink function you wanted</p>\n\n<p>1- divide your x by 2 ( shrink it ) </p>\n\n<p>2-display it correctly </p>\n\n<pre><code>void shrink(float x) {\nfloat v = x/2.0;\nprintf (\" shrink(%.2f) = %.2f/2 = %.2f\\n\", x, x, v);\n} \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11091865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27320569a9bc0b326a94b2fea0663dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukja.E ", "link": "https://stackoverflow.com/users/11091865/lukja-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1509, "favorite_count": 0, "closed_date": 1550741905, "answer_count": 1, "score": -3, "last_activity_date": 1550698592, "creation_date": 1550688394, "last_edit_date": 1550688446, "question_id": 54793261, "link": "https://stackoverflow.com/questions/54793261/how-do-i-create-a-shrink-function-that-would-divide-the-input-by-2", "closed_reason": "Needs details or clarity", "title": "How do I create a shrink function that would divide the input by 2?", "body": "<p>Using this code below, how would I create a shrink function that divides the input by 2? I'm pretty new to this stuff, so I've tried doing things like float shrink(a/2) with no luck. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid printHelp () {\n printf (\"\\n\");\n printf (\"a: a(x) = x*x\\n\");\n printf (\"b: b(x) = x*x*x\\n\");\n printf (\"c: c(x) = x^2 + 2*x + 7\\n\");\n printf (\"q: quit\\n\");\n}\n\nvoid a(float x) {\nfloat v = x*x;\nprintf (\" a(%.2f) = %.2f^2 = %.2f\\n\", x, x, v);\n} // end function a\nvoid b(float x) {\nfloat v = x*x*x;\n printf (\" a(%.2f) = %.2f^3 = %.2f\\n\", x, x, v);\n} // end function b\nvoid c(float x) {\n float v = x*x + 2*x + 7;\n printf (\" c(%.2f) = %.2f^2 + 2*%.2f + 7 = %.2f\\n\",\n x, x, x, v);\n} // end function c\nint menu () {\n char selection;\n float x;\n printHelp ();\n scanf (\"%s\", &amp;selection);\n if (selection == 'q') return 1;\n scanf (\"%f\", &amp;x);\n if (selection == 'a') a(x);\n if (selection == 'b') b(x);\n if (selection == 'c') c(x);\n return 0;\n} // end function menu\nint main() {\n while (menu() == 0);\n printf (\"... bye ...\\n\");\n return 0;\n} // end main\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1550687398, "post_id": 54793002, "comment_id": 96364095, "body": "What keeps you from doing as intended? Consider making a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1550687480, "post_id": 54793002, "comment_id": 96364125, "body": "What problem do you have with using EOF?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1550687588, "post_id": 54793002, "comment_id": 96364186, "body": "Did you try some tests on the code you are suggesting to see how it works with various test cases of simple input file? Btw, I assume by <code>filename</code> you really mean the file descriptor pointer."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1550687600, "post_id": 54793002, "comment_id": 96364195, "body": "<code>\\n</code> in a <code>scanf</code> format string is a bit of a red flag. It makes me question whether the author understands how <code>scanf</code> works."}, {"owner": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "edited": false, "score": 0, "creation_date": 1550687620, "post_id": 54793002, "comment_id": 96364208, "body": "The assignment says that testing for EOF is inferior in this case."}, {"owner": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "edited": false, "score": 0, "creation_date": 1550687680, "post_id": 54793002, "comment_id": 96364235, "body": "Clearly I am a beginner in C, any advice would be appreciated."}, {"owner": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1550696774, "post_id": 54793002, "comment_id": 96368489, "body": "@melpomene this comment is not useful at all, maybe instead of questioning my understanding of a function try explaining it instead."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1550744247, "post_id": 54793002, "comment_id": 96385625, "body": "@cap Why? It may well have been intentional. But if you really don&#39;t know, why not just check the manual of <code>scanf</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1550689628, "post_id": 54793100, "comment_id": 96365188, "body": "Curious about the downvote. Any reasons, so I may improve my answer?"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1550689881, "post_id": 54793100, "comment_id": 96365318, "body": "It&#39;s not better design to use fgets and then sscanf unless you really need to.  It&#39;s better design to just use fscanf in the way it was designed."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1550690442, "post_id": 54793100, "comment_id": 96365557, "body": "@ChrisDodd If a line in the file fails to match the format string, <code>fscanf</code> will remain at the same position in the stream. This requires additional handling that an <code>fgets</code>/<code>sscanf</code> loop wouldn&#39;t"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": -1, "last_activity_date": 1550687707, "creation_date": 1550687707, "answer_id": 54793100, "question_id": 54793002, "link": "https://stackoverflow.com/questions/54793002/how-to-read-next-line-of-input-file-until-end-of-file-without-using-eof/54793100#54793100", "title": "How to read next line of input file until end of file without using EOF", "body": "<p>It's better design to read lines from a file with a straight string-reading function (like <code>fgets</code>), and then use string parsing on the string read from the file with <code>sscanf</code> or similar. <code>scanf</code>-family functions generally shouldn't be used to read from streams directly, only from strings.</p>\n\n<p>Then, you should also check the return value of <code>sscanf</code> to ensure that each value was scanned into the intended type appropriately.</p>\n\n<pre><code>char line[200];\nwhile(fgets(line, 200, stdin))\n{\n    if(sscanf(line, \"&lt;format-string-here&gt;\", ...) != 16)\n    {\n        // handle error\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1550689725, "post_id": 54793518, "comment_id": 96365242, "body": "<code>getline</code> is a posix function; it is not standard C"}], "tags": [], "owner": {"reputation": 19, "user_id": 8195540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488da921d01564275242d4b2ce09cc32?s=128&d=identicon&r=PG&f=1", "display_name": "CodeByAk", "link": "https://stackoverflow.com/users/8195540/codebyak"}, "is_accepted": false, "score": 0, "last_activity_date": 1550689925, "last_edit_date": 1550689925, "creation_date": 1550689321, "answer_id": 54793518, "question_id": 54793002, "link": "https://stackoverflow.com/questions/54793002/how-to-read-next-line-of-input-file-until-end-of-file-without-using-eof/54793518#54793518", "title": "How to read next line of input file until end of file without using EOF", "body": "<pre><code>#include &lt;stdlib.h&gt;\nFile *file;\nsize_t len = 0;\nssize_t read;\nchar * line = NULL;     \nwhile ((read = getline(&amp;line, &amp;len, file)) != -1)\n{\n    printf(\"%s\",line);\n    if(sscanf(line, \"....format\",...)==16)){\n           ..............\n     }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 1, "last_activity_date": 1550703156, "last_edit_date": 1550703156, "creation_date": 1550689824, "answer_id": 54793656, "question_id": 54793002, "link": "https://stackoverflow.com/questions/54793002/how-to-read-next-line-of-input-file-until-end-of-file-without-using-eof/54793656#54793656", "title": "How to read next line of input file until end of file without using EOF", "body": "<p>Spaces and newlines in the fscanf format string do NOT match spaces and newlines in the input.  Instead, any whitespace character in the format means \"skip over whitespace\", reading and discarding whitespace until any non-whitespace character is found -- which might be the next character, so nothing is skipped.  In addition, most conversion specifiers also skip whitespace, so you only want spaces in the format before literal chaarcters or <code>%c</code>, <code>%[</code> and <code>%n</code>directives, which are the ones that don't skip whitespace.</p>\n\n<p>So for your purposes, you want a format string like:</p>\n\n<pre><code>while(fscanf(filename,\n         \" (%3d%2d%2d%c ,%2d%2d%2d%c ) (%3d%2d%2d%c ,%2d%2d%2d%c )\",\n         &amp;firstLonD, &amp;firstLonM, &amp;firstLonS, &amp;firstLonC,\n         &amp;firstLatD, &amp;firstLatM, &amp;firstLatS, &amp;firstLatC,\n         &amp;secLonD, &amp;secLonM. &amp;secLonS, &amp;secLonC,\n         &amp;secLatD, &amp;secLatM, &amp;secLatS, &amp;secLatC) == 16) {\n</code></pre>\n\n<p>Though it might also be better to read single coordinates in a loop a later pair them up:</p>\n\n<pre><code>while(fscanf(filename,\n         \" (%3d%2d%2d%c ,%2d%2d%2d%c )\",\n         &amp;LonD, &amp;LonM, &amp;LonS, &amp;LonC,\n         &amp;LatD, &amp;LatM, &amp;LatS, &amp;LatC) == 8) {\n</code></pre>\n\n<p>It might also be better to read the latitude/longitude as a single number and later split it into degrees/minutes/seconds by div/mod by 100:</p>\n\n<pre><code>while(fscanf(file, \" (%d%c ,%d%c )\", &amp;lonVal, &amp;lonDir, &amp;latVal, &amp;latDir) == 4) {\n    lonDeg = lonVal / 10000;\n    lonMin = (lonVal % 10000) / 100;\n    lonSec = lonVal % 100;\n</code></pre>\n\n<p>this way you can deal with longitudes &lt; 100 degrees without requiring leading 0s to make them be exactly 7 digits...</p>\n\n<hr>\n\n<p>The thing about scanf and friends is that they want to read things delimited by whitespace, and they really don't care what kind of whitespace it is.  So input all on one line with just spaces (or tabs) is the \"same\" as multiple lines.  This is an intentional \"feature\" of the way scanf works, so if you actually care about the difference between newlines and other whitespace, scanf is not the right tool.</p>\n"}], "owner": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 54793656, "answer_count": 3, "score": -1, "last_activity_date": 1550703156, "creation_date": 1550687232, "last_edit_date": 1550687547, "question_id": 54793002, "link": "https://stackoverflow.com/questions/54793002/how-to-read-next-line-of-input-file-until-end-of-file-without-using-eof", "title": "How to read next line of input file until end of file without using EOF", "body": "<p>I have an input file (lets say 10 lines) of coordinate pairs with each line looking something like this: </p>\n\n<blockquote>\n  <p>(1653408W, 503223N) (1651614W, 502806N)</p>\n</blockquote>\n\n<p>I am trying to put the given input into DMS format. Each line in the input file ends with a <code>\\n</code> character and I would like to loop through the file and stop after the final <code>\\n</code>. I was thinking of using something like:</p>\n\n<pre><code>while(fscanf(filename,\n             \"(%3d%2d%2d%c, %2d%2d%2d%c) (%3d%2d%2d%c, %2d%2d%2d%c)\\n\",\n             &amp;firstLonD, &amp;firstLonM, &amp;firstLonS, &amp;firstLonC,\n             &amp;firstLatD, &amp;firstLatM, &amp;firstLatS, &amp;firstLatC,\n             &amp;secLonD, &amp;secLonM. &amp;secLonS, &amp;secLonC,\n             &amp;secLatD, &amp;secLatM, &amp;secLatS, &amp;secLatC) == 16) {\n//do something\n}\n</code></pre>\n\n<p>Sorry for long loop conditional and possible poor readability. Any suggestions on how to proceed? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1550686448, "post_id": 54792814, "comment_id": 96363576, "body": "It&#39;s a part of a <i>bitfield</i>."}], "answers": [{"comments": [{"owner": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "edited": false, "score": 0, "creation_date": 1550686655, "post_id": 54792831, "comment_id": 96363682, "body": "So the rest 32-19=13 bits of <code>int</code> are not used? What is the advantage of writing it in this way? What is difference between <code>int abi : 8;</code> and <code>char abi;</code>? Can&#39;t I just use <code>char</code> as an 8-bit integer?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "edited": false, "score": 0, "creation_date": 1550686714, "post_id": 54792831, "comment_id": 96363712, "body": "@user1424739 yes, you cut the grass under my feet, I am editing my answer to speak about that ^^"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "edited": false, "score": 0, "creation_date": 1550686834, "post_id": 54792831, "comment_id": 96363774, "body": "@user1424739 in a lot of cases <code>int abi : 8;</code> and <code>char abi;</code> does the same, but this is not guaranty by the language"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550687248, "post_id": 54792831, "comment_id": 96364010, "body": "Note, that attempting to <code>sizeof</code> a bitfield member is a constraint violation."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550687339, "post_id": 54792831, "comment_id": 96364056, "body": "@EugeneSh. also that yes"}, {"owner": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "edited": false, "score": 0, "creation_date": 1550687345, "post_id": 54792831, "comment_id": 96364063, "body": "So code using bitfields is slower, as bit operations are needed before the data can be accessed?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "edited": false, "score": 0, "creation_date": 1550687611, "post_id": 54792831, "comment_id": 96364202, "body": "@user1424739 yes it can be a little because the generated code uses masks to get / set the value of a bit field"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1550687574, "last_edit_date": 1550687574, "creation_date": 1550686481, "answer_id": 54792831, "question_id": 54792814, "link": "https://stackoverflow.com/questions/54792814/what-does-int-kind-19-mean/54792831#54792831", "title": "What does `int kind : 19;` mean?", "body": "<pre><code>int kind : 19;\n</code></pre>\n\n<p>means 19 bits are used to memorize <em>kind</em>, it is a bit field</p>\n\n<p>this may allows to reduce the memory (heap or stack) consumption, for instance if an other field just before or after is on 13 bits both of them can use 32 bits (depending on the other fields, alignment etc)</p>\n\n<p>Example</p>\n\n<pre><code>struct S1 {\n   int kind : 19;\n   int value : 13;\n};\nstruct S2 {\n   int kind ;\n   int value;\n};\n</code></pre>\n\n<p>if <em>int</em> uses 32 bits <code>sizeof(struct S2)</code> is 8 while <code>sizeof(struct S1)</code> is 4</p>\n\n<hr>\n\n<p>There are limitations :</p>\n\n<p>For instance you cannot get the address of a bit field :</p>\n\n<pre><code>struct S1 s1;\nint * p = &amp;s1.kind;\n</code></pre>\n\n<p>produces the compiler error <code>cannot take address of bit-field \u2018kind\u2019</code>, this is because the type <code>int:19</code> does not exist and using the address of the field <em>kind</em> as an <em>int *</em> is of course a non sense.</p>\n\n<p>And as EugeneSh. says in a remark you cannot get the <em>sizeof</em> of a bitfield because the unity of <em>sizeof</em> is the size of a char ( <em>sizeof(char)</em> is 1 by definition ),  so</p>\n\n<pre><code>sizeof(s1.kind)\n</code></pre>\n\n<p>produces the compiler error <code>\u2018sizeof\u2019 applied to a bit-field</code></p>\n"}], "owner": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "closed_date": 1550686683, "answer_count": 1, "score": 0, "last_activity_date": 1550687593, "creation_date": 1550686426, "last_edit_date": 1550687593, "question_id": 54792814, "link": "https://stackoverflow.com/questions/54792814/what-does-int-kind-19-mean", "closed_reason": "Duplicate", "title": "What does `int kind : 19;` mean?", "body": "<p>I see something like <code>int kind : 19;</code>. I am not familar with this syntax. Could anybody let me know what it means? Thanks.</p>\n\n<pre><code>struct _jit_type\n{\n    unsigned int ref_count;\n    int          kind         : 19;\n    int          abi          : 8;\n    int          is_fixed     : 1;\n    int          layout_flags : 4;\n    jit_nuint    size;\n    jit_nuint    alignment;\n    jit_type_t   sub_type;\n    unsigned int num_components;\n    struct jit_component components[1];\n};\n</code></pre>\n\n<p><a href=\"http://git.savannah.gnu.org/cgit/libjit.git/tree/jit/jit-internal.h#n784\" rel=\"nofollow noreferrer\">http://git.savannah.gnu.org/cgit/libjit.git/tree/jit/jit-internal.h#n784</a></p>\n"}, {"tags": ["c++", "c", "linux", "signals", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1550681687, "post_id": 54791361, "comment_id": 96361209, "body": "WSL bug maybe??"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1550682275, "post_id": 54791361, "comment_id": 96361576, "body": "Do any functions return an error?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1550689184, "post_id": 54791361, "comment_id": 96364965, "body": "What is <code>TSignalHandler</code>? What is <code>functor</code>?"}, {"owner": {"reputation": 158, "user_id": 2375262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95f3f066a9505066439aa254e4de63da?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2375262/matt"}, "edited": false, "score": 0, "creation_date": 1550722221, "post_id": 54791361, "comment_id": 96375535, "body": "As one might see on line 4, functor is a function pointer with type <code>void* (*) (void*)</code>. And as one might know from the sigaction struct, <code>TSignalHandler</code> is a void functiong taking one int parameter."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1550765536, "post_id": 54791361, "comment_id": 96399815, "body": "If you run the program under gdb, can you show us what line of code makes it hang, and get a backtrace?"}, {"owner": {"reputation": 158, "user_id": 2375262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95f3f066a9505066439aa254e4de63da?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2375262/matt"}, "edited": false, "score": 0, "creation_date": 1550808029, "post_id": 54791361, "comment_id": 96414943, "body": "I just tried it, it DOES NOT hang in GDB.  So, it hangs in WSL without GDB, but runs fine in native linux without GDB, but runs fine in WSL WITH gdb."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1550808296, "post_id": 54791361, "comment_id": 96414991, "body": "I understand your code executes functions. But by being evasive about what they do, it decreases the likelihood that you will get useful help. MCVE please."}, {"owner": {"reputation": 158, "user_id": 2375262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95f3f066a9505066439aa254e4de63da?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2375262/matt"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1550851750, "post_id": 54791361, "comment_id": 96436814, "body": "@jxh &quot;I understand your code executes functions&quot; made me LOL at myself. Yes, I misunderstood the point of your comment. functor is an empty loop and TSignalHandler just prints a message with printf."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1550862376, "post_id": 54791361, "comment_id": 96442074, "body": "It is probably not your issue, but calling <code>printf</code> from a signal handler is a bad idea. The general purpose C library functions are often not reentrant, and can hang if the signal is being handled while it is in the middle of uncompleted library call itself."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1550875950, "post_id": 54791361, "comment_id": 96447306, "body": "I recommend that when you get it to hang, induce a core file (e.g., by killing the process with SIGTRAP) or attach gdb to the running process. Find the backtrace."}, {"owner": {"reputation": 158, "user_id": 2375262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95f3f066a9505066439aa254e4de63da?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2375262/matt"}, "edited": false, "score": 0, "creation_date": 1550960926, "post_id": 54791361, "comment_id": 96466383, "body": "@lxh Problem solved thanks you your GDB comment,I assumed the problem was WSL because it ran fine on native linux.I was wrong (way wrong). the problem was that on native linux, the new thread had time to set up before the main thread started using it.On WSL the main thread started using the new thread before it had time to setup, causing the new thread to get used too soon.  This caused the thread to behave in an undefined manner and the main thread would stay joined for ever.  Thanks again jxh If you submit an answer about attaching GDB ill accept it."}, {"owner": {"reputation": 158, "user_id": 2375262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95f3f066a9505066439aa254e4de63da?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2375262/matt"}, "edited": false, "score": 0, "creation_date": 1550961013, "post_id": 54791361, "comment_id": 96466407, "body": "also @jhx, I will make sure not to call printf in a release, they are just for debugging atm, thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 2375262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95f3f066a9505066439aa254e4de63da?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2375262/matt"}, "edited": false, "score": 0, "creation_date": 1551151701, "post_id": 54858637, "comment_id": 96525654, "body": "Thanks, this really helped me find my issue, which was my own fault and not wsl. Race condition, in code that was called by posted code."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 2, "last_activity_date": 1551208426, "last_edit_date": 1551208426, "creation_date": 1551061140, "answer_id": 54858637, "question_id": 54791361, "link": "https://stackoverflow.com/questions/54791361/why-does-the-program-hang-in-wsl/54858637#54858637", "title": "Why does the program hang in WSL?", "body": "<p>When you have a hanging bug that you cannot reproduce when running within the debugger, you can attach the debugger to the running process after you reproduce the hang. This won't let you observe the variables changing as you lead to the hang, but at least you get the stack trace of exactly where the hang is occurring.</p>\n\n<p>Once you know the process id of the hung process (assume it's 12345), you can use:</p>\n\n<blockquote>\n<pre><code>$ gdb -p 12345\n</code></pre>\n</blockquote>\n\n<p>Or, you can kill the process with a signal that will cause a core to be generated. I like to use <code>SIGTRAP</code>, since it is easy to distinguish from a <code>SIGSEGV</code>.</p>\n\n<blockquote>\n<pre><code>$ kill -SIGTRAP 12345\n</code></pre>\n</blockquote>\n\n<p>And then you can use <code>gdb</code> to discover what the process was hanging on.</p>\n\n<p>The advantage of attaching to the running process is that the process is still live. This allows you to call functions from the debugger, which may provide easier access to diagnostics built into your program. The core file preserves the error, which is beneficial if the hanging bug is difficult to reproduce.</p>\n"}], "owner": {"reputation": 158, "user_id": 2375262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95f3f066a9505066439aa254e4de63da?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2375262/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 54858637, "answer_count": 1, "score": 2, "last_activity_date": 1551208426, "creation_date": 1550681001, "last_edit_date": 1551061209, "question_id": 54791361, "link": "https://stackoverflow.com/questions/54791361/why-does-the-program-hang-in-wsl", "title": "Why does the program hang in WSL?", "body": "<p>I have the following code in my program.</p>\n\n<pre><code>Thread* t = arg-&gt;thread;\n//at this point, the new thread is being executed.\nt-&gt;myId = TGetId();\nvoid* (*functor)(void*) = t-&gt;functor;\nvoid* fArg = arg-&gt;arg;\nnfree(arg);\n_INFO_PRINTF(1, \"Launching thread with ID: %d\", t-&gt;myId);\nsigset_t mask;\nsigfillset(&amp;mask);         //fill mask with all signals\nsigdelset(&amp;mask, SIGUSR1); // allow SIGUSR1 to get to the thread.\nsigdelset(&amp;mask, SIGUSR2); // allow SIGUSR2 to get to the thread.\npthread_sigmask(SIG_SETMASK, &amp;mask, NULL); //block some sigs\n\nstruct sigaction act;\nmemset(&amp;act, 0, sizeof(act));\nact.sa_handler = TSignalHandler;\nact.sa_mask = mask;\nif(sigaction(SIGUSR1, &amp;act, NULL))\n{\n    _ERROR_PRINT(1, \"Could not set signal action.\");\n    return NULL;\n}\nif(sigaction(SIGUSR2, &amp;act, NULL))\n{\n    _ERROR_PRINT(1, \"Could not set signal action.\");\n    return NULL;\n}\nvoid* ret = functor(fArg);\nt-&gt;hasReturned = true;\nreturn ret;\n</code></pre>\n\n<p>The thread that executes this code will properly call the signal handler when on native linux.  The problem is that on Windows Subsystem for Linux, the program hangs with the SIGUSR1 or SIGUSR2 is sent via pthread_kill which sends signals to a thread.  Why does this work on native ubuntu (via VMWARE WORKSTATION 14) and debian and fedora, but NOT WSL?</p>\n"}, {"tags": ["c++", "c", "mqtt", "mosquitto"], "comments": [{"owner": {"reputation": 3666, "user_id": 1373856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dc47dfe9d2847119c55d74a038e4b?s=128&d=identicon&r=PG", "display_name": "Ben T", "link": "https://stackoverflow.com/users/1373856/ben-t"}, "edited": false, "score": 0, "creation_date": 1550715133, "post_id": 54791231, "comment_id": 96373838, "body": "You can check the AWS console and cloudwatch to see if the connection was successful. As for <code>fail to push data</code> the code snippet doesn&#39;t publish any message - what are you expecting to appear?"}, {"owner": {"reputation": 3666, "user_id": 1373856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dc47dfe9d2847119c55d74a038e4b?s=128&d=identicon&r=PG", "display_name": "Ben T", "link": "https://stackoverflow.com/users/1373856/ben-t"}, "edited": false, "score": 0, "creation_date": 1550715178, "post_id": 54791231, "comment_id": 96373846, "body": "You probably also want to set the <code>host</code> to your iot endpoint instead of <code>amazonaws.com</code>"}, {"owner": {"reputation": 81, "user_id": 1676751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474f2066b334a43a9433b6560f2225b?s=128&d=identicon&r=PG&f=1", "display_name": "chinmaya", "link": "https://stackoverflow.com/users/1676751/chinmaya"}, "reply_to_user": {"reputation": 3666, "user_id": 1373856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dc47dfe9d2847119c55d74a038e4b?s=128&d=identicon&r=PG", "display_name": "Ben T", "link": "https://stackoverflow.com/users/1373856/ben-t"}, "edited": false, "score": 0, "creation_date": 1550715813, "post_id": 54791231, "comment_id": 96373994, "body": "@blt I have deliberately removed the lines of code for publish to keep the lines of code less. callback functions (e.g. my_connect_callback)  do not get call even though the mosquitto_connect is successful is my biggest concern."}, {"owner": {"reputation": 81, "user_id": 1676751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474f2066b334a43a9433b6560f2225b?s=128&d=identicon&r=PG&f=1", "display_name": "chinmaya", "link": "https://stackoverflow.com/users/1676751/chinmaya"}, "reply_to_user": {"reputation": 3666, "user_id": 1373856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dc47dfe9d2847119c55d74a038e4b?s=128&d=identicon&r=PG", "display_name": "Ben T", "link": "https://stackoverflow.com/users/1373856/ben-t"}, "edited": false, "score": 0, "creation_date": 1550716095, "post_id": 54791231, "comment_id": 96374056, "body": "For ease of read i have added just &quot;amazonaws.com&quot; else i have a pretty good 39 byte size long string as iot endpoint. Thanks for your response @blt"}, {"owner": {"reputation": 3666, "user_id": 1373856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dc47dfe9d2847119c55d74a038e4b?s=128&d=identicon&r=PG", "display_name": "Ben T", "link": "https://stackoverflow.com/users/1373856/ben-t"}, "edited": false, "score": 0, "creation_date": 1550749081, "post_id": 54791231, "comment_id": 96388633, "body": "Which CA certificate are you using? The AWS IoT Cloudwatch logs may also help."}, {"owner": {"reputation": 81, "user_id": 1676751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474f2066b334a43a9433b6560f2225b?s=128&d=identicon&r=PG&f=1", "display_name": "chinmaya", "link": "https://stackoverflow.com/users/1676751/chinmaya"}, "reply_to_user": {"reputation": 3666, "user_id": 1373856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dc47dfe9d2847119c55d74a038e4b?s=128&d=identicon&r=PG", "display_name": "Ben T", "link": "https://stackoverflow.com/users/1373856/ben-t"}, "edited": false, "score": 0, "creation_date": 1550878201, "post_id": 54791231, "comment_id": 96447850, "body": "@blt After giving the right ca.crt, all the callbacks started to get called (my_connect_callback and my_publish_callback). If my_publish_callback gets called then the publish is success that&#39;s what my understanding is. But i do not see data in AWS, would you like to help me in figuring out what would be the cause of this ?"}, {"owner": {"reputation": 3666, "user_id": 1373856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220dc47dfe9d2847119c55d74a038e4b?s=128&d=identicon&r=PG", "display_name": "Ben T", "link": "https://stackoverflow.com/users/1373856/ben-t"}, "edited": false, "score": 0, "creation_date": 1550883469, "post_id": 54791231, "comment_id": 96448848, "body": "I suggest you edit this question or create a new one with what you have tried. Otherwise, I recommend checking the Cloudwatch logs."}], "owner": {"reputation": 81, "user_id": 1676751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474f2066b334a43a9433b6560f2225b?s=128&d=identicon&r=PG&f=1", "display_name": "chinmaya", "link": "https://stackoverflow.com/users/1676751/chinmaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551019362, "creation_date": 1550680554, "last_edit_date": 1551019362, "question_id": 54791231, "link": "https://stackoverflow.com/questions/54791231/callback-function-for-mosquitto-c-apis-is-not-getting-called", "title": "callback function for mosquitto c APIs is not getting called", "body": "<p>For some reason, I had to use C APIs in C++ code. Would anyone please help me in finding the reason for which this code is not working.</p>\n\n<pre><code>void ConfigureBroker()\n{\n   auto res = mosquitto_lib_init();\n   if (res == MOSQ_ERR_SUCCESS)\n      std::cout&lt;&lt;\" mosquitto_lib_init succeed. \"&lt;&lt;std::endl;\n   else\n      std::cout&lt;&lt;\" mosquitto_lib_init failed with result : \"&lt;&lt;res&lt;&lt;std::endl;\n\n   struct mosquitto * mosq = NULL;\n   const char *clientId = \"mydev\";\n   mosq = mosquitto_new(clientId, true, NULL);\n   if (!mosq) {\n      std::cout&lt;&lt;\" mosquitto_new failed. \"&lt;&lt;std::endl;\n      return;\n   }\n   else\n      std::cout&lt;&lt;\" mosquitto_new succeed. \"&lt;&lt;std::endl;\n\n   res = mosquitto_tls_set(mosq, \"path/to/CA.crt\", NULL,\n                         \"path/to/crts/DeviceCert1.crt\",\n                         \"path/to/DeviceCert1.key\", NULL);\n\n   if (MOSQ_ERR_SUCCESS == res)\n      std::cout&lt;&lt;\"mosquitto_tls_set succeed.\"&lt;&lt;std::endl;\n   else\n      std::cout&lt;&lt;\"mosquitto_tls_set failed with result : \"&lt;&lt;res&lt;&lt;std::endl;\n\n   mosquitto_connect_callback_set(mosq, my_connect_callback);\n\n   const char *host = \"amazonaws.com\";\n   res = mosquitto_connect(mosq, host, 8883, 60);\n\n   if (MOSQ_ERR_SUCCESS == res)\n      std::cout&lt;&lt;\"mosquitto_connect succeed.\"&lt;&lt;std::endl;\n   else\n      std::cout&lt;&lt;\"mosquitto_connect failed with result : \"&lt;&lt;res&lt;&lt;std::endl;\n\n   while(!mosquitto_loop(mosq, -1, 1))\n      std::cout&lt;&lt;\"mosquitto_loop_forever suceed. \\n \"&lt;&lt;std::endl;\n}\n</code></pre>\n\n<p>The output to the above code is as below</p>\n\n<pre><code>mosquitto_lib_init succeed.\nmosquitto_new succeed.\nmosquitto_tls_set succeed.\nmosquitto_connect succeed.\nmosquitto_loop_forever suceed.\nmosquitto_loop_forever suceed.\nmosquitto_loop_forever suceed.\nmosquitto_loop_forever suceed.\nmosquitto_loop_forever suceed.\nmosquitto_loop_forever suceed.\nmosquitto_loop_forever suceed.\n</code></pre>\n\n<blockquote>\n  <ol>\n  <li><p>my_connect_callback() function does get called even though mosquitto_connect() returns 0. In fact none of the callback functions\n  get call.</p></li>\n  <li><p>Though the APIs execute successfully, fail to push data into AWS.</p></li>\n  </ol>\n</blockquote>\n\n<p>mosquitto_publish() has been removed from the above code deliberately which results success as well. Any help will be appreciated.</p>\n\n<blockquote>\n  <p>FYI : mosquitto_loop_forever(mosq, -1, 1); <strong>fails</strong> with error <strong>A TLS error occured.</strong></p>\n  \n  <p>Now tested with <strong>mosquitto_pub</strong> with the same certificates and the result show there would be problem with certificates which i may need to check</p>\n</blockquote>\n\n<pre><code>Client mosqpub|11358-PCMA4GF11 sending CONNECT\nOpenSSL Error: error:14094416:SSL routines:ssl3_read_bytes:sslv3 alert certificate unknown\nError: A TLS error occurred.\n</code></pre>\n"}, {"tags": ["c", "macos", "darwin"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1550679867, "post_id": 54790858, "comment_id": 96360098, "body": "The <code>&#47;dev&#47;diskxxx</code>is just a directory entry pointing to a special inode. <code>mknod &#47;tmp&#47;mydisk b 4096  4</code> (or similar) will probably create (an other)one for you."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1550681579, "post_id": 54790858, "comment_id": 96361147, "body": "So if you want to find an existing entry, you&#39;ll have to list the directory and look for it.  (Note that it might not exist at all.)  You can list the directory by invoking the <code>ls -l</code> command, or by calling <code>opendir</code>/<code>readdir</code> and then <code>stat</code>, whichever you find more convenient."}], "answers": [{"tags": [], "owner": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "is_accepted": true, "score": 2, "last_activity_date": 1550682249, "creation_date": 1550682249, "answer_id": 54791765, "question_id": 54790858, "link": "https://stackoverflow.com/questions/54790858/get-device-filesystem-path-from-dev-t-on-macos/54791765#54791765", "title": "Get device filesystem path from dev_t on macOS", "body": "<p>You have to enumerate the mounted file systems and look for one who's device ID matches. You can use <code>getfsstat()</code> for the enumeration. That fills in <code>struct statfs</code> structures. Compare the field <code>f_fsid.val[0]</code> of each structure to the <code>dev_t</code> you're looking for. If they match, then that <code>struct statfs</code> is the one for the device you're looking for and you can examine its other fields for the info you're looking for. In particular, the <code>f_mntfromname</code> is the device path.</p>\n"}, {"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 2, "last_activity_date": 1550683768, "last_edit_date": 1550683768, "creation_date": 1550683088, "answer_id": 54791983, "question_id": 54790858, "link": "https://stackoverflow.com/questions/54790858/get-device-filesystem-path-from-dev-t-on-macos/54791983#54791983", "title": "Get device filesystem path from dev_t on macOS", "body": "<pre><code>find /dev -type b -ls\n</code></pre>\n\n<p>, And check the output for major/minor == {0x1000,4}</p>\n\n<hr>\n\n<p>Or: <code>find /  -type b -ls</code> if need to search the entire file system. </p>\n\n<p>BTW: there could be more entries, referring to the same {major,minor} combination.</p>\n"}], "owner": {"reputation": 1268, "user_id": 481073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d55d0be7e71fcb8817afddf6123f8b78?s=128&d=identicon&r=PG", "display_name": "svth", "link": "https://stackoverflow.com/users/481073/svth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 1, "accepted_answer_id": 54791765, "answer_count": 2, "score": 0, "last_activity_date": 1550683768, "creation_date": 1550679431, "question_id": 54790858, "link": "https://stackoverflow.com/questions/54790858/get-device-filesystem-path-from-dev-t-on-macos", "title": "Get device filesystem path from dev_t on macOS", "body": "<p>If I have a 32-bit integer BSD device number dev_t (e.g. 0x1000004) on macOS (Darwin), how can I get the corresponding filesystem path for this device (e.g. \"/dev/disk1s4\")?</p>\n"}, {"tags": ["c++", "c", "memory-leaks", "free", "calloc"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1550678364, "post_id": 54790461, "comment_id": 96359178, "body": "I&#39;m curious as to why you want to use <code>char**</code> when you&#39;ve shown you are willing and able to use both <code>std::vector</code> and <code>std::string</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1550678384, "post_id": 54790461, "comment_id": 96359191, "body": "Not the problem but why is <code>numberOfKeys</code> a <code>double</code>?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1550678418, "post_id": 54790461, "comment_id": 96359204, "body": "Note that if <code>(storage[key]!=nullptr</code> is ever <code>true</code>, you fail to <code>free</code> any previous allocations you&#39;ve performed previously in your function."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1550678477, "post_id": 54790461, "comment_id": 96359248, "body": "Is this the only place you allocate stuff? The vector allocates stuff too - when does that go out of scope?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1550678492, "post_id": 54790461, "comment_id": 96359254, "body": "On some platforms, <code>free</code>ing memory doesn&#39;t necessarily mean it&#39;s returned to the OS right away. The application may still hold the rights to those pages of memory to speed up future allocations. So the released memory may still appear as being in use from the OS&#39; point of view."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 1, "creation_date": 1550678621, "post_id": 54790461, "comment_id": 96359329, "body": "What does your c-lib-function do with the <code>char **</code>?"}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1550679118, "post_id": 54790461, "comment_id": 96359654, "body": "@Fran&#231;oisAndrieux thanks! Did not think of that previous allocations."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1550679204, "post_id": 54790461, "comment_id": 96359697, "body": "@phil_rudd69 If you stick with container objects, you you won&#39;t have to worry about remembering these types of things. One of several reasons not use manual memory allocations anymore."}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1550679239, "post_id": 54790461, "comment_id": 96359715, "body": "@doctorlove it is passed to the c-lib to build a hash function from the hashKeys. see <a href=\"http://cmph.sourceforge.net/\" rel=\"nofollow noreferrer\">cmph.sourceforge.net</a>"}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1550679400, "post_id": 54790461, "comment_id": 96359819, "body": "@NathanOliver because the number can get <i>really</i> big in my real scenario."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1550679492, "post_id": 54790461, "comment_id": 96359876, "body": "@phil_rudd69 Then use a <code>std::size_t</code>.  Using a double is the wrong approach and if the number is really big you&#39;ll get the wrong result since it can only exactly represent integers of 53 bits in size.  <code>std::size_t</code> on the other hand is guaranteed to work."}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1550679767, "post_id": 54790461, "comment_id": 96360042, "body": "@NathanOliver thanks, if I change it to std::size_t, do I have to change anything else, too?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1550679841, "post_id": 54790461, "comment_id": 96360080, "body": "You should also change <code>key</code> (you loop indexes) to be <code>size_t</code> as well since <code>int</code> can be smaller than a <code>size_t</code>."}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1550679852, "post_id": 54790461, "comment_id": 96360091, "body": "@Fran&#231;oisAndrieux I don&#39;t see how I can avoid these manual allocations, since the aforementioned c-lib only takes char** as input. :)"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1550679914, "post_id": 54790461, "comment_id": 96360128, "body": "@phil_rudd69 If the number of elements doesn&#39;t fit in <code>int</code>, then your <code>for</code> loops won&#39;t work anyways."}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1550679971, "post_id": 54790461, "comment_id": 96360158, "body": "@NathanOliver obviously :D thanks"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1550680013, "post_id": 54790461, "comment_id": 96360179, "body": "@phil_rudd69 A <code>std::vector&lt;char*&gt;</code>&#39;s <code>data()</code> is a <code>char**</code>. You can then build that vector by assigning the <code>data()</code> of each element in a <code>std::vector&lt;std::string&gt;</code>."}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1550680076, "post_id": 54790461, "comment_id": 96360222, "body": "@Fran&#231;oisAndrieux makes sense as well... I&#39;ll have to check my original code. Would be a stupid mistake."}, {"owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1550680244, "post_id": 54790461, "comment_id": 96360318, "body": "@Fran&#231;oisAndrieux that&#39;s good to know. Did not know that std::vector&lt;char*&gt;&#39;s data was char**. Would have saved me some headaches."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1550680367, "post_id": 54790461, "comment_id": 96360382, "body": "@phil_rudd69 One important property of <code>std::vector</code> is that all elements are guaranteed to be stored in a contiguous array, and a <code>std::vector&lt;T&gt;</code>&#39;s <code>data()</code> member always returns a <code>T*</code> (except for <code>std::vector&lt;bool&gt;</code> for silly reasons). It can be used instead whenever you might use a dynamically allocated array."}], "owner": {"reputation": 1, "user_id": 11090916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PW7Hq.png?s=128&g=1", "display_name": "phil_rudd69", "link": "https://stackoverflow.com/users/11090916/phil-rudd69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "closed_date": 1550678614, "answer_count": 0, "score": 0, "last_activity_date": 1550678304, "creation_date": 1550678304, "question_id": 54790461, "link": "https://stackoverflow.com/questions/54790461/memory-leak-despite-deallocating-char", "closed_reason": "Duplicate", "title": "memory leak despite deallocating char **?", "body": "<p>it seems that my de-allocation does not work as intended.\nI have to copy the content of a std::vector &lt; uint64_t > into a char**, because a used C-library wants it like this. To achieve this, I wrote the following code.</p>\n\n<p><strong>Problem:</strong> Is <code>free(storage[key])</code> not the right choice here, did I forget some additional freeing? Because after that free-command the amount of occupied memory stays the same, according to ubuntu's \"system monitor\". Even after re-entering the main-function, the occupied memory of the program is still about 30MiB, which should be too much.</p>\n\n<p>I already used valgrind on this, which seems to not report any memory leak.</p>\n\n<p>Funny thing: If I repeatedly call <code>problematic_function()</code>, the amount of occupied memory in system monitor stays at 30 MiB and does not double.\nIs this only a \"system monitor\" bug?</p>\n\n<pre><code>bool problematic_function(std::vector&lt;uint64_t&gt;&amp; hashTableKeys){\n\n   // get number of keys\n   double numberOfKeys = hashTableKeys.size();\n\n   // copy keys into char** 'storage', because C-lib wants it like this.\n   char** storage = (char**)calloc( numberOfKeys, sizeof(char*));\n   if (storage!=nullptr){ // if calloc() succeeded\n      for(int key = 0; key &lt; numberOfKeys; key++){\n         std::string keyString = std::to_string(hashTableKeys[key]);\n         storage[key] = (char *)calloc( (keyString.length()+1), sizeof(char));\n         if (storage[key]!=nullptr){ // if calloc() succeeded\n            std::strcpy(storage[key], keyString.c_str());\n         }\n         else{\n            return false;\n         }\n      }\n   }\n   else{\n      return false;\n   }\n\n   // pass the char** to the c-lib-function\n   // ...\n\n   // de-allocate the memory-blocks\n   for(int key=0; key &lt; numberOfKeys; key++){\n      free(storage[key]);\n   }\n   free(storage);\n   hashTableKeys.clear();\n   return true;\n}\n\nint main(int argc, char **argv)\n{\n   /*\n    * checking if memory is freed\n    */\n\n   int numberOfModelKeys = 1000000;\n\n   // construct arbitrary keys\n   std::vector&lt;uint64_t&gt; hashTableKeys;\n   for (int i = 0; i &lt; numberOfModelKeys ; i++){\n      uint64_t hashKey = static_cast&lt;uint64_t&gt;(i);\n      hashTableKeys.push_back(hashKey);\n   }\n\n   problematic_function(hashTableKeys);\n\n   /*\n    * at this point the occupied memory of the program (as shown in ubuntu's system-monitor)\n    * is still about 30 MiB, although it probably should be a lot less.\n    */\n }\n</code></pre>\n"}, {"tags": ["mysql", "c", "mysql-connector"], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 8024584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-Pwwdk425ODE/AAAAAAAAAAI/AAAAAAAAAC4/LtAdfXYroZE/photo.jpg?sz=128", "display_name": "sixpain", "link": "https://stackoverflow.com/users/8024584/sixpain"}, "edited": false, "score": 0, "creation_date": 1550681450, "post_id": 54790378, "comment_id": 96361050, "body": "compiling this <code>char code[5]; \t\tchar name[30]; \t\tfloat cost; \t\tscanf (&quot;%s&quot;,code); \t\tscanf (&quot;%s&quot;,name); \t\tscanf (&quot;%f&quot;,&amp;cost); \t\tprintf(&quot;%s\\n&quot;,code); \t\tprintf (&quot;%s\\n&quot;,name); \t\tprintf (&quot;%f\\n&quot;,cost);     \tprintf(&quot;Loggato come amministratore del sistema\\n\\n&quot;); \t\tsnprintf(query, 1000, &quot;call esame_aggiungi(\\&quot;%s\\&quot;, \\&quot;%s\\&quot;, %f);&quot;, code, name, cost);</code> it gives me segmentation fault. Can you help me?"}, {"owner": {"reputation": 212, "user_id": 8024584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-Pwwdk425ODE/AAAAAAAAAAI/AAAAAAAAAC4/LtAdfXYroZE/photo.jpg?sz=128", "display_name": "sixpain", "link": "https://stackoverflow.com/users/8024584/sixpain"}, "edited": false, "score": 0, "creation_date": 1550682421, "post_id": 54790378, "comment_id": 96361654, "body": "i solved the segmentation fault. Now i have to pass the <code>snprintf()</code> result to <code>mysql_query(conn,&lt;query to execute&gt;)</code>"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 212, "user_id": 8024584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-Pwwdk425ODE/AAAAAAAAAAI/AAAAAAAAAC4/LtAdfXYroZE/photo.jpg?sz=128", "display_name": "sixpain", "link": "https://stackoverflow.com/users/8024584/sixpain"}, "edited": false, "score": 0, "creation_date": 1550682459, "post_id": 54790378, "comment_id": 96361674, "body": "<code>snprintf</code> populates the string pointed to by the first parameter (i.e. <code>query</code>); you can use that"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1550682547, "last_edit_date": 1550682547, "creation_date": 1550678093, "answer_id": 54790378, "question_id": 54790294, "link": "https://stackoverflow.com/questions/54790294/calling-mysql-stored-procedure-in-c-passing-variable-argument/54790378#54790378", "title": "Calling mysql stored procedure in c, passing variable argument", "body": "<p>If you're asking \"how do I build the <code>CALL MYPROC(ARG1, ARG2...)</code> string within my C program\", you can use the function <code>snprintf</code> for that, which writes formatted data to a string of known length.</p>\n\n<pre><code>char query[1000];\nsnprintf(query, 1000, \"CALL MYPROCEDURE(\\\"%s\\\", \\\"%s\\\", %f);\", code, name, cost);\n\nmysql_query(conn, query);\n</code></pre>\n\n<p>Note that bounds checking for the constraints in the MySQL table (i.e. the field <code>code</code> is of type <code>CHAR (5)</code> and <code>name</code> is of type <code>VARCHAR (30)</code>) must be taken care of as well.  A column with type <code>CHAR(N)</code> rather than <code>VARCHAR</code> will contain exactly <code>N</code> characters.</p>\n"}], "owner": {"reputation": 212, "user_id": 8024584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-Pwwdk425ODE/AAAAAAAAAAI/AAAAAAAAAC4/LtAdfXYroZE/photo.jpg?sz=128", "display_name": "sixpain", "link": "https://stackoverflow.com/users/8024584/sixpain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 54790378, "answer_count": 1, "score": -1, "last_activity_date": 1550688328, "creation_date": 1550677832, "last_edit_date": 1550688328, "question_id": 54790294, "link": "https://stackoverflow.com/questions/54790294/calling-mysql-stored-procedure-in-c-passing-variable-argument", "title": "Calling mysql stored procedure in c, passing variable argument", "body": "<p>I made a database in mysql and i created some Stored Procedure. Now i need to launch these SP using a C program.</p>\n\n<p>I've already connected my db to c successfully, using:</p>\n\n<pre><code>char u[255];\nchar p[255];\n\n\nint main (int argc, char *argv[])\n{   \n    scanf(\"%s\",u);\n    scanf(\"%s\",p);\n\n    conn = mysql_init (NULL);\n    login = mysql_real_connect(conn, \"localhost\",u,p, \"ASL\", 3306, NULL, 0);\n}\n</code></pre>\n\n<p>I'm able to calling a SP without any parameter. For example my SP <code>mostra_pazienti()</code>shows all the rows contained in the mysql table 'paziente', and i made in this way:</p>\n\n<pre><code>    query = \"call mostra_pazienti()\";\n    mysql_query (conn,query);\n    MYSQL_RES *result = mysql_store_result(conn);\n    int num_fields = mysql_num_fields(result);\n    while ((row = mysql_fetch_row(result))) \n    { \n        for(int i = 0; i &lt; num_fields; i++) \n        {   \n            printf(\" %s \", row[i] ? row[i] : \"NULL\"); \n        }\n        printf (\"\\n\");\n        }   \n    }\n</code></pre>\n\n<p>But bassically now i need to run a procedure wich takes some parameters as input.</p>\n\n<p>For example mysql procedure <code>esame_aggiungi(IN code CHAR(5),IN name VARCHAR(30),IN cost FLOAT)</code> insert a new row in the table exam. </p>\n\n<p>So,in C, how can i take the parameters code,name,cost, using <code>scanf()</code>, and how can i use them to execute my Stored procedure?</p>\n"}, {"tags": ["c", "char", "argv"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 3, "creation_date": 1550677714, "post_id": 54790215, "comment_id": 96358775, "body": "If <code>CHAR_BIT == 8</code> on your compiler, you cannot have a <code>char</code> variable with more than 8 bits. You will need to use a larger type in this case."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1550677740, "post_id": 54790215, "comment_id": 96358788, "body": "When using 8bit in YUV one byte is exactly one color. How is a YUV file stored with 10 bits?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1550677840, "post_id": 54790215, "comment_id": 96358846, "body": "<code>temp = atoi(argv[2]);</code> if that arg will represent any value greater than <code>255</code>, then <code>char</code> simply won&#39;t be enough to store it. Unless of course you&#39;re on a very exotic system where <code>char</code> is greater than 8 bits."}, {"owner": {"reputation": 5450, "user_id": 2758823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Nxaq.jpg?s=128&g=1", "display_name": "Giacomo Catenazzi", "link": "https://stackoverflow.com/users/2758823/giacomo-catenazzi"}, "edited": false, "score": 2, "creation_date": 1550677909, "post_id": 54790215, "comment_id": 96358897, "body": "<code>short</code> is a good way, but transferring to the file you will encounter the problem of endianess, which is not a problem with 8bits. So after you have done your calculations, you should split every <code>short</code> into two bytes (simple mask and shift), according to the format of your destination files [often 16bit, which only 10 really used)"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1550678598, "post_id": 54790215, "comment_id": 96359315, "body": "<a href=\"https://stackoverflow.com/q/17710018/995714\">Why shouldn&#39;t I use atoi()?</a>. And did you read how the 10-bit YUV file is stored? Normally odd-sized image formats are packed somehow, like 5 bytes for four 10-bit channels withe the 4 LSBs in the last byte, because storing 10 bits of data in a 16-bit short is a huge waste of memory"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550678993, "post_id": 54790215, "comment_id": 96359561, "body": "the posted code is missing the trailing closing brace &#39;}&#39;."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1550679274, "post_id": 54790215, "comment_id": 96359738, "body": "rather than: <code>#define TRUE        1 #define FALSE       0</code>  it is much better to include the header file: <code>stdbool.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550679412, "post_id": 54790215, "comment_id": 96359829, "body": "OT: regarding this kind of statement: <code>fwrite(&amp;cb, 1, 1, fpout);</code>  The code should always check the returned value (which should be the same as the third parameter to assure the operation was successful"}, {"owner": {"reputation": 13, "user_id": 9970734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5e207624602bb8450b2ebe518fcee3?s=128&d=identicon&r=PG&f=1", "display_name": "stonehenge", "link": "https://stackoverflow.com/users/9970734/stonehenge"}, "edited": false, "score": 0, "creation_date": 1550680593, "post_id": 54790215, "comment_id": 96360517, "body": "here is what I found on how 10 bit YUV is stored. I need to go through it a bit more. <a href=\"https://docs.microsoft.com/en-us/windows/desktop/medfound/10-bit-and-16-bit-yuv-video-formats\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/medfound/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 9970734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5e207624602bb8450b2ebe518fcee3?s=128&d=identicon&r=PG&f=1", "display_name": "stonehenge", "link": "https://stackoverflow.com/users/9970734/stonehenge"}, "edited": false, "score": 0, "creation_date": 1550681719, "post_id": 54790215, "comment_id": 96361235, "body": "The original code uses the packed format 4:2:2 UYVY and I believe it would be the same for the 10 bit file."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1550690403, "post_id": 54790215, "comment_id": 96365539, "body": "Ugh - Grab a C# library and do it there :)"}, {"owner": {"reputation": 165, "user_id": 10569552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a19bab13980743df8c0947d5969894d?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/10569552/anand"}, "edited": false, "score": 0, "creation_date": 1550726227, "post_id": 54790215, "comment_id": 96376514, "body": "Which code is giving error on incompatible pointer type is not posted. If it is fwrite(), cast short or int pointer (&amp;) first argument passed to fwrite() to char *."}], "owner": {"reputation": 13, "user_id": 9970734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5e207624602bb8450b2ebe518fcee3?s=128&d=identicon&r=PG&f=1", "display_name": "stonehenge", "link": "https://stackoverflow.com/users/9970734/stonehenge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1550680869, "creation_date": 1550677609, "question_id": 54790215, "link": "https://stackoverflow.com/questions/54790215/update-my-code-to-take-arguments-more-than-255-char-in-c", "title": "Update my code to take arguments more than 255 char in C", "body": "<p>The following code works perfectly to create 8 bit YUV files. I want to update it to be able to create 10 bit YUV files. But the char function does not allow integers more than 255. </p>\n\n<p>I've tried changing it to short or int but I get incompatible pointer type errors. I've spent hours researching alternative approaches but have not been able to figure out how to adjust this code. Any help appreciated.</p>\n\n<pre><code>/*\nMPEG 2 decoder bitstream xfer\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define TRUE        1\n#define FALSE       0\n\nint main(int argc, char **argv)\n{\n    FILE    *fpout;\n    unsigned int    i, j;\n    unsigned char   y, cb, cr, temp;\n\n    if (argc != 5) {\n        fprintf(stderr, \"usage: pat&lt;outfile&gt; &lt;Y&gt; &lt;Cb&gt; &lt;Cr&gt;\\n\");\n        exit(-1);\n    }\n\n    /*--- open binary file (for parsing) ---*/\n    fpout = fopen(argv[1], \"wb\");\n    if (fpout == 0) {\n        fprintf(stderr, \"Cannot open output file &lt;%s&gt;\\n\", argv[1]);\n        exit(-1);\n    }\n\n    for(j = 0; j &lt; 360; j++)  {\n        for(i = 0; i &lt; 960; i++)  {\n            y = 16;\n            cr = 128;\n            cb = 128;\n            fwrite(&amp;cb, 1, 1, fpout);\n            fwrite(&amp;y, 1, 1, fpout);\n            fwrite(&amp;cr, 1, 1, fpout);\n            fwrite(&amp;y, 1, 1, fpout);\n        }\n    }\n    for(j = 0; j &lt; 360; j++)  {\n        for(i = 0; i &lt; 960; i++)  {\n            if(i &lt; 320 || i &gt; 639)  {\n                y = 16;\n                cr = 128;\n                cb = 128;\n                fwrite(&amp;cb, 1, 1, fpout);\n                fwrite(&amp;y, 1, 1, fpout);\n                fwrite(&amp;cr, 1, 1, fpout);\n                fwrite(&amp;y, 1, 1, fpout);\n            }\n            else  {\n                temp = atoi(argv[2]);\n                y = temp;\n                temp = atoi(argv[3]);\n                cb = temp;\n                temp = atoi(argv[4]);\n                cr = temp;\n                fwrite(&amp;cb, 1, 1, fpout);\n                fwrite(&amp;y, 1, 1, fpout);\n                fwrite(&amp;cr, 1, 1, fpout);\n                fwrite(&amp;y, 1, 1, fpout);\n            }\n        }\n    }\n\n\n    fclose(fpout);\n    return 0;\n</code></pre>\n"}, {"tags": ["c", "memory", "stm32"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1550678013, "post_id": 54789317, "comment_id": 96358971, "body": "<code>userValues[0] + addressGap</code> this should be <code>&amp;userValues[0] + addressGap</code> or better <code>$userValues[addressGap]</code>.... The linker file is not really needed for anything. What is <code>userConfig.o</code> supposed to be? What is that <code>section</code> gcc specifier for? <code>pow(2, flashTypeProgram)</code> - this is bad, I know the compiler may optimize it, however it casts the arguments to float, which is unneded here. Also why <code>64&#47;</code> ?"}, {"owner": {"reputation": 23, "user_id": 11024908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a7b078b1e230d50077999587f5edf?s=128&d=identicon&r=PG&f=1", "display_name": "Nibble", "link": "https://stackoverflow.com/users/11024908/nibble"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1550678100, "post_id": 54789317, "comment_id": 96359027, "body": "From what I understood it is an object file. I was under the impression that I needed this in order to be able to access (sorry I am not sure if that is the correct term) the location in memory. I tried adding the &quot;&amp;&quot; in from of userValues[0] but I get an error saying &quot;incompatible pointer to integer conversion...&quot;"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1550678218, "post_id": 54789317, "comment_id": 96359092, "body": "If you use <code>HAL_FLASH_Program</code> you don&#39;t need linker for anything - you can write to any location in memory. And the linker can&#39;t stop you. <code>incompatible pointer to integer conversion...</code> - 1. Post full error message, 2. <code>HAL_FLASH_Program</code> takes <code>uin32_t</code> argument - you need to cast your pointer."}, {"owner": {"reputation": 23, "user_id": 11024908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a7b078b1e230d50077999587f5edf?s=128&d=identicon&r=PG&f=1", "display_name": "Nibble", "link": "https://stackoverflow.com/users/11024908/nibble"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1550678541, "post_id": 54789317, "comment_id": 96359279, "body": "Oops, somehow casting completely slipped my mind :). Thanks for that. On another note, since HAL_FLASH_Program doesn&#39;t need a linker, would I need to put any information into the linker file?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1550678618, "post_id": 54789317, "comment_id": 96359326, "body": "No? The only use case I would see, if you want the <code>USER_CONFIG</code> section to start at a specified location in the memory. But I don&#39;t think you care about the exact location, just only so it is there and is not used."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 11024908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a7b078b1e230d50077999587f5edf?s=128&d=identicon&r=PG&f=1", "display_name": "Nibble", "link": "https://stackoverflow.com/users/11024908/nibble"}, "is_accepted": true, "score": 1, "last_activity_date": 1551107418, "last_edit_date": 1551107418, "creation_date": 1550698360, "answer_id": 54795560, "question_id": 54789317, "link": "https://stackoverflow.com/questions/54789317/stm32f411vet6-storing-data-in-r-w-flash-memory/54795560#54795560", "title": "STM32F411VET6 storing data in R/W flash memory", "body": "<p>I was able to get the solution with some help from <a href=\"https://stackoverflow.com/users/9072753/kamil-cuk\">Kamil Cuk</a> that helped me solve some issues. One of the problems I was experiencing with the scatter file was that my load and execution addresses were not the same causing linker to not work as intended (very well explained in <a href=\"http://www.keil.com/forum/61666/stm32-viewing-flash-memory-contents/\" rel=\"nofollow noreferrer\">this link</a>). I modified my .sct file to the following:</p>\n\n<pre><code>LR_IROM1 0x08000000 0x00060000  {    ; load region size_region\n  ER_IROM1 0x08000000 0x00060000  {  ; load address = execution address\n   *.o (RESET, +First)\n   *(InRoot$$Sections)\n   .ANY (+RO)\n   .ANY (+XO)\n  }\n  RW_IRAM1 0x20000000 0x00020000  {  ; RW data\n   .ANY (+RW +ZI)\n  }\n}\n\nLR_IROM2 0x08060000 0x00020000 {  ; load region size_region\n  USER_CONFIG 0x08060000 0x00020000  {\n   *(.user_data)\n  }\n}\n</code></pre>\n\n<p>This implementation where an additional load region was created would cause my load address and exception address to be the same.</p>\n\n<p>Then, in case someone comes here looking for help as well, here is my code for the flashing:</p>\n\n<pre><code>__attribute__((section(\".user_data\"))) const char userConfig[64];\n\n[...]\n\nvoid Write_Flash(uint32_t data[], uint8_t flashTypeProgram)\n{\n  uint8_t addressGap;\n  HAL_FLASH_Unlock();\n  __HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_EOP | FLASH_FLAG_OPERR | FLASH_FLAG_WRPERR | FLASH_FLAG_PGAERR | FLASH_FLAG_PGSERR);\n  FLASH_Erase_Sector(FLASH_SECTOR_7, VOLTAGE_RANGE_3);\n  int ii = 0;\n  for (ii = 0; ii &lt; 64 / pow(2, flashTypeProgram); ii++)\n  {\n    addressGap = pow(2, flashTypeProgram) * ii;\n    HAL_FLASH_Program(flashTypeProgram, (uint32_t) &amp;userConfig[0] + addressGap, data[ii]);\n  }\n  HAL_FLASH_Lock();\n}\n</code></pre>\n\n<p>This program allowed me to store data in internal flash which would remain stored even after a hard reboot where all power was disconnected and then reconnected to the board.</p>\n"}], "owner": {"reputation": 23, "user_id": 11024908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a7b078b1e230d50077999587f5edf?s=128&d=identicon&r=PG&f=1", "display_name": "Nibble", "link": "https://stackoverflow.com/users/11024908/nibble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 54795560, "answer_count": 1, "score": 0, "last_activity_date": 1564833299, "creation_date": 1550674908, "last_edit_date": 1564833299, "question_id": 54789317, "link": "https://stackoverflow.com/questions/54789317/stm32f411vet6-storing-data-in-r-w-flash-memory", "title": "STM32F411VET6 storing data in R/W flash memory", "body": "<p>I am trying to store data in flash memory on a STM32F411VET6. I want the memory to store and stay there even after rebooting the MC. I have looked at <a href=\"https://stackoverflow.com/questions/28503808/allocating-memory-in-flash-for-user-data-stm32f4-hal\">this</a>, <a href=\"https://stackoverflow.com/questions/49220921/stm32f4-discovery-writing-reading-flash-memory?noredirect=1&amp;lq=1\">this</a>, <a href=\"https://stackoverflow.com/questions/27075807/error-l6236e-no-section-matches-selector-no-section-to-be-first-last\">this</a> and <a href=\"https://stackoverflow.com/questions/44443619/how-to-write-read-to-flash-on-stm32f4-cortex-m4\">this</a> examples but I am still not sure that I am doing this correctly. I was able to create a location in memory (I checked in the map file) with this as my scatter file:</p>\n\n<pre><code>LR_IROM1 0x08000000 0x00080000  {    ; load region size_region\n  ER_IROM1 0x08000000 0x00060000  {  ; load address = execution address\n   *.o (RESET, +First)\n   *(InRoot$$Sections)\n   .ANY (+RO)\n   .ANY (+XO)\n  }\n  USER_CONFIG 0x08060000 0x0001FFFF  {\n   userConfig.o (+RW)\n  }\n  RW_IRAM1 0x20000000 0x00020000  {  ; RW data\n   .ANY (+RW +ZI)\n  }\n}\n</code></pre>\n\n<p>and this for my code (adapted from <a href=\"https://stackoverflow.com/questions/49220921/stm32f4-discovery-writing-reading-flash-memory?noredirect=1&amp;lq=1\">this</a> example):</p>\n\n<pre><code>__attribute__((__section__(\"USER_CONFIG\"))) const char userValues[64];\n\nvoid Write_Flash(uint32_t data[], uint8_t flashTypeProgram)\n{\n  uint8_t addressGap;\n  HAL_FLASH_Unlock();\n  __HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_EOP | FLASH_FLAG_OPERR | FLASH_FLAG_WRPERR | FLASH_FLAG_PGAERR | FLASH_FLAG_PGSERR);\n  FLASH_Erase_Sector(FLASH_SECTOR_7, VOLTAGE_RANGE_3);\n  int ii = 0;\n  for (ii = 0; ii &lt; 64 / pow(2, flashTypeProgram); ii++)\n  {\n    addressGap = pow(2, flashTypeProgram) * ii;\n    HAL_FLASH_Program(flashTypeProgram, userValues[0] + addressGap, data[ii]);\n  }\n  HAL_FLASH_Lock();\n}\n</code></pre>\n\n<p>but whenever I build the code I get an error that \"No section matches pattern userConfig.o\".</p>\n\n<p>Is there anything that I am setting up incorrectly or why if I am missing a call somewhere?</p>\n"}, {"tags": ["c", "matrix-multiplication"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1550674420, "post_id": 54788758, "comment_id": 96356624, "body": "Let&#39;s say the block size is 8x8, and you want to multiply A=3x4 with B=4x9. You  can embed the input matrices in block-sized matrices and pad the rest with zeroes, as that does not affect the results for the smaller matrices. So copy A to an 8x8 matrix and B to an 8x16 matrix. Then do the block-sized multiplication. Afterwards extract the useful pieces from the 8x16 result (3x9 in my example) and print them."}, {"owner": {"reputation": 1, "user_id": 11090611, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HRSLaonKB8I/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOLII8dW1ZbqjHLzqKakpdYJHVcOQ/mo/photo.jpg?sz=128", "display_name": "A Confused Student", "link": "https://stackoverflow.com/users/11090611/a-confused-student"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1550675214, "post_id": 54788758, "comment_id": 96357108, "body": "I understand the theory behind it, I am just unsure how to make that edit to the <i>main</i> function"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1550675829, "post_id": 54788758, "comment_id": 96357541, "body": "Remember the original width and height. Round up the <code>height</code> and <code>width</code> of your matrices to multiples of the block size. Allocate arrays with the padded size. Fill in the original part and set the padding to zero. Do the multiplication. Extract the useful portion of the output."}, {"owner": {"reputation": 1, "user_id": 11090611, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HRSLaonKB8I/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOLII8dW1ZbqjHLzqKakpdYJHVcOQ/mo/photo.jpg?sz=128", "display_name": "A Confused Student", "link": "https://stackoverflow.com/users/11090611/a-confused-student"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1550676024, "post_id": 54788758, "comment_id": 96357681, "body": "Thank you for trying to help, although I don&#39;t understand what you mean about padding?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1550676731, "post_id": 54788758, "comment_id": 96358136, "body": "Taking my example above, you need to pad the matrix A=3x4 to the block size 8x8. The resulting matrix must be zero everywhere, except for the upper 3x4 part, which is a copy of A. The zeros are &#39;padding&#39; as they are just taking up space and not relevant to the calculation of AxB."}, {"owner": {"reputation": 135, "user_id": 11037415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bf02f74eedf41415ca599581624192?s=128&d=identicon&r=PG&f=1", "display_name": "aminosbh", "link": "https://stackoverflow.com/users/11037415/aminosbh"}, "edited": false, "score": 0, "creation_date": 1550688071, "post_id": 54788758, "comment_id": 96364426, "body": "I think, it could be interesting that you add the <code>cuda</code> tag (and/or mention it in the title). Your question will be visible to CUDA developers."}], "owner": {"reputation": 1, "user_id": 11090611, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HRSLaonKB8I/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOLII8dW1ZbqjHLzqKakpdYJHVcOQ/mo/photo.jpg?sz=128", "display_name": "A Confused Student", "link": "https://stackoverflow.com/users/11090611/a-confused-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1550676355, "creation_date": 1550673251, "last_edit_date": 1550676355, "question_id": 54788758, "link": "https://stackoverflow.com/questions/54788758/how-to-do-matrix-multiplication-without-restricting-the-dimensions-of-the-input", "title": "How to do matrix multiplication without restricting the dimensions of the input matrices to be multiples of the block size?", "body": "<p>I need to <strong>modify the code to remove the restriction that the dimensions of the input matrices must be multiples of the block size</strong>, but have no clue how to do this.</p>\n\n<p>The guide I am following says to make changes to the <em>main</em> method in order to do this, but as far as I am aware, the code in <em>main</em> simply populates the array and calls the kernel.</p>\n\n<p>Below is my code, it is a basic Matrix Multiplication calculator.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;cuda.h&gt;\n#define BLOCK_SIZE 16\n\n// Matrices are stored in row-major order\ntypedef struct {\nint width;\nint height;\nfloat* elements;\n} Matrix;\n\n__global__ void MatrixMultKern(const Matrix A, const Matrix B, const Matrix C) {\n    // Calculate the column index of C and B\n    int col = blockIdx.x * blockDim.x + threadIdx.x;\n    // Calculate the row index of C and of A\n    int row = blockIdx.y * blockDim.y + threadIdx.y;\n\n    if ((row &lt; A.height) &amp;&amp; (col &lt; B.width)) {\n        float Cvalue = 0;\n        // each thread computes one element of the block sub-matrix\n        for (int k = 0; k &lt; A.width; ++k) {\n            Cvalue += A.elements[row * A.width + k] * B.elements[k*B.width + col];\n        }\n        C.elements[row * C.width + col] = Cvalue;\n    }\n}\n\n// Matrix multiplication - Host Code\n// Matrix dimensions are assumed to be multiples of BLOCK_SIZE\nvoid MatrixMult(const Matrix h_A, const Matrix h_B, Matrix h_C)\n{\n    // Load A and B into device memory\n    Matrix d_A;\n    d_A.width = h_A.width; d_A.height = h_A.height;\n    size_t size = h_A.width * h_A.height * sizeof(float);\n    cudaMalloc(&amp;d_A.elements, size);\n    cudaMemcpy(d_A.elements, h_A.elements, size, cudaMemcpyHostToDevice);\n\n    Matrix d_B;\n    d_B.width = h_B.width; d_B.height = h_B.height;\n    size = h_B.width * h_B.height * sizeof(float);\n    cudaMalloc(&amp;d_B.elements, size);\n    cudaMemcpy(d_B.elements, h_B.elements, size, cudaMemcpyHostToDevice);\n\n    // Allocate C in Device memory\n    Matrix d_C;\n    d_C.width = h_C.width; d_C.height = h_C.height;\n    size = h_C.width * h_C.height * sizeof(float);\n    cudaMalloc(&amp;d_C.elements, size);\n\n    // Invoke Kernel\n    dim3 dimBlock(BLOCK_SIZE, BLOCK_SIZE);\n    dim3 dimGrid(d_B.width / dimBlock.x, d_A.height / dimBlock.y);\n    MatrixMultKern&lt;&lt;&lt; dimGrid, dimBlock &gt;&gt;&gt;(d_A, d_B, d_C);\n\n    // Read C from Device to Host\n    cudaMemcpy(h_C.elements, d_C.elements, size, cudaMemcpyDeviceToHost);\n\n    // Free Device Memory\n    cudaFree(d_A.elements);\n    cudaFree(d_B.elements);\n    cudaFree(d_C.elements);\n}\n\nint main(int argc, char* argv[]) {\n    Matrix A, B, C;\n    // Read Dimensions of A and B\n    A.height = atoi(argv[1]);\n    A.width = atoi(argv[2]);\n    B.height = A.width;\n    B.width = atoi(argv[3]);\n\n    //Allocate memory\n    A.elements = (float*)malloc(A.width * A.height * sizeof(float));\n    B.elements = (float*)malloc(B.width * B.height * sizeof(float));\n    C.height = A.height;\n    C.width = B.width;\n    C.elements = (float*)malloc(C.width * C.height * sizeof(float));\n\n    //populates arrays with random numbers\n    for(int i = 0; i &lt; A.height; i++)\n        for(int j = 0; j &lt; A.width; j++)\n            A.elements[i*A.width + j] = (float)(rand() % 3);\n    for(int i = 0; i &lt; B.height; i++)\n        for(int j = 0; j &lt; B.width; j++)\n            B.elements[i*B.width + j] = (float)(rand() % 2);\n    MatrixMult(A, B, C);\n\n    for(int i = 0; i &lt; A.height; i++){\n        for(int j = 0; j &lt; A.width; j++)\n            printf(\"%f \", A.elements[i*A.width + j]);\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n    for(int i = 0; i &lt; B.height; i++){\n        for(int j = 0; j &lt; B.width; j++)\n            printf(\"%f \", B.elements[i*B.width + j]);\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n    for(int i = 0; i &lt; C.height; i++){\n        for(int j = 0; j &lt; C.width; j++)\n            printf(\"%f \", C.elements[i*C.width + j]);\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads", "mutex"], "answers": [{"tags": [], "owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "is_accepted": false, "score": 0, "last_activity_date": 1550855302, "creation_date": 1550855302, "answer_id": 54831992, "question_id": 54788527, "link": "https://stackoverflow.com/questions/54788527/producers-consumers-threads-and-mutex/54831992#54831992", "title": "Producers Consumers Threads and Mutex", "body": "<p>A conditional variable is a way of efficiently blocking a thread until a certain condition is verified.</p>\n\n<p>You use a conditional variable in the consumer simply because you dictate you <strong>can't consume if there isn't anything to consume</strong> -- so you decide to block until there is something to consume. In your case, this happens when <code>toConsume == 0</code>.</p>\n\n<p>You may dictate that the producer must also wait -- that's entirely up to your specification. Some ideas:</p>\n\n<ul>\n<li>You may want to prevent the variable to go over a certain value (e.g. <code>1000</code>, or <code>INT_MAX</code> to avoid overflow).</li>\n<li>If instead of a counter you use a <a href=\"https://en.wikipedia.org/wiki/Circular_buffer\" rel=\"nofollow noreferrer\">circular buffer</a> to place your <em>things</em> to be consumed, the producer must wait if there are no free slots to place the <em>things</em> in the buffer. This is the most common way of teaching the producers-consumers in textbooks :)</li>\n</ul>\n"}], "owner": {"reputation": 93, "user_id": 11090556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5051c372c28ff9fa12319d4567b4b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Sue", "link": "https://stackoverflow.com/users/11090556/sue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550855302, "creation_date": 1550672432, "last_edit_date": 1550846164, "question_id": 54788527, "link": "https://stackoverflow.com/questions/54788527/producers-consumers-threads-and-mutex", "title": "Producers Consumers Threads and Mutex", "body": "<p>In relation to when producer accesses the shared source, Do I need another condition variable/condition signal? So it does get blocked when the shared resource is locked. I have a condition variable for the consumer, so it does it waits and if it won't try to access if there is nothing there to be added on (to  consume)    </p>\n\n<pre><code>int pnum;  // number updated when producer runs.\nint csum;  // sum computed using pnum when consumer runs.\n\nint (*pred)(int); // predicate indicating number to be consumed\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n\npthread_cond_t condc,condp;\n\nint toConsume = 0; // condition varibale counter\nint produceT() {\n    //Start Critical Section\n    pthread_mutex_lock(&amp;mutex);\n    scanf(\"%d\",&amp;pnum);\n    toConsume++;\n    //End Critical Section\n    pthread_cond_signal (&amp;condc);\n\n    pthread_mutex_unlock(&amp;mutex);\n    return pnum;\n}\n\nvoid *Produce(void *a) {\n  int p;\n\n  p=1;\n  while (p) {\n    printf(\"producer thinking...\\n\");\n    sleep(1);\n    printf(\"..done!\\n\");\n    p = produceT();\n    printf(\"PRODUCED %d\\n\",p);\n  }\n  printf(\"EXIT-P\\n\");\n  pthread_exit(0);\n}\n\n\nint consumeT() {\n    pthread_mutex_lock(&amp;mutex); //protect buffer\n    while(toConsume &lt;=0){ // if nothing in buffer then wait\n        pthread_cond_wait(&amp;condc,&amp;mutex);\n    }\n    pthread_mutex_unlock(&amp;mutex); //release buffer\n    //sleep()\n    pthread_mutex_lock(&amp;mutex); //protect buffer\n    if ( pred(pnum) ) { csum += pnum; }\n    toConsume--;\n    pthread_mutex_unlock(&amp;mutex);\n    return pnum;\n}\n\nvoid *Consume(void *a) {\n  int p;\n\n  p=1;\n  while (p) {\n    printf(\"consumer thinking...\\n\");\n    sleep(rand()%3);\n    printf(\"..done!\\n\");\n    p = consumeT();\n    printf(\"CONSUMED %d\\n\",csum);\n  }\n  printf(\"EXIT-C\\n\");\n  pthread_exit(0);\n}\n\n\nint main (int argc, const char * argv[]) {\n  // the current number predicate\n  static pthread_t prod,cons;\n    long rc;\n\n  pred = &amp;cond1;\n  if (argc&gt;1) {\n    if      (!strncmp(argv[1],\"2\",10)) { pred = &amp;cond2; }\n    else if (!strncmp(argv[1],\"3\",10)) { pred = &amp;cond3; }\n  }\n  pthread_mutex_init(&amp;mutex,NULL);\n  pthread_cond_init(&amp;condc,NULL);//Initialize consumer condition variable\n  pthread_cond_init(&amp;condp,NULL);//Initialize producer condition variable\n\n  pnum = 999;\n  csum=0;\n  srand(time(0));\n\n  printf(\"Creating Producer:\\n\");\n    rc = pthread_create(&amp;prod,NULL,Produce,(void *)0);\n    if (rc) {\n            printf(\"ERROR return code from pthread_create(prod): %ld\\n\",rc);\n            exit(-1);\n        }\n  printf(\"Creating Consumer:\\n\");\n    rc = pthread_create(&amp;cons,NULL,Consume,(void *)0);\n    if (rc) {\n            printf(\"ERROR return code from pthread_create(cons): %ld\\n\",rc);\n            exit(-1);\n        }\n\n    pthread_join( prod, NULL);\n    pthread_join( cons, NULL);\n\n\n  printf(\"csum=%d.\\n\",csum);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "line-breaks", "spaces", "fgetc"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550672269, "post_id": 54788423, "comment_id": 96355225, "body": "You need to consider the case where the char is something else than a letter (hint: use <code>isalpha</code>). Other hint:  you can solve your problem by adding 2 lines to your code (~30 characters in all)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550672678, "post_id": 54788423, "comment_id": 96355490, "body": "Actually there is an even simpler solution that the one I suggested in my first comment: move line and delete one other line."}, {"owner": {"reputation": 37, "user_id": 10585679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb79f5d89f4bb53bf3ad1c44c8a8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Parsons", "link": "https://stackoverflow.com/users/10585679/ollie-parsons"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550672759, "post_id": 54788423, "comment_id": 96355546, "body": "@Jabberwocky Thanks! Now does it but puts &#39;&#255;&#39; at the end from nowhere. Any idea as to why?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550672858, "post_id": 54788423, "comment_id": 96355612, "body": "The <code>&#255;</code> is because you output the EOF. Shoul&#39;d be too hard to figure out what to do."}, {"owner": {"reputation": 37, "user_id": 10585679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb79f5d89f4bb53bf3ad1c44c8a8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Parsons", "link": "https://stackoverflow.com/users/10585679/ollie-parsons"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550672983, "post_id": 54788423, "comment_id": 96355690, "body": "@Jabberwocky What do you mean exactly? And how do i stop that?"}, {"owner": {"reputation": 37, "user_id": 10585679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb79f5d89f4bb53bf3ad1c44c8a8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Parsons", "link": "https://stackoverflow.com/users/10585679/ollie-parsons"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550673064, "post_id": 54788423, "comment_id": 96355738, "body": "@Jabberwocky would it be like if its = EOF then it puts nothing?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550673065, "post_id": 54788423, "comment_id": 96355740, "body": "The <code>EOF</code> is a special value that means you&#39;ve read past the end of the file. You should not output that value."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1550673089, "post_id": 54788423, "comment_id": 96355760, "body": "make it <code>while( (singleline = fgetc( fp1 )) != EOF )  { ... }</code> instead of <code>do { ... } while( .. );</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550673185, "post_id": 54788423, "comment_id": 96355823, "body": "@OllieParsons <i>&quot;if its = EOF then it puts nothing&quot;</i>: more or less. If <code>singleline</code> is <code>EOF</code> then you shouldn&#39;t <code>fputc</code> it to the output."}, {"owner": {"reputation": 37, "user_id": 10585679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb79f5d89f4bb53bf3ad1c44c8a8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Parsons", "link": "https://stackoverflow.com/users/10585679/ollie-parsons"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550673404, "post_id": 54788423, "comment_id": 96355964, "body": "@Jabberwocky isn&#39;t that what the &quot;while (singleline != EOF)&quot; part should prevent?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550673459, "post_id": 54788423, "comment_id": 96355998, "body": "@OllieParsons yes, but the test happens too late, the fputc with EOF has already been done then"}], "answers": [{"comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550695971, "post_id": 54788796, "comment_id": 96368130, "body": "Why this inconsistency in the using of braces? :)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550696248, "post_id": 54788796, "comment_id": 96368259, "body": "@CacahueteFrito no special reason"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1550673366, "creation_date": 1550673366, "answer_id": 54788796, "question_id": 54788423, "link": "https://stackoverflow.com/questions/54788423/reading-a-file-one-character-at-a-time-with-spaces/54788796#54788796", "title": "reading a file one character at a time with spaces", "body": "<p>Overall beginner's solution:</p>\n\n<pre><code>...\ndo\n{\n    singleline = fgetc(fp1);\n    if (singleline == EOF)\n      break;        // end of file =&gt; game over quit loop immediately\n\n    // convert char if neessary\n    if (islower(singleline))\n    {\n        singleline = toupper(singleline);\n    }\n    else if (isupper(singleline))\n    {\n        singleline = tolower(singleline);\n    }\n\n    // output the char\n    fputc(singleline, fp2);\n} while (1);\n...\n</code></pre>\n\n<p>There are shorter solutions, but these are harder to read and to understand for beginners.</p>\n"}], "owner": {"reputation": 37, "user_id": 10585679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb79f5d89f4bb53bf3ad1c44c8a8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Parsons", "link": "https://stackoverflow.com/users/10585679/ollie-parsons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54788796, "answer_count": 1, "score": 0, "last_activity_date": 1550673927, "creation_date": 1550672089, "question_id": 54788423, "link": "https://stackoverflow.com/questions/54788423/reading-a-file-one-character-at-a-time-with-spaces", "title": "reading a file one character at a time with spaces", "body": "<p>I'm trying to convert the case from a file and write into another. The file I'm trying to convert has spaces and a few lines. The converted form is written with no spaces and no line breaks. Does anyone know how I can alter my code, so that it includes the spaces and line breaks from the original file?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;ctype.h&gt;\n\nint main(void)\n{\nFILE *fp1, *fp2;\nfp1 = fopen(\"exercise2.txt\", \"r\");\nfp2 = fopen(\"exercise2_converted.txt\", \"w\");\n\nint singleline;\n\nif (fp1 == NULL)\n{\n    printf(\"Error opening fp1!\\n\");\n    return 0;\n}\nif (fp2 == NULL)\n{\n    printf(\"Error opening fp2!\\n\");\n    fclose(fp1);\n    return 0;\n}\n\ndo\n{\n    singleline = fgetc(fp1);\n    if (islower(singleline))\n    {\n        singleline = toupper(singleline);\n        fputc(singleline, fp2);\n    }\n    else if (isupper(singleline))\n    {\n        singleline = tolower(singleline);\n        fputc(singleline, fp2);\n    }\n} while (singleline != EOF);\n\n\nfclose(fp1);\nfclose(fp2);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 2, "creation_date": 1550670816, "post_id": 54787867, "comment_id": 96354280, "body": "Are the operators <code>+</code>, <code>-</code>, <code>*</code>, <code>&#47;</code>? Do you have to handle operator precedence? Please update your question with more details. You should also show the code of your proposed implementations."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550671117, "post_id": 54787867, "comment_id": 96354464, "body": "Don&#39;t be &quot;sorry for your bad english&quot;, but improve the question by asking help from someone who knows english better than you and/or use translate.google.com and/or show some examples which also may help us to understand what you are asking."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 2, "creation_date": 1550671459, "post_id": 54787867, "comment_id": 96354681, "body": "<code>a+b+c</code> is not a sum with 3 operand but two sum having 2 operand each"}, {"owner": {"reputation": 23, "user_id": 11090337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dB3DOdiuYlg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOc3VTJa6iBugjyROACfhkNYXfYzg/mo/photo.jpg?sz=128", "display_name": "Ihatemyice", "link": "https://stackoverflow.com/users/11090337/ihatemyice"}, "edited": false, "score": 0, "creation_date": 1550671607, "post_id": 54787867, "comment_id": 96354780, "body": "Thanks for comments, I learn very much."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1550671642, "post_id": 54787867, "comment_id": 96354800, "body": "Regarding the comment by @Bodo: the input &quot;2+6*3&quot; should evaluate to 24 or 20?"}, {"owner": {"reputation": 23, "user_id": 11090337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dB3DOdiuYlg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOc3VTJa6iBugjyROACfhkNYXfYzg/mo/photo.jpg?sz=128", "display_name": "Ihatemyice", "link": "https://stackoverflow.com/users/11090337/ihatemyice"}, "edited": false, "score": 0, "creation_date": 1550671762, "post_id": 54787867, "comment_id": 96354878, "body": "The result of 2+6*3 is 20, &quot; * , / &quot; still have the precedence."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550671881, "post_id": 54787867, "comment_id": 96354971, "body": "@Ihatemyice OK, now it is clear what you want, but the question is too broad. Please read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and this: <a href=\"https://stackoverflow.com/tour\">tour</a>."}, {"owner": {"reputation": 23, "user_id": 11090337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dB3DOdiuYlg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOc3VTJa6iBugjyROACfhkNYXfYzg/mo/photo.jpg?sz=128", "display_name": "Ihatemyice", "link": "https://stackoverflow.com/users/11090337/ihatemyice"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550672079, "post_id": 54787867, "comment_id": 96355094, "body": "@Jabberwocky I will read the tour, thanks."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1550672198, "post_id": 54787867, "comment_id": 96355172, "body": "The question describes a quite artificial scenario. If it is a homework or other training assignment, you should describe what you have figured out so far and what specific problem you are having. If it is a real-world problem, you should explain how it arises and what the ultimate goal actually is\u2014it is unlikely the question as described is a good approach for solving some real-world problem."}, {"owner": {"reputation": 23, "user_id": 11090337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dB3DOdiuYlg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOc3VTJa6iBugjyROACfhkNYXfYzg/mo/photo.jpg?sz=128", "display_name": "Ihatemyice", "link": "https://stackoverflow.com/users/11090337/ihatemyice"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1550672461, "post_id": 54787867, "comment_id": 96355349, "body": "@Eric Postpischil It&#39;s just a simple C question."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1550672479, "post_id": 54787867, "comment_id": 96355359, "body": "Better insert your code into your question as a code block (using the {} function of the editor) instead of using an external service."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1550674357, "post_id": 54787867, "comment_id": 96356573, "body": "You might have to enable more warnings in the project&#39;s build options. Check all that enable more warnings or more strict checking. (but not &quot;Inhibit all warning messages (-w)&quot; or &quot;Stop compiling after first error (-Wfatal-errors)&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11090337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dB3DOdiuYlg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOc3VTJa6iBugjyROACfhkNYXfYzg/mo/photo.jpg?sz=128", "display_name": "Ihatemyice", "link": "https://stackoverflow.com/users/11090337/ihatemyice"}, "edited": false, "score": 0, "creation_date": 1550674141, "post_id": 54788957, "comment_id": 96356439, "body": "Thanks, I will try it."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 1, "last_activity_date": 1550674827, "last_edit_date": 1550674827, "creation_date": 1550673895, "answer_id": 54788957, "question_id": 54787867, "link": "https://stackoverflow.com/questions/54787867/how-to-calculate-the-result-of-3-operands-with-2-operators/54788957#54788957", "title": "How to calculate the result of 3 operands with 2 operators?", "body": "<p>There are a few typos in your code and you will get warnings because you did not include all necessary header files.</p>\n\n<p>You cannot define an array without size like <code>char string[]</code>.</p>\n\n<p>Depending on your compiler and C library you might get a warning about deprecated function <code>gets</code>. You should use <code>fgets</code> instead to avoid buffer overflow. Both functions return a pointer which may be <code>NULL</code>, but not <code>EOF</code>.</p>\n\n<p>You should fix all compiler warnings first.</p>\n\n<p>I will not write the full program (for now), but suggest some possible solutions.</p>\n\n<p>For a smart solution you could implement a function that does a calculation <code>A op B</code> using a <code>switch</code> with 4 cases and call it twice. The function could be defined as</p>\n\n<pre><code>int calculate(int a, char op, int b)\n</code></pre>\n\n<p>With your calculation <code>A op1 B op2 C</code> you would first have to check the precedence of the operators <code>op1</code> and <code>op2</code> to decide if you calculate <code>( A op1 B ) op2 C</code> or <code>A op1 ( B op2 C)</code>. For this you could implement a function that returns the precedence of an operator. I assume a lower value is higher precedence. The function could be defined as</p>\n\n<pre><code>int precedence(char op)\n</code></pre>\n\n<p>Then you could do something like this:</p>\n\n<pre><code>if(precedence(ops[0]) &lt; precedence(ops[1])) {\n    return calculate( calculate(nums[0], ops[0], nums[1]),\n                      ops[1], nums[2] );\n} else {\n    return calculate( nums[0], ops[0],\n                      calculate(nums[1], ops[1], nums[2]) );\n}\n</code></pre>\n\n<p>In the program from the question you might want to use <code>sum = calculate( ... )</code> instead of <code>return calculate( ... )</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 11090337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dB3DOdiuYlg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOc3VTJa6iBugjyROACfhkNYXfYzg/mo/photo.jpg?sz=128", "display_name": "Ihatemyice", "link": "https://stackoverflow.com/users/11090337/ihatemyice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 54788957, "answer_count": 1, "score": -3, "last_activity_date": 1550676854, "creation_date": 1550670443, "last_edit_date": 1550676854, "question_id": 54787867, "link": "https://stackoverflow.com/questions/54787867/how-to-calculate-the-result-of-3-operands-with-2-operators", "title": "How to calculate the result of 3 operands with 2 operators?", "body": "<p>As the title.\nI get a problem, with 3 operands, every one is random, and with 2 operators are also random.</p>\n\n<p>For example, it can be performed as : num1 [ops] num2 [ops] num3. User can input as \"3+2/8\", \"45*76+8\" or \"14-8-9\", ... ( '*' and '/' still have operator precedences).</p>\n\n<p>If I use \"if\" to deal with it, it's not smart.\nBut if I use switch, it also need 4*4 cases, it's not smart, either.\nSo, how do I do?</p>\n\n<p>Thanks for your looking, and I felt sorry with my bad English.</p>\n\n<p>here is my code:</p>\n\n<pre><code>void judge(char *);\nint main()\n{\n    char string[]={};\n    while(gets(string)!=EOF)\n    {\n        judge(string);\n    }\n    return 0;\n}\n\nvoid judge(char *string)\n{\n    int i=0;\n    int sum=0;\n\n    char string2[10];\n    strcpy(string2, string);\n\n    char ops[2]={};\n    int nums[3]={};\n    char *delim =\" +-*/\";\n    char *delim2=\" 0123456789\";\n    char * pch;\n    char * pch2;\n\n    pch = strtok(string,delim);\n    while (pch != NULL)\n    {\n        nums[i]=atoi(pch);\n        i++;\n        pch = strtok (NULL, delim);\n    }\n    i=0;\n    pch2 = strtok(string2,delim2);\n    while (pch2 != NULL)\n    {\n        ops[i]=pch2[0];\n        i++;\n        pch2 = strtok (NULL, delim2);\n    }\n    for(i=0;i&lt;3;i++)\n    {\n        if(i&gt;0)\n        {\n            printf(\" \");\n        }\n        printf(\"%d\",nums[i]);\n    }\n    printf(\" \");\n    for(i=0;i&lt;2;i++)\n    {\n        if(i&gt;0)\n        {\n            printf(\" \");\n        }\n        printf(\"%c\",ops[i]);\n    }\n\n\n    /* here is what I confused. */\n    switch(ops[0])\n    {\n        case '+':\n            if(ops[1]=='+')\n                sum=nums[0]+nums[1]+num[2];\n            if(ops[1]=='-')\n                sum=nums[0]+nums[1]-num[2];\n            if(ops[1]=='*')\n                sum=nums[0]+nums[1]*num[2];\n            if(ops[1]=='/')\n                sum=nums[0]+nums[1]/num[2];\n    }\n}\n</code></pre>\n\n<p>and the compiler window:\n<a href=\"https://i.stack.imgur.com/wpg8w.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c", "time-complexity"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1550669982, "post_id": 54787576, "comment_id": 96353743, "body": "<code>f2</code>is of course O(1)."}, {"owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 1, "creation_date": 1550671252, "post_id": 54787576, "comment_id": 96354547, "body": "<code>f1</code> is <code>O(N^5)</code>"}, {"owner": {"reputation": 21, "user_id": 11090265, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gfzo_6bbQIA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOL_decvImq_AQph7ufS2-iM1V-Nw/mo/photo.jpg?sz=128", "display_name": "RLee", "link": "https://stackoverflow.com/users/11090265/rlee"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1550671256, "post_id": 54787576, "comment_id": 96354548, "body": "@IanAbbott Why f1 is O(N^4)?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1550671352, "post_id": 54787576, "comment_id": 96354604, "body": "@RLee, sorry, I was wrong. It is indeed O(N^5) (O(N*(N^2)*(N^2)))."}], "answers": [{"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 6, "last_activity_date": 1550676411, "last_edit_date": 1550676411, "creation_date": 1550671653, "answer_id": 54788272, "question_id": 54787576, "link": "https://stackoverflow.com/questions/54787576/complexity-of-functions-in-c/54788272#54788272", "title": "complexity of functions in C", "body": "<p>Your first function has the complexity O(N^(1+2+2)) = O(N^5).</p>\n\n<p>In the first loop i goes from 0 on N, the second one j loops over a limit that depends on N^2 and in the 3rd one k loops on an interval whose size depends on N^2 as well.</p>\n\n<p>The function F2 is constant time, so O(1) because the loops do not have any degree of liberty.</p>\n\n<p>This kind of stuff is studied in the courses of algorithms at the topic \"complexity\".</p>\n\n<p>There is also another kind of measurement of complexity of algorithms, based on <a href=\"https://www.khanacademy.org/computing/computer-science/algorithms/asymptotic-notation/a/big-big-omega-notation\" rel=\"nofollow noreferrer\">omega-notation</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1550672289, "post_id": 54788391, "comment_id": 96355237, "body": "It would be interesting to see which compiler can reduce this theoretical complexity to O(1)."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1550672631, "post_id": 54788391, "comment_id": 96355460, "body": "@chqrlie In the case of a <code>Sum++</code> I hope all production grade compiler, but anyhow any reasonable developer would hopefully just <code>return (N*N + N ) &#47; 2 * (N*N*N*N + N*N) &#47; 2) * 2</code> (off by one errors not included)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1550752773, "post_id": 54788391, "comment_id": 96390930, "body": "<code>gcc</code> does not seem to reduce the complexity, even at <code>-O4</code> and <code>clang</code> generates SSE/AVX code that is difficult to follow."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1550752957, "post_id": 54788391, "comment_id": 96391045, "body": "@chqrlie I guess it&#39;s unrealistic that it can optimise it, since it would need a complete symbolic computer algebra system able to solve series and also recognise such loop builds as sums."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1550753302, "post_id": 54788391, "comment_id": 96391276, "body": "compilers do detect some trivial loops and generate better alternatives. This is done on a case by case basis."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1550758705, "post_id": 54788391, "comment_id": 96394851, "body": "@chqrlie Still got the problem of detection that those loops together with that += expression constitutes a series, and conclude it&#39;s solvable and solve it."}], "tags": [], "owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "is_accepted": false, "score": 4, "last_activity_date": 1550674257, "last_edit_date": 1550674257, "creation_date": 1550672009, "answer_id": 54788391, "question_id": 54787576, "link": "https://stackoverflow.com/questions/54787576/complexity-of-functions-in-c/54788391#54788391", "title": "complexity of functions in C", "body": "<p>The complexity of <code>f1</code> is in O(n^5) since</p>\n\n<pre><code>for(i=0; i&lt;N; i++) //i has a upper bound of n \n    for(j=0; j&lt;i*i; j++) //j has a upper bound of i^2, which itself has the upper bound of n, so this is n^2\n        for(k=0; k&lt;j; k++) //k has a upper bound of j, which is n^2  \n            Sum++; //constant\n</code></pre>\n\n<p>So the complete upper bound is n * n^2 * n^2 which is n^5 so <code>f1</code> is in O(n^5).</p>\n\n<pre><code>for (i = 0; i &lt; 10; i++) //upper bound of 10 so in O(10) which is in O(1)\n    for (j = 0; j &lt; i; j++) //upper bound of i so also O(1)\n        Sum += j * N; //N is just a integer here, and multiplication is a constant operation independent of the size of N, so also O(1)\n</code></pre>\n\n<p>So <code>f2</code> is in O(1*1*1) which is simply O(1).\nNote all assignments and declarations are also constant.</p>\n\n<p>BTW since <code>Sum++</code> has no side effects and with the according loops develops a series we know a solution for (math yay), a programmer or optimal compiler optimiser could reduce <code>f1</code> to a constant program using the gaussian sum formula <code>(n*n+n) / 2</code>, so sum could be just calculated by something like <code>(N*N + N ) / 2 * (N*N*N*N + N*N) / 2) * 2</code> , however my formula does not consider starting at 0.</p>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 7775552, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O0rpQjmhviE/AAAAAAAAAAI/AAAAAAAACnM/caneqnPkovQ/photo.jpg?sz=128", "display_name": "Titan3", "link": "https://stackoverflow.com/users/7775552/titan3"}, "is_accepted": false, "score": 1, "last_activity_date": 1550677830, "last_edit_date": 1550677830, "creation_date": 1550676952, "answer_id": 54789966, "question_id": 54787576, "link": "https://stackoverflow.com/questions/54787576/complexity-of-functions-in-c/54789966#54789966", "title": "complexity of functions in C", "body": "<p>Using <a href=\"https://en.wikipedia.org/wiki/Summation\" rel=\"nofollow noreferrer\">sigma notation</a>:</p>\n\n<h1>f1:</h1>\n\n<blockquote>\n  <blockquote>\n    <p>The outer loop runs from 0 to N, the one inside it runs from 0 to i^2 and the last one runs from 0 to j, and inside we only have one operation so we are summing 1. Thus we get:</p>\n  </blockquote>\n  \n  <p><img src=\"https://i.stack.imgur.com/Lu3qQ.gif\" alt=\"1\"></p>\n  \n  <blockquote>\n    <p>1+1+1... j times gives 1*j=j, thus we get:</p>\n  </blockquote>\n  \n  <p><img src=\"https://i.stack.imgur.com/V3puL.gif\" alt=\"3\"></p>\n  \n  <blockquote>\n    <p>Using the rule of <a href=\"https://en.wikipedia.org/wiki/1_%2B_2_%2B_3_%2B_4_%2B_%E2%8B%AF\" rel=\"nofollow noreferrer\">the summation of natural numbers</a> but we replace n (in the Wikipedia article) with i^2 so we get:</p>\n  </blockquote>\n  \n  <p><img src=\"https://i.stack.imgur.com/mZI3b.gif\" alt=\"4\"></p>\n  \n  <blockquote>\n    <blockquote>\n      <p>The reason for the approximation is because when finding the time complexity of a function and we have the addition of multiple powers we take the highest one. This just makes the math simpler. For example <code>f(n)=(n^3+n^2+n)=O(n^3)</code> (supposing that f(n) represents the maximal running time required by the given algorithm depending on the input size n) .</p>\n    </blockquote>\n    \n    <p>And using the formula for the summation of the first N numbers to 4th power we get (look at the note in the end):</p>\n  </blockquote>\n  \n  <p><img src=\"https://i.stack.imgur.com/7bvTQ.gif\" alt=\"6\"></p>\n</blockquote>\n\n<p>Thus the time complexity for f1 is <code>O(n^5)</code>.</p>\n\n<h1>f2:</h1>\n\n<blockquote>\n  <blockquote>\n    <p>Using the same method we get:</p>\n  </blockquote>\n  \n  <p><img src=\"https://i.stack.imgur.com/6OJ5i.gif\" alt=\"2\"></p>\n  \n  <p><img src=\"https://i.stack.imgur.com/NvhYp.gif\" alt=\"8\"></p>\n</blockquote>\n\n<p>But this just gives a constant which doesn't depend on n thus the time complexity for f2 is <code>O(1)</code>.</p>\n\n<h2>note:</h2>\n\n<p>When we have a summation of the first N numbers that are to the K power, the time complexity of it would be N^(K+1), so you obviously don't need to remember the formula. For example:</p>\n\n<blockquote>\n  <p><img src=\"https://i.stack.imgur.com/MC7Te.gif\" alt=\"9\"></p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 11090265, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gfzo_6bbQIA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOL_decvImq_AQph7ufS2-iM1V-Nw/mo/photo.jpg?sz=128", "display_name": "RLee", "link": "https://stackoverflow.com/users/11090265/rlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1550677830, "creation_date": 1550669635, "last_edit_date": 1550671790, "question_id": 54787576, "link": "https://stackoverflow.com/questions/54787576/complexity-of-functions-in-c", "title": "complexity of functions in C", "body": "<pre><code>int f1(int N) {\n    int Sum, i, j, k;\n    Sum = 0;\n    for (i = 0; i &lt; N; i++)\n        for (j = 0; j &lt; i * i; j++)\n            for (k = 0; k &lt; j; k++)    \n                Sum++;\n    return Sum;\n}\n\nint f2(int N) {\n    int Sum, i, j;\n    Sum = 0;\n    for (i = 0; i &lt; 10; i++)\n        for (j = 0; j &lt; i; j++)\n            Sum += j * N;\n    return Sum;\n}\n</code></pre>\n\n<p>What are the complexities of <code>f1</code> and <code>f2</code>?</p>\n\n<p>I have no idea about the complexity of <code>f1</code> and I think the complexity of <code>f2</code> should be <strong>O(1)</strong> since the number of iterations is constant. It is correct? </p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1550669231, "post_id": 54787392, "comment_id": 96353238, "body": "When copying data in C, use <a href=\"https://en.cppreference.com/w/c/string/byte/memcpy\" rel=\"nofollow noreferrer\"><code>memcpy</code></a>. As long as you know the sizes of the three arrays, and that neither destination size will cause you to go out of bounds of the source array, then there&#39;s really no problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1550669279, "post_id": 54787392, "comment_id": 96353268, "body": "As to get a pointer to a specific element of the source array, simply use the address-of operator <code>&amp;</code>. As in <code>&amp;bigArray[10]</code> which will give you a pointer to the eleventh element."}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "edited": false, "score": 1, "creation_date": 1550669545, "post_id": 54787392, "comment_id": 96353447, "body": "When you place values from bigarray[i] into arr20[i] or arr10[i], this means they are put into the array at the same position that they were found in the big array. So if they are in the big array at position 3, they will be put into the smaller array at position 3 with 0&#39;s for 0 - 2. You might want to use a counter to track  the &quot;i&quot; position for the smaller arrays if you don&#39;t want them to skip positions."}], "answers": [{"comments": [{"owner": {"reputation": 1300, "user_id": 1692367, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/n4ejl.jpg?s=128&g=1", "display_name": "Yannis Dran", "link": "https://stackoverflow.com/users/1692367/yannis-dran"}, "edited": false, "score": 1, "creation_date": 1550684777, "post_id": 54788046, "comment_id": 96362817, "body": "selected as the right answer because of the effort you ve done and because memcpy is the way to go. However, I used Patrick&#39;s solution for my program as I wanted to avoid the memcpy for now."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 3, "last_activity_date": 1550676922, "last_edit_date": 1550676922, "creation_date": 1550670912, "answer_id": 54788046, "question_id": 54787392, "link": "https://stackoverflow.com/questions/54787392/how-copy-an-arrays-contents-into-two-smaller-arrays-of-unequal-size/54788046#54788046", "title": "How copy an array&#39;s contents into two smaller arrays of unequal size", "body": "<p>As mentioned in comments, when splitting the contents of an array, recognize each element is located in a specific addressable place in memory, making this a perfect job for <em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_memcpy.htm\" rel=\"nofollow noreferrer\">memcpy()</a></em>.  Here is a simple illustration using that concept:</p>\n\n<pre><code>int main(void)\n{\n    double source[] = {3.4,5.6,2.3,4.5,6.7,8.9,10.1,11.1,12.3,4.5};\n    double split1[3];\n    double split2[7];\n\n    memcpy(split1, &amp;source[0], 3*sizeof(double));\n    memcpy(split2, &amp;source[3], 7*sizeof(double));\n\n    return 0;   \n}\n</code></pre>\n\n<p>If your project has well defined and static parameters that are known at runtime, then using a few common macros, and some additional variables, this could be made a little more general.    </p>\n\n<p>The following example does essentially the same as the illustration above, but in a loop, potentially a more adaptable construct.</p>\n\n<pre><code>#define SPLIT_CNT 3\n\nint main(void)\n{\n    double source[] = {3.4,5.6,2.3,4.5,6.7,8.9,10.1,11.1,12.3,4.5,8.5,9.5};\n    double split1[3];                         // arrays if differing sizes\n    double split2[7];\n    double split3[2];\n    size_t start_pos;                         //position accumulator\n    size_t cpy_len[SPLIT_CNT] = {3,7,2};      //known array sections\n    double *split[] = {split1,split2,split3}; //enables looping on arrays of differing sizes\n    start_pos = 0;\n    for(int i=0;i&lt;SPLIT_CNT;i++)\n    {\n        if(i &gt; 0)start_pos += cpy_len[i-1]; //move the start postition  \n        memcpy(split[i], &amp;source[start_pos], sizeof(double)*cpy_len[i]);\n    }\n\n    return 0;   \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 0, "last_activity_date": 1550671259, "creation_date": 1550671259, "answer_id": 54788152, "question_id": 54787392, "link": "https://stackoverflow.com/questions/54787392/how-copy-an-arrays-contents-into-two-smaller-arrays-of-unequal-size/54788152#54788152", "title": "How copy an array&#39;s contents into two smaller arrays of unequal size", "body": "<p>Use separate counters for the index in <code>array10</code> and <code>array20</code>.</p>\n\n<pre><code>#define size 20\n\ndouble bigArray[size]={14.553,13.653,9.555,8.564..and so on...9.324,11.123};\n\n/*IndicatorArray is associated to bigArray as follows:\n if bigArray[i]&lt;10 then indicatorArray[i]=10 else =20 */\nint indicatorArray[size]={20,20,10,10,..and so on..};\n\ndouble array10[count10], array20[count20]; /*count10 and count20 are \ncounters from indicatorArray passed as a size of each array \nin earlier function not shown here*/\n\nsize_t i10; /* index for array10 *** */\nsize_t i20; /* index for array20 *** */\n\nfor (i=0, i10=0, i20=0; i&lt;size; i++){\n        if (indicatorArray[i]==10) {\n            if(i10 &lt; count10) { /* prevent array index out of range *** */\n                arr10[i10++]=bigArray[i];\n            }\n        }\n        else {\n            if(i20 &lt; count20) { /* prevent array index out of range *** */\n                arr20[i20++]=bigArray[i];\n            }\n        }\n    }\n    for (i=0;i&lt;count10;i++){\n        printf(\"%lf \",arr10[i]);\n    }\n    printf(\"\\n \\n\");\n    for (i=0;i&lt;count20;i++){\n        printf(\"%lf \",arr20[i]);\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1300, "user_id": 1692367, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/n4ejl.jpg?s=128&g=1", "display_name": "Yannis Dran", "link": "https://stackoverflow.com/users/1692367/yannis-dran"}, "edited": false, "score": 0, "creation_date": 1550736778, "post_id": 54788199, "comment_id": 96381011, "body": "It also works like this: arr10[arr10Count++]=bigArray[i];  Thank you Patrick for your answer."}], "tags": [], "owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1550671411, "creation_date": 1550671411, "answer_id": 54788199, "question_id": 54787392, "link": "https://stackoverflow.com/questions/54787392/how-copy-an-arrays-contents-into-two-smaller-arrays-of-unequal-size/54788199#54788199", "title": "How copy an array&#39;s contents into two smaller arrays of unequal size", "body": "<p>As someprogrammerdude commented, you should look into using memcpy when copying data. If you still want to use your implementation instead, the problem lies with how you use <code>i</code> in the for loop. Remember that in this instance, <code>i</code> will be the position in the big array that the number you want to copy appears. If you want the first element you copy from the big array to be in position 0 of one of the smaller arrays, there's no way that will happen for both if you use <code>arr10[i]</code> and <code>arr20[i]</code>. Instead you can use a counter for each smaller array and increment each time an element goes into it. Here's a quick example I did with an online compiler after hard coding some values:</p>\n\n<pre><code>int arr10Count = 0;\nint arr20Count = 0;\n\nint i;\nfor (i=0;i&lt;size;i++){\n        if (indicatorArray[i]==10) {\n            arr10[arr10Count]=bigArray[i];\n            arr10Count++;\n        //  printf(\"%lf \",arr10[i]); /*this shows me correct results*/\n        }\n        else {\n            arr20[arr20Count]=bigArray[i];\n            arr20Count++;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 1300, "user_id": 1692367, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/n4ejl.jpg?s=128&g=1", "display_name": "Yannis Dran", "link": "https://stackoverflow.com/users/1692367/yannis-dran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54788046, "answer_count": 3, "score": 1, "last_activity_date": 1550676922, "creation_date": 1550669006, "question_id": 54787392, "link": "https://stackoverflow.com/questions/54787392/how-copy-an-arrays-contents-into-two-smaller-arrays-of-unequal-size", "title": "How copy an array&#39;s contents into two smaller arrays of unequal size", "body": "<p>I am trying to copy contents of a larger array to two smaller arrays of an unequal size each (of which size may change according to the program). I have four arrays at the simplified code below:</p>\n\n<pre><code>#define size 20\ndouble bigArray[size]={14.553,13.653,9.555,8.564..and so on...9.324,11.123};\n/*IndicatorArray is associated to bigArray as follows:\n if bigArray[i]&lt;10 then indicatorArray[i]=10 else =20 */\nint indicatorArray[size]={20,20,10,10,..and so on..};\ndouble array10[count10], array20[count20]; /*count10 and count20 are \ncounters from indicatorArray passed as a size of each array \nin earlier function not shown here*/\nfor (i=0;i&lt;size;i++){\n        if (indicatorArray[i]==10) {\n            arr10[i]=bigArray[i];\n        //  printf(\"%lf \",arr10[i]); /*this shows me correct results*/\n        }\n        else {\n            arr20[i]=bigArray[i];\n        }\n    }\n    for (i=0;i&lt;count10;i++){\n        printf(\"%lf \",arr10[i]);\n    }\n    printf(\"\\n \\n\");\n    for (i=0;i&lt;count20;i++){\n        printf(\"%lf \",arr20[i]);\n    }\n</code></pre>\n\n<p>The result is something like</p>\n\n<p>00.0000 00.0000 9.555 8.564 11.123 14.666 ....</p>\n\n<p>14.553 13.653 00.000......00.000</p>\n\n<p>but I don't want zeros to appear or have such disrupted results but something like</p>\n\n<p>9.55 8.564 ...... 7.123\nand\n14.533 13.653 .....11.123</p>\n\n<p>Why does this happen and how to do it in the right way?</p>\n"}, {"tags": ["c", "task", "system"], "comments": [{"owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1550668276, "post_id": 54787132, "comment_id": 96352652, "body": "You can use <code>time</code> or <code>clock</code> using <code>#include &lt;time.h&gt;</code>, but generally you want to just write a shell script"}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "reply_to_user": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 1, "creation_date": 1550668847, "post_id": 54787132, "comment_id": 96353006, "body": "To complete @YoYoYonnY, you could use <code>SIGALRM</code> with <code>alarm</code> (see <a href=\"https://stackoverflow.com/questions/1784136/simple-signals-c-programming-and-alarm-function\">this post</a>)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1550670492, "post_id": 54787132, "comment_id": 96354074, "body": "<a href=\"https://stackoverflow.com/q/54618065/905902\">stackoverflow.com/q/54618065/905902</a> SIGALRM+setitimer()+pause() [in Unix, that is]"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1550694698, "post_id": 54787132, "comment_id": 96367548, "body": "I would use a threading library such as pthreads and use timers with condition variables to wake up each thread (task) periodically."}], "owner": {"reputation": 33, "user_id": 10811777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3420161eefd3961d2cc4bb3b9e2bf5b8?s=128&d=identicon&r=PG&f=1", "display_name": "Micky ", "link": "https://stackoverflow.com/users/10811777/micky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550668170, "creation_date": 1550668170, "question_id": 54787132, "link": "https://stackoverflow.com/questions/54787132/plan-and-execute-a-system-of-periodic-tasks-in-c", "title": "plan and execute a system of periodic tasks in C", "body": "<p>How do you program and run a system of periodic tasks in C? What can we do, what can not we do?</p>\n\n<p>I DON'T want the code. Just if someone can give me a first vision.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["c", "windows", "visual-studio", "debugging", "kernel"], "comments": [{"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1550685963, "post_id": 54787115, "comment_id": 96363375, "body": "use <a href=\"https://stackoverflow.com/a/54256372/1466046\">this new tool</a> it supports the API sets"}, {"owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1550756196, "post_id": 54787115, "comment_id": 96393201, "body": "Thank you so much - this is a really useful tool. I see which <b>.sys</b> files are missed, but I can&#39;t realize the next thing. I see these missing files in <b>C:\\Windows\\System32\\drivers</b>, but Windows tries to search these in <b>C:\\Windows\\System32</b>. Maybe do you know why is this happening? Copying files from <b>..\\drivers</b> to <b>System32</b> folder is an awful idea. This need not be so."}, {"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1550774192, "post_id": 54787115, "comment_id": 96404502, "body": "this is expected . install the driver each time with devcon.exe which places the sys in system32/drivers."}, {"owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1550850498, "post_id": 54787115, "comment_id": 96436134, "body": "Why can&#39;t I use <b>OSR Loader</b>? As I understand, I need to force <b>OSR Loader</b> search <b>.sys</b> files in <b>C:\\Windows\\System32\\drivers</b>."}, {"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1550850823, "post_id": 54787115, "comment_id": 96436310, "body": "I haven&#39;t used this tool before. <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debug-universal-drivers--kernel-mode-#install\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows-hardware/drivers/debugger/&hellip;</a>"}, {"owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1550858567, "post_id": 54787115, "comment_id": 96440351, "body": "Thanks for your help.  I handled with installing via PnPUtil. <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/pnputil-examples\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows-hardware/drivers/devtest/&hellip;</a>"}, {"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1550934251, "post_id": 54787115, "comment_id": 96459083, "body": "ok and now everything works and you can debug the driver?"}, {"owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1551023215, "post_id": 54787115, "comment_id": 96478741, "body": "If be honest - no. I can&#39;t see any trace in WinDbg. But your comments helped me to resolve the problem with installing. If you know what is the reason for the empty log traces I will be glad to know. I restart PC with disabling Driver signature, run WinDbg for local kernel debugging, wait to connect and after that install driver. Debugging console doesn&#39;t change. Traces in the driver via macro <i>TraceEvents(...)</i>."}, {"owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1551025823, "post_id": 54787115, "comment_id": 96479507, "body": "So, it seems the driver wasn&#39;t installed. I ran in WinDbg: <b>!wdfkd.wdfldr</b> and didn&#39;t see my driver on the list. However, via <b>pnputil /enum-drivers</b> I see it."}, {"owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1551026560, "post_id": 54787115, "comment_id": 96479734, "body": "I&#39;ve updated the question."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "edited": false, "score": 0, "creation_date": 1552036959, "post_id": 55039546, "comment_id": 96868517, "body": "Ooopppss. For generating tmf files should be used the following command: <b>tracepdb.exe -f TestKernelDriver2\\TestKernelDriver2.pdb -p TestKernelDriver2\\tmfs</b>"}], "tags": [], "owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1551948572, "creation_date": 1551948572, "answer_id": 55039546, "question_id": 54787115, "link": "https://stackoverflow.com/questions/54787115/how-to-debug-a-windows-kernel-driver-properly/55039546#55039546", "title": "How to debug a Windows kernel driver properly?", "body": "<p>I found the solution via <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/example-9--creating-a-tmf-file\" rel=\"nofollow noreferrer\">tracefmt</a> generator and <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/creating-a-trace-session-with-a-control-guid\" rel=\"nofollow noreferrer\">TraceView</a> application.</p>\n\n<p><strong>Step 0</strong>: Generate tmf file by command:</p>\n\n<pre><code>tracefmt \u0421:\\TestDriver\\TestKernelDriver2\\TestKernelDriver2.etl -i \u0421:\\TestDriver\\TestKernelDriver2\\TestKernelDriver2.sys -r \u0421:\\TestDriver\\TestKernelDriver2\\TestKernelDriver2 -p \u0421:\\TestDriver\\TestKernelDriver2\\tmfs -o \u0421:\\TestDriver\\TestKernelDriver2\\TestKernelDriver2.txt -v\n</code></pre>\n\n<p><strong>Step 1</strong>: Create Session in TraceView:\n<strong>File</strong> -> <strong>Create New Session</strong>. Fill <strong>Manually Entered Control GUID</strong>. (<em>0f4fbb98-1569-495b-88d1-f654b1e2d68e</em>)</p>\n\n<p><strong>Step 2</strong>: <strong>Choose Source of WPP Format Information</strong> (<strong>Set TMF Search Path</strong> option) and fill path: <em>C:\\DriverTest\\TestKernelDriver2\\tmfs</em></p>\n\n<p><strong>Step 3</strong>: <em>Next</em>, fill <strong>Log Session Name</strong> and <strong>Real-Time Display</strong> is checked. <em>Finish</em>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2sgt6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2sgt6.png\" alt=\"TraceView settings\"></a></p>\n"}], "owner": {"reputation": 181, "user_id": 4359175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjrXkbJYKeo/AAAAAAAAAAI/AAAAAAAAACk/l8H5ex4ZOI8/photo.jpg?sz=128", "display_name": "slinkin", "link": "https://stackoverflow.com/users/4359175/slinkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2500, "favorite_count": 0, "accepted_answer_id": 55039546, "answer_count": 1, "score": 7, "last_activity_date": 1551948572, "creation_date": 1550668123, "last_edit_date": 1551026516, "question_id": 54787115, "link": "https://stackoverflow.com/questions/54787115/how-to-debug-a-windows-kernel-driver-properly", "title": "How to debug a Windows kernel driver properly?", "body": "<p>I'm trying to set up the environment of <em>Windows</em> VM for debugging a kernel driver.</p>\n\n<p>I created a sample of kernel driver in Visual Studio 2017. <strong>File->New Project->Kernel Mode Driver</strong> (<em>basic project</em>; just for testing - autogenerated trace macro, required procedures, etc.) and want to test it on the <em>target machine</em>.</p>\n\n<p>There are my steps (<em>target machine</em>):</p>\n\n<ol>\n<li>Install Windows 10 to a virtual machine (VirtualBox);</li>\n<li><a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/install/the-testsigning-boot-configuration-option\" rel=\"nofollow noreferrer\">Turn on Test mode</a> and set <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--dbgsettings\" rel=\"nofollow noreferrer\">BCDEdit as local</a>;</li>\n<li>Install <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk\" rel=\"nofollow noreferrer\">WDK</a>;</li>\n<li>Download <a href=\"https://www.osronline.com/article.cfm?article=157\" rel=\"nofollow noreferrer\">OSR Loader</a>;</li>\n<li>Copy files after a building to a VM (C:\\DriverTest\\TestKernelDriver2\\; <strong>.cer</strong>, <strong>.inf</strong>, <strong>.pdb</strong>, <strong>.sys</strong>);</li>\n<li>Create <strong>traces</strong> folder; C:\\DriverTest\\TestKernelDriver2\\traces\\</li>\n<li>Install the cerificate - <strong>TestKernelDriver2.sys</strong>; (<em>Sign mode</em>: <strong>Test Sign</strong>)</li>\n<li>Run <strong>OSR Driver Loader</strong>, choose the driver, press <strong>Register service</strong> (<em>Success</em>).</li>\n<li><p>Run <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/tracelog\" rel=\"nofollow noreferrer\">tracelog</a> with params (GUID was generated by templates; no via <strong>Tools->Create GUID</strong>) - <em>success</em>:</p>\n\n<p><code>tracelog -start TestKernelDriver2 -guid #0f4fbb98-1569-495b-88d1-f654b1e2d68e -f C:\\DriverTest\\TestKernelDriver2\\traces\\trace.etl -flag 2 -level 0xFFFF</code></p></li>\n<li><p>Check C:\\DriverTest\\TestKernelDriver2\\traces\\trace.etl; (exist - <strong>64KB</strong> size)</p></li>\n<li>OSR Driver Loader: press <strong>Start Service</strong> (<em>fail</em>). Error message: <strong>The specified procedure could not be found.</strong></li>\n<li><p>Stop <strong>tracelog</strong> - <em>success</em>:</p>\n\n<p><code>tracelog -stop TestKernelDriver2</code></p></li>\n<li><p>Open <a href=\"https://www.howtogeek.com/123646/htg-explains-what-the-windows-event-viewer-is-and-how-you-can-use-it/\" rel=\"nofollow noreferrer\">Event Viewer</a>. <strong>Windows logs->System</strong>. The last error:</p>\n\n<p><code>The TestKernelDriver2 service failed to start due to the following error: \nThe specified procedure could not be found.</code></p>\n\n<p><code>Details:\n     EventData \n     param1 TestKernelDriver2 \n     param2 %%127 \n   54006500730074004B00650072006E0065006C0044007200690076006500720032000000</code></p></li>\n<li>Open C:\\DriverTest\\TestKernelDriver2\\traces\\trace.etl via <strong>Event Viewer</strong> and don't see any logs.</li>\n</ol>\n\n<p>How can I find out what is procedure was missed?</p>\n\n<p>I tried to investigate it via <a href=\"http://www.dependencywalker.com/\" rel=\"nofollow noreferrer\">Dependency Walker</a> and revealed that some <strong>.sys</strong> files are missed (<strong>WppRecorder.sys</strong>, <strong>WdfLdr.sys</strong>, <strong>msrpc.sys</strong>, <strong>EXT-MS-WIN-</strong>###<strong>.DLL</strong>). These filed are located in C:\\Windows\\System32\\drivers. I copied the files to C:\\Windows\\System32 and <strong>Dependency Walker</strong> calmed down. What about EXT-MS-WIN-*.DLL - I read in <a href=\"https://stackoverflow.com/a/40077240/4359175\">this topic</a> that these files can be missed.</p>\n\n<p>Thanks to @magicandre1981. I installed my driver via <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/pnputil-examples\" rel=\"nofollow noreferrer\">PnPUtil</a>. But now, I see it in the list of <strong>pnputil /enum-drivers</strong> command.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xJwsc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xJwsc.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I run the following commands in <strong>WinDbg</strong>, I don't see my driver in the list:</p>\n\n<pre><code>!load wdfkd.dll\n!wdfkd.wdfldr\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vqaT9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vqaT9.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm trying to make steps of Session 1 from <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/wdf/debugging-kernel-mode-driver-framework-drivers\" rel=\"nofollow noreferrer\">this Microsoft ttutoriall</a>.</p>\n"}, {"tags": ["c", "linux", "timer"], "comments": [{"owner": {"reputation": 339, "user_id": 8464011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6545cc3092941ea0cd4b86b689550d28?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Mips", "link": "https://stackoverflow.com/users/8464011/mr-mips"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1550668597, "post_id": 54787020, "comment_id": 96352848, "body": "@xing AHH. I did not know about the other options. But since <code>clock_gettime()</code> gets us the time since the Epoch, how will this factor into getting the difference between the two times? Will a simple switch of <code>CLOCK_REALTIME</code> to <code>CLOCK_PROCESS_CPU_TIME</code> suffice? I am not sure what gets stored in my <code>current</code> and <code>previous</code> variables now"}, {"owner": {"reputation": 339, "user_id": 8464011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6545cc3092941ea0cd4b86b689550d28?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Mips", "link": "https://stackoverflow.com/users/8464011/mr-mips"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1550669573, "post_id": 54787020, "comment_id": 96353470, "body": "@xing hmm. I&#39;ll do some testing in my program to see what is stored in my <code>current</code> and <code>start</code> with the new option."}], "answers": [{"tags": [], "owner": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "is_accepted": true, "score": 1, "last_activity_date": 1550671029, "creation_date": 1550671029, "answer_id": 54788083, "question_id": 54787020, "link": "https://stackoverflow.com/questions/54787020/tracking-a-tasks-execution-time-in-c-ignoring-time-task-is-suspended/54788083#54788083", "title": "Tracking a task&#39;s execution time in C (ignoring time task is suspended)", "body": "<p>Change <code>CLOCK_REALTIME</code> to <code>CLOCK_PROCESS_CPU_TIME</code>.<br>\nusing <code>sleep()</code> takes several seconds to accumulate a small amount of CPU time. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;time.h&gt;\n#define BILLION 1E9\nint main ( void) {\n    double executionTime = 0.0001;\n\n    double  elapsedTime = -1;\n    double  elapsedTimertc = -1;\n\n    struct timespec startrtc;\n    struct timespec start;\n    struct timespec currentrtc;\n    struct timespec current;\n\n    clock_gettime(CLOCK_REALTIME, &amp;startrtc);\n    clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &amp;start);\n\n    for (;;)\n    {\n        sleep ( 1);\n        clock_gettime(CLOCK_REALTIME, &amp;currentrtc);\n        clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &amp;current);\n\n        elapsedTime = (current.tv_sec - start.tv_sec) + ((current.tv_nsec - start.tv_nsec) / BILLION);\n        elapsedTimertc = (currentrtc.tv_sec - startrtc.tv_sec) + ((currentrtc.tv_nsec - startrtc.tv_nsec) / BILLION);\n\n        if (elapsedTime &gt;= executionTime)\n        {\n            break;\n        }\n    }\n    printf ( \"elapsed time %f\\n\", elapsedTime);\n    printf ( \"elapsed time %f\\n\", elapsedTimertc);\n}\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 8464011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6545cc3092941ea0cd4b86b689550d28?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Mips", "link": "https://stackoverflow.com/users/8464011/mr-mips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 54788083, "answer_count": 1, "score": 1, "last_activity_date": 1550671029, "creation_date": 1550667763, "last_edit_date": 1550668147, "question_id": 54787020, "link": "https://stackoverflow.com/questions/54787020/tracking-a-tasks-execution-time-in-c-ignoring-time-task-is-suspended", "title": "Tracking a task&#39;s execution time in C (ignoring time task is suspended)", "body": "<p>I have to track how long a task executes for. I am working on Linux, but I do not have access to the kernel itself. </p>\n\n<p>My task simply busy-loops until the process has been executing for a certain amount of time. Then the process is supposed to break out of this loop. </p>\n\n<p>I had a somewhat working version that used <code>clock_gettime()</code> from <code>time.h</code>. I stored the time since Epoch right before I busy looped in a \"start\" variable. Then in each iteration of the loop, I checked the time since Epoch again in another variable called \"current\". </p>\n\n<p>Oh each iteration of the loop, I took the difference between \"current\" and \"start\". If that difference was greater than or equal to my requested execution time, I broke out of the loop. </p>\n\n<p>The trouble is <code>clock_gettime()</code> does not factor in suspension of a task. So if my task suspends, the way I am doing this now will treat the time a task is suspended as if it were still executing. </p>\n\n<p>Does anyone have an alternative to <code>clock_gettime()</code> that will allow a timer to somehow ignore the suspension time? Code of my current method below. </p>\n\n<pre><code>//DOES NOT HANDLE TASK SUSPENSION \n#include &lt;time.h&gt; \n#define BILLION 1E9\n\n//Set execution time to 2 seconds\ndouble executionTime = 2; \n\n//Variable used later to compute difference in time\ndouble  elapsedTime = -1;\n\nstruct timespec start;\nstruct timespec current;\n\n//Get time before we busy-loop\nclock_gettime(CLOCK_REALTIME, &amp;start);\n\nint i; \nfor (i = 0; i &lt; 10000000000; i++)\n{\n    //Get time on each busy-loop iteration\n    clock_gettime(CLOCK_REALTIME, &amp;current);\n\n        elapsedTime = (current.tv_sec - start.tv_sec) + ((current.tv_nsec - start.tv_nsec) / BILLION);\n\n        //If we have been executing for the specified execution time, break. \n        if (elapsedTime &gt;= executionTime)\n        {\n            break;\n        }\n    } \n</code></pre>\n"}, {"tags": ["c", "function", "struct"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1550658991, "post_id": 54784220, "comment_id": 96346965, "body": "Do some reading about <a href=\"https://en.cppreference.com/w/c/language/compound_literal\" rel=\"nofollow noreferrer\"><i>compound literals</i></a>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1550659256, "post_id": 54784220, "comment_id": 96347125, "body": "Is this what you ask for? <code>testFunction((struct test){1,2});</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1550663074, "post_id": 54784220, "comment_id": 96349489, "body": "Aside: <a href=\"https://ideone.com/j4dD6J\" rel=\"nofollow noreferrer\">un-learn <code>void main()</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1550663270, "post_id": 54784333, "comment_id": 96349585, "body": "See Lundin&#39;s answer for improvement - you almost certainly want to pass a pointer to <code>const</code>."}], "tags": [], "owner": {"reputation": 39, "user_id": 8077830, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4b9886d5da7c25e9a1cf8fd49c27610?s=128&d=identicon&r=PG&f=1", "display_name": "F.Gradl", "link": "https://stackoverflow.com/users/8077830/f-gradl"}, "is_accepted": false, "score": 0, "last_activity_date": 1550660087, "last_edit_date": 1550660087, "creation_date": 1550659215, "answer_id": 54784333, "question_id": 54784220, "link": "https://stackoverflow.com/questions/54784220/c-it-is-possible-to-pass-variables-to-a-function-that-request-a-struct-so-when/54784333#54784333", "title": "C: It is possible to pass variables to a function that request a struct so when the function is called these variables are wrapped into a struct?", "body": "<p>Try:</p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n\nstruct test{\n     int a;\n     int b;\n};\n\nvoid testFunction(struct test *mytest)\n{\n    printf(\"a.........:%d\",(*mytest).a);\n}\n\nint main()\n{\n    //function call with some sort of wrapping system...\n    testFunction(&amp;(struct test){1,2});\n}\n</code></pre>\n\n<p>Works for me.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1550662926, "creation_date": 1550662926, "answer_id": 54785548, "question_id": 54784220, "link": "https://stackoverflow.com/questions/54784220/c-it-is-possible-to-pass-variables-to-a-function-that-request-a-struct-so-when/54785548#54785548", "title": "C: It is possible to pass variables to a function that request a struct so when the function is called these variables are wrapped into a struct?", "body": "<p>As a rule of thumb you should avoid passing structs by value. Furthermore, the kind of feature you are looking for is probably only suitable for functions that do not modify the parameters passed, meaning it should use const correctness:</p>\n\n<pre><code>void testFunction(const struct test* mytest);\n</code></pre>\n\n<p>This could be called with a temporary struct known as <em>compound literal</em> in standard C. (Similar to the term anonymous objects in other languages.)</p>\n\n<pre><code>testFunction(&amp;(struct test){1,2});\n</code></pre>\n\n<p>where <code>(struct test){1,2}</code> is the compound literal and we take its address to pass on to the function.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1550664111, "last_edit_date": 1550664111, "creation_date": 1550663786, "answer_id": 54785838, "question_id": 54784220, "link": "https://stackoverflow.com/questions/54784220/c-it-is-possible-to-pass-variables-to-a-function-that-request-a-struct-so-when/54785838#54785838", "title": "C: It is possible to pass variables to a function that request a struct so when the function is called these variables are wrapped into a struct?", "body": "<p>The function <code>testFunction</code> as you declare it, <code>void testFunction(struct mytest test)</code>, can be called with:</p>\n\n<pre><code>testFunction((struct mytest) {1,2});\n</code></pre>\n\n<p>This uses a <em>compound literal</em>, which has the form:</p>\n\n<pre><code>(type) { initializers... }\n</code></pre>\n\n<p>Used in this way, it creates a temporary object and passes its value to the function.</p>\n\n<p>For a function that takes a pointer to a structure, such as <code>void testFunction(struct test *mytest)</code>, you can pass the address of a compound literal with:</p>\n\n<pre><code>testFunction(&amp; (struct mytest) {1,2});\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>testFunction((struct mytest []) {1,2});\n</code></pre>\n\n<p>The lifetime of a compound literal inside a function ends when execution of its associated block (the innermost <code>{...}</code> that enclose it) ends. It has automatic storage duration.</p>\n\n<p>A compound literal outside of any function has static storage duration; it exists for the lifetime of the program.</p>\n"}], "owner": {"reputation": 15, "user_id": 9106876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72a148be8bd4437a6e95475df3d0df17?s=128&d=identicon&r=PG&f=1", "display_name": "Juanea7", "link": "https://stackoverflow.com/users/9106876/juanea7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 54785838, "answer_count": 3, "score": 0, "last_activity_date": 1550745683, "creation_date": 1550658846, "last_edit_date": 1550666258, "question_id": 54784220, "link": "https://stackoverflow.com/questions/54784220/c-it-is-possible-to-pass-variables-to-a-function-that-request-a-struct-so-when", "title": "C: It is possible to pass variables to a function that request a struct so when the function is called these variables are wrapped into a struct?", "body": "<p>I have a function that request a struct.</p>\n\n<pre><code>struct test{\n    const int a;\n    const int b;\n};\n\nvoid testFunction(struct test mytest)\n{\n    //code\n}\n</code></pre>\n\n<p>I was wondering if there is a way of passing two ints to the function so the process of calling it wraps those two ints into a struct.</p>\n\n<p>Something like:</p>\n\n<pre><code>int main()\n{\n    //function call with some sort of wrapping system...\n    testFunction({1,2});\n}\n</code></pre>\n\n<p>Is there a way to the <em>{1,2}</em> wrapping part? </p>\n\n<p>(If there is... Could be also done with functions that request pointer to structs?)</p>\n\n<p>Thanks in advance,</p>\n\n<p>Juan</p>\n"}, {"tags": ["c", "types"], "comments": [{"owner": {"reputation": 126, "user_id": 10973714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fFjJ.jpg?s=128&g=1", "display_name": "heeat", "link": "https://stackoverflow.com/users/10973714/heeat"}, "reply_to_user": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1550656940, "post_id": 54782743, "comment_id": 96345552, "body": "@Biffen my bad wrong research i suppose i will remove the comment"}], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 10518032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91471cd13b1f82257c4311a9e213753?s=128&d=identicon&r=PG&f=1", "display_name": "nm_tp", "link": "https://stackoverflow.com/users/10518032/nm-tp"}, "edited": false, "score": 2, "creation_date": 1550654887, "post_id": 54782877, "comment_id": 96344296, "body": "The modulo reasoning is not quite correct. You don&#39;t use module 255 but module 256."}, {"owner": {"reputation": 186, "user_id": 7862303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-rH3Oi5xG3XA/AAAAAAAAAAI/AAAAAAAALOo/mn3nPWKl15c/photo.jpg?sz=128", "display_name": "Darkpingouin", "link": "https://stackoverflow.com/users/7862303/darkpingouin"}, "reply_to_user": {"reputation": 413, "user_id": 10518032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91471cd13b1f82257c4311a9e213753?s=128&d=identicon&r=PG&f=1", "display_name": "nm_tp", "link": "https://stackoverflow.com/users/10518032/nm-tp"}, "edited": false, "score": 0, "creation_date": 1550654919, "post_id": 54782877, "comment_id": 96344313, "body": "Oh yeah because there are 256 values possible (0 to 255). You&#39;re right"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1550655266, "post_id": 54782877, "comment_id": 96344556, "body": "If the <code>char</code> is <code>signed</code> then it is undefined behaviour."}], "tags": [], "owner": {"reputation": 186, "user_id": 7862303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-rH3Oi5xG3XA/AAAAAAAAAAI/AAAAAAAALOo/mn3nPWKl15c/photo.jpg?sz=128", "display_name": "Darkpingouin", "link": "https://stackoverflow.com/users/7862303/darkpingouin"}, "is_accepted": false, "score": 4, "last_activity_date": 1550654941, "last_edit_date": 1550654941, "creation_date": 1550654815, "answer_id": 54782877, "question_id": 54782743, "link": "https://stackoverflow.com/questions/54782743/printing-the-char-variable-value-using-d/54782877#54782877", "title": "printing the char variable value using %d", "body": "<p>The maximum value of a char is <code>255</code>.</p>\n\n<p>By adding <code>10</code> to that number you get <code>265</code>.</p>\n\n<p>Because that value is not a suitable value for a char it will do <code>265 % 256</code> resulting <code>9</code></p>\n\n<p>That's why your result is <code>9</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9952900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hx7Y7hrGefI/AAAAAAAAAAI/AAAAAAAAYmE/MTApqEcXxCo/photo.jpg?sz=128", "display_name": "Naman Tyagi", "link": "https://stackoverflow.com/users/9952900/naman-tyagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "closed_date": 1550655039, "answer_count": 1, "score": -6, "last_activity_date": 1550656237, "creation_date": 1550654399, "last_edit_date": 1550656237, "question_id": 54782743, "link": "https://stackoverflow.com/questions/54782743/printing-the-char-variable-value-using-d", "closed_reason": "Duplicate", "title": "printing the char variable value using %d", "body": "<p>I was trying to get into c programming, but in a question a get stuck, please explain this.</p>\n\n<pre><code> int main()\n{\n char c = 255;\n c=c+10;\n printf(\"%d\",c);\n return 0;\n }\n</code></pre>\n\n<p>the output it gave is </p>\n\n<pre><code>&gt; 9\n</code></pre>\n\n<p><strong>kindly explain this to me.</strong></p>\n"}, {"tags": ["c", "r", "ffi"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1550657979, "post_id": 54782622, "comment_id": 96346250, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13904786/r-pointer-to-c-function\">R: pointer to c function</a>"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1550658017, "post_id": 54782622, "comment_id": 96346271, "body": "<a href=\"https://stackoverflow.com/questions/13904786/r-pointer-to-c-function\" title=\"r pointer to c function\">stackoverflow.com/questions/13904786/r-pointer-to-c-function</a>"}, {"owner": {"reputation": 253, "user_id": 379998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24980ac827724250cfbc462cc163af6?s=128&d=identicon&r=PG", "display_name": "Jonatan Kallus", "link": "https://stackoverflow.com/users/379998/jonatan-kallus"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1550659883, "post_id": 54782622, "comment_id": 96347523, "body": "Thanks @alinsoar! See my edit regarding your suggested duplicate. It seems to my like <code>as.raw</code> could be a step towards the solution, but I still can&#39;t make it work."}], "owner": {"reputation": 253, "user_id": 379998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24980ac827724250cfbc462cc163af6?s=128&d=identicon&r=PG", "display_name": "Jonatan Kallus", "link": "https://stackoverflow.com/users/379998/jonatan-kallus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1550827282, "creation_date": 1550654034, "last_edit_date": 1550827282, "question_id": 54782622, "link": "https://stackoverflow.com/questions/54782622/pass-a-null-pointer-to-c-from-r-using-c", "title": "Pass a null pointer to C from R using .C", "body": "<p>EDIT: No, that thread does not answer my question. See my other edit below.</p>\n\n<p>I am trying to call a function implemented in a C library from R. The signature of the C function is</p>\n\n<pre><code>METIS_API(int) METIS_PartGraphKway(idx_t *nvtxs, idx_t *ncon, idx_t *xadj, \n                  idx_t *adjncy, idx_t *vwgt, idx_t *vsize, idx_t *adjwgt, \n                  idx_t *nparts, real_t *tpwgts, real_t *ubvec, idx_t *options, \n                  idx_t *edgecut, idx_t *part);\n</code></pre>\n\n<p>This function allows several of the arguments to be NULL, meaning that the computation will use default values. How can I pass the null pointer as a value from R? My R code looks like this</p>\n\n<pre><code>libpath &lt;- '/usr/lib/x86_64-linux-gnu/libmetis.so'\ndyn.load(libpath)\n\nMETIS_PartGraphKway &lt;- function(xadj, adjncy, nparts) {\n  nvtxs &lt;- length(xadj) - 1\n  ncon &lt;- 1\n  .C('METIS_PartGraphKway', as.integer(nvtxs), as.integer(ncon),\n    as.integer(xadj), as.integer(adjncy), NULL, NULL, NULL,\n    as.integer(nparts), NULL, NULL, NULL, objval=integer(1),\n    part=integer(nvtxs))\n}\n\nxadj &lt;- 0:4\nadjncy &lt;- c(1, 0, 3, 2)\nMETIS_PartGraphKway(xadj, adjncy, 2)\n</code></pre>\n\n<p>but it gives the error</p>\n\n<pre><code>Error in METIS_PartGraphKway(xadj, adjncy, 2) :\n  invalid mode (NULL) to pass to C or Fortran (arg 5)\n</code></pre>\n\n<p>I can not find any mention of this in the manual <a href=\"https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Interface-functions-_002eC-and-_002eFortran\" rel=\"nofollow noreferrer\">Writing R extensions</a>. If possible I want to avoid writing a C wrapper to the function and can thus not use the alternative <code>.Call</code> foreign function interface.</p>\n\n<p>EDIT: <a href=\"https://stackoverflow.com/a/13904932/379998\">This answer</a> suggests to use <code>as.raw(rep(0, 4))</code> to create a NULL pointer, but it does not seem to work for me. I no longer get an error, but the behavior of the computation becomes erratic (random and not equal to when called with the same arguments from C) so it does not seem to be a solution. I tried with <code>as.raw(rep(0, 8))</code> too, but still no success.</p>\n"}, {"tags": ["c", "autosar"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1550653643, "post_id": 54782319, "comment_id": 96343561, "body": "Decompose them into 32-bit ints and construct the higher-precision operations out of 32-bit operations.  The rest is up to you."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1550653870, "post_id": 54782319, "comment_id": 96343688, "body": "Please clarify your question, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. What you are mentioning will happen in C due to rules of integer promotion. If your specific coding style rules prevent 64-bit numbers, you will have to do this manually. Which is usually a worse option than letting the compiler do it for you, using functions which has been thoroughly tested."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550656876, "post_id": 54782319, "comment_id": 96345503, "body": "To begin with: why do you need 64 bit arithmetic in the first place?"}, {"owner": {"reputation": 37, "user_id": 10784424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3V0LjIu0zxU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iH3YFQhER8POfU8CYR2G29z6KpLw/mo/photo.jpg?sz=128", "display_name": "Tejas", "link": "https://stackoverflow.com/users/10784424/tejas"}, "edited": false, "score": 0, "creation_date": 1550657984, "post_id": 54782319, "comment_id": 96346254, "body": "As it is given in autosar math library, one of the function is Efx_Add_s64s32_s64 , so what I do is                                                                                                        sint64 result;  result = (sint64)x +(sint64)y. but as per autosar specification they said we should not use c operator during implementation. so what is other way to implement ."}], "owner": {"reputation": 37, "user_id": 10784424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3V0LjIu0zxU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iH3YFQhER8POfU8CYR2G29z6KpLw/mo/photo.jpg?sz=128", "display_name": "Tejas", "link": "https://stackoverflow.com/users/10784424/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550655875, "creation_date": 1550652999, "last_edit_date": 1550655875, "question_id": 54782319, "link": "https://stackoverflow.com/questions/54782319/addition-of-sint64-and-uint32-data-type-result-in-sint64", "title": "addition of sint64 and uint32 data type result in sint64", "body": "<p>when i goint to implement addition of sitn64 and uint32 the result should be return as in sint64 type in AUTOSAR_SWS_EFXLibrary. \nbut some condition are given e.g</p>\n\n<pre><code>[SWS_Efx_00415] \n**C operators shall not be used for 64bit data (cast, arithmetic operators and comparison operators)** \n[SWS_Efx_00416] \u2308\n**64bit constants shall not be used.** \n[SWS_Efx_00417]\n**Direct affectation to and from a 64 bit type shall only be used through predefined functions of 64 bits library.**\n[SWS_Efx_00418] \u2308\n**Only the sint64 type is allowed (uint64 shall not be used)**. \u230b ( )\n[SWS_Efx_00419] \u2308\n**64bit functions do not perform saturation, even for the conversion to smaller types.** \n</code></pre>\n\n<p>So How can we implement function without using c operators.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "kernel"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 10788236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96afe2f4d08f36cf1491dbce2588fdb9?s=128&d=identicon&r=PG&f=1", "display_name": "tejosa", "link": "https://stackoverflow.com/users/10788236/tejosa"}, "edited": false, "score": 0, "creation_date": 1550653817, "post_id": 54782337, "comment_id": 96343658, "body": "Thank you for your explanation and help!"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1550653451, "last_edit_date": 1550653451, "creation_date": 1550653093, "answer_id": 54782337, "question_id": 54782308, "link": "https://stackoverflow.com/questions/54782308/how-to-get-the-model-name-from-proc-cpuinfo-in-linux/54782337#54782337", "title": "How to get the model name from /proc/cpuinfo in linux?", "body": "<p><code>fopen(\"/proc/cpuinfo | grep 'model name' \", \"r\");</code> will return a NULL pointer because the file <code>/proc/cpuinfo | grep 'model name'</code> certainly doesn't not exist</p>\n\n<p><em>fopen</em> allows to open a file, not to execute commands</p>\n\n<p>Use <em>popen</em> :</p>\n\n<pre><code>FILE * fp = popen(\"grep 'model name'  /proc/cpuinfo\", \"r\");\n\nif (fp != NULL) {\n  ...read in \n  pclose(fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 10788236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96afe2f4d08f36cf1491dbce2588fdb9?s=128&d=identicon&r=PG&f=1", "display_name": "tejosa", "link": "https://stackoverflow.com/users/10788236/tejosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 54782337, "answer_count": 1, "score": 0, "last_activity_date": 1550653451, "creation_date": 1550652950, "question_id": 54782308, "link": "https://stackoverflow.com/questions/54782308/how-to-get-the-model-name-from-proc-cpuinfo-in-linux", "title": "How to get the model name from /proc/cpuinfo in linux?", "body": "<p>I am working in C and trying to get specific information from <code>/proc</code> files.\nI know in linux when I do the following I get the model name.</p>\n\n<pre><code>cd /proc\ncat cpuinfo | grep 'model name'\n</code></pre>\n\n<p>but if I'm trying to do this in C it results in a <code>core dumped</code></p>\n\n<pre><code>thisfile = fopen(\"/proc/cpuinfo | grep 'model name' \", \"r\");\n</code></pre>\n\n<p>How can I get the model name when opening a file?</p>\n"}, {"tags": ["c", "windows", "debugging", "bison", "flex-lexer"], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 9848231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9JnIMMx61Y/AAAAAAAAAAI/AAAAAAAAAaE/a0UKGe7LqF4/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/9848231/joey"}, "edited": false, "score": 0, "creation_date": 1550694971, "post_id": 54789541, "comment_id": 96367662, "body": "Thanks, I will try debugging the code in Dev C for the linked list as I haven&#39;t really worked with C too much as I mainly worked with Java. So debugging it is fairly new to me. I just wanted to know if there was an obvious error. Additionally to your 2nd point I had to add them as the code would not compile as I was getting an error that the newly specified values in the header were not declared/initialized. To the third point I tried to put in the only possible working output, with, noun dog home, and verb run. And then i entered dog run home and I got the output of syntax error syntax error."}, {"owner": {"reputation": 60, "user_id": 9848231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9JnIMMx61Y/AAAAAAAAAAI/AAAAAAAAAaE/a0UKGe7LqF4/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/9848231/joey"}, "edited": false, "score": 0, "creation_date": 1550695571, "post_id": 54789541, "comment_id": 96367946, "body": "I just went further and checked in Dev-C if the add word and lookup word functions are working and they are. Leaving me further confused as my hypothesis was incorrect."}, {"owner": {"reputation": 60, "user_id": 9848231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9JnIMMx61Y/AAAAAAAAAAI/AAAAAAAAAaE/a0UKGe7LqF4/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/9848231/joey"}, "edited": false, "score": 0, "creation_date": 1550696970, "post_id": 54789541, "comment_id": 96368577, "body": "I just realized the fallacy in me reading the Lex and Yacc book when there is a readily available Flex and Bison. I was trying to make it work, but that was very foolish I didn&#39;t realize there was a book by O&#39;Reily on those languages as well. Will start again from there and go from there examples which will most likely eliminate any errors I had."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 60, "user_id": 9848231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9JnIMMx61Y/AAAAAAAAAAI/AAAAAAAAAaE/a0UKGe7LqF4/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/9848231/joey"}, "edited": false, "score": 0, "creation_date": 1550702363, "post_id": 54789541, "comment_id": 96370643, "body": "@joey: I took another quick look at your code, and realised that your hand-written header cannot possibly work. Ditch it. Figure out what you are doing wrong in the build procedure, and build your code correctly."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 1, "last_activity_date": 1550776390, "last_edit_date": 1550776390, "creation_date": 1550675571, "answer_id": 54789541, "question_id": 54782193, "link": "https://stackoverflow.com/questions/54782193/flex-and-bison-windows-error-using-symbol-table/54789541#54789541", "title": "Flex and Bison, Windows Error using symbol table", "body": "<ol>\n<li><p>If you feel that there is a problem with your linked list implementation, you'd be a lot better off testing and debugging it with a simple driver program rather than trying to do that with some tools (flex and bison) which you are still learning. On the whole, the simpler a test is and the fewest dependencies which it has, the easier it is to track down problems. See <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">this useful essay by Eric Clippert</a> for some suggestions on debugging.</p></li>\n<li><p>I don't understand why you felt the need to introduce \"short versions\" of the token IDs. The example code in Levine's book does not anywhere use these symbols. You cannot just invent symbols and you don't need these abbreviations for anything.</p>\n\n<p>The comment that you \"had to create 2 versions [of the header file] for some values\" but that the \"code was having an issue with them, and I wasn't understanding why\" is far too unspecific for an answer. Perhaps the problem was that you thought you could use identifiers which are not defined anywhere, which would certainly cause a compiler error. But if there is some other issue, you could ask a question with an accurate problem description (that is, exactly what problem you encountered) and a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> (as indicated in the StackOverflow help pages).</p>\n\n<p>In any case, manually setting the values of the token IDs is <em>almost certainly</em> preventing you from being able to recognized inputs. Bison/yacc reserves the values 256 and 257 for internal tokens, so the first one which will be generated (and therefore used in the parser) has value 258. That means that the token values you are returning from your lexical scanner have a different meaning inside bison. Bottom line: <em>Never</em> manually set token values. If your header isn't being generated correctly, figure out why.</p></li>\n<li><p>As far as I can see, the only legal input for your program has the form:</p>\n\n<pre><code>sentence: subject VERB object\n</code></pre>\n\n<p>Since none of your sample inputs (\"run\", for example) have this form, a syntax error is not surprising. However, the fact that you receive a very early syntax error on the input \"cat\" does suggest there might be a problem with your symbol table lookup. (That's probably the result of the problem noted above.)</p></li>\n</ol>\n"}], "owner": {"reputation": 60, "user_id": 9848231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9JnIMMx61Y/AAAAAAAAAAI/AAAAAAAAAaE/a0UKGe7LqF4/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/9848231/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 54789541, "answer_count": 1, "score": 0, "last_activity_date": 1550776390, "creation_date": 1550652555, "last_edit_date": 1550662643, "question_id": 54782193, "link": "https://stackoverflow.com/questions/54782193/flex-and-bison-windows-error-using-symbol-table", "title": "Flex and Bison, Windows Error using symbol table", "body": "<p>Program is intended to store values in a symbol table and then have them be able to be printed out stating the part of speech. Further to be parsed and state more in the parser, whether it is a sentence and more.</p>\n\n<p>I create the executable file by </p>\n\n<pre><code>flex try1.l\nbison -dy try1.y\ngcc lex.yy.c y.tab.c -o try1.exe\n</code></pre>\n\n<p>in cmd (WINDOWS)</p>\n\n<p>My issue occurs when I try to declare any value when running the executable,\nverb run\nit goes like this\nBOLD IS INPUT</p>\n\n<p><strong>verb run<br>\nrun<br>\nrun</strong><br>\nsyntax error<br>\n<strong>noun cat<br>\ncat</strong><br>\nsyntax error<br>\n<strong>run<br>\nrun</strong><br>\nsyntax error<br>\n<strong>cat run</strong><br>\nsyntax error<br></p>\n\n<p>MY THOUGHTS: I'm unsure why I'm getting this error back from the code Syntax error. Although after debugging and trying to print out what value was being stored, I figured there has to be some kind of issue with the linked list. As it seemed only one value was being stored in the linked list and causing an error of sorts. As I tried to print out the stored word_type integer value for run and it would print out the correct value 259, but would refuse to let me define any other words to my symbol table. I reversed the changes of the print statements and now it works as previously stated. I think again there is an issue with the addword method as it isn't properly being added so the lookup method is crashing the program.</p>\n\n<p>Lexer file, this example is taken from O'Reily 2nd edition on Lex And Yacc,\nExample 1-5,1-6.\nAm trying to learn Lex and Yacc on my own and reproduce this example.</p>\n\n<pre><code>%{\n/*\n* We now build a lexical analyzer to be used by a higher-level parser.\n*/\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"ytab.h\" /* token codes from the parser */\n#define LOOKUP 0 /* default - not a defined word type. */\nint state;\n%}\n/* \n*  Example from page 9 Word recognizer with a symbol table. PART 2 of Lexer\n*/\n%%\n\\n { state = LOOKUP; } /* end of line, return to default state */\n    \\.\\n { state = LOOKUP;\n    return 0; /* end of sentence */\n    }\n        /* whenever a line starts with a reserved part of speech name */\n        /* start defining words of that type */\n        ^verb { state = VERB; }\n        ^adj { state = ADJ; }\n        ^adv { state = ADV; }\n        ^noun { state = NOUN; }\n        ^prep { state = PREP; }\n        ^pron { state = PRON; }\n        ^conj { state = CONJ; }\n        [a-zA-Z]+ {\n            if(state != LOOKUP) {\n            add_word(state, yytext);\n            } else {\n                switch(lookup_word(yytext)) {\n                case VERB:\n                return(VERB);\n                case ADJECTIVE:\n                return(ADJECTIVE);\n                case ADVERB:\n                return(ADVERB);\n                case NOUN:\n                return(NOUN);\n                case PREPOSITION:\n                return(PREPOSITION);\n                case PRONOUN:\n                return(PRONOUN);\n                case CONJUNCTION:\n                return(CONJUNCTION);\n                default:\n                printf(\"%s: don't recognize\\n\", yytext);\n                /* don't return, just ignore it */\n                    }\n                    }\n               }\n        . ;\n%%\nint yywrap()\n{\nreturn 1;\n}\n/* define a linked list of words and types */\nstruct word {\n        char *word_name;\n        int word_type;\n        struct word *next;\n};\nstruct word *word_list; /* first element in word list */\nextern void *malloc() ;\nint\nadd_word(int type, char *word)\n    {\n    struct word *wp;\n        if(lookup_word(word) != LOOKUP) {\n        printf(\"!!! warning: word %s already defined \\n\", word);\n        return 0;\n        }\n    /* word not there, allocate a new entry and link it on the list */\n    wp = (struct word *) malloc(sizeof(struct word));\n    wp-&gt;next = word_list;\n    /* have to copy the word itself as well */\n    wp-&gt;word_name = (char *) malloc(strlen(word)+1);\n    strcpy(wp-&gt;word_name, word);\n    wp-&gt;word_type = type;\n    word_list = wp;\n    return 1; /* it worked */\n    }\n    int\n    lookup_word(char *word)\n    {\n    struct word *wp = word_list;\n    /* search down the list looking for the word */\n    for(; wp; wp = wp-&gt;next) {\n        if(strcmp(wp-&gt;word_name, word) == 0)\n        return wp-&gt;word_type;\n    }\nreturn LOOKUP; /* not found */\n}\n</code></pre>\n\n<p>Yacc file,</p>\n\n<pre><code>%{\n/*\n* A lexer for the basic grammar to use for recognizing English sentences.\n*/\n#include &lt;stdio.h&gt;\n%}\n%token NOUN PRONOUN VERB ADVERB ADJECTIVE PREPOSITION CONJUNCTION\n%%\nsentence: subject VERB object{ printf(\"Sentence is valid.\\n\"); }\n;\nsubject: NOUN\n| PRONOUN\n;\nobject: NOUN\n;\n%%\nextern FILE *yyin;\nmain()\n{\ndo\n{\nyyparse();\n}\nwhile (!feof(yyin));\n}\nyyerror(s)\nchar *s;\n{\nfprintf(stderr, \"%s\\n\", s);\n}\n</code></pre>\n\n<p>Header file, had to create 2 versions for some values not sure why but code was having an issue with them, and I wasn't understanding why so I just created a token with the full name and the shortened as the book had only one for each.</p>\n\n<pre><code># define NOUN 257\n# define PRON 258\n# define VERB 259\n# define ADVERB 260\n# define ADJECTIVE 261\n# define PREPOSITION 262\n# define CONJUNCTION 263\n# define ADV 260\n# define ADJ 261\n# define PREP 262\n# define CONJ 263\n# define PRONOUN 258\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1550652112, "post_id": 54782027, "comment_id": 96342718, "body": "Why do you need it for static allocation? If you need an init function anyway, why not dynamically allocate the memory in that function as well?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1550652272, "post_id": 54782027, "comment_id": 96342799, "body": "Sounds like you can&#39;t: to determine the size you need to know all its membes; to hide its members means you can&#39;t determine the size."}, {"owner": {"reputation": 765, "user_id": 10143388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95f5ed267f8601015469bc5617750a?s=128&d=identicon&r=PG&f=1", "display_name": "A.R.C.", "link": "https://stackoverflow.com/users/10143388/a-r-c"}, "edited": false, "score": 0, "creation_date": 1550652510, "post_id": 54782027, "comment_id": 96342936, "body": "This looks like an information hiding pattern. Look at this code example, maybe it can help you: <a href=\"https://github.com/adamtornhill/PatternsInC/tree/master/1_FirstClassADT\" rel=\"nofollow noreferrer\">github.com/adamtornhill/PatternsInC/tree/master/1_FirstClass&zwnj;&#8203;ADT</a>"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550652514, "post_id": 54782027, "comment_id": 96342940, "body": "You can define a (const) size_t variable in module.c which is initialized with <code>sizeof(Private)</code> (which is known there) and expose it for public use through a declaration in module.h. [Actually, the variable would probably be a static variable in a function which returns its value; this avoids static intialization order issues.] As an aside, I also wonder whether you could forward-declare Private and have a better type check e.g. with the parameter for <code>Init()</code>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1550652715, "post_id": 54782027, "comment_id": 96343038, "body": "You shouldn&#39;t be overlooking alignment requirements since you are at the business of exposing size only."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550653705, "post_id": 54782027, "comment_id": 96343595, "body": "@PeterA.Schneider There are no static initialization order issues in C. Also, moving static variables into functions doesn&#39;t affect initialization order."}, {"owner": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1550653992, "post_id": 54782027, "comment_id": 96343764, "body": "@Gerhardh I&#39;m running on embedded system with tens of kilobytes of memory"}, {"owner": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "reply_to_user": {"reputation": 765, "user_id": 10143388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95f5ed267f8601015469bc5617750a?s=128&d=identicon&r=PG&f=1", "display_name": "A.R.C.", "link": "https://stackoverflow.com/users/10143388/a-r-c"}, "edited": false, "score": 0, "creation_date": 1550654391, "post_id": 54782027, "comment_id": 96343985, "body": "@A.R.C Unfortunately, in example the object allocates itself dynamically, I can only use static allocation which is why my module must rely on the application to allocate one or more private objects."}, {"owner": {"reputation": 765, "user_id": 10143388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95f5ed267f8601015469bc5617750a?s=128&d=identicon&r=PG&f=1", "display_name": "A.R.C.", "link": "https://stackoverflow.com/users/10143388/a-r-c"}, "edited": false, "score": 0, "creation_date": 1550657741, "post_id": 54782027, "comment_id": 96346084, "body": "You can replace the dynamic allocation in the example with a static object in the .c file. The information what types of information is stored inside the struct is still hiddent to the outside."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1550660276, "post_id": 54782027, "comment_id": 96347764, "body": "@melpomene Are you saying that there is a strict ordering of the initialization of static variables in different translation units in C? So the <a href=\"https://isocpp.org/wiki/faq/ctors#static-init-order\" rel=\"nofollow noreferrer\">problem existing in C++</a> does not exist in C?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550663498, "post_id": 54782027, "comment_id": 96349709, "body": "@PeterA.Schneider I&#39;m saying there are no dependencies between static variables, so the order doesn&#39;t matter."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550666611, "post_id": 54782027, "comment_id": 96351695, "body": "&quot;limited embedded system and dynamic allocation is not available.&quot; --&gt; what system/compiler is that?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1550670832, "post_id": 54782027, "comment_id": 96354291, "body": "What problem do you try to solve with information hiding? What do you expect to gain with it? If not much, then just move your type definition to header."}], "answers": [{"comments": [{"owner": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "edited": false, "score": 0, "creation_date": 1550654511, "post_id": 54782482, "comment_id": 96344059, "body": "Please, see my @A.R.C comment in the question"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "edited": false, "score": 0, "creation_date": 1550656365, "post_id": 54782482, "comment_id": 96345184, "body": "@jackhab Added a note at the bottom of the answer regarding that. In particular, see the answer by Clifford in the linked post."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1550656348, "last_edit_date": 1550656348, "creation_date": 1550653567, "answer_id": 54782482, "question_id": 54782027, "link": "https://stackoverflow.com/questions/54782027/how-to-expose-c-struct-size-without-exposing-its-type/54782482#54782482", "title": "How to expose C struct size without exposing its type?", "body": "<p>You shouldn't expose the size of the struct to the caller, because that breaks the whole purpose of having private encapsulation in the first place. Allocation of your private data is no business of the caller. Also, avoid using <code>void*</code> because they complete lack type safety.</p>\n\n<p>This is how you write private encapsulation in C:</p>\n\n<ul>\n<li>In module.h, forward declare an incomplete type <code>typedef struct module module;</code>.</li>\n<li>In module.c, place the struct definition of this struct. it will only be visible to module.c and not to the caller. This is known as <em>opaque types</em>.</li>\n<li>The caller can only allocate pointers to this struct, never allocate objects.</li>\n<li><p>Caller code might look like:</p>\n\n<pre><code>#include \"module.h\"\n...\nmodule* m;\nresult = module_init(&amp;m)\n</code></pre></li>\n<li><p>And the <code>module_init</code> function acts as a \"constructor\", declared in module.h and defined in module.c:</p>\n\n<pre><code>bool module_init (module** obj)\n{\n  module* m = malloc(sizeof *m);\n  ...\n  m-&gt;something = ...; // init private variables if applicable\n\n  *obj = m;\n  return true;\n}\n</code></pre></li>\n<li><p>If the caller does need to know the size of the objects, it would only be for the purpose of hard copy etc. If there's a need for that, provide a copy function which encapsulates the allocation and copy (\"copy constructor\"), for example:</p>\n\n<pre><code>result module_copy (module** dst, const module* src);\n</code></pre></li>\n</ul>\n\n<p>Edit:</p>\n\n<p>Please note that the manner of allocation is a separate issue. You don't have to use dynamic allocation for the above design. In embedded systems for example, it is common to use static memory pools instead. See <a href=\"https://stackoverflow.com/questions/4440476/static-allocation-of-opaque-data-types\">Static allocation of opaque data types</a></p>\n"}, {"tags": [], "owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "is_accepted": false, "score": 1, "last_activity_date": 1550658645, "creation_date": 1550658645, "answer_id": 54784137, "question_id": 54782027, "link": "https://stackoverflow.com/questions/54782027/how-to-expose-c-struct-size-without-exposing-its-type/54784137#54784137", "title": "How to expose C struct size without exposing its type?", "body": "<p>In conforming C code you can't create a static instance of an arbitrary unknown type even if you know its size at compile time (not even if you know the alignment).</p>\n\n<p>Let's say you try doing it anyway. How would you do it, given the size in a macro or enum <code>PRIVATE_SIZE</code>?</p>\n\n<pre><code>unsigned char obj[PRIVATE_SIZE];\n</code></pre>\n\n<p>And then you'd pass <code>(void*)obj</code> to wherever its needed, right?\nWell, this breaks the aliasing rules. While you can legally access any individual char/byte in any object, you can't do it the other way around saying that those chars are not chars, they are just storage behind other types. That is, you can't legally have a <code>short int</code> superimposed on top of, say, <code>obj[2]</code> and <code>obj[3]</code> through smarty-pants casts (e.g. <code>((struct Private*)obj)-&gt;my_short = 2;</code>). The only legal way to do something like this would be through <code>memcpy()</code>, e.g. <code>memcpy(&amp;temp, obj, sizeof temp);</code> and then back after the modification. Or you'd need to work with individual chars of <code>obj[]</code>.</p>\n\n<p>There are two possible ways to sort of do it. One is described in another answer, basically define the instance where the type is known, but only let the outside world have a pointer to it.</p>\n\n<p>Another, very similar, define it in assembly code and, again, let the outside world have a pointer to it. The \"beauty\" of the assembly way is that you really only need a name, an alignment and a size to allocate space for a named object.</p>\n\n<p>And if you put the instances into a special data section (see the gcc's section attribute and the linker scripts), you may even have all of the instances in the same place (think, array) and even find out their cumulative size and therefore count.</p>\n\n<p>Yet another thing to do while not explicitly violating any C rules is to still use this <code>unsigned char obj[PRIVATE_SIZE]</code> trick, but launder it by passing it unchanged through an assembly function that the C compiler can't look into, e.g. something like</p>\n\n<pre><code>// struct Private* launder(unsigned char*);\n.text\n.globl launder\nlaunder:\n    move %first_param_reg, %return_reg\n    ret\n</code></pre>\n\n<p>But you'll really need to change <code>unsigned char obj[PRIVATE_SIZE]</code> to something that would have proper alignment on your architecture, e.g. <code>double obj[PRIVATE_SIZE / sizeof(double)]</code> (or the same with <code>long long</code> if you like that way better).</p>\n\n<p>As for <code>PRIVATE_SIZE</code>, you can have a check at compile time that it matches the size of the type, e.g.</p>\n\n<pre><code>#include \"mod.h\" // mod.h defines PRIVATE_SIZE\nstruct Private { ... };\nextern char StAtIcAsSeRt[sizeof(struct Private) == PRIVATE_SIZE];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1550666916, "last_edit_date": 1550666916, "creation_date": 1550666539, "answer_id": 54786650, "question_id": 54782027, "link": "https://stackoverflow.com/questions/54782027/how-to-expose-c-struct-size-without-exposing-its-type/54786650#54786650", "title": "How to expose C struct size without exposing its type?", "body": "<blockquote>\n  <p>How to expose C struct size without exposing its type?</p>\n</blockquote>\n\n<p>If able to compromise a bit:  (statically --> <code>main()</code> local)<br>\nwith <em>variable length arrays</em> (C99), use a helper function and put the array in <code>main()</code>.</p>\n\n<pre><code>module.h\n  size_t foo_size(void);\n\nmain.c\n  int main() {\n    char m1[foo_size()];\n    foo(m1, 10);\n  }\n</code></pre>\n\n<p>Additional work needed to account for alignment issues.  </p>\n\n<p>Consider relaxing your goal as <a href=\"https://stackoverflow.com/a/54782482/2410359\">suggested</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "edited": false, "score": 0, "creation_date": 1550696641, "post_id": 54787772, "comment_id": 96368437, "body": "Hi, dbush! Can you provide and example of alignment problem which can arise here?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "edited": false, "score": 1, "creation_date": 1550698087, "post_id": 54787772, "comment_id": 96369065, "body": "@jackhab In the above example, <code>struct Private</code> would typically have an alignment requirement of 8.  If you just created a <code>char</code> array to layer the struct on top of, that array might not have that alignment.  On some systems, misalignment can cause inefficient code to be generated or even a memory fault."}, {"owner": {"reputation": 2512, "user_id": 683727, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6afa301295775f882aea1c37da9aee3?s=128&d=identicon&r=PG&f=1", "display_name": "wuxb", "link": "https://stackoverflow.com/users/683727/wuxb"}, "edited": false, "score": 0, "creation_date": 1591818366, "post_id": 54787772, "comment_id": 110204801, "body": "Yes you may add padding variables to fill up the space. But anyway that static-assert is very effective."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1550782230, "last_edit_date": 1550782230, "creation_date": 1550670190, "answer_id": 54787772, "question_id": 54782027, "link": "https://stackoverflow.com/questions/54782027/how-to-expose-c-struct-size-without-exposing-its-type/54787772#54787772", "title": "How to expose C struct size without exposing its type?", "body": "<p>You can't allocate size for a struct such as this because it isn't known at compile time.  Even if you did know the size at run time, you'd still have issues due to alignment.</p>\n\n<p>There is a possible solution which involves defining a separate structure that has the same size and alignment requirements as the private struct.</p>\n\n<p>For example:</p>\n\n<p>module.h:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n\nstruct Public {\n    uint64_t opaque1;\n    uint64_t opaque2;\n    uint64_t opaque3;\n};\n\nvoid init(struct Public *p);\n</code></pre>\n\n<p>module.c:</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdalign.h&gt;\n#include \"module.h\"\n\nstruct Private {\n    int a;\n    double b;\n    float c;\n};\n\nstatic_assert(sizeof(struct Private)==sizeof(struct Public), \"sizes differ\");\nstatic_assert(alignof(struct Private)==alignof(struct Public), \"alignments differ\");\n\nvoid init(struct Public *p)\n{\n    struct Private *pr = (struct Private *)p;\n    pr-&gt;a = 2;\n    pr-&gt;b = 2.5;\n    pr-&gt;c = 2.4f;\n}\n</code></pre>\n\n<p>The <code>Public</code> and <code>Private</code> structs are guaranteed to have the same size, and the alignment <em>should</em> be the same.  There is the possibility of the user writing the the \"opaque\" fields of the public struct, in which case you could have aliasing issues regarding effective types, but if the user can be trusted to do that then this should work.</p>\n\n<hr>\n\n<p>Another, more robust option, is if you have some idea of the maximum number of objects you want to support.  If that's the case, you can have a static array of these objects in your implementation file, and the init function would return a pointer to one of the objects in this list.  Then you'd have a related cleanup function that would free the instance.</p>\n\n<p>For example:</p>\n\n<p>module.c:</p>\n\n<pre><code>struct Private {\n    int a;\n    double b;\n    float c;\n};\n\nstruct PrivateAllocator {\n    struct Private obj;\n    int used;\n};\n\nstruct PrivateAllocator list[5] = {\n    { { 0, 0, 0}, 0 },\n    { { 0, 0, 0}, 0 },\n    { { 0, 0, 0}, 0 },\n    { { 0, 0, 0}, 0 },\n    { { 0, 0, 0}, 0 }\n};\n\nstruct Private *private_init()\n{\n    int i;\n    for (i=0; i&lt;5; i++) {\n        if (!list[i].used) {\n            list[i].used = 1;\n            return &amp;list[i].obj;\n        }\n    }\n    return NULL;\n}\n\nvoid private_free(struct Private *p)\n{\n    int i;\n    for (i=0; i&lt;5; i++) {\n        if (&amp;list[i].obj == p) {\n            list[i].used = 0;\n            return;\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "edited": false, "score": 0, "creation_date": 1550696464, "post_id": 54789289, "comment_id": 96368371, "body": "Unfortunately my compiler (Microchip XC8) does not support VLAs"}], "tags": [], "owner": {"reputation": 1100, "user_id": 1164753, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/32d94ee651e8e6a4140ea93704f40bfa?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1164753/petr"}, "is_accepted": false, "score": 0, "last_activity_date": 1550674812, "creation_date": 1550674812, "answer_id": 54789289, "question_id": 54782027, "link": "https://stackoverflow.com/questions/54782027/how-to-expose-c-struct-size-without-exposing-its-type/54789289#54789289", "title": "How to expose C struct size without exposing its type?", "body": "<p>C99 allowes you to use <strong>variable length array.</strong> </p>\n\n<p>private.h:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nextern const size_t size;\n</code></pre>\n\n<p>private.c:</p>\n\n<pre><code>#include \"private.h\"\nstruct Private {\n        int x;\n        int y;\n        int z;\n};\n\nconst size_t size = sizeof(struct Private);\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"private.h\"\nint main(void) {\n        char m1[size]; //variable length array\n        printf(\"Size of m1 = %ld\\n\", sizeof(m1));\n}\n</code></pre>\n"}], "owner": {"reputation": 14892, "user_id": 48461, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/234f359fd915ac46d92b477dc55a13fa?s=128&d=identicon&r=PG", "display_name": "jackhab", "link": "https://stackoverflow.com/users/48461/jackhab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 5, "score": 4, "last_activity_date": 1550782230, "creation_date": 1550651925, "last_edit_date": 1550658876, "question_id": 54782027, "link": "https://stackoverflow.com/questions/54782027/how-to-expose-c-struct-size-without-exposing-its-type", "title": "How to expose C struct size without exposing its type?", "body": "<p>I have the following in C (not C++!):</p>\n\n<pre><code>module.c\n    struct Private {...};\n    void foo(void* private, int param) {...}\n\nmodule.h\n    #define PRIVATE_SIZE ???;\n    void foo(void* private, int param);\n\nmain.c\n    char m1[PRIVATE_SIZE];\n    char m2[PRIVATE_SIZE];\n\n    int main()\n    {\n        foo(m1, 10);\n        foo(m2, 20);\n    }\n</code></pre>\n\n<p>How can I expose sizeof(Private) at compile time so that application can <strong><em>statically</em></strong> allocate its storage without exposing Private type?</p>\n\n<p>Note, this is a very limited embedded system and dynamic allocation is not available.</p>\n"}, {"tags": ["c++", "c", "assembly", "x86-64", "red-zone"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1550650895, "post_id": 54781648, "comment_id": 96342121, "body": "Esp has not been changed so no action needed. Why to restore something unaffected"}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1550651188, "post_id": 54781648, "comment_id": 96342273, "body": "Yea, I see that now, right before you mentioned. I&#39;ve updated post. Now, there is another question then.."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1550652128, "post_id": 54781648, "comment_id": 96342729, "body": "See <a href=\"https://en.wikipedia.org/wiki/Red_zone_%28computing%29\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Red_zone_%28computing%29</a>."}, {"owner": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1550652759, "post_id": 54781648, "comment_id": 96343062, "body": "what happens if you call a function inside add() ? e.g change it to <code>a + b+ c + f()</code> with <code>int f() { return 5;} </code>. I am curious what happens to <code>rsp</code> before the call to <code>f</code>. It should be adjusted otherwise local variables would be overwritten."}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "reply_to_user": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 1, "creation_date": 1550655016, "post_id": 54781648, "comment_id": 96344381, "body": "@AndreasH. It adds <code>push rbx; sub rsp, 16</code> to prologue and <code>add rsp, 16; pop rbx</code> to epilogue"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "closed_date": 1550652985, "answer_count": 0, "score": 3, "last_activity_date": 1550657682, "creation_date": 1550650505, "last_edit_date": 1550657682, "question_id": 54781648, "link": "https://stackoverflow.com/questions/54781648/why-there-is-no-leave-instruction-at-function-epilog-on-x64", "closed_reason": "Duplicate", "title": "Why there is no `leave` instruction at function epilog on x64?", "body": "<p>I'm on the way to get idea how the stack works on x86 and x64 machines. What I observed however is that when I manually write a code and disassembly it, it differs from what I see in the code people provide (eg. in their questions and tutorials). Here is little example:</p>\n\n<p><strong>Source</strong></p>\n\n<pre><code>int add(int a, int b) {\n    int c = 16;\n    return a + b + c;\n}\n\nint main () {\n    add(3,4);\n   return 0;\n}\n</code></pre>\n\n<p><strong>x86</strong></p>\n\n<pre><code>add(int, int):\n        push    ebp\n        mov     ebp, esp\n        sub     esp, 16\n        mov     DWORD PTR [ebp-4], 16\n        mov     edx, DWORD PTR [ebp+8]\n        mov     eax, DWORD PTR [ebp+12]\n        add     edx, eax\n        mov     eax, DWORD PTR [ebp-4]\n        add     eax, edx\n        leave (!)\n        ret\n\nmain:\n        push    ebp\n        mov     ebp, esp\n        push    4\n        push    3\n        call    add(int, int)\n        add     esp, 8\n        mov     eax, 0\n        leave (!)\n        ret\n</code></pre>\n\n<p><strong>Now goes x64</strong></p>\n\n<pre><code>add(int, int):\n        push    rbp\n        mov     rbp, rsp\n        (?) where is `sub rsp, X`?\n        mov     DWORD PTR [rbp-20], edi\n        mov     DWORD PTR [rbp-24], esi\n        mov     DWORD PTR [rbp-4], 16\n        mov     edx, DWORD PTR [rbp-20]\n        mov     eax, DWORD PTR [rbp-24]\n        add     edx, eax\n        mov     eax, DWORD PTR [rbp-4]\n        add     eax, edx\n        (?) where is `mov rsp, rbp` before popping rbp?\n        pop     rbp\n        ret\n\nmain:\n        push    rbp\n        mov     rbp, rsp\n        mov     esi, 4\n        mov     edi, 3\n        call    add(int, int)\n        mov     eax, 0\n        (?) where is `mov rsp, rbp` before popping rbp?\n        pop     rbp\n        ret\n</code></pre>\n\n<p>As you can see, my main confusion is that when I compile against x86 - I see what I expect. When it's x64 - I miss leave instruction or exact following sequence: <code>mov rsp, rbp</code> then <code>pop rbp</code>. What's worng?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>It seems like <code>leave</code> is missing, just because it wasn't altered previously. But then, goes another question - why there is no allocation for local vars in the frame? </p>\n\n<hr>\n\n<p>To this question <a href=\"https://stackoverflow.com/questions/54781648/why-there-is-no-leave-instruction-at-function-epilog-on-x64#comment96342729_54781648\">@melpomene</a> gives pretty straightforward answer - because of \"red zone\". Which basically means the function that calls no further functions (leaf) can use the first 128 bytes below the stack without allocating space. So if I insert a call inside an <code>add()</code> to any other dumb function - <code>sub rsp, X</code> and <code>add rsp, X</code> will be added to prologue and epilogue respectively.</p>\n"}, {"tags": ["c", "linux", "valgrind"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1550649574, "post_id": 54781388, "comment_id": 96341425, "body": "Where do you <code>free</code> the memory allocated by the first two <code>asprintf</code> calls?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1550650138, "post_id": 54781388, "comment_id": 96341713, "body": "and the &#39;first&#39; can be several because in a <i>for</i> ... and its result is not used"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1550692915, "post_id": 54781388, "comment_id": 96366727, "body": "Sidenote: you can avoid a lot of strlen()s if you use the return value from asprintf()"}], "answers": [{"tags": [], "owner": {"reputation": 939, "user_id": 1556829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NKY9p.png?s=128&g=1", "display_name": "Igor S.K.", "link": "https://stackoverflow.com/users/1556829/igor-s-k"}, "is_accepted": false, "score": 5, "last_activity_date": 1550650014, "creation_date": 1550650014, "answer_id": 54781519, "question_id": 54781388, "link": "https://stackoverflow.com/questions/54781388/valgrind-reports-memory-leak-with-asprintf/54781519#54781519", "title": "Valgrind reports memory leak with asprintf", "body": "<p>This is what the man page says:</p>\n\n<blockquote>\n  <p>The  functions asprintf() .... allocate a string...</p>\n</blockquote>\n\n<p>and later</p>\n\n<blockquote>\n  <p>This pointer should be passed to free(3) to release the allocated storage when it is no longer needed.</p>\n</blockquote>\n\n<p>Every new call leads to a new allocation. You don't seem to free the previously allocated string .</p>\n"}, {"comments": [{"owner": {"reputation": 1968, "user_id": 4402916, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2ed524952816b84787b70aea7c8bcf8a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkon", "link": "https://stackoverflow.com/users/4402916/arkon"}, "edited": false, "score": 0, "creation_date": 1550736838, "post_id": 54781840, "comment_id": 96381036, "body": "In your modified version, you only perform 1 call to write. Also, how can you make sure <code>resp-&gt;content-&gt;data</code> is not going to overflow in buffer without realloc?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1968, "user_id": 4402916, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2ed524952816b84787b70aea7c8bcf8a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkon", "link": "https://stackoverflow.com/users/4402916/arkon"}, "edited": false, "score": 1, "creation_date": 1550753414, "post_id": 54781840, "comment_id": 96391348, "body": "@Arkon: indeed I did not implement all suggestions. Regarding potential buffer overflow, <code>if (resp-&gt;content != NULL) bytes += 2 + resp-&gt;content-&gt;size;</code> at the end of the initial phase ensures enough space is allocated."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1550671631, "last_edit_date": 1550671631, "creation_date": 1550651324, "answer_id": 54781840, "question_id": 54781388, "link": "https://stackoverflow.com/questions/54781388/valgrind-reports-memory-leak-with-asprintf/54781840#54781840", "title": "Valgrind reports memory leak with asprintf", "body": "<p>Your code does not <code>free</code> all the strings allocated by <code>asprintf</code>. Given how you use <code>asprintf</code> to perform dynamic string concatenation, fixing this problem is a bit cumbersome. Note that you do not handle memory allocation failure either. You could use <code>asprintf</code> return value to detect that and update <code>bytes</code> without the need for an extra <code>strlen()</code> call.</p>\n\n<pre><code>/* return the number of bytes written or -1 in case of error */\nint write_response(request *req, response *resp, int socket) {\n    char *raw_resp, *new_p;\n    int bytes;\n\n    bytes = asprintf(&amp;raw_resp, \"HTTP/1.1 %d %s\\r\\n\", resp-&gt;code, resp-&gt;reason_phrase);\n    if (bytes &lt; 0)\n        return -1;\n\n    for (int i = 0; i &lt; resp-&gt;header_count; i++) {\n        bytes = asprintf(&amp;new_p, \"%s%s\", raw_resp, resp-&gt;headers[i]);\n        free(raw_resp);\n        raw_resp = newp;\n        if (bytes &lt; 0)\n            return -1;\n    }\n\n    if (resp-&gt;content != NULL) {\n        bytes = asprintf(&amp;new_p, \"%s\\r\\n\", raw_resp);\n        free(raw_resp);\n        raw_resp = newp;\n        if (bytes &lt; 0)\n            return -1;\n        new_p = realloc(raw_resp, bytes + resp-&gt;content-&gt;size);\n        if (new_p == NULL) {\n            free(raw_resp);\n            return -1;\n        }\n        raw_resp = new_p;\n        memcpy(raw_resp + bytes, resp-&gt;content-&gt;data, resp-&gt;content-&gt;size);\n        bytes += resp-&gt;content-&gt;size;\n    }\n    bytes = write(socket, raw_resp, bytes);\n    free(raw_resp);\n    return bytes;\n}\n</code></pre>\n\n<p>Remarks:</p>\n\n<ul>\n<li><p>Using <code>asprintf</code> to perform string concatenation with allocation seems inefficient, simply use <code>strlen</code>, <code>realloc</code> and <code>memcpy</code>.</p></li>\n<li><p><code>asprintf()</code> is non-standard, it is not be available on all platforms.</p></li>\n<li><p>Unless you are requested to issue a single call to <code>write</code>, it might be more efficient to write the contents separately to avoid the extra call to <code>realloc()</code> for a potentially large amount of memory.</p></li>\n<li><p>It might also be more efficient to compute the length of the headers in a initial phase with <code>snprintf</code> and <code>strlen</code> and allocate the space for the headers directly to the full size, or not even allocate if below a reasonable threshold (4K) using a local array.</p></li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre><code>int write_response(request *req, response *resp, int socket) {\n    char buffer[4096];\n    char *raw_resp, *allocated = NULL;\n    int bytes, pos;\n\n    bytes = snprintf(NULL, 0, \"HTTP/1.1 %d %s\\r\\n\", resp-&gt;code, resp-&gt;reason_phrase);\n    for (int i = 0; i &lt; resp-&gt;header_count; i++)\n        bytes += strlen(resp-&gt;headers[i]);\n    if (resp-&gt;content != NULL)\n        bytes += 2 + resp-&gt;content-&gt;size;\n\n    /* need an extra byte for `snprintf` null terminator \n       if no headers and no contents */\n    if (bytes &lt; sizeof(buffer)) {\n        raw_resp = buffer;\n    } else {\n        raw_resp = allocated = malloc(bytes + 1): \n        if (raw_resp == NULL)\n            return -1;\n    }\n    pos = snprintf(raw_resp, bytes, \"HTTP/1.1 %d %s\\r\\n\", resp-&gt;code, resp-&gt;reason_phrase);\n    for (int i = 0; i &lt; resp-&gt;header_count; i++) {\n        int len = strlen(resp-&gt;headers[i]);\n        memcpy(raw_resp + pos, resp-&gt;headers[i], len);\n        pos += len;\n    }\n\n    if (resp-&gt;content != NULL) {\n        raw_resp[pos++] = '\\r';\n        raw_resp[pos++] = '\\n';\n        memcpy(raw_resp + pos, resp-&gt;content-&gt;data, resp-&gt;content-&gt;size);\n        pos += resp-&gt;content-&gt;size;\n    }\n    bytes = write(socket, raw_resp, bytes);\n    free(allocated);\n    return bytes;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1550654337, "last_edit_date": 1550654337, "creation_date": 1550651522, "answer_id": 54781903, "question_id": 54781388, "link": "https://stackoverflow.com/questions/54781388/valgrind-reports-memory-leak-with-asprintf/54781903#54781903", "title": "Valgrind reports memory leak with asprintf", "body": "<p>You have missing frees, and you do not need <em>asprintf</em> except the first time</p>\n\n<p>Can be:</p>\n\n<pre><code>void write_response(request *req, response *resp, int socket) {\n  char * buff;\n  int len;\n\n  len = asprintf(&amp;buff, \"HTTP/1.1 %d %s\\r\\n\", resp-&gt;code, resp-&gt;reason_phrase);\n  if (len == -1)\n    .. error management\n\n  for (int i = 0; i &lt; resp-&gt;header_count; i++) {\n    size_t hlen = strlen(resp-&gt;headers[i]);\n\n    buff = realloc(buff, len + hlen + 1);\n    if (buff == NULL)\n      ... error management\n    strcpy(buff + len, resp-&gt;headers[i]);\n    len += hlen;\n  }\n\n  if (resp-&gt;content != NULL) {\n    buff = realloc(buff, len + 2 + resp-&gt;content-&gt;size);\n    if (buff == NULL)\n      ... error management\n    buff[len] = '\\r';\n    buff[len + 1] = '\\n';\n    memcpy(len + 2, resp-&gt;content-&gt;data, resp-&gt;content-&gt;size);\n    len += resp-&gt;content-&gt;size + 2;\n  }\n  if (write(socket, buff, len) != len)\n    ... error management\n  free(buff);\n}\n</code></pre>\n"}], "owner": {"reputation": 1968, "user_id": 4402916, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2ed524952816b84787b70aea7c8bcf8a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkon", "link": "https://stackoverflow.com/users/4402916/arkon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 54781840, "answer_count": 3, "score": 1, "last_activity_date": 1550671631, "creation_date": 1550649419, "question_id": 54781388, "link": "https://stackoverflow.com/questions/54781388/valgrind-reports-memory-leak-with-asprintf", "title": "Valgrind reports memory leak with asprintf", "body": "<p>Here is a piece of code that writes an HTTP response on a socket based on a simple struct</p>\n\n<pre><code>void write_response(request *req, response *resp, int socket) {\n  char *raw_resp;\n  int bytes = 0;\n\n  asprintf(&amp;raw_resp, \"HTTP/1.1 %d %s\\r\\n\", resp-&gt;code, resp-&gt;reason_phrase);\n\n  bytes += strlen(raw_resp);\n  for (int i = 0; i &lt; resp-&gt;header_count; i++) {\n    asprintf(&amp;raw_resp, \"%s%s\", raw_resp, resp-&gt;headers[i]);\n    bytes += strlen(resp-&gt;headers[i]);\n  }\n\n  if (resp-&gt;content != NULL) {\n    asprintf(&amp;raw_resp, \"%s\\r\\n\", raw_resp);\n    raw_resp = realloc(raw_resp, bytes + 2 + resp-&gt;content-&gt;size);\n    memcpy(&amp;raw_resp[strlen(raw_resp)], resp-&gt;content-&gt;data,\n           resp-&gt;content-&gt;size);\n    bytes += (resp-&gt;content-&gt;size + 2);\n  }\n  write(socket, raw_resp, bytes);\n  free(raw_resp);\n}\n</code></pre>\n\n<p>Basically, it adds the HTTP request line first, then the headers and finally if needed the body.</p>\n\n<p>However, valgrind is reporting a <code>Invalid free() / delete / delete[] / realloc()</code> and <code>18 bytes in 1 blocks are definitely lost in loss record 2 of 4</code> (memory leaks) on the first 2 asprintf but weirdly not on the 3rd one.</p>\n\n<p>Am I using asprintf right?</p>\n"}, {"tags": ["c", "memory-layout", "data-segment"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1550645379, "post_id": 54780355, "comment_id": 96339537, "body": "Ummm. <code>dec 15688</code> is <code>hex 3d48</code> (no mystery there) Both global and those declared <code>static</code> have static storage duration and are initialize to zero by default. (no clue on 3Q)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1550645420, "post_id": 54780355, "comment_id": 96339555, "body": "Small differences in compiler flags and compiler versions and operating systems will lead to large differences in the generated executable. Whatever documentation or tutorial you read, all its examples will be just that: <i>examples</i>. And what <code>size</code> is telling you have nothing to do with the in-memory layout of a running program, only information about the executable file itself."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1550645590, "post_id": 54780355, "comment_id": 96339629, "body": "Quote: &quot;...i wanted to know exactly how this memory management works in C&quot; Well, that can&#39;t be answered as the C standard by itself does <b>not</b> specify such things. Therefore it may differ from system/setup to system/setup. Only when you give an exact specification of your system/setup it will be possible to answer."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1550645627, "post_id": 54780355, "comment_id": 96339645, "body": "And nothing in this question is about the runtime memory of a program or C memory management, all it&#39;s about are the segments of the executable file <i>on disk</i>. On-disk executable file segments really have no relation to runtime memory management, and haven&#39;t had the last couple of decades."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1550645797, "post_id": 54780355, "comment_id": 96339719, "body": "<code>&quot;And finally when i initialize the global variable with 20, data got incremented (expected) and dec also got incremented why?&quot;</code> (both <code>dec</code> and <code>hex</code> were incremented because they represent the sum of <code>text + data + bss</code>)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1550646127, "post_id": 54780355, "comment_id": 96339852, "body": "A more fine-grained explanation can be gathered by using <code>objdump</code>, e.g. <code>objdump -D -M &quot;intel-mnemonic&quot; path&#47;to&#47;your&#47;exe</code>. It will show detailed contents of each of the <code>.text .bss &amp; .data</code> sections."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550649412, "post_id": 54780355, "comment_id": 96341343, "body": "See this example: <a href=\"https://stackoverflow.com/questions/52855674/a-program-uses-different-regions-of-memory-for-static-objects-automatic-objects\" title=\"a program uses different regions of memory for static objects automatic objects\">stackoverflow.com/questions/52855674/&hellip;</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550649483, "post_id": 54780355, "comment_id": 96341378, "body": "As for dec, it is simply the total size of all code and data expressed in decimal format. And hex is the same, but hex format."}], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 10973714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fFjJ.jpg?s=128&g=1", "display_name": "heeat", "link": "https://stackoverflow.com/users/10973714/heeat"}, "edited": false, "score": 0, "creation_date": 1550649640, "post_id": 54781045, "comment_id": 96341455, "body": "What are the 3 digits in hex? are they the last 3 digits of the hexcode i.e the address where these memort blocks are stored or is there any other meaning."}, {"owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "reply_to_user": {"reputation": 126, "user_id": 10973714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fFjJ.jpg?s=128&g=1", "display_name": "heeat", "link": "https://stackoverflow.com/users/10973714/heeat"}, "edited": false, "score": 0, "creation_date": 1550652473, "post_id": 54781045, "comment_id": 96342916, "body": "The 3 characters in <code>hex</code> do not specify memory location. It other meaning. They signify the memory area used by your process. They are just hexadecimal equivalent of <code>dec</code>."}], "tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": true, "score": 1, "last_activity_date": 1550648073, "creation_date": 1550648073, "answer_id": 54781045, "question_id": 54780355, "link": "https://stackoverflow.com/questions/54780355/memory-allocation-layout-issues-in-c-64-bit/54781045#54781045", "title": "Memory allocation layout issues in C (64-bit)", "body": "<blockquote>\n  <p>What are the factors (Hardware/Software) that are responsible for the memory allocation?. And what does dec in the layout refer to</p>\n</blockquote>\n\n<p>Your program is divided into many sections when it runs. <code>stack</code> contains the local variables. <code>bss data</code> contains the <strong>uninitalized</strong> global variables. <code>initialized data</code> contains the initialized global variables. <code>text</code> contains your text (code).\n<code>dec</code> is the sum of <code>text</code>, <code>bss</code> , <code>data</code></p>\n\n<blockquote>\n  <p>But when i add the static int x it is not adding the memory block to bss anymore.is it expected?</p>\n</blockquote>\n\n<p>Keep it uninitialized then it will add.</p>\n\n<p>Before adding static variable:</p>\n\n<pre><code>   text    data     bss     dec     hex filename\n   1099     544       8    1651     673 a.out\n</code></pre>\n\n<p>After adding static variable:</p>\n\n<pre><code>   text    data     bss     dec     hex filename\n   1099     544      16    1659     67b a.out\n</code></pre>\n\n<blockquote>\n  <p>And finally when i initialize the global variable with 20, data got incremented (expected) and dec also got incremented. Why?</p>\n</blockquote>\n\n<p>Because <code>dec</code> is the sum of <code>text</code>, <code>data</code> , <code>bss</code></p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1550951130, "last_edit_date": 1550951130, "creation_date": 1550649676, "answer_id": 54781449, "question_id": 54780355, "link": "https://stackoverflow.com/questions/54780355/memory-allocation-layout-issues-in-c-64-bit/54781449#54781449", "title": "Memory allocation layout issues in C (64-bit)", "body": "<p>Here is a quick summary:</p>\n\n<ul>\n<li><p>executable code, string literals and constant global variables are loaded to the <strong>text</strong> segment, which is made read-only in memory by the OS program loader on systems that support it.</p></li>\n<li><p>global initialized modifiable objects and local initialized objects declared with <code>static</code> storage are loaded into the <strong>data</strong> segment.</p></li>\n<li><p>uninitialized modifiable global objects and uninitialized local <code>static</code> objects are allocated in the <strong>bss</strong> segment, which is not present in the executable file.</p></li>\n<li><p>other local objects with automatic storage are carved dynamically from the <strong>stack</strong> segment upon function entry of sometimes on the fly when they come into scope.</p></li>\n<li><p>the <strong>dec</strong> column gives the total size of the program code and data: the sum of <strong>text</strong>, <strong>data</strong> and <strong>bss</strong>. This does not include memory allocated at startup time, stack space, nor data allocated dynamically from the heap or using other OS specific methods.</p></li>\n<li><p><strong>hex</strong> is the hexadecimal representation of <strong>dec</strong>.</p></li>\n</ul>\n\n<p>These values vary depending on the operating system, compiler, compiler settings and libraries. The website shows the output on a system running CentOS, possibly in 32-bit mode. Note how the same program produces much larger values for all segments mostly due to a different C library startup code. The <code>main</code> function itself should use from a few bytes to at most a few dozens depending on compiling options.</p>\n\n<p>The size of the executable file is different from <strong>dec</strong> because it does not contain the <strong>bss</strong> data but contain other information regarding how to load the program: the sizes and placement of the various segments, the references to dynamic libraries and the symbols to link from them, debug information, etc.</p>\n\n<p>When you add a global variable, <strong>bss</strong> is increased if it is uninitialized, otherwise <strong>data</strong> increases.  When you add a local variable, the same happens if it is static.</p>\n\n<p>Note however that alignment issues may affect how the data is added to a segment and optimisation settings may affect whether new objects are actually added to the executable. If the compiler can determine that an object is never used, it might ignore it completely.</p>\n\n<p>Modern operating systems handle many more segments and intricacies about executable programs, the above is a simplistic approach that models the memory layout of executable programs in the early Unix systems during the 1970s and 1980s. The names predate Unix by almost 2 decades. More information can be displayed with the <strong>objdump</strong> and <strong>nm</strong> utilities.</p>\n\n<p>You can read a detailed explanation about the standard Unix segments names here:</p>\n\n<p><strong>text</strong>: <a href=\"https://en.wikipedia.org/wiki/Code_segment\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Code_segment</a></p>\n\n<p><strong>data</strong>: <a href=\"https://en.wikipedia.org/wiki/Data_segment\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Data_segment</a></p>\n\n<p><strong>bss</strong>: <a href=\"https://en.wikipedia.org/wiki/.bss\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/.bss</a></p>\n"}], "owner": {"reputation": 126, "user_id": 10973714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fFjJ.jpg?s=128&g=1", "display_name": "heeat", "link": "https://stackoverflow.com/users/10973714/heeat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 54781045, "answer_count": 2, "score": 1, "last_activity_date": 1550951130, "creation_date": 1550645128, "last_edit_date": 1550649985, "question_id": 54780355, "link": "https://stackoverflow.com/questions/54780355/memory-allocation-layout-issues-in-c-64-bit", "title": "Memory allocation layout issues in C (64-bit)", "body": "<p>I wanted to understand how a \"C\" program runs and store the data in machine.\nSo I looked into Memory Layout of C from <a href=\"https://www.geeksforgeeks.org/memory-layout-of-c-program/\" rel=\"nofollow noreferrer\">here</a> and I followed the same instructions in my machine which is 64-bit. </p>\n\n<p>First when I wrote the program (<code>main</code> has only <code>return 0;</code>) and used the <code>size</code> command for the executable file: it showed a lot of difference in both text and data segments. </p>\n\n<pre><code>text    data    bss     dec     hex     filename\n10648   2400    2640    15688   3d48    33.exe\n</code></pre>\n\n<p>But in the website mentioned above it showed:</p>\n\n<pre><code>text    data    bss     dec     hex     filename\n960     248     8       1216    4c0     memory-layout\n</code></pre>\n\n<p><strong>First Question:</strong>\nWhat are the factors (hardware/software) that are responsible for the memory allocation?.\nAnd what does <code>dec</code> in the layout refer to?  /<strong>Question ends here</strong></p>\n\n<p>But first I ignored this and started declaring the variables (global and static) to see where they are being stored. And I was facing a problem in this phase.</p>\n\n<p>for this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \nint global;  \nint main(void) {\n    //static int x;\n    return 0; \n} \n</code></pre>\n\n<p>I got output as:</p>\n\n<pre><code>text    data    bss     dec     hex     filename\n10648   2400    2656    15704   3d48    33.exe\n</code></pre>\n\n<p>That is because I declared (uninitialised) a global variable and that is why 16 bytes (int-64bit) of memory block has been added to the <code>bss</code> so it became 2656 from 2640 (first example) I understand this.</p>\n\n<p><strong>Q2</strong>: But when I add the <code>static int x</code> it is not adding the memory block to <code>bss</code> anymore. Is this expected?</p>\n\n<pre><code>text    data    bss     dec     hex     filename\n10648   2400    2656    15704   3d48    33.exe \n</code></pre>\n\n<p><strong>Q3</strong>: And finally when I initialize the global variable with <code>20</code>, <code>data</code> got incremented (expected) and <code>dec</code> also got incremented why?</p>\n\n<pre><code>text    data    bss     dec     hex     filename\n10648   2416    2656    15720   3d48    33.exe\n</code></pre>\n\n<p>I know I asked many questions here, but I wanted to know exactly how this memory management works in C.</p>\n\n<p>Arigato:)</p>\n"}, {"tags": ["c", "linux", "makefile"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1550643265, "post_id": 54779736, "comment_id": 96338701, "body": "Where are <code>heapsort</code> and <code>mergesort</code> defined?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1550643984, "post_id": 54779736, "comment_id": 96339000, "body": "<code>mergesort() from the C standard library</code> - there is no mergesort() in C standard library."}], "answers": [{"comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1550645034, "post_id": 54779988, "comment_id": 96339413, "body": "Why? You won&#39;t find them in C++ (well, there is a heap sort but that algorithm has a different name...). They&#39;re from *BSD libcs."}], "tags": [], "owner": {"reputation": 1422, "user_id": 4538770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfd2f0b91001372439c7e23c60e4c52?s=128&d=identicon&r=PG", "display_name": "Jo&#235;l Hecht", "link": "https://stackoverflow.com/users/4538770/jo%c3%abl-hecht"}, "is_accepted": false, "score": 1, "last_activity_date": 1550643491, "creation_date": 1550643491, "answer_id": 54779988, "question_id": 54779736, "link": "https://stackoverflow.com/questions/54779736/linking-error-for-mergesort-from-the-c-standard-library/54779988#54779988", "title": "linking error for mergesort() from the C standard library", "body": "<p><code>heapsort</code> and <code>mergesort</code> are not part of the standard library in C. You should look at a C++ compiler to have these functions.</p>\n"}, {"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1550644411, "creation_date": 1550644411, "answer_id": 54780176, "question_id": 54779736, "link": "https://stackoverflow.com/questions/54779736/linking-error-for-mergesort-from-the-c-standard-library/54780176#54780176", "title": "linking error for mergesort() from the C standard library", "body": "<p><code>mergesort() from the C standard library</code> - there is no mergesort() in C standard library. The function does not come from <a href=\"https://en.cppreference.com/w/c/header\" rel=\"nofollow noreferrer\">the C standard library</a>.</p>\n\n<p>I have found <a href=\"https://linux.die.net/man/3/mergesort\" rel=\"nofollow noreferrer\">man mergesort</a> on linux.die.net, which suggest the function is from BSD systems. So you should link your program against <code>-lbsd</code>.</p>\n\n<p>In your makefile you have:</p>\n\n<pre><code>OS=$(shell lsb_release -si)\nifeq ($(OS),Ubuntu)\n    LDLIBS=-llcthw -lbsd -L./build -lm\nendif\n</code></pre>\n\n<p>It should be done for all linux hosts that have bsd package installed. Remove that check.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 15489728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GglasjUzTHgad3udXg_MVeiUlmx7gvtifDMXSu-dw0=k-s128", "display_name": "Cameron Larson", "link": "https://stackoverflow.com/users/15489728/cameron-larson"}, "is_accepted": false, "score": 1, "last_activity_date": 1616795950, "creation_date": 1616795950, "answer_id": 66824797, "question_id": 54779736, "link": "https://stackoverflow.com/questions/54779736/linking-error-for-mergesort-from-the-c-standard-library/66824797#66824797", "title": "linking error for mergesort() from the C standard library", "body": "<p>For anyone else going through the Learn C The Hard Way book by Zed A. Shaw, in the makefile you can also replace this block:</p>\n<pre><code>OS=$(shell lsb_release -si)\nifeq ($(OS),Ubuntu)\n    LDLIBS=-llcthw -lbsd -L./build -lm\nendif\n</code></pre>\n<p>With the following:</p>\n<pre><code>OS=$(shell uname -a)\nifeq (Linux,$(findstring Linux,$(OS)))\n    LDLIBS=-llcthw -lbsd -L./build -lm\nendif\n</code></pre>\n<p>Which should work with any Linux distro without disrupting the makefile execution on a Mac. The reason this is happening is stdlib.h in Linux has an implementation of quick sort but not of heap sort and merge sort so the BSD stdlib.h (which is what Mr. Shaw is using on his Mac) should be used instead.</p>\n<p>In darray_algos.c you may also need to replace:</p>\n<pre><code>#include &lt;stdlib.h&gt;\n</code></pre>\n<p>with:</p>\n<pre><code>#include &lt;bsd/stdlib.h&gt;\n</code></pre>\n<p>to get rid of warnings when compiling.</p>\n"}], "owner": {"reputation": 11, "user_id": 11088139, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lxKZhzObPdk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNpWUFKwNfd-YCEuSmck5546OCkwg/mo/photo.jpg?sz=128", "display_name": "Arath Figueroa Salomon", "link": "https://stackoverflow.com/users/11088139/arath-figueroa-salomon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1616795950, "creation_date": 1550642345, "last_edit_date": 1550644439, "question_id": 54779736, "link": "https://stackoverflow.com/questions/54779736/linking-error-for-mergesort-from-the-c-standard-library", "title": "linking error for mergesort() from the C standard library", "body": "<p>This is my source file but when I compile it i got undefined reference to mergesort.</p>\n\n<pre><code>#include &lt;lcthw/darray_algos.h&gt;\n#include &lt;stdlib.h&gt;\n\n    int DArray_qsort(DArray * array,DArray_compare cmp)\n    {\n    qsort(array-&gt;contents,   DArray_count(array), sizeof(void *), cmp);\n    return 0;\n    }\n\n    int DArray_heapsort(DArray * array, DArray_compare cmp)\n    {\n    return heapsort(array-&gt;contents, DArray_count(array),\n            sizeof(void *), cmp);\n    }\n\n    int DArray_mergesort(DArray * array, DArray_compare cmp)\n    {\n    return mergesort(array-&gt;contents, DArray_count(array),\n            sizeof(void *), cmp);\n    }\n</code></pre>\n\n<p>I dont know how to link the stdlib sorting functions correctly I been using this generic makefile but it seems to failing the stdlib</p>\n\n<pre><code>   CFLAGS=-g -O2 -Wall -Wextra -Isrc    -rdynamic -DNDEBUG $(OPTFLAGS)\nLDFLAGS=$(OPTLIBS)\nPREFIX?=/usr/local\n\nSOURCES=$(wildcard src/**/*.c src/*.c)\nOBJECTS=$(patsubst %.c,%.o,$(SOURCES))\n\nTEST_SRC=$(wildcard tests/*_tests.c)\nTESTS=$(patsubst %.c,%,$(TEST_SRC))\n\nTARGET=build/liblcthw.a\n\nOS=$(shell lsb_release -si)\nifeq ($(OS),Ubuntu)\n    LDLIBS=-llcthw -lbsd -L./build -lm\nendif\n\n# The Target Build\nall: $(TARGET) tests\n\ndev: CFLAGS=-g -Wall -Isrc -Wall -Wextra $(OPTFLAGS)\ndev: all\n\n$(TARGET): CFLAGS += -fPIC\n$(TARGET): build $(OBJECTS)\n    ar rcs $@ $(OBJECTS)\n    ranlib $@\n\nbuild:\n    @mkdir -p build\n    @mkdir -p bin\n</code></pre>\n"}, {"tags": ["c", "floating-point", "break"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1550641477, "post_id": 54779528, "comment_id": 96338026, "body": "That loop in the <code>main</code> function, when is it supposed to end? If you want to add a special condition that <code>break</code> the loop, why have a conditional loop anyway? Especially one that could lead to signed integer arithmetic overflow (which is <i>undefined behavior</i>)."}, {"owner": {"reputation": 75, "user_id": 4565702, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203899953366841/picture?type=large", "display_name": "Jay", "link": "https://stackoverflow.com/users/4565702/jay"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1550641617, "post_id": 54779528, "comment_id": 96338069, "body": "It is not.  It is left infinite on purpose to see how big the numbers get.  I am hoping that i can make it stop when a particular value appears"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1550641800, "post_id": 54779528, "comment_id": 96338139, "body": "It&#39;s only infinite in theory. In practice all integer values on a computer are limited. And as mentioned, arithmetic overflow of signed integers (which will happen with <code>n++</code> when you cross the limit of <code>int</code>) in C leads to undefined behavior."}, {"owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "edited": false, "score": 1, "creation_date": 1550641984, "post_id": 54779528, "comment_id": 96338201, "body": "you probably should at least check man(3) isinf() and fpclassify(), inf is not intend to be used as in your code."}, {"owner": {"reputation": 75, "user_id": 4565702, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203899953366841/picture?type=large", "display_name": "Jay", "link": "https://stackoverflow.com/users/4565702/jay"}, "edited": false, "score": 0, "creation_date": 1550642106, "post_id": 54779528, "comment_id": 96338247, "body": "Easy enough to put numbers in and make it stop.  Will do.  Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "is_accepted": false, "score": 4, "last_activity_date": 1550642934, "creation_date": 1550642934, "answer_id": 54779871, "question_id": 54779528, "link": "https://stackoverflow.com/questions/54779528/how-do-i-process-the-return-value-inf/54779871#54779871", "title": "How do I process the return value inf", "body": "<p>The simplest is to use <a href=\"https://en.cppreference.com/w/c/numeric/math/INFINITY\" rel=\"nofollow noreferrer\">INFINITY</a> or <a href=\"https://en.cppreference.com/w/c/numeric/math/isinf\" rel=\"nofollow noreferrer\">isinf()</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": false, "score": 1, "last_activity_date": 1550644300, "creation_date": 1550644300, "answer_id": 54780142, "question_id": 54779528, "link": "https://stackoverflow.com/questions/54779528/how-do-i-process-the-return-value-inf/54780142#54780142", "title": "How do I process the return value inf", "body": "<blockquote>\n  <p>largest Fibonacci number my machine can produce</p>\n</blockquote>\n\n<p>This question is not concerned with any data type but it is concerned with <strong>machine</strong>.</p>\n\n<p>The basic rule of fibonacci is this:</p>\n\n<p><code>n = (n-1) + (n-2)</code></p>\n\n<p>You can take a big sized <code>unsigned long long</code> variable and you can keep on adding. But what if that datatype is overflowed? You are not concerned with data type. Your machine may produce a number even bigger than the <code>long long</code>. What would that number be ? Entire bits on RAM? Hard Disk ?</p>\n\n<p>Since you are required to use an iterative method and not recursive method, your teacher/book/instructor might be testing you on loops (and not any standard API). Below is sample code using <code>unsigned long long</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n\n  unsigned long long a = 0;\n  unsigned long long b = 1;\n\n  unsigned long long c = a + b;\n\n\n  while(c &gt;= b)\n  {\n     a = c;\n     c = b + c;\n     b = a;\n  }\n\n  printf(\"\\n%llu\\n\", b);\n\n  return 0;\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p><code>12200160415121876738</code></p>\n"}, {"comments": [{"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 1, "creation_date": 1550646645, "post_id": 54780322, "comment_id": 96340074, "body": "The explanation is wrong. This works because <code>Inf - Inf</code> produces <code>Nan</code>, which is unequal to everything, including itself."}, {"owner": {"reputation": 70, "user_id": 10989826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6ad39a278c350ecfe620848b074ec7?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/10989826/curious-student"}, "reply_to_user": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1550647264, "post_id": 54780322, "comment_id": 96340321, "body": "@AlexeyFrunze it turns out that you are correct, there is no need to typecast one of <code>temp</code>s. An if condition like <code>(temp - temp != 0)</code> or just <code>(temp - temp != any_number)</code> seems to do the job since all of them produce <code>Nan</code>."}], "tags": [], "owner": {"reputation": 70, "user_id": 10989826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6ad39a278c350ecfe620848b074ec7?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/10989826/curious-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1550647702, "last_edit_date": 1550647702, "creation_date": 1550645014, "answer_id": 54780322, "question_id": 54779528, "link": "https://stackoverflow.com/questions/54779528/how-do-i-process-the-return-value-inf/54780322#54780322", "title": "How do I process the return value inf", "body": "<p>Just did a little search and found this nice trick:</p>\n\n<pre><code>...\ndouble value, temp; // Value of the series for the number input\n\nwhile (n &gt;= 0)\n{\n\n   // Call fibo function\n\n   temp = fibo(n);\n   if (temp - temp != 0)\n        break;\n   else\n        value=temp;\n...\n</code></pre>\n\n<p>well it turns out that whats happening is when temp hits <code>Inf</code> the if condition <code>temp - temp</code> produces <code>Nan</code> which equals nothing and the rest is just executing <code>break;</code> to exit the process.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1550849939, "last_edit_date": 1550849939, "creation_date": 1550848379, "answer_id": 54830044, "question_id": 54779528, "link": "https://stackoverflow.com/questions/54779528/how-do-i-process-the-return-value-inf/54830044#54830044", "title": "How do I process the return value inf", "body": "<blockquote>\n  <p>I want to to break when the output gives me the first instance of : <code>inf</code></p>\n</blockquote>\n\n<p>Simply test against <code>INFINITY</code> from <code>&lt;math.h&gt;</code>.  The output will not be an <em>exact</em> <a href=\"https://en.wikipedia.org/wiki/Fibonacci_number\" rel=\"nofollow noreferrer\">Fibonacci number</a>.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void) {\n  double a;\n  double b = 0;\n  double c = 1;\n  do {\n    a = b;\n    b = c;\n    c = a + b;\n  } while (c &lt; INFINITY);\n  printf(\"%e\\n\", b);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>1.306989e+308\n</code></pre>\n\n<p><strong><code>long double</code></strong></p>\n\n<p>Use the widest floating point type and look for an inexact addition.</p>\n\n<pre><code>#include &lt;fenv.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void) {\n  long double a;\n  long double b = 0;\n  long double c = 1;\n  do {\n    a = b;\n    b = c;\n    c = a + b;\n  } while (fetestexcept(FE_INEXACT) == 0);\n  printf(\"%.0Lf\\n\", b);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>12200160415121876738\n</code></pre>\n\n<p><strong>Integers</strong></p>\n\n<p>Use the widest type available.  This is akin to <a href=\"https://stackoverflow.com/a/54780142/2410359\">@Syed.Waris</a> <code>unsigned long long</code> approach.   Although common that <code>unsigned long long</code> and <code>uintmax_t</code> have the same range, using <code>uintmax_t</code> insures the widest.</p>\n\n<blockquote>\n  <p><code>uintmax_t</code>: The following type designates an unsigned integer type capable of representing any value of any unsigned integer type:</p>\n</blockquote>\n\n<pre><code>  #include &lt;stdint.h&gt;\n  #include &lt;stdio.h&gt;\n\n  uintmax_t a;\n  uintmax_t b = 0;\n  uintmax_t c = 1;\n\n  do {\n    a = b;\n    b = c;\n    c = a + b;\n  } while(c &gt;= b);\n  printf(\"%ju\\n\", b);\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>12200160415121876738\n</code></pre>\n\n<p><strong>String</strong></p>\n\n<p>An alternative to <code>double</code> or some <code>int</code> type, is to create a simple <em>string</em> add function <a href=\"https://stackoverflow.com/a/34360258/2410359\">str_add()</a>, then quite easy to form <em>large</em> Fibonacci numbers.</p>\n\n<pre><code>int main(void) {\n  char fib[3][4000];\n  strcpy(fib[0], \"0\");\n  strcpy(fib[1], \"1\");\n  int i;\n  for (i = 2; i &lt;= 17127 &amp;&amp; strlen(fib[1])  &lt; sizeof fib[1] - 1; i++) {\n    printf(\"Fib(%3d) %s.\\n\", i, str_add(fib[2], fib[1], fib[0]));\n    strcpy(fib[0], fib[1]);\n    strcpy(fib[1], fib[2]);\n  }\n  printf(\"%zu\\n\", strlen(fib[2]));\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Fib(1476) 13069...(299 digits)....71632.  // Exact max `double`\nFib(17127) 95902...(3569 digits)...90818.\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4565702, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203899953366841/picture?type=large", "display_name": "Jay", "link": "https://stackoverflow.com/users/4565702/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 54830044, "answer_count": 4, "score": 2, "last_activity_date": 1550849939, "creation_date": 1550641334, "last_edit_date": 1550667694, "question_id": 54779528, "link": "https://stackoverflow.com/questions/54779528/how-do-i-process-the-return-value-inf", "title": "How do I process the return value inf", "body": "<p>I working through a book on C on my own.  This isn't homework to be turned in. I am writing a C program to determine the largest Fibonacci number my machine can produce.  And instructed to use a nonrecursive method.  </p>\n\n<p>My Code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\ndouble fibo(int n);\nint main(void)\n{\n    int n = 0; // The number input by the user\n    double value; // Value of the series for the number input\n\n    while (n &gt;= 0)\n    {\n\n       // Call fibo function\n\n       value = fibo(n);\n\n       // Output the value\n\n       printf(\"For %d the value of the fibonacci series = %.0f\\n\", n, \n       value);\n\n\n       n++;\n\n    }\n\n   return 0;\n}\n\ndouble fibo(int n)\n{\n\n  int i; // For loop control variable\n  double one = 0; // First term\n  double two = 1; // Second term\n  double sum = 0; // placeholder\n\n  if (n == 0)\n      return 0;\n  else if (n == 1)\n      return 1;\n  else\n  {\n     for (i = 2; i &lt;= n; i++)\n     {\n        sum = one + two;\n        one = two;\n        two = sum;\n     }\n  }\n\nreturn sum;\n</code></pre>\n\n<p>Code works fine but I want to to break when the output gives me the fist instance of :</p>\n\n<pre><code>For 17127 the value of the fibonacci series = inf\n</code></pre>\n\n<p>Is there way to us an if statement like:</p>\n\n<pre><code>if (value == inf)\n  break;\n</code></pre>\n"}, {"tags": ["c", "gdb"], "answers": [{"tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": true, "score": 2, "last_activity_date": 1550641657, "creation_date": 1550641657, "answer_id": 54779593, "question_id": 54779014, "link": "https://stackoverflow.com/questions/54779014/gdb-continue-after-attach/54779593#54779593", "title": "gdb continue after attach", "body": "<p>Make two terminals: 1 and 2.</p>\n\n<p>Do the following steps:</p>\n\n<ol>\n<li>In Terminal 1, <code>gdb p1</code>. <code>break foo</code>.</li>\n<li>In Terminal 1, <code>run</code>.</li>\n<li>The break point will be hit in p1 and p1 will pause.</li>\n<li>Now the process p2 would be running (since p1 has started running).</li>\n<li>In the terminal 2. open gdb and attach p2. Add breakpoint in p2.</li>\n<li><code>continue</code> in terminal 1. And change to terminal 2.</li>\n<li>You will see that break point is hit in p2 at <code>bar</code>.</li>\n</ol>\n\n<p>This is based on assumption that <code>bar</code> in <code>p2</code> will always be hit after <code>foo</code> in <code>p1</code>.</p>\n"}], "owner": {"reputation": 189, "user_id": 3833632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4d03e486c974c270e094e1072b5ded28?s=128&d=identicon&r=PG&f=1", "display_name": "CalebK", "link": "https://stackoverflow.com/users/3833632/calebk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 54779593, "answer_count": 1, "score": 2, "last_activity_date": 1550641657, "creation_date": 1550637920, "question_id": 54779014, "link": "https://stackoverflow.com/questions/54779014/gdb-continue-after-attach", "title": "gdb continue after attach", "body": "<p>I am debugging a program with multiple processes using GDB. There are two different processes involved all launched by the main program. Lets call them p1 (the process that is started on and eventually launches p2) p2 (the process that is launched and I want to attach to)</p>\n\n<p>The trick is that I need to attach to p2 and break at a point in its process ONLY after a break point in p1.</p>\n\n<p>So essentially I find myself doing:</p>\n\n<pre><code>gdb p1\n(gdb) break foo\n(gdb) attach &lt;pid of p2&gt;\n(gdb) break bar\n</code></pre>\n\n<p>Where pid is determined by running a <code>ps</code> command in another tab while p1 is broken. </p>\n\n<p>The problem with this is that when I attach to p2 p1 is still broken. Really the continue, attach, and new breakpoints need to all be done simultaniously. How do I do this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "edited": false, "score": 2, "creation_date": 1550635811, "post_id": 54778665, "comment_id": 96336491, "body": "remove max=min=grade in the while loop"}, {"owner": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "edited": false, "score": 0, "creation_date": 1550636060, "post_id": 54778665, "comment_id": 96336548, "body": "Really no reason to set max to 100, prior to setting it to the input. Once you get this working, you could get feedback on it on Code Review."}, {"owner": {"reputation": 47, "user_id": 10991234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9YwVZ.png?s=128&g=1", "display_name": "CTrainee", "link": "https://stackoverflow.com/users/10991234/ctrainee"}, "reply_to_user": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "edited": false, "score": 0, "creation_date": 1550636147, "post_id": 54778665, "comment_id": 96336569, "body": "Removing the max=min-grade in the while loop actually got it to work! Thank you!"}, {"owner": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "edited": false, "score": 0, "creation_date": 1550636179, "post_id": 54778665, "comment_id": 96336574, "body": "You&#39;re welcome."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 10973714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fFjJ.jpg?s=128&g=1", "display_name": "heeat", "link": "https://stackoverflow.com/users/10973714/heeat"}, "is_accepted": true, "score": 1, "last_activity_date": 1550637018, "last_edit_date": 1550637018, "creation_date": 1550636267, "answer_id": 54778767, "question_id": 54778665, "link": "https://stackoverflow.com/questions/54778665/displaying-highest-and-lowest-number-values-in-c/54778767#54778767", "title": "Displaying highest and lowest number values in C", "body": "<p>In the while loop you are mentioning <em>min=max=grade</em> the second time in the program.\nThat is taking the value of -1 from grade which is used to stop the program.\nPlease comment that line and try it should work.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 7022445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KSGci.jpg?s=128&g=1", "display_name": "monkSinha", "link": "https://stackoverflow.com/users/7022445/monksinha"}, "is_accepted": false, "score": 0, "last_activity_date": 1550636297, "creation_date": 1550636297, "answer_id": 54778773, "question_id": 54778665, "link": "https://stackoverflow.com/questions/54778665/displaying-highest-and-lowest-number-values-in-c/54778773#54778773", "title": "Displaying highest and lowest number values in C", "body": "<p>Here:</p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n\nint main()\n{\n    unsigned int counter;\n   float average;\n    int grade, total, max, min;\n\n    total=0;\n   counter=0;\n   max=100;\n   min=0;\n\n   printf(\"Please enter grades, enter -1 to stop\\n\");\n   scanf (\"%d\", &amp;grade);\n   max=min=grade;\n\n   while ( grade !=-1 ) \n  {\n       total = total+ grade;\n       counter= counter +1;\n       if (grade &gt; max)\n        {\n         max = grade;\n        }\n       if (grade &lt; min)\n        {\n         min = grade;\n        }\n       printf(\"Please enter grades, enter -1 to stop\\n\");\n   scanf (\"%d\", &amp;grade);\n\n   }\n\nif ( counter !=0 ) \n{\n    average = (float) total / counter;\n    printf(\"Your average is %.2f\\n\",average);\n    printf(\"Your highest grade is %d\\n\", max);\n    printf(\"Your lowest grade is %d\\n\", min);\n}\n\n  else \n{\n      printf(\"No grades were entered\\n\");\n  }\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10991234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9YwVZ.png?s=128&g=1", "display_name": "CTrainee", "link": "https://stackoverflow.com/users/10991234/ctrainee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "accepted_answer_id": 54778767, "answer_count": 2, "score": 1, "last_activity_date": 1550637018, "creation_date": 1550635559, "last_edit_date": 1550636082, "question_id": 54778665, "link": "https://stackoverflow.com/questions/54778665/displaying-highest-and-lowest-number-values-in-c", "title": "Displaying highest and lowest number values in C", "body": "<p>I am new to programming and I am trying to finish a programming exercise in which the teacher (user) will input grades and will be continuously prompted to do so until they enter \"-1.\" When it is entered, the prompt will end and it should output the average of all user-inputted grades, along with the highest and lowest grade inputted.</p>\n\n<p>Here is the code I have so far.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    unsigned int counter;\n   float average;\n    int grade, total, max, min;\n\n    total=0;\n   counter=0;\n   max=100;\n   min=0;\n\n   printf(\"Please enter grades, enter -1 to stop\\n\");\n   scanf (\"%d\", &amp;grade);\n   max=min=grade;\n\n   while ( grade !=-1 ) {\n       total = total+ grade;\n       counter= counter +1;\n       if (grade &gt; max)\n       max = grade;\n       if (grade &lt; min)\n       min = grade;\n       printf(\"Please enter grades, enter -1 to stop\\n\");\n   scanf (\"%d\", &amp;grade);\n   max=min=grade;\n   }\n\nif ( counter !=0 ) {\n    average = (float) total / counter;\n    printf(\"Your average is %.2f\\n\",average);\n    printf(\"Your highest grade is %d\\n\", max);\n    printf(\"Your lowest grade is %d\\n\", min);\n}\n  else {\n      printf(\"No grades were entered\\n\");\n  }\n\n}\n</code></pre>\n\n<p>Here is an example input that results from the code:</p>\n\n<pre><code>Please enter grade, enter -1 to stop                                                                            \n95                                                                                                              \nPlease enter grade, enter -1 to stop                                                                            \n87                                                                                                              \nPlease enter grade, enter -1 to stop                                                                            \n-1                                                                                                              \nYour average is 91.00                                                                                           \nYour highest grade is -1                                                                                        \nYour lowest grade is -1    \n</code></pre>\n\n<p>I cannot figure out why it wont display the proper values, with 95 being the highest and 87 being the lowest in this case. I would appreciate any help since it is the only part of the program I need to solve.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "string-literals", "char-pointer"], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 4, "last_activity_date": 1550635668, "creation_date": 1550635668, "answer_id": 54778688, "question_id": 54778650, "link": "https://stackoverflow.com/questions/54778650/can-a-string-literal-be-concatenated-with-a-char/54778688#54778688", "title": "Can a string literal be concatenated with a char*?", "body": "<p>No. Concatenation of string literals is performed during translation (compilation). The operation you are requesting must be done within the program when it is executing. There is no provision for doing it automatically; you must write code to allocate space for the resulting string and to perform the concatenation.</p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 3, "last_activity_date": 1550635676, "creation_date": 1550635676, "answer_id": 54778690, "question_id": 54778650, "link": "https://stackoverflow.com/questions/54778650/can-a-string-literal-be-concatenated-with-a-char/54778690#54778690", "title": "Can a string literal be concatenated with a char*?", "body": "<p>No. Adjacent string literals being concatenated is a capability of the compiler, which treats adjacent string literals as one string literal, in order to help coders write readable code (in case of a large string literal that would not fit on a line nicely).</p>\n\n<p>C as a language does not have a concatenation operator, the closest you can get to it is a function (<code>strncat</code>, <code>strcat</code>. <code>strcpy</code>, <code>memcpy</code>).</p>\n"}], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 54778688, "answer_count": 2, "score": 0, "last_activity_date": 1550649341, "creation_date": 1550635415, "last_edit_date": 1550649341, "question_id": 54778650, "link": "https://stackoverflow.com/questions/54778650/can-a-string-literal-be-concatenated-with-a-char", "title": "Can a string literal be concatenated with a char*?", "body": "<p>I know that in C adjacent string literals are concatenated. I want to know, are adjacent string literals concatenated with char*s?</p>\n\n<p>The reason I'm asking this question is because I want to pass a concatenation of two strings to <code>perror()</code>, and one of the strings is not known in advance so I have to use a <code>char*</code>.</p>\n\n<pre><code>perror(\"error opening \" \"file.txt\");  // string literals are concatenated\n\nchar* filename = \"file.txt\";  // or some other file\nperror(\"error opening \" filename);    // will this work?\n</code></pre>\n"}, {"tags": ["c", "g++", "exec", "ping"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550646618, "post_id": 54778648, "comment_id": 96340061, "body": "there are three (3) kinds of returns from the function: <code>fork()</code>  1) &lt;0 means an error occurred  ==0 means in child process  3) &gt;0 means in the parent process.  The posted code fails to check for the failure condition"}, {"owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "edited": false, "score": 0, "creation_date": 1550648491, "post_id": 54778648, "comment_id": 96340928, "body": "So what is the problem you are facing? Mention the problem&#39;s location and description please"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11087859, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218673779702795/picture?type=large", "display_name": "Will Athanas", "link": "https://stackoverflow.com/users/11087859/will-athanas"}, "edited": false, "score": 0, "creation_date": 1550652987, "post_id": 54780939, "comment_id": 96343195, "body": "I get four errors that say:       desktop.cpp:9:9: warning: conversion from string literal to &#39;char *&#39; is deprecated [-Wc++11-compat-deprecated-writable-strings]  &quot;-c&quot;, ^."}, {"owner": {"reputation": 1, "user_id": 11087859, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218673779702795/picture?type=large", "display_name": "Will Athanas", "link": "https://stackoverflow.com/users/11087859/will-athanas"}, "edited": false, "score": 0, "creation_date": 1550653105, "post_id": 54780939, "comment_id": 96343246, "body": "Then, I get three errors that say:    desktop.cpp:25:14: error: use of undeclared identifier &#39;perror&#39;              perror( &quot;fork failed&quot; );              ^ desktop.cpp:26:20: error: use of undeclared identifier &#39;EXIT_FAILURE&#39;              exit( EXIT_FAILURE );"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 1, "user_id": 11087859, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218673779702795/picture?type=large", "display_name": "Will Athanas", "link": "https://stackoverflow.com/users/11087859/will-athanas"}, "edited": false, "score": 0, "creation_date": 1550680234, "post_id": 54780939, "comment_id": 96360312, "body": "&#39;perror()` is prototyped in the header file: <code>stdio.h</code>.  <code>exit()&#39; and </code>EXIT_FAILURE` are prototyped/defined in the header file: <code>stdlib.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 1, "user_id": 11087859, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218673779702795/picture?type=large", "display_name": "Will Athanas", "link": "https://stackoverflow.com/users/11087859/will-athanas"}, "edited": false, "score": 0, "creation_date": 1550680390, "post_id": 54780939, "comment_id": 96360399, "body": "The comment about: <code>9:9...</code> is missing the echo of which actual line is being referred to.  Please post the whole error message"}, {"owner": {"reputation": 1, "user_id": 11087859, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218673779702795/picture?type=large", "display_name": "Will Athanas", "link": "https://stackoverflow.com/users/11087859/will-athanas"}, "edited": false, "score": 0, "creation_date": 1550705700, "post_id": 54780939, "comment_id": 96371697, "body": "I got rid of most errors, hoping you can help me figure out the issue with the current build."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 1, "user_id": 11087859, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218673779702795/picture?type=large", "display_name": "Will Athanas", "link": "https://stackoverflow.com/users/11087859/will-athanas"}, "edited": false, "score": 0, "creation_date": 1550731004, "post_id": 54780939, "comment_id": 96378275, "body": "Using the header files you used in the linked code, I changed: <code>int status; wait( &amp;status );</code>   to <code>wait( NULL );</code>  because of a complaint from the compiler about the variable <code>status</code> and the program compiled with no errors.  Your error message seems to be saying that it cannot find the function: <code>execv()</code> which is (about) line 33 in the linked code, not line 9  Are you sure your compiling the same code as your posting?"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1550647687, "creation_date": 1550647687, "answer_id": 54780939, "question_id": 54778648, "link": "https://stackoverflow.com/questions/54778648/how-to-use-exec-in-c-to-run-ping-multiple-times/54780939#54780939", "title": "How to use exec in c to run ping multiple times", "body": "<p>regarding:</p>\n\n<pre><code>char *args[2];\n\nargs[0] = \"ping 192.(hidden for privacy) -s 256 \";        \nargs[1] = NULL; \n</code></pre>\n\n<p>is not correct, the program <code>ping</code> is run by the shell and each string needs to be in a separate argument entry.</p>\n\n<p>Suggest:</p>\n\n<pre><code>int main( void )\n{\n    char *args[] = \n    {\n        \"bash\",\n        \"-c\",\n        \"ping\",\n        \"190\",\n        \"192...\",  // place the IP address here\n        \"-s\",\n        \"256\",\n        NULL\n    };\n\n\n    pid_t pid = fork();\n\n    switch( pid )\n    {\n         case -1:\n             // an error occurred\n             perror( \"fork failed\" );\n             exit( EXIT_FAILURE );\n             break;\n\n        case 0:\n            // in child process\n            execv( args[0], args );\n            // the exec* functions never return \n            // unless unable to generate \n            // the child process\n            perror( \"execv failed\" );\n            exit( EXIT_FAILURE );\n            break;\n\n        default:\n            int status;\n            wait( &amp;status );\n            break;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11087859, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218673779702795/picture?type=large", "display_name": "Will Athanas", "link": "https://stackoverflow.com/users/11087859/will-athanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1550647687, "creation_date": 1550635410, "question_id": 54778648, "link": "https://stackoverflow.com/questions/54778648/how-to-use-exec-in-c-to-run-ping-multiple-times", "title": "How to use exec in c to run ping multiple times", "body": "<p>I am trying to make a simple script to understand how to using the PING command for fun (taking a data security class at uni right now). I have the following code:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nint main( void )\n{\n    int status;\n    char *args[2];\n\n    args[0] = \"ping 192.(hidden for privacy) -s 256 \";        // first arg is the full path to the executable\n    args[1] = NULL;             // list of args must be NULL terminated\n\n    if ( fork() == 0 )\n        execv( args[0], args );\n    else\n        wait( &amp;status );       \n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1550627976, "post_id": 54777726, "comment_id": 96334825, "body": "<code>*</code> could be multiply if there is another int on the left to it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1550628132, "post_id": 54777726, "comment_id": 96334865, "body": "<code>&quot;Assume k is a pointer to an integer in C.&quot;</code> OK, ... <code>&quot;For the expression **k,.:</code> Wait... If <code>k</code> is a pointer to <code>int</code>, <code>*k</code> is an <code>int</code> and <code>**k</code> is nonsense. What are you trying to do?"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 2, "creation_date": 1550628231, "post_id": 54777726, "comment_id": 96334894, "body": "Your thought is (fundamentally) correct.  I would suggest providing the code the textbook says is correct."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 4, "creation_date": 1550629107, "post_id": 54777726, "comment_id": 96335081, "body": "You should show the <b>exact text</b> shown in your textbook."}], "answers": [{"comments": [{"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1550629640, "post_id": 54777872, "comment_id": 96335197, "body": "A quick test using <code>-std=gnu90</code> also failed to compile:  <code>int n=5; int*pN=&amp;n; void*pV=(void*)(**pN);</code>"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 5, "last_activity_date": 1550629653, "last_edit_date": 1550629653, "creation_date": 1550629088, "answer_id": 54777872, "question_id": 54777726, "link": "https://stackoverflow.com/questions/54777726/tricky-pointer-arithmetic-in-c-k/54777872#54777872", "title": "tricky Pointer arithmetic in C: **k", "body": "<p>The C 2018 standard says, in clause 6.5.3.2, paragraph 2, \u201cThe operand of the unary <code>*</code> operator shall have pointer type.\u201d If <code>k</code> is a pointer to an integer, then <code>*k</code> is an integer, which is not a pointer type, so it cannot be the operand of a unary <code>*</code> operator. Thus an expression such as <code>x = **k</code> violates this rule.</p>\n\n<p>The rule ins 6.5.3.2 2 is a constraint, meaning that a conforming compiler is required to produce a diagnostic message for and that the C standard does not define the behavior.</p>\n\n<p>Technically, a C compiler could, in addition to issuing the diagnostic message, accept the expression and define as it pleases. I am not aware of any that do so, and no common compiler does so.</p>\n\n<p>It is possible the characters <code>**k</code> might appear in some larger expression where they do not both act as unary <code>*</code> operators, such as in <code>x = y**k</code>, which is equivalent to <code>x = y * *k</code>, in which the first <code>*</code> is a binary multiplication operator. You should show the <strong>exact text</strong> shown in your textbook.</p>\n"}, {"tags": [], "owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1550704180, "last_edit_date": 1550704180, "creation_date": 1550633518, "answer_id": 54778387, "question_id": 54777726, "link": "https://stackoverflow.com/questions/54777726/tricky-pointer-arithmetic-in-c-k/54778387#54778387", "title": "tricky Pointer arithmetic in C: **k", "body": "<p>Beyond what the standard says, dereferencing an int fundamentally makes no sense.  Let's say the compiler is willing to assume that ints can be converted to directly to pointers (a BIG assumption).  What TYPE of pointer will the compiler assume it is?  The only safe assumption is <code>void*</code>.  And dereferencing a <code>void*</code> makes no sense because even when assigning to a known type, the <strong>type of pointer</strong> still matters:</p>\n\n<pre><code>  unsigned int n = 0xFFFFFFFF;\n  void *pN = &amp;n;\n  unsigned int fromIntPtr = *(unsigned int*)pN;\n  unsigned int fromCharPtr = *(unsigned char*)pN;\n  printf(\"%X\\n\", fromIntPtr);\n  printf(\"%X\\n\", fromCharPtr);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>FFFFFFFF\nFF\n</code></pre>\n\n<p>Lacking a type of pointer, the compiler could perhaps infer <code>unsigned int*</code> based on the LHS expression.  That's 1) a wildly stupid inference and 2) C doesn't really infer types.  (Shoving a typed RHS into a differently typed LHS value isn't inference :))</p>\n"}], "owner": {"reputation": 91, "user_id": 10977038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sdsmrB1QNPM/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNEYN3WX3jLCCO84G3dzPJuCfnlHg/mo/photo.jpg?sz=128", "display_name": "Fred", "link": "https://stackoverflow.com/users/10977038/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1550704180, "creation_date": 1550627870, "question_id": 54777726, "link": "https://stackoverflow.com/questions/54777726/tricky-pointer-arithmetic-in-c-k", "title": "tricky Pointer arithmetic in C: **k", "body": "<p>Assume k is a pointer to an integer in C.</p>\n\n<p>For the expression **k, when we try to evaluate this on the right side of an assignment operator(\"=\"), would the value be illegal? </p>\n\n<p>Here is my thought:</p>\n\n<p>**k is actually *(*k). When we dereference k, we get the value of an integer. Then we try to dereference an integer, which is an illegal operation. </p>\n\n<p>But my textbook says this expression on the right side is actually legal.</p>\n\n<p>Why so?</p>\n"}, {"tags": ["c", "linked-list"], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 74, "user_id": 11072731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d1486389826d5e5ac821b49b23d48a?s=128&d=identicon&r=PG&f=1", "display_name": "vksdbvksbvk", "link": "https://stackoverflow.com/users/11072731/vksdbvksbvk"}, "edited": false, "score": 0, "creation_date": 1550629067, "post_id": 54777702, "comment_id": 96335071, "body": "@vksdbvksbvk Glad I could help.  Feel free to <a href=\"https://stackoverflow.com/help/accepted-answer\">accept this answer</a> if you found it useful."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1550627701, "creation_date": 1550627701, "answer_id": 54777702, "question_id": 54777617, "link": "https://stackoverflow.com/questions/54777617/linked-list-array-type-name-aka-char-41-is-not-assignable/54777702#54777702", "title": "Linked List Array type &#39;NAME&#39; (aka &#39;char [41]&#39;) is not assignable", "body": "<p>This is not the correct way to compare strings:</p>\n\n<pre><code>if (p-&gt;name == name) {\n</code></pre>\n\n<p>This compares the pointer address stored in <code>name</code> with the address of the first element of <code>p-&gt;name</code>.  This will always be false.  To compare strings you need the <code>strcmp</code> function:</p>\n\n<pre><code>if (strcmp(p-&gt;name,name) == 0) {\n</code></pre>\n\n<p>While this is a problem, it is unrelated to the error you got.  That is complaining about an assignment to the <code>name</code> field of a <code>struct list</code>.  Because this field is an array, you cannot assign to it.  What you probably want is <code>strcpy</code>, which is used for copying strings.  For example:</p>\n\n<pre><code>strcpy(p-&gt;name, \"my name\");\n</code></pre>\n"}], "owner": {"reputation": 74, "user_id": 11072731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d1486389826d5e5ac821b49b23d48a?s=128&d=identicon&r=PG&f=1", "display_name": "vksdbvksbvk", "link": "https://stackoverflow.com/users/11072731/vksdbvksbvk"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1550752436, "accepted_answer_id": 54777702, "answer_count": 1, "score": -1, "last_activity_date": 1550627701, "creation_date": 1550627249, "question_id": 54777617, "link": "https://stackoverflow.com/questions/54777617/linked-list-array-type-name-aka-char-41-is-not-assignable", "closed_reason": "Duplicate", "title": "Linked List Array type &#39;NAME&#39; (aka &#39;char [41]&#39;) is not assignable", "body": "<p>I am searching a name on linked list but I am having some issues</p>\n\n<p>these are the structures</p>\n\n<pre><code>typedef struct list\n{\n    void *data;\n    struct list *next;\n} LIST;\n</code></pre>\n\n<pre><code>typedef char NAME[41];\n\n\n/*\nirrelevant structure here\n\n*/\n\n\ntypedef struct person\n{\n    NAME name;\n    int age;\n    float height;\n    DATE bday;\n} PERSON;\n</code></pre>\n\n<p>here is the function to find the person</p>\n\n<pre><code>PERSON *findPersonInDatabase(char *name)\n{\n    LIST *current = head;\n    if (current == NULL) {\n        printf(\"empty fam\");\n    }\n\n    // PERSON* tryout;\n    // tryout-&gt;name = name;\n\n    while (current != NULL) {\n        PERSON* p = (PERSON*) current-&gt;data;\n\n        if (p-&gt;name == name) {\n            printf(\"please\");\n            return p;\n        }\n    }\n\n    return NULL;\n}\n</code></pre>\n\n<p>I Believe the problem I am having is related to this\nwhen I check whether or data stored in type NAME == type char* it just does not work but when I print out the data inside these types I get the value I am looking for. My question is how can I make this work ?</p>\n"}, {"tags": ["c", "embedded", "bit-shift", "usart"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1550627368, "post_id": 54777567, "comment_id": 96334680, "body": "tl;dr. If there is an array and you only want to access values on 8 bit boundaries indexing a <code>char</code>-array (or a <code>char*</code> aliasing that thingy you want to access) is always more appropriate and easier to read than bit-shifting."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550627495, "post_id": 54777567, "comment_id": 96334705, "body": "Awesome. Thanks for the sanity check. I think I got tunnel-vision on this... bad brain... BAD... go sit in the corner and stop overthinking!!"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550627598, "post_id": 54777567, "comment_id": 96334737, "body": "take a rubber duck with you and have a great time in the corner then ;p"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1550647662, "post_id": 54777567, "comment_id": 96340519, "body": "Don&#39;t write code such as <code>usart-&gt;TXDATAX = (i == 0 ? (HPI_usart_data.txdata &amp; USART_TXDATA_DATABITS) : (HPI_usart_data.txdata &gt;&gt; SINGLE_BYTE_SHIFT) &amp; USART_TXDATA_DATABITS);</code>. This is dangerous, unreadable and needs to be split in several expressions."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1550648445, "post_id": 54777567, "comment_id": 96340906, "body": "@Swordfish A <code>char</code> array is entirely unsuitable to use for anything but strings. It should never be used for de-serializing a larger chunk of data. If attempted, the programmer will end up in implicit type promotion hell, when mixing bitwise operators with potentially signed <code>char</code>."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550654434, "post_id": 54777567, "comment_id": 96344008, "body": "@Lundin I have used uintN_t datatypes throughout my code. Also what do you mean by this is dangerous? It&#39;s a simple ternary operator with some bit-shifting. Everything is in it&#39;s own set of parenthesis to avoid any confusing precedence."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550664104, "post_id": 54777567, "comment_id": 96350065, "body": "@Medicineman25 Lundin is talking about integer promotion. There is a problem with <code>uint8_t</code>, though, it isn&#39;t allowed to alias other types unlike <code>char</code> and <code>char unsigned</code>."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550669455, "post_id": 54777567, "comment_id": 96353395, "body": "@Swordfish oh yeh I got the part about integer promotion, hence why I don&#39;t use those datatypes... was just confused about his comment that the ternary operator was dangerous. They aren&#39;t related are they?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550669684, "post_id": 54777567, "comment_id": 96353545, "body": "@Medicineman25 in my eyes that&#39;s no argument to not use <code>char unsigned</code>. you just have to know what you&#39;re doing. but that is true for all aspects of C. i don&#39;t know why the ternary operator should be considered &quot;dangerous&quot;."}, {"owner": {"reputation": 1300, "user_id": 1198066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a0a68dd4c4916fc2fd33708e595bf5?s=128&d=identicon&r=PG", "display_name": "Ross", "link": "https://stackoverflow.com/users/1198066/ross"}, "edited": false, "score": 0, "creation_date": 1550672226, "post_id": 54777567, "comment_id": 96355195, "body": "Lundin&#39;s comment about &quot;dangerous&quot; is that the line is difficult to decode at glance.  By smushing everything into a single line, you&#39;re not optimizing the code in any way (any even half-decent compiler will generate the same assembly for your ternary versus a full up if/else), but you&#39;re making all future maintainers of the code step carefully through the line, as there are complex operations in both the if and the else."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550712060, "post_id": 54777567, "comment_id": 96373142, "body": "I would disagree strongly with that assertion. Perhaps I could have improved the layout of each statement after every OR, perhaps as a new line and align the OR operators vertically, but the inability to read a simple ternary is no cause for alarm other than identifying an opportunity to teach the person who is unable to read the statement. Anyway I don&#39;t wanna start a flame-war, just offering a counter-opinion. Thank you for yours @Lundin :)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550734975, "post_id": 54777567, "comment_id": 96380052, "body": "@Swordfish Of course it is allowed to alias character types or the whole C standard falls apart. And that&#39;s usually how <code>uint8_t</code> is implemented, as a typedef to <code>unsigned char</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1550735236, "post_id": 54777567, "comment_id": 96380200, "body": "@Medicineman25 My comment is mostly about &quot;most operators on a single line wins a price&quot;. When you write a mess like that line, you have multiple implicit promotions taking place. Something around 8 of them. You took all those in account when you wrote that line? No? So bluntly put, you write code which you don&#39;t know what it does - buggy and dangerous. And yes, the ?: operator adds a little bit to that, by balancing the 2nd and 3rd operands against each other regardless of which one that is evaluated."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550735576, "post_id": 54777567, "comment_id": 96380380, "body": "For example if <code>HPI_usart_data.txdata</code> is of type <code>char</code>, <code>uint8_t</code>, <code>int</code> or <code>short</code>, you have a big portability bug sitting right there, getting wildly different results depending on if right shift is arithmetic or logical for the given system."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550735725, "post_id": 54777567, "comment_id": 96380462, "body": "@Lundin That&#39;s not what i said. I said <code>uintX_t</code> is not allowed to alias OTHER types. And if <code>uint8_t</code> is <code>char unsigned</code> or <code>int8_t</code> is <code>char</code> is not guaranteed and thus implementation-defined and not portable. duh. In general <code>uint8_t</code> and <code>int8_t</code> are NOT allowed to alias other types."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1550881451, "post_id": 54777567, "comment_id": 96448520, "body": "@Lundin Ah I see... I&#39;m not sure what implicit promotion you are referring to there, I would love to learn more if you could elaborate. For clarity, txdata is of type uint32_t, USART_TXDATA_DATABITS is a const uint8_t assigned the value 0xFF and  SINGLE_BYTE_SHIFT is just a preproc define of 8."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1550881615, "post_id": 54777567, "comment_id": 96448545, "body": "The way I read the logic is this: &quot;does i equal 0? if not, bitwise AND the 32bit member txdata, with an 8 bit constant, thus extracting 8 bits. else if i &gt; 0, shift the 32bit value to the right 8 bits in each loop iteration and cut off the next 8 bits. Shift the whole value to the right and tack the new 8 bits onto the 32 bit field."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1550881725, "post_id": 54777567, "comment_id": 96448566, "body": "However, rereading this logic, I realise that I should have bitshifted the actual struct member by 8 bits, prior assignment, in order to achieve the desired outcome of tacking on a new 8 bits to a 32 bit field. However that is not something that&#39;s been pointed out. So for now let&#39;s pretend I didn&#39;t make that logical error and the logic is sound. Where else is there fault in this ternary operator. I would love to learn more about why this isn&#39;t safe or portable. I definitely do not want to assume something is good quality and go about the world writing shitty code willy-nilly..."}], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1550654692, "post_id": 54781150, "comment_id": 96344174, "body": "Agreed. This is for a use-case where the code is very modular, and the gps layer I&#39;m using will be open sourced, so I need to take into account that not everyone will want to encode every 8/16-bit of data into a 32-bit field. Either way, it&#39;s a waste of power to encode and then immediately decode like this."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1550648478, "creation_date": 1550648478, "answer_id": 54781150, "question_id": 54777567, "link": "https://stackoverflow.com/questions/54777567/bitshifting-vs-array-indexing-which-is-more-appropriate-for-usart-interfaces-on/54781150#54781150", "title": "Bitshifting vs array indexing, which is more appropriate for usart interfaces on 32bit MCUs", "body": "<blockquote>\n  <p>Since it's a 32-bit MCU, I figured I might as well pass around 32-bit fields </p>\n</blockquote>\n\n<p>That's not really the programmer's call to make. Put the 8 or 16 bit variable in a struct. Let the compiler add padding if needed. Alternatively you can use <code>uint_fast8_t</code> and <code>uint_fast16_t</code>.</p>\n\n<blockquote>\n  <p>My question is this: bitshifting vs array indexing, which is more appropriate? </p>\n</blockquote>\n\n<p>Array indexing is for accessing arrays. If you have an array, use it. If not, then don't. </p>\n\n<p>While it is possible to chew through larger chunks of data byte by byte, such code must be written much more carefully, to prevent running into various subtle type conversion and pointer aliasing bugs.</p>\n\n<p>In general, bit shifting is preferred when accessing data up to the CPU's word size, 32 bits in this case. It is fast and also portable, so that you don't have to take endianess in account. It is the preferred method of serialization/de-serialization of integers.</p>\n"}], "owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 54781150, "answer_count": 1, "score": 1, "last_activity_date": 1550882197, "creation_date": 1550626922, "last_edit_date": 1550882197, "question_id": 54777567, "link": "https://stackoverflow.com/questions/54777567/bitshifting-vs-array-indexing-which-is-more-appropriate-for-usart-interfaces-on", "title": "Bitshifting vs array indexing, which is more appropriate for usart interfaces on 32bit MCUs", "body": "<p>I have an embedded project with a USART HAL. This USART can only transmit or receive 8 or 16 bits at a time (depending on the usart register I chose i.e. single/double in/out). Since it's a 32-bit MCU, I figured I might as well pass around 32-bit fields as (from what I have been lead to understand) this is a more efficient use of bits for the MPU. Same would apply for a 64-bit MPU i.e. pass around 64-bit integers. Perhaps that is misguided advice, or advice taken out of context. </p>\n\n<p>With that in mind, I have packed the 8 bits into a 32-bit field via bit-shifting. I do this for both tx and rx on the usart. </p>\n\n<p>The code for the 8-bit only register is as follows (the 16-bit register just has half the amount of rounds for bit-shifting):</p>\n\n<pre><code>int zg_usartTxdataWrite(USART_data*         MPI_buffer,\n                        USART_frameconf*    MPI_config,\n                        USART_error*        MPI_error)\n{\n\nMPI_error = NULL;\n\nif(MPI_config != NULL){\n    zg_usartFrameConfWrite(MPI_config);\n}\n\nHPI_usart_data.txdata = MPI_buffer-&gt;txdata;\n\n    for (int i = 0; i &lt; USART_TXDATA_LOOP; i++){\n        if((USART_STATUS_TXC &amp; usart-&gt;STATUS) &gt; 0){\n            usart-&gt;TXDATAX = (i == 0 ? (HPI_usart_data.txdata &amp; USART_TXDATA_DATABITS) : (HPI_usart_data.txdata &gt;&gt; SINGLE_BYTE_SHIFT) &amp; USART_TXDATA_DATABITS);\n        }\n        usart-&gt;IFC |= USART_STATUS_TXC;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>EDIT: RE-ENTERTING LOGIC OF ABOVE CODE WITH ADDED DEFINES FOR CLARITY OF TERNARY OPERATOR IMPLICIT PROMOTION PROBLEM DISCUSSED IN COMMENTS SECTION</p>\n\n<p>(the HPI_usart and USART_data structs are the same just different levels, I have since removed the HPI_usart layer, but for the sake of this example I will leave it in)</p>\n\n<pre><code>#define USART_TXDATA_LOOP 4\n#define SINGLE_BYTE_SHIFT 8\n\ntypedef struct HPI_USART_DATA{\n\n   ...\n   uint32_t txdata;\n   ...\n\n}HPI_usart\n\nHPI_usart HPI_usart_data = {'\\0'};\n\nconst uint8_t USART_TXDATA_DATABITS = 0xFF;\n\nint zg_usartTxdataWrite(USART_data*         MPI_buffer,\n                        USART_frameconf*    MPI_config,\n                        USART_error*        MPI_error)\n{\n\nMPI_error = NULL;\n\nif(MPI_config != NULL){\n    zg_usartFrameConfWrite(MPI_config);\n}\n\nHPI_usart_data.txdata = MPI_buffer-&gt;txdata;\n\n    for (int i = 0; i &lt; USART_TXDATA_LOOP; i++){\n        if((USART_STATUS_TXC &amp; usart-&gt;STATUS) &gt; 0){\n            usart-&gt;TXDATAX = (i == 0 ? (HPI_usart_data.txdata &amp; USART_TXDATA_DATABITS) : (HPI_usart_data.txdata &gt;&gt; SINGLE_BYTE_SHIFT) &amp; USART_TXDATA_DATABITS);\n        }\n        usart-&gt;IFC |= USART_STATUS_TXC;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>However, I now realize that this is potentially causing more issues than it solves because I am essentially internally encoding these bits which then have to be decoded almost immediately when they are passed through to/from different data layers. I feel like it's a clever and sexy solution, but I'm now trying to solve a problem that I shouldn't have created in the first place. Like how to extract variable bit fields when there is an offset i.e. in gps nmea sentences where the first 8 bits might be one relevant field and then the rest are 32bit fields. So it ends up being like this:</p>\n\n<p>32-bit array member 0:</p>\n\n<pre><code> bits 24-31      bits 15-23          bits 8-15            bits 0-7\n</code></pre>\n\n<p>|    8-bit Value   | 32-bit Value A, bits 24-31 | 32-bit Value A, bits 16-23 | 32-bit Value A, bits 8-15 |</p>\n\n<p>32-bit array member 1:</p>\n\n<pre><code> bits 24-31             bits 15-23           bits 8-15               bits 0-7\n</code></pre>\n\n<p>|    32-bit Value A, bits 0-7  | 32-bit Value B, bits 24-31 | 32-bit Value B, bits 16-23 | 32-bit Value B, bits 8-15 |</p>\n\n<p>32-bit array member 2:</p>\n\n<pre><code> bits 24-31        15-23 8-15 ...\n</code></pre>\n\n<p>|    32-bit Value B, bits 0-7  | etc... | .... | .... |</p>\n\n<p>The above example requires manual decoding, which is fine I guess, but it's different for every nmea sentence and just feels more manual than programmatic. </p>\n\n<p>My question is this: bitshifting vs array indexing, which is more appropriate? </p>\n\n<p>Should I just have assigned each incoming/outgoing value to a 32-bit array member and then just index that way? I feel like that is the solution since it would not only make it easier to traverse the data on other layers, but I would be able to eliminate all this bit-shifting logic and then the only difference between an rx or tx function would be the direction the data is going. </p>\n\n<p>It does mean a small rewrite of the interface and the resulting gps module layer, but that feels like less work and also a cheap lesson early on in my project. </p>\n\n<p>Also any thoughts and general experience on this would be great. </p>\n"}, {"tags": ["c", "arrays", "segmentation-fault"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1550625231, "post_id": 54777342, "comment_id": 96334197, "body": "Why are you casting the argument to <code>func</code>? You&#39;re passing in the incorrect type. Casting can&#39;t fix that."}, {"owner": {"reputation": 2014, "user_id": 2138219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KNoxN.jpg?s=128&g=1", "display_name": "francium", "link": "https://stackoverflow.com/users/2138219/francium"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550625375, "post_id": 54777342, "comment_id": 96334221, "body": "@tadman I&#39;m compiling with Wall and I get <code>-Wincompatible-pointer-types</code> otherwise. <code>note: expected &#39;int **&#39; but argument is of type &#39;int (*)[3]&#39;</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1550625408, "post_id": 54777342, "comment_id": 96334226, "body": "Yes, that&#39;s what you&#39;ve defined. An array of <code>int[3]</code>, not an array of <code>int*</code>. This is a huge difference. One is just three elements, the other is a pointer."}, {"owner": {"reputation": 2014, "user_id": 2138219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KNoxN.jpg?s=128&g=1", "display_name": "francium", "link": "https://stackoverflow.com/users/2138219/francium"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550625465, "post_id": 54777342, "comment_id": 96334241, "body": "@tadman Is my approach wrong then? I can&#39;t remove the 3&#39;s - it complains. Should I use malloc here?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550625498, "post_id": 54777342, "comment_id": 96334251, "body": "A pointer to a pointer to <code>int</code> is not a 2d array."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1550625615, "post_id": 54777342, "comment_id": 96334283, "body": "<code>int[3][3]</code> and <code>int**</code> are not inter-compatible. You might want to switch this to a single <code>3*3</code>-sized array as honestly multidimensional arrays in C are an utter nightmare, not only from a code perspective but also from how they require <i>N+1</i> pointers instead of 1 and can scatter your data all over the heap."}, {"owner": {"reputation": 2014, "user_id": 2138219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KNoxN.jpg?s=128&g=1", "display_name": "francium", "link": "https://stackoverflow.com/users/2138219/francium"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550625638, "post_id": 54777342, "comment_id": 96334287, "body": "@Swordfish What would be the correct approach based on what I&#39;m trying to do? My underlying question, that I&#39;ve omitted for the sake of simplicity here, has to go with passing a 2D array via a struct to another thread and then accessing elements on it. I figured if I can figure out how to access things on an <code>int **</code> I would solve that problem too."}, {"owner": {"reputation": 2014, "user_id": 2138219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KNoxN.jpg?s=128&g=1", "display_name": "francium", "link": "https://stackoverflow.com/users/2138219/francium"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550625755, "post_id": 54777342, "comment_id": 96334311, "body": "@tadman Good to know. I&#39;m lacking the experience in C to know the best approach and figured pointer to a pointer was the best approach. I&#39;ll switch to a single 3*3 array. Thanks"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1550625801, "post_id": 54777342, "comment_id": 96334327, "body": "By comparison C++ has far better support for this sort of thing, but C, being much more low-level, expects you to to organize things a certain way or deal with the complexity yourself. <code>int[3][3]</code> has a memory layout similar to <code>int[3*3]</code>, there&#39;s no intermediate pointers. It&#39;s not equivalent to <code>int**</code>."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550625844, "post_id": 54777342, "comment_id": 96334336, "body": "@tadman <i>but also from how they require N+1 pointers instead of 1 and can scatter your data all over the heap.</i> \u2013 what you&#39;re describing isn&#39;t a 2d-array either."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550625933, "post_id": 54777342, "comment_id": 96334362, "body": "@tadman i&#39;d call a pointer to an array of pointers to array a jagged array."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550625957, "post_id": 54777342, "comment_id": 96334369, "body": "@Swordfish Like everything in C it&#39;s got a lot of sharp edges."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1550626218, "post_id": 54777342, "comment_id": 96334427, "body": "@tadman <i>but an array of arrays</i> \u2013 an array of arrays is a 2d-array (<code>T foo[COLUMNS][ROWS]</code>) but a pointer to one or more pointers to <code>T</code> is something different. Sorry for being that picky but i can&#39;t stand it when people mix those things up."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550626251, "post_id": 54777342, "comment_id": 96334432, "body": "@Swordfish That&#39;s a much better explanation."}, {"owner": {"reputation": 2014, "user_id": 2138219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KNoxN.jpg?s=128&g=1", "display_name": "francium", "link": "https://stackoverflow.com/users/2138219/francium"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550626438, "post_id": 54777342, "comment_id": 96334479, "body": "@Swordfish so if I understand you correctly. You&#39;re saying [[0, 1], [2, 3]] is a 2d array, but [0x1230, 0x1238], where 0x1230 contains [0, 1] and same for 0x1238, is something different. Is my understanding of this correct? The big difference being 2d array is a contiguous block of memory, but a pointer to a pointer of T could be anywhere in memory."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550626717, "post_id": 54777342, "comment_id": 96334537, "body": "@tadman multidimensional arrays do not require <code>N+1</code> pointers and also allocate the data contiguously. I get what you mean, but just not the right term."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1550626805, "post_id": 54777342, "comment_id": 96334554, "body": "<code>func(int **arr, int s)</code> --&gt; <code>func(int arr[][3], int s)</code>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1550626828, "post_id": 54777342, "comment_id": 96334559, "body": "@chux One chux for the rescue ;) one more thing to say: <code>func(int arr[][3], int s)</code> is exactly the same as <code>func(int *arr[3], int s)</code>."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1550627152, "post_id": 54777342, "comment_id": 96334627, "body": "Might be helpful: <a href=\"https://parrt.cs.usfca.edu/doc/how-to-read-C-declarations.html\" rel=\"nofollow noreferrer\">How to Read C Declarations</a> and <a href=\"https://cdecl.org/\" rel=\"nofollow noreferrer\">cdecl: C gibberish \u2194 English</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550627306, "post_id": 54777342, "comment_id": 96334665, "body": "Try <code>void func(int s, int arr[s][s]) {</code>  (C99)"}, {"owner": {"reputation": 2014, "user_id": 2138219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KNoxN.jpg?s=128&g=1", "display_name": "francium", "link": "https://stackoverflow.com/users/2138219/francium"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1550627459, "post_id": 54777342, "comment_id": 96334695, "body": "@chux Thanks for the suggestion, but I did use that but it doesn&#39;t fit in my real world situation. my real situation was on in which I&#39;m passing a 2d array to a thread via a struct. I didn&#39;t know how to pass an actual arr[s][s] type via a struct or how to case a (int <i>*) back into a arr[s][s] without the compiler complaining, so I figured a (int **) was my best bet. I&#39;ve followed the advice given here and used a 1d array of size s</i>s and that has worked perfectly for my situation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550627672, "post_id": 54777342, "comment_id": 96334753, "body": "&quot;I didn&#39;t know how to pass an actual <code>arr[s][s]</code> type&quot; --&gt; My suggest was not to <i>pass</i>  a <code>arr[s][s]</code>, but to use <code>arr[s][s]</code> as the receiving parameter.  Just call as <code>func(3, arr)</code>.  Better, post a more complete example of what your need."}, {"owner": {"reputation": 401, "user_id": 7926640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15aaf0885ac6a86de3d42c23139abdb2?s=128&d=identicon&r=PG&f=1", "display_name": "stensal", "link": "https://stackoverflow.com/users/7926640/stensal"}, "edited": false, "score": 0, "creation_date": 1550628207, "post_id": 54777342, "comment_id": 96334887, "body": "You can define the array as a field of your struct.  this is a live test of this approach: <a href=\"https://https://segfault.stensal.com/a/KTH9up3OKUzNsHpd\" rel=\"nofollow noreferrer\">https://segfault.stensal.com/a/KTH9up3OKUzNsHpd</a>"}], "owner": {"reputation": 2014, "user_id": 2138219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KNoxN.jpg?s=128&g=1", "display_name": "francium", "link": "https://stackoverflow.com/users/2138219/francium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1550626768, "answer_count": 0, "score": 0, "last_activity_date": 1550625160, "creation_date": 1550625160, "question_id": 54777342, "link": "https://stackoverflow.com/questions/54777342/iterating-over-a-2d-array-int-causes-segmentation-fault-in-c", "closed_reason": "Duplicate", "title": "Iterating over a 2D array (int **) causes segmentation fault in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nvoid func(int **arr, int s) {\n    for (int i = 0; i &lt; s; i++) {\n        for (int j = 0; j &lt; s; j++) {\n            printf(\"%d\\n\", arr[i][j]);\n        }\n    }\n    printf(\"\\n\");\n}\n\nint main() {\n    int arr[3][3] = {\n        {11, 12, 13},\n        {21, 22, 23},\n        {31, 32, 33},\n    };\n    func((int**)arr, 3);\n}\n</code></pre>\n\n<p>In this code I'm trying to pass a 2D array to another function and have the second function print out all it's values. I've chosen to specify the array as a <code>int **</code> in the signature of the function (loosely following the <a href=\"https://stackoverflow.com/a/3912959/2138219\">second method specified in this example</a>).</p>\n\n<p>When I run this code I expect it to be able to print out all the items, but instead it seg faults and I'm not sure why. I've tried debugging it, but gdb points me  to the <code>printf</code>'s array access in the <code>func</code> function, but I already suspected that's the cause. There is obviously a discrepency between what I think the memory looks like and how i'm trying to access it and how it's actaully being accessed (or what's being accessed).</p>\n"}, {"tags": ["c", "arguments", "structure"], "comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550623157, "post_id": 54777052, "comment_id": 96333766, "body": "What is <code>tam</code>? Maybe a helpful name would help understand what you want to do. Also serves as documentation for the code. <code>a</code> is also a bad name for <code>struct Person</code> I think"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550623247, "post_id": 54777052, "comment_id": 96333789, "body": "You remove the &#39;*&#39;.  But then you have a <i>different</i> problem: whole arrays such as <code>a[i].name</code> cannot be assigned to.  In that particular case, perhaps you want <code>strcpy()</code>."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550623338, "post_id": 54777052, "comment_id": 96333812, "body": "Please show the full function that contains the for loop.  Is it supposed to be part of <code>add()</code>?"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550624101, "post_id": 54777052, "comment_id": 96333987, "body": "@CacahueteFrito yes the <code>for</code> loop is inside the <code>add()</code> function, and <code>*tam</code> variable is just to count the size of  the structure array"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550624194, "post_id": 54777052, "comment_id": 96334002, "body": "@JohnBollinger probably you mean <code>strncpy()</code>.  Usually you should avoid <code>strcpy()</code>"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550624377, "post_id": 54777052, "comment_id": 96334030, "body": "@JohnBollinger If I have to modify a array member the way is strncpy()?"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550624389, "post_id": 54777052, "comment_id": 96334033, "body": "Do you mean something like this? <code>void add(int n, struct Person a[n]);</code>"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550624584, "post_id": 54777052, "comment_id": 96334071, "body": "@CacahueteFrito I mean I dont understand why not <code>void add (Person ** a, int * size)</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550624978, "post_id": 54777052, "comment_id": 96334145, "body": "A) why do you want <code>tam</code> to be a pointer? B) why do you want to use pointers instead of an array for <code>a</code>, if you are trying to deal with an array?"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550625612, "post_id": 54777052, "comment_id": 96334280, "body": "@CacahueteFrito  <code>tam</code> is the index that will be passed to main. B) dont know if this is bad programming habit, but wont i pass the adress either way? <code>void something( int a[])</code>  or <code>void something(int * a)</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550625901, "post_id": 54777052, "comment_id": 96334348, "body": "I still think you want this <code>void add(int tam, struct Person a[tam]);</code> and then <code>strncpy(a[i].name, name, BUFF_SIZE - 1)</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550626474, "post_id": 54777052, "comment_id": 96334489, "body": "Yes, in the end it is the same (not in arrays with more than 1 dimension, but true in this case), but it is a lot more clear, and you wouldn&#39;t have had many of this problems if you had used the array form."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550626591, "post_id": 54777052, "comment_id": 96334509, "body": "How can it be the index and the size at the same time?"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550627069, "post_id": 54777052, "comment_id": 96334612, "body": "@CacahueteFrito srry <code>tam</code> is the array size not index"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550627427, "post_id": 54777052, "comment_id": 96334692, "body": "Are you modifying <code>*tam</code> inside the function? If not, you shouldn&#39;t use a pointer. Also, why are you iterating until <code>i &lt; *tam+1</code> and not <code>i &lt; *tam</code>? You will be accessing one element outside the array size."}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550628902, "post_id": 54777052, "comment_id": 96335022, "body": "@CacahueteFrito I edit the question to clarify the current situation with <code>main()</code> and <code>add()</code> . I declared <code>tam = 0</code> thats why i need <code>for(int i = 0; i &lt; *tam +1;i++)</code> and it isnt complete yet, because my confusion with structures."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550652949, "post_id": 54777052, "comment_id": 96343172, "body": "Problems:  A) You have an <code>int</code> named <code>Calendar</code>, and also a <code>typedef struct Calendar Calendar;</code>  You should rename the former to <code>int calendar</code>."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550653075, "post_id": 54777052, "comment_id": 96343236, "body": "B)  If you are not very confident with <code>struct</code>s and are still learning them, I suggest that you start without using <code>typedef</code>.  It only serves to obscure the <code>struct</code>."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550653259, "post_id": 54777052, "comment_id": 96343334, "body": "C)  You should pass the maximum size of the array, so that <code>add()</code>doesn&#39;t try to write more than it, and to keep track of the number of elements used, another variable (by ref):  <code>void add(size_t n, struct Person a[n], int *tam);</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550657435, "post_id": 54777052, "comment_id": 96345871, "body": "D)  Please do NOT declare <code>main()</code> like that.  First of all, the implicit <code>int</code> is deprecated (read this: <a href=\"https://stackoverflow.com/questions/13935104/what-if-i-omit-the-return-type-of-main-function-in-c\" title=\"what if i omit the return type of main function in c\">stackoverflow.com/questions/13935104/&hellip;</a>).   There are <b>only</b> 2 portable forms accepted in standard: <code>int main(void)</code> and <code>int main(int argc, char *argv[])</code> (read this: <a href=\"https://stackoverflow.com/a/2108208/6872717\">stackoverflow.com/a/2108208/6872717</a>).  Other implementation defined prototypes for <code>main()</code> may be accepted, but you shouldn&#39;t rely on them without a good reason."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550658123, "post_id": 54777052, "comment_id": 96346344, "body": "E)  I guess you want your <code>add()</code> function to only add one element to the array, so I don&#39;t see why you need the <code>for</code> loop.  I think you may want <code>strncpy(a[*tam].name, name, n - 1);  (*tam)++;</code> and get rid of the <code>for</code> loop."}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550660946, "post_id": 54777052, "comment_id": 96348220, "body": "@CacahueteFrito you are right. the <code>for</code> loop is absolutely unnecessary, thanks."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550661443, "post_id": 54777052, "comment_id": 96348555, "body": "<code>scanf(&quot;%c&quot;, &amp;op);</code>:  You should add a space just before the <code>%c</code>:  <code>scanf(&quot; %c&quot;, &amp;op);</code> (read this: <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/scanf.3.html</a>)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550671535, "post_id": 54777052, "comment_id": 96354729, "body": "@CacahueteFrito, regarding &quot;Usually you should avoid strcpy()&quot;: no, I do not accept that as a general rule.  It is a question of your requirements and what you can rely upon about your data.  Whereas <code>strcpy()</code> may overrun array bounds if you are not careful, <code>strncpy()</code> may leave the destination unterminated, setting the stage for a <i>future</i> buffer overrun (and it may itself overrun the buffer, too, if you don&#39;t get its length right).  In practice, the failure behavior attending <code>strncpy()</code> can be worse than the failure behavior attending <code>strcpy()</code>."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550676287, "post_id": 54777052, "comment_id": 96357863, "body": "The <code>-1</code> is exactly for that purpose:  It means &quot;<code>strncpy()</code> please do leave one last <code>char</code> to write a <code>&#39;\\0&#39;</code> there&quot;."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1550705709, "post_id": 54777052, "comment_id": 96371700, "body": "Of course, <code>strlcpy()</code> is better, but it isn&#39;t standard (I hope it is in the future)."}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550661830, "post_id": 54783218, "comment_id": 96348794, "body": "About the prototype if I pass a single structure as argument to modify it value it would be <code>void add(Person * a)</code>. What I don&#39;t understand is why when it is an array of structure the compiler gives error with this <code>void add(Person *a[])</code>, but works with this instead <code>void add(Person a[])</code> or <code>void add(Person * a)</code>. An array of array would be <code>void func(int a[][])</code> or <code>void func(int *a[])</code>. Doesn&#39;t  both, structure or array, pass arguments as references? What am I missing?"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550663159, "post_id": 54783218, "comment_id": 96349541, "body": "No, if you pass a <code>struct</code> your are really passing a copy of it (read this answer: <a href=\"https://stackoverflow.com/a/13555817/6872717\">stackoverflow.com/a/13555817/6872717</a>)"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550663321, "post_id": 54783218, "comment_id": 96349625, "body": "So yes, your new prototype <code>void add(struct Person *a)</code> would work, if you passed a pointer to a struct like this: <code>add(&amp;(book[tam]));</code> but then you would need to increment <code>tam</code> in main.  Also you would need to use it differently inside of <code>add()</code>: <code>strncpy(a-&gt;name, name, 40 - 1);</code> (which is short for <code>strncpy((*a).name, name, 40 - 1);</code>) (read this: <a href=\"https://stackoverflow.com/questions/13366083/why-does-the-arrow-operator-in-c-exist/13366168\" title=\"why does the arrow operator in c exist\">stackoverflow.com/questions/13366083/&hellip;</a>)."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550663796, "post_id": 54783218, "comment_id": 96349883, "body": "Read better this one about the <code>-&gt;</code> operator: <a href=\"https://stackoverflow.com/a/2575050/6872717\">stackoverflow.com/a/2575050/6872717</a>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550664193, "post_id": 54783218, "comment_id": 96350118, "body": "Passing a <code>struct</code> to a function behaves like passing an <code>int</code>. It just makes a copy of it, and if you want to modify it you need to pass a pointer to it.  Arrays are the only weird things that behave differently when passed to a function: instead of passing a copy, they pass a pointer to its first element, so that you can modify them without explicitly using pointers.  And therefore you need to use <code>const</code> if you want to pass an array that cannot be modified."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550664734, "post_id": 54783218, "comment_id": 96350517, "body": "So, if you want to pass a copy of a <code>struct</code>, you use: <code>void add(struct Person a);</code> and use it like this: <code>x = a.age;</code> (note that this is a copy, so usually you would only read from it).   If you want to pass a pointer to a single <code>struct</code>, you use: <code>void add(struct Person *a);</code> and use it like this: <code>a-&gt;age = 7;</code>.   And if you want to pass an array of <code>struct</code>s, you use: <code>void add(size_t n, struct Person a[n]);</code> and use it like this: <code>a[i].age = 7;</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550665135, "post_id": 54783218, "comment_id": 96350780, "body": "Usually when passing <code>struct</code>s to a function you don&#39;t want to pass a copy of them even if you only want to read from them, because that would use more RAM and would be slow;  The solution is to pass a <code>const struct Struct_Tag *some_struct</code> so that you pass a pointer to the original struct, but you don&#39;t allow the function to write into it."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1550666507, "post_id": 54783218, "comment_id": 96351617, "body": "This: <code>struct Person *a[]</code> is an array of pointers to <code>struct</code>s.  You clearly do NOT have an array of pointers to <code>struct</code>s.  The whole thing of considering that arrays are pointers is misleading you.  Arrays decay to pointers, but that shouldn&#39;t bother you, and <code>struct</code>s have nothing to do with pointers."}], "tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": true, "score": 0, "last_activity_date": 1550704061, "last_edit_date": 1550704061, "creation_date": 1550655917, "answer_id": 54783218, "question_id": 54777052, "link": "https://stackoverflow.com/questions/54777052/array-of-structure-as-arguments-and-acessing-members-confusion/54783218#54783218", "title": "Array of structure as arguments and acessing members confusion", "body": "<p>The prototype for your function should make clear that it works with an array:</p>\n\n<pre><code>void add(size_t n, struct Person arr[n], int *tam);\n</code></pre>\n\n<p>This way, you know the size of the array (<code>n</code>), and you can make sure that you don't try to access beyond that size, which would end up in a <code>segmentation fault</code> if you are lucky (read this: <a href=\"https://stackoverflow.com/questions/15646973/how-dangerous-is-it-to-access-an-array-out-of-bounds\">How dangerous is it to access an array out of bounds?</a>).</p>\n\n<hr>\n\n<p>The <code>for</code> loop would then loop over the array:</p>\n\n<pre><code>for (int i = 0, *tam = 0; i &lt; n; i++, (*tam)++) {\n    printf(\"Insert your name:\\n\");\n    fgets(name, 30, stdin);\n    /* a[i].name = name; */\n}\n(*tam)++;\n</code></pre>\n\n<p>You <strong>need</strong> the parentheses around <code>(*tam)++</code> because of operator precedance (read this: <a href=\"https://stackoverflow.com/questions/8208021/how-to-increment-a-pointer-address-and-pointers-value\">How to increment a pointer address and pointer&#39;s value?</a>).</p>\n\n<hr>\n\n<p>As for the access to the <code>struct</code>s inside the array, you have to know that you are accessing an array of <code>struct</code>s;  that is just many <code>struct</code>s put together, as an array of <code>int</code>s would be:</p>\n\n<p><code>a</code> is an array of <code>struct</code>s.</p>\n\n<p><code>a[i]</code> is the <code>i</code>th struct in the array.</p>\n\n<p><code>a[i].name</code> is the element <code>name</code> in the struct <code>a[i]</code>.</p>\n\n<hr>\n\n<p>To copy a string into another, you have to copy it element by element, because internally they are an array of <code>char</code>s, and because of the way arrays work in C, you can not copy them with <code>=</code> but by iterating and copying element by element.</p>\n\n<p>In case of normal arrays, function <code>memcpy()</code> does that for you (read this: <a href=\"http://man7.org/linux/man-pages/man3/memcpy.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/memcpy.3.html</a>).</p>\n\n<p>When you are dealing with strings, the function you want to use to copy them is <code>strncpy()</code> (read this: <a href=\"http://man7.org/linux/man-pages/man3/strncpy.3p.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/strncpy.3p.html</a>).</p>\n\n<p>The correct usage of <code>strncpy()</code> is explained in this answer: <a href=\"https://stackoverflow.com/a/14067026/6872717\">https://stackoverflow.com/a/14067026/6872717</a></p>\n\n<p>Basically you would use it like this:</p>\n\n<pre><code>strncpy(a[i].name, name, n - 1);\n</code></pre>\n\n<p>so your <code>for</code> loop should look like this:</p>\n\n<pre><code>for (int i = 0, *tam = 0; i &lt; n; i++, (*tam)++) {\n    printf(\"Insert your name:\\n\");\n    fgets(name, 30, stdin);\n    strncpy(a[i].name, name, 40 - 1);\n    a[i].name[40 - 1] = '\\0';\n}\n(*tam)++;\n</code></pre>\n\n<hr>\n\n<p>This is more a comment, and I may remove it later if it isn't what you want, but here I can format better the code:</p>\n\n<p>I am not sure why the <code>for</code> loop is there, but for the context, I guess this function is meant to only write into one <code>struct</code> in the array.  So maybe instead of the <code>for</code> loop you may want something like this:</p>\n\n<pre><code>if (*tam = (n - 1))\n    goto err_array_full;\nif (*tam &gt; (n - 1)  ||  *tam &lt; 0)\n    goto err_invalid_index;\n\nprintf(\"Insert your name:\\n\");\nfgets(name, 30, stdin);\nstrncpy(a[*tam].name, name, 40 - 1);\na[*tam].name[40 - 1] = '\\0';\n(*tam)++;\n</code></pre>\n\n<hr>\n\n<p>Final note:  I used <code>40</code> in <code>strncpy()</code> because you used <code>40</code> to create the array, but that <em>should</em> be a macro which you would use in both places so that when you change the size of the array you don't forget to change it also in <code>strncpy()</code>, which would introduce a bug.  With a macro you are safe because you only change one number and all your code is updated.</p>\n"}], "owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54783218, "answer_count": 1, "score": 0, "last_activity_date": 1550704061, "creation_date": 1550622891, "last_edit_date": 1550628347, "question_id": 54777052, "link": "https://stackoverflow.com/questions/54777052/array-of-structure-as-arguments-and-acessing-members-confusion", "title": "Array of structure as arguments and acessing members confusion", "body": "<pre><code>typedef struct Calendar {\n    int day;\n    int month;\n    int year;\n}Calendar;\n\ntypedef struct Person {\n    char name[40];\n    int age;\n    float salary;\n    Calendar birth;\n}Person;\nvoid add(Person * a, int * tam);\n</code></pre>\n\n<p>If I want to pass structure as argument and modify its original value I have to pass as pointer, but a array of structure shouldn't be passed as pointer of a pointer like a array of array? Why the compiler works with a pointer and gives error with a pointer of a pointer? </p>\n\n<pre><code>for (int i = 0; i &lt; *tam + 1; i++)\n{\n        printf(\"Insert your name:\\n\");\n        fgets(name, 30, stdin);\n        *a[i].name = name;\n}\n</code></pre>\n\n<p>The last line gives  warning C4047: char differs in levels of indirections. If I remove '*' it doesn't compile. How do I correctly access a array member from a array of structure?</p>\n\n<p>EDIT 1: To clarify here is the full <code>add()</code> function and <code>main()</code> function.</p>\n\n<pre><code>void add(Person * a, int * tam) {\n\n    char name[30];\n    int op = 0;\n    int c, day = 0, month = 0, year = 0, Calendar = -1;\n    float sal = -1;\n\n    for (int i = 0; i &lt; *tam + 1; i++)\n    {\n        printf(\"Insert your name:\\n\");\n        fgets(name, 30, stdin);\n        *a[i].name = name;\n\n        while ((c = getchar()) != '\\n' &amp;&amp; c != EOF)\n            ;\n        do\n        {\n            printf(\"Insert %s's age:\\n\", name);\n            scanf(\"%d\", &amp;op);\n            while ((c = getchar()) != '\\n' &amp;&amp; c != EOF)\n                ;\n            if (!op)\n                printf(\"invalid age!\\n\");\n            else\n                a[i].age = op;\n        } while (op &lt;= 0);\n        do\n        {\n            printf(\"Insert %s's salary:\\n\", name);\n            scanf(\"%f\", &amp;sal);\n            while ((c = getchar()) != '\\n' &amp;&amp; c != EOF)\n                ;\n            if (sal &lt; 0)\n                printf(\"Invalid salary!\\n\");\n            else\n                a[i].salary = sal;\n\n        } while (sal &lt; 0);\n        do\n        {\n            printf(\"Insert %s's date birth\\n\", name);\n            printf(\"Day:\\n\");\n            scanf(\"%d\", &amp;day);\n            while ((c = getchar()) != '\\n' &amp;&amp; c != EOF)\n                ;\n            printf(\"Month:\\n\");\n            scanf(\"%d\", &amp;month);\n            while ((c = getchar()) != '\\n' &amp;&amp; c != EOF)\n                ;\n            printf(\"Year:\\n\");\n            scanf(\"%d\", &amp;year);\n            while ((c = getchar()) != '\\n' &amp;&amp; c != EOF)\n                ;\n\n            if ((day &gt; 0 &amp;&amp; day &lt; 31) &amp;&amp; (month &gt; 0 &amp;&amp; month &lt; 12) &amp;&amp; (year &gt; 0))\n            {\n                Calendar = 1;\n                a[i].birth.day = day;\n                a[i].birth.month = month;\n                a[i].birth.year = year;\n            }\n            else\n                printf(\"Invalid calendar!\\n\");\n\n        } while (Calendar != 1);\n\n    }\n    *tam++;\n}\n\nmain() {\n    Person book[10];\n    int c, tam = 0;\n    char op, out = 0;\n    while (!out)\n    {\n\n        do\n        {\n            printf(\"1: Insert a profile\\n\");\n            printf(\"2: Change a profile\\n\");\n            printf(\"3: Erase a Profile\\n\");\n            printf(\"4: Show all profiles\\n\");\n            printf(\"5: Search\\n\");\n            printf(\"0: Exit\\n\");\n            scanf(\"%c\", &amp;op);\n            while ((c = getchar()) != '\\n' &amp;&amp; c != EOF)\n                ;\n\n        } while (op &lt; '0' || op &gt; '5');\n\n        switch (op)\n        {\n        case '1':\n            add(book, &amp;tam);\n            break;\n        case '2':\n\n            break;\n        case '3':\n\n            break;\n        case '4':\n            read(book, &amp;tam);\n            break;\n        case '5':\n\n            break;\n        case '0':\n            out = 1;\n            break;\n        default:\n            break;\n        }\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1550622435, "post_id": 54776938, "comment_id": 96333592, "body": "Should <code>N = 5</code> have 5 rows?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1550622758, "post_id": 54776938, "comment_id": 96333671, "body": "There&#39;s no reason to post that output as a picture since it is only text. Please convert it to text."}, {"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1550622982, "post_id": 54776938, "comment_id": 96333715, "body": "<code>for(rows2=1; rows2&lt;=1; rows2++)</code> is useless. I guess you&#39;re supposed to loop twice on the number of elements, on for vertical, one for horizontal, and add a space only on odd lines (%2 == 1) if counted from 0"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1550622987, "post_id": 54776938, "comment_id": 96333718, "body": "You could start by removing <code>rows2</code> and <code>width2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 1, "creation_date": 1550623028, "post_id": 54777058, "comment_id": 96333727, "body": "most likely missing the &quot; &quot; to add every 2 lines!"}, {"owner": {"reputation": 156, "user_id": 8366477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d567442dacc119a6cb152943b909?s=128&d=identicon&r=PG&f=1", "display_name": "malanb5", "link": "https://stackoverflow.com/users/8366477/malanb5"}, "reply_to_user": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1550623207, "post_id": 54777058, "comment_id": 96333776, "body": "I wasn&#39;t sure if that was intentional or not in the picture."}, {"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1550623309, "post_id": 54777058, "comment_id": 96333805, "body": "Sure. As is the question of 4 or 5 lines in the case 5, not likely correct in the picture!"}, {"owner": {"reputation": 156, "user_id": 8366477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d567442dacc119a6cb152943b909?s=128&d=identicon&r=PG&f=1", "display_name": "malanb5", "link": "https://stackoverflow.com/users/8366477/malanb5"}, "reply_to_user": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1550623382, "post_id": 54777058, "comment_id": 96333825, "body": "I added the line in there"}, {"owner": {"reputation": 25, "user_id": 6063896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8559d5da4faf6246209d6177e9631c91?s=128&d=identicon&r=PG&f=1", "display_name": "Rozay", "link": "https://stackoverflow.com/users/6063896/rozay"}, "edited": false, "score": 0, "creation_date": 1550637638, "post_id": 54777058, "comment_id": 96336943, "body": "The <code>if</code> statement is saying that if the <code>width</code> is equal to zero and the length has a remainder of one after being divided by two, meaning an odd number, then print a space, right?  Is because the first line of the program will be considered zero and the second line will be considered one (odd)?"}, {"owner": {"reputation": 156, "user_id": 8366477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d567442dacc119a6cb152943b909?s=128&d=identicon&r=PG&f=1", "display_name": "malanb5", "link": "https://stackoverflow.com/users/8366477/malanb5"}, "reply_to_user": {"reputation": 620, "user_id": 6660678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650f0bb98fc9fde7f182cd0b810bc25b?s=128&d=identicon&r=PG&f=1", "display_name": "mdfst13", "link": "https://stackoverflow.com/users/6660678/mdfst13"}, "edited": false, "score": 0, "creation_date": 1550711438, "post_id": 54777058, "comment_id": 96373004, "body": "Thank you @mdfst13 for the catch.  I deleted the comment about O(n^4)"}, {"owner": {"reputation": 156, "user_id": 8366477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d567442dacc119a6cb152943b909?s=128&d=identicon&r=PG&f=1", "display_name": "malanb5", "link": "https://stackoverflow.com/users/8366477/malanb5"}, "reply_to_user": {"reputation": 620, "user_id": 6660678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650f0bb98fc9fde7f182cd0b810bc25b?s=128&d=identicon&r=PG&f=1", "display_name": "mdfst13", "link": "https://stackoverflow.com/users/6660678/mdfst13"}, "edited": false, "score": 0, "creation_date": 1550711927, "post_id": 54777058, "comment_id": 96373106, "body": "@mdfst13 I also moved the space before the inner loop. Thank you.  Feel free to edit my answer as well."}, {"owner": {"reputation": 156, "user_id": 8366477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d567442dacc119a6cb152943b909?s=128&d=identicon&r=PG&f=1", "display_name": "malanb5", "link": "https://stackoverflow.com/users/8366477/malanb5"}, "reply_to_user": {"reputation": 25, "user_id": 6063896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8559d5da4faf6246209d6177e9631c91?s=128&d=identicon&r=PG&f=1", "display_name": "Rozay", "link": "https://stackoverflow.com/users/6063896/rozay"}, "edited": false, "score": 0, "creation_date": 1550712097, "post_id": 54777058, "comment_id": 96373149, "body": "@Rozay Yes is the mod operator and works basically as you describe.  The odd numbered rows have a space before the * get printed out.  It does not happen on every execution thus the need for a conditional (if).  I updated the answer based upon feedback from mdfst13 so please take another look at it."}], "tags": [], "owner": {"reputation": 156, "user_id": 8366477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d567442dacc119a6cb152943b909?s=128&d=identicon&r=PG&f=1", "display_name": "malanb5", "link": "https://stackoverflow.com/users/8366477/malanb5"}, "is_accepted": true, "score": 0, "last_activity_date": 1550711851, "last_edit_date": 1550711851, "creation_date": 1550622915, "answer_id": 54777058, "question_id": 54776938, "link": "https://stackoverflow.com/questions/54776938/printing-pattern-with-nested-for-loops-in-c/54777058#54777058", "title": "Printing Pattern with Nested for Loops in C", "body": "<p>1) In the first conditional, you return 0 to indicate a success.  I would go with the macro EXIT_FAILURE (even better use a while loop until you get a valid input from the user) in the conditional obtaining the user's input.</p>\n\n<p>2) I would trace through this and see step by step what you expect to get at each step in your program.  Think about if you could eliminate some of the for loops, how many are really essential for your program to run?</p>\n\n<p>*************ONLY LOOK AT THIS WHEN YOU HAVE ATTEMPTED FIXING IT YOURSELF ***********</p>\n\n<pre><code>int main() {\n\n        int N;\n\n        printf(\"Please enter a number between 2 and 5 (including 2 and 5). \\n\");\n        scanf(\"%d\", &amp;N);\n\n        if (N&lt;2 || N&gt;5)\n        {\n            printf (\"The number you entered is either less than 2 or greater than 5. \\\n            Please try again.\");\n            return EXIT_FAILURE;\n        }\n\n        for (int length= 0; length &lt; N; length++) {\n            if(length %2 == 1){\n                    printf(\" \");\n            }\n            for(int width = 0; width &lt; N; width++) {\n\n                printf(\"*\");\n            }\n            printf(\"\\n\");\n        }\n\n        return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 620, "user_id": 6660678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650f0bb98fc9fde7f182cd0b810bc25b?s=128&d=identicon&r=PG&f=1", "display_name": "mdfst13", "link": "https://stackoverflow.com/users/6660678/mdfst13"}, "is_accepted": false, "score": 0, "last_activity_date": 1550632922, "creation_date": 1550632922, "answer_id": 54778308, "question_id": 54776938, "link": "https://stackoverflow.com/questions/54776938/printing-pattern-with-nested-for-loops-in-c/54778308#54778308", "title": "Printing Pattern with Nested for Loops in C", "body": "<p>You print twice in your outer loop.  I.e. you have </p>\n\n<pre><code>for 1 to N, stepping by 1\n    print line\n\n    print leading space\n    print line\n</code></pre>\n\n<p>So you print two times <code>N</code> lines when you want to print exactly <code>N</code> lines.  </p>\n\n<p>Either increase your increment (replace <code>rows++</code> with <code>rows += 2</code> which will cause you to only print an even number of lines, so you'll have to fix it for odd <code>N</code>) or change to print only one line per iteration (where you'll have to fix the alternating leading space).  <a href=\"https://stackoverflow.com/a/54777058/6660678\">The @malanb5 answer</a> codes an example of the latter solution.  </p>\n"}], "owner": {"reputation": 25, "user_id": 6063896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8559d5da4faf6246209d6177e9631c91?s=128&d=identicon&r=PG&f=1", "display_name": "Rozay", "link": "https://stackoverflow.com/users/6063896/rozay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 54777058, "answer_count": 2, "score": 0, "last_activity_date": 1550711851, "creation_date": 1550622118, "last_edit_date": 1550627695, "question_id": 54776938, "link": "https://stackoverflow.com/questions/54776938/printing-pattern-with-nested-for-loops-in-c", "title": "Printing Pattern with Nested for Loops in C", "body": "<p>I'm studying for an exam and the professor asked for a program that can print out the following patterns: <a href=\"https://i.stack.imgur.com/3z4OW.png\" rel=\"nofollow noreferrer\">picture of the expected output</a></p>\n\n<pre><code>N=2    N=3    N=4    N=5\n**     ***    ****   *****\n **     ***    ****   *****\n       ***    ****   *****\n               ****   *****\n                     *****\n</code></pre>\n\n<p>(Except the image misses the fifth line for <code>N=5</code>.)</p>\n\n<p>My program can get a similar output except it doubles the number of rows for each expected output (IE when N=3 there are 6 rows, when N=4 there are 8 rows). Not sure how to stop it running after the number of rows hits N. Here's my code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    int N, rows1, width1, rows2, width2;\n\n    printf(\"Please enter a number between 2 and 5 (including 2 and 5).\\n\");\n    scanf(\"%d\", &amp;N);\n\n    if (N&lt;2 || N&gt;5)\n    {\n        printf (\"The number you entered is either less than 2 or greater than 5.\"\n                \" Please try again.\\n\");\n                return 0;\n    }\n\n    for (rows1=1; rows1&lt;=N; rows1++)\n    {\n        for(width1=1; width1&lt;=N; width1++)\n            printf (\"*\");\n        printf (\"\\n\");\n\n        for(rows2=1; rows2&lt;=1; rows2++)\n            printf (\" \");\n\n        for(width2=1; width2&lt;=N; width2++)\n            printf (\"*\");\n        printf (\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "char", "printf", "format-string"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 6, "creation_date": 1550623574, "post_id": 54776933, "comment_id": 96333863, "body": "It&#39;s unlikely that this is a true <code>?</code> character.  More likely that it&#39;s a character that your terminal is having trouble displaying, or if you are using a graphical terminal then that particular character does not exist in the current font."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1550625102, "post_id": 54776933, "comment_id": 96334173, "body": "Posting the results of <code>printf(&quot;\\n %d&quot; , ((unsigned char)a[i]+100);</code> would help."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550626850, "post_id": 54776933, "comment_id": 96334562, "body": "@chux pardon me if I am asking something basic, but wouldn&#39;t <code>%d</code> with <code>(unsigned char)</code> be wrong? Shouldn&#39;t it be <code>%u</code>? I always have trouble understanding default arg promotion."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1550626967, "post_id": 54776933, "comment_id": 96334592, "body": "@AjayBrahmakshatriya Yes, <code>&quot;%u&quot;</code> would be better.  Makes no difference if <code>UCHAR_MAX &lt;= INT_MAX</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550627528, "post_id": 54776933, "comment_id": 96334712, "body": "@chux, but if I understand correctly, the bit representation for <code>unsigned int</code> will be passed and it will be reinterpreted as <code>int</code>. Are they allowed to have different representations by the standard?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1550627946, "post_id": 54776933, "comment_id": 96334818, "body": "@AjayBrahmakshatriya When the value is representable in both the signed and unsigned version, either specifier is OK.  See C11 &#167;6.5.2.2 6"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550636039, "post_id": 54776933, "comment_id": 96336542, "body": "@chux perfect! Thanks. Does this automatically imply that signed and unsigned integers should use the same representation (at least for the value in the common range)?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1550664704, "post_id": 54776933, "comment_id": 96350486, "body": "@AjayBrahmakshatriya Yes."}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 8366477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d567442dacc119a6cb152943b909?s=128&d=identicon&r=PG&f=1", "display_name": "malanb5", "link": "https://stackoverflow.com/users/8366477/malanb5"}, "is_accepted": false, "score": 2, "last_activity_date": 1550629900, "last_edit_date": 1550629900, "creation_date": 1550622207, "answer_id": 54776948, "question_id": 54776933, "link": "https://stackoverflow.com/questions/54776933/why-does-c-print-and-what-is-its-meaning/54776948#54776948", "title": "Why does %c print &#39;?&#39; and what is its meaning", "body": "<p>You are missing a closing \" in both statements.  What compiler are you using?  If you compile with gcc with the -Wall compiler flag on you would see:</p>\n\n<pre><code>warning: missing terminating \" character\n     printf(\"\\n %c , ((unsigned char)a[i]+100);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1846, "user_id": 2589273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/34lAu.jpg?s=128&g=1", "display_name": "user2589273", "link": "https://stackoverflow.com/users/2589273/user2589273"}, "is_accepted": false, "score": 0, "last_activity_date": 1550622348, "creation_date": 1550622348, "answer_id": 54776972, "question_id": 54776933, "link": "https://stackoverflow.com/questions/54776933/why-does-c-print-and-what-is-its-meaning/54776972#54776972", "title": "Why does %c print &#39;?&#39; and what is its meaning", "body": "<p>You guessed it, <code>c</code> returns a character. This means that in <code>%c</code> a character is substituted at that location within the print string.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1550628246, "post_id": 54777459, "comment_id": 96334898, "body": "&quot;Only characters 0-127 are valid for %c ...&quot; --&gt; Disagree. Any 0 or positive value passed as an <code>int</code> is OK --&gt; &quot;the <code>int</code> argument is converted to an <code>unsigned char</code>, and the resulting character is written.&quot;  <code>printf(&quot;\\n %c , &#39;X&#39; + 256);</code> and <code>printf(&quot;\\n %c ,  255);</code>  are fine."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1550626051, "creation_date": 1550626051, "answer_id": 54777459, "question_id": 54776933, "link": "https://stackoverflow.com/questions/54776933/why-does-c-print-and-what-is-its-meaning/54777459#54777459", "title": "Why does %c print &#39;?&#39; and what is its meaning", "body": "<p>Character -11 is not a valid 7-bit ASCII character. It's also an invalid UTF-8 byte, hence the <code>?</code> result.</p>\n\n<p>Only characters 0-127 are valid for <code>%c</code>. Everything else is going to be part of a multi-byte UTF-8 character, or is character-set dependent.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1550630956, "last_edit_date": 1550630956, "creation_date": 1550630524, "answer_id": 54778049, "question_id": 54776933, "link": "https://stackoverflow.com/questions/54776933/why-does-c-print-and-what-is-its-meaning/54778049#54778049", "title": "Why does %c print &#39;?&#39; and what is its meaning", "body": "<p><code>\"%c\"</code> expects an <code>int</code>.</p>\n\n<p><code>(unsigned char)a[i]+100</code>  is a <code>(unsigned char) + (int)</code>.  When <code>(unsigned char)</code> is 8-bit (most common), this results in an <code>int</code>.  Thus, in both of the below, code pass an <code>int</code> to <code>printf()</code>.</p>\n\n<pre><code>printf(\"\\n %c , ((unsigned char)a[i]+100);\nprintf(\"\\n %c , -11);\n</code></pre>\n\n<p><code>\"%c\"</code> converts that <code>int</code> to a <code>unsigned char</code>.  </p>\n\n<blockquote>\n  <p><code>c</code> ... the <code>int</code> argument is converted to an\n  <code>unsigned char</code>, and the resulting character is written.  C11dr \u00a77.21.6.1 8</p>\n</blockquote>\n\n<p>Assuming an 8-bit <code>unsigned char</code>, that converted value is in the range 0 to 255.  -11 becomes 245.  Then the character is written.  For values in the ASCII range of 0-127, we usually see the ASCII character or effect of a control character.  Other values print other things.  </p>\n\n<p>Certainly on OP's platform the output defaults to <code>?</code> for many of those out-of-ASCII-range characters. <a href=\"https://stackoverflow.com/questions/54776933/why-does-c-print-and-what-is-its-meaning#comment96333863_54776933\">@paddy</a></p>\n"}], "owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1550630956, "creation_date": 1550622054, "last_edit_date": 1550628072, "question_id": 54776933, "link": "https://stackoverflow.com/questions/54776933/why-does-c-print-and-what-is-its-meaning", "title": "Why does %c print &#39;?&#39; and what is its meaning", "body": "<p>Two examples </p>\n\n<pre><code>printf(\"\\n %c , ((unsigned char)a[i]+100);\n\nprintf(\"\\n %c , -11);\n</code></pre>\n\n<p>Returns</p>\n\n<pre><code>?\n?\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1550621698, "post_id": 54776872, "comment_id": 96333434, "body": "Because in the other cases, the value itself is returned. If they too, returned a <i>pointer</i> to the local variable, the same would be true."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1550624251, "post_id": 54776872, "comment_id": 96334013, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12380758/error-function-returns-address-of-local-variable\">error: function returns address of local variable</a>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1550621995, "creation_date": 1550621995, "answer_id": 54776920, "question_id": 54776872, "link": "https://stackoverflow.com/questions/54776872/stack-segment-c-arrays/54776920#54776920", "title": "Stack Segment C Arrays", "body": "<p>The difference is in returning a value as opposed to returning a pointer.</p>\n\n<p>When you do this:</p>\n\n<pre><code>int f()\n{\n    int x = 9;\n    return x;\n}\n\nint main()\n{\n    int a = f();\n    printf(\"a=%d\\n\", a);\n    return;\n}\n</code></pre>\n\n<p>This is valid because even though <code>x</code> is out of scope when <code>f</code> returns, it is the <em>value</em> stored in <code>x</code> (9 in this case) that is returned.  That value is then assigned to <code>a</code> and subsequently printed.</p>\n\n<p>In your example you're returning an array.  In most contexts, an array used in an expression decays into a pointer to its first element.  So <code>return str</code> is the same as <code>return &amp;str[0]</code>.  That pointer value is returned and passed to <code>printf</code>.  Then <code>printf</code> tried to dereference that pointer, but the memory it points to (the array <code>str</code>) is no longer valid.</p>\n\n<p>So you can return values from a function, but if that value is a pointer to a local variable it will not be valid.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550624415, "post_id": 54777166, "comment_id": 96334039, "body": "Is a string constant like <code>&quot;x&quot;</code> stored in the stack? It might be stored somewhere in the data segment."}, {"owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1550627983, "post_id": 54777166, "comment_id": 96334828, "body": "with or without const, gcc(6.3) all give the same &quot;warning: function returns address of local variable [-Wreturn-local-addr]&quot;, which imply it might be stored on stack too."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550629340, "post_id": 54777166, "comment_id": 96335138, "body": "Good on GCC, then!"}], "tags": [], "owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "is_accepted": false, "score": 5, "last_activity_date": 1550814841, "last_edit_date": 1550814841, "creation_date": 1550623609, "answer_id": 54777166, "question_id": 54776872, "link": "https://stackoverflow.com/questions/54776872/stack-segment-c-arrays/54777166#54777166", "title": "Stack Segment C Arrays", "body": "<p>This should roughly explains what happened, after return from getString(), its stack is not valid anymore.</p>\n\n<pre><code>         ^            ^ \n         |  not valid |    ^            ^\n         +------------+    | not valid  |\n  str--&gt; | \"GfG\"      |    | not valid  | &lt;---+\n         |  ---       |    | not valid  |     |\n         | stack of   |    +------------+     |\n         | getString  |    | return(str)| ----+\n         +------------+    | ---        |\n         |            |    |            |\n         | stack of   |    | stack of   |\n         | main()     |    | main()     |\n         +------------+    +------------+\n</code></pre>\n\n<p>If compiled with gcc -W -Wall (should always use those options), it should give the warning:</p>\n\n<pre><code>warning: function returns address of local variable [-Wreturn-local-addr]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": false, "score": 0, "last_activity_date": 1550645469, "creation_date": 1550645469, "answer_id": 54780444, "question_id": 54776872, "link": "https://stackoverflow.com/questions/54776872/stack-segment-c-arrays/54780444#54780444", "title": "Stack Segment C Arrays", "body": "<p>There are 2 situations:</p>\n\n<ol>\n<li><p>When you return a simple value like an <code>int</code> or <code>char</code> from a local function and that variable is defined/declared in that local function. It happens successfully, because while returning the value is <strong>actually copied</strong>.</p></li>\n<li><p>Now you have string <code>\"GfG\"</code> in <code>str</code> and when you do <code>return str</code>, the value that is copied is what is there in <code>str</code> and that is the address location of the array. So in this case the array location (pointer) is copied, while the contents of this array vanishes (since the contents were on local stack frame).</p></li>\n</ol>\n"}], "owner": {"reputation": 324, "user_id": 8928797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fe97af56b902b3ed03e449107619e7?s=128&d=identicon&r=PG&f=1", "display_name": "nrmad", "link": "https://stackoverflow.com/users/8928797/nrmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 54776920, "answer_count": 3, "score": 0, "last_activity_date": 1550814841, "creation_date": 1550621585, "last_edit_date": 1550676747, "question_id": 54776872, "link": "https://stackoverflow.com/questions/54776872/stack-segment-c-arrays", "title": "Stack Segment C Arrays", "body": "<p>I came across an example in a page outlining the various ways to represent a string in C structures. It explains that an array defined in a function outside main will be stored in the stack segment and as such will not necessarily be present following its return potentially causing a runtime error. </p>\n\n<p><strong>HIGHLIGHTED POSSIBLE DUPLICATE EXPLAINED WHY THE ARRAY FAILED ON RETURN I.E THE POINTER TO ELEMENT 0 RETURNED IS NO LONGER VALID BUT DID NOT SHOW THAT THE REASON VARIABLES OF THE SAME STORAGE CLASS (AUTO) ARE SUCCESSFUL IS THAT THEY PASS A VALUE WHICH SURVIVES THE REMOVAL OF THE STACK FRAME</strong></p>\n\n<p>\" the below program may print some garbage data as string is stored in stack frame of function getString() and data may not be there after getString() returns. \" </p>\n\n<pre><code>char *getString() \n{ \n  char str[] = \"GfG\"; /* Stored in stack segment */\n\n  /* Problem: string may not be present after getSting() returns */\n  return str;  \n}      \nint main() \n{ \n  printf(\"%s\", getString());   \n  getchar(); \n  return 0; \n} \n</code></pre>\n\n<p>I understand that other local C variables will also be defined in their respective stack frames and obviously they can be returned so why is it an issue for arrays?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1550620668, "post_id": 54776721, "comment_id": 96333191, "body": "No. The uppercase A has an ASCII value of 65 decimal, 0x41 hex (see any ASCII chart), not zero."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1550621328, "post_id": 54776721, "comment_id": 96333356, "body": "<a href=\"https://stackoverflow.com/questions/1469711/converting-letters-to-numbers-in-c\" title=\"converting letters to numbers in c\">stackoverflow.com/questions/1469711/&hellip;</a>"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1550628927, "post_id": 54776721, "comment_id": 96335030, "body": "Ciphers typical bypass this issue by transforming an array of bytes to an array of bytes. That the original bytes represent text is out of scope. That you might want to transfer the output as text is out of scope. (Base64 or similar is typically used when that is required.)"}], "answers": [{"tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 4, "last_activity_date": 1550620831, "creation_date": 1550620831, "answer_id": 54776776, "question_id": 54776721, "link": "https://stackoverflow.com/questions/54776721/do-chars-in-c-have-pre-assigned-zero-indexed-values/54776776#54776776", "title": "Do char&#39;s in C have pre-assigned zero indexed values?", "body": "<p>In C, character literals like <code>'A'</code> are of type <code>int</code>, and represent whatever integer value encodes the character A on your system. On the 99.999...% of systems that use ASCII character encoding, that's the number 65. If you have an old IBM mainframe from the 1970s using EBCDIC, it might be something else. You'll notice that the code is subtracting <code>'A'</code> to make  0-based values.</p>\n\n<p>This does make the assumption that the letters A-Z occupy 26 consecutive codes. This is true of ASCII (A=65, B=66, etc.), but not of all codes, and not guaranteed by the language.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 3, "last_activity_date": 1550620901, "creation_date": 1550620901, "answer_id": 54776791, "question_id": 54776721, "link": "https://stackoverflow.com/questions/54776721/do-chars-in-c-have-pre-assigned-zero-indexed-values/54776791#54776791", "title": "Do char&#39;s in C have pre-assigned zero indexed values?", "body": "<blockquote>\n  <p>does 'A' hold a zero indexed value automatically? (B = 1, C = 2, ...)</p>\n</blockquote>\n\n<p>No.  Strictly conforming C code can not depend on any character encoding other than the numerals <code>0</code>-<code>9</code> being represented consecutively, even though the common <a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">ASCII</a> character set does represent them consecutively.</p>\n\n<p>The only guarantee regarding character sets is per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.2.1p3\" rel=\"nofollow noreferrer\"><strong>5.2.1 Character sets</strong>, paragraph 3 of the C standard</a>:</p>\n\n<blockquote>\n  <p>... the value of each character after 0 in the above list of decimal digits shall be one greater than the value of the previous...</p>\n</blockquote>\n\n<p>Character sets such as <a href=\"https://en.wikipedia.org/wiki/EBCDIC\" rel=\"nofollow noreferrer\">EBCDIC</a> don't represent letters consecutively</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1550624926, "post_id": 54776831, "comment_id": 96334137, "body": "@Broman OP is concern about a niche issue, the sequentiality of <code>A-Z</code>, something the is on nil concern given encoding characters of 2019, yet missing a more  likely failing issue (UB) of <code>is...()</code> functions."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1550621285, "creation_date": 1550621285, "answer_id": 54776831, "question_id": 54776721, "link": "https://stackoverflow.com/questions/54776721/do-chars-in-c-have-pre-assigned-zero-indexed-values/54776831#54776831", "title": "Do char&#39;s in C have pre-assigned zero indexed values?", "body": "<p>Sequentiality is only one aspect of concern.</p>\n\n<p>Proper use of <code>isalpha(ch)</code> is another, not quite implemented properly in OP's code.</p>\n\n<p><code>isalpha(ch)</code> expects a <code>ch</code> in the range of <code>unsigned char</code> or <code>EOF</code>.  With <code>k[h]</code>, a <code>char</code>, that value could be negative.  Insure a non-negative value with:</p>\n\n<pre><code>// if  isalpha(k[h])\nif isalpha((unsigned char) k[h])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 1, "last_activity_date": 1550621531, "creation_date": 1550621531, "answer_id": 54776867, "question_id": 54776721, "link": "https://stackoverflow.com/questions/54776721/do-chars-in-c-have-pre-assigned-zero-indexed-values/54776867#54776867", "title": "Do char&#39;s in C have pre-assigned zero indexed values?", "body": "<p><code>char</code> is a numeric type that happens to also often be used to represent visible characters (or special non-visible pseudo-characters).  <code>'A'</code> is a value (with actual type <code>int</code>) that can be converted to a <code>char</code> without overflow or underflow.  That is, it's really some number, but you usually don't need to know what number, since you generally use a particular <code>char</code> value either as just a number or as just a character, not both.</p>\n\n<p>But this program is using <code>char</code> values in both ways, so it somewhat does matter what the numeric values corresponding to visible characters are.  One way it's very often done, but <strong>not always</strong>, is using the <a href=\"https://en.wikipedia.org/wiki/ASCII#Printable_characters\" rel=\"nofollow noreferrer\">ASCII</a> values which are numbered <code>0</code> to <code>127</code>, or some other scheme which uses those values plus more values outside that range.  So for example, if the computer uses one of those schemes, then <code>'A'==65</code>, and <code>'A'+1==66</code>, which is <code>'B'</code>.</p>\n\n<p>This program is assuming that all the lowercase Latin-alphabet letters have numeric values in consecutive order from <code>'a'</code> to <code>'z'</code>, and all the uppercase Latin-alphabet letters have numeric values in consecutive order from <code>'A'</code> to <code>'Z'</code>, without caring exactly what those values are.  This is true of ASCII, so it will work on many kinds of machines.  But there's no guarantee it will always be true!</p>\n\n<p>C does guarantee the ten digit characters from <code>'0'</code> to <code>'9'</code> are in consecutive order, which means that if <code>n</code> is a digit number from zero to nine inclusive, then <code>n + '0'</code> is the character for displaying that digit, and if <code>c</code> is such a digit character, then <code>c - '0'</code> is the number from zero to nine it represents.  But that's the only guarantee the C language makes about the values of characters.</p>\n\n<p>For one counter-example, see <a href=\"https://en.wikipedia.org/wiki/EBCDIC#Code_page_layout\" rel=\"nofollow noreferrer\">EBCDIC</a>, which is not in much use now, but was used on some older computers, and C supports it.  Its alphabetic characters are arranged in clumps of consecutive letters, but not with all 26 letters of each case all together.  So the program would give incorrect results running on such a computer.</p>\n"}], "owner": {"reputation": 11, "user_id": 11020932, "user_type": "registered", "profile_image": "https://graph.facebook.com/2569072236441459/picture?type=large", "display_name": "Josh Gohr", "link": "https://stackoverflow.com/users/11020932/josh-gohr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1550621531, "creation_date": 1550620432, "last_edit_date": 1550621434, "question_id": 54776721, "link": "https://stackoverflow.com/questions/54776721/do-chars-in-c-have-pre-assigned-zero-indexed-values", "title": "Do char&#39;s in C have pre-assigned zero indexed values?", "body": "<p>Sorry if my title is a little misleading, I am still new to a lot of this but:</p>\n\n<p>I recently worked on a small cipher project where the user can give the file a argument at the command line but it must be alphabetical. (Ex: ./file abc)</p>\n\n<p>This argument will then be used in a formula to encipher a message of plain text you provide. I got the code to work, thanks to my friend for helping but i'm not 100% a specific part of this formula.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;ctype.h&gt;\n\n\nint main (int argc, string argv[])\n{   //Clarify that the argument count is not larger than 2\n    if (argc != 2)\n    {\n        printf(\"Please Submit a Valid Argument.\\n\");\n        return 1;\n    }\n    //Store the given arguemnt (our key) inside a string var 'k' and check if it is alpha\n    string k = (argv[1]);\n    //Store how long the key is\n    int kLen = strlen(k);\n    //Tell the user we are checking their key\n    printf(\"Checking key validation...\\n\");\n    //Pause the program for 2 seconds\n    sleep(2);\n    //Check to make sure the key submitted is alphabetical\n    for (int h = 0, strlk = strlen(k); h &lt; strlk; h++)\n    {\n        if isalpha(k[h])\n        {\n            printf(\"Character %c is valid\\n\", k[h]);\n            sleep(1);\n        }\n        else\n        {   //Telling the user the key is invalid and returning them to the console\n            printf(\"Key is not alphabetical, please try again!\\n\");\n            return 0;\n        }\n\n    }\n    //Store the users soon to be enciphered text in a string var 'pt'\n    string pt = get_string(\"Please enter the text to be enciphered: \");\n    //A prompt that the encrypted text will display on\n    printf(\"Printing encrypted text: \");\n    sleep(2);\n    //Encipher Function\n    for(int i = 0, j = 0, strl = strlen(pt); i &lt; strl; i++)\n    {\n        //Get the letter 'key'\n        int lk = tolower(k[j % kLen]) - 'a';\n        //If the char is uppercase, run the V formula and increment j by 1\n        if isupper(pt[i])\n        {\n            printf(\"%c\", 'A' + (pt[i] - 'A' + lk) % 26);\n            j++;\n        }\n        //If the char is lowercase, run the V formula and increment j by 1\n        else if islower(pt[i])\n        {\n            printf(\"%c\", 'a' + (pt[i] - 'a' + lk) % 26);\n            j++;\n        }\n        //If the char is a symbol just print said symbol\n        else\n        {\n            printf(\"%c\", pt[i]);\n        }\n    }\n    printf(\"\\n\");\n    printf(\"Closing Script...\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>The Encipher Function:\nUses 'A' as a char for the placeholder but does 'A' hold a zero indexed value automatically? (B = 1, C = 2, ...)</p>\n"}, {"tags": ["c", "unix", "emacs", "manual"], "comments": [{"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1550629377, "post_id": 54776710, "comment_id": 96335146, "body": "If you &quot;really&quot; want  to write a man page, this <a href=\"https://liw.fi/manpages/\" rel=\"nofollow noreferrer\">link</a> might get you started."}, {"owner": {"reputation": 8257, "user_id": 3568092, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/mlJHI.png?s=128&g=1", "display_name": "dangom", "link": "https://stackoverflow.com/users/3568092/dangom"}, "edited": false, "score": 0, "creation_date": 1551006267, "post_id": 54776710, "comment_id": 96474435, "body": "Maybe this is what you are looking for <a href=\"https://github.com/tldr-pages/tldr\" rel=\"nofollow noreferrer\">github.com/tldr-pages/tldr</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1550622447, "creation_date": 1550622447, "answer_id": 54776985, "question_id": 54776710, "link": "https://stackoverflow.com/questions/54776710/creating-a-text-file-that-serves-as-a-manual-for-commands-in-unix/54776985#54776985", "title": "Creating a text file that serves as a manual for commands in Unix", "body": "<p>Manually <a href=\"http://manpages.ubuntu.com/manpages/cosmic/en/man7/man.7.html\" rel=\"nofollow noreferrer\">man man</a>, my man.</p>\n\n<pre><code>man man\n</code></pre>\n\n<p>:-)</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 11092103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcf126640e9b906e39b2e076e65d8a2?s=128&d=identicon&r=PG&f=1", "display_name": "Tucker", "link": "https://stackoverflow.com/users/11092103/tucker"}, "is_accepted": false, "score": 1, "last_activity_date": 1550706799, "last_edit_date": 1550706799, "creation_date": 1550705550, "answer_id": 54796906, "question_id": 54776710, "link": "https://stackoverflow.com/questions/54776710/creating-a-text-file-that-serves-as-a-manual-for-commands-in-unix/54796906#54796906", "title": "Creating a text file that serves as a manual for commands in Unix", "body": "<p>Man pages are stored in a man directory often under /usr/share, you can use <code>manpath</code> to find the directories used by your distribution. This directory is usually divided into sub directories man1, man2,... etc corresponding with the man sections and the files are named program_name.1 (where 1 is the section number). For example the man file for <code>cat</code> could be found in <code>/usr/share/man/man1/cat.1</code>.</p>\n\n<p>These files are written using <a href=\"https://en.wikipedia.org/wiki/Troff\" rel=\"nofollow noreferrer\">troff</a> (a typesetting language) with the <a href=\"https://www.gnu.org/software/groff/manual/html_node/man.html#man\" rel=\"nofollow noreferrer\">man</a> macro package. You can view these files directly however they are kind of confusing if you do not understand troff syntax. You can use the command</p>\n\n<pre><code>nroff -man man_file.1\n</code></pre>\n\n<p>to view the typeset version of the manual, in fact the man command basically just finds the man file you are looking for and runs it through nroff and less. You can mimic this functionality with pipes:</p>\n\n<pre><code>nroff -man man_file.1 | less\n</code></pre>\n\n<p>Some systems compress their man files in which case you will need to use <code>gunzip</code> first:</p>\n\n<pre><code>gunzip -c man_file.1.gz | nroff -man | less\n</code></pre>\n\n<p>Therefore to search the man file you can just pipe this output to grep, sed, or even into a file for further processing. One thing to note is that the output of nroff will include some escape sequences for formatting on a terminal, so it might look messy if opened in a text editor, although it will still work with programs like sed.</p>\n\n<p>You can find more information about troff from the following links:</p>\n\n<ul>\n<li><a href=\"https://www.gnu.org/software/groff/\" rel=\"nofollow noreferrer\">Groff</a> The GNU implementation of troff (used on most systems).</li>\n<li><a href=\"http://www.kohala.com/start/troff/troff.html\" rel=\"nofollow noreferrer\">Troff Resources</a> A collection of papers on troff and its various preprocessors.</li>\n<li><a href=\"http://home.windstream.net/kollar/utp/\" rel=\"nofollow noreferrer\">Unix Text Processing</a> A book on troff and other unix based text processing.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10598167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318dbf22964f2974e512aadcf8dadbda?s=128&d=identicon&r=PG&f=1", "display_name": "rave7230", "link": "https://stackoverflow.com/users/10598167/rave7230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550706799, "creation_date": 1550620354, "question_id": 54776710, "link": "https://stackoverflow.com/questions/54776710/creating-a-text-file-that-serves-as-a-manual-for-commands-in-unix", "title": "Creating a text file that serves as a manual for commands in Unix", "body": "<p>Is there anyway to create a textfile that functions the same way the man command works in unix? Essentially creating a formatted textfile that serves the same purpose as the manual from Unix. Is there anyway that I could use the grep or sed command to essentially pull command information from this Manual text file? </p>\n\n<p>If anyone has any resources or any tips for how I could get started or learn how to do this that would be helpful.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1550620054, "post_id": 54776603, "comment_id": 96333031, "body": "<code>&quot;%lu&quot;</code> is for an unsigned long. Use <code>&quot;%ld&quot;</code> for a signed long."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 2, "creation_date": 1550620059, "post_id": 54776603, "comment_id": 96333034, "body": "Could it be, perhaps, that the program is supposed to calculate the result for more than one input?  And that maybe it also expects the output to have line-endings?"}, {"owner": {"reputation": 66, "user_id": 4467472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37ba841cef5355830ddbf0449118d70?s=128&d=identicon&r=PG", "display_name": "LeNiglo", "link": "https://stackoverflow.com/users/4467472/leniglo"}, "edited": false, "score": 0, "creation_date": 1550620256, "post_id": 54776603, "comment_id": 96333971, "body": "On my side, it does work. Just compiled it to test. You should check what your submission says. It might be giving the number as parameter, instead of STDIN; or might want you to return it instead of output it ... That&#39;s my best guess, because the code should work for those numbers."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1550620266, "post_id": 54776603, "comment_id": 96333092, "body": "<i>But the submission keep giving me an error</i>  What <b>specifically</b> is the error?  What is your input, expected output, and actual output?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1550620279, "post_id": 54776603, "comment_id": 96333098, "body": "Indent your code properly next time, please."}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1550620314, "post_id": 54776603, "comment_id": 96333107, "body": "Did you test your code with simple inputs? Like 0, 1, 9, 10, <b>-1, -9, -10</b>?"}, {"owner": {"reputation": 1099, "user_id": 4284015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a8d2e2027d7b0a5c55b9a9df4886ff?s=128&d=identicon&r=PG", "display_name": "Mulli", "link": "https://stackoverflow.com/users/4284015/mulli"}, "edited": false, "score": 0, "creation_date": 1550620438, "post_id": 54776603, "comment_id": 96333149, "body": "I suggest that you use cast: <code>num_ins = (long) num_ins &#47; 10;</code> Because the result is a float"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1099, "user_id": 4284015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a8d2e2027d7b0a5c55b9a9df4886ff?s=128&d=identicon&r=PG", "display_name": "Mulli", "link": "https://stackoverflow.com/users/4284015/mulli"}, "edited": false, "score": 7, "creation_date": 1550620568, "post_id": 54776603, "comment_id": 96333169, "body": "@Mulli No, it&#39;s not.  Division between two integers is an integer."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1550620905, "post_id": 54776603, "comment_id": 96333972, "body": "Well, <a href=\"https://wandbox.org/permlink/P9WGIu2sk4hPW5yA\" rel=\"nofollow noreferrer\">for some relaxed definition of &quot;work&quot;</a>. When the wrong format specifier is used, the behavior is undefined."}, {"owner": {"reputation": 1, "user_id": 5768139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c572a4c7ff1dc57d131f809c769ec56?s=128&d=identicon&r=PG&f=1", "display_name": "xexo", "link": "https://stackoverflow.com/users/5768139/xexo"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1550621147, "post_id": 54776603, "comment_id": 96333973, "body": "@user3386109 actually i had corrected id before i copied to here(forgot to update that part)"}, {"owner": {"reputation": 1, "user_id": 5768139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c572a4c7ff1dc57d131f809c769ec56?s=128&d=identicon&r=PG&f=1", "display_name": "xexo", "link": "https://stackoverflow.com/users/5768139/xexo"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1550621293, "post_id": 54776603, "comment_id": 96333974, "body": "@paddy nop, only 1 number by time"}, {"owner": {"reputation": 1, "user_id": 5768139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c572a4c7ff1dc57d131f809c769ec56?s=128&d=identicon&r=PG&f=1", "display_name": "xexo", "link": "https://stackoverflow.com/users/5768139/xexo"}, "edited": false, "score": 0, "creation_date": 1550621309, "post_id": 54776603, "comment_id": 96333975, "body": "@the error is in the output(in a test automatic created not by me), the answear do nto coincide"}, {"owner": {"reputation": 1, "user_id": 5768139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c572a4c7ff1dc57d131f809c769ec56?s=128&d=identicon&r=PG&f=1", "display_name": "xexo", "link": "https://stackoverflow.com/users/5768139/xexo"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550621316, "post_id": 54776603, "comment_id": 96333976, "body": "@swordfish sorry buddy"}, {"owner": {"reputation": 1, "user_id": 5768139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c572a4c7ff1dc57d131f809c769ec56?s=128&d=identicon&r=PG&f=1", "display_name": "xexo", "link": "https://stackoverflow.com/users/5768139/xexo"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1550621325, "post_id": 54776603, "comment_id": 96333977, "body": "@mkrieger tried that and a shitload of them xD 0 gave me a error at first, but fixed it in that last code"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1550621348, "post_id": 54776603, "comment_id": 96333361, "body": "In any case, I&#39;d suggest also to add a newline at the end of your print statements: <code>printf(&quot;%d\\n&quot;, contador);</code>"}, {"owner": {"reputation": 1, "user_id": 5768139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c572a4c7ff1dc57d131f809c769ec56?s=128&d=identicon&r=PG&f=1", "display_name": "xexo", "link": "https://stackoverflow.com/users/5768139/xexo"}, "reply_to_user": {"reputation": 66, "user_id": 4467472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37ba841cef5355830ddbf0449118d70?s=128&d=identicon&r=PG", "display_name": "LeNiglo", "link": "https://stackoverflow.com/users/4467472/leniglo"}, "edited": false, "score": 0, "creation_date": 1550621555, "post_id": 54776603, "comment_id": 96333978, "body": "@leNiglo tried return, and nop xD"}, {"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 2, "creation_date": 1550622361, "post_id": 54776603, "comment_id": 96333575, "body": "Are you supposed to count the - sign on negative numbers? Do you have to exclude -2^31 that can be coded in the long value? Are your longs actually on 32 bits?"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 2, "creation_date": 1550623143, "post_id": 54776603, "comment_id": 96333762, "body": "It sounds like you&#39;re using an online judge site, and usually those do not want any prompts like your first <code>printf</code> to appear in the output."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550625479, "post_id": 54776603, "comment_id": 96334246, "body": "Note <code>if (num_ins == 0) {         printf(&quot;%d&quot;, 1);     }     else</code> is not needed.  Instead <code>do {             num_ins &#47;= 10;             contador++;         } while (num_ins);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1550625577, "post_id": 54776603, "comment_id": 96334272, "body": "&quot;count the digits of a number&quot; or  &quot;count the characters of a number&quot;?  What should <code>-123</code> report?  What should <code>xyz</code> report? 0?  (try <code>long int num_ins = 0;</code>)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1550647940, "post_id": 54776603, "comment_id": 96340662, "body": "You should post a pointer to the actual online submission site. If not possible, post the problem description from the site."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550649064, "post_id": 54776603, "comment_id": 96341174, "body": "most of the online coding has the first item passed to the program is a counter of how many data items will be passed to the program.  With out the actual link or the actual text, we really cannot help you much"}], "answers": [{"tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": false, "score": 0, "last_activity_date": 1550646912, "creation_date": 1550646912, "answer_id": 54780777, "question_id": 54776603, "link": "https://stackoverflow.com/questions/54776603/printing-the-number-of-digits-of-an-integer/54780777#54780777", "title": "Printing the number of digits of an integer", "body": "<p>First of all, if you are using a 32 bit data type, then the range will be <code>-2^31 to 2^31 -1</code>. </p>\n\n<p>So the maximum positive number will be <code>2^31 = 2147483647</code> and minimum will be <code>-2147483648</code></p>\n\n<p><code>long int</code> is sometimes 64 bits (as is on my PC) so its range will change. Max value will then be <code>9223372036854775807</code></p>\n\n<p>According to your code, </p>\n\n<ul>\n<li><p>If input is <code>2147483647</code>, then output = <code>10</code>. (Correct).</p></li>\n<li><p>If input is <code>9223372036854775807</code> (max valid value) , then output =<br>\n<code>19</code> (Correct).</p></li>\n<li><p>If input is <code>92233720368547758078</code>(exceeds max valid value and has number of digits as 20) , then<br>\noutput = <code>19</code> (Incorrect).</p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 5768139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c572a4c7ff1dc57d131f809c769ec56?s=128&d=identicon&r=PG&f=1", "display_name": "xexo", "link": "https://stackoverflow.com/users/5768139/xexo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1550647514, "creation_date": 1550619623, "last_edit_date": 1550647514, "question_id": 54776603, "link": "https://stackoverflow.com/questions/54776603/printing-the-number-of-digits-of-an-integer", "title": "Printing the number of digits of an integer", "body": "<p>I have to submit this code, the intention is to count the digits of a number and print it (range is from -2<sup>31</sup>+1 to 2<sup>31</sup>-1) and the result must be presented as a single number (for example, given the number 234 it prints 3)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    long int num_ins;\n    int contador = 0;\n\n    printf(\"Inserir numero desejado a avaliar?\\n\"); // asking the number\n    scanf(\"%ld\", &amp;num_ins);\n\n    if (num_ins == 0) {\n        printf(\"%d\", 1);\n    } else {\n        while (num_ins != 0) {\n            num_ins = num_ins / 10;\n            contador++;\n        }\n        printf(\"%d\", contador); //contador is count\n    }\n}\n</code></pre>\n\n<p>But the submission keeps giving me an error, that there are some numbers where it isn't right, and I can't figure it out.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550619055, "post_id": 54776510, "comment_id": 96332766, "body": "You are initializing the address pointed to by <code>x</code> which is declared as being of type <code>int *</code>."}, {"owner": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 0, "creation_date": 1550619056, "post_id": 54776510, "comment_id": 96332767, "body": "How would you expect <code>int *x; x = 10;</code> to work?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1550619177, "post_id": 54776510, "comment_id": 96332797, "body": "Initializing a variable in C requires a compatible rvalue to the to-be-initialized id. <code>int *x</code> declares a pointer-to-int. <code>10</code> is int, not pointer-to-int. If you expect otherwise you&#39;re misinformed, as those are simply the rules of the language. It may be the position and usage of the asterisk that is throwing you off; <code>int *x;</code> indicates a pointer-to-int declaration. <code>printf(&quot;%d&quot;, *x);</code> uses it as a <i>dereference</i> operator. There is a significant difference (obviously)."}], "answers": [{"tags": [], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "is_accepted": false, "score": 1, "last_activity_date": 1550619205, "creation_date": 1550619205, "answer_id": 54776551, "question_id": 54776510, "link": "https://stackoverflow.com/questions/54776510/why-cant-i-set-a-value-of-a-pointer-int-x-to-say-10/54776551#54776551", "title": "Why can&#39;t I set a value of a pointer int *x to, say, 10?", "body": "<p>int *x means ---- x is integer pointer type.</p>\n\n<p>and 10 is a integer type.</p>\n\n<p>in your case, you are trying to assign an \"integer\" type to \" integer pointer\" type, which is not valid because of two different types.</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "is_accepted": false, "score": 2, "last_activity_date": 1550619657, "creation_date": 1550619657, "answer_id": 54776612, "question_id": 54776510, "link": "https://stackoverflow.com/questions/54776510/why-cant-i-set-a-value-of-a-pointer-int-x-to-say-10/54776612#54776612", "title": "Why can&#39;t I set a value of a pointer int *x to, say, 10?", "body": "<p>int* x -> x is a memory adress for an Integer, type (int*).</p>\n\n<p>if you do *x it displays the content because * is a operand, a memory operand that shows what is stored in that memory adress, and (int*) is a type of data,a pointer to something in the memory, very different.</p>\n\n<p>Hope I explained it quickly. Good coding.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1550619851, "creation_date": 1550619851, "answer_id": 54776643, "question_id": 54776510, "link": "https://stackoverflow.com/questions/54776510/why-cant-i-set-a-value-of-a-pointer-int-x-to-say-10/54776643#54776643", "title": "Why can&#39;t I set a value of a pointer int *x to, say, 10?", "body": "<p>Your confusion has to do with the difference between an initialization and an assignment.  These are examples of initialization:</p>\n\n<pre><code>int a = 5;    // valid; \"a\" is an int which is initialized with the value 5\nint *b = &amp;a;  // valid; \"b\" is an int * which is initialized with the address of \"a\"\nint *c = 10;  // invalid; \"c\" is an int * which is initialized with the value 10\n</code></pre>\n\n<p>While these are assignments:</p>\n\n<pre><code>a = 5;    // valid; \"a\" is assigned the value 5\nb = &amp;a;   // valid; \"b\" is assigned the address of \"a\"\n*b = 10;  // valid; \"b\" points to \"a\", and the value \"b\" points to is set to 10\n</code></pre>\n\n<p>Note that the use of <code>*</code> differs between the two.  In an initalization <code>*</code> means that the given variable is a pointer, while <code>*</code> in an assignment (or any expression) means that the pointer is dereferenced.</p>\n"}], "owner": {"reputation": 1604, "user_id": 8326382, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fca60030cf663d714d5d2fe3701e46f?s=128&d=identicon&r=PG&f=1", "display_name": "danielschnoll", "link": "https://stackoverflow.com/users/8326382/danielschnoll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 54776643, "answer_count": 3, "score": 3, "last_activity_date": 1550619851, "creation_date": 1550618928, "question_id": 54776510, "link": "https://stackoverflow.com/questions/54776510/why-cant-i-set-a-value-of-a-pointer-int-x-to-say-10", "title": "Why can&#39;t I set a value of a pointer int *x to, say, 10?", "body": "<p>I'm severely misunderstanding pointers, so hopefully someone can clarify this please. </p>\n\n<p><code>int *x;</code> is a pointer to an int. <code>x</code> refers to the pointer itself, and <code>*x</code> refers to the <strong>value</strong> (or target) stored at x's memory location.</p>\n\n<p>If I want x to point to an int, who's value is 10, why can't I do <code>int *x = 10;</code>?</p>\n\n<p>I don't quite understand why when we do something like <code>printf(\"%d\", *x);</code>, it prints out the value stored at x but we can't do <code>int *x = 10;</code></p>\n"}, {"tags": ["c++", "c", "header", "include"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1550618856, "post_id": 54776489, "comment_id": 96332714, "body": "Using GCC, the <code>-H</code> option lists the headers included, with nesting level indicated too.  You need to specify which compiler you&#39;re using though; what works for GCC will probably work for Clang, but probably won&#39;t work for other compilers."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550619753, "post_id": 54776489, "comment_id": 96332939, "body": "It&#39;s GCC, on a package with <code>.&#47;configure</code>. I got the command line used during compilation via <code>make V=1</code>. I wouldn&#39;t be sure how to apply <code>-H</code> here."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1550620697, "post_id": 54776489, "comment_id": 96333196, "body": "Try <code>.&#47;configure CC=&#39;gcc -H&#39;</code>.  Don&#39;t use that permanently, but it will get the C compiler set to include <code>-H</code>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1550621164, "post_id": 54776489, "comment_id": 96333312, "body": "FWIW, per the current sources (I googled the project) sha1-git.c doesn&#39;t seem to reference stdint.h at all. Looks like a programmer bug to me, probably relying on transitive includes through string.h or arpa/inet.h (in sha1-git.h). Are you <i>sure</i> it&#39;s including a stdint.h at all? Your question seems predicated on you having determined this already. Otherwise I think you should get in touch with the developers."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1550621291, "post_id": 54776489, "comment_id": 96333341, "body": "Aaaaaand <a href=\"https://github.com/aircrack-ng/aircrack-ng/blob/master/src/sha1-git.c#L42\" rel=\"nofollow noreferrer\">it&#39;s been fixed on master since the last release, 1.5.2</a> (<a href=\"https://github.com/aircrack-ng/aircrack-ng/commit/fc4cedcb448cddb5d75d0b6d28c976ade25ea899\" rel=\"nofollow noreferrer\">commit</a>; unlucky, that&#39;s barely a month later)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1550621473, "post_id": 54776489, "comment_id": 96333387, "body": "Now I don&#39;t know what to do! That&#39;s the answer to your problem, but not (at all) to your question. Let me know if you want to (a) delete this, (b) reframe this, or (c) leave this as it is for broader interest. I&#39;ll migrate my comment to an answer in the case of (b), as it will then be one."}, {"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 0, "creation_date": 1550621937, "post_id": 54776489, "comment_id": 96333472, "body": "my two cents; the question is still interesting in its general form. (Don&#39;t know if it already has a dupe answer though)"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1550621940, "post_id": 54776489, "comment_id": 96333473, "body": "Once upon a time, I was trying to fix a coding problem on a major project (&gt; 100 programmers at my site).  Using  -H, I discovered 5 files (of several hundred) shared the name &quot;foo.h&quot; ... and my problem was tangled into this.  I was directed to move my change from path4/foo.h to path2/foo.h and to not fix any of the other foo.h."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1550652175, "post_id": 54776489, "comment_id": 96342751, "body": "@LightnessRacesinOrbit - Please see updated OP."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1550658192, "post_id": 54776489, "comment_id": 96346388, "body": "Your update doesn&#39;t seem to address the fact that I literally found the bug? Why are you still looking for a specific <code>stdint.h</code>? Your build commands/output show that you are building 1.5.2, which has the bug."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1550686618, "post_id": 54776489, "comment_id": 96363662, "body": "@LightnessRacesinOrbit - I think there is no bug in the package. The package simply does not have <code>#include &lt;stdint.h&gt;&quot;</code> statements, nor recognition of linux/msys2. When you posted your comment, I had already found out I needed such an include, and I had added it (even if I did not mention it). It&#39;s only that I thought the error came from the compilation of one file (which puzzled me), while it actually came from the compilation of a different file (with the same name). Perhaps all this is more clear with the latest minor edit."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550733684, "post_id": 54776489, "comment_id": 96379434, "body": "in *inx environments, you can use the <code>which</code> command to have the shell tell you the actual path to the indicated file, that was/is used"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1550747745, "post_id": 54776489, "comment_id": 96387773, "body": "@sancho.s That an include file is missing <i>is</i> the bug! If you&#39;d already added it then that definitely should have been mentioned."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550820196, "post_id": 54776489, "comment_id": 96418774, "body": "@user3629249 - I guess <code>which</code> serves a different purpose:&lt;br&gt; <code>$ which --help</code>&lt;br&gt; <code>Usage: which [options] [--] COMMAND [...]</code>&lt;br&gt; <code>Write the full path of COMMAND(s) to standard output.</code>&lt;br&gt; Could you give an example of the way you would use it?"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1550625735, "last_edit_date": 1550625735, "creation_date": 1550625379, "answer_id": 54777368, "question_id": 54776489, "link": "https://stackoverflow.com/questions/54776489/find-which-file-was-used-by-an-include-directive/54777368#54777368", "title": "Find which file was used by an include directive", "body": "<p><sub><em>Transferring material from comments to an answer and expanding it.</em></sub></p>\n\n<p>Using GCC, the <code>-H</code> option lists the headers included, with nesting level indicated too. You need to specify which compiler you're using though; what works for GCC will probably work for Clang, but probably won't work for other compilers.</p>\n\n<p>Since you're using an autoconfiscated project and GCC, you have at least two options for how to get the information for a specific file.</p>\n\n<ol>\n<li><p>Broad \u2014 not specific:</p>\n\n<pre><code>./configure CC='gcc -H'\n</code></pre>\n\n<p>This sets the C compiler to <code>gcc -H</code>, which will be noisy.  It may be sensible to do it anyway, but probably only if the problem occurs during the configuration stage (unless the caveats in the next option end up applying).</p></li>\n<li><p>Narrow \u2014 specific file:</p>\n\n<pre><code>make \u2026normal options\u2026   CC='gcc -H' problemchild.o\n</code></pre>\n\n<p>This sets the C compiler to <code>gcc -H</code> while compiling the specific problem child source file.  This can be more difficult to achieve than you'd expect if you're dealing with a project with source code in multiple directories, or if the source is in one directory and the object code in another, or some of the other variations that build systems use.</p></li>\n</ol>\n\n<p>Either way, or using any variant, the key part of the idea is that you tell the system that the name of your compiler is <code>gcc -H</code> rather than just <code>gcc</code>.  This can normally be made to work.  Occasionally, a system will use a Make macro name other than CC for the C compiler (and the macro name used for a C++ compiler can vary too).  In that case, you have to ferret out the name it uses (<code>./configure CC=/opt/gcc/bin/gcc</code> for example usually works, but you may need to find where <code>/opt/gcc/bin/gcc</code> is used and futz with the makefile(s) accordingly.</p>\n\n<p>Stop using the <code>-H</code> option as soon as you can.  It produces copious output on big systems.  That can be several hundred lines of header on the builds I do, for example.  However, using it can be quite informative.</p>\n"}], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 54777368, "answer_count": 1, "score": 0, "last_activity_date": 1550686702, "creation_date": 1550618797, "last_edit_date": 1550686702, "question_id": 54776489, "link": "https://stackoverflow.com/questions/54776489/find-which-file-was-used-by-an-include-directive", "title": "Find which file was used by an include directive", "body": "<p>Is there a way to get the absolute path of the file read by an <code>#include &lt;hdr.h&gt;</code> directive?\nAnd for an <code>#include \"hdr.h\"</code> directive?\nI am working under Win 10 / Msys2.</p>\n\n<p>I mean to find which <code>stdint.h</code> is found during compilation of <code>src/sha1-git.c</code>, since:</p>\n\n<ol>\n<li><p>It should declare <code>uint32_t</code> and apparently it's not doing it, as per what I get with</p>\n\n<pre><code>$ make -V=1\n\n/bin/sh ../../libtool  --tag=CC   --mode=compile gcc -DPACKAGE_NAME=\\\"aircrack-ng\\\" -DPACKAGE_TARNAME=\\\"aircrack-ng\\\" -DPACKAGE_VERSION=\\\"1.5.2\\\" -DPACKAGE_STRING=\\\"aircrack-ng\\ 1.5.2\\\" -DPACKAGE_BUGREPORT=\\\"https://forum.aircrack-ng.org\\\" -DPACKAGE_URL=\\\"\\\" -DPACKAGE=\\\"aircrack-ng\\\" -DVERSION=\\\"1.5.2\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DLT_OBJDIR=\\\".libs/\\\" -D_REVISION=\\\"1.5.2\\\" -DHAVE_OPENSSL_CRYPTO_H=1 -DHAVE_OPENSSL_CMAC_H=1 -DHAVE_OPENSSL_CMAC_H=1 -DHAVE_SQLITE3_H=1 -DHAVE_SQLITE3=1 -DHAVE_SQLITE=1 -D_FILE_OFFSET_BITS=64 -DHAVE_PTHREAD_PRIO_INHERIT=1 -D_REENTRANT=1 -DHAVE___MINGW_ALIGNED_MALLOC=1 -DCACHELINE_SIZE=64 -DINTEL_ASM=1 -DCACHELINE_SIZE=64 -I.  -I../.. -I../../src/include -I../../src   -DCYGWIN -DMSYS2 -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_FORTIFY_SOURCE=2 -pthread   -Wall -O3 -std=gnu99 -fno-strict-aliasing -Wpointer-arith -Wstrict-overflow=2 -Wstrict-prototypes -fvisibility=hidden -Wno-unused-but-set-variable -Wno-array-bounds  -mconsole -mwindows -DMSYS2 -MT libaircrack_crypto_la-sha1-git.lo -MD -MP -MF .deps/libaircrack_crypto_la-sha1-git.Tpo -c -o libaircrack_crypto_la-sha1-git.lo `test -f 'sha1-git.c' || echo './'`sha1-git.c\nlibtool: compile:  gcc -DPACKAGE_NAME=\\\"aircrack-ng\\\" -DPACKAGE_TARNAME=\\\"aircrack-ng\\\" -DPACKAGE_VERSION=\\\"1.5.2\\\" \"-DPACKAGE_STRING=\\\"aircrack-ng 1.5.2\\\"\" -DPACKAGE_BUGREPORT=\\\"https://forum.aircrack-ng.org\\\" -DPACKAGE_URL=\\\"\\\" -DPACKAGE=\\\"aircrack-ng\\\" -DVERSION=\\\"1.5.2\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DLT_OBJDIR=\\\".libs/\\\" -D_REVISION=\\\"1.5.2\\\" -DHAVE_OPENSSL_CRYPTO_H=1 -DHAVE_OPENSSL_CMAC_H=1 -DHAVE_OPENSSL_CMAC_H=1 -DHAVE_SQLITE3_H=1 -DHAVE_SQLITE3=1 -DHAVE_SQLITE=1 -D_FILE_OFFSET_BITS=64 -DHAVE_PTHREAD_PRIO_INHERIT=1 -D_REENTRANT=1 -DHAVE___MINGW_ALIGNED_MALLOC=1 -DCACHELINE_SIZE=64 -DINTEL_ASM=1 -DCACHELINE_SIZE=64 -I. -I../.. -I../../src/include -I../../src -DCYGWIN -DMSYS2 -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_FORTIFY_SOURCE=2 -pthread -Wall -O3 -std=gnu99 -fno-strict-aliasing -Wpointer-arith -Wstrict-overflow=2 -Wstrict-prototypes -fvisibility=hidden -Wno-unused-but-set-variable -Wno-array-bounds -mconsole -mwindows -DMSYS2 -MT libaircrack_crypto_la-sha1-git.lo -MD -MP -MF .deps/libaircrack_crypto_la-sha1-git.Tpo -c sha1-git.c  -DDLL_EXPORT -DPIC -o .libs/libaircrack_crypto_la-sha1-git.o\nsha1-git.c: In function 'blk_SHA1_Final':\nsha1-git.c:328:21: error: 'uint32_t' undeclared (first use in this function); did you mean 'wint_t'?\n  padlen[0] = htonl((uint32_t)(ctx-&gt;size &gt;&gt; 29));\n</code></pre></li>\n</ol>\n\n<p><strong>EDIT</strong></p>\n\n<ol start=\"2\">\n<li>There are quite a few <code>stdint.h</code> in the subdirectory tree of my Msys2, as candidates. I <em>should</em> be able to trace \"by hand\" which <code>stdint.h</code> is included by checking the compilation command line, the order include directories are listed, etc., and I did it several times before.\nBut I mean to do this automatically, to avoid errors.</li>\n</ol>\n\n<p>PS: Since I am under Msys2, I changed (recursively) all occurrences of\n<code>#include &lt;arpa/inet.h&gt;</code>\nby\n<code>#include &lt;winsock.h&gt;</code>\nin <code>src/*.h</code> and <code>src/*.c</code>.\nIn file <code>src/sha1-git.c</code> I added\n<code>#include &lt;stdint.h&gt;</code>\nright after that (inserting line 43) to get <code>uint32_t</code>.</p>\n\n<p>PS2: <strong>There was another file <code>src/aircrack-crypto/sha1-git.c</code> which did not have\n<code>#include &lt;stdint.h&gt;</code>.\nCompilation of this file was the problem. I added the <code>#include ...</code> in this other file and compilation proceeded</strong>.</p>\n\n<p>PS3: I mean to make this work, so perhaps the answer to this specific OP is only one step ahead towards the goal, but not enough...\n<strong>EDIT 2</strong> Confirmed.\nAfter having to execute <code>make V=1 CFLAGS=\"-I/usr/include\" LDFLAGS=\"-L/usr/lib\"</code> (otherwise, no <code>sys/wait.h</code> was found during compilation of <code>common.c</code>),  I got </p>\n\n<pre><code>.../MSYS2Portable/App/msys32/mingw64/x86_64-w64-mingw32/include/winsock.h:309:34: error: conflicting types for 'gethostname'                                                                                                                                                                       \n   WINSOCK_API_LINKAGE int WSAAPI gethostname(char *name,int namelen);                                                                                                    \n                                  ^~~~~~~~~~~                                                                                                                             \nIn file included from .../MSYS2Portable/App/msys32/usr/include/unistd.h:4,                                               \n                 from common.c:42:                                                                                                                                        \n.../MSYS2Portable/App/msys32/usr/include/sys/unistd.h:300:6: note: previous declaration of 'gethostname' was here        \n  int gethostname (char *__name, size_t __len);                                                                                                                           \n      ^~~~~~~~~~~                                                                                                                                                         \nmake[2]: *** [Makefile:713: libaircrack_util_la-common.lo] Error 1                                                                                                        \n</code></pre>\n\n<p>It seems files in <code>mingw64/x86_64-w64-mingw32/include</code> are not consistent with files in <code>usr/include</code>.\nAnd there is no <code>sys/wait.h</code> in <code>mingw64/x86_64-w64-mingw32/include</code>, so I have to also add <code>usr/include</code> in the search path, giving me problems.</p>\n\n<p>I would likely give up compiling under Msys2, and I would get a vbox.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 4, "creation_date": 1550616588, "post_id": 54776034, "comment_id": 96332113, "body": "<code>int *x[5]</code> and <code>int x[5][5]</code> are <i>completely</i> different.  The first is an array of pointers, whereas the second is a 2D array."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 4, "last_activity_date": 1550618365, "last_edit_date": 1550618365, "creation_date": 1550617238, "answer_id": 54776217, "question_id": 54776034, "link": "https://stackoverflow.com/questions/54776034/pass-an-array-located-in-heap-to-a-func-in-c/54776217#54776217", "title": "Pass An Array Located in Heap to a Func in C", "body": "<p>The compiler gives a pretty good clue:</p>\n\n<pre><code>~$ gcc mat.c \nmat.c: In function \u2018main\u2019:\nmat.c:22:12: warning: passing argument 1 of \u2018modify\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n     modify(x, 5, 5);\n            ^\nmat.c:3:17: note: expected \u2018int (*)[5]\u2019 but argument is of type \u2018int **\u2019\n void modify(int x[5][5], int m, int n) {\n             ~~~~^~~~~~~\n</code></pre>\n\n<p>The declaration <code>int x[5][5]</code> declares an array of arrays. That's something completely different from <code>int *x[5];</code> which declares an array of pointers. Fun fact: Add parenthesis like this <code>int (*x)[5]</code> and you will instead get a pointer to an int array of size 5. Here is a good site that translates C declarations to English: <a href=\"https://cdecl.org/\" rel=\"nofollow noreferrer\">https://cdecl.org/</a></p>\n\n<blockquote>\n  <p>Is there a difference between passing an array located in stack and an array located in heap?</p>\n</blockquote>\n\n<p>Dynamically allocated memory <em>usually</em> ends up on the heap, while the rest <em>usually</em> goes to the stack. However, this is just an implementation detail, and nothing in the C standard requires either a heap or a stack to exist at all. </p>\n\n<p>When you're passing an array to a function it will <em>decay</em> to a pointer to it's first element. The function will have no idea of where the data is (hmmm, well since the pointer has the actual address it does, but it does not know about heap or stack) or how it was allocated. So consider this code snippet:</p>\n\n<pre><code>void setToZero(int * arr, int size) {\n    for(int i=0; i&lt;size; i++) arr[i] = 0;\n}\n</code></pre>\n\n<p>The function will have EXACTLY the same effect for both <code>x</code> and <code>y</code>:</p>\n\n<pre><code>int x[10];\nint *y = malloc(10 * sizeof *y);\nsetToZero(x);\nsetToZero(y);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9213, "user_id": 1105562, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oV4rn.jpg?s=128&g=1", "display_name": "david.pfx", "link": "https://stackoverflow.com/users/1105562/david-pfx"}, "is_accepted": false, "score": 1, "last_activity_date": 1553177536, "creation_date": 1553177536, "answer_id": 55282388, "question_id": 54776034, "link": "https://stackoverflow.com/questions/54776034/pass-an-array-located-in-heap-to-a-func-in-c/55282388#55282388", "title": "Pass An Array Located in Heap to a Func in C", "body": "<p>It may help to recall that there are no arrays in C, only pointers and blocks of memory. The rest is compiler fakery.</p>\n\n<p>Your main program allocates a block of memory for 5 <code>*int</code> pointers (called <code>x</code>) on the stack and 5 blocks of 5 <code>int</code>s on the heap. It calls the function with a pointer to the beginning of x, and relies on the function to perform the correct pointer arithmetic to access the other blocks correctly.</p>\n\n<p>The first two functions are equivalent in this case (that's not always true), and the pointer arithmetic correctly matches the allocations. The third function incorrectly performs pointer arithmetic to address 25 ints arranged 5x5, so the first 5 stores overwrite a <code>*int</code> by an <code>int</code> and the 6th access is out of bounds (assuming <code>int</code> and <code>*int</code> are the same size).</p>\n\n<p>I've explained it this way to emphasise the necessity to understand the relationship between arrays and pointer arithmetic in C. If you really understand this you won't need to ask questions like this again.</p>\n"}], "owner": {"reputation": 33, "user_id": 11087032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f04fd8c576023766cbc9668d71d02ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Z.", "link": "https://stackoverflow.com/users/11087032/jason-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 54776217, "answer_count": 2, "score": 3, "last_activity_date": 1553177536, "creation_date": 1550616022, "last_edit_date": 1550616678, "question_id": 54776034, "link": "https://stackoverflow.com/questions/54776034/pass-an-array-located-in-heap-to-a-func-in-c", "title": "Pass An Array Located in Heap to a Func in C", "body": "<p>Consider the following code:</p>\n\n<pre><code>int main(void) {\n    int *x[5];\n\n    for(int i = 0; i &lt; 5; i++) {\n        x[i] = malloc(sizeof(int) * 5);\n    }\n    for(int i = 0; i &lt; 5; i++) {\n        for(int j = 0; j &lt; 5; j++) {\n            x[i][j] = i * j;\n        }\n    }\n    modify(x, 5, 5);\n    return 0; \n}\n</code></pre>\n\n<p>Which of the implementations of method modify below set all elements of the matrix x to zero?</p>\n\n<ol>\n<li>\n\n<pre><code>void modify(int **x, int m, int n) {\n    for (int i = 0; i &lt; m; i++) {\n        for (int j = 0; j &lt; n; j++) {\n            x[i][j] = 0;\n        }\n    }\n}\n</code></pre></li>\n<li>\n\n<pre><code>void modify(int *x[], int m, int n) {\n    for (int i = 0; i &lt; m; i++) {\n        for (int j = 0; j &lt; n; j++) {\n            x[i][j] = 0;\n        }\n    }\n}\n</code></pre></li>\n<li>\n\n<pre><code>void modify(int x[5][5], int m, int n) {\n    for (int i = 0; i &lt; m; i++) {\n        for (int j = 0; j &lt; n; j++) {\n            x[i][j] = 0;\n        }\n    }\n}\n</code></pre></li>\n</ol>\n\n<p>I'm quite confused about why the third option is not correct. Is there a difference between passing an array located in stack and an array located in heap?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 2, "creation_date": 1550616254, "post_id": 54776001, "comment_id": 96332022, "body": "Note there is no conventional line-ending format that uses <code>\\n\\r</code>. Windows uses <code>\\r\\n</code> and *nix use <code>\\n</code>"}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1550616409, "post_id": 54776001, "comment_id": 96332073, "body": "How does <code>arrayvalues.txt</code> look like? I assume you are trying to load each line in the array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550616430, "post_id": 54776001, "comment_id": 96332081, "body": "You&#39;re overwriting <code>prod</code> every time you read a line, not making a copy. And <code>strtok()</code> just returns a pointer into the string. So all your array elements point to that same string that&#39;s being overwritten."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1550616448, "post_id": 54776001, "comment_id": 96332086, "body": "strtok is going to return a pointer to <code>prod</code> and modify the contents of <code>prod</code>.  you are always storing prod to array[i].  you are also modifying the contents of <code>prod</code> every time inside your while loop via fgets.  thus all the prints will be the same.  also, you don&#39;t terminate your last array value with NULL to indicate the end."}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1550616672, "post_id": 54776001, "comment_id": 96332142, "body": "@GovindParmar - True and that&#39;s what that parameter is doing he detects both \\n and \\r so he works in both systems. He doesnt look for \\n\\r together but divided if this makes sense."}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1550616755, "post_id": 54776001, "comment_id": 96332164, "body": "@balki - Yes, the content does not matter, it is less then 10 chars long tho."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 1, "creation_date": 1550616937, "post_id": 54776001, "comment_id": 96332225, "body": "Try <code>strdup(strtok(...))</code> And initialize the array like <code>char* array[200000] = {0}</code>"}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1550617071, "post_id": 54776001, "comment_id": 96332251, "body": "@MFisherKDX that&#39;s right, thank you. I thought he returned a new pointer in memory each time."}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1550617216, "post_id": 54776001, "comment_id": 96332286, "body": "@balki - Yap, allocating memory with strdup solves the problem! Thank you man! My bad"}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1550617715, "post_id": 54776001, "comment_id": 96332404, "body": "@balki Why the initialization? strtok puts the &#39;\\0&#39; allways in the end"}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1550618018, "post_id": 54776001, "comment_id": 96332488, "body": "In the for-loop, you are checking if <code>array[i]</code> is NULL. You don&#39;t need it if you check for end of strings using a different condition like in the answer. <code>for(j = 0; j &lt; i ;++j)</code>"}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1550618679, "post_id": 54776001, "comment_id": 96332665, "body": "@GovindParmar - If Im not wrong /r in *nix means new line and /n in windows and I dont want to preserve the new lines, I explained it poorly. Thank you."}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1550618750, "post_id": 54776001, "comment_id": 96332681, "body": "@Barmar - Yap that was the problem, thought strtok generated a new pointer and allocated new memory."}], "answers": [{"comments": [{"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 1, "creation_date": 1550617639, "post_id": 54776196, "comment_id": 96332378, "body": "man page says <code>bzero</code> is deprecated. <code>The bzero() function is deprecated (marked  as  LEGACY  in  POSIX.1-2001);  use  memset(3)  in  new  programs.</code>"}, {"owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "edited": false, "score": 0, "creation_date": 1550617938, "post_id": 54776196, "comment_id": 96332457, "body": "Is using the 2D array more efficient then using an 1D pointer array? Your version is very good, but I wanted to escape the 2D array version."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1550617960, "post_id": 54776196, "comment_id": 96332466, "body": "<code>char array[200000][11];</code> may blow the stack on some OS&#39;s and memory models."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1550619463, "post_id": 54776196, "comment_id": 96332873, "body": "@DavidC.Rankin True, but so can <code>char* array[200000]</code>"}], "tags": [], "owner": {"reputation": 177, "user_id": 9499535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Horacio Goetendia", "link": "https://stackoverflow.com/users/9499535/horacio-goetendia"}, "is_accepted": false, "score": 1, "last_activity_date": 1550617809, "last_edit_date": 1550617809, "creation_date": 1550617063, "answer_id": 54776196, "question_id": 54776001, "link": "https://stackoverflow.com/questions/54776001/array-of-strings-in-c-obtained-by-reading-a-file-and-displaying-it/54776196#54776196", "title": "Array of Strings in C obtained by reading a file and displaying it", "body": "<p>Using your coding style try this (please adjust the hard coded values to your needs)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main () {\n\n    int i = 0, j = 0;\n    char array[200000][11];\n    char prod [10]; \n    char *ptr;\n\n    memset(array, 0, sizeof(array));\n\n    FILE * fp = fopen (\"arrayValues.txt\", \"r\");\n\n    while (fgets(prod, 10, fp) != NULL) {\n\n        ptr = strtok(prod, \"\\n\\r\");\n        snprintf(array[i], sizeof(array[i]) , ptr);\n        printf(\"%s\\n\", array[i]);\n        i++;\n\n    }\n\n    fclose(fp); \n\n    printf(\"============\\n\");\n\n    for (j = 0; j &lt; i; j++){ \n        printf(\"%s  %d\\n\", array[j], j);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11087006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EE0Lr9Mqvbk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMEwkdrLgpVjBZzNeShTFAKIvExHQ/mo/photo.jpg?sz=128", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11087006/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1550617809, "creation_date": 1550615791, "question_id": 54776001, "link": "https://stackoverflow.com/questions/54776001/array-of-strings-in-c-obtained-by-reading-a-file-and-displaying-it", "title": "Array of Strings in C obtained by reading a file and displaying it", "body": "<p>I wanna store an array of Strings and display it like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main () {\n\n    int i = 0;\n    char* array[200000];\n    char prod [10]; \n\n    FILE * fp = fopen (\"arrayValues.txt\", \"r\");\n\n    while (fgets(prod, 10, fp) != NULL) {\n\n        array[i] = strtok(prod, \"\\n\\r\");\n        i++;\n\n    }\n\n    fclose(fp); \n\n\n    for (i = 0; array[i] ; i++) {\n\n        printf(\"%s  %d\\n\", array[i], i);\n\n    }\n\n\n\n}\n</code></pre>\n\n<p>but the output is only the last line of the file im working with x times.\nSuggestions?</p>\n"}, {"tags": ["c", "time", "casting"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4212212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dd942dbc8fd776b9dc213c5df2f6708?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Null", "link": "https://stackoverflow.com/users/4212212/colin-null"}, "edited": false, "score": 0, "creation_date": 1550625597, "post_id": 54776395, "comment_id": 96334276, "body": "Thank you, that actually fixed my issue. It makes sense to me as well. I wasn\u2019t getting passed a null so it defaulted to time implementation"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 2, "last_activity_date": 1550618248, "creation_date": 1550618248, "answer_id": 54776395, "question_id": 54775930, "link": "https://stackoverflow.com/questions/54775930/modifying-the-time-function-in-c/54776395#54776395", "title": "Modifying the time function in C", "body": "<p>You're not implementing the entire functionality of <code>time()</code>.  The code your interposing on may use functionality that you have not implemented.</p>\n\n<p><a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.27.2.4\" rel=\"nofollow noreferrer\">Per the C standard</a>:</p>\n\n<blockquote>\n  <p><strong>7.27.2.4 The time function</strong> (note the bolded part):</p>\n  \n  <p><strong>Synopsis</strong></p>\n\n<pre><code>     #include &lt;time.h&gt;\n     time_t time(time_t *timer);\n</code></pre>\n  \n  <p><strong>Description</strong></p>\n  \n  <p>The time function determines the current calendar time. The encoding\n  of the value is unspecified.</p>\n  \n  <p><strong>Returns</strong></p>\n  \n  <p>The time function returns the implementation's best approximation to\n  the current calendar time. The value (time_t)(-1) is returned if the\n  calendar time is not available. <strong>If timer is not a null pointer, the\n  return value is also assigned to the object it points to.</strong></p>\n</blockquote>\n\n<p>A full implementation, based on your code:</p>\n\n<pre><code>time_t time (time_t *t)\n{\n    long int seconds = 1485907200;\n    time_t modifiedTime = (time_t) seconds;\n\n    if ( t )\n    {\n        *t = modifiedTime;\n    }\n\n    return modifiedTime;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 11037415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bf02f74eedf41415ca599581624192?s=128&d=identicon&r=PG&f=1", "display_name": "aminosbh", "link": "https://stackoverflow.com/users/11037415/aminosbh"}, "is_accepted": false, "score": 0, "last_activity_date": 1550618667, "creation_date": 1550618667, "answer_id": 54776458, "question_id": 54775930, "link": "https://stackoverflow.com/questions/54775930/modifying-the-time-function-in-c/54776458#54776458", "title": "Modifying the time function in C", "body": "<p>In fact, there is no problem in the code that you presented. I tested it with the following basic program:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n    printf(\"%ld\\n\", (long) time(NULL));\n}\n</code></pre>\n\n<p>So I just run <code>LD_PRELOAD=./newtime.so ./test</code> and I get the expected result.</p>\n\n<p>However, the <code>date</code> command doesn't make call to the <code>time</code> function. It calls instead <code>int clock_gettime(clockid_t clk_id, struct timespec *tp)</code>. So you should better re-implement them both if you would like to cover this case.</p>\n\n<p>May be a simple implementation like the following one (It works fine with <code>date</code>):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int clock_gettime(clockid_t clk_id, struct timespec *tp)\n{\n    if(tp) {\n        tp-&gt;tv_sec = 1485907200;\n        tp-&gt;tv_nsec = 0;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>If you get a date different from your expectation, it could be related to your time zone.</p>\n"}], "owner": {"reputation": 111, "user_id": 4212212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dd942dbc8fd776b9dc213c5df2f6708?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Null", "link": "https://stackoverflow.com/users/4212212/colin-null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 54776395, "answer_count": 2, "score": 3, "last_activity_date": 1550618667, "creation_date": 1550615428, "question_id": 54775930, "link": "https://stackoverflow.com/questions/54775930/modifying-the-time-function-in-c", "title": "Modifying the time function in C", "body": "<p>For a computer security assignment, I have to modify the time function in order to return a specific date. I need the time function to return a date between Jan 1st, 2016 and June 15th, 2018. I then use these commands to overload and hook into the time function:</p>\n\n<pre><code>gcc -Wall -fPIC -shared -o newtime.so newtime.c -ldl\nexport LD_PRELOAD=$PWD/newtime.so\n</code></pre>\n\n<p>Here is my modified version of the time function:</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;dlfcn.h&gt;\n#include &lt;time.h&gt;\n\ntime_t time (time_t *t)\n{\n    long int seconds = 1485907200;\n    time_t modifiedTime = (time_t) seconds;\n    return modifiedTime;\n}\n</code></pre>\n\n<p>Whenever I run this implementation, it says that the date being returned is December 31, 1969 19:00:00. Am I just formatting the time since the Linux Epoch incorrectly or am I making a more serious mistake? I have tried using a regular int instead of a long int, and still experience the same issues. Some insight into my mistake would be very helpful. </p>\n"}, {"tags": ["c", "parallel-processing"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550649455, "post_id": 54775920, "comment_id": 96341364, "body": "when compiling, always enable the warnings, then fix those warnings. ( for <code>gcc</code>, at a minimum use: `-Wall -Wextra -Wconversion -pedantic -std=gnu111 )  Note: other compilers use different options to perform the same functionality"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550650036, "post_id": 54775920, "comment_id": 96341672, "body": "when executing a sub process, like: <code>sum2b()</code>  The code should not just run off the end of the sub process, Rather, use: <code>exit( EXIT_SUCCESS )</code>  Otherwise, the sub process is still executing when the execution path returns to where the sub process was called."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550650204, "post_id": 54775920, "comment_id": 96341742, "body": "regarding this kind of code sequence: `\t\t\tpid_t pid3 = fork(); \t\t\tif(pid3==0) \t\t\t{ \t\t\t\tsum4b(); \t\t\t} \t\t\t \t\t\telse \t\t\t{ \t\t\t\tsum3b(); \t\t\t\twait(NULL); \t\t\t}`  what about when the call to <code>fork()</code> fails?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550650613, "post_id": 54775920, "comment_id": 96341963, "body": "regarding this code block: <code>} else {              &#47;&#47;parent process         sum1b(array);         wait(NULL);</code>  The way the code is written, there is no guarantee that all the sub processes have completed So any timing will only apply to the first sub process.  Suggest having <code>main() start all sub processes, then </code>wait()` in a loop until all sub processes have exited"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550650757, "post_id": 54775920, "comment_id": 96342040, "body": "Suggest: avoid the timing and data collection problems of using sub processes.  Just use 4 threads and use the <code>attr</code> parameter in <code>pthread_create()</code> to set the &#39;affinity&#39; of each thread to a different CPU core"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550650965, "post_id": 54775920, "comment_id": 96342159, "body": "it is unlikely that the sum of all the digits in a 1/2 billion will fit into a <code>long int</code>  This is something that needs to be confirmed"}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": false, "score": 0, "last_activity_date": 1550645751, "creation_date": 1550645751, "answer_id": 54780508, "question_id": 54775920, "link": "https://stackoverflow.com/questions/54775920/adding-results-of-parallel-processes-to-shared-memory/54780508#54780508", "title": "Adding results of parallel processes to shared memory", "body": "<p>You can use <code>mmap</code> to allocate shared memory, <br></p>\n\n<pre><code>long *array;\narray=(long *)mmap(NULL, sizeof(long)*4, PROT_READ|PROT_WRITE,\n                   MAP_SHARED|MAP_ANONYMOUS, -1, 0);\n</code></pre>\n\n<p>The modified code is as follows:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;sys/mman.h&gt;\n\nvoid sum1b(long *psum); //sum 1 to 1 billion\nvoid sum2b(long *psum); //sum 1 billion to 2 billion\nvoid sum3b(long *psum); //sum 1 to 1 billion\nvoid sum4b(long *psum); //sum 1 billion to 2 billion\n\nint main()\n{\n    int status, i;\n    long sum = 0;\n    long *array;\n\n    //timer\n    struct timeval start, end;\n    long mtime, seconds, useconds;\n\n    gettimeofday(&amp;start, NULL); //timer\n    array=(long *)mmap(NULL, sizeof(long)*4, PROT_READ|PROT_WRITE,\n                        MAP_SHARED|MAP_ANONYMOUS, -1, 0);\n    pid_t pid1 = fork();\n\n    if(pid1 &lt; 0) {        //fork failed\n        fprintf(stderr, \"Fork Failed!\");\n        return 1;\n    } else if(pid1 == 0) { //child process\n        pid_t pid2 = fork();\n        if(pid2==0) {\n            pid_t pid3 = fork();\n            if(pid3==0) {\n                sum4b(array);\n            } else {\n                sum3b(array);\n                wait(NULL);\n            }\n        } else {\n            sum2b(array);\n            wait(NULL);\n        }\n    } else {              //parent process\n        sum1b(array);\n        wait(NULL);\n\n        for(i=0; i&lt;4; i++) {\n            printf(\"array[%d]=%ld\\n\", i, array[i]);\n            sum += array[i];\n        }\n\n        gettimeofday(&amp;end, NULL); //timer\n        //timer\n        seconds  = end.tv_sec  - start.tv_sec;\n        useconds = end.tv_usec - start.tv_usec;\n        mtime = ((seconds) * 1000 + useconds/1000.0) + 0.5;\n        printf(\"Elapsed time: %ld milliseconds on pid=%d sum=%ld\\n\", mtime, pid1, sum);\n\n        munmap(array, sizeof(long)*4);\n    }\n\n    return 0;\n}\n\nvoid sum1b(long *psum)\n{\n    long sum =0;\n    for(int i=1; i&lt;500000000; i++) {\n        sum += i;\n    }\n    psum[0] = sum;\n    printf(\"The sum of 1 to 0.5b is: %ld\\n\", sum);\n}\n\nvoid sum2b(long *psum)\n{\n    long sum =0;\n    for(int i=500000000; i&lt;1000000000; i++) {\n        sum += i;\n    }\n    psum[1] = sum;\n    printf(\"The sum of 0.5b to 1b is: %ld\\n\", sum);\n}\n\nvoid sum3b(long *psum)\n{\n    long sum =0;\n    for(int i=1000000000; i&lt;1500000000; i++) {\n        sum += i;\n    }\n    psum[2] = sum;\n    printf(\"The sum of 1b to 1.5b is: %ld\\n\", sum);\n}\n\nvoid sum4b(long *psum)\n{\n    long sum =0;\n    for(int i=1500000000; i&lt;2000000000; i++) {\n        sum += i;\n    }\n    psum[3] = sum;\n    printf(\"The sum of 1.5b to 2b is: %ld\\n\", sum);\n}\n</code></pre>\n\n<p>However, this scenario is recommended to use multithreading.<br>\nGood luck!</p>\n"}], "owner": {"reputation": 11, "user_id": 11086967, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-181Lef95SL4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmPualxF1-kcYiRPrkYD40bSSoFQ/mo/photo.jpg?sz=128", "display_name": "Jordan Lacob", "link": "https://stackoverflow.com/users/11086967/jordan-lacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550645751, "creation_date": 1550615358, "question_id": 54775920, "link": "https://stackoverflow.com/questions/54775920/adding-results-of-parallel-processes-to-shared-memory", "title": "Adding results of parallel processes to shared memory", "body": "<p>In my class we are currently learning about parallel processing. We're writing in C and using Linux command line.</p>\n\n<p>In our exercise, we are adding the sum of numbers from 0 to 2 billion.</p>\n\n<p>So far, we've taken a serial approach where you calculate the results of 0-1 billion and 1-2 billion then sum those. </p>\n\n<p>We also broke those 2 tasks into a parallel approach, halving the running time.</p>\n\n<p>We then broke it into 4 processes (our machines in class have 4-cores) each adding 1/4 of 2 billion, then having the parent function sum them all together, which halved the run time again. This code in C is included here.</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/time.h&gt;\n\nvoid sum1b(); //sum 1 to 1 billion\nvoid sum2b(); //sum 1 billion to 2 billion\nvoid sum3b(); //sum 1 to 1 billion\nvoid sum4b(); //sum 1 billion to 2 billion\n\nint main(){\n  int status;\n  pid_t pid1 = fork();\n\n  //timer\n  struct timeval start, end;\n  long mtime, seconds, useconds;  \n  gettimeofday(&amp;start, NULL); //timer\n\n  if(pid1 &lt; 0){         //fork failed\n    fprintf(stderr, \"Fork Failed!\");\n    return 1;\n  }else if(pid1 == 0){  //child process\n    pid_t pid2 = fork();\n    if(pid2==0){\n        pid_t pid3 = fork();\n        if(pid3==0){\n            sum4b();\n        }else{\n            sum3b();\n            wait(NULL);\n        }\n    }else{\n      sum2b();\n      wait(NULL);\n    }\n  }else{               //parent process\n    sum1b();\n    wait(NULL);\n\n    gettimeofday(&amp;end, NULL); //timer\n    //timer\n    seconds  = end.tv_sec  - start.tv_sec;\n    useconds = end.tv_usec - start.tv_usec;\n    mtime = ((seconds) * 1000 + useconds/1000.0) + 0.5;\n    printf(\"Elapsed time: %ld milliseconds on pid=%d\\n\", mtime, pid1); \n  }\n\n  return 0;\n}\n\nvoid sum1b(){\n  long sum =0;\n  for(int i=1;i&lt;500000000;i++){\n    sum += i;\n  }\n  printf(\"The sum of 1 to 0.5b is: %ld\\n\", sum);\n}\n\nvoid sum2b(){\n  long sum =0;\n  for(int i=500000000;i&lt;1000000000;i++){\n    sum += i;\n  }\n  printf(\"The sum of 0.5b to 1b is: %ld\\n\", sum);\n}\nvoid sum3b(){\n  long sum =0;\n  for(int i=1000000000;i&lt;1500000000;i++){\n    sum += i;\n  }\n  printf(\"The sum of 1 to 1.5b is: %ld\\n\", sum);\n}\n\nvoid sum4b(){\n  long sum =0;\n  for(int i=1500000000;i&lt;2000000000;i++){\n    sum += i;\n  }\n  printf(\"The sum of 1.5b to 2b is: %ld\\n\", sum);\n}\n</code></pre>\n\n<p>How would I go about adding each of the results to a shared memory space, then having the parent result collect all the partial results and return the final result?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550613641, "post_id": 54775577, "comment_id": 96331152, "body": "How do you run it?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1550613674, "post_id": 54775577, "comment_id": 96331169, "body": "<code>if (argc &gt; 2)</code> seems like it should have an appropriate home somewhere before you  use those <code>argv</code> dereferences, don&#39;t you think? Regardless, a <i>debugger</i> is a tool literally <i>made</i> for rooting out problems like this. Use one."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550613703, "post_id": 54775577, "comment_id": 96331184, "body": "What is it even supposed to do? You read a character into <code>i</code>, but then you use it as a loop counter."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1550613777, "post_id": 54775577, "comment_id": 96331217, "body": "<code>printf(&quot;%s&quot;, buffer[i]);</code> - You are passing a <code>char</code> instead of <code>char*</code>. Please don&#39;t tell me there is no warnings about it."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1550614151, "post_id": 54775577, "comment_id": 96331347, "body": "the management concerning <i>addy</i>  is out of my imagination, in the best case you initialize it with the FILE * (on the &#39;else&#39; branch it is not initialized) then you print it and increment it each time you read a char in the file, do you think to increment a FILE * has a meaning ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1550614304, "post_id": 54775577, "comment_id": 96331398, "body": "in your code <code>fopen() == NULL</code> =&gt; <code>printf(&quot;Error: File Empty.\\n&quot;)</code> !"}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1550614486, "post_id": 54775577, "comment_id": 96331457, "body": "<a href=\"https://stackoverflow.com/q/33047452/10396\">How to debug a segfault</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1550615032, "post_id": 54775577, "comment_id": 96331631, "body": "<code>faults before this print</code> No, it almost certainly <b>doesn&#39;t</b>.  <code>printf()</code> to <code>stdout</code> is buffered, so the output won&#39;t be printed until the output buffer is flushed."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550732146, "post_id": 54775577, "comment_id": 96378764, "body": "OT: regarding: <code>#include &quot;xbd.c&quot;</code>  Never include a *.c file.  Rather compile the *.c files separately then link them together"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550732353, "post_id": 54775577, "comment_id": 96378858, "body": "OT: never access beyond <code>argv[0]</code> with out first checking <code>argc</code> to assure the user actually entered the desired command line parameter(s)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550732789, "post_id": 54775577, "comment_id": 96379060, "body": "OT: regarding: <code>printf(&quot;Error: File Empty.\\n&quot;);</code> error messages should be output to <code>stderr</code>, not <code>stdout</code> and when the error indication comes from a C library function should also output (to <code>stderr</code>) the text reason the system thinks the error occurred.  The function: <code>perror()</code> outputs both your error message and the text reason the system thinks the error occurred"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550732887, "post_id": 54775577, "comment_id": 96379101, "body": "when <code>#include</code>ing any home grown header files, always post the contents of those files as part of your question."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550733127, "post_id": 54775577, "comment_id": 96379197, "body": "Please correct your posted code until it cleanly compiles. When compiling, always enable the warnings, then fix those warnings. (for gcc, at a minimum use: -Wall -Wextra -Wconversion -pedantic -std=gnu11 ) Note other compilers use different options to perform the same results"}], "answers": [{"tags": [], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "is_accepted": true, "score": 1, "last_activity_date": 1550616020, "last_edit_date": 1550616020, "creation_date": 1550615224, "answer_id": 54775899, "question_id": 54775577, "link": "https://stackoverflow.com/questions/54775577/cant-find-segmentation-fault-happens-in-either-case-before-the-first-print/54775899#54775899", "title": "Cant find segmentation fault. Happens in either case before the first print", "body": "<p>I cleaned up your compiler warnings. Seems the code now works as expected. In the future, clean up your compiler warnings and learn to use <code>gdb</code> or other debugger.</p>\n\n<p>Also, before you use argv[] you MUST check to make sure enough arguments are actually provided on the command line.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar hexForm(int current_byte);\nchar binForm(int current_byte);\n\n\n\nint main(int argc, char *argv[]){\n    int i;\n    int counter = 0;\n    char *addy;\n    char buffer[16];\n\n    if(argc &lt; 2 )  /* the actual correct usage here is left up to OP */\n    {\n        printf(\"Invalid parameters\\n\")\n        return(0);\n    }\n\n\n    //If the user wishes for binary output command arg 2 will be '-b'\n    if(strcmp(argv[1], \"-b\") == 0){\n        FILE *f = fopen(argv[2], \"r\");\n        addy = (char*) f;\n        //Check for valid file\n        if(f == NULL){\n            printf(\"Error: File Empty.\\n\");\n            return(-1);\n        }\n        //print starting address, faults before this print\n        printf(\"%p: \", (void*)&amp;f);\n        while((i = fgetc(f)) != EOF){\n            //While there are contents in the file, dump in binary groups of 6 chars\n            if(counter == 6){\n                //print human readable string here\n                printf(\" \");\n                for(int i = 0; i &lt; 6; i++){\n                    printf(\"%c\", buffer[i]);\n                }\n                printf(\"\\n\");\n                printf(\"%p: \", (void*)&amp;addy);\n                counter = 0;\n            }\n            buffer[counter] = binForm(i);\n            counter++;\n            addy++;\n        }\n        fclose(f);\n    }\n    //If not binary, output will be in Hex\n    else{\n        FILE *f = fopen(argv[1], \"r\");\n        //addy = (char*) f;\n        //Check for valid file\n        if(f == NULL){\n            printf(\"Error: File Empty.\\n\");\n            return(-1);\n        }\n        //Print starting address, faults before this print\n        printf(\"%p: \", (void*)&amp;f);\n        while((i = fgetc(f)) != EOF){\n            //While file has contents, dump in hex groups of 16 chars\n            if(counter == 16){\n                printf(\" \");\n                //print human readable string here\n                for(int i = 0; i &lt; 16; i++){\n                    printf(\"%c\", buffer[i]);\n                }\n                printf(\"\\n\");\n                printf(\"%p: \", (void*)&amp;addy);\n                counter = 0;\n            }\n            if(counter%2 == 1){\n                buffer[counter] = hexForm(i);\n                printf(\" \");\n            }\n            else{\n                buffer[counter] = hexForm(i);\n            }\n            counter++;\n            addy++;\n        }\n        fclose(f);\n    }\n}\n\nchar hexForm(int current_byte){\n    //Print hex digits for one byte\n    printf(\"%X\", current_byte);\n    //If unprintable, convert to '.'\n    if(current_byte &lt; 33)\n        current_byte = 46;\n    return (char)current_byte;\n}\nchar binForm(int current_byte){\n    //Print binary digits for one byte\n    while (current_byte) {\n    if (current_byte &amp; 1)\n        printf(\"1\");\n    else\n        printf(\"0\");\n\n    current_byte &gt;&gt;= 1;\n    }\n    //If unprintable, convert to '.'\n    if(current_byte &lt; 33)\n        current_byte = 46;\n    return (char)current_byte;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11086891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-arxNUTttYMQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPx4mDuPsntqiTR7Vwj-E-Jbald9g/mo/photo.jpg?sz=128", "display_name": "Anon", "link": "https://stackoverflow.com/users/11086891/anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 54775899, "answer_count": 1, "score": 1, "last_activity_date": 1550616020, "creation_date": 1550613500, "question_id": 54775577, "link": "https://stackoverflow.com/questions/54775577/cant-find-segmentation-fault-happens-in-either-case-before-the-first-print", "title": "Cant find segmentation fault. Happens in either case before the first print", "body": "<p>Included is the main and then the implementation of the hex and binary dump, my main concern is with the main. The code is in C. It compiles without error. Im being told to add more details because the post is mostly code but i thought i got my point across. Im looking for whatever is causing the segmentation fault. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"xbd.h\"\n#include \"xbd.c\"\n\nint main(int argc, char *argv[]){\n    int i;\n    int counter = 0;\n    char *addy;\n    char buffer[16];\n\n    //If the user wishes for binary output command arg 2 will be '-b'\n    if(strcmp(argv[1], \"-b\") == 0){\n        FILE *f = fopen(argv[2], \"r\");\n        addy = (char*) f;\n        //Check for valid file\n        if(f == NULL){\n            printf(\"Error: File Empty.\\n\");\n            return(-1);\n        }\n        //print starting address, faults before this print\n        printf(\"%p: \", (void*)&amp;f);\n        while((i = fgetc(f)) != EOF){\n            //While there are contents in the file, dump in binary groups of 6 chars\n            if(counter == 6){\n                //print human readable string here\n                printf(\" \");\n                for(int i = 0; i &lt; 6; i++){\n                    printf(\"%s\", buffer[i]);\n                }\n                printf(\"\\n\");\n                printf(\"%p: \", (void*)&amp;addy);\n                counter = 0;\n            }\n            buffer[counter] = binForm(i);\n            counter++;\n            addy++;\n        }\n        fclose(f);\n    }\n    //If not binary, output will be in Hex\n    else{\n        FILE *f = fopen(argv[1], \"r\");\n        //addy = (char*) f;\n        //Check for valid file\n        if(f == NULL){\n            printf(\"Error: File Empty.\\n\");\n            return(-1);\n        }\n        //Print starting address, faults before this print\n        printf(\"%p: \", (void*)&amp;f);\n        while((i = fgetc(f)) != EOF){\n            //While file has contents, dump in hex groups of 16 chars\n            if(counter == 16){\n                printf(\" \");\n                //print human readable string here\n                for(int i = 0; i &lt; 16; i++){\n                    printf(\"%s\", buffer[i]);\n                }\n                printf(\"\\n\");\n                printf(\"%p: \", (void*)&amp;addy);\n                counter = 0;\n            }\n            if(counter%2 == 1){\n                buffer[counter] = hexForm(i);\n                printf(\" \");\n            }\n            else{\n                buffer[counter] = hexForm(i);\n            }\n            counter++;\n            addy++;\n        }\n        fclose(f);\n    }\n}\n\nchar hexForm(int current_byte){\n    //Print hex digits for one byte\n    printf(\"%X\", current_byte);\n    //If unprintable, convert to '.'\n    if(current_byte &lt; 33)\n        current_byte = 46;\n    return (char)current_byte;\n}\nchar binForm(int current_byte){\n    //Print binary digits for one byte\n    while (current_byte) {\n    if (current_byte &amp; 1)\n        printf(\"1\");\n    else\n        printf(\"0\");\n\n    current_byte &gt;&gt;= 1;\n    }\n    //If unprintable, convert to '.'\n    if(current_byte &lt; 33)\n        current_byte = 46;\n    return (char)current_byte;\n}\n</code></pre>\n\n<p>Why is it faulting? I tried commenting some of the early stuff out to see if it goes through but the first couple lines of code result in seg fault. The purpose of the program is to read a file and then changed the text to hex or binary coded output depending on command line argument \"-b\".</p>\n"}, {"tags": ["c", "objective-c", "objective-c-blocks", "swift-protocols"], "comments": [{"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550614344, "post_id": 54775394, "comment_id": 96331410, "body": "A Block is an object, so <code>@</code> is correct. Have a look at my answers to similar questions: <a href=\"https://stackoverflow.com/a/36162832/603977\">stackoverflow.com/a/36162832/603977</a> and <a href=\"https://stackoverflow.com/a/17892240/603977\">stackoverflow.com/a/17892240/603977</a>"}, {"owner": {"reputation": 11, "user_id": 11086841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ec75b9d900f06d4a61a38689f66c97?s=128&d=identicon&r=PG&f=1", "display_name": "user11086841", "link": "https://stackoverflow.com/users/11086841/user11086841"}, "reply_to_user": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550614952, "post_id": 54775394, "comment_id": 96331604, "body": "@JoshCaswell Unfortunately, it does not work. I tried <code>WSSBlockInvocation * block_invocation = [WSSBlockInvocation invocationWithSignature:[WSSBlockSignature signatureForBlock:(__bridge id)(block)]];</code> where <code>block</code> is from the question text above. It gives an <code>EXC_BAD_ACCESS</code> because <code>block</code> is NULL."}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550615024, "post_id": 54775394, "comment_id": 96331626, "body": "Yes, you need an actual instance of the Block to use <code>signatureForBlock:</code>"}, {"owner": {"reputation": 11, "user_id": 11086841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ec75b9d900f06d4a61a38689f66c97?s=128&d=identicon&r=PG&f=1", "display_name": "user11086841", "link": "https://stackoverflow.com/users/11086841/user11086841"}, "reply_to_user": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550615161, "post_id": 54775394, "comment_id": 96331672, "body": "@JoshCaswell How can I do that? I&#39;ve been stuck on this issue for days :/"}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550618039, "post_id": 54775394, "comment_id": 96332493, "body": "Can you explain <i>why</i> you&#39;re trying to do this? It might help; there might be another way."}, {"owner": {"reputation": 11, "user_id": 11086841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ec75b9d900f06d4a61a38689f66c97?s=128&d=identicon&r=PG&f=1", "display_name": "user11086841", "link": "https://stackoverflow.com/users/11086841/user11086841"}, "reply_to_user": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550618383, "post_id": 54775394, "comment_id": 96332592, "body": "I have a list of protocols (100s) with methods that\u2019d I\u2019d like to get the signature for (instead of doing it manually). I know this functionality does exist but I\u2019m not sure how to do it."}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550618495, "post_id": 54775394, "comment_id": 96332612, "body": "Instead of doing <i>what</i> manually? What do you actually need the signature for?"}, {"owner": {"reputation": 11, "user_id": 11086841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ec75b9d900f06d4a61a38689f66c97?s=128&d=identicon&r=PG&f=1", "display_name": "user11086841", "link": "https://stackoverflow.com/users/11086841/user11086841"}, "reply_to_user": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550620291, "post_id": 54775394, "comment_id": 96333103, "body": "Instead of manually looking at each method and determining its protocol. I can technically make a python script that reads the header file and determine the signature, but I\u2019d like to do this natively in Obj-C. I just want to be able to do it for the sake of learning and maybe use it in the future if needed."}, {"owner": {"reputation": 11, "user_id": 11086841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ec75b9d900f06d4a61a38689f66c97?s=128&d=identicon&r=PG&f=1", "display_name": "user11086841", "link": "https://stackoverflow.com/users/11086841/user11086841"}, "reply_to_user": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550678538, "post_id": 54775394, "comment_id": 96359277, "body": "@JoshCaswell See my answer below. One function got the job done :)"}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1550688212, "post_id": 54775394, "comment_id": 96364494, "body": "Cool, nice find!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11086841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ec75b9d900f06d4a61a38689f66c97?s=128&d=identicon&r=PG&f=1", "display_name": "user11086841", "link": "https://stackoverflow.com/users/11086841/user11086841"}, "is_accepted": false, "score": 1, "last_activity_date": 1550678496, "creation_date": 1550678496, "answer_id": 54790532, "question_id": 54775394, "link": "https://stackoverflow.com/questions/54775394/get-nsmethodsignature-of-a-method-block-in-a-protocol/54790532#54790532", "title": "Get NSMethodSignature of a method block in a Protocol", "body": "<p>Finally found the answer: <code>const char *_protocol_getMethodTypeEncoding(Protocol *, SEL, BOOL isRequiredMethod, BOOL isInstanceMethod);</code></p>\n\n<p>The method will get you the full signature of any selector!</p>\n"}, {"comments": [{"owner": {"reputation": 814, "user_id": 868270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b403bfdd4a45c940b9c13bf04b311c9?s=128&d=identicon&r=PG", "display_name": "Augusto Dias Noronha", "link": "https://stackoverflow.com/users/868270/augusto-dias-noronha"}, "edited": false, "score": 0, "creation_date": 1581948709, "post_id": 58096148, "comment_id": 106597427, "body": "I tried using <code>_Block_signature</code> but it doesn&#39;t work. Do I have to import some framework to find it? I tried googling this function but I&#39;m not finding anything, and Apple&#39;s doc turn up nothing."}], "tags": [], "owner": {"reputation": 55634, "user_id": 983912, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8bccd55617e47290df57895b2d57359e?s=128&d=identicon&r=PG", "display_name": "Leo Natan", "link": "https://stackoverflow.com/users/983912/leo-natan"}, "is_accepted": false, "score": 0, "last_activity_date": 1569409733, "last_edit_date": 1569409733, "creation_date": 1569406707, "answer_id": 58096148, "question_id": 54775394, "link": "https://stackoverflow.com/questions/54775394/get-nsmethodsignature-of-a-method-block-in-a-protocol/58096148#58096148", "title": "Get NSMethodSignature of a method block in a Protocol", "body": "<p>There is also</p>\n\n<pre><code>extern const char* _Block_signature(id block);\n</code></pre>\n\n<p>which you can use for any arbitrary block object. </p>\n"}], "owner": {"reputation": 11, "user_id": 11086841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ec75b9d900f06d4a61a38689f66c97?s=128&d=identicon&r=PG&f=1", "display_name": "user11086841", "link": "https://stackoverflow.com/users/11086841/user11086841"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1569409733, "creation_date": 1550612621, "last_edit_date": 1550613607, "question_id": 54775394, "link": "https://stackoverflow.com/questions/54775394/get-nsmethodsignature-of-a-method-block-in-a-protocol", "title": "Get NSMethodSignature of a method block in a Protocol", "body": "<p>I'm trying to get the signature of a block in a Protocol method.</p>\n\n<p>Here's a sample protocol:</p>\n\n<pre><code>@protocol ProtocolSample &lt;NSObject&gt;\n- (void) doSomething: (void (^) (NSString *))a_block;\n@end\n</code></pre>\n\n<p>I am able to get the signature of <code>doSomething</code> using the following:</p>\n\n<pre><code>Protocol *protocol_sample = @protocol(ProtocolSample);\n\nunsigned int outCount;\nstruct objc_method_description *method_description_list = protocol_copyMethodDescriptionList(protocol_sample, YES, YES, &amp;outCount);\n\nstruct objc_method_description method_description = method_description_list[0];\n\nNSMethodSignature *signature = [NSMethodSignature signatureWithObjCTypes:method_description.types];\n</code></pre>\n\n<p>The signature I get is: <code>v@:@?</code></p>\n\n<p>My goal is to get the signature of the <code>a_block</code>. I've tried many methods including the following:</p>\n\n<pre><code>NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:signature];\n\nvoid *block;\n[invocation getArgument:&amp;block atIndex:2];\n</code></pre>\n\n<p>But <code>block</code> is always <code>NULL</code>.</p>\n\n<p>How is it possible to get the signature of <code>a_block</code>?</p>\n"}, {"tags": ["c", "linux", "cflow"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1550613245, "post_id": 54775386, "comment_id": 96331012, "body": "A static analyzer can&#39;t know which calls will be performed at the runtime. There can be some function pointers assigned with different functions based on the runtime information (different inputs?) and this will be totally evaded from this type of software."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1550613967, "post_id": 54775386, "comment_id": 96331287, "body": "<code>cflow</code> will not follow tables of function pointers, or function pointer variables."}], "owner": {"reputation": 33, "user_id": 10276450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c061214f5032c7b0aa153f6946b5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Sida", "link": "https://stackoverflow.com/users/10276450/sida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550612581, "creation_date": 1550612581, "question_id": 54775386, "link": "https://stackoverflow.com/questions/54775386/does-cflow-generate-a-sound-call-graph-from-c-programs", "title": "Does cflow generate a sound call graph from C programs?", "body": "<p>By \"sound\"ness, I mean that it has all the edges that are possible at runtime.</p>\n"}, {"tags": ["c", "c-strings", "stdio", "strcpy"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1550610437, "post_id": 54774912, "comment_id": 96329898, "body": "If you want to <i>copy</i> strings, you will have to use <code>strcpy</code>. This is the C way to copy strings. Of course you can have an array of <i>pointers</i> which are simply pointing to different parts of your original string."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1550610450, "post_id": 54774912, "comment_id": 96329904, "body": "Enable all your compiler warnings, and address the problems they reveal."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550731742, "post_id": 54774912, "comment_id": 96378594, "body": "in the second code example, the only output will be: &#39;txt&#39;    I.E. neither code example will output what your question states as the desired output"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550731805, "post_id": 54774912, "comment_id": 96378619, "body": "in the first code example, the ONLY output from the code will be the <code>t</code> not that whole array of outputs."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1550610687, "creation_date": 1550610687, "answer_id": 54774985, "question_id": 54774912, "link": "https://stackoverflow.com/questions/54774912/c-split-string-and-enter-into-array/54774985#54774985", "title": "C - split string and enter into array", "body": "<p>The <code>parts</code> array should be an array of pointers, not a 2-dimensional array of characters:</p>\n\n<pre><code>char *parts[2];\n</code></pre>\n\n<p>Then you assign:</p>\n\n<pre><code>parts[i] = name;\n</code></pre>\n\n<p>If you want to copy from the input string to <code>parts</code>, you need to declare the 2nd dimension large enough for the largest possible string:</p>\n\n<pre><code>char parts[2][10];\n</code></pre>\n\n<p>and then you should use <code>strcpy()</code> rather than assignment to copy it.</p>\n\n<pre><code>strcpy(parts[i], name);\n</code></pre>\n\n<p>Notice that you don't give a second index to <code>parts</code> when doing this, that's only used to access specific characters of the string, not the string as a whole.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1550613194, "last_edit_date": 1550613194, "creation_date": 1550611777, "answer_id": 54775208, "question_id": 54774912, "link": "https://stackoverflow.com/questions/54774912/c-split-string-and-enter-into-array/54775208#54775208", "title": "C - split string and enter into array", "body": "<p>In case separating a file name from its extension is actually relevant to whatever you're trying to accomplish, I'll assume you're using Windows and point you to the documentation for the recommended Windows API library for this, <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/pathcch/\" rel=\"nofollow noreferrer\"><code>&lt;pathcch.h&gt;</code></a>.</p>\n\n<p>With regard to your actual question, your first code doesn't work because:</p>\n\n<ol>\n<li>You're assigning to a single character in the line <code>parts[i][5] = name;</code>. You're also overflowing since <code>parts[i]</code> has the type <code>char [5]</code>, which only has positions <code>0</code> to <code>4</code>.</li>\n<li>You redeclare <code>name</code> as a single <code>char</code> rather than a <code>char *</code> pointer, which is the correct type, and was declared as such (correctly) outside the loop scope. Your new variable <code>char name</code> overwrites the existing <code>char *name</code> variable.</li>\n</ol>\n\n<p>You cannot get around using <code>strcpy</code>-family functions to assign to a character array for this (and most other) use cases.  The only time the syntax <code>char foo[] = \"Hello World\";</code> is valid is immediately on declaration. Also, string literals are stored in read-only memory.</p>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 9499535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Horacio Goetendia", "link": "https://stackoverflow.com/users/9499535/horacio-goetendia"}, "is_accepted": false, "score": 0, "last_activity_date": 1550612814, "last_edit_date": 1550612814, "creation_date": 1550611881, "answer_id": 54775233, "question_id": 54774912, "link": "https://stackoverflow.com/questions/54774912/c-split-string-and-enter-into-array/54775233#54775233", "title": "C - split string and enter into array", "body": "<p>Following your coding style, this is the solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char str[] = \"titanic.txt\";\n    char delim[] = \".\";\n    char parts[2][10];\n    char *ptr = strtok(str, delim);\n    int i = 0;\n\n    for (i = 0; i &lt; 2; i++){\n        if(ptr != NULL)\n        {                \n            snprintf(parts[i], sizeof(parts[0])  ,\"%s\", ptr);\n            ptr = strtok(NULL, delim);\n        }\n    }\n\n    printf(\"'%s'\\n\", parts[0]);\n    printf(\"'%s'\\n\", parts[1]);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11077036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iYc3s1UYNNA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPU7xHuVIUGaZVQ1lkZeeWQsR5IXQ/mo/photo.jpg?sz=128", "display_name": "Dylan Edmonds", "link": "https://stackoverflow.com/users/11077036/dylan-edmonds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2017, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1550613194, "creation_date": 1550610353, "question_id": 54774912, "link": "https://stackoverflow.com/questions/54774912/c-split-string-and-enter-into-array", "title": "C - split string and enter into array", "body": "<p>I am currently trying to handle string in C and I am having trouble placing the split values of a string into an array. Bellow is the code I have created in an attempt to achieve this. </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;string.h&gt;\n\n int main(){\n     char str[]=\"titanic.txt\";\n     char parts[2][5];\n     char *name = strtok(str, \".\");\n     for (int i = 0; i &lt; 2; i++){\n          parts[i][5] = name;\n          char name = strtok(NULL, \".\");\n\n     }\n     printf(\"%c\\n\", str[0]);\n     return 0;\n  }\n</code></pre>\n\n<p>The output I would be expecting from this would hopefully look something like this. </p>\n\n<pre><code> char part[2][10]{\n     {'t', 'i', 't', 'a', 'n', 'i', 'c'},\n     {'t', 'x', 't'}\n };\n</code></pre>\n\n<p>alternatively, I have tried something like this using string copy as such.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;string.h&gt;\n\n int main(){\n     char str[]=\"titanic.txt\";\n     char parts[2][10];\n     char *name = strtok(str, \".\");\n     for (int i = 0; i &lt; 2; i++){\n         strcpy(parts[i], name);\n         name = strtok(NULL, \".\");\n\n      }\n     printf(\"%s\\n\", parts[1]);\n     return 0;\n }\n</code></pre>\n\n<p>Which, did what I want it to, but I would like to try and achieve this without string copy because I feel it will help me understand strings, characters, and arrays better. I do not want to reinvent the wheel I just want a deeper understanding.</p>\n"}, {"tags": ["c", "operating-system"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550608584, "post_id": 54774481, "comment_id": 96329100, "body": "Your logic is not clear. Better move it outside the <code>fork</code> loop. Best - to a dedicated function."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 3, "creation_date": 1550608716, "post_id": 54774481, "comment_id": 96329163, "body": "<code>fork</code>, especially, requires consistent indentation."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 11037415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bf02f74eedf41415ca599581624192?s=128&d=identicon&r=PG&f=1", "display_name": "aminosbh", "link": "https://stackoverflow.com/users/11037415/aminosbh"}, "is_accepted": true, "score": 1, "last_activity_date": 1550611775, "creation_date": 1550611775, "answer_id": 54775206, "question_id": 54774481, "link": "https://stackoverflow.com/questions/54774481/finding-the-level-of-a-child-process-in-a-process-tree/54775206#54775206", "title": "Finding the level of a child process in a process tree", "body": "<p>The intended process tree is the following:</p>\n\n<pre><code>0\n|-&gt;1\n|  |-&gt;2\n|  |  |-&gt;3\n|  |\n|  |-&gt;2\n|\n|-&gt;1\n|  |-&gt;2\n|\n|-&gt;1\n</code></pre>\n\n<p>So to be able to print the level of each process, we should just initialize the <code>level</code> variable to <code>0</code> <strong>outside</strong> the main <code>for</code> loop and just increment its value each time a child process is created.</p>\n\n<p>The following code will print the level of each child process as expected:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main()\n{\n  pid_t baseID = getpid();\n  printf(\"Base Process ID: %d, level: 0 \\n\", baseID);\n\n  int level = 0;\n\n  for (int i = 0; i &lt; 3; i++) {\n\n    pid_t pid = fork();\n\n    if (pid == 0) { // Child\n\n      pid_t childID = getpid();\n      pid_t parentID = getppid();\n\n      level++;\n\n      printf(\"Process ID: %d, Parent ID: %d, level: %d \\n\", getpid(), getppid(), level);\n\n    } else { // Parent\n      wait(NULL);\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11086599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2591f0c12432d667239f8d81d12cc6?s=128&d=identicon&r=PG&f=1", "display_name": "fion_", "link": "https://stackoverflow.com/users/11086599/fion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "accepted_answer_id": 54775206, "answer_count": 1, "score": 2, "last_activity_date": 1550611775, "creation_date": 1550608371, "last_edit_date": 1550611774, "question_id": 54774481, "link": "https://stackoverflow.com/questions/54774481/finding-the-level-of-a-child-process-in-a-process-tree", "title": "Finding the level of a child process in a process tree", "body": "<p>I've been trying to create a process tree using fork() and print each child's level (0 for base process, 1 for its child, 2 for its grandchild etc.) in the tree. The code below only works for depth 0 and 1. Any idea how I can improve it?\nThanks.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\nint i;\nint main()\n{\n    pid_t baseID = getpid();\n    printf(\"Base Process ID: %d, level: 0 \\n\", baseID);\n    for (i = 0; i &lt; 3; i++) {\n        int level = 1;\n        pid_t pid;\n        pid = fork();\n        if (pid == 0) {\n            pid_t childID = getpid();\n            pid_t parentID = getppid();\n            if (parentID == baseID) {\n                level = 1;\n            }\n            else {\n                // do something for grandchildren here\n                level++;\n            }\n            printf(\"Process ID: %d, Parent ID: %d, level: %d \\n\", getpid(), getppid(), level);\n        }\n        else {\n            wait(NULL);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1550609280, "post_id": 54774450, "comment_id": 96329404, "body": "You are going to take a pointer to a command line argument, split it and store both parts back where they came from. I don&#39;t think so.  Better <code>malloc</code> a group of 50 character blocks, (to match the size of <code>temp</code>)  and copy your half strings into those.  Then sort that list"}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 1, "creation_date": 1550609433, "post_id": 54774450, "comment_id": 96329475, "body": "Although why you want to do a <code>strcpy()</code> to swap whole strings instead of keeping a list of pointers and swapping them, I don&#39;t know"}, {"owner": {"reputation": 541, "user_id": 4929652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/10207183537735185/picture?type=large", "display_name": "Nathan Schwarz", "link": "https://stackoverflow.com/users/4929652/nathan-schwarz"}, "edited": false, "score": 0, "creation_date": 1550609604, "post_id": 54774450, "comment_id": 96329549, "body": "first thing first: when you&#39;re using allocated arrays of char (or other types), don&#39;t use the notation <code>*whatever[]</code> ; use <code>**whatever</code>. Use only the first notation when the arrays are allocated in the stack. Also use errors flags when compiling (-Wall -Werror) it will help you on pointers/types errors."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1550609745, "post_id": 54774450, "comment_id": 96329612, "body": "After copying and splitting the data, <code>qsort</code> could be used with <code>strcmp</code> to easily sort the data."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1550611866, "post_id": 54774450, "comment_id": 96330481, "body": "<code>splitString</code> appears to allocate the strings, split it, print it, and then frees, returning 0, which is then ignored. Are you sure this contract is correct?"}, {"owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1550613490, "post_id": 54774450, "comment_id": 96331091, "body": "@NeilEdelman that is what I found to work for the time being, I&#39;m working on getting the lexicographicalSort Method to work. I plan on cutting out any unnecessary code after the program works."}, {"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1550624076, "post_id": 54774450, "comment_id": 96333982, "body": "incompatible pointer type: argv[i] is a char*, not a char <i>arg[] which is a char*</i>"}], "answers": [{"comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1550700065, "post_id": 54789978, "comment_id": 96369836, "body": "This is a good solution if you don&#39;t want to copy the strings. Shouldn&#39;t you take into account the <code>pv1-&gt;l</code> in <code>cmp</code>?"}, {"owner": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1550700551, "post_id": 54789978, "comment_id": 96370038, "body": "@NeilEdelman I&#39;ve thought about it. Since only length of a second string can be greater length, one may modify the cmp function to take it into account. Should I suppose that if left string equals to right, and, right string is greater, then, cmp shall return +1 ?"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1550700964, "post_id": 54789978, "comment_id": 96370166, "body": "In general, <code>cmp</code> could be called on any string, so I think that if <code>strncmp</code> (size smaller) returns 0, if it&#39;s different lengths, you should just return the one that is longer."}], "tags": [], "owner": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "is_accepted": false, "score": 1, "last_activity_date": 1550676991, "creation_date": 1550676991, "answer_id": 54789978, "question_id": 54774450, "link": "https://stackoverflow.com/questions/54774450/how-to-order-split-command-line-arguments-in-lexicographical-order-using-a-funct/54789978#54789978", "title": "How to order split command line arguments in lexicographical order using a function?", "body": "<p>Basic scheme is simple. Make an array of tuples {start_pointer, length}. Do some programming on args to split the args. Fill in the array as appropriate. Make sorting with qsort, or any other sort of your choise.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *s = \"hello, world! . hello.....\";\nchar *pc;\nint i, n, nargs;\n\nstruct pp{\n char *p;\n int   l;\n};\n\nstruct pp args[10], hargs[20];\nstruct pp *pargs;\n\nint cmp(const void * v0, const void * v1) {\n   struct pp *pv0 = v0, *pv1 = v1;\n   return strncmp(pv0-&gt;p, pv1-&gt;p, pv0-&gt;l);\n}\n\nint main(void)\n{\n for(pc = s, i = 0; *pc; ++i){\n  sscanf(pc, \"%*[^ ]%n\", &amp;n);\n  if(n &gt; 0){\n   args[i].p = pc;\n   args[i].l = n;\n  }\n  for(pc += n, n = 0; isspace(*pc); ++pc);\n }\n for(nargs = i, i = 0; i &lt; nargs; ++i)\n  printf(\"%d arg is: %.*s\\n\", i, args[i].l, args[i].p);\n putchar('\\n');\n for(i = 0, pargs = hargs; i &lt; nargs; ++i){\n  if(args[i].l == 1){\n   pargs-&gt;p = args[i].p;\n   pargs-&gt;l = 1;\n   pargs = pargs + 1;\n  }else {\n   pargs-&gt;p = args[i].p;\n   pargs-&gt;l = args[i].l / 2;\n   pargs = pargs + 1;\n   pargs-&gt;p = args[i].p + args[i].l / 2;\n   pargs-&gt;l = args[i].l - args[i].l / 2;\n   pargs = pargs + 1;\n  }\n }\n putchar('\\n');\n for(nargs = pargs - hargs, i = 0; i &lt; nargs; ++i)\n  printf(\"%d arg is: %.*s\\n\", i, hargs[i].l, hargs[i].p);\n qsort(hargs, nargs, sizeof(struct pp), cmp);\n putchar('\\n');\n for(i = 0; i &lt; nargs; ++i)\n  printf(\"%d arg is: %.*s\\n\", i, hargs[i].l, hargs[i].p);\n\n return 0;\n}\n</code></pre>\n\n<p><a href=\"https://rextester.com/GSH22767\" rel=\"nofollow noreferrer\">https://rextester.com/GSH22767</a></p>\n"}, {"tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1550863768, "last_edit_date": 1550863768, "creation_date": 1550712607, "answer_id": 54797869, "question_id": 54774450, "link": "https://stackoverflow.com/questions/54774450/how-to-order-split-command-line-arguments-in-lexicographical-order-using-a-funct/54797869#54797869", "title": "How to order split command line arguments in lexicographical order using a function?", "body": "<p>Upon splitting a <code>C</code> string, one needs one extra <code>char</code> to store extra null-terminator. There is one answer that bypasses this by storing the length. For completeness, this is closer to your original intention: allocating enough space to copy the programmes arguments. It probably works slower, but one is free to use the strings elsewhere in the programme.</p>\n\n<pre><code>#include &lt;stdlib.h&gt; /* malloc free EXIT qsort */\n#include &lt;stdio.h&gt;  /* fprintf */\n#include &lt;string.h&gt; /* strlen memcpy */\n#include &lt;errno.h&gt;  /* errno */\n\nstatic int strcompare(const void *a, const void *b) {\n    const char *a_str = *(const char *const*)a, *b_str = *(const char *const*)b;\n    return strcmp(a_str, b_str);\n}\n\nint main(int argc, char **argv) {\n    char *spacev = 0, **listv = 0;\n    size_t spacec = 0, listc = 0;\n    int is_done = 0;\n    do { /* \"Try.\" */\n        int i;\n        char *sv;\n        size_t j;\n        /* This requires argc &gt; 1. */\n        if(argc &lt;= 1) { errno = EDOM; break; }\n        /* Allocate maximum space. */\n        for(i = 1; i &lt; argc; i++) spacec += strlen(argv[i]) + 2;\n        if(!(spacev = malloc(spacec)) || !(listv = malloc(argc * 2))) break;\n        sv = spacev;\n        /* Copy and split the arguments. */\n        for(i = 1; i &lt; argc; i++) {\n            const char *const word = argv[i];\n            const size_t word_len = strlen(word),\n                w0_len = word_len / 2, w1_len = word_len - w0_len;\n            if(w0_len) {\n                listv[listc++] = sv;\n                memcpy(sv, word, w0_len);\n                sv += w0_len;\n                *(sv++) = '\\0';\n            }\n            if(w1_len) {\n                listv[listc++] = sv;\n                memcpy(sv, word + w0_len, w1_len);\n                sv += w1_len;\n                *(sv++) = '\\0';\n            }\n        }\n        /* Sort. */\n        qsort(listv, listc, sizeof listv, &amp;strcompare);\n        for(j = 0; j &lt; listc; j++) printf(\"%s\\n\", listv[j]);\n        is_done = 1;\n    } while(0); if(!is_done) {\n        perror(\"split\");\n    } {\n        free(spacev);\n        free(listv);\n    }\n    return is_done ? EXIT_SUCCESS : EXIT_FAILURE;\n}\n</code></pre>\n\n<p>It is simpler than your original; instead of allocating each string individually, it counts the maximum number of <code>char</code>s needed (plus two for two null terminators) and allocates the block all at once (<code>space</code>.) The pointers to the new list also need allocating, the maximum is <code>2 * argc</code>. Once you copy and modify the argument list, one has an actual array of strings that one can <code>qsort</code>.</p>\n"}], "owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550863768, "creation_date": 1550608173, "question_id": 54774450, "link": "https://stackoverflow.com/questions/54774450/how-to-order-split-command-line-arguments-in-lexicographical-order-using-a-funct", "title": "How to order split command line arguments in lexicographical order using a function?", "body": "<p>I'm working on a program that takes command line arguments and splits them in half and then orders them in lexicographical order. \nFor example:</p>\n\n<p>hello, world!</p>\n\n<p>would turn into:</p>\n\n<p>he</p>\n\n<p>ld!</p>\n\n<p>llo</p>\n\n<p>wor</p>\n\n<p>I have a main method that reads through the arguments, a function that splits the arguments, and finally a function that is supposed to order the halves in lexicographical order. I can't get this to run properly because of argument type errors in the lexicographicalSort method and an incompatible pointer type in the main method. I'm having issues to correct these syntax errors, how exactly would I correct them? Also, is there anything here that would cause logical errors? This is what I have so far:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint splitString(char arg[], int n)\n{\n   int len = strlen(arg);\n   int len1 = len/2;\n   int len2 = len - len1; // Compensate for possible odd length\n   char *s1 = malloc(len1 + 1); // one for the null terminator\n   memcpy(s1, arg, len1);\n   s1[len1] = '\\0';\n   char *s2 = malloc(len2 + 1); // one for the null terminator\n   memcpy(s2, arg + len1, len2);\n   s2[len2] = '\\0';\n   printf(\"%s\\n\", s1);\n   printf(\"%s\\n\", s2);\n   free(s1);\n   free(s2);\n\n   return 0;\n}\n\nint lexicographicalSort(char *arg[], int n) \n{\n    char temp[50];\n\n    for(int i = 0; i &lt; n; ++i)\n        scanf(\"%s[^\\n]\",arg[i]); \n\n    for(int i = 0; i &lt; n - 1; ++i)\n        for(int j = i + 1; j &lt; n ; ++j)\n        {\n            if(strcmp(arg[i], arg[j]) &gt; 0)\n            {\n                strcpy(temp, arg[i]);\n                strcpy(arg[i], arg[j]);\n                strcpy(arg[j], temp);\n            }\n        }\n\n    for(int i = 0; i &lt; n; ++i)\n    {\n        puts(arg[i]);\n    }\n\n    return 0;   \n}\n\nint main(int argc, char *argv[])\n{\n    if (argc &gt; 1) \n    {\n        for (int i = 1; i &lt; argc; i++) \n        {\n            int j = 1;\n            int k = strlen(argv[i]);\n\n            splitString(argv[i], j);\n            lexicographicalSort(argv[i], j);\n\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "performance", "shared-memory", "timing"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1550609025, "post_id": 54774372, "comment_id": 96329292, "body": "See <code>&#47;proc&#47;interrupts</code> to find which cores are servicing which interrupts."}, {"owner": {"reputation": 5875, "user_id": 2702398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87402651ed56717034035915b95c1ae0?s=128&d=identicon&r=PG&f=1", "display_name": "oakad", "link": "https://stackoverflow.com/users/2702398/oakad"}, "edited": false, "score": 0, "creation_date": 1550626660, "post_id": 54774372, "comment_id": 96334526, "body": "<code>pthread_mutex_unlock(&amp;sdata-&gt;ipc_mutex); pthread_mutex_lock(&amp;sdata-&gt;ipc_mutex);</code> - I, personally, don&#39;t think that having this sort of thing in your program is a reasonable path to pursue. What exactly are you trying to achieve here? Why not use a proper <code>pthread_cond_t</code> mechanism?"}, {"owner": {"reputation": 41, "user_id": 11086492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82359bd3c21e94a0dfcb2cafb691462?s=128&d=identicon&r=PG&f=1", "display_name": "aketcham", "link": "https://stackoverflow.com/users/11086492/aketcham"}, "reply_to_user": {"reputation": 5875, "user_id": 2702398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87402651ed56717034035915b95c1ae0?s=128&d=identicon&r=PG&f=1", "display_name": "oakad", "link": "https://stackoverflow.com/users/2702398/oakad"}, "edited": false, "score": 0, "creation_date": 1550631086, "post_id": 54774372, "comment_id": 96335496, "body": "@oakad - Waking the sleeping thread through the use of conditional variables resulted in a latency that was too high for my requirements, which is why I&#39;ve implemented a busy waiting solution here."}, {"owner": {"reputation": 5875, "user_id": 2702398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87402651ed56717034035915b95c1ae0?s=128&d=identicon&r=PG&f=1", "display_name": "oakad", "link": "https://stackoverflow.com/users/2702398/oakad"}, "edited": false, "score": 0, "creation_date": 1550634153, "post_id": 54774372, "comment_id": 96336134, "body": "Then you have to at least <code>sched_yield</code> there - you&#39;re not leaving the other process any opportunities to acquire the lock. In general, you should look into implementing a so called &quot;disruptor&quot; algorithm if your latency requirements are so harsh: <a href=\"http://lmax-exchange.github.io/disruptor/files/Disruptor-1.0.pdf\" rel=\"nofollow noreferrer\">lmax-exchange.github.io/disruptor/files/Disruptor-1.0.pdf</a> (check out page 8 for the general idea; several c++ ports of this idea also exist)."}], "owner": {"reputation": 41, "user_id": 11086492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82359bd3c21e94a0dfcb2cafb691462?s=128&d=identicon&r=PG&f=1", "display_name": "aketcham", "link": "https://stackoverflow.com/users/11086492/aketcham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1550612445, "creation_date": 1550607862, "last_edit_date": 1550612445, "question_id": 54774372, "link": "https://stackoverflow.com/questions/54774372/improving-performance-of-shared-memory-isolating-linux-core", "title": "Improving Performance of Shared Memory - Isolating Linux Core", "body": "<p>I'm trying to optimize the performance of reading and writing a <code>double</code> to shared memory. I have one program writing to shared memory, and another reading from it. </p>\n\n<p>I've used <a href=\"https://stackoverflow.com/questions/13583146/whole-one-core-dedicated-to-single-process\">this post</a> to help isolate CPUs for these two programs to run on, with the following line in my <code>etc/default/grub</code> file:</p>\n\n<pre><code>GRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash intel_idle.max_cstate=1 isolcpus=6,7\"\n</code></pre>\n\n<p>I am using <code>taskset -c 6 writer</code> and <code>taskset -c 7 reader</code> to set these programs to run on these cpus.</p>\n\n<p>Using <a href=\"http://man7.org/linux/man-pages/man2/sched_setscheduler.2.html\" rel=\"nofollow noreferrer\">this man page on sched_setscheduler</a>, I have set up both programs to have the highest scheduling priority using the following code:</p>\n\n<pre><code>struct sched_param param;   \nparam.sched_priority = sched_get_priority_max(SCHED_FIFO);\n\nif(sched_setscheduler(0, SCHED_FIFO, &amp;param) == -1) \n{\n     perror(\"sched_setscheduler failed\");\n     exit(-1);\n}\n</code></pre>\n\n<p>I have defined a struct to be used in shared memory that contains the required synchronization tools, as well as a timespec struct and a double to pass between the two programs, as follows:</p>\n\n<pre><code>typedef struct\n{\n    // Synchronization objects\n    pthread_mutex_t ipc_mutex;\n    sem_t ipc_sem;\n    // Shared data\n    double value;\n    volatile int read_cond;\n    volatile int end_cond;\n    double start_time;\n    struct timespec ts;\n} shared_data_t;\n</code></pre>\n\n<p><strong>Shared Memory Initialization:</strong></p>\n\n<p><strong>Writer:</strong></p>\n\n<pre><code>// ftok to generate unique key \nkey_t key = ftok(\"shmfile\",65); \n\n// shmget returns an identifier in shmid \nint shmid = shmget(key,1024,0666|IPC_CREAT); \nftruncate(shmid, sizeof(shared_data_t));\n\n// shmat to attach to shared memory \nshared_data_t* sdata = (shared_data_t*) shmat(shmid,(void*)0,0); \nsdata-&gt;value = 0;\n</code></pre>\n\n<p><strong>Reader:</strong></p>\n\n<pre><code>// ftok to generate unique key \nkey_t key = ftok(\"shmfile\",65); \n\n// shmget returns an identifier in shmid \nint shmid = shmget(key,1024,0666|IPC_CREAT); \nftruncate(shmid, sizeof(shared_data_t));\n\n// shmat to attach to shared memory \nshared_data_t* sdata = (shared_data_t*) shmat(shmid,(void*)0,0); \n</code></pre>\n\n<p><strong>Initialization of Synchronization Tools in Writer</strong></p>\n\n<pre><code>pthread_mutexattr_t mutex_attr;\npthread_mutexattr_init(&amp;mutex_attr);\npthread_mutexattr_setpshared(&amp;mutex_attr, PTHREAD_PROCESS_SHARED);\npthread_mutex_init(&amp;sdata-&gt;ipc_mutex, &amp;mutex_attr);\nsem_init(&amp;sdata-&gt;ipc_sem, 1, 0);\n</code></pre>\n\n<p><strong>Write Code</strong></p>\n\n<pre><code>for (int i = 0; i &lt; 20000000; ++i)\n    {\n        pthread_mutex_lock(&amp;sdata-&gt;ipc_mutex);\n        sdata-&gt;value++;\n        clock_gettime(CLOCK_MONOTONIC, &amp;sdata-&gt;ts);\n        sdata-&gt;start_time = (BILLION*sdata-&gt;ts.tv_sec) + sdata-&gt;ts.tv_nsec;\n        sdata-&gt;read_cond = 1;\n        pthread_mutex_unlock(&amp;sdata-&gt;ipc_mutex);\n        sem_wait(&amp;sdata-&gt;ipc_sem);\n    }\nfprintf(stderr, \"done writing\\n\" );\n\npthread_mutex_lock(&amp;sdata-&gt;ipc_mutex);\nsdata-&gt;end_cond = 1;\npthread_mutex_unlock(&amp;sdata-&gt;ipc_mutex);\n</code></pre>\n\n<p><strong>Read Code</strong> </p>\n\n<pre><code>double counter = 0;\ndouble total_time = 0;\ndouble max_time = 0;\ndouble min_time = BILLION;\ndouble max_thresh = 1000;\nint above_max_counter = 0;\ndouble last_val = 0;\nwhile (1) {\n\n        pthread_mutex_lock(&amp;sdata-&gt;ipc_mutex);\n        while (!sdata-&gt;read_cond &amp;&amp; !sdata-&gt;end_cond) {\n            pthread_mutex_unlock(&amp;sdata-&gt;ipc_mutex);\n            pthread_mutex_lock(&amp;sdata-&gt;ipc_mutex);\n        }\n\n        clock_gettime(CLOCK_MONOTONIC, &amp;sdata-&gt;ts);\n        double time_to_read = (BILLION*sdata-&gt;ts.tv_sec) + sdata-&gt;ts.tv_nsec - sdata-&gt;start_time;\n\n        if (sdata-&gt;end_cond) {\n            break;\n        }\n\n        if (sdata-&gt;value != last_val + 1) {\n            fprintf(stderr, \"synchronization error: val: %g, last val: %g\\n\", sdata-&gt;value, last_val);\n        }\n        last_val = sdata-&gt;value;\n\n        if (time_to_read &gt; max_time) {\n            max_time = time_to_read;\n            printf(\"max time: %lf, counter: %ld\\n\", max_time, (long int) counter);\n        }  \n        if (time_to_read &lt; min_time) min_time = time_to_read;\n\n        if (time_to_read &gt; max_thresh) above_max_counter++;\n        total_time += time_to_read;\n        counter++;\n\n        sdata-&gt;read_cond = 0;\n        sem_post(&amp;sdata-&gt;ipc_sem);\n        pthread_mutex_unlock(&amp;sdata-&gt;ipc_mutex);\n\n    }\n\nfprintf(stderr, \"avg time to read: %g\\n\", total_time / counter);\nfprintf(stderr, \"max time to read: %g\\n\", max_time);\nfprintf(stderr, \"min time to read: %g\\n\", min_time);\nfprintf(stderr, \"count above max threshhold of %g ns: %d\\n\", max_thresh, above_max_counter);\n</code></pre>\n\n<p><strong>Cleanup in Writer</strong></p>\n\n<pre><code>//detach from shared memory \nshmdt(sdata); \n</code></pre>\n\n<p><strong>Cleanup in Reader</strong></p>\n\n<pre><code>pthread_mutex_unlock(&amp;sdata-&gt;ipc_mutex);\npthread_mutex_destroy(&amp;sdata-&gt;ipc_mutex);\n\n//detach from shared memory \nshmdt(sdata); \n\n// destroy the shared memory \nshmctl(shmid,IPC_RMID,NULL); \n</code></pre>\n\n<p>The goal is to minimize the amount of time spent between these two operations. Ideally, I would like to be able to guarantee that the time to read from the time the value is written is less than 1 microsecond. However, the output I get:</p>\n\n<pre><code>max time: 5852.000000, counter: 0\nmax time: 18769.000000, counter: 30839\nmax time: 27416.000000, counter: 66632\nmax time: 28668.000000, counter: 1820109\nmax time: 121362.000000, counter: 1853346\ndone writing\navg time to read: 277.959\nmax time to read: 121362\nmin time to read: 60\ncount above max threshhold of 1000 ns: 1871\n</code></pre>\n\n<p>indicates that there are a number of times (~.01% of reads) where the read exceeds 1 us, and can go as high as 121us.</p>\n\n<p>My question is as follows:</p>\n\n<p><strong>What could be causing these spikes, since I have set the priority to highest and isolated the CPU on which these programs are running?</strong></p>\n\n<p>I have learned from <a href=\"https://stackoverflow.com/questions/16275444/how-to-print-time-difference-in-accuracy-of-milliseconds-and-nanoseconds-from-c\">this post</a> that I should not expect clock_gettime to have nanosecond accuracy. Are these spikes simply inaccuracies in clock_gettime?</p>\n\n<p>The other option I considered is that these cores (6 and 7) are being interrupted somehow, despite having been set as highest priority.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Per comment below, here is the contents of my <code>/proc/interrupts</code> file:</p>\n\n<pre><code>           CPU0       CPU1       CPU2       CPU3       CPU4       CPU5       CPU6       CPU7       \n   0:         20          0          0          0          0          0          0          0   IO-APIC    2-edge      timer\n   1:          2          0          0          0          0          0          0          0   IO-APIC    1-edge      i8042\n   8:          1          0          0          0          0          0          0          0   IO-APIC    8-edge      rtc0\n   9:          0          0          0          0          0          0          0          0   IO-APIC    9-fasteoi   acpi\n  12:          2          0          0          0          1          1          0          0   IO-APIC   12-edge      i8042\n  16:          0          0          0          0          0          0          0          0   IO-APIC   16-fasteoi   i801_smbus, pcim_das1602_16\n  19:          2          0          0          0          8         10          6          2   IO-APIC   19-fasteoi \n 120:          0          0          0          0          0          0          0          0   PCI-MSI 16384-edge      aerdrv\n 121:         99        406          0          0         14       5960          6          0   PCI-MSI 327680-edge      xhci_hcd\n 122:       8726        133         47         28       4126       3910      22638        795   PCI-MSI 376832-edge      ahci[0000:00:17.0]\n 123:          2          0          0          0          2          0          3       3663   PCI-MSI 520192-edge      eno1\n 124:       3411          0          2          1        176      24498         77         11   PCI-MSI 32768-edge      i915\n 125:         45          0          0          0          3          6          0          0   PCI-MSI 360448-edge      mei_me\n 126:        432          0          0          0        144        913         28          1   PCI-MSI 514048-edge      snd_hda_intel:card0\n NMI:          1          1          1          1          1          1          1          1   Non-maskable interrupts\n LOC:      12702      10338      10247      10515       9969      10386      16658      13568   Local timer interrupts\n SPU:          0          0          0          0          0          0          0          0   Spurious interrupts\n PMI:          1          1          1          1          1          1          1          1   Performance monitoring interrupts\n IWI:          0          0          0          0          0          0          0          0   IRQ work interrupts\n RTR:          7          0          0          0          0          0          0          0   APIC ICR read retries\n RES:       4060       2253       1026        708        595        846        887        751   Rescheduling interrupts\n CAL:      11906      10423      11418       9894      14562      11000      21479      11223   Function call interrupts\n TLB:      10620       8996      10060       8674      13172       9622      20121       9838   TLB shootdowns\n TRM:          0          0          0          0          0          0          0          0   Thermal event interrupts\n THR:          0          0          0          0          0          0          0          0   Threshold APIC interrupts\n DFR:          0          0          0          0          0          0          0          0   Deferred Error APIC interrupts\n MCE:          0          0          0          0          0          0          0          0   Machine check exceptions\n MCP:          2          2          2          2          2          2          2          2   Machine check polls\n ERR:          0\n MIS:          0\n PIN:          0          0          0          0          0          0          0          0   Posted-interrupt notification event\n PIW:          0          0          0          0          0          0          0          0   Posted-interrupt wakeup event\n</code></pre>\n\n<p>I've tried changing the smp affinity for interrupts 122 and 123 to cores 0 and 1, per <a href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/performance_tuning_guide/s-cpu-irq\" rel=\"nofollow noreferrer\">this post</a>, which appears to do nothing, as when I reset my computer, these affinities are still set to cores 6 and 7, respectively.</p>\n\n<p>Even without resetting and simply re-running my programs(s), I see no change in the number of interrupts serviced by these CPU cores.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1550606349, "post_id": 54774028, "comment_id": 96328050, "body": "I don&#39;t see a question and I don&#39;t see correlation between the title and the body of the question."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1550606555, "post_id": 54774028, "comment_id": 96328157, "body": "You have a Flexible Array Member in <code>Category</code> (ticket) which requires the struct be <code>malloc</code>ed, but you are statically allocating instances of Category."}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 0, "creation_date": 1550606608, "post_id": 54774028, "comment_id": 96328183, "body": "It should be <code>Ticket *tickets</code> (or, rather, <code>Ticket *ticket</code>)."}, {"owner": {"reputation": 93, "user_id": 4187827, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001187558026/picture?type=large", "display_name": "Justin Macwan", "link": "https://stackoverflow.com/users/4187827/justin-macwan"}, "edited": false, "score": 0, "creation_date": 1550606680, "post_id": 54774028, "comment_id": 96328214, "body": "so i create a pointer to the struct instead of the array?"}, {"owner": {"reputation": 139, "user_id": 9682036, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Helping Bean", "link": "https://stackoverflow.com/users/9682036/helping-bean"}, "edited": false, "score": 0, "creation_date": 1550606704, "post_id": 54774028, "comment_id": 96328227, "body": "Ticket ticket[] will lead to undefined behavior."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1550606705, "post_id": 54774028, "comment_id": 96328229, "body": "What is &quot;that error&quot; you mentioned?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 1, "creation_date": 1550606727, "post_id": 54774028, "comment_id": 96328243, "body": "@wizzwizz4 It&#39;s OK o have a flexible array member as defined."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550606763, "post_id": 54774028, "comment_id": 96328258, "body": "Also, <code>Category</code> has three members, and you are trying to initialize with four values."}, {"owner": {"reputation": 93, "user_id": 4187827, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001187558026/picture?type=large", "display_name": "Justin Macwan", "link": "https://stackoverflow.com/users/4187827/justin-macwan"}, "edited": false, "score": 0, "creation_date": 1550606832, "post_id": 54774028, "comment_id": 96328306, "body": "i did that because Ticket has 2 members"}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 0, "creation_date": 1550606868, "post_id": 54774028, "comment_id": 96328323, "body": "@JustinMacwan Well\u2026 that&#39;s not how to do it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139, "user_id": 9682036, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Helping Bean", "link": "https://stackoverflow.com/users/9682036/helping-bean"}, "edited": false, "score": 1, "creation_date": 1550606944, "post_id": 54774028, "comment_id": 96328358, "body": "@HelpingBean It won&#39;t by itself. Just a reference to the standard allowing this: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p18\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.7.2.1p18</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 1, "creation_date": 1550607682, "post_id": 54774028, "comment_id": 96328679, "body": "@wizzwizz4, well ... Justin&#39;s approach would be a perfectly valid way to do it if his <code>Category.ticket</code> were a single <code>Ticket</code> or an ordinary array of them.  It is not obligatory to enclose the initializer for a sub-object in nested parentheses."}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550607790, "post_id": 54774028, "comment_id": 96328721, "body": "@JohnBollinger I did not know that. Post an answer!"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 4187827, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001187558026/picture?type=large", "display_name": "Justin Macwan", "link": "https://stackoverflow.com/users/4187827/justin-macwan"}, "edited": false, "score": 0, "creation_date": 1550607250, "post_id": 54774149, "comment_id": 96328489, "body": "i understand that i will have to allocate space for the array with malloc but how do i assign the values and the to Category and its flexible array member with a pointer?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550607350, "post_id": 54774149, "comment_id": 96328536, "body": "<code>memcpy</code> them. You can use a <i>compound literal</i> as source."}, {"owner": {"reputation": 93, "user_id": 4187827, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001187558026/picture?type=large", "display_name": "Justin Macwan", "link": "https://stackoverflow.com/users/4187827/justin-macwan"}, "edited": false, "score": 0, "creation_date": 1550607606, "post_id": 54774149, "comment_id": 96328641, "body": "I got it. Thank you so much!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550608312, "post_id": 54774149, "comment_id": 96328959, "body": "Cannot one use simple assignment to copy the prototype structure values to other structures of compatible type, FAM notwithstanding?  I&#39;m not presently seeing anything conflicting with that being one of those cases in which the FAM is ignored."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550609369, "post_id": 54774149, "comment_id": 96329445, "body": "@JohnBollinger: I do not see a problem with that. I will update later."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550609767, "post_id": 54774149, "comment_id": 96329619, "body": "Hmm, that awful, no-good, very bad way that you mentioned not to use involving <code>union</code>s... is that actually legal C?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1550627279, "post_id": 54774149, "comment_id": 96334658, "body": "@ChristianGibbons: Sure. Per C 2018 6.7.2.1 18, when you access a flexible array member with <code>-&gt;</code> or <code>.</code>, it behaves as if the member were replaced with the longest array that would not make the structure larger than the object being accessed. So if the union is defined so that it has enough space, then the structure within it behaves as if it has an array that fits. It is actually not has bad an idea as I made it seem in the answer."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 7, "last_activity_date": 1550627128, "last_edit_date": 1550627128, "creation_date": 1550606837, "answer_id": 54774149, "question_id": 54774028, "link": "https://stackoverflow.com/questions/54774028/static-initialization-of-a-flexible-array-member/54774149#54774149", "title": "Static initialization of a flexible array member", "body": "<p>You cannot initialize a flexible array member. Per C 2018 6.7.2.1 18, in most situations, a flexible array member is ignored. This is one of those situations: In initialization, it is as if the member does not exist.</p>\n\n<p>Creating a structure with a flexible array member in a declaration statement can only create a structure with zero members in the array. To create a structure with more members in the array, you should dynamically allocate space with <code>malloc</code> or a similar routine. Once you have allocated sufficient space, you may convert the pointer to a pointer to a <code>Category</code> and then assign (rather than initialize) values to its members, including elements of its flexible array member.</p>\n\n<p>(Conceivably, there might be a horrible way to define a union containing a structure with a flexible array member in such a way that sufficient space is provided for elements of the array, by stuffing the union with a <code>char</code> array of the necessary size. You still could not initialize those elements, but you could assign to them. Do not do this.)</p>\n\n<p>To set up some prototype <code>Category</code> objects, you could use:</p>\n\n<pre><code>static const Category category1 = {\"Academic Registrar\"};\nstatic const Category category2 = {\"Financial Services\"};\nstatic const Category category3 = {\"IT Support\", \"IT\"};\nstatic const Category category4 = {\"Parking Police\", \"PP\"};\nstatic const Category category5 = {\"Coop Placement\", \"CP\"};\n</code></pre>\n\n<p>Later, to create a <code>Category</code> with several <code>Ticket</code> elements, you could do:</p>\n\n<pre><code>Category *C = malloc(sizeof *C + nTickets * sizeof(Ticket));\n// Test C for NULL in case malloc failed.\n\n// Copy initial data into new Category.\n*C = category3;\n\n// Assign values to Ticket elements.\nfor (int i = 0; i &lt; nTickets; ++i)\n{\n    C-&gt;ticket[i] = rand();\n    C-&gt;timestamp = 0;\n}\n</code></pre>\n\n<p>Note that you cannot create an array of <code>Category</code> objects, because they have flexible size, and objects in an array can only have a fixed size. So you can only work with one <code>Category</code> at a time. The <code>C</code> pointer above can only point to one <code>Category</code>, not an array of them. But the <code>C-&gt;ticket</code> member is an array of <code>Ticket</code>.</p>\n\n<p>Note that I do not necessarily recommend copying data into a <code>Category</code> from prototypes that way. If the data is short, it could just be assigned in code. If the data is long, it might be better to use pointers to data instead of copying all the data into each one. Good solutions depend on circumstances. The above code is given just as an example.</p>\n"}, {"tags": [], "owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "is_accepted": false, "score": 1, "last_activity_date": 1550607166, "creation_date": 1550607166, "answer_id": 54774230, "question_id": 54774028, "link": "https://stackoverflow.com/questions/54774028/static-initialization-of-a-flexible-array-member/54774230#54774230", "title": "Static initialization of a flexible array member", "body": "<p>This code betrays a few misunderstandings about C. Here's what I assume to be a corrected version, with edits for spelling and style:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"input.h\"\n\ntypedef struct Ticket {\n  int id;\n  long timestamp;\n} Ticket;\n\ntypedef struct Categories {\n  char name[20];\n  char code[3];\n  // One ticket doesn't need an array.\n  Ticket ticket;\n} Category;\n\nvoid generateTickets(){\n  struct Ticket *ptr;\n  int nTickets = getNumTickets();\n  ptr = malloc(nTickets * sizeof(struct Ticket));\n\n  for(int i = 0; i &lt; nTickets; i++)\n  {\n    // rand() % nTickets won't guarantee uniqueness\n    ptr[i].id = rand() % nTickets;\n    ptr[i].timestamp = 0;\n  }\n}\n\nvoid initializeCategories() {\n  // Nested initialisation for nested structs.\n  Category category1 = {\"Academic Registrar\", \"AR\", {0, 0}};\n  Category category2 = {\"Financial Services\", \"FS\", {0, 0}};\n  Category category3 = {\"IT Support\", \"IT\", {0, 0}};\n  Category category4 = {\"Parking Police\", \"PP\", {0, 0}};\n  Category category5 = {\"Coop Placement\", \"CP\", {0, 0}};\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 3, "last_activity_date": 1550607650, "creation_date": 1550607650, "answer_id": 54774328, "question_id": 54774028, "link": "https://stackoverflow.com/questions/54774028/static-initialization-of-a-flexible-array-member/54774328#54774328", "title": "Static initialization of a flexible array member", "body": "<p>For <code>const</code> structures of static duration, a workable approach in most cases is to declare a structure which has the same members as the FAM version, but with the flexible array member replaced by a suitably-sized array, and then construct a union which contains that type as well as the one with the Flexible Array Member.  The Common Initial Sequence guarantees imply that either type may be used to inspect the common members, and if an implementation gives any heed whatsoever to footnote 88 of the C11 draft (N1570) which says the purpose of 6.5p7 is to specify the circumstance when things may alias, it will refrain from using the rule as an excuse to break such code, since references to storage that is never modified never alias (aliasing involves situations where re-ordering accesses to an object would affect the semantics thereof; if an object is never modified, the order of accesses will never have any observable effect).</p>\n\n<p>In theory, an implementation would be allowed to place a flexible array member at a different offset from a fixed-sized array, but code could, if desired, use a static assertion to ensure that does not happen.  A deliberately-obtuse interpretation might break things, but since the One Program Rule would allow deliberately-obtuse implementations to break just about any program, that's not really saying much.</p>\n"}], "owner": {"reputation": 93, "user_id": 4187827, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001187558026/picture?type=large", "display_name": "Justin Macwan", "link": "https://stackoverflow.com/users/4187827/justin-macwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 54774149, "answer_count": 3, "score": 1, "last_activity_date": 1550627128, "creation_date": 1550606293, "last_edit_date": 1550607274, "question_id": 54774028, "link": "https://stackoverflow.com/questions/54774028/static-initialization-of-a-flexible-array-member", "title": "Static initialization of a flexible array member", "body": "<p>I am trying to compile this piece of code and it's giving me error: static initialization of flexible array member. I know it is because I am initializing the <code>id</code> and <code>timestamp</code> to <code>0</code> but they are supposed to be assigned at runtime and the 0s are just a place holder till then</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"input.h\"\n\ntypedef struct Ticket {\n    int id;\n    long timestamp;\n} Ticket;\n\ntypedef struct Categories {\n    char name[20];\n    char code[3];\n    Ticket ticket[];\n} Category;\n\nvoid genereateTickets() {\n    struct Ticket *ptr;\n    int nTickets = getNumTickets();\n    ptr = (struct Ticket *)malloc(nTickets * sizeof(struct Ticket));\n\n    for (int i = 0; i &lt; nTickets; i++) {\n        (ptr+i)-&gt;id = rand() % nTickets;\n        (ptr+i)-&gt;timestamp = 0;\n    }\n}\n\nvoid initializeCategories() {\n    Category category1 = { \"Academic Registrar\", \"AR\", 0, 0 };\n    Category category2 = { \"Financial Services\", \"FS\", 0, 0 };\n    Category category3 = { \"IT Support\", \"IT\", 0, 0 };\n    Category category4 = { \"Parking Police\", \"PP\", 0, 0 };\n    Category category5 = { \"Coop Placement\", \"CP\", 0, 0 };\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "qt", "sockets", "pthreads"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1550604548, "post_id": 54773553, "comment_id": 96327196, "body": "Well, using QT would require rewriting your program from C to C++..."}, {"owner": {"reputation": 60, "user_id": 8966358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e0sCj3d3Y3g/AAAAAAAAAAI/AAAAAAAAAJk/Z5mzFozTgck/photo.jpg?sz=128", "display_name": "ilmu011", "link": "https://stackoverflow.com/users/8966358/ilmu011"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1550604712, "post_id": 54773553, "comment_id": 96327274, "body": "@Shawn Why is that? I thought C++ is backwards compatible? It imagined I just had to embed my already existing C project in QT."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1550605394, "post_id": 54773553, "comment_id": 96327581, "body": "If you don&#39;t want to redesign your C program, one possible work-around would be to have your Qt GUI launch your C program as a sub-process (via the <code>QProcess</code> class) and read the sub-process&#39;s stdout and write to its stdin.  (i.e. it would act as a &quot;wrapper&quot; around the original program rather than including the original code directly)"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1550605757, "post_id": 54773553, "comment_id": 96327753, "body": "There are quite a few similarities between the languages, but it&#39;s trivial to write C that follows that languages best practices that is invalid C++."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1550608073, "post_id": 54773553, "comment_id": 96328850, "body": "@ilmu011 While C and C++ share <i>some</i> syntax and functionality, they are by now (C11 vs C++17) <i>very</i> different languages and you can even find constructs that are valid in both but have completely different meaning. Yes, there is a C subset in C++, but it is getting smaller by the hour and you should <i>not</i> assume that just because something compiles with both a C and a C++ compiler, it will do the same thing. Two very different languages - period."}, {"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 1, "creation_date": 1550832386, "post_id": 54773553, "comment_id": 96425477, "body": "I have used both C and C++ for more than 25 years. Usually, compiling and porting a program from C to C++ is not hard at all. You should be able to move your C code to C++ and use Qt without too much hassle. Of course, with C++, you tend to use STL, smart pointers and so on, which makes your code easier to write and easier to maintain. But remember, keep it simple - simple is almost always good!"}], "answers": [{"tags": [], "owner": {"reputation": 370, "user_id": 719809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb43066f8b2177c9af726360458aa19b?s=128&d=identicon&r=PG", "display_name": "mzimmers", "link": "https://stackoverflow.com/users/719809/mzimmers"}, "is_accepted": false, "score": 2, "last_activity_date": 1550605375, "creation_date": 1550605375, "answer_id": 54773809, "question_id": 54773553, "link": "https://stackoverflow.com/questions/54773553/adding-qt-to-a-c-socket-program/54773809#54773809", "title": "Adding Qt to a C-Socket program?", "body": "<p>As Shawn mentioned above, using Qt entails the use of an object-based language (probably C++ in your case). But there's another consideration -- Qt is a multi-platform framework; it can be thought of as a layer between your application and the OS it runs on. So, while the literal answer to your question is \"yes,\" if you're going to use Qt for its UI abilities, you're better off (IMO) using its socket facility <a href=\"https://doc.qt.io/qt-5/qabstractsocket.html\" rel=\"nofollow noreferrer\">QAbstractSocket</a> as well, rather than use the native (or Cygwin) socket API.</p>\n"}], "owner": {"reputation": 60, "user_id": 8966358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e0sCj3d3Y3g/AAAAAAAAAAI/AAAAAAAAAJk/Z5mzFozTgck/photo.jpg?sz=128", "display_name": "ilmu011", "link": "https://stackoverflow.com/users/8966358/ilmu011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550605375, "creation_date": 1550604250, "last_edit_date": 1550605123, "question_id": 54773553, "link": "https://stackoverflow.com/questions/54773553/adding-qt-to-a-c-socket-program", "title": "Adding Qt to a C-Socket program?", "body": "<p>I am working on a simple socket application written in C, which allows two members to communicate over the internet using basic command line prompt.</p>\n\n<p>I would like to add a proper GUI to it, just to use a decent UI and not basic standard input/output.</p>\n\n<p>Right now I am developing with Cygwin to use POSIX threads and sockets. Is there anyway to hook it up to Qt?</p>\n"}, {"tags": ["c", "sockets", "fread"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8218649, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/41371f4d51e71165cb768280ecc4f036?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Bernat", "link": "https://stackoverflow.com/users/8218649/adrian-bernat"}, "edited": false, "score": 0, "creation_date": 1550607767, "post_id": 54774111, "comment_id": 96328706, "body": "I see what you are saying with the 1017 issue. I was under the (wrong) impression that fread returns the bytes read. As for the other issue, I had a underlying bad feeling about that (if fread) line. What I am attempting to do, in English, is send a packet with 1017 bytes + some header information in a 1024 size char buffer. SeqNum is iterated server side, as I plan to implement a timer that detects packet drop. Basically if client is awaiting seNum 5, it shall not accept 4 (already have it) or 6 (skipped one, packet was dropped).  My question: how to detect EOF with only one fread call?"}, {"owner": {"reputation": 55, "user_id": 8218649, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/41371f4d51e71165cb768280ecc4f036?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Bernat", "link": "https://stackoverflow.com/users/8218649/adrian-bernat"}, "edited": false, "score": 0, "creation_date": 1550607923, "post_id": 54774111, "comment_id": 96328788, "body": "To elaborate^ I meant, detect EOF and read the data at the same time, instead of using two calls to fileread()"}], "tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 0, "last_activity_date": 1550608608, "last_edit_date": 1550608608, "creation_date": 1550606662, "answer_id": 54774111, "question_id": 54773180, "link": "https://stackoverflow.com/questions/54773180/issue-with-sending-data-over-udp-using-fread/54774111#54774111", "title": "Issue with sending data over UDP using fread", "body": "<p>Two things strike immediately.</p>\n\n<ul>\n<li><p><code>fread</code> returns the <em>number of items</em> it read. <code>fread(datapkt.data, 1017, 1, filereq)</code> tries to read <em>one</em> item of size 1017. There is no chance this call would ever return 1017. It may only return 0 or 1. The test</p>\n\n<pre><code>    if (fread(....) != 1017)\n</code></pre>\n\n<p>always fails. However, 1017 bytes has been read, and due to the test failure, are discarded. That explains a huge data loss.</p>\n\n<p>Swap the order of parameters, check how may 1-byte items has been read:</p>\n\n<pre><code>    size_t bytes = fread(datapkt.data, 1, 1017, filereq);\n</code></pre>\n\n<p>and use this <code>bytes</code> as a size of the payload. <code>bytes &lt; 1017</code> likely to indicate the end of file. To be sure, call <code>feof</code> and <code>ferror</code>.</p></li>\n<li><p>The server flow:</p>\n\n<pre><code>    if (dacpkt.seqNum == datapkt.seqNum) {\n        ....\n        fread(...);\n        ....\n    }\n    if (fread(....) != 1017) {\n        ....\n    }\n</code></pre>\n\n<p>means that there are <em>two</em> calls to <code>fread</code> once <code>seqNum</code> matches, and a one call if it doesn't. I can't really follow the data flow, but it does feel strange. Server shall not go ahead and send new <code>seqNum</code> until ack is received.</p>\n\n<p>In any case, it shall not blindly send <code>MAX</code> bytes. The first <code>fread</code> also must check how many bytes it got, and fix the sizes in <code>memcpy</code> and <code>sendto</code> accordingly.</p></li>\n</ul>\n\n<hr>\n\n<p>To _detect EOF and read the data at the same time`, try something like</p>\n\n<pre><code>    size_t bytes = fread(datapkt.data, 1, 1017, filereq);\n    if (bytes == 0 &amp;&amp; feof(filereq)) {\n        handle_end_of_file();\n    } else {\n        memcpy(memcpy(buffer + off, &amp;datapkt.data, bytes);\n        send_the_packet();\n    }\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8218649, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/41371f4d51e71165cb768280ecc4f036?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Bernat", "link": "https://stackoverflow.com/users/8218649/adrian-bernat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550608608, "creation_date": 1550602643, "question_id": 54773180, "link": "https://stackoverflow.com/questions/54773180/issue-with-sending-data-over-udp-using-fread", "title": "Issue with sending data over UDP using fread", "body": "<p>I am working on implementing a \"stop and go\" protocol using UDP. I essentially use a char buffer to serialize any data I send over, using ntoh and hton where needed, and deserializing once my data reaches the other side. Everything works great, however when I try to send a file, I get random bogus bytes in the new file. I will try to summarize the necessary information for this question:</p>\n\n<p>The first character in my char buffer represents the type of packet that is being sent. I implemented a small 3-way handshake to establish connection. The server simply takes a specific port as an arg, the client takes an ip, port, and filename, then requests this file from the server. The server responds with the size of the file, and then the client sends the final ACK packet, then data is sent. I use fread() to send data ~1kb at a time, using a 1kb buffer size. Once the client obtains this packet, it sends a confirmation packet then waits for the next data packet. Here is the relevant code:</p>\n\n<pre><code>                else if (b == 'a')\n                {\n                        memcpy(&amp;dacpkt.seqNum, buffer+sizeof(char), sizeof(int));\n                        dacpkt.seqNum = ntohl(dacpkt.seqNum);           // convert from network to host data\n                        datapkt.pktLen = 1017;\n                        if (dacpkt.seqNum == datapkt.seqNum)\n                        {\n                                ++seq;\n                                dacpkt.t = b;\n\n                                datapkt.seqNum = seq;\n                                fread(datapkt.data, datapkt.pktLen, 1, filereq);\n\n                                memcpy(buffer, &amp;datapkt.t, sizeof(char));                               // data packet type\n                                off = sizeof(char);\n                                datapkt.seqNum = htonl(datapkt.seqNum);\n                                memcpy(buffer + off, &amp;datapkt.seqNum, sizeof(int));     // data packet sequence#\n                                off += sizeof(int);\n                                datapkt.pktLen = htons(datapkt.pktLen);\n                                memcpy(buffer + off, &amp;datapkt.pktLen, sizeof(short));   // data packet size\n                                off += sizeof(short);\n                                memcpy(buffer + off, &amp;datapkt.data, 1017);                              // data packet payload\n                                n = sendto(sock, buffer, MAX, 0, (struct sockaddr*) &amp;from, fromlen);\n                                if (n &lt; 0)\n                                        error(\"sendto\");\n                        }\n\n                        if(fread(datapkt.data, 1017, 1, filereq) != 1017)       // fread hit the end of the file\n                        {\n                                ++seq;\n                                dacpkt.t = 'c';\n                                dacpkt.seqNum = seq;\n                                memcpy(buffer, &amp;dacpkt.t, sizeof(char));                        // close packet\n                                off = sizeof(char);\n                                dacpkt.seqNum = htonl(dacpkt.seqNum);\n                                memcpy(buffer + off, &amp;dacpkt.seqNum, sizeof(int));      // close packet sequence#\n                                n = sendto(sock, buffer, 5, 0, (struct sockaddr*) &amp;from, fromlen);\n                        }\n\n                }\n</code></pre>\n\n<p>dacpkt is the acknowledgement packet that I populate upon deserialization of the char buffer from recvfrom(), and datapkt is the packet I build, then serialize and send. I BELIEVE my issue is in my usage of fread. Here is the receiving code client-side:</p>\n\n<pre><code>                        if (b == 'd')\n                        {\n                                //build the response packet and send\n                                memset(buffer, 0, MAX);\n                                //populate struct\n                                dacpkt.t = 'a';\n                                dacpkt.seqNum = htonl(sequence_num);\n\n                                //copy to buffer\n                                memcpy(buffer, &amp;dacpkt.t, sizeof(char));\n                                off = sizeof(char);\n                                memcpy(buffer + off, &amp;dacpkt.seqNum, sizeof(int));\n\n                                //send the ACK\n                                n = sendto(sock, buffer, MAX, 0, (struct sockaddr *) &amp;server, length);\n                                if (n &lt; 0)\n                                        error(\"sendto\");\n\n                                //receive as well before exiting while loop\n                                memset(buffer, 0, MAX);\n                                n = recvfrom(sock, buffer, MAX, 0, (struct sockaddr *) &amp;from, &amp;length);\n                                if (n &lt; 0)\n                                        error(\"recvfrom\");\n\n                                datapkt.t = buffer[0];\n                                off = sizeof(char);\n                                memcpy(&amp;datapkt.seqNum, buffer + off, sizeof(int));\n                                datapkt.seqNum = ntohl(datapkt.seqNum);\n                                off += sizeof(int);\n                                memcpy(&amp;datapkt.pktLen, buffer + off, sizeof(short));\n                                datapkt.pktLen = ntohl(datapkt.pktLen);\n                                off += sizeof(short);\n                                strcat(datapkt.data, buffer + off);\n\n                                //ensures we are receiving the next packet\n                                if (datapkt.seqNum = (sequence_num + 1))\n                                {\n                                        n = fputs(datapkt.data, newfile); //we need buffer to be the exact size\n                                        if (n &lt; 0)\n                                                error(\"writing to file\");\n\n                                        sequence_num = datapkt.seqNum;\n                                }\n\n                        }\n\n                        fclose(newfile);\n                }\n                //post-receiving the file!\n                memset(buffer, 0, MAX);\n                dacpkt.t = 'c';\n                dacpkt.seqNum = htonl(sequence_num);\n                memcpy(buffer, &amp;dacpkt.t, sizeof(char));\n                memcpy(buffer + 1, &amp;dacpkt.seqNum, sizeof(int));\n                //send the ACK\n                n = sendto(sock, buffer, MAX, 0, (struct sockaddr *) &amp;server, length);\n                if (n &lt; 0)\n                        error(\"sendto\");\n</code></pre>\n\n<p>I am sorry if the information I gave is a bit ambiguous, but I am fairly certain my issues lie in my reading/writing to file. For instance, I ran the program trying to transfer a text file with the alphabet characters (a-z) on each line, on 600 lines. Original file was 16200 bytes, whereas the new file created by the sending data is only 3069 bytes. The new file is only 113 lines, and random bytes appear throughout like this:</p>\n\n<pre><code> 36 abcdefghijklmnopqrstuvwxyz\n 37 abcdefghijklmnopqrstuvwxyz\n 38 abcdefghijklmnopqr8ze$\u00fc^?abcdefghijklmnopqrstuvwxyz\n 39 abcdefghijklmnopqrstuvwxyz\n</code></pre>\n\n<p>and notably, at the end of the file:</p>\n\n<pre><code>111 abcdefghijklmnopqrstuvwxyz\n112 abcdefghijklmnopqrstuvwxyz\n113 abcdefghi8ze$\u00fc^?\n</code></pre>\n\n<p>I think I do not understand how fread() works, in regards to how to tell when to end the file transfer. If anyone has ideas on how I could implement this better, I'm all ears. All I want to do, is send data in one kb packets at a time, until I reach end of file, at which point, I send this final, partial packet, then send a signal to close the client.</p>\n"}, {"tags": ["c", "initialization"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550602705, "post_id": 54773163, "comment_id": 96326432, "body": "I don&#39;t see where <code>sum</code> isn&#39;t initialized. The first line of the function does it."}, {"owner": {"reputation": 1256, "user_id": 3717691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e31f2eebcaa93d53b27abaf149df957?s=128&d=identicon&r=PG&f=1", "display_name": "Jeppe", "link": "https://stackoverflow.com/users/3717691/jeppe"}, "edited": false, "score": 3, "creation_date": 1550602879, "post_id": 54773163, "comment_id": 96326515, "body": "Can you add an example of what the code it supposed to do? Do you need <code>sum</code> to be 0 initially for each of the outer iterations?"}, {"owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "edited": false, "score": 3, "creation_date": 1550602882, "post_id": 54773163, "comment_id": 96326518, "body": "huh? can you please define what the behavior was when it was not working and when it was working? include where you placed <code>sum</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1550603295, "post_id": 54773163, "comment_id": 96326654, "body": "If you move <code>int sum = 0;</code> inside the <code>for</code> loop you will of cause get another output as you set <code>sum</code> to zero in every loop."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1550604054, "post_id": 54773163, "comment_id": 96326965, "body": "What is the problem? Can you run the program? Is it producing incorrect output? If so, what&#39;s the input, output, and expected output?"}, {"owner": {"reputation": 139, "user_id": 9682036, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Helping Bean", "link": "https://stackoverflow.com/users/9682036/helping-bean"}, "edited": false, "score": 0, "creation_date": 1550606499, "post_id": 54773163, "comment_id": 96328122, "body": "Explain the question correctly as to what you are expecting? What is that you are not able to find out? It will be easy for the other geeks to help you."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1550606827, "post_id": 54773163, "comment_id": 96328301, "body": "You have mentioned three different versions of this code, but shown only one.  If you want an explanation of the behaviour of each version, provide each version - a vague description is inadequate. You have asserted that it is a matter of scope, but it is a matter of initialisation.  You have also claimed that &quot;<i>there not much explicit information about this topic</i>&quot;, which is nonsense - the behaviour of the language is <i>well defined</i>.  In general, just ask the question rather then providing assertions and propositions about things you know little of."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9939334, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ErbrWauuzuQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0vpSkJL_W1W4HTe6Vutpbdr4LeNg/mo/photo.jpg?sz=128", "display_name": "Arpan jana", "link": "https://stackoverflow.com/users/9939334/arpan-jana"}, "edited": false, "score": 0, "creation_date": 1550607330, "post_id": 54773837, "comment_id": 96328527, "body": "not working if putting the sum inside the loop.I don&#39;t why."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 9, "user_id": 9939334, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ErbrWauuzuQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0vpSkJL_W1W4HTe6Vutpbdr4LeNg/mo/photo.jpg?sz=128", "display_name": "Arpan jana", "link": "https://stackoverflow.com/users/9939334/arpan-jana"}, "edited": false, "score": 0, "creation_date": 1550607498, "post_id": 54773837, "comment_id": 96328601, "body": "@Arpanjana: what do you mean by <i>not working</i> and <i>putting the sum inside the loop</i>? Be more concise, add an EDIT to the question with the code that is <i>not working</i>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1550607610, "last_edit_date": 1550607610, "creation_date": 1550605502, "answer_id": 54773837, "question_id": 54773163, "link": "https://stackoverflow.com/questions/54773163/variable-scope-in-c-language/54773837#54773837", "title": "variable scope in C language", "body": "<p>Moving the definition and initialization of <code>sum</code> inside the outer loop body will work fine. <code>sum</code> will be reinitialized at the start if each iteration.</p>\n\n<p>Note that you can reduce the time complexity of this function this way:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    for (int num = 1; num &lt;= 100000; ++num) {\n        int i, sum = 1;\n        for (i = 2; i * i &lt; num; ++i) {\n            if (num % i == 0) {\n                sum += i + num / i;\n            }\n        }\n        if (i * i == num) {\n            sum += i;\n        }\n        if (sum == num) {\n            printf(\"%d, \", num);\n        }\n    }\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Timed output (<code>num &lt;= 100000</code>):</p>\n\n<pre><code>1, 6, 28, 496, 8128,\n\nreal    0m0.075s\nuser    0m0.070s\nsys     0m0.002s\n</code></pre>\n\n<p>Original code:</p>\n\n<pre><code>6, 28, 496, 8128,\n\nreal    0m15.582s\nuser    0m15.249s\nsys     0m0.067s\n</code></pre>\n\n<p>EDIT: If by <em>putting the sum inside the loop</em>, you mean writing <code>for (int i = 1, sum = 0; i &lt; num; ++i) {</code> it does not compile because <code>sum</code> is only defined inside the <code>for</code> statement, so the test <code>if (sum == num)</code> refers to an undefined variable.</p>\n"}], "owner": {"reputation": 9, "user_id": 9939334, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ErbrWauuzuQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0vpSkJL_W1W4HTe6Vutpbdr4LeNg/mo/photo.jpg?sz=128", "display_name": "Arpan jana", "link": "https://stackoverflow.com/users/9939334/arpan-jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1550607837, "creation_date": 1550602575, "last_edit_date": 1550607837, "question_id": 54773163, "link": "https://stackoverflow.com/questions/54773163/variable-scope-in-c-language", "title": "variable scope in C language", "body": "<p>I was trying to find out the <strong>perfect numbers</strong> between 1 to 500.I was trying running the following program but I was not getting the desired output except when I am initializing the same(i.e.,sum) inside the for loop,I am getting the desired output. What is is it so?</p>\n\n<pre><code>int main() {\n    int sum = 0;\n    for (int num = 1; num &lt;= 500; ++num) {\n        for (int i = 1; i &lt; num; ++i) {\n            if (num % i == 0) {\n                sum = sum + i;\n            }\n        }\n        if (sum == num) {\n            printf(\"%d, \", num);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ieee-754", "atan2"], "comments": [{"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1550605735, "post_id": 54773111, "comment_id": 96327736, "body": "The title isn&#39;t consistent with the code.  <code>2^-30</code> in the title suggests bitwise exclusive-or of 2 and -30 (though that&#39;s not the case because of C++&#39;s oft-surprising operator  precedence). :-)"}, {"owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1550605992, "post_id": 54773111, "comment_id": 96327891, "body": "You are completely right. I&#39;ll change the heading."}], "answers": [{"comments": [{"owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 0, "creation_date": 1550605329, "post_id": 54773362, "comment_id": 96327549, "body": "Thanks for the explanation so far! One thing: <i>[...] Additionally, an integer compare typically takes less processor resources than a floating-point compare [...]</i> Yes, I&#39;ve got that they first check against <code>2^-29</code>, and I understand the way they do it. But the following code puzzles me. Obviously, they build and compare <code>huge + x</code> only if <code>x &lt; 2^-29</code> (which I eventually will understand some day), but also obviously, for any given <code>x</code>, the choice of <code>huge</code> will influence whether <code>inexact</code> is triggered or not (e.g. <code>1.0e300</code> vs. <code>1.0e307</code>). So how did they derive the value <code>1.0e300</code>?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 0, "creation_date": 1550606357, "post_id": 54773362, "comment_id": 96328057, "body": "@Binarus: Since <code>x</code> is less than 2^-29, its highest bit is less than 2^-30 or lower. The <code>double</code> format this code was written for has only 53 bits in the significand. So if the highest bit of a number is 2^23, the lowest bit in its significand could be at most 2^(23-52) = 2^-29. Therefore, if any number 2^23 or greater is added to a positive number less than 2^-29, the result cannot be exactly represented, so an inexact exception occurs. However, at this point, x could be negative, in which case the sum could come down slightly from 2^23 and have another bit available. Using 2^24 avoids that."}, {"owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 1, "creation_date": 1550606366, "post_id": 54773362, "comment_id": 96328061, "body": "One more interesting thing (just saw it by accident): The <code>float32</code> version of that function, including the trick discussed in my question, is nearly literally still in glibc 2.19! Since glibc is meant to be portable, the code should be as well. It is in the sub-directory <code>sysdeps\\ieee754\\flt-32</code>, so I suppose this is the software emulation of the <code>float32</code> functions, where portability is no issue (I think the software emulation raises those exceptions exactly as defined in IEEE754). I&#39;ll add this finding to my question to emphasize that this trick is still used."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 0, "creation_date": 1550606373, "post_id": 54773362, "comment_id": 96328067, "body": "So, adding any number 2^24 or greater to x would cause an inexact exception. It does not need to be 1e300."}, {"owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 0, "creation_date": 1550606489, "post_id": 54773362, "comment_id": 96328117, "body": "Fantastic explanation in your comments, thank you very much! Accepted and +1."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 7, "last_activity_date": 1550603450, "creation_date": 1550603450, "answer_id": 54773362, "question_id": 54773111, "link": "https://stackoverflow.com/questions/54773111/what-exactly-does-1-0e300-pow2-0-30-0-1-0-do-in-stdc/54773362#54773362", "title": "What exactly does (1.0e300 + pow(2.0, -30.0) &gt; 1.0) do in STDC?", "body": "<p>The intent of <code>if ((huge + x) &gt; one) return x;</code> is to generate a floating-point inexact exception and then return from the routine.</p>\n\n<p>A floating-point exception is not a trap or processor exception. It just means something unusual has happened in a floating-point operation. What happens then depends on the circumstances of the operation. In particular, the floating-point environment might be set so that an inexact exception merely raises a flag in a special register and continues with the operation, delivering a numerical result. Or it might be set so that an inexact exception causes a trap, and program control is redirected to a trap handler.</p>\n\n<p>This code implementing <code>atan</code> does not know how the floating-point environment is set. Maybe it could fetch the settings, but it does not want to bother with that. Given that it has decided the arctangent function cannot be computed exactly, the easiest way for it to trigger a floating-point inexact exception is merely to perform a simple addition that has an inexact result. This inexact addition will have the same behavior that is desired for an inexact arctangent\u2014it will either just raise the flag or cause a trap, depending on the settings.</p>\n\n<p>As to why comparisons are made with <code>ix &lt; 0x3e200000</code>, that is not clear. For one thing, <code>ix</code> has been adjusted to reflect the absolute value, whereas <code>x</code> has not, so why not use the already prepared <code>ix</code> rather than using another operation to produce <code>fabs(x)</code>? Additionally, an integer compare typically takes less processor resources than a floating-point compare, especially in the processors of the time when this code was written. Or it may be the author simply happened to use one over the author, perhaps writing most of their code using <code>ix</code> to operate on the floating-point encoding and not <code>x</code> to operate on the floating-point value, and they did not want to switch back and forth unnecessarily. It could also be because the code was written before the hexadecimal floating-point notation was available (so we could write <code>x &lt; 0x1p-29f</code>), and compilers were not good about converting decimal numerals to floating-point values, so they did not want to write out the floating-point value in the source code.</p>\n\n<p>This sort of code is problematic and is highly dependent on the C implementation it is written for. In general, there may not be a guarantee from the compiler that <code>(huge + x) &gt; one</code> will be evaluated during program execution. The compiler might evaluate it at compile time. Presumably, though, if this code is written for a particular C implementation, they know the compiler will either evaluate it at compile time or will ensure the same result is achieved, including raising of the floating-point inexact exception.</p>\n\n<p>On the face of it, <code>(huge + x) &gt; one</code> does not seem to do anything useful that <code>huge + x</code> alone does not do, but perhaps the author knew something about the compiler that we do not.</p>\n\n<p><code>huge</code> does not need to be <code>1.0e300</code>. Any value so large that the sum of <code>huge</code> and <code>x</code> cannot be exact would suffice.</p>\n"}], "owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 54773362, "answer_count": 1, "score": 8, "last_activity_date": 1551429322, "creation_date": 1550602307, "last_edit_date": 1551429322, "question_id": 54773111, "link": "https://stackoverflow.com/questions/54773111/what-exactly-does-1-0e300-pow2-0-30-0-1-0-do-in-stdc", "title": "What exactly does (1.0e300 + pow(2.0, -30.0) &gt; 1.0) do in STDC?", "body": "<p>I have come across a function which computes <code>atan(x)</code> (the source is <a href=\"http://www.netlib.org/fdlibm/s_atan.c\" rel=\"nofollow noreferrer\">here</a>). Reducing it to the core of my question and slightly reformatting it, they have something like that:</p>\n\n<pre><code>static const double one   = 1.0,\n                   huge   = 1.0e300;\n\ndouble atan(double x)\n{\n  /* A lot of uninteresting stuff here */\n\n  if (ix &lt; 0x3fdc0000) {              /* |x| &lt; 0.4375 */\n\n    if (ix &lt; 0x3e200000) {            /* |x| &lt; 2^-29 */\n      if ((huge + x) &gt; one) return x; /* raise inexact */\n    }\n\n    id = -1;\n  }\n\n  /* A lot of more uninteresting stuff */\n}\n</code></pre>\n\n<p>I would be very interested in what the line <code>if ((huge + x) ...</code> is supposed to do and how it works.</p>\n\n<p>According to the comments, if the absolute value of <code>x</code> is smaller than <code>2^-29</code>, the expression or the comparison raises an <code>inexact</code> error.</p>\n\n<p>My first problem is that I currently don't get why this is done that way: If computing the <code>arctan</code> using that function leads to imprecise results if the absolute value of <code>x</code> is too small, why don't they just use something like <code>if (fabs(x) &lt; [some_value_here]) ...</code>? I suspect that this is just because the <code>inexact</code> warning wouldn't be raised that way in their hardware / library, but I'd like to know for sure.</p>\n\n<p>Assuming that I am right, my second problem is that I don't understand why the comparison is needed. I think that the key point here is that a very small number is added to a very large one, so that this addition does not change the large one sufficiently or even not at all. Hence, it is the addition which will raise the <code>inexact</code> warning, not the comparison. So I am asking myself what the comparison should do. Is this just to force the compiler to actually compute <code>(huge + x)</code>, which might be optimized out otherwise?</p>\n\n<p>Finally, I would be grateful if somebody could explain the math a little bit. Choosing the value <code>1.0e300</code> for <code>huge</code> seems a pretty arbitrary choice. But this is only a bonus question since I admit I haven't done the <em>math</em> part of my homework yet (I am not a total newbie regarding <code>double</code> values and their IEEE754 representation, but understanding the mathematical aspects of this code will take me some time, unless somebody gives a short explanation).</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>Just seen by accident:</p>\n\n<p>The <code>float32</code> version of that function, including the weird line discussed above, is nearly literally still in glibc 2.19! Since glibc is meant to be portable, that code should be as well. It is in the sub-directory <code>sysdeps\\ieee754\\flt-32</code>, so I suppose this is the software emulation of the <code>float32</code> functions, where portability is no issue because hardware-dependent oddities won't show up (I think the software emulation raises those exceptions exactly as defined in IEEE754).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1550600942, "post_id": 54772637, "comment_id": 96325600, "body": "Welcome to SO. For better readability and attracting more users you should improve the indentation of your code."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1550601164, "post_id": 54772637, "comment_id": 96325713, "body": "You do not store an image count per car. That&#39;s why you get same number of images for every car."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1550601471, "post_id": 54772637, "comment_id": 96325840, "body": "The <code>pic</code> element is an <code>int *</code> and not an <code>int</code>, which is a bit weird.  You should probably add an image count to the structure.  Note that your <code>initCar()</code> function is passed an image count, but doesn&#39;t use it."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1550601775, "post_id": 54772637, "comment_id": 96325992, "body": "<code>newCar.pic = &amp;newImage;</code> This will add the same address of the same local variable each time you execute the loop. After <code>newCar</code> function is left, the memory address is no longer valid."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550601800, "post_id": 54772637, "comment_id": 96326002, "body": "You&#39;re using the <code>gets()</code> function \u2014 don&#39;t!  See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why the <code>gets()</code> function is too dangerous to be used \u2014 ever!</a>"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1550602100, "post_id": 54772637, "comment_id": 96326146, "body": "You have lots of issues in your code.  For example, <code>initCar</code> doesn&#39;t create memory for the pic array.  You need to change it to do something like this: <code>Car initCar(char itsId[],char itsBrand[],int *itsPic, int imagecount){                 Car newCar;                  strcpy(newCar.id, itsId);                 strcpy(newCar.brand, itsBrand);                 newCar.pic = malloc(imagecount * sizeof (int));                 memcpy(newCar.pic, itsPic, imagecount * sizeof (int));                 return newCar; } </code>  This way you&#39;re creating memory for the pic with <code>malloc</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1550602461, "post_id": 54772637, "comment_id": 96326319, "body": "Your loop <code>while (input&lt;1 || input&lt;2)               ;</code> is problematic.  First the condition can be just <code>while (input &lt; 2)</code>.  Next, the loop is infinite once entered because the value of <code>input</code> never changes."}, {"owner": {"reputation": 3854, "user_id": 10607772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e478f2600848a3dc5238b7ffb2e148f6?s=128&d=identicon&r=PG", "display_name": "double-beep", "link": "https://stackoverflow.com/users/10607772/double-beep"}, "edited": false, "score": 1, "creation_date": 1550608833, "post_id": 54772637, "comment_id": 96329199, "body": "Please don&#39;t make more work for other people by vandalizing your posts. By posting on Stack Overflow, you&#39;ve granted a non-revocable right, under the <a href=\"https://creativecommons.org/licenses/by-sa/3.0/\" rel=\"nofollow noreferrer\">CC BY-SA 3.0 license</a> for Stack Overflow to distribute that content. By Stack Overflow policy, any vandalism will be reverted. If you want to know more about deleting a post, please take a look at <a href=\"https://meta.stackexchange.com/a/5222\">How does deleting work?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1190, "user_id": 3344587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d246b94ff48978d81b706630d0102196?s=128&d=identicon&r=PG&f=1", "display_name": "Loc Tran", "link": "https://stackoverflow.com/users/3344587/loc-tran"}, "is_accepted": false, "score": 0, "last_activity_date": 1550602276, "creation_date": 1550602276, "answer_id": 54773103, "question_id": 54772637, "link": "https://stackoverflow.com/questions/54772637/adding-value-to-struct-adding-goes-wrong-in-c/54773103#54773103", "title": "adding value to struct, adding goes wrong in C", "body": "<p>Your <code>NewCar</code> function have some problems. The <code>newImage</code> is in stack memory. When you do assignment <code>newCar.pic = &amp;newImage;</code> the <code>newCar.pic</code> will point to undefined memory region because <code>newImage</code> was out of its scope. better way, we just use its value only, don't use address operator here. And one more thing, the <code>newCar.pic</code> is an pointer (array of int). So you need to allocate it before use. When you add more image item, you need to reallocate it. And initialize the <code>pic</code> to NULL pointer as well.</p>\n\n<p>Here is my modification your <code>NewCar</code> function:</p>\n\n<pre><code>Car NewCar(Car minapatienter[], int patientCount)\n{\n    Car newCar;\n\n    gets(newCar.id);\n    printf(\"type in  ID \\n\"); \n    gets(newCar.id); \n    printf(\"type in brand\\n\");\n    gets(newCar.brand);\n    newCar.pic = NULL;\n\n    bool imageInputDone = false; \n    int imageCount=0;\n    while(imageInputDone == false)\n    {\n      printf(\"type in image reference \\n\");\n      int newImage; \n      scanf(\"%d\",&amp;newImage);\n\n      // Rellocation\n      newCar.pic = realloc(newCar.pic, (imageCount+1)*sizeof(int));\n      newCar.pic[imageCount] = newImage; \n      imageCount++;\n\n      printf(\"vill du \\n1.Add another image reference \\n2.exit\\n\");\n      int input;\n      scanf(\"%d\", &amp;input);\n      printf(\"input: %i\\n\",input);\n      switch(input)\n      {\n          case 1: \n              printf(\"Adding one more image\\n\");\n              break;\n          case 2: \n              printf(\"Leaving loop\\n\");\n              imageInputDone = true; \n              break;\n          default:\n              while (input&lt;1 || input&lt;2)\n                ;\n              printf(\"Input correct number\\n\");\n              break;\n      }\n\n      return newCar; \n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1550605595, "post_id": 54773274, "comment_id": 96327669, "body": "If it really took days, then please regard it as a MUST DO to learn using a debugger. Running your program in GDB or similar should reveal most of the problems in a shorter time. MUCH shorter."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1550605307, "last_edit_date": 1550605307, "creation_date": 1550603068, "answer_id": 54773274, "question_id": 54772637, "link": "https://stackoverflow.com/questions/54772637/adding-value-to-struct-adding-goes-wrong-in-c/54773274#54773274", "title": "adding value to struct, adding goes wrong in C", "body": "<p>You get the same number of images printed for each car because you only have a global counter. You need a counter per image:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define MAX       1000\n#define IDSIZE    20\n#define BRANDSIZE 50\n#define PICSIZE   10\n\ntypedef struct Car\n{\n  char  id[IDSIZE+1];\n  char  brand[BRANDSIZE+1];\n  int  *pic;\n  int   imagecount;\n} Car;\n</code></pre>\n\n<p>With this change there is no need to pass a count for printing:</p>\n\n<pre><code>void printCar(Car *pCar)\n{\n  printf(\" %s \", pCar-&gt;id);\n  printf(\"    %s \", pCar-&gt;brand);\n  for(int i=0; i&lt;pCar-&gt;imagecount; i++)\n  {\n    printf(\"   %d\",pCar-&gt;pic[i]);\n  }\n  printf(\"\\n\");\n}\n</code></pre>\n\n<p>The counter needs to be stored during initialization:</p>\n\n<pre><code>Car initCar(char itsId[], char itsBrand[], int *itsPic, int imagecount)\n{\n  Car newCar;\n  strcpy(newCar.id, itsId);\n  strcpy(newCar.brand, itsBrand);\n  newCar.pic = itsPic;\n  newCar.imagecount = imagecount;\n\n  return newCar;\n}\n</code></pre>\n\n<p>When you print your list, you mix up count of images and count of cars:</p>\n\n<pre><code>void PrintList(Car aLista[], int imagecount, int carcount)\n{\n  for(int i = 0; i&lt;imagecount; i++)\n    printCar(&amp;aLista[i],carcount);\n}\n</code></pre>\n\n<p>This must be:</p>\n\n<pre><code>void PrintList(Car aLista[], int carcount)\n{\n  for (int i = 0; i &lt; carcount; i++)\n    printCar(&amp;aLista[i]);\n}\n</code></pre>\n\n<p>Adding the car to your array is basically OK, but you might check if you reach <code>MAX</code> cars.</p>\n\n<pre><code>void AddCar(Car aList[], int *pAt, Car theCar) \n{\n  aList[(*pAt)++]=theCar;    \n}\n</code></pre>\n\n<p>Now the biggest problem. This function hads issues with memory usage and weird loops. </p>\n\n<pre><code>Car NewCar(void)\n{\n  Car newCar = {0};  // initialze with empty strings and NULL pointers.\n\n  // TODO: Replace gets with fgets!\n  // gets(newCar.id); // WHY read before you prompt??\n  printf(\"type in  ID \\n\"); \n  gets(newCar.id); \n  printf(\"type in brand\\n\");\n  gets(newCar.brand);\n\n  bool imageInputDone = false; \n  int imageCount=0;\n\n  while(imageInputDone == false)\n  {\n    printf(\"type in image reference \\n\");\n    int newImage; \n    scanf(\"%d\",&amp;newImage);\n\n    imageCount++;\n    int *newpics = realloc(newCar.pic, (imageCount) * sizeof(int));\n    newpics[imageCount-1] = newImage; \n    newCar.pic = newpics;\n    // TODO: Check for NULL\n\n    printf(\"vill du \\n1.Add another image reference \\n2.exit\\n\");\n    int input;\n    scanf(\"%d\", &amp;input);\n    printf(\"input: %i\\n\",input);\n    while (input &lt; 1 || input &gt; 2)\n    switch(input)\n    {\n        case 1: \n            printf(\"Adding one more image\\n\");\n            break;\n        case 2: \n            printf(\"Leaving loop\\n\");\n            imageInputDone = true; \n            break;\n        default:\n            printf(\"Input correct number\\n\");\n            break;\n    }\n\n    newCar.imagecount = imageCount;\n    return newCar; \n  }\n}\n</code></pre>\n\n<p>And finally...</p>\n\n<pre><code>int main(void)\n{\n  int carCount=0;\n  Car myCar[MAX]; \n  int input;\n\n  int test[3]  = {1,2,3};\n  int test2[3] = {4,5,6};\n\n  myCar[0] = initCar(\"bbb188\", \"BMW\", test, 3);\n  myCar[1] = initCar(\"AAA-999\", \"VOLVO\", test2, 3);\n  myCar[2] = initCar(\"CCC-999\", \"CITROEN\", test, 3);\n\n  carCount=3;\n\n  do\n  {\n    printf(\"1. Show cars \\n2. Add car \\n\");\n    scanf(\"%d\", &amp;input);\n\n    switch(input)\n    {\n      case 1:\n        printf(\"ID          BRAND         PICS \\n\");\n        PrintList(myCar, carCount);\n        break; \n      case 2: \n        AddCar(myCar, &amp;carCount, NewCar());\n        printf(\"ID          BRAND         PICS \\n\");\n        PrintList(myCar, carCount);\n    }    //break; \n  } while (input &lt; 1 || input &gt; 2); // compare as integers, not characters. Don't use &lt; operator\n\n  return 0;\n}\n</code></pre>\n\n<p>The code is not tested. Remaining errors are left for exercise. ;)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11086101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550608815, "creation_date": 1550600465, "last_edit_date": 1550608815, "question_id": 54772637, "link": "https://stackoverflow.com/questions/54772637/adding-value-to-struct-adding-goes-wrong-in-c", "title": "adding value to struct, adding goes wrong in C", "body": "<p>I'm new to programming so I'm trying to write a small program were I can show car information but also add cars to my \"library\"\nright now my out come for 1.Show cars looks like this: </p>\n\n<pre><code>  ID          BRAND         PICS \n  bbb188     BMW    1   2   3\n  AAA-999     VOLVO    4   5   6\n  CCC-999     CITROEN    1   2   3\n</code></pre>\n\n<p>but after I add a new car the PICS does not show. \nso if I would add AAA-111 VOLVO 1. this is the outcome: </p>\n\n<pre><code> bbb188     BMW    1   2   3\n AAA-999     VOLVO    4   5   6\n CCC-999     CITROEN    1   2   3\n AAA-111     VOLVO    -398253632   3   3\n</code></pre>\n\n<p>I just get random numbers for pics and always 3 values. \nCould anyone help me with this, and please show me how to do it instead. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define MAX 1000\n#define IDSIZE 20\n#define BRANDSIZE 50\n#define PICSIZE 10\n\ntypedef struct{\n  char id[IDSIZE+1];\n  char brand[BRANDSIZE+1];\n  int *pic;\n} Car;\n\n\nvoid printCar(Car *pCar,int imagecount)\n{\n  printf(\" %s \",pCar-&gt;id);\n  printf(\"    %s \",pCar-&gt;brand);\n  for(int i=0; i&lt;imagecount; i++){\n    printf(\"   %d\",pCar-&gt;pic[i]);\n  }\n  printf(\"\\n\");\n}\n\nCar initCar(char itsId[],char itsBrand[],int *itsPic, int imagecount)\n{\n  Car newCar;\n  strcpy(newCar.id, itsId);\n  strcpy(newCar.brand, itsBrand);\n  newCar.pic = itsPic;\n\n  return newCar;\n}\n\nvoid PrintList(Car aLista[],int imagecount, int carcount)\n{\n  for(int i = 0; i&lt;imagecount; i++)\n    printCar(&amp;aLista[i],carcount);\n}\n\nvoid AddCar(Car aList[], int *pAt, Car theCar) \n{\n  aList[(*pAt)++]=theCar;    \n}\n\nCar NewCar(Car minapatienter[], int patientCount)\n{\n  Car newCar;\n\n  gets(newCar.id);\n  printf(\"type in  ID \\n\"); \n  gets(newCar.id); \n  printf(\"type in brand\\n\");\n  gets(newCar.brand);\n\n  bool imageInputDone = false; \n  int imageCount=0;\n  while(imageInputDone == false)\n  {\n    printf(\"type in image reference \\n\");\n    int newImage; \n    scanf(\"%d\",&amp;newImage);\n\n    newCar.pic = &amp;newImage; \n    imageCount++;\n    printf(\"vill du \\n1.Add another image reference \\n2.exit\\n\");\n    int input;\n    scanf(\"%d\", &amp;input);\n    printf(\"input: %i\\n\",input);\n    switch(input)\n    {\n        case 1: \n            printf(\"Adding one more image\\n\");\n            break;\n        case 2: \n            printf(\"Leaving loop\\n\");\n            imageInputDone = true; \n            break;\n        default:\n            while (input&lt;1 || input&lt;2)\n              ;\n            printf(\"Input correct number\\n\");\n            break;\n    }\n\n    return newCar; \n  }\n}\n\nint main(void)\n{\n  int carCount=0;\n  int imagecount=0;\n  Car myCar[MAX]; \n  int input;\n\n  int test[3]={1,2,3};\n  int test2[3]={4,5,6};\n\n  myCar[0]= initCar(\"bbb188\",\"BMW\", test, 3);\n  myCar[1] = initCar(\"AAA-999\",\"VOLVO\", test2, 3);\n  myCar[2] = initCar(\"CCC-999\", \"CITROEN\", test,3);\n\n  carCount=3;\n  imagecount=3;\n\n  do {\n    printf(\"1. Show cars \\n2. Add car \\n\");\n    scanf(\"%d\",&amp;input);\n    switch(input)\n    {\n      case 1:\n        printf(\"ID          BRAND         PICS \\n\");\n        PrintList(myCar,carCount, imagecount);\n        break; \n      case 2: \n        AddCar(myCar,&amp;carCount,NewCar(myCar,carCount));\n        printf(\"ID          BRAND         PICS \\n\");\n        PrintList(myCar,carCount, imagecount);\n    }    //break; \n  } while (input &lt; '1'|| input &lt; '2');\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c", "visual-studio"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1550601258, "post_id": 54772620, "comment_id": 96325745, "body": "Check <a href=\"https://stackoverflow.com/help/mcve\">&#91;SO&#93;: How to create a Minimal, Complete, and Verifiable example (mcve)</a>. Please edit your question and add relevant code. Also, <b>what is your Visual Studio Project TYPE</b> (maybe <b><i>C#</i></b>)? Cause that doesn&#39;t look like a <i>C</i> error."}, {"owner": {"reputation": 11, "user_id": 7168829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406fef49c9bbb9a896d6329602125331?s=128&d=identicon&r=PG&f=1", "display_name": "user7168829", "link": "https://stackoverflow.com/users/7168829/user7168829"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1550603542, "post_id": 54772620, "comment_id": 96326741, "body": "Its C++ win32, there is no code yet.  Only the include files.  The u-tube example which i followed exactly (although that was in VS 2010) did not have any errors where as mine does."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1550603856, "post_id": 54772620, "comment_id": 96326873, "body": "The includes <b>are code</b>."}, {"owner": {"reputation": 11, "user_id": 7168829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406fef49c9bbb9a896d6329602125331?s=128&d=identicon&r=PG&f=1", "display_name": "user7168829", "link": "https://stackoverflow.com/users/7168829/user7168829"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1550606336, "post_id": 54772620, "comment_id": 96328044, "body": "Ok, but whats wrong with it?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550606819, "post_id": 54772620, "comment_id": 96328297, "body": "Of critical importance: the C language is case sensitive and the keyword is <code>#include</code>  NOT <code>#Include</code>  (note the capitalization)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550606876, "post_id": 54772620, "comment_id": 96328326, "body": "please post the link to the code that you copied"}, {"owner": {"reputation": 1151, "user_id": 3870315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/bpHmm.jpg?s=128&g=1", "display_name": "user3870315", "link": "https://stackoverflow.com/users/3870315/user3870315"}, "edited": false, "score": 0, "creation_date": 1550618470, "post_id": 54772620, "comment_id": 96332606, "body": "Should the Python.h header file be in double quotes if the header is not in the standard library. Something like &quot;Python.h&quot; ?"}], "owner": {"reputation": 11, "user_id": 7168829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406fef49c9bbb9a896d6329602125331?s=128&d=identicon&r=PG&f=1", "display_name": "user7168829", "link": "https://stackoverflow.com/users/7168829/user7168829"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550606483, "creation_date": 1550600422, "last_edit_date": 1550606483, "question_id": 54772620, "link": "https://stackoverflow.com/questions/54772620/simple-python-c-project-wont-run-or-compile", "title": "Simple python / C project wont run or compile", "body": "<p>I copied a very simple example where the only line in the <code>c</code> file is <code>#include</code>, the include file itself contains :</p>\n\n<pre><code> #Include &lt;Python.h&gt;.  \n</code></pre>\n\n<p>It's a win32 project, using <code>Python27</code>.</p>\n\n<p>However visual studio is give the message:</p>\n\n<pre><code>1&gt;------ Build started: Project: CProjectVS2017, Configuration: Debug Win32 ------\n1&gt;Object reference not set to an instance of an object.\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\n</code></pre>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1550600640, "post_id": 54772561, "comment_id": 96325451, "body": "<code>currbuf2</code> will usually never be equal to <code>currbuf</code> unless the compiler is merging duplicate string literals. However you set both of them to equal <code>temp</code>. That is not the way to compare a string in C."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 2, "creation_date": 1550600680, "post_id": 54772561, "comment_id": 96325471, "body": "This will hog your CPU."}, {"owner": {"reputation": 1031, "user_id": 9817924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Juraj Jakubov", "link": "https://stackoverflow.com/users/9817924/juraj-jakubov"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1550600770, "post_id": 54772561, "comment_id": 96325519, "body": "@WeatherVane But if they never will be equal it will be printing something forever. But with that IF statement it prints only first active window."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1550600812, "post_id": 54772561, "comment_id": 96325540, "body": "@JurajJakubov I was editing the first comment."}, {"owner": {"reputation": 1031, "user_id": 9817924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Juraj Jakubov", "link": "https://stackoverflow.com/users/9817924/juraj-jakubov"}, "edited": false, "score": 1, "creation_date": 1550600901, "post_id": 54772561, "comment_id": 96325582, "body": "Thanks i was googling and going to try &quot;strcmp&quot;."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1550600952, "post_id": 54772561, "comment_id": 96325605, "body": "You don&#39;t copy strings in C with <code>=</code> and even if you used <code>strcpy</code> the target is a (read-only) string literal of inadequate size."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1550601105, "post_id": 54772561, "comment_id": 96325678, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8004237/how-do-i-properly-compare-strings\">How do I properly compare strings?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1550601651, "last_edit_date": 1550601651, "creation_date": 1550600950, "answer_id": 54772755, "question_id": 54772561, "link": "https://stackoverflow.com/questions/54772561/cycle-is-not-printing-active-window/54772755#54772755", "title": "Cycle is not printing active window", "body": "<blockquote>\n  <p>Problem is that it print only title of first active window.</p>\n</blockquote>\n\n<p>You need to compare the string <em>contents</em>, not the string <em>pointers</em>:</p>\n\n<pre><code>char temp[100] = \"\", currbuf[100] = \"\";\n\nwhile (1) {\n    GetWindowText(GetForegroundWindow(), temp, sizeof temp / sizeof *temp);\n    if (strcmp(currbuf, temp) != 0) {\n        strcpy(currbuf, temp);\n        printf(\"\\n\\nWindow title: %s\\n\", temp);\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>What i want to do is to print title of active window everytime it changes.</p>\n</blockquote>\n\n<p>Rather than using an endless loop that constantly polls the active window, you should instead use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setwineventhook\" rel=\"nofollow noreferrer\"><code>SetWinEventHook()</code></a> to receive <code>EVENT_SYSTEM_FOREGROUND</code> notifications from the OS whenever the foreground window changes. Don't poll (except maybe the first time before starting the hook).</p>\n\n<pre><code>void displayWindowTitle(HWND hWnd)\n{\n    char temp[100] = \"\";\n    GetWindowText(hWnd, temp, sizeof temp / sizeof *temp);\n    printf(\"\\n\\nWindow title: %s\\n\", temp);\n}\n\nvoid CALLBACK MyHookCallback(HWINEVENTHOOK hook, DWORD event, HWND hwnd, LONG idObject, LONG idChild, DWORD dwEventThread, DWORD dwmsEventTime)\n{\n    displayWindowTitle(hwnd);\n}\n\n...\n\ndisplayWindowTitle(GetForegroundWindow());\nHWINEVENTHOOK hHook = SetWinEventHook(EVENT_SYSTEM_FOREGROUND, EVENT_SYSTEM_FOREGROUND, NULL, &amp;MyHookCallback, 0, 0, WINEVENT_OUTOFCONTEXT);\n...\nUnhookWinEvent(hHook);\n</code></pre>\n"}], "owner": {"reputation": 1031, "user_id": 9817924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Juraj Jakubov", "link": "https://stackoverflow.com/users/9817924/juraj-jakubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54772755, "answer_count": 1, "score": 0, "last_activity_date": 1550601651, "creation_date": 1550600176, "last_edit_date": 1550601160, "question_id": 54772561, "link": "https://stackoverflow.com/questions/54772561/cycle-is-not-printing-active-window", "title": "Cycle is not printing active window", "body": "<p>I have a simple cycle with simple window print function.</p>\n\n<pre><code>char temp[100], *currbuf= \"\", *currbuf2 = \"\";\n\n\nwhile (1) {\n    GetWindowText(GetForegroundWindow(), temp, sizeof temp / sizeof *temp);\n    currbuf2 = temp;\n    if (currbuf2 != currbuf) {\n        currbuf = temp;\n        printf(\"\\n\\nWindow title: %s\\n\", temp);\n    };\n};\n</code></pre>\n\n<p>Problem is that it print only title of first active window.\nWhat i want to do is to print title of active window everytime it changes.\nWithout if statement it works well(but still printing that active window).</p>\n"}, {"tags": ["c", "arrays", "gets"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1550599655, "post_id": 54772430, "comment_id": 96324927, "body": "<code>gets</code> is deprecated.  Do not use it."}, {"owner": {"reputation": 45, "user_id": 10781996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIU179Eh3Nw/AAAAAAAAAAI/AAAAAAAAAEM/tW2YjWO-Gzk/photo.jpg?sz=128", "display_name": "bufftowel", "link": "https://stackoverflow.com/users/10781996/bufftowel"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550599690, "post_id": 54772430, "comment_id": 96324951, "body": "may i know why is that?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1550599707, "post_id": 54772430, "comment_id": 96324959, "body": "See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why the <code>gets()</code> function is too dangerous to be used \u2014 ever!</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1550599841, "post_id": 54772430, "comment_id": 96325028, "body": "Using <code>gets()</code> is dangerous because it doesn&#39;t know how big the buffer is.  If you enter 32 digits (or fewer) and a newline, your code would be &#39;OK&#39;.  If you enter more, or add spaces at either end, then you will run into problems.  The <code>gets()</code> function was removed from C11 (a change forecast in TC3 \u2014 Technical Corrigendum 3 \u2014 in 2007).  You should assume it causes your program to crash.  (Note that a program using <code>gets()</code> was one of the bugs that allowed the Morris Internet Worm to escape in 1988.)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1550599864, "post_id": 54772430, "comment_id": 96325034, "body": "Re the behaviour: the <code>&#39;\\0&#39;</code> is added at the end of the text you entered, not at the end of the array you defined."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1550600221, "post_id": 54772430, "comment_id": 96325230, "body": "Note that the <code>for</code> loop condition <code>i &lt; 33, binary[i] != &#39;\\0&#39;</code> uses a comma operator which evaluates and discards the LHS (<code>i &lt; 33</code>) and then produces the result of the RHS (<code>binary[i] != &#39;\\0&#39;</code>).  If the user types 64 digits, your loop will go accessing way beyond the end of the array."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1550600296, "post_id": 54772430, "comment_id": 96325278, "body": "Also, the ASCII NUL (single <code>L</code>) character is different from <code>NULL</code>.  You should only use <code>NULL</code> in the context of pointers.  On some systems, it is defined as <code>#define NULL ((void *)0)</code> and using that to assign to an <code>char</code> will often (but not necessarily) trigger a compiler warning.  It depends on how fussy you set your compiler to be."}, {"owner": {"reputation": 45, "user_id": 10781996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIU179Eh3Nw/AAAAAAAAAAI/AAAAAAAAAEM/tW2YjWO-Gzk/photo.jpg?sz=128", "display_name": "bufftowel", "link": "https://stackoverflow.com/users/10781996/bufftowel"}, "edited": false, "score": 0, "creation_date": 1550600582, "post_id": 54772430, "comment_id": 96325419, "body": "ok i will keep that in mind."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1550606565, "post_id": 54772430, "comment_id": 96328161, "body": "any modern C compiler will output a message about the function: <code>gets()</code>.  You should always enable the warnings then fix those warnings.  Suggest using <code>fgets()</code> (which has a different syntax, so read the MAN page)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1550607904, "post_id": 54772430, "comment_id": 96328774, "body": "@ChristianGibbons gets was removed in 2011. It was deprecated before that"}], "answers": [{"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": true, "score": 6, "last_activity_date": 1550599721, "creation_date": 1550599721, "answer_id": 54772454, "question_id": 54772430, "link": "https://stackoverflow.com/questions/54772430/does-the-gets-function-in-c-automatically-add-a-null-character-at-the-end-of-t/54772454#54772454", "title": "Does the gets() function in C automatically add a NULL character at the end of the input string?", "body": "<p>Yes it does, writing past the end of <code>binary[33]</code> if it needs to.</p>\n\n<p>Never use <code>gets</code>; automatic buffer overrun.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">Why is the gets function so dangerous that it should not be used?</a> for details.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1550606923, "creation_date": 1550606923, "answer_id": 54774168, "question_id": 54772430, "link": "https://stackoverflow.com/questions/54772430/does-the-gets-function-in-c-automatically-add-a-null-character-at-the-end-of-t/54774168#54774168", "title": "Does the gets() function in C automatically add a NULL character at the end of the input string?", "body": "<p>When <code>gets</code> was last supported (though deprecated) by the C standard, it had the following description (&sect; 7.19.7.7, The <code>gets</code> function):</p>\n\n<blockquote>\n  <p>The gets function reads characters from the input stream pointed to by <code>stdin</code>, into the\n  array pointed to by <code>s</code>, until end-of-file is encountered or a new-line character is read.\n  Any new-line character is discarded, and a <strong>null character is written immediately after the last character</strong> read into the array.</p>\n</blockquote>\n\n<p>This means that if the string read from <code>stdin</code> was exactly as long as, or longer than, the array pointed to by <code>s</code>, <code>gets</code> would still (try to) append the null character to the end of the string.</p>\n\n<p>Even if you are on a compiler or C standard revision that supports <code>gets</code>, don't use it. <code>fgets</code> is much safer since it requires the size of the buffer being written to as a parameter, and will not write past its end. Another difference is that it will leave the newline in the buffer, unlike <code>gets</code> did.</p>\n"}], "owner": {"reputation": 45, "user_id": 10781996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIU179Eh3Nw/AAAAAAAAAAI/AAAAAAAAAEM/tW2YjWO-Gzk/photo.jpg?sz=128", "display_name": "bufftowel", "link": "https://stackoverflow.com/users/10781996/bufftowel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 0, "accepted_answer_id": 54772454, "answer_count": 2, "score": 0, "last_activity_date": 1550606923, "creation_date": 1550599624, "last_edit_date": 1550600129, "question_id": 54772430, "link": "https://stackoverflow.com/questions/54772430/does-the-gets-function-in-c-automatically-add-a-null-character-at-the-end-of-t", "title": "Does the gets() function in C automatically add a NULL character at the end of the input string?", "body": "<p>I am writing a simple program to convert a number(+ve,32-bit) from binary to decimal. Here's my code:</p>\n\n<pre><code>int main()\n{\n    int n=0,i=0;\n    char binary[33];\n    gets(binary);\n    for (i = 0; i &lt; 33, binary[i] != '\\0'; i++)\n        n=n*2+binary[i]-'0';\n    printf(\"%d\",n);\n}\n</code></pre>\n\n<p>If I remove <code>binary[i]!='\\0'</code>, then it gives wrong answer due to garbage values but if I don't it gives the correct answer. My question is: does the <code>gets</code> function automatically add a '\\0' (NULL) character at the end of the string or is this just a coincidence?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550594981, "post_id": 54771057, "comment_id": 96322456, "body": "Do bounds checking on the result. If it&#39;s not acceptable, error out."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1550595009, "post_id": 54771057, "comment_id": 96322474, "body": "@tadman which is easier said, than done."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550595026, "post_id": 54771057, "comment_id": 96322481, "body": "Overflow bugs occur when you fail to test the result and just <i>assume</i> it&#39;s fine. If you need to, clamp the result to acceptable bounds."}, {"owner": {"reputation": 8716, "user_id": 634336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X0uNz.jpg?s=128&g=1", "display_name": "Tugrul Ates", "link": "https://stackoverflow.com/users/634336/tugrul-ates"}, "edited": false, "score": 0, "creation_date": 1550595171, "post_id": 54771057, "comment_id": 96322556, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1694266/validate-max-integer-in-scanf\">Validate max integer in scanf</a>"}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1550595079, "post_id": 54771191, "comment_id": 96322509, "body": "A comment sample worth a thousand words :)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1550595151, "post_id": 54771191, "comment_id": 96322545, "body": "@SergeyA what do you mean ? an example of code is missing ?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1550595170, "post_id": 54771191, "comment_id": 96322554, "body": "Yes, this is exactly what I mean"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1550595197, "post_id": 54771191, "comment_id": 96322567, "body": "@SergeyA so we agree, I will ^^"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1550597643, "post_id": 54771191, "comment_id": 96323867, "body": "You need to set <code>errno</code> to zero before calling <code>strtol()</code> otherwise there&#39;s no guarantee it will be zero should <code>strtol()</code> succeed."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1550597721, "post_id": 54771191, "comment_id": 96323918, "body": "@AndrewHenle ah yes, very true, stupid I am, thank you"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550600505, "post_id": 54771191, "comment_id": 96325382, "body": "You could use <code>&lt;limits.h&gt;</code> and <code>INT_MAX</code> and <code>INT_MIN</code> and <code>LONG_MAX</code> and <code>LONG_MIN</code> to determine whether the range of <code>int</code> and <code>long</code> are the same, or use <code>sizeof(int) != sizeof(long)</code> in a condition (not in a preprocessor condition, but in an <code>if</code> statement)."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550600668, "post_id": 54771191, "comment_id": 96325464, "body": "@JonathanLeffler yes but I do not wanted to add #ifdef to know if hte size are not the same, and in case the size are the same I think the compiler by itself will remove <code>((int) l) != l)</code>, no ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550601151, "post_id": 54771191, "comment_id": 96325708, "body": "Yes, but you could also use <code>if (l &gt; INT_MAX || l &lt; INT_MIN)</code> which is not conditionally compiled, either.  And you could prefix that with a test on <code>sizeof()</code> which would be resolved at compile time: <code>if (sizeof(int) != sizeof(long) &amp;&amp; (l &gt; INT_MAX || l &lt; INT_MIN))</code>.  An optimizing compiler would eliminate that code if <code>int</code> and <code>long</code> are the same size \u2014 maybe even when not optimizing."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550601694, "post_id": 54771191, "comment_id": 96325957, "body": "@JonathanLeffler my point of view is <code>if (sizeof(int) != sizeof(long) &amp;&amp; (l &gt; INT_MAX || l &lt; INT_MIN))</code> more complicated to read than the simple and short form <code>((int) l) != l)</code> and &#39;worst&#39; to write for my lazy fingers, and all of that for the same result after compilation. But thank you for your remark"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1550602252, "post_id": 54771191, "comment_id": 96326214, "body": "OK \u2014 opinions differ. Even without a comment, the expression checking against <code>INT_MIN</code> and <code>INT_MAX</code> is clearly testing the range, whereas it&#39;s not obvious what the comparison with cast is doing. (Note that the compiler has to treat it as <code>((long)(int)l != l)</code> with the extra conversion to <code>long</code> if the two types are of different sizes.) With a comment, it is &#39;OK&#39; \u2014 it might even be more efficient because it doesn&#39;t require branching. I was merely pointing out that there are other ways to write the tests. I said &#39;could&#39; in my first comment. I did not say &#39;should&#39; (but I would use the limits)."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 7, "last_activity_date": 1550597858, "last_edit_date": 1550597858, "creation_date": 1550594991, "answer_id": 54771191, "question_id": 54771057, "link": "https://stackoverflow.com/questions/54771057/check-for-possible-int-overflow-from-an-input/54771191#54771191", "title": "Check For Possible Int Overflow From an Input", "body": "<p>You can read a string then use <em>strtol</em> then check the <em>endptr</em> and <em>errno</em>, when all is ok you can assign your <em>int</em> var</p>\n\n<p>Verbose use of <em>strtol</em></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n\nint main()\n{\n  char s[32]; /* 31 characters is surely large enough for an int */\n\n  if (scanf(\"%31s\", s) != 1)\n    puts(\"nok\");\n  else {\n    errno = 0;\n\n    char * endptr;\n    long int l = strtol(s, &amp;endptr, 10);\n\n    if (endptr == s)\n      puts(\"no digit\");\n    else if ((*endptr != 0) &amp;&amp; !isspace(*endptr))\n      puts(\"invalid number\");\n    else if (errno != 0)\n      puts(\"overflow on long\");\n    else if (((int) l) != l) /* in case long and int do not have the same size */\n      puts(\"overflow on int\");\n    else\n      puts(\"you enter a valid int\");\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra s.c\npi@raspberrypi:/tmp $ ./a.out\na \nno digit\npi@raspberrypi:/tmp $ ./a.out\n12z\ninvalid number\npi@raspberrypi:/tmp $ ./a.out\n123\nyou enter a valid int\npi@raspberrypi:/tmp $ ./a.out\n12345678901\noverflow on long\n</code></pre>\n\n<hr>\n\n<p>So to exactly answer to the question :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n\nint readInt(int * v)\n{\n  char s[32]; /* 31 characters is surely large enough for an int */\n\n  if (scanf(\"%31s\", s) != 1)\n    return 0;\n  else {\n    errno = 0;\n\n    char * endptr;\n    long int l = strtol(s, &amp;endptr, 10);\n\n    if ((endptr == s) ||       /* no digit */\n        ((*endptr != 0) &amp;&amp; !isspace(*endptr)) || /* e.g. 12a */\n        (errno != 0) ||        /* overflow on long */\n        (((int) l) != l))      /* overflow on int */\n      return 0;\n\n    *v = (int) l;\n    return 1;\n  }\n}\n\n\nint main()\n{\n  int v = 123;\n\n  if (readInt(&amp;v))\n    printf(\"new valid in value : %d\\n\", v);\n  else\n    printf(\"unvalid input, still %d\\n\", v);\n\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra s.c\npi@raspberrypi:/tmp $ ./a.out\n12\nnew valid in value : 12\npi@raspberrypi:/tmp $ ./a.out\n9878787878787878\nunvalid input, still 123\npi@raspberrypi:/tmp $ \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1550595064, "post_id": 54771200, "comment_id": 96322498, "body": "A comment sample worth a thousand words :)"}], "tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": false, "score": 2, "last_activity_date": 1550595019, "creation_date": 1550595019, "answer_id": 54771200, "question_id": 54771057, "link": "https://stackoverflow.com/questions/54771057/check-for-possible-int-overflow-from-an-input/54771200#54771200", "title": "Check For Possible Int Overflow From an Input", "body": "<p>If you must read directly into an int, you can't really check for overflow before assigning.  </p>\n\n<p>There are ways around that if reading directly into int is not a requirement.  For example, you can read into a character buffer/string and then check if the input was numeric and if it will fit into an int.  If so, you then convert character buffer to an integer using standard library functions and assign to your int.</p>\n"}], "owner": {"reputation": 73, "user_id": 10786121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UocuP.jpg?s=128&g=1", "display_name": "HaxCkzersssxz", "link": "https://stackoverflow.com/users/10786121/haxckzersssxz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 54771191, "answer_count": 2, "score": 3, "last_activity_date": 1550597858, "creation_date": 1550594453, "question_id": 54771057, "link": "https://stackoverflow.com/questions/54771057/check-for-possible-int-overflow-from-an-input", "title": "Check For Possible Int Overflow From an Input", "body": "<p>I've been reading sources for a while but they're always talking about overflows when doing operations but how do I really check for potential int overflow the moment it was entered by the user before it can be assigned to the int identifier?</p>\n\n<p>I want to check the input the moment it was entered so when found that such value already exceeded the range of value for int type data, I can put a stop to it before it even proceeds to the next part of the code.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1550594756, "post_id": 54771050, "comment_id": 96322312, "body": "We would need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to be sure, but the most plausible explanation I see is that the <code>for</code> loop performs zero iterations.  That might easily result from the contents of the <code>test_suite.txt</code> file being malformed."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1550594778, "post_id": 54771050, "comment_id": 96322325, "body": "Where do you make <code>s1</code> point to enough memory to hold the string you try to read into what it points to?"}, {"owner": {"reputation": 117, "user_id": 11006304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868653dd90dc31acdd518433040d95ca?s=128&d=identicon&r=PG&f=1", "display_name": "user11006304", "link": "https://stackoverflow.com/users/11006304/user11006304"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550594820, "post_id": 54771050, "comment_id": 96322349, "body": "@JohnBollinger it contains &quot;TC1 1 TC2 9 TC3 10 TC4 12&quot;"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550594875, "post_id": 54771050, "comment_id": 96322388, "body": "On the other hand, perhaps the program just crashes.  It is, after all, trying to <code>strcpy</code> into the memory pointed to by <code>s2</code>, when in fact <code>s2</code> has never been assigned a value.  The program therefore having undefined behavior, pretty much anything might happen."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1550594969, "post_id": 54771050, "comment_id": 96322450, "body": "Same with <code>s2</code>. Always compile with warnings and debug information turned on! Then run your program through valgrind, or compile with <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizer\" rel=\"nofollow noreferrer\">ASan</a>."}, {"owner": {"reputation": 117, "user_id": 11006304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868653dd90dc31acdd518433040d95ca?s=128&d=identicon&r=PG&f=1", "display_name": "user11006304", "link": "https://stackoverflow.com/users/11006304/user11006304"}, "edited": false, "score": 0, "creation_date": 1550595072, "post_id": 54771050, "comment_id": 96322502, "body": "I declared s1 and s2 as s1[20] and s2[20] and now it works."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1550595704, "post_id": 54771050, "comment_id": 96322865, "body": "Spam-repeating the same thing over and over because you didn&#39;t explain well enough doesn&#39;t mean that you did explain well enough. You may have fooled the content screening filter, but you haven&#39;t fooled us."}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 9499535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Horacio Goetendia", "link": "https://stackoverflow.com/users/9499535/horacio-goetendia"}, "is_accepted": true, "score": 1, "last_activity_date": 1550597520, "last_edit_date": 1550597520, "creation_date": 1550597395, "answer_id": 54771880, "question_id": 54771050, "link": "https://stackoverflow.com/questions/54771050/why-doesnt-this-program-write-in-result-txt/54771880#54771880", "title": "Why doesn&#39;t this program write in result.txt?", "body": "<p>In this part:</p>\n\n<pre><code>while(fscanf(fp, \"%s %d\", s1, &amp;n) == 2) cont++;\n</code></pre>\n\n<p>Maybe \"cont\" dont increment because \"test_suite.txt\" don't have the \"fscanf\" format requirements.</p>\n"}], "owner": {"reputation": 117, "user_id": 11006304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868653dd90dc31acdd518433040d95ca?s=128&d=identicon&r=PG&f=1", "display_name": "user11006304", "link": "https://stackoverflow.com/users/11006304/user11006304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 54771880, "answer_count": 1, "score": -1, "last_activity_date": 1550597520, "creation_date": 1550594417, "last_edit_date": 1550595707, "question_id": 54771050, "link": "https://stackoverflow.com/questions/54771050/why-doesnt-this-program-write-in-result-txt", "title": "Why doesn&#39;t this program write in result.txt?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"vettore.h\"\n\nint main(int argc, char *argv[]){\n    FILE *result = fopen(\"result.txt\", \"w\");\n    int cont = 0, i, n;\n    char *s1;\n    if(argc != 1)\n        printf(\"Numero parametri non corretto\\n\");\n    else{\n        FILE *fp = fopen(\"test_suite.txt\", \"r\");\n        while(fscanf(fp, \"%s %d\", s1, &amp;n) == 2)\n            cont++;\n        rewind(fp);\n        for(i=0; i&lt;cont; i++){\n            fscanf(fp, \"%s %d\", s1, &amp;n);\n            int *a = (int*) calloc(n, sizeof(int));\n            char *s2;\n            strcpy(s2, s1);\n            finput_array(strcat(s1,\"_input.txt\"), a, n);\n            strcpy(s1,s2);\n            bubblesort(a, n);\n            foutput_array(strcat(s1, \"_output.txt\"), a, n);\n            strcpy(s1,s2);\n            int *oracle = (int*) calloc(n, sizeof(int));\n            finput_array(strcat(s1, \"_oracle.txt\"), oracle, n);\n            strcpy(s1,s2);\n\n            if(confronta_array(a, oracle, n))\n                fprintf(result, \"%s PASS\\n\", s1);\n            else\n                fprintf(result, \"%s FAIL\\n\", s1);\n            free(a);\n            free(oracle);\n        }\n        fclose(fp);\n    }\n    fclose(result);\n}\n</code></pre>\n\n<p>This are \"vettore.c\" functions:</p>\n\n<pre><code>void bubblesort(int a[], int n){\nint i, j;\n  for(i = 0 ; i &lt; n - 1; i++)\n  {\n    for(j = 0 ; j &lt; n - i - 1; j++)\n    {\n      if (a[j] &gt; a[j+1]) /* For decreasing order use &lt; */\n      {\n        scambia(&amp;a[j], &amp;a[j+1]);\n       }\n      }\n     }\n}\n\nvoid finput_array(char *file_name, int a[], int n){\n    FILE *fd = fopen(file_name, \"r\");\n    if(fd == NULL)\n        printf(\"Errore in apertura del file %s\\n\", file_name);\n    else{\n        for(int i=0; i&lt;n; i++)\n            fscanf(fd, \"%d\", &amp;a[i]);\n        fclose(fd);\n    }\n}\n\nvoid foutput_array(char *file_name, int a[], int n){\n    int i;\n    FILE *fd;\n\n    fd = fopen(file_name, \"w\");\n    if(fd == NULL)\n        printf(\"Errore in apertura del file %s\\n\", file_name);\n    else{\n        for(i=0; i&lt;n; i++)  \n            fprintf(fd, \"%d\\n\", a[i]);\n        fclose(fd);\n    }\n}\n\nint confronta_array(int a[], int b[], int n){\n    int i=0;\n\n    while(i&lt;n &amp;&amp; a[i] == b[i])\n        i++;\n\n    return (i==n) ? 1 : 0;\n}\n</code></pre>\n\n<p>The program doesn't write anything in \"result.txt\". Why?</p>\n\n<p>It should write those sentences.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1550593779, "post_id": 54770835, "comment_id": 96321708, "body": "AFAIK UNICODE support in <code>cmd.exe</code> is still broken and just a PITA."}, {"owner": {"reputation": 363, "user_id": 10284786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ef9fc457873fe05114b2fa5c9eb05f?s=128&d=identicon&r=PG&f=1", "display_name": "Doritos", "link": "https://stackoverflow.com/users/10284786/doritos"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550594080, "post_id": 54770835, "comment_id": 96321904, "body": "Do you know of any other way to run CMD.EXE commands that support UNICODE? I was originally doing a wpopen but that spawns a cmd.exe window. Was switching to CreateProcess so I can hide it."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550594310, "post_id": 54770835, "comment_id": 96322053, "body": "<code>_wpopen()</code> doesn&#39;t start a different command interpreter. It is just a version of <code>_popen()</code> that accepts UNICODE strings as command line. Do you actually know that the tools you call output UNICODE characters?"}, {"owner": {"reputation": 363, "user_id": 10284786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ef9fc457873fe05114b2fa5c9eb05f?s=128&d=identicon&r=PG&f=1", "display_name": "Doritos", "link": "https://stackoverflow.com/users/10284786/doritos"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550594387, "post_id": 54770835, "comment_id": 96322097, "body": "A dir command could output Unicode."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550594463, "post_id": 54770835, "comment_id": 96322147, "body": "I don&#39;t think so. <a href=\"https://www.curlybrace.com/words/2014/10/03/windows-console-and-doublemulti-byte-character-set/\" rel=\"nofollow noreferrer\">Windows Console and Double/Multi Byte Character Set</a>"}, {"owner": {"reputation": 363, "user_id": 10284786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ef9fc457873fe05114b2fa5c9eb05f?s=128&d=identicon&r=PG&f=1", "display_name": "Doritos", "link": "https://stackoverflow.com/users/10284786/doritos"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550595537, "post_id": 54770835, "comment_id": 96322772, "body": "Oh that is interesting."}], "answers": [{"tags": [], "owner": {"reputation": 362, "user_id": 5331696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53418e9ac96de6ad4951d5b8140fc22c?s=128&d=identicon&r=PG&f=1", "display_name": "vasile_t", "link": "https://stackoverflow.com/users/5331696/vasile-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1550594448, "last_edit_date": 1550594448, "creation_date": 1550594055, "answer_id": 54770949, "question_id": 54770835, "link": "https://stackoverflow.com/questions/54770835/windows-c-programming-readfile-char-or-wchar/54770949#54770949", "title": "Windows C Programming ReadFile CHAR or WCHAR", "body": "<p>You are basically reading from a stream, be it pipe of file or a in-memory buffer. So what you usually obtain is a pointer to a buffer in your program. It is up to your app logic to determine how to treat those bytes - as CHAR or as WCHAR, i.e. UTF-8 or UTF-16. Keep in mind that a buffer of CHAR elements can be cast to one of WCHAR and vice-versa.</p>\n\n<p>I could suggest to use WHCAR to make your app UTF-16 compatible. Youc an refer to this question <a href=\"https://stackoverflow.com/questions/23136837/in-c-when-to-use-wchar-and-when-to-use-char/46445846\">In C++ when to use WCHAR and when to use CHAR</a></p>\n"}], "owner": {"reputation": 363, "user_id": 10284786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ef9fc457873fe05114b2fa5c9eb05f?s=128&d=identicon&r=PG&f=1", "display_name": "Doritos", "link": "https://stackoverflow.com/users/10284786/doritos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550594448, "creation_date": 1550593596, "last_edit_date": 1550593823, "question_id": 54770835, "link": "https://stackoverflow.com/questions/54770835/windows-c-programming-readfile-char-or-wchar", "title": "Windows C Programming ReadFile CHAR or WCHAR", "body": "<p>I am using ReadFile to read a pipe that has output from a command I run. However my understanding is ReadFile only reads the bytes and doesn't care if they are WCHAR or CHAR. It just reads the bytes.</p>\n\n<p>I am trying to understand how would I go about determining if the bytes it reads from the buffer are WCHAR or CHAR so I can print properly. These bytes will be sent back to a Python server that will print.</p>\n"}, {"tags": ["c", "variables"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 2, "creation_date": 1550593708, "post_id": 54770825, "comment_id": 96321663, "body": "Please show the definition of <code>struct client_config</code> and if necessary all types used for its members. Probably <code>config-&gt;MAC</code> is not large enough for the data you copy with <code>strcpy</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1550594015, "post_id": 54770825, "comment_id": 96321868, "body": "Without seeing the remainder of your code, when a variable changes value and you haven&#39;t changed it -- that is the result of stack (or heap) corruption generally caused by you writing beyond the end of an array or failing to allocate for a pointer variable and then writing information to the pointer address. This overwrites adjacent variable values."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1550594552, "post_id": 54770825, "comment_id": 96322214, "body": "Your <code>MAC</code> field is large enough to hold 12 characters, but not a 12-character <i>string</i> - you need an extra element for the string terminator.  To store an N-character <i>string</i>, you need <i>at least</i> an N+1 sized array."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550593834, "post_id": 54770871, "comment_id": 96321745, "body": "I think your analysis is right, but is this supposed to be an answer or a comment?  If the former, then the &quot;Please also post [...]&quot; bit has no place.  And if the latter, then it is a bit sparse."}], "tags": [], "owner": {"reputation": 423, "user_id": 5611829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdae215b7e14781af23ae4fad4746732?s=128&d=identicon&r=PG&f=1", "display_name": "bbu", "link": "https://stackoverflow.com/users/5611829/bbu"}, "is_accepted": true, "score": 1, "last_activity_date": 1550593944, "last_edit_date": 1550593944, "creation_date": 1550593742, "answer_id": 54770871, "question_id": 54770825, "link": "https://stackoverflow.com/questions/54770825/why-my-variable-changes-its-value-when-i-am-not-changing-it-c/54770871#54770871", "title": "Why my variable changes its value when I am not changing it? C", "body": "<p>It appears like your MAC field has exactly 12 chars and no place for the trailing 0 char so that the following server is directly appended during print.</p>\n"}, {"tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 2, "last_activity_date": 1550594023, "creation_date": 1550594023, "answer_id": 54770941, "question_id": 54770825, "link": "https://stackoverflow.com/questions/54770825/why-my-variable-changes-its-value-when-i-am-not-changing-it-c/54770941#54770941", "title": "Why my variable changes its value when I am not changing it? C", "body": "<p>You don't have space for the terminating <code>'\\0'</code> in the <code>MAC</code> field. </p>\n\n<p>When you first copy to the <code>MAC</code> field, the <code>printf</code> finds the terminating <code>'\\0'</code> in the <code>server</code> field. After copying to <code>server</code>, the characters in <code>server</code> follow immediately after the characters in <code>MAC</code> without a terminating <code>'\\0'</code> in between.</p>\n\n<p>You need at least</p>\n\n<pre><code>struct client_config{\n    char name[20]; //en teoria son 6 + '\\0'\n    char MAC[13]; // 12 characters + '\\0'\n    char server[20];\n    int UDPport;\n};\n</code></pre>\n\n<p>You should also check that <code>strcpy</code> does not copy more than the available memory for the structure fields. Maybe use <code>strncpy</code> instead of <code>strcpy</code>, but make sure the result is terminated with <code>'\\0'</code>. (Read the documentation of <code>strncpy</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 2, "last_activity_date": 1550594813, "last_edit_date": 1550594813, "creation_date": 1550594186, "answer_id": 54770989, "question_id": 54770825, "link": "https://stackoverflow.com/questions/54770825/why-my-variable-changes-its-value-when-i-am-not-changing-it-c/54770989#54770989", "title": "Why my variable changes its value when I am not changing it? C", "body": "<p>The problem is that the MAC field does not have room for the trailing <code>\\0</code> character. All strings in C needs to be one character longer than the actual data.</p>\n\n<p>To make the reading more secure, I'd recommend using a max length for fscanf. Like this:</p>\n\n<pre><code>fscanf(conf, \"%12s\", word); \n</code></pre>\n\n<p>Or even better, use <code>fgets</code>. It makes it easy to use a variable or constant for max length.</p>\n\n<pre><code>fgets(word, MAXLENGTH, conf);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 9499535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Horacio Goetendia", "link": "https://stackoverflow.com/users/9499535/horacio-goetendia"}, "is_accepted": false, "score": 0, "last_activity_date": 1550597449, "last_edit_date": 1550597449, "creation_date": 1550596076, "answer_id": 54771535, "question_id": 54770825, "link": "https://stackoverflow.com/questions/54770825/why-my-variable-changes-its-value-when-i-am-not-changing-it-c/54771535#54771535", "title": "Why my variable changes its value when I am not changing it? C", "body": "<ul>\n<li><p>Check the <strong>struct client_config</strong> members size, do not forget to consider the string null terminator \"\\0\".</p></li>\n<li><p>Do not forget to initialize the <strong>struct client_config</strong> with zeros before.</p></li>\n</ul>\n"}], "owner": {"reputation": 65, "user_id": 11085536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b492a7ca30eb94e0464faea608688f?s=128&d=identicon&r=PG&f=1", "display_name": "Blodorn", "link": "https://stackoverflow.com/users/11085536/blodorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 54770871, "answer_count": 4, "score": 1, "last_activity_date": 1590398176, "creation_date": 1550593566, "last_edit_date": 1590398176, "question_id": 54770825, "link": "https://stackoverflow.com/questions/54770825/why-my-variable-changes-its-value-when-i-am-not-changing-it-c", "title": "Why my variable changes its value when I am not changing it? C", "body": "<p>I have to read some configuration on a file to do a project from college.\nIn my read function I use a struct to store the configuration but, I don't know why, one of the variables changes it's value when reading the next parameter.</p>\n\n<pre><code>struct client_config {\n    char name[20]; // en teoria son 6 + '\\0'\n    char MAC[12];\n    char server[20];\n    int UDPport;\n};\n\nvoid read_software_config_file(struct client_config *config) {\n    FILE * conf;\n    conf = fopen(software_config_file, \"r\");\n    if (conf == NULL) {\n        fprintf(stderr, \"Error obrir arxiu\");\n        exit(-1);\n    }\n    char word[1024];\n    int i = 0;\n\n    fscanf(conf, \"%s\", word);\n    // No es la millor manera de fer-ho...\n    // pero ja que suposem que el fitxer es correcte\n    fscanf(conf, \"%s\", word);\n    // Ens saltem les comprovacions\n    strcpy(config-&gt;name, word);\n\n    fscanf(conf, \"%s\", word);\n    fscanf(conf, \"%s\", word);\n    strcpy(config-&gt;MAC, word);\n    printf(\"%s this is config-&gt;mac after first read \\n\", config-&gt;MAC);\n\n    fscanf(conf, \"%s\", word);\n    fscanf(conf, \"%s\", word);\n    strcpy(config-&gt;server, word);\n    printf(\"%s this is config-&gt;mac after next read \\n\", config-&gt;MAC);\n\n    fscanf(conf, \"%s\", word);\n    fscanf(conf, \"%s\", word);\n    config-&gt;UDPport = atoi(word);\n    fclose(conf);\n}\n</code></pre>\n\n<p>OUTPUT: </p>\n\n<p>89F107457A36 this is config->mac after first read (this is correct)</p>\n\n<p>89F107457A36localhost this is config->mac after next read (this is not correct)</p>\n\n<p>The file i'm reading is this:</p>\n\n<pre><code>Nom SW-01\nMAC 89F107457A36\nServer localhost\nServer-port 2019\n</code></pre>\n"}, {"tags": ["c", "string", "strcpy", "strlcpy"], "comments": [{"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1550593708, "post_id": 54770801, "comment_id": 96321662, "body": "<i>when they basically do the same thing</i> - incorrect assumption. See <a href=\"https://en.m.wikipedia.org/wiki/Null-terminated_string\" rel=\"nofollow noreferrer\">Null-terminated strings</a>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1550593986, "post_id": 54770801, "comment_id": 96321850, "body": "Try this: <code>char x[] = &quot;one\\0\\0\\0two\\0three&quot;; printf(&quot;%s %s %s\\n&quot;, x, x+6, x+10);</code> (<a href=\"https://ideone.com/NCMHed\" rel=\"nofollow noreferrer\">ideone</a>)"}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1550596298, "post_id": 54770801, "comment_id": 96323175, "body": "You don&#39;t have to return the buffer you write in.You could have a return regarding if it was succeeded or not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550626254, "post_id": 54770801, "comment_id": 96334434, "body": "&quot;It works flawlessly&quot; --&gt; no."}], "answers": [{"comments": [{"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 1, "creation_date": 1550595549, "post_id": 54771065, "comment_id": 96322779, "body": "...and without the second <code>while</code> loop, the function will only write <code>strlen(src)</code> bytes."}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 1, "last_activity_date": 1550594479, "creation_date": 1550594479, "answer_id": 54771065, "question_id": 54770801, "link": "https://stackoverflow.com/questions/54770801/why-does-this-implementation-of-strncpy-work/54771065#54771065", "title": "Why does this implementation of &#39;strncpy&#39; work?", "body": "<p><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strncpy.html\" rel=\"nofollow noreferrer\"><code>strncpy()</code></a> is specified as writing exactly <code>n</code> bytes, independently of the length of the source string.</p>\n\n<pre><code>strncpy(dst, \"foo\", 5); // writes 'f', 'o', 'o', 0, and 0\nstrncpy(dst, \"foo\", 3); // writes 'f', 'o', and 'o': dst is not a string now (*)\nstrncpy(dst, \"foo\", 1); // write 'f': dst is not a string now (*)\n// (*) unless you make sure there is a '\\0' somewhere else in dst\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1550595113, "post_id": 54771072, "comment_id": 96322524, "body": "When you have a buffer passed as a param to write things in it, you always need to have another param for the size of this buffer."}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "reply_to_user": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1550595666, "post_id": 54771072, "comment_id": 96322845, "body": "@TsakiroglouFotis this is true in general, but the C-library <code>strncpy</code> function does not, since it assumes the destination buffer is big enough (many C library functions do assume things like this), which is why it is acceptable in the case of a reimplementation like this."}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1550596218, "post_id": 54771072, "comment_id": 96323138, "body": "Do you mean strcpy?Because -n- in strncpy is the size.It&#39;s truth that strcpy assumes that there is enough space.I was speaking though for function we make, like ft_strncpy here."}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "reply_to_user": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 1, "creation_date": 1550597930, "post_id": 54771072, "comment_id": 96324022, "body": "I meant to say that <code>strncpy</code> does not really care about the size of the buffers but only the amount of characters you want to copy. It is still our job to ensure the number of copied bytes is correct (which is only a different way of making sure the stop condition will be met, in the same way we have to make sure there is a null byte at the end of the buffer with <code>strcpy</code>). You are however correct that using a buffer size argument is the good practice in C."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550626024, "post_id": 54771072, "comment_id": 96334383, "body": "Failed corner case: Code is UB when <code>n==0</code> and code attempts <code>while (src[0] &amp;&amp; ...</code>  Better to use <code>while (i &lt; n &amp;&amp; src[i])</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550626126, "post_id": 54771072, "comment_id": 96334410, "body": "<code>strncpy(char *dest, const char *src, size_t n)</code>  uses <code>size_t</code>, not <code>unsigned int n</code>."}], "tags": [], "owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "is_accepted": true, "score": 1, "last_activity_date": 1550594512, "creation_date": 1550594512, "answer_id": 54771072, "question_id": 54770801, "link": "https://stackoverflow.com/questions/54770801/why-does-this-implementation-of-strncpy-work/54771072#54771072", "title": "Why does this implementation of &#39;strncpy&#39; work?", "body": "<blockquote>\n  <p>the value of i should be (n - 1) right ?</p>\n</blockquote>\n\n<p>This is not necessarily the case, since the first <code>while</code> loop exits when it encounters a <code>\\0</code> character (even if <code>i</code> is less than <code>n-1</code>).</p>\n\n<p>The <code>while</code>-loop is used to ensure the remainder of the <code>dest</code> array is properly initialized to <code>\\0</code>.</p>\n\n<p>The \"wrong\" behavior you are seeing (the string being printed beyond the end of the copied string) is due to the fact that both loops exit with the same condition: the first loop exits when <code>i</code> becomes <code>n</code> and since the second loop has the check <code>i&lt;n</code>, it does not run.</p>\n\n<p>This corresponds to the behavior described in the manual:</p>\n\n<blockquote>\n  <p>The <em>strncpy()</em> function is similar, except that at most <code>n</code> bytes of <code>src</code> are copied.  Warning: If there is no null byte among the first <code>n</code> bytes of <code>src</code>, the string placed in <code>dest</code> will not be null-terminated.</p>\n</blockquote>\n\n<p>If you were to copy a string <code>str</code> with the value <code>abc</code>, it would properly display it in the example below:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nchar    *ft_strncpy(char *dest, char *src, unsigned int n)\n{\n    unsigned int i;\n    unsigned int size;\n\n    i = 0;\n    size = 0;\n    while (src[i] &amp;&amp; i &lt; n)\n    {\n        dest[i] = src[i];\n        i++;\n    }\n    while (i &lt; n)\n    {\n        dest[i] = '\\0';\n        i++;\n    }\n    return (dest);\n}\n\nint main()\n{\n     char str[] = \"test de chaine\";\n     char *str2 = \"abc\";\n\n     ft_strncpy(str, str2, 6);\n     printf(\"%s\\n\", str);\n     return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "is_accepted": false, "score": 0, "last_activity_date": 1550596326, "last_edit_date": 1550596326, "creation_date": 1550595956, "answer_id": 54771497, "question_id": 54770801, "link": "https://stackoverflow.com/questions/54770801/why-does-this-implementation-of-strncpy-work/54771497#54771497", "title": "Why does this implementation of &#39;strncpy&#39; work?", "body": "<p>You need to understand that while they look similar,a char array is not a string while a string is a char array.Some functions (i.e. string.h ones) will read each byte one after the other and will stop when they meet '\\0'.So check this example and you'll have a different view.</p>\n\n<pre><code>int main()\n{\n     char str3[] = \"This is a test\";\n\n     printf(\"\\n %s\", str3);\n     str3[5] = '\\0';\n     printf(\"\\n %s \\n\", str3);\n     int i = 0;\n     for(i = 0 ; i &lt; strlen(str3) ; i ++)\n     {\n         printf(\" %c -\",str3[i] );\n     }\n     printf(\"\\n\");\n     for(i = 0 ; i &lt; 12 ; i ++)\n     {\n         printf(\" %c -\",str3[i] );\n     }\n     return 0;\n}\n</code></pre>\n\n<p>What we print is not what we have in memory.Especially using %s will stream the char array and stop when hit '\\0'.\nIs what happens in this example clear to you?</p>\n"}], "owner": {"reputation": 35, "user_id": 6278784, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U67to.jpg?s=128&g=1", "display_name": "Jib", "link": "https://stackoverflow.com/users/6278784/jib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 54771072, "answer_count": 3, "score": 0, "last_activity_date": 1550596326, "creation_date": 1550593496, "question_id": 54770801, "link": "https://stackoverflow.com/questions/54770801/why-does-this-implementation-of-strncpy-work", "title": "Why does this implementation of &#39;strncpy&#39; work?", "body": "<p>I have to rewrite for an assignment a function that mimics the behavior of the strncpy, after many trials and error, some external help, here's the final code :</p>\n\n<pre><code> 15 char    *ft_strncpy(char *dest, char *src, unsigned int n)\n 16 {\n 17     unsigned int i;\n 18     unsigned int size;\n 19\n 20     i = 0;\n 21     size = 0;\n 22     while (src[i] &amp;&amp; i &lt; n)\n 23     {\n 24         dest[i] = src[i];\n 25         i++;\n 26     }\n 27     while (i &lt; n)\n 28     {\n 29         dest[i] = '\\0';\n 30         i++;\n 31     }\n 32     return (dest);\n 33 }\n</code></pre>\n\n<p>It works flawlessly, but I don't get this part : </p>\n\n<pre><code> while (i &lt; n)\n {\n     dest[i] = '\\0';\n     i++;\n }\n</code></pre>\n\n<p>At this point, the value of i should be (n - 1) right ? So <code>'\\0' goes into dest[n-1]</code> and the loop ends because <code>i becomes equal to n</code> and then the function ends.</p>\n\n<p>We're left with a string that would look something like this :</p>\n\n<pre><code>\"string copied\\0not copied part\"\n</code></pre>\n\n<p>And be printed like : <code>string copiednot copied part</code>.</p>\n\n<p>My question is :</p>\n\n<ul>\n<li><p>Why does <code>dest[n-1]='\\0'</code> or <code>dest[n]='\\0'</code> instead of that while loop, return <code>string copied</code> instead of 'string copiednot copied part' when they basically do the same thing ?</p></li>\n<li><p>Why does the <code>\\0</code> seem to be 'ignored' when printed out after the while loop, when it's considered a full stop when I use dest[n-1] = '\\0' instead ?</p></li>\n</ul>\n\n<p>Here's the main/alternative function I used to run test and try to understand : </p>\n\n<pre><code>int main()\n{\n     char str[] = \"test de chaine\";\n     char *str2 = \"chaine de test\";\n\n     ft_strncpy(str, str2, 6);\n     printf(\"%s\", str);\n     return 0;\n}\n\nchar    *ft_strncpy(char *dest, char *src, unsigned int n)\n {\n     unsigned int i;\n     unsigned int size;\n\n     i = 0;\n     size = 0;\n     while (src[i] &amp;&amp; i &lt; n)\n     {\n         dest[i] = src[i];\n         i++;\n     }\n         dest[n-1] = '\\0';\n     return (dest);\n }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 2, "creation_date": 1550592469, "post_id": 54770467, "comment_id": 96320953, "body": "<code>gets</code> should never be used in modern C code."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1550592541, "post_id": 54770467, "comment_id": 96320990, "body": "Who or what suggested using <code>gets()</code>?"}, {"owner": {"reputation": 4985, "user_id": 2005038, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/hGCjO.png?s=128&g=1", "display_name": "marco-a", "link": "https://stackoverflow.com/users/2005038/marco-a"}, "edited": false, "score": 0, "creation_date": 1550592602, "post_id": 54770467, "comment_id": 96321025, "body": "Replace <code>gets</code> with <code>scanf(&quot;%1000s&quot;, dir);</code> and <code>puts</code> with <code>printf(&quot;%s&quot;, dir);</code>"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1550592656, "post_id": 54770467, "comment_id": 96321066, "body": "<a href=\"http://c-faq.com/stdio/scanfinterlace.html\" rel=\"nofollow noreferrer\">c-faq.com/stdio/scanfinterlace.html</a> and <a href=\"http://c-faq.com/stdio/getsvsfgets.html\" rel=\"nofollow noreferrer\">c-faq.com/stdio/getsvsfgets.html</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550593273, "post_id": 54770467, "comment_id": 96321403, "body": "Advice: don&#39;t us <code>scanf</code> for interactive input. Use <code>fgets</code> followed by <code>sccanf</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550593339, "post_id": 54770467, "comment_id": 96321448, "body": "Clarification: yes it&#39;s a duplicate, <code>fgets</code> is the new <code>gets</code>."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1550593488, "post_id": 54770467, "comment_id": 96321532, "body": "Nothing wrong with <code>puts()</code>, btw. Better <code>puts(foo)</code> than <code>printf(&quot;%s\\n&quot;, foo)</code>. (In fact, gcc will sometimes transform the latter into the former). I prefer <code>fputs(foo, stdout)</code> over <code>printf(&quot;%s&quot;, foo)</code> too. If you don&#39;t need printf&#39;s formatting ability, why use it?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1550593586, "post_id": 54770467, "comment_id": 96321603, "body": "Upvoted for the totally useless (but nonetheless kewl) ASCII-art. Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Regarding your addition to your questions: <code>puts()</code> is perfectly fine."}, {"owner": {"reputation": 4985, "user_id": 2005038, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/hGCjO.png?s=128&g=1", "display_name": "marco-a", "link": "https://stackoverflow.com/users/2005038/marco-a"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1550600863, "post_id": 54770467, "comment_id": 96325564, "body": "@Shawn You&#39;re right. I thought puts takes a format string just like printf..."}], "owner": {"reputation": 11, "user_id": 10996706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed6cd3dd9ec89f9a1e134b9464fb3a7?s=128&d=identicon&r=PG&f=1", "display_name": "Desmazio", "link": "https://stackoverflow.com/users/10996706/desmazio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1550593206, "answer_count": 0, "score": 0, "last_activity_date": 1550593123, "creation_date": 1550592407, "last_edit_date": 1550593123, "question_id": 54770467, "link": "https://stackoverflow.com/questions/54770467/i-cant-get-a-string-input", "closed_reason": "Duplicate", "title": "I can&#39;t get a string input", "body": "<p>When I run this code and it's time to enter the string, it skips over the call to <code>gets</code>, without writing anything.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid disegnaMenu(){\n\n    printf(\"*****************************************\\n\");\n    printf(\"*   ____                   _            *\\n\");\n    printf(\"*  |    \\  ___ ___ _ _ ___ | |____ ___   *\\n\");\n    printf(\"*  |  |  | -_|  _| | | . |   | -_|  _|  *\\n\");\n    printf(\"*  |____/|___|___|_  |  _|_|_|___|_|    *\\n\");\n    printf(\"*                |___|_|                *\\n\");\n    printf(\"*****************************************\\n\");\n    printf(\"*                                       *\\n\");\n    printf(\"* 1)Converti da .txt                    *\\n\");\n    printf(\"*                                       *\\n\");\n    printf(\"* 2)Converti a .txt                     *\\n\");\n    printf(\"*                                       *\\n\");\n    printf(\"*****************************************\\n\");\n\n}\n\nint main(){\n\n    int scelta;\n    char dir[1000];\n\n    disegnaMenu();\n\n    printf(\"&gt;\");\n    scanf(\"%d\", &amp;scelta);\n\n    if(scelta == 1){\n\n        printf(\"\\n*****************************************\\n\");\n        printf(\"Directory:\\n&gt;\");\n        gets(dir);\n        printf(\"\\n\");\n        puts(dir);\n\n    }\n}\n</code></pre>\n\n<p>What should I do?\nThanks.</p>\n\n<p>EDIT:</p>\n\n<p>Ok, apparently <code>gets</code> and <code>puts</code> should not be used, better use <code>scanf(\"%1000s\", dir)</code> and <code>printf()</code></p>\n"}, {"tags": ["c++", "c", "visual-c++", "msvcrt"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1550591388, "post_id": 54770059, "comment_id": 96320310, "body": "The idea that one value is &quot;portable&quot; and the other is &quot;non-portable&quot; is mistaken. The numeric values, except perhaps the universally-known &quot;9&quot; which is a de facto standard, are not anything that portable or even non-portable programs rely on across platforms. If you want to use a signal, you use the <code>SIG*</code> macro names, not the numbers. So this doesn&#39;t matter. I&#39;m not sure what the MS justification for having the <code>_COMPAT</code> one is, though."}, {"owner": {"reputation": 144, "user_id": 6272829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8342a6e7cd380250515749f8d6f599e?s=128&d=identicon&r=PG&f=1", "display_name": "Seltzer", "link": "https://stackoverflow.com/users/6272829/seltzer"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1550594336, "post_id": 54770059, "comment_id": 96322071, "body": "The one place the numbers themselves are useful is when determining reasons for involuntary shutdown. The numbers for several of them (including SIGABRT) are defined by POSIX, so they&#39;re pretty reliable, but it&#39;s absolutely true (and I do note it) that the symbolic values should be used."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1550598522, "post_id": 54770059, "comment_id": 96324302, "body": "Indeed, I wasn&#39;t aware but POSIX <i>does</i> define some numbers, for the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/kill.html\" rel=\"nofollow noreferrer\"><code>kill</code> command</a>. I don&#39;t see where this imposes a requirement on the C interface though; it&#39;s possible that the numbers the <code>kill</code> command accepts differ from the numbers used in the C interfaces."}], "owner": {"reputation": 144, "user_id": 6272829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8342a6e7cd380250515749f8d6f599e?s=128&d=identicon&r=PG&f=1", "display_name": "Seltzer", "link": "https://stackoverflow.com/users/6272829/seltzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550591055, "creation_date": 1550591055, "question_id": 54770059, "link": "https://stackoverflow.com/questions/54770059/why-does-sigabrt-compat-exist-in-the-ucrt-and-what-is-its-intended-use", "title": "Why does SIGABRT_COMPAT exist in the UCRT and what is it&#39;s intended use?", "body": "<p>In the UCRT signal.h, I see these defines.</p>\n\n<pre><code>#define SIGABRT         22  // abnormal termination triggered by abort call\n\n#define SIGABRT_COMPAT  6   // SIGABRT compatible with other platforms, same as SIGABRT\n</code></pre>\n\n<p>Full path is <code>c:\\Program Files (x86)\\Windows Kits\\10\\Include\\10.0.10240.0\\ucrt\\signal.h</code> if it helps.</p>\n\n<p>In <code>man signal.7</code> on my Ubuntu 18.04 system I see <code>SIGABRT</code> is also mapped to <code>6</code>.</p>\n\n<p>This is confusing to me. Being that Windows doesn't truly have \"signals\" under the hood, and this is all an emulation layer on top of the <a href=\"https://stackoverflow.com/a/26405412/6272829\">various messaging mechanisms native to Windows</a> wrapped by the C++11 standard library, why did they choose something non-portable for the default <code>SIGABRT</code>? Do they expect people to be using it as an argument to <code>raise()</code>, or for comparison in a signal handler?</p>\n\n<p>The only documentation I can find regarding the existence of <code>SIGABRT_COMPAT</code> is the comment in the header file, and the table in the <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/signal-constants?view=vs-2017\" rel=\"nofollow noreferrer\">online documentation</a> which is no more descriptive than the header.</p>\n\n<p>The standard doesn't even define it: <a href=\"https://en.cppreference.com/w/cpp/header/csignal\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/header/csignal</a></p>\n\n<p>I realize that these are all symbolic values and it may be considered poor form to depend on them being specific values (<a href=\"https://unix.stackexchange.com/questions/99112/default-exit-code-when-process-is-terminated\">though it can be useful</a>), but this must be here for a reason.</p>\n\n<p>This is a bit upsetting to see because it seems to be there for portability reasons, but at the same time it looks like using it <em>reduces</em> code portability since it's only defined in the UCRT.</p>\n"}, {"tags": ["c", "winapi", "hwnd"], "comments": [{"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1550590758, "post_id": 54769891, "comment_id": 96319878, "body": "What you expect to see - id (HWND) or window title (text)?"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1550590763, "post_id": 54769891, "comment_id": 96319880, "body": "You lack basic C understanding. Calling a function requires (), e.g. GetActiveWindow() and it does not return a string, but a pointer. Better avoid WinAPI until you are ready."}, {"owner": {"reputation": 114, "user_id": 9571508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c39a851f0fe37c3c0d049b3a4a333b?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon", "link": "https://stackoverflow.com/users/9571508/sheldon"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1550590803, "post_id": 54769891, "comment_id": 96319901, "body": "@i486 Title of window."}, {"owner": {"reputation": 114, "user_id": 9571508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c39a851f0fe37c3c0d049b3a4a333b?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon", "link": "https://stackoverflow.com/users/9571508/sheldon"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1550590837, "post_id": 54769891, "comment_id": 96319935, "body": "@Michael Hmm yes. I know how to call function for example func1(param1,param2) but i am lost with this where to get string of windows title."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1550590876, "post_id": 54769891, "comment_id": 96319962, "body": "@Sheldon you need GetWindowText()"}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1550591136, "post_id": 54769891, "comment_id": 96320137, "body": "<code>GetWindowText( GetActiveWindow(), buf, sizeof buf &#47; sizeof *buf )</code> where <code>buf</code> is <code>TCHAR</code> array. But <code>printf</code> means that you have console application and the title comes from Prompt (cmd.exe), usually &quot;Command Prompt&quot;."}, {"owner": {"reputation": 114, "user_id": 9571508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c39a851f0fe37c3c0d049b3a4a333b?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon", "link": "https://stackoverflow.com/users/9571508/sheldon"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1550591196, "post_id": 54769891, "comment_id": 96320175, "body": "@i486 yes i just want to print active window in console."}, {"owner": {"reputation": 114, "user_id": 9571508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c39a851f0fe37c3c0d049b3a4a333b?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon", "link": "https://stackoverflow.com/users/9571508/sheldon"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1550591238, "post_id": 54769891, "comment_id": 96320207, "body": "@i486 And thank very much for code :)"}], "answers": [{"tags": [], "owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": true, "score": 3, "last_activity_date": 1550591260, "creation_date": 1550591260, "answer_id": 54770119, "question_id": 54769891, "link": "https://stackoverflow.com/questions/54769891/how-to-print-the-title-of-the-active-window-in-c-winapi/54770119#54770119", "title": "How to print the title of the active window in C - WinAPI", "body": "<pre><code>TCHAR buf[256];\n\nGetWindowText( GetActiveWindow(), buf, sizeof buf / sizeof *buf );\nwsprintf( TEXT( \"Window text: %s\\n\" ), buf );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1550593306, "last_edit_date": 1550593306, "creation_date": 1550591273, "answer_id": 54770123, "question_id": 54769891, "link": "https://stackoverflow.com/questions/54769891/how-to-print-the-title-of-the-active-window-in-c-winapi/54770123#54770123", "title": "How to print the title of the active window in C - WinAPI", "body": "<p>An <code>HWND</code> is a <a href=\"https://docs.microsoft.com/en-us/windows/desktop/sysinfo/handles-and-objects\" rel=\"nofollow noreferrer\">handle</a>. It has an integral value, not a string value. If your intent is to print out the title of the window, you can use the <code>GetWindowText</code> function to obtain a title from an <code>HWND</code>:</p>\n\n<pre><code>void printWindow(HWND hWnd)\n{\n    DWORD dwLen = GetWindowTextLengthW(hWnd);\n    WCHAR *wszTitle = HeapAlloc(GetProcessHeap(), 0, (dwLen + 1) * sizeof(WCHAR));\n    if(wszTitle == NULL)\n    {\n        return;\n    }\n    GetWindowTextW(hWnd, wszTitle, dwLen + 1);\n\n    wprintf(L\"%s\\n\", wszTitle);\n\n    HeapFree(GetProcessHeap(), 0, wszTitle);\n}\n</code></pre>\n"}], "owner": {"reputation": 114, "user_id": 9571508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c39a851f0fe37c3c0d049b3a4a333b?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon", "link": "https://stackoverflow.com/users/9571508/sheldon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 54770119, "answer_count": 2, "score": 0, "last_activity_date": 1550681959, "creation_date": 1550590542, "last_edit_date": 1550681959, "question_id": 54769891, "link": "https://stackoverflow.com/questions/54769891/how-to-print-the-title-of-the-active-window-in-c-winapi", "title": "How to print the title of the active window in C - WinAPI", "body": "<p>Well i have only one semester of C so i am little confused with <code>HWND</code> and how to use it. I just want to print active window.\nI found - <code>GetActiveWindow</code>, <code>GetForegroundWindow</code>.</p>\n\n<p>But i just dont understand how to use this function to print that active window.</p>\n\n<p>I was trying to do something like.</p>\n\n<pre><code>HWND GetActiveWindow();\nprintf(\"%s\", GetActiveWindow);\n</code></pre>\n\n<p>But that is probably bad use and not working.<br>\nIf someone can gave me a working example i will be very thankfull.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1550588926, "post_id": 54769246, "comment_id": 96318640, "body": "&quot;Why&quot; questions usually can&#39;t be answered here, because we aren&#39;t the compiler developers.  The diagnostic text you quote sounds like a GCC diagnostic, so you might have better luck asking this question on the mailing list <code>gcc@gcc.gnu.org</code> (see <a href=\"https://gcc.gnu.org/lists.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/lists.html</a>)."}, {"owner": {"reputation": 1261, "user_id": 1846228, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9a17eedf0472db2700ce6f3d8848265d?s=128&d=identicon&r=PG", "display_name": "XapaJIaMnu", "link": "https://stackoverflow.com/users/1846228/xapajiamnu"}, "edited": false, "score": 0, "creation_date": 1550588939, "post_id": 54769246, "comment_id": 96318652, "body": "What compiler are you using? This is an error unless doing <code>fpermissive</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1261, "user_id": 1846228, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9a17eedf0472db2700ce6f3d8848265d?s=128&d=identicon&r=PG", "display_name": "XapaJIaMnu", "link": "https://stackoverflow.com/users/1846228/xapajiamnu"}, "edited": false, "score": 0, "creation_date": 1550589024, "post_id": 54769246, "comment_id": 96318709, "body": "@XapaJIaMnu <a href=\"https://www.godbolt.org/z/2gDqxv\" rel=\"nofollow noreferrer\">godbolt.org/z/2gDqxv</a> : gcc treats this as a warning: <a href=\"https://www.godbolt.org/z/2gDqxv\" rel=\"nofollow noreferrer\">godbolt.org/z/2gDqxv</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1550589153, "post_id": 54769246, "comment_id": 96318780, "body": "@zwol gcc, clang, MS C compiler all give similar warnings. And it&#39;s not specific to gcc at all."}, {"owner": {"reputation": 1261, "user_id": 1846228, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9a17eedf0472db2700ce6f3d8848265d?s=128&d=identicon&r=PG", "display_name": "XapaJIaMnu", "link": "https://stackoverflow.com/users/1846228/xapajiamnu"}, "edited": false, "score": 0, "creation_date": 1550589168, "post_id": 54769246, "comment_id": 96318797, "body": "Oh, my bad,  I compiled using g++ not gcc."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1261, "user_id": 1846228, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9a17eedf0472db2700ce6f3d8848265d?s=128&d=identicon&r=PG", "display_name": "XapaJIaMnu", "link": "https://stackoverflow.com/users/1846228/xapajiamnu"}, "edited": false, "score": 1, "creation_date": 1550589266, "post_id": 54769246, "comment_id": 96318860, "body": "@XapaJIaMnu yep, the behaviour of C++ is definitely more sane than that of c"}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 1, "creation_date": 1550589812, "post_id": 54769246, "comment_id": 96319220, "body": "This behaviour is present in the standard, and it is implementation defined: &quot;... An integer may be converted to any pointer type ...&quot;. <a href=\"http://c0x.coding-guidelines.com/6.3.2.3.html\" rel=\"nofollow noreferrer\">c0x.coding-guidelines.com/6.3.2.3.html</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 2, "creation_date": 1550590991, "post_id": 54769246, "comment_id": 96320045, "body": "@Jose The document is misleading. You need an explicit conversion (cast) for this."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 1, "creation_date": 1550591485, "post_id": 54769246, "comment_id": 96320356, "body": "@Jose: As n.m. said, that document is non-authoritative and misleading. If you want to make claims like this cite the standard, not sketchy sites like coding-guidelines or cppreference."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1550591525, "post_id": 54769246, "comment_id": 96320368, "body": "A warning is a diagnostic. The standard only requires a diagnostic."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1550592376, "post_id": 54769246, "comment_id": 96320884, "body": "@zwol: The fact that people here are not the originators of knowledge does not mean that they do not possess or cannot acquire the knowledge. There are more ways of learning than direct experience. And are you sure none of the people here are the compiler developers?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 1, "creation_date": 1550593776, "post_id": 54769246, "comment_id": 96321706, "body": "@Persixty I have no idea what <i>any</i> of this means."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1550594111, "post_id": 54769246, "comment_id": 96321934, "body": "@n.m. Read the answer by R. below in context with <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1548.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/n1548.pdf</a>. As well as section 3.4.3 (Undefined Behaviour). In the page you referenced it only talks about converting 0 to a pointer. Also look at my comment on R.&#39;s answer below. There&#39;s no question my answer and R.&#39;s answer and other comments above are in &#39;Language Lawyer&#39; mode and offering a formal interpretation of the formal language specification!  My link is the last draft available in Public Domain."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 1, "creation_date": 1550594461, "post_id": 54769246, "comment_id": 96322144, "body": "@Persixty I don&#39;t recall referencing any page here. I was going to post an answer but R. has posted almost exactly the same thing I wanted to."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1550594994, "post_id": 54769246, "comment_id": 96322466, "body": "@n.m. On account of me being an idiot and sending you a comment that should have gone to Jose! I apologise."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1550595015, "post_id": 54769246, "comment_id": 96322477, "body": "@Jose It&#39;s undefined behaviour. However one of the things the standard permits is a locally defined interpretation (with or without the issuance of a diagnostic). In short compiling that code amounts to supporting a language extension (beyond behaviour fully defined in the standard). The only arithmetic value the page you cite defines a meaning for is 0."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1550590960, "post_id": 54770002, "comment_id": 96320018, "body": "Yes, of course I use <code>-Wall</code> precisely for that reason."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1550591093, "post_id": 54770002, "comment_id": 96320109, "body": "@Jabberwocky It&#39;s compilers being helpful when they&#39;re not! If the out of the box settings were more conservative generations of novice programmers would be led away from pointlessly bad habits."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1550591127, "post_id": 54770002, "comment_id": 96320129, "body": "Totally agree on this."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1550593885, "post_id": 54770002, "comment_id": 96321785, "body": "@Jabberwocky If you value your sanity, use <code>-Werror</code>."}], "tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 2, "last_activity_date": 1550595119, "last_edit_date": 1550595119, "creation_date": 1550590874, "answer_id": 54770002, "question_id": 54769246, "link": "https://stackoverflow.com/questions/54769246/idea-behind-makes-pointer-from-integer-without-a-cast/54770002#54770002", "title": "Idea behind &quot;[...] makes pointer from integer without a cast&quot;", "body": "<p>The behaviour of assigning an arithmetic type to a pointer is not well formed in the C standard. (See the answer provided by R.. for relevant sections.) </p>\n\n<p>Your compiler (or the settings you're using) have decided to treat that as a warning.</p>\n\n<p>Compilers have default settings and often support language extensions and those may be quite liberal. </p>\n\n<p>Notice for anything outside the language specification it's up to the implementers of the compiler to decide what's an error or if they're going to interpret it as a language extension and (hopefully) issue a warning that the the code is off the offical piste.</p>\n\n<p>I agree that's not best. My recommendation would be to treat is an error because it almost certainly is and casting an <code>int</code> to a pointer is the standard supported way of being explicit and getting the same result (e.g. <code>int *</code>n).</p>\n\n<p>I think you're using GCC and it's notorious for \"helpfully\" compiling things that it could better serve you by rejecting and making you use standard constructs.</p>\n\n<p>Enable all warnings (<code>-Wall</code> on the gcc command-line) and make sure you understand and address them all appropriately.</p>\n"}, {"comments": [{"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1550593724, "post_id": 54770305, "comment_id": 96321679, "body": "May be helpful to add the footnote in 6.3.2.3:  The mapping functions for converting a pointer to an integer or an integer to a pointer are intended to be consistent with the addressing structure of the execution environment.  That only applies to well-formed conversions but by an assumption of sanity I&#39;d say there&#39;s nothing else a compiler that chooses to compile that code could reasonably do!"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1550600522, "post_id": 54770305, "comment_id": 96325391, "body": "@Persixty: Sanity went out of fashion years ago.  If a 32-bit compiler is given something like <code>unsigned mul(unsigned short x, unsigned short y) { return x*y;}</code> it may seem like the only sane things for it to do if <code>x*y</code> exceeds <code>INT_MAX</code> would be to either trap or yield the arithmetical value of the product (according to the Rationale, the authors of the Standard expected most compilers to do the latter) but gcc is more &quot;creative&quot;; invoking that function with <code>x*y &gt; INT_MAX</code> may disrupt the behavior of the surrounding code."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1550750319, "post_id": 54770305, "comment_id": 96389356, "body": "I take the point though C11 says that&#39;s non-compliant &quot;A computation involving unsigned operands can never overflow, because a result that cannot be represented by the resulting unsigned integer type is reduced modulo the number that is one greater than the largest value that can be represented by the resulting type.&quot; My point is that having detected the ill-formed code and decided to issue a warning and emit code (rather than error) the implementer has created a language extension and should document the behaviour."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 1, "creation_date": 1550763615, "post_id": 54770305, "comment_id": 96398509, "body": "@Persixty: They&#39;re not unsigned operands. <code>unsigned short</code> promotes to <code>int</code> via default promotions, <i>then</i> the multiplication takes place."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1550827674, "post_id": 54770305, "comment_id": 96422483, "body": "@R.. Ouch! Fair play. The operands converted to <code>int</code> (if range compatible - typically so) and then the (logical) result is outside <code>int</code> range (also typically possible) results in UB. To me the sanity was lost when unsigned types are converted to <code>int</code> in preference to unsigned. But that is the standard. It&#39;s also perverse that arithmetic overflow is UB rather than an implementation defined value. Perverse or not, that is what the standard says. It should definitely be on lists of &#39;little known gotchas&#39;. Got me anyway!"}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 7, "last_activity_date": 1550591850, "creation_date": 1550591850, "answer_id": 54770305, "question_id": 54769246, "link": "https://stackoverflow.com/questions/54769246/idea-behind-makes-pointer-from-integer-without-a-cast/54770305#54770305", "title": "Idea behind &quot;[...] makes pointer from integer without a cast&quot;", "body": "<p>Per <em>6.5.2.2 Function Calls</em>, \u00b6 7:</p>\n\n<blockquote>\n  <p>If the expression that denotes the called function has a type that does include a prototype, the arguments are implicitly converted, as if by assignment, to the types of the corresponding parameters, taking the type of each parameter to be the unqualified version of its declared type</p>\n</blockquote>\n\n<p>The relevant text in <em>6.5.16.1 Simple Assignment</em> is:</p>\n\n<blockquote>\n  <p>Constraints</p>\n  \n  <p>One of the following shall hold:</p>\n  \n  <ul>\n  <li>the left operand has atomic, qualified, or unqualified arithmetic type, and the right has arithmetic type;</li>\n  <li>the left operand has an atomic, qualified, or unqualified version of a structure or union type compatible with the type of the right;</li>\n  <li>the left operand has atomic, qualified, or unqualified pointer type, and (considering the type the left operand would have after lvalue conversion) both operands are pointers to qualified or unqualified versions of compatible types, and the type pointed to by the left has all the qualifiers of the type pointed to by the right;</li>\n  <li>the left operand has atomic, qualified, or unqualified pointer type, and (considering the type the left operand would have after lvalue conversion) one operand is a pointer to an object type, and the other is a pointer to a qualified or unqualified version of void, and the type pointed to by the left has all the qualifiers of the type pointed to by the right;</li>\n  <li>the left operand is an atomic, qualified, or unqualified pointer, and the right is a null pointer constant; or</li>\n  <li>the left operand has type atomic, qualified, or unqualified _Bool, and the right is a pointer.</li>\n  </ul>\n</blockquote>\n\n<p>None of these allow the left operand as a pointer and the right operand as an integer. Thus, such an assignment (and by the first quoted text above, the function call) is a <strong>constraint violation</strong>. This means the compiler is required by the standard to \"diagnose\" it. However it's up to the compiler what it does beyond that. Yes, an error would be highly preferable, but just printing a warning is a low-quality way to satisfy the requirement to \"diagnose\" constraint violations like this.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1550614129, "creation_date": 1550614129, "answer_id": 54775696, "question_id": 54769246, "link": "https://stackoverflow.com/questions/54769246/idea-behind-makes-pointer-from-integer-without-a-cast/54775696#54775696", "title": "Idea behind &quot;[...] makes pointer from integer without a cast&quot;", "body": "<blockquote>\n  <p>Does somebody know what's the idea behind this?</p>\n  \n  <ul>\n  <li>Is it mostly to allow prehistoric code to be compiled without errors?</li>\n  <li>Or just to comply to the standard? Then latter maybe needs some fixing.</li>\n  </ul>\n</blockquote>\n\n<p>It is to comply with the standard in the sense that the standard requires conforming implementations to diagnose such issues, as @R.. describes in his answer.  Implementations are <em>not</em> required to reject programs on account of such issues, however.  As for why some compilers instead accept such programs, that would need to be evaluated on a per-implementation basis, but this quotation from the first edition of K&amp;R may shed a bit of light:</p>\n\n<blockquote>\n  <p><strong>5.6 Pointers are not Integers</strong></p>\n  \n  <p>You may notice in older C programs a rather cavalier attitude toward\n  copying pointers.  It has generally been true that on most machines a\n  pointer may be assigned to an integer and back again; no scaling or\n  conversion takes place, and no bits are lost.  Regrettably, this has\n  led to the taking of liberties with routines that return pointers\n  which are then merely passed to other routines -- the requisite\n  pointer declarations are often left out.</p>\n</blockquote>\n\n<p>(Kernighan &amp; Ritchie, <em>The C Programming Language</em>, 1<sup>st</sup> ed., 1978)</p>\n\n<p>Notice in the first place that this long predates even C89.  I'm a bit amused today that the authors were <em>then</em> talking about \"older\" C programs.  But note too that even at that time, the C language as defined by K&amp;R did not formally permit implicit conversion between pointers and integers (though it did permit casting between them).</p>\n\n<p>Nevertheless, there were programs that relied on implicit conversion anyway, apparently because it happened to work on the targeted implementations.  It was attractive, by some people's standards at the time, in conjunction with primordial C's implicit typing rules.  One could let a variable or function intended to return or store a pointer default to type <code>int</code> by omitting its declaration altogether, and as long as it was interpreted as a pointer wherever it ultimately was used, everything usually happened to work as intended.</p>\n\n<p>I'm inclined to guess that everything continuing to work as intended, thereby supporting backwards compatibility, was a consideration for compiler developers in continuing to accept implicit conversions, so that's \"allow[ing] prehistoric code to be compiled.\"  I note, however, that these days code with implicit conversions of this kind are much less likely to work as intended than they used to be, for many machines these days have 64-bit pointers but only 32-bit <code>int</code>s.</p>\n"}], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 1, "accepted_answer_id": 54775696, "answer_count": 3, "score": 11, "last_activity_date": 1550614129, "creation_date": 1550588595, "last_edit_date": 1550590572, "question_id": 54769246, "link": "https://stackoverflow.com/questions/54769246/idea-behind-makes-pointer-from-integer-without-a-cast", "title": "Idea behind &quot;[...] makes pointer from integer without a cast&quot;", "body": "<p>I always wondered why warnings <code>passing argument 1 from of 'foo' makes pointer from integer without a cast</code> and alike are only warnings and not errors.</p>\n\n<p>Actually these warnings are almost always errors.</p>\n\n<p>Does somebody know what's the idea behind this? </p>\n\n<ul>\n<li>Is it mostly to allow prehistoric code to be compiled without errors?</li>\n<li>Or just to comply to the standard? Then latter maybe needs some fixing.</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>int foo(int *bar)\n{\n  *bar = 42;\n}\n\nvoid bar()\n{\n  int n = 0;\n  foo(n);      // this is obviously an error\n  ...\n}\n</code></pre>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 4, "creation_date": 1550588790, "post_id": 54769186, "comment_id": 96318550, "body": "Read up on what the third argument to <code>fread()</code> is supposed to be."}, {"owner": {"reputation": 125, "user_id": 9654148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c49c70e7d4d0f4c7423b089a603b4ef?s=128&d=identicon&r=PG&f=1", "display_name": "user9654148", "link": "https://stackoverflow.com/users/9654148/user9654148"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1550589006, "post_id": 54769186, "comment_id": 96318696, "body": "You nailed it.  It&#39;s the size.  I changed it to <code>(sizeof buffer) &#47; sizeof(unsigned int)</code> and the problem is gone.  Thank you so much the answer!"}], "owner": {"reputation": 125, "user_id": 9654148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c49c70e7d4d0f4c7423b089a603b4ef?s=128&d=identicon&r=PG&f=1", "display_name": "user9654148", "link": "https://stackoverflow.com/users/9654148/user9654148"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 440, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550588403, "creation_date": 1550588403, "question_id": 54769186, "link": "https://stackoverflow.com/questions/54769186/why-fread-efault-bad-address-in-this-c-function", "title": "Why &quot;fread: EFAULT, bad address&quot; in this C function?", "body": "<p>The following function reads arbitrary data from the <code>stdin</code> and produces an <code>unsigned int</code> one a time.  If it finds <code>EOF</code>, it quits.  If the file is infinite (such as <code>/dev/urandom</code>), it goes on forever.  I have a file of about 95 MiB that makes it produce <code>fread: Bad address</code>.  Can you see why?</p>\n\n<pre><code>unsigned int generator(void)\n{\n  static unsigned int buffer[8192 / sizeof(unsigned int)];\n  static unsigned int pos; /* where is our number? */\n  static unsigned int limit; /* where does the data in the buffer end? */\n\n  if (pos &gt;= limit) {\n    /* refill the buffer and continue by restarting at 0 */\n    limit = fread(buffer, sizeof (unsigned int), sizeof buffer, stdin);\n\n    if (limit == 0) {\n      /* We read 0 bytes.  This either means we found EOF or we have\n      an error.  A decent generator is infinite, so this should never\n      happen. */\n      if (ferror(stdin) != 0) {\n        perror(\"fread\"); exit(-1);\n      }\n      if (feof(stdin) != 0) {\n        printf(\"generator produced eof\\n\");\n        exit(0);\n      }\n    }\n\n    pos = 0;\n\n  }\n\n  unsigned int random = buffer[pos]; /* get one */\n  pos = pos + 1;\n  return random;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc", "system-calls"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1550588198, "post_id": 54769055, "comment_id": 96318220, "body": "The output is buffered. The buffer is duplicated when <code>fork</code>ing. It may or not to contain the characters written there before <code>fork</code>. If you want a predictable behavior, use <code>fflush</code>."}, {"owner": {"reputation": 513, "user_id": 10532629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827650de0b201131dc41e1aa1317fb77?s=128&d=identicon&r=PG&f=1", "display_name": "kalpaj agrawalla", "link": "https://stackoverflow.com/users/10532629/kalpaj-agrawalla"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1550588731, "post_id": 54769055, "comment_id": 96318516, "body": "@EugeneSh. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 774, "user_id": 11059346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eOFhuwfbeLw/AAAAAAAAAAI/AAAAAAAAC5g/I9X1kvk3q24/photo.jpg?sz=128", "display_name": "Esdras Xavier", "link": "https://stackoverflow.com/users/11059346/esdras-xavier"}, "is_accepted": true, "score": 2, "last_activity_date": 1550588338, "creation_date": 1550588338, "answer_id": 54769150, "question_id": 54769055, "link": "https://stackoverflow.com/questions/54769055/redirection-ambiguity/54769150#54769150", "title": "Redirection ambiguity", "body": "<p>I think it's because of the buffer, give a try with the follow code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n    printf(\"T\\n\");\n    fflush(stdout);\n    fork();\n    printf(\"F\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 10532629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827650de0b201131dc41e1aa1317fb77?s=128&d=identicon&r=PG&f=1", "display_name": "kalpaj agrawalla", "link": "https://stackoverflow.com/users/10532629/kalpaj-agrawalla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "closed_date": 1550588338, "accepted_answer_id": 54769150, "answer_count": 1, "score": 1, "last_activity_date": 1550588338, "creation_date": 1550588069, "question_id": 54769055, "link": "https://stackoverflow.com/questions/54769055/redirection-ambiguity", "closed_reason": "Duplicate", "title": "Redirection ambiguity", "body": "<p>I have a file named test.c (Its contents are given below)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    printf(\"T\\n\");\n    fork();\n    printf(\"F\\n\");\n}\n</code></pre>\n\n<p>The expected result is:</p>\n\n<pre><code>T\nF\nF\n</code></pre>\n\n<p>Compiling with gcc and executing <code>./a.out</code> ,the output is:</p>\n\n<pre><code>T\nF\nF\n</code></pre>\n\n<p>which matches the expected answer. </p>\n\n<p><strong>But ambiguity arises when I redirect the output to another file.</strong></p>\n\n<pre><code>$ ./a.out &gt; Output.txt \n</code></pre>\n\n<p>The Output.txt has the following data:</p>\n\n<pre><code>T\nF\nT\nF\n</code></pre>\n\n<p>Why is there an additional T in my Output.txt file when I use redirectors?</p>\n\n<p>1) I've check this in multiple PC's running on ubuntu with gcc installed.</p>\n\n<p>2) Tried deleting the Output.txt and moving all the files to a different location, but this still persists.</p>\n\n<p>P.s. this works fine without the redirector.</p>\n"}, {"tags": ["c", "regex", "vxworks"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1550587238, "post_id": 54768729, "comment_id": 96317649, "body": "<code>scanf</code> doesn&#39;t use regular expressions. A single format specifier kind of <i>reminds</i> of a regex, but it&#39;s not. See e.g. <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">this <code>scanf</code> (and family) reference</a> for more details about the <code>&quot;%[&quot;</code> format specifier."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1550587238, "post_id": 54768729, "comment_id": 96317650, "body": "The &quot;format&quot; of <code>scanf()</code> is <b>not</b> a regular expression."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1550587653, "post_id": 54768729, "comment_id": 96317906, "body": "... and even if it <i>were</i> a regular expression, to include a literal backslash in a string literal you would still need to escape it by doubling it.  Your failure to do so is what the compiler is complaining about."}, {"owner": {"reputation": 45, "user_id": 11027961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2ab82a7e88235671c14c985d32c95c?s=128&d=identicon&r=PG", "display_name": "Albrecht", "link": "https://stackoverflow.com/users/11027961/albrecht"}, "edited": false, "score": 0, "creation_date": 1550587954, "post_id": 54768729, "comment_id": 96318098, "body": "ok, thanks for pointing to the actual problem"}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 0, "last_activity_date": 1550587939, "creation_date": 1550587939, "answer_id": 54769004, "question_id": 54768729, "link": "https://stackoverflow.com/questions/54768729/get-rid-of-regex-compilerwarning-without-using-include-regex-h/54769004#54769004", "title": "get rid of regex compilerwarning without using &quot;#include &lt;regex.h&gt;&quot;", "body": "<p>You may want to try something like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char buf[99];\n    int idx, n;\n    while (fgets(buf, sizeof buf, stdin)) {\n        buf[strcspn(buf, \"\\n\")] = 0; // remove ENTER\n        if (sscanf(buf, \"%*[^[][%d%n\", &amp;idx, &amp;n) != 1) {\n            printf(\"no number in %s\\n\", buf);\n        } else {\n            printf(\"number found: %d (left over string: \\\"%s\\\")\\n\", idx, buf + n);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/gC2G4m\" rel=\"nofollow noreferrer\">See code running on ideone</a></p>\n"}], "owner": {"reputation": 45, "user_id": 11027961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2ab82a7e88235671c14c985d32c95c?s=128&d=identicon&r=PG", "display_name": "Albrecht", "link": "https://stackoverflow.com/users/11027961/albrecht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54769004, "answer_count": 1, "score": 0, "last_activity_date": 1550587939, "creation_date": 1550587026, "question_id": 54768729, "link": "https://stackoverflow.com/questions/54768729/get-rid-of-regex-compilerwarning-without-using-include-regex-h", "title": "get rid of regex compilerwarning without using &quot;#include &lt;regex.h&gt;&quot;", "body": "<p>I am using regex under vxworks and have no possibility to include \"regex.h\".</p>\n\n<p>I am getting the compilerwarning \"unrecognized character escape sequence\" for the code <code>if (sscanf(token, \"%*[^\\[][%d]\", &amp;idx) != 1)</code>\nbecause of the '\\' and the following '['.</p>\n\n<p>Is there a possibility to get rid of that compilerwarning without using the regex.h and stuff like it is done here: <a href=\"https://stackoverflow.com/questions/41740157/unable-to-match-regex-in-c\">Unable to match regex in C</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1550585694, "post_id": 54768281, "comment_id": 96316659, "body": "The crash probably happens in the parts of the code you <i>don&#39;t</i> show us. Please use a debugger to catch the crash and locate when and where in your code it happens."}, {"owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "edited": false, "score": 0, "creation_date": 1550585809, "post_id": 54768281, "comment_id": 96316726, "body": "Please add also <code>vettore.h</code>."}, {"owner": {"reputation": 603, "user_id": 5631673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35dd8802f901c6e38887ab1dc61b8ef3?s=128&d=identicon&r=PG&f=1", "display_name": "A. Gille", "link": "https://stackoverflow.com/users/5631673/a-gille"}, "edited": false, "score": 0, "creation_date": 1550585836, "post_id": 54768281, "comment_id": 96316746, "body": "And don&#39;t forget to <code>free()</code> what you <code>calloc</code>ed"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1550586143, "post_id": 54768281, "comment_id": 96316931, "body": "Have you declared the function properly? Because there&#39;s a mismatch between the shown declaration of <code>finput_array</code> and how you call it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1550586194, "post_id": 54768281, "comment_id": 96316963, "body": "Also please read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">Why is \u201cwhile (!feof(file))\u201d always wrong?</a>"}, {"owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "edited": false, "score": 0, "creation_date": 1550586237, "post_id": 54768281, "comment_id": 96316996, "body": "Looks that you never declared <code>swap(int* lhs, int* rhs)</code>"}, {"owner": {"reputation": 117, "user_id": 11006304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868653dd90dc31acdd518433040d95ca?s=128&d=identicon&r=PG&f=1", "display_name": "user11006304", "link": "https://stackoverflow.com/users/11006304/user11006304"}, "reply_to_user": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "edited": false, "score": 0, "creation_date": 1550586275, "post_id": 54768281, "comment_id": 96317024, "body": "@DDS it&#39;s contained in another file"}, {"owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "edited": false, "score": 1, "creation_date": 1550586323, "post_id": 54768281, "comment_id": 96317055, "body": "we need all the (non C-standard) dependancies.... also little sample input and desired output for that input would be a nice to have"}, {"owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "edited": false, "score": 1, "creation_date": 1550587336, "post_id": 54768281, "comment_id": 96317724, "body": "Also a tip: set gcc to output warnings (use -Wall options)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1550587356, "post_id": 54768281, "comment_id": 96317732, "body": "Didn&#39;t you get any compiler warnings or did you just ignore them? 1) Turn your compilers warning level to maximum. 2) Always take warnings seriously, i.e. fix them"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1550587823, "post_id": 54768281, "comment_id": 96318010, "body": "Didn&#39;t you get a warning in this line: <code>finput_array(argv[2], a, n);</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1190, "user_id": 3344587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d246b94ff48978d81b706630d0102196?s=128&d=identicon&r=PG&f=1", "display_name": "Loc Tran", "link": "https://stackoverflow.com/users/3344587/loc-tran"}, "is_accepted": true, "score": 3, "last_activity_date": 1550586397, "creation_date": 1550586397, "answer_id": 54768523, "question_id": 54768281, "link": "https://stackoverflow.com/questions/54768281/segmentation-fault-error-when-i-try-to-run-this-program/54768523#54768523", "title": "Segmentation fault error when I try to run this program", "body": "<p>You have problem when using finput_array</p>\n\n<pre><code>finput_array(argv[2], a, n);\n</code></pre>\n\n<p>Please replace by</p>\n\n<pre><code>finput_array(argv[2], a, &amp;n);\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 11006304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868653dd90dc31acdd518433040d95ca?s=128&d=identicon&r=PG&f=1", "display_name": "user11006304", "link": "https://stackoverflow.com/users/11006304/user11006304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 54768523, "answer_count": 1, "score": 0, "last_activity_date": 1550586397, "creation_date": 1550585584, "last_edit_date": 1550586023, "question_id": 54768281, "link": "https://stackoverflow.com/questions/54768281/segmentation-fault-error-when-i-try-to-run-this-program", "title": "Segmentation fault error when I try to run this program", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"vettore.h\"\n\nint main(int argc, char *argv[]){\n    if(argc != 5)\n        printf(\"Incorrect parameters number\\n\");\n    else{\n        int n = atoi(argv[1]);\n        int *a = (int*) calloc(n, sizeof(int));\n        if(a == NULL)\n            printf(\"Unsufficient memory\\n\");\n        else{\n            finput_array(argv[2], a, n);\n            bubblesort(a, n);\n            foutput_array(argv[4], a, n);\n            int *oracle = (int*) calloc(n, sizeof(int));\n            finput_array(argv[3], oracle, n);\n\n            if(compare_array(a, oracle, n))\n                printf(\"PASS\\n\");\n            else\n                printf(\"FAIL\\n\");\n        }\n    }\n}\n</code></pre>\n\n<p>I run the program this way: <code>./test_ordina_array.exe 12 TC4_input.txt TC4_oracle.txt TC4_output.txt</code> but it gives me segmentation fault.</p>\n\n<p>\"TC4_output.txt\" is created by the program while the other two files already exist.</p>\n\n<p>This are the functions used:</p>\n\n<pre><code>    void bubblesort(int a[], int n){\nint i, j;\n  for(i = 0 ; i &lt; n - 1; i++)\n  {\n    for(j = 0 ; j &lt; n - i - 1; j++)\n    {\n      if (a[j] &gt; a[j+1]) /* For decreasing order use &lt; */\n      {\n        swap(&amp;a[j], &amp;a[j+1]);\n       }\n      }\n     }\n}\n\nvoid finput_array(char *file_name, int a[], int *n){\n    FILE *fd = fopen(file_name, \"r\");\n    if(fd == NULL)\n        printf(\"Errore in apertura del file %s\\n\", file_name);\n    else{\n        int i = 0;\n        fscanf(fd, \"%d\", &amp;a[i]);\n        while(i&lt;*n &amp;&amp; !feof(fd)){\n            i++;\n            fscanf(fd, \"%d\", &amp;a[i]);\n        }\n        fclose(fd);\n        if(i&lt;*n)\n            *n = i;\n    }\n}\n\nvoid foutput_array(char *file_name, int a[], int n){\n    int i;\n    FILE *fd;\n\n    fd = fopen(file_name, \"w\");\n    if(fd == NULL)\n        printf(\"Errore in apertura del file %s\\n\", file_name);\n    else{\n        for(i=0; i&lt;n; i++)  \n            fprintf(fd, \"%d\\n\", a[i]);\n        fclose(fd);\n    }\n}\n\nint compare_array(int a[], int b[], int n){\n    int i=0;\n\n    while(i&lt;n &amp;&amp; a[i] == b[i])\n        i++;\n\n    return (i==n) ? 1 : 0;\n}\n</code></pre>\n\n<p>They are contained in \"vettore.c\" and \"vettore.h\" contains their prototypes.</p>\n\n<p>The program has to order in ascending order the elements contained in the first txt file and write them in the output file.</p>\n"}, {"tags": ["c", "operating-system", "ubuntu-16.04", "system-calls"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1550586646, "post_id": 54767494, "comment_id": 96317284, "body": "Read the section about shared resources in the documentation of <code>clone</code>. This should explain the behavior of the <code>lseek</code> calls in child and parent. Check the delayed <code>wait4</code> system call and see the exit status <code>42</code> there."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1550594306, "post_id": 54767494, "comment_id": 96322050, "body": "Even if this question were on topic, we couldn&#39;t effectively evaluate your analysis without a more specific description of the assignment than &quot;explain the reason the strace appears as follows&quot;.  If I were to guess, however, I would suppose that the instructor was looking for something more along the lines of a possible sequence of C function calls in the program source that would produce such a trace.  If you choose to look into that, then consider trying to duplicate the trace with a program you write yourself as a means to check your analysis."}], "owner": {"reputation": 880, "user_id": 9219650, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b698c5963df9e360b2e72fed0c97da7a?s=128&d=identicon&r=PG&f=1", "display_name": "Prashin Jeevaganth", "link": "https://stackoverflow.com/users/9219650/prashin-jeevaganth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550585454, "creation_date": 1550583131, "last_edit_date": 1550585454, "question_id": 54767494, "link": "https://stackoverflow.com/questions/54767494/exercise-to-determine-source-code-behaviour-using-strace", "title": "Exercise to determine source code behaviour using strace", "body": "<p>I have an assignment where I am given an x86 Linux executable and am supposed to explain the reason why the strace appears as follows. This is what happens where I run strace -f in Ubuntu 16.04.5 on VirtualBox.</p>\n\n<pre><code>execve(\"./asg-myst\", [\"./asg-myst\"], [/* 67 vars */]) = 0\nuname({sysname=\"Linux\", nodename=\"student-VirtualBox\", ...}) = 0\nbrk(NULL)                               = 0x1191000\nbrk(0x11921c0)                          = 0x11921c0\narch_prctl(ARCH_SET_FS, 0x1191880)      = 0\nreadlink(\"/proc/self/exe\", \"/home/student/Desktop/asgUBUNTU\"..., 4096) = 42\nbrk(0x11b31c0)                          = 0x11b31c0\nbrk(0x11b4000)                          = 0x11b4000\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/etc/passwd\", O_RDONLY)           = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=2246, ...}) = 0\nread(3, \"root:x:0:0:root:/root:/bin/bash\\n\"..., 4096) = 2246\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 4), ...}) = 0\nwrite(1, \"csdae+\", 6)                   = 6\ngetpid()                                = 3794\nclone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x1191b50) = 3795\nwait4(-1, strace: Process 3795 attached\n &lt;unfinished ...&gt;\n[pid  3795] write(1, \"795794=\", 7)      = 7\n[pid  3795] lseek(3, -2167, SEEK_CUR)   = 79\n[pid  3795] exit_group(42)              = ?\n[pid  3795] +++ exited with 42 +++\n&lt;... wait4 resumed&gt; [{WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) == 42}], 0, NULL) = 3795\n--- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=3795, si_uid=1000, si_status=42, si_utime=0, si_stime=0} ---\nwrite(1, \"42\\n\", 3)                     = 3\nlseek(3, -2167, SEEK_CUR)               = -1 EINVAL (Invalid argument)\nexit_group(0)                           = ?\n+++ exited with 0 +++\n</code></pre>\n\n<p>My description will be this:</p>\n\n<p>The parent process calls getpid() system call, then the parent calls clone(). This somehow stores the getpid value of the parent process into the child process, without the child process calling getpid() to return the parent\u2019s pid value. This is evident in the strace of the code, running with an additional -f flag.</p>\n\n<p>Since the program is always run as a new process, the pid value is always changing.\nThe printed output has a pattern of 6 digits which is related to the changing pid value, where the rightmost 3 digits corresponds to the rightmost 3 digit of the getpid() of the parent, and the leftmost 3 digits that remains is this rightmost 3 digits previously +1. For example, for a pid of 3287, last 3 digits is 287, so the printed output is 288287.</p>\n\n<p>The child process exit_group(42) which somehow edits the si_status, and the parent process prints this si_status before exiting normally.</p>\n\n<blockquote>\n  <p>Is there something I\u2019m lacking in my analysis, I\u2019m just thinking this is the flow solely by reading the strace output. </p>\n</blockquote>\n"}]